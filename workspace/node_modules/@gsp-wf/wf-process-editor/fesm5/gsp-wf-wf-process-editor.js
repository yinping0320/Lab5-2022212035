import { forkJoin as forkJoin$1 } from 'rxjs/observable/forkJoin';
import { of } from 'rxjs/observable/of';
import { ReplaySubject } from 'rxjs/ReplaySubject';
import { ParameterFetchValueMode } from '@gsp-cmp/wscmp-models';
import { LookupDataService } from '@farris/lookup-config';
import 'rxjs/Observable';
import { Subject as Subject$1 } from 'rxjs/Subject';
import { BpmnModelJsonHelper as BpmnModelJsonHelper$1, JsonConvertableImpl as JsonConvertableImpl$1 } from '@edp-aif/common-api';
import { forkJoin, Subject, of as of$1, from, Observable, throwError } from 'rxjs';
import { switchMap, map, catchError, delay } from 'rxjs/operators';
import { CommonComponentUiRTService, CommonComponentUiModule } from '@gsp-cmp/ccmp-ui';
import { SysFarrisLookupComponent, SysFarrisTreeHelpComponent, SysManagerUIModule } from '@gsp-sys/sysmgr-ui';
import { RtfAppHelpModule } from '@gsp-sys/rtf-ui';
import { ShowMode, PropertyPanelModule } from '@farris/ide-property-panel';
import { DataTableModule } from '@farris/ui-datatable';
import { LayoutModule } from '@farris/ui-layout';
import { FlexLayoutModule } from '@farris/ui-flex-layout';
import { FarrisPanelModule } from '@farris/ui-panel';
import { FarrisResponsiveModule } from '@farris/ui-responsive';
import { PopoverModule } from '@farris/ui-popover';
import { DatagridFilterRowModule } from '@farris/ui-datagrid-filter';
import { FarrisDropdownModule, FDropdownDirectiveTypeModule } from '@farris/ui-dropdown';
import { WizardModule } from '@farris/ui-wizard';
import { PerfectScrollbarModule } from '@farris/ui-perfect-scrollbar';
import { ExprEditMode, ExpressionService, InjectedType, ExpressioneditorComponent, VarEntity, ExpressionModule } from '@gsp-svc/expression';
import { WfBizprocessLookupModule } from '@gsp-wf/wf-bizprocess-lookup';
import { NumberSpinnerModule } from '@farris/ui-number-spinner';
import { FarrisButtonModule } from '@farris/ui-button';
import { ConditionEntity, ConditionType, BpmnModelJsonHelper, ComponentConditionContent, ExpressionConditionContent, JsonConvertableImpl, TextValue } from '@edp-bif/common-api';
import { CommonModelUtil } from '@gsp-bef/gsp-cm-metadata';
import { ComboLookupModule } from '@farris/ui-combo-lookup';
import { SysLookupDetailComponent, SysmgrLookupModule } from '@gsp-sys/sysmgr-lookup';
import { VerifyDetailService, VerifyDetailModule } from '@farris/ui-verify-detail';
import { FarrisHtmlEditorModule } from '@farris/ui-html-editor';
import { WfTaskHandlerService, WfTaskHandlerModule } from '@gsp-wf/wf-task-handler';
import { HttpClientModule, HttpClient } from '@angular/common/http';
import { FormBuilder, FormControl, FormGroup, FormsModule, ReactiveFormsModule } from '@angular/forms';
import { HttpService, SessionService, CacheService } from '@ecp-caf/caf-common';
import { ComboListModule } from '@farris/ui-combo-list';
import { FarrisCommonModule } from '@farris/ui-common';
import { DatagridComponent, DatagridModule } from '@farris/ui-datagrid';
import { EditorTypes, DatagridEditorsModule, EditorProviders } from '@farris/ui-datagrid-editors';
import { FarrisDialogModule } from '@farris/ui-dialog';
import { AngularDraggableModule } from '@farris/ui-draggable';
import { FarrisFormsModule } from '@farris/ui-forms';
import { InputGroupModule } from '@farris/ui-input-group';
import { LanguageTextboxModule } from '@farris/ui-language-textbox';
import { ListFilterModule } from '@farris/ui-list-filter';
import { LoadingService, LoadingModule } from '@farris/ui-loading';
import { ServerSideToken, LookupGridComponent, LookupModule } from '@farris/ui-lookup';
import { MessagerService, MessagerModule } from '@farris/ui-messager';
import { BsModalService, ModalModule } from '@farris/ui-modal';
import { NotifyService, NotifyModule } from '@farris/ui-notify';
import { PaginationModule } from '@farris/ui-pagination';
import { FarrisSectionModule } from '@farris/ui-section';
import { SplitterModule } from '@farris/ui-splitter';
import { SwitchModule } from '@farris/ui-switch';
import { FarrisTabsModule } from '@farris/ui-tabs';
import { TreeTableModule } from '@farris/ui-treetable';
import { BusinessObjectRtService } from '@gsp-lcm/bo-rt-service';
import { SelectMetadataRTComponent, GSPMetadataRTService, MetadataRTSelectModule, GSPMetadataRTServiceModule } from '@gsp-lcm/metadatart-selector';
import { FrameworkService, AppService, FrmEventBus, FuncsService, LoadingService as LoadingService$1 } from '@gsp-sys/rtf-common';
import { FResponseToolbarModule } from '@farris/ui-response-toolbar';
import { DataEntityService, DataEntityModule } from '@gsp-svc/data-entity-adapter';
import { BizProcessApiModule } from '@gsp-wf/biz-process-api';
import { PersonnelSelectorComponent, PersonnelSelectorModule, PersonnelSelectorDataGridEditorProvider } from '@farris/ui-personnel-selector';
import { TranslateHttpLoader } from '@ngx-translate/http-loader';
import { TranslateService, TranslateLoader, TranslateModule } from '@ngx-translate/core';
import { CommonModule } from '@angular/common';
import { ActivatedRoute, Router, RouterModule } from '@angular/router';
import { Injectable, NgModule, Injector, ComponentFactoryResolver, Inject, LOCALE_ID, ChangeDetectorRef, Component, EventEmitter, Optional, Output, ViewChild, Pipe, InjectionToken, HostBinding, Input, ViewContainerRef, ElementRef, NgZone, defineInjectable } from '@angular/core';
import { __values, __spread, __assign, __extends, __read } from 'tslib';
import { BpmnModelHelper, Expression, DataType, DataTypes, DataObject, FlowNodeState, MultiInstanceLoopCharacteristics, Signal, ParallelGateway, BpmnModel, SequenceFlowState } from '@edp-pmf/bpmn-model';
import { ElementPropertyConfig, PmfEvents, ProcessCell, Graph, Sidebar, BpmnCellHelper, ExclusiveGatewayCell, NodeCell, ParallelGatewayCell, EndEventCell, InclusiveGatewayCell, EditorUi, ActionKeys, ToolboxGroup, ToolboxItem, SequenceFlowEdge } from '@edp-pmf/grapheditor';
import { Condition, CounterSignRule, ValuedDataObject, VariableParticipantExpression, ComponentParticipantExpression, ReportingLineParticipantExpression, MatrixParticipantExpression, OrganizationParticipantExpression, VariableSetting, Component as Component$1, ActivityExecutorParticipantExpression, UserParticipantExpression, PositionParticipantExpression, ProcessHeader, StartMode, CDTSchemaType, ToolTime, ExecuteForm, ActualParameter, TitleExpression, CustomizeAction, MessageNotice, TimeLimitControl, ExtendProperty, ImageSettings, TimeLimitControlInfo, SendMessageExpireOperationInfo, SendMessageExpireOperation, AutoHandleExpireOperation, AutoHandleExpireOperationInfo, SmsMessageTemplate, SmsMessageVariable, UserActivity, AifCreationBillActivity, AutoActivity, CallActivitySubProcess, BackWardRule, SemanticExpression, IntermediateCatchEventImpl, SignalEventDefinitionImpl, MessageActivity, NotifyActivity, ActionScope, PotentialOwnerImpl, HumanPerformerImpl, OtherAssignNodes, OperationActivity, StartActivity, UrgeHandleRule, ApprovalPivot, ApprovalPivotConfig, CheckCondition, JumpScope, ParticipantSetting, AssignPerformerConfig, ConclusionItem, ExecuteWorkItemMode, WorkFlowAction, DisplayTerminal, AssignmentStrategy, ParticipantExpression, OtherAssignActivityNodeInfo, OrganizationLevel } from '@gsp-wf/wf-process-model';
import { mxResources, mxEventObject, mxConstants, mxUtils, mxGeometry, mxEvent } from '@edp-pmf/mxgraph-ts';

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var WfProcessEditorService = /** @class */ (function () {
    function WfProcessEditorService() {
    }
    WfProcessEditorService.decorators = [
        { type: Injectable, args: [{
                    providedIn: 'root'
                },] }
    ];
    /** @nocollapse */
    WfProcessEditorService.ctorParameters = function () { return []; };
    /** @nocollapse */ WfProcessEditorService.ngInjectableDef = defineInjectable({ factory: function WfProcessEditorService_Factory() { return new WfProcessEditorService(); }, token: WfProcessEditorService, providedIn: "root" });
    return WfProcessEditorService;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/** @enum {string} */
var ProcessTime = {
    dt: 'dt',
    rt: 'rt',
};

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var FlowFormInfo = /** @class */ (function () {
    function FlowFormInfo() {
    }
    return FlowFormInfo;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/** @type {?} */
var WF_LANG_RESOURCES = new InjectionToken("WF_LANG_RESOURCES");
var WfLocalePipe = /** @class */ (function () {
    function WfLocalePipe(localeId, resources) {
        this.defaultLang = "zh-CHS";
        this.langCode = localeId || this.defaultLang;
        this.resources = resources || {};
        this.lang = resources[this.langCode] || resources[this.defaultLang] || {};
    }
    /**
     * @param {?} name
     * @return {?}
     */
    WfLocalePipe.prototype.transform = /**
     * @param {?} name
     * @return {?}
     */
    function (name) {
        var e_1, _a;
        /** @type {?} */
        var keys = name.split(".");
        /** @type {?} */
        var temp = this.lang;
        try {
            for (var keys_1 = __values(keys), keys_1_1 = keys_1.next(); !keys_1_1.done; keys_1_1 = keys_1.next()) {
                var key = keys_1_1.value;
                temp = temp[key];
                if (temp == null) {
                    break;
                }
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (keys_1_1 && !keys_1_1.done && (_a = keys_1.return)) _a.call(keys_1);
            }
            finally { if (e_1) throw e_1.error; }
        }
        return temp || name;
    };
    /**
     * @param {?} name
     * @return {?}
     */
    WfLocalePipe.prototype.instant = /**
     * @param {?} name
     * @return {?}
     */
    function (name) {
        return this.transform(name);
    };
    WfLocalePipe.decorators = [
        { type: Pipe, args: [{ name: 'wfLocale' },] }
    ];
    /** @nocollapse */
    WfLocalePipe.ctorParameters = function () { return [
        { type: String, decorators: [{ type: Optional }, { type: Inject, args: [LOCALE_ID,] }] },
        { type: undefined, decorators: [{ type: Optional }, { type: Inject, args: [WF_LANG_RESOURCES,] }] }
    ]; };
    return WfLocalePipe;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var ProcessDesignerUIState = /** @class */ (function () {
    function ProcessDesignerUIState(http, localePipe) {
        this.http = http;
        this.localePipe = localePipe;
        this.rootPath = '';
        // 入口单据Info
        this.flowFormInfo = new FlowFormInfo();
        // Model上下文
        this.content = '';
        // 属性框
        this.propertyConfig = [];
        this.propertyData = {};
        // 设计器地址
        this.POST_MESSAGE_TARGET = window.document.location.origin + this.rootPath + '/platform/runtime/wf/web/designer/index.html';
        this.schemas = [];
        // 审批活动属性
        this.counterSignVariables = [];
        this.approvalItems = [];
        // 流程的审批活动节点信息
        this.userActList = [];
        // 流程包括结束和审批活动节点的信息
        this.allActList = [];
        // 流程包括审批活动，知会活动，消息的节点信息
        this.MessageActList = [];
        this.NotifyActKist = [];
        this.SubAndCatchActList = [];
        this.enableAdminOrgAut = false;
        this.enableFlowFormAut = false;
        // 流程管理员信息
        this.isAdministratorConfig = false;
        // 审批活动属性枚举===========================================================================================
        this.assignIterator = [{ key: 'ALL', value: this.localePipe.transform("app.processDesigner.all") },
            { key: 'ASSIGN', value: this.localePipe.transform("app.processDesigner.assign") },
            { key: 'CLAIM', value: this.localePipe.transform("app.processDesigner.claim") }];
        this.completeIterator = [{ key: 'Preempt', value: this.localePipe.transform("app.processDesigner.preempt") },
            { key: 'Parallel', value: this.localePipe.transform("app.processDesigner.parallel") },
            { key: 'Sequential', value: this.localePipe.transform("app.processDesigner.sequential") }];
        this.completeIterator4Claim = [{ key: 'Preempt', value: this.localePipe.transform("app.processDesigner.preempt") }];
        this.boolIterator = [{ key: true, value: this.localePipe.transform("app.processDesigner.true") },
            { key: false, value: this.localePipe.transform("app.processDesigner.false") }];
        // 会签不允许跳转
        this.noJump4Sign = [{ key: false, value: this.localePipe.transform("app.processDesigner.false") }];
        // =================================================================================================
        // 流程实例上下文-----------------------------------------------
        this.procInstContext = [
            { key: 'dataId', name: this.localePipe.transform("app.processDesigner.dataId"), description: 'this.localePipe.transform("app.processDesigner.dataId")' },
            { key: 'procInstId', name: this.localePipe.transform("app.processDesigner.procInstId"), description: this.localePipe.transform("app.processDesigner.procInstId") },
            { key: 'bizDefKey', name: this.localePipe.transform("app.processDesigner.bizDefKey"), description: this.localePipe.transform("app.processDesigner.bizDefKey") },
            { key: 'processDefinitionKey', name: this.localePipe.transform("app.processDesigner.processDefinitionKey"), description: this.localePipe.transform("app.processDesigner.processDefinitionKey") },
            { key: 'procInstCreator', name: this.localePipe.transform("app.processDesigner.procInstCreator"), description: this.localePipe.transform("app.processDesigner.procInstCreator") },
            { key: 'businessCreator', name: this.localePipe.transform("app.processDesigner.businessCreator"), description: this.localePipe.transform("app.processDesigner.businessCreator") },
            { key: 'procInstDescription', name: this.localePipe.transform("app.processDesigner.procInstDescription"), description: this.localePipe.transform("app.processDesigner.procInstDescription") },
            { key: 'comment', name: this.localePipe.transform("app.processDesigner.comment"), description: this.localePipe.transform("app.processDesigner.comment") },
            { key: 'bizDefName', name: this.localePipe.transform("app.processDesigner.bizDefName"), description: this.localePipe.transform("app.processDesigner.bizDefName") },
            { key: 'curLoginUsername', name: this.localePipe.transform("app.processDesigner.curLoginUsername"), description: this.localePipe.transform("app.processDesigner.curLoginUsername") },
            { key: 'procInstCreatorName', name: this.localePipe.transform("app.processDesigner.procInstCreatorName"), description: this.localePipe.transform("app.processDesigner.procInstCreatorName") },
            { key: 'currentParticipantId', name: this.localePipe.transform("app.processDesigner.currentParticipantId"), description: this.localePipe.transform("app.processDesigner.currentParticipantId") },
            { key: 'currentParticipantName', name: this.localePipe.transform("app.processDesigner.currentParticipantName"), description: this.localePipe.transform("app.processDesigner.currentParticipantName") }
        ];
        // 催办上下文--------------------------------------------------
        this.urgeContext = [
            { key: 'dataId', name: this.localePipe.transform("app.processDesigner.dataId"), description: this.localePipe.transform("app.processDesigner.dataId") },
            { key: 'procInstId', name: this.localePipe.transform("app.processDesigner.procInstId"), description: this.localePipe.transform("app.processDesigner.procInstId") },
            { key: 'bizDefKey', name: this.localePipe.transform("app.processDesigner.bizDefKey"), description: this.localePipe.transform("app.processDesigner.bizDefKey") },
            { key: 'processDefinitionKey', name: this.localePipe.transform("app.processDesigner.processDefinitionKey"), description: this.localePipe.transform("app.processDesigner.processDefinitionKey") },
            { key: 'procInstCreator', name: this.localePipe.transform("app.processDesigner.procInstCreator"), description: this.localePipe.transform("app.processDesigner.procInstCreator") },
            { key: 'businessCreator', name: this.localePipe.transform("app.processDesigner.businessCreator"), description: this.localePipe.transform("app.processDesigner.businessCreator") },
            { key: 'procInstDescription', name: this.localePipe.transform("app.processDesigner.procInstDescription"), description: this.localePipe.transform("app.processDesigner.procInstDescription") },
            { key: 'comment', name: this.localePipe.transform("app.processDesigner.comment"), description: this.localePipe.transform("app.processDesigner.comment") },
            { key: 'bizDefName', name: this.localePipe.transform("app.processDesigner.bizDefName"), description: this.localePipe.transform("app.processDesigner.bizDefName") },
            { key: 'curLoginUsername', name: this.localePipe.transform("app.processDesigner.curLoginUsername"), description: this.localePipe.transform("app.processDesigner.curLoginUsername") },
            { key: 'procInstCreatorName', name: this.localePipe.transform("app.processDesigner.procInstCreatorName"), description: this.localePipe.transform("app.processDesigner.procInstCreatorName") }
        ];
        /**
         * 流程参数上下文
         */
        this.formalParameterContext = [];
        /**
         * 参与者上下文
         */
        this.participantContext = [
            {
                key: 'procInstCreator',
                name: this.localePipe.transform("app.processDesigner.procInstCreator"),
                description: this.localePipe.transform("app.processDesigner.procInstCreator")
            }, {
                key: 'businessCreator',
                name: this.localePipe.transform("app.processDesigner.businessCreator"),
                description: this.localePipe.transform("app.processDesigner.businessCreator")
            }, {
                key: 'currentUser',
                name: this.localePipe.transform("app.processDesigner.currentUser"),
                description: this.localePipe.transform("app.processDesigner.currentUser")
            }, {
                key: 'preActExecutors',
                name: this.localePipe.transform("app.processDesigner.preActExecutors"),
                description: this.localePipe.transform("app.processDesigner.preActExecutors")
            }
        ];
        /**
         * 子活动上下文
         */
        this.subActivityContext = [
            {
                key: 'collectionElementVariable',
                name: this.localePipe.transform("app.processDesigner.collectionElementVariable"),
                description: this.localePipe.transform("app.processDesigner.collectionElementVariable")
            }
        ];
        /**
         * 子流程元素上下文
         */
        this.subProcessElementContext = [
            {
                key: 'subCollectionElementVariable',
                name: this.localePipe.transform("app.processDesigner.subCollectionElementVariable"),
                description: this.localePipe.transform("app.processDesigner.subCollectionElementVariable")
            }
        ];
        /**
         * 多实例启用条件上下文
         */
        this.multiCounterSignVariables = [
            { key: 'nrOfInstances', name: this.localePipe.transform("app.processDesigner.nrOfInstances"), description: this.localePipe.transform("app.processDesigner.nrOfInstances") },
            { key: 'nrOfCompletedInstances', name: this.localePipe.transform("app.processDesigner.nrOfCompletedInstances"), description: this.localePipe.transform("app.processDesigner.nrOfCompletedInstances") },
            { key: 'nrOfActiveInstances', name: this.localePipe.transform("app.processDesigner.nrOfActiveInstances"), description: this.localePipe.transform("app.processDesigner.nrOfActiveInstances") },
            { key: 'nrOfForward', name: this.localePipe.transform("app.processDesigner.nrOfForward"), description: this.localePipe.transform("app.processDesigner.nrOfForward") },
            { key: 'nrOfBackward', name: this.localePipe.transform("app.processDesigner.nrOfBackward"), description: this.localePipe.transform("app.processDesigner.nrOfBackward") },
            { key: 'nrOfAbort', name: this.localePipe.transform("app.processDesigner.nrOfAbort"), description: this.localePipe.transform("app.processDesigner.nrOfAbort") }
        ];
        /**
         * 活动构件参数上下文
         */
        this.activityComponentContext = [
            {
                key: 'conclusionType',
                name: this.localePipe.transform("app.processDesigner.conclusionType"),
                description: this.localePipe.transform("app.processDesigner.conclusionTypeTips")
            }, {
                key: 'conclusionValue',
                name: this.localePipe.transform("app.processDesigner.conclusionValue"),
                description: this.localePipe.transform("app.processDesigner.conclusionValueTips")
            }
        ];
        this.processVariableContext = new Array();
        this.processVariables = new Array();
        /**
         * 汇报级次
         */
        this.dimensions = [
            { value: 'directSuperior', text: this.localePipe.transform("app.processDesigner.directSuperior") },
            { value: 'higherSuperior', text: this.localePipe.transform("app.processDesigner.higherSuperior") }
        ];
        /**
         * 启动方式
         */
        this.startModeIterator = [
            { key: 'DIRECT', value: this.localePipe.transform("app.processDesigner.DIRECT") },
            { key: 'EXTERNAL_PROCESS', value: this.localePipe.transform("app.processDesigner.EXTERNAL_PROCESS") },
            { key: 'SUB_PROCESS', value: this.localePipe.transform("app.processDesigner.SUB_PROCESS") }
        ];
        /**
         * 显示终端
         */
        this.displayTerminal = [
            { key: "ALL", value: this.localePipe.transform("app.processDesigner.ALL") },
            { key: "WEB", value: this.localePipe.transform("app.processDesigner.WEB") },
            { key: "APP", value: this.localePipe.transform("app.processDesigner.APP") }
        ];
        /**
         * 消息渠道列表
         */
        this.messageChannels = new Array();
        this.orgTypeCollection = [];
        try {
            this.rootPath = ((/** @type {?} */ (window))).gspframeworkService.common.getBasePath.get();
        }
        catch (error) {
        }
    }
    Object.defineProperty(ProcessDesignerUIState.prototype, "ProcessVariables", {
        get: /**
         * @return {?}
         */
        function () {
            return this.processVariables;
        },
        set: /**
         * @param {?} variables
         * @return {?}
         */
        function (variables) {
            this.processVariables = variables;
            this.setProcessVariableContext();
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @param {?} key
     * @return {?}
     */
    ProcessDesignerUIState.prototype.variableContextName = /**
     * @param {?} key
     * @return {?}
     */
    function (key) {
        return this.participantContext.find((/**
         * @param {?} i
         * @return {?}
         */
        function (i) { return i.key === key; })).name;
    };
    /**
     * @param {?} value
     * @return {?}
     */
    ProcessDesignerUIState.prototype.ranksName = /**
     * @param {?} value
     * @return {?}
     */
    function (value) {
        return this.dimensions.find((/**
         * @param {?} i
         * @return {?}
         */
        function (i) { return i.value === value; })).text;
    };
    /**
     * @return {?}
     */
    ProcessDesignerUIState.prototype.getMessageChannels = /**
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var url = '/api/runtime/msg/v1.0/messageplatform/channel/getenabledchannels';
        this.http.get(url).subscribe((/**
         * @param {?} re
         * @return {?}
         */
        function (re) {
            _this.messageChannels = re;
        }));
    };
    /**
     * @return {?}
     */
    ProcessDesignerUIState.prototype.getAdministratorInfo = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.getCurrentUser().subscribe((/**
         * @param {?} user
         * @return {?}
         */
        function (user) {
            /** @type {?} */
            var userId = user.userId;
            forkJoin(_this.getAdministratorConfig(), _this.getAdministrator(userId)).subscribe((/**
             * @param {?} re
             * @return {?}
             */
            function (re) {
                _this.isAdministratorConfig = re[0].currentValue === 'true' ? true : false;
                _this.administrator = re[1];
            }));
        }));
    };
    /**
     * @return {?}
     */
    ProcessDesignerUIState.prototype.getEnableAdminOrgAut = /**
     * @return {?}
     */
    function () {
        return this.getEnableProcessDesignerDataAut('WF_AdminOrg');
    };
    /**
     * @return {?}
     */
    ProcessDesignerUIState.prototype.getEnableFlowFormAut = /**
     * @return {?}
     */
    function () {
        return this.getEnableProcessDesignerDataAut('WF_FlowForm');
    };
    /**
     * @private
     * @param {?} authField
     * @return {?}
     */
    ProcessDesignerUIState.prototype.getEnableProcessDesignerDataAut = /**
     * @private
     * @param {?} authField
     * @return {?}
     */
    function (authField) {
        /** @type {?} */
        var url = '/api/runtime/wf/v1.0/dtProcDefs/enableProcessDesignerDataAut/' + authField;
        return this.http.get(url);
    };
    /**
     * @private
     * @return {?}
     */
    ProcessDesignerUIState.prototype.getCurrentUser = /**
     * @private
     * @return {?}
     */
    function () {
        /** @type {?} */
        var url = '/api/runtime/sys/v1.0/userinfos?infoType=user';
        return this.http.get(url);
    };
    /**
     * @private
     * @param {?} userId
     * @return {?}
     */
    ProcessDesignerUIState.prototype.getAdministrator = /**
     * @private
     * @param {?} userId
     * @return {?}
     */
    function (userId) {
        /** @type {?} */
        var url = "/api/runtime/wf/v1.0/processAdministrator/" + userId;
        return this.http.get(url);
    };
    /**
     * @return {?}
     */
    ProcessDesignerUIState.prototype.getReleaseConfig = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var url = "/api/runtime/wf/v1.0/generalConfig/Is_Enable_Examine";
        return this.http.get(url);
    };
    /**
     * @private
     * @return {?}
     */
    ProcessDesignerUIState.prototype.getAdministratorConfig = /**
     * @private
     * @return {?}
     */
    function () {
        /** @type {?} */
        var url = "/api/runtime/wf/v1.0/generalConfig/Is_EnableAdministrator";
        return this.http.get(url);
    };
    /**
     * @private
     * @param {?} orgId
     * @return {?}
     */
    ProcessDesignerUIState.prototype.getSysOrgById = /**
     * @private
     * @param {?} orgId
     * @return {?}
     */
    function (orgId) {
        /** @type {?} */
        var url = "/api/runtime/sys/v1.0/sysOrgs/" + orgId;
        return this.http.get(url);
    };
    /**
     * @private
     * @param {?} orgId
     * @return {?}
     */
    ProcessDesignerUIState.prototype.getSysOrgWithAllSubsById = /**
     * @private
     * @param {?} orgId
     * @return {?}
     */
    function (orgId) {
        /** @type {?} */
        var url = "/api/runtime/sys/v1.0/sysOrgs?param=" + encodeURIComponent("{\"parentId\":\"" + orgId + "\",\"withAllSub\":true}");
        return this.http.get(url);
    };
    /**
     * @private
     * @param {?} userId
     * @return {?}
     */
    ProcessDesignerUIState.prototype.getCurUserInfo = /**
     * @private
     * @param {?} userId
     * @return {?}
     */
    function (userId) {
        /** @type {?} */
        var url = "/api/runtime/sys/v1.0/users/" + userId;
        return this.http.get(url);
    };
    /**
     * @return {?}
     */
    ProcessDesignerUIState.prototype.getOrgConfig = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var url = "/api/runtime/wf/v1.0/generalConfig/Is_Required_Organization";
        return this.http.get(url);
    };
    /**
     * 获取当前用户信息
     */
    /**
     * 获取当前用户信息
     * @return {?}
     */
    ProcessDesignerUIState.prototype.getUserInfo = /**
     * 获取当前用户信息
     * @return {?}
     */
    function () {
        /** @type {?} */
        var url = "/api/runtime/sys/v1.0/userinfos?infoType=user";
        return this.http.get(url);
    };
    /**
     * 流程审核：新增
     */
    /**
     * 流程审核：新增
     * @return {?}
     */
    ProcessDesignerUIState.prototype.createData = /**
     * 流程审核：新增
     * @return {?}
     */
    function () {
        /** @type {?} */
        var url = "/api/bpms/wf/v1.0/processrelease_frm";
        /** @type {?} */
        var requestInfo = {
            dataChange: [],
            variableChange: null
        };
        return this.http.post(url, requestInfo);
    };
    /**
     * 流程审核：保存
     */
    /**
     * 流程审核：保存
     * @param {?} data
     * @return {?}
     */
    ProcessDesignerUIState.prototype.releaseSave = /**
     * 流程审核：保存
     * @param {?} data
     * @return {?}
     */
    function (data) {
        /** @type {?} */
        var requestInfo = {
            dataChange: [data],
            variableChange: null
        };
        /** @type {?} */
        var url = "/api/bpms/wf/v1.0/processrelease_frm";
        return this.http.put(url, requestInfo);
    };
    /**
     * @private
     * @return {?}
     */
    ProcessDesignerUIState.prototype.setProcessVariableContext = /**
     * @private
     * @return {?}
     */
    function () {
        var e_1, _a;
        this.processVariableContext = new Array();
        if (this.ProcessVariables && this.ProcessVariables.length > 0) {
            try {
                for (var _b = __values(this.ProcessVariables), _c = _b.next(); !_c.done; _c = _b.next()) {
                    var v = _c.value;
                    /** @type {?} */
                    var varEntity = {
                        key: v.name,
                        name: v.documentation,
                        description: v.description
                    };
                    this.processVariableContext.push(varEntity);
                }
            }
            catch (e_1_1) { e_1 = { error: e_1_1 }; }
            finally {
                try {
                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                }
                finally { if (e_1) throw e_1.error; }
            }
        }
    };
    /**
     * @param {?} helpId
     * @param {?} su
     * @return {?}
     */
    ProcessDesignerUIState.prototype.getHelpMetaData = /**
     * @param {?} helpId
     * @param {?} su
     * @return {?}
     */
    function (helpId, su) {
        /** @type {?} */
        var url = "/api/runtime/lcm/v1.0/rt-metadatas/" + helpId;
        return this.http.get(url);
    };
    /**
     * 获取框架的顶级window
     * 进行跨域封装
     */
    /**
     * 获取框架的顶级window
     * 进行跨域封装
     * @private
     * @return {?}
     */
    ProcessDesignerUIState.prototype.getTopWindow = /**
     * 获取框架的顶级window
     * 进行跨域封装
     * @private
     * @return {?}
     */
    function () {
        /** @type {?} */
        var curWin = window.self;
        try {
            while (curWin.location.origin === curWin.parent.location.origin) {
                if (curWin !== curWin.parent && !((/** @type {?} */ (curWin))).isRTFTopWin) {
                    curWin = curWin.parent;
                }
                else {
                    break;
                }
            }
        }
        catch (e) { }
        return curWin;
    };
    // --------------------------0-------------------------
    // uiState初始
    // --------------------------0-------------------------
    // uiState初始
    /**
     * @return {?}
     */
    ProcessDesignerUIState.prototype.initUIState = 
    // --------------------------0-------------------------
    // uiState初始
    /**
     * @return {?}
     */
    function () {
        this.propertyConfig = [];
        this.propertyData = null;
        this.content = '';
        this.schemas = [];
    };
    /**
     * 获取所有审批节点信息
     * @param data
     */
    /**
     * 获取所有审批节点信息
     * @param {?} data
     * @return {?}
     */
    ProcessDesignerUIState.prototype.getUserActList = /**
     * 获取所有审批节点信息
     * @param {?} data
     * @return {?}
     */
    function (data) {
        var e_2, _a;
        this.userActList = [];
        if (data && data.length > 0) {
            try {
                for (var data_1 = __values(data), data_1_1 = data_1.next(); !data_1_1.done; data_1_1 = data_1.next()) {
                    var userAct = data_1_1.value;
                    /** @type {?} */
                    var userActInfo = {
                        Id: userAct.Id,
                        Name: userAct.NameLanguage ? (userAct.NameLanguage[this.localePipe.langCode] ? userAct.NameLanguage[this.localePipe.langCode] : userAct.Name) : userAct.Name,
                        ClrTypeID: userAct.ClrTypeID,
                        AssignmentStrategy: userAct.AssignmentStrategy
                    };
                    if (userAct.AssignmentStrategy === 'ASSIGN') {
                        userActInfo.AssignPerformerConfig = userAct.AssignPerformerConfig;
                    }
                    this.userActList.push(userActInfo);
                }
            }
            catch (e_2_1) { e_2 = { error: e_2_1 }; }
            finally {
                try {
                    if (data_1_1 && !data_1_1.done && (_a = data_1.return)) _a.call(data_1);
                }
                finally { if (e_2) throw e_2.error; }
            }
        }
    };
    /**
     * 获取所有结束节点信息
     * @param data
     */
    /**
     * 获取所有结束节点信息
     * @param {?} data
     * @return {?}
     */
    ProcessDesignerUIState.prototype.getEndEventList = /**
     * 获取所有结束节点信息
     * @param {?} data
     * @return {?}
     */
    function (data) {
        var e_3, _a;
        this.allActList = [];
        if (data && data.length > 0) {
            try {
                for (var data_2 = __values(data), data_2_1 = data_2.next(); !data_2_1.done; data_2_1 = data_2.next()) {
                    var endEvent = data_2_1.value;
                    /** @type {?} */
                    var endEventInfo = {
                        Id: endEvent.Id,
                        Name: endEvent.Name
                    };
                    // 取结束节点存到
                    this.allActList.push(endEventInfo);
                }
            }
            catch (e_3_1) { e_3 = { error: e_3_1 }; }
            finally {
                try {
                    if (data_2_1 && !data_2_1.done && (_a = data_2.return)) _a.call(data_2);
                }
                finally { if (e_3) throw e_3.error; }
            }
        }
        // // 存入审批活动节点
        // this.allActList = this.allActList.concat(this.userActList);
    };
    /**
     * 获取所有知会活动节点信息
     * @param data
     */
    /**
     * 获取所有知会活动节点信息
     * @param {?} data
     * @return {?}
     */
    ProcessDesignerUIState.prototype.getNotifyEventList = /**
     * 获取所有知会活动节点信息
     * @param {?} data
     * @return {?}
     */
    function (data) {
        var e_4, _a;
        this.NotifyActKist = [];
        if (data && data.length > 0) {
            try {
                for (var data_3 = __values(data), data_3_1 = data_3.next(); !data_3_1.done; data_3_1 = data_3.next()) {
                    var notifyEvent = data_3_1.value;
                    /** @type {?} */
                    var notifyEventInfo = {
                        Id: notifyEvent.Id,
                        Name: notifyEvent.Name
                    };
                    // 取知会活动，消息节点存到
                    this.NotifyActKist.push(notifyEventInfo);
                }
            }
            catch (e_4_1) { e_4 = { error: e_4_1 }; }
            finally {
                try {
                    if (data_3_1 && !data_3_1.done && (_a = data_3.return)) _a.call(data_3);
                }
                finally { if (e_4) throw e_4.error; }
            }
        }
    };
    //TODO: 只有审批\审批+人工\审批+人工+知会\审批、人工、子流程、信号捕获
    /**
     * 获取所有消息节点信息
     * @param data
     */
    //TODO: 只有审批\审批+人工\审批+人工+知会\审批、人工、子流程、信号捕获
    /**
     * 获取所有消息节点信息
     * @param {?} data
     * @return {?}
     */
    ProcessDesignerUIState.prototype.getMessageEventList = 
    //TODO: 只有审批\审批+人工\审批+人工+知会\审批、人工、子流程、信号捕获
    /**
     * 获取所有消息节点信息
     * @param {?} data
     * @return {?}
     */
    function (data) {
        var e_5, _a;
        this.MessageActList = [];
        if (data && data.length > 0) {
            try {
                for (var data_4 = __values(data), data_4_1 = data_4.next(); !data_4_1.done; data_4_1 = data_4.next()) {
                    var messageEvent = data_4_1.value;
                    /** @type {?} */
                    var messageEventInfo = {
                        Id: messageEvent.Id,
                        Name: messageEvent.Name
                    };
                    // 取知会活动，消息节点存到
                    this.MessageActList.push(messageEventInfo);
                }
            }
            catch (e_5_1) { e_5 = { error: e_5_1 }; }
            finally {
                try {
                    if (data_4_1 && !data_4_1.done && (_a = data_4.return)) _a.call(data_4);
                }
                finally { if (e_5) throw e_5.error; }
            }
        }
        // 存入审批活动节点
        this.MessageActList = this.MessageActList.concat(this.NotifyActKist);
        // 存入审批活动节点
        this.MessageActList = this.MessageActList.concat(this.userActList);
    };
    /**
     * @param data
     */
    /**
     * @param {?} data
     * @return {?}
     */
    ProcessDesignerUIState.prototype.getSubAndCatchEventsList = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        var e_6, _a;
        this.SubAndCatchActList = [];
        if (data && data.length > 0) {
            try {
                for (var data_5 = __values(data), data_5_1 = data_5.next(); !data_5_1.done; data_5_1 = data_5.next()) {
                    var subAndCatchEvent = data_5_1.value;
                    /** @type {?} */
                    var subAndCatEventInfo = {
                        Id: subAndCatchEvent.Id,
                        Name: subAndCatchEvent.Name
                    };
                    // 取知会活动，消息节点存到
                    this.SubAndCatchActList.push(subAndCatEventInfo);
                }
            }
            catch (e_6_1) { e_6 = { error: e_6_1 }; }
            finally {
                try {
                    if (data_5_1 && !data_5_1.done && (_a = data_5.return)) _a.call(data_5);
                }
                finally { if (e_6) throw e_6.error; }
            }
        }
    };
    /**
     * 获取当前流程启动方式
     * @param data
     */
    /**
     * 获取当前流程启动方式
     * @param {?} data
     * @return {?}
     */
    ProcessDesignerUIState.prototype.getStartMode = /**
     * 获取当前流程启动方式
     * @param {?} data
     * @return {?}
     */
    function (data) {
        this.startMode = data;
    };
    /**
     * 添加上下文变量
     */
    /**
     * 添加上下文变量
     * @param {?} context
     * @return {?}
     */
    ProcessDesignerUIState.prototype.addContext = /**
     * 添加上下文变量
     * @param {?} context
     * @return {?}
     */
    function (context) {
        var e_7, _a, e_8, _b, e_9, _c, e_10, _d;
        if (this.procInstContext.length > 0) {
            try {
                for (var _e = __values(this.procInstContext), _f = _e.next(); !_f.done; _f = _e.next()) {
                    var variable = _f.value;
                    context.push(variable);
                }
            }
            catch (e_7_1) { e_7 = { error: e_7_1 }; }
            finally {
                try {
                    if (_f && !_f.done && (_a = _e.return)) _a.call(_e);
                }
                finally { if (e_7) throw e_7.error; }
            }
        }
        if (this.formalParameterContext.length > 0) {
            var _loop_1 = function (variable) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    context.push(variable);
                }
            };
            try {
                for (var _g = __values(this.formalParameterContext), _h = _g.next(); !_h.done; _h = _g.next()) {
                    var variable = _h.value;
                    _loop_1(variable);
                }
            }
            catch (e_8_1) { e_8 = { error: e_8_1 }; }
            finally {
                try {
                    if (_h && !_h.done && (_b = _g.return)) _b.call(_g);
                }
                finally { if (e_8) throw e_8.error; }
            }
        }
        if (this.participantContext.length > 0) {
            var _loop_2 = function (variable) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    context.push(variable);
                }
            };
            try {
                for (var _j = __values(this.participantContext), _k = _j.next(); !_k.done; _k = _j.next()) {
                    var variable = _k.value;
                    _loop_2(variable);
                }
            }
            catch (e_9_1) { e_9 = { error: e_9_1 }; }
            finally {
                try {
                    if (_k && !_k.done && (_c = _j.return)) _c.call(_j);
                }
                finally { if (e_9) throw e_9.error; }
            }
        }
        if (this.processVariableContext.length > 0) {
            var _loop_3 = function (variable) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    context.push(variable);
                }
            };
            try {
                for (var _l = __values(this.processVariableContext), _m = _l.next(); !_m.done; _m = _l.next()) {
                    var variable = _m.value;
                    _loop_3(variable);
                }
            }
            catch (e_10_1) { e_10 = { error: e_10_1 }; }
            finally {
                try {
                    if (_m && !_m.done && (_d = _l.return)) _d.call(_l);
                }
                finally { if (e_10) throw e_10.error; }
            }
        }
        return context;
    };
    ProcessDesignerUIState.decorators = [
        { type: Injectable }
    ];
    /** @nocollapse */
    ProcessDesignerUIState.ctorParameters = function () { return [
        { type: HttpService },
        { type: WfLocalePipe }
    ]; };
    return ProcessDesignerUIState;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var ProcessDeUtil = /** @class */ (function () {
    function ProcessDeUtil() {
    }
    /**
     * @return {?}
     */
    ProcessDeUtil.GenerateElementId = /**
     * @return {?}
     */
    function () {
        return BpmnModelHelper.GenerateElementId();
    };
    /**
     * 创建内码
     */
    /**
     * 创建内码
     * @return {?}
     */
    ProcessDeUtil.createNM = /**
     * 创建内码
     * @return {?}
     */
    function () {
        /**
         * @return {?}
         */
        function S4() {
            return (((1 + Math.random()) * 0x10000) | 0).toString(16).substring(1);
        }
        return (S4() + S4() + '-' + S4() + '-' + S4() + '-' + S4() + '-' + S4() + S4() + S4());
    };
    /**
     * @param {?} value
     * @return {?}
     */
    ProcessDeUtil.initVariableType = /**
     * @param {?} value
     * @return {?}
     */
    function (value) {
        if (value) {
            if (value.length >= 8 && value.slice(0, 8) === "{\"expr\":") {
                return 'expression';
            }
            else {
                return 'constant';
            }
        }
        else {
            return 'variable';
        }
    };
    /**
     * @return {?}
     */
    ProcessDeUtil.prototype.getProcessDesignerRouter = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var url = 'processList';
        return url;
    };
    // 获取流程分类webapi
    // 获取流程分类webapi
    /**
     * @return {?}
     */
    ProcessDeUtil.prototype.getFlowFormWebApi = 
    // 获取流程分类webapi
    /**
     * @return {?}
     */
    function () {
        return '/api/runtime/wf/v1.0/flowForm';
    };
    // 获取参数列表webapi
    // 获取参数列表webapi
    /**
     * @return {?}
     */
    ProcessDeUtil.prototype.getFormalParametersWebApi = 
    // 获取参数列表webapi
    /**
     * @return {?}
     */
    function () {
        return '/api/runtime/wf/v1.0/formalParameter';
    };
    // 获取运行时元数据webapi
    // 获取运行时元数据webapi
    /**
     * @return {?}
     */
    ProcessDeUtil.prototype.getMetaDataRUWebApi = 
    // 获取运行时元数据webapi
    /**
     * @return {?}
     */
    function () {
        return '/api/runtime/lcm/v1.0/rt-metadatas/';
    };
    // 获取流程构件webapi
    // 获取流程构件webapi
    /**
     * @return {?}
     */
    ProcessDeUtil.prototype.getBizComponentsWebApi = 
    // 获取流程构件webapi
    /**
     * @return {?}
     */
    function () {
        return '/api/runtime/wf/v1.0/bizComponent';
    };
    // 基于流程分类获取表单定义
    // 基于流程分类获取表单定义
    /**
     * @return {?}
     */
    ProcessDeUtil.prototype.getExcuteFormsWebApi = 
    // 基于流程分类获取表单定义
    /**
     * @return {?}
     */
    function () {
        return '/api/runtime/wf/v1.0/excuteForm';
    };
    // 获取设计时流程定义WebAPi
    // 获取设计时流程定义WebAPi
    /**
     * @return {?}
     */
    ProcessDeUtil.prototype.getProcessDefinitionWebApi = 
    // 获取设计时流程定义WebAPi
    /**
     * @return {?}
     */
    function () {
        return '/api/runtime/wf/v1.0/dtProcDefs';
    };
    // 判断是否允许删除流程定义的api
    // 判断是否允许删除流程定义的api
    /**
     * @return {?}
     */
    ProcessDeUtil.prototype.getCheckExistActiveProcDefApi = 
    // 判断是否允许删除流程定义的api
    /**
     * @return {?}
     */
    function () {
        return '/api/runtime/wf/v1.0/procDefs/checkExistActiveProcDef';
    };
    /**
     * 获取业务活动webApi
     */
    /**
     * 获取业务活动webApi
     * @param {?} ffId
     * @return {?}
     */
    ProcessDeUtil.prototype.getBizActivityWebApi = /**
     * 获取业务活动webApi
     * @param {?} ffId
     * @return {?}
     */
    function (ffId) {
        return "/api/runtime/wf/v1.0/bizActivity?flowFormKey=" + ffId;
    };
    /**
     * @return {?}
     */
    ProcessDeUtil.prototype.getProcDefKeyWebApi = /**
     * @return {?}
     */
    function () {
        return '/api/runtime/wf/v1.0/procDefs/processDefinitionKeys';
    };
    /**
     * 发布流程api
     */
    /**
     * 发布流程api
     * @return {?}
     */
    ProcessDeUtil.prototype.deployWebApi = /**
     * 发布流程api
     * @return {?}
     */
    function () {
        return '/api/runtime/wf/v1.0/procDefs/deploy';
    };
    /**
     * 保存流程api
     */
    /**
     * 保存流程api
     * @return {?}
     */
    ProcessDeUtil.prototype.saveWebApi = /**
     * 保存流程api
     * @return {?}
     */
    function () {
        return '/api/runtime/wf/v1.0/DTProcessDefinitions/SaveBpmnModel';
    };
    /**
     * 获取审批动作webapi
     */
    /**
     * 获取审批动作webapi
     * @return {?}
     */
    ProcessDeUtil.prototype.getApprovalActionWebApi = /**
     * 获取审批动作webapi
     * @return {?}
     */
    function () {
        return '/api/runtime/wf/v1.0/approvalAction';
    };
    /**
     * 获取运行时流程定义WebAPi
     */
    /**
     * 获取运行时流程定义WebAPi
     * @return {?}
     */
    ProcessDeUtil.prototype.getRTProcessDefinitionWebApi = /**
     * 获取运行时流程定义WebAPi
     * @return {?}
     */
    function () {
        return '/api/runtime/wf/v1.0/procDefs';
    };
    /**
     * @param {?} data
     * @param {?} code
     * @return {?}
     */
    ProcessDeUtil.prototype.getValue = /**
     * @param {?} data
     * @param {?} code
     * @return {?}
     */
    function (data, code) {
        if (!code) {
            return '';
        }
        /** @type {?} */
        var resultVal = '';
        if (code.indexOf('.') === -1) {
            resultVal = data[code];
        }
        else {
            resultVal = code.split('.').reduce((/**
             * @param {?} obj
             * @param {?} key
             * @return {?}
             */
            function (obj, key) {
                if (obj) {
                    return obj[key];
                }
                else {
                    return null;
                }
            }), data);
        }
        return resultVal;
    };
    /**
     * 转换
     * @param jsonObj Object
     */
    /**
     * 转换
     * @param {?} jsonObj Object
     * @return {?}
     */
    ProcessDeUtil.prototype.toUpperCase = /**
     * 转换
     * @param {?} jsonObj Object
     * @return {?}
     */
    function (jsonObj) {
        var e_1, _a;
        if (typeof (jsonObj) === 'object') {
            try {
                for (var _b = __values(Object.keys(jsonObj)), _c = _b.next(); !_c.done; _c = _b.next()) {
                    var key = _c.value;
                    jsonObj[key.substring(0, 1).toUpperCase() + key.substring(1)] = jsonObj[key];
                    delete (jsonObj[key]);
                }
            }
            catch (e_1_1) { e_1 = { error: e_1_1 }; }
            finally {
                try {
                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                }
                finally { if (e_1) throw e_1.error; }
            }
        }
        return jsonObj;
    };
    /**
     * @param {?} jsonObj
     * @return {?}
     */
    ProcessDeUtil.prototype.toLowCase = /**
     * @param {?} jsonObj
     * @return {?}
     */
    function (jsonObj) {
        var e_2, _a;
        if (typeof (jsonObj) === 'object') {
            try {
                for (var _b = __values(Object.keys(jsonObj)), _c = _b.next(); !_c.done; _c = _b.next()) {
                    var key = _c.value;
                    if ((key.substring(0, 1).toLowerCase() + key.substring(1)) !== key) {
                        jsonObj[key.substring(0, 1).toLowerCase() + key.substring(1)] = jsonObj[key];
                        delete (jsonObj[key]);
                    }
                }
            }
            catch (e_2_1) { e_2 = { error: e_2_1 }; }
            finally {
                try {
                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                }
                finally { if (e_2) throw e_2.error; }
            }
        }
        return jsonObj;
    };
    ProcessDeUtil.decorators = [
        { type: Injectable }
    ];
    /** @nocollapse */
    ProcessDeUtil.ctorParameters = function () { return []; };
    return ProcessDeUtil;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var ProcessDesignerDataService = /** @class */ (function () {
    function ProcessDesignerDataService(http, util) {
        this.http = http;
        this.util = util;
    }
    // 基于流程分类ID获取流程分类信息
    // 基于流程分类ID获取流程分类信息
    /**
     * @param {?} id
     * @return {?}
     */
    ProcessDesignerDataService.prototype.GetFlowFormbyId = 
    // 基于流程分类ID获取流程分类信息
    /**
     * @param {?} id
     * @return {?}
     */
    function (id) {
        if (id) {
            /** @type {?} */
            var url = this.util.getFlowFormWebApi() + '/getFlowForm';
            url += "/" + id;
            return this.http.get(url);
        }
    };
    // 基于流程分类获取参数列表
    // 基于流程分类获取参数列表
    /**
     * @param {?} id
     * @return {?}
     */
    ProcessDesignerDataService.prototype.getParametersbyFlowFormKey = 
    // 基于流程分类获取参数列表
    /**
     * @param {?} id
     * @return {?}
     */
    function (id) {
        if (id) {
            /** @type {?} */
            var url = this.util.getFormalParametersWebApi();
            url += "?flowFormKey=" + id;
            return this.http.get(url);
        }
    };
    // 基于流程分类获取流程构件
    // 基于流程分类获取流程构件
    /**
     * @param {?} id
     * @return {?}
     */
    ProcessDesignerDataService.prototype.getComponentsbyFlowformkey = 
    // 基于流程分类获取流程构件
    /**
     * @param {?} id
     * @return {?}
     */
    function (id) {
        if (id) {
            /** @type {?} */
            var url = this.util.getBizComponentsWebApi();
            url += "/query?param=" + encodeURIComponent("{\"flowFormKey\":\"" + id + "\"}");
            return this.http.get(url);
        }
    };
    // 基于流程分类获取表单定义
    // 基于流程分类获取表单定义
    /**
     * @param {?} id
     * @return {?}
     */
    ProcessDesignerDataService.prototype.getExecuteFormbyFlowFormKey = 
    // 基于流程分类获取表单定义
    /**
     * @param {?} id
     * @return {?}
     */
    function (id) {
        if (id) {
            /** @type {?} */
            var url = this.util.getExcuteFormsWebApi();
            url += "?flowFormKey=" + id;
            return this.http.get(url);
        }
    };
    /**
     * 基于流程分类Id获取业务活动
     * @param ffId 流程分类id
     */
    /**
     * 基于流程分类Id获取业务活动
     * @param {?} ffId 流程分类id
     * @return {?}
     */
    ProcessDesignerDataService.prototype.getBizActivities = /**
     * 基于流程分类Id获取业务活动
     * @param {?} ffId 流程分类id
     * @return {?}
     */
    function (ffId) {
        if (ffId) {
            /** @type {?} */
            var url = this.util.getBizActivityWebApi(ffId);
            return this.http.get(url);
            // .pipe(
            //     map((re: any) => re),
            //     mergeMap((activities: any[]) => {
            //         if (activities && activities.length > 0) {
            //             return forkJoin(activities.map(activity => {
            //                 return forkJoin(this.getBizActivityComponents(ffId, activity.id),
            //                     this.getBizActivityActions(activity.id))
            //                     .pipe(
            //                         map((re: any[]) => {
            //                             activity.components = re[0];
            //                             activity.actions = re[1];
            //                             return activity;
            //                         }));
            //             }));
            //         } else {
            //             return of([]);
            //         }
            //     })
            // );
        }
    };
    /**
     * 基于流程分类ID获取自定义动作
     * @param formId 流程分类ID
     */
    /**
     * 基于流程分类ID获取自定义动作
     * @param {?} formId 流程分类ID
     * @return {?}
     */
    ProcessDesignerDataService.prototype.getCustomizeActions = /**
     * 基于流程分类ID获取自定义动作
     * @param {?} formId 流程分类ID
     * @return {?}
     */
    function (formId) {
        if (formId) {
            /** @type {?} */
            var url = "/api/runtime/wf/v1.0/customizeAction?flowFormKey=" + formId;
            return this.http.get(url);
        }
    };
    /**
     * 基于业务活动id获取业务活动构件
     * @param id 业务活动id
     */
    /**
     * 基于业务活动id获取业务活动构件
     * @private
     * @param {?} flowFormId
     * @param {?} id 业务活动id
     * @return {?}
     */
    ProcessDesignerDataService.prototype.getBizActivityComponents = /**
     * 基于业务活动id获取业务活动构件
     * @private
     * @param {?} flowFormId
     * @param {?} id 业务活动id
     * @return {?}
     */
    function (flowFormId, id) {
        if (id) {
            /** @type {?} */
            var url = this.util.getBizComponentsWebApi();
            url += "/query?param=" + encodeURIComponent("{\"flowFormKey\":\"" + flowFormId + "\",\"owner\":\"" + id + "\",\"ownerType\":\"Activity\"}");
            return this.http.get(url);
        }
    };
    /**
     * @private
     * @param {?} id
     * @return {?}
     */
    ProcessDesignerDataService.prototype.getBizActivityActions = /**
     * @private
     * @param {?} id
     * @return {?}
     */
    function (id) {
        if (id) {
            /** @type {?} */
            var url = this.util.getApprovalActionWebApi();
            url += "?bizActivityId=" + id;
            return this.http.get(url);
        }
    };
    // 基于ID获取BE
    // 基于ID获取BE
    /**
     * @param {?} id
     * @return {?}
     */
    ProcessDesignerDataService.prototype.getBusinessEntitybyId = 
    // 基于ID获取BE
    /**
     * @param {?} id
     * @return {?}
     */
    function (id) {
        if (id) {
            // let url = this.util.getMetaDataRUWebApi();
            // url += id;
            // const url = `/api/runtime/lcm/v1.0/bef/handledBeMeta?beId=${id}`;
            /** @type {?} */
            var url = "/api/runtime/lcm/v1.0/bef/expression?beId=" + id;
            return this.http.get(url);
        }
    };
    /**
     * 基于流程定义Key获取上下文
     * @param key 流程定义key
     */
    /**
     * 基于流程定义Key获取上下文
     * @param {?} key 流程定义key
     * @return {?}
     */
    ProcessDesignerDataService.prototype.getProcContentbyKey = /**
     * 基于流程定义Key获取上下文
     * @param {?} key 流程定义key
     * @return {?}
     */
    function (key) {
        if (key) {
            /** @type {?} */
            var url = this.util.getProcessDefinitionWebApi();
            url += "/bpmnModel?procDefKey=" + key;
            return this.http.get(url);
        }
    };
    /**
     * 基于流程定义Key获取上下文
     * @param key 流程定义Id
     */
    /**
     * 基于流程定义Key获取上下文
     * @param {?} id
     * @return {?}
     */
    ProcessDesignerDataService.prototype.getRTProcContentbyId = /**
     * 基于流程定义Key获取上下文
     * @param {?} id
     * @return {?}
     */
    function (id) {
        if (id) {
            /** @type {?} */
            var url = this.util.getRTProcessDefinitionWebApi();
            url += "/" + id + "/bpmnModel";
            return this.http.get(url);
        }
    };
    /**
     * 保存流程
     * @param content
     */
    /**
     * 保存流程
     * @param {?} content
     * @param {?} processInfo
     * @param {?} state
     * @return {?}
     */
    ProcessDesignerDataService.prototype.saveProcess = /**
     * 保存流程
     * @param {?} content
     * @param {?} processInfo
     * @param {?} state
     * @return {?}
     */
    function (content, processInfo, state) {
        if (content) {
            /** @type {?} */
            var postData = {
                organization: processInfo.procOrg ? processInfo.procOrg.orgId : '',
                organizationName: processInfo.procOrg ? processInfo.procOrg.orgName : '',
                accessLevel: processInfo.accessLevel,
                procContent: content,
                state: state
            };
            /** @type {?} */
            var url = this.util.getProcessDefinitionWebApi();
            return this.http.post(url, JSON.stringify(postData));
        }
    };
    /**
     * @param {?} info
     * @return {?}
     */
    ProcessDesignerDataService.prototype.auditProcessDef = /**
     * @param {?} info
     * @return {?}
     */
    function (info) {
        /** @type {?} */
        var url = '/api/runtime/wf/v1.0/dtProcDefs/auditProcessDef';
        this.http.post(url, info).subscribe((/**
         * @param {?} re
         * @return {?}
         */
        function (re) { }));
    };
    /**
     * 发布流程
     * @param content
     */
    /**
     * 发布流程
     * @param {?} content
     * @return {?}
     */
    ProcessDesignerDataService.prototype.deployProcess = /**
     * 发布流程
     * @param {?} content
     * @return {?}
     */
    function (content) {
        if (content) {
            /** @type {?} */
            var postData = {
                procDefContent: content
            };
            /** @type {?} */
            var url = this.util.deployWebApi();
            return this.http.post(url, JSON.stringify(postData));
        }
    };
    /**
     * @param {?} content
     * @param {?} procDefId
     * @return {?}
     */
    ProcessDesignerDataService.prototype.saveRTProcess = /**
     * @param {?} content
     * @param {?} procDefId
     * @return {?}
     */
    function (content, procDefId) {
        if (content) {
            /** @type {?} */
            var postData = {
                procDefContent: content
            };
            /** @type {?} */
            var url = this.util.getRTProcessDefinitionWebApi();
            url += "/" + procDefId + "/adjust";
            return this.http.post(url, JSON.stringify(postData));
        }
    };
    /**
     * @param {?} content
     * @param {?} rtProcessInfo
     * @return {?}
     */
    ProcessDesignerDataService.prototype.syncDtProcess = /**
     * @param {?} content
     * @param {?} rtProcessInfo
     * @return {?}
     */
    function (content, rtProcessInfo) {
        if (content) {
            /** @type {?} */
            var postData = {
                organization: rtProcessInfo.procOrg ? rtProcessInfo.procOrg.orgId : '',
                organizationName: rtProcessInfo.procOrg ? rtProcessInfo.procOrg.orgName : '',
                accessLevel: rtProcessInfo.accessLevel || 'public',
                procContent: content,
                state: 0
            };
            /** @type {?} */
            var url = '/api/runtime/wf/v1.0/dtProcDefs';
            return this.http.post(url, JSON.stringify(postData));
        }
    };
    /**
     * 获取流程扩展属性
     * @param bizDefKey
     * @param startMode
     * @param bizCategoryId
     * @returns
     */
    /**
     * 获取流程扩展属性
     * @param {?} bizDefKey
     * @param {?} startMode
     * @param {?} bizCategoryId
     * @return {?}
     */
    ProcessDesignerDataService.prototype.getProcExtendProperty = /**
     * 获取流程扩展属性
     * @param {?} bizDefKey
     * @param {?} startMode
     * @param {?} bizCategoryId
     * @return {?}
     */
    function (bizDefKey, startMode, bizCategoryId) {
        /** @type {?} */
        var filter = '{';
        filter += "\"bizDefKey\":\"" + bizDefKey + "\",";
        filter += "\"bizCategoryId\":\"" + bizCategoryId + "\",";
        filter += "\"startMode\":\"" + startMode + "\"";
        filter += '}';
        filter = encodeURIComponent(filter);
        /** @type {?} */
        var url = "/api/runtime/wf/v1.0/procExtendProperty?param=" + filter;
        return this.http.get(url);
    };
    /**
     * 获取流程构件
     * @returns
     */
    /**
     * 获取流程构件
     * @return {?}
     */
    ProcessDesignerDataService.prototype.getBizCmp = /**
     * 获取流程构件
     * @return {?}
     */
    function () {
        /** @type {?} */
        var url = "/api/runtime/wf/v1.0/bizComponent?flowFormKey=*&owner=*&ownerType=Process";
        return this.http.get(url);
    };
    /**
     * 获取全部流程构件
     * @param flowFormKey
     * @returns
     */
    /**
     * 获取全部流程构件
     * @param {?} flowFormKey
     * @return {?}
     */
    ProcessDesignerDataService.prototype.getAllBizCmp = /**
     * 获取全部流程构件
     * @param {?} flowFormKey
     * @return {?}
     */
    function (flowFormKey) {
        /** @type {?} */
        var url = "/api/runtime/wf/v1.0/bizComponent?flowFormKey=" + flowFormKey + "&owner=" + flowFormKey + "&ownerType=Process";
        return this.http.get(url);
    };
    /**
     * 获取表单格式
     */
    /**
     * 获取表单格式
     * @param {?} bizCategoryId
     * @return {?}
     */
    ProcessDesignerDataService.prototype.getFormFormat = /**
     * 获取表单格式
     * @param {?} bizCategoryId
     * @return {?}
     */
    function (bizCategoryId) {
        if (bizCategoryId == null) {
            return of(null);
        }
        /** @type {?} */
        var url = "/api/runtime/wf/v1.0/formFormat/query?param=%7B%22bizCategory%22%3A%22" + bizCategoryId + "%22%7D";
        return this.http.get(url);
    };
    /**
     * 获取配置
     * @returns
     */
    /**
     * 获取配置
     * @return {?}
     */
    ProcessDesignerDataService.prototype.getGeneralConfig = /**
     * 获取配置
     * @return {?}
     */
    function () {
        var _this = this;
        return this.http.get("/api/runtime/wf/v1.0/generalConfig/Is_EnableTransfer").pipe(switchMap((/**
         * @param {?} enableTransfer
         * @return {?}
         */
        function (enableTransfer) {
            return _this.http.get("/api/runtime/wf/v1.0/generalConfig/Is_EnableNotify").pipe(switchMap((/**
             * @param {?} enableNotify
             * @return {?}
             */
            function (enableNotify) {
                return _this.http.get("/api/runtime/wf/v1.0/generalConfig/Is_EnableAddSignBehind").pipe(switchMap((/**
                 * @param {?} enableAddSignBehind
                 * @return {?}
                 */
                function (enableAddSignBehind) {
                    return _this.http.get("/api/runtime/wf/v1.0/generalConfig/Is_EnableAddSignFront").pipe(switchMap((/**
                     * @param {?} enableAddSignFront
                     * @return {?}
                     */
                    function (enableAddSignFront) {
                        /** @type {?} */
                        var res = {
                            enableTransfer: JSON.parse(enableTransfer.currentValue),
                            enableNotify: JSON.parse(enableNotify.currentValue),
                            enableAddSignBehind: JSON.parse(enableAddSignBehind.currentValue),
                            enableAddSignFront: JSON.parse(enableAddSignFront.currentValue)
                        };
                        return of(res);
                    })));
                })));
            })));
        })));
    };
    ProcessDesignerDataService.decorators = [
        { type: Injectable }
    ];
    /** @nocollapse */
    ProcessDesignerDataService.ctorParameters = function () { return [
        { type: HttpService },
        { type: ProcessDeUtil }
    ]; };
    return ProcessDesignerDataService;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/** @enum {string} */
var ProcessClrTypeID = {
    /**
     * 流程typeId
     */
    process: 'bpmn.Process',
    /**
     * 开始活动typeId
     */
    startActivity: 'wf.StartActivity',
    /**
     * 活动节点typeId
     */
    userActivity: 'wf.UserActivity',
    /**
     * 人工操作typeId
     */
    operationActivity: 'wf.OperationActivity',
    /**
     * 结束活动typeId
     */
    endEvent: 'bpmn.EndEvent',
    /**
     * 流转线typeId
     */
    sequenceFlow: 'bpmn.SequenceFlow',
    /**
     * 排他网关typeId
     */
    exclusiveGateway: 'bpmn.ExclusiveGateway',
    /**
     * 并行网关typeId
     */
    parallelGateway: 'bpmn.ParallelGateway',
    /**
     * 子流程
     */
    subProcess: 'wf.CallActivitySubProcess',
    /**
     * 服务活动
     */
    autoActivity: 'wf.AutoActivity',
    /**
     * 信号捕获
     */
    catchEvent: 'wf.IntermediateCatchEventImpl',
    /**
     * 消息
     */
    messageActivity: 'wf.MessageActivity',
    /**
     * 知会活动
     */
    notifyActivity: "wf.NotifyActivity",
    /**
     * 生单活动
     */
    aifCreationBillActivity: "wf.AifCreationBillActivity",
    billNodeActivity: "wf.AifBillNodeActivity",
    sequenceActivity: "wf.AifSequenceActivity",
};

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var EntryFormEditorComponent = /** @class */ (function () {
    function EntryFormEditorComponent(http, message, cdr, localeId, resources, localePipe) {
        this.http = http;
        this.message = message;
        this.cdr = cdr;
        this.localeId = localeId;
        this.resources = resources;
        this.localePipe = localePipe;
        this.closeModal = new EventEmitter();
        this.submitModal = new EventEmitter();
        this.editorParams = {};
        this.modalConfig = {
            title: this.localePipe.transform('component.entryFormEditor.flowForm'),
            width: 760,
            height: 506,
            showButtons: true
        };
        this.columns = [
            { title: this.localePipe.transform('component.entryFormEditor.code'), field: 'code', width: 100, sortable: true },
            { title: this.localePipe.transform('component.entryFormEditor.name'), field: 'name', width: 100, sortable: true },
            { title: this.localePipe.transform('component.entryFormEditor.base'), field: 'base', width: 60,
                formatter: { type: 'boolean', options: { trueText: this.localePipe.transform('component.entryFormEditor.extend'), falseText: this.localePipe.transform('component.entryFormEditor.foundation') } } }
        ];
        this.data = [];
        this.localePipe = this.localePipe || new WfLocalePipe(localeId, resources);
    }
    Object.defineProperty(EntryFormEditorComponent.prototype, "value", {
        set: /**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            if (data) {
                this.flowFormId = data.id;
            }
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    EntryFormEditorComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        this.getBaseAndExtendFlowForm();
    };
    /**
     * @return {?}
     */
    EntryFormEditorComponent.prototype.ngAfterViewInit = /**
     * @return {?}
     */
    function () {
    };
    /**
     * @return {?}
     */
    EntryFormEditorComponent.prototype.clickOK = /**
     * @return {?}
     */
    function () {
        if (!this.grid.selectedRow) {
            this.message.info(this.localePipe.transform('component.entryFormEditor.selectedRow'));
            return;
        }
        /** @type {?} */
        var object = { value: this.grid.selectedRow.data, parameters: null };
        this.submitModal.emit(object);
    };
    /**
     * @return {?}
     */
    EntryFormEditorComponent.prototype.clickCancel = /**
     * @return {?}
     */
    function () {
        this.closeModal.emit();
    };
    /**
     * @private
     * @return {?}
     */
    EntryFormEditorComponent.prototype.getBaseAndExtendFlowForm = /**
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        if (this.flowFormId) {
            /** @type {?} */
            var url = "/api/runtime/wf/v1.0/flowForm/" + this.flowFormId + "/baseAndExtend";
            this.http.get(url).subscribe((/**
             * @param {?} re
             * @return {?}
             */
            function (re) {
                if (re && re.length > 0) {
                    _this.data = re;
                    setTimeout((/**
                     * @return {?}
                     */
                    function () {
                        _this.grid.selectRow(_this.flowFormId, true);
                    }), 0);
                }
                else {
                    _this.message.info(_this.localePipe.transform('component.entryFormEditor.absent'));
                }
            }));
        }
    };
    EntryFormEditorComponent.decorators = [
        { type: Component, args: [{
                    selector: 'app-entry-form-editor',
                    template: "<div class=\"f-page\">\r\n  <div class=\"f-page-main f-utils-fill-flex-column h-100\">\r\n    <div class=\"f-utils-fill-flex-column farris-overflow-y-auto h-100\" style=\"border-radius:16px;border: 1.5px solid #F1F3F7;margin-left: 6px;margin-right: 6px;\">\r\n      <farris-datagrid #grid [data]=\"data\" [columns]=\"columns\" [idField]=\"'id'\" [fit]=\"true\" [fitColumns]=\"true\"\r\n         [pagination]=\"false\" [showCheckbox]=\"false\" [multiSelect]=\"false\" [showLineNumber]=\"true\" lineNumberTitle=\"{{'component.entryFormEditor.lineNumber' | wfLocale}}\"\r\n         [lineNumberWidth]=\"50\">\r\n      </farris-datagrid>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n\r\n<ng-template #iconSelectFooter>\r\n    <button type=\"button\" class=\"btn btn-secondary btn-sm px-3\" (click)=\"clickCancel()\">{{'component.entryFormEditor.clickCancel' | wfLocale}}</button>\r\n    <button type=\"button\" class=\"btn btn-primary btn-sm px-3 mx-2\" (click)=\"clickOK()\">{{'component.entryFormEditor.clickOK' | wfLocale}}</button>\r\n</ng-template>\r\n",
                    providers: [
                        WfLocalePipe,
                    ],
                    styles: [""]
                }] }
    ];
    /** @nocollapse */
    EntryFormEditorComponent.ctorParameters = function () { return [
        { type: HttpService },
        { type: MessagerService },
        { type: ChangeDetectorRef, decorators: [{ type: Optional }] },
        { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
        { type: undefined, decorators: [{ type: Inject, args: [WF_LANG_RESOURCES,] }] },
        { type: WfLocalePipe, decorators: [{ type: Optional }] }
    ]; };
    EntryFormEditorComponent.propDecorators = {
        closeModal: [{ type: Output }],
        submitModal: [{ type: Output }],
        value: [{ type: Input }],
        modalFooter: [{ type: ViewChild, args: ['iconSelectFooter',] }],
        grid: [{ type: ViewChild, args: ['grid',] }],
        editorParams: [{ type: Input }]
    };
    return EntryFormEditorComponent;
}());
var FlowFormConverter = /** @class */ (function () {
    function FlowFormConverter() {
    }
    /**
     * @param {?} data
     * @return {?}
     */
    FlowFormConverter.prototype.convertTo = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        if (data) {
            return data.name;
        }
    };
    return FlowFormConverter;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var ActivityComponentUIState = /** @class */ (function () {
    function ActivityComponentUIState(localePipe) {
        this.localePipe = localePipe;
        /**
         * 构件列表
         */
        this.components = [];
        /**
         * 流程分类绑定的所有活动构件
         */
        this.allComponents = [];
        /**
         * 构件执行时机数据绑定
         */
        this.executionCollection = [
            // { text: '流程创建', value: 'PROCESSINSTANCE_CREATED' },
            { text: this.localePipe.transform("component.activityComponent.PROCESSINSTANCE_STARTED"), value: 'PROCESSINSTANCE_STARTED' },
            { text: this.localePipe.transform("component.activityComponent.PROCESSINSTANCE_SUSPENDED"), value: 'PROCESSINSTANCE_SUSPENDED' },
            { text: this.localePipe.transform("component.activityComponent.PROCESSINSTANCE_RESUMED"), value: 'PROCESSINSTANCE_RESUMED' },
            { text: this.localePipe.transform("component.activityComponent.PROCESSINSTANCE_COMPLETED"), value: 'PROCESSINSTANCE_COMPLETED' },
            { text: this.localePipe.transform("component.activityComponent.PROCESSINSTANCE_ABORTED"), value: 'PROCESSINSTANCE_ABORTED' },
            // { text: '流程预警', value: 'PROCESSINSTANCE_ALARM' },
            // { text: '流程超时', value: 'PROCESSINSTANCE_TIMEOUT' },
            // { text: '流程删除', value: 'PROCESSINSTANCE_DELETED' },
            { text: this.localePipe.transform("component.activityComponent.PROCESSINSTANCE_CANCELED"), value: 'PROCESSINSTANCE_CANCELED' },
            { text: this.localePipe.transform("component.activityComponent.PROCESSINSTANCE_REACTIVATED"), value: 'PROCESSINSTANCE_REACTIVATED' },
            { text: this.localePipe.transform("component.activityComponent.PROCESSINSTANCE_ROLLBACK"), value: 'PROCESSINSTANCE_ROLLBACK' },
            { text: this.localePipe.transform("component.activityComponent.PROCESSINSTANCE_RESUBMIT"), value: 'PROCESSINSTANCE_RESUBMIT' },
            { text: this.localePipe.transform("component.activityComponent.ACTIVITY_AND_PARTICIPANT_UPDATED"), value: 'ACTIVITY_AND_PARTICIPANT_UPDATED' },
            { text: this.localePipe.transform("component.activityComponent.PROCESSINSTANCE_ABORTED_BY_ADMIN"), value: 'PROCESSINSTANCE_ABORTED_BY_ADMIN' },
            { text: this.localePipe.transform("component.activityComponent.PROCESSINSTANCE_BEFORE_START"), value: 'PROCESSINSTANCE_BEFORE_START' },
            { text: this.localePipe.transform("component.activityComponent.WORKITEM_BEFORE_COMPLETE"), value: 'WORKITEM_BEFORE_COMPLETE' },
            { text: this.localePipe.transform("component.activityComponent.WORKITEM_AFTER_COMPLETE"), value: 'WORKITEM_AFTER_COMPLETE' },
            { text: this.localePipe.transform("component.activityComponent.LOADDATA"), value: 'LOADDATA' }
        ];
        this.activityCollection = [
            // { text: '活动创建', value: 'ACTIVITY_CREATED' },
            { text: this.localePipe.transform("component.activityComponent.ACTIVITY_STARTED"), value: 'ACTIVITY_STARTED' },
            // { text: '活动挂起', value: 'ACTIVITY_SUSPENDED' },
            // { text: '活动恢复', value: 'ACTIVITY_RESUMED' },
            { text: this.localePipe.transform("component.activityComponent.ACTIVITY_COMPLETED"), value: 'ACTIVITY_COMPLETED' },
            { text: this.localePipe.transform("component.activityComponent.ACTIVITY_ABORTED"), value: 'ACTIVITY_ABORTED' },
            { text: this.localePipe.transform("component.activityComponent.WORKITEM_CREATED"), value: 'WORKITEM_CREATED' },
            { text: this.localePipe.transform("component.activityComponent.WORKITEM_COMPLETED"), value: 'WORKITEM_COMPLETED' },
            { text: this.localePipe.transform("component.activityComponent.WORKITEM_SUSPENDED"), value: 'WORKITEM_SUSPENDED' },
            { text: this.localePipe.transform("component.activityComponent.WORKITEM_RESUMED"), value: 'WORKITEM_RESUMED' },
            { text: this.localePipe.transform("component.activityComponent.WORKITEM_ABORTED"), value: 'WORKITEM_ABORTED' },
            { text: this.localePipe.transform("component.activityComponent.WORKITEM_RETRIEVED"), value: 'WORKITEM_RETRIEVED' },
            { text: this.localePipe.transform("component.activityComponent.WORKITEM_CLAIMED"), value: 'WORKITEM_CLAIMED' },
            { text: this.localePipe.transform("component.activityComponent.WORKITEM_UNCLAIMED"), value: 'WORKITEM_UNCLAIMED' },
            { text: this.localePipe.transform("component.activityComponent.ACTIVITY_ASSIGNMENT"), value: 'ACTIVITY_ASSIGNMENT' }
        ];
    }
    ActivityComponentUIState.decorators = [
        { type: Injectable }
    ];
    /** @nocollapse */
    ActivityComponentUIState.ctorParameters = function () { return [
        { type: WfLocalePipe }
    ]; };
    return ActivityComponentUIState;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var BizComponentEntity = /** @class */ (function () {
    function BizComponentEntity(name, metadataid, method) {
        this.id = ProcessDeUtil.GenerateElementId();
        this.name = name;
        this.metadataId = metadataid;
        this.methodCode = method;
        this.isForCompensation = false;
    }
    return BizComponentEntity;
}());
/** @enum {string} */
var OwnerType = {
    Process: 'Process',
    Activity: 'Activity',
    Schema: 'Schema',
};

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var ActivityComponentRepository = /** @class */ (function () {
    function ActivityComponentRepository(uistate, util, http, designerState) {
        this.uistate = uistate;
        this.util = util;
        this.http = http;
        this.designerState = designerState;
        this.defaultProcessComponentIds = ['5863c8a8-e0a7-4137-a8b2-4c05e42b3b73', 'be781ba1-a88b-4bb8-9c88-2e2a27a9226e'];
        this.subject = new Subject();
    }
    /**
     * @param {?} flowFormId
     * @param {?} bizActId
     * @return {?}
     */
    ActivityComponentRepository.prototype.loadComponents = /**
     * @param {?} flowFormId
     * @param {?} bizActId
     * @return {?}
     */
    function (flowFormId, bizActId) {
        var _this = this;
        /** @type {?} */
        var url = this.util.getBizComponentsWebApi();
        if (bizActId) {
            url += "/query?param=" + encodeURIComponent("{\"flowFormKey\":\"" + flowFormId + "\",\"owner\":\"" + bizActId + "\",\"ownerType\":\"Activity\"}");
        }
        else {
            this.uistate.allComponents = [];
            return;
        }
        this.http.get(url).subscribe((/**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            _this.uistate.allComponents = data.filter((/**
             * @param {?} c
             * @return {?}
             */
            function (c) { return c.ownerType === OwnerType.Activity; }));
        }));
    };
    /**
     * @param {?} id
     * @return {?}
     */
    ActivityComponentRepository.prototype.removeComponent = /**
     * @param {?} id
     * @return {?}
     */
    function (id) {
        if (id) {
            this.uistate.components = this.uistate.components.filter((/**
             * @param {?} c
             * @return {?}
             */
            function (c) { return c.id !== id; }));
        }
    };
    /**
     * @param {?} cpt
     * @return {?}
     */
    ActivityComponentRepository.prototype.addComponent = /**
     * @param {?} cpt
     * @return {?}
     */
    function (cpt) {
        if (cpt) {
            /** @type {?} */
            var component = new BizComponentEntity(cpt.name, cpt.id, cpt.operations[0].code);
            component.id = ProcessDeUtil.GenerateElementId();
            component.actualParameters = this.bindParas(cpt);
            console.log(cpt);
            console.log(component.actualParameters);
            if (component.metadataId === '7433df25-9260-4c24-86f0-9da3e89450fb' ||
                component.metadataId === 'd0783800-ed60-488c-b053-8806a15947fe' ||
                component.metadataId === 'b89e9b9a-2e2d-4bd0-b354-187219544d34' ||
                component.metadataId === 'a8b8f7a4-49ae-4b7d-88d2-b3772b9d0ae5') {
                component.scopeType = 'ExternalProcess';
            }
            else {
                component.scopeType = 'DirectStart';
            }
            this.uistate.components.push(component);
            this.subject.next(component);
        }
    };
    /**
     * @private
     * @param {?} component
     * @return {?}
     */
    ActivityComponentRepository.prototype.bindParas = /**
     * @private
     * @param {?} component
     * @return {?}
     */
    function (component) {
        /** @type {?} */
        var parameters = [];
        if (component.operations[0].parameters && component.operations[0].parameters.length > 0) {
            if (this.defaultProcessComponentIds.indexOf(component.id) > -1) {
                parameters = this.assignParameterValue(component.operations[0].parameters);
            }
            else {
                parameters = component.operations[0].parameters.map((/**
                 * @param {?} p
                 * @return {?}
                 */
                function (p) { return ({ code: p.code, name: p.name, value: '' }); }));
            }
        }
        return parameters;
    };
    /**
     * @private
     * @param {?} params
     * @return {?}
     */
    ActivityComponentRepository.prototype.assignParameterValue = /**
     * @private
     * @param {?} params
     * @return {?}
     */
    function (params) {
        var _this = this;
        return params.map((/**
         * @param {?} p
         * @return {?}
         */
        function (p) {
            if (p.code.indexOf('beId') > -1) {
                /** @type {?} */
                var v = _this.designerState.formalParameterContext.filter((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key.indexOf('metadataId') > -1; }))[0].key;
                return { code: p.code, name: p.name, value: "{\"expr\":\"DefaultFunction.GetContextParameter(\\\"" + v + "\\\")\"}" };
            }
            else if (p.code.indexOf('nodeId') > -1) {
                /** @type {?} */
                var v = _this.designerState.formalParameterContext.filter((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key.indexOf('schemaId') > -1; }))[0].key;
                return { code: p.code, name: p.name, value: "{\"expr\":\"DefaultFunction.GetContextParameter(\\\"" + v + "\\\")\"}" };
            }
            else if (p.code.indexOf('dataId') > -1) {
                return { code: p.code, name: p.name, value: "{\"expr\":\"DefaultFunction.GetContextParameter(\\\"dataId\\\")\"}" };
            }
            else if (p.code.indexOf('procInstId') > -1) {
                return { code: p.code, name: p.name, value: "{\"expr\":\"DefaultFunction.GetContextParameter(\\\"procInstId\\\")\"}" };
            }
            else {
                return { code: p.code, name: p.name, value: '' };
            }
        }));
    };
    /**
     * @param {?} arr
     * @param {?} i1
     * @param {?} i2
     * @return {?}
     */
    ActivityComponentRepository.prototype.swapArray = /**
     * @param {?} arr
     * @param {?} i1
     * @param {?} i2
     * @return {?}
     */
    function (arr, i1, i2) {
        arr[i1] = arr.splice(i2, 1, arr[i1])[0];
        return arr;
    };
    // 获取是否预制了外部流程构件
    // 获取是否预制了外部流程构件
    /**
     * @param {?} hander
     * @return {?}
     */
    ActivityComponentRepository.prototype.getBizCmp = 
    // 获取是否预制了外部流程构件
    /**
     * @param {?} hander
     * @return {?}
     */
    function (hander) {
        /** @type {?} */
        var url = "/api/runtime/wf/v1.0/bizComponent?flowFormKey=*&owner=*&ownerType=Process";
        this.http.get(url).subscribe((/**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            hander(data);
        }));
    };
    ActivityComponentRepository.decorators = [
        { type: Injectable }
    ];
    /** @nocollapse */
    ActivityComponentRepository.ctorParameters = function () { return [
        { type: ActivityComponentUIState },
        { type: ProcessDeUtil },
        { type: HttpService },
        { type: ProcessDesignerUIState }
    ]; };
    return ActivityComponentRepository;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var ActivityComponentViewModel = /** @class */ (function () {
    function ActivityComponentViewModel(uistate, repository, messager, localePipe) {
        this.uistate = uistate;
        this.repository = repository;
        this.messager = messager;
        this.localePipe = localePipe;
    }
    /**
     * @return {?}
     */
    ActivityComponentViewModel.prototype.deleteRow = /**
     * @return {?}
     */
    function () {
        if (this.uistate.curComponent) {
            if (this.uistate.curComponent.executionTime === 'LOADDATA') {
                this.messager.info(this.localePipe.transform('component.activityList.name'));
            }
            else {
                this.repository.removeComponent(this.uistate.curComponent.id);
            }
        }
        else {
            return;
        }
    };
    /**
     * @param {?} cpt
     * @return {?}
     */
    ActivityComponentViewModel.prototype.componentSelect = /**
     * @param {?} cpt
     * @return {?}
     */
    function (cpt) {
        if (cpt) {
            this.repository.addComponent(cpt);
        }
    };
    /**
     * @param {?} flowFormId
     * @param {?} bizActId
     * @return {?}
     */
    ActivityComponentViewModel.prototype.loadComponents = /**
     * @param {?} flowFormId
     * @param {?} bizActId
     * @return {?}
     */
    function (flowFormId, bizActId) {
        this.repository.loadComponents(flowFormId, bizActId);
    };
    ActivityComponentViewModel.decorators = [
        { type: Injectable }
    ];
    /** @nocollapse */
    ActivityComponentViewModel.ctorParameters = function () { return [
        { type: ActivityComponentUIState },
        { type: ActivityComponentRepository },
        { type: MessagerService },
        { type: WfLocalePipe }
    ]; };
    return ActivityComponentViewModel;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var EditComponentParameterComponent = /** @class */ (function () {
    function EditComponentParameterComponent(designerState, expr, resolver, injector, sessionSrc, componentService, modalService, message, cd, cdr, localeId, resources, localePipe) {
        this.designerState = designerState;
        this.expr = expr;
        this.resolver = resolver;
        this.injector = injector;
        this.sessionSrc = sessionSrc;
        this.componentService = componentService;
        this.modalService = modalService;
        this.message = message;
        this.cd = cd;
        this.cdr = cdr;
        this.localeId = localeId;
        this.resources = resources;
        this.localePipe = localePipe;
        this.defaultProcessComponentIds = ['5863c8a8-e0a7-4137-a8b2-4c05e42b3b73', 'be781ba1-a88b-4bb8-9c88-2e2a27a9226e'];
        this.closeEmitter = new EventEmitter();
        this.submitEmitter = new EventEmitter();
        this.paramColumns = [];
        this.groupIcon = '<i class="f-icon f-icon-lookup"></i>';
        this.executionTimingList = new Array();
        this.paramAfterEdit = (/**
         * @param {?} rowIndex
         * @param {?} rowData
         * @param {?=} column
         * @return {?}
         */
        function (rowIndex, rowData, column) {
            return of$1(true);
        });
        this.localePipe = this.localePipe || new WfLocalePipe(localeId, resources);
    }
    /**
     * @return {?}
     */
    EditComponentParameterComponent.prototype.ngAfterViewInit = /**
     * @return {?}
     */
    function () {
    };
    /**
     * @return {?}
     */
    EditComponentParameterComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.paramColumns = [
            { field: 'code', width: 50, title: this.localePipe.transform('component.editComponentParameter.code') },
            { field: 'name', width: 50, title: this.localePipe.transform('component.editComponentParameter.name') },
            {
                field: 'required', width: 50, title: this.localePipe.transform('component.editComponentParameter.required'), formatter: (/**
                 * @param {?} v
                 * @param {?} d
                 * @param {?} i
                 * @return {?}
                 */
                function (v, d, i) {
                    if (v) {
                        return _this.localePipe.transform('component.editComponentParameter.yes');
                    }
                    else {
                        return _this.localePipe.transform('component.editComponentParameter.no');
                    }
                })
            },
            {
                field: 'value', width: 100, title: this.localePipe.transform('component.editComponentParameter.value'),
                editor: {
                    type: 'input-group',
                    options: {
                        groupText: '<i class="f-icon f-icon-lookup"></i>',
                        editable: false,
                        clickHandle: (/**
                         * @param {?} e
                         * @return {?}
                         */
                        function (e) {
                            e.formControl.setValue(e.instance.value ? e.instance.value : '');
                            _this.showExprHelp(e);
                        }),
                        clear: (/**
                         * @param {?} e
                         * @return {?}
                         */
                        function (e) {
                            console.log('clear', e);
                        })
                    }
                }
            }
        ];
        // setTimeout(() => {
        //   this.cd.detectChanges();
        // },0 )
    };
    /**
     * @param {?} e
     * @return {?}
     */
    EditComponentParameterComponent.prototype.showExprHelp = /**
     * @param {?} e
     * @return {?}
     */
    function (e) {
        var _this = this;
        var e_1, _a, e_2, _b, e_3, _c, e_4, _d;
        /** @type {?} */
        var context = new Array();
        // if(this.expr.exprEntity.contextEntities.find(x => x.key === 'CurrentLanguage')) {
        //   context.push(this.expr.exprEntity.contextEntities.find(x => x.key === 'CurrentLanguage'));
        // }
        // this.expr.clearContext();
        if (this.designerState.schemas.length > 0) {
            try {
                for (var _e = __values(this.designerState.schemas), _f = _e.next(); !_f.done; _f = _e.next()) {
                    var schema = _f.value;
                    this.expr.addSchema('Schema', schema);
                }
            }
            catch (e_1_1) { e_1 = { error: e_1_1 }; }
            finally {
                try {
                    if (_f && !_f.done && (_a = _e.return)) _a.call(_e);
                }
                finally { if (e_1) throw e_1.error; }
            }
            if (this.designerState.schemas[0].entityTypes && this.designerState.schemas[0].entityTypes.length > 0) {
                /** @type {?} */
                var entityType = this.designerState.schemas[0].entityTypes[0];
                this.expr.addInjectedEntity(entityType.name, 'Schema', entityType.name, InjectedType.EntityType);
            }
        }
        context = this.designerState.addContext(context);
        if (this.designerState.subActivityContext.length > 0) {
            var _loop_1 = function (variable) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    context.push(variable);
                }
            };
            try {
                for (var _g = __values(this.designerState.subActivityContext), _h = _g.next(); !_h.done; _h = _g.next()) {
                    var variable = _h.value;
                    _loop_1(variable);
                }
            }
            catch (e_2_1) { e_2 = { error: e_2_1 }; }
            finally {
                try {
                    if (_h && !_h.done && (_b = _g.return)) _b.call(_g);
                }
                finally { if (e_2) throw e_2.error; }
            }
        }
        if (this.location === 'activity') {
            var _loop_2 = function (variable) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    context.push(variable);
                }
            };
            try {
                for (var _j = __values(this.designerState.activityComponentContext), _k = _j.next(); !_k.done; _k = _j.next()) {
                    var variable = _k.value;
                    _loop_2(variable);
                }
            }
            catch (e_3_1) { e_3 = { error: e_3_1 }; }
            finally {
                try {
                    if (_k && !_k.done && (_c = _j.return)) _c.call(_j);
                }
                finally { if (e_3) throw e_3.error; }
            }
        }
        if (context.length > 0) {
            try {
                for (var context_1 = __values(context), context_1_1 = context_1.next(); !context_1_1.done; context_1_1 = context_1.next()) {
                    var v = context_1_1.value;
                    this.expr.addContext(v);
                }
            }
            catch (e_4_1) { e_4 = { error: e_4_1 }; }
            finally {
                try {
                    if (context_1_1 && !context_1_1.done && (_d = context_1.return)) _d.call(context_1);
                }
                finally { if (e_4) throw e_4.error; }
            }
        }
        this.expr.setEditPattern(ExprEditMode.Advanced); // 默认打开高级表达式编辑器
        this.expr.addExpressionText(e.instance.value);
        this.expr.buildExpression().then((/**
         * @param {?} expressioninfo
         * @return {?}
         */
        function (expressioninfo) {
            e.formControl.setValue(expressioninfo);
            e.instance.cd.detectChanges();
            //点击确定后，去除表达式里面的新增的上下文变量
            if (context.length > 0) {
                _this.expr.exprEntity.contextEntities = _this.expr.exprEntity.contextEntities.filter((/**
                 * @param {?} x
                 * @return {?}
                 */
                function (x) { return !context.some((/**
                 * @param {?} y
                 * @return {?}
                 */
                function (y) { return y.key === x.key; })); }));
            }
        }));
    };
    /**
     * 取数构件帮助new
     */
    /**
     * 取数构件帮助new
     * @param {?} metadataId
     * @param {?} sessionId
     * @return {?}
     */
    EditComponentParameterComponent.prototype.openComponentSelectorNew = /**
     * 取数构件帮助new
     * @param {?} metadataId
     * @param {?} sessionId
     * @return {?}
     */
    function (metadataId, sessionId) {
        var _this = this;
        this.componentService.openSelector(metadataId, sessionId).subscribe((/**
         * @param {?} selectorResult
         * @return {?}
         */
        function (selectorResult) {
            selectorResult.confirmEvent.subscribe((/**
             * @param {?} result
             * @return {?}
             */
            function (result) {
                if (result) {
                    /** @type {?} */
                    var component = new BizComponentEntity(result.name, result.id, result.operations[0].code);
                    component.id = ProcessDeUtil.GenerateElementId();
                    component.actualParameters = _this.bindParas(result);
                    if (component.metadataId === '7433df25-9260-4c24-86f0-9da3e89450fb' ||
                        component.metadataId === 'd0783800-ed60-488c-b053-8806a15947fe' ||
                        component.metadataId === 'b89e9b9a-2e2d-4bd0-b354-187219544d34' ||
                        component.metadataId === 'a8b8f7a4-49ae-4b7d-88d2-b3772b9d0ae5') {
                        component.scopeType = 'ExternalProcess';
                    }
                    else {
                        component.scopeType = 'DirectStart';
                    }
                    _this.curComponent = component;
                    _this.cd.detectChanges();
                }
            }));
        }));
    };
    /**
     * @private
     * @param {?} component
     * @return {?}
     */
    EditComponentParameterComponent.prototype.bindParas = /**
     * @private
     * @param {?} component
     * @return {?}
     */
    function (component) {
        /** @type {?} */
        var parameters = [];
        if (component.operations[0].parameters && component.operations[0].parameters.length > 0) {
            if (this.defaultProcessComponentIds.indexOf(component.id) > -1) {
                parameters = this.assignParameterValue(component.operations[0].parameters);
            }
            else {
                parameters = component.operations[0].parameters.map((/**
                 * @param {?} p
                 * @return {?}
                 */
                function (p) { return ({ code: p.code, name: p.name, value: '', required: p.code.toLowerCase() === 'wfcontext' ? false : p.required }); }));
            }
        }
        return parameters;
    };
    /**
     * @private
     * @param {?} params
     * @return {?}
     */
    EditComponentParameterComponent.prototype.assignParameterValue = /**
     * @private
     * @param {?} params
     * @return {?}
     */
    function (params) {
        var _this = this;
        return params.map((/**
         * @param {?} p
         * @return {?}
         */
        function (p) {
            if (p.code.indexOf('beId') > -1) {
                /** @type {?} */
                var v = _this.designerState.formalParameterContext.filter((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key.indexOf('metadataId') > -1; }))[0].key;
                return { code: p.code, name: p.name, value: "{\"expr\":\"DefaultFunction.GetContextParameter(\\\"" + v + "\\\")\"}", required: true };
            }
            else if (p.code.indexOf('nodeId') > -1) {
                /** @type {?} */
                var v = _this.designerState.formalParameterContext.filter((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key.indexOf('schemaId') > -1; }))[0].key;
                return { code: p.code, name: p.name, value: "{\"expr\":\"DefaultFunction.GetContextParameter(\\\"" + v + "\\\")\"}", required: true };
            }
            else if (p.code.indexOf('dataId') > -1) {
                return { code: p.code, name: p.name, value: "{\"expr\":\"DefaultFunction.GetContextParameter(\\\"dataId\\\")\"}", required: true };
            }
            else if (p.code.indexOf('procInstId') > -1) {
                return { code: p.code, name: p.name, value: "{\"expr\":\"DefaultFunction.GetContextParameter(\\\"procInstId\\\")\"}", required: true };
            }
            else {
                return { code: p.code, name: p.name, value: '', required: true };
            }
        }));
    };
    /**
     * @return {?}
     */
    EditComponentParameterComponent.prototype.componentSelect = /**
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var compFactory = this.resolver.resolveComponentFactory(SelectMetadataRTComponent);
        /** @type {?} */
        var compRef = compFactory.create(this.injector);
        compRef.instance.typeList = 'WebServiceComponent'; // 目前只能根据元数据类型过滤，后续添加标签过滤
        compRef.instance.selectedMetadata.subscribe((/**
         * @param {?} $event
         * @return {?}
         */
        function ($event) {
            try {
                /** @type {?} */
                var meta = $event.metadata;
                _this.openComponentSelectorNew(meta.id, _this.sessionSrc.getUserSessionId());
            }
            catch (_a) {
                console.log('$event', $event);
                throw new Error(_this.localePipe.transform('component.editComponentParameter.openComponentFail') + $event);
            }
        }));
        /** @type {?} */
        var modalConfig = {
            title: this.localePipe.transform('component.editComponentParameter.componentSelection'),
            width: 980,
            height: 548,
            showButtons: false
        };
        /** @type {?} */
        var dialog = this.modalService.show(compRef, modalConfig);
        compRef.instance.closeModalEmitter.subscribe((/**
         * @param {?} $event
         * @return {?}
         */
        function ($event) { return dialog.close(); }));
    };
    /**
     * @return {?}
     */
    EditComponentParameterComponent.prototype.endCellEdit = /**
     * @return {?}
     */
    function () {
        this.paramlist.endCellEdit();
    };
    /**
     * @return {?}
     */
    EditComponentParameterComponent.prototype.editOK = /**
     * @return {?}
     */
    function () {
        // 结束构件参数编辑状态
        this.endCellEdit();
        if (this.validator()) {
            this.submitEmitter.emit(this.curComponent);
        }
    };
    /**
     * @return {?}
     */
    EditComponentParameterComponent.prototype.editCancel = /**
     * @return {?}
     */
    function () {
        this.closeEmitter.emit();
    };
    /**
     * @return {?}
     */
    EditComponentParameterComponent.prototype.validator = /**
     * @return {?}
     */
    function () {
        var e_5, _a;
        if (!this.curComponent || !this.curComponent.metadataId || !this.curComponent.methodCode) {
            this.message.info(this.localePipe.transform('component.editComponentParameter.curComponent'));
            return false;
        }
        else if (this.location !== 'autoActivity' && !this.curComponent.executionTime) {
            this.message.info(this.localePipe.transform('component.editComponentParameter.executionTime'));
            return false;
        }
        else {
            /** @type {?} */
            var codeList = '';
            try {
                for (var _b = __values(this.curComponent.actualParameters), _c = _b.next(); !_c.done; _c = _b.next()) {
                    var param = _c.value;
                    if (param.required && !param.value) {
                        codeList = codeList + ("\uFF0C" + param.code);
                    }
                }
            }
            catch (e_5_1) { e_5 = { error: e_5_1 }; }
            finally {
                try {
                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                }
                finally { if (e_5) throw e_5.error; }
            }
            if (codeList.length > 0) {
                codeList = codeList.slice(1, codeList.length);
                this.message.info(this.localePipe.transform('component.editComponentParameter.para') + '【' + codeList + this.localePipe.transform('component.editComponentParameter.paraRequired'));
                return false;
            }
        }
        return true;
    };
    EditComponentParameterComponent.decorators = [
        { type: Component, args: [{
                    selector: 'lib-edit-component-parameter',
                    template: "<div *ngIf=\"curComponent\" class=\"f-page\">\r\n  <div class=\"f-utils-fill-flex-column farris-overflow-y-auto h-100\">\r\n    <form class=\"farris-form farris-card-content-bg farris-card-section mx-2\">\r\n      <div class=\"d-flex flex-wrap flex-column mb-2 pr-4\">\r\n        <div class=\"farris-form-controls-inline farris-form-auto mb-2\">\r\n          <div class=\"farris-group-wrap mx-3\">\r\n            <div class=\"form-group\">\r\n              <label class=\"col-form-label\">\r\n                <span class=\"farris-label-info text-danger\">*</span>\r\n                <span class=\"farris-label-text\">{{'component.editComponentParameter.componentSelection' | wfLocale}}</span>\r\n              </label>\r\n              <div class=\"farris-input-wrap ml-2\">\r\n                <input-group class=\"form-control\" style=\"width: 100%;padding:0;border:0;\" name=\"method\" [showButtonWhenDisabled]=\"false\"\r\n                [enableClear]=\"false\" [editable]=\"false\" (clickHandle)=\"componentSelect()\" [groupText]=\"groupIcon\" [(ngModel)]=\"curComponent.name\" [disabled]=\"editState==='edit'\"></input-group>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <ng-container *ngIf=\"location!=='autoActivity'\">\r\n          <div class=\"farris-form-controls-inline farris-form-auto\">\r\n            <div class=\"farris-group-wrap mx-3\">\r\n              <div class=\"form-group\">\r\n                <label class=\"col-form-label\">\r\n                  <span class=\"farris-label-info text-danger\">*</span>\r\n                  <span class=\"farris-label-text\">{{'component.editComponentParameter.execuTime' | wfLocale}}</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap ml-2\">\r\n                  <farris-combo-list name=\"executionTime\" [idField]=\"'value'\" [(ngModel)]=\"curComponent.executionTime\"\r\n                    [textField]=\"'text'\" [valueField]=\"'value'\" [data]=\"executionTimingList\" [panelHeight]=\"'auto'\">\r\n                  </farris-combo-list>\r\n                  <div class=\"farris-feedback valid-feedback\"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </ng-container>\r\n      </div>\r\n    </form>\r\n    <ng-container>\r\n      <farris-tabs class=\"f-utils-fill pr-2 pl-2\" [value]=\"'parameters'\" [contentFill]=\"true\" [autoTitleWidth]=\"true\">\r\n        <farris-tab title=\"{{'component.editComponentParameter.parameterList'|wfLocale}}\" [id]=\"'parameters'\">\r\n          <ng-template #content>\r\n            <div class=\"f-utils-fill-flex-column h-100\">\r\n              <farris-datagrid #paramlist [data]=\"curComponent.actualParameters\" [columns]=\"paramColumns\"\r\n                [idField]=\"'code'\" [fit]=\"true\" [fitColumns]=\"true\" [editable]=\"true\" [editMode]=\"'cell'\"\r\n                [pagination]=\"false\" [showCheckbox]=\"false\" [multiSelect]=\"false\" [afterEdit]=\"paramAfterEdit\"\r\n                [closeOtherGridEditor]=\"true\">\r\n              </farris-datagrid>\r\n            </div>\r\n          </ng-template>\r\n        </farris-tab>\r\n      </farris-tabs>\r\n    </ng-container>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #editFooter>\r\n  <button type=\"button\" class=\"btn btn-secondary btn-sm px-3 mx-2\" (click)=\"editCancel()\">{{'component.editComponentParameter.clickCancel' | wfLocale}}</button>\r\n  <button type=\"button\" class=\"btn btn-primary btn-sm px-3 mx-2\" (click)=\"editOK()\">{{'component.editComponentParameter.clickOK' | wfLocale}}</button>\r\n</ng-template>\r\n\r\n",
                    providers: [
                        WfLocalePipe,
                    ],
                    styles: [""]
                }] }
    ];
    /** @nocollapse */
    EditComponentParameterComponent.ctorParameters = function () { return [
        { type: ProcessDesignerUIState },
        { type: ExpressionService },
        { type: ComponentFactoryResolver },
        { type: Injector },
        { type: SessionService },
        { type: CommonComponentUiRTService },
        { type: BsModalService },
        { type: MessagerService },
        { type: ChangeDetectorRef },
        { type: ChangeDetectorRef, decorators: [{ type: Optional }] },
        { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
        { type: undefined, decorators: [{ type: Inject, args: [WF_LANG_RESOURCES,] }] },
        { type: WfLocalePipe, decorators: [{ type: Optional }] }
    ]; };
    EditComponentParameterComponent.propDecorators = {
        editState: [{ type: Input }],
        closeEmitter: [{ type: Output }],
        submitEmitter: [{ type: Output }],
        paramlist: [{ type: ViewChild, args: ['paramlist',] }],
        editFooter: [{ type: ViewChild, args: ['editFooter',] }],
        curComponent: [{ type: Input }]
    };
    return EditComponentParameterComponent;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var ActivityComponentComponent = /** @class */ (function () {
    function ActivityComponentComponent(uistate, viewModel, designerState, expr, resolver, injector, modalService, componentService, repository, message, cdr, localeId, resources, localePipe) {
        this.uistate = uistate;
        this.viewModel = viewModel;
        this.designerState = designerState;
        this.expr = expr;
        this.resolver = resolver;
        this.injector = injector;
        this.modalService = modalService;
        this.componentService = componentService;
        this.repository = repository;
        this.message = message;
        this.cdr = cdr;
        this.localeId = localeId;
        this.resources = resources;
        this.localePipe = localePipe;
        this.cls = 'farris-main-area flex-column';
        this.closeModal = new EventEmitter();
        this.submitModal = new EventEmitter();
        this.editorParams = {};
        this.exBizTips = false;
        this.modalConfig = {
            title: this.localePipe.transform('component.activityComponent.component'),
            width: 960,
            height: 506,
            showButtons: true
        };
        this.buttonGroupData = [
            {
                id: 'edit',
                text: this.localePipe.transform('component.activityComponent.edit'),
            },
            {
                id: 'deleteRow',
                text: this.localePipe.transform('component.activityComponent.deleteRow'),
            }
        ];
        this.editState = 'new'; // 编辑状态，用于区分是新增还是编辑  new | edit
        // 编辑状态，用于区分是新增还是编辑  new | edit
        this.isPreExternalProcessCmps = false;
        this.columns = [];
        this.paramColumns = [];
        this.paramAfterEdit = (/**
         * @param {?} rowIndex
         * @param {?} rowData
         * @param {?=} column
         * @return {?}
         */
        function (rowIndex, rowData, column) {
            return of$1(true);
        });
        this.localePipe = this.localePipe || new WfLocalePipe(localeId, resources);
    }
    Object.defineProperty(ActivityComponentComponent.prototype, "value", {
        set: /**
         * @param {?} cpts
         * @return {?}
         */
        function (cpts) {
            var _this = this;
            var e_1, _a;
            if (cpts && cpts.length > 0) {
                /** @type {?} */
                var metaDataIdList = new Array();
                try {
                    for (var cpts_1 = __values(cpts), cpts_1_1 = cpts_1.next(); !cpts_1_1.done; cpts_1_1 = cpts_1.next()) {
                        var cmp = cpts_1_1.value;
                        if (metaDataIdList.indexOf(cmp.metadataId) == -1) {
                            metaDataIdList.push(cmp.metadataId);
                        }
                    }
                }
                catch (e_1_1) { e_1 = { error: e_1_1 }; }
                finally {
                    try {
                        if (cpts_1_1 && !cpts_1_1.done && (_a = cpts_1.return)) _a.call(cpts_1);
                    }
                    finally { if (e_1) throw e_1.error; }
                }
                if (metaDataIdList.length > 0) {
                    forkJoin(metaDataIdList.map((/**
                     * @param {?} metaDataId
                     * @return {?}
                     */
                    function (metaDataId) { return _this.designerState.getHelpMetaData(metaDataId, ''); }))).subscribe((/**
                     * @param {?} cmpMetas
                     * @return {?}
                     */
                    function (cmpMetas) {
                        var e_2, _a;
                        var _loop_1 = function (cpt) {
                            /** @type {?} */
                            var bizComponent = new BizComponentEntity(cpt.name, cpt.metadataId, cpt.methodCode);
                            bizComponent.executionTime = cpt.executionTime,
                                bizComponent.id = cpt.id;
                            bizComponent.isForCompensation = cpt.isForCompensation;
                            bizComponent.actualParameters = new Array();
                            bizComponent.scopeType = cpt.scopeType || null;
                            /** @type {?} */
                            var meta = cmpMetas.find((/**
                             * @param {?} m
                             * @return {?}
                             */
                            function (m) { return m.id === cpt.metadataId; }));
                            /** @type {?} */
                            var content = JSON.parse(meta.content);
                            /** @type {?} */
                            var operation = content.operations.find((/**
                             * @param {?} o
                             * @return {?}
                             */
                            function (o) { return o.code === cpt.methodCode; }));
                            if (operation) {
                                bizComponent.actualParameters = cpt.actualParameters.map((/**
                                 * @param {?} a
                                 * @return {?}
                                 */
                                function (a) {
                                    /** @type {?} */
                                    var p = operation.parameters.find((/**
                                     * @param {?} i
                                     * @return {?}
                                     */
                                    function (i) { return i.code === a.code; }));
                                    if (p) {
                                        return {
                                            code: a.code,
                                            name: a.name,
                                            value: a.value,
                                            required: a.code.toLowerCase() === 'wfcontext' ? false : p.required
                                        };
                                    }
                                    else {
                                        console.error(_this.localePipe.transform('component.activityComponent.method') + cpt.methodCode + _this.localePipe.transform('component.activityComponent.inconsistentParameters'));
                                        return {
                                            code: a.code,
                                            name: a.name,
                                            value: a.value,
                                            required: false
                                        };
                                    }
                                }));
                            }
                            else {
                                console.error(_this.localePipe.transform('component.activityComponent.longerExists') + cpt.methodCode + _this.localePipe.transform('component.activityComponent.pleaseCheck'));
                            }
                            _this.uistate.components.push(bizComponent);
                        };
                        try {
                            for (var cpts_2 = __values(cpts), cpts_2_1 = cpts_2.next(); !cpts_2_1.done; cpts_2_1 = cpts_2.next()) {
                                var cpt = cpts_2_1.value;
                                _loop_1(cpt);
                            }
                        }
                        catch (e_2_1) { e_2 = { error: e_2_1 }; }
                        finally {
                            try {
                                if (cpts_2_1 && !cpts_2_1.done && (_a = cpts_2.return)) _a.call(cpts_2);
                            }
                            finally { if (e_2) throw e_2.error; }
                        }
                    }));
                }
            }
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    ActivityComponentComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        // 2023-5-25 网速慢的时候会导致加载不出来流程构件，因此加个延时
        setTimeout((/**
         * @return {?}
         */
        function () {
            _this.restart();
        }), 300);
    };
    /**
     * @return {?}
     */
    ActivityComponentComponent.prototype.restart = /**
     * @return {?}
     */
    function () {
        var _this = this;
        if (this.designerState.startMode === 'EXTERNAL_PROCESS') {
            this.repository.getBizCmp((/**
             * @param {?} cmps
             * @return {?}
             */
            function (cmps) {
                var e_3, _a;
                if (cmps && cmps.length > 0) {
                    try {
                        // 此处标记有外部流程通用构件
                        for (var cmps_1 = __values(cmps), cmps_1_1 = cmps_1.next(); !cmps_1_1.done; cmps_1_1 = cmps_1.next()) {
                            var c = cmps_1_1.value;
                            if (c.scopeType === 'ExternalProcess') {
                                _this.exBizTips = true;
                                break;
                            }
                        }
                    }
                    catch (e_3_1) { e_3 = { error: e_3_1 }; }
                    finally {
                        try {
                            if (cmps_1_1 && !cmps_1_1.done && (_a = cmps_1.return)) _a.call(cmps_1);
                        }
                        finally { if (e_3) throw e_3.error; }
                    }
                }
            }));
        }
        this.location = this.editorParams.location;
        if (this.location === 'activity') {
            this.uistate.executionCollection = this.uistate.activityCollection;
            this.columns = [
                {
                    field: 'executionTime', width: 100, title: this.localePipe.transform('component.activityComponent.executionTime'),
                    editor: {
                        type: EditorTypes.COMBOLIST,
                        options: { data: this.uistate.executionCollection, groupField: 'text', valueField: 'value', textField: 'text', idField: 'value', panelHeight: 'auto' }
                    },
                    formatter: (/**
                     * @param {?} v
                     * @param {?} d
                     * @param {?} i
                     * @return {?}
                     */
                    function (v, d, i) {
                        if (v) {
                            return _this.uistate.executionCollection.find((/**
                             * @param {?} item
                             * @return {?}
                             */
                            function (item) { return item.value === v; })).text;
                        }
                        else {
                            return '';
                        }
                    }),
                    validators: [
                        { type: 'required', messager: '必填' }
                    ]
                },
                {
                    field: 'name', width: 100, title: this.localePipe.transform('component.activityComponent.cmpName')
                },
                { field: 'metadataId', width: 100, title: this.localePipe.transform('component.activityComponent.metadataId') },
                { field: 'methodCode', width: 100, title: this.localePipe.transform('component.activityComponent.methodCode') },
                {
                    field: 'isForCompensation', width: 50, title: this.localePipe.transform('component.activityComponent.isForCompensation'),
                    editor: { type: EditorTypes.SWITCH, options: {} },
                    formatter: { type: 'boolean', options: { trueText: this.localePipe.transform('component.activityComponent.yes'), falseText: this.localePipe.transform('component.activityComponent.no') } }
                },
                { title: this.localePipe.transform('component.activityComponent.operate'), width: 70, template: this.btnTemplate }
            ];
        }
        else if (this.location === 'autoActivity') {
            this.columns = [
                {
                    field: 'name', width: 100, title: this.localePipe.transform('component.activityComponent.cmpName')
                },
                { field: 'metadataId', width: 100, title: this.localePipe.transform('component.activityComponent.metadataId') },
                { field: 'methodCode', width: 100, title: this.localePipe.transform('component.activityComponent.methodCode') },
                {
                    field: 'isForCompensation', width: 50, title: this.localePipe.transform('component.activityComponent.isForCompensation'),
                    editor: { type: EditorTypes.SWITCH, options: {} },
                    formatter: { type: 'boolean', options: { trueText: this.localePipe.transform('component.activityComponent.yes'), falseText: this.localePipe.transform('component.activityComponent.no') } }
                },
                { title: this.localePipe.transform('component.activityComponent.operate'), width: 70, template: this.btnTemplate }
            ];
        }
        else {
            this.columns = [
                {
                    field: 'executionTime', width: 100, title: this.localePipe.transform('component.activityComponent.executionTime'),
                    editor: {
                        type: EditorTypes.COMBOLIST,
                        options: { data: this.uistate.executionCollection, groupField: 'text', valueField: 'value', textField: 'text', idField: 'value', panelHeight: 'auto' }
                    },
                    formatter: (/**
                     * @param {?} v
                     * @param {?} d
                     * @param {?} i
                     * @return {?}
                     */
                    function (v, d, i) {
                        if (v) {
                            return _this.uistate.executionCollection.find((/**
                             * @param {?} item
                             * @return {?}
                             */
                            function (item) { return item.value === v; })).text;
                        }
                        else {
                            return '';
                        }
                    }),
                    validators: [
                        { type: 'required', messager: '必填' }
                    ]
                },
                {
                    field: 'name', width: 100, title: this.localePipe.transform('component.activityComponent.cmpName')
                },
                { field: 'metadataId', width: 100, title: this.localePipe.transform('component.activityComponent.metadataId') },
                { field: 'methodCode', width: 100, title: this.localePipe.transform('component.activityComponent.methodCode') },
                { title: this.localePipe.transform('component.activityComponent.operate'), width: 70, template: this.btnTemplate }
            ];
        }
        if (this.uistate.components && this.uistate.components.length > 0) {
            this.cmplist.selectRow(this.uistate.components[0].id, true);
        }
        this.paramColumns = [
            { field: 'code', width: 50, title: this.localePipe.transform('component.activityComponent.code') },
            { field: 'name', width: 50, title: this.localePipe.transform('component.activityComponent.name') },
            {
                field: 'value', width: 100, title: this.localePipe.transform('component.activityComponent.value'),
                editor: {
                    type: 'input-group',
                    options: {
                        groupText: '<i class="f-icon f-icon-lookup"></i>',
                        editable: false,
                        clickHandle: (/**
                         * @param {?} e
                         * @return {?}
                         */
                        function (e) {
                            e.formControl.setValue(e.instance.value ? e.instance.value : '');
                            _this.showExprHelp(e);
                        }),
                        clear: (/**
                         * @param {?} e
                         * @return {?}
                         */
                        function (e) {
                            console.log('clear', e);
                        })
                    }
                }
            }
        ];
        // 选中当前行
        this.repository.subject.subscribe((/**
         * @param {?} cmp
         * @return {?}
         */
        function (cmp) {
            _this.cmplist.loadData(_this.uistate.components);
            if (cmp) {
                _this.cmplist.selectRow(cmp.id, true);
            }
            else {
                _this.uistate.curComponent = null;
            }
        }));
    };
    /**
     * @return {?}
     */
    ActivityComponentComponent.prototype.ngAfterViewInit = /**
     * @return {?}
     */
    function () {
        if (this.uistate.components && this.uistate.components.length > 0) {
            this.cmplist.selectRow(this.uistate.components[0].id, true);
        }
    };
    /**
     * @return {?}
     */
    ActivityComponentComponent.prototype.edit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.editState = 'edit';
        /** @type {?} */
        var compFactory = this.resolver.resolveComponentFactory(EditComponentParameterComponent);
        /** @type {?} */
        var compRef = compFactory.create(this.injector);
        /** @type {?} */
        var modalConfig = {
            title: this.localePipe.transform('component.activityComponent.editComponent'),
            width: 700,
            height: 400,
            buttons: compRef.instance.editFooter,
            showButtons: true,
            initialState: {
                curComponent: JSON.parse(JSON.stringify(this.uistate.curComponent))
            }
        };
        /** @type {?} */
        var editDialog = this.modalService.show(compRef, modalConfig);
        compRef.instance.canEdit = false;
        compRef.instance.editState = this.editState;
        compRef.instance.location = this.location;
        compRef.instance.executionTimingList = this.uistate.executionCollection;
        // compRef.instance.curComponent = JSON.parse(JSON.stringify(this.uistate.curComponent));
        compRef.instance.submitEmitter.subscribe((/**
         * @param {?} cmp
         * @return {?}
         */
        function (cmp) {
            /** @type {?} */
            var i = _this.uistate.components.findIndex((/**
             * @param {?} item
             * @return {?}
             */
            function (item) { return item.id === cmp.id; }));
            _this.uistate.components[i] = cmp;
            _this.cmplist.loadData(_this.uistate.components);
            editDialog.close();
        }));
        compRef.instance.closeEmitter.subscribe((/**
         * @param {?} re
         * @return {?}
         */
        function (re) {
            editDialog.close();
        }));
        setTimeout((/**
         * @return {?}
         */
        function () {
            compRef.instance.cd.detectChanges();
        }));
    };
    /**
     * @return {?}
     */
    ActivityComponentComponent.prototype.deleteRow = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.message.confirm(this.localePipe.transform('component.activityComponent.confirmDelete')).subscribe((/**
         * @param {?} v
         * @return {?}
         */
        function (v) {
            if (v) {
                _this.closeCellEdit();
                _this.viewModel.deleteRow();
                _this.cmplist.loadData(_this.uistate.components);
            }
        }));
    };
    /**
     * @return {?}
     */
    ActivityComponentComponent.prototype.moveUp = /**
     * @return {?}
     */
    function () {
        if (!this.uistate.curComponent) {
            this.message.info(this.localePipe.transform('component.activityComponent.curComponent'));
            return;
        }
        /** @type {?} */
        var curCmpId = this.uistate.curComponent.id;
        /** @type {?} */
        var i = this.uistate.components.findIndex((/**
         * @param {?} c
         * @return {?}
         */
        function (c) { return c.id === curCmpId; }));
        if (i === 0) {
            return;
        }
        this.repository.swapArray(this.uistate.components, i, i - 1);
        this.cmplist.loadData(this.uistate.components);
        this.cmplist.selectRow(curCmpId, true);
    };
    /**
     * @return {?}
     */
    ActivityComponentComponent.prototype.moveDown = /**
     * @return {?}
     */
    function () {
        if (!this.uistate.curComponent) {
            this.message.info(this.localePipe.transform('component.activityComponent.curComponent'));
            return;
        }
        /** @type {?} */
        var curCmpId = this.uistate.curComponent.id;
        /** @type {?} */
        var i = this.uistate.components.findIndex((/**
         * @param {?} c
         * @return {?}
         */
        function (c) { return c.id === curCmpId; }));
        if (i === this.uistate.components.length - 1) {
            return;
        }
        this.repository.swapArray(this.uistate.components, i, i + 1);
        this.cmplist.loadData(this.uistate.components);
        this.cmplist.selectRow(curCmpId, true);
    };
    /**
     * @param {?} buttonId
     * @param {?} ctx
     * @return {?}
     */
    ActivityComponentComponent.prototype.clickAction = /**
     * @param {?} buttonId
     * @param {?} ctx
     * @return {?}
     */
    function (buttonId, ctx) {
        this.uistate.curComponent = ctx.rowData;
        switch (buttonId) {
            case 'edit':
                this.edit();
                break;
            case 'deleteRow':
                this.deleteRow();
                break;
        }
    };
    /**
     * @return {?}
     */
    ActivityComponentComponent.prototype.clickOK = /**
     * @return {?}
     */
    function () {
        this.closeCellEdit();
        if (this.validator()) {
            /** @type {?} */
            var object = { value: this.uistate.components, parameters: null };
            this.submitModal.emit(object);
        }
    };
    /**
     * @return {?}
     */
    ActivityComponentComponent.prototype.clickCancel = /**
     * @return {?}
     */
    function () {
        this.closeModal.emit();
    };
    /**
     * @return {?}
     */
    ActivityComponentComponent.prototype.componentSelect = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.editState = 'new';
        /** @type {?} */
        var compFactory = this.resolver.resolveComponentFactory(EditComponentParameterComponent);
        /** @type {?} */
        var compRef = compFactory.create(this.injector);
        /** @type {?} */
        var modalConfig = {
            title: this.localePipe.transform('component.activityComponent.newComponent'),
            width: 700,
            height: 400,
            buttons: compRef.instance.editFooter,
            showButtons: true
        };
        /** @type {?} */
        var editDialog = this.modalService.show(compRef, modalConfig);
        compRef.instance.canEdit = true;
        compRef.instance.editState = this.editState;
        compRef.instance.location = this.location;
        compRef.instance.executionTimingList = this.uistate.executionCollection;
        compRef.instance.curComponent = new BizComponentEntity();
        compRef.instance.submitEmitter.subscribe((/**
         * @param {?} cmp
         * @return {?}
         */
        function (cmp) {
            _this.uistate.components.push(cmp);
            _this.cmplist.loadData(_this.uistate.components);
            editDialog.close();
        }));
        compRef.instance.closeEmitter.subscribe((/**
         * @param {?} re
         * @return {?}
         */
        function (re) {
            editDialog.close();
        }));
        setTimeout((/**
         * @return {?}
         */
        function () {
            compRef.instance.cd.detectChanges();
        }));
    };
    /**
     * 取数构件帮助new
     */
    /**
     * 取数构件帮助new
     * @param {?} metadataId
     * @param {?} sessionId
     * @return {?}
     */
    ActivityComponentComponent.prototype.openComponentSelectorNew = /**
     * 取数构件帮助new
     * @param {?} metadataId
     * @param {?} sessionId
     * @return {?}
     */
    function (metadataId, sessionId) {
        var _this = this;
        this.componentService.openSelector(metadataId, sessionId).subscribe((/**
         * @param {?} selectorResult
         * @return {?}
         */
        function (selectorResult) {
            selectorResult.confirmEvent.subscribe((/**
             * @param {?} result
             * @return {?}
             */
            function (result) {
                _this.viewModel.componentSelect(result);
            }));
        }));
    };
    /**
     * @param {?} e
     * @return {?}
     */
    ActivityComponentComponent.prototype.showExprHelp = /**
     * @param {?} e
     * @return {?}
     */
    function (e) {
        var _this = this;
        var e_4, _a, e_5, _b, e_6, _c, e_7, _d;
        /** @type {?} */
        var context = new Array();
        // if(this.expr.exprEntity.contextEntities.find(x => x.key === 'CurrentLanguage')) {
        //   context.push(this.expr.exprEntity.contextEntities.find(x => x.key === 'CurrentLanguage'));
        // }
        // this.expr.clearContext();
        if (this.designerState.schemas.length > 0) {
            try {
                for (var _e = __values(this.designerState.schemas), _f = _e.next(); !_f.done; _f = _e.next()) {
                    var schema = _f.value;
                    this.expr.addSchema('Schema', schema);
                }
            }
            catch (e_4_1) { e_4 = { error: e_4_1 }; }
            finally {
                try {
                    if (_f && !_f.done && (_a = _e.return)) _a.call(_e);
                }
                finally { if (e_4) throw e_4.error; }
            }
            if (this.designerState.schemas[0].entityTypes && this.designerState.schemas[0].entityTypes.length > 0) {
                /** @type {?} */
                var entityType = this.designerState.schemas[0].entityTypes[0];
                this.expr.addInjectedEntity(entityType.name, 'Schema', entityType.name, InjectedType.EntityType);
            }
        }
        context = this.designerState.addContext(context);
        if (this.location === 'activity') {
            var _loop_2 = function (variable) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    context.push(variable);
                }
            };
            try {
                for (var _g = __values(this.designerState.activityComponentContext), _h = _g.next(); !_h.done; _h = _g.next()) {
                    var variable = _h.value;
                    _loop_2(variable);
                }
            }
            catch (e_5_1) { e_5 = { error: e_5_1 }; }
            finally {
                try {
                    if (_h && !_h.done && (_b = _g.return)) _b.call(_g);
                }
                finally { if (e_5) throw e_5.error; }
            }
        }
        if (this.location === 'activity') {
            var _loop_3 = function (variable) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    context.push(variable);
                }
            };
            try {
                for (var _j = __values(this.designerState.subActivityContext), _k = _j.next(); !_k.done; _k = _j.next()) {
                    var variable = _k.value;
                    _loop_3(variable);
                }
            }
            catch (e_6_1) { e_6 = { error: e_6_1 }; }
            finally {
                try {
                    if (_k && !_k.done && (_c = _j.return)) _c.call(_j);
                }
                finally { if (e_6) throw e_6.error; }
            }
        }
        if (context.length > 0) {
            try {
                for (var context_1 = __values(context), context_1_1 = context_1.next(); !context_1_1.done; context_1_1 = context_1.next()) {
                    var v = context_1_1.value;
                    this.expr.addContext(v);
                }
            }
            catch (e_7_1) { e_7 = { error: e_7_1 }; }
            finally {
                try {
                    if (context_1_1 && !context_1_1.done && (_d = context_1.return)) _d.call(context_1);
                }
                finally { if (e_7) throw e_7.error; }
            }
        }
        this.expr.setEditPattern(ExprEditMode.Advanced); // 默认打开高级表达式编辑器
        this.expr.addExpressionText(e.instance.value);
        this.expr.buildExpression().then((/**
         * @param {?} expressioninfo
         * @return {?}
         */
        function (expressioninfo) {
            e.formControl.setValue(expressioninfo);
            e.instance.cd.detectChanges();
            //点击确定后，去除表达式里面的新增的上下文变量
            if (context.length > 0) {
                _this.expr.exprEntity.contextEntities = _this.expr.exprEntity.contextEntities.filter((/**
                 * @param {?} x
                 * @return {?}
                 */
                function (x) { return !context.some((/**
                 * @param {?} y
                 * @return {?}
                 */
                function (y) { return y.key === x.key; })); }));
            }
        }));
    };
    /**
     * @param {?} data
     * @return {?}
     */
    ActivityComponentComponent.prototype.selectionChange = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        this.uistate.curComponent = data.data;
    };
    /**
     * @private
     * @return {?}
     */
    ActivityComponentComponent.prototype.closeCellEdit = /**
     * @private
     * @return {?}
     */
    function () {
        this.cmplist.endCellEdit();
        if (this.paramlist) {
            this.paramlist.endCellEdit();
        }
    };
    /**
     * @private
     * @return {?}
     */
    ActivityComponentComponent.prototype.validator = /**
     * @private
     * @return {?}
     */
    function () {
        var e_8, _a;
        // 校验是否存在重复的构件
        /** @type {?} */
        var cache = [];
        var _loop_4 = function (cmp) {
            var e_9, _a;
            if (cache.find((/**
             * @param {?} c
             * @return {?}
             */
            function (c) { return c.methodCode === cmp.methodCode && JSON.stringify(c.actualParameters) === JSON.stringify(cmp.actualParameters) &&
                c.executionTime === cmp.executionTime; }))) {
                console.log(cmp.actualParameters);
                this_1.message.warning(this_1.localePipe.transform('component.activityComponent.sameCmp') + ("" + cmp.name) + this_1.localePipe.transform('component.activityComponent.cmpMethod') + cmp.methodCode + this_1.localePipe.transform('component.activityComponent.pleaseCheck'));
                return { value: false };
            }
            cache.push(cmp);
            if (!cmp.executionTime && this_1.location !== 'autoActivity') {
                this_1.message.warning(this_1.localePipe.transform('component.activityComponent.executionTimeNotNull'));
                return { value: false };
            }
            try {
                for (var _b = __values(cmp.actualParameters), _c = _b.next(); !_c.done; _c = _b.next()) {
                    var param = _c.value;
                    if (param.required && !param.value) {
                        this_1.message.warning(this_1.localePipe.transform('component.activityComponent.component') + ("\u3010" + cmp.name + "\u3011") + this_1.localePipe.transform('component.activityComponent.param') + ("\u3010" + param.code + "\u3011") + this_1.localePipe.transform('component.activityComponent.required'));
                        return { value: false };
                    }
                }
            }
            catch (e_9_1) { e_9 = { error: e_9_1 }; }
            finally {
                try {
                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                }
                finally { if (e_9) throw e_9.error; }
            }
        };
        var this_1 = this;
        try {
            for (var _b = __values(this.uistate.components), _c = _b.next(); !_c.done; _c = _b.next()) {
                var cmp = _c.value;
                var state_1 = _loop_4(cmp);
                if (typeof state_1 === "object")
                    return state_1.value;
            }
        }
        catch (e_8_1) { e_8 = { error: e_8_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_8) throw e_8.error; }
        }
        return true;
    };
    ActivityComponentComponent.decorators = [
        { type: Component, args: [{
                    selector: 'app-activity-component',
                    template: "<div class=\"f-page\">\r\n  <div class=\"f-page-header\">\r\n    <nav class=\"f-page-header-base\">\r\n      <div class=\"f-title\">\r\n              <ng-container *ngIf=\"exBizTips\">\r\n                <div  class=\"f-component-wizard-page-detail-header\">\r\n                  <div class=\"page-friendly-reminder\" style=\"background:#E6F7FF;padding: 0.5rem!important\">\r\n                    <div class=\"reminder-message\">\r\n                      <span class=\"reminder-title\">\r\n                        <span class=\"f-icon f-icon-info\">\r\n                        </span>\r\n                        <span class=\"reminder-name\" style=\"padding-left: 0.25rem\">{{'component.activityComponent.tips' | wfLocale}}\r\n                        </span>\r\n                      </span>\r\n                      <span class=\"message\">{{'component.activityComponent.prefabricated' | wfLocale}}\r\n                      </span>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </ng-container>\r\n      </div>\r\n      <div class=\"btn-toolbar btn-group-lg\">\r\n        <button class=\"btn btn-primary mr-2\" (click)=\"componentSelect()\">{{'component.activityComponent.add' | wfLocale}}</button>\r\n        <button class=\"btn btn-secondary mr-2\" (click)=\"moveUp()\">{{'component.activityComponent.moveUp' | wfLocale}}</button>\r\n        <button class=\"btn btn-secondary\" (click)=\"moveDown()\">{{'component.activityComponent.moveDown' | wfLocale}}</button>\r\n      </div>\r\n    </nav>\r\n  </div>\r\n  <div class=\"f-page-main f-utils-fill-flex-column h-100\">\r\n    <div class=\"f-utils-fill-flex-column farris-overflow-y-auto h-100\" style=\"border-radius:16px;border: 1.5px solid #F1F3F7;margin-left: 6px;margin-right: 6px;\">\r\n      <div [style.height.%]=\"uistate.curComponent?100:100\">\r\n        <farris-datagrid #cmplist [data]=\"uistate.components\" [idField]=\"'id'\" [columns]=\"columns\" [fit]=\"true\"\r\n          [showGroupColumn]=\"true\" [fitColumns]=\"true\" [editable]=\"true\" [editMode]=\"'cell'\" [pagination]=\"false\"\r\n          [showCheckbox]=\"false\" [groupRows]=\"true\" [multiSelect]=\"false\" (selectChanged)=\"selectionChange($event)\"\r\n          [closeOtherGridEditor]=\"true\" [mergeCell]=\"true\" [mergeFields]=\"['executionTime']\">\r\n        </farris-datagrid>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #buttonsTemplate let-ctx>\r\n  <farris-button-group [count]=\"2\" [data]=\"buttonGroupData\" (change)=\"clickAction($event, ctx)\">\r\n  </farris-button-group>\r\n</ng-template>\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type=\"button\" class=\"btn btn-secondary btn-sm px-3\" (click)=\"clickCancel()\">{{'component.activityComponent.clickCancel' | wfLocale}}</button>\r\n  <button type=\"button\" class=\"btn btn-primary btn-sm px-3 mx-2\" (click)=\"clickOK()\">{{'component.activityComponent.clickOK' | wfLocale}}</button>\r\n</ng-template>\r\n",
                    providers: [ActivityComponentRepository, ActivityComponentUIState, ActivityComponentViewModel,
                        WfLocalePipe,
                    ],
                    styles: [""]
                }] }
    ];
    /** @nocollapse */
    ActivityComponentComponent.ctorParameters = function () { return [
        { type: ActivityComponentUIState },
        { type: ActivityComponentViewModel },
        { type: ProcessDesignerUIState },
        { type: ExpressionService },
        { type: ComponentFactoryResolver },
        { type: Injector },
        { type: BsModalService },
        { type: CommonComponentUiRTService },
        { type: ActivityComponentRepository },
        { type: MessagerService },
        { type: ChangeDetectorRef, decorators: [{ type: Optional }] },
        { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
        { type: undefined, decorators: [{ type: Inject, args: [WF_LANG_RESOURCES,] }] },
        { type: WfLocalePipe, decorators: [{ type: Optional }] }
    ]; };
    ActivityComponentComponent.propDecorators = {
        cls: [{ type: HostBinding, args: ['class',] }],
        closeModal: [{ type: Output }],
        submitModal: [{ type: Output }],
        editorParams: [{ type: Input }],
        modalFooter: [{ type: ViewChild, args: ['iconSelectFooter',] }],
        btnTemplate: [{ type: ViewChild, args: ['buttonsTemplate',] }],
        cmplist: [{ type: ViewChild, args: ['cmplist',] }],
        paramlist: [{ type: ViewChild, args: ['paramlist',] }],
        value: [{ type: Input }]
    };
    return ActivityComponentComponent;
}());
var ActivityComponentConverter = /** @class */ (function () {
    function ActivityComponentConverter(localePipe) {
        this.localePipe = localePipe;
    }
    /**
     * @param {?} data
     * @return {?}
     */
    ActivityComponentConverter.prototype.convertTo = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        if (data && data.length > 0) {
            return this.localePipe.transform("component.activityComponent.set");
        }
        else {
            return this.localePipe.transform("component.activityComponent.notSet");
        }
    };
    return ActivityComponentConverter;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var ExecuteFormsUIState = /** @class */ (function () {
    function ExecuteFormsUIState(localePipe) {
        this.localePipe = localePipe;
        this.formTypeCollection = [
            { text: this.localePipe.transform('component.executeForms.processEmbeddedForm'), value: '0' },
            { text: this.localePipe.transform('component.executeForms.formEmbedProcess'), value: '1' },
        ];
    }
    ExecuteFormsUIState.decorators = [
        { type: Injectable }
    ];
    /** @nocollapse */
    ExecuteFormsUIState.ctorParameters = function () { return [
        { type: WfLocalePipe }
    ]; };
    return ExecuteFormsUIState;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var ExecuteFormsViewModel = /** @class */ (function () {
    function ExecuteFormsViewModel() {
    }
    ExecuteFormsViewModel.decorators = [
        { type: Injectable }
    ];
    return ExecuteFormsViewModel;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var ExecuteFormsRepository = /** @class */ (function () {
    function ExecuteFormsRepository() {
    }
    ExecuteFormsRepository.decorators = [
        { type: Injectable }
    ];
    return ExecuteFormsRepository;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var ExecuteFormModel = /** @class */ (function () {
    function ExecuteFormModel() {
    }
    return ExecuteFormModel;
}());
var ActualParameter$1 = /** @class */ (function () {
    function ActualParameter$$1() {
    }
    return ActualParameter$$1;
}());
/** @enum {string} */
var TerminalType = {
    PC: 'PC',
    MOBILE: 'MOBILE',
    ALL: 'ALL',
};

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var FormFormatService = /** @class */ (function () {
    function FormFormatService(http) {
        this.http = http;
    }
    /**
     * @param {?} url
     * @param {?=} params
     * @return {?}
     */
    FormFormatService.prototype.getData = /**
     * @param {?} url
     * @param {?=} params
     * @return {?}
     */
    function (url, params) {
        /** @type {?} */
        var customData = params.customData;
        /** @type {?} */
        var index = params.pageIndex || 1;
        /** @type {?} */
        var size = params.pageSize || 20;
        /** @type {?} */
        var searchValue = JSON.parse(params.searchValue);
        /** @type {?} */
        var terminal = customData.tab === 'web' ? 'PC' : 'Mobile';
        /** @type {?} */
        var query = '?param=';
        /** @type {?} */
        var filter = "{\"terminal\":\"" + terminal + "\"";
        if (searchValue.searchValue) {
            if (searchValue.searchField === '*') {
                filter += ",\"allColumns\":\"" + searchValue.searchValue + "\"";
            }
            else {
                filter += ",\"" + searchValue.searchField + "\":\"" + searchValue.searchValue + "\"";
            }
        }
        filter += '}';
        filter = encodeURIComponent(filter);
        query += (filter + ("&pageNum=" + index + "&pageSize=" + size));
        url += query;
        return this.http.get(url).pipe(map((/**
         * @param {?} re
         * @return {?}
         */
        function (re) { return ({
            items: re.content,
            total: re.totalElements,
            pageInfo: {
                pageIndex: re.pageable.pageNumber + 1,
                pageSize: re.pageable.pageSize,
                pageList: [20, 40, 60, 80, 100],
                enablePager: true
            }
        }); })));
    };
    FormFormatService.decorators = [
        { type: Injectable }
    ];
    /** @nocollapse */
    FormFormatService.ctorParameters = function () { return [
        { type: HttpService }
    ]; };
    return FormFormatService;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var ExecuteForm$1 = /** @class */ (function () {
    function ExecuteForm$$1() {
    }
    return ExecuteForm$$1;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var AddExecuteFormComponent = /** @class */ (function () {
    function AddExecuteFormComponent(state, http, session, message, cdr, localeId, resources, localePipe) {
        var _this = this;
        this.state = state;
        this.http = http;
        this.session = session;
        this.message = message;
        this.cdr = cdr;
        this.localeId = localeId;
        this.resources = resources;
        this.localePipe = localePipe;
        this.submit = new Subject();
        this.cancel = new Subject();
        this.forms = new Array();
        // private formTypeCollection = [
        //   { text: '流程嵌表单', value: '0' },
        //   { text: '表单嵌流程', value: '1' },
        // ];
        this.columns = [
            { field: 'code', width: 100, title: this.localePipe.transform('component.executeForms.code') },
            {
                field: 'name', width: 100, title: this.localePipe.transform('component.executeForms.name'),
            },
            {
                field: 'tag', width: 80, title: this.localePipe.transform('component.executeForms.apptag'),
                formatter: (/**
                 * @param {?} v
                 * @param {?} d
                 * @param {?} i
                 * @return {?}
                 */
                function (v, d, i) {
                    if (d.appId) {
                        return _this.localePipe.transform('component.executeForms.functionMenu');
                    }
                    else if (d.formFormatId) {
                        return _this.localePipe.transform('component.executeForms.formFormat');
                    }
                })
            }
            // {
            //   field: 'formType', width: 80, title: '联查类型',
            //   formatter: {
            //     type: 'enum',
            //     options: { valueField: 'value', textField: 'text', data: this.formTypeCollection }
            //   },
            // },
        ];
        // 表单格式显示列
        this.cols = [
            {
                field: 'code', width: 100, title: this.localePipe.transform('component.executeForms.docFormatNumber'), searchField: 'code'
            }, {
                field: 'name', width: 100, title: this.localePipe.transform('component.executeForms.docFormatName'), searchField: 'name'
            }
        ];
        this.dataUri = '/api/runtime/wf/v1.0/formFormat/page';
        this.localePipe = this.localePipe || new WfLocalePipe(localeId, resources);
    }
    /**
     * @return {?}
     */
    AddExecuteFormComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        this.getAllExecuteForms();
    };
    /**
     * @return {?}
     */
    AddExecuteFormComponent.prototype.clickOK = /**
     * @return {?}
     */
    function () {
        var _this = this;
        if (this.grid.selectedRow) {
            /** @type {?} */
            var form = this.grid.selectedRow.data;
            /** @type {?} */
            var model = new ExecuteFormModel();
            model.Id = ProcessDeUtil.GenerateElementId();
            model.Name = form.name;
            model.ComponentId = form.appId;
            model.FormType = form.formType;
            model.formFormatId = form.formFormatId;
            model.TerminalType = this.tab === 'web' ? TerminalType.PC : TerminalType.MOBILE;
            model.ActualParameters = form.actualParameters.map((/**
             * @param {?} p
             * @return {?}
             */
            function (p) {
                /** @type {?} */
                var a = new ActualParameter$1();
                a.Name = p.code;
                a.Tag = p.valueType ? p.valueType : _this.initVariableType(p.value);
                a.Value = p.value;
                return a;
            }));
            this.submit.next(model);
        }
        else {
            this.message.info(this.localePipe.transform('component.executeForms.selectedRow'));
        }
    };
    /**
     * @return {?}
     */
    AddExecuteFormComponent.prototype.clickCancel = /**
     * @return {?}
     */
    function () {
        this.cancel.next();
    };
    // selectOtherFormFormat() {
    //   this.lookUp.showDialog();
    // }
    // dictPicking = (arg) => {
    //   return of({
    //     showDialog: true, data: {
    //       tab: this.tab
    //     }
    //   });
    // }
    // dictPicked = (data: any): Observable<PickedResult> => {
    //   const model = new ExecuteFormModel();
    //   model.Id = ProcessDeUtil.GenerateElementId();
    //   model.Name = data.name;
    //   model.ComponentId = null;
    //   model.FormType = '0';
    //   model.formFormatId = data.id;
    //   model.TerminalType = this.tab === 'web' ? TerminalType.PC : TerminalType.MOBILE;
    //   model.ActualParameters = data.urlParameters.map(p => {
    //     const a = new ActualParameter();
    //     a.Name = p.code;
    //     a.Value = p.value;
    //     return a;
    //   });
    //   this.submit.next(model);
    //   return of({ closeDialog: true });
    // }
    // selectOtherFunc() {
    //   this.appHelper.showHelp(this.session.getUserSessionId());
    // }
    // funcSelected(apps: RtfApp[]) {
    //   if (apps && apps.length > 0) {
    //     const model = new ExecuteFormModel();
    //     model.Id = ProcessDeUtil.GenerateElementId();
    //     model.Name = apps[0].Name;
    //     model.ComponentId = apps[0].Id;
    //     model.FormType = '0';
    //     model.formFormatId = null;
    //     model.TerminalType = this.tab === 'web' ? TerminalType.PC : TerminalType.MOBILE;
    //     model.ActualParameters = [];
    //     if (apps[0].InvokingConfig['entityParams']) {
    //       const paras = JSON.parse(apps[0].InvokingConfig['entityParams']);
    //       model.ActualParameters = paras.map(p => ({
    //         Name: p.name,
    //         Value: ''
    //       }));
    //     }
    //     setTimeout(() => {
    //       this.submit.next(model);
    //     }, 0);
    //   }
    // }
    // selectOtherFormFormat() {
    //   this.lookUp.showDialog();
    // }
    // dictPicking = (arg) => {
    //   return of({
    //     showDialog: true, data: {
    //       tab: this.tab
    //     }
    //   });
    // }
    // dictPicked = (data: any): Observable<PickedResult> => {
    //   const model = new ExecuteFormModel();
    //   model.Id = ProcessDeUtil.GenerateElementId();
    //   model.Name = data.name;
    //   model.ComponentId = null;
    //   model.FormType = '0';
    //   model.formFormatId = data.id;
    //   model.TerminalType = this.tab === 'web' ? TerminalType.PC : TerminalType.MOBILE;
    //   model.ActualParameters = data.urlParameters.map(p => {
    //     const a = new ActualParameter();
    //     a.Name = p.code;
    //     a.Value = p.value;
    //     return a;
    //   });
    //   this.submit.next(model);
    //   return of({ closeDialog: true });
    // }
    // selectOtherFunc() {
    //   this.appHelper.showHelp(this.session.getUserSessionId());
    // }
    // funcSelected(apps: RtfApp[]) {
    //   if (apps && apps.length > 0) {
    //     const model = new ExecuteFormModel();
    //     model.Id = ProcessDeUtil.GenerateElementId();
    //     model.Name = apps[0].Name;
    //     model.ComponentId = apps[0].Id;
    //     model.FormType = '0';
    //     model.formFormatId = null;
    //     model.TerminalType = this.tab === 'web' ? TerminalType.PC : TerminalType.MOBILE;
    //     model.ActualParameters = [];
    //     if (apps[0].InvokingConfig['entityParams']) {
    //       const paras = JSON.parse(apps[0].InvokingConfig['entityParams']);
    //       model.ActualParameters = paras.map(p => ({
    //         Name: p.name,
    //         Value: ''
    //       }));
    //     }
    //     setTimeout(() => {
    //       this.submit.next(model);
    //     }, 0);
    //   }
    // }
    /**
     * @private
     * @return {?}
     */
    AddExecuteFormComponent.prototype.getAllExecuteForms = 
    // selectOtherFormFormat() {
    //   this.lookUp.showDialog();
    // }
    // dictPicking = (arg) => {
    //   return of({
    //     showDialog: true, data: {
    //       tab: this.tab
    //     }
    //   });
    // }
    // dictPicked = (data: any): Observable<PickedResult> => {
    //   const model = new ExecuteFormModel();
    //   model.Id = ProcessDeUtil.GenerateElementId();
    //   model.Name = data.name;
    //   model.ComponentId = null;
    //   model.FormType = '0';
    //   model.formFormatId = data.id;
    //   model.TerminalType = this.tab === 'web' ? TerminalType.PC : TerminalType.MOBILE;
    //   model.ActualParameters = data.urlParameters.map(p => {
    //     const a = new ActualParameter();
    //     a.Name = p.code;
    //     a.Value = p.value;
    //     return a;
    //   });
    //   this.submit.next(model);
    //   return of({ closeDialog: true });
    // }
    // selectOtherFunc() {
    //   this.appHelper.showHelp(this.session.getUserSessionId());
    // }
    // funcSelected(apps: RtfApp[]) {
    //   if (apps && apps.length > 0) {
    //     const model = new ExecuteFormModel();
    //     model.Id = ProcessDeUtil.GenerateElementId();
    //     model.Name = apps[0].Name;
    //     model.ComponentId = apps[0].Id;
    //     model.FormType = '0';
    //     model.formFormatId = null;
    //     model.TerminalType = this.tab === 'web' ? TerminalType.PC : TerminalType.MOBILE;
    //     model.ActualParameters = [];
    //     if (apps[0].InvokingConfig['entityParams']) {
    //       const paras = JSON.parse(apps[0].InvokingConfig['entityParams']);
    //       model.ActualParameters = paras.map(p => ({
    //         Name: p.name,
    //         Value: ''
    //       }));
    //     }
    //     setTimeout(() => {
    //       this.submit.next(model);
    //     }, 0);
    //   }
    // }
    /**
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        forkJoin(this.getExecuteForms(), this.getFormFormats()).subscribe((/**
         * @param {?} re
         * @return {?}
         */
        function (re) {
            var e_1, _a;
            if (re[0]) {
                _this.forms = re[0];
            }
            if (re[1] && re[1].length > 0) {
                /** @type {?} */
                var formFormats = re[1];
                var _loop_1 = function (format) {
                    if (_this.forms.findIndex((/**
                     * @param {?} f
                     * @return {?}
                     */
                    function (f) { return f.formFormatId && f.formFormatId === format.id; })) === -1) {
                        /** @type {?} */
                        var executeForm = new ExecuteForm$1();
                        executeForm.id = ProcessDeUtil.createNM();
                        executeForm.flowFormKey = _this.state.flowFormInfo.flowForm.id;
                        executeForm.appId = null;
                        executeForm.code = format.code;
                        executeForm.name = format.name;
                        executeForm.actualParameters = [];
                        executeForm.isDefault = false;
                        executeForm.formType = '0';
                        executeForm.terminal = 'web';
                        executeForm.formFormatId = format.id;
                        executeForm.sysInit = 0;
                        executeForm.remarks = '';
                        if (format.urlParameters && format.urlParameters.length > 0) {
                            /** @type {?} */
                            var actPList = format.urlParameters.map((/**
                             * @param {?} p
                             * @return {?}
                             */
                            function (p) { return ({
                                code: p.code,
                                name: p.name,
                                valueType: p.valueType ? p.valueType : _this.initVariableType(p.value),
                                value: p.value
                            }); }));
                            executeForm.actualParameters = actPList;
                        }
                        _this.forms.push(executeForm);
                    }
                };
                try {
                    for (var formFormats_1 = __values(formFormats), formFormats_1_1 = formFormats_1.next(); !formFormats_1_1.done; formFormats_1_1 = formFormats_1.next()) {
                        var format = formFormats_1_1.value;
                        _loop_1(format);
                    }
                }
                catch (e_1_1) { e_1 = { error: e_1_1 }; }
                finally {
                    try {
                        if (formFormats_1_1 && !formFormats_1_1.done && (_a = formFormats_1.return)) _a.call(formFormats_1);
                    }
                    finally { if (e_1) throw e_1.error; }
                }
            }
        }));
    };
    /**
     * @param {?} value
     * @return {?}
     */
    AddExecuteFormComponent.prototype.initVariableType = /**
     * @param {?} value
     * @return {?}
     */
    function (value) {
        if (value) {
            if (value.length >= 8 && value.slice(0, 8) === "{\"expr\":") {
                return 'expression';
            }
            else {
                return 'constant';
            }
        }
        else {
            return 'variable';
        }
    };
    /**
     * @private
     * @return {?}
     */
    AddExecuteFormComponent.prototype.getExecuteForms = /**
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        if (this.state.flowFormInfo.flowForm.id && this.tab) {
            /** @type {?} */
            var url = "/api/runtime/wf/v1.0/excuteForm?flowFormKey=" + this.state.flowFormInfo.flowForm.id;
            return this.http.get(url).pipe(map((/**
             * @param {?} re
             * @return {?}
             */
            function (re) {
                if (_this.tab === 'web') {
                    return re.filter((/**
                     * @param {?} f
                     * @return {?}
                     */
                    function (f) { return f.terminal.indexOf('web') > -1; }));
                }
                else if (_this.tab === 'mobile') {
                    return re.filter((/**
                     * @param {?} f
                     * @return {?}
                     */
                    function (f) { return f.terminal.indexOf('app') > -1; }));
                }
            })));
        }
        else {
            return from(new Array());
        }
    };
    /**
     * @private
     * @return {?}
     */
    AddExecuteFormComponent.prototype.getFormFormats = /**
     * @private
     * @return {?}
     */
    function () {
        if (this.state.flowFormInfo.flowForm.businessObjectId && this.tab) {
            /** @type {?} */
            var terminal = this.tab === 'web' ? 'PC' : 'Mobile';
            /** @type {?} */
            var url = "/api/runtime/wf/v1.0/formFormat/query?param=";
            /** @type {?} */
            var param = "{\"bizCategory\":\"" + this.state.flowFormInfo.flowForm.businessObjectId + "\",\"terminal\":\"" + terminal + "\"}";
            param = encodeURIComponent(param);
            url += param;
            return this.http.get(url);
        }
        else {
            return from(new Array());
        }
    };
    AddExecuteFormComponent.decorators = [
        { type: Component, args: [{
                    selector: 'lib-add-execute-form',
                    template: "<div class=\"f-page f-page-is-managelist\">\r\n  <div class=\"f-page-main my-0\">\r\n    <div class=\"f-struct-wrapper f-utils-fill-flex-column\">\r\n      <farris-section class=\"f-section-grid f-section-in-managelist p-2\" [showHeader]=\"false\">\r\n        <farris-datagrid class=\"f-component-grid\" [columns]=\"columns\" [data]=\"forms\" #grid\r\n          [idField]=\"'id'\" [showLineNumber]=\"true\" [striped]=\"true\"\r\n          [showCheckbox]=\"false\" [virtualized]=\"true\" [pagination]=\"false\" [fit]=\"true\" [fitColumns]=\"true\">\r\n        </farris-datagrid>\r\n      </farris-section>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type=\"button\" class=\"btn btn-secondary btn-sm\" (click)=\"clickCancel()\">{{'component.executeForms.clickCancel' | wfLocale}}</button>\r\n  <button type=\"button\" class=\"btn btn-primary btn-sm mx-2\" (click)=\"clickOK()\">{{'component.executeForms.clickOK' | wfLocale}}</button>\r\n</ng-template>\r\n<!--\r\n<app-rtf-app-help #appHelper (afterHelpConfirm)=\"funcSelected($event)\" [isLayeredLoad]=\"true\">\r\n</app-rtf-app-help>\r\n\r\n<farris-lookup-grid #lookup style=\"display: none;\" [editable]=\"false\" [columns]=\"cols\" [singleSelect]=\"true\"\r\n  title=\"'\u5355\u636E\u683C\u5F0F'\" [displayType]=\"'List'\" [uri]=\"dataUri\" [idField]=\"'id'\" [pageIndex]=\"1\" [pageSize]=\"20\"\r\n  [pagination]=\"true\" [valueField]=\"'id'\" [textField]=\"'name'\" [dialogWidth]=\"550\" [dictPicked]=\"dictPicked\"\r\n  [dictPicking]=\"dictPicking\">\r\n</farris-lookup-grid> -->\r\n",
                    providers: [{
                            provide: ServerSideToken, useClass: FormFormatService
                        },
                        WfLocalePipe
                    ],
                    styles: [""]
                }] }
    ];
    /** @nocollapse */
    AddExecuteFormComponent.ctorParameters = function () { return [
        { type: ProcessDesignerUIState },
        { type: HttpService },
        { type: SessionService },
        { type: MessagerService },
        { type: ChangeDetectorRef, decorators: [{ type: Optional }] },
        { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
        { type: undefined, decorators: [{ type: Inject, args: [WF_LANG_RESOURCES,] }] },
        { type: WfLocalePipe, decorators: [{ type: Optional }] }
    ]; };
    AddExecuteFormComponent.propDecorators = {
        modalFooter: [{ type: ViewChild, args: ['iconSelectFooter',] }],
        grid: [{ type: ViewChild, args: ['grid',] }]
    };
    return AddExecuteFormComponent;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var FormFormat = /** @class */ (function () {
    function FormFormat() {
    }
    return FormFormat;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var FormFormatConfig = /** @class */ (function () {
    function FormFormatConfig() {
        this.id = ProcessDeUtil.createNM();
        this.formMethodConfigs = new Array();
    }
    return FormFormatConfig;
}());
var FormButtonConfig = /** @class */ (function () {
    function FormButtonConfig() {
    }
    return FormButtonConfig;
}());
var FormFieldConfig = /** @class */ (function () {
    function FormFieldConfig() {
    }
    return FormFieldConfig;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/** @type {?} */
var workFlowActions = [
    { text: '正向', value: 'Forward' },
    { text: '反向', value: 'Backward' },
    { text: '终止', value: 'Abort' }
];
/** @type {?} */
var executionTime = [
    { text: '流转前', value: 'Pre' },
    { text: '流转后', value: 'Post' }
];
var FormMethodConfig = /** @class */ (function () {
    function FormMethodConfig() {
        this.id = ProcessDeUtil.createNM();
        this.workFlowAction = workFlowActions[0].value;
        this.executionTime = executionTime[0].value;
        this.sortOrder = 1;
    }
    return FormMethodConfig;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var VariableGridComponent = /** @class */ (function () {
    function VariableGridComponent(cdr, localeId, resources, localePipe) {
        this.cdr = cdr;
        this.localeId = localeId;
        this.resources = resources;
        this.localePipe = localePipe;
        this.cancel = new EventEmitter();
        this.submit = new EventEmitter();
        this.data = [];
        this.columns = [
            { field: 'key', width: 50, title: this.localePipe.transform('component.executeForms.key') },
            { field: 'name', width: 50, title: this.localePipe.transform('component.executeForms.name') }
        ];
        this.localePipe = this.localePipe || new WfLocalePipe(localeId, resources);
    }
    /**
     * @return {?}
     */
    VariableGridComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
    };
    /**
     * @return {?}
     */
    VariableGridComponent.prototype.clickOK = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var selectedRow = this.grid.selectedRow;
        console.log(selectedRow);
        if (!selectedRow) {
            this.submit.next(null);
        }
        else {
            this.submit.next(selectedRow.data);
        }
    };
    /**
     * @return {?}
     */
    VariableGridComponent.prototype.clickCancel = /**
     * @return {?}
     */
    function () {
        this.cancel.next();
    };
    VariableGridComponent.decorators = [
        { type: Component, args: [{
                    selector: 'lib-variable-grid',
                    template: "<div class=\"f-page\">\r\n  <div class=\"f-page-main f-utils-fill-flex-column h-100\">\r\n    <div class=\"f-utils-fill-flex-column farris-overflow-y-auto h-100\">\r\n      <farris-datagrid #grid [data]=\"data\" [columns]=\"columns\" [idField]=\"'key'\" [fit]=\"true\" [fitColumns]=\"true\"\r\n         [pagination]=\"false\" [showCheckbox]=\"false\" [multiSelect]=\"false\" [showLineNumber]=\"true\" lineNumberTitle=\"{{'component.executeForms.lineNumber' | wfLocale}}\"\r\n         [lineNumberWidth]=\"50\">\r\n      </farris-datagrid>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #buttonRef>\r\n    <button type=\"button\" class=\"btn btn-secondary btn-sm px-3\" (click)=\"clickCancel()\">{{'component.executeForms.clickCancel' | wfLocale}}</button>\r\n    <button type=\"button\" class=\"btn btn-primary btn-sm px-3 mx-2\" (click)=\"clickOK()\">{{'component.executeForms.clickOK' | wfLocale}}</button>\r\n</ng-template>\r\n",
                    providers: [
                        WfLocalePipe,
                    ],
                    styles: [""]
                }] }
    ];
    /** @nocollapse */
    VariableGridComponent.ctorParameters = function () { return [
        { type: ChangeDetectorRef, decorators: [{ type: Optional }] },
        { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
        { type: undefined, decorators: [{ type: Inject, args: [WF_LANG_RESOURCES,] }] },
        { type: WfLocalePipe, decorators: [{ type: Optional }] }
    ]; };
    VariableGridComponent.propDecorators = {
        grid: [{ type: ViewChild, args: [DatagridComponent,] }],
        buttonRef: [{ type: ViewChild, args: ['buttonRef',] }],
        cancel: [{ type: Output }],
        submit: [{ type: Output }]
    };
    return VariableGridComponent;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var ParameterSettingComponent = /** @class */ (function () {
    function ParameterSettingComponent(expr, designerState, resolver, modalService, injector, cdr, localeId, resources, localePipe) {
        var _this = this;
        this.expr = expr;
        this.designerState = designerState;
        this.resolver = resolver;
        this.modalService = modalService;
        this.injector = injector;
        this.cdr = cdr;
        this.localeId = localeId;
        this.resources = resources;
        this.localePipe = localePipe;
        this.idField = 'Name';
        this._mode = 'bpmn';
        this.submit = new Subject();
        this.cancel = new Subject();
        this.formTypeCollection = [
            { text: this.localePipe.transform('component.executeForms.processEmbeddedForm'), value: '0' },
            { text: this.localePipe.transform('component.executeForms.formEmbedProcess'), value: '1' },
        ];
        this.valueTypeCollection = [
            { text: this.localePipe.transform('component.executeForms.variable'), value: 'variable' },
            { text: this.localePipe.transform('component.executeForms.constant'), value: 'constant' },
            { text: this.localePipe.transform('component.executeForms.expression'), value: 'expression' }
        ];
        this.cols = new Array();
        this.parameters = new Array();
        this.formType = this.formTypeCollection[0].value;
        this.showFormType = false;
        this.allParameters = new Array();
        this.beforeEdit = (/**
         * @param {?} param
         * @return {?}
         */
        function (param) {
            if (_this.mode === 'usual') {
                return of$1(true);
            }
            else {
                if (param.column.field === 'Value') {
                    /** @type {?} */
                    var rowData = (/** @type {?} */ (param.rowData));
                    switch (rowData.Tag) {
                        case 'expression':
                            param.column.editor = {
                                type: 'input-group',
                                options: {
                                    groupText: '<i class="f-icon f-icon-lookup"></i>',
                                    editable: false,
                                    clickHandle: (/**
                                     * @param {?} e
                                     * @return {?}
                                     */
                                    function (e) {
                                        e.formControl.setValue(e.instance.value ? e.instance.value : '');
                                        _this.showExprHelp(e);
                                    }),
                                    clear: (/**
                                     * @param {?} e
                                     * @return {?}
                                     */
                                    function (e) {
                                        console.log('clear', e);
                                    })
                                }
                            };
                            break;
                        case 'variable':
                            param.column.editor = {
                                type: 'input-group',
                                options: {
                                    groupText: '<i class="f-icon f-icon-lookup"></i>',
                                    editable: true,
                                    clickHandle: (/**
                                     * @param {?} e
                                     * @return {?}
                                     */
                                    function (e) {
                                        _this.selectVariable(e);
                                    }),
                                    clear: (/**
                                     * @param {?} e
                                     * @return {?}
                                     */
                                    function (e) {
                                        console.log('clear', e);
                                    })
                                }
                            };
                            break;
                        case 'constant':
                            param.column.editor = { type: EditorTypes.TEXTBOX, options: {} };
                            break;
                    }
                }
                return of$1(true);
            }
        });
        this.localePipe = this.localePipe || new WfLocalePipe(localeId, resources);
    }
    Object.defineProperty(ParameterSettingComponent.prototype, "mode", {
        get: /**
         * @return {?}
         */
        function () {
            return this._mode;
        },
        set: /**
         * @param {?} m
         * @return {?}
         */
        function (m) {
            var _this = this;
            this._mode = m;
            if (m === 'bpmn') {
                this.idField = 'Name';
                this.cols = [
                    { field: 'Name', width: 50, title: this.localePipe.transform('component.executeForms.code') },
                    { field: 'Tag', width: 50, title: this.localePipe.transform('component.executeForms.tag'), formatter: {
                            type: 'enum',
                            options: { valueField: 'value', textField: 'text', data: this.valueTypeCollection }
                        },
                        editor: {
                            type: EditorTypes.COMBOLIST,
                            options: {
                                valueField: 'value', textField: 'text', data: this.valueTypeCollection, idField: 'value', panelHeight: 'auto', enableClear: false,
                                selectChange: (/**
                                 * @param {?} e
                                 * @return {?}
                                 */
                                function (e) {
                                    _this.valueTypeChange(e);
                                })
                            }
                        } },
                    {
                        field: 'Value', width: 100, title: this.localePipe.transform('component.executeForms.value'),
                        editor: {
                            type: 'input-group',
                            options: {
                                groupText: '<i class="f-icon f-icon-lookup"></i>',
                                editable: false,
                                clickHandle: (/**
                                 * @param {?} e
                                 * @return {?}
                                 */
                                function (e) {
                                    e.formControl.setValue(e.instance.value ? e.instance.value : '');
                                    _this.showExprHelp(e);
                                }),
                                clear: (/**
                                 * @param {?} e
                                 * @return {?}
                                 */
                                function (e) {
                                    console.log('clear', e);
                                })
                            }
                        }
                    }
                ];
            }
            else {
                this.idField = 'code';
                this.cols = [
                    { field: 'code', width: 50, title: this.localePipe.transform('component.executeForms.code') },
                    { field: 'name', width: 50, title: this.localePipe.transform('component.executeForms.name') },
                    {
                        field: 'value', width: 100, title: this.localePipe.transform('component.executeForms.value'),
                        editor: {
                            type: 'input-group',
                            options: {
                                groupText: '<i class="f-icon f-icon-lookup"></i>',
                                editable: false,
                                clickHandle: (/**
                                 * @param {?} e
                                 * @return {?}
                                 */
                                function (e) {
                                    e.formControl.setValue(e.instance.value ? e.instance.value : '');
                                    _this.showExprHelp(e);
                                }),
                                clear: (/**
                                 * @param {?} e
                                 * @return {?}
                                 */
                                function (e) {
                                    console.log('clear', e);
                                })
                            }
                        }
                    }
                ];
            }
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    ParameterSettingComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
    };
    /**
     * @param {?} e
     * @return {?}
     */
    ParameterSettingComponent.prototype.showExprHelp = /**
     * @param {?} e
     * @return {?}
     */
    function (e) {
        var _this = this;
        var e_1, _a, e_2, _b, e_3, _c;
        /** @type {?} */
        var context = new Array();
        // if(this.expr.exprEntity.contextEntities.find(x => x.key === 'CurrentLanguage')) {
        //   context.push(this.expr.exprEntity.contextEntities.find(x => x.key === 'CurrentLanguage'));
        // }
        // this.expr.clearContext();
        if (this.designerState.schemas.length > 0) {
            try {
                for (var _d = __values(this.designerState.schemas), _e = _d.next(); !_e.done; _e = _d.next()) {
                    var schema = _e.value;
                    this.expr.addSchema('Schema', schema);
                }
            }
            catch (e_1_1) { e_1 = { error: e_1_1 }; }
            finally {
                try {
                    if (_e && !_e.done && (_a = _d.return)) _a.call(_d);
                }
                finally { if (e_1) throw e_1.error; }
            }
            if (this.designerState.schemas[0].entityTypes && this.designerState.schemas[0].entityTypes.length > 0) {
                /** @type {?} */
                var entityType = this.designerState.schemas[0].entityTypes[0];
                this.expr.addInjectedEntity(entityType.name, 'Schema', entityType.name, InjectedType.EntityType);
            }
        }
        context = this.designerState.addContext(context);
        if (this.designerState.subActivityContext.length > 0) {
            var _loop_1 = function (variable) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    context.push(variable);
                }
            };
            try {
                for (var _f = __values(this.designerState.subActivityContext), _g = _f.next(); !_g.done; _g = _f.next()) {
                    var variable = _g.value;
                    _loop_1(variable);
                }
            }
            catch (e_2_1) { e_2 = { error: e_2_1 }; }
            finally {
                try {
                    if (_g && !_g.done && (_b = _f.return)) _b.call(_f);
                }
                finally { if (e_2) throw e_2.error; }
            }
        }
        if (context.length > 0) {
            try {
                for (var context_1 = __values(context), context_1_1 = context_1.next(); !context_1_1.done; context_1_1 = context_1.next()) {
                    var v = context_1_1.value;
                    this.expr.addContext(v);
                }
            }
            catch (e_3_1) { e_3 = { error: e_3_1 }; }
            finally {
                try {
                    if (context_1_1 && !context_1_1.done && (_c = context_1.return)) _c.call(context_1);
                }
                finally { if (e_3) throw e_3.error; }
            }
        }
        this.expr.addExpressionText(e.instance.value);
        this.expr.buildExpression().then((/**
         * @param {?} d
         * @return {?}
         */
        function (d) {
            if (d) {
                e.formControl.setValue(d);
                e.instance.cd.detectChanges();
            }
            //点击确定后，去除表达式里面的新增的上下文变量
            if (context.length > 0) {
                _this.expr.exprEntity.contextEntities = _this.expr.exprEntity.contextEntities.filter((/**
                 * @param {?} x
                 * @return {?}
                 */
                function (x) { return !context.some((/**
                 * @param {?} y
                 * @return {?}
                 */
                function (y) { return y.key === x.key; })); }));
            }
        }));
    };
    /**
     * @return {?}
     */
    ParameterSettingComponent.prototype.clickOK = /**
     * @return {?}
     */
    function () {
        this.grid.endCellEdit();
        this.submit.next({ parameters: this.parameters, formType: this.formType });
    };
    /**
     * @return {?}
     */
    ParameterSettingComponent.prototype.clickCancel = /**
     * @return {?}
     */
    function () {
        this.cancel.next();
    };
    /**
     * @param {?} e
     * @return {?}
     */
    ParameterSettingComponent.prototype.valueTypeChange = /**
     * @param {?} e
     * @return {?}
     */
    function (e) {
        /** @type {?} */
        var param = this.parameters.find((/**
         * @param {?} p
         * @return {?}
         */
        function (p) { return p.Name === e.rowData.Name; }));
        param.Value = '';
    };
    /**
     * @param {?} e
     * @return {?}
     */
    ParameterSettingComponent.prototype.selectVariable = /**
     * @param {?} e
     * @return {?}
     */
    function (e) {
        /** @type {?} */
        var compFactory = this.resolver.resolveComponentFactory(VariableGridComponent);
        /** @type {?} */
        var compRef = compFactory.create(this.injector);
        compRef.instance.data = this.allParameters; // 目前只能根据元数据类型过滤，后续添加标签过滤
        // 目前只能根据元数据类型过滤，后续添加标签过滤
        /** @type {?} */
        var modalConfig = {
            title: this.localePipe.transform('component.executeForms.variable'),
            width: 460,
            height: 450,
            showButtons: true,
            buttons: compRef.instance.buttonRef
        };
        /** @type {?} */
        var dialog = this.modalService.show(compRef, modalConfig);
        compRef.instance.submit.subscribe((/**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            if (data) {
                e.formControl.setValue(data.key);
                e.instance.cd.detectChanges();
            }
            dialog.close();
        }));
        compRef.instance.cancel.subscribe((/**
         * @param {?} data
         * @return {?}
         */
        function (data) { return dialog.close(); }));
    };
    ParameterSettingComponent.decorators = [
        { type: Component, args: [{
                    selector: 'lib-parameter-setting',
                    template: "\r\n<div class=\"f-page f-page-is-managelist\">\r\n  <div class=\"f-page-main my-0\">\r\n    <div class=\"f-struct-wrapper f-utils-fill-flex-column\">\r\n      <farris-section class=\"f-section-grid f-section-in-managelist px-0\" [showHeader]=\"showFormType\" mainTitle=\"{{'component.executeForms.parametersSet' | wfLocale}}\" [enableMaximize]=\"false\">\r\n        <ng-template farrisSectionToolbar>\r\n          <farris-combo-list [(ngModel)]=\"formType\" name=\"formType\" [idField]=\"'value'\" [textField]=\"'text'\"\r\n            [enableClear]=\"false\" [valueField]=\"'value'\" [data]=\"formTypeCollection\" [panelHeight]=\"'auto'\" [editable]=\"false\"\r\n            style=\"width: 130px;\">\r\n          </farris-combo-list>\r\n        </ng-template>\r\n        <farris-datagrid class=\"f-component-grid\" [columns]=\"cols\" [data]=\"parameters\" #grid\r\n          [idField]=\"idField\" [fit]=\"true\" [fitColumns]=\"true\" [editable]=\"true\" [editMode]=\"'cell'\" [pagination]=\"false\"\r\n          [showCheckbox]=\"false\" [multiSelect]=\"false\" [showLineNumber]=\"true\" [striped]=\"true\" [beforeEdit]=\"beforeEdit\"\r\n          [virtualized]=\"true\">\r\n        </farris-datagrid>\r\n      </farris-section>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type=\"button\" class=\"btn btn-secondary btn-sm\" (click)=\"clickCancel()\">{{'component.executeForms.clickCancel' | wfLocale}}</button>\r\n  <button type=\"button\" class=\"btn btn-primary btn-sm mx-2\" (click)=\"clickOK()\">{{'component.executeForms.clickOK' | wfLocale}}</button>\r\n</ng-template>\r\n",
                    providers: [
                        WfLocalePipe,
                    ],
                    styles: [""]
                }] }
    ];
    /** @nocollapse */
    ParameterSettingComponent.ctorParameters = function () { return [
        { type: ExpressionService },
        { type: ProcessDesignerUIState },
        { type: ComponentFactoryResolver },
        { type: BsModalService },
        { type: Injector },
        { type: ChangeDetectorRef, decorators: [{ type: Optional }] },
        { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
        { type: undefined, decorators: [{ type: Inject, args: [WF_LANG_RESOURCES,] }] },
        { type: WfLocalePipe, decorators: [{ type: Optional }] }
    ]; };
    ParameterSettingComponent.propDecorators = {
        modalFooter: [{ type: ViewChild, args: ['iconSelectFooter',] }],
        grid: [{ type: ViewChild, args: ['grid',] }]
    };
    return ParameterSettingComponent;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var FormOperationConfigComponent = /** @class */ (function () {
    function FormOperationConfigComponent(http, message, resolver, injector, modalService, cdr, localeId, resources, localePipe) {
        this.http = http;
        this.message = message;
        this.resolver = resolver;
        this.injector = injector;
        this.modalService = modalService;
        this.cdr = cdr;
        this.localeId = localeId;
        this.resources = resources;
        this.localePipe = localePipe;
        this.operations = new Array();
        this.cols = new Array();
        this.methodCols = [
            { field: 'method', width: 100, title: this.localePipe.transform("component.executeForms.method"), showTips: true },
            { field: 'methodName', width: 80, title: this.localePipe.transform("component.executeForms.methodName"), showTips: true },
            { field: 'description', width: 120, title: this.localePipe.transform("component.executeForms.description"), showTips: true }
        ];
        this.formMethods = new Array();
        this.state = 'add';
    }
    Object.defineProperty(FormOperationConfigComponent.prototype, "formFormatId", {
        get: /**
         * @return {?}
         */
        function () {
            return this._fromFormatId;
        },
        set: /**
         * @param {?} v
         * @return {?}
         */
        function (v) {
            this._fromFormatId = v;
            if (this._fromFormatId) {
                this.getFormMethods();
            }
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    FormOperationConfigComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.cols = [
            {
                field: 'workFlowAction', width: 80, title: this.localePipe.transform("component.executeForms.workFlowAction"),
                formatter: {
                    type: 'enum',
                    options: { valueField: 'value', textField: 'text', data: workFlowActions }
                },
                editor: {
                    type: EditorTypes.COMBOLIST,
                    options: { valueField: 'value', textField: 'text', data: workFlowActions, idField: 'value', panelHeight: 'auto', enableClear: false }
                },
                validators: [
                    { type: 'required', messager: '必填' }
                ]
            }, {
                field: 'method', width: 100, title: this.localePipe.transform("component.executeForms.formOperations"),
                editor: {
                    type: 'input-group',
                    options: {
                        groupText: '<i class="f-icon f-icon-lookup"></i>',
                        editable: false,
                        clickHandle: (/**
                         * @param {?} e
                         * @return {?}
                         */
                        function (e) {
                            e.formControl.setValue(e.instance.value ? e.instance.value : '');
                            _this.e = e;
                            _this.methodsDialog.show();
                            _this.state = 'edit';
                        }),
                        clear: (/**
                         * @param {?} e
                         * @return {?}
                         */
                        function (e) {
                            console.log('clear', e);
                        })
                    }
                },
                formatter: (/**
                 * @param {?} v
                 * @param {?} d
                 * @param {?} i
                 * @return {?}
                 */
                function (v, d, i) {
                    if (v) {
                        /** @type {?} */
                        var m = _this.formMethods.find((/**
                         * @param {?} item
                         * @return {?}
                         */
                        function (item) { return item.method === v; }));
                        if (m) {
                            return m.methodName;
                        }
                        else {
                            return '';
                        }
                    }
                    else {
                        return '';
                    }
                }),
                validators: [
                    { type: 'required', messager: '必填' }
                ]
            },
            {
                field: 'executionTime', width: 80, title: this.localePipe.transform("component.executeForms.executionTime"),
                formatter: {
                    type: 'enum',
                    options: { valueField: 'value', textField: 'text', data: executionTime }
                },
                editor: {
                    type: EditorTypes.COMBOLIST,
                    options: { valueField: 'value', textField: 'text', data: executionTime, idField: 'value', panelHeight: 'auto', enableClear: false }
                },
                validators: [
                    { type: 'required', messager: '必填' }
                ]
            },
            {
                field: 'sortOrder', width: 60, title: this.localePipe.transform("component.executeForms.sortOrder"),
                editor: {
                    type: EditorTypes.NUMBERBOX, options: {}
                },
                formatter: { type: 'number', options: { precision: 0 } },
                validators: [
                    { type: 'required', messager: '必填' }
                ]
            },
            {
                field: 'methodParameters', width: 80, title: this.localePipe.transform("component.executeForms.methodParameters"),
                template: this.cell,
                halign: 'center', align: 'center'
            }
        ];
    };
    /**
     * @return {?}
     */
    FormOperationConfigComponent.prototype.add = /**
     * @return {?}
     */
    function () {
        this.methodsDialog.show();
        this.state = 'add';
    };
    /**
     * @return {?}
     */
    FormOperationConfigComponent.prototype.delete = /**
     * @return {?}
     */
    function () {
        var _this = this;
        if (this.grid.selectedRow) {
            this.operations = this.operations.filter((/**
             * @param {?} o
             * @return {?}
             */
            function (o) { return o.id !== _this.grid.selectedRow.id; }));
        }
        else {
            this.message.info(this.localePipe.transform("component.executeForms.selectFormActionConfig"));
        }
    };
    /**
     * @param {?} ctx
     * @return {?}
     */
    FormOperationConfigComponent.prototype.editParam = /**
     * @param {?} ctx
     * @return {?}
     */
    function (ctx) {
        var _this = this;
        /** @type {?} */
        var compFactory = this.resolver.resolveComponentFactory(ParameterSettingComponent);
        /** @type {?} */
        var compRef = compFactory.create(this.injector);
        compRef.instance.mode = 'usual';
        compRef.instance.showFormType = false;
        if (ctx.rowData.methodParameters) {
            compRef.instance.parameters = __spread(ctx.rowData.methodParameters.map((/**
             * @param {?} p
             * @return {?}
             */
            function (p) { return Object.assign({}, p); })));
        }
        else {
            compRef.instance.parameters = new Array();
        }
        /** @type {?} */
        var modalConfig = {
            title: this.localePipe.transform("component.executeForms.parameterSettings"),
            width: 620,
            height: 400,
            showButtons: true,
            buttons: compRef.instance.modalFooter
        };
        /** @type {?} */
        var dialog = this.modalService.show(compRef, modalConfig);
        compRef.instance.submit.subscribe((/**
         * @param {?} re
         * @return {?}
         */
        function (re) {
            var e_1, _a;
            try {
                for (var _b = __values(_this.operations), _c = _b.next(); !_c.done; _c = _b.next()) {
                    var o = _c.value;
                    if (o.id === ctx.rowData.id) {
                        o.methodParameters = re.parameters;
                    }
                }
            }
            catch (e_1_1) { e_1 = { error: e_1_1 }; }
            finally {
                try {
                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                }
                finally { if (e_1) throw e_1.error; }
            }
            dialog.close();
        }));
        compRef.instance.cancel.subscribe((/**
         * @param {?} re
         * @return {?}
         */
        function (re) {
            dialog.close();
        }));
    };
    /**
     * @return {?}
     */
    FormOperationConfigComponent.prototype.methodSelected = /**
     * @return {?}
     */
    function () {
        var e_2, _a;
        if (this.methodGrid.selectedRow) {
            /** @type {?} */
            var data = this.methodGrid.selectedRow.data;
            if (this.state === 'edit') {
                if (this.e) {
                    this.e.formControl.setValue(data.method);
                    this.e.instance.cd.detectChanges();
                    try {
                        for (var _b = __values(this.operations), _c = _b.next(); !_c.done; _c = _b.next()) {
                            var o = _c.value;
                            if (o.id === data.id) {
                                o.method = data.method;
                                o.sortOrder = data.sortOrder;
                                o.methodParameters = data.methodParameters;
                            }
                        }
                    }
                    catch (e_2_1) { e_2 = { error: e_2_1 }; }
                    finally {
                        try {
                            if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                        }
                        finally { if (e_2) throw e_2.error; }
                    }
                }
            }
            else {
                /** @type {?} */
                var operation = new FormMethodConfig();
                operation.formFormatConfigId = this.formFormatConfigId;
                operation.method = data.method;
                operation.sortOrder = data.sortOrder;
                operation.methodParameters = data.methodParameters;
                this.operations = this.operations.concat([operation]);
            }
            this.methodsDialog.close();
        }
        else {
            this.message.info(this.localePipe.transform("component.executeForms.selectFormAction"));
        }
    };
    /**
     * @return {?}
     */
    FormOperationConfigComponent.prototype.validator = /**
     * @return {?}
     */
    function () {
        var e_3, _a;
        this.grid.endCellEdit();
        try {
            for (var _b = __values(this.operations), _c = _b.next(); !_c.done; _c = _b.next()) {
                var o = _c.value;
                if (!o.method) {
                    this.message.info(this.localePipe.transform("component.executeForms.selectFormAction"));
                    return false;
                }
            }
        }
        catch (e_3_1) { e_3 = { error: e_3_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_3) throw e_3.error; }
        }
        return true;
    };
    /**
     * @private
     * @return {?}
     */
    FormOperationConfigComponent.prototype.getFormMethods = /**
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        if (this.formFormatId) {
            /** @type {?} */
            var url = "/api/runtime/wf/v1.0/formOperation?formFormatId=" + this.formFormatId;
            this.http.get(url).subscribe((/**
             * @param {?} re
             * @return {?}
             */
            function (re) {
                if (re) {
                    _this.formMethods = re;
                }
            }));
        }
    };
    FormOperationConfigComponent.decorators = [
        { type: Component, args: [{
                    selector: 'lib-form-operation-config',
                    template: "<div class=\"f-utils-fill-flex-column h-100\" style=\"background: #FFF;\">\r\n  <farris-datagrid class=\"f-component-grid f-utils-fill\" [columns]=\"cols\" [data]=\"operations\" #grid\r\n    [idField]=\"'id'\" [showLineNumber]=\"true\" [fitColumns]=\"true\" [striped]=\"true\" [showCheckbox]=\"false\"\r\n    [virtualized]=\"true\" [pagination]=\"false\" [useThemes]=\"false\" [fit]=\"true\"\r\n    [editable]=\"true\" [editMode]=\"'cell'\" >\r\n  </farris-datagrid>\r\n  <ng-template #cell let-ctx>\r\n    <a href=\"javascript: void(0);\" title=\"{{'component.executeForms.parameterSettings'|wfLocale}}\" (click)=\"editParam(ctx)\">{{'component.executeForms.editParam'|wfLocale}}</a>\r\n  </ng-template>\r\n</div>\r\n\r\n<ng-template #buttonRef>\r\n  <button class=\"btn btn-sm btn-default px-3\" (click)=\"methodsDialog.close()\">{{'component.executeForms.clickCancel'|wfLocale}}</button>\r\n  <button class=\"btn btn-sm btn-primary px-3\" (click)=\"methodSelected()\">{{'component.executeForms.clickOK'|wfLocale}}</button>\r\n</ng-template>\r\n<farris-dialog #methodsDialog [buttons]=\"buttonRef\" [width]=\"700\" [height]=\"500\" title=\"{{'component.executeForms.formEvents'|wfLocale}}\">\r\n  <div class=\"f-page f-page-is-managelist\">\r\n    <div class=\"f-page-main\">\r\n      <div class=\"f-struct-wrapper f-utils-fill-flex-column\">\r\n        <farris-section class=\"f-section-grid f-section-in-managelist p-0\" [showHeader]=\"false\">\r\n          <farris-datagrid class=\"f-component-grid\" [columns]=\"methodCols\" [data]=\"formMethods\" #methodGrid [idField]=\"'id'\"\r\n            [showLineNumber]=\"true\" [striped]=\"true\" [showCheckbox]=\"false\" [virtualized]=\"true\" [pagination]=\"false\"\r\n            [fit]=\"true\" [fitColumns]=\"true\">\r\n          </farris-datagrid>\r\n        </farris-section>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</farris-dialog>\r\n\r\n",
                    providers: [
                        WfLocalePipe,
                    ],
                    styles: [""]
                }] }
    ];
    /** @nocollapse */
    FormOperationConfigComponent.ctorParameters = function () { return [
        { type: HttpService },
        { type: MessagerService },
        { type: ComponentFactoryResolver },
        { type: Injector },
        { type: BsModalService },
        { type: ChangeDetectorRef, decorators: [{ type: Optional }] },
        { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
        { type: undefined, decorators: [{ type: Inject, args: [WF_LANG_RESOURCES,] }] },
        { type: WfLocalePipe, decorators: [{ type: Optional }] }
    ]; };
    FormOperationConfigComponent.propDecorators = {
        formFormatId: [{ type: Input }],
        formFormatConfigId: [{ type: Input }],
        operations: [{ type: Input }],
        methodsDialog: [{ type: ViewChild, args: ['methodsDialog',] }],
        grid: [{ type: ViewChild, args: ['grid',] }],
        methodGrid: [{ type: ViewChild, args: ['methodGrid',] }],
        cell: [{ type: ViewChild, args: ['cell',] }]
    };
    return FormOperationConfigComponent;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var FormFormatConfigComponent = /** @class */ (function () {
    function FormFormatConfigComponent(http, message, notify, injector, cdr, localeId, resources, localePipe) {
        this.http = http;
        this.message = message;
        this.notify = notify;
        this.injector = injector;
        this.cdr = cdr;
        this.localeId = localeId;
        this.resources = resources;
        this.localePipe = localePipe;
        this.config = new FormFormatConfig();
        this.formFormat = new FormFormat();
        this.state = 'edit';
        this.showMethodTab = true;
        this.buttonCols = [];
        this.buttonConfigs = new Array();
        this.fieldCols = [];
        this.fieldConfigs = new Array();
        this.formatFieldList = new Array();
        this.showExtendTab = false;
        this.localePipe = this.localePipe || new WfLocalePipe(localeId, resources);
        /** @type {?} */
        var serchFields = {
            label: this.localePipe.transform('component.executeForms.fieldName'),
            value: 'fieldName'
        };
        if (this.searchFields) {
            if (!this.searchFields.some((/**
             * @param {?} x
             * @return {?}
             */
            function (x) { return x.value === serchFields.value; }))) {
                this.searchFields = this.searchFields.concat(serchFields);
            }
        }
        else {
            this.searchFields = [];
            this.searchFields = this.searchFields.concat(serchFields);
        }
    }
    Object.defineProperty(FormFormatConfigComponent.prototype, "formFormatId", {
        get: /**
         * @return {?}
         */
        function () {
            return this._formFormatId;
        },
        set: /**
         * @param {?} v
         * @return {?}
         */
        function (v) {
            this._formFormatId = v;
            this.config.formFormatId = v;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormFormatConfigComponent.prototype, "formatConfigId", {
        get: /**
         * @return {?}
         */
        function () {
            return this._formatConfigId;
        },
        set: /**
         * @param {?} v
         * @return {?}
         */
        function (v) {
            this._formatConfigId = v;
            if (!v) {
                this.state = 'new';
            }
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    FormFormatConfigComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        this.buttonCols = [
            { field: 'buttonName', width: 100, title: this.localePipe.transform('component.executeForms.buttonName'), filter: true },
            // { field: 'buttonId', width: 100, title: '按钮标识' },
            {
                title: this.localePipe.transform('component.executeForms.enable'),
                field: 'enable',
                width: 80,
                template: this.btnEnable,
                align: 'center',
                hAlign: 'center'
            },
            {
                title: this.localePipe.transform('component.executeForms.disabled'),
                field: 'disabled',
                width: 80,
                template: this.btnDisabled,
                align: 'center',
                hAlign: 'center'
            },
            {
                title: this.localePipe.transform('component.executeForms.hidden'),
                field: 'hidden',
                width: 80,
                template: this.btnHidden,
                align: 'center',
                hAlign: 'center'
            }
        ];
        this.fieldCols = [
            { field: 'fieldName', width: 100, title: this.localePipe.transform('component.executeForms.fieldName') },
            // { field: 'fieldId', width: 100, title: '字段标识' },
            {
                title: this.localePipe.transform('component.executeForms.editable'),
                field: 'editable',
                width: 80,
                template: this.fieldEditable,
                align: 'center',
                hAlign: 'center'
            },
            {
                title: this.localePipe.transform('component.executeForms.readonly'),
                field: 'readonly',
                width: 80,
                template: this.fieldReadonly,
                align: 'center',
                hAlign: 'center'
            },
            {
                title: this.localePipe.transform('component.executeForms.hidden'),
                field: 'hidden',
                width: 80,
                template: this.fieldHidden,
                align: 'center',
                hAlign: 'center'
            },
            {
                title: this.localePipe.transform('component.executeForms.required'),
                field: 'required',
                width: 80,
                template: this.fieldRequired,
                align: 'center',
                hAlign: 'center'
            }
        ];
        this.getConfig();
    };
    /**
     * @return {?}
     */
    FormFormatConfigComponent.prototype.submit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var subject = new Subject();
        this.validator().subscribe((/**
         * @param {?} re
         * @return {?}
         */
        function (re) {
            if (re) {
                _this.setBtnAndFieldConfigs();
                if (_this.extendComponentRef) {
                    _this.extendComponentRef.instance.submit().subscribe((/**
                     * @param {?} configId
                     * @return {?}
                     */
                    function (configId) {
                        if (configId) {
                            _this.config.id = configId;
                            _this.saveConfig(_this.config).subscribe((/**
                             * @param {?} re
                             * @return {?}
                             */
                            function (re) {
                                subject.next({ result: true, configId: _this.config.id });
                            }), (/**
                             * @param {?} err
                             * @return {?}
                             */
                            function (err) {
                                _this.message.error(_this.localePipe.transform('component.executeForms.saveFail'));
                                subject.next({ result: false, configId: _this.config.id });
                            }));
                        }
                        else {
                            if (_this.state === 'new' &&
                                _this.config.formButtonConfigs.length === 0 &&
                                _this.config.formFieldConfigs.length === 0 &&
                                _this.operationConfig.operations.length === 0) {
                                setTimeout((/**
                                 * @return {?}
                                 */
                                function () {
                                    subject.next({ result: true, configId: null });
                                }), 10);
                            }
                            else {
                                _this.saveConfig(_this.config).subscribe((/**
                                 * @param {?} re
                                 * @return {?}
                                 */
                                function (re) {
                                    subject.next({ result: true, configId: _this.config.id });
                                }), (/**
                                 * @param {?} err
                                 * @return {?}
                                 */
                                function (err) {
                                    _this.message.error(_this.localePipe.transform('component.executeForms.saveFail'));
                                    subject.next({ result: false, configId: _this.config.id });
                                }));
                            }
                        }
                    }));
                }
                else {
                    if (_this.state === 'new' &&
                        _this.config.formButtonConfigs.length === 0 &&
                        _this.config.formFieldConfigs.length === 0 &&
                        _this.operationConfig.operations.length === 0) {
                        setTimeout((/**
                         * @return {?}
                         */
                        function () {
                            subject.next({ result: true, configId: null });
                        }), 10);
                    }
                    else {
                        _this.saveConfig(_this.config).subscribe((/**
                         * @param {?} re
                         * @return {?}
                         */
                        function (re) {
                            subject.next({ result: true, configId: _this.config.id });
                        }), (/**
                         * @param {?} err
                         * @return {?}
                         */
                        function (err) {
                            _this.message.error(_this.localePipe.transform('component.executeForms.saveFail'));
                            subject.next({ result: false, configId: _this.config.id });
                        }));
                    }
                }
            }
            else {
                setTimeout((/**
                 * @return {?}
                 */
                function () {
                    subject.next({ result: false });
                }), 10);
            }
        }));
        return subject.asObservable();
    };
    /**
     * @param {?} data
     * @return {?}
     */
    FormFormatConfigComponent.prototype.searchField = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        data.field = 'fieldName';
        /** @type {?} */
        var searchData = {
            field: 'fieldName',
            value: data.value
        };
        this.fieldTree.searchData = searchData;
        // this.fieldTree.searchData.field = 'fieldName';
        /** @type {?} */
        var serchFields = {
            label: this.localePipe.transform('component.executeForms.fieldName'),
            value: 'fieldName'
        };
        if (this.fieldTree.searchFields) {
            if (!this.fieldTree.searchFields.some((/**
             * @param {?} x
             * @return {?}
             */
            function (x) { return x.value === serchFields.value; }))) {
                this.fieldTree.searchFields = this.fieldTree.searchFields.concat(serchFields);
            }
        }
        else {
            this.fieldTree.searchFields = [];
            this.fieldTree.searchFields = this.fieldTree.searchFields.concat(serchFields);
        }
        this.fieldTree.searchHandle.search(data.field, data.value, 'client');
    };
    /**
     * @param {?} bool
     * @param {?} field
     * @param {?} id
     * @return {?}
     */
    FormFormatConfigComponent.prototype.btnConfigChange = /**
     * @param {?} bool
     * @param {?} field
     * @param {?} id
     * @return {?}
     */
    function (bool, field, id) {
        var e_1, _a;
        if (bool) {
            try {
                for (var _b = __values(this.buttonConfigs), _c = _b.next(); !_c.done; _c = _b.next()) {
                    var b = _c.value;
                    if (b.id === id) {
                        switch (field) {
                            case 'enable':
                                b.enable = bool;
                                b.disabled = false;
                                b.hidden = false;
                                break;
                            case 'disabled':
                                b.disabled = bool;
                                b.enable = false;
                                b.hidden = false;
                                break;
                            case 'hidden':
                                b.hidden = bool;
                                b.disabled = false;
                                b.enable = false;
                                break;
                        }
                        this.btnGrid.updateRow(id, b);
                    }
                }
            }
            catch (e_1_1) { e_1 = { error: e_1_1 }; }
            finally {
                try {
                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                }
                finally { if (e_1) throw e_1.error; }
            }
        }
        this.btnGrid.cd.detectChanges();
    };
    /**
     * @param {?} operation
     * @return {?}
     */
    FormFormatConfigComponent.prototype.btnBatchOperate = /**
     * @param {?} operation
     * @return {?}
     */
    function (operation) {
        var e_2, _a;
        /** @type {?} */
        var checkeds = this.btnGrid.checkedRows;
        if (checkeds && checkeds.length > 0) {
            try {
                for (var checkeds_1 = __values(checkeds), checkeds_1_1 = checkeds_1.next(); !checkeds_1_1.done; checkeds_1_1 = checkeds_1.next()) {
                    var c = checkeds_1_1.value;
                    this.btnConfigChange(true, operation, c.id);
                }
            }
            catch (e_2_1) { e_2 = { error: e_2_1 }; }
            finally {
                try {
                    if (checkeds_1_1 && !checkeds_1_1.done && (_a = checkeds_1.return)) _a.call(checkeds_1);
                }
                finally { if (e_2) throw e_2.error; }
            }
            this.btnGrid.cd.detectChanges();
        }
        else {
            this.message.info(this.localePipe.transform('component.executeForms.checkedRows'));
        }
    };
    /**
     * @return {?}
     */
    FormFormatConfigComponent.prototype.btnBatchReset = /**
     * @return {?}
     */
    function () {
        var e_3, _a;
        /** @type {?} */
        var checkeds = this.btnGrid.checkedRows;
        if (checkeds && checkeds.length > 0) {
            var _loop_1 = function (c) {
                var e_4, _a;
                /** @type {?} */
                var button = this_1.formFormat.formButtons.find((/**
                 * @param {?} b
                 * @return {?}
                 */
                function (b) { return b.id === c.id; }));
                try {
                    for (var _b = __values(this_1.buttonConfigs), _c = _b.next(); !_c.done; _c = _b.next()) {
                        var b = _c.value;
                        if (b.id === c.id) {
                            b.enable = button.buttonState === 'Enable' ? true : false;
                            b.disabled = button.buttonState === 'Disabled' ? true : false;
                            b.hidden = button.buttonState === 'Hidden' ? true : false;
                        }
                        this_1.btnGrid.updateRow(b.id, b);
                    }
                }
                catch (e_4_1) { e_4 = { error: e_4_1 }; }
                finally {
                    try {
                        if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                    }
                    finally { if (e_4) throw e_4.error; }
                }
            };
            var this_1 = this;
            try {
                for (var checkeds_2 = __values(checkeds), checkeds_2_1 = checkeds_2.next(); !checkeds_2_1.done; checkeds_2_1 = checkeds_2.next()) {
                    var c = checkeds_2_1.value;
                    _loop_1(c);
                }
            }
            catch (e_3_1) { e_3 = { error: e_3_1 }; }
            finally {
                try {
                    if (checkeds_2_1 && !checkeds_2_1.done && (_a = checkeds_2.return)) _a.call(checkeds_2);
                }
                finally { if (e_3) throw e_3.error; }
            }
            this.btnGrid.cd.detectChanges();
        }
        else {
            this.message.info(this.localePipe.transform('component.executeForms.checkedRows'));
        }
    };
    /**
     * @param {?} bool
     * @param {?} field
     * @param {?} id
     * @param {?=} search
     * @return {?}
     */
    FormFormatConfigComponent.prototype.fieldConfigChange = /**
     * @param {?} bool
     * @param {?} field
     * @param {?} id
     * @param {?=} search
     * @return {?}
     */
    function (bool, field, id, search) {
        if (search === void 0) { search = true; }
        if (bool) {
            this.fieldSwitchChange(this.fieldConfigs, field, id);
        }
        if (search) {
            this.fieldTree.searchHandle['research']();
        }
    };
    /**
     * @private
     * @param {?} fieldConfigs
     * @param {?} field
     * @param {?} id
     * @return {?}
     */
    FormFormatConfigComponent.prototype.fieldSwitchChange = /**
     * @private
     * @param {?} fieldConfigs
     * @param {?} field
     * @param {?} id
     * @return {?}
     */
    function (fieldConfigs, field, id) {
        var e_5, _a;
        if (fieldConfigs.length > 0) {
            try {
                for (var fieldConfigs_1 = __values(fieldConfigs), fieldConfigs_1_1 = fieldConfigs_1.next(); !fieldConfigs_1_1.done; fieldConfigs_1_1 = fieldConfigs_1.next()) {
                    var f = fieldConfigs_1_1.value;
                    if (f.data.id === id) {
                        switch (field) {
                            case 'editable':
                                f.data.editable = true;
                                f.data.readonly = false;
                                f.data.hidden = false;
                                f.data.required = false;
                                break;
                            case 'readonly':
                                f.data.editable = false;
                                f.data.readonly = true;
                                f.data.hidden = false;
                                f.data.required = false;
                                break;
                            case 'hidden':
                                f.data.editable = false;
                                f.data.readonly = false;
                                f.data.hidden = true;
                                f.data.required = false;
                                break;
                            case 'required':
                                f.data.editable = false;
                                f.data.readonly = false;
                                f.data.hidden = false;
                                f.data.required = true;
                                break;
                        }
                        return;
                    }
                    else {
                        if (f.children && f.children.length > 0) {
                            this.fieldSwitchChange(f.children, field, id);
                        }
                    }
                }
            }
            catch (e_5_1) { e_5 = { error: e_5_1 }; }
            finally {
                try {
                    if (fieldConfigs_1_1 && !fieldConfigs_1_1.done && (_a = fieldConfigs_1.return)) _a.call(fieldConfigs_1);
                }
                finally { if (e_5) throw e_5.error; }
            }
        }
    };
    /**
     * @param {?} operation
     * @return {?}
     */
    FormFormatConfigComponent.prototype.fieldBatchOperate = /**
     * @param {?} operation
     * @return {?}
     */
    function (operation) {
        var e_6, _a;
        /** @type {?} */
        var checkeds = this.fieldTree.checkeds;
        if (checkeds && checkeds.length > 0) {
            try {
                for (var checkeds_3 = __values(checkeds), checkeds_3_1 = checkeds_3.next(); !checkeds_3_1.done; checkeds_3_1 = checkeds_3.next()) {
                    var c = checkeds_3_1.value;
                    this.fieldConfigChange(true, operation, c.data.id, false);
                }
            }
            catch (e_6_1) { e_6 = { error: e_6_1 }; }
            finally {
                try {
                    if (checkeds_3_1 && !checkeds_3_1.done && (_a = checkeds_3.return)) _a.call(checkeds_3);
                }
                finally { if (e_6) throw e_6.error; }
            }
            this.fieldTree.searchHandle['research']();
        }
        else {
            this.message.info(this.localePipe.transform('component.executeForms.checkeds'));
        }
    };
    /**
     * @return {?}
     */
    FormFormatConfigComponent.prototype.fieldBatchReset = /**
     * @return {?}
     */
    function () {
        var e_7, _a;
        /** @type {?} */
        var checkeds = this.fieldTree.checkeds;
        if (checkeds && checkeds.length > 0) {
            var _loop_2 = function (c) {
                /** @type {?} */
                var field = this_2.formatFieldList.find((/**
                 * @param {?} f
                 * @return {?}
                 */
                function (f) { return f.id === c.data.id; }));
                this_2.resetFieldConfig(this_2.fieldConfigs, c.data.id, field);
            };
            var this_2 = this;
            try {
                for (var checkeds_4 = __values(checkeds), checkeds_4_1 = checkeds_4.next(); !checkeds_4_1.done; checkeds_4_1 = checkeds_4.next()) {
                    var c = checkeds_4_1.value;
                    _loop_2(c);
                }
            }
            catch (e_7_1) { e_7 = { error: e_7_1 }; }
            finally {
                try {
                    if (checkeds_4_1 && !checkeds_4_1.done && (_a = checkeds_4.return)) _a.call(checkeds_4);
                }
                finally { if (e_7) throw e_7.error; }
            }
            this.fieldTree.searchHandle['research']();
        }
        else {
            this.message.info(this.localePipe.transform('component.executeForms.checkeds'));
        }
    };
    /**
     * @param {?} fieldConfigs
     * @param {?} id
     * @param {?} field
     * @return {?}
     */
    FormFormatConfigComponent.prototype.resetFieldConfig = /**
     * @param {?} fieldConfigs
     * @param {?} id
     * @param {?} field
     * @return {?}
     */
    function (fieldConfigs, id, field) {
        var e_8, _a;
        if (fieldConfigs.length > 0) {
            try {
                for (var fieldConfigs_2 = __values(fieldConfigs), fieldConfigs_2_1 = fieldConfigs_2.next(); !fieldConfigs_2_1.done; fieldConfigs_2_1 = fieldConfigs_2.next()) {
                    var f = fieldConfigs_2_1.value;
                    if (f.leaf === true && f.data.id === id) {
                        f.data.editable = field.fieldState === 'Editable' ? true : false;
                        f.data.readonly = field.fieldState === 'Readonly' ? true : false;
                        f.data.hidden = field.fieldState === 'Hidden' ? true : false;
                        f.data.required = field.fieldState === 'Required' ? true : false;
                        return;
                    }
                    else {
                        if (f.children && f.children.length > 0) {
                            this.resetFieldConfig(f.children, id, field);
                        }
                    }
                }
            }
            catch (e_8_1) { e_8 = { error: e_8_1 }; }
            finally {
                try {
                    if (fieldConfigs_2_1 && !fieldConfigs_2_1.done && (_a = fieldConfigs_2.return)) _a.call(fieldConfigs_2);
                }
                finally { if (e_8) throw e_8.error; }
            }
        }
    };
    /**
     * @private
     * @return {?}
     */
    FormFormatConfigComponent.prototype.validator = /**
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        if (this.extendComponentRef) {
            /** @type {?} */
            var result$ = this.extendComponentRef.instance.validator();
            if (result$ instanceof Observable) {
                return result$.pipe(switchMap((/**
                 * @param {?} b
                 * @return {?}
                 */
                function (b) {
                    if (b && _this.innerValidator()) {
                        return of$1(true);
                    }
                    else {
                        return of$1(false);
                    }
                })));
            }
            else {
                if (result$) {
                    return of$1(this.innerValidator());
                }
                else {
                    return of$1(false);
                }
            }
        }
        else {
            return of$1(this.innerValidator());
        }
    };
    /**
     * @private
     * @return {?}
     */
    FormFormatConfigComponent.prototype.innerValidator = /**
     * @private
     * @return {?}
     */
    function () {
        return this.operationConfig.validator();
    };
    /**
     * @private
     * @return {?}
     */
    FormFormatConfigComponent.prototype.setBtnAndFieldConfigs = /**
     * @private
     * @return {?}
     */
    function () {
        var e_9, _a;
        this.config.formButtonConfigs = new Array();
        var _loop_3 = function (btn) {
            /** @type {?} */
            var button = this_3.formFormat.formButtons.find((/**
             * @param {?} b
             * @return {?}
             */
            function (b) { return b.buttonId === btn.buttonId; }));
            /** @type {?} */
            var btnConfig = new FormButtonConfig();
            btnConfig.buttonId = btn.buttonId;
            if (btn.enable) {
                btnConfig.buttonState = 'Enable';
            }
            else if (btn.disabled) {
                btnConfig.buttonState = 'Disabled';
            }
            else if (btn.hidden) {
                btnConfig.buttonState = 'Hidden';
            }
            else {
                return "continue";
            }
            if (!button.buttonState && btnConfig.buttonState) {
                this_3.config.formButtonConfigs.push(btnConfig);
            }
            if (button.buttonState && button.buttonState !== btnConfig.buttonState) {
                this_3.config.formButtonConfigs.push(btnConfig);
            }
        };
        var this_3 = this;
        try {
            for (var _b = __values(this.buttonConfigs), _c = _b.next(); !_c.done; _c = _b.next()) {
                var btn = _c.value;
                _loop_3(btn);
            }
        }
        catch (e_9_1) { e_9 = { error: e_9_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_9) throw e_9.error; }
        }
        this.config.formFieldConfigs = new Array();
        this.getFieldConfigs(this.fieldConfigs);
        this.config.formMethodConfigs = this.operationConfig.operations || new Array();
    };
    /**
     * @private
     * @param {?} fieldConfigs
     * @return {?}
     */
    FormFormatConfigComponent.prototype.getFieldConfigs = /**
     * @private
     * @param {?} fieldConfigs
     * @return {?}
     */
    function (fieldConfigs) {
        var e_10, _a;
        if (fieldConfigs && fieldConfigs.length > 0) {
            var _loop_4 = function (f) {
                if (f.children && f.children.length > 0) {
                    this_4.getFieldConfigs(f.children);
                }
                if (f.leaf === false) {
                    return "continue";
                }
                /** @type {?} */
                var field = this_4.formatFieldList.find((/**
                 * @param {?} fd
                 * @return {?}
                 */
                function (fd) { return fd.fieldId === f.data.fieldId; }));
                /** @type {?} */
                var fieldConfig = new FormFieldConfig();
                fieldConfig.fieldId = f.data.fieldId;
                if (f.data.editable) {
                    fieldConfig.fieldState = 'Editable';
                }
                else if (f.data.readonly) {
                    fieldConfig.fieldState = 'Readonly';
                }
                else if (f.data.hidden) {
                    fieldConfig.fieldState = 'Hidden';
                }
                else if (f.data.required) {
                    fieldConfig.fieldState = 'Required';
                }
                else {
                    return "continue";
                }
                if (!field.fieldState && fieldConfig.fieldState) {
                    this_4.config.formFieldConfigs.push(fieldConfig);
                }
                if (field.fieldState && field.fieldState !== fieldConfig.fieldState) {
                    this_4.config.formFieldConfigs.push(fieldConfig);
                }
            };
            var this_4 = this;
            try {
                for (var fieldConfigs_3 = __values(fieldConfigs), fieldConfigs_3_1 = fieldConfigs_3.next(); !fieldConfigs_3_1.done; fieldConfigs_3_1 = fieldConfigs_3.next()) {
                    var f = fieldConfigs_3_1.value;
                    _loop_4(f);
                }
            }
            catch (e_10_1) { e_10 = { error: e_10_1 }; }
            finally {
                try {
                    if (fieldConfigs_3_1 && !fieldConfigs_3_1.done && (_a = fieldConfigs_3.return)) _a.call(fieldConfigs_3);
                }
                finally { if (e_10) throw e_10.error; }
            }
        }
    };
    /**
     * @private
     * @return {?}
     */
    FormFormatConfigComponent.prototype.getConfig = /**
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        if (this.formFormatId) {
            forkJoin(this.getFormFormatType(), this.getFormFormat(), this.getFormFormatConfig()).subscribe((/**
             * @param {?} re
             * @return {?}
             */
            function (re) {
                var e_11, _a, e_12, _b, e_13, _c;
                /** @type {?} */
                var formFormatType = (/** @type {?} */ (re[0]));
                if (formFormatType) {
                    _this.formFormatType = formFormatType;
                    if (_this.formFormatType.extendImpl) {
                        _this.showExtendTab = true;
                        _this.createExtendComponent(_this.formFormatType.extendImpl);
                    }
                    else {
                        _this.showExtendTab = false;
                    }
                }
                /** @type {?} */
                var formFormat = (/** @type {?} */ (re[1]));
                if (formFormat) {
                    _this.formFormat = _this.convertFormFormat(formFormat);
                }
                /** @type {?} */
                var config = (/** @type {?} */ (re[2]));
                if (config) {
                    _this.config = config;
                }
                if (_this.formFormat.formButtons) {
                    _this.buttonConfigs = _this.formFormat.formButtons.map((/**
                     * @param {?} b
                     * @return {?}
                     */
                    function (b) { return Object.assign({}, b, {
                        enable: b.buttonState === 'Enable' ? true : false,
                        disabled: b.buttonState === 'Disabled' ? true : false,
                        hidden: b.buttonState === 'Hidden' ? true : false
                    }); }));
                    /** @type {?} */
                    var btnConfigs = new Array();
                    if (config && config.formButtonConfigs) {
                        btnConfigs = config.formButtonConfigs;
                    }
                    try {
                        for (var btnConfigs_1 = __values(btnConfigs), btnConfigs_1_1 = btnConfigs_1.next(); !btnConfigs_1_1.done; btnConfigs_1_1 = btnConfigs_1.next()) {
                            var b = btnConfigs_1_1.value;
                            try {
                                for (var _d = __values(_this.buttonConfigs), _e = _d.next(); !_e.done; _e = _d.next()) {
                                    var btn = _e.value;
                                    if (btn.buttonId === b.buttonId) {
                                        switch (b.buttonState) {
                                            case 'Enable':
                                                btn.enable = true;
                                                btn.disabled = false;
                                                btn.hidden = false;
                                                break;
                                            case 'Disabled':
                                                btn.enable = false;
                                                btn.disabled = true;
                                                btn.hidden = false;
                                                break;
                                            case 'Hidden':
                                                btn.enable = false;
                                                btn.disabled = false;
                                                btn.hidden = true;
                                                break;
                                        }
                                        break;
                                    }
                                }
                            }
                            catch (e_12_1) { e_12 = { error: e_12_1 }; }
                            finally {
                                try {
                                    if (_e && !_e.done && (_b = _d.return)) _b.call(_d);
                                }
                                finally { if (e_12) throw e_12.error; }
                            }
                        }
                    }
                    catch (e_11_1) { e_11 = { error: e_11_1 }; }
                    finally {
                        try {
                            if (btnConfigs_1_1 && !btnConfigs_1_1.done && (_a = btnConfigs_1.return)) _a.call(btnConfigs_1);
                        }
                        finally { if (e_11) throw e_11.error; }
                    }
                }
                if (_this.formFormat.formFields) {
                    _this.fieldConfigs = __spread(_this.formFormat.formFields);
                    _this.orgFieldConfigs(_this.fieldConfigs);
                    /** @type {?} */
                    var configs = new Array();
                    if (config && config.formFieldConfigs) {
                        configs = config.formFieldConfigs;
                    }
                    try {
                        for (var configs_1 = __values(configs), configs_1_1 = configs_1.next(); !configs_1_1.done; configs_1_1 = configs_1.next()) {
                            var f = configs_1_1.value;
                            _this.setFieldConfig(_this.fieldConfigs, f);
                        }
                    }
                    catch (e_13_1) { e_13 = { error: e_13_1 }; }
                    finally {
                        try {
                            if (configs_1_1 && !configs_1_1.done && (_c = configs_1.return)) _c.call(configs_1);
                        }
                        finally { if (e_13) throw e_13.error; }
                    }
                }
            }));
        }
    };
    /**
     * @param {?} extendImpl
     * @return {?}
     */
    FormFormatConfigComponent.prototype.createExtendComponent = /**
     * @param {?} extendImpl
     * @return {?}
     */
    function (extendImpl) {
        var _this = this;
        /** @type {?} */
        var url = extendImpl.split('#')[0];
        /** @type {?} */
        var selectorCmp = extendImpl.split('#')[1];
        System.import(url)
            .then((/**
         * @param {?} moduleFactorys
         * @return {?}
         */
        function (moduleFactorys) {
            /** @type {?} */
            var moduleFactory = Object.values(moduleFactorys)[0];
            /** @type {?} */
            var moduleRef = moduleFactory.create(_this.injector);
            if (selectorCmp) {
                /** @type {?} */
                var facMap = moduleRef.componentFactoryResolver['_factories'];
                facMap.forEach((/**
                 * @param {?} value
                 * @param {?} key
                 * @param {?} map
                 * @return {?}
                 */
                function (value, key, map$$1) {
                    /** @type {?} */
                    var selector = value.selector;
                    if (selectorCmp == selector) {
                        /** @type {?} */
                        var cmpFactory = moduleRef.componentFactoryResolver.resolveComponentFactory((/** @type {?} */ (key)));
                        _this.extendComponentRef = cmpFactory.create(moduleRef.injector);
                        _this.extendComponentRef.instance.formFormatId = _this.formFormatId;
                        _this.extendComponentRef.instance.formatConfigId = _this.formatConfigId;
                        _this.container.clear();
                        _this.container.insert(_this.extendComponentRef.hostView);
                    }
                }));
            }
            else {
                /** @type {?} */
                var bootstrapComponent = moduleRef['_bootstrapComponents'][0];
                if (bootstrapComponent) //先找bootstrapComponent数组有无组件
                 {
                    /** @type {?} */
                    var cmpFactory = moduleRef.componentFactoryResolver.resolveComponentFactory(bootstrapComponent);
                    _this.extendComponentRef = cmpFactory.create(moduleRef.injector);
                    _this.extendComponentRef.instance.formFormatId = _this.formFormatId;
                    _this.extendComponentRef.instance.formatConfigId = _this.formatConfigId;
                    _this.container.clear();
                    _this.container.insert(_this.extendComponentRef.hostView);
                }
            }
        }));
    };
    /**
     * @private
     * @param {?} formFields
     * @return {?}
     */
    FormFormatConfigComponent.prototype.orgFieldConfigs = /**
     * @private
     * @param {?} formFields
     * @return {?}
     */
    function (formFields) {
        var e_14, _a;
        if (formFields.length > 0) {
            try {
                for (var formFields_1 = __values(formFields), formFields_1_1 = formFields_1.next(); !formFields_1_1.done; formFields_1_1 = formFields_1.next()) {
                    var d = formFields_1_1.value;
                    d.data = Object.assign({}, d.data, {
                        editable: d.data.fieldState === 'Editable' ? true : false,
                        readonly: d.data.fieldState === 'Readonly' ? true : false,
                        hidden: d.data.fieldState === 'Hidden' ? true : false,
                        required: d.data.fieldState === 'Required' ? true : false
                    });
                    if (d.children && d.children) {
                        this.orgFieldConfigs(d.children);
                    }
                }
            }
            catch (e_14_1) { e_14 = { error: e_14_1 }; }
            finally {
                try {
                    if (formFields_1_1 && !formFields_1_1.done && (_a = formFields_1.return)) _a.call(formFields_1);
                }
                finally { if (e_14) throw e_14.error; }
            }
        }
    };
    /**
     * @private
     * @param {?} fieldConfigs
     * @param {?} config
     * @return {?}
     */
    FormFormatConfigComponent.prototype.setFieldConfig = /**
     * @private
     * @param {?} fieldConfigs
     * @param {?} config
     * @return {?}
     */
    function (fieldConfigs, config) {
        var e_15, _a;
        if (fieldConfigs.length > 0) {
            try {
                for (var fieldConfigs_4 = __values(fieldConfigs), fieldConfigs_4_1 = fieldConfigs_4.next(); !fieldConfigs_4_1.done; fieldConfigs_4_1 = fieldConfigs_4.next()) {
                    var f = fieldConfigs_4_1.value;
                    if (f.data.fieldId === config.fieldId) {
                        switch (config.fieldState) {
                            case 'Editable':
                                f.data.editable = true;
                                f.data.readonly = false;
                                f.data.hidden = false;
                                f.data.required = false;
                                break;
                            case 'Readonly':
                                f.data.editable = false;
                                f.data.readonly = true;
                                f.data.hidden = false;
                                f.data.required = false;
                                break;
                            case 'Hidden':
                                f.data.editable = false;
                                f.data.readonly = false;
                                f.data.hidden = true;
                                f.data.required = false;
                                break;
                            case 'Required':
                                f.data.editable = false;
                                f.data.readonly = false;
                                f.data.hidden = false;
                                f.data.required = true;
                                break;
                        }
                        return;
                    }
                    else {
                        if (f.children && f.children.length > 0) {
                            this.setFieldConfig(f.children, config);
                        }
                    }
                }
            }
            catch (e_15_1) { e_15 = { error: e_15_1 }; }
            finally {
                try {
                    if (fieldConfigs_4_1 && !fieldConfigs_4_1.done && (_a = fieldConfigs_4.return)) _a.call(fieldConfigs_4);
                }
                finally { if (e_15) throw e_15.error; }
            }
        }
    };
    /**
     * @private
     * @param {?} config
     * @return {?}
     */
    FormFormatConfigComponent.prototype.saveConfig = /**
     * @private
     * @param {?} config
     * @return {?}
     */
    function (config) {
        /** @type {?} */
        var url = '/api/runtime/wf/v1.0/formFormatConfig';
        return this.http.post(url, config);
    };
    /**
     * @private
     * @return {?}
     */
    FormFormatConfigComponent.prototype.getFormFormat = /**
     * @private
     * @return {?}
     */
    function () {
        if (this.formFormatId) {
            /** @type {?} */
            var url = "/api/runtime/wf/v1.0/formFormat/" + this.formFormatId;
            url = encodeURI(url);
            return this.http.get(url);
        }
        else {
            return of$1(null);
        }
    };
    /**
     * @private
     * @return {?}
     */
    FormFormatConfigComponent.prototype.getFormFormatType = /**
     * @private
     * @return {?}
     */
    function () {
        if (this.formFormatId) {
            /** @type {?} */
            var url = "/api/runtime/wf/v1.0/formFormatType/formFormat?formFormat=" + this.formFormatId;
            return this.http.get(url);
        }
    };
    /**
     * @private
     * @return {?}
     */
    FormFormatConfigComponent.prototype.getFormFormatConfig = /**
     * @private
     * @return {?}
     */
    function () {
        if (this.formatConfigId) {
            /** @type {?} */
            var url = "/api/runtime/wf/v1.0/formFormatConfig/" + this.formatConfigId;
            url = encodeURI(url);
            return this.http.get(url);
        }
        else {
            return of$1(null);
        }
    };
    /**
     * @private
     * @param {?} formFormat
     * @return {?}
     */
    FormFormatConfigComponent.prototype.convertFormFormat = /**
     * @private
     * @param {?} formFormat
     * @return {?}
     */
    function (formFormat) {
        if (!formFormat.status) {
            formFormat.status = 0;
        }
        this.convertformFields(formFormat.formFields);
        this.getFormatFieldList(formFormat.formFields, this.formatFieldList);
        return formFormat;
    };
    /**
     * @private
     * @param {?} formFields
     * @return {?}
     */
    FormFormatConfigComponent.prototype.convertformFields = /**
     * @private
     * @param {?} formFields
     * @return {?}
     */
    function (formFields) {
        var e_16, _a;
        if (formFields && formFields.length > 0) {
            try {
                for (var formFields_2 = __values(formFields), formFields_2_1 = formFields_2.next(); !formFields_2_1.done; formFields_2_1 = formFields_2.next()) {
                    var d = formFields_2_1.value;
                    if (typeof (d.leaf) !== 'boolean' && (d.leaf == null || d.leaf === undefined)) {
                        d.leaf = true;
                    }
                    if (d.children && d.children) {
                        this.orgFieldConfigs(d.children);
                    }
                }
            }
            catch (e_16_1) { e_16 = { error: e_16_1 }; }
            finally {
                try {
                    if (formFields_2_1 && !formFields_2_1.done && (_a = formFields_2.return)) _a.call(formFields_2);
                }
                finally { if (e_16) throw e_16.error; }
            }
        }
    };
    /**
     * @private
     * @param {?} formFields
     * @param {?} array
     * @return {?}
     */
    FormFormatConfigComponent.prototype.getFormatFieldList = /**
     * @private
     * @param {?} formFields
     * @param {?} array
     * @return {?}
     */
    function (formFields, array) {
        var e_17, _a;
        if (formFields && formFields.length > 0) {
            try {
                for (var formFields_3 = __values(formFields), formFields_3_1 = formFields_3.next(); !formFields_3_1.done; formFields_3_1 = formFields_3.next()) {
                    var d = formFields_3_1.value;
                    array.push(d.data);
                    if (d.children && d.children) {
                        this.getFormatFieldList(d.children, array);
                    }
                }
            }
            catch (e_17_1) { e_17 = { error: e_17_1 }; }
            finally {
                try {
                    if (formFields_3_1 && !formFields_3_1.done && (_a = formFields_3.return)) _a.call(formFields_3);
                }
                finally { if (e_17) throw e_17.error; }
            }
        }
    };
    /**
     * @private
     * @param {?} formFields
     * @param {?} fieldId
     * @return {?}
     */
    FormFormatConfigComponent.prototype.getFormatField = /**
     * @private
     * @param {?} formFields
     * @param {?} fieldId
     * @return {?}
     */
    function (formFields, fieldId) {
        var e_18, _a;
        try {
            for (var formFields_4 = __values(formFields), formFields_4_1 = formFields_4.next(); !formFields_4_1.done; formFields_4_1 = formFields_4.next()) {
                var f = formFields_4_1.value;
                if (f.data.fieldId === fieldId) {
                    return f;
                }
                if (f.children && f.children.length > 0) {
                    return this.getFormatField(f.children, fieldId);
                }
            }
        }
        catch (e_18_1) { e_18 = { error: e_18_1 }; }
        finally {
            try {
                if (formFields_4_1 && !formFields_4_1.done && (_a = formFields_4.return)) _a.call(formFields_4);
            }
            finally { if (e_18) throw e_18.error; }
        }
    };
    FormFormatConfigComponent.decorators = [
        { type: Component, args: [{
                    selector: 'lib-form-format-config',
                    template: "\r\n<!--\u9700\u8981\u5D4C\u5957\u7684\u5C42-----------\u6807\u7B7E\u9875---------------->\r\n<farris-tabs class=\"h-100 f-component-tabs f-tabs-has-grid\" [value]=\"'buttonConfig'\" [contentFill]=\"true\">\r\n  <farris-tab title=\"{{'component.executeForms.formBtn'|wfLocale}}\" [id]=\"'buttonConfig'\">\r\n    <ng-template farrisTabsExtend>\r\n      <farris-button [type]=\"'link'\" (click)=\"btnBatchOperate('enable')\">\r\n        {{'component.executeForms.enableBtn'|wfLocale}}\r\n      </farris-button>\r\n      <farris-button [type]=\"'link'\" (click)=\"btnBatchOperate('disabled')\">\r\n        {{'component.executeForms.disabledBtn'|wfLocale}}\r\n      </farris-button>\r\n      <farris-button [type]=\"'link'\" (click)=\"btnBatchOperate('hidden')\">\r\n        {{'component.executeForms.hiddenBtn'|wfLocale}}\r\n      </farris-button>\r\n      <farris-button [type]=\"'link'\" (click)=\"btnBatchReset()\">\r\n        {{'component.executeForms.btnBatchReset'|wfLocale}}\r\n      </farris-button>\r\n    </ng-template>\r\n    <ng-template #content>\r\n      <div class=\"f-utils-fill-flex-column\" style=\"background: #FFF;\">\r\n        <farris-datagrid class=\"f-component-grid f-utils-fill\" [columns]=\"buttonCols\" [data]=\"buttonConfigs\" #btnGrid\r\n          [idField]=\"'id'\" [showLineNumber]=\"false\" [fitColumns]=\"true\" [striped]=\"true\"\r\n          [virtualized]=\"true\" [pagination]=\"false\" [useThemes]=\"false\" [fit]=\"true\" [showAllCheckbox]=\"true\"\r\n          [showCheckbox]=\"true\" [multiSelect]=\"true\" [enableFilterRow]=\"true\">\r\n        </farris-datagrid>\r\n      </div>\r\n    </ng-template>\r\n  </farris-tab>\r\n  <farris-tab title=\"{{'component.executeForms.formfield'|wfLocale}}\" [id]=\"'fieldConfig'\">\r\n    <ng-template farrisTabsExtend>\r\n      <farris-button [type]=\"'link'\" (click)=\"fieldBatchOperate('editable')\">\r\n        {{'component.executeForms.editableBtn'|wfLocale}}\r\n      </farris-button>\r\n      <farris-button [type]=\"'link'\" (click)=\"fieldBatchOperate('readonly')\">\r\n        {{'component.executeForms.readonlyBtn'|wfLocale}}\r\n      </farris-button>\r\n      <farris-button [type]=\"'link'\" (click)=\"fieldBatchOperate('hidden')\">\r\n        {{'component.executeForms.hiddenBtn'|wfLocale}}\r\n      </farris-button>\r\n      <farris-button [type]=\"'link'\" (click)=\"fieldBatchOperate('required')\">\r\n        {{'component.executeForms.requiredBtn'|wfLocale}}\r\n      </farris-button>\r\n      <farris-button [type]=\"'link'\" (click)=\"fieldBatchReset()\">\r\n        {{'component.executeForms.btnBatchReset'|wfLocale}}\r\n      </farris-button>\r\n    </ng-template>\r\n    <ng-template #content>\r\n      <div class=\"f-utils-fill-flex-column\" style=\"background: #FFF;\">\r\n        <farris-treetable #fieldTree [columns]=\"fieldCols\" [showFilterBar]=\"true\" [searchFields] = \"searchFields\"\r\n          [showBorder]=\"false\" [showHeader]=\"true\" [data]=\"fieldConfigs\" [fit]=\"true\" [fitColumns]=\"true\"\r\n          [idField]=\"'id'\" [virtualized]=\"false\" [singleSelect]=\"false\" [showCheckbox]=\"true\"\r\n          [showCheckAll]=\"true\" [striped]=\"true\" [fixedHeader]=\"true\" (search)=\"searchField($event)\">\r\n        </farris-treetable>\r\n      </div>\r\n    </ng-template>\r\n  </farris-tab>\r\n  <farris-tab title=\"{{'component.executeForms.formEvents'|wfLocale}}\" [id]=\"'operationConfig'\" [show]=\"showMethodTab\">\r\n    <ng-template farrisTabsExtend>\r\n      <farris-button [type]=\"'link'\" (click)=\"operationConfig.add()\">\r\n        {{'component.executeForms.add'|wfLocale}}\r\n      </farris-button>\r\n      <farris-button [type]=\"'link'\" (click)=\"operationConfig.delete()\">\r\n        {{'component.executeForms.delete'|wfLocale}}\r\n      </farris-button>\r\n    </ng-template>\r\n    <ng-template #content>\r\n      <lib-form-operation-config\r\n        [formFormatId]=\"formFormatId\"\r\n        [formFormatConfigId]=\"config.id\"\r\n        [operations]=\"config.formMethodConfigs\"\r\n        class=\"h-100\"></lib-form-operation-config>\r\n    </ng-template>\r\n  </farris-tab>\r\n  <farris-tab title=\"{{'component.executeForms.other'|wfLocale}}\" [id]=\"'extendConfig'\" [show]=\"showExtendTab\">\r\n    <ng-template #content>\r\n      <ng-container #container></ng-container>\r\n    </ng-template>\r\n  </farris-tab>\r\n</farris-tabs>\r\n<!--Tab\u533A\u57DF-->\r\n\r\n  <!-- </section>\r\n</div> -->\r\n\r\n<ng-template #btnEnable let-ctx>\r\n  <farris-switch [(ngModel)]=\"ctx.rowData.enable\" (valueChange)=\"btnConfigChange($event, ctx.field, ctx.rowData.id)\"></farris-switch>\r\n</ng-template>\r\n<ng-template #btnDisabled let-ctx>\r\n  <farris-switch [(ngModel)]=\"ctx.rowData.disabled\" (valueChange)=\"btnConfigChange($event, ctx.field, ctx.rowData.id)\"></farris-switch>\r\n</ng-template>\r\n<ng-template #btnHidden let-ctx>\r\n  <farris-switch [(ngModel)]=\"ctx.rowData.hidden\" (valueChange)=\"btnConfigChange($event, ctx.field, ctx.rowData.id)\"></farris-switch>\r\n</ng-template>\r\n<ng-template #fieldEditable let-ctx>\r\n  <farris-switch *ngIf=\"ctx.node.leaf\" size=\"small\" [(ngModel)]=\"ctx.node.data.editable\"\r\n  (valueChange)=\"fieldConfigChange($event, ctx.column.field, ctx.node.data.id)\">\r\n  </farris-switch>\r\n</ng-template>\r\n<ng-template #fieldReadonly let-ctx>\r\n  <farris-switch *ngIf=\"ctx.node.leaf\" size=\"small\" [(ngModel)]=\"ctx.node.data.readonly\"\r\n    (valueChange)=\"fieldConfigChange($event, ctx.column.field, ctx.node.data.id)\">\r\n  </farris-switch>\r\n</ng-template>\r\n<ng-template #fieldHidden let-ctx>\r\n  <farris-switch *ngIf=\"ctx.node.leaf\" size=\"small\" [(ngModel)]=\"ctx.node.data.hidden\"\r\n    (valueChange)=\"fieldConfigChange($event, ctx.column.field, ctx.node.data.id)\">\r\n  </farris-switch>\r\n</ng-template>\r\n<ng-template #fieldRequired let-ctx>\r\n  <farris-switch *ngIf=\"ctx.node.leaf\" size=\"small\" [(ngModel)]=\"ctx.node.data.required\"\r\n    (valueChange)=\"fieldConfigChange($event, ctx.column.field, ctx.node.data.id)\">\r\n  </farris-switch>\r\n</ng-template>\r\n\r\n\r\n",
                    providers: [
                        WfLocalePipe,
                    ],
                    styles: [""]
                }] }
    ];
    /** @nocollapse */
    FormFormatConfigComponent.ctorParameters = function () { return [
        { type: HttpService },
        { type: MessagerService },
        { type: NotifyService },
        { type: Injector },
        { type: ChangeDetectorRef, decorators: [{ type: Optional }] },
        { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
        { type: undefined, decorators: [{ type: Inject, args: [WF_LANG_RESOURCES,] }] },
        { type: WfLocalePipe, decorators: [{ type: Optional }] }
    ]; };
    FormFormatConfigComponent.propDecorators = {
        btnEnable: [{ type: ViewChild, args: ['btnEnable',] }],
        btnDisabled: [{ type: ViewChild, args: ['btnDisabled',] }],
        btnHidden: [{ type: ViewChild, args: ['btnHidden',] }],
        fieldEditable: [{ type: ViewChild, args: ['fieldEditable',] }],
        fieldReadonly: [{ type: ViewChild, args: ['fieldReadonly',] }],
        fieldHidden: [{ type: ViewChild, args: ['fieldHidden',] }],
        fieldRequired: [{ type: ViewChild, args: ['fieldRequired',] }],
        btnGrid: [{ type: ViewChild, args: ['btnGrid',] }],
        fieldTree: [{ type: ViewChild, args: ['fieldTree',] }],
        operationConfig: [{ type: ViewChild, args: [FormOperationConfigComponent,] }],
        container: [{ type: ViewChild, args: ['container', { read: ViewContainerRef },] }],
        showMethodTab: [{ type: Input }]
    };
    return FormFormatConfigComponent;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var FormConfigContainerComponent = /** @class */ (function () {
    function FormConfigContainerComponent(injector, cfr, http) {
        this.injector = injector;
        this.cfr = cfr;
        this.http = http;
        this.showMethodTab = true;
    }
    /**
     * @return {?}
     */
    FormConfigContainerComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        // this.showComponentRef();
    };
    /**
     * @param {?} changes
     * @return {?}
     */
    FormConfigContainerComponent.prototype.ngOnChanges = /**
     * @param {?} changes
     * @return {?}
     */
    function (changes) {
        if (changes['formFormatId'] && changes['formFormatId'].currentValue) {
            this.showComponentRef();
        }
        else { // 功能菜单时
            this.componentRef = this.createWFComponentRef();
            this.componentRef.instance.formFormatId = null;
            this.componentRef.instance.formatConfigId = null;
            this.componentRef.instance.showMethodTab = this.showMethodTab;
            this.container.clear();
            this.container.insert(this.componentRef.hostView);
        }
    };
    /**
     * @return {?}
     */
    FormConfigContainerComponent.prototype.submit = /**
     * @return {?}
     */
    function () {
        return this.componentRef.instance.submit();
    };
    /**
     * @private
     * @return {?}
     */
    FormConfigContainerComponent.prototype.showComponentRef = /**
     * @private
     * @return {?}
     */
    function () {
        this.componentRef = this.createWFComponentRef();
        this.componentRef.instance.formFormatId = this.formFormatId;
        this.componentRef.instance.formatConfigId = this.formatConfigId;
        this.componentRef.instance.showMethodTab = this.showMethodTab;
        this.container.clear();
        this.container.insert(this.componentRef.hostView);
        // if (this.formFormatId) {
        // this.getFormFormatType().subscribe((re: FormFormatType) => {
        // if (re.code === 'wf') {
        // } else {
        //   System.import(re.customImpl)
        //     .then((moduleFactorys: any) => {
        //       const moduleFactory: any = Object.values(moduleFactorys)[0];
        //       const moduleRef = moduleFactory.create(this.injector);
        //       this.componentRef = moduleRef.instance.createCustomComponentRef(this.injector);
        //       this.componentRef.instance.formFormatId = this.formFormatId;
        //       this.componentRef.instance.formatConfigId = this.formatConfigId;
        //       this.componentRef.instance.showMethodTab = this.showMethodTab;
        //       this.container.clear();
        //       this.container.insert(this.componentRef.hostView);
        //     });
        // }
        // });
        // }
    };
    /**
     * @private
     * @return {?}
     */
    FormConfigContainerComponent.prototype.createWFComponentRef = /**
     * @private
     * @return {?}
     */
    function () {
        /** @type {?} */
        var cmpF = this.cfr.resolveComponentFactory(FormFormatConfigComponent);
        /** @type {?} */
        var cmpR = cmpF.create(this.injector);
        return cmpR;
    };
    /**
     * @private
     * @return {?}
     */
    FormConfigContainerComponent.prototype.getFormFormatType = /**
     * @private
     * @return {?}
     */
    function () {
        if (this.formFormatId) {
            /** @type {?} */
            var url = "/api/runtime/wf/v1.0/formFormatType/formFormat?formFormat=" + this.formFormatId;
            return this.http.get(url);
        }
    };
    FormConfigContainerComponent.decorators = [
        { type: Component, args: [{
                    selector: 'lib-form-config-container',
                    template: "<ng-container #container></ng-container>\r\n",
                    styles: [""]
                }] }
    ];
    /** @nocollapse */
    FormConfigContainerComponent.ctorParameters = function () { return [
        { type: Injector },
        { type: ComponentFactoryResolver },
        { type: HttpService }
    ]; };
    FormConfigContainerComponent.propDecorators = {
        container: [{ type: ViewChild, args: ['container', { read: ViewContainerRef },] }],
        modalFooter: [{ type: ViewChild, args: ['iconSelectFooter',] }],
        formFormatId: [{ type: Input }],
        formatConfigId: [{ type: Input }],
        showMethodTab: [{ type: Input }]
    };
    return FormConfigContainerComponent;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var ExecuteFormsComponent = /** @class */ (function () {
    // *******************************************************
    function ExecuteFormsComponent(formBuilder, uistate, viewmodel, resolver, injector, modalService, designerState, message, cdr, localeId, resources, localePipe) {
        this.formBuilder = formBuilder;
        this.uistate = uistate;
        this.viewmodel = viewmodel;
        this.resolver = resolver;
        this.injector = injector;
        this.modalService = modalService;
        this.designerState = designerState;
        this.message = message;
        this.cdr = cdr;
        this.localeId = localeId;
        this.resources = resources;
        this.localePipe = localePipe;
        this.modalConfig = {
            title: this.localePipe.transform('component.executeForms.executeForms'),
            width: 760,
            height: 532,
            showButtons: true
        };
        this.cls = 'farris-main-area flex-column';
        this.style = '#FFF';
        this.closeModal = new EventEmitter();
        this.submitModal = new EventEmitter();
        this.editorParams = {};
        this.tab = 'web';
        this.groupIcon = '<i class="f-icon f-icon-lookup"></i>';
        this.cols = [];
        this.showMethodTab = true;
        this.allParameters = new Array();
        this.localePipe = this.localePipe || new WfLocalePipe(localeId, resources);
        this.form = new ExecuteFormModel();
        this.allParameters = this.getVariableList();
    }
    Object.defineProperty(ExecuteFormsComponent.prototype, "value", {
        set: /**
         * @param {?} item
         * @return {?}
         */
        function (item) {
            var _this = this;
            if (item) {
                /** @type {?} */
                var paramArray_1 = new Array();
                item.ActualParameters.forEach((/**
                 * @param {?} a
                 * @return {?}
                 */
                function (a) {
                    /** @type {?} */
                    var para = new ActualParameter$1();
                    para.Name = a.Name;
                    para.Tag = a.Tag ? a.Tag : _this.initVariableType(a.Value);
                    para.Value = a.Value;
                    paramArray_1.push(para);
                }));
                this.form.ActualParameters = paramArray_1;
                this.form.Id = item.Id;
                this.form.Name = item.Name;
                this.form.ComponentId = item.ComponentId;
                this.form.formFormatId = item.formFormatId;
                this.form.formatConfigId = item.formatConfigId;
                this.form.FormType = item.FormType;
                this.form.TerminalType = item.TerminalType;
            }
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    ExecuteFormsComponent.prototype.ngAfterViewInit = /**
     * @return {?}
     */
    function () {
    };
    /**
     * @return {?}
     */
    ExecuteFormsComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        this.location = this.editorParams.location;
        this.tab = this.editorParams.tab;
        if (this.location === 'userActivity') {
            this.showMethodTab = true;
        }
        else {
            this.showMethodTab = false;
        }
    };
    /**
     * @return {?}
     */
    ExecuteFormsComponent.prototype.clickOK = /**
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var data = new ExecuteFormModel();
        this.getForm().subscribe((/**
         * @param {?} re
         * @return {?}
         */
        function (re) {
            var e_1, _a;
            if (!re.result) {
                return;
            }
            data = re.form;
            if (_this.validator(data)) {
                /** @type {?} */
                var parameters = null;
                // 如果存在变量类型参数在流程变量上不存在，需要同步流程变量
                if (data && data.ActualParameters && data.ActualParameters.length > 0) {
                    /** @type {?} */
                    var formalParameters = _this.designerState.flowFormInfo.formalParameters.filter((/**
                     * @param {?} p
                     * @return {?}
                     */
                    function (p) { return p.dataType !== 'CDTSchema'; }));
                    var _loop_1 = function (parameter) {
                        if (parameter.Tag === 'variable' && parameter.Value && !_this.allParameters.some((/**
                         * @param {?} p
                         * @return {?}
                         */
                        function (p) { return p.key === parameter.Value; })) && formalParameters.some((/**
                         * @param {?} p
                         * @return {?}
                         */
                        function (p) { return p.code === parameter.Value; }))) {
                            parameters = formalParameters;
                            return "break";
                        }
                    };
                    try {
                        for (var _b = __values(data.ActualParameters), _c = _b.next(); !_c.done; _c = _b.next()) {
                            var parameter = _c.value;
                            var state_1 = _loop_1(parameter);
                            if (state_1 === "break")
                                break;
                        }
                    }
                    catch (e_1_1) { e_1 = { error: e_1_1 }; }
                    finally {
                        try {
                            if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                        }
                        finally { if (e_1) throw e_1.error; }
                    }
                }
                /** @type {?} */
                var object = { value: data, parameters: parameters };
                _this.submitModal.emit(object);
            }
        }));
    };
    /**
     * @return {?}
     */
    ExecuteFormsComponent.prototype.clickCancel = /**
     * @return {?}
     */
    function () {
        this.closeModal.emit();
    };
    /**
     * @param {?} form
     * @return {?}
     */
    ExecuteFormsComponent.prototype.validator = /**
     * @param {?} form
     * @return {?}
     */
    function (form) {
        var e_2, _a;
        if (form && form.ActualParameters && form.ActualParameters.length > 0) {
            /** @type {?} */
            var formalParameters = this.designerState.flowFormInfo.formalParameters.filter((/**
             * @param {?} p
             * @return {?}
             */
            function (p) { return p.dataType !== 'CDTSchema'; }));
            var _loop_2 = function (parameter) {
                if (parameter.Tag === 'variable' && parameter.Value && !this_1.allParameters.some((/**
                 * @param {?} p
                 * @return {?}
                 */
                function (p) { return p.key === parameter.Value; })) && !formalParameters.some((/**
                 * @param {?} p
                 * @return {?}
                 */
                function (p) { return p.code === parameter.Value; }))) {
                    this_1.message.error(this_1.localePipe.transform('component.executeForms.parameters') + parameter.Name + this_1.localePipe.transform('component.executeForms.typeAsvariable'));
                    return { value: false };
                }
            };
            var this_1 = this;
            try {
                for (var _b = __values(form.ActualParameters), _c = _b.next(); !_c.done; _c = _b.next()) {
                    var parameter = _c.value;
                    var state_2 = _loop_2(parameter);
                    if (typeof state_2 === "object")
                        return state_2.value;
                }
            }
            catch (e_2_1) { e_2 = { error: e_2_1 }; }
            finally {
                try {
                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                }
                finally { if (e_2) throw e_2.error; }
            }
        }
        return true;
    };
    // tabChange(data) {
    //   this.tab = data.nextId;
    // }
    // editCSS() {
    //   this.configSection.nativeElement.querySelector('div.f-section-header').classList.add('mb-0');
    // }
    // tabChange(data) {
    //   this.tab = data.nextId;
    // }
    // editCSS() {
    //   this.configSection.nativeElement.querySelector('div.f-section-header').classList.add('mb-0');
    // }
    /**
     * @private
     * @return {?}
     */
    ExecuteFormsComponent.prototype.getForm = 
    // tabChange(data) {
    //   this.tab = data.nextId;
    // }
    // editCSS() {
    //   this.configSection.nativeElement.querySelector('div.f-section-header').classList.add('mb-0');
    // }
    /**
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        if (this.form.ComponentId) {
            return of({ result: true, form: this.form });
        }
        else if (this.form.formFormatId) {
            return this.configContainer.submit().pipe(switchMap((/**
             * @param {?} re
             * @return {?}
             */
            function (re) {
                if (re.result) {
                    _this.form.formatConfigId = re.configId;
                    return of({ result: true, form: _this.form });
                }
                else {
                    return of({ result: false, form: _this.form });
                }
            })));
        }
        else {
            return of({ result: true, form: null });
        }
    };
    /**
     * 参数设置
     */
    /**
     * 参数设置
     * @return {?}
     */
    ExecuteFormsComponent.prototype.parametersSet = /**
     * 参数设置
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var compFactory = this.resolver.resolveComponentFactory(ParameterSettingComponent);
        /** @type {?} */
        var compRef = compFactory.create(this.injector);
        compRef.instance.mode = 'bpmn';
        compRef.instance.allParameters = this.allParameters;
        if (this.tab === 'web') {
            if (this.form.ComponentId) {
                compRef.instance.showFormType = true;
                compRef.instance.formType = this.form.FormType;
            }
            compRef.instance.parameters = __spread(this.form.ActualParameters.map((/**
             * @param {?} p
             * @return {?}
             */
            function (p) { return Object.assign({}, p); })));
        }
        else {
            compRef.instance.parameters = __spread(this.form.ActualParameters.map((/**
             * @param {?} p
             * @return {?}
             */
            function (p) { return Object.assign({}, p); })));
        }
        /** @type {?} */
        var modalConfig = {
            title: this.localePipe.transform('component.executeForms.parameterSettings'),
            width: 620,
            height: 400,
            showButtons: true,
            buttons: compRef.instance.modalFooter
        };
        /** @type {?} */
        var dialog = this.modalService.show(compRef, modalConfig);
        compRef.instance.submit.subscribe((/**
         * @param {?} re
         * @return {?}
         */
        function (re) {
            if (_this.tab === 'web') {
                _this.form.ActualParameters = re.parameters;
                _this.form.FormType = re.formType;
            }
            else {
                _this.form.ActualParameters = re.parameters;
            }
            dialog.close();
        }));
        compRef.instance.cancel.subscribe((/**
         * @param {?} re
         * @return {?}
         */
        function (re) {
            dialog.close();
        }));
    };
    /**
     * 选择表单定义
     */
    /**
     * 选择表单定义
     * @return {?}
     */
    ExecuteFormsComponent.prototype.selectExecuteForm = /**
     * 选择表单定义
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var compFactory = this.resolver.resolveComponentFactory(AddExecuteFormComponent);
        /** @type {?} */
        var compRef = compFactory.create(this.injector);
        compRef.instance.tab = this.tab;
        /** @type {?} */
        var modalConfig = {
            title: this.localePipe.transform('component.executeForms.formDefinitionList'),
            width: 650,
            height: 400,
            showButtons: true,
            buttons: compRef.instance.modalFooter
        };
        /** @type {?} */
        var dialog = this.modalService.show(compRef, modalConfig);
        compRef.instance.submit.subscribe((/**
         * @param {?} re
         * @return {?}
         */
        function (re) {
            _this.form = re;
            dialog.close();
        }));
        compRef.instance.cancel.subscribe((/**
         * @param {?} re
         * @return {?}
         */
        function (re) {
            dialog.close();
        }));
    };
    /**
     * @return {?}
     */
    ExecuteFormsComponent.prototype.clear = /**
     * @return {?}
     */
    function () {
        this.form = new ExecuteFormModel();
    };
    /**
     * @param {?} value
     * @return {?}
     */
    ExecuteFormsComponent.prototype.initVariableType = /**
     * @param {?} value
     * @return {?}
     */
    function (value) {
        if (value) {
            if (value.length >= 8 && value.slice(0, 8) === "{\"expr\":") {
                return 'expression';
            }
            else {
                return 'constant';
            }
        }
        else {
            return 'variable';
        }
    };
    /**
     * @private
     * @return {?}
     */
    ExecuteFormsComponent.prototype.getVariableList = /**
     * @private
     * @return {?}
     */
    function () {
        var e_3, _a, e_4, _b, e_5, _c, e_6, _d, e_7, _e;
        /** @type {?} */
        var context = new Array();
        if (this.designerState.procInstContext.length > 0) {
            try {
                for (var _f = __values(this.designerState.procInstContext), _g = _f.next(); !_g.done; _g = _f.next()) {
                    var variable = _g.value;
                    context.push(variable);
                }
            }
            catch (e_3_1) { e_3 = { error: e_3_1 }; }
            finally {
                try {
                    if (_g && !_g.done && (_a = _f.return)) _a.call(_f);
                }
                finally { if (e_3) throw e_3.error; }
            }
        }
        if (this.designerState.subActivityContext.length > 0) {
            var _loop_3 = function (variable) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    context.push(variable);
                }
            };
            try {
                for (var _h = __values(this.designerState.subActivityContext), _j = _h.next(); !_j.done; _j = _h.next()) {
                    var variable = _j.value;
                    _loop_3(variable);
                }
            }
            catch (e_4_1) { e_4 = { error: e_4_1 }; }
            finally {
                try {
                    if (_j && !_j.done && (_b = _h.return)) _b.call(_h);
                }
                finally { if (e_4) throw e_4.error; }
            }
        }
        if (this.designerState.formalParameterContext.length > 0) {
            var _loop_4 = function (variable) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    context.push(variable);
                }
            };
            try {
                for (var _k = __values(this.designerState.formalParameterContext), _l = _k.next(); !_l.done; _l = _k.next()) {
                    var variable = _l.value;
                    _loop_4(variable);
                }
            }
            catch (e_5_1) { e_5 = { error: e_5_1 }; }
            finally {
                try {
                    if (_l && !_l.done && (_c = _k.return)) _c.call(_k);
                }
                finally { if (e_5) throw e_5.error; }
            }
        }
        if (this.designerState.participantContext.length > 0) {
            var _loop_5 = function (variable) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    context.push(variable);
                }
            };
            try {
                for (var _m = __values(this.designerState.participantContext), _o = _m.next(); !_o.done; _o = _m.next()) {
                    var variable = _o.value;
                    _loop_5(variable);
                }
            }
            catch (e_6_1) { e_6 = { error: e_6_1 }; }
            finally {
                try {
                    if (_o && !_o.done && (_d = _m.return)) _d.call(_m);
                }
                finally { if (e_6) throw e_6.error; }
            }
        }
        if (this.designerState.processVariableContext.length > 0) {
            var _loop_6 = function (variable) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    context.push(variable);
                }
            };
            try {
                for (var _p = __values(this.designerState.processVariableContext), _q = _p.next(); !_q.done; _q = _p.next()) {
                    var variable = _q.value;
                    _loop_6(variable);
                }
            }
            catch (e_7_1) { e_7 = { error: e_7_1 }; }
            finally {
                try {
                    if (_q && !_q.done && (_e = _p.return)) _e.call(_p);
                }
                finally { if (e_7) throw e_7.error; }
            }
        }
        return context;
    };
    ExecuteFormsComponent.decorators = [
        { type: Component, args: [{
                    selector: 'app-execute-forms',
                    template: "\r\n<ng-template #iconSelectFooter>\r\n  <button type=\"button\" class=\"btn btn-secondary btn-sm\" (click)=\"clickCancel()\">{{'component.executeForms.clickCancel'|wfLocale}}</button>\r\n  <button type=\"button\" class=\"btn btn-primary btn-sm mx-2\" (click)=\"clickOK()\">{{'component.executeForms.clickOK'|wfLocale}}</button>\r\n</ng-template>\r\n\r\n<ng-template #empty>\r\n  <div class=\"f-utils-fill-flex-column h-100\">\r\n    <div class=\"f-datagrid-norecords\" style=\"height: 100%;\">\r\n      <div class=\"f-datagrid-norecords-content w-100\">{{'component.executeForms.noForm'|wfLocale}}</div>\r\n    </div>\r\n  </div>\r\n</ng-template>\r\n\r\n<div class=\"f-page f-page-is-managelist\">\r\n  <div class=\"f-page-main mx-3\" style=\"border-radius:16px;border: 1.5px solid #F1F3F7;\">\r\n    <div class=\"farris-form farris-form-controls-inline farris-form-auto f-form-lable-auto\">\r\n      <div class=\"f-section-formgroup-inputs\">\r\n        <div class=\"col-12 col-md-5 px-0 my-2\" style=\"margin-left: 50px;\">\r\n          <div class=\"farris-group-wrap\">\r\n            <div class=\"form-group farris-form-group mb-0\">\r\n              <label class=\"col-form-label\">\r\n                <span class=\"farris-label-text\">{{'component.executeForms.form'|wfLocale}}</span>\r\n              </label>\r\n              <input-group class=\"form-control\" style=\"width: 100%;padding:0;border:0;\" [enableClear]=\"true\"\r\n                [showButtonWhenDisabled]=\"false\" [(ngModel)]=\"form.Name\" name=\"form\" placeholder=\"{{'component.executeForms.placeholder'|wfLocale}}\"\r\n                [editable]=\"false\" (clickHandle)=\"selectExecuteForm()\" (clear)=\"clear()\" [groupText]=\"groupIcon\">\r\n              </input-group>\r\n              <div class=\"farris-feedback valid-feedback\"></div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div class=\"col-12 col-md-2 my-2 px-0\">\r\n          <div class=\"farris-group-wrap\" style=\"padding-top: 2px;\">\r\n            <div class=\"form-group farris-form-group mb-0\">\r\n              <div class=\"farris-input-wrap\">\r\n                <farris-button [disabled]=\"!form.ComponentId && !form.formFormatId\" [type]=\"'link'\" (click)=\"parametersSet()\">\r\n                  {{'component.executeForms.parametersSet'|wfLocale}}\r\n                </farris-button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=\"h-100 mx-3\">\r\n    <lib-form-config-container #configContainer\r\n      [formFormatId]=\"form.formFormatId\" [formatConfigId]=\"form.formatConfigId\" [showMethodTab]=\"showMethodTab\"\r\n      class=\"h-100\"></lib-form-config-container>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n\r\n\r\n\r\n",
                    providers: [
                        ExecuteFormsUIState, ExecuteFormsViewModel, ExecuteFormsRepository,
                        WfLocalePipe,
                    ],
                    styles: [""]
                }] }
    ];
    /** @nocollapse */
    ExecuteFormsComponent.ctorParameters = function () { return [
        { type: FormBuilder },
        { type: ExecuteFormsUIState },
        { type: ExecuteFormsViewModel },
        { type: ComponentFactoryResolver },
        { type: Injector },
        { type: BsModalService },
        { type: ProcessDesignerUIState },
        { type: MessagerService },
        { type: ChangeDetectorRef, decorators: [{ type: Optional }] },
        { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
        { type: undefined, decorators: [{ type: Inject, args: [WF_LANG_RESOURCES,] }] },
        { type: WfLocalePipe, decorators: [{ type: Optional }] }
    ]; };
    ExecuteFormsComponent.propDecorators = {
        cls: [{ type: HostBinding, args: ['class',] }],
        style: [{ type: HostBinding, args: ['style.background',] }],
        closeModal: [{ type: Output }],
        submitModal: [{ type: Output }],
        value: [{ type: Input }],
        editorParams: [{ type: Input }],
        modalFooter: [{ type: ViewChild, args: ['iconSelectFooter',] }],
        configContainer: [{ type: ViewChild, args: ['configContainer',] }],
        configSection: [{ type: ViewChild, args: ['configSection', { read: ElementRef },] }]
    };
    return ExecuteFormsComponent;
}());
var ExecuteFormsConverter = /** @class */ (function () {
    function ExecuteFormsConverter(params, localePipe) {
        this.localePipe = localePipe;
        this.params = params;
    }
    /**
     * @param {?} data
     * @return {?}
     */
    ExecuteFormsConverter.prototype.convertTo = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        if (data) {
            return data.Name;
        }
        else {
            if (this.params.location === 'process') {
                return this.localePipe.transform('component.executeForms.notSet');
            }
            else {
                return this.localePipe.transform('component.executeForms.default');
            }
        }
    };
    return ExecuteFormsConverter;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var TitleExpressionComponent = /** @class */ (function () {
    function TitleExpressionComponent(expr, injector, designerState, cdr, localeId, resources, localePipe) {
        this.expr = expr;
        this.injector = injector;
        this.designerState = designerState;
        this.cdr = cdr;
        this.localeId = localeId;
        this.resources = resources;
        this.localePipe = localePipe;
        this.closeModal = new EventEmitter();
        this.submitModal = new EventEmitter();
        this.textWithMultiLanguage = new Map();
        this.editorParams = {};
        this.language = 'zh-CHS';
        this.languageOptions = [
            { value: 'zh-CHS', text: this.localePipe.transform("component.titleExpression.zh-CHS") },
            { value: 'zh-CHT', text: this.localePipe.transform("component.titleExpression.zh-CHT") },
            { value: 'en', text: this.localePipe.transform("component.titleExpression.en") }
        ];
        this.contextEntities = [];
        this.schema = {};
        this.injectName = '';
        this.modalConfig = {
            title: this.localePipe.transform("component.titleExpression.taskDescription"),
            width: 1140,
            height: 720,
            showButtons: true
        };
        this.localePipe = this.localePipe || new WfLocalePipe(localeId, resources);
        if (this.designerState.schemas[0]) {
            this.schema = this.designerState.schemas[0];
            if (this.designerState.schemas[0].entityTypes && this.designerState.schemas[0].entityTypes.length > 0) {
                this.injectName = this.designerState.schemas[0].entityTypes[0].name;
            }
        }
        this.language = this.injector.get(LOCALE_ID, null) || this.language;
    }
    /**
     * @return {?}
     */
    TitleExpressionComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        var e_1, _a, e_2, _b, e_3, _c, e_4, _d, e_5, _e;
        // 构造多语表达式编辑器的数据源，兼容历史
        if (this.value != null) {
            if (typeof (this.value) === 'string') {
                this.textWithMultiLanguage.set('zh-CHS', this.value);
            }
            else {
                this.textWithMultiLanguage = new Map(Object.entries(this.value));
            }
        }
        this.contextEntities = new Array();
        if (this.designerState.procInstContext.length > 0) {
            try {
                for (var _f = __values(this.designerState.procInstContext), _g = _f.next(); !_g.done; _g = _f.next()) {
                    var variable = _g.value;
                    this.contextEntities = this.contextEntities.concat([variable]);
                }
            }
            catch (e_1_1) { e_1 = { error: e_1_1 }; }
            finally {
                try {
                    if (_g && !_g.done && (_a = _f.return)) _a.call(_f);
                }
                finally { if (e_1) throw e_1.error; }
            }
        }
        if (this.designerState.formalParameterContext.length > 0) {
            var _loop_1 = function (variable) {
                if (!this_1.contextEntities.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    this_1.contextEntities = this_1.contextEntities.concat([variable]);
                }
            };
            var this_1 = this;
            try {
                for (var _h = __values(this.designerState.formalParameterContext), _j = _h.next(); !_j.done; _j = _h.next()) {
                    var variable = _j.value;
                    _loop_1(variable);
                }
            }
            catch (e_2_1) { e_2 = { error: e_2_1 }; }
            finally {
                try {
                    if (_j && !_j.done && (_b = _h.return)) _b.call(_h);
                }
                finally { if (e_2) throw e_2.error; }
            }
        }
        if (this.designerState.subActivityContext.length > 0) {
            var _loop_2 = function (variable) {
                if (!this_2.contextEntities.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    this_2.contextEntities = this_2.contextEntities.concat([variable]);
                }
            };
            var this_2 = this;
            try {
                for (var _k = __values(this.designerState.subActivityContext), _l = _k.next(); !_l.done; _l = _k.next()) {
                    var variable = _l.value;
                    _loop_2(variable);
                }
            }
            catch (e_3_1) { e_3 = { error: e_3_1 }; }
            finally {
                try {
                    if (_l && !_l.done && (_c = _k.return)) _c.call(_k);
                }
                finally { if (e_3) throw e_3.error; }
            }
        }
        if (this.designerState.participantContext.length > 0) {
            var _loop_3 = function (variable) {
                if (!this_3.contextEntities.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    this_3.contextEntities = this_3.contextEntities.concat([variable]);
                }
            };
            var this_3 = this;
            try {
                for (var _m = __values(this.designerState.participantContext), _o = _m.next(); !_o.done; _o = _m.next()) {
                    var variable = _o.value;
                    _loop_3(variable);
                }
            }
            catch (e_4_1) { e_4 = { error: e_4_1 }; }
            finally {
                try {
                    if (_o && !_o.done && (_d = _m.return)) _d.call(_m);
                }
                finally { if (e_4) throw e_4.error; }
            }
        }
        if (this.designerState.processVariableContext.length > 0) {
            var _loop_4 = function (variable) {
                if (!this_4.contextEntities.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    this_4.contextEntities = this_4.contextEntities.concat([variable]);
                }
            };
            var this_4 = this;
            try {
                for (var _p = __values(this.designerState.processVariableContext), _q = _p.next(); !_q.done; _q = _p.next()) {
                    var variable = _q.value;
                    _loop_4(variable);
                }
            }
            catch (e_5_1) { e_5 = { error: e_5_1 }; }
            finally {
                try {
                    if (_q && !_q.done && (_e = _p.return)) _e.call(_p);
                }
                finally { if (e_5) throw e_5.error; }
            }
        }
    };
    /**
     * @return {?}
     */
    TitleExpressionComponent.prototype.clickOK = /**
     * @return {?}
     */
    function () {
        this.value = this.editor.getExprWithMultiLanguage();
        /** @type {?} */
        var obj = __spread(this.value.entries()).reduce((/**
         * @param {?} obj
         * @param {?} __1
         * @return {?}
         */
        function (obj, _a) {
            var _b = __read(_a, 2), key = _b[0], value = _b[1];
            return (obj[key] = value == null ? '' : value, obj);
        }), {});
        /** @type {?} */
        var object = { value: obj, parameters: null };
        this.submitModal.emit(object);
    };
    /**
     * @return {?}
     */
    TitleExpressionComponent.prototype.clickCancel = /**
     * @return {?}
     */
    function () {
        this.closeModal.emit();
    };
    /**
     * @private
     * @param {?} val
     * @return {?}
     */
    TitleExpressionComponent.prototype.convertToValue = /**
     * @private
     * @param {?} val
     * @return {?}
     */
    function (val) {
        if (val) {
            if (val.substring(9, val.length - 2)) {
                return val;
            }
            else {
                return '';
            }
        }
        else {
            return '';
        }
    };
    TitleExpressionComponent.decorators = [
        { type: Component, args: [{
                    selector: 'app-title-expression',
                    template: "<div class=\"f-page\">\r\n  <div class=\"f-page-header\">\r\n    <nav class=\"f-page-header-base\">\r\n      <div class=\"f-title\">\r\n        <div class=\"col-12 farris-group-auto pr-5\">\r\n          <div class=\"farris-group-wrap\">\r\n            <div class=\"form-group farris-form-group\" style=\"display:flex\">\r\n              <label class=\"col-form-label\">\r\n                <span class=\"farris-label-text\">{{'component.titleExpression.currentLanguage' | wfLocale}}</span>\r\n              </label>\r\n              <div class=\"farris-input-wrap\">\r\n                <farris-combo-list [data]=\"languageOptions\" [textField]=\"'text'\" [valueField]=\"'value'\"\r\n                  [idField]=\"'value'\" [(ngModel)]=\"language\" style=\"flex: 1;\" [enableClear]=\"false\">\r\n                </farris-combo-list>\r\n                <div class=\"farris-feedback valid-feedback\"></div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </nav>\r\n  </div>\r\n  <div class=\"f-page-main f-utils-fill-flex-column h-100\">\r\n    <div class=\"f-utils-fill-flex-column farris-overflow-y-auto h-100\">\r\n      <app-expressioneditor class=\"h-100\" [isPanel]=\"true\" [contextEntities]=\"contextEntities\" [text]=\"value\"\r\n        [customSchemaName]=\"'Schema'\" [customSchema]=\"schema\" [injectName]=\"injectName\" [injectSchemaName]=\"'Schema'\"\r\n        [injectNameInSchema]=\"injectName\" [language]=\"language\" [textWithMultiLanguage]=\"textWithMultiLanguage\">\r\n      </app-expressioneditor>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #iconSelectFooter>\r\n  <div class=\"btns\">\r\n    <button type=\"button\" class=\"btn btn-secondary btn-sm\" (click)=\"clickCancel()\">{{'component.titleExpression.clickCancel' | wfLocale}}</button>\r\n    <button type=\"button\" class=\"btn btn-primary btn-sm mr-2\" (click)=\"clickOK()\">{{'component.titleExpression.clickOK' | wfLocale}}</button>\r\n  </div>\r\n</ng-template>\r\n",
                    providers: [
                        WfLocalePipe,
                    ],
                    styles: [""]
                }] }
    ];
    /** @nocollapse */
    TitleExpressionComponent.ctorParameters = function () { return [
        { type: ExpressionService },
        { type: Injector },
        { type: ProcessDesignerUIState },
        { type: ChangeDetectorRef, decorators: [{ type: Optional }] },
        { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
        { type: undefined, decorators: [{ type: Inject, args: [WF_LANG_RESOURCES,] }] },
        { type: WfLocalePipe, decorators: [{ type: Optional }] }
    ]; };
    TitleExpressionComponent.propDecorators = {
        closeModal: [{ type: Output }],
        submitModal: [{ type: Output }],
        value: [{ type: Input }],
        modalFooter: [{ type: ViewChild, args: ['iconSelectFooter',] }],
        editorParams: [{ type: Input }],
        editor: [{ type: ViewChild, args: [ExpressioneditorComponent,] }]
    };
    return TitleExpressionComponent;
}());
var TitleExpressionConverter = /** @class */ (function () {
    function TitleExpressionConverter(localePipe) {
        this.localePipe = localePipe;
    }
    /**
     * @param {?} data
     * @return {?}
     */
    TitleExpressionConverter.prototype.convertTo = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        if (data && typeof data === 'string') {
            return data;
        }
        else if (data && Object.keys(data).length > 0) {
            return this.areAllPropertiesEmpty(data)
                ? this.localePipe.transform("component.titleExpression.notSet")
                : this.localePipe.transform("component.titleExpression.set");
        }
        else {
            return this.localePipe.transform("component.titleExpression.notSet");
        }
    };
    /**
     * @param {?} obj
     * @return {?}
     */
    TitleExpressionConverter.prototype.areAllPropertiesEmpty = /**
     * @param {?} obj
     * @return {?}
     */
    function (obj) {
        for (var key in obj) {
            if (obj.hasOwnProperty(key) && obj[key] !== '') {
                return false;
            }
        }
        return true;
    };
    return TitleExpressionConverter;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var CustomizeAciton = /** @class */ (function () {
    function CustomizeAciton(id, code, name) {
        this.id = id;
        this.code = code;
        this.name = name;
    }
    return CustomizeAciton;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var CustomizeActionListComponent = /** @class */ (function () {
    function CustomizeActionListComponent(designerUIState, cdr, localeId, resources, localePipe) {
        this.designerUIState = designerUIState;
        this.cdr = cdr;
        this.localeId = localeId;
        this.resources = resources;
        this.localePipe = localePipe;
        this.submit = new EventEmitter();
        this.cancel = new EventEmitter();
        this.terminalList = [
            { value: 'app', text: this.localePipe.transform('component.customizeAction.app') },
            { value: 'web', text: 'web' },
            { value: 'web,app', text: this.localePipe.transform('component.customizeAction.all') }
        ];
        this.cols = [
            { field: 'code', width: 100, title: this.localePipe.transform('component.customizeAction.code') },
            { field: 'name', width: 100, title: this.localePipe.transform('component.customizeAction.name') },
            {
                field: 'terminal', width: 100, title: this.localePipe.transform('component.customizeAction.terminalType'),
                formatter: {
                    type: 'enum',
                    options: { valueField: 'value', textField: 'text', data: this.terminalList }
                },
            },
            {
                field: 'isAll', width: 100, title: this.localePipe.transform('component.customizeAction.isAll'),
                formatter: { type: 'boolean', options: { trueText: this.localePipe.transform('component.customizeAction.yes'), falseText: this.localePipe.transform('component.customizeAction.no') } }
            }
        ];
        this.localePipe = this.localePipe || new WfLocalePipe(localeId, resources);
        this.customActionList = this.designerUIState.flowFormInfo.customizeActions || [];
    }
    /**
     * @return {?}
     */
    CustomizeActionListComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
    };
    /**
     * @return {?}
     */
    CustomizeActionListComponent.prototype.clickOK = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var selections = [];
        /** @type {?} */
        var checkeds = this.grid.checkeds;
        if (checkeds && checkeds.length > 0) {
            checkeds.forEach((/**
             * @param {?} action
             * @return {?}
             */
            function (action) {
                var e_1, _a;
                /** @type {?} */
                var item = new CustomizeAciton(action.data.id, action.data.code, action.data.name);
                item.terminalType = action.data.terminal;
                // item.enable = true;
                item.actualParameters = [];
                if (action.data.actualParameters && action.data.actualParameters.length > 0) {
                    try {
                        for (var _b = __values(action.data.actualParameters), _c = _b.next(); !_c.done; _c = _b.next()) {
                            var p = _c.value;
                            /** @type {?} */
                            var param = (/** @type {?} */ ({
                                Name: p.code,
                                Value: p.value,
                                ValueText: p.name,
                                Tag: 'expression'
                            }));
                            item.actualParameters.push(param);
                        }
                    }
                    catch (e_1_1) { e_1 = { error: e_1_1 }; }
                    finally {
                        try {
                            if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                        }
                        finally { if (e_1) throw e_1.error; }
                    }
                }
                selections.push(item);
            }));
        }
        this.submit.emit(selections);
    };
    /**
     * @return {?}
     */
    CustomizeActionListComponent.prototype.clickCancel = /**
     * @return {?}
     */
    function () {
        this.cancel.emit(true);
    };
    CustomizeActionListComponent.decorators = [
        { type: Component, args: [{
                    selector: 'app-customize-action-list',
                    template: "<div class=\"f-utils-fill-flex-column farris-overflow-y-auto h-100 m-2\">\r\n  <farris-datagrid #grid [columns]=\"cols\" [data]=\"customActionList\" [idField]=\"'id'\" [fit]=\"true\"\r\n    [fitColumns]=\"true\" [pagination]='false' [multiSelect]=\"true\" [showCheckbox]=\"true\" [multiSelect]=\"true\"\r\n    [checkOnSelect]=\"true\" [selectOnCheck]=\"true\">\r\n  </farris-datagrid>\r\n</div>\r\n\r\n<ng-template #footer>\r\n  <button type=\"button\" class=\"btn btn-secondary btn-sm px-3\" (click)=\"clickCancel()\">{{'component.customizeAction.clickCancel' | wfLocale}}</button>\r\n  <button type=\"button\" class=\"btn btn-primary btn-sm px-3 mx-2\" (click)=\"clickOK()\">{{'component.customizeAction.clickOK' | wfLocale}}</button>\r\n</ng-template>\r\n",
                    providers: [
                        WfLocalePipe,
                    ],
                    styles: [""]
                }] }
    ];
    /** @nocollapse */
    CustomizeActionListComponent.ctorParameters = function () { return [
        { type: ProcessDesignerUIState },
        { type: ChangeDetectorRef, decorators: [{ type: Optional }] },
        { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
        { type: undefined, decorators: [{ type: Inject, args: [WF_LANG_RESOURCES,] }] },
        { type: WfLocalePipe, decorators: [{ type: Optional }] }
    ]; };
    CustomizeActionListComponent.propDecorators = {
        grid: [{ type: ViewChild, args: ['grid',] }],
        footer: [{ type: ViewChild, args: ['footer',] }],
        submit: [{ type: Output }],
        cancel: [{ type: Output }]
    };
    return CustomizeActionListComponent;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var CustomizeActionComponent = /** @class */ (function () {
    function CustomizeActionComponent(designerState, expr, resolver, injector, modalService, message, cdr, localeId, resources, localePipe) {
        var _this = this;
        this.designerState = designerState;
        this.expr = expr;
        this.resolver = resolver;
        this.injector = injector;
        this.modalService = modalService;
        this.message = message;
        this.cdr = cdr;
        this.localeId = localeId;
        this.resources = resources;
        this.localePipe = localePipe;
        this.cls = 'farris-main-area flex-column';
        this.closeModal = new EventEmitter();
        this.submitModal = new EventEmitter();
        this.editorParams = {};
        this.modalConfig = {
            title: this.localePipe.transform('component.customizeAction.customizeAction'),
            width: 800,
            height: 520,
            showButtons: true
        };
        this.terminalList = [
            { value: 'app', text: this.localePipe.transform('component.customizeAction.app') },
            { value: 'web', text: 'web' },
            { value: 'web,app', text: this.localePipe.transform('component.customizeAction.') }
        ];
        this.actions = [];
        this.columns = [
            { field: 'code', width: 100, title: this.localePipe.transform('component.customizeAction.code') },
            { field: 'name', width: 100, title: this.localePipe.transform('component.customizeAction.name') },
            {
                field: 'terminalType', width: 100, title: this.localePipe.transform('component.customizeAction.terminalType'),
                formatter: {
                    type: 'enum',
                    options: { valueField: 'value', textField: 'text', data: this.terminalList }
                },
            },
        ];
        this.paramColumns = [
            { field: 'Name', width: 50, title: this.localePipe.transform('component.customizeAction.paramName') },
            { field: 'ValueText', width: 50, title: this.localePipe.transform('component.customizeAction.valueText') },
            {
                field: 'Value', width: 100, title: this.localePipe.transform('component.customizeAction.value'),
                editor: {
                    type: 'input-group',
                    options: {
                        groupText: '<i class="f-icon f-icon-lookup"></i>',
                        editable: false,
                        clickHandle: (/**
                         * @param {?} e
                         * @return {?}
                         */
                        function (e) {
                            e.formControl.setValue(e.instance.value ? e.instance.value : '');
                            _this.showExprHelp(e);
                        }),
                        clear: (/**
                         * @param {?} e
                         * @return {?}
                         */
                        function (e) {
                            console.log('clear', e);
                        })
                    }
                }
            }
        ];
        this.localePipe = this.localePipe || new WfLocalePipe(localeId, resources);
    }
    Object.defineProperty(CustomizeActionComponent.prototype, "value", {
        set: /**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            var e_1, _a, e_2, _b;
            if (data && data.length > 0) {
                try {
                    for (var data_1 = __values(data), data_1_1 = data_1.next(); !data_1_1.done; data_1_1 = data_1.next()) {
                        var d = data_1_1.value;
                        /** @type {?} */
                        var action = new CustomizeAciton(d.id, d.code, d.name);
                        action.terminalType = d.terminalType;
                        action.actualParameters = [];
                        if (d.actualParameters && d.actualParameters.length > 0) {
                            try {
                                for (var _c = __values(d.actualParameters), _d = _c.next(); !_d.done; _d = _c.next()) {
                                    var a = _d.value;
                                    /** @type {?} */
                                    var p = new ActualParameter$1();
                                    p.Name = a.Name;
                                    p.Value = a.Value;
                                    p.ValueText = a.ValueText;
                                    p.Tag = a.Tag;
                                    action.actualParameters.push(p);
                                }
                            }
                            catch (e_2_1) { e_2 = { error: e_2_1 }; }
                            finally {
                                try {
                                    if (_d && !_d.done && (_b = _c.return)) _b.call(_c);
                                }
                                finally { if (e_2) throw e_2.error; }
                            }
                        }
                        this.actions.push(action);
                    }
                }
                catch (e_1_1) { e_1 = { error: e_1_1 }; }
                finally {
                    try {
                        if (data_1_1 && !data_1_1.done && (_a = data_1.return)) _a.call(data_1);
                    }
                    finally { if (e_1) throw e_1.error; }
                }
            }
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    CustomizeActionComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
    };
    /**
     * @return {?}
     */
    CustomizeActionComponent.prototype.ngAfterViewInit = /**
     * @return {?}
     */
    function () {
        this.loadData();
        // this.actionlist.loadData(this.actions);
        // if (this.actions && this.actions.length > 0) {
        //   this.actionlist.selectRow(this.actions[0].id, true);
        // }
    };
    /**
     * @return {?}
     */
    CustomizeActionComponent.prototype.addActions = /**
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var compFactory = this.resolver.resolveComponentFactory(CustomizeActionListComponent);
        /** @type {?} */
        var compRef = compFactory.create(this.injector);
        /** @type {?} */
        var modalConfig = {
            title: this.localePipe.transform('component.customizeAction.addActions'),
            width: 800,
            height: 520,
            showButtons: true,
            buttons: compRef.instance.footer
        };
        /** @type {?} */
        var dialog = this.modalService.show(compRef, modalConfig);
        compRef.instance.submit.subscribe((/**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            var e_3, _a;
            if (data && data.length > 0) {
                var _loop_1 = function (a) {
                    /** @type {?} */
                    var index = _this.actions.findIndex((/**
                     * @param {?} act
                     * @return {?}
                     */
                    function (act) { return act.code === a.code; }));
                    if (index > -1) {
                        _this.message.info(_this.localePipe.transform('component.customizeAction.actionExisted'));
                        _this.actions.splice(index, 1);
                    }
                    _this.actions.push(a);
                };
                try {
                    for (var data_2 = __values(data), data_2_1 = data_2.next(); !data_2_1.done; data_2_1 = data_2.next()) {
                        var a = data_2_1.value;
                        _loop_1(a);
                    }
                }
                catch (e_3_1) { e_3 = { error: e_3_1 }; }
                finally {
                    try {
                        if (data_2_1 && !data_2_1.done && (_a = data_2.return)) _a.call(data_2);
                    }
                    finally { if (e_3) throw e_3.error; }
                }
                _this.loadData();
            }
            dialog.close();
        }));
        compRef.instance.cancel.subscribe((/**
         * @param {?} $event
         * @return {?}
         */
        function ($event) { return dialog.close(); }));
    };
    /**
     * @return {?}
     */
    CustomizeActionComponent.prototype.delete = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.actionlist.endCellEdit();
        if (this.actionlist.selectedRow && this.actionlist.selectedRow.data) {
            /** @type {?} */
            var i = this.actions.findIndex((/**
             * @param {?} d
             * @return {?}
             */
            function (d) { return d.code === _this.actionlist.selectedRow.data.code; }));
            this.actions.splice(i, 1);
            this.loadData();
            // this.actionlist.loadData(this.actions);
            // if (this.actions && this.actions.length > 0) {
            //   this.actionlist.selectRow(this.actions[0].id, true);
            // } else {
            //   this.curAction = null;
            // }
        }
        else {
            this.message.info(this.localePipe.transform('component.customizeAction.selectedRow'));
        }
    };
    /**
     * @return {?}
     */
    CustomizeActionComponent.prototype.clickOK = /**
     * @return {?}
     */
    function () {
        this.actionlist.endCellEdit();
        this.paramlist && this.paramlist.endCellEdit();
        /** @type {?} */
        var object = { value: this.actions, parameters: null };
        this.submitModal.emit(object);
    };
    /**
     * @return {?}
     */
    CustomizeActionComponent.prototype.clickCancel = /**
     * @return {?}
     */
    function () {
        this.closeModal.emit();
    };
    /**
     * @return {?}
     */
    CustomizeActionComponent.prototype.loadData = /**
     * @return {?}
     */
    function () {
        this.actionlist.loadData(this.actions);
        if (this.actions.length > 0 && (!this.actionlist.selectedRow || !this.actionlist.selectedRow.data)) {
            this.actionlist.selectRow(this.actions[0].id, true);
        }
        else {
            this.curAction = null;
        }
    };
    /**
     * @param {?} data
     * @return {?}
     */
    CustomizeActionComponent.prototype.selectChanged = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        this.curAction = data.data;
    };
    /**
     * @param {?} e
     * @return {?}
     */
    CustomizeActionComponent.prototype.showExprHelp = /**
     * @param {?} e
     * @return {?}
     */
    function (e) {
        var _this = this;
        var e_4, _a, e_5, _b, e_6, _c;
        /** @type {?} */
        var context = new Array();
        // if(this.expr.exprEntity.contextEntities.find(x => x.key === 'CurrentLanguage')) {
        //   context.push(this.expr.exprEntity.contextEntities.find(x => x.key === 'CurrentLanguage'));
        // }
        // this.expr.clearContext();
        if (this.designerState.schemas.length > 0) {
            try {
                for (var _d = __values(this.designerState.schemas), _e = _d.next(); !_e.done; _e = _d.next()) {
                    var schema = _e.value;
                    this.expr.addSchema('Schema', schema);
                }
            }
            catch (e_4_1) { e_4 = { error: e_4_1 }; }
            finally {
                try {
                    if (_e && !_e.done && (_a = _d.return)) _a.call(_d);
                }
                finally { if (e_4) throw e_4.error; }
            }
            if (this.designerState.schemas[0].entityTypes && this.designerState.schemas[0].entityTypes.length > 0) {
                /** @type {?} */
                var entityType = this.designerState.schemas[0].entityTypes[0];
                this.expr.addInjectedEntity(entityType.name, 'Schema', entityType.name, InjectedType.EntityType);
            }
        }
        context = this.designerState.addContext(context);
        if (this.designerState.subActivityContext.length > 0) {
            var _loop_2 = function (variable) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    context.push(variable);
                }
            };
            try {
                for (var _f = __values(this.designerState.subActivityContext), _g = _f.next(); !_g.done; _g = _f.next()) {
                    var variable = _g.value;
                    _loop_2(variable);
                }
            }
            catch (e_5_1) { e_5 = { error: e_5_1 }; }
            finally {
                try {
                    if (_g && !_g.done && (_b = _f.return)) _b.call(_f);
                }
                finally { if (e_5) throw e_5.error; }
            }
        }
        if (context.length > 0) {
            try {
                for (var context_1 = __values(context), context_1_1 = context_1.next(); !context_1_1.done; context_1_1 = context_1.next()) {
                    var v = context_1_1.value;
                    this.expr.addContext(v);
                }
            }
            catch (e_6_1) { e_6 = { error: e_6_1 }; }
            finally {
                try {
                    if (context_1_1 && !context_1_1.done && (_c = context_1.return)) _c.call(context_1);
                }
                finally { if (e_6) throw e_6.error; }
            }
        }
        // if (e.instance.value) {
        this.expr.addExpressionText(e.instance.value);
        // }
        this.expr.buildExpression().then((/**
         * @param {?} expressioninfo
         * @return {?}
         */
        function (expressioninfo) {
            e.formControl.setValue(expressioninfo);
            e.instance.cd.detectChanges();
            //点击确定后，去除表达式里面的新增的上下文变量
            if (context.length > 0) {
                _this.expr.exprEntity.contextEntities = _this.expr.exprEntity.contextEntities.filter((/**
                 * @param {?} x
                 * @return {?}
                 */
                function (x) { return !context.some((/**
                 * @param {?} y
                 * @return {?}
                 */
                function (y) { return y.key === x.key; })); }));
            }
        }));
    };
    CustomizeActionComponent.decorators = [
        { type: Component, args: [{
                    selector: 'app-customize-action',
                    template: "<div class=\"f-page\">\r\n  <div class=\"f-page-header\">\r\n    <nav class=\"f-page-header-base\">\r\n      <div class=\"f-title\">\r\n        <!-- <span class=\"f-title-icon f-text-orna-bill\">\r\n          <i class=\"f-icon f-icon-page-title-administer\"></i>\r\n        </span> -->\r\n        <!-- <h4 class=\"f-title-text\">\u5217\u8868</h4> -->\r\n      </div>\r\n      <div class=\"btn-toolbar btn-group-lg\">\r\n        <button class=\"btn btn-primary mr-2\" (click)=\"addActions()\">{{'component.customizeAction.add' | wfLocale}}</button>\r\n        <button class=\"btn btn-secondary\" (click)=\"delete()\">{{'component.customizeAction.delete' | wfLocale}}</button>\r\n      </div>\r\n    </nav>\r\n  </div>\r\n  <div class=\"f-page-main f-utils-fill-flex-column h-100\">\r\n    <div class=\"f-utils-fill-flex-column farris-overflow-y-auto h-100\">\r\n      <div [style.height.%]=\"curAction?45:100\">\r\n        <farris-datagrid #actionlist [data]=\"actions\" [idField]=\"'id'\"\r\n          [columns]=\"columns\" [fit]=\"true\" [fitColumns]=\"true\" [editable]=\"true\"\r\n          [editMode]=\"'cell'\" [pagination]=\"false\" [showCheckbox]=\"false\" [multiSelect]=\"false\"\r\n          (selectChanged)=\"selectChanged($event)\" [closeOtherGridEditor]=\"true\">\r\n        </farris-datagrid>\r\n      </div>\r\n      <ng-container *ngIf=\"curAction\">\r\n        <farris-tabs class=\"f-utils-fill\" [value]=\"'parameters'\" [contentFill]=\"true\" [autoTitleWidth]=\"true\">\r\n          <farris-tab title=\"{{'component.customizeAction.parameterList'|wfLocale}}\" [id]=\"'parameters'\">\r\n            <ng-template #content>\r\n              <div class=\"f-utils-fill-flex-column h-100\">\r\n                <farris-datagrid #paramlist [data]=\"curAction.actualParameters\" [columns]=\"paramColumns\"\r\n                  [idField]=\"'Name'\" [fit]=\"true\" [fitColumns]=\"true\" [editable]=\"true\" [editMode]=\"'cell'\"\r\n                  [pagination]=\"false\" [showCheckbox]=\"false\" [multiSelect]=\"false\" [closeOtherGridEditor]=\"true\">\r\n                </farris-datagrid>\r\n              </div>\r\n            </ng-template>\r\n          </farris-tab>\r\n        </farris-tabs>\r\n      </ng-container>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type=\"button\" class=\"btn btn-secondary btn-sm px-3\" (click)=\"clickCancel()\">{{'component.customizeAction.clickCancel' | wfLocale}}</button>\r\n  <button type=\"button\" class=\"btn btn-primary btn-sm px-3 mx-2\" (click)=\"clickOK()\">{{'component.customizeAction.clickOK' | wfLocale}}</button>\r\n</ng-template>\r\n",
                    providers: [
                        WfLocalePipe,
                    ],
                    styles: [""]
                }] }
    ];
    /** @nocollapse */
    CustomizeActionComponent.ctorParameters = function () { return [
        { type: ProcessDesignerUIState },
        { type: ExpressionService },
        { type: ComponentFactoryResolver },
        { type: Injector },
        { type: BsModalService },
        { type: MessagerService },
        { type: ChangeDetectorRef, decorators: [{ type: Optional }] },
        { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
        { type: undefined, decorators: [{ type: Inject, args: [WF_LANG_RESOURCES,] }] },
        { type: WfLocalePipe, decorators: [{ type: Optional }] }
    ]; };
    CustomizeActionComponent.propDecorators = {
        cls: [{ type: HostBinding, args: ['class',] }],
        closeModal: [{ type: Output }],
        submitModal: [{ type: Output }],
        editorParams: [{ type: Input }],
        modalFooter: [{ type: ViewChild, args: ['iconSelectFooter',] }],
        value: [{ type: Input }],
        actionlist: [{ type: ViewChild, args: ['actionlist',] }],
        paramlist: [{ type: ViewChild, args: ['paramlist',] }]
    };
    return CustomizeActionComponent;
}());
var CustomizeActionConverter = /** @class */ (function () {
    function CustomizeActionConverter(localePipe) {
        this.localePipe = localePipe;
    }
    /**
     * @param {?} data
     * @return {?}
     */
    CustomizeActionConverter.prototype.convertTo = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        if (data && data.length > 0) {
            return this.localePipe.transform("component.customizeAction.set");
        }
        else {
            return this.localePipe.transform("component.customizeAction.notSet");
        }
    };
    return CustomizeActionConverter;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var ProcessVariable = /** @class */ (function () {
    function ProcessVariable() {
        this.id = ProcessDeUtil.GenerateElementId();
        this.basicType = 'String';
    }
    return ProcessVariable;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var ConstantEditComponent = /** @class */ (function () {
    function ConstantEditComponent(cdr, localeId, resources, localePipe) {
        this.cdr = cdr;
        this.localeId = localeId;
        this.resources = resources;
        this.localePipe = localePipe;
        this.closeEmitter = new EventEmitter();
        this.submitEmitter = new EventEmitter();
    }
    /**
     * @return {?}
     */
    ConstantEditComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
    };
    /**
     * @return {?}
     */
    ConstantEditComponent.prototype.clickOK = /**
     * @return {?}
     */
    function () {
        this.submitEmitter.emit(this.value);
    };
    /**
     * @return {?}
     */
    ConstantEditComponent.prototype.clickCancel = /**
     * @return {?}
     */
    function () {
        this.closeEmitter.emit();
    };
    ConstantEditComponent.decorators = [
        { type: Component, args: [{
                    selector: 'lib-constant-edit',
                    template: "<div class=\"f-page\">\r\n  <div class=\"f-utils-fill-flex-column farris-split-section m-2 h-100\">\r\n    <section class=\"f-utils-fill-flex-column h-100\">\r\n      <textarea class=\"form-control\" type=\"text\" value=\"message\" [(ngModel)]=\"value\"\r\n        name=\"message\" style=\"height: 100%;\"></textarea>\r\n      <div class=\"farris-feedback valid-feedback\"></div>\r\n    </section>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #footer>\r\n  <button type=\"button\" class=\"btn btn-secondary btn-sm\" (click)=\"clickCancel()\">{{'component.optins.clickCancel' | wfLocale}}</button>\r\n  <button type=\"button\" class=\"btn btn-primary btn-sm mx-2\" (click)=\"clickOK()\">{{'component.optins.clickOk' | wfLocale}}</button>\r\n</ng-template>\r\n",
                    providers: [
                        WfLocalePipe,
                    ],
                    styles: [""]
                }] }
    ];
    /** @nocollapse */
    ConstantEditComponent.ctorParameters = function () { return [
        { type: ChangeDetectorRef, decorators: [{ type: Optional }] },
        { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
        { type: undefined, decorators: [{ type: Inject, args: [WF_LANG_RESOURCES,] }] },
        { type: WfLocalePipe, decorators: [{ type: Optional }] }
    ]; };
    ConstantEditComponent.propDecorators = {
        footer: [{ type: ViewChild, args: ['footer',] }],
        closeEmitter: [{ type: Output }],
        submitEmitter: [{ type: Output }],
        value: [{ type: Input }]
    };
    return ConstantEditComponent;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var ComponentEditLookUpService = /** @class */ (function () {
    function ComponentEditLookUpService(http) {
        this.http = http;
    }
    /**
     * @param {?} url
     * @param {?=} params
     * @return {?}
     */
    ComponentEditLookUpService.prototype.getData = /**
     * @param {?} url
     * @param {?=} params
     * @return {?}
     */
    function (url, params) {
        /** @type {?} */
        var customData = params.customData;
        /** @type {?} */
        var index = params.pageIndex || 1;
        /** @type {?} */
        var size = params.pageSize || 20;
        /** @type {?} */
        var searchValue = params.searchValue;
        if (customData.helpId) {
            /** @type {?} */
            var query = "?helpId=" + customData.helpId + "&pageIndex=" + index + "&pageSize=" + size;
            if (searchValue) {
                query += "&searchValue=" + searchValue;
            }
            url += query;
            return this.http.get(url);
        }
    };
    ComponentEditLookUpService.decorators = [
        { type: Injectable }
    ];
    /** @nocollapse */
    ComponentEditLookUpService.ctorParameters = function () { return [
        { type: HttpService }
    ]; };
    return ComponentEditLookUpService;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var ComponentEditService = /** @class */ (function () {
    function ComponentEditService(http) {
        this.http = http;
    }
    /**
     * @param {?} helpId
     * @param {?} su
     * @return {?}
     */
    ComponentEditService.prototype.getHelpMetaData = /**
     * @param {?} helpId
     * @param {?} su
     * @return {?}
     */
    function (helpId, su) {
        /** @type {?} */
        var url = "/api/runtime/lcm/v1.0/rt-metadatas/" + helpId;
        return this.http.get(url);
    };
    ComponentEditService.decorators = [
        { type: Injectable }
    ];
    /** @nocollapse */
    ComponentEditService.ctorParameters = function () { return [
        { type: HttpService }
    ]; };
    return ComponentEditService;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var ComponentEntity = /** @class */ (function () {
    function ComponentEntity() {
        this.Id = ProcessDeUtil.GenerateElementId();
        this.ActualParameters = new Array();
    }
    return ComponentEntity;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var ComponentEditComponent = /** @class */ (function () {
    function ComponentEditComponent(formBuilder, designerState, expr, resolver, injector, sessionSrc, modalService, componentService, ngZone, service, util, message, cdr, localeId, resources, localePipe) {
        var _this = this;
        this.formBuilder = formBuilder;
        this.designerState = designerState;
        this.expr = expr;
        this.resolver = resolver;
        this.injector = injector;
        this.sessionSrc = sessionSrc;
        this.modalService = modalService;
        this.componentService = componentService;
        this.ngZone = ngZone;
        this.service = service;
        this.util = util;
        this.message = message;
        this.cdr = cdr;
        this.localeId = localeId;
        this.resources = resources;
        this.localePipe = localePipe;
        this.cls = 'farris-main-area flex-column';
        this.closeEmitter = new EventEmitter();
        this.submitEmitter = new EventEmitter();
        this.showClearButton = false;
        this._component = new ComponentEntity();
        this.columns = [
            { field: 'Name', width: 100, title: this.localePipe.transform("component.variableSetting.parameterName") },
            {
                field: 'Value', width: 100, title: this.localePipe.transform("component.variableSetting.parameterValue"),
                editor: {
                    type: 'input-group',
                    options: {
                        groupText: '<i class="f-icon f-icon-lookup"></i>',
                        editable: false,
                        clickHandle: (/**
                         * @param {?} e
                         * @return {?}
                         */
                        function (e) {
                            e.formControl.setValue(e.instance.value ? e.instance.value : '');
                            _this.showExprHelp(e);
                        }),
                        clear: (/**
                         * @param {?} e
                         * @return {?}
                         */
                        function (e) {
                            console.log('clear', e);
                        })
                    }
                }
            }
        ];
        this.helpFields = {
            idField: '',
            valueField: '',
            textField: ''
        };
        this.dataUri = '/api/runtime/wf/v1.0/dtProcDefs/getHelpData';
        this.helpCols = [];
        this.displayType = 'List';
        this.title = '';
        this.beforeEdit = (/**
         * @param {?} param
         * @return {?}
         */
        function (param) {
            /** @type {?} */
            var rowData = (/** @type {?} */ (param.rowData));
            switch (rowData.fetchValueMode) {
                case ParameterFetchValueMode.express:
                    param.column.editor = {
                        type: 'input-group',
                        options: {
                            groupText: '<i class="f-icon f-icon-lookup"></i>',
                            editable: false,
                            clickHandle: (/**
                             * @param {?} e
                             * @return {?}
                             */
                            function (e) {
                                e.formControl.setValue(e.instance.value ? e.instance.value : '');
                                _this.showExprHelp(e);
                            }),
                            clear: (/**
                             * @param {?} e
                             * @return {?}
                             */
                            function (e) {
                                console.log('clear', e);
                            })
                        }
                    };
                    break;
                case ParameterFetchValueMode.none:
                    param.column.editor = {
                        type: 'input-group',
                        options: {
                            groupText: '<i class="f-icon f-icon-lookup"></i>',
                            editable: false,
                            clickHandle: (/**
                             * @param {?} e
                             * @return {?}
                             */
                            function (e) {
                                e.formControl.setValue(e.instance.value ? e.instance.value : '');
                                _this.showExprHelp(e);
                            }),
                            clear: (/**
                             * @param {?} e
                             * @return {?}
                             */
                            function (e) {
                                console.log('clear', e);
                            })
                        }
                    };
                    break;
                case ParameterFetchValueMode.const:
                    param.column.editor = { type: EditorTypes.TEXTBOX, options: {} };
                    break;
                case ParameterFetchValueMode.enum:
                    param.column.editor = { type: EditorTypes.TEXTBOX, options: {} };
                    break;
                case ParameterFetchValueMode.help:
                    param.column.editor = {
                        type: 'input-group',
                        options: {
                            groupText: '<i class="f-icon f-icon-lookup"></i>',
                            editable: false,
                            clickHandle: (/**
                             * @param {?} e
                             * @return {?}
                             */
                            function (e) {
                                _this.cell = e;
                                _this.helpId = ((/** @type {?} */ (rowData.fetchValueSetting))).helpId;
                                _this.su = ((/** @type {?} */ (rowData.fetchValueSetting))).serviceUnit;
                                _this.getHelpInfo().subscribe((/**
                                 * @param {?} re
                                 * @return {?}
                                 */
                                function (re) {
                                    console.log(re);
                                    /** @type {?} */
                                    var meta = re;
                                    /** @type {?} */
                                    var help = (/** @type {?} */ (JSON.parse(meta.content)));
                                    _this.helpCols = help.dataSource.columns;
                                    _this.displayType = help.displayType;
                                    _this.helpFields = {
                                        idField: help.idField,
                                        valueField: help.valueField,
                                        textField: help.textField
                                    };
                                    _this.lookup.onClear();
                                    _this.lookup.showDialog();
                                }), (/**
                                 * @param {?} err
                                 * @return {?}
                                 */
                                function (err) {
                                    _this.message.error(_this.localePipe.transform("component.variableSetting.metadataNotExist"));
                                }));
                            }),
                            clear: (/**
                             * @param {?} e
                             * @return {?}
                             */
                            function (e) {
                                console.log('clear', e);
                            })
                        }
                    };
                    break;
            }
            return of$1(true);
        });
        this.afterEdit = (/**
         * @param {?} rowIndex
         * @param {?} rowData
         * @param {?=} column
         * @return {?}
         */
        function (rowIndex, rowData, column) {
            return of$1(true);
        });
        this.dictPicking = (/**
         * @return {?}
         */
        function () {
            return of$1({
                showDialog: true, data: {
                    helpId: _this.helpId
                }
            });
        });
        this.dictPicked = (/**
         * @param {?} rowData
         * @return {?}
         */
        function (rowData) {
            if (_this.cell) {
                console.log(rowData);
                _this.cell.formControl.setValue(_this.util.getValue(rowData, _this.helpFields.valueField));
                _this.cell.instance.cd.detectChanges();
                return of$1(true);
            }
        });
        this.localePipe = this.localePipe || new WfLocalePipe(localeId, resources);
    }
    Object.defineProperty(ComponentEditComponent.prototype, "component", {
        get: /**
         * @return {?}
         */
        function () {
            return this._component;
        },
        set: /**
         * @param {?} cmp
         * @return {?}
         */
        function (cmp) {
            var _this = this;
            if (cmp && cmp.MethodCode) {
                this.service.getHelpMetaData(cmp.MetadataId, '').subscribe((/**
                 * @param {?} re
                 * @return {?}
                 */
                function (re) {
                    /** @type {?} */
                    var c = JSON.parse(re.content);
                    /** @type {?} */
                    var operation = c.operations.find((/**
                     * @param {?} o
                     * @return {?}
                     */
                    function (o) { return o.code === cmp.MethodCode; }));
                    if (operation) {
                        cmp.ActualParameters = cmp.ActualParameters.map((/**
                         * @param {?} a
                         * @return {?}
                         */
                        function (a) {
                            /** @type {?} */
                            var p = operation.parameters.find((/**
                             * @param {?} i
                             * @return {?}
                             */
                            function (i) { return i.code === a.Name; }));
                            if (p) {
                                return __assign({}, a, { fetchValueMode: p.fetchValueMode, fetchValueSetting: p.fetchValueSetting });
                            }
                            else {
                                throw new Error(_this.localePipe.transform("component.variableSetting.inconsistentParameters"));
                            }
                        }));
                        _this._component = cmp;
                    }
                    else {
                        throw new Error(_this.localePipe.transform("component.variableSetting.methodNotExist"));
                    }
                }));
            }
            else {
                this._component = new ComponentEntity();
            }
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    ComponentEditComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
    };
    /**
     * @return {?}
     */
    ComponentEditComponent.prototype.ngAfterViewInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.ngZone.runOutsideAngular((/**
         * @return {?}
         */
        function () {
            _this.inputGroup.nativeElement.addEventListener('mouseenter', _this.onMouseEnter.bind(_this));
            _this.inputGroup.nativeElement.addEventListener('mouseleave', _this.onMouseLeave.bind(_this));
        }));
    };
    /**
     * @param {?} event
     * @return {?}
     */
    ComponentEditComponent.prototype.onMouseEnter = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        this.showClearButton = true;
        if (this.showClearButton) {
            this.toggleClearIcon(event, true);
        }
    };
    /**
     * @param {?} event
     * @return {?}
     */
    ComponentEditComponent.prototype.onMouseLeave = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        this.showClearButton = false;
        this.toggleClearIcon(event, false);
    };
    /**
     * @private
     * @param {?} event
     * @param {?=} isShow
     * @return {?}
     */
    ComponentEditComponent.prototype.toggleClearIcon = /**
     * @private
     * @param {?} event
     * @param {?=} isShow
     * @return {?}
     */
    function (event, isShow) {
        if (isShow === void 0) { isShow = false; }
        /** @type {?} */
        var str = isShow ? '' : 'none';
        /** @type {?} */
        var clearIcon = event.target.querySelector('.input-group-clear');
        if (clearIcon) {
            clearIcon.style.display = str;
        }
    };
    /**
     * @return {?}
     */
    ComponentEditComponent.prototype.clickOK = /**
     * @return {?}
     */
    function () {
        this.grid.endCellEdit();
        if (this.validator()) {
            this.submitEmitter.emit(this.component);
        }
        else {
            this.message.info(this.localePipe.transform("component.variableSetting.methodnotSelected"));
        }
    };
    /**
     * @return {?}
     */
    ComponentEditComponent.prototype.clickCancel = /**
     * @return {?}
     */
    function () {
        this.closeEmitter.emit();
    };
    /**
     * @private
     * @return {?}
     */
    ComponentEditComponent.prototype.validator = /**
     * @private
     * @return {?}
     */
    function () {
        if (!this.component.MethodCode || !this.component.MetadataId) {
            return false;
        }
        return true;
    };
    /**
     * @return {?}
     */
    ComponentEditComponent.prototype.clear = /**
     * @return {?}
     */
    function () {
        this.component = new ComponentEntity();
    };
    /**
     * @return {?}
     */
    ComponentEditComponent.prototype.selectComponent = /**
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var compFactory = this.resolver.resolveComponentFactory(SelectMetadataRTComponent);
        /** @type {?} */
        var compRef = compFactory.create(this.injector);
        compRef.instance.typeList = 'WebServiceComponent'; // 目前只能根据元数据类型过滤，后续添加标签过滤
        compRef.instance.selectedMetadata.subscribe((/**
         * @param {?} $event
         * @return {?}
         */
        function ($event) {
            try {
                /** @type {?} */
                var meta = $event.metadata;
                _this.openComponentSelectorNew(meta.id, _this.sessionSrc.getUserSessionId());
            }
            catch (_a) {
                console.log('$event', $event);
                throw new Error(_this.localePipe.transform("component.variableSetting.errorObtainComponent") + $event);
            }
        }));
        /** @type {?} */
        var modalConfig = {
            title: this.localePipe.transform("component.variableSetting.componentSelection"),
            width: 980,
            height: 548,
            showButtons: false
        };
        /** @type {?} */
        var dialog = this.modalService.show(compRef, modalConfig);
        compRef.instance.closeModalEmitter.subscribe((/**
         * @param {?} $event
         * @return {?}
         */
        function ($event) { return dialog.close(); }));
    };
    /**
     * @private
     * @param {?} metadataId
     * @param {?} sessionId
     * @return {?}
     */
    ComponentEditComponent.prototype.openComponentSelectorNew = /**
     * @private
     * @param {?} metadataId
     * @param {?} sessionId
     * @return {?}
     */
    function (metadataId, sessionId) {
        var _this = this;
        this.componentService.openSelector(metadataId, sessionId).subscribe((/**
         * @param {?} selectorResult
         * @return {?}
         */
        function (selectorResult) {
            selectorResult.confirmEvent.subscribe((/**
             * @param {?} result
             * @return {?}
             */
            function (result) {
                if (result) {
                    _this.component.Name = result.name;
                    _this.component.MetadataId = result.id;
                    _this.component.MethodCode = result.operations[0].code;
                    // this.component.methodName = result.operations[0].name;
                    _this.component.ActualParameters = [];
                    if (result.operations[0].parameters && result.operations[0].parameters.length > 0) {
                        _this.component.ActualParameters = result.operations[0].parameters
                            .map((/**
                         * @param {?} p
                         * @return {?}
                         */
                        function (p) { return ({
                            Name: p.code, Value: '', Tag: p.fetchValueMode.indexOf('express,none') > -1 ? 'expression' : 'constant',
                            fetchValueMode: p.fetchValueMode,
                            fetchValueSetting: p.fetchValueSetting
                        }); }));
                    }
                }
            }));
        }));
    };
    /**
     * @param {?} e
     * @return {?}
     */
    ComponentEditComponent.prototype.showExprHelp = /**
     * @param {?} e
     * @return {?}
     */
    function (e) {
        var _this = this;
        var e_1, _a, e_2, _b, e_3, _c;
        // this.expr.clearContext();
        if (this.designerState.schemas.length > 0) {
            try {
                for (var _d = __values(this.designerState.schemas), _e = _d.next(); !_e.done; _e = _d.next()) {
                    var schema = _e.value;
                    this.expr.addSchema('Schema', schema);
                }
            }
            catch (e_1_1) { e_1 = { error: e_1_1 }; }
            finally {
                try {
                    if (_e && !_e.done && (_a = _d.return)) _a.call(_d);
                }
                finally { if (e_1) throw e_1.error; }
            }
            if (this.designerState.schemas[0].entityTypes && this.designerState.schemas[0].entityTypes.length > 0) {
                /** @type {?} */
                var entityType = this.designerState.schemas[0].entityTypes[0];
                this.expr.addInjectedEntity(entityType.name, 'Schema', entityType.name, InjectedType.EntityType);
            }
        }
        /** @type {?} */
        var context = new Array();
        context = this.designerState.addContext(context);
        if (this.designerState.subActivityContext.length > 0) {
            var _loop_1 = function (variable) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    context.push(variable);
                }
            };
            try {
                for (var _f = __values(this.designerState.subActivityContext), _g = _f.next(); !_g.done; _g = _f.next()) {
                    var variable = _g.value;
                    _loop_1(variable);
                }
            }
            catch (e_2_1) { e_2 = { error: e_2_1 }; }
            finally {
                try {
                    if (_g && !_g.done && (_b = _f.return)) _b.call(_f);
                }
                finally { if (e_2) throw e_2.error; }
            }
        }
        if (context.length > 0) {
            try {
                for (var context_1 = __values(context), context_1_1 = context_1.next(); !context_1_1.done; context_1_1 = context_1.next()) {
                    var v = context_1_1.value;
                    this.expr.addContext(v);
                }
            }
            catch (e_3_1) { e_3 = { error: e_3_1 }; }
            finally {
                try {
                    if (context_1_1 && !context_1_1.done && (_c = context_1.return)) _c.call(context_1);
                }
                finally { if (e_3) throw e_3.error; }
            }
        }
        this.expr.addExpressionText(e.instance.value);
        this.expr.buildExpression().then((/**
         * @param {?} d
         * @return {?}
         */
        function (d) {
            e.formControl.setValue(d);
            e.instance.cd.detectChanges();
            //点击确定后，去除表达式里面的新增的上下文变量
            if (context.length > 0) {
                _this.expr.exprEntity.contextEntities = _this.expr.exprEntity.contextEntities.filter((/**
                 * @param {?} x
                 * @return {?}
                 */
                function (x) { return !context.some((/**
                 * @param {?} y
                 * @return {?}
                 */
                function (y) { return y.key === x.key; })); }));
            }
        }));
    };
    /**
     * @private
     * @return {?}
     */
    ComponentEditComponent.prototype.getHelpInfo = /**
     * @private
     * @return {?}
     */
    function () {
        return this.service.getHelpMetaData(this.helpId, this.su);
    };
    ComponentEditComponent.decorators = [
        { type: Component, args: [{
                    selector: 'lib-component-edit',
                    template: "<div class=\"f-utils-fill-flex-column farris-overflow-y-auto h-100 m-2\" style=\"background:#FFF;\">\r\n  <form class=\"farris-form farris-card-content-bg farris-card-section mx-2\">\r\n    <div class=\"d-flex flex-wrap flex-column mb-2 pr-4\">\r\n      <div class=\"farris-form-controls-inline farris-form-auto mb-2\">\r\n        <div class=\"farris-group-wrap mx-3\">\r\n          <div class=\"form-group\">\r\n            <label class=\"col-form-label\">\r\n              <span class=\"farris-label-info text-danger\">*</span>\r\n              <span class=\"farris-label-text\">{{ 'component.variableSetting.parameterName' | wfLocale }}</span>\r\n            </label>\r\n            <div class=\"farris-input-wrap ml-2\">\r\n              <input type=\"text\" class=\"k-textbox form-control\" name=\"name\" [(ngModel)]=\"component.Name\" />\r\n              <div class=\"farris-feedback valid-feedback\"></div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div class=\"farris-form-controls-inline farris-form-auto\">\r\n        <div class=\"farris-group-wrap mx-3\">\r\n          <div class=\"form-group\">\r\n            <label class=\"col-form-label\">\r\n              <span class=\"farris-label-info text-danger\">*</span>\r\n              <span class=\"farris-label-text\">{{ 'component.variableSetting.componentSelection' | wfLocale }}</span>\r\n            </label>\r\n            <div class=\"farris-input-wrap ml-2\">\r\n              <div #inputGroup class=\"input-group\">\r\n                <input type=\"text\" class=\"form-control\" [(ngModel)]=\"component.MethodCode\" name=\"methodCode\"\r\n                  [readOnly]=\"true\" />\r\n                <div class=\"input-group-append\">\r\n                  <span [style.display]=\"showClearButton ? '' : 'none'\" class=\"input-group-text input-group-clear\"\r\n                    (click)=\"clear()\">\r\n                    <i class=\"f-icon modal_close\"></i>\r\n                  </span>\r\n                  <span class=\"input-group-text\" (click)=\"selectComponent()\" style=\"background: #FFF;\">\r\n                    <i class=\"f-icon f-icon-lookup\"></i>\r\n                  </span>\r\n                </div>\r\n              </div>\r\n              <div class=\"farris-feedback valid-feedback\"></div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </form>\r\n  <farris-tabs class=\"f-utils-fill\" #params [value]=\"'params'\" [contentFill]=\"true\">\r\n    <farris-tab title=\"{{'component.variableSetting.parameterList' | wfLocale}}\" [id]=\"'params'\">\r\n      <ng-template #content>\r\n        <div class=\"f-utils-fill-flex-column h-100\">\r\n          <farris-datagrid #grid [data]=\"component.ActualParameters\" [columns]=\"columns\" [idField]=\"'Name'\" [fit]=\"true\"\r\n            [fitColumns]=\"true\" [editable]=\"true\" [editMode]=\"'cell'\" [pagination]=\"false\" [showCheckbox]=\"false\" [striped]=\"true\"\r\n            [multiSelect]=\"false\" [afterEdit]=\"afterEdit\" [beforeEdit]=\"beforeEdit\"></farris-datagrid>\r\n        </div>\r\n      </ng-template>\r\n    </farris-tab>\r\n  </farris-tabs>\r\n</div>\r\n\r\n<farris-lookup-grid style=\"display: none;\" #lookup [(ngModel)]=\"value\" [editable]=\"false\" [columns]=\"helpCols\"\r\n  [singleSelect]=\"true\" title=\"title\" [displayType]=\"displayType\" [uri]=\"dataUri\"\r\n  [idField]=\"helpFields.idField\" [pagination]=\"true\" [valueField]=\"helpFields.valueField\"\r\n  [textField]=\"helpFields.textField\" [dictPicking]=\"dictPicking\" [dictPicked]=\"dictPicked\">\r\n</farris-lookup-grid>\r\n\r\n<ng-template #footer>\r\n  <button type=\"button\" class=\"btn btn-secondary btn-sm\" (click)=\"clickCancel()\">{{'component.variableSetting.clickCancel' | wfLocale}}</button>\r\n  <button type=\"button\" class=\"btn btn-primary btn-sm mx-2\" (click)=\"clickOK()\">{{'component.variableSetting.clickOK' | wfLocale}}</button>\r\n</ng-template>\r\n",
                    providers: [
                        ComponentEditService,
                        { provide: ServerSideToken, useClass: ComponentEditLookUpService },
                        WfLocalePipe,
                    ],
                    styles: [""]
                }] }
    ];
    /** @nocollapse */
    ComponentEditComponent.ctorParameters = function () { return [
        { type: FormBuilder },
        { type: ProcessDesignerUIState },
        { type: ExpressionService },
        { type: ComponentFactoryResolver },
        { type: Injector },
        { type: SessionService },
        { type: BsModalService },
        { type: CommonComponentUiRTService },
        { type: NgZone },
        { type: ComponentEditService },
        { type: ProcessDeUtil },
        { type: MessagerService },
        { type: ChangeDetectorRef, decorators: [{ type: Optional }] },
        { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
        { type: undefined, decorators: [{ type: Inject, args: [WF_LANG_RESOURCES,] }] },
        { type: WfLocalePipe, decorators: [{ type: Optional }] }
    ]; };
    ComponentEditComponent.propDecorators = {
        cls: [{ type: HostBinding, args: ['class',] }],
        grid: [{ type: ViewChild, args: [DatagridComponent,] }],
        lookup: [{ type: ViewChild, args: [LookupGridComponent,] }],
        footer: [{ type: ViewChild, args: ['footer',] }],
        closeEmitter: [{ type: Output }],
        submitEmitter: [{ type: Output }],
        inputGroup: [{ type: ViewChild, args: ['inputGroup',] }],
        component: [{ type: Input }]
    };
    return ComponentEditComponent;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var ProcessVariablesComponent = /** @class */ (function () {
    function ProcessVariablesComponent(message, resolver, injector, modalService, uistate, expr, cdr, localeId, resources, localePipe) {
        var _this = this;
        this.message = message;
        this.resolver = resolver;
        this.injector = injector;
        this.modalService = modalService;
        this.uistate = uistate;
        this.expr = expr;
        this.cdr = cdr;
        this.localeId = localeId;
        this.resources = resources;
        this.localePipe = localePipe;
        this.cls = 'farris-main-area flex-column';
        this.variableSetting = false;
        this.closeModal = new EventEmitter();
        this.submitModal = new EventEmitter();
        this.variableSetEmitter = new EventEmitter();
        this.value = new Array();
        this.selectedValue = new Array();
        this.editorParams = {};
        this.basicTypes = [
            { value: 'String', text: this.localePipe.transform('component.processVariables.string') },
            { value: 'Integer', text: this.localePipe.transform('component.processVariables.integer') },
            { value: 'Decimal', text: this.localePipe.transform('component.processVariables.decimal') },
            { value: 'Boolean', text: this.localePipe.transform('component.processVariables.boolean') },
        ];
        this.tags = [
            { value: 'constant', text: this.localePipe.transform('component.processVariables.constant') },
            { value: 'expression', text: this.localePipe.transform('component.processVariables.expression') },
            { value: 'component', text: this.localePipe.transform('component.processVariables.component') }
        ];
        this.columns = [
            {
                field: 'name', width: 80, title: this.localePipe.transform('component.processVariables.name'), sortable: true,
                editor: { type: EditorTypes.TEXTBOX, options: {} },
                validators: [
                    { type: 'required', messager: '必填' }
                ]
            },
            {
                field: 'documentation', width: 80, title: this.localePipe.transform('component.processVariables.documentation'), sortable: true,
                editor: { type: EditorTypes.TEXTBOX, options: {} },
                validators: [
                    { type: 'required', messager: '必填' }
                ]
            },
            {
                field: 'basicType', width: 60, title: this.localePipe.transform('component.processVariables.basicType'), sortable: true,
                formatter: {
                    type: 'enum',
                    options: { valueField: 'value', textField: 'text', data: this.basicTypes }
                },
                editor: {
                    type: EditorTypes.COMBOLIST,
                    options: { valueField: 'value', textField: 'text', data: this.basicTypes, idField: 'value', panelHeight: 'auto', showClear: false }
                },
                validators: [
                    { type: 'required', messager: '必填' }
                ]
            }, {
                field: 'description', width: 100, title: this.localePipe.transform('component.processVariables.description'), showTips: true,
                editor: { type: EditorTypes.TEXTBOX, options: {} },
            }, {
                field: 'tag', width: 60, title: this.localePipe.transform('component.processVariables.tag'), sortable: true,
                formatter: {
                    type: 'enum',
                    options: { valueField: 'value', textField: 'text', data: this.tags }
                },
                editor: {
                    type: EditorTypes.COMBOLIST,
                    options: {
                        valueField: 'value', textField: 'text', data: this.tags, idField: 'value', panelHeight: 'auto',
                        selectChange: (/**
                         * @param {?} e
                         * @return {?}
                         */
                        function (e) {
                            _this.value = _this.value.map((/**
                             * @param {?} v
                             * @return {?}
                             */
                            function (v) {
                                if (v.id === e.rowId) {
                                    v.value = null;
                                    v.valueText = null;
                                    if (v.component) {
                                        v.component = null;
                                    }
                                    return v;
                                }
                                else {
                                    return v;
                                }
                            }));
                        }),
                        clear: (/**
                         * @param {?} e
                         * @return {?}
                         */
                        function (e) {
                            _this.value = _this.value.map((/**
                             * @param {?} v
                             * @return {?}
                             */
                            function (v) {
                                if (v.id === e.rowId) {
                                    v.value = null;
                                    v.valueText = null;
                                    if (v.component) {
                                        v.component = null;
                                    }
                                    return v;
                                }
                                else {
                                    return v;
                                }
                            }));
                        })
                    }
                }
            }, {
                field: 'valueText', width: 120, title: this.localePipe.transform('component.processVariables.valueText'), showTips: true,
                editor: { type: EditorTypes.TEXTBOX, options: {} }
            }
        ];
        this.modalConfig = {
            title: this.localePipe.transform('component.processVariables.processVariables'),
            width: 1070,
            height: 510,
            showButtons: true
        };
        this.beforeEdit = (/**
         * @param {?} param
         * @return {?}
         */
        function (param) {
            /** @type {?} */
            var rowData = (/** @type {?} */ (param.rowData));
            /** @type {?} */
            var column = param.column;
            if (column.field === 'valueText') {
                if (!((/** @type {?} */ (rowData))).tag) {
                    return of$1(false);
                }
                if (((/** @type {?} */ (rowData))).tag === _this.tags[0].value) {
                    param.column.editor = { type: EditorTypes.TEXTBOX, options: {} };
                }
                else {
                    param.column.editor = {
                        type: 'input-group',
                        options: {
                            groupText: '<i class="f-icon f-icon-lookup"></i>',
                            editable: false,
                            showClear: false,
                            clickHandle: (/**
                             * @param {?} e
                             * @return {?}
                             */
                            function (e) {
                                e.formControl.setValue(e.instance.value ? e.instance.value : '');
                                _this.valueEdit(e);
                            }),
                            clear: (/**
                             * @param {?} e
                             * @return {?}
                             */
                            function (e) {
                                console.log('clear', e);
                            })
                        }
                    };
                }
            }
            return of$1(true);
        });
        this.localePipe = this.localePipe || new WfLocalePipe(localeId, resources);
    }
    /**
     * @return {?}
     */
    ProcessVariablesComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        if (this.variableSetting) {
            this.columns = this.columns.filter((/**
             * @param {?} c
             * @return {?}
             */
            function (c) { return c.field !== 'tag'
                && c.field !== 'valueText' && c.field !== 'description'; }));
        }
    };
    /**
     * @return {?}
     */
    ProcessVariablesComponent.prototype.add = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var variable = new ProcessVariable();
        this.value = this.value.concat([variable]);
    };
    /**
     * @return {?}
     */
    ProcessVariablesComponent.prototype.delete = /**
     * @return {?}
     */
    function () {
        this.grid.endCellEdit();
        /** @type {?} */
        var selected = this.grid.selectedRow;
        if (!selected) {
            this.message.info(this.localePipe.transform('component.processVariables.notSelected'));
            return;
        }
        this.value = this.value.filter((/**
         * @param {?} v
         * @return {?}
         */
        function (v) { return v.id !== selected.data.id; }));
    };
    /**
     * @return {?}
     */
    ProcessVariablesComponent.prototype.clickOK = /**
     * @return {?}
     */
    function () {
        if (this.variableSetting) {
            /** @type {?} */
            var selecteds = this.grid.checkeds;
            if (selecteds.length > 0) {
                if (this.varValidator()) {
                    this.variableSetEmitter.emit(selecteds);
                }
            }
            else {
                this.message.info(this.localePipe.transform('component.processVariables.notSelected'));
            }
        }
        else {
            this.grid.endCellEdit();
            if (this.validator()) {
                /** @type {?} */
                var object = { value: this.value, parameters: null };
                this.submitModal.emit(object);
            }
        }
    };
    /**
     * @return {?}
     */
    ProcessVariablesComponent.prototype.clickCancel = /**
     * @return {?}
     */
    function () {
        this.closeModal.emit();
    };
    /**
     * @param {?} data
     * @return {?}
     */
    ProcessVariablesComponent.prototype.endEdit = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        if (data.column.field === 'valueText' && data.rowData.tag === this.tags[0].value) {
            data.rowData.value = data.rowData.valueText;
        }
    };
    /**
     * @param {?} e
     * @return {?}
     */
    ProcessVariablesComponent.prototype.valueEdit = /**
     * @param {?} e
     * @return {?}
     */
    function (e) {
        /** @type {?} */
        var rowdata = e.rowData;
        switch (rowdata.tag) {
            case this.tags[0].value:
                this.editConstant(e);
                break;
            case this.tags[1].value:
                this.editExpression(e);
                break;
            case this.tags[2].value:
                this.editComponent(e);
                break;
        }
    };
    /**
     * @private
     * @param {?} e
     * @return {?}
     */
    ProcessVariablesComponent.prototype.editConstant = /**
     * @private
     * @param {?} e
     * @return {?}
     */
    function (e) {
        /** @type {?} */
        var data = e.rowData;
        /** @type {?} */
        var dialog;
        /** @type {?} */
        var compFactory = this.resolver.resolveComponentFactory(ConstantEditComponent);
        /** @type {?} */
        var compRef = compFactory.create(this.injector);
        compRef.instance.value = data.value;
        compRef.instance.submitEmitter.subscribe((/**
         * @param {?} re
         * @return {?}
         */
        function (re) {
            e.formControl.setValue(re);
            e.instance.cd.detectChanges();
            data.value = re;
            dialog.close();
        }));
        compRef.instance.closeEmitter.subscribe((/**
         * @param {?} re
         * @return {?}
         */
        function (re) {
            dialog.close();
        }));
        /** @type {?} */
        var modalConfig = {
            title: this.localePipe.transform('component.processVariables.constant'),
            width: 340,
            height: 280,
            showButtons: true,
            buttons: compRef.instance.footer
        };
        dialog = this.modalService.show(compRef, modalConfig);
    };
    /**
     * @private
     * @param {?} e
     * @return {?}
     */
    ProcessVariablesComponent.prototype.editExpression = /**
     * @private
     * @param {?} e
     * @return {?}
     */
    function (e) {
        var _this = this;
        var e_1, _a, e_2, _b, e_3, _c;
        // this.expr.clearContext();
        /** @type {?} */
        var data = e.rowData;
        if (this.uistate.schemas.length > 0) {
            try {
                for (var _d = __values(this.uistate.schemas), _e = _d.next(); !_e.done; _e = _d.next()) {
                    var schema = _e.value;
                    this.expr.addSchema('Schema', schema);
                }
            }
            catch (e_1_1) { e_1 = { error: e_1_1 }; }
            finally {
                try {
                    if (_e && !_e.done && (_a = _d.return)) _a.call(_d);
                }
                finally { if (e_1) throw e_1.error; }
            }
            if (this.uistate.schemas[0].entityTypes && this.uistate.schemas[0].entityTypes.length > 0) {
                /** @type {?} */
                var entityType = this.uistate.schemas[0].entityTypes[0];
                this.expr.addInjectedEntity(entityType.name, 'Schema', entityType.name, InjectedType.EntityType);
            }
        }
        /** @type {?} */
        var context = new Array();
        context = this.uistate.addContext(context);
        if (this.uistate.subActivityContext.length > 0) {
            var _loop_1 = function (variable) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    context.push(variable);
                }
            };
            try {
                for (var _f = __values(this.uistate.subActivityContext), _g = _f.next(); !_g.done; _g = _f.next()) {
                    var variable = _g.value;
                    _loop_1(variable);
                }
            }
            catch (e_2_1) { e_2 = { error: e_2_1 }; }
            finally {
                try {
                    if (_g && !_g.done && (_b = _f.return)) _b.call(_f);
                }
                finally { if (e_2) throw e_2.error; }
            }
        }
        if (context.length > 0) {
            try {
                for (var context_1 = __values(context), context_1_1 = context_1.next(); !context_1_1.done; context_1_1 = context_1.next()) {
                    var v = context_1_1.value;
                    this.expr.addContext(v);
                }
            }
            catch (e_3_1) { e_3 = { error: e_3_1 }; }
            finally {
                try {
                    if (context_1_1 && !context_1_1.done && (_c = context_1.return)) _c.call(context_1);
                }
                finally { if (e_3) throw e_3.error; }
            }
        }
        this.expr.setEditPattern(ExprEditMode.Advanced); // 表达式展现模式：默认高级版
        this.expr.addExpressionText(data.value);
        this.expr.buildExpression().then((/**
         * @param {?} re
         * @return {?}
         */
        function (re) {
            e.formControl.setValue(re);
            e.instance.cd.detectChanges();
            data.value = re;
            e.form.bindingData.value = re;
            e.form.value.value = re;
            //点击确定后，去除表达式里面的新增的上下文变量
            if (context.length > 0) {
                _this.expr.exprEntity.contextEntities = _this.expr.exprEntity.contextEntities.filter((/**
                 * @param {?} x
                 * @return {?}
                 */
                function (x) { return !context.some((/**
                 * @param {?} y
                 * @return {?}
                 */
                function (y) { return y.key === x.key; })); }));
            }
        }));
    };
    /**
     * @private
     * @param {?} e
     * @return {?}
     */
    ProcessVariablesComponent.prototype.editComponent = /**
     * @private
     * @param {?} e
     * @return {?}
     */
    function (e) {
        /** @type {?} */
        var data = e.rowData;
        /** @type {?} */
        var dialog;
        /** @type {?} */
        var compFactory = this.resolver.resolveComponentFactory(ComponentEditComponent);
        /** @type {?} */
        var compRef = compFactory.create(this.injector);
        compRef.instance.component = data.component;
        compRef.instance.submitEmitter.subscribe((/**
         * @param {?} re
         * @return {?}
         */
        function (re) {
            e.formControl.setValue(re.Name + '-' + re.MethodCode);
            e.instance.cd.detectChanges();
            data.value = re.Id;
            data.component = re;
            e.form.bindingData.value = re.Id;
            e.form.value.value = re.Id;
            e.form.value.component = re;
            e.form.bindingData.component = re;
            dialog.close();
        }));
        compRef.instance.closeEmitter.subscribe((/**
         * @param {?} re
         * @return {?}
         */
        function (re) {
            dialog.close();
        }));
        /** @type {?} */
        var modalConfig = {
            title: this.localePipe.transform('component.processVariables.component'),
            width: 800,
            height: 515,
            showButtons: true,
            buttons: compRef.instance.footer
        };
        dialog = this.modalService.show(compRef, modalConfig);
    };
    /**
     * @private
     * @return {?}
     */
    ProcessVariablesComponent.prototype.validator = /**
     * @private
     * @return {?}
     */
    function () {
        var e_4, _a;
        try {
            for (var _b = __values(this.value), _c = _b.next(); !_c.done; _c = _b.next()) {
                var item = _c.value;
                if (!item.name) {
                    this.message.warning(this.localePipe.transform('component.processVariables.variableNumberEmpty'));
                    return false;
                }
                if (!item.documentation) {
                    this.message.warning(this.localePipe.transform('component.processVariables.variableNameEmpty'));
                    return false;
                }
                if (!this.IsMatchVariableNameRules(item.name)) {
                    this.message.warning(this.localePipe.transform('component.processVariables.variableNumberNotStandard'));
                    return false;
                }
                if (item.value && !item.tag) {
                    this.message.warning(this.localePipe.transform('component.processVariables.tagNotEmpty'));
                    return false;
                }
            }
        }
        catch (e_4_1) { e_4 = { error: e_4_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_4) throw e_4.error; }
        }
        if (this.value.length > 1) {
            for (var i = 0; i < this.value.length; i++) {
                /** @type {?} */
                var code1 = this.value[i].name;
                for (var j = i + 1; j < this.value.length; j++) {
                    /** @type {?} */
                    var code2 = this.value[j].name;
                    if (code1 === code2) {
                        this.message.warning(this.localePipe.transform('component.processVariables.codeDuplicates'));
                        return false;
                    }
                }
            }
        }
        return true;
    };
    /**
     * @private
     * @param {?} str
     * @return {?}
     */
    ProcessVariablesComponent.prototype.IsMatchVariableNameRules = /**
     * @private
     * @param {?} str
     * @return {?}
     */
    function (str) {
        /** @type {?} */
        var Regx = /^[a-zA-Z_][a-zA-Z_0-9]{0,}/;
        if (Regx.test(str)) {
            return true;
        }
        else {
            return false;
        }
    };
    // 变量赋值专用校验
    // 变量赋值专用校验
    /**
     * @private
     * @return {?}
     */
    ProcessVariablesComponent.prototype.varValidator = 
    // 变量赋值专用校验
    /**
     * @private
     * @return {?}
     */
    function () {
        var e_5, _a;
        var _loop_2 = function (item) {
            if (this_1.selectedValue.length && this_1.selectedValue.length > 0) {
                if (this_1.selectedValue.filter((/**
                 * @param {?} v
                 * @return {?}
                 */
                function (v) { return v.variableCode === item.data.name; })).length > 0) {
                    this_1.message.warning(this_1.localePipe.transform('component.processVariables.alreadyExists'));
                    return { value: false };
                }
            }
        };
        var this_1 = this;
        try {
            for (var _b = __values(this.grid.checkeds), _c = _b.next(); !_c.done; _c = _b.next()) {
                var item = _c.value;
                var state_1 = _loop_2(item);
                if (typeof state_1 === "object")
                    return state_1.value;
            }
        }
        catch (e_5_1) { e_5 = { error: e_5_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_5) throw e_5.error; }
        }
        return true;
    };
    ProcessVariablesComponent.decorators = [
        { type: Component, args: [{
                    selector: 'lib-process-variables',
                    template: "<div class=\"f-page\">\r\n  <div *ngIf=\"!variableSetting\" class=\"f-page-header\">\r\n    <nav class=\"f-page-header-base\">\r\n      <div class=\"f-title\">\r\n      </div>\r\n      <div class=\"btn-toolbar btn-group-lg\">\r\n        <button class=\"btn btn-secondary mr-2\" (click)=\"delete()\">{{'component.processVariables.delete' | wfLocale}}</button>\r\n        <button class=\"btn btn-primary\" (click)=\"add()\">{{'component.processVariables.add' | wfLocale}}</button>\r\n      </div>\r\n    </nav>\r\n  </div>\r\n  <div class=\"f-page-main f-utils-fill-flex-column h-100\">\r\n    <div class=\"f-utils-fill-flex-column farris-overflow-y-auto h-100\">\r\n      <farris-datagrid #grid [data]=\"value\" [columns]=\"columns\" [idField]=\"'id'\" [fit]=\"true\" [fitColumns]=\"true\"\r\n        [editable]=\"!variableSetting\" [editMode]=\"'cell'\" [pagination]=\"false\" (endEdit)=\"endEdit($event)\" [beforeEdit]=\"beforeEdit\"\r\n        [showCheckbox]=\"variableSetting\" [multiSelect]=\"variableSetting\" [checkOnSelect]=\"true\" [selectOnCheck]=\"true\" [showAllCheckbox]=\"variableSetting\"\r\n        [showLineNumber]=\"true\" lineNumberTitle=\"{{'component.processVariables.number' | wfLocale}}\" [lineNumberWidth]=\"50\" [striped]=\"true\">\r\n      </farris-datagrid>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type=\"button\" class=\"btn btn-secondary btn-sm px-3 mx-2\" (click)=\"clickCancel()\">{{'component.processVariables.clickCancel' | wfLocale}}</button>\r\n  <button type=\"button\" class=\"btn btn-primary btn-sm px-3 mx-2\" (click)=\"clickOK()\">{{'component.processVariables.clickOK' | wfLocale}}</button>\r\n</ng-template>\r\n",
                    providers: [
                        WfLocalePipe,
                    ],
                    styles: [""]
                }] }
    ];
    /** @nocollapse */
    ProcessVariablesComponent.ctorParameters = function () { return [
        { type: MessagerService },
        { type: ComponentFactoryResolver },
        { type: Injector },
        { type: BsModalService },
        { type: ProcessDesignerUIState },
        { type: ExpressionService },
        { type: ChangeDetectorRef, decorators: [{ type: Optional }] },
        { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
        { type: undefined, decorators: [{ type: Inject, args: [WF_LANG_RESOURCES,] }] },
        { type: WfLocalePipe, decorators: [{ type: Optional }] }
    ]; };
    ProcessVariablesComponent.propDecorators = {
        cls: [{ type: HostBinding, args: ['class',] }],
        variableSetting: [{ type: Input }],
        closeModal: [{ type: Output }],
        submitModal: [{ type: Output }],
        variableSetEmitter: [{ type: Output }],
        value: [{ type: Input }],
        selectedValue: [{ type: Input }],
        editorParams: [{ type: Input }],
        modalFooter: [{ type: ViewChild, args: ['iconSelectFooter',] }],
        grid: [{ type: ViewChild, args: ['grid',] }]
    };
    return ProcessVariablesComponent;
}());
var ProcessVariablesConverter = /** @class */ (function () {
    function ProcessVariablesConverter(localePipe) {
        this.localePipe = localePipe;
    }
    /**
     * @param {?} data
     * @return {?}
     */
    ProcessVariablesConverter.prototype.convertTo = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        if (data && data.length > 0) {
            return this.localePipe.transform("component.processVariables.set");
        }
        else {
            return this.localePipe.transform("component.processVariables.notSet");
        }
    };
    return ProcessVariablesConverter;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var TimeLimitInfo = /** @class */ (function () {
    function TimeLimitInfo() {
        this.tag = 'constant';
        this.enable = false;
        this.timeUnit = 'day';
        this.expireOperations = new Array();
    }
    return TimeLimitInfo;
}());
var ExpireOperation = /** @class */ (function () {
    function ExpireOperation() {
        this.id = ProcessDeUtil.GenerateElementId();
        this.durationType = 'BeforeDuration';
        this.timeDuration = 0;
        this.timeUnit = 'day';
        // 默认操作类型是发送预警消息
        this.operationTypeName = 'SendMessageExpireOperation';
    }
    return ExpireOperation;
}());
/**
 * 发送预警信息方式
 */
var /**
 * 发送预警信息方式
 */
SendMessage = /** @class */ (function (_super) {
    __extends(SendMessage, _super);
    function SendMessage(location, localePipe) {
        var _this = _super.call(this) || this;
        _this.localePipe = localePipe;
        _this.cycleEnable = false;
        _this.cycleTimeUnit = 'day';
        _this.receiver = location === 'activity' ? 'workItemParticipant' : 'procInstCreator';
        _this.receiverText = location === 'activity' ? _this.localePipe.transform('component.timeLimitControl.workItemParticipant') : _this.localePipe.transform('component.timeLimitControl.procInstCreator');
        _this.subject = "{\"expr\":\"'" + _this.localePipe.transform('component.timeLimitControl.SendMessageExpireOperation') + "'\",\"sexpr\":\"\"}";
        _this.message = "{\"expr\":\"'" + (location === 'activity' ? _this.localePipe.transform('component.timeLimitControl.to-doMessageTimeOut') : _this.localePipe.transform('component.timeLimitControl.messageTimeOut')) + "'\",\"sexpr\":\"\"}";
        return _this;
    }
    return SendMessage;
}(ExpireOperation));
var AutoHandle = /** @class */ (function (_super) {
    __extends(AutoHandle, _super);
    function AutoHandle(type, localePipe) {
        var _this = _super.call(this) || this;
        _this.localePipe = localePipe;
        _this.autoHandleType = type;
        _this.message = _this.localePipe.transform('component.timeLimitControl.agree');
        return _this;
    }
    return AutoHandle;
}(ExpireOperation));

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var SmsMessageTemplate$1 = /** @class */ (function () {
    function SmsMessageTemplate$$1() {
        this.smsMessageVariables = new Array();
    }
    return SmsMessageTemplate$$1;
}());
var SmsMessageVariable$1 = /** @class */ (function () {
    function SmsMessageVariable$$1() {
        this.tag = 'expression';
        this.id = ProcessDeUtil.createNM();
    }
    return SmsMessageVariable$$1;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var SmsMessageTemplateComponent = /** @class */ (function () {
    function SmsMessageTemplateComponent(designerState, expr, message, cdr, localeId, resources, localePipe) {
        this.designerState = designerState;
        this.expr = expr;
        this.message = message;
        this.cdr = cdr;
        this.localeId = localeId;
        this.resources = resources;
        this.localePipe = localePipe;
        this.smsVariableList = new Array();
        this.smsVariableCols = new Array();
        this.smsTemplateContent = this.localePipe.transform('component.smsMessageTemplate.smsTemplateContent');
        this.localePipe = this.localePipe || new WfLocalePipe(localeId, resources);
        this.smsMessageTemplate = new SmsMessageTemplate$1();
    }
    /**
     * @return {?}
     */
    SmsMessageTemplateComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.smsVariableCols = [{
                field: 'code', width: 80, title: this.localePipe.transform('component.smsMessageTemplate.code'), editor: { type: EditorTypes.TEXTBOX, options: {} }
            }, {
                field: 'value', width: 100, title: this.localePipe.transform('component.smsMessageTemplate.value'), showTips: true, editor: {
                    type: 'input-group',
                    options: {
                        groupText: '<i class="f-icon f-icon-lookup"></i>',
                        editable: false,
                        clickHandle: (/**
                         * @param {?} e
                         * @return {?}
                         */
                        function (e) {
                            e.formControl.setValue(e.instance.value ? e.instance.value : '');
                            _this.showExprHelp(e);
                        }),
                        clear: (/**
                         * @param {?} e
                         * @return {?}
                         */
                        function (e) {
                            console.log('clear', e);
                        })
                    }
                }
            }];
        console.log(this.smsMessageTemplate);
    };
    /**
     * @return {?}
     */
    SmsMessageTemplateComponent.prototype.addSmsVariable = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var variable = new SmsMessageVariable$1();
        this.smsMessageTemplate.smsMessageVariables.push(variable);
        this.grid.loadData(this.smsMessageTemplate.smsMessageVariables);
    };
    /**
     * @return {?}
     */
    SmsMessageTemplateComponent.prototype.deleteSmsVariable = /**
     * @return {?}
     */
    function () {
        this.endGridEdit();
        /** @type {?} */
        var selectedVariable = this.grid.selectedRow;
        if (!selectedVariable) {
            this.message.info(this.localePipe.transform('component.smsMessageTemplate.noRowsSelected'));
            return;
        }
        /** @type {?} */
        var index = this.smsMessageTemplate.smsMessageVariables.findIndex((/**
         * @param {?} variable
         * @return {?}
         */
        function (variable) { return variable.id === selectedVariable.id; }));
        if (index > -1) {
            this.smsMessageTemplate.smsMessageVariables.splice(index, 1);
            this.grid.loadData(this.smsMessageTemplate.smsMessageVariables);
        }
    };
    /**
     * @return {?}
     */
    SmsMessageTemplateComponent.prototype.endGridEdit = /**
     * @return {?}
     */
    function () {
        this.grid.endCellEdit();
    };
    /**
     * @private
     * @param {?} e
     * @return {?}
     */
    SmsMessageTemplateComponent.prototype.showExprHelp = /**
     * @private
     * @param {?} e
     * @return {?}
     */
    function (e) {
        var _this = this;
        var e_1, _a, e_2, _b, e_3, _c;
        // this.expr.clearContext();
        if (this.designerState.schemas.length > 0) {
            try {
                for (var _d = __values(this.designerState.schemas), _e = _d.next(); !_e.done; _e = _d.next()) {
                    var schema = _e.value;
                    this.expr.addSchema('Schema', schema);
                }
            }
            catch (e_1_1) { e_1 = { error: e_1_1 }; }
            finally {
                try {
                    if (_e && !_e.done && (_a = _d.return)) _a.call(_d);
                }
                finally { if (e_1) throw e_1.error; }
            }
            if (this.designerState.schemas[0].entityTypes && this.designerState.schemas[0].entityTypes.length > 0) {
                /** @type {?} */
                var entityType = this.designerState.schemas[0].entityTypes[0];
                this.expr.addInjectedEntity(entityType.name, 'Schema', entityType.name, InjectedType.EntityType);
            }
        }
        /** @type {?} */
        var context = new Array();
        context = this.designerState.addContext(context);
        if (this.designerState.subActivityContext.length > 0) {
            var _loop_1 = function (variable) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    context.push(variable);
                }
            };
            try {
                for (var _f = __values(this.designerState.subActivityContext), _g = _f.next(); !_g.done; _g = _f.next()) {
                    var variable = _g.value;
                    _loop_1(variable);
                }
            }
            catch (e_2_1) { e_2 = { error: e_2_1 }; }
            finally {
                try {
                    if (_g && !_g.done && (_b = _f.return)) _b.call(_f);
                }
                finally { if (e_2) throw e_2.error; }
            }
        }
        if (context.length > 0) {
            try {
                for (var context_1 = __values(context), context_1_1 = context_1.next(); !context_1_1.done; context_1_1 = context_1.next()) {
                    var v = context_1_1.value;
                    this.expr.addContext(v);
                }
            }
            catch (e_3_1) { e_3 = { error: e_3_1 }; }
            finally {
                try {
                    if (context_1_1 && !context_1_1.done && (_c = context_1.return)) _c.call(context_1);
                }
                finally { if (e_3) throw e_3.error; }
            }
        }
        this.expr.setEditPattern(ExprEditMode.Advanced); // 默认打开高级表达式编辑器
        this.expr.addExpressionText(e.instance.value);
        this.expr.buildExpression().then((/**
         * @param {?} expressioninfo
         * @return {?}
         */
        function (expressioninfo) {
            e.formControl.setValue(expressioninfo);
            e.instance.cd.detectChanges();
            //点击确定后，去除表达式里面的新增的上下文变量
            if (context.length > 0) {
                _this.expr.exprEntity.contextEntities = _this.expr.exprEntity.contextEntities.filter((/**
                 * @param {?} x
                 * @return {?}
                 */
                function (x) { return !context.some((/**
                 * @param {?} y
                 * @return {?}
                 */
                function (y) { return y.key === x.key; })); }));
            }
        }));
    };
    SmsMessageTemplateComponent.decorators = [
        { type: Component, args: [{
                    selector: 'lib-sms-message-template',
                    template: "<div class=\"w-100\">\r\n  <farris-section class=\"py-0 \" [enableAccordion]=\"''\" [enableMaximize]=\"false\">\r\n    <ng-template farrisSectionHeader>\r\n      <div class=\"f-title\">\r\n        <h4 class=\"f-title-text\">{{'component.smsMessageTemplate.smsMessageTemplate'|wfLocale}}</h4>\r\n        <span farrisPopover class=\"f-icon f-icon-message_help\" style=\"color:#FBB902\" [container]=\"'body'\"\r\n          [triggers]=\"'hover'\" [placement]=\"'right'\" [popover]=\"poptmpl\">\r\n        </span>\r\n        <ng-template #poptmpl let-infos>\r\n          <div style=\"padding:10px 10px 10px 10px;font-size: 12px;color: black;width: 260px;\">\r\n            <h4 style=\"font-weight: 600;font-size: 16px;color: saddlebrown;\">{{'component.smsMessageTemplate.smsMessageTemplate'|wfLocale}}</h4>\r\n            <p style=\"margin: 0 0 10px;\">{{'component.smsMessageTemplate.tips1'|wfLocale}}</p>\r\n            <h4 style=\"font-weight: 600;font-size: 16px;color: saddlebrown;\">{{'component.smsMessageTemplate.smsTemplateNumber'|wfLocale}}</h4>\r\n            <p style=\"margin: 0 0 10px;\">{{'component.smsMessageTemplate.tips2'|wfLocale}}</p>\r\n            <!-- <h4 style=\"font-weight: 600;font-size: 16px;color: saddlebrown;\">\u77ED\u4FE1\u6A21\u677F\u5185\u5BB9</h4>\r\n            <p style=\"margin: 0 0 10px;\">{{smsTemplateContent}}</p> -->\r\n            <h4 style=\"font-weight: 600;font-size: 16px;color: saddlebrown;\">{{'component.smsMessageTemplate.smsVariableBinding'|wfLocale}}</h4>\r\n            <p style=\"margin: 0 0 10px;\">{{'component.smsMessageTemplate.tips3'|wfLocale}}</p>\r\n          </div>\r\n        </ng-template>\r\n      </div>\r\n    </ng-template>\r\n    <div class=\"f-form-layout farris-form  farris-form-controls-inline f-form-lable-auto farris-form-auto\">\r\n      <div class=\"col-12\">\r\n        <div class=\"farris-group-wrap\">\r\n          <div class=\"form-group farris-form-group\">\r\n            <label class=\"col-form-label\">\r\n              <span class=\"farris-label-info text-danger\">*</span>\r\n              <span class=\"farris-label-text\">{{'component.smsMessageTemplate.smsTemplateNumber'|wfLocale}}</span>\r\n            </label>\r\n            <div class=\"farris-input-wrap ml-1\">\r\n              <input [(ngModel)]=\"smsMessageTemplate.code\" class=\"form-control\" name=\"tempCode\" type=\"text\">\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <!-- <div class=\"col-12\">\r\n        <div class=\"farris-group-wrap\">\r\n          <div class=\"form-group farris-form-group\">\r\n            <label class=\"col-form-label\">\r\n              <span class=\"farris-label-info text-danger\" style=\"visibility: hidden;\">*</span>\r\n              <span class=\"farris-label-text\">\u77ED\u4FE1\u6A21\u677F\u5185\u5BB9</span>\r\n            </label>\r\n            <div class=\"farris-input-wrap ml-1\">\r\n              <textarea [(ngModel)]=\"smsMessageTemplate.content\"  class=\"form-control \" cols=\"10\" id=\"textobj\" name=\"tempText\" rows=\"3\"> </textarea>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div> -->\r\n    </div>\r\n  </farris-section>\r\n</div>\r\n<div class=\"w-100\">\r\n  <farris-section class=\"pt-0 f-section-grid f-section-in-managelist\"\r\n    enableAccordion=\"{{'component.smsMessageTemplate.smsTemplateNumber'|wfLocale}}\" [enableMaximize]=\"false\" [mainTitle]=\"''\">\r\n    <!-- <ng-template farrisSectionTitle>\r\n      <div class=\"farris-label-text\">\u77ED\u4FE1\u53D8\u91CF\u7ED1\u5B9A</div>\r\n    </ng-template> -->\r\n    <ng-template farrisSectionToolbar>\r\n      <farris-button [type]=\"'link'\" (click)=\"addSmsVariable()\">\r\n        <span class=\"f-icon f-icon-add\"></span>\r\n        {{'component.smsMessageTemplate.addSmsVariable'|wfLocale}}</farris-button>\r\n      <farris-button [type]=\"'link'\" (click)=\"deleteSmsVariable()\">\r\n        <span class=\"f-icon f-icon-delete\"></span>\r\n        {{'component.smsMessageTemplate.deleteSmsVariable'|wfLocale}}</farris-button>\r\n    </ng-template>\r\n    <div style=\"height: 180px\">\r\n      <farris-datagrid #grid [data]=\"smsMessageTemplate.smsMessageVariables\" [idField]=\"'id'\" [columns]=\"smsVariableCols\"\r\n        [fit]=\"true\" [fitColumns]=\"true\" [editable]=\"true\" [editMode]=\"'cell'\" [pagination]=\"false\"\r\n        [showLineNumber]=\"true\" [showCheckbox]=\"false\" [multiSelect]=\"false\">\r\n      </farris-datagrid>\r\n    </div>\r\n  </farris-section>\r\n</div>\r\n",
                    providers: [
                        WfLocalePipe,
                    ],
                    styles: [""]
                }] }
    ];
    /** @nocollapse */
    SmsMessageTemplateComponent.ctorParameters = function () { return [
        { type: ProcessDesignerUIState },
        { type: ExpressionService },
        { type: MessagerService },
        { type: ChangeDetectorRef, decorators: [{ type: Optional }] },
        { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
        { type: undefined, decorators: [{ type: Inject, args: [WF_LANG_RESOURCES,] }] },
        { type: WfLocalePipe, decorators: [{ type: Optional }] }
    ]; };
    SmsMessageTemplateComponent.propDecorators = {
        grid: [{ type: ViewChild, args: ['grid',] }],
        smsMessageTemplate: [{ type: Input }]
    };
    return SmsMessageTemplateComponent;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var SendMessageOperationComponent = /** @class */ (function () {
    function SendMessageOperationComponent(injector, message, uistate, cdr, localeId, resources, localePipe, expr) {
        this.injector = injector;
        this.message = message;
        this.uistate = uistate;
        this.cdr = cdr;
        this.localeId = localeId;
        this.resources = resources;
        this.localePipe = localePipe;
        this.expr = expr;
        this.groupIcon2 = '<i class="f-icon f-icon-lookup"></i>';
        // operation: ExpireOperation = new ExpireOperation();
        this.operation = new SendMessage('activity', this.localePipe);
        this.closeEmitter = new EventEmitter();
        this.submitEmitter = new EventEmitter();
        this.typeGroup = this.uistate.messageChannels.map((/**
         * @param {?} m
         * @return {?}
         */
        function (m) { return ({ value: m.code, name: m.name }); }));
        this.receiverVariables = [
            { value: 'procInstCreator', name: this.localePipe.transform("component.sendMessageOperation.procInstCreator") }
        ];
        this.activityReceiverVariables = [
            { value: 'workItemParticipant', name: this.localePipe.transform("component.sendMessageOperation.workItemParticipant") },
            { value: 'procInstCreator', name: this.localePipe.transform("component.sendMessageOperation.procInstCreator") },
            { value: 'preActExecutors', name: this.localePipe.transform("component.sendMessageOperation.preActExecutors") }
        ];
        this.placeholder = '';
        this.placeholder2 = '';
        this.hasSmsTemplate = false;
        this.parser = (/**
         * @param {?} val
         * @return {?}
         */
        function (val) {
            // console.log(val);
            return Number(val);
        });
        this.timeUnitCollection = [
            { value: 'day', text: this.localePipe.transform("component.sendMessageOperation.day") },
            { value: 'hour', text: this.localePipe.transform("component.sendMessageOperation.hour") },
            { value: 'minute', text: this.localePipe.transform("component.sendMessageOperation.minute") }
        ];
        this.location = 'activity';
        this.activityReceiverVar = '';
        this.bindingData = {};
    }
    Object.defineProperty(SendMessageOperationComponent.prototype, "value", {
        get: /**
         * @return {?}
         */
        function () {
            return this.operation;
        },
        set: /**
         * @param {?} info
         * @return {?}
         */
        function (info) {
            var e_1, _a, e_2, _b;
            this.operation = JSON.parse(JSON.stringify(info));
            if (this.operation.sendType === undefined) {
                /** @type {?} */
                var sendMessage = new SendMessage(this.location, this.localePipe);
                this.operation.cycleEnable = sendMessage.cycleEnable;
                this.operation.cycleTimeUnit = sendMessage.cycleTimeUnit;
                this.operation.receiver = sendMessage.receiver;
                this.operation.subject = sendMessage.subject;
                this.operation.message = sendMessage.message;
            }
            if (this.operation.receiver && this.operation.receiver.length > 0) {
                /** @type {?} */
                var array = this.operation.receiver.split(',');
                if (array.indexOf('workItemParticipant') > -1) {
                    this.receiverVari = 'workItemParticipant';
                    this.activityReceiverVar += 'workItemParticipant,';
                }
                if (array.indexOf('procInstCreator') > -1) {
                    this.receiverVari = 'procInstCreator';
                    this.activityReceiverVar += 'procInstCreator,';
                }
                if (array.indexOf('preActExecutors') > -1) {
                    this.activityReceiverVar += 'preActExecutors,';
                }
                if (this.activityReceiverVar.length > 0) {
                    this.activityReceiverVar = this.activityReceiverVar.substring(0, this.activityReceiverVar.length - 1);
                }
                if (array.length > 0) {
                    array = array.filter((/**
                     * @param {?} a
                     * @return {?}
                     */
                    function (a) { return a !== 'procInstCreator'; }));
                    this.bindingData.id = '';
                    try {
                        for (var array_1 = __values(array), array_1_1 = array_1.next(); !array_1_1.done; array_1_1 = array_1.next()) {
                            var r = array_1_1.value;
                            this.bindingData.id += r + ',';
                        }
                    }
                    catch (e_1_1) { e_1 = { error: e_1_1 }; }
                    finally {
                        try {
                            if (array_1_1 && !array_1_1.done && (_a = array_1.return)) _a.call(array_1);
                        }
                        finally { if (e_1) throw e_1.error; }
                    }
                    if (this.bindingData.id) {
                        this.bindingData.id = this.bindingData.id.substring(0, this.bindingData.id.length - 1);
                    }
                }
            }
            if (this.operation.receiverText && this.operation.receiverText.length > 0) {
                /** @type {?} */
                var array = this.operation.receiverText.split(',');
                if (array.length > 0) {
                    array = array.filter((/**
                     * @param {?} a
                     * @return {?}
                     */
                    function (a) { return a !== '流程发起人'; }));
                    this.bindingData.name = '';
                    try {
                        for (var array_2 = __values(array), array_2_1 = array_2.next(); !array_2_1.done; array_2_1 = array_2.next()) {
                            var r = array_2_1.value;
                            this.bindingData.name += r + ',';
                        }
                    }
                    catch (e_2_1) { e_2 = { error: e_2_1 }; }
                    finally {
                        try {
                            if (array_2_1 && !array_2_1.done && (_b = array_2.return)) _b.call(array_2);
                        }
                        finally { if (e_2) throw e_2.error; }
                    }
                    if (this.bindingData.name) {
                        this.bindingData.name = this.bindingData.name.substring(0, this.bindingData.name.length - 1);
                    }
                }
            }
            if (this.hasSmsMessage(this.operation.sendType)) {
                this.hasSmsTemplate = true;
                if (!this.operation.smsMessageTemplate) {
                    this.operation.smsMessageTemplate = new SmsMessageTemplate$1();
                }
            }
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    SendMessageOperationComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
    };
    /**
     * @param {?} data
     * @return {?}
     */
    SendMessageOperationComponent.prototype.contentExpr = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        this.showContentHelp(data);
    };
    /**
     * @param {?} data
     * @return {?}
     */
    SendMessageOperationComponent.prototype.titleExpr = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        this.showTitleHelp(data);
    };
    /**
     * @param {?} data
     * @return {?}
     */
    SendMessageOperationComponent.prototype.showContentHelp = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        var _this = this;
        /** @type {?} */
        var context = this.showExpr();
        if (this.operation.message && this.operation.message.length > 0) {
            if (!this.operation.message.startsWith("{\"" + "expr\"" + ":\"")) {
                this.expr.addExpressionText("\'" + this.operation.message + "\'");
            }
            else {
                this.expr.addExpressionText(this.operation.message);
            }
        }
        else {
            this.expr.addExpressionText('');
        }
        this.expr.buildExpression().then((/**
         * @param {?} expressionInfo
         * @return {?}
         */
        function (expressionInfo) {
            _this.operation.message = expressionInfo;
            //点击确定后，去除表达式里面的新增的上下文变量
            if (context.length > 0) {
                _this.expr.exprEntity.contextEntities = _this.expr.exprEntity.contextEntities.filter((/**
                 * @param {?} x
                 * @return {?}
                 */
                function (x) { return !context.some((/**
                 * @param {?} y
                 * @return {?}
                 */
                function (y) { return y.key === x.key; })); }));
            }
        }));
    };
    /**
     * @param {?} data
     * @return {?}
     */
    SendMessageOperationComponent.prototype.showTitleHelp = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        var _this = this;
        /** @type {?} */
        var context = this.showExpr();
        if (this.operation.subject && this.operation.subject.length > 0) {
            if (!this.operation.subject.startsWith("{\"" + "expr\"" + ":\"")) {
                this.expr.addExpressionText("\'" + this.operation.subject + "\'");
            }
            else {
                this.expr.addExpressionText(this.operation.subject);
            }
        }
        else {
            this.expr.addExpressionText('');
        }
        this.expr.buildExpression().then((/**
         * @param {?} expressionInfo
         * @return {?}
         */
        function (expressionInfo) {
            _this.operation.subject = expressionInfo;
            //点击确定后，去除表达式里面的新增的上下文变量
            if (context.length > 0) {
                _this.expr.exprEntity.contextEntities = _this.expr.exprEntity.contextEntities.filter((/**
                 * @param {?} x
                 * @return {?}
                 */
                function (x) { return !context.some((/**
                 * @param {?} y
                 * @return {?}
                 */
                function (y) { return y.key === x.key; })); }));
            }
        }));
    };
    /**
     * @return {?}
     */
    SendMessageOperationComponent.prototype.clickOK = /**
     * @return {?}
     */
    function () {
        if (this.SmsTemplate) {
            this.SmsTemplate.endGridEdit();
        }
        this.operation.cycleTime += '';
        if (this.location === 'process') {
            this.setReceiver();
        }
        if (this.location === 'activity') {
            this.setActivityReceiver();
        }
        if (this.hasSmsTemplate) {
            this.operation.smsMessageTemplate = this.SmsTemplate.smsMessageTemplate;
            if (this.operation.smsMessageTemplate.smsMessageVariables && this.operation.smsMessageTemplate.smsMessageVariables.length > 0) {
                this.operation.smsMessageTemplate.smsMessageVariables = this.operation.smsMessageTemplate.smsMessageVariables.filter((/**
                 * @param {?} variable
                 * @return {?}
                 */
                function (variable) { return variable.code; }));
            }
        }
        else {
            this.operation.smsMessageTemplate = null;
        }
        if (this.validator()) {
            this.submitEmitter.emit(this.operation);
        }
    };
    /**
     * @return {?}
     */
    SendMessageOperationComponent.prototype.clickCancel = /**
     * @return {?}
     */
    function () {
        this.closeEmitter.emit();
    };
    /**
     * @return {?}
     */
    SendMessageOperationComponent.prototype.clear = /**
     * @return {?}
     */
    function () {
        this.bindingData = {};
    };
    /**
     * @param {?} sendType
     * @return {?}
     */
    SendMessageOperationComponent.prototype.sendTypeChange = /**
     * @param {?} sendType
     * @return {?}
     */
    function (sendType) {
        if (this.hasSmsMessage(sendType)) {
            this.hasSmsTemplate = true;
            if (!this.operation.smsMessageTemplate) {
                this.operation.smsMessageTemplate = new SmsMessageTemplate$1();
            }
        }
        else {
            this.hasSmsTemplate = false;
            this.operation.smsMessageTemplate = null;
        }
    };
    /**
     * @private
     * @return {?}
     */
    SendMessageOperationComponent.prototype.setReceiver = /**
     * @private
     * @return {?}
     */
    function () {
        var e_3, _a;
        /** @type {?} */
        var receiver = '';
        /** @type {?} */
        var receiverText = '';
        if (this.receiverVari) {
            receiver += this.receiverVari + ',';
            /** @type {?} */
            var array = this.receiverVari.split(',');
            if (array.length > 0) {
                var _loop_1 = function (a) {
                    /** @type {?} */
                    var t = this_1.receiverVariables.find((/**
                     * @param {?} v
                     * @return {?}
                     */
                    function (v) { return v.value === a; })).name;
                    receiverText += t + ',';
                };
                var this_1 = this;
                try {
                    for (var array_3 = __values(array), array_3_1 = array_3.next(); !array_3_1.done; array_3_1 = array_3.next()) {
                        var a = array_3_1.value;
                        _loop_1(a);
                    }
                }
                catch (e_3_1) { e_3 = { error: e_3_1 }; }
                finally {
                    try {
                        if (array_3_1 && !array_3_1.done && (_a = array_3.return)) _a.call(array_3);
                    }
                    finally { if (e_3) throw e_3.error; }
                }
            }
        }
        if (this.bindingData.id) {
            receiver += this.bindingData.id + ',';
            receiverText += this.bindingData.name + ',';
        }
        if (receiver) {
            receiver = receiver.substring(0, receiver.length - 1);
        }
        if (receiverText) {
            receiverText = receiverText.substring(0, receiverText.length - 1);
        }
        this.operation.receiver = receiver;
        this.operation.receiverText = receiverText;
    };
    /**
     * @return {?}
     */
    SendMessageOperationComponent.prototype.setActivityReceiver = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var receiver = '';
        if (this.activityReceiverVar) {
            receiver += this.activityReceiverVar + ',';
        }
        if (receiver) {
            receiver = receiver.substring(0, receiver.length - 1);
        }
        this.operation.receiver = receiver;
    };
    /**
     * @private
     * @return {?}
     */
    SendMessageOperationComponent.prototype.validator = /**
     * @private
     * @return {?}
     */
    function () {
        // 2023-5-22 如果没有启用循环预警则不进行校验
        if (this.operation.cycleEnable) {
            if (this.operation.cycleTime === 'undefined') {
                this.message.info(this.localePipe.transform("component.sendMessageOperation.cycleTimeNotEmpty"));
                return false;
            }
        }
        if (!this.operation.sendType) {
            this.message.info(this.localePipe.transform("component.sendMessageOperation.sendMethodNotEmpty"));
            return false;
        }
        if (!this.operation.subject) {
            this.message.info(this.localePipe.transform("component.sendMessageOperation.subjectNotEmpty"));
            return false;
        }
        if (!this.operation.message) {
            this.message.info(this.localePipe.transform("component.sendMessageOperation.contentNotEmpty"));
            return false;
        }
        if (!this.operation.receiver) {
            this.message.info(this.localePipe.transform("component.sendMessageOperation.recipientNotEmpty"));
            return false;
        }
        //去除消息模板编号校验
        // if (this.hasSmsTemplate) {
        //   if (!this.operation.smsMessageTemplate) {
        //     this.message.info(this.localePipe.transform("component.sendMessageOperation.messageTemplate"));
        //     return false;
        //   }
        //   if (!this.operation.smsMessageTemplate.code) {
        //     this.message.info(this.localePipe.transform("component.sendMessageOperation.smsTemplateNumberNotEmpty"));
        //     return false;
        //   }
        // }
        return true;
    };
    /**
     * @private
     * @param {?} sendType
     * @return {?}
     */
    SendMessageOperationComponent.prototype.hasSmsMessage = /**
     * @private
     * @param {?} sendType
     * @return {?}
     */
    function (sendType) {
        var _this = this;
        if (sendType) {
            /** @type {?} */
            var sendTypeList = sendType.split(',');
            /** @type {?} */
            var messageChannel = sendTypeList.find((/**
             * @param {?} val
             * @return {?}
             */
            function (val) { return _this.uistate.messageChannels.find((/**
             * @param {?} channel
             * @return {?}
             */
            function (channel) { return channel.code == val && channel.channelType == 'Sms'; })); }));
            if (messageChannel) {
                return true;
            }
            else {
                return false;
            }
        }
        else {
            return false;
        }
    };
    /**
     * @return {?}
     */
    SendMessageOperationComponent.prototype.showExpr = /**
     * @return {?}
     */
    function () {
        var e_4, _a, e_5, _b, e_6, _c, e_7, _d, e_8, _e;
        // this.expr.clearContext();
        if (this.uistate.schemas.length > 0) {
            try {
                for (var _f = __values(this.uistate.schemas), _g = _f.next(); !_g.done; _g = _f.next()) {
                    var schema = _g.value;
                    // this.expr.addCommonObject(co);
                    this.expr.addSchema('Schema', schema);
                }
            }
            catch (e_4_1) { e_4 = { error: e_4_1 }; }
            finally {
                try {
                    if (_g && !_g.done && (_a = _f.return)) _a.call(_f);
                }
                finally { if (e_4) throw e_4.error; }
            }
            if (this.uistate.schemas[0].entityTypes && this.uistate.schemas[0].entityTypes.length > 0) {
                /** @type {?} */
                var entityType = this.uistate.schemas[0].entityTypes[0];
                this.expr.addInjectedEntity(entityType.name, 'Schema', entityType.name, InjectedType.EntityType);
            }
        }
        /** @type {?} */
        var context = new Array();
        if (this.uistate.procInstContext.length > 0) {
            try {
                for (var _h = __values(this.uistate.procInstContext), _j = _h.next(); !_j.done; _j = _h.next()) {
                    var variable = _j.value;
                    context.push(variable);
                    // this.expr.addContext(variable);
                }
            }
            catch (e_5_1) { e_5 = { error: e_5_1 }; }
            finally {
                try {
                    if (_j && !_j.done && (_b = _h.return)) _b.call(_h);
                }
                finally { if (e_5) throw e_5.error; }
            }
        }
        if (this.uistate.processVariableContext.length > 0) {
            var _loop_2 = function (variable) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    context.push(variable);
                }
            };
            try {
                for (var _k = __values(this.uistate.processVariableContext), _l = _k.next(); !_l.done; _l = _k.next()) {
                    var variable = _l.value;
                    _loop_2(variable);
                }
            }
            catch (e_6_1) { e_6 = { error: e_6_1 }; }
            finally {
                try {
                    if (_l && !_l.done && (_c = _k.return)) _c.call(_k);
                }
                finally { if (e_6) throw e_6.error; }
            }
        }
        if (this.uistate.subActivityContext.length > 0) {
            var _loop_3 = function (variable) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    context.push(variable);
                }
            };
            try {
                for (var _m = __values(this.uistate.subActivityContext), _o = _m.next(); !_o.done; _o = _m.next()) {
                    var variable = _o.value;
                    _loop_3(variable);
                }
            }
            catch (e_7_1) { e_7 = { error: e_7_1 }; }
            finally {
                try {
                    if (_o && !_o.done && (_d = _m.return)) _d.call(_m);
                }
                finally { if (e_7) throw e_7.error; }
            }
        }
        if (context.length > 0) {
            try {
                for (var context_1 = __values(context), context_1_1 = context_1.next(); !context_1_1.done; context_1_1 = context_1.next()) {
                    var v = context_1_1.value;
                    this.expr.addContext(v);
                }
            }
            catch (e_8_1) { e_8 = { error: e_8_1 }; }
            finally {
                try {
                    if (context_1_1 && !context_1_1.done && (_e = context_1.return)) _e.call(context_1);
                }
                finally { if (e_8) throw e_8.error; }
            }
        }
        return context;
    };
    SendMessageOperationComponent.decorators = [
        { type: Component, args: [{
                    selector: 'lib-send-message-operation',
                    template: "<div class=\"f-page\">\r\n  <div class=\"f-utils-fill-flex-column h-100\">\r\n    <perfect-scrollbar [config]=\"{}\">\r\n      <form class=\"h-100\">\r\n        <div class=\"f-form-layout farris-form farris-form-controls-inline farris-form-auto\" style=\"padding-right: 0.875rem; padding-left: 0.875rem;\">\r\n          <div class=\"col-12 mt-2\">\r\n            <div class=\"farris-group-wrap\">\r\n              <div class=\"form-group\">\r\n                <label class=\"col-form-label pl-1 mr-3\">\r\n                  <span class=\"farris-label-text\">{{'component.sendMessageOperation.cycleEnable' | wfLocale}}</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap mr-5\">\r\n                  <farris-switch [(ngModel)]=\"operation.cycleEnable\" name=\"cycleEnable\"></farris-switch>\r\n                  <div class=\"farris-feedback valid-feedback\"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"col-7 mt-2 pr-1\">\r\n            <div class=\"farris-group-wrap\">\r\n              <div class=\"form-group\" style=\"width: 100%;\">\r\n                <label class=\"col-form-label pl-1 mr-3\">\r\n                  <span class=\"farris-label-info text-danger\">*</span>\r\n                  <span class=\"farris-label-text\">{{'component.sendMessageOperation.cycleTime' | wfLocale}}</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap mr-1\" style=\"width: 35%;\">\r\n                  <farris-number-spinner [(ngModel)]=\"operation.cycleTime\" name=\"cycleTime\"\r\n                                          [editable]=\"true\" [precision]=\"0\" [parser]=\"parser\"\r\n                                          [min]=\"0\"></farris-number-spinner>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"col-3 mt-2 pl-1\">\r\n            <div class=\"farris-group-wrap\">\r\n              <div class=\"form-group\" style=\"width: 100%;\">\r\n                <div class=\"farris-input-wrap mr-5\" style=\"width: 30%;\">\r\n                  <farris-combo-list [(ngModel)]=\"operation.cycleTimeUnit\" name=\"cycleTimeUnit\" [idField]=\"'value'\" [textField]=\"'text'\"\r\n                                      [valueField]=\"'value'\" [data]=\"timeUnitCollection\" [panelHeight]=\"'auto'\"\r\n                                      [editable]=\"false\" [enableClear]=\"false\">\r\n                  </farris-combo-list>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"col-12 mt-2\">\r\n            <div class=\"farris-group-wrap\">\r\n              <div class=\"form-group farris-form-group\">\r\n                <label class=\"col-form-label\">\r\n                  <span class=\"farris-label-info text-danger\">*</span>\r\n                  <span class=\"farris-label-text\">{{'component.sendMessageOperation.sendType' | wfLocale}}</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap ml-1\">\r\n                  <farris-checkboxgroup #checkboxGroup [(ngModel)]=\"operation.sendType\" name=\"sendType\" [horizontal]=\"true\"\r\n                    [data]=\"typeGroup\" (changeValue)=\"sendTypeChange($event)\">\r\n                  </farris-checkboxgroup>\r\n                  <div class=\"farris-feedback valid-feedback\"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"col-12 mt-2\">\r\n            <div class=\"farris-group-wrap\">\r\n              <div class=\"form-group farris-form-group\">\r\n                <label class=\"col-form-label\">\r\n                  <span class=\"farris-label-info text-danger\">*</span>\r\n                  <span class=\"farris-label-text\">{{'component.sendMessageOperation.subject' | wfLocale}}</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap ml-1\">\r\n                    <input-group [editable]=\"false\" [enableClear]=\"false\" [customCls]=\"'custom-cls'\" [groupText]=\"groupIcon2\"\r\n                    [(value)]=\"operation.subject\" (clickHandle)=\"titleExpr($event)\">\r\n                    </input-group>\r\n                  <div class=\"farris-feedback valid-feedback\"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"col-12 mt-2\">\r\n            <div class=\"farris-group-wrap\">\r\n              <div class=\"form-group farris-form-group\">\r\n                <label class=\"col-form-label\">\r\n                  <span class=\"farris-label-info text-danger\">*</span>\r\n                  <span class=\"farris-label-text\">{{'component.sendMessageOperation.message' | wfLocale}}</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap ml-1\">\r\n                    <input-group [editable]=\"false\" [enableClear]=\"false\" [customCls]=\"'custom-cls'\" [groupText]=\"groupIcon2\"\r\n                    [(value)]=\"operation.message\" (clickHandle)=\"contentExpr($event)\">\r\n                    </input-group>\r\n                  <div class=\"farris-feedback valid-feedback\"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"col-12 mt-2\">\r\n            <div *ngIf=\"location==='process'\" class=\"farris-group-wrap\">\r\n              <div class=\"form-group farris-form-group\">\r\n                <label class=\"col-form-label\">\r\n                  <span class=\"farris-label-info text-danger\">*</span>\r\n                  <span class=\"farris-label-text\">{{'component.sendMessageOperation.receiverVari' | wfLocale}}</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap ml-1\">\r\n                  <div class=\"pb-2\">\r\n                    <farris-checkboxgroup #receiverVariable [(ngModel)]=\"receiverVari\" name=\"receiverVariable\"\r\n                      [horizontal]=\"true\" [data]=\"receiverVariables\">\r\n                    </farris-checkboxgroup>\r\n                  </div>\r\n                  <div>\r\n                    <sys-farris-grid-lookup #userHelp [singleSelect]=\"false\" [displayTxt]=\"bindingData.name\" [pagination]=\"true\"\r\n                      [pageSize]=\"20\" title=\"{{'component.sendMessageOperation.sysUsers' | wfLocale}}\" [sourceType]=\"'user'\" [bindingData]=\"bindingData\"\r\n                      [filter]=\"{notGetCurrentUser:false, notGetStopUser:true}\" [typeMode]=\"1\" (clear)=\"clear()\">\r\n                    </sys-farris-grid-lookup>\r\n                  </div>\r\n                  <div class=\"farris-feedback valid-feedback\"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div *ngIf=\"location==='activity'\" class=\"farris-group-wrap\">\r\n              <div class=\"form-group farris-form-group\">\r\n                <label class=\"col-form-label\">\r\n                  <span class=\"farris-label-info text-danger\">*</span>\r\n                  <span class=\"farris-label-text\">{{'component.sendMessageOperation.receiverVari' | wfLocale}}</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap ml-1\">\r\n                  <div class=\"pb-2\">\r\n                    <farris-checkboxgroup #receiverVariable1 [(ngModel)]=\"activityReceiverVar\" name=\"ActivityReceiverVariable\"\r\n                                          [horizontal]=\"true\" [data]=\"activityReceiverVariables\">\r\n                    </farris-checkboxgroup>\r\n                  </div>\r\n                  <div class=\"farris-feedback valid-feedback\"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <lib-sms-message-template *ngIf=\"hasSmsTemplate\" [smsMessageTemplate]=\"operation.smsMessageTemplate\"></lib-sms-message-template>\r\n      </form>\r\n    </perfect-scrollbar>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #footer>\r\n  <button type=\"button\" class=\"btn btn-secondary btn-sm mx-2\" (click)=\"clickCancel()\">{{'component.sendMessageOperation.clickCancel' | wfLocale}}</button>\r\n  <button type=\"button\" class=\"btn btn-primary btn-sm mx-2\" (click)=\"clickOK()\">{{'component.sendMessageOperation.clickOK' | wfLocale}}</button>\r\n</ng-template>\r\n",
                    providers: [
                        WfLocalePipe,
                    ],
                    styles: [""]
                }] }
    ];
    /** @nocollapse */
    SendMessageOperationComponent.ctorParameters = function () { return [
        { type: Injector },
        { type: MessagerService },
        { type: ProcessDesignerUIState },
        { type: ChangeDetectorRef, decorators: [{ type: Optional }] },
        { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
        { type: undefined, decorators: [{ type: Inject, args: [WF_LANG_RESOURCES,] }] },
        { type: WfLocalePipe, decorators: [{ type: Optional }] },
        { type: ExpressionService }
    ]; };
    SendMessageOperationComponent.propDecorators = {
        footer: [{ type: ViewChild, args: ['footer',] }],
        SmsTemplate: [{ type: ViewChild, args: [SmsMessageTemplateComponent,] }],
        value: [{ type: Input }],
        closeEmitter: [{ type: Output }],
        submitEmitter: [{ type: Output }]
    };
    return SendMessageOperationComponent;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var AutoHandleOperationComponent = /** @class */ (function () {
    function AutoHandleOperationComponent(message, uiState, cdr, localeId, resources, localePipe) {
        var e_1, _a;
        this.message = message;
        this.uiState = uiState;
        this.cdr = cdr;
        this.localeId = localeId;
        this.resources = resources;
        this.localePipe = localePipe;
        this.placeholder = '';
        this.operation = new AutoHandle('Pass', this.localePipe);
        this.submitEmitter = new EventEmitter();
        this.closeEmitter = new EventEmitter();
        this.autoHandleType = [
        // { value: 'autoPass', text: '自动通过' },
        // { value: 'autoBack', text: '自动驳回' }
        ];
        this.localePipe = this.localePipe || new WfLocalePipe(localeId, resources);
        try {
            for (var _b = __values(this.uiState.propertyData.ApprovalItems), _c = _b.next(); !_c.done; _c = _b.next()) {
                var item = _c.value;
                this.autoHandleType.push({ value: item.Value, text: item.Text });
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_1) throw e_1.error; }
        }
    }
    Object.defineProperty(AutoHandleOperationComponent.prototype, "value", {
        get: /**
         * @return {?}
         */
        function () {
            return this.operation;
        },
        set: /**
         * @param {?} info
         * @return {?}
         */
        function (info) {
            this.operation = Object.assign({}, info);
            if (this.operation.autoHandleType === undefined) {
                /** @type {?} */
                var autoHandle = new AutoHandle(this.autoHandleType[0].value, this.localePipe);
                this.operation.autoHandleType = autoHandle.autoHandleType;
                this.operation.message = autoHandle.message;
            }
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    AutoHandleOperationComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
    };
    /**
     * @return {?}
     */
    AutoHandleOperationComponent.prototype.clickOK = /**
     * @return {?}
     */
    function () {
        if (this.validator()) {
            this.submitEmitter.emit(this.operation);
        }
    };
    /**
     * @return {?}
     */
    AutoHandleOperationComponent.prototype.clickCancel = /**
     * @return {?}
     */
    function () {
        this.closeEmitter.emit();
    };
    /**
     * @private
     * @return {?}
     */
    AutoHandleOperationComponent.prototype.validator = /**
     * @private
     * @return {?}
     */
    function () {
        if (!this.operation.message) {
            this.message.info(this.localePipe.transform('component.sendMessageOperation.opinionsNotEmpty'));
            return false;
        }
        if (!this.operation.autoHandleType) {
            this.message.info(this.localePipe.transform('component.sendMessageOperation.processingNotEmpty'));
            return false;
        }
        return true;
    };
    AutoHandleOperationComponent.decorators = [
        { type: Component, args: [{
                    selector: 'lib-auto-handle-operation',
                    template: "<div class=\"f-page\">\r\n  <div class=\"f-utils-fill-flex-column farris-split-section m-2 h-100\">\r\n    <section class=\"f-utils-fill-flex-column h-100\">\r\n      <div class=\"f-section-header pt-2 mx-2\">\r\n        <div class=\"f-title\">\r\n          <h4 class=\"f-title-text\">{{'component.sendMessageOperation.automaticProcessSet' | wfLocale}}</h4>\r\n        </div>\r\n      </div>\r\n      <div class=\"f-utils-fill-flex-column h-100\">\r\n        <perfect-scrollbar [config]=\"{}\">\r\n          <form class=\"h-100\">\r\n            <div class=\"farris-form form-inline farris-form-inline\">\r\n              <div class=\"farris-group-wrap\">\r\n                <div class=\"form-group farris-form-group\">\r\n                  <label class=\"col-form-label\">\r\n                    <span class=\"farris-label-info text-danger\">*</span>\r\n                    <span class=\"farris-label-text\">{{'component.sendMessageOperation.automaticProcessMethod' | wfLocale}}</span>\r\n                  </label>\r\n                  <div class=\"farris-input-wrap ml-1\">\r\n                    <farris-combo-list [(ngModel)]=\"operation.autoHandleType\" name=\"cycleTimeUnit\" [idField]=\"'value'\" [textField]=\"'text'\"\r\n                                       [valueField]=\"'value'\" [data]=\"autoHandleType\" [panelHeight]=\"'auto'\"\r\n                                       [editable]=\"false\" [enableClear]=\"false\">\r\n                    </farris-combo-list>\r\n                    <div class=\"farris-feedback valid-feedback\"></div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <div class=\"farris-group-wrap my-3\">\r\n                <div class=\"form-group farris-form-group\">\r\n                  <label class=\"col-form-label\">\r\n                    <span class=\"farris-label-info text-danger\">*</span>\r\n                    <span class=\"farris-label-text\">{{'component.sendMessageOperation.automaticOpinionHandle' | wfLocale}}</span>\r\n                  </label>\r\n                  <div class=\"farris-input-wrap ml-1\">\r\n                    <textarea class=\"form-control\" type=\"text\" value=\"message\" [(ngModel)]=\"operation.message\" name=\"message\"\r\n                              [placeholder]=\"placeholder\" style=\"height: 100px;\"></textarea>\r\n                    <div class=\"farris-feedback valid-feedback\"></div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </form>\r\n        </perfect-scrollbar>\r\n      </div>\r\n    </section>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #footer>\r\n  <button type=\"button\" class=\"btn btn-secondary btn-sm mx-2\" (click)=\"clickCancel()\">{{'component.sendMessageOperation.clickCancel' | wfLocale}}</button>\r\n  <button type=\"button\" class=\"btn btn-primary btn-sm mx-2\" (click)=\"clickOK()\">{{'component.sendMessageOperation.clickOK' | wfLocale}}</button>\r\n</ng-template>\r\n",
                    providers: [
                        WfLocalePipe,
                    ],
                    styles: [""]
                }] }
    ];
    /** @nocollapse */
    AutoHandleOperationComponent.ctorParameters = function () { return [
        { type: MessagerService },
        { type: ProcessDesignerUIState },
        { type: ChangeDetectorRef, decorators: [{ type: Optional }] },
        { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
        { type: undefined, decorators: [{ type: Inject, args: [WF_LANG_RESOURCES,] }] },
        { type: WfLocalePipe, decorators: [{ type: Optional }] }
    ]; };
    AutoHandleOperationComponent.propDecorators = {
        footer: [{ type: ViewChild, args: ['footer',] }],
        value: [{ type: Input }],
        submitEmitter: [{ type: Output }],
        closeEmitter: [{ type: Output }]
    };
    return AutoHandleOperationComponent;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var TimeLimitControlComponent = /** @class */ (function () {
    function TimeLimitControlComponent(resolver, injector, modalService, message, cdr, localeId, resources, localePipe) {
        var _this = this;
        this.resolver = resolver;
        this.injector = injector;
        this.modalService = modalService;
        this.message = message;
        this.cdr = cdr;
        this.localeId = localeId;
        this.resources = resources;
        this.localePipe = localePipe;
        this.cls = 'farris-main-area flex-column';
        this.closeModal = new EventEmitter();
        this.submitModal = new EventEmitter();
        this.editorParams = {};
        this.modalConfig = {
            title: this.localePipe.transform("component.timeLimitControl.timedOutOperation"),
            width: 760,
            height: 532,
            showButtons: true
        };
        this.timeLimitInfo = new TimeLimitInfo();
        this.tagCollection = [
            { value: 'constant', text: this.localePipe.transform("component.timeLimitControl.constant") },
            { value: 'scope', text: this.localePipe.transform("component.timeLimitControl.scope") }
        ];
        this.timeUnitCollection = [
            { value: 'day', text: this.localePipe.transform("component.timeLimitControl.day") },
            { value: 'hour', text: this.localePipe.transform("component.timeLimitControl.hour") },
            { value: 'minute', text: this.localePipe.transform("component.timeLimitControl.minute") }
        ];
        this.durationTypeCollection = [
            { value: 'BeforeDuration', text: this.localePipe.transform("component.timeLimitControl.BeforeDuration") },
            { value: 'OnDuration', text: this.localePipe.transform("component.timeLimitControl.OnDuration") },
            { value: 'AfterDuration', text: this.localePipe.transform("component.timeLimitControl.AfterDuration") }
        ];
        this.activityOperationTypeName = [
            { value: 'SendMessageExpireOperation', text: this.localePipe.transform("component.timeLimitControl.SendMessageExpireOperation") },
            { value: 'AutoHandleExpireOperation', text: this.localePipe.transform("component.timeLimitControl.AutoHandleExpireOperation") }
        ];
        this.processOperationTypeName = [
            { value: 'SendMessageExpireOperation', text: this.localePipe.transform("component.timeLimitControl.SendMessageExpireOperation") }
        ];
        this.operationTypeName = [];
        this.timeScopeCollection = [
            { value: 'curDay', name: this.localePipe.transform("component.timeLimitControl.curDay") }
        ];
        this.timeScopeValue = this.timeScopeCollection[0].value;
        this.cols = [];
        this.location = 'activity';
        this.parser = (/**
         * @param {?} val
         * @return {?}
         */
        function (val) {
            return Number(val);
        });
        this.durationTypeChange = (/**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            if (data && data.value && data.value.value === _this.durationTypeCollection[1].value) {
                /** @type {?} */
                var operation = _this.timeLimitInfo.expireOperations.find((/**
                 * @param {?} e
                 * @return {?}
                 */
                function (e) { return e.id === data.rowData.id; }));
                operation.timeDuration = 0;
            }
        });
        this.localePipe = this.localePipe || new WfLocalePipe(localeId, resources);
    }
    Object.defineProperty(TimeLimitControlComponent.prototype, "value", {
        set: /**
         * @param {?} v
         * @return {?}
         */
        function (v) {
            var e_1, _a;
            if (v) {
                this.timeLimitInfo = v;
            }
            else {
                this.timeLimitInfo = new TimeLimitInfo();
            }
            try {
                // 兼容历史数据中的操作类型
                for (var _b = __values(this.timeLimitInfo.expireOperations), _c = _b.next(); !_c.done; _c = _b.next()) {
                    var operation = _c.value;
                    if (operation.operationTypeName === undefined) {
                        operation.operationTypeName = 'SendMessageExpireOperation';
                    }
                }
            }
            catch (e_1_1) { e_1 = { error: e_1_1 }; }
            finally {
                try {
                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                }
                finally { if (e_1) throw e_1.error; }
            }
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    TimeLimitControlComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        this.location = this.editorParams.location;
        if (this.location === 'activity') {
            this.operationTypeName = this.activityOperationTypeName;
        }
        else {
            this.operationTypeName = this.processOperationTypeName;
        }
        this.cols = [
            {
                field: 'durationType', width: 80, title: this.localePipe.transform("component.timeLimitControl.durationType"),
                formatter: {
                    type: 'enum',
                    options: { valueField: 'value', textField: 'text', data: this.durationTypeCollection }
                },
                editor: {
                    type: EditorTypes.COMBOLIST,
                    options: {
                        valueField: 'value', textField: 'text', data: this.durationTypeCollection, idField: 'value', panelHeight: 'auto',
                        valueChange: this.durationTypeChange, showClear: false
                    }
                },
                validators: [
                    { type: 'required', messager: '必填' }
                ]
            },
            {
                field: 'timeDuration', width: 60, title: this.localePipe.transform("component.timeLimitControl.timeDuration"),
                editor: {
                    type: EditorTypes.NUMBERBOX, options: { min: 0 },
                },
                validators: [
                    { type: 'required', messager: '必填' }
                ]
            },
            {
                field: 'timeUnit', width: 60, title: this.localePipe.transform("component.timeLimitControl.timeUnit"),
                formatter: {
                    type: 'enum',
                    options: { valueField: 'value', textField: 'text', data: this.timeUnitCollection }
                },
                editor: {
                    type: EditorTypes.COMBOLIST,
                    options: { valueField: 'value', textField: 'text', data: this.timeUnitCollection, idField: 'value', panelHeight: 'auto' }
                },
                validators: [
                    { type: 'required', messager: '必填' }
                ]
            },
            {
                field: 'operationTypeName', width: 100, title: this.localePipe.transform("component.timeLimitControl.operationTypeName"),
                formatter: {
                    type: 'enum',
                    options: { valueField: 'value', textField: 'text', data: this.operationTypeName }
                },
                editor: {
                    type: EditorTypes.COMBOLIST,
                    options: { valueField: 'value', textField: 'text', data: this.operationTypeName, idField: 'value', panelHeight: 'auto' }
                },
                validators: [
                    { type: 'required', messager: '必填' }
                ]
            },
            {
                field: 'sendType', width: 80, title: this.localePipe.transform("component.timeLimitControl.sendType"), template: this.cell,
                validators: [
                    { type: 'required', messager: '必填' }
                ]
            }
        ];
    };
    /**
     * @return {?}
     */
    TimeLimitControlComponent.prototype.clickOK = /**
     * @return {?}
     */
    function () {
        this.grid.endCellEdit();
        this.timeLimitInfo.dueTime += '';
        if (this.validator()) {
            /** @type {?} */
            var object = { value: this.timeLimitInfo, parameters: null };
            this.submitModal.emit(object);
        }
    };
    /**
     * @return {?}
     */
    TimeLimitControlComponent.prototype.clickCancel = /**
     * @return {?}
     */
    function () {
        this.closeModal.emit();
    };
    /**
     * @private
     * @return {?}
     */
    TimeLimitControlComponent.prototype.validator = /**
     * @private
     * @return {?}
     */
    function () {
        var e_2, _a;
        if ((this.timeLimitInfo.dueTime).indexOf('.') > -1) {
            console.log(this.timeLimitInfo.dueTime);
            this.message.info(this.localePipe.transform("component.timeLimitControl.onlyBeInteger"));
            return false;
        }
        if (this.timeLimitInfo.expireOperations
            && this.timeLimitInfo.expireOperations.length > 0) {
            try {
                for (var _b = __values(this.timeLimitInfo.expireOperations), _c = _b.next(); !_c.done; _c = _b.next()) {
                    var e = _c.value;
                    if (e.operationTypeName === 'SendMessageExpireOperation') {
                        /** @type {?} */
                        var a = (/** @type {?} */ (e));
                        if (!a.sendType) {
                            this.message.info(this.localePipe.transform("component.timeLimitControl.setOperation"));
                            return false;
                        }
                    }
                    if (e.operationTypeName === 'AutoHandleExpireOperation') {
                        /** @type {?} */
                        var a = (/** @type {?} */ (e));
                        if (!a.autoHandleType) {
                            this.message.info(this.localePipe.transform("component.timeLimitControl.setType"));
                            return false;
                        }
                        if (!a.message) {
                            this.message.info(this.localePipe.transform("component.timeLimitControl.setComments"));
                            return false;
                        }
                    }
                    if (e.durationType === 'OnDuration' && e.timeDuration !== 0) {
                        e.timeDuration = 0;
                    }
                }
            }
            catch (e_2_1) { e_2 = { error: e_2_1 }; }
            finally {
                try {
                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                }
                finally { if (e_2) throw e_2.error; }
            }
        }
        return true;
    };
    /**
     * @return {?}
     */
    TimeLimitControlComponent.prototype.add = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var operation = new ExpireOperation();
        this.timeLimitInfo.expireOperations.push(operation);
        this.grid.loadData(this.timeLimitInfo.expireOperations);
        this.grid.selectRow(operation.id);
    };
    /**
     * @return {?}
     */
    TimeLimitControlComponent.prototype.remove = /**
     * @return {?}
     */
    function () {
        this.grid.endCellEdit();
        /** @type {?} */
        var curItem = this.grid.selectedRow;
        if (!curItem) {
            this.message.info(this.localePipe.transform("component.timeLimitControl.selectedOperation"));
            return;
        }
        /** @type {?} */
        var i = this.timeLimitInfo.expireOperations.findIndex((/**
         * @param {?} a
         * @return {?}
         */
        function (a) { return a.id === curItem.data.id; }));
        if (i > -1) {
            this.timeLimitInfo.expireOperations.splice(i, 1);
            this.grid.loadData(this.timeLimitInfo.expireOperations);
        }
    };
    /**
     * @param {?} ctx
     * @return {?}
     */
    TimeLimitControlComponent.prototype.editOperation = /**
     * @param {?} ctx
     * @return {?}
     */
    function (ctx) {
        var _this = this;
        this.grid.endCellEdit();
        if (ctx.rowData.operationTypeName === 'SendMessageExpireOperation') {
            this.sendMassageOperation(ctx);
        }
        if (ctx.rowData.operationTypeName === 'AutoHandleExpireOperation') {
            this.message.confirm(this.localePipe.transform("component.timeLimitControl.notSupportAutomatic")).subscribe((/**
             * @param {?} re
             * @return {?}
             */
            function (re) { return re === true ? _this.autoHandleOperation(ctx) : null; }));
        }
    };
    /**
     * @param {?} ctx
     * @return {?}
     */
    TimeLimitControlComponent.prototype.sendMassageOperation = /**
     * @param {?} ctx
     * @return {?}
     */
    function (ctx) {
        var _this = this;
        /** @type {?} */
        var dialog;
        /** @type {?} */
        var compFactory = this.resolver.resolveComponentFactory(SendMessageOperationComponent);
        /** @type {?} */
        var compRef = compFactory.create(this.injector);
        compRef.instance.location = this.location;
        compRef.instance.value = Object.assign({}, ctx.rowData);
        compRef.instance.submitEmitter.subscribe((/**
         * @param {?} re
         * @return {?}
         */
        function (re) {
            /** @type {?} */
            var operation = _this.timeLimitInfo.expireOperations.find((/**
             * @param {?} o
             * @return {?}
             */
            function (o) { return o.id === re.id; }));
            operation = Object.assign(operation, re);
            dialog.close();
        }));
        compRef.instance.closeEmitter.subscribe((/**
         * @param {?} re
         * @return {?}
         */
        function (re) {
            dialog.close();
        }));
        /** @type {?} */
        var modalConfig = {
            title: this.localePipe.transform("component.timeLimitControl.warningMessage"),
            width: 800,
            height: 515,
            buttons: compRef.instance.footer,
            showButtons: true
        };
        dialog = this.modalService.show(compRef, modalConfig);
    };
    /**
     * @param {?} ctx
     * @return {?}
     */
    TimeLimitControlComponent.prototype.autoHandleOperation = /**
     * @param {?} ctx
     * @return {?}
     */
    function (ctx) {
        var _this = this;
        /** @type {?} */
        var dialog;
        /** @type {?} */
        var compFactory = this.resolver.resolveComponentFactory(AutoHandleOperationComponent);
        /** @type {?} */
        var compRef = compFactory.create(this.injector);
        compRef.instance.value = Object.assign({}, ctx.rowData);
        compRef.instance.submitEmitter.subscribe((/**
         * @param {?} re
         * @return {?}
         */
        function (re) {
            /** @type {?} */
            var operation = _this.timeLimitInfo.expireOperations.find((/**
             * @param {?} o
             * @return {?}
             */
            function (o) { return o.id === re.id; }));
            operation = Object.assign(operation, re);
            dialog.close();
        }));
        compRef.instance.closeEmitter.subscribe((/**
         * @param {?} re
         * @return {?}
         */
        function (re) {
            dialog.close();
        }));
        /** @type {?} */
        var modalConfig = {
            title: this.localePipe.transform("component.timeLimitControl.automaticProcessing"),
            width: 500,
            height: this.location === 'activity' ? 390 : 460,
            buttons: compRef.instance.footer,
            showButtons: true
        };
        dialog = this.modalService.show(compRef, modalConfig);
    };
    /**
     * @param {?} data
     * @return {?}
     */
    TimeLimitControlComponent.prototype.tagSelectChange = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        if (data.data.value === 'constant') {
            this.timeLimitInfo.timeUnit = "day";
        }
        else if (data.data.value === 'scope') {
            this.timeLimitInfo.timeUnit = '';
            this.timeLimitInfo.dueTime = this.timeScopeValue;
        }
    };
    /**
     * @param {?} data
     * @return {?}
     */
    TimeLimitControlComponent.prototype.changeTimeScope = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        this.timeScopeValue = data;
        this.timeLimitInfo.dueTime = this.timeScopeValue;
    };
    TimeLimitControlComponent.decorators = [
        { type: Component, args: [{
                    selector: 'lib-time-limit-control',
                    template: "<div class=\"f-page\">\r\n  <div class=\"f-utils-fill-flex-column farris-split-section m-2 h-100\">\r\n    <section class=\"f-utils-fill-flex-column h-100\" style=\"border-radius:16px;border: 1.5px solid #F1F3F7\">\r\n      <div class=\"f-section-header pt-2 mx-2\">\r\n        <div class=\"f-title\">\r\n          <h4 class=\"f-title-text\">{{ 'component.timeLimitControl.timelinessControl' | wfLocale }}</h4><span class=\"title-line\"></span>\r\n        </div>\r\n      </div>\r\n      <div class=\"f-utils-fill-flex-column h-100\">\r\n        <form class=\"h-100\">\r\n          <div class=\"f-utils-fill-flex-column h-100\">\r\n            <div class=\"farris-form-controls-inline\">\r\n              <div class=\"farris-group-wrap\">\r\n                <div class=\"form-group\">\r\n                  <label class=\"col-form-label pl-1 mr-3\">\r\n                    <span class=\"farris-label-text\">{{ 'component.timeLimitControl.isEnable' | wfLocale }}</span>\r\n                  </label>\r\n                  <div class=\"farris-input-wrap mr-5\">\r\n                    <farris-switch [(ngModel)]=\"timeLimitInfo.enable\" name=\"enable\"></farris-switch>\r\n                    <div class=\"farris-feedback valid-feedback\"></div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div class=\"farris-form-controls-inline\">\r\n              <div class=\"farris-group-wrap\">\r\n                <div class=\"form-group\" style=\"width: 100%;\">\r\n                  <label class=\"col-form-label pl-1 mr-3\">\r\n                    <span class=\"farris-label-text\">{{ 'component.timeLimitControl.taskDeadline' | wfLocale }}</span>\r\n                  </label>\r\n                  <div class=\"farris-input-wrap mr-1\" style=\"width: 35%;\"><!--name=\"tag\"-->\r\n                    <farris-combo-list [(ngModel)]=\"timeLimitInfo.tag\" [idField]=\"'value'\" [textField]=\"'text'\" name=\"tag\"\r\n                                       [valueField]=\"'value'\" [data]=\"tagCollection\" [panelHeight]=\"'auto'\"\r\n                                       [editable]=\"false\" [enableClear]=\"false\" (selectChange)=\"tagSelectChange($event)\">\r\n                    </farris-combo-list>\r\n                    <div class=\"farris-feedback valid-feedback\"></div>\r\n                  </div>\r\n                  <div *ngIf=\"timeLimitInfo.tag === 'constant'\" class=\"farris-input-wrap mr-1\" style=\"width: 35%;\">\r\n                    <farris-number-spinner [(ngModel)]=\"timeLimitInfo.dueTime\" name=\"dueTime\"\r\n                      [editable]=\"true\" [precision]=\"0\" [parser]=\"parser\"\r\n                      [min]=\"0\"></farris-number-spinner>\r\n                    <div class=\"farris-feedback valid-feedback\"></div>\r\n                  </div>\r\n                  <div *ngIf=\"timeLimitInfo.tag === 'constant'\" class=\"farris-input-wrap mr-5\" style=\"width: 30%;\">\r\n                    <farris-combo-list [(ngModel)]=\"timeLimitInfo.timeUnit\" name=\"timeUnit\" [idField]=\"'value'\" [textField]=\"'text'\"\r\n                    [valueField]=\"'value'\" [data]=\"timeUnitCollection\" [panelHeight]=\"'auto'\"\r\n                    [editable]=\"false\" [enableClear]=\"false\">\r\n                    </farris-combo-list>\r\n                    <div class=\"farris-feedback valid-feedback\"></div>\r\n                  </div>\r\n                  <div *ngIf=\"timeLimitInfo.tag === 'scope'\" class=\"farris-input-wrap mr-1\" style=\"width: 65%;\">\r\n                    <farris-radiogroup [(ngModel)]=\"timeLimitInfo.dueTime\" name=\"scope\"\r\n                                       [data]=\"timeScopeCollection\"\r\n                                       (changeValue)=\"changeTimeScope($event)\">\r\n                    </farris-radiogroup>\r\n                    <div class=\"farris-feedback valid-feedback\"></div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div class=\"mx-2 mt-3\">\r\n              <div class=\"title-content\">\r\n                <h4 class=\"title-text\">{{ 'component.timeLimitControl.timelyOperation' | wfLocale }}</h4><span class=\"title-line\"></span>\r\n              </div>\r\n            </div>\r\n            <div class=\"mx-2 h-100\">\r\n              <farris-tabs class=\"f-utils-fill h-100\" [value]=\"'operation'\" [contentFill]=\"true\" [autoTitleWidth]=\"true\">\r\n                <farris-tab title=\"{{'component.timeLimitControl.timelyOperation' | wfLocale}}\" [id]=\"'operation'\">\r\n                  <ng-template farrisTabsExtend>\r\n                    <div class=\"mx-2\">\r\n                      <button type=\"button\" (click)=\"add()\"\r\n                        class=\"btn btn-primary mr-2\">{{ 'component.timeLimitControl.add' | wfLocale }}</button>\r\n                      <button type=\"button\" (click)=\"remove()\"\r\n                        class=\"btn btn-secondary\">{{ 'component.timeLimitControl.remove' | wfLocale }}</button>\r\n                    </div>\r\n                  </ng-template>\r\n                  <ng-template #content>\r\n                    <div class=\"f-utils-fill-flex-column h-100\" style=\"background: #FFF;\">\r\n                      <farris-datagrid #grid [data]=\"timeLimitInfo.expireOperations\" [idField]=\"'id'\" [columns]=\"cols\"\r\n                        [fit]=\"true\" [editMode]=\"'cell'\" [editable]=\"true\"\r\n                        [fitColumns]=\"true\" [pagination]=\"false\" [showCheckbox]=\"false\" [multiSelect]=\"false\"><!--[beforeEdit]=\"beforeEdit\" [afterEdit]=\"afterEdit\"-->\r\n                      </farris-datagrid>\r\n                    </div>\r\n                  </ng-template>\r\n                </farris-tab>\r\n              </farris-tabs>\r\n            </div>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </section>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #cell let-ctx>\r\n  <span (click)=\"editOperation(ctx)\" *ngIf=\"ctx.rowData.operationTypeName === 'SendMessageExpireOperation'\" class=\"link\">\r\n    {{ ctx.rowData.sendType?('component.timeLimitControl.set' | wfLocale): ('component.timeLimitControl.notSet' | wfLocale) }}\r\n  </span>\r\n  <span (click)=\"editOperation(ctx)\" *ngIf=\"ctx.rowData.operationTypeName === 'AutoHandleExpireOperation'\" class=\"link\">\r\n    {{ (ctx.rowData.autoHandleType && ctx.rowData.message)?('component.timeLimitControl.set' | wfLocale): ('component.timeLimitControl.notSet' | wfLocale) }}\r\n  </span>\r\n</ng-template>\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type=\"button\" class=\"btn btn-secondary btn-sm\" (click)=\"clickCancel()\">{{'component.timeLimitControl.clickCancel' | wfLocale }}</button>\r\n  <button type=\"button\" class=\"btn btn-primary btn-sm mx-2\" (click)=\"clickOK()\">{{'component.timeLimitControl.clickOK' | wfLocale }}</button>\r\n</ng-template>",
                    providers: [
                        WfLocalePipe,
                    ],
                    styles: [".title-content{color:#000;display:inline-flex;align-items:center;line-height:1.375rem;position:relative;overflow:hidden;padding:0 0 0 1rem;min-width:760px}.title-content ::before{content:'';width:.25rem;height:1.125rem;background:#59a1ff;border-radius:1px;position:absolute;top:50%;left:0;margin-top:-.5625rem}.title-text{font-size:1rem;line-height:1.375rem;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;margin-bottom:0;margin-right:10px}.title-line{flex-grow:1;border-bottom:1px dashed rgba(0,0,0,.1)}.link{color:#1206bb;font-size:14px}.link:hover{color:#5d478b;font-size:14px}"]
                }] }
    ];
    /** @nocollapse */
    TimeLimitControlComponent.ctorParameters = function () { return [
        { type: ComponentFactoryResolver },
        { type: Injector },
        { type: BsModalService },
        { type: MessagerService },
        { type: ChangeDetectorRef, decorators: [{ type: Optional }] },
        { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
        { type: undefined, decorators: [{ type: Inject, args: [WF_LANG_RESOURCES,] }] },
        { type: WfLocalePipe, decorators: [{ type: Optional }] }
    ]; };
    TimeLimitControlComponent.propDecorators = {
        cls: [{ type: HostBinding, args: ['class',] }],
        closeModal: [{ type: Output }],
        submitModal: [{ type: Output }],
        value: [{ type: Input }],
        editorParams: [{ type: Input }],
        modalFooter: [{ type: ViewChild, args: ['iconSelectFooter',] }],
        cell: [{ type: ViewChild, args: ['cell',] }],
        grid: [{ type: ViewChild, args: ['grid',] }]
    };
    return TimeLimitControlComponent;
}());
var TimeLimitControlConverter = /** @class */ (function () {
    function TimeLimitControlConverter(localePipe) {
        this.localePipe = localePipe;
    }
    /**
     * @param {?} data
     * @return {?}
     */
    TimeLimitControlConverter.prototype.convertTo = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        if (data && data.enable) {
            return this.localePipe.transform("component.timeLimitControl.set");
        }
        else {
            return this.localePipe.transform("component.timeLimitControl.notSet");
        }
    };
    return TimeLimitControlConverter;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var MessageNotice$1 = /** @class */ (function () {
    function MessageNotice$$1() {
        /**
         * 接收人列表
         */
        this.receivers = new Array();
        this.id = ProcessDeUtil.GenerateElementId();
        this.subject = '消息通知';
        // this.sendType = 'email';
        this.content = "{\"expr\":\"'\u60A8\u6709\u4E00\u6761\u6D88\u606F\u901A\u77E5\u3002'\",\"sexpr\":\"\"}";
    }
    return MessageNotice$$1;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var MessageReceiver = /** @class */ (function () {
    function MessageReceiver() {
    }
    return MessageReceiver;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var ActivityListComponent = /** @class */ (function () {
    function ActivityListComponent(designerUIState, message, cdr, localeId, resources, localePipe) {
        this.designerUIState = designerUIState;
        this.message = message;
        this.cdr = cdr;
        this.localeId = localeId;
        this.resources = resources;
        this.localePipe = localePipe;
        this.closeEmitter = new EventEmitter();
        this.submitEmitter = new EventEmitter();
        this.multiSelect = true;
        this.showCheckbox = true;
        this.data = new Array();
        this.columns = [
            { title: this.localePipe.transform('component.activityList.name'), field: 'Name', width: 60 },
            { title: 'ID', field: 'Id', width: 90 }
        ];
        this.localePipe = this.localePipe || new WfLocalePipe(localeId, resources);
    }
    /**
     * @return {?}
     */
    ActivityListComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        this.data = this.designerUIState.userActList;
    };
    /**
     * @return {?}
     */
    ActivityListComponent.prototype.clickOK = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var result = this.grid.checkeds;
        if (!result || result.length === 0) {
            this.message.info(this.localePipe.transform('component.activityList.checkeds'));
            return;
        }
        this.submitEmitter.emit(result);
    };
    /**
     * @return {?}
     */
    ActivityListComponent.prototype.clickCancel = /**
     * @return {?}
     */
    function () {
        this.closeEmitter.emit();
    };
    ActivityListComponent.decorators = [
        { type: Component, args: [{
                    selector: 'lib-activity-list',
                    template: "<div class=\"f-page\">\r\n  <div class=\"f-page-main f-utils-fill-flex-column h-100\">\r\n    <div class=\"f-utils-fill-flex-column farris-overflow-y-auto h-100\">\r\n      <farris-datagrid #grid [data]=\"data\" [columns]=\"columns\" [idField]=\"'Id'\" [fit]=\"true\" [fitColumns]=\"true\"\r\n         [pagination]=\"false\" [showCheckbox]=\"showCheckbox\" [multiSelect]=\"multiSelect\" [showLineNumber]=\"true\" lineNumberTitle=\"{{'component.activityList.checkeds' | wfLocale}}\"\r\n         [lineNumberWidth]=\"50\" [checkOnSelect]=\"true\" [selectOnCheck]=\"true\">\r\n      </farris-datagrid>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #buttonRef>\r\n    <button type=\"button\" class=\"btn btn-secondary btn-sm px-3\" (click)=\"clickCancel()\">{{'component.activityList.clickCancel' | wfLocale}}</button>\r\n    <button type=\"button\" class=\"btn btn-primary btn-sm px-3 mx-2\" (click)=\"clickOK()\">{{'component.activityList.clickOK' | wfLocale}}</button>\r\n</ng-template>\r\n",
                    providers: [
                        WfLocalePipe,
                    ],
                    styles: [""]
                }] }
    ];
    /** @nocollapse */
    ActivityListComponent.ctorParameters = function () { return [
        { type: ProcessDesignerUIState },
        { type: MessagerService },
        { type: ChangeDetectorRef, decorators: [{ type: Optional }] },
        { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
        { type: undefined, decorators: [{ type: Inject, args: [WF_LANG_RESOURCES,] }] },
        { type: WfLocalePipe, decorators: [{ type: Optional }] }
    ]; };
    ActivityListComponent.propDecorators = {
        closeEmitter: [{ type: Output }],
        submitEmitter: [{ type: Output }],
        buttonRef: [{ type: ViewChild, args: ['buttonRef',] }],
        grid: [{ type: ViewChild, args: ['grid',] }]
    };
    return ActivityListComponent;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var PerformerEntity = /** @class */ (function () {
    function PerformerEntity(id, name, type) {
        this.id = '_' + ProcessDeUtil.GenerateElementId();
        this.performerId = id;
        this.performerName = name;
        this.type = type;
    }
    return PerformerEntity;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var PositionPerformerEntity = /** @class */ (function (_super) {
    __extends(PositionPerformerEntity, _super);
    function PositionPerformerEntity() {
        return _super.call(this) || this;
    }
    return PositionPerformerEntity;
}(PerformerEntity));

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var PositionsNamePipe = /** @class */ (function () {
    function PositionsNamePipe() {
    }
    /**
     * @param {?} positions
     * @param {?=} defaultVal
     * @return {?}
     */
    PositionsNamePipe.prototype.transform = /**
     * @param {?} positions
     * @param {?=} defaultVal
     * @return {?}
     */
    function (positions, defaultVal) {
        if (defaultVal === void 0) { defaultVal = ''; }
        /** @type {?} */
        var r = '';
        console.log(positions);
        positions.forEach((/**
         * @param {?} u
         * @return {?}
         */
        function (u) {
            r += u.performerName + '，';
        }));
        if (r) {
            r = r.substring(0, r.length - 1);
        }
        console.log(r);
        return r ? r : defaultVal;
    };
    PositionsNamePipe.decorators = [
        { type: Pipe, args: [{ name: 'positionsName' },] }
    ];
    /** @nocollapse */
    PositionsNamePipe.ctorParameters = function () { return []; };
    return PositionsNamePipe;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var PositionPerformerComponent = /** @class */ (function () {
    function PositionPerformerComponent(designerUIState, expr, ngZone, resolver, injector, modalService, cdr, localeId, resources, localePipe, positionsNamePipe) {
        this.designerUIState = designerUIState;
        this.expr = expr;
        this.ngZone = ngZone;
        this.resolver = resolver;
        this.injector = injector;
        this.modalService = modalService;
        this.cdr = cdr;
        this.localeId = localeId;
        this.resources = resources;
        this.localePipe = localePipe;
        this.positionsNamePipe = positionsNamePipe;
        this.cls = 'd-flex flex-fill h-100';
        this.closeEmitter = new EventEmitter();
        this.submitEmitter = new EventEmitter();
        this.showClearButton = false;
        this.isRequired = false;
        this.groupIcon = '<i class="f-icon f-icon-lookup"></i>';
        this.positionTypes = [
            { value: '0', text: this.localePipe.transform('component.positionPerformer.orgPosition') },
            { value: '1', text: this.localePipe.transform('component.positionPerformer.generalPosition') }
        ];
        this.performerName = '';
        this.style = { background: '#FFF' };
        this.newFilter = {};
        this.treeFilter = {};
        this.curPosIdList = [];
        this.editState = true;
        this.showCondition = true;
        this.positions = [];
        this.localePipe = this.localePipe || new WfLocalePipe(localeId, resources);
        this.position = this.position || new PositionPerformerEntity();
        this.performerName = this.performerName || (this.positions && this.positions.length ? this.positionsNamePipe.transform(this.positions) : this.position.performerName || '');
        if (this.designerUIState.scene === 'inSuite') {
            this.position.positionType = '1';
            this.newFilter = { positionType: '1' };
            this.style = { background: '#FFF', height: '150px' };
        }
    }
    /**
     * @return {?}
     */
    PositionPerformerComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.designerUIState.getOrgConfig().subscribe((/**
         * @param {?} re
         * @return {?}
         */
        function (re) {
            if (re && re.currentValue === 'true') {
                _this.isRequired = true;
            }
        }));
    };
    /**
     * @return {?}
     */
    PositionPerformerComponent.prototype.ngAfterViewInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.ngZone.runOutsideAngular((/**
         * @return {?}
         */
        function () {
            _this.inputGroup.nativeElement.addEventListener('mouseenter', _this.onMouseEnter.bind(_this));
            _this.inputGroup.nativeElement.addEventListener('mouseleave', _this.onMouseLeave.bind(_this));
        }));
    };
    /**
     * @param {?} event
     * @return {?}
     */
    PositionPerformerComponent.prototype.onMouseEnter = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        this.showClearButton = true;
        if (this.showClearButton) {
            this.toggleClearIcon(event, true);
        }
    };
    /**
     * @param {?} event
     * @return {?}
     */
    PositionPerformerComponent.prototype.onMouseLeave = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        this.showClearButton = false;
        this.toggleClearIcon(event, false);
    };
    /**
     * @private
     * @param {?} event
     * @param {?=} isShow
     * @return {?}
     */
    PositionPerformerComponent.prototype.toggleClearIcon = /**
     * @private
     * @param {?} event
     * @param {?=} isShow
     * @return {?}
     */
    function (event, isShow) {
        if (isShow === void 0) { isShow = false; }
        /** @type {?} */
        var str = isShow ? '' : 'none';
        /** @type {?} */
        var clearIcon = event.target.querySelector('.input-group-clear');
        if (clearIcon) {
            clearIcon.style.display = str;
        }
    };
    /**
     * @return {?}
     */
    PositionPerformerComponent.prototype.clickOK = /**
     * @return {?}
     */
    function () {
        this.submitEmitter.emit(this.position);
    };
    /**
     * @return {?}
     */
    PositionPerformerComponent.prototype.clickCancel = /**
     * @return {?}
     */
    function () {
        this.closeEmitter.emit();
    };
    /**
     * @return {?}
     */
    PositionPerformerComponent.prototype.clear = /**
     * @return {?}
     */
    function () {
        this.position.performerId = null;
        this.position.performerName = null;
        this.performerName = '';
    };
    /**
     * @param {?} data
     * @return {?}
     */
    PositionPerformerComponent.prototype.positionTypeChange = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        if (data.value === '0') {
            this.newFilter = { positionType: '0' };
            this.positionType = '0';
        }
        else {
            this.newFilter = { positionType: '1' };
            this.positionType = '1';
        }
        this.clear();
        this.position.orgType = null;
        this.position.orgId = null;
    };
    /**
     * @return {?}
     */
    PositionPerformerComponent.prototype.selectOrganition = /**
     * @return {?}
     */
    function () {
        var _this = this;
        var e_1, _a, e_2, _b, e_3, _c;
        // this.expr.clearContext();
        if (this.position.positionType === '1') {
            if (this.designerUIState.schemas.length > 0) {
                try {
                    for (var _d = __values(this.designerUIState.schemas), _e = _d.next(); !_e.done; _e = _d.next()) {
                        var schema = _e.value;
                        this.expr.addSchema('Schema', schema);
                    }
                }
                catch (e_1_1) { e_1 = { error: e_1_1 }; }
                finally {
                    try {
                        if (_e && !_e.done && (_a = _d.return)) _a.call(_d);
                    }
                    finally { if (e_1) throw e_1.error; }
                }
                if (this.designerUIState.schemas[0].entityTypes && this.designerUIState.schemas[0].entityTypes.length > 0) {
                    /** @type {?} */
                    var entityType = this.designerUIState.schemas[0].entityTypes[0];
                    this.expr.addInjectedEntity(entityType.name, 'Schema', entityType.name, InjectedType.EntityType);
                }
            }
            /** @type {?} */
            var context_2 = new Array();
            if (this.designerUIState.subActivityContext.length > 0) {
                var _loop_1 = function (variable) {
                    if (!context_2.some((/**
                     * @param {?} c
                     * @return {?}
                     */
                    function (c) { return c.key === variable.key; }))) {
                        context_2.push(variable);
                    }
                };
                try {
                    for (var _f = __values(this.designerUIState.subActivityContext), _g = _f.next(); !_g.done; _g = _f.next()) {
                        var variable = _g.value;
                        _loop_1(variable);
                    }
                }
                catch (e_2_1) { e_2 = { error: e_2_1 }; }
                finally {
                    try {
                        if (_g && !_g.done && (_b = _f.return)) _b.call(_f);
                    }
                    finally { if (e_2) throw e_2.error; }
                }
            }
            if (context_2.length > 0) {
                try {
                    for (var context_1 = __values(context_2), context_1_1 = context_1.next(); !context_1_1.done; context_1_1 = context_1.next()) {
                        var v = context_1_1.value;
                        this.expr.addContext(v);
                    }
                }
                catch (e_3_1) { e_3 = { error: e_3_1 }; }
                finally {
                    try {
                        if (context_1_1 && !context_1_1.done && (_c = context_1.return)) _c.call(context_1);
                    }
                    finally { if (e_3) throw e_3.error; }
                }
            }
            this.expr.setEditPattern(ExprEditMode.Advanced);
            this.expr.addExpressionText(this.position.orgId);
            this.expr.buildExpression().then((/**
             * @param {?} expr
             * @return {?}
             */
            function (expr) {
                _this.position.orgId = expr;
                //点击确定后，去除表达式里面的新增的上下文变量
                if (context_2.length > 0) {
                    _this.expr.exprEntity.contextEntities = _this.expr.exprEntity.contextEntities.filter((/**
                     * @param {?} x
                     * @return {?}
                     */
                    function (x) { return !context_2.some((/**
                     * @param {?} y
                     * @return {?}
                     */
                    function (y) { return y.key === x.key; })); }));
                }
            }));
        }
    };
    /**
     * @return {?}
     */
    PositionPerformerComponent.prototype.selectPosition = /**
     * @return {?}
     */
    function () {
        this.setPosition();
    };
    /**
     * @return {?}
     */
    PositionPerformerComponent.prototype.editCondition = /**
     * @return {?}
     */
    function () {
        var _this = this;
        var e_4, _a, e_5, _b, e_6, _c, e_7, _d;
        // this.expr.clearContext();
        if (this.designerUIState.schemas.length > 0) {
            try {
                for (var _e = __values(this.designerUIState.schemas), _f = _e.next(); !_f.done; _f = _e.next()) {
                    var schema = _f.value;
                    this.expr.addSchema('Schema', schema);
                }
            }
            catch (e_4_1) { e_4 = { error: e_4_1 }; }
            finally {
                try {
                    if (_f && !_f.done && (_a = _e.return)) _a.call(_e);
                }
                finally { if (e_4) throw e_4.error; }
            }
            if (this.designerUIState.schemas[0].entityTypes && this.designerUIState.schemas[0].entityTypes.length > 0) {
                /** @type {?} */
                var entityType = this.designerUIState.schemas[0].entityTypes[0];
                this.expr.addInjectedEntity(entityType.name, 'Schema', entityType.name, InjectedType.EntityType);
            }
        }
        /** @type {?} */
        var context = new Array();
        context = this.designerUIState.addContext(context);
        if (this.designerUIState.subActivityContext.length > 0) {
            var _loop_2 = function (variable) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    context.push(variable);
                }
            };
            try {
                for (var _g = __values(this.designerUIState.subActivityContext), _h = _g.next(); !_h.done; _h = _g.next()) {
                    var variable = _h.value;
                    _loop_2(variable);
                }
            }
            catch (e_5_1) { e_5 = { error: e_5_1 }; }
            finally {
                try {
                    if (_h && !_h.done && (_b = _g.return)) _b.call(_g);
                }
                finally { if (e_5) throw e_5.error; }
            }
        }
        if (this.designerUIState.activityComponentContext.length > 0) {
            var _loop_3 = function (variable) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    context.push(variable);
                }
            };
            try {
                for (var _j = __values(this.designerUIState.activityComponentContext), _k = _j.next(); !_k.done; _k = _j.next()) {
                    var variable = _k.value;
                    _loop_3(variable);
                }
            }
            catch (e_6_1) { e_6 = { error: e_6_1 }; }
            finally {
                try {
                    if (_k && !_k.done && (_c = _j.return)) _c.call(_j);
                }
                finally { if (e_6) throw e_6.error; }
            }
        }
        if (context.length > 0) {
            try {
                for (var context_3 = __values(context), context_3_1 = context_3.next(); !context_3_1.done; context_3_1 = context_3.next()) {
                    var v = context_3_1.value;
                    this.expr.addContext(v);
                }
            }
            catch (e_7_1) { e_7 = { error: e_7_1 }; }
            finally {
                try {
                    if (context_3_1 && !context_3_1.done && (_d = context_3.return)) _d.call(context_3);
                }
                finally { if (e_7) throw e_7.error; }
            }
        }
        this.expr.setEditPattern(ExprEditMode.Conditional); // 表达式展现模式：默认简易版
        this.expr.addExpressionText(this.position.condition);
        this.expr.buildExpression().then((/**
         * @param {?} expressioninfo
         * @return {?}
         */
        function (expressioninfo) {
            var e_8, _a;
            _this.position.condition = expressioninfo;
            try {
                for (var _b = __values(_this.positions), _c = _b.next(); !_c.done; _c = _b.next()) {
                    var p = _c.value;
                    p.condition = expressioninfo;
                }
            }
            catch (e_8_1) { e_8 = { error: e_8_1 }; }
            finally {
                try {
                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                }
                finally { if (e_8) throw e_8.error; }
            }
            //点击确定后，去除表达式里面的新增的上下文变量
            if (context.length > 0) {
                _this.expr.exprEntity.contextEntities = _this.expr.exprEntity.contextEntities.filter((/**
                 * @param {?} x
                 * @return {?}
                 */
                function (x) { return !context.some((/**
                 * @param {?} y
                 * @return {?}
                 */
                function (y) { return y.key === x.key; })); }));
            }
        }));
    };
    /**
     * @param {?} re
     * @return {?}
     */
    PositionPerformerComponent.prototype.orgTypeChange = /**
     * @param {?} re
     * @return {?}
     */
    function (re) {
        this.position.orgType = re.data.value;
    };
    /**
     * @return {?}
     */
    PositionPerformerComponent.prototype.clearOrgType = /**
     * @return {?}
     */
    function () {
        this.position.orgType = null;
    };
    /**
     * @param {?} data
     * @return {?}
     */
    PositionPerformerComponent.prototype.positionsSelected = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        var e_9, _a;
        this.positions = [];
        if (data || data.data.length > 0) {
            /** @type {?} */
            var positions = [];
            try {
                for (var _b = __values(data.data), _c = _b.next(); !_c.done; _c = _b.next()) {
                    var dataSelected = _c.value;
                    if (this.editState) {
                        this.position = new PositionPerformerEntity();
                        this.position.performerId = dataSelected.id;
                        this.position.performerName = dataSelected.name;
                        this.position.type = 'wf.PositionParticipantExpression';
                        if (!this.position.positionType) {
                            this.position.positionType = dataSelected.posType + '';
                            this.newFilter = {
                                positionType: dataSelected.posType
                            };
                        }
                        this.position.isRequired = this.isRequired;
                        this.position.condition = this.condition ? this.condition : "";
                        positions.push(this.position);
                    }
                    else {
                        this.position.performerId = dataSelected.id;
                        this.position.performerName = dataSelected.name;
                        this.position.type = 'wf.PositionParticipantExpression';
                        if (!this.position.positionType) {
                            this.position.positionType = dataSelected.posType + '';
                            this.newFilter = {
                                positionType: dataSelected.posType
                            };
                        }
                        this.position.isRequired = this.isRequired;
                        this.position.condition = this.condition ? this.condition : "";
                        positions.push(this.position);
                    }
                }
            }
            catch (e_9_1) { e_9 = { error: e_9_1 }; }
            finally {
                try {
                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                }
                finally { if (e_9) throw e_9.error; }
            }
            this.positions = __spread(positions);
            this.performerName = this.positions && this.positions.length ? (this.positionsNamePipe.transform(this.positions)) : (this.position.performerName ? this.position.performerName : '');
        }
    };
    /**
     * @return {?}
     */
    PositionPerformerComponent.prototype.setPosition = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.positions = [];
        /** @type {?} */
        var compFactory = this.resolver.resolveComponentFactory(SysLookupDetailComponent);
        /** @type {?} */
        var compRef = compFactory.create(this.injector);
        compRef.instance.initGridIdList = this.curPosIdList;
        compRef.instance.treeFilter = this.treeFilter;
        compRef.instance.listFilter = this.newFilter;
        compRef.instance.sourceType = 'position';
        compRef.instance.multiSelect = false;
        // 编辑状态下只能单选
        if (this.positionType === "0" && this.editState) {
            compRef.instance.multiSelect = true;
        }
        /** @type {?} */
        var modalConfig = {
            title: this.localePipe.transform('component.positionPerformer.sysPositions'),
            width: 1000,
            height: 550,
            showButtons: true,
            buttons: compRef.instance.btnTemplateRef,
            showMaxButton: true,
            resizable: false
        };
        /** @type {?} */
        var dialog = this.modalService.show(compRef, modalConfig);
        // 取消后
        compRef.instance.afterCancle.subscribe((/**
         * @param {?} res
         * @return {?}
         */
        function (res) {
            // 消失模态框
            dialog.close();
        }));
        // 确认后
        compRef.instance.afterConfirm.subscribe((/**
         * @param {?} res
         * @return {?}
         */
        function (res) {
            _this.positionsSelected(res);
        }));
    };
    /**
     * @return {?}
     */
    PositionPerformerComponent.prototype.getPerformers = /**
     * @return {?}
     */
    function () {
        if (!this.editState) {
            this.positions.push(this.position);
        }
        return this.positions;
    };
    PositionPerformerComponent.decorators = [
        { type: Component, args: [{
                    selector: 'app-position-performer',
                    template: "<div class=\"d-flex flex-fill farris-overflow-y-auto p-md-2\" style=\"background: #FFF;\">\r\n  <div class=\"d-flex flex-fill farris-overflow-y-auto mx-3 my-2\" style=\"border-radius:16px;border: 1.5px solid #F1F3F7;\">\r\n  <form style=\"width: 100%;\">\r\n    <div class=\"d-flex m-2 flex-column w-100\" style=\"margin-top: 20px!important;\">\r\n      <div class=\"d-flex flex-column\" [ngStyle]=\"style\">\r\n        <div class=\"farris-form form-inline  farris-form-inline mr-5\">\r\n          <div *ngIf=\"designerUIState.scene!=='inSuite'\" class=\"col-12 farris-group-auto my-3\">\r\n            <div class=\"farris-group-wrap\">\r\n              <div class=\"form-group farris-form-group\">\r\n                <label class=\"col-form-label\">\r\n                  <span class=\"farris-label-text\">{{'component.positionPerformer.positionType'|wfLocale}}</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap\">\r\n                  <farris-combo-list [(ngModel)]=\"position.positionType\" name=\"positionType\" [panelHeight]=\"'auto'\" [idField]=\"'value'\"\r\n                    [textField]=\"'text'\" [data]=\"positionTypes\" (valueChange)=\"positionTypeChange($event)\"\r\n                    [panelHeight]=\"'auto'\" [enableClear]=\"false\">\r\n                  </farris-combo-list>\r\n                  <div class=\"farris-feedback valid-feedback\"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"col-12 farris-group-auto my-4\">\r\n            <div class=\"farris-group-wrap\">\r\n              <div class=\"form-group farris-form-group\">\r\n                <label class=\"col-form-label\">\r\n                  <span class=\"farris-label-info text-danger\">*</span>\r\n                  <span class=\"farris-label-text\">{{designerUIState.scene==='inSuite'?('component.positionPerformer.role'|wfLocale):('component.positionPerformer.position'|wfLocale)}}</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap\">\r\n                  <div #inputGroup class=\"input-group\">\r\n                    <input type=\"text\" class=\"form-control\" [(ngModel)]=\"performerName\" name=\"positionName\" [readOnly]=\"true\" />\r\n                    <div class=\"input-group-append\">\r\n                      <span [style.display]=\"showClearButton ? '' : 'none'\" class=\"input-group-text input-group-clear\" (click)=\"clear()\">\r\n                        <i class=\"f-icon modal_close\"></i>\r\n                      </span>\r\n                      <span class=\"input-group-text\" (click)=\"selectPosition()\" style=\"background: #FFF;\">\r\n                        <i class=\"f-icon f-icon-lookup\"></i>\r\n                      </span>\r\n                    </div>\r\n                  </div>\r\n                  <div class=\"farris-feedback valid-feedback\"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div *ngIf=\"designerUIState.scene!=='inSuite' && position.positionType === '1'\" class=\"col-12 farris-group-auto my-4\">\r\n            <div class=\"farris-group-wrap\">\r\n              <div class=\"form-group farris-form-group\">\r\n                <label class=\"col-form-label\">\r\n                  <ng-container *ngIf=\"isRequired&&position.positionType==='1'\">\r\n                    <span class=\"farris-label-info text-danger\">*</span>\r\n                  </ng-container>\r\n                  <span class=\"farris-label-text\">{{'component.positionPerformer.sysType'|wfLocale}}</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap\">\r\n                  <farris-combo-list [(ngModel)]=\"position.orgType\" name=\"orgType\" [idField]=\"'value'\" [textField]=\"'text'\" [valueField]=\"'value'\"\r\n                    [data]=\"designerUIState.orgTypeCollection\" [panelHeight]=\"'auto'\" (clear)=\"clearOrgType()\"\r\n                    (selectChange)='orgTypeChange($event)' [readonly]=\"!(position.positionType==='1')\" placeholder=\"{{position.positionType==='1'?('component.positionPerformer.placeholder'|wfLocale):''}}\">\r\n                  </farris-combo-list>\r\n                  <div class=\"farris-feedback valid-feedback\"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div *ngIf=\"designerUIState.scene!=='inSuite' && position.positionType === '1'\" class=\"col-12 farris-group-auto my-4\">\r\n            <div class=\"farris-group-wrap\">\r\n              <div class=\"form-group farris-form-group\">\r\n                <label class=\"col-form-label\">\r\n                  <ng-container *ngIf=\"isRequired&&position.positionType==='1'\">\r\n                    <span class=\"farris-label-info text-danger\">*</span>\r\n                  </ng-container>\r\n                  <span class=\"farris-label-text\">{{'component.positionPerformer.orgId'|wfLocale}}</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap\">\r\n                  <input-group class=\"form-control\" style=\"width: 100%;padding:0;border:0;\" [enableClear]=\"false\"\r\n                    [showButtonWhenDisabled]=\"false\" [readonly]=\"!(position.positionType==='1')\"\r\n                    [(ngModel)]=\"position.orgId\" name=\"organization\" placeholder=\"{{position.positionType==='1'?('component.positionPerformer.placeholder'|wfLocale):''}}\"\r\n                    [editable]=\"false\" (clickHandle)=\"selectOrganition()\" [groupText]=\"groupIcon\"></input-group>\r\n                  <div class=\"farris-feedback valid-feedback\"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div *ngIf=\"showCondition\" class=\"d-flex flex-column\" style=\"background: #FFF;\">\r\n        <div class=\"farris-form form-inline farris-form-inline mr-5\">\r\n          <div class=\"col-12 farris-group-auto my-3\">\r\n            <div class=\"farris-group-wrap\">\r\n              <div class=\"form-group farris-form-group\">\r\n                <label class=\"col-form-label\">\r\n                  <span class=\"farris-label-text\">{{'component.positionPerformer.condition'|wfLocale}}</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap\">\r\n                  <div class=\"input-group\">\r\n                    <input type=\"text\" class=\"form-control\" [(ngModel)]=\"this.position.condition\" name=\"conditon\" [readOnly]=\"true\" />\r\n                    <div class=\"input-group-append\">\r\n                      <span class=\"input-group-text\" (click)=\"editCondition()\" style=\"background: #FFF;\">\r\n                        <i class=\"f-icon f-icon-lookup\"></i>\r\n                      </span>\r\n                    </div>\r\n                  </div>\r\n                  <div class=\"farris-feedback valid-feedback\"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </form>\r\n</div>\r\n</div>\r\n\r\n<ng-template #buttonRef>\r\n  <button type=\"button\" class=\"btn btn-secondary btn-sm px-3\" (click)=\"clickCancel()\">{{'component.positionPerformer.clickCancel'|wfLocale}}</button>\r\n  <button type=\"button\" class=\"btn btn-primary btn-sm px-3 mx-2\" (click)=\"clickOK()\">{{'component.positionPerformer.clickOK'|wfLocale}}</button>\r\n</ng-template>\r\n",
                    providers: [
                        WfLocalePipe,
                    ],
                    styles: [""]
                }] }
    ];
    /** @nocollapse */
    PositionPerformerComponent.ctorParameters = function () { return [
        { type: ProcessDesignerUIState },
        { type: ExpressionService },
        { type: NgZone },
        { type: ComponentFactoryResolver },
        { type: Injector },
        { type: BsModalService },
        { type: ChangeDetectorRef, decorators: [{ type: Optional }] },
        { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
        { type: undefined, decorators: [{ type: Inject, args: [WF_LANG_RESOURCES,] }] },
        { type: WfLocalePipe, decorators: [{ type: Optional }] },
        { type: PositionsNamePipe }
    ]; };
    PositionPerformerComponent.propDecorators = {
        cls: [{ type: HostBinding, args: ['class',] }],
        closeEmitter: [{ type: Output }],
        submitEmitter: [{ type: Output }],
        posiHelp: [{ type: ViewChild, args: [SysFarrisLookupComponent,] }],
        buttonRef: [{ type: ViewChild, args: ['buttonRef',] }],
        inputGroup: [{ type: ViewChild, args: ['inputGroup',] }]
    };
    return PositionPerformerComponent;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var MessageNoticeEditComponent = /** @class */ (function () {
    function MessageNoticeEditComponent(message, uistate, expr, resolver, injector, modalService, designerUIState, http, cdr, localeId, resources, localePipe) {
        var _this = this;
        this.message = message;
        this.uistate = uistate;
        this.expr = expr;
        this.resolver = resolver;
        this.injector = injector;
        this.modalService = modalService;
        this.designerUIState = designerUIState;
        this.http = http;
        this.cdr = cdr;
        this.localeId = localeId;
        this.resources = resources;
        this.localePipe = localePipe;
        this.groupIcon2 = '<i class="f-icon f-icon-lookup"></i>';
        this.exprAble = false;
        this.closeEmitter = new EventEmitter();
        this.submitEmitter = new EventEmitter();
        this._location = 'activity';
        this.messageNotice = new MessageNotice$1();
        this.typeGroup = this.uistate.messageChannels.map((/**
         * @param {?} m
         * @return {?}
         */
        function (m) { return ({ value: m.code, name: m.name }); }));
        this.receiverVariables = [
            { value: 'workItemParticipant', name: this.localePipe.transform('component.messageNoticeEdit.workItemParticipant') }
        ];
        this.variableOrgTypes = [
            { name: this.localePipe.transform('component.messageNoticeEdit.sys'), value: 'Sys' },
            { name: this.localePipe.transform('component.messageNoticeEdit.administrative_organization'), value: 'Administrative_organization' }
        ];
        this.sendTimes = [];
        this.bindingData = {};
        this.receiverTypes = [
            { value: 'processParticipant', text: this.localePipe.transform('component.MessageNotice.processParticipant') },
            { value: 'variableParticipant', text: this.localePipe.transform('component.MessageNotice.variableParticipant') },
            { value: 'userParticipant', text: this.localePipe.transform('component.MessageNotice.userParticipant') },
            { value: 'positionParticipant', text: this.localePipe.transform('component.MessageNotice.positionParticipant') },
        ];
        this.processParticipantTypes = [
            { value: 'procInstCreator', text: this.localePipe.transform('component.MessageNotice.procInstCreator') },
            { value: 'workItemParticipant', text: this.localePipe.transform('component.MessageNotice.workItemParticipant') },
            { value: 'activityExecutorParticipant', text: this.localePipe.transform('component.MessageNotice.activityExecutorParticipant') },
        ];
        this.userTypeButtonNeedShow = false; // 用户类型单选按钮是否需要显示
        this.hasSmsTemplate = false;
        this.disableAdd = (/**
         * @return {?}
         */
        function () {
            if (_this.messageNotice.sendTime === 'WORKITEM_CREATED' && _this.messageNotice.receivers.filter((/**
             * @param {?} r
             * @return {?}
             */
            function (r) { return r.type; })).length > 0) {
                return true;
            }
            else {
                return false;
            }
        });
        // 由于需要实现国际化，此处定义不能提取；
        this.processSendTime = [
            { value: 'PROCESSINSTANCE_COMPLETED', text: this.localePipe.transform('component.MessageNotice.procComplete') },
            { value: 'PROCESSINSTANCE_ABORTED', text: this.localePipe.transform('component.MessageNotice.procAborted') },
            { value: 'PROCESSINSTANCE_ROLLBACK', text: this.localePipe.transform('component.MessageNotice.procRollBack') }
        ];
        this.ReceiverType = [
            { value: 'processParticipant', text: this.localePipe.transform('component.MessageNotice.processParticipant') },
            { value: 'variableParticipant', text: this.localePipe.transform('component.MessageNotice.variableParticipant') },
            { value: 'userParticipant', text: this.localePipe.transform('component.MessageNotice.userParticipant') },
            { value: 'positionParticipant', text: this.localePipe.transform('component.MessageNotice.positionParticipant') },
        ];
        this.activitySendTime = [
            { value: 'WORKITEM_CREATED', text: this.localePipe.transform('component.MessageNotice.workCreated') },
            { value: 'ACTIVITY_COMPLETED', text: this.localePipe.transform('component.MessageNotice.actComplete') },
            { value: 'ACTIVITY_ABORTED', text: this.localePipe.transform('component.MessageNotice.actAborted') },
        ];
        this.localePipe = this.localePipe || new WfLocalePipe(localeId, resources);
    }
    Object.defineProperty(MessageNoticeEditComponent.prototype, "location", {
        get: /**
         * @return {?}
         */
        function () {
            return this._location;
        },
        set: /**
         * @param {?} l
         * @return {?}
         */
        function (l) {
            this._location = l;
            if (this.location !== 'activity') {
                this.processParticipantTypes = [
                    { value: 'procInstCreator', text: this.localePipe.transform('component.messageNoticeEdit.procInstCreator') },
                    { value: 'activityExecutorParticipant', text: this.localePipe.transform('component.messageNoticeEdit.activityExecutorParticipant') }
                ];
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(MessageNoticeEditComponent.prototype, "value", {
        get: /**
         * @return {?}
         */
        function () {
            return this.messageNotice;
        },
        set: /**
         * @param {?} m
         * @return {?}
         */
        function (m) {
            // 深拷贝处理messageNotice 2022-12-1
            /** @type {?} */
            var jsonMessageNotice = JSON.stringify(Object.assign({}, m));
            this.messageNotice = JSON.parse(jsonMessageNotice);
            this.exprAble = this.messageNotice.subject.charAt(0) === '{';
            if (this.hasSmsMessage(this.messageNotice.sendType)) {
                this.hasSmsTemplate = true;
                if (!this.messageNotice.smsMessageTemplate) {
                    this.messageNotice.smsMessageTemplate = new SmsMessageTemplate$1();
                }
            }
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    MessageNoticeEditComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        if (this.location === 'activity') {
            this.sendTimes = this.activitySendTime;
            if (this.messageNotice.sendTime === this.activitySendTime[0].value) {
                this.receiverTypes = [
                    { value: 'processParticipant', text: this.localePipe.transform('component.messageNoticeEdit.processParticipant') }
                ];
                this.processParticipantTypes = [
                    { value: 'workItemParticipant', text: this.localePipe.transform('component.messageNoticeEdit.workItemReceiveParticipant') }
                ];
            }
            else {
                this.receiverTypes = [
                    { value: 'processParticipant', text: this.localePipe.transform('component.messageNoticeEdit.processParticipant') },
                    { value: 'variableParticipant', text: this.localePipe.transform('component.messageNoticeEdit.variableParticipant') },
                    { value: 'userParticipant', text: this.localePipe.transform('component.messageNoticeEdit.userParticipant') },
                    { value: 'positionParticipant', text: this.localePipe.transform('component.messageNoticeEdit.positionParticipant') },
                ];
                this.processParticipantTypes = [
                    { value: 'procInstCreator', text: this.localePipe.transform('component.messageNoticeEdit.procInstCreator') },
                    { value: 'activityExecutorParticipant', text: this.localePipe.transform('component.messageNoticeEdit.activityExecutorParticipant') }
                ];
            }
        }
        else {
            this.sendTimes = this.processSendTime;
        }
        /** @type {?} */
        var url = '/api/runtime/wf/v1.0/reportingOrgType/hasAdminOrg';
        this.http.get(url).subscribe((/**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            _this.hasAdminOrg = data;
            // inSuite场景，变量参与者场景下显示用户类型
            if (_this.designerUIState.scene === 'inSuite') {
                _this.userTypeButtonNeedShow = true;
            }
            else {
                _this.userTypeButtonNeedShow = data;
            }
            if (!_this.userTypeButtonNeedShow) {
                _this.variableOrgTypes = [{ name: _this.localePipe.transform('component.messageNoticeEdit.sys'), value: 'Sys' }];
            }
        }));
    };
    /**
     * @return {?}
     */
    MessageNoticeEditComponent.prototype.clickOK = /**
     * @return {?}
     */
    function () {
        if (this.SmsTemplate) {
            this.SmsTemplate.endGridEdit();
        }
        this.setReceiver();
        if (this.hasSmsTemplate) {
            this.messageNotice.smsMessageTemplate = this.SmsTemplate.smsMessageTemplate;
            if (this.messageNotice.smsMessageTemplate.smsMessageVariables && this.messageNotice.smsMessageTemplate.smsMessageVariables.length > 0) {
                this.messageNotice.smsMessageTemplate.smsMessageVariables = this.messageNotice.smsMessageTemplate.smsMessageVariables.filter((/**
                 * @param {?} variable
                 * @return {?}
                 */
                function (variable) { return variable.code; }));
            }
        }
        else {
            this.messageNotice.smsMessageTemplate = null;
        }
        if (this.validator()) {
            this.submitEmitter.emit(this.messageNotice);
        }
    };
    /**
     * @return {?}
     */
    MessageNoticeEditComponent.prototype.clickCancel = /**
     * @return {?}
     */
    function () {
        this.closeEmitter.emit();
    };
    /**
     * @param {?} data
     * @return {?}
     */
    MessageNoticeEditComponent.prototype.sendTimeChange = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        var e_1, _a;
        if (data.data.value === this.activitySendTime[0].value) {
            /** @type {?} */
            var messageReceiver = new MessageReceiver();
            messageReceiver.type = 'processParticipant';
            messageReceiver.processParticipant = 'workItemParticipant';
            this.messageNotice.receivers = [messageReceiver];
            this.receiverTypes = [
                { value: 'processParticipant', text: this.localePipe.transform('component.messageNoticeEdit.processParticipant') }
            ];
            this.processParticipantTypes = [
                { value: 'workItemParticipant', text: this.localePipe.transform('component.messageNoticeEdit.workItemParticipant') }
            ];
        }
        else {
            try {
                for (var _b = __values(this.messageNotice.receivers), _c = _b.next(); !_c.done; _c = _b.next()) {
                    var r = _c.value;
                    if (r.type === 'processParticipant' && r.processParticipant === 'workItemParticipant') {
                        r.processParticipant = 'procInstCreator';
                    }
                }
            }
            catch (e_1_1) { e_1 = { error: e_1_1 }; }
            finally {
                try {
                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                }
                finally { if (e_1) throw e_1.error; }
            }
            this.receiverTypes = [
                { value: 'processParticipant', text: this.localePipe.transform('component.messageNoticeEdit.processParticipant') },
                { value: 'variableParticipant', text: this.localePipe.transform('component.messageNoticeEdit.variableParticipant') },
                { value: 'userParticipant', text: this.localePipe.transform('component.messageNoticeEdit.userParticipant') },
                { value: 'positionParticipant', text: this.localePipe.transform('component.messageNoticeEdit.positionParticipant') },
            ];
            this.processParticipantTypes = [
                { value: 'procInstCreator', text: this.localePipe.transform('component.messageNoticeEdit.procInstCreator') },
                { value: 'activityExecutorParticipant', text: this.localePipe.transform('component.messageNoticeEdit.activityExecutorParticipant') }
            ];
        }
    };
    /**
     * @param {?} sendType
     * @return {?}
     */
    MessageNoticeEditComponent.prototype.sendTypeChange = /**
     * @param {?} sendType
     * @return {?}
     */
    function (sendType) {
        if (this.hasSmsMessage(sendType)) {
            this.hasSmsTemplate = true;
            if (!this.messageNotice.smsMessageTemplate) {
                this.messageNotice.smsMessageTemplate = new SmsMessageTemplate$1();
            }
        }
        else {
            this.hasSmsTemplate = false;
            this.messageNotice.smsMessageTemplate = null;
        }
    };
    /**
     * @private
     * @param {?} sendType
     * @return {?}
     */
    MessageNoticeEditComponent.prototype.hasSmsMessage = /**
     * @private
     * @param {?} sendType
     * @return {?}
     */
    function (sendType) {
        var _this = this;
        if (sendType) {
            /** @type {?} */
            var sendTypeList = sendType.split(',');
            /** @type {?} */
            var messageChannel = sendTypeList.find((/**
             * @param {?} val
             * @return {?}
             */
            function (val) { return _this.uistate.messageChannels.find((/**
             * @param {?} channel
             * @return {?}
             */
            function (channel) { return channel.code == val && channel.channelType == 'Sms'; })); }));
            if (messageChannel) {
                return true;
            }
            else {
                return false;
            }
        }
        else {
            return false;
        }
    };
    /**
     * @param {?} data
     * @return {?}
     */
    MessageNoticeEditComponent.prototype.usersSelect = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        var e_2, _a, e_3, _b;
        this.messageNotice.receivers[this.index].userIds = '';
        this.messageNotice.receivers[this.index].userNames = '';
        if (data && data.length > 0) {
            /** @type {?} */
            var userIds = '';
            try {
                for (var data_1 = __values(data), data_1_1 = data_1.next(); !data_1_1.done; data_1_1 = data_1.next()) {
                    var d = data_1_1.value;
                    userIds += d.id + ',';
                }
            }
            catch (e_2_1) { e_2 = { error: e_2_1 }; }
            finally {
                try {
                    if (data_1_1 && !data_1_1.done && (_a = data_1.return)) _a.call(data_1);
                }
                finally { if (e_2) throw e_2.error; }
            }
            if (userIds) {
                this.messageNotice.receivers[this.index].userIds = userIds.substring(0, userIds.length - 1);
            }
            /** @type {?} */
            var userNames = '';
            try {
                for (var data_2 = __values(data), data_2_1 = data_2.next(); !data_2_1.done; data_2_1 = data_2.next()) {
                    var d = data_2_1.value;
                    userNames += d.name + ',';
                }
            }
            catch (e_3_1) { e_3 = { error: e_3_1 }; }
            finally {
                try {
                    if (data_2_1 && !data_2_1.done && (_b = data_2.return)) _b.call(data_2);
                }
                finally { if (e_3) throw e_3.error; }
            }
            if (userNames) {
                this.messageNotice.receivers[this.index].userNames = userNames.substring(0, userNames.length - 1);
            }
        }
    };
    /**
     * @param {?} index
     * @return {?}
     */
    MessageNoticeEditComponent.prototype.clearUsers = /**
     * @param {?} index
     * @return {?}
     */
    function (index) {
        this.messageNotice.receivers[index].userIds = '';
        this.messageNotice.receivers[index].userNames = '';
    };
    /**
     * @param {?} index
     * @return {?}
     */
    MessageNoticeEditComponent.prototype.clearPosition = /**
     * @param {?} index
     * @return {?}
     */
    function (index) {
        this.messageNotice.receivers[index].positionId = '';
        this.messageNotice.receivers[index].positionName = '';
        this.messageNotice.receivers[index].positionType = '';
        this.messageNotice.receivers[index].orgId = '';
        this.messageNotice.receivers[index].orgType = '';
    };
    /**
     * @param {?} index
     * @return {?}
     */
    MessageNoticeEditComponent.prototype.clearActivityExecutor = /**
     * @param {?} index
     * @return {?}
     */
    function (index) {
        this.messageNotice.receivers[index].activityDefId = '';
        this.messageNotice.receivers[index].activityDefName = '';
    };
    /**
     * @param {?} index
     * @return {?}
     */
    MessageNoticeEditComponent.prototype.clearVariableParticipant = /**
     * @param {?} index
     * @return {?}
     */
    function (index) {
        this.messageNotice.receivers[index].variableParticipant = '';
        this.messageNotice.receivers[index].variableName = '';
    };
    /**
     * @param {?} data
     * @return {?}
     */
    MessageNoticeEditComponent.prototype.changeValue = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
    };
    /**
     * @return {?}
     */
    MessageNoticeEditComponent.prototype.clear = /**
     * @return {?}
     */
    function () {
        this.bindingData = {};
    };
    /**
     * @private
     * @return {?}
     */
    MessageNoticeEditComponent.prototype.setReceiver = /**
     * @private
     * @return {?}
     */
    function () {
    };
    /**
     * @private
     * @return {?}
     */
    MessageNoticeEditComponent.prototype.validator = /**
     * @private
     * @return {?}
     */
    function () {
        var e_4, _a;
        if (!this.messageNotice.sendType) {
            this.message.info(this.localePipe.transform('component.messageNoticeEdit.sendType'));
            return false;
        }
        //去除消息模板编号校验
        // if (this.hasSmsTemplate) {
        //   if (!this.messageNotice.smsMessageTemplate) {
        //     this.message.info(this.localePipe.transform('component.messageNoticeEdit.smsMessageTemplate'));
        //     return;
        //   }
        //   if (!this.messageNotice.smsMessageTemplate.code) {
        //     this.message.info(this.localePipe.transform('component.messageNoticeEdit.smsMessageTemplateCode'));
        //     return;
        //   }
        // }
        if (this.location !== 'messageActivity' && !this.messageNotice.sendTime) {
            this.message.info(this.localePipe.transform('component.messageNoticeEdit.sendTime'));
            return false;
        }
        if (!this.messageNotice.subject) {
            this.message.info(this.localePipe.transform('component.messageNoticeEdit.subject'));
            return false;
        }
        if (!this.messageNotice.content) {
            this.message.info(this.localePipe.transform('component.messageNoticeEdit.content'));
            return false;
        }
        this.messageNotice.receivers = this.messageNotice.receivers.filter((/**
         * @param {?} r
         * @return {?}
         */
        function (r) { return r.type; }));
        if (!this.messageNotice.receivers || this.messageNotice.receivers.length === 0) {
            this.message.info(this.localePipe.transform('component.messageNoticeEdit.receivers'));
            return false;
        }
        else {
            try {
                for (var _b = __values(this.messageNotice.receivers), _c = _b.next(); !_c.done; _c = _b.next()) {
                    var r = _c.value;
                    switch (r.type) {
                        case 'processParticipant':
                            if (!r.processParticipant) {
                                this.message.info(this.localePipe.transform('component.messageNoticeEdit.processParticipantNotNull'));
                                return false;
                            }
                            else if (r.processParticipant === 'activityExecutorParticipant' && !r.activityDefId) {
                                this.message.info(this.localePipe.transform('component.messageNoticeEdit.activityDefIdNotNull'));
                                return false;
                            }
                            break;
                        case 'variableParticipant':
                            if (!r.variableParticipant) {
                                this.message.info(this.localePipe.transform('component.messageNoticeEdit.variableParticipantNotNull'));
                                return false;
                            }
                            if (!r.orgType) {
                                this.message.info(this.localePipe.transform('component.messageNoticeEdit.orgType'));
                                return false;
                            }
                            break;
                        case 'userParticipant':
                            if (!r.userIds) {
                                this.message.info(this.localePipe.transform('component.messageNoticeEdit.userIds'));
                                return false;
                            }
                            break;
                        case 'positionParticipant':
                            if (!r.positionId) {
                                this.message.info(this.localePipe.transform('component.messageNoticeEdit.positionId'));
                                return false;
                            }
                            break;
                    }
                }
            }
            catch (e_4_1) { e_4 = { error: e_4_1 }; }
            finally {
                try {
                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                }
                finally { if (e_4) throw e_4.error; }
            }
        }
        return true;
    };
    /**
     * @return {?}
     */
    MessageNoticeEditComponent.prototype.addReceiver = /**
     * @return {?}
     */
    function () {
        if (this.disableAdd()) {
            return;
        }
        /** @type {?} */
        var receivers = this.messageNotice.receivers.filter((/**
         * @param {?} r
         * @return {?}
         */
        function (r) { return r.type; }));
        if (receivers && receivers.length > 0) {
            /** @type {?} */
            var userParticipant = new MessageReceiver();
            userParticipant.type = 'userParticipant';
            this.messageNotice.receivers = this.messageNotice.receivers.concat([userParticipant]);
        }
        else {
            if (this.location !== 'activity') {
                /** @type {?} */
                var procInstCreator = new MessageReceiver();
                procInstCreator.type = 'processParticipant';
                procInstCreator.processParticipant = 'procInstCreator';
                this.messageNotice.receivers = this.messageNotice.receivers.concat([procInstCreator]);
            }
            else {
                /** @type {?} */
                var workItemParticipant = new MessageReceiver();
                workItemParticipant.type = 'processParticipant';
                workItemParticipant.processParticipant = 'workItemParticipant';
                this.messageNotice.receivers = this.messageNotice.receivers.concat([workItemParticipant]);
            }
        }
    };
    /**
     * @param {?} activityDefId
     * @param {?} index
     * @return {?}
     */
    MessageNoticeEditComponent.prototype.selectActivityExecutorParticipant = /**
     * @param {?} activityDefId
     * @param {?} index
     * @return {?}
     */
    function (activityDefId, index) {
        var _this = this;
        /** @type {?} */
        var dialog;
        /** @type {?} */
        var compFactory = this.resolver.resolveComponentFactory(ActivityListComponent);
        /** @type {?} */
        var compRef = compFactory.create(this.injector);
        compRef.instance.submitEmitter.subscribe((/**
         * @param {?} re
         * @return {?}
         */
        function (re) {
            var e_5, _a;
            /** @type {?} */
            var acticity = re.shift();
            _this.messageNotice.receivers[index].activityDefId = acticity.id;
            _this.messageNotice.receivers[index].activityDefName = acticity.data.Name;
            if (re && re.length > 0) {
                try {
                    for (var re_1 = __values(re), re_1_1 = re_1.next(); !re_1_1.done; re_1_1 = re_1.next()) {
                        var a = re_1_1.value;
                        /** @type {?} */
                        var receiver = new MessageReceiver();
                        receiver.type = 'processParticipant';
                        receiver.processParticipant = 'activityExecutorParticipant';
                        receiver.activityDefId = a.id;
                        receiver.activityDefName = a.data.Name;
                        _this.messageNotice.receivers = _this.messageNotice.receivers.concat([receiver]);
                    }
                }
                catch (e_5_1) { e_5 = { error: e_5_1 }; }
                finally {
                    try {
                        if (re_1_1 && !re_1_1.done && (_a = re_1.return)) _a.call(re_1);
                    }
                    finally { if (e_5) throw e_5.error; }
                }
            }
            dialog.close();
        }));
        compRef.instance.closeEmitter.subscribe((/**
         * @param {?} r
         * @return {?}
         */
        function (r) {
            dialog.close();
        }));
        /** @type {?} */
        var modalConfig = {
            title: this.localePipe.transform('component.messageNoticeEdit.activityList'),
            width: 490,
            height: 490,
            showButtons: true,
            buttons: compRef.instance.buttonRef
        };
        dialog = this.modalService.show(compRef, modalConfig);
    };
    /**
     * @param {?} variableParticipant
     * @param {?} index
     * @return {?}
     */
    MessageNoticeEditComponent.prototype.selectVariableParticipant = /**
     * @param {?} variableParticipant
     * @param {?} index
     * @return {?}
     */
    function (variableParticipant, index) {
        var _this = this;
        var e_6, _a, e_7, _b, e_8, _c, e_9, _d, e_10, _e;
        /** @type {?} */
        var context = new Array();
        // if(this.expr.exprEntity.contextEntities.find(x => x.key === 'CurrentLanguage')) {
        //   context.push(this.expr.exprEntity.contextEntities.find(x => x.key === 'CurrentLanguage'));
        // }
        // this.expr.clearContext();
        this.expr.setEditPattern(ExprEditMode.Advanced);
        if (this.designerUIState.schemas.length > 0) {
            try {
                for (var _f = __values(this.designerUIState.schemas), _g = _f.next(); !_g.done; _g = _f.next()) {
                    var schema = _g.value;
                    this.expr.addSchema('Schema', schema);
                }
            }
            catch (e_6_1) { e_6 = { error: e_6_1 }; }
            finally {
                try {
                    if (_g && !_g.done && (_a = _f.return)) _a.call(_f);
                }
                finally { if (e_6) throw e_6.error; }
            }
            if (this.designerUIState.schemas[0].entityTypes && this.designerUIState.schemas[0].entityTypes.length > 0) {
                /** @type {?} */
                var entityType = this.designerUIState.schemas[0].entityTypes[0];
                this.expr.addInjectedEntity(entityType.name, 'Schema', entityType.name, InjectedType.EntityType);
            }
        }
        if (this.designerUIState.participantContext.length > 0) {
            try {
                for (var _h = __values(this.designerUIState.participantContext), _j = _h.next(); !_j.done; _j = _h.next()) {
                    var variable = _j.value;
                    context.push(variable);
                }
            }
            catch (e_7_1) { e_7 = { error: e_7_1 }; }
            finally {
                try {
                    if (_j && !_j.done && (_b = _h.return)) _b.call(_h);
                }
                finally { if (e_7) throw e_7.error; }
            }
        }
        if (this.designerUIState.processVariableContext.length > 0) {
            var _loop_1 = function (variable) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    context.push(variable);
                }
            };
            try {
                for (var _k = __values(this.designerUIState.processVariableContext), _l = _k.next(); !_l.done; _l = _k.next()) {
                    var variable = _l.value;
                    _loop_1(variable);
                }
            }
            catch (e_8_1) { e_8 = { error: e_8_1 }; }
            finally {
                try {
                    if (_l && !_l.done && (_c = _k.return)) _c.call(_k);
                }
                finally { if (e_8) throw e_8.error; }
            }
        }
        if (this.designerUIState.subActivityContext.length > 0) {
            var _loop_2 = function (variable) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    context.push(variable);
                }
            };
            try {
                for (var _m = __values(this.designerUIState.subActivityContext), _o = _m.next(); !_o.done; _o = _m.next()) {
                    var variable = _o.value;
                    _loop_2(variable);
                }
            }
            catch (e_9_1) { e_9 = { error: e_9_1 }; }
            finally {
                try {
                    if (_o && !_o.done && (_d = _m.return)) _d.call(_m);
                }
                finally { if (e_9) throw e_9.error; }
            }
        }
        if (context.length > 0) {
            try {
                for (var context_1 = __values(context), context_1_1 = context_1.next(); !context_1_1.done; context_1_1 = context_1.next()) {
                    var v = context_1_1.value;
                    this.expr.addContext(v);
                }
            }
            catch (e_10_1) { e_10 = { error: e_10_1 }; }
            finally {
                try {
                    if (context_1_1 && !context_1_1.done && (_e = context_1.return)) _e.call(context_1);
                }
                finally { if (e_10) throw e_10.error; }
            }
        }
        if (variableParticipant) {
            this.expr.addExpressionText(variableParticipant);
        }
        else {
            this.expr.addExpressionText('');
        }
        this.expr.buildExpression().then((/**
         * @param {?} expressioninfo
         * @return {?}
         */
        function (expressioninfo) {
            _this.messageNotice.receivers[index].variableParticipant = expressioninfo;
            _this.messageNotice.receivers[index].variableName = _this.variableParticipantName(expressioninfo);
            //点击确定后，去除表达式里面的新增的上下文变量
            if (context.length > 0) {
                _this.expr.exprEntity.contextEntities = _this.expr.exprEntity.contextEntities.filter((/**
                 * @param {?} x
                 * @return {?}
                 */
                function (x) { return !context.some((/**
                 * @param {?} y
                 * @return {?}
                 */
                function (y) { return y.key === x.key; })); }));
            }
        }));
    };
    /**
     * @param {?} receiver
     * @param {?} index
     * @return {?}
     */
    MessageNoticeEditComponent.prototype.selectUserParticipant = /**
     * @param {?} receiver
     * @param {?} index
     * @return {?}
     */
    function (receiver, index) {
        var _this = this;
        this.index = index;
        this.bindingData = {};
        if (receiver.userIds && receiver.userIds.length > 0) {
            this.bindingData.id = receiver.userIds;
            this.bindingData.name = receiver.userNames;
        }
        setTimeout((/**
         * @return {?}
         */
        function () {
            _this.userHelp.showHelp();
        }), 0);
    };
    /**
     * @param {?} receiver
     * @param {?} index
     * @return {?}
     */
    MessageNoticeEditComponent.prototype.selectPositionParticipant = /**
     * @param {?} receiver
     * @param {?} index
     * @return {?}
     */
    function (receiver, index) {
        var _this = this;
        /** @type {?} */
        var dialog;
        /** @type {?} */
        var compFactory = this.resolver.resolveComponentFactory(PositionPerformerComponent);
        /** @type {?} */
        var compRef = compFactory.create(this.injector);
        compRef.instance.showCondition = false;
        compRef.instance.position.performerId = this.messageNotice.receivers[index].positionId;
        compRef.instance.position.performerName = this.messageNotice.receivers[index].positionName;
        compRef.instance.position.positionType = this.messageNotice.receivers[index].positionType;
        compRef.instance.position.orgId = this.messageNotice.receivers[index].orgId;
        compRef.instance.position.orgType = this.messageNotice.receivers[index].orgType;
        if (compRef.instance.position.positionType === '0') {
            compRef.instance.newFilter = { positionType: '0' };
        }
        else {
            compRef.instance.newFilter = { positionType: '1' };
        }
        compRef.instance.submitEmitter.subscribe((/**
         * @param {?} re
         * @return {?}
         */
        function (re) {
            if (re.performerId) {
                _this.messageNotice.receivers[index].positionId = re.performerId;
                _this.messageNotice.receivers[index].positionName = re.performerName;
                _this.messageNotice.receivers[index].positionType = re.positionType;
                _this.messageNotice.receivers[index].orgId = re.orgId;
                _this.messageNotice.receivers[index].orgType = re.orgType;
            }
            dialog.close();
        }));
        compRef.instance.closeEmitter.subscribe((/**
         * @param {?} r
         * @return {?}
         */
        function (r) {
            dialog.close();
        }));
        /** @type {?} */
        var modalConfig = {
            title: this.localePipe.transform('component.messageNoticeEdit.position'),
            width: 700,
            height: 400,
            showButtons: true,
            buttons: compRef.instance.buttonRef
        };
        dialog = this.modalService.show(compRef, modalConfig);
    };
    /**
     * @param {?} data
     * @return {?}
     */
    MessageNoticeEditComponent.prototype.titleExpr = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        this.showTitleHelp(data);
    };
    /**
     * @param {?} data
     * @return {?}
     */
    MessageNoticeEditComponent.prototype.contentExpr = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        this.showContentHelp(data);
    };
    /**
     * @param {?} data
     * @return {?}
     */
    MessageNoticeEditComponent.prototype.showContentHelp = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        var _this = this;
        /** @type {?} */
        var context = this.showExpr();
        if (this.messageNotice.content && this.messageNotice.content.length > 0) {
            this.expr.addExpressionText(this.messageNotice.content);
        }
        else {
            this.expr.addExpressionText('');
        }
        this.expr.buildExpression().then((/**
         * @param {?} expressionInfo
         * @return {?}
         */
        function (expressionInfo) {
            _this.messageNotice.content = expressionInfo;
            //点击确定后，去除表达式里面的新增的上下文变量
            if (context.length > 0) {
                _this.expr.exprEntity.contextEntities = _this.expr.exprEntity.contextEntities.filter((/**
                 * @param {?} x
                 * @return {?}
                 */
                function (x) { return !context.some((/**
                 * @param {?} y
                 * @return {?}
                 */
                function (y) { return y.key === x.key; })); }));
            }
        }));
    };
    /**
     * @param {?} data
     * @return {?}
     */
    MessageNoticeEditComponent.prototype.showTitleHelp = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        var _this = this;
        if (this.messageNotice.subject && this.messageNotice.subject.charAt(0) !== '{') {
            this.messageNotice.subject = '';
        }
        /** @type {?} */
        var context = this.showExpr();
        if (this.messageNotice.subject && this.messageNotice.subject.length > 0) {
            this.expr.addExpressionText(this.messageNotice.subject);
        }
        else {
            this.expr.addExpressionText('');
        }
        this.expr.buildExpression().then((/**
         * @param {?} expressionInfo
         * @return {?}
         */
        function (expressionInfo) {
            _this.messageNotice.subject = expressionInfo;
            //点击确定后，去除表达式里面的新增的上下文变量
            if (context.length > 0) {
                _this.expr.exprEntity.contextEntities = _this.expr.exprEntity.contextEntities.filter((/**
                 * @param {?} x
                 * @return {?}
                 */
                function (x) { return !context.some((/**
                 * @param {?} y
                 * @return {?}
                 */
                function (y) { return y.key === x.key; })); }));
            }
        }));
    };
    /**
     * @return {?}
     */
    MessageNoticeEditComponent.prototype.showExpr = /**
     * @return {?}
     */
    function () {
        var e_11, _a, e_12, _b, e_13, _c, e_14, _d, e_15, _e;
        /** @type {?} */
        var context = new Array();
        // if(this.expr.exprEntity.contextEntities.find(x => x.key === 'CurrentLanguage')) {
        //   context.push(this.expr.exprEntity.contextEntities.find(x => x.key === 'CurrentLanguage'));
        // }
        // this.expr.clearContext();
        if (this.uistate.schemas.length > 0) {
            try {
                for (var _f = __values(this.uistate.schemas), _g = _f.next(); !_g.done; _g = _f.next()) {
                    var schema = _g.value;
                    // this.expr.addCommonObject(co);
                    this.expr.addSchema('Schema', schema);
                }
            }
            catch (e_11_1) { e_11 = { error: e_11_1 }; }
            finally {
                try {
                    if (_g && !_g.done && (_a = _f.return)) _a.call(_f);
                }
                finally { if (e_11) throw e_11.error; }
            }
            if (this.uistate.schemas[0].entityTypes && this.uistate.schemas[0].entityTypes.length > 0) {
                /** @type {?} */
                var entityType = this.uistate.schemas[0].entityTypes[0];
                this.expr.addInjectedEntity(entityType.name, 'Schema', entityType.name, InjectedType.EntityType);
            }
        }
        if (this.uistate.procInstContext.length > 0) {
            try {
                for (var _h = __values(this.uistate.procInstContext), _j = _h.next(); !_j.done; _j = _h.next()) {
                    var variable = _j.value;
                    context.push(variable);
                    // this.expr.addContext(variable);
                }
            }
            catch (e_12_1) { e_12 = { error: e_12_1 }; }
            finally {
                try {
                    if (_j && !_j.done && (_b = _h.return)) _b.call(_h);
                }
                finally { if (e_12) throw e_12.error; }
            }
        }
        if (this.uistate.subActivityContext.length > 0) {
            var _loop_3 = function (variable) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    context.push(variable);
                }
            };
            try {
                for (var _k = __values(this.uistate.subActivityContext), _l = _k.next(); !_l.done; _l = _k.next()) {
                    var variable = _l.value;
                    _loop_3(variable);
                }
            }
            catch (e_13_1) { e_13 = { error: e_13_1 }; }
            finally {
                try {
                    if (_l && !_l.done && (_c = _k.return)) _c.call(_k);
                }
                finally { if (e_13) throw e_13.error; }
            }
        }
        if (this.uistate.processVariableContext.length > 0) {
            var _loop_4 = function (variable) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    context.push(variable);
                }
            };
            try {
                for (var _m = __values(this.uistate.processVariableContext), _o = _m.next(); !_o.done; _o = _m.next()) {
                    var variable = _o.value;
                    _loop_4(variable);
                }
            }
            catch (e_14_1) { e_14 = { error: e_14_1 }; }
            finally {
                try {
                    if (_o && !_o.done && (_d = _m.return)) _d.call(_m);
                }
                finally { if (e_14) throw e_14.error; }
            }
        }
        if (context.length > 0) {
            try {
                for (var context_2 = __values(context), context_2_1 = context_2.next(); !context_2_1.done; context_2_1 = context_2.next()) {
                    var v = context_2_1.value;
                    this.expr.addContext(v);
                }
            }
            catch (e_15_1) { e_15 = { error: e_15_1 }; }
            finally {
                try {
                    if (context_2_1 && !context_2_1.done && (_e = context_2.return)) _e.call(context_2);
                }
                finally { if (e_15) throw e_15.error; }
            }
        }
        return context;
    };
    /**
     * @return {?}
     */
    MessageNoticeEditComponent.prototype.tranExpr = /**
     * @return {?}
     */
    function () {
        this.messageNotice.subject = '';
    };
    /**
     * @private
     * @param {?} expr
     * @return {?}
     */
    MessageNoticeEditComponent.prototype.variableParticipantName = /**
     * @private
     * @param {?} expr
     * @return {?}
     */
    function (expr) {
        var e_16, _a, e_17, _b;
        try {
            for (var _c = __values(this.designerUIState.participantContext), _d = _c.next(); !_d.done; _d = _c.next()) {
                var c = _d.value;
                if (expr.indexOf(c.key) > -1) {
                    return c.name;
                }
            }
        }
        catch (e_16_1) { e_16 = { error: e_16_1 }; }
        finally {
            try {
                if (_d && !_d.done && (_a = _c.return)) _a.call(_c);
            }
            finally { if (e_16) throw e_16.error; }
        }
        try {
            for (var _e = __values(this.designerUIState.processVariableContext), _f = _e.next(); !_f.done; _f = _e.next()) {
                var c = _f.value;
                if (expr.indexOf(c.key) > -1) {
                    return c.name;
                }
            }
        }
        catch (e_17_1) { e_17 = { error: e_17_1 }; }
        finally {
            try {
                if (_f && !_f.done && (_b = _e.return)) _b.call(_e);
            }
            finally { if (e_17) throw e_17.error; }
        }
        return JSON.parse(expr).expr;
    };
    MessageNoticeEditComponent.decorators = [
        { type: Component, args: [{
                    selector: 'lib-message-notice-edit',
                    template: "<div class=\"f-page\">\r\n  <div class=\"f-utils-fill-flex-column farris-split-section m-2 h-100\" style=\"border-radius:16px;border: 1.5px solid #F1F3F7;\">\r\n    <section class=\"f-utils-fill-flex-column h-100\">\r\n      <div class=\"f-utils-fill-flex-column h-100\">\r\n        <perfect-scrollbar [config]=\"{}\">\r\n          <form class=\"h-100\">\r\n            <div class=\"f-form-layout farris-form  farris-form-controls-inline f-form-label-sm\">\r\n              <div *ngIf=\"location!=='messageActivity'\" class=\"col-12 col-md-6 mt-3\">\r\n                <div class=\"farris-group-wrap\">\r\n                  <div class=\"form-group farris-form-group\">\r\n                    <label class=\"col-form-label\">\r\n                      <span class=\"farris-label-info text-danger\">*</span>\r\n                      <span class=\"farris-label-text\">{{'component.MessageNotice.sendTime'|wfLocale}}</span>\r\n                    </label>\r\n                    <div class=\"farris-input-wrap ml-1\">\r\n                      <farris-combo-list [(ngModel)]=\"messageNotice.sendTime\" [idField]=\"'value'\" [textField]=\"'text'\"\r\n                        [enableClear]=\"false\" [data]=\"sendTimes\" name=\"sendTime\" [editable]=\"false\"\r\n                        (selectChange)=\"sendTimeChange($event)\">\r\n                      </farris-combo-list>\r\n                      <div class=\"farris-feedback valid-feedback\"></div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <div class=\"col-12 farris-group-auto mt-2\">\r\n                <div class=\"farris-group-wrap\">\r\n                  <div class=\"form-group farris-form-group\">\r\n                    <label class=\"col-form-label\">\r\n                      <span class=\"farris-label-info text-danger\">*</span>\r\n                      <span class=\"farris-label-text\">{{'component.messageNoticeEdit.messSendType'|wfLocale}}</span>\r\n                    </label>\r\n                    <div class=\"farris-input-wrap ml-1\">\r\n                      <farris-checkboxgroup #checkboxGroup [(ngModel)]=\"messageNotice.sendType\" name=\"sendType\"\r\n                        [horizontal]=\"true\" [data]=\"typeGroup\" (changeValue)=\"sendTypeChange($event)\">\r\n                      </farris-checkboxgroup>\r\n                      <div class=\"farris-feedback valid-feedback\"></div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <div class=\"col-8 farris-group-auto mt-2\">\r\n                <div class=\"farris-group-wrap\">\r\n                  <div class=\"form-group farris-form-group\">\r\n                    <label class=\"col-form-label\">\r\n                      <span class=\"farris-label-info text-danger\">*</span>\r\n                      <span class=\"farris-label-text\">{{'component.messageNoticeEdit.messSubject'|wfLocale}}</span>\r\n                    </label>\r\n                    <div class=\"farris-input-wrap ml-1\" *ngIf=\"!exprAble; else disabled\">\r\n                      <input class=\"form-control\" type=\"text\" value=\"subject\" [(ngModel)]=\"messageNotice.subject\"\r\n                        name=\"subject\" />\r\n                      <div class=\"farris-feedback valid-feedback\"></div>\r\n                    </div>\r\n                    <ng-template #disabled>\r\n                      <div class=\"farris-input-wrap ml-1\">\r\n                        <input-group [editable]=\"false\" [enableClear]=\"false\" [customCls]=\"'custom-cls'\" [groupText]=\"groupIcon2\"\r\n                          [(value)]=\"messageNotice.subject\" (clickHandle)=\"titleExpr($event)\">\r\n                        </input-group>\r\n                      </div>\r\n                    </ng-template>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <div class=\"col-4 farris-group-auto mt-2\">\r\n                <div class=\"farris-group-wrap\">\r\n                  <div class=\"form-group farris-form-group\">\r\n                    <label class=\"col-form-label\">\r\n                      <span class=\"farris-label-text\">{{'component.messageNoticeEdit.enable'|wfLocale}}</span>\r\n                    </label>\r\n                    <div class=\"farris-input-wrap\">\r\n                      <farris-switch [(ngModel)]=\"exprAble\" name=\"enable\" (click)=\"tranExpr()\"></farris-switch>\r\n                      <div class=\"farris-feedback valid-feedback\"></div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <div class=\"col-12 farris-group-auto mt-2\">\r\n                <div class=\"farris-group-wrap\">\r\n                  <div class=\"form-group farris-form-group\">\r\n                    <label class=\"col-form-label\">\r\n                      <span class=\"farris-label-info text-danger\">*</span>\r\n                      <span class=\"farris-label-text\">{{'component.messageNoticeEdit.messContent'|wfLocale}}</span>\r\n                    </label>\r\n                    <div class=\"farris-input-wrap ml-1\">\r\n                      <input-group [editable]=\"false\" [enableClear]=\"false\" [customCls]=\"'custom-cls'\" [groupText]=\"groupIcon2\"\r\n                        [(value)]=\"messageNotice.content\" (clickHandle)=\"contentExpr($event)\">\r\n                      </input-group>\r\n                      <div class=\"farris-feedback valid-feedback\"></div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <div class=\"col-12 farris-group-auto mt-2\">\r\n                <div class=\"farris-group-wrap\">\r\n                  <div class=\"form-group farris-form-group\">\r\n                    <label class=\"col-form-label\">\r\n                      <span class=\"farris-label-info text-danger\">*</span>\r\n                      <span class=\"farris-label-text\">{{'component.messageNoticeEdit.recipient'|wfLocale}}</span>\r\n                    </label>\r\n                    <div class=\"farris-input-wrap\">\r\n                      <div class=\"text-right mb-2\">\r\n                        <farris-button [type]=\"'link'\" (click)=\"addReceiver()\" [disabled]=\"disableAdd()\">\r\n                          <span class=\"f-icon f-icon-add\"></span>\r\n                          {{'component.messageNoticeEdit.addReceiver'|wfLocale}}</farris-button>\r\n                      </div>\r\n                      <div *ngFor=\"let receiver of messageNotice.receivers; let i=index\" class=\"col-12 d-flex px-0\">\r\n                        <div class=\"farris-group-wrap col-4 pl-0\">\r\n                          <div class=\"form-group farris-form-group\">\r\n                            <div class=\"farris-input-wrap\">\r\n                              <farris-combo-list [(ngModel)]=\"receiver.type\" [idField]=\"'value'\" [textField]=\"'text'\"\r\n                                [enableClear]=\"true\" [data]=\"receiverTypes\" [name]=\"'receiverType'+i\"\r\n                                [editable]=\"false\">\r\n                              </farris-combo-list>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                        <div *ngIf=\"receiver.type==='processParticipant'\" class=\"farris-group-wrap col-4 pl-0\">\r\n                          <div class=\"form-group farris-form-group\">\r\n                            <div class=\"farris-input-wrap\">\r\n                              <farris-combo-list [(ngModel)]=\"receiver.processParticipant\" [idField]=\"'value'\"\r\n                                [textField]=\"'text'\" [enableClear]=\"false\" [data]=\"processParticipantTypes\"\r\n                                [name]=\"'processParticipantType'+i\" [editable]=\"false\">\r\n                              </farris-combo-list>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                        <div\r\n                          *ngIf=\"receiver.type==='processParticipant' && receiver.processParticipant==='activityExecutorParticipant'\"\r\n                          class=\"farris-group-wrap col-4 px-0\">\r\n                          <div class=\"form-group farris-form-group\">\r\n                            <div class=\"farris-input-wrap\">\r\n                              <input-group [editable]=\"false\" [customCls]=\"'custom-cls'\" [groupText]=\"groupIcon2\"\r\n                                [enableClear]=\"true\" (clear)=\"clearActivityExecutor(i)\"\r\n                                [(value)]=\"receiver.activityDefName\"\r\n                                (clickHandle)=\"selectActivityExecutorParticipant(receiver.activityDefId, i)\">\r\n                              </input-group>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                        <div *ngIf=\"receiver.type==='variableParticipant'\" class=\"farris-group-wrap col-5 px-0\">\r\n                          <div class=\"form-group farris-form-group\">\r\n                            <div class=\"farris-input-wrap\">\r\n                              <input-group [editable]=\"false\" [customCls]=\"'custom-cls'\" [groupText]=\"groupIcon2\"\r\n                                [enableClear]=\"true\" (clear)=\"clearVariableParticipant(i)\"\r\n                                [(value)]=\"receiver.variableName\"\r\n                                (clickHandle)=\"selectVariableParticipant(receiver.variableParticipant, i)\">\r\n                              </input-group>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                        <div *ngIf=\"receiver.type==='variableParticipant'\" class=\"farris-group-wrap col-3 px-0 pl-3\">\r\n                          <div class=\"form-group farris-form-group\">\r\n                            <div class=\"farris-input-wrap\">\r\n                              <farris-combo-list [(ngModel)]=\"receiver.orgType\" [idField]=\"'value'\" [textField]=\"'name'\"\r\n                                [enableClear]=\"false\" [data]=\"variableOrgTypes\" [name]=\"'variableParticipantOrgType'+i\"\r\n                                [editable]=\"false\">\r\n                              </farris-combo-list>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                        <div *ngIf=\"receiver.type==='userParticipant'\" class=\"farris-group-wrap col-8 px-0\">\r\n                          <div class=\"form-group farris-form-group\">\r\n                            <div class=\"farris-input-wrap\">\r\n                              <input-group [editable]=\"false\" [customCls]=\"'custom-cls'\" [groupText]=\"groupIcon2\"\r\n                                [(value)]=\"receiver.userNames\" (clickHandle)=\"selectUserParticipant(receiver, i)\"\r\n                                (clear)=\"clearUsers(i)\">\r\n                              </input-group>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                        <div *ngIf=\"receiver.type==='positionParticipant'\" class=\"farris-group-wrap col-8 px-0\">\r\n                          <div class=\"form-group farris-form-group\">\r\n                            <div class=\"farris-input-wrap\">\r\n                              <input-group [editable]=\"false\" [customCls]=\"'custom-cls'\" [groupText]=\"groupIcon2\"\r\n                                [enableClear]=\"true\" (clear)=\"clearPosition(i)\"\r\n                                [value]=\"receiver.positionId?('component.messageNoticeEdit.posi'|wfLocale)+receiver.positionName+'\uFF1B'+(receiver.orgId?(('component.messageNoticeEdit.organization'|wfLocale))+receiver.orgId:''):''\"\r\n                                (clickHandle)=\"selectPositionParticipant(receiver, i)\">\r\n                              </input-group>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <lib-sms-message-template *ngIf=\"hasSmsTemplate\" [smsMessageTemplate]=\"this.messageNotice.smsMessageTemplate\"></lib-sms-message-template>\r\n          </form>\r\n        </perfect-scrollbar>\r\n      </div>\r\n    </section>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #footer>\r\n  <button type=\"button\" class=\"btn btn-secondary btn-sm mx-2\" (click)=\"clickCancel()\">{{'component.messageNoticeEdit.clickCancel'|wfLocale}}</button>\r\n  <button type=\"button\" class=\"btn btn-primary btn-sm mx-2\" (click)=\"clickOK()\">{{'component.messageNoticeEdit.clickOK'|wfLocale}}</button>\r\n</ng-template>\r\n\r\n\r\n<sys-farris-grid-lookup #userHelp style=\"display: none;\" [singleSelect]=\"false\" [displayTxt]=\"bindingData.name\"\r\n  [pagination]=\"true\" [pageSize]=\"20\" title=\"{{'component.messageNoticeEdit.sys'|wfLocale}}\" [sourceType]=\"'user'\" (afterConfirm)=\"usersSelect($event)\"\r\n  [bindingData]=\"bindingData\" [filter]=\"{notGetCurrentUser:false, notGetStopUser: true}\" [typeMode]=\"1\"\r\n  [required]=\"false\">\r\n</sys-farris-grid-lookup>\r\n",
                    providers: [
                        WfLocalePipe,
                    ],
                    styles: [".help-tip{text-align:center;background-color:#bcdbea;border-radius:50%;width:20px;height:20px;font-size:6px;cursor:default}"]
                }] }
    ];
    /** @nocollapse */
    MessageNoticeEditComponent.ctorParameters = function () { return [
        { type: MessagerService },
        { type: ProcessDesignerUIState },
        { type: ExpressionService },
        { type: ComponentFactoryResolver },
        { type: Injector },
        { type: BsModalService },
        { type: ProcessDesignerUIState },
        { type: HttpService },
        { type: ChangeDetectorRef, decorators: [{ type: Optional }] },
        { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
        { type: undefined, decorators: [{ type: Inject, args: [WF_LANG_RESOURCES,] }] },
        { type: WfLocalePipe, decorators: [{ type: Optional }] }
    ]; };
    MessageNoticeEditComponent.propDecorators = {
        footer: [{ type: ViewChild, args: ['footer',] }],
        SmsTemplate: [{ type: ViewChild, args: [SmsMessageTemplateComponent,] }],
        closeEmitter: [{ type: Output }],
        submitEmitter: [{ type: Output }],
        userHelp: [{ type: ViewChild, args: [SysFarrisLookupComponent,] }],
        location: [{ type: Input }],
        value: [{ type: Input }]
    };
    return MessageNoticeEditComponent;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var MessageNoticeBatchSet = /** @class */ (function () {
    function MessageNoticeBatchSet() {
    }
    return MessageNoticeBatchSet;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var MessageNoticeCopyComponent = /** @class */ (function () {
    function MessageNoticeCopyComponent(uistate, message, cdr, localeId, resources, localePipe) {
        var _this = this;
        this.uistate = uistate;
        this.message = message;
        this.cdr = cdr;
        this.localeId = localeId;
        this.resources = resources;
        this.localePipe = localePipe;
        this.closeEmitter = new EventEmitter();
        this.submitEmitter = new EventEmitter();
        this.cols = [
            { title: this.localePipe.transform('component.MessageNotice.name'), field: 'Name', width: 60, searchField: 'Name' },
            { title: 'ID', field: 'Id', width: 90, searchField: 'Id' }
        ];
        // ==========================================================
        this.actis = [];
        this.fullActis = [];
        this.pageInfo = {
            pageIndex: 1,
            pageList: [10, 20, 30, 50],
            pageSize: 20
        };
        this.messageNotice = [];
        this.messageNoticeValue = [];
        this.targetNodeID = [];
        this.activitySendTime = [
            { value: 'WORKITEM_CREATED', text: this.localePipe.transform('component.MessageNotice.workCreated') },
            { value: 'ACTIVITY_COMPLETED', text: this.localePipe.transform('component.MessageNotice.actComplete') },
            { value: 'ACTIVITY_ABORTED', text: this.localePipe.transform('component.MessageNotice.actAborted') },
        ];
        this.columns = [
            {
                field: 'subject', width: 100, title: this.localePipe.transform('component.MessageNotice.subject'),
            }, {
                field: 'content', width: 150, title: this.localePipe.transform('component.MessageNotice.content'), showTips: true,
            }, {
                field: 'sendTime', width: 100, title: this.localePipe.transform('component.MessageNotice.sendTime'),
                formatter: {
                    type: 'enum',
                    options: { valueField: 'value', textField: 'text', data: this.activitySendTime }
                },
            }, {
                field: 'sendType', width: 100, title: this.localePipe.transform('component.MessageNotice.sendType'),
                formatter: {
                    type: 'enum',
                    options: { valueField: 'value', textField: 'name', data: this.uistate.messageChannels.map((/**
                         * @param {?} m
                         * @return {?}
                         */
                        function (m) { return ({ value: m.code, name: m.name }); })) }
                },
            }, {
                field: 'receiverText', width: 120, title: this.localePipe.transform('component.MessageNotice.receiverText'), showTips: true
            }
        ];
        this.actisSelect = (/**
         * @param {?} rowData
         * @return {?}
         */
        function (rowData) {
            var e_1, _a;
            try {
                for (var rowData_1 = __values(rowData), rowData_1_1 = rowData_1.next(); !rowData_1_1.done; rowData_1_1 = rowData_1.next()) {
                    var r = rowData_1_1.value;
                    _this.targetNodeID.push(r.Id);
                }
            }
            catch (e_1_1) { e_1 = { error: e_1_1 }; }
            finally {
                try {
                    if (rowData_1_1 && !rowData_1_1.done && (_a = rowData_1.return)) _a.call(rowData_1);
                }
                finally { if (e_1) throw e_1.error; }
            }
            return of$1({
                closeDialog: true
            });
        });
        this.paramAfterEdit = (/**
         * @param {?} rowIndex
         * @param {?} rowData
         * @param {?=} column
         * @return {?}
         */
        function (rowIndex, rowData, column) {
            console.log(rowData);
            console.log(rowIndex);
            return of$1(true);
        });
        this.localePipe = this.localePipe || new WfLocalePipe(localeId, resources);
    }
    /**
     * @return {?}
     */
    MessageNoticeCopyComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () { };
    /**
     * @param {?} e
     * @return {?}
     */
    MessageNoticeCopyComponent.prototype.endEdit = /**
     * @param {?} e
     * @return {?}
     */
    function (e) {
        console.log(e);
    };
    Object.defineProperty(MessageNoticeCopyComponent.prototype, "messageNotices", {
        get: /**
         * @return {?}
         */
        function () {
            return this.messageNotice;
        },
        set: /**
         * @param {?} m
         * @return {?}
         */
        function (m) {
            this.messageNotice = m;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    MessageNoticeCopyComponent.prototype.clickOK = /**
     * @return {?}
     */
    function () {
        if (!this.targetNodeID && this.targetNodeID.length === 0) {
            this.message.info(this.localePipe.transform('component.MessageNotice.noTargetNode'));
            return;
        }
        if (!this.messageNotice && this.messageNotice.length === 0) {
            this.message.info(this.localePipe.transform('component.MessageNotice.noMessageNotifyAttribute'));
            return;
        }
        /** @type {?} */
        var batchSetValue = new MessageNoticeBatchSet();
        batchSetValue.messageNotice = this.messageNotice;
        batchSetValue.targetNodeID = this.targetNodeID;
        batchSetValue.isBatchCopy = true;
        /** @type {?} */
        var object = { value: batchSetValue, parameters: null };
        this.submitEmitter.emit(object);
    };
    /**
     * @return {?}
     */
    MessageNoticeCopyComponent.prototype.clickCancel = /**
     * @return {?}
     */
    function () {
        this.closeEmitter.emit();
    };
    MessageNoticeCopyComponent.decorators = [
        { type: Component, args: [{
                    selector: 'lib-message-notice-copy',
                    template: "<div class=\"f-page\">\r\n  <div class=\"f-utils-fill-flex-column farris-split-section m-2 h-100\">\r\n    <section class=\"f-utils-fill-flex-column h-100\">\r\n      <div class=\"f-utils-fill-flex-column h-100\">\r\n        <form class=\"h-100\">\r\n          <div class=\"f-utils-fill-flex-column h-100\">\r\n            <!-- \u53EF\u9009\u8282\u70B9\u76EE\u6807\u5C0F\u6807\u9898 -->\r\n            <div class=\"mx-2 mt-1\">\r\n              <div class=\"title-content\">\r\n                <h4 class=\"title-text\">{{'component.messageNoticeEdit.optionalNodes'|wfLocale}}</h4><span class=\"title-line\"></span>\r\n              </div>\r\n            </div>\r\n            <div class=\"mt-2 mx-4 farris-form-controls-inline\">\r\n              <div class=\"farris-group-wrap\">\r\n                <!-- \u9644\u52A0\u8282\u70B9\u5E2E\u52A9 -->\r\n                <farris-lookup-grid #userActisDialog [items]=\"uistate.userActList\" [columns]=\"cols\" [resizable]=\"true\"\r\n                  [singleSelect]=\"false\" [idField]=\"'Id'\" [textField]=\"'Name'\" [(ngModel)]=\"actis\" [valueField]=\"'Id'\"\r\n                  [pagination]=\"false\" [pageIndex]=\"pageInfo.pageIndex\" name=\"defaultActivities\"\r\n                  [pageSize]=\"pageInfo.pageSize\" [pageList]=\"pageInfo.pageList\" [total]=\"total\" [enableClear]=\"false\"\r\n                  title=\"{{'component.messageNoticeEdit.targetNodeList'|wfLocale}}\" [displayType]=\"'List'\" [remoteSearch]='false' [enableToSelect]=\"false\"\r\n                  placeholder=\"{{'component.messageNoticeEdit.placeholder'|wfLocale}}\" [dictPicked]=\"actisSelect\" [nosearch]=\"true\" [showFilterBar]=\"false\">\r\n                </farris-lookup-grid>\r\n              </div>\r\n            </div>\r\n            <!-- \u53EF\u9009\u5C5E\u6027\u76EE\u6807\u5C0F\u6807\u9898 -->\r\n            <div class=\"mx-2 mt-1\">\r\n              <div class=\"title-content\">\r\n                <h4 class=\"title-text\">{{'component.messageNoticeEdit.optionalAttribute'|wfLocale}}</h4><span class=\"title-line\"></span>\r\n              </div>\r\n            </div>\r\n            <!-- \u6D88\u606F\u901A\u77E5\u5C5E\u6027 -->\r\n            <div class=\"f-page-main f-utils-fill-flex-column h-100\">\r\n              <div class=\"f-utils-fill-flex-column farris-overflow-y-auto h-100\">\r\n                <farris-datagrid #grid [data]=\"messageNotices\" [columns]=\"columns\" [idField]=\"'id'\" [fit]=\"true\"\r\n                  [fitColumns]=\"true\" [editable]=\"false\" [pagination]=\"false\" [showCheckbox]=\"false\"\r\n                  [multiSelect]=\"false\" [showLineNumber]=\"true\" lineNumberTitle=\"{{'component.messageNoticeEdit.lineNumber'|wfLocale}}\" [lineNumberWidth]=\"50\"\r\n                  [striped]=\"true\" [showAllCheckbox]=\"false\" [afterEdit]=\"paramAfterEdit\" (endEdit)=\"endEdit($event)\">\r\n                </farris-datagrid>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </section>\r\n  </div>\r\n</div>\r\n\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type=\"button\" class=\"btn btn-secondary btn-sm\" (click)=\"clickCancel()\">{{'component.messageNoticeEdit.clickCancel'|wfLocale}}</button>\r\n  <button type=\"button\" class=\"btn btn-primary btn-sm mx-2\" (click)=\"clickOK()\">{{'component.messageNoticeEdit.clickOK'|wfLocale}}</button>\r\n</ng-template>\r\n",
                    providers: [
                        WfLocalePipe,
                    ],
                    styles: [".title-content{color:#000;display:inline-flex;align-items:center;line-height:1.375rem;position:relative;overflow:hidden;padding:0 0 0 1rem;min-width:760px}.title-content ::before{content:'';width:.25rem;height:1.125rem;background:#59a1ff;border-radius:1px;position:absolute;top:50%;left:0;margin-top:-.5625rem}.title-text{font-size:1rem;line-height:1.375rem;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;margin-bottom:0;margin-right:10px}.title-line{flex-grow:1;border-bottom:1px dashed rgba(0,0,0,.1)}"]
                }] }
    ];
    /** @nocollapse */
    MessageNoticeCopyComponent.ctorParameters = function () { return [
        { type: ProcessDesignerUIState },
        { type: MessagerService },
        { type: ChangeDetectorRef, decorators: [{ type: Optional }] },
        { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
        { type: undefined, decorators: [{ type: Inject, args: [WF_LANG_RESOURCES,] }] },
        { type: WfLocalePipe, decorators: [{ type: Optional }] }
    ]; };
    MessageNoticeCopyComponent.propDecorators = {
        modalFooter: [{ type: ViewChild, args: ['iconSelectFooter',] }],
        closeEmitter: [{ type: Output }],
        submitEmitter: [{ type: Output }],
        allActisTable: [{ type: ViewChild, args: ['allActisTable',] }],
        allActisDialog: [{ type: ViewChild, args: ['allActisDialog',] }],
        actTable: [{ type: ViewChild, args: ['actTable',] }],
        lookup: [{ type: ViewChild, args: ['lookup',] }]
    };
    return MessageNoticeCopyComponent;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var MessageNoticeComponent = /** @class */ (function () {
    function MessageNoticeComponent(resolver, injector, modalService, message, uistate, viewModel, http, cdr, localeId, resources, localePipe) {
        this.resolver = resolver;
        this.injector = injector;
        this.modalService = modalService;
        this.message = message;
        this.uistate = uistate;
        this.viewModel = viewModel;
        this.http = http;
        this.cdr = cdr;
        this.localeId = localeId;
        this.resources = resources;
        this.localePipe = localePipe;
        this.cls = 'farris-main-area flex-column';
        this.closeModal = new EventEmitter();
        this.submitModal = new EventEmitter();
        this.editorParams = {};
        this.modalConfig = {
            title: this.localePipe.transform('component.MessageNotice.notify'),
            width: 760,
            height: 480,
            showButtons: true
        };
        this.messageNotices = new Array();
        this.columns = [];
        this.location = 'activity';
        this.processSendTime = [
            { value: 'PROCESSINSTANCE_COMPLETED', text: this.localePipe.transform('component.MessageNotice.procComplete') },
            { value: 'PROCESSINSTANCE_ABORTED', text: this.localePipe.transform('component.MessageNotice.procAborted') },
            { value: 'PROCESSINSTANCE_ROLLBACK', text: this.localePipe.transform('component.MessageNotice.procRollBack') }
        ];
        this.activitySendTime = [
            { value: 'WORKITEM_CREATED', text: this.localePipe.transform('component.MessageNotice.workCreated') },
            { value: 'ACTIVITY_COMPLETED', text: this.localePipe.transform('component.MessageNotice.actComplete') },
            { value: 'ACTIVITY_ABORTED', text: this.localePipe.transform('component.MessageNotice.actAborted') },
        ];
        this.localePipe = this.localePipe || new WfLocalePipe(localeId, resources);
        this.GetOrganizationType();
    }
    Object.defineProperty(MessageNoticeComponent.prototype, "value", {
        set: /**
         * @param {?} notices
         * @return {?}
         */
        function (notices) {
            if (notices && notices.length > 0) {
                this.messageNotices = notices.map((/**
                 * @param {?} n
                 * @return {?}
                 */
                function (n) { return ({
                    id: ProcessDeUtil.GenerateElementId(),
                    content: n.content,
                    sendTime: n.sendTime,
                    sendType: n.sendType,
                    subject: n.subject,
                    receiver: n.receiver,
                    receiverText: n.receiverText,
                    receivers: n.receivers ? n.receivers : new Array(),
                    smsMessageTemplate: n.smsMessageTemplate
                }); }));
            }
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    MessageNoticeComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.location = this.editorParams.location;
        this.columns = [
            {
                field: 'subject', width: 100, title: this.localePipe.transform('component.MessageNotice.subject'),
            }, {
                field: 'content', width: 150, title: this.localePipe.transform('component.MessageNotice.content'), showTips: true,
            }, {
                field: 'sendTime', width: 100, title: this.localePipe.transform('component.MessageNotice.sendTime'),
                formatter: {
                    type: 'enum',
                    options: { valueField: 'value', textField: 'text', data: this.location === 'process' ? this.processSendTime : this.activitySendTime }
                },
            }, {
                field: 'sendType', width: 100, title: this.localePipe.transform('component.MessageNotice.sendType'),
                formatter: {
                    type: 'enum',
                    options: { valueField: 'value', textField: 'name', data: this.uistate.messageChannels.map((/**
                         * @param {?} m
                         * @return {?}
                         */
                        function (m) { return ({ value: m.code, name: m.name }); })) }
                },
            }, {
                field: 'receiverText', width: 120, title: this.localePipe.transform('component.MessageNotice.receiverText'), showTips: true, formatter: (/**
                 * @param {?} v
                 * @param {?} d
                 * @param {?} i
                 * @return {?}
                 */
                function (v, d, i) {
                    var e_1, _a;
                    /** @type {?} */
                    var receiverText = '';
                    if (d.receivers && d.receivers.length > 0) {
                        try {
                            for (var _b = __values(d.receivers), _c = _b.next(); !_c.done; _c = _b.next()) {
                                var receiver = _c.value;
                                if (receiver.type === 'processParticipant') {
                                    if (receiver.processParticipant === 'procInstCreator') {
                                        receiverText += _this.localePipe.transform('component.MessageNotice.procInstCreator');
                                    }
                                    else if (receiver.processParticipant === 'workItemParticipant') {
                                        receiverText += _this.localePipe.transform('component.MessageNotice.workItemParticipant');
                                    }
                                    else if (receiver.processParticipant === 'activityExecutorParticipant') {
                                        receiverText += (receiver.activityDefName + '，');
                                    }
                                }
                                else if (receiver.type === 'userParticipant') {
                                    receiverText += (receiver.userNames + '，');
                                }
                                else if (receiver.type === 'variableParticipant') {
                                    receiverText += (receiver.variableName + '，');
                                }
                                else if (receiver.type === 'positionParticipant') {
                                    receiverText += (receiver.positionName + '，');
                                }
                            }
                        }
                        catch (e_1_1) { e_1 = { error: e_1_1 }; }
                        finally {
                            try {
                                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                            }
                            finally { if (e_1) throw e_1.error; }
                        }
                    }
                    if (receiverText) {
                        receiverText = receiverText.substring(0, receiverText.length - 1);
                    }
                    return receiverText;
                }),
            }
        ];
        if (this.location === 'messageActivity') {
            this.columns = this.columns.filter((/**
             * @param {?} c
             * @return {?}
             */
            function (c) { return c.field !== 'sendTime'; }));
        }
    };
    /**
     * @return {?}
     */
    MessageNoticeComponent.prototype.add = /**
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var dialog;
        /** @type {?} */
        var compFactory = this.resolver.resolveComponentFactory(MessageNoticeEditComponent);
        /** @type {?} */
        var compRef = compFactory.create(this.injector);
        compRef.instance.location = this.location;
        /** @type {?} */
        var messageNotice = new MessageNotice$1();
        if (this.location === 'activity') {
            messageNotice.sendTime = 'WORKITEM_CREATED';
            /** @type {?} */
            var messageReceiver = new MessageReceiver();
            messageReceiver.type = 'processParticipant';
            messageReceiver.processParticipant = 'workItemParticipant';
            messageNotice.receivers = [messageReceiver];
        }
        else if (this.location === 'process') {
            messageNotice.sendTime = 'PROCESSINSTANCE_COMPLETED';
            /** @type {?} */
            var messageReceiver = new MessageReceiver();
            messageReceiver.type = 'processParticipant';
            messageReceiver.processParticipant = 'procInstCreator';
            messageNotice.receivers = [messageReceiver];
        }
        else if (this.location === 'messageActivity') {
            /** @type {?} */
            var messageReceiver = new MessageReceiver();
            messageReceiver.type = 'processParticipant';
            messageReceiver.processParticipant = 'procInstCreator';
            messageNotice.receivers = [messageReceiver];
        }
        compRef.instance.value = messageNotice;
        compRef.instance.submitEmitter.subscribe((/**
         * @param {?} re
         * @return {?}
         */
        function (re) {
            _this.messageNotices = _this.messageNotices.concat([re]);
            dialog.close();
        }));
        compRef.instance.closeEmitter.subscribe((/**
         * @param {?} re
         * @return {?}
         */
        function (re) {
            dialog.close();
        }));
        /** @type {?} */
        var modalConfig = {
            title: this.localePipe.transform('component.MessageNotice.messageSet'),
            width: 760,
            height: 480,
            showButtons: true,
            buttons: compRef.instance.footer
        };
        dialog = this.modalService.show(compRef, modalConfig);
    };
    /**
     * @return {?}
     */
    MessageNoticeComponent.prototype.edit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        if (!this.grid.selectedRow) {
            this.message.info(this.localePipe.transform('component.MessageNotice.selectedRow'));
            return;
        }
        /** @type {?} */
        var dialog;
        /** @type {?} */
        var compFactory = this.resolver.resolveComponentFactory(MessageNoticeEditComponent);
        /** @type {?} */
        var compRef = compFactory.create(this.injector);
        compRef.instance.location = this.location;
        compRef.instance.value = this.grid.selectedRow.data;
        compRef.instance.submitEmitter.subscribe((/**
         * @param {?} re
         * @return {?}
         */
        function (re) {
            _this.messageNotices = _this.messageNotices.map((/**
             * @param {?} m
             * @return {?}
             */
            function (m) {
                if (m.id === re.id) {
                    return re;
                }
                return m;
            }));
            _this.grid.unSelectRow(_this.grid.selectedRow.data.id, true);
            dialog.close();
        }));
        compRef.instance.closeEmitter.subscribe((/**
         * @param {?} re
         * @return {?}
         */
        function (re) {
            dialog.close();
        }));
        /** @type {?} */
        var modalConfig = {
            title: this.localePipe.transform('component.MessageNotice.messageSet'),
            width: 760,
            height: 480,
            showButtons: true,
            buttons: compRef.instance.footer
        };
        dialog = this.modalService.show(compRef, modalConfig);
    };
    /**
     * @return {?}
     */
    MessageNoticeComponent.prototype.batchCopy = /**
     * @return {?}
     */
    function () {
        var _this = this;
        if (!this.messageNotices) {
            this.message.info(this.localePipe.transform('component.MessageNotice.noCopy'));
            return;
        }
        /** @type {?} */
        var dialog;
        /** @type {?} */
        var compFactory = this.resolver.resolveComponentFactory(MessageNoticeCopyComponent);
        /** @type {?} */
        var compRef = compFactory.create(this.injector);
        compRef.instance.messageNotices = this.messageNotices;
        compRef.instance.submitEmitter.subscribe((/**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            _this.viewModel.copy(ResourceKeys.batchCopyProperty, data);
            dialog.close();
        }));
        compRef.instance.closeEmitter.subscribe((/**
         * @param {?} re
         * @return {?}
         */
        function (re) {
            dialog.close();
        }));
        /** @type {?} */
        var modalConfig = {
            title: this.localePipe.transform('component.MessageNotice.batchCopy'),
            width: 800,
            height: 515,
            showButtons: true,
            buttons: compRef.instance.modalFooter
        };
        dialog = this.modalService.show(compRef, modalConfig);
    };
    /**
     * @return {?}
     */
    MessageNoticeComponent.prototype.delete = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var selected = this.grid.selectedRow;
        if (!selected) {
            this.message.info(this.localePipe.transform('component.MessageNotice.selectedRow'));
            return;
        }
        this.messageNotices = this.messageNotices.filter((/**
         * @param {?} m
         * @return {?}
         */
        function (m) { return m.id !== selected.id; }));
    };
    /**
     * @return {?}
     */
    MessageNoticeComponent.prototype.clickOK = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var object = { value: this.messageNotices, parameters: null };
        this.submitModal.emit(object);
    };
    /**
     * @return {?}
     */
    MessageNoticeComponent.prototype.clickCancel = /**
     * @return {?}
     */
    function () {
        this.closeModal.emit();
    };
    /**
     * @private
     * @return {?}
     */
    MessageNoticeComponent.prototype.GetOrganizationType = /**
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var url = '/api/runtime/sys/v1.0/authfields/globalauthfields';
        this.http.get(url)
            .subscribe((/**
         * @param {?} data
         * @return {?}
         */
        function (data) { return _this.uistate.orgTypeCollection = data.map((/**
         * @param {?} d
         * @return {?}
         */
        function (d) { return ({ value: d.id, text: d.name }); })); }));
    };
    MessageNoticeComponent.decorators = [
        { type: Component, args: [{
                    selector: 'lib-message-notice',
                    template: "<div class=\"f-page\">\r\n  <div class=\"f-page-header\">\r\n    <nav class=\"f-page-header-base\">\r\n      <div class=\"f-title\">\r\n      </div>\r\n      <div class=\"btn-toolbar btn-group-lg\">\r\n        <button class=\"btn btn-primary mr-2\" (click)=\"add()\">{{'component.MessageNotice.add' | wfLocale}}</button>\r\n        <button class=\"btn btn-secondary mr-2\" (click)=\"edit()\">{{'component.MessageNotice.edit' | wfLocale}}</button>\r\n        <button class=\"btn btn-secondary mr-2\" [disabled]=\"location!=='activity'\" (click)=\"batchCopy()\">{{'component.MessageNotice.batchCopy' | wfLocale}}</button>\r\n        <button class=\"btn btn-secondary\" (click)=\"delete()\">{{'component.MessageNotice.delete' | wfLocale}}</button>\r\n      </div>\r\n    </nav>\r\n  </div>\r\n  <div class=\"f-page-main f-utils-fill-flex-column h-100\">\r\n    <div class=\"f-utils-fill-flex-column farris-overflow-y-auto h-100\" style=\"border-radius:16px;border: 1.5px solid #F1F3F7;\">\r\n      <farris-datagrid #grid [data]=\"messageNotices\" [columns]=\"columns\" [idField]=\"'id'\" [fit]=\"true\"\r\n        [fitColumns]=\"true\" [editable]=\"false\" [pagination]=\"false\" [showCheckbox]=\"false\"\r\n        [multiSelect]=\"false\" [showLineNumber]=\"true\" lineNumberTitle=\"{{'component.MessageNotice.lineNumber'|wfLocale}}\" [lineNumberWidth]=\"50\"\r\n        [striped]=\"true\">\r\n      </farris-datagrid>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type=\"button\" class=\"btn btn-secondary btn-sm px-3 mx-2\" (click)=\"clickCancel()\">{{'component.MessageNotice.clickCancel' | wfLocale}}</button>\r\n  <button type=\"button\" class=\"btn btn-primary btn-sm px-3 mx-2\" (click)=\"clickOK()\">{{'component.MessageNotice.clickOK' | wfLocale}}</button>\r\n</ng-template>\r\n",
                    providers: [
                        WfLocalePipe,
                    ],
                    styles: [""]
                }] }
    ];
    /** @nocollapse */
    MessageNoticeComponent.ctorParameters = function () { return [
        { type: ComponentFactoryResolver },
        { type: Injector },
        { type: BsModalService },
        { type: MessagerService },
        { type: ProcessDesignerUIState },
        { type: ProcessDesignerViewModel },
        { type: HttpService },
        { type: ChangeDetectorRef, decorators: [{ type: Optional }] },
        { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
        { type: undefined, decorators: [{ type: Inject, args: [WF_LANG_RESOURCES,] }] },
        { type: WfLocalePipe, decorators: [{ type: Optional }] }
    ]; };
    MessageNoticeComponent.propDecorators = {
        cls: [{ type: HostBinding, args: ['class',] }],
        closeModal: [{ type: Output }],
        submitModal: [{ type: Output }],
        value: [{ type: Input }],
        editorParams: [{ type: Input }],
        modalFooter: [{ type: ViewChild, args: ['iconSelectFooter',] }],
        grid: [{ type: ViewChild, args: ['grid',] }]
    };
    return MessageNoticeComponent;
}());
/** @enum {string} */
var ResourceKeys = {
    batchCopyProperty: 'batchCopyProperty',
};
var MessageNoticeConverter = /** @class */ (function () {
    function MessageNoticeConverter(localePipe) {
        this.localePipe = localePipe;
    }
    /**
     * @param {?} data
     * @return {?}
     */
    MessageNoticeConverter.prototype.convertTo = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        if (data && data.length > 0) {
            return this.localePipe.transform("component.MessageNotice.set");
        }
        else {
            return this.localePipe.transform("component.MessageNotice.notSet");
        }
    };
    return MessageNoticeConverter;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var ExtendPropertyComponent = /** @class */ (function () {
    function ExtendPropertyComponent(uiState, cdr, localeId, resources, localePipe) {
        this.uiState = uiState;
        this.cdr = cdr;
        this.localeId = localeId;
        this.resources = resources;
        this.localePipe = localePipe;
        this.closeModal = new EventEmitter();
        this.submitModal = new EventEmitter();
        this.modalConfig = {
            title: this.localePipe.transform("component.extendProperty.extendProperty"),
            width: 430,
            height: 370,
            showButtons: true
        };
        this.procExtendProperty = new Array();
        this.booleanlist = [
            { key: this.localePipe.transform("component.extendProperty.true"), value: 'true' },
            { key: this.localePipe.transform("component.extendProperty.false"), value: 'false' }
        ];
        this.extendPropertyList = {
            key: '',
            value: ''
        };
        this.localePipe = this.localePipe || new WfLocalePipe(localeId, resources);
    }
    Object.defineProperty(ExtendPropertyComponent.prototype, "value", {
        set: /**
         * @param {?} property
         * @return {?}
         */
        function (property) {
            if (property && property.length > 0) {
                this.procExtendProperty = property.map((/**
                 * @param {?} p
                 * @return {?}
                 */
                function (p) { return ({
                    id: p.id,
                    code: p.code,
                    parentId: p.parentId,
                    sortOrder: p.sortOrder,
                    propertyNote: p.propertyNote,
                    propertyTitle: p.propertyTitle,
                    propertyLocation: p.propertyLocation,
                    propertyType: p.propertyType,
                    enumValue: p.enumValue,
                    bizDefKey: p.bizDefKey,
                    bizCategoryId: p.bizCategoryId,
                    startMode: p.startMode,
                    value: p.value,
                }); }));
            }
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @param {?} obj
     * @return {?}
     */
    ExtendPropertyComponent.prototype.setProperty = /**
     * @param {?} obj
     * @return {?}
     */
    function (obj) {
        this.uiState.propertyData = obj.propertyData;
        this.uiState.propertyConfig = obj.propertyConfig;
    };
    /**
     * @return {?}
     */
    ExtendPropertyComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
    };
    /**
     * @return {?}
     */
    ExtendPropertyComponent.prototype.clickOK = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var value = this.procExtendProperty;
        /** @type {?} */
        var object = { value: value, parameters: null };
        this.submitModal.emit(object);
    };
    /**
     * @return {?}
     */
    ExtendPropertyComponent.prototype.cancel = /**
     * @return {?}
     */
    function () {
        this.closeModal.emit();
    };
    ExtendPropertyComponent.decorators = [
        { type: Component, args: [{
                    selector: 'lib-extend-property',
                    template: "<div class=\"f-page\">\r\n  <div class=\"f-page-main\">\r\n    <section class=\"\">\r\n      <div class=\"f-section-header pt-2 mx-2\">\r\n      </div>\r\n      <div class=\"f-section-content\">\r\n        <div class=\"f-form-layout farris-form farris-form-controls-inline\">\r\n          <fieldset class=\"f-section-formgroup\"\r\n            style=\"flex-grow: 1; overflow-y: auto; height: 210px;\">\r\n            <div class=\"f-section-formgroup-inputs\">\r\n              <ng-container *ngFor=\"let data of procExtendProperty\">\r\n                <!-- \u6587\u672C\u578B\u5C5E\u6027\u6846 -->\r\n                <div *ngIf=\"data.propertyType === 'text'\" class=\"col-12 farris-group-auto pr-5\">\r\n                  <div class=\"farris-group-wrap\">\r\n                    <div class=\"form-group farris-form-group\">\r\n                      <label class=\"col-form-label\">\r\n                        <span class=\"farris-label-text\">{{data.propertyTitle}}</span>\r\n                      </label>\r\n                      <div class=\"farris-input-wrap ml-1\" style=\"padding-right: 30px\">\r\n                        <input-group [(ngModel)]=\"data.value\"></input-group>\r\n                        <div class=\"farris-feedback valid-feedback\"></div>\r\n                      </div>\r\n                      <span class=\"f-icon f-icon-info\" farrisPopover popoverTitle=\"{{'component.extendProperty.extendProperty'|wfLocale}}\"\r\n                        [popover]=\"data.propertyNote\" [container]=\"'body'\" [triggers]=\"'hover'\"\r\n                        [placement]=\"'left'\"></span>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n                <!-- \u679A\u4E3E\u578B\u5C5E\u6027\u6846 -->\r\n                  <div *ngIf=\"data.propertyType === 'enum'\" class=\"col-12 farris-group-auto pr-5\">\r\n                    <div class=\"farris-group-wrap\">\r\n                      <div class=\"form-group farris-form-group\">\r\n                        <label class=\"col-form-label\">\r\n                          <span class=\"farris-label-text\">{{data.propertyTitle}}</span>\r\n                        </label>\r\n                        <div class=\"farris-input-wrap ml-1\" style=\"padding-right: 30px\">\r\n                          <farris-combo-list autoHeight=\"true\" [(ngModel)]=\"data.value\" name=\"booleanProperty\"\r\n                            [idField]=\"'value'\" [textField]=\"'key'\" [valueField]=\"'value'\" [data]=\"data.enumValue\"\r\n                            placeholder=\"{{'component.extendProperty.placeholder'|wfLocale}}\">\r\n                          </farris-combo-list>\r\n                          <div class=\"farris-feedback valid-feedback\"></div>\r\n                        </div>\r\n                        <span class=\"f-icon f-icon-info\" farrisPopover popoverTitle=\"{{'component.extendProperty.illustrate'|wfLocale}}\"\r\n                          [popover]=\"data.propertyNote\" [container]=\"'body'\" [triggers]=\"'hover'\"\r\n                          [placement]=\"'left'\"></span>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                <!-- \u5E03\u5C14\u578B\u5C5E\u6027\u6846 mt-4 -->\r\n                  <div *ngIf=\"data.propertyType === 'boolean'\" class=\"col-12 farris-group-auto pr-5\">\r\n                    <div class=\"farris-group-wrap\">\r\n                      <div class=\"form-group farris-form-group\">\r\n                        <label class=\"col-form-label\">\r\n                          <span class=\"farris-label-text\">{{data.propertyTitle}}</span>\r\n                        </label>\r\n                        <div class=\"farris-input-wrap ml-1\" style=\"padding-right: 30px\">\r\n                          <farris-combo-list autoHeight=\"true\" [(ngModel)]=\"data.value\" name=\"booleanProperty\"\r\n                            [idField]=\"'value'\" [textField]=\"'key'\" [valueField]=\"'value'\" [data]=\"booleanlist\"\r\n                            placeholder=\"{{'component.extendProperty.placeholder'|wfLocale}}\">\r\n                          </farris-combo-list>\r\n                          <div class=\"farris-feedback valid-feedback\"></div>\r\n                        </div>\r\n                        <span class=\"f-icon f-icon-info\" farrisPopover popoverTitle=\"{{'component.extendProperty.illustrate'|wfLocale}}\"\r\n                          [popover]=\"data.propertyNote\" [container]=\"'body'\" [triggers]=\"'hover'\"\r\n                          [placement]=\"'left'\"></span>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n              </ng-container>\r\n            </div>\r\n          </fieldset>\r\n        </div>\r\n      </div>\r\n    </section>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type=\"button\" class=\"btn btn-secondary btn-sm mx-2\" (click)=\"cancel()\">{{'component.extendProperty.cancel' | wfLocale}}</button>\r\n  <button type=\"button\" class=\"btn btn-primary btn-sm mx-2\" (click)=\"clickOK()\">{{'component.extendProperty.clickOK' | wfLocale}}</button>\r\n</ng-template>\r\n",
                    providers: [
                        WfLocalePipe,
                    ],
                    styles: [""]
                }] }
    ];
    /** @nocollapse */
    ExtendPropertyComponent.ctorParameters = function () { return [
        { type: ProcessDesignerUIState },
        { type: ChangeDetectorRef, decorators: [{ type: Optional }] },
        { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
        { type: undefined, decorators: [{ type: Inject, args: [WF_LANG_RESOURCES,] }] },
        { type: WfLocalePipe, decorators: [{ type: Optional }] }
    ]; };
    ExtendPropertyComponent.propDecorators = {
        closeModal: [{ type: Output }],
        submitModal: [{ type: Output }],
        modalFooter: [{ type: ViewChild, args: ['iconSelectFooter',] }],
        value: [{ type: Input }]
    };
    return ExtendPropertyComponent;
}());
var ExtendPropertyConverter = /** @class */ (function () {
    function ExtendPropertyConverter(localePipe) {
        this.localePipe = localePipe;
    }
    /**
     * @param {?} data
     * @return {?}
     */
    ExtendPropertyConverter.prototype.convertTo = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        if (data && data instanceof Array && data.some((/**
         * @param {?} item
         * @return {?}
         */
        function (item) { return item.value; }))) {
            return this.localePipe.transform("component.extendProperty.set");
        }
        return this.localePipe.transform("component.extendProperty.notSet");
    };
    return ExtendPropertyConverter;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var ImageSetting = /** @class */ (function () {
    function ImageSetting() {
    }
    return ImageSetting;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var ImageSetComponent = /** @class */ (function () {
    function ImageSetComponent(message, cdr, localeId, resources, localePipe) {
        this.message = message;
        this.cdr = cdr;
        this.localeId = localeId;
        this.resources = resources;
        this.localePipe = localePipe;
        this.closeModal = new EventEmitter();
        this.submitModal = new EventEmitter();
        this.modalConfig = {
            title: this.localePipe.transform('component.imageSet.imageSet'),
            width: 520,
            height: 360,
            showButtons: true
        };
        // 影像操作权限选项列表
        this.operationList = [
            { value: 'onlyView', name: this.localePipe.transform('component.imageSet.onlyView') },
            { value: 'edit', name: this.localePipe.transform('component.imageSet.edit') },
            { value: 'reScanStart', name: this.localePipe.transform('component.imageSet.reScanStart') },
            { value: 'reScanComplete', name: this.localePipe.transform('component.imageSet.reScanComplete') }
        ];
        // 影像操作权限
        this.imageSetting = new ImageSetting();
        this.localePipe = this.localePipe || new WfLocalePipe(localeId, resources);
    }
    Object.defineProperty(ImageSetComponent.prototype, "value", {
        set: /**
         * @param {?} setValue
         * @return {?}
         */
        function (setValue) {
            if (setValue) {
                this.imageSetting.imageOperation = setValue.imageOperation;
            }
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    ImageSetComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
    };
    /**
     * @param {?} data
     * @return {?}
     */
    ImageSetComponent.prototype.changeValue = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        var _this = this;
        // 先选0再选123的时候，暂时置为0？先选123再选0则置为0√
        if (data.indexOf('onlyView') > -1) {
            setTimeout((/**
             * @return {?}
             */
            function () {
                _this.message.info(_this.localePipe.transform('component.imageSet.mutualExclusion'));
                _this.imageSetting.imageOperation = 'onlyView';
            }), 100);
        }
    };
    /**
     * @return {?}
     */
    ImageSetComponent.prototype.clickOK = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var value = this.imageSetting;
        /** @type {?} */
        var object = { value: value, parameters: null };
        this.submitModal.emit(object);
    };
    /**
     * @return {?}
     */
    ImageSetComponent.prototype.clickCancel = /**
     * @return {?}
     */
    function () {
        this.closeModal.emit();
    };
    ImageSetComponent.decorators = [
        { type: Component, args: [{
                    selector: 'lib-image-set',
                    template: "<div class=\"f-page\">\r\n  <div class=\"f-utils-fill-flex-column farris-split-section m-2 h-100\">\r\n    <section class=\"f-utils-fill-flex-column h-100\">\r\n      <!-- <div class=\"f-section-header pt-2 mx-2\">\r\n        <div class=\"f-title\">\r\n          <h4 class=\"f-title-text\">\u5F71\u50CF\u8BBE\u7F6E</h4>\r\n        </div>\r\n      </div> -->\r\n      <div class=\"f-utils-fill-flex-column h-100\">\r\n        <div class=\"farris-form form-inline farris-form-inline\">\r\n          <div class=\"col-12 farris-group-auto my-3 pr-5\">\r\n            <div class=\"farris-group-wrap\">\r\n              <div class=\"form-group farris-form-group\">\r\n                <label class=\"col-form-label\">\r\n                  <span class=\"farris-label-text\">{{'component.imageSet.imageOperation'|wfLocale}}</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap ml-1\">\r\n                  <farris-checkboxgroup [data]=\"operationList\" [(ngModel)]=\"imageSetting.imageOperation\" [horizontal]=\"true\"\r\n                  [isStringValue]=true (changeValue)=\"changeValue($event)\">\r\n                  </farris-checkboxgroup>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </section>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type=\"button\" class=\"btn btn-secondary btn-sm mx-2\" (click)=\"clickCancel()\">{{'component.imageSet.clickCancel'|wfLocale}}</button>\r\n  <button type=\"button\" class=\"btn btn-primary btn-sm mx-2\" (click)=\"clickOK()\">{{'component.imageSet.clickOK'|wfLocale}}</button>\r\n</ng-template>\r\n\r\n",
                    providers: [
                        WfLocalePipe,
                    ],
                    styles: [""]
                }] }
    ];
    /** @nocollapse */
    ImageSetComponent.ctorParameters = function () { return [
        { type: MessagerService },
        { type: ChangeDetectorRef, decorators: [{ type: Optional }] },
        { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
        { type: undefined, decorators: [{ type: Inject, args: [WF_LANG_RESOURCES,] }] },
        { type: WfLocalePipe, decorators: [{ type: Optional }] }
    ]; };
    ImageSetComponent.propDecorators = {
        closeModal: [{ type: Output }],
        submitModal: [{ type: Output }],
        value: [{ type: Input }],
        modalFooter: [{ type: ViewChild, args: ['iconSelectFooter',] }]
    };
    return ImageSetComponent;
}());
var ImageSetConverter = /** @class */ (function () {
    function ImageSetConverter(localePipe) {
        this.localePipe = localePipe;
    }
    /**
     * @param {?} data
     * @return {?}
     */
    ImageSetConverter.prototype.convertTo = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        if (data && data.imageOperation) {
            return this.localePipe.transform('component.imageSet.set');
        }
        return this.localePipe.transform('component.imageSet.notSet');
    };
    return ImageSetConverter;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/** @type {?} */
var BIF_LANG_RESOURCES = new InjectionToken("BIF_LANG_RESOURCES");
var AifLocalePipe = /** @class */ (function () {
    function AifLocalePipe(localeId, resources) {
        this.defaultLang = "zh-CHS";
        this.langCode = localeId || this.defaultLang;
        this.resources = resources || {};
        this.lang = resources[this.langCode] || resources[this.defaultLang] || {};
    }
    /**
     * @param {?} name
     * @return {?}
     */
    AifLocalePipe.prototype.transform = /**
     * @param {?} name
     * @return {?}
     */
    function (name) {
        return this.lang[name] || name;
    };
    /**
     * @param {?} name
     * @return {?}
     */
    AifLocalePipe.prototype.instant = /**
     * @param {?} name
     * @return {?}
     */
    function (name) {
        return this.transform(name);
    };
    AifLocalePipe.decorators = [
        { type: Pipe, args: [{ name: 'aifLocale' },] }
    ];
    /** @nocollapse */
    AifLocalePipe.ctorParameters = function () { return [
        { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
        { type: undefined, decorators: [{ type: Inject, args: [BIF_LANG_RESOURCES,] }] }
    ]; };
    return AifLocalePipe;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var StartConditionService = /** @class */ (function () {
    function StartConditionService() {
    }
    /**
     * @return {?}
     */
    StartConditionService.prototype.createConditionEntity = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var entity = new ConditionEntity();
        entity.id = this.generateGUID();
        entity.isEnabled = true;
        entity.type = ConditionType.COMPONENT;
        return entity;
    };
    /**
     * @return {?}
     */
    StartConditionService.prototype.generateGUID = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var d = new Date().getTime();
        /** @type {?} */
        var guid = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, (/**
         * @param {?} c
         * @return {?}
         */
        function (c) {
            /** @type {?} */
            var r = (d + Math.random() * 16) % 16 | 0;
            d = Math.floor(d / 16);
            return (c == 'x' ? r : (r & 0x3 | 0x8)).toString(16);
        }));
        return guid;
    };
    StartConditionService.decorators = [
        { type: Injectable }
    ];
    return StartConditionService;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/**
 * @abstract
 */
var  /**
 * @abstract
 */
AbstractDatagridComponent = /** @class */ (function () {
    function AbstractDatagridComponent(messager, notify, metadataService, modalService, localePipe, injector, resolver, cdf) {
        this.messager = messager;
        this.notify = notify;
        this.metadataService = metadataService;
        this.modalService = modalService;
        this.localePipe = localePipe;
        this.injector = injector;
        this.resolver = resolver;
        this.cdf = cdf;
        this.groupIcon = '<i class="f-icon f-icon-lookup"></i>';
        this.toolbarData = [
            {
                id: 'btn-add',
                text: this.localePipe.instant("add"),
                class: 'btn btn-secondary',
                disabled: false
            },
            {
                id: 'btn-remove',
                text: this.localePipe.instant("remove"),
                class: 'btn btn-secondary',
                disabled: false
            },
        ];
        this.dgIdField = "id";
        this.editingRowId = null;
    }
    Object.defineProperty(AbstractDatagridComponent.prototype, "dgTotal", {
        get: /**
         * @return {?}
         */
        function () {
            return this.dgData.length || 0;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @param {?} args
     * @return {?}
     */
    AbstractDatagridComponent.prototype.toolbarClickHandler = /**
     * @param {?} args
     * @return {?}
     */
    function (args) {
        switch (args.id) {
            case 'btn-add':
                this.add();
                break;
            case 'btn-remove':
                this.remove(null);
                break;
        }
    };
    /**
     * 开始行编辑
     * @param ctx
     */
    /**
     * 开始行编辑
     * @param {?=} ctx
     * @return {?}
     */
    AbstractDatagridComponent.prototype.startRowEdit = /**
     * 开始行编辑
     * @param {?=} ctx
     * @return {?}
     */
    function (ctx) {
        this.dg.editRow(ctx.rowData.id);
        this.editingRowId = ctx.rowData.id;
        this.cdf.detectChanges();
        return false;
    };
    /**
     * 取消行编辑
     * @param ctx
     */
    /**
     * 取消行编辑
     * @param {?=} ctx
     * @return {?}
     */
    AbstractDatagridComponent.prototype.cancelRowEdit = /**
     * 取消行编辑
     * @param {?=} ctx
     * @return {?}
     */
    function (ctx) {
        this.dg.cancelEdit(ctx.rowData.id);
        this.editingRowId = null;
        this.cdf.detectChanges();
        return false;
    };
    /**
     * 结束行编辑
     * @param ctx
     */
    /**
     * 结束行编辑
     * @param {?=} ctx
     * @return {?}
     */
    AbstractDatagridComponent.prototype.endRowEdit = /**
     * 结束行编辑
     * @param {?=} ctx
     * @return {?}
     */
    function (ctx) {
        this.dg.endRowEdit();
        this.editingRowId = null;
        this.cdf.detectChanges();
        return false;
    };
    /**
     * 行删除
     * @param ctx
     */
    /**
     * 行删除
     * @param {?} evt
     * @param {?=} ctx
     * @return {?}
     */
    AbstractDatagridComponent.prototype.remove = /**
     * 行删除
     * @param {?} evt
     * @param {?=} ctx
     * @return {?}
     */
    function (evt, ctx) {
        var e_1, _a;
        /** @type {?} */
        var ids = [];
        if (ctx == null) {
            // 批量删除
            this.dg.checkeds.forEach((/**
             * @param {?} it
             * @return {?}
             */
            function (it) {
                ids.push(it.id);
            }));
        }
        else {
            // 行内删除
            ids.push(ctx.rowData.id);
        }
        if (ids.length == 0) {
            this.notify.warning(this.localePipe.instant("pleaseSelectOneItemAtLeast"));
            if (evt != null) {
                evt.stopPropagation();
            }
            return false;
        }
        try {
            for (var ids_1 = __values(ids), ids_1_1 = ids_1.next(); !ids_1_1.done; ids_1_1 = ids_1.next()) {
                var id = ids_1_1.value;
                this.dg.deleteRow(id);
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (ids_1_1 && !ids_1_1.done && (_a = ids_1.return)) _a.call(ids_1);
            }
            finally { if (e_1) throw e_1.error; }
        }
        this.dgData = this.dg.data;
        if (this.editingRowId != null) {
            if (ids.includes(this.editingRowId)) {
                this.editingRowId = null;
            }
            else {
                this.dg.editRow(this.editingRowId);
            }
        }
        this.cdf.detectChanges();
        if (evt != null) {
            evt.stopPropagation();
        }
        return false;
    };
    /**
     * 行移动
     * @param ctx datagrid上下文
     * @param direction -1: 上移， 1：下移
     */
    /**
     * 行移动
     * @param {?} evt
     * @param {?} ctx datagrid上下文
     * @param {?} direction -1: 上移， 1：下移
     * @return {?}
     */
    AbstractDatagridComponent.prototype.rowMove = /**
     * 行移动
     * @param {?} evt
     * @param {?} ctx datagrid上下文
     * @param {?} direction -1: 上移， 1：下移
     * @return {?}
     */
    function (evt, ctx, direction) {
        // const arr = dg.data;
        /** @type {?} */
        var arr = this.dgData;
        /** @type {?} */
        var index = this.findIndex(arr, ctx.rowData.id);
        if (index == -1 || (direction == 1 && index == arr.length - 1) || (direction == -1 && index == 0)) {
            return;
        }
        arr[index] = [arr[index + direction], arr[index + direction] = arr[index]][0];
        this.dgData = __spread(this.dgData);
        this.cdf.detectChanges();
        if (evt != null) {
            evt.stopPropagation();
        }
        return false;
    };
    /**
     * 查找数组中指定id的元素下标
     * @param arr 数组
     * @param id 数组唯一标识
     * @returns 元素下标
     */
    /**
     * 查找数组中指定id的元素下标
     * @protected
     * @param {?} arr 数组
     * @param {?} id 数组唯一标识
     * @return {?} 元素下标
     */
    AbstractDatagridComponent.prototype.findIndex = /**
     * 查找数组中指定id的元素下标
     * @protected
     * @param {?} arr 数组
     * @param {?} id 数组唯一标识
     * @return {?} 元素下标
     */
    function (arr, id) {
        /** @type {?} */
        var index = -1;
        for (var i = 0; i < arr.length; i++) {
            /** @type {?} */
            var elt = arr[i];
            if (elt.id == id) {
                index = i;
                break;
            }
        }
        return index;
    };
    return AbstractDatagridComponent;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/** @type {?} */
var LANG_RESOURCES = {
    "zh-CHS": {
        "startCondition": "启动条件",
        "yes": "是",
        "no": "否",
        "confirm": "确定",
        "edit": "编辑",
        "moveUp": "上移",
        "moveDown": "下移",
        "add": "新增",
        "remove": "删除",
        "isEnabled": "是否启用",
        "type": "类型",
        "commonComponent": "通用构件",
        "expression": "表达式",
        "billAction": "业务动作",
        "content": "内容",
        "description": "描述",
        "operation": "操作",
        "typeMustNotBeNull": "类型不可为空",
        "contentMustNotBeNull": "内容不可为空",
        "commonComponentMetadataSelector": "通用构件选择",
        "pleaseSelectOneItemAtLeast": "请至少选择一条数据",
        "pleaseEndCurrentRowEditing": "请先结束当前行编辑",
    },
    "en": {
        "startCondition": "Start Condition",
        "yes": "Yes",
        "no": "No",
        "confirm": "Confirm",
        "edit": "Edit",
        "moveUp": "Move Up",
        "moveDown": "Move Down",
        "add": "Add",
        "remove": "Remove",
        "isEnabled": "Is Enabled",
        "type": "Type",
        "commonComponent": "Common Component",
        "expression": "Expression",
        "billAction": "Bill Action",
        "content": "Content",
        "description": "Description",
        "operation": "Operation",
        "typeMustNotBeNull": "Type must not be null",
        "contentMustNotBeNull": "Content must not be null",
        "commonComponentMetadataSelector": "Common Component Selector",
        "pleaseSelectOneItemAtLeast": "Please select one item at least",
        "pleaseEndCurrentRowEditing": "Please end current row editing",
    },
    "zh-CHT": {
        "startCondition": "啓動條件",
        "yes": "是",
        "no": "否",
        "confirm": "確定",
        "edit": "編輯",
        "moveUp": "上移",
        "moveDown": "下移",
        "add": "新增",
        "remove": "刪除",
        "isEnabled": "是否啓用",
        "type": "類型",
        "commonComponent": "通用構件",
        "expression": "表達式",
        "billAction": "業務動作",
        "content": "內容",
        "description": "描述",
        "operation": "操作",
        "typeMustNotBeNull": "類型不可爲空",
        "contentMustNotBeNull": "內容不可爲空",
        "commonComponentMetadataSelector": "通用構件選擇",
        "pleaseSelectOneItemAtLeast": "請至少選擇壹條數據",
        "pleaseEndCurrentRowEditing": "請先結束當前行編輯",
    }
};

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var ɵ0 = LANG_RESOURCES;
var StartConditionComponent = /** @class */ (function (_super) {
    __extends(StartConditionComponent, _super);
    function StartConditionComponent(startConditionService, designerState, metadata, expr, des, messager, notify, modal, framework, router, activatedRoute, loading, localeId, localePipe, cfr, cdf, inj) {
        var _this = _super.call(this, messager, notify, metadata, modal, localePipe, inj, cfr, cdf) || this;
        _this.startConditionService = startConditionService;
        _this.designerState = designerState;
        _this.metadata = metadata;
        _this.expr = expr;
        _this.des = des;
        _this.messager = messager;
        _this.notify = notify;
        _this.modal = modal;
        _this.framework = framework;
        _this.router = router;
        _this.activatedRoute = activatedRoute;
        _this.loading = loading;
        _this.localePipe = localePipe;
        _this.cfr = cfr;
        _this.cdf = cdf;
        _this.inj = inj;
        _this.groupIcon = '<i class="f-icon f-icon-lookup"></i>';
        _this.closeModal = new EventEmitter();
        _this.submitModal = new EventEmitter();
        _this.editorParams = {};
        _this.modalConfig = {
            title: '启动条件',
            width: 900,
            height: 400,
            showButtons: true,
            showHeader: false
        };
        _this.dgIdField = "id";
        _this.designedConditionEntities = new Array();
        _this.editingRowId = null;
        _this.canEdit = true;
        _this.beforeEdit = (/**
         * @param {...?} args
         * @return {?}
         */
        function () {
            var args = [];
            for (var _i = 0; _i < arguments.length; _i++) {
                args[_i] = arguments[_i];
            }
            // console.log('Before Edit', args);
            return of$1(true);
        });
        _this.afterEdit = (/**
         * @param {?} rowIndex
         * @param {?} rowData
         * @param {...?} args
         * @return {?}
         */
        function (rowIndex, rowData) {
            var args = [];
            for (var _i = 2; _i < arguments.length; _i++) {
                args[_i - 2] = arguments[_i];
            }
            if (rowData.component && rowData.component.compMetadataId) {
                return of$1(true);
            }
            else if (rowData.expression && rowData.expression.exprContent) {
                return of$1(true);
            }
            else {
                _this.notify.warning(_this.localePipe.instant("eventRouterConditionsContentCantBeEmpty"));
                return of$1(false);
            }
        });
        return _this;
    }
    Object.defineProperty(StartConditionComponent.prototype, "value", {
        set: /**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            data = data ? data : '[]';
            /** @type {?} */
            var conditionEntities = data ? [] : BpmnModelJsonHelper.FromJson(data, ConditionEntity);
            this.designedConditionEntities = conditionEntities.map((/**
             * @param {?} item
             * @return {?}
             */
            function (item) {
                /** @type {?} */
                var entity = {
                    id: item.id,
                    isEnabled: item.isEnabled,
                    name: item.name,
                    type: item.type,
                    remarks: item.remarks,
                    component: {},
                    expression: {},
                };
                if (entity.type == ConditionType.COMPONENT) {
                    /** @type {?} */
                    var compCondCont = new ComponentConditionContent();
                    compCondCont.LoadFromJson(item.content);
                    entity.component.compId = compCondCont.componentId;
                    entity.component.compMetadataId = compCondCont.componentMetadataId;
                    entity.component.compName = compCondCont.name;
                    entity.displayedContent = entity.component.compName;
                }
                else if (entity.type == ConditionType.EXPRESSION) {
                    /** @type {?} */
                    var exprContent = new ExpressionConditionContent();
                    exprContent.LoadFromJson(item.content);
                    entity.expression.exprContent = exprContent.expressionContent;
                    entity.displayedContent = entity.expression.exprContent;
                }
                return entity;
            }));
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(StartConditionComponent.prototype, "dgData", {
        get: /**
         * @return {?}
         */
        function () {
            return this.designedConditionEntities;
        },
        set: /**
         * @param {?} arr
         * @return {?}
         */
        function (arr) {
            this.designedConditionEntities = arr;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(StartConditionComponent.prototype, "dgTotal", {
        get: /**
         * @return {?}
         */
        function () {
            return this.dgData.length || 0;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    StartConditionComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        this.configDgColumns();
    };
    /**
     * @return {?}
     */
    StartConditionComponent.prototype.clickOk = /**
     * @return {?}
     */
    function () {
        if (this.dg.isEditing() || this.editingRowId != null) {
            return;
        }
        /** @type {?} */
        var conditionEntities = this.designedConditionEntities.map((/**
         * @param {?} entity
         * @return {?}
         */
        function (entity) {
            /** @type {?} */
            var item = new ConditionEntity();
            item.id = entity.id;
            item.isEnabled = entity.isEnabled;
            item.name = entity.name;
            item.type = entity.type;
            item.remarks = entity.remarks;
            if (entity.type == ConditionType.COMPONENT) {
                /** @type {?} */
                var compCondCont = new ComponentConditionContent();
                compCondCont.name = entity.component.compName;
                compCondCont.componentId = entity.component.compId;
                compCondCont.componentMetadataId = entity.component.compMetadataId;
                item.content = compCondCont.ConvertToJson();
            }
            else if (entity.type == ConditionType.EXPRESSION) {
                /** @type {?} */
                var exprContent = new ExpressionConditionContent();
                exprContent.expressionContent = entity.expression.exprContent;
                item.content = exprContent.ConvertToJson();
            }
            return item;
        }));
        /** @type {?} */
        var val = BpmnModelJsonHelper.ToJson(conditionEntities);
        /** @type {?} */
        var obj = { value: val, parameters: null };
        this.submitModal.emit(obj);
    };
    /**
     * @return {?}
     */
    StartConditionComponent.prototype.clickCancel = /**
     * @return {?}
     */
    function () {
        this.closeModal.emit();
    };
    /**
     * @return {?}
     */
    StartConditionComponent.prototype.load = /**
     * @return {?}
     */
    function () {
        throw new Error('Method not implemented.');
    };
    /**
     * @param {?} args
     * @return {?}
     */
    StartConditionComponent.prototype.toolbarClickHandler = /**
     * @param {?} args
     * @return {?}
     */
    function (args) {
        switch (args.id) {
            case 'btn-add':
                this.add();
                break;
            case 'btn-remove':
                this.remove(null);
                break;
        }
    };
    /**
     * @return {?}
     */
    StartConditionComponent.prototype.add = /**
     * @return {?}
     */
    function () {
        var _this = this;
        if (this.dg.isEditing() == false || this.dg.isEditing() == null) {
            /** @type {?} */
            var newItem_1 = this.startConditionService.createConditionEntity();
            /** @type {?} */
            var newEntity = {
                id: newItem_1.id,
                name: newItem_1.name,
                type: newItem_1.type,
                isEnabled: newItem_1.isEnabled,
                remarks: newItem_1.remarks,
                component: {},
                expression: {},
            };
            this.dgData = __spread(this.dgData, [newEntity]);
            this.cdf.detectChanges();
            setTimeout((/**
             * @return {?}
             */
            function () {
                _this.dg.editRow(newItem_1.id);
                _this.editingRowId = newItem_1.id;
            }), 0);
        }
        else {
            this.notify.warning(this.localePipe.instant("pleaseEndCurrentRowEditing"));
        }
    };
    /**
     * 行删除
     * @param ctx
     */
    /**
     * 行删除
     * @param {?} evt
     * @param {?=} ctx
     * @return {?}
     */
    StartConditionComponent.prototype.remove = /**
     * 行删除
     * @param {?} evt
     * @param {?=} ctx
     * @return {?}
     */
    function (evt, ctx) {
        var e_1, _a;
        /** @type {?} */
        var ids = [];
        if (ctx == null) {
            // 批量删除
            this.dg.checkeds.forEach((/**
             * @param {?} it
             * @return {?}
             */
            function (it) {
                ids.push(it.id);
            }));
        }
        else {
            // 行内删除
            ids.push(ctx.rowData.id);
        }
        if (ids.length == 0) {
            this.notify.warning(this.localePipe.instant("pleaseSelectOneItemAtLeast"));
            if (evt != null) {
                evt.stopPropagation();
            }
            return false;
        }
        try {
            for (var ids_1 = __values(ids), ids_1_1 = ids_1.next(); !ids_1_1.done; ids_1_1 = ids_1.next()) {
                var id = ids_1_1.value;
                this.dg.deleteRow(id);
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (ids_1_1 && !ids_1_1.done && (_a = ids_1.return)) _a.call(ids_1);
            }
            finally { if (e_1) throw e_1.error; }
        }
        this.dgData = this.dg.data;
        if (this.editingRowId != null) {
            if (ids.includes(this.editingRowId)) {
                this.editingRowId = null;
            }
            else {
                this.dg.editRow(this.editingRowId);
            }
        }
        this.cdf.detectChanges();
        if (evt != null) {
            evt.stopPropagation();
        }
        return false;
    };
    /**
     * @param {?} e
     * @return {?}
     */
    StartConditionComponent.prototype.selectContent = /**
     * @param {?} e
     * @return {?}
     */
    function (e) {
        switch (e.form.value.type) {
            case ConditionType.COMPONENT:
                this.selectCommonComp(e);
                break;
            case ConditionType.EXPRESSION:
                this.showExpression(e);
                break;
            // case ConditionType.FULL_EXPRESSION:
            //   this.showExpression(e);
            //   break;
            // case ConditionType.INCREMENTAL_EXPRESSION:
            //   this.showExpression(e);
            //   break;
            case ConditionType.VOACTION:
                this.selectVOAction(e);
                break;
        }
    };
    /**
     * @param {?} e
     * @return {?}
     */
    StartConditionComponent.prototype.selectCommonComp = /**
     * @param {?} e
     * @return {?}
     */
    function (e) {
        /** @type {?} */
        var compFactory = this.cfr.resolveComponentFactory(SelectMetadataRTComponent);
        /** @type {?} */
        var compRef = compFactory.create(this.inj);
        compRef.instance.typeList = "CommonComponent";
        // compRef.instance.boId = `${this.processContent.upBillBoId},${this.processContent.downBillBoId}`;
        compRef.instance.selectedMetadata.subscribe((/**
         * @param {?} metadata4RefDto
         * @return {?}
         */
        function (metadata4RefDto) {
            /** @type {?} */
            var content = new ComponentConditionContent();
            /** @type {?} */
            var metadata = metadata4RefDto.metadata;
            /** @type {?} */
            var entity = e.form.bindingData;
            entity.component.compName = metadata.name;
            entity.component.compMetadataId = metadata.id;
            /** @type {?} */
            var metadataContent = JSON.parse(metadata.content);
            entity.component.compId = metadataContent.id || metadataContent.Id || metadataContent.ID || metadata.id;
            entity.displayedContent = entity.component.compName;
            e.formControl.setValue(entity.displayedContent);
            e.instance.cd.detectChanges();
        }));
        /** @type {?} */
        var modalConfig = {
            title: this.localePipe.instant("commonComponentMetadataSelector"),
            width: 930,
            height: 573,
            showButtons: false
        };
        /** @type {?} */
        var dialog = this.modal.show(compRef, modalConfig);
        compRef.instance.closeModalEmitter.subscribe((/**
         * @param {?} $event
         * @return {?}
         */
        function ($event) { return dialog.close(); }));
    };
    /**
     * @param {?} e
     * @return {?}
     */
    StartConditionComponent.prototype.selectVOAction = /**
     * @param {?} e
     * @return {?}
     */
    function (e) {
    };
    /**
     * @param {?} e
     * @return {?}
     */
    StartConditionComponent.prototype.showExpression = /**
     * @param {?} e
     * @return {?}
     */
    function (e) {
        var _this = this;
        var e_2, _a, e_3, _b;
        // this.expr.clearContext();
        /** @type {?} */
        var context = new Array();
        if (this.designerState.subActivityContext.length > 0) {
            var _loop_1 = function (variable) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    context.push(variable);
                }
            };
            try {
                for (var _c = __values(this.designerState.subActivityContext), _d = _c.next(); !_d.done; _d = _c.next()) {
                    var variable = _d.value;
                    _loop_1(variable);
                }
            }
            catch (e_2_1) { e_2 = { error: e_2_1 }; }
            finally {
                try {
                    if (_d && !_d.done && (_a = _c.return)) _a.call(_c);
                }
                finally { if (e_2) throw e_2.error; }
            }
        }
        if (context.length > 0) {
            try {
                for (var context_1 = __values(context), context_1_1 = context_1.next(); !context_1_1.done; context_1_1 = context_1.next()) {
                    var v = context_1_1.value;
                    this.expr.addContext(v);
                }
            }
            catch (e_3_1) { e_3 = { error: e_3_1 }; }
            finally {
                try {
                    if (context_1_1 && !context_1_1.done && (_b = context_1.return)) _b.call(context_1);
                }
                finally { if (e_3) throw e_3.error; }
            }
        }
        this.expr.addExpressionText(e.formControl.value);
        this.configExpressionExpendFuncs();
        /** @type {?} */
        var schema$ = this.des.getSchemaById(this.editorParams.voId);
        schema$.subscribe((/**
         * @param {?} schema
         * @return {?}
         */
        function (schema) {
            _this.expr.addNewSchema(schema.name, schema);
            _this.expr.addInjectedEntity(schema.entityTypes[0].code, schema.name, schema.entityTypes[0].code, InjectedType.EntityType);
            _this.expr.buildExpression(!_this.canEdit).then((/**
             * @param {?} expressioninfo
             * @return {?}
             */
            function (expressioninfo) {
                /** @type {?} */
                var content = new ExpressionConditionContent();
                /** @type {?} */
                var temp = expressioninfo;
                /** @type {?} */
                var entity = e.form.bindingData;
                entity.expression.exprContent = temp;
                entity.displayedContent = entity.expression.exprContent;
                e.formControl.setValue(entity.displayedContent);
                e.instance.cd.detectChanges();
                //点击确定后，去除表达式里面的新增的上下文变量
                if (context.length > 0) {
                    _this.expr.exprEntity.contextEntities = _this.expr.exprEntity.contextEntities.filter((/**
                     * @param {?} x
                     * @return {?}
                     */
                    function (x) { return !context.some((/**
                     * @param {?} y
                     * @return {?}
                     */
                    function (y) { return y.key === x.key; })); }));
                }
            }));
        }));
    };
    /**
     * @param {?} e
     * @return {?}
     */
    StartConditionComponent.prototype.clearContent = /**
     * @param {?} e
     * @return {?}
     */
    function (e) {
        /** @type {?} */
        var entity = e.form.bindingData;
        entity.displayedContent = null;
        //构件
        entity.component.compName = null;
        entity.component.compMetadataId = null;
        entity.component.compId = null;
        //表达式
        entity.expression.exprContent = null;
        //VO动作
        e.formControl.setValue(null);
        e.instance.cd.detectChanges();
    };
    /**
     * @return {?}
     */
    StartConditionComponent.prototype.configDgColumns = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.dgColumns = [
            // { field: 'id', title: this.localePipeService.instant("id"), width: 160 },
            {
                field: 'isEnabled', title: this.localePipe.instant("isEnabled"), width: 100, template: this.dgIsEnabledStateCell,
            },
            {
                field: 'type', title: this.localePipe.instant("type"), width: 120,
                editor: {
                    type: EditorTypes.SELECT,
                    options: {
                        idField: "value",
                        valueField: 'value',
                        textField: 'text',
                        data: [
                            // { value: ConditionType.VOACTION, text: this.localePipeService.instant("billAction") },
                            // { value: ConditionType.EXPRESSION, text: this.localePipe.instant("expression") },
                            { value: ConditionType.COMPONENT, text: this.localePipe.instant("commonComponent") },
                        ]
                    },
                    validators: [
                        { type: 'required', messager: this.localePipe.instant("typeMustNotBeNull") },
                    ]
                },
                validators: [
                    { type: 'required' },
                ],
                formatter: (/**
                 * @param {?} value
                 * @param {?} rowData
                 * @param {?} rowIndex
                 * @return {?}
                 */
                function (value, rowData, rowIndex) {
                    switch (value) {
                        case ConditionType.COMPONENT:
                            return _this.localePipe.instant("commonComponent");
                        case ConditionType.EXPRESSION:
                            return _this.localePipe.instant("expression");
                        // case ConditionType.FULL_EXPRESSION:
                        //   return this.localePipe.instant("fullExpression");
                        // case ConditionType.INCREMENTAL_EXPRESSION:
                        //   return this.localePipe.instant("incrementalExpression");
                        case ConditionType.VOACTION:
                            return _this.localePipe.instant("billAction");
                        default:
                            return "Unknown";
                    }
                })
            },
            {
                field: "displayedContent", title: this.localePipe.instant("content"), width: 200,
                editor: {
                    type: EditorTypes.INPUTGROUP,
                    options: {
                        groupText: this.groupIcon,
                        editable: false,
                        clickHandle: (/**
                         * @param {?} e
                         * @return {?}
                         */
                        function (e) {
                            _this.selectContent(e);
                        }),
                        clear: (/**
                         * @param {?} e
                         * @return {?}
                         */
                        function (e) {
                            _this.clearContent(e);
                        }),
                    },
                    validators: [
                        { type: 'required', messager: this.localePipe.instant("contentMustNotBeNull") }
                    ]
                },
                validators: [
                    { type: 'required' },
                ],
            },
            {
                field: 'remarks', title: this.localePipe.instant("description"), width: 200,
                editor: {
                    type: EditorTypes.TEXTAREA, options: {},
                }
            },
            { field: null, title: this.localePipe.instant("operation"), width: 250, template: this.dgOpCell, halign: 'center', align: 'center' },
        ];
    };
    /**
     * @param {?} param
     * @return {?}
     */
    StartConditionComponent.prototype.beginEdit = /**
     * @param {?} param
     * @return {?}
     */
    function (param) {
        // console.log('Begin Edit', param);
        this.editingRowId = param.rowData.id;
        /** @type {?} */
        var editors = param.gridInstance.getEditors();
        /** @type {?} */
        var select = editors[0];
        select.instance.formControl.valueChanges.subscribe((/**
         * @param {?} val
         * @return {?}
         */
        function (val) {
            if (select.instance.dr.form.bindingData.type != val) {
                select.instance.group.bindingData.displayedContent = null;
                select.instance.group.controls.displayedContent.setValue(null);
                select.instance.group.bindingData.remarks = null;
                select.instance.group.controls.remarks.setValue(null);
                select.instance.dr.cd.detectChanges();
            }
        }));
    };
    /**
     * @param {...?} args
     * @return {?}
     */
    StartConditionComponent.prototype.endEdit = /**
     * @param {...?} args
     * @return {?}
     */
    function () {
        var args = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            args[_i] = arguments[_i];
        }
        // console.log('End Edit', args);
        this.editingRowId = null;
    };
    /**
     * @param {...?} args
     * @return {?}
     */
    StartConditionComponent.prototype.cancelEdited = /**
     * @param {...?} args
     * @return {?}
     */
    function () {
        var args = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            args[_i] = arguments[_i];
        }
        // console.log('取消编辑', args);
        this.editingRowId = null;
    };
    /**
     * @return {?}
     */
    StartConditionComponent.prototype.configExpressionExpendFuncs = /**
     * @return {?}
     */
    function () {
        // let changeDetails: VarEntity =
        // {
        //   key: "changeDetails",
        //   name: "业务实体变更集列表",
        //   description: "业务实体变更集列表"
        // }
        // this.expr.addContext(changeDetails);
    };
    StartConditionComponent.decorators = [
        { type: Component, args: [{
                    selector: 'lib-start-condition',
                    template: "<div class=\"f-page f-page-is-managelist p-2\">\r\n  <div class=\"f-page-header-base\" style=\"min-height: unset;\">\r\n    <div class=\"f-title\">\r\n      <span class=\"f-title-icon f-text-orna-param\">\r\n        <i class=\"f-icon f-icon-clock\"></i>\r\n      </span>\r\n      <h4 class=\"f-title-text\" style=\"font-size: 1rem;\">\r\n        {{ 'startCondition' | aifLocale }}\r\n      </h4>\r\n    </div>\r\n    <f-response-toolbar class=\"f-toolbar\" #toolbar [datas]=\"toolbarData\" (rtClickEvent)=\"toolbarClickHandler($event)\"\r\n      [style.display]=\"canEdit==false?'none':null\">\r\n    </f-response-toolbar>\r\n  </div>\r\n  <div class=\"f-utils-fill-flex-column\">\r\n    <farris-datagrid #dg=\"datagrid\" [columns]=\"dgColumns\" [data]=\"dgData\" [editable]=\"canEdit\" [editMode]=\"'row'\"\r\n      [idField]=\"dgIdField\" [showLineNumber]=\"true\" [striped]=\"false\" [showBorder]=\"true\" [pagination]=\"false\"\r\n      [showAllCheckbox]=\"true\" [selectOnCheck]=\"false\" [checkOnSelect]=\"false\" [onlySelectSelf]=\"true\"\r\n      [showCheckbox]=\"true\" [multiSelect]=\"true\" [keepSelect]=\"true\" [fitColumns]=\"true\" [fit]=\"true\"\r\n      [virtualized]=\"false\" [clickToEdit]=\"false\" [beforeEdit]=\"beforeEdit\" (beginEdit)=\"beginEdit($event)\"\r\n      [afterEdit]=\"afterEdit\" (endEdit)=\"endEdit($event)\" (cancelEdited)=\"cancelEdited($event)\">\r\n    </farris-datagrid>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #dgIsEnabledStateCell let-ctx>\r\n  <div class=\"f-datagrid-cell-formgroup farris-group-auto\" style=\"line-height: 100%;\">\r\n    <farris-switch checked id=\"isEnabled\" [disabled]=\"!canEdit\" checkedLabel=\"{{'yes'|aifLocale}}\"\r\n      uncheckedLabel=\"{{'no'|aifLocale}}\" [(ngModel)]=\"ctx.rowData.isEnabled\"></farris-switch>\r\n  </div>\r\n</ng-template>\r\n\r\n<ng-template #dgOpCell let-ctx>\r\n  <ng-container\r\n    *ngIf=\"dg.isEditing()!=false&&dg.isEditing()!=null&&dg.selectedRow.id==ctx.rowData.id; else elseTemplate\">\r\n    <button class=\"btn btn-link mr-2\" [disabled]=\"!canEdit\" (click)=\"endRowEdit(ctx)\" title=\"{{'confirm'|aifLocale}}\">\r\n      <span class=\"f-icon f-icon-check\" [ngClass]=\"{'f-pretend-link': canEdit}\"\r\n        style=\"width: 20px; height: 20px; font-size: 20px;\"></span>\r\n    </button>\r\n  </ng-container>\r\n  <ng-template #elseTemplate>\r\n    <button class=\"btn btn-link mr-2\" [disabled]=\"!canEdit\" (click)=\"startRowEdit(ctx)\" title=\"{{'edit'|aifLocale}}\">\r\n      <span class=\"f-icon f-icon-edit-button\" [ngClass]=\"{'f-pretend-link': canEdit}\"\r\n        style=\"width: 20px; height: 20px; font-size: 20px;\"></span>\r\n    </button>\r\n  </ng-template>\r\n  <button class=\"btn btn-link mr-2\" [disabled]=\"!canEdit\" (click)=\"rowMove($event, ctx, -1)\"\r\n    title=\"{{'moveUp'|aifLocale}}\">\r\n    <span class=\"f-icon f-icon-arrow-seek-up\" [ngClass]=\"{'f-pretend-link': canEdit}\"\r\n      style=\"width: 20px; height: 20px; font-size: 20px;\"></span>\r\n  </button>\r\n  <button class=\"btn btn-link mr-2\" [disabled]=\"!canEdit\" (click)=\"rowMove($event, ctx, 1)\"\r\n    title=\"{{'moveDown'|aifLocale}}\">\r\n    <span class=\"f-icon f-icon-arrow-seek-down\" [ngClass]=\"{'f-pretend-link': canEdit}\"\r\n      style=\"width: 20px; height: 20px; font-size: 20px;\"></span>\r\n  </button>\r\n  <button class=\"btn btn-link mr-2\" [disabled]=\"!canEdit\" (click)=\"remove($event, ctx)\" title=\"{{'remove'|aifLocale}}\">\r\n    <span class=\"f-icon f-icon-delete\" [ngClass]=\"{'f-pretend-link': canEdit}\"\r\n      style=\"width: 20px; height: 20px; font-size: 20px;\"></span>\r\n  </button>\r\n</ng-template>\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type=\"button\" class=\"btn btn-secondary btn-sm px-3 mx-2\" (click)=\"clickCancel()\">\u53D6\u6D88</button>\r\n  <button type=\"button\" class=\"btn btn-primary btn-sm px-3 mx-2\" (click)=\"clickOk()\">\u786E\u5B9A</button>\r\n</ng-template>\r\n",
                    providers: [
                        { provide: BIF_LANG_RESOURCES, useValue: ɵ0 },
                        AifLocalePipe,
                        StartConditionService,
                    ],
                    styles: [""]
                }] }
    ];
    /** @nocollapse */
    StartConditionComponent.ctorParameters = function () { return [
        { type: StartConditionService },
        { type: ProcessDesignerUIState },
        { type: GSPMetadataRTService },
        { type: ExpressionService },
        { type: DataEntityService },
        { type: MessagerService },
        { type: NotifyService },
        { type: BsModalService },
        { type: FrameworkService },
        { type: Router },
        { type: ActivatedRoute },
        { type: LoadingService },
        { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
        { type: AifLocalePipe },
        { type: ComponentFactoryResolver },
        { type: ChangeDetectorRef },
        { type: Injector }
    ]; };
    StartConditionComponent.propDecorators = {
        closeModal: [{ type: Output }],
        submitModal: [{ type: Output }],
        value: [{ type: Input }],
        editorParams: [{ type: Input }],
        modalFooter: [{ type: ViewChild, args: ['iconSelectFooter',] }],
        dg: [{ type: ViewChild, args: ["dg",] }],
        dgIsEnabledStateCell: [{ type: ViewChild, args: ["dgIsEnabledStateCell",] }],
        dgOpCell: [{ type: ViewChild, args: ["dgOpCell",] }]
    };
    return StartConditionComponent;
}(AbstractDatagridComponent));
var StartConditionConverter = /** @class */ (function () {
    function StartConditionConverter() {
    }
    /**
     * @param {?} data
     * @return {?}
     */
    StartConditionConverter.prototype.convertTo = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        if (data && data.StartCondition) {
            return '（已设置）';
        }
        return '（未设置）';
    };
    return StartConditionConverter;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/** @enum {string} */
var ProcessPropertyKeys = {
    Id: "Id",
    Name: "Name",
    NameLanguage: "NameLanguage",
    ClrTypeID: "ClrTypeID",
    Key: "Key",
    /**
     * 分支条件
     */
    ConditionExpression: 'ConditionExpression',
    /**
     * 流程备注
     */
    wf_TitleExpression: 'wf_TitleExpression',
    /**
     * 默认分支
     */
    Default: 'Default',
    startMode: "startMode",
    wf_ExecuteForms_PC: "wf_ExecuteForms_PC",
    wf_ExecuteForms_Mobile: "wf_ExecuteForms_Mobile",
    wf_Component: "wf_Component",
    processVariables: "processVariables",
    wf_CustomizeAction: "wf_CustomizeAction",
    enablePriority: "enablePriority",
    imageSettings: "imageSettings",
    timeLimitControl: "timeLimitControl",
    messageNotice: "messageNotice",
    allowPreAssign: "allowPreAssign",
    EntryForm: "EntryForm",
    DisplayTerminal: "DisplayTerminal",
    StartCondition: "StartCondition",
    /**
     * 整单撤回审核中单据
     */
    enableWholeOrderRetrieve: 'enableWholeOrderRetrieve',
};

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var BpmnProcessViewModel = /** @class */ (function () {
    function BpmnProcessViewModel(uiState, localPipe) {
        this.uiState = uiState;
        this.localPipe = localPipe;
    }
    /**
     * @param {?} obj
     * @return {?}
     */
    BpmnProcessViewModel.prototype.setProcessProperty = /**
     * @param {?} obj
     * @return {?}
     */
    function (obj) {
        this.uiState.propertyData = obj.propertyData;
        this.uiState.ProcessVariables = this.uiState.propertyData[ProcessPropertyKeys.processVariables];
        this.uiState.propertyConfig = this.setProcessConfig(obj.propertyConfig);
    };
    /**
     * @param {?} obj
     * @return {?}
     */
    BpmnProcessViewModel.prototype.setProcessConfig = /**
     * @param {?} obj
     * @return {?}
     */
    function (obj) {
        var _this = this;
        /** @type {?} */
        var propertyConfig = [];
        if (obj) {
            obj.forEach((/**
             * @param {?} element
             * @return {?}
             */
            function (element) {
                _this.setProcessEntity(element.properties);
                propertyConfig.push(element);
            }));
        }
        return propertyConfig;
    };
    /**
     * @private
     * @param {?} obj
     * @return {?}
     */
    BpmnProcessViewModel.prototype.setProcessEntity = /**
     * @private
     * @param {?} obj
     * @return {?}
     */
    function (obj) {
        var _this = this;
        if (obj.length > 0) {
            obj.forEach((/**
             * @param {?} item
             * @return {?}
             */
            function (item) {
                switch (item.propertyID) {
                    case ProcessPropertyKeys.Key: // 标识
                        break;
                    case ProcessPropertyKeys.EntryForm: // 流程分类
                        item.editor = EntryFormEditorComponent;
                        item.converter = new FlowFormConverter();
                        // item.editorParams = {
                        //     flowForms: [this.uiState.flowFormInfo.flowForm]
                        // };
                        break;
                    case ProcessPropertyKeys.wf_Component:
                        item.editor = ActivityComponentComponent;
                        item.converter = new ActivityComponentConverter(_this.localPipe);
                        item.editorParams = {
                            location: 'process'
                        };
                        break;
                    case ProcessPropertyKeys.wf_ExecuteForms_PC:
                        item.editor = ExecuteFormsComponent;
                        /** @type {?} */
                        var params = {
                            location: 'process',
                            tab: 'web'
                        };
                        item.converter = new ExecuteFormsConverter(params, _this.localPipe);
                        item.editorParams = params;
                        break;
                    case ProcessPropertyKeys.wf_ExecuteForms_Mobile:
                        item.editor = ExecuteFormsComponent;
                        /** @type {?} */
                        var editorParams = {
                            location: 'process',
                            tab: 'mobile'
                        };
                        item.converter = new ExecuteFormsConverter(editorParams, _this.localPipe);
                        item.editorParams = editorParams;
                        break;
                    case ProcessPropertyKeys.wf_TitleExpression:
                        item.editor = TitleExpressionComponent;
                        item.converter = new TitleExpressionConverter(_this.localPipe);
                        break;
                    case ProcessPropertyKeys.allowPreAssign:
                        item.iterator = _this.uiState.boolIterator;
                        break;
                    case ProcessPropertyKeys.enablePriority:
                        item.iterator = _this.uiState.boolIterator;
                        break;
                    case ProcessPropertyKeys.enableWholeOrderRetrieve:
                        item.iterator = _this.uiState.boolIterator;
                        break;
                    case ProcessPropertyKeys.startMode:
                        item.iterator = _this.uiState.startModeIterator;
                        break;
                    case ProcessPropertyKeys.DisplayTerminal:
                        item.iterator = _this.uiState.displayTerminal;
                        break;
                    case ProcessPropertyKeys.wf_CustomizeAction:
                        item.editor = CustomizeActionComponent;
                        item.converter = new CustomizeActionConverter(_this.localPipe);
                        break;
                    case ProcessPropertyKeys.processVariables:
                        item.editor = ProcessVariablesComponent;
                        item.converter = new ProcessVariablesConverter(_this.localPipe);
                        break;
                    case ProcessPropertyKeys.timeLimitControl:
                        item.editor = TimeLimitControlComponent;
                        item.converter = new TimeLimitControlConverter(_this.localPipe);
                        item.editorParams = {
                            location: 'process'
                        };
                        break;
                    case ProcessPropertyKeys.messageNotice:
                        item.editor = MessageNoticeComponent;
                        item.converter = new MessageNoticeConverter(_this.localPipe);
                        item.editorParams = {
                            location: 'process'
                        };
                        break;
                    case ProcessPropertyKeys.imageSettings:
                        item.editor = ImageSetComponent;
                        item.converter = new ImageSetConverter(_this.localPipe);
                        break;
                    case ProcessPropertyKeys.StartCondition:
                        item.editor = StartConditionComponent;
                        item.editorParams = {};
                        item.converter = new StartConditionConverter();
                        break;
                    default:
                        item.editor = ExtendPropertyComponent;
                        item.converter = new ExtendPropertyConverter(_this.localPipe);
                        break;
                }
            }));
        }
    };
    BpmnProcessViewModel.decorators = [
        { type: Injectable }
    ];
    /** @nocollapse */
    BpmnProcessViewModel.ctorParameters = function () { return [
        { type: ProcessDesignerUIState },
        { type: WfLocalePipe }
    ]; };
    return BpmnProcessViewModel;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var ApprovalItemEntity = /** @class */ (function () {
    function ApprovalItemEntity(value, text, wfAction) {
        this.isDefault = false;
        this.commentNecessary = false;
        this.certification = false;
        this.attachmentNecessary = false;
        this.signatureNecessary = false;
        this.value = value;
        this.text = text;
        this.workFlowAction = wfAction;
    }
    return ApprovalItemEntity;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var SignRuleEntity = /** @class */ (function () {
    function SignRuleEntity() {
    }
    return SignRuleEntity;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var SignRuleComponent = /** @class */ (function () {
    function SignRuleComponent(formBuilder, message, exprService, designerUIState, cdr, localeId, resources, localePipe) {
        var _this = this;
        this.formBuilder = formBuilder;
        this.message = message;
        this.exprService = exprService;
        this.designerUIState = designerUIState;
        this.cdr = cdr;
        this.localeId = localeId;
        this.resources = resources;
        this.localePipe = localePipe;
        this.cls = 'farris-main-area flex-column';
        this.closeModal = new EventEmitter();
        this.submitModal = new EventEmitter();
        this.editorParams = {};
        this.modalConfig = {
            title: this.localePipe.transform('component.signRule.countersignRules'),
            width: 800,
            height: 520,
            showButtons: true
        };
        this.editCondition = false;
        this.data = [];
        this.calculationMethods = [
            { text: this.localePipe.transform('component.signRule.byNumber'), value: 'byNumber' },
            { text: this.localePipe.transform('component.signRule.byProportion'), value: 'byProportion' },
            { text: this.localePipe.transform('component.signRule.customConditions'), value: 'null' },
        ];
        this.counterSignVariables = [];
        this.bpmnModel = this.designerUIState.bpmnModel;
        /**
         * **** 审批项帮助参数 ********************************************************
         */
        this.approvalCols = [{ title: this.localePipe.transform('component.signRule.value'), field: 'value', width: 80 },
            { title: this.localePipe.transform('component.signRule.text'), field: 'text', width: 90 }];
        this.approvalItems = [];
        this.approvalItems1 = [
            { value: 'Forward', text: this.localePipe.transform('multiInstanceLoopCharacteristics.completionConditionRulesList.forward') },
            { value: 'Backward', text: this.localePipe.transform('multiInstanceLoopCharacteristics.completionConditionRulesList.backward') },
            { value: 'Abort', text: this.localePipe.transform('multiInstanceLoopCharacteristics.completionConditionRulesList.abort') }
        ];
        /**
         * ********************************
         */
        this.columns = [
            { field: 'conclusionName', width: 25, title: this.localePipe.transform('component.signRule.conclusionName') },
            { field: 'conclusionValue', width: 25, title: this.localePipe.transform('component.signRule.conclusionValue') },
            { field: 'calculateType', width: 40, title: this.localePipe.transform('component.signRule.calculateType'),
                formatter: { type: 'enum', options: { valueField: 'value', textField: 'text', data: this.calculationMethods } },
                editor: { type: EditorTypes.COMBOLIST, options: { valueField: 'value', textField: 'text', data: this.calculationMethods, idField: 'value', panelHeight: 'auto' } }
            },
            { field: 'conditionValue', width: 25, title: this.localePipe.transform('component.signRule.conditionValue'),
                editor: { type: EditorTypes.NUMBERBOX, options: {} },
                formatter: { type: 'number', options: { precision: 0, min: 0 } }
            },
            { field: 'waitAllVotes', width: 35, title: this.localePipe.transform('component.signRule.waitAllVotes'),
                editor: { type: EditorTypes.SWITCH, options: {} },
                formatter: { type: 'boolean', options: { trueText: this.localePipe.transform('component.signRule.yes'), falseText: this.localePipe.transform('component.signRule.no') } }
            },
            { field: 'completionCondition', width: 50, title: this.localePipe.transform('component.signRule.customConditions'),
                editor: {
                    type: 'input-group',
                    options: {
                        groupText: '<i class="f-icon f-icon-lookup"></i>',
                        editable: false,
                        clickHandle: (/**
                         * @param {?} e
                         * @return {?}
                         */
                        function (e) {
                            e.formControl.setValue(e.instance.value ? e.instance.value : '');
                            _this.editConditon(e);
                        }),
                        clear: (/**
                         * @param {?} e
                         * @return {?}
                         */
                        function (e) {
                            console.log('clear', e);
                        })
                    }
                }
            }
        ];
        /**
         * 结束编辑前事件
         */
        this.afterEdit = (/**
         * @param {?} rowIndex
         * @param {?} rowData
         * @param {?=} column
         * @return {?}
         */
        function (rowIndex, rowData, column) {
            _this.preValue = JSON.parse(JSON.stringify(rowData));
            return of$1(true);
        });
        this.localePipe = this.localePipe || new WfLocalePipe(localeId, resources);
    }
    Object.defineProperty(SignRuleComponent.prototype, "value", {
        //会签规则打开页面
        set: 
        //会签规则打开页面
        /**
         * @param {?} rules
         * @return {?}
         */
        function (rules) {
            var e_1, _a;
            if (rules && rules.length > 0) {
                try {
                    for (var rules_1 = __values(rules), rules_1_1 = rules_1.next(); !rules_1_1.done; rules_1_1 = rules_1.next()) {
                        var rule = rules_1_1.value;
                        /** @type {?} */
                        var val = new SignRuleEntity();
                        val.id = ProcessDeUtil.GenerateElementId();
                        val.conclusionValue = rule.ConclusionValue;
                        val.conclusionName = rule.ConclusionName;
                        val.calculateType = rule.CalculateType ? rule.CalculateType : 'null';
                        val.conditionValue = rule.ConditionValue ? rule.ConditionValue : 0;
                        val.waitAllVotes = rule.WaitAllVotes ? rule.WaitAllVotes : false;
                        val.completionCondition = rule.CompletionCondition ? rule.CompletionCondition._value : null;
                        this.data.push(val);
                    }
                }
                catch (e_1_1) { e_1 = { error: e_1_1 }; }
                finally {
                    try {
                        if (rules_1_1 && !rules_1_1.done && (_a = rules_1.return)) _a.call(rules_1);
                    }
                    finally { if (e_1) throw e_1.error; }
                }
            }
            else { // 如果模型上没有会签规则，自动带入所有的审批选项
                this.deleteRow();
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SignRuleComponent.prototype, "value1", {
        //多实例打开完成规则页面
        set: 
        //多实例打开完成规则页面
        /**
         * @param {?} rules
         * @return {?}
         */
        function (rules) {
            var e_2, _a;
            this.editCondition = true;
            if (rules && rules.length > 0) {
                try {
                    for (var rules_2 = __values(rules), rules_2_1 = rules_2.next(); !rules_2_1.done; rules_2_1 = rules_2.next()) {
                        var rule = rules_2_1.value;
                        /** @type {?} */
                        var val = new SignRuleEntity();
                        val.id = BpmnModelHelper.GenerateElementId();
                        val.conclusionValue = rule.ConclusionValue;
                        // val.conclusionName = rule.conclusionName;
                        val.calculateType = rule.CalculateType ? rule.CalculateType : 'null';
                        val.conditionValue = rule.ConditionValue ? rule.ConditionValue : 0;
                        val.waitAllVotes = rule.WaitAllVotes ? rule.WaitAllVotes : false;
                        val.completionCondition = rule.CompletionCondition ? rule.CompletionCondition.Value : null;
                        this.data.push(val);
                    }
                }
                catch (e_2_1) { e_2 = { error: e_2_1 }; }
                finally {
                    try {
                        if (rules_2_1 && !rules_2_1.done && (_a = rules_2.return)) _a.call(rules_2);
                    }
                    finally { if (e_2) throw e_2.error; }
                }
                this.data = this.setName1(this.data);
            }
            else { // 如果模型上没有会签规则，自动带入所有的审批选项
                this.deleteRow1();
            }
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    SignRuleComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        this.counterSignVariables = this.designerUIState.counterSignVariables || [];
        this.approvalItems = this.designerUIState.approvalItems || [];
    };
    // 重置动作
    // 重置动作
    /**
     * @return {?}
     */
    SignRuleComponent.prototype.deleteRow = 
    // 重置动作
    /**
     * @return {?}
     */
    function () {
        var e_3, _a;
        this.data = [];
        /** @type {?} */
        var ruleItems = this.designerUIState.approvalItems || [];
        if (ruleItems && ruleItems.length > 0) {
            try {
                for (var ruleItems_1 = __values(ruleItems), ruleItems_1_1 = ruleItems_1.next(); !ruleItems_1_1.done; ruleItems_1_1 = ruleItems_1.next()) {
                    var ruleItem = ruleItems_1_1.value;
                    /** @type {?} */
                    var val = new SignRuleEntity();
                    if (ruleItem.value === 'Pass') {
                        val.id = ProcessDeUtil.GenerateElementId();
                        val.conclusionValue = ruleItem.value;
                        val.conclusionName = ruleItem.text;
                        val.calculateType = 'byProportion';
                        val.conditionValue = '100';
                        val.waitAllVotes = true;
                    }
                    else if (ruleItem.value === 'Back') {
                        val.id = ProcessDeUtil.GenerateElementId();
                        val.conclusionValue = ruleItem.value;
                        val.conclusionName = ruleItem.text;
                        val.calculateType = 'byNumber';
                        val.conditionValue = '1';
                        val.waitAllVotes = true;
                    }
                    else {
                        val.id = ProcessDeUtil.GenerateElementId();
                        val.conclusionValue = ruleItem.value;
                        val.conclusionName = ruleItem.text;
                        val.calculateType = 'null';
                        val.conditionValue = '0';
                        val.waitAllVotes = true;
                    }
                    this.data.push(val);
                }
            }
            catch (e_3_1) { e_3 = { error: e_3_1 }; }
            finally {
                try {
                    if (ruleItems_1_1 && !ruleItems_1_1.done && (_a = ruleItems_1.return)) _a.call(ruleItems_1);
                }
                finally { if (e_3) throw e_3.error; }
            }
        }
    };
    // 重置动作
    // 重置动作
    /**
     * @return {?}
     */
    SignRuleComponent.prototype.deleteRow1 = 
    // 重置动作
    /**
     * @return {?}
     */
    function () {
        var e_4, _a;
        this.data = [];
        if (this.approvalItems1 && this.approvalItems1.length > 0) {
            try {
                for (var _b = __values(this.approvalItems1), _c = _b.next(); !_c.done; _c = _b.next()) {
                    var ruleItem = _c.value;
                    /** @type {?} */
                    var val = new SignRuleEntity();
                    if (ruleItem.value === 'Forward') {
                        val.id = ProcessDeUtil.GenerateElementId();
                        val.conclusionValue = ruleItem.value;
                        val.conclusionName = ruleItem.text;
                        val.calculateType = 'byProportion';
                        val.conditionValue = '100';
                        val.waitAllVotes = true;
                    }
                    else if (ruleItem.value === 'Backward' || ruleItem.value === 'Abort') {
                        val.id = ProcessDeUtil.GenerateElementId();
                        val.conclusionValue = ruleItem.value;
                        val.conclusionName = ruleItem.text;
                        val.calculateType = 'byNumber';
                        val.conditionValue = '1';
                        val.waitAllVotes = true;
                    }
                    else {
                        val.id = ProcessDeUtil.GenerateElementId();
                        val.conclusionValue = ruleItem.value;
                        val.conclusionName = ruleItem.text;
                        val.calculateType = 'null';
                        val.conditionValue = '0';
                        val.waitAllVotes = true;
                    }
                    this.data.push(val);
                }
            }
            catch (e_4_1) { e_4 = { error: e_4_1 }; }
            finally {
                try {
                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                }
                finally { if (e_4) throw e_4.error; }
            }
        }
    };
    // 给个名字
    // 给个名字
    /**
     * @param {?} signRuleEntity
     * @return {?}
     */
    SignRuleComponent.prototype.setName1 = 
    // 给个名字
    /**
     * @param {?} signRuleEntity
     * @return {?}
     */
    function (signRuleEntity) {
        if (signRuleEntity && signRuleEntity.length > 0) {
            for (var i = 0; i < signRuleEntity.length; i++) {
                if (signRuleEntity[i].conclusionValue === 'Forward') {
                    signRuleEntity[i].conclusionName = this.localePipe.transform('multiInstanceLoopCharacteristics.completionConditionRulesList.forward');
                }
                else if (signRuleEntity[i].conclusionValue === 'Backward') {
                    signRuleEntity[i].conclusionName = this.localePipe.transform('multiInstanceLoopCharacteristics.completionConditionRulesList.backward');
                }
                else if (signRuleEntity[i].conclusionValue === 'Abort') {
                    signRuleEntity[i].conclusionName = this.localePipe.transform('multiInstanceLoopCharacteristics.completionConditionRulesList.abort');
                }
            }
        }
        return signRuleEntity;
    };
    /**
     * @return {?}
     */
    SignRuleComponent.prototype.clickOK = /**
     * @return {?}
     */
    function () {
        this.grid.endCellEdit();
        if (this.data.length === 0) {
            this.message.warning(this.localePipe.transform('component.signRule.notEmpty'));
        }
        else {
            /** @type {?} */
            var object = { value: this.data, parameters: null };
            this.submitModal.emit(object);
        }
    };
    /**
     * @return {?}
     */
    SignRuleComponent.prototype.clickOK1 = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.grid.endCellEdit();
        if (this.data.length === 0) {
            this.message.warning(this.localePipe.transform('component.signRule.notEmpty'));
        }
        else {
            /** @type {?} */
            var counterSignRules_1 = new Array();
            this.data.forEach((/**
             * @param {?} d
             * @return {?}
             */
            function (d) {
                /** @type {?} */
                var counterSignRule = new CounterSignRule(_this.bpmnModel);
                counterSignRule.CalculateType = d.calculateType;
                counterSignRule.ConclusionValue = d.conclusionValue;
                counterSignRule.ConditionValue = d.conditionValue;
                counterSignRule.WaitAllVotes = d.waitAllVotes;
                counterSignRule.CompletionCondition = new Condition(_this.bpmnModel);
                counterSignRule.CompletionCondition.Value = d.completionCondition;
                counterSignRules_1.push(counterSignRule);
            }));
            // let counterSignRules = new CounterSignRule(this.bpmnModel);
            this.submitModal.emit(counterSignRules_1);
        }
    };
    /**
     * @return {?}
     */
    SignRuleComponent.prototype.clickCancel = /**
     * @return {?}
     */
    function () {
        this.closeModal.emit();
    };
    /**
     * @param {?} e
     * @return {?}
     */
    SignRuleComponent.prototype.editConditon = /**
     * @param {?} e
     * @return {?}
     */
    function (e) {
        var _this = this;
        var e_5, _a, e_6, _b, e_7, _c, e_8, _d, e_9, _e;
        // this.exprService.clearContext();
        /** @type {?} */
        var context = new Array();
        if (this.editCondition) {
            if (this.designerUIState.multiCounterSignVariables.length > 0) {
                var _loop_1 = function (variable) {
                    if (!context.some((/**
                     * @param {?} c
                     * @return {?}
                     */
                    function (c) { return c.key === variable.key; }))) {
                        context.push(variable);
                    }
                };
                try {
                    for (var _f = __values(this.designerUIState.multiCounterSignVariables), _g = _f.next(); !_g.done; _g = _f.next()) {
                        var variable = _g.value;
                        _loop_1(variable);
                    }
                }
                catch (e_5_1) { e_5 = { error: e_5_1 }; }
                finally {
                    try {
                        if (_g && !_g.done && (_a = _f.return)) _a.call(_f);
                    }
                    finally { if (e_5) throw e_5.error; }
                }
            }
            if (context.length > 0) {
                try {
                    for (var context_1 = __values(context), context_1_1 = context_1.next(); !context_1_1.done; context_1_1 = context_1.next()) {
                        var v = context_1_1.value;
                        this.exprService.addContext(v);
                    }
                }
                catch (e_6_1) { e_6 = { error: e_6_1 }; }
                finally {
                    try {
                        if (context_1_1 && !context_1_1.done && (_b = context_1.return)) _b.call(context_1);
                    }
                    finally { if (e_6) throw e_6.error; }
                }
            }
        }
        else {
            if (this.counterSignVariables && this.counterSignVariables.length > 0) {
                var _loop_2 = function (variable) {
                    if (!context.some((/**
                     * @param {?} c
                     * @return {?}
                     */
                    function (c) { return c.key === variable.key; }))) {
                        context.push(variable);
                    }
                };
                try {
                    for (var _h = __values(this.counterSignVariables), _j = _h.next(); !_j.done; _j = _h.next()) {
                        var variable = _j.value;
                        _loop_2(variable);
                    }
                }
                catch (e_7_1) { e_7 = { error: e_7_1 }; }
                finally {
                    try {
                        if (_j && !_j.done && (_c = _h.return)) _c.call(_h);
                    }
                    finally { if (e_7) throw e_7.error; }
                }
            }
            if (this.designerUIState.subActivityContext.length > 0) {
                var _loop_3 = function (variable) {
                    if (!context.some((/**
                     * @param {?} c
                     * @return {?}
                     */
                    function (c) { return c.key === variable.key; }))) {
                        context.push(variable);
                    }
                };
                try {
                    for (var _k = __values(this.designerUIState.subActivityContext), _l = _k.next(); !_l.done; _l = _k.next()) {
                        var variable = _l.value;
                        _loop_3(variable);
                    }
                }
                catch (e_8_1) { e_8 = { error: e_8_1 }; }
                finally {
                    try {
                        if (_l && !_l.done && (_d = _k.return)) _d.call(_k);
                    }
                    finally { if (e_8) throw e_8.error; }
                }
            }
            if (context.length > 0) {
                try {
                    for (var context_2 = __values(context), context_2_1 = context_2.next(); !context_2_1.done; context_2_1 = context_2.next()) {
                        var v = context_2_1.value;
                        this.exprService.addContext(v);
                    }
                }
                catch (e_9_1) { e_9 = { error: e_9_1 }; }
                finally {
                    try {
                        if (context_2_1 && !context_2_1.done && (_e = context_2.return)) _e.call(context_2);
                    }
                    finally { if (e_9) throw e_9.error; }
                }
            }
        }
        this.exprService.setEditPattern(ExprEditMode.Advanced); // 表达式展现模式：默认高级版（会签规则需要上下文变量）
        this.exprService.addExpressionText(e.instance.value);
        this.exprService.buildExpression().then((/**
         * @param {?} cond
         * @return {?}
         */
        function (cond) {
            e.formControl.setValue(cond);
            e.instance.cd.detectChanges();
            //点击确定后，去除表达式里面的新增的上下文变量
            if (context.length > 0) {
                _this.exprService.exprEntity.contextEntities = _this.exprService.exprEntity.contextEntities.filter((/**
                 * @param {?} x
                 * @return {?}
                 */
                function (x) { return !context.some((/**
                 * @param {?} y
                 * @return {?}
                 */
                function (y) { return y.key === x.key; })); }));
            }
        }));
    };
    /**
     * 选中审批项
     */
    /**
     * 选中审批项
     * @return {?}
     */
    SignRuleComponent.prototype.approvalSelect = /**
     * 选中审批项
     * @return {?}
     */
    function () {
        var e_10, _a;
        /** @type {?} */
        var selections = this.apvlItemsGrid.checkeds;
        if (selections && selections.length > 0) {
            try {
                for (var selections_1 = __values(selections), selections_1_1 = selections_1.next(); !selections_1_1.done; selections_1_1 = selections_1.next()) {
                    var selection = selections_1_1.value;
                    /** @type {?} */
                    var signRule = new SignRuleEntity();
                    signRule.id = ProcessDeUtil.GenerateElementId();
                    signRule.conclusionValue = selection.data.value;
                    signRule.conclusionName = selection.data.text;
                    this.data.push(signRule);
                }
            }
            catch (e_10_1) { e_10 = { error: e_10_1 }; }
            finally {
                try {
                    if (selections_1_1 && !selections_1_1.done && (_a = selections_1.return)) _a.call(selections_1);
                }
                finally { if (e_10) throw e_10.error; }
            }
            this.grid.loadData(this.data);
            this.apvlItemDialog.close();
        }
        else {
            this.message.info(this.localePipe.transform('component.signRule.pleaseSelect'));
        }
    };
    /**
     * @param {?} e
     * @return {?}
     */
    SignRuleComponent.prototype.endEdit = /**
     * @param {?} e
     * @return {?}
     */
    function (e) {
        this.curValue = e.rowData;
        // 自定义会签规则和预置会签规则互斥
        if (this.preValue.completionCondition !== this.curValue.completionCondition &&
            !(this.isEmpty(this.preValue.completionCondition) && this.isEmpty(this.curValue.completionCondition))) {
            this.data[e.rowIndex].calculateType = 'null',
                this.data[e.rowIndex].conditionValue = '0';
            this.data[e.rowIndex].waitAllVotes = false;
        }
        else if (this.preValue.calculateType !== this.curValue.calculateType ||
            this.preValue.conditionValue !== this.curValue.conditionValue ||
            this.preValue.waitAllVotes !== this.curValue.waitAllVotes) {
            this.data[e.rowIndex].completionCondition = null;
        }
        if (e.column.field === 'conditionValue' && this.data[e.rowIndex].calculateType === 'byProportion'
            && Number.parseInt(e.value) > 100) {
            this.message.info(this.localePipe.transform('component.signRule.maxConditionValue'));
            this.data[e.rowIndex].conditionValue = '100';
        }
        else if (e.column.field === 'conditionValue' && Number.parseInt(e.value) < 0) {
            this.message.info(this.localePipe.transform('component.signRule.minConditionValue'));
            this.data[e.rowIndex].conditionValue = '0';
        }
        else if ((e.column.field === 'calculateType' || e.column.field === 'conditionValue') && (this.data[e.rowIndex].calculateType === 'oneVote' ||
            this.data[e.rowIndex].calculateType === 'fullVote') && Number.parseInt(this.data[e.rowIndex].conditionValue) !== 0) {
            this.message.info(this.localePipe.transform('component.signRule.noConditional'));
            this.data[e.rowIndex].conditionValue = '0';
        }
        else if (e.column.field === 'calculateType' && this.data[e.rowIndex].calculateType === 'byProportion' &&
            Number.parseInt(this.data[e.rowIndex].conditionValue) > 100) {
            this.message.info(this.localePipe.transform('component.signRule.maxConditionValue'));
            this.data[e.rowIndex].conditionValue = '100';
        }
    };
    /**
     * @param {?} s
     * @return {?}
     */
    SignRuleComponent.prototype.isEmpty = /**
     * @param {?} s
     * @return {?}
     */
    function (s) {
        if (!s || s.length == 0) {
            return true;
        }
        else {
            return false;
        }
    };
    SignRuleComponent.decorators = [
        { type: Component, args: [{
                    selector: 'app-sign-rule',
                    template: "  <div class=\"f-page\">\r\n    <div class=\"f-page-main f-utils-fill-flex-column h-100\">\r\n      <div class=\"f-utils-fill-flex-column farris-overflow-y-auto h-100\">\r\n        <farris-datagrid #grid [data]=\"data\" [columns]=\"columns\" [idField]=\"'id'\" [fit]=\"true\"\r\n          [fitColumns]=\"true\" [editable]=\"true\" [editMode]=\"'cell'\" [pagination]=\"false\" [showCheckbox]=\"false\"\r\n          [multiSelect]=\"false\" [afterEdit]='afterEdit' (endEdit)=\"endEdit($event)\">\r\n        </farris-datagrid>\r\n      </div>\r\n    </div>\r\n  </div>\r\n<ng-template #iconSelectFooter>\r\n  <button type=\"button\" class=\"btn btn-secondary btn-sm px-3 mx-2\" (click)=\"clickCancel()\">{{'component.signRule.clickCancel' | wfLocale}}</button>\r\n  <button type=\"button\" class=\"btn btn-secondary btn-sm px-3 mx-2\" (click)=\"deleteRow()\">{{'component.signRule.deleteRow' | wfLocale}}</button>\r\n  <button type=\"button\" class=\"btn btn-primary btn-sm px-3 mx-2\" (click)=\"clickOK()\">{{'component.signRule.clickOK' | wfLocale}}</button>\r\n</ng-template>\r\n\r\n\r\n<ng-template #iconSelectFooter1>\r\n  <button type=\"button\" class=\"btn btn-secondary btn-sm px-3 mx-2\" (click)=\"clickCancel()\">{{'component.signRule.clickCancel' | wfLocale}}</button>\r\n  <button type=\"button\" class=\"btn btn-secondary btn-sm px-3 mx-2\" (click)=\"deleteRow1()\">{{'component.signRule.deleteRow' | wfLocale}}</button>\r\n  <button type=\"button\" class=\"btn btn-primary btn-sm px-3 mx-2\" (click)=\"clickOK1()\">{{'component.signRule.clickOK' | wfLocale}}</button>\r\n</ng-template>\r\n\r\n<farris-dialog #approvalItemDialog [buttons]=\"buttonRef\" [width]=\"700\" [height]=\"520\" title=\"{{'component.signRule.approvalOptions'| wfLocale}}\">\r\n  <div class=\"f-utils-fill-flex-column farris-overflow-y-auto h-100 m-2\">\r\n      <farris-datagrid #approvalTable [columns]=\"approvalCols\" [data]=\"approvalItems\" [idField]=\"'value'\"\r\n        [fit]=\"true\" [fitColumns]=\"true\" [pagination]='false' [multiSelect]=\"true\"\r\n        [showCheckbox]=\"true\" [multiSelect]=\"true\" [checkOnSelect]=\"true\" [selectOnCheck]=\"true\">\r\n      </farris-datagrid>\r\n  </div>\r\n</farris-dialog>\r\n<ng-template #buttonRef>\r\n  <button class=\"btn btn-secondary btn-sm px-3 mx-2\" (click)=\"approvalItemDialog.close()\">{{'component.signRule.clickCancel' | wfLocale}}</button>\r\n  <button class=\"btn btn-sm btn-primary px-3 mx-2\" (click)=\"approvalSelect()\">{{'component.signRule.clickOK' | wfLocale}}</button>\r\n</ng-template>\r\n",
                    providers: [
                        WfLocalePipe,
                    ],
                    styles: [""]
                }] }
    ];
    /** @nocollapse */
    SignRuleComponent.ctorParameters = function () { return [
        { type: FormBuilder },
        { type: MessagerService },
        { type: ExpressionService },
        { type: ProcessDesignerUIState },
        { type: ChangeDetectorRef, decorators: [{ type: Optional }] },
        { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
        { type: undefined, decorators: [{ type: Inject, args: [WF_LANG_RESOURCES,] }] },
        { type: WfLocalePipe, decorators: [{ type: Optional }] }
    ]; };
    SignRuleComponent.propDecorators = {
        cls: [{ type: HostBinding, args: ['class',] }],
        closeModal: [{ type: Output }],
        submitModal: [{ type: Output }],
        value: [{ type: Input }],
        value1: [{ type: Input }],
        editorParams: [{ type: Input }],
        modalFooter: [{ type: ViewChild, args: ['iconSelectFooter',] }],
        modalFooter1: [{ type: ViewChild, args: ['iconSelectFooter1',] }],
        apvlItemsGrid: [{ type: ViewChild, args: ['approvalTable',] }],
        apvlItemDialog: [{ type: ViewChild, args: ['approvalItemDialog',] }],
        grid: [{ type: ViewChild, args: ['grid',] }]
    };
    return SignRuleComponent;
}());
var SignRuleConverter = /** @class */ (function () {
    function SignRuleConverter(localePipe) {
        this.localePipe = localePipe;
    }
    /**
     * @param {?} data
     * @return {?}
     */
    SignRuleConverter.prototype.convertTo = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        // 会签规则只要启用就有默认值，所以始终置为'已设置';
        return this.localePipe.transform("component.signRule.set");
    };
    return SignRuleConverter;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var ApprovelItemsComponent = /** @class */ (function () {
    function ApprovelItemsComponent(message, util, http, uiState, resolver, cdr, localeId, resources, localePipe) {
        this.message = message;
        this.util = util;
        this.http = http;
        this.uiState = uiState;
        this.resolver = resolver;
        this.cdr = cdr;
        this.localeId = localeId;
        this.resources = resources;
        this.localePipe = localePipe;
        this.cls = 'farris-main-area flex-column';
        this.closeModal = new EventEmitter();
        this.submitModal = new EventEmitter();
        this.modalConfig = {
            title: this.localePipe.transform('component.approvelItems.approvalOptions'),
            width: 1100,
            height: 515,
            showButtons: true
        };
        this.workFlowActions = [
            { text: this.localePipe.transform('component.approvelItems.forward'), value: 'Forward' },
            { text: this.localePipe.transform('component.approvelItems.backward'), value: 'Backward' },
            { text: this.localePipe.transform('component.approvelItems.abort'), value: 'Abort' }
        ];
        this.columns = [
            {
                field: 'value', width: 80, title: this.localePipe.transform('component.approvelItems.value'),
            },
            { field: 'text', width: 80, title: this.localePipe.transform('component.approvelItems.text') },
            {
                field: 'workFlowAction', width: 80, title: this.localePipe.transform('component.approvelItems.workFlowAction'),
                formatter: {
                    type: 'enum',
                    options: { valueField: 'value', textField: 'text', data: this.workFlowActions }
                },
                editor: {
                    type: EditorTypes.COMBOLIST,
                    options: { valueField: 'value', textField: 'text', data: this.workFlowActions, idField: 'value', panelHeight: 'auto' }
                },
                validators: [
                    { type: 'required', messager: '必填' }
                ]
            },
            {
                field: 'isDefault', width: 60, title: this.localePipe.transform('component.approvelItems.isDefault'),
                editor: {
                    type: EditorTypes.SWITCH,
                    options: {}
                },
                formatter: { type: 'boolean', options: { trueText: this.localePipe.transform('component.approvelItems.yes'), falseText: this.localePipe.transform('component.approvelItems.no') } },
                validators: [
                    { type: 'required', messager: '必填' }
                ]
            },
            {
                field: 'commentNecessary', width: 60, title: this.localePipe.transform('component.approvelItems.commentNecessary'),
                editor: {
                    type: EditorTypes.SWITCH,
                    options: {}
                },
                formatter: { type: 'boolean', options: { trueText: this.localePipe.transform('component.approvelItems.yes'), falseText: this.localePipe.transform('component.approvelItems.no') } },
                validators: [
                    { type: 'required', messager: '必填' }
                ]
            },
            {
                field: 'attachmentNecessary', width: 60, title: this.localePipe.transform('component.approvelItems.attachmentNecessary'),
                editor: {
                    type: EditorTypes.SWITCH,
                    options: {}
                },
                formatter: { type: 'boolean', options: { trueText: this.localePipe.transform('component.approvelItems.yes'), falseText: this.localePipe.transform('component.approvelItems.no') } },
                validators: [
                    { type: 'required', messager: '必填' }
                ]
            },
            {
                field: 'certification', width: 60, title: this.localePipe.transform('component.approvelItems.certification'),
                editor: {
                    type: EditorTypes.SWITCH,
                    options: {}
                },
                formatter: { type: 'boolean', options: { trueText: this.localePipe.transform('component.approvelItems.yes'), falseText: this.localePipe.transform('component.approvelItems.no') } },
                validators: [
                    { type: 'required', messager: '必填' }
                ]
            },
            {
                field: 'signatureNecessary', width: 60, title: this.localePipe.transform('component.approvelItems.signatureNecessary'),
                editor: {
                    type: EditorTypes.SWITCH,
                    options: {}
                },
                formatter: { type: 'boolean', options: { trueText: this.localePipe.transform('component.approvelItems.yes'), falseText: this.localePipe.transform('component.approvelItems.no') } },
                validators: []
            },
            {
                field: 'defaultComment', isMultilingualField: true, width: 70, title: this.localePipe.transform('component.approvelItems.defaultComment'),
                editor: {
                    type: EditorTypes.LANGUAGETEXTBOX, options: {
                        languages: [
                            { code: 'zh-CHS', name: this.localePipe.transform('component.approvelItems.zh-CHS') },
                            { code: 'zh-CHT', name: this.localePipe.transform('component.approvelItems.zh-CHT') },
                            { code: 'en', name: this.localePipe.transform('component.approvelItems.en') }
                        ]
                    }
                },
            }
        ];
        this.data = [];
        this.actionsCols = [
            { title: this.localePipe.transform('component.approvelItems.value'), field: 'code', width: 80 },
            { title: this.localePipe.transform('component.approvelItems.text'), field: 'name', width: 90 }
        ];
        this.localePipe = this.localePipe || new WfLocalePipe(localeId, resources);
    }
    Object.defineProperty(ApprovelItemsComponent.prototype, "value", {
        set: /**
         * @param {?} items
         * @return {?}
         */
        function (items) {
            var e_1, _a;
            if (items && items.length > 0) {
                try {
                    for (var items_1 = __values(items), items_1_1 = items_1.next(); !items_1_1.done; items_1_1 = items_1.next()) {
                        var item = items_1_1.value;
                        /** @type {?} */
                        var approval = new ApprovalItemEntity();
                        approval.value = item.Value;
                        approval.text = item.Text;
                        approval.workFlowAction = item.WorkFlowAction;
                        approval.isDefault = item.IsDefault;
                        if (item.commentNecessary === null || item.commentNecessary === undefined) {
                            approval.commentNecessary = (item.Value === 'Back' ? true : false);
                        }
                        else {
                            approval.commentNecessary = item.commentNecessary;
                        }
                        approval.certification = item.certification ? item.certification : false;
                        approval.attachmentNecessary = item.attachmentNecessary ? item.attachmentNecessary : false;
                        approval.signatureNecessary = item.signatureNecessary ? item.signatureNecessary : false;
                        approval.defaultComment = item.defaultComment ? JSON.parse(item.defaultComment) : null;
                        this.data.push(approval);
                    }
                }
                catch (e_1_1) { e_1 = { error: e_1_1 }; }
                finally {
                    try {
                        if (items_1_1 && !items_1_1.done && (_a = items_1.return)) _a.call(items_1);
                    }
                    finally { if (e_1) throw e_1.error; }
                }
            }
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    ApprovelItemsComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        this.getActionsList();
    };
    /**
     * @return {?}
     */
    ApprovelItemsComponent.prototype.clickOK = /**
     * @return {?}
     */
    function () {
        var e_2, _a;
        this.grid.endCellEdit();
        if (this.validator()) {
            /** @type {?} */
            var actionList = [];
            try {
                // 将多语的默认意见转成String
                for (var _b = __values(this.data), _c = _b.next(); !_c.done; _c = _b.next()) {
                    var action = _c.value;
                    if (action.defaultComment != null) {
                        action.defaultComment = JSON.stringify(action.defaultComment);
                    }
                    actionList.push(action);
                }
            }
            catch (e_2_1) { e_2 = { error: e_2_1 }; }
            finally {
                try {
                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                }
                finally { if (e_2) throw e_2.error; }
            }
            console.log(actionList);
            /** @type {?} */
            var object = { value: actionList, parameters: null };
            this.submitModal.emit(object);
        }
    };
    /**
     * @return {?}
     */
    ApprovelItemsComponent.prototype.clickCancel = /**
     * @return {?}
     */
    function () {
        this.closeModal.emit();
    };
    /**
     * @private
     * @return {?}
     */
    ApprovelItemsComponent.prototype.validator = /**
     * @private
     * @return {?}
     */
    function () {
        if (this.data.findIndex((/**
         * @param {?} d
         * @return {?}
         */
        function (d) { return !d.workFlowAction; })) > -1) {
            this.message.warning(this.localePipe.transform('component.approvelItems.workFlowActionNotNull'));
            return false;
        }
        return true;
    };
    /**
     * @param {?} data
     * @return {?}
     */
    ApprovelItemsComponent.prototype.selectChanged = /**
     * @param {?} data
     * @return {?}
     */
    function (data) { };
    /**
     * @return {?}
     */
    ApprovelItemsComponent.prototype.deleteRow = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.grid.endCellEdit();
        if (this.grid.selectedRow && this.grid.selectedRow.data) {
            /** @type {?} */
            var i = this.data.findIndex((/**
             * @param {?} d
             * @return {?}
             */
            function (d) { return d.value === _this.grid.selectedRow.data.value; }));
            this.data.splice(i, 1);
            this.grid.loadData(this.data);
        }
        else {
            this.message.info(this.localePipe.transform('component.approvelItems.deleteRow'));
        }
    };
    /**
     * @private
     * @return {?}
     */
    ApprovelItemsComponent.prototype.getActionsList = /**
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var url = this.util.getApprovalActionWebApi() + '?';
        if (this.uiState.bizActivityId) {
            url += "bizActivityId=" + this.uiState.bizActivityId;
        }
        else {
            url += "bizActivityId=";
        }
        this.http.get(url).subscribe((/**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            data = data.filter((/**
             * @param {?} a
             * @return {?}
             */
            function (a) { return _this.actionValidate(a); }));
            _this.actions = data;
        }));
    };
    /**
     * @return {?}
     */
    ApprovelItemsComponent.prototype.actionsSelect = /**
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var selections = this.actionsTable.checkeds;
        if (selections && selections.length > 0) {
            selections.forEach((/**
             * @param {?} action
             * @return {?}
             */
            function (action) {
                /** @type {?} */
                var item = new ApprovalItemEntity(action.data.code, action.data.name, action.data.workFlowAction);
                /** @type {?} */
                var index = _this.data.findIndex((/**
                 * @param {?} act
                 * @return {?}
                 */
                function (act) { return act.value === action.data.code; }));
                if (index > -1) {
                    _this.data.splice(index, 1);
                }
                _this.data.push(item);
            }));
            this.grid.loadData(this.data);
        }
        // 2023-6-13 关闭前清空已选数据
        this.actionsTable.clearCheckeds(true);
        this.actionsDialog.close();
    };
    /**
     * @return {?}
     */
    ApprovelItemsComponent.prototype.SelectCancel = /**
     * @return {?}
     */
    function () {
        // 2023-6-13 关闭前清空已选数据
        this.actionsTable.clearCheckeds(true);
        this.actionsDialog.close();
    };
    /**
     * @private
     * @param {?} action
     * @return {?}
     */
    ApprovelItemsComponent.prototype.actionValidate = /**
     * @private
     * @param {?} action
     * @return {?}
     */
    function (action) {
        /** @type {?} */
        var arr = ['ViewBizLog', 'ViewFlowChart', 'AssignUser', 'Claim', 'Unclaim', 'Retrieve', 'Resubmit', 'Obsolete', 'Transfer', 'AddSignFront', 'ViewExecuteForm'];
        return arr.indexOf(action.code.trim()) === -1;
    };
    ApprovelItemsComponent.decorators = [
        { type: Component, args: [{
                    selector: 'app-approvel-items',
                    template: "<div class=\"f-page\">\r\n  <div class=\"f-page-header\">\r\n    <nav class=\"f-page-header-base\">\r\n      <div class=\"f-title\">\r\n      </div>\r\n      <div class=\"btn-toolbar btn-group-lg\">\r\n      <button class=\"btn btn-primary mr-2\" (click)=\"actionsDialog.show()\">{{'component.approvelItems.add' | wfLocale}}</button>\r\n      <button class=\"btn btn-secondary\" (click)=\"deleteRow()\">{{'component.approvelItems.delete' | wfLocale}}</button>\r\n      </div>\r\n    </nav>\r\n  </div>\r\n  <div class=\"f-page-main f-utils-fill-flex-column h-100\">\r\n    <div class=\"f-utils-fill-flex-column farris-overflow-y-auto h-100\">\r\n      <farris-datagrid #grid [data]=\"data\" [columns]=\"columns\" [idField]=\"'value'\" [fit]=\"true\"\r\n        [fitColumns]=\"true\" [editable]=\"true\" [editMode]=\"'cell'\" [pagination]=\"false\" [showCheckbox]=\"false\"\r\n        [multiSelect]=\"false\" (selectChanged)=\"selectChanged($event)\">\r\n      </farris-datagrid>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type=\"button\" class=\"btn btn-secondary btn-sm px-3 mx-2\" (click)=\"clickCancel()\">{{'component.approvelItems.clickCancel' | wfLocale}}</button>\r\n  <button type=\"button\" class=\"btn btn-primary btn-sm px-3 mx-2\" (click)=\"clickOK()\">{{'component.approvelItems.clickOK' | wfLocale}}</button>\r\n</ng-template>\r\n\r\n<ng-template #buttonRef>\r\n  <button class=\"btn btn-sm btn-default px-3\" (click)=\"SelectCancel()\">{{'component.approvelItems.clickCancel' | wfLocale}}</button>\r\n  <button class=\"btn btn-sm btn-primary px-3\" (click)=\"actionsSelect()\">{{'component.approvelItems.clickOK' | wfLocale}}</button>\r\n</ng-template>\r\n<farris-dialog #actionsDialog [buttons]=\"buttonRef\" [width]=\"700\" [height]=\"520\" title=\"{{'component.approvelItems.approvalAction' | wfLocale}}\">\r\n  <!-- 2023-6-1 \u89E3\u51B3\u5BA1\u6279\u52A8\u4F5C\u5F39\u7A97\u53CC\u6EDA\u52A8\u6761\u7684\u95EE\u9898 -->\r\n  <div class=\"f-utils-fill-flex-column farris-overflow-y-hidden h-100\" style=\"margin-left: 8px;margin-right: 8px;\">\r\n    <farris-datagrid #actionsTable [columns]=\"actionsCols\" [data]=\"actions\"\r\n      [idField]=\"'id'\" [fit]=\"true\" [fitColumns]=\"true\" [pagination]='false'\r\n      [showCheckbox]=\"true\" [multiSelect]=\"true\" [checkOnSelect]=\"true\" [selectOnCheck]=\"true\" [showAllCheckbox]=\"true\"\r\n      [showLineNumber]=\"true\" lineNumberTitle=\"{{'component.approvelItems.lineNumber' | wfLocale}}\" [lineNumberWidth]=\"50\" [striped]=\"true\">\r\n    </farris-datagrid>\r\n  </div>\r\n</farris-dialog>\r\n",
                    providers: [
                        WfLocalePipe,
                    ],
                    styles: [""]
                }] }
    ];
    /** @nocollapse */
    ApprovelItemsComponent.ctorParameters = function () { return [
        { type: MessagerService },
        { type: ProcessDeUtil },
        { type: HttpService },
        { type: ProcessDesignerUIState },
        { type: ComponentFactoryResolver },
        { type: ChangeDetectorRef, decorators: [{ type: Optional }] },
        { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
        { type: undefined, decorators: [{ type: Inject, args: [WF_LANG_RESOURCES,] }] },
        { type: WfLocalePipe, decorators: [{ type: Optional }] }
    ]; };
    ApprovelItemsComponent.propDecorators = {
        cls: [{ type: HostBinding, args: ['class',] }],
        closeModal: [{ type: Output }],
        submitModal: [{ type: Output }],
        value: [{ type: Input }],
        modalFooter: [{ type: ViewChild, args: ['iconSelectFooter',] }],
        actionsTable: [{ type: ViewChild, args: ['actionsTable',] }],
        actionsDialog: [{ type: ViewChild, args: ['actionsDialog',] }],
        grid: [{ type: ViewChild, args: ['grid',] }]
    };
    return ApprovelItemsComponent;
}());
var ApprovelItemsConverter = /** @class */ (function () {
    function ApprovelItemsConverter(localePipe) {
        this.localePipe = localePipe;
    }
    /**
     * @param {?} data
     * @return {?}
     */
    ApprovelItemsConverter.prototype.convertTo = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        if (data && data.length > 0) {
            return this.localePipe.transform('component.approvelItems.set');
        }
        else {
            return this.localePipe.transform('component.approvelItems.notSet');
        }
    };
    return ApprovelItemsConverter;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var ExpressionEditorComponent = /** @class */ (function () {
    function ExpressionEditorComponent(expr, designerState, cdr, localeId, resources, localePipe) {
        this.expr = expr;
        this.designerState = designerState;
        this.cdr = cdr;
        this.localeId = localeId;
        this.resources = resources;
        this.localePipe = localePipe;
        this.closeModal = new EventEmitter();
        this.submitModal = new EventEmitter();
        this.editorParams = {};
        this.contextEntities = [];
        this.schema = {};
        this.injectName = '';
        this.modalConfig = {
            title: this.localePipe.transform('component.expressionEditor.expressionEditor'),
            width: 1036,
            height: 530,
            showButtons: true
        };
        this.localePipe = this.localePipe || new WfLocalePipe(localeId, resources);
        if (this.designerState.schemas[0]) {
            this.schema = this.designerState.schemas[0];
            if (this.designerState.schemas[0].entityTypes && this.designerState.schemas[0].entityTypes.length > 0) {
                this.injectName = this.designerState.schemas[0].entityTypes[0].name;
            }
        }
    }
    /**
     * @return {?}
     */
    ExpressionEditorComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        var e_1, _a, e_2, _b, e_3, _c, e_4, _d, e_5, _e, e_6, _f;
        this.contextEntities = new Array();
        if (this.designerState.procInstContext.length > 0) {
            try {
                for (var _g = __values(this.designerState.procInstContext), _h = _g.next(); !_h.done; _h = _g.next()) {
                    var variable = _h.value;
                    this.contextEntities = this.contextEntities.concat([variable]);
                }
            }
            catch (e_1_1) { e_1 = { error: e_1_1 }; }
            finally {
                try {
                    if (_h && !_h.done && (_a = _g.return)) _a.call(_g);
                }
                finally { if (e_1) throw e_1.error; }
            }
        }
        if (this.designerState.subActivityContext.length > 0) {
            var _loop_1 = function (variable) {
                if (!this_1.contextEntities.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    this_1.contextEntities = this_1.contextEntities.concat([variable]);
                }
            };
            var this_1 = this;
            try {
                for (var _j = __values(this.designerState.subActivityContext), _k = _j.next(); !_k.done; _k = _j.next()) {
                    var variable = _k.value;
                    _loop_1(variable);
                }
            }
            catch (e_2_1) { e_2 = { error: e_2_1 }; }
            finally {
                try {
                    if (_k && !_k.done && (_b = _j.return)) _b.call(_j);
                }
                finally { if (e_2) throw e_2.error; }
            }
        }
        if (this.designerState.formalParameterContext.length > 0) {
            var _loop_2 = function (variable) {
                if (!this_2.contextEntities.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    this_2.contextEntities = this_2.contextEntities.concat([variable]);
                }
            };
            var this_2 = this;
            try {
                for (var _l = __values(this.designerState.formalParameterContext), _m = _l.next(); !_m.done; _m = _l.next()) {
                    var variable = _m.value;
                    _loop_2(variable);
                }
            }
            catch (e_3_1) { e_3 = { error: e_3_1 }; }
            finally {
                try {
                    if (_m && !_m.done && (_c = _l.return)) _c.call(_l);
                }
                finally { if (e_3) throw e_3.error; }
            }
        }
        if (this.designerState.participantContext.length > 0) {
            var _loop_3 = function (variable) {
                if (!this_3.contextEntities.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    this_3.contextEntities = this_3.contextEntities.concat([variable]);
                }
            };
            var this_3 = this;
            try {
                for (var _o = __values(this.designerState.participantContext), _p = _o.next(); !_p.done; _p = _o.next()) {
                    var variable = _p.value;
                    _loop_3(variable);
                }
            }
            catch (e_4_1) { e_4 = { error: e_4_1 }; }
            finally {
                try {
                    if (_p && !_p.done && (_d = _o.return)) _d.call(_o);
                }
                finally { if (e_4) throw e_4.error; }
            }
        }
        if (this.designerState.activityComponentContext.length > 0) {
            var _loop_4 = function (variable) {
                if (!this_4.contextEntities.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    this_4.contextEntities = this_4.contextEntities.concat([variable]);
                }
            };
            var this_4 = this;
            try {
                for (var _q = __values(this.designerState.activityComponentContext), _r = _q.next(); !_r.done; _r = _q.next()) {
                    var variable = _r.value;
                    _loop_4(variable);
                }
            }
            catch (e_5_1) { e_5 = { error: e_5_1 }; }
            finally {
                try {
                    if (_r && !_r.done && (_e = _q.return)) _e.call(_q);
                }
                finally { if (e_5) throw e_5.error; }
            }
        }
        if (this.designerState.processVariableContext.length > 0) {
            var _loop_5 = function (variable) {
                if (!this_5.contextEntities.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    this_5.contextEntities = this_5.contextEntities.concat([variable]);
                }
            };
            var this_5 = this;
            try {
                for (var _s = __values(this.designerState.processVariableContext), _t = _s.next(); !_t.done; _t = _s.next()) {
                    var variable = _t.value;
                    _loop_5(variable);
                }
            }
            catch (e_6_1) { e_6 = { error: e_6_1 }; }
            finally {
                try {
                    if (_t && !_t.done && (_f = _s.return)) _f.call(_s);
                }
                finally { if (e_6) throw e_6.error; }
            }
        }
    };
    /**
     * @return {?}
     */
    ExpressionEditorComponent.prototype.clickOK = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var result = this.compute.getExpr();
        this.value = this.convertToValue(result.text);
        /** @type {?} */
        var object = { value: this.value, parameters: null };
        this.submitModal.emit(object);
    };
    /**
     * 切换表达式类型（简易表达式<--->高级表达式）
     */
    /**
     * 切换表达式类型（简易表达式<--->高级表达式）
     * @return {?}
     */
    ExpressionEditorComponent.prototype.changeType = /**
     * 切换表达式类型（简易表达式<--->高级表达式）
     * @return {?}
     */
    function () {
        this.compute.changeType();
    };
    /**
     * @return {?}
     */
    ExpressionEditorComponent.prototype.clickCancel = /**
     * @return {?}
     */
    function () {
        this.closeModal.emit();
    };
    /**
     * @private
     * @param {?} val
     * @return {?}
     */
    ExpressionEditorComponent.prototype.convertToValue = /**
     * @private
     * @param {?} val
     * @return {?}
     */
    function (val) {
        if (val) {
            if (val.substring(9, val.length - 2)) {
                return val;
            }
            else {
                return '';
            }
        }
        else {
            return '';
        }
    };
    ExpressionEditorComponent.decorators = [
        { type: Component, args: [{
                    selector: 'app-expression-editor',
                    template: "<div class=\"mx-3 h-100\" style=\"border-radius:16px;border: 1.5px solid #F1F3F7;\">\r\n  <app-compute-rule-editor #compute\r\n  [text]=\"value\"\r\n  [advancedContexts]=\"contextEntities\"\r\n  [injectName]=\"injectName\"\r\n  [injectSchemaName]=\"'Schema'\"\r\n  [injectNameInSchema]=\"injectName\"\r\n  [schema]=\"schema\"\r\n  [schemaName]=\"'Schema'\">\r\n</app-compute-rule-editor>\r\n</div>\r\n\r\n<ng-template #iconSelectFooter>\r\n  <div class=\"btns\">\r\n    <button type=\"button\" class=\"btn btn-secondary btn-sm mr-2\" (click)=\"clickCancel()\">{{'component.expressionEditor.clickCancel' | wfLocale}}</button>\r\n    <button type=\"button\" class=\"btn btn-secondary btn-sm mr-2\" (click)=\"changeType()\">{{'component.expressionEditor.changeType' | wfLocale}}</button>\r\n    <button type=\"button\" class=\"btn btn-primary btn-sm\" (click)=\"clickOK()\">{{'component.expressionEditor.clickOK' | wfLocale}}</button>\r\n  </div>\r\n</ng-template>\r\n",
                    providers: [
                        WfLocalePipe,
                    ],
                    styles: [""]
                }] }
    ];
    /** @nocollapse */
    ExpressionEditorComponent.ctorParameters = function () { return [
        { type: ExpressionService },
        { type: ProcessDesignerUIState },
        { type: ChangeDetectorRef, decorators: [{ type: Optional }] },
        { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
        { type: undefined, decorators: [{ type: Inject, args: [WF_LANG_RESOURCES,] }] },
        { type: WfLocalePipe, decorators: [{ type: Optional }] }
    ]; };
    ExpressionEditorComponent.propDecorators = {
        closeModal: [{ type: Output }],
        submitModal: [{ type: Output }],
        value: [{ type: Input }],
        modalFooter: [{ type: ViewChild, args: ['iconSelectFooter',] }],
        editorParams: [{ type: Input }],
        editor: [{ type: ViewChild, args: [ExpressioneditorComponent,] }],
        compute: [{ type: ViewChild, args: ['compute',] }]
    };
    return ExpressionEditorComponent;
}());
var ExpressionEditorConverter = /** @class */ (function () {
    function ExpressionEditorConverter(localePipe) {
        this.localePipe = localePipe;
    }
    /**
     * @param {?} data
     * @return {?}
     */
    ExpressionEditorConverter.prototype.convertTo = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        if (data) {
            return data;
        }
        else {
            return this.localePipe.transform("component.expressionEditor.notSet");
        }
    };
    return ExpressionEditorConverter;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var JumpScopeComponent = /** @class */ (function () {
    function JumpScopeComponent(uistate, message, cdr, localeId, resources, localePipe) {
        var _this = this;
        this.uistate = uistate;
        this.message = message;
        this.cdr = cdr;
        this.localeId = localeId;
        this.resources = resources;
        this.localePipe = localePipe;
        this.cls = 'farris-main-area flex-column';
        this.closeModal = new EventEmitter();
        this.submitModal = new EventEmitter();
        this.modalConfig = {
            title: this.localePipe.transform('component.jumpScope.targetNodeOptions'),
            width: 520,
            height: 460,
            showButtons: true
        };
        this.cols = [
            { title: this.localePipe.transform('component.jumpScope.name'), field: 'Name', width: 60, searchField: 'Name' },
            { title: 'ID', field: 'Id', width: 90, searchField: 'Id' }
        ];
        // ==========================================================
        this.actis = [];
        this.fullActis = [];
        this.defaultacty = '';
        this.categoryListItems = [
            { value: 'OutConnectNode', name: this.localePipe.transform('component.jumpScope.outConnectNode') },
            { value: 'Global', name: this.localePipe.transform('component.jumpScope.global') },
            { value: 'AfterNodes', name: this.localePipe.transform('component.jumpScope.afterNodes') },
            { value: 'SpecifiedSet', name: this.localePipe.transform('component.jumpScope.specifiedSet') }
        ];
        this.category = '';
        this.defaultType = '';
        this.defaultTypeListItems = [
            { value: 'FirstNode', name: this.localePipe.transform('component.jumpScope.firstNode') },
            { value: 'NullNode', name: this.localePipe.transform('component.jumpScope.nullNode') },
            { value: 'SpecifyNode', name: this.localePipe.transform('component.jumpScope.specifyNode') }
        ];
        this.defaultActivity = '';
        this.pageInfo = {
            pageIndex: 1,
            pageList: [10, 20, 30, 50],
            pageSize: 20
        };
        this.actisSelect = (/**
         * @param {?} rowData
         * @return {?}
         */
        function (rowData) {
            // 附加节点的帮助后事件，把选中的数据赋给fullActis（此处处理的目的是为了显示Name同时取Id值）
            // console.log(rowData);
            _this.fullActis = rowData;
            return of$1({
                closeDialog: true
            });
        });
        this.defaultActivitySelect = (/**
         * @param {?} rowData
         * @return {?}
         */
        function (rowData) {
            // 默认节点的帮助后事件，把选中的id赋给defaultActivity（此处处理的目的是为了显示Name同时取Id值）
            _this.defaultActivity = rowData.Id;
            return of$1({
                closeDialog: true
            });
        });
        this.localePipe = this.localePipe || new WfLocalePipe(localeId, resources);
    }
    Object.defineProperty(JumpScopeComponent.prototype, "value", {
        set: /**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            var e_1, _a, e_2, _b;
            if (data) {
                this.category = data.Category;
                this.defaultType = data.DefaultType;
                // 取到DefaultActivity的节点Id，遍历出Name绑定到radiogroup上去（defaultacty）
                /** @type {?} */
                var acty = data.DefaultActivity;
                if (acty != null) {
                    try {
                        for (var _c = __values(this.uistate.allActList), _d = _c.next(); !_d.done; _d = _c.next()) {
                            var act = _d.value;
                            if (act.Id === acty) {
                                this.defaultacty = act.Name;
                            }
                        }
                    }
                    catch (e_1_1) { e_1 = { error: e_1_1 }; }
                    finally {
                        try {
                            if (_d && !_d.done && (_a = _c.return)) _a.call(_c);
                        }
                        finally { if (e_1) throw e_1.error; }
                    }
                }
                // 取到DestinationActivities的节点Id，遍历出Id和Name绑定到radiogroup上去（actis）
                /** @type {?} */
                var strs = data.DestinationActivities;
                if (strs && strs.length > 0) {
                    var _loop_1 = function (str) {
                        /** @type {?} */
                        var name_1 = this_1.uistate.allActList.filter((/**
                         * @param {?} act
                         * @return {?}
                         */
                        function (act) { return act.Id === str; }))[0].Name;
                        // const acti = { Id: str, Name: name };
                        this_1.actis.push(name_1);
                    };
                    var this_1 = this;
                    try {
                        for (var strs_1 = __values(strs), strs_1_1 = strs_1.next(); !strs_1_1.done; strs_1_1 = strs_1.next()) {
                            var str = strs_1_1.value;
                            _loop_1(str);
                        }
                    }
                    catch (e_2_1) { e_2 = { error: e_2_1 }; }
                    finally {
                        try {
                            if (strs_1_1 && !strs_1_1.done && (_b = strs_1.return)) _b.call(strs_1);
                        }
                        finally { if (e_2) throw e_2.error; }
                    }
                }
            }
            else {
                this.category = 'OutConnectNode';
                this.defaultType = 'FirstNode';
            }
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    JumpScopeComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
    };
    /**
     * @return {?}
     */
    JumpScopeComponent.prototype.clickOK = /**
     * @return {?}
     */
    function () {
        var e_3, _a, e_4, _b, e_5, _c;
        if (this.validator()) {
            /** @type {?} */
            var value = void 0;
            /** @type {?} */
            var list_1 = [];
            // 重新打开设置界面，没有进行节点配置的情况（DefaultActivity）
            if (this.defaultActivity === '' && this.defaultacty !== '') {
                try {
                    for (var _d = __values(this.uistate.allActList), _e = _d.next(); !_e.done; _e = _d.next()) {
                        var defAct = _e.value;
                        if (defAct.Name === this.defaultacty) {
                            this.defaultActivity = defAct.Id;
                        }
                    }
                }
                catch (e_3_1) { e_3 = { error: e_3_1 }; }
                finally {
                    try {
                        if (_e && !_e.done && (_a = _d.return)) _a.call(_d);
                    }
                    finally { if (e_3) throw e_3.error; }
                }
            }
            // 重新打开设置界面，没有进行节点配置的情况（DestinationActivities）
            if (this.fullActis.length === 0 && this.actis.length > 0) {
                try {
                    for (var _f = __values(this.actis), _g = _f.next(); !_g.done; _g = _f.next()) {
                        var act = _g.value;
                        try {
                            for (var _h = __values(this.uistate.allActList), _j = _h.next(); !_j.done; _j = _h.next()) {
                                var allAct = _j.value;
                                if (act === allAct.Name) {
                                    list_1.push(allAct.Id);
                                }
                            }
                        }
                        catch (e_5_1) { e_5 = { error: e_5_1 }; }
                        finally {
                            try {
                                if (_j && !_j.done && (_c = _h.return)) _c.call(_h);
                            }
                            finally { if (e_5) throw e_5.error; }
                        }
                    }
                }
                catch (e_4_1) { e_4 = { error: e_4_1 }; }
                finally {
                    try {
                        if (_g && !_g.done && (_b = _f.return)) _b.call(_f);
                    }
                    finally { if (e_4) throw e_4.error; }
                }
            }
            else if (this.category === 'SpecifiedSet' && this.fullActis && this.fullActis.length > 0) {
                // 附加节点的id传给模型上的DestinationActivities
                this.fullActis.forEach((/**
                 * @param {?} act
                 * @return {?}
                 */
                function (act) { return list_1.push(act.Id); }));
            }
            value = {
                Category: this.category,
                DefaultType: this.defaultType,
                DefaultActivity: this.defaultActivity,
                DestinationActivities: list_1,
            };
            /** @type {?} */
            var object = { value: value, parameters: null };
            this.submitModal.emit(object);
        }
    };
    /**
     * @return {?}
     */
    JumpScopeComponent.prototype.clickCancel = /**
     * @return {?}
     */
    function () {
        this.closeModal.emit();
    };
    /**
     * @private
     * @return {?}
     */
    JumpScopeComponent.prototype.validator = /**
     * @private
     * @return {?}
     */
    function () {
        if (!this.category) {
            this.message.warning(this.localePipe.transform('component.jumpScope.noSetTargetNode'));
            return false;
        }
        // if (this.category === 'SpecifiedSet' && Object.prototype.isPrototypeOf(this.actis)) {
        //   this.message.info('尚未选择附加节点，请了解！');
        //   return false;
        // }
        if (this.defaultType === 'SpecifyNode' && this.defaultacty === '') {
            this.message.warning(this.localePipe.transform('component.jumpScope.noSetSpecifyNode'));
            return false;
        }
        return true;
    };
    /**
     * @param {?} arg
     * @return {?}
     */
    JumpScopeComponent.prototype.searchDefault = /**
     * @param {?} arg
     * @return {?}
     */
    function (arg) {
        this.pageInfo.pageIndex = arg.pageInfo.pageIndex;
        this.pageInfo.pageSize = arg.pageInfo.pageSize;
        /** @type {?} */
        var search = arg.search;
        this.loadDefault(search);
    };
    /**
     * @param {?=} search
     * @return {?}
     */
    JumpScopeComponent.prototype.loadDefault = /**
     * @param {?=} search
     * @return {?}
     */
    function (search) {
        /** @type {?} */
        var start = (this.pageInfo.pageIndex - 1) * this.pageInfo.pageSize;
        /** @type {?} */
        var end = start + this.pageInfo.pageSize;
        /** @type {?} */
        var items = [];
        if (search && search.value) {
            if (search.field === '*') {
                items = this.uistate.allActList.filter((/**
                 * @param {?} i
                 * @return {?}
                 */
                function (i) { return i.Name.indexOf(search.value) > -1 || i.Id.indexOf(search.value) > -1; }));
            }
            else {
                items = this.uistate.allActList.filter((/**
                 * @param {?} f
                 * @return {?}
                 */
                function (f) { return f[search.field].indexOf(search.value) > -1; }));
            }
        }
        else {
            items = this.uistate.allActList;
        }
        this.total = items.length;
        // this.items = items;
        if (items) {
            this.allActisTable.componentRef.instance.loadData({
                data: items
            });
        }
    };
    /**
     * @param {?} arg
     * @return {?}
     */
    JumpScopeComponent.prototype.searchSelect = /**
     * @param {?} arg
     * @return {?}
     */
    function (arg) {
        this.pageInfo.pageIndex = arg.pageInfo.pageIndex;
        this.pageInfo.pageSize = arg.pageInfo.pageSize;
        /** @type {?} */
        var search = arg.search;
        this.loadSelect(search);
    };
    /**
     * @param {?=} search
     * @return {?}
     */
    JumpScopeComponent.prototype.loadSelect = /**
     * @param {?=} search
     * @return {?}
     */
    function (search) {
        /** @type {?} */
        var start = (this.pageInfo.pageIndex - 1) * this.pageInfo.pageSize;
        /** @type {?} */
        var end = start + this.pageInfo.pageSize;
        /** @type {?} */
        var items = [];
        if (search && search.value) {
            if (search.field === '*') {
                items = this.uistate.allActList.filter((/**
                 * @param {?} i
                 * @return {?}
                 */
                function (i) { return i.Name.indexOf(search.value) > -1 || i.Id.indexOf(search.value) > -1; }));
            }
            else {
                items = this.uistate.allActList.filter((/**
                 * @param {?} f
                 * @return {?}
                 */
                function (f) { return f[search.field].indexOf(search.value) > -1; }));
            }
        }
        else {
            items = this.uistate.allActList;
        }
        this.total = items.length;
        // this.items = items;
        if (items) {
            this.userActis.componentRef.instance.loadData({
                data: items
            });
        }
    };
    /**
     * @return {?}
     */
    JumpScopeComponent.prototype.deleteRow = /**
     * @return {?}
     */
    function () {
        var _this = this;
        if (this.actTable.selectedRow && this.actTable.selectedRow.data) {
            /** @type {?} */
            var i = this.actis.findIndex((/**
             * @param {?} d
             * @return {?}
             */
            function (d) { return d.id === _this.actTable.selectedRow.data.id; }));
            this.actis.splice(i, 1);
            this.actTable.loadData(this.actis);
        }
        else {
            this.message.info(this.localePipe.transform('component.jumpScope.selectedRow'));
        }
    };
    JumpScopeComponent.decorators = [
        { type: Component, args: [{
                    selector: 'app-jump-scope',
                    template: "<div class=\"f-page\">\r\n  <div class=\"f-utils-fill-flex-column farris-split-section m-2 h-100\">\r\n    <section class=\"f-utils-fill-flex-column h-100\">\r\n      <div class=\"f-utils-fill-flex-column h-100\">\r\n        <form class=\"h-100\">\r\n          <div class=\"f-utils-fill-flex-column h-100\">\r\n            <!-- \u5141\u8BB8\u9009\u62E9\u76EE\u6807\u8282\u70B9\u5355\u9009\u9879 -->\r\n            <!-- <div class=\"mx-4 mt-3 farris-form-controls-inline\">\r\n              <div class=\"farris-group-wrap\">\r\n                <div class=\"form-group farris-form-group\">\r\n                  <div class=\"farris-input-wrap\">\r\n                    <div class=\"custom-control custom-checkbox\">\r\n                      <input class=\"custom-control-input\" name=\"submitterAutoPass\" type=\"checkbox\"\r\n                        id=\"submitterAutoPass\" [(ngModel)]=\"outConnectNode\" />\r\n                      <label class=\"custom-control-label\" for=\"submitterAutoPass\">\u5141\u8BB8\u9009\u62E9\u76EE\u6807\u8282\u70B9</label>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div> -->\r\n            <!-- \u53EF\u9009\u8282\u70B9\u5C0F\u6807\u9898 -->\r\n            <div class=\"mx-2 mt-1\">\r\n              <div class=\"title-content\">\r\n                <h4 class=\"title-text\">{{'component.jumpScope.optionalNodes'|wfLocale}}</h4><span class=\"title-line\"></span>\r\n              </div>\r\n            </div>\r\n            <div class=\"mt-2 mx-4 farris-form-controls-inline\">\r\n              <div class=\"farris-group-wrap\">\r\n                <div class=\"form-group\">\r\n                  <!-- \u7AD6\u5217\u679A\u4E3E\u7684category\u9009\u9879 -->\r\n                  <farris-radiogroup [(ngModel)]=\"category\" [data]=\"categoryListItems\" name=\"category\"\r\n                    [horizontal]=false>\r\n                  </farris-radiogroup>\r\n                </div>\r\n                <!-- \u9644\u52A0\u8282\u70B9\u5E2E\u52A9 -->\r\n                <farris-lookup-grid #userActisDialog\r\n                  [items]=\"uistate.allActList | jumpScopePipe:uistate.propertyData.Id \" [columns]=\"cols\"\r\n                  [disabled]=\"!(category === 'SpecifiedSet')\" [resizable]=\"true\" [singleSelect]=\"false\" [idField]=\"'Id'\"\r\n                  [textField]=\"'Name'\" [(ngModel)]=\"actis\" [valueField]=\"'Id'\" [pagination]=\"true\"\r\n                  [pageIndex]=\"pageInfo.pageIndex\" name=\"defaultActivities\" [pageSize]=\"pageInfo.pageSize\" (search)=\"searchSelect($event)\"\r\n                  [pageList]=\"pageInfo.pageList\" [total]=\"total\" [enableClear]=\"false\" title=\"{{'component.jumpScope.listOfAdditional'|wfLocale}}\"\r\n                  [displayType]=\"'List'\" [remoteSearch]='false' [enableToSelect]=\"false\" placeholder=\"{{'component.jumpScope.pleaseSelect1'|wfLocale}}\" [dictPicked]=\"actisSelect\">\r\n                </farris-lookup-grid>\r\n              </div>\r\n            </div>\r\n            <!-- \u9ED8\u8BA4\u8282\u70B9\u5C0F\u6807\u9898 -->\r\n            <div class=\"mx-2 mt-1\">\r\n              <div class=\"title-content\">\r\n                <h4 class=\"title-text\">{{'component.jumpScope.defaultNode'|wfLocale}}</h4><span class=\"title-line\"></span>\r\n              </div>\r\n            </div>\r\n            <div class=\"mt-2 mx-4 farris-form-controls-inline\">\r\n              <div class=\"farris-group-wrap\">\r\n                <div class=\"form-group\">\r\n                  <!-- \u7AD6\u5217\u679A\u4E3E\u7684DefaultType\u9009\u9879 -->\r\n                  <farris-radiogroup [(ngModel)]=\"defaultType\" [data]=\"defaultTypeListItems\" name=\"defaultType\"\r\n                    [horizontal]=false>\r\n                  </farris-radiogroup>\r\n                </div>\r\n                <!-- \u9ED8\u8BA4\u8282\u70B9\u5E2E\u52A9 -->\r\n                <farris-lookup-grid #allActisTable [items]=\"uistate.allActList | jumpScopePipe:uistate.propertyData.Id \"\r\n                  [columns]=\"cols\" [disabled]=\"!(defaultType === 'SpecifyNode')\" [resizable]=\"true\"\r\n                  [singleSelect]=\"true\" [idField]=\"'Id'\" [textField]=\"'Name'\" [(ngModel)]=\"defaultacty\"\r\n                  [valueField]=\"'Id'\" [pagination]=\"true\" placeholder=\"{{'component.jumpScope.pleaseSelect2'|wfLocale}}\" [pageIndex]=\"pageInfo.pageIndex\"\r\n                  name=\"defaultActivity\" [pageSize]=\"pageInfo.pageSize\" [pageList]=\"pageInfo.pageList\" [total]=\"total\"\r\n                  [enableClear]=\"false\" title=\"{{'component.jumpScope.defaultNodeList'|wfLocale}}\" (search)=\"searchDefault($event)\" [displayType]=\"'List'\" [remoteSearch]='false' [dictPicked]=\"defaultActivitySelect\">\r\n                </farris-lookup-grid>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </section>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type=\"button\" class=\"btn btn-secondary btn-sm\" (click)=\"clickCancel()\">{{'component.jumpScope.clickCancel'|wfLocale}}</button>\r\n  <button type=\"button\" class=\"btn btn-primary btn-sm mx-2\" (click)=\"clickOK()\">{{'component.jumpScope.clickOK'|wfLocale}}</button>\r\n</ng-template>\r\n\r\n<!-- <ng-template #buttonRef>\r\n  <button class=\"btn btn-sm btn-primary mx-2\" (click)=\"actisSelect()\">\u786E\u5B9A</button>\r\n  <button class=\"btn btn-sm btn-default\" (click)=\"allActisDialog.close()\">\u53D6\u6D88</button>\r\n</ng-template> -->\r\n<!-- <farris-dialog #allActisDialog [buttons]=\"buttonRef\" [width]=\"700\" [height]=\"520\" title=\"'\u6D3B\u52A8\u5217\u8868'\">\r\n  <div class=\"f-utils-fill-flex-column farris-overflow-y-auto h-100 m-2\">\r\n    <farris-datagrid #allActisTable [columns]=\"cols\"\r\n      [data]=\"uistate.userActList | jumpScopePipe:uistate.propertyData.Id\" [idField]=\"'Id'\" [fit]=\"true\"\r\n      [fitColumns]=\"true\" [pagination]='false' [multiSelect]=\"true\" [showCheckbox]=\"true\" [multiSelect]=\"true\"\r\n      [checkOnSelect]=\"true\" [selectOnCheck]=\"true\">\r\n    </farris-datagrid>\r\n  </div>\r\n</farris-dialog> -->\r\n",
                    providers: [
                        WfLocalePipe,
                    ],
                    styles: [".title-content{color:#000;display:inline-flex;align-items:center;line-height:1.375rem;position:relative;overflow:hidden;padding:0 0 0 1rem;min-width:760px}.title-content ::before{content:'';width:.25rem;height:1.125rem;background:#59a1ff;border-radius:1px;position:absolute;top:50%;left:0;margin-top:-.5625rem}.title-text{font-size:1rem;line-height:1.375rem;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;margin-bottom:0;margin-right:10px}.title-line{flex-grow:1;border-bottom:1px dashed rgba(0,0,0,.1)}"]
                }] }
    ];
    /** @nocollapse */
    JumpScopeComponent.ctorParameters = function () { return [
        { type: ProcessDesignerUIState },
        { type: MessagerService },
        { type: ChangeDetectorRef, decorators: [{ type: Optional }] },
        { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
        { type: undefined, decorators: [{ type: Inject, args: [WF_LANG_RESOURCES,] }] },
        { type: WfLocalePipe, decorators: [{ type: Optional }] }
    ]; };
    JumpScopeComponent.propDecorators = {
        cls: [{ type: HostBinding, args: ['class',] }],
        closeModal: [{ type: Output }],
        submitModal: [{ type: Output }],
        value: [{ type: Input }],
        modalFooter: [{ type: ViewChild, args: ['iconSelectFooter',] }],
        allActisTable: [{ type: ViewChild, args: ['allActisTable',] }],
        allActisDialog: [{ type: ViewChild, args: ['allActisDialog',] }],
        actTable: [{ type: ViewChild, args: ['actTable',] }],
        lookup: [{ type: ViewChild, args: ['lookup',] }],
        userActis: [{ type: ViewChild, args: ['userActisDialog',] }]
    };
    return JumpScopeComponent;
}());
var JumpScopeConverter = /** @class */ (function () {
    function JumpScopeConverter(localePipe) {
        this.localePipe = localePipe;
    }
    /**
     * @return {?}
     */
    JumpScopeConverter.prototype.convertTo = /**
     * @return {?}
     */
    function () {
        return this.localePipe.transform('component.jumpScope.set');
    };
    return JumpScopeConverter;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/** @enum {string} */
var ResubmitEffect = {
    sequence: 'sequence',
    backToMe: 'backToMe',
    backToCurrentNode: 'backToCurrentNode',
};

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var BackwardRuleComponent = /** @class */ (function () {
    function BackwardRuleComponent(uiState, message, notify, cdr, localeId, resources, localePipe) {
        var _this = this;
        this.uiState = uiState;
        this.message = message;
        this.notify = notify;
        this.cdr = cdr;
        this.localeId = localeId;
        this.resources = resources;
        this.localePipe = localePipe;
        this.cls = 'farris-main-area flex-column';
        this.editorParams = {};
        this.nodeType = 'UserActivity';
        this.closeModal = new EventEmitter();
        this.submitModal = new EventEmitter();
        this.modalConfig = {
            title: this.localePipe.transform('component.backwardRule.backwardRule'),
            width: 760,
            height: 505,
            showButtons: true
        };
        this.displayTestText = [];
        this.fullActs = [];
        this.listItems = [
            { Id: 'InitialActityId', Name: this.localePipe.transform('component.backwardRule.initialActityId') },
            { Id: 'PrecursorActivityId', Name: this.localePipe.transform('component.backwardRule.precursorActivityId') },
            { Id: 'Empty', Name: this.localePipe.transform('component.backwardRule.empty') }
        ];
        this.items = [];
        this.itemsTemp = [];
        this.itemsBackScope = [];
        this.itemsBackScopeTemp = [];
        this.columns = [
            { title: this.localePipe.transform('component.backwardRule.name'), field: 'Name', width: 100, searchField: 'Name' },
            { title: this.localePipe.transform('component.backwardRule.id'), field: 'Id', width: 100, searchField: 'Id' },
        ];
        this.selectAbleChecked = false;
        this.waitReturnChecked = false;
        this.resubmitEffectOptions = [
            { value: ResubmitEffect.sequence, text: this.localePipe.transform('component.backwardRule.sequence') },
            { value: ResubmitEffect.backToMe, text: this.localePipe.transform('component.backwardRule.backToMe') },
            { value: ResubmitEffect.backToCurrentNode, text: this.localePipe.transform('component.backwardRule.backToCurrentNode') },
        ];
        this.dynamicBackWardRuleAbleChecked = false;
        this.targetRef = this.listItems[0].Id;
        this.selectTargetList = new Array();
        this.popover = '1.顺序流转:按照流转线顺序进行流转; 2.返回我:完成策略为抢占：只给驳回人创建任务,完成策略为会签：驳回人与未审批人收到新任务，已审批人员自动审批通过; 3.返回本节点:实际效果受“再次进入节点时，办理人是否是节点已办人员影响”选项的影响';
        this.pageInfo = {
            pageIndex: 1,
            pageList: [10, 20, 30, 50],
            pageSize: 20
        };
        this.dictPicked = (/**
         * @param {?} arg
         * @return {?}
         */
        function (arg) {
            _this.targetRef = arg.Id;
            _this.displayText = arg.Name;
            if (arg.Id === 'Empty' && !_this.selectAbleChecked) {
                _this.selectAbleChecked = true;
                _this.notify.info(_this.localePipe.transform('component.backwardRule.dictPicked'));
            }
            return of$1({ closeDialog: true });
        });
        this.dictPickedTest = (/**
         * @param {?} arg
         * @return {?}
         */
        function (arg) {
            _this.fullActs = arg;
            return of$1({ closeDialog: true });
        });
        this.beforeOpen = (/**
         * @return {?}
         */
        function () {
            _this.items = _this.deepCloneBackDefine(_this.itemsTemp);
            return of$1(true);
        });
        this.beforeOpenTest = (/**
         * @return {?}
         */
        function () {
            _this.itemsBackScope = _this.deepCloneBackDefine(_this.itemsBackScopeTemp);
            return of$1(true);
        });
        this.localePipe = this.localePipe || new WfLocalePipe(localeId, resources);
        this.listItems = this.listItems.concat(this.uiState.userActList);
        this.items = this.listItems;
        this.itemsBackScope = this.listItems;
        this.total = this.listItems.length;
        this.totalBackScope = this.listItems.length;
    }
    Object.defineProperty(BackwardRuleComponent.prototype, "value", {
        set: /**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            var _this = this;
            var e_1, _a;
            if (data) {
                this.selectAbleChecked = data.SelectTargetAble;
                if (!data.SelectTargetAble) {
                    this.selectTargetList = new Array();
                }
                else {
                    this.selectTargetList = data.SelectTargetList;
                }
                this.waitReturnChecked = data.WaitReturn;
                this.dynamicBackWardRuleAbleChecked = data.DynamicBackWardRuleAble;
                this.resubmitEffect = data.ResubmitEffect;
                if (!data.TargetRef) {
                    this.targetRef = 'Empty';
                }
                else {
                    this.targetRef = data.TargetRef;
                }
                if (this.resubmitEffect === null) {
                    this.resubmitEffect = ResubmitEffect.sequence;
                }
                /** @type {?} */
                var strs = data.SelectTargetList;
                if (strs && strs.length > 0) {
                    var _loop_1 = function (str) {
                        if (this_1.listItems.filter((/**
                         * @param {?} act
                         * @return {?}
                         */
                        function (act) { return act.Id === str; }))[0]) {
                            /** @type {?} */
                            var name_1 = this_1.listItems.filter((/**
                             * @param {?} act
                             * @return {?}
                             */
                            function (act) { return act.Id === str; }))[0].Name;
                            this_1.displayTestText.push(name_1);
                        }
                    };
                    var this_1 = this;
                    try {
                        for (var strs_1 = __values(strs), strs_1_1 = strs_1.next(); !strs_1_1.done; strs_1_1 = strs_1.next()) {
                            var str = strs_1_1.value;
                            _loop_1(str);
                        }
                    }
                    catch (e_1_1) { e_1 = { error: e_1_1 }; }
                    finally {
                        try {
                            if (strs_1_1 && !strs_1_1.done && (_a = strs_1.return)) _a.call(strs_1);
                        }
                        finally { if (e_1) throw e_1.error; }
                    }
                }
                /** @type {?} */
                var act = this.listItems.find((/**
                 * @param {?} item
                 * @return {?}
                 */
                function (item) { return item.Id === _this.targetRef; }));
                if (act) {
                    this.displayText = act.Name;
                }
                else {
                    this.displayText = '';
                    setTimeout((/**
                     * @return {?}
                     */
                    function () {
                        _this.message.warning(_this.localePipe.transform('component.backwardRule.reEdit'));
                    }), 500);
                }
            }
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    BackwardRuleComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        this.nodeType = this.editorParams.nodeType;
        if (this.nodeType !== 'UserActivity') {
            this.listItems = this.listItems.filter((/**
             * @param {?} i
             * @return {?}
             */
            function (i) { return i.Id !== 'Empty'; }));
            this.items = this.listItems;
            this.total = this.listItems.length;
        }
        this.itemsBackScope = this.listItems.filter((/**
         * @param {?} i
         * @return {?}
         */
        function (i) { return i.Id !== 'Empty' && i.Id !== 'PrecursorActivityId'; }));
        this.totalBackScope = this.itemsBackScope.length;
        this.itemsTemp = this.deepCloneDefine(this.items);
        this.itemsBackScopeTemp = this.deepCloneDefine(this.itemsBackScope);
    };
    /**
     * @return {?}
     */
    BackwardRuleComponent.prototype.ngAfterViewInit = /**
     * @return {?}
     */
    function () {
    };
    /**
     * @return {?}
     */
    BackwardRuleComponent.prototype.selectAbleClick = /**
     * @return {?}
     */
    function () {
        var _this = this;
        if (this.uiState.propertyData.ClrTypeID === 'wf.UserActivity'
            && this.uiState.propertyData.CompleteStrategy !== this.uiState.completeIterator[0].key
            && this.selectAbleChecked === true) {
            this.message.info(this.localePipe.transform('component.backwardRule.selectAbleClick'), (/**
             * @return {?}
             */
            function () {
                _this.selectAbleChecked = false;
            }));
        }
        if (this.selectAbleChecked == false) {
            this.displayTestText = [];
        }
    };
    /**
     * @return {?}
     */
    BackwardRuleComponent.prototype.waitReturnClick = /**
     * @return {?}
     */
    function () {
        this.waitReturnChecked = !this.waitReturnChecked;
    };
    /**
     * @return {?}
     */
    BackwardRuleComponent.prototype.dynamicBackWardRuleAbleClick = /**
     * @return {?}
     */
    function () {
        this.dynamicBackWardRuleAbleChecked = !this.dynamicBackWardRuleAbleChecked;
    };
    /**
     * @return {?}
     */
    BackwardRuleComponent.prototype.clickOK = /**
     * @return {?}
     */
    function () {
        var _this = this;
        var e_2, _a, e_3, _b;
        /** @type {?} */
        var list = [];
        // 重新打开设置界面，没有进行节点配置的情况（DestinationActivities）
        if (this.fullActs.length === 0 && this.displayTestText.length > 0) {
            try {
                for (var _c = __values(this.displayTestText), _d = _c.next(); !_d.done; _d = _c.next()) {
                    var act = _d.value;
                    try {
                        for (var _e = __values(this.listItems), _f = _e.next(); !_f.done; _f = _e.next()) {
                            var allAct = _f.value;
                            if (act === allAct.Name) {
                                list.push(allAct.Id);
                            }
                        }
                    }
                    catch (e_3_1) { e_3 = { error: e_3_1 }; }
                    finally {
                        try {
                            if (_f && !_f.done && (_b = _e.return)) _b.call(_e);
                        }
                        finally { if (e_3) throw e_3.error; }
                    }
                }
            }
            catch (e_2_1) { e_2 = { error: e_2_1 }; }
            finally {
                try {
                    if (_d && !_d.done && (_a = _c.return)) _a.call(_c);
                }
                finally { if (e_2) throw e_2.error; }
            }
        }
        else if (this.fullActs && this.fullActs.length > 0) {
            // 附加节点的id传给模型上的DestinationActivities
            this.fullActs.forEach((/**
             * @param {?} act
             * @return {?}
             */
            function (act) {
                if (_this.uiState.userActList.some((/**
                 * @param {?} u
                 * @return {?}
                 */
                function (u) { return u.Id == act.Id; }))) {
                    list.push(act.Id);
                }
            }));
        }
        /** @type {?} */
        var backWardRule = {
            TargetRef: this.getTargetRef(),
            SelectTargetAble: this.selectAbleChecked,
            WaitReturn: this.waitReturnChecked,
            DynamicBackWardRuleAble: this.dynamicBackWardRuleAbleChecked,
            SelectTargetList: list,
            ResubmitEffect: this.resubmitEffect
        };
        /** @type {?} */
        var object = { value: backWardRule, parameters: null };
        this.submitModal.emit(object);
    };
    /**
     * @return {?}
     */
    BackwardRuleComponent.prototype.clickCancel = /**
     * @return {?}
     */
    function () {
        this.closeModal.emit();
    };
    /**
     * @param {?} arg
     * @return {?}
     */
    BackwardRuleComponent.prototype.pagerChanged = /**
     * @param {?} arg
     * @return {?}
     */
    function (arg) {
        this.pageInfo.pageIndex = arg.pageIndex;
        this.pageInfo.pageSize = arg.pageSize;
        /** @type {?} */
        var search = {
            field: arg.searchValue.searchField,
            value: arg.searchValue.searchValue
        };
        this.load(search);
    };
    /**
     * @param {?} arg
     * @return {?}
     */
    BackwardRuleComponent.prototype.pagerChangedBackScope = /**
     * @param {?} arg
     * @return {?}
     */
    function (arg) {
        this.pageInfo.pageIndex = arg.pageIndex;
        this.pageInfo.pageSize = arg.pageSize;
        /** @type {?} */
        var search = {
            field: arg.searchValue.searchField,
            value: arg.searchValue.searchValue
        };
        this.loadBackScope(search);
    };
    /**
     * @param {?} arg
     * @return {?}
     */
    BackwardRuleComponent.prototype.pageSizeChange = /**
     * @param {?} arg
     * @return {?}
     */
    function (arg) {
        console.log(arg);
        this.pageInfo.pageIndex = arg.pageIndex;
        this.pageInfo.pageSize = arg.pageSize;
        /** @type {?} */
        var search = {
            field: arg.searchValue.searchField,
            value: arg.searchValue.searchValue
        };
        this.load(search);
    };
    /**
     * @param {?} arg
     * @return {?}
     */
    BackwardRuleComponent.prototype.pageSizeChangeBackScope = /**
     * @param {?} arg
     * @return {?}
     */
    function (arg) {
        console.log(arg);
        this.pageInfo.pageIndex = arg.pageIndex;
        this.pageInfo.pageSize = arg.pageSize;
        /** @type {?} */
        var search = {
            field: arg.searchValue.searchField,
            value: arg.searchValue.searchValue
        };
        this.loadBackScope(search);
    };
    /**
     * @param {?} arg
     * @return {?}
     */
    BackwardRuleComponent.prototype.search = /**
     * @param {?} arg
     * @return {?}
     */
    function (arg) {
        this.pageInfo.pageIndex = arg.pageInfo.pageIndex;
        this.pageInfo.pageSize = arg.pageInfo.pageSize;
        /** @type {?} */
        var search = arg.search;
        this.load(search);
    };
    /**
     * @param {?} arg
     * @return {?}
     */
    BackwardRuleComponent.prototype.searchBackScope = /**
     * @param {?} arg
     * @return {?}
     */
    function (arg) {
        this.pageInfo.pageIndex = arg.pageInfo.pageIndex;
        this.pageInfo.pageSize = arg.pageInfo.pageSize;
        /** @type {?} */
        var search = arg.search;
        this.loadBackScope(search);
    };
    /**
     * @param {?=} search
     * @return {?}
     */
    BackwardRuleComponent.prototype.load = /**
     * @param {?=} search
     * @return {?}
     */
    function (search) {
        /** @type {?} */
        var start = (this.pageInfo.pageIndex - 1) * this.pageInfo.pageSize;
        /** @type {?} */
        var end = start + this.pageInfo.pageSize;
        /** @type {?} */
        var items = [];
        if (search) {
            if (search.field === '*') {
                items = this.listItems.filter((/**
                 * @param {?} i
                 * @return {?}
                 */
                function (i) { return i.Name.indexOf(search.value) > -1 || i.Id.indexOf(search.value) > -1; }));
            }
            else {
                items = this.listItems.filter((/**
                 * @param {?} f
                 * @return {?}
                 */
                function (f) { return f[search.field].indexOf(search.value) > -1; }));
            }
        }
        else {
            items = this.listItems;
        }
        this.total = items.length;
        this.items = items;
        this.hlp.componentRef.instance.loadData({
            data: this.items
        });
    };
    /**
     * @param {?=} search
     * @return {?}
     */
    BackwardRuleComponent.prototype.loadBackScope = /**
     * @param {?=} search
     * @return {?}
     */
    function (search) {
        /** @type {?} */
        var start = (this.pageInfo.pageIndex - 1) * this.pageInfo.pageSize;
        /** @type {?} */
        var end = start + this.pageInfo.pageSize;
        /** @type {?} */
        var itemsBackScope = [];
        if (search) {
            if (search.field === '*') {
                itemsBackScope = this.listItems.filter((/**
                 * @param {?} i
                 * @return {?}
                 */
                function (i) { return i.Name.indexOf(search.value) > -1 || i.Id.indexOf(search.value) > -1; }));
            }
            else {
                itemsBackScope = this.listItems.filter((/**
                 * @param {?} f
                 * @return {?}
                 */
                function (f) { return f[search.field].indexOf(search.value) > -1; }));
            }
        }
        else {
            itemsBackScope = this.listItems;
        }
        this.totalBackScope = itemsBackScope.length;
        this.itemsBackScope = itemsBackScope;
        this.hlpScope.componentRef.instance.loadData({
            data: this.itemsBackScope
        });
    };
    /**
     * @private
     * @return {?}
     */
    BackwardRuleComponent.prototype.getTargetRef = /**
     * @private
     * @return {?}
     */
    function () {
        if (this.targetRef === 'Empty') {
            return '';
        }
        else {
            return this.targetRef;
        }
    };
    //为了打开后仍然显示最初数据，而不是过滤后的数据
    //为了打开后仍然显示最初数据，而不是过滤后的数据
    /**
     * @param {?} target
     * @return {?}
     */
    BackwardRuleComponent.prototype.deepCloneDefine = 
    //为了打开后仍然显示最初数据，而不是过滤后的数据
    /**
     * @param {?} target
     * @return {?}
     */
    function (target) {
        /** @type {?} */
        var result = [];
        target.forEach((/**
         * @param {?} t
         * @return {?}
         */
        function (t) { return result.push(JSON.stringify(t)); }));
        return result;
    };
    /**
     * @param {?} target
     * @return {?}
     */
    BackwardRuleComponent.prototype.deepCloneBackDefine = /**
     * @param {?} target
     * @return {?}
     */
    function (target) {
        /** @type {?} */
        var result = [];
        target.forEach((/**
         * @param {?} t
         * @return {?}
         */
        function (t) { return result.push(JSON.parse(t)); }));
        return result;
    };
    BackwardRuleComponent.decorators = [
        { type: Component, args: [{
                    selector: 'procDesigner-backward-rule',
                    template: "<div class=\"f-page\">\r\n  <div class=\"f-utils-fill-flex-column farris-split-section m-2 h-100\">\r\n    <section class=\"f-utils-fill-flex-column h-100\">\r\n      <div class=\"f-utils-fill-flex-column farris-overflow-y-auto h-100\" style=\"border-radius:16px;border: 1.5px solid #F1F3F7;\">\r\n        <div class=\"farris-form form-inline farris-form-inline\">\r\n          <div class=\"col-12 farris-group-auto my-3 pr-5\">\r\n            <div class=\"farris-group-wrap\">\r\n              <div class=\"form-group farris-form-group\">\r\n                <label class=\"col-form-label\">\r\n                  <span class=\"farris-label-info text-danger\">*</span>\r\n                  <span class=\"farris-label-text\">{{'component.backwardRule.rejectedTo:' | wfLocale}}</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap\" style=\"padding-right: 30px\">\r\n                  <farris-lookup-grid #hlp [items]=\"items\" [columns]=\"columns\" [resizable]=\"true\" [singleSelect]=\"true\"\r\n                    [idField]=\"'Id'\" [textField]=\"'Name'\" [(ngModel)]=\"displayText\" [valueField]=\"'Id'\"  [beforeOpen] = \"beforeOpen\"\r\n                    [pagination]=\"false\" [pageIndex]=\"pageInfo.pageIndex\" [pageSize]=\"pageInfo.pageSize\"\r\n                    [pageList]=\"pageInfo.pageList\" [total]=\"total\" title=\"{{'component.backwardRule.title' | wfLocale}}\" [displayType]=\"'List'\"\r\n                    [dictPicked]=\"dictPicked\" [remoteSearch]='false' (pagerChanged)=\"pagerChanged($event)\"\r\n                    (search)=\"search($event)\" [enableClear]=\"false\" (pageSizeChange)=\"pageSizeChange($event)\">\r\n                  </farris-lookup-grid>\r\n                  <div class=\"farris-feedback valid-feedback\"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div *ngIf=\"nodeType==='UserActivity'\">\r\n            <div class=\"col-12 farris-group-auto my-3\">\r\n              <div class=\"farris-group-wrap\" style=\"padding-left: 2.75rem!important\">\r\n                <div class=\"form-group farris-form-group\">\r\n                  <div class=\"farris-input-wrap\">\r\n                    <div class=\"custom-control custom-checkbox\">\r\n                      <input class=\"custom-control-input\" name=\"selectAble\" type=\"checkbox\" id=\"selectAble\"\r\n                        [(ngModel)]=\"selectAbleChecked\" (change)=\"selectAbleClick()\" />\r\n                      <label class=\"custom-control-label\" for=\"selectAble\">{{'component.backwardRule.dynamicSelection' | wfLocale}}</label>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div class=\"col-12 farris-group-auto my-3 pr-5\" *ngIf=\"selectAbleChecked\">\r\n              <div class=\"farris-group-wrap\">\r\n                <div class=\"form-group farris-form-group\">\r\n                  <label class=\"col-form-label\">\r\n                    <span class=\"farris-label-text\">{{'component.backwardRule.backScope' | wfLocale}}</span>\r\n                  </label>\r\n                  <div class=\"farris-input-wrap\" style=\"padding-right: 30px;\">\r\n                    <farris-lookup-grid #hlpScope [items]=\"itemsBackScope\" [columns]=\"columns\" [disabled]=\"!(selectAbleChecked)\"  [beforeOpen] = \"beforeOpenTest\"\r\n                      [resizable]=\"true\" [singleSelect]=\"false\" [idField]=\"'Id'\" [textField]=\"'Name'\" [(ngModel)]=\"displayTestText\" [valueField]=\"'Id'\"\r\n                      [pagination]=\"false\" [pageIndex]=\"pageInfo.pageIndex\" [pageSize]=\"pageInfo.pageSize\"\r\n                      [pageList]=\"pageInfo.pageList\" [total]=\"totalBackScope\" title=\"{{'component.backwardRule.title' | wfLocale}}\" [displayType]=\"'List'\"\r\n                      [dictPicked]=\"dictPickedTest\" [remoteSearch]='false' (pagerChanged)=\"pagerChangedBackScope($event)\"\r\n                      placeholder=\"{{'component.backwardRule.defaultPrompt' | wfLocale}}\" [enableToSelect]=\"false\"\r\n                      (search)=\"searchBackScope($event)\" [enableClear]=\"false\" (pageSizeChange)=\"pageSizeChangeBackScope($event)\">\r\n                    </farris-lookup-grid>\r\n                    <div class=\"farris-feedback valid-feedback\"></div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div class=\"col-12 farris-group-auto my-3 pr-5\">\r\n              <div class=\"farris-group-wrap\">\r\n                <div class=\"form-group farris-form-group\">\r\n                  <label class=\"col-form-label\">\r\n                    <span class=\"farris-label-text\">{{'component.backwardRule.resubmitEffectOptions' | wfLocale}}</span>\r\n                  </label>\r\n                  <div class=\"farris-input-wrap\" style=\"padding-right: 30px\">\r\n                    <farris-combo-list [data]=\"resubmitEffectOptions\" [textField]=\"'text'\" [valueField]=\"'value'\"\r\n                      [idField]=\"'value'\" [(ngModel)]=\"resubmitEffect\" style=\"flex: 1;\" [enableClear]=\"false\">\r\n                    </farris-combo-list>\r\n                    <div class=\"farris-feedback valid-feedback\"></div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div class=\"col-12 farris-group-auto my-3 pr-5\">\r\n              <div class=\"farris-group-wrap\">\r\n                <div class=\"form-group farris-form-group\">\r\n                  <label class=\"col-form-label\">\r\n                    <span class=\"farris-label-text\"></span>\r\n                  </label>\r\n                  <div class=\"farris-input-wrap\" style=\"padding-right: 30px;border-radius:15px\">\r\n                    <div class=\"page-friendly-reminder\" style=\"background:#ECF4FF;padding: 0.5rem!important;border-radius:6px\">\r\n                      <div class=\"reminder-message\">\r\n                        <span class=\"reminder-title\">\r\n                          <span class=\"f-icon f-icon-info\">\r\n                          </span>\r\n                          <span class=\"reminder-name\" style=\"padding-left: 0.25rem\">\r\n                          </span>\r\n                        </span>\r\n                        <span class=\"message\"><br/>{{'component.backwardRule.popover1' | wfLocale}}<br/>\r\n                          {{'component.backwardRule.popover2' | wfLocale}}<br/>\r\n                          {{'component.backwardRule.popover3' | wfLocale}}<br/>\r\n                        </span>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div class=\"col-12 farris-group-auto my-3\">\r\n              <div class=\"farris-group-wrap\" style=\"padding-left: 2.75rem!important\">\r\n                <div class=\"form-group farris-form-group\">\r\n                  <div class=\"farris-input-wrap\">\r\n                    <div class=\"custom-control custom-checkbox\">\r\n                      <input class=\"custom-control-input\" name=\"dynamicBackWardRuleAble\" type=\"checkbox\"\r\n                        id=\"dynamicBackWardRuleAble\" [checked]=\"dynamicBackWardRuleAbleChecked\"\r\n                        (change)=\"dynamicBackWardRuleAbleClick()\" />\r\n                      <label class=\"custom-control-label\" for=\"dynamicBackWardRuleAble\">{{'component.backwardRule.allowModification' | wfLocale}}</label>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </section>\r\n  </div>\r\n</div>\r\n<ng-template #iconSelectFooter>\r\n  <button type=\"button\" class=\"btn btn-secondary btn-sm mx-2\" (click)=\"clickCancel()\">{{'component.backwardRule.clickCancel' | wfLocale}}</button>\r\n  <button type=\"button\" class=\"btn btn-primary btn-sm mx-2\" (click)=\"clickOK()\">{{'component.backwardRule.clickOk' | wfLocale}}</button>\r\n</ng-template>\r\n",
                    providers: [
                        WfLocalePipe,
                    ],
                    styles: [".item-header{padding:1rem}.item{padding:.5rem 5rem}"]
                }] }
    ];
    /** @nocollapse */
    BackwardRuleComponent.ctorParameters = function () { return [
        { type: ProcessDesignerUIState },
        { type: MessagerService },
        { type: NotifyService },
        { type: ChangeDetectorRef, decorators: [{ type: Optional }] },
        { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
        { type: undefined, decorators: [{ type: Inject, args: [WF_LANG_RESOURCES,] }] },
        { type: WfLocalePipe, decorators: [{ type: Optional }] }
    ]; };
    BackwardRuleComponent.propDecorators = {
        cls: [{ type: HostBinding, args: ['class',] }],
        editorParams: [{ type: Input }],
        value: [{ type: Input }],
        nodeType: [{ type: Input }],
        closeModal: [{ type: Output }],
        submitModal: [{ type: Output }],
        modalFooter: [{ type: ViewChild, args: ['iconSelectFooter',] }],
        hlp: [{ type: ViewChild, args: ['hlp',] }],
        hlpScope: [{ type: ViewChild, args: ['hlpScope',] }]
    };
    return BackwardRuleComponent;
}());
var BackwardRuleConverter = /** @class */ (function () {
    function BackwardRuleConverter(localePipe) {
        this.localePipe = localePipe;
    }
    /**
     * @param {?} data
     * @return {?}
     */
    BackwardRuleConverter.prototype.convertTo = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        if (data) {
            return this.localePipe.transform('component.backwardRule.set');
        }
        return this.localePipe.transform('component.backwardRule.notSet');
    };
    return BackwardRuleConverter;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var PerformerUIState = /** @class */ (function () {
    function PerformerUIState(uiState) {
        this.uiState = uiState;
        this.performersList = [];
        this.typeCollection = [
            { text: '用户', value: 'wf.UserParticipantExpression' },
            { text: '变量参与者', value: 'wf.VariableParticipantExpression' },
            { text: '岗位', value: 'wf.PositionParticipantExpression' },
            { text: '构件参与者', value: 'wf.ComponentParticipantExpression' },
            { text: '汇报关系', value: 'wf.ReportingLineParticipantExpression' },
            { text: '矩阵', value: 'wf.MatrixParticipantExpression' },
            { text: '历史活动办理人', value: 'wf.ActivityExecutorParticipantExpression' },
            { text: '单位/部门', value: 'wf.OrganizationParticipantExpression' }
        ];
        this.performerInfo = {
            performers: [],
            variablePerformers: [],
            components: [],
            reportingLines: [],
            matrixParticipants: [],
            activityExecutors: [],
            organizationParticipants: [],
            options: null,
            isAllScope: false
        };
        if (this.uiState.scene === 'inSuite') {
            this.typeCollection = [
                { text: '用户', value: 'wf.UserParticipantExpression' },
                { text: '变量参与者', value: 'wf.VariableParticipantExpression' },
                { text: '角色', value: 'wf.PositionParticipantExpression' },
                { text: '构件参与者', value: 'wf.ComponentParticipantExpression' },
                { text: '汇报关系', value: 'wf.ReportingLineParticipantExpression' },
                { text: '矩阵', value: 'wf.MatrixParticipantExpression' },
                { text: '历史活动办理人', value: 'wf.ActivityExecutorParticipantExpression' },
                { text: '单位/部门', value: 'wf.OrganizationParticipantExpression' }
            ];
        }
        else {
            this.typeCollection = [
                { text: '用户', value: 'wf.UserParticipantExpression' },
                { text: '变量参与者', value: 'wf.VariableParticipantExpression' },
                { text: '岗位', value: 'wf.PositionParticipantExpression' },
                { text: '构件参与者', value: 'wf.ComponentParticipantExpression' },
                { text: '汇报关系', value: 'wf.ReportingLineParticipantExpression' },
                { text: '矩阵', value: 'wf.MatrixParticipantExpression' },
                { text: '历史活动办理人', value: 'wf.ActivityExecutorParticipantExpression' },
                { text: '单位/部门', value: 'wf.OrganizationParticipantExpression' }
            ];
        }
    }
    /**
     * @return {?}
     */
    PerformerUIState.prototype.clearPerformer = /**
     * @return {?}
     */
    function () {
        this.performerInfo.performers = new Array();
        this.performerInfo.components = new Array();
        this.performerInfo.reportingLines = new Array();
        this.performerInfo.matrixParticipants = new Array();
        this.performerInfo.activityExecutors = new Array();
        this.performerInfo.organizationParticipants = new Array();
        this.performersList = new Array();
    };
    PerformerUIState.decorators = [
        { type: Injectable }
    ];
    /** @nocollapse */
    PerformerUIState.ctorParameters = function () { return [
        { type: ProcessDesignerUIState }
    ]; };
    return PerformerUIState;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var PerformerRepository = /** @class */ (function () {
    function PerformerRepository() {
    }
    PerformerRepository.decorators = [
        { type: Injectable }
    ];
    return PerformerRepository;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var PerformerViewModel = /** @class */ (function () {
    function PerformerViewModel(resolver, injector, modalService) {
        this.resolver = resolver;
        this.injector = injector;
        this.modalService = modalService;
    }
    PerformerViewModel.decorators = [
        { type: Injectable }
    ];
    /** @nocollapse */
    PerformerViewModel.ctorParameters = function () { return [
        { type: ComponentFactoryResolver },
        { type: Injector },
        { type: BsModalService }
    ]; };
    return PerformerViewModel;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var UserPerformerEntity = /** @class */ (function (_super) {
    __extends(UserPerformerEntity, _super);
    function UserPerformerEntity(id, name, type) {
        return _super.call(this, id, name, type) || this;
    }
    return UserPerformerEntity;
}(PerformerEntity));

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var PerformerConfigService = /** @class */ (function () {
    function PerformerConfigService(http) {
        var _this = this;
        this.http = http;
        this.lookupConfig = new ReplaySubject();
        // let rootPath = '';
        // try {
        //     rootPath = (window as any).gspframeworkService.common.getBasePath.get();
        // } catch (error) {
        // }
        // this.http.get(rootPath + '/platform/runtime/wf/web/wf-proc-designer/assets/config/performerlookupconfig.json').subscribe((data) => {
        this.http.get('/platform/runtime/wf/web/wf-proc-designer/assets/config/performerlookupconfig.json').subscribe((/**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            _this.lookupConfig.next(data);
        }));
    }
    /**
     * @return {?}
     */
    PerformerConfigService.prototype.getLookupConfig = /**
     * @return {?}
     */
    function () {
        return this.lookupConfig.asObservable();
    };
    PerformerConfigService.decorators = [
        { type: Injectable }
    ];
    /** @nocollapse */
    PerformerConfigService.ctorParameters = function () { return [
        { type: HttpService }
    ]; };
    return PerformerConfigService;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var UserPerformerComponent = /** @class */ (function () {
    function UserPerformerComponent(designerUIState, expr, injector, lookupConfig, ngZone, cdr, localeId, resources, localePipe, http, message) {
        this.designerUIState = designerUIState;
        this.expr = expr;
        this.injector = injector;
        this.lookupConfig = lookupConfig;
        this.ngZone = ngZone;
        this.cdr = cdr;
        this.localeId = localeId;
        this.resources = resources;
        this.localePipe = localePipe;
        this.http = http;
        this.message = message;
        this.cls = 'd-flex flex-fill h-100';
        this.showClearButton = false;
        this.bindingData = {};
        this.farrisUserHelpShowTabIds = 'recent,organization';
        this.activeTabId = 'organization';
        this.selectedUserIds = '';
        this.userTypeCollection = [
            { text: this.localePipe.transform('component.userPerformer.regularUser'), value: 'user' },
            { text: this.localePipe.transform('component.userPerformer.variablePart'), value: 'variable' }
        ];
        this.userType = this.userTypeCollection[0].value;
        this.variableOrgTypes = [
            { name: this.localePipe.transform('component.userPerformer.sys'), value: 'Sys' },
            { name: this.localePipe.transform('component.userPerformer.administrative_organization'), value: 'Administrative_organization' }
        ];
        this.curOrgType = this.variableOrgTypes[0].value;
        this.hasAdminOrg = false;
        this.userTypeButtonNeedShow = false; // 用户类型单选按钮是否需要显示
        // 用户类型单选按钮是否需要显示
        this.multiSelect = true; //选人组件是否支持多选（编辑用户时只能单选）
        this.users = [];
        this.localePipe = this.localePipe || new WfLocalePipe(localeId, resources);
    }
    /**
     * @return {?}
     */
    UserPerformerComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var url = '/api/runtime/wf/v1.0/reportingOrgType/hasAdminOrg';
        this.http.get(url).subscribe((/**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            _this.hasAdminOrg = data;
            // inSuite场景，变量参与者场景下显示用户类型
            if (_this.designerUIState.scene === 'inSuite' && _this.userType === 'variable') {
                _this.userTypeButtonNeedShow = true;
            }
            else {
                _this.userTypeButtonNeedShow = data && (_this.userType === 'variable' || _this.userType === null);
            }
        }));
    };
    /**
     * @return {?}
     */
    UserPerformerComponent.prototype.ngAfterViewInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.ngZone.runOutsideAngular((/**
         * @return {?}
         */
        function () {
            _this.inputGroup.nativeElement.addEventListener('mouseenter', _this.onMouseEnter.bind(_this));
            _this.inputGroup.nativeElement.addEventListener('mouseleave', _this.onMouseLeave.bind(_this));
        }));
    };
    /**
     * @param {?} event
     * @return {?}
     */
    UserPerformerComponent.prototype.onMouseEnter = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        this.showClearButton = true;
        if (this.showClearButton) {
            this.toggleClearIcon(event, true);
        }
    };
    /**
     * @param {?} event
     * @return {?}
     */
    UserPerformerComponent.prototype.onMouseLeave = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        this.showClearButton = false;
        this.toggleClearIcon(event, false);
    };
    /**
     * @private
     * @param {?} event
     * @param {?=} isShow
     * @return {?}
     */
    UserPerformerComponent.prototype.toggleClearIcon = /**
     * @private
     * @param {?} event
     * @param {?=} isShow
     * @return {?}
     */
    function (event, isShow) {
        if (isShow === void 0) { isShow = false; }
        /** @type {?} */
        var str = isShow ? '' : 'none';
        /** @type {?} */
        var clearIcon = event.target.querySelector('.input-group-clear');
        if (clearIcon) {
            clearIcon.style.display = str;
        }
    };
    /**
     * @param {?} data
     * @return {?}
     */
    UserPerformerComponent.prototype.clear = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        this.bindingData = {};
        this.users = [];
        this.selectedUserIds = '';
        this.variableOrgTypes = [
            { name: this.localePipe.transform('component.userPerformer.sys'), value: 'Sys' },
            { name: this.localePipe.transform('component.userPerformer.administrative_organization'), value: 'Administrative_organization' }
        ];
    };
    /**
     * @param {?} data
     * @return {?}
     */
    UserPerformerComponent.prototype.selectUsers = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        var _this = this;
        // 固定用户
        if (this.userType === this.userTypeCollection[0].value) {
            this.lookupConfig.getLookupConfig().subscribe((/**
             * @param {?} re
             * @return {?}
             */
            function (re) {
                // 项目配置了自己的帮助时
                if (re.user && re.user.impl) {
                    System.import(re.user.impl)
                        .then((/**
                     * @param {?} moduleFactorys
                     * @return {?}
                     */
                    function (moduleFactorys) {
                        /** @type {?} */
                        var moduleFactory = Object.values(moduleFactorys)[0];
                        /** @type {?} */
                        var moduleRef = moduleFactory.create(_this.injector);
                        moduleRef.instance.showHelp().subscribe((/**
                         * @param {?} data
                         * @return {?}
                         */
                        function (data) {
                            if (data && data.length > 0) {
                                _this.users = data.map((/**
                                 * @param {?} u
                                 * @return {?}
                                 */
                                function (u) {
                                    /** @type {?} */
                                    var user = new UserPerformerEntity(u.id, u.name, 'wf.UserParticipantExpression');
                                    user.orgId = u.orgId;
                                    user.orgName = u.orgName;
                                    user.userType = _this.userTypeCollection[0].value;
                                    return user;
                                }));
                            }
                        }));
                    }));
                }
                else { // 加载默认帮助
                    _this.userHelp.farrisDialogshow();
                }
            }));
        }
        else {
            this.showExprHelp();
        }
    };
    /**
     * @return {?}
     */
    UserPerformerComponent.prototype.editConditon = /**
     * @return {?}
     */
    function () {
        var _this = this;
        var e_1, _a, e_2, _b, e_3, _c, e_4, _d;
        // this.expr.clearContext();
        if (this.designerUIState.schemas.length > 0) {
            try {
                for (var _e = __values(this.designerUIState.schemas), _f = _e.next(); !_f.done; _f = _e.next()) {
                    var schema = _f.value;
                    this.expr.addSchema('Schema', schema);
                }
            }
            catch (e_1_1) { e_1 = { error: e_1_1 }; }
            finally {
                try {
                    if (_f && !_f.done && (_a = _e.return)) _a.call(_e);
                }
                finally { if (e_1) throw e_1.error; }
            }
            if (this.designerUIState.schemas[0].entityTypes && this.designerUIState.schemas[0].entityTypes.length > 0) {
                /** @type {?} */
                var entityType = this.designerUIState.schemas[0].entityTypes[0];
                this.expr.addInjectedEntity(entityType.name, 'Schema', entityType.name, InjectedType.EntityType);
            }
        }
        /** @type {?} */
        var context = new Array();
        context = this.designerUIState.addContext(context);
        if (this.designerUIState.subActivityContext.length > 0) {
            var _loop_1 = function (variable) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    context.push(variable);
                }
            };
            try {
                for (var _g = __values(this.designerUIState.subActivityContext), _h = _g.next(); !_h.done; _h = _g.next()) {
                    var variable = _h.value;
                    _loop_1(variable);
                }
            }
            catch (e_2_1) { e_2 = { error: e_2_1 }; }
            finally {
                try {
                    if (_h && !_h.done && (_b = _g.return)) _b.call(_g);
                }
                finally { if (e_2) throw e_2.error; }
            }
        }
        if (this.designerUIState.activityComponentContext.length > 0) {
            var _loop_2 = function (variable) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    context.push(variable);
                }
            };
            try {
                for (var _j = __values(this.designerUIState.activityComponentContext), _k = _j.next(); !_k.done; _k = _j.next()) {
                    var variable = _k.value;
                    _loop_2(variable);
                }
            }
            catch (e_3_1) { e_3 = { error: e_3_1 }; }
            finally {
                try {
                    if (_k && !_k.done && (_c = _j.return)) _c.call(_j);
                }
                finally { if (e_3) throw e_3.error; }
            }
        }
        if (context.length > 0) {
            try {
                for (var context_1 = __values(context), context_1_1 = context_1.next(); !context_1_1.done; context_1_1 = context_1.next()) {
                    var v = context_1_1.value;
                    this.expr.addContext(v);
                }
            }
            catch (e_4_1) { e_4 = { error: e_4_1 }; }
            finally {
                try {
                    if (context_1_1 && !context_1_1.done && (_d = context_1.return)) _d.call(context_1);
                }
                finally { if (e_4) throw e_4.error; }
            }
        }
        this.expr.setEditPattern(ExprEditMode.Conditional); // 表达式展现模式：默认简易版
        this.expr.addExpressionText(this.condition);
        this.expr.buildExpression().then((/**
         * @param {?} expressioninfo
         * @return {?}
         */
        function (expressioninfo) {
            _this.condition = expressioninfo;
            //点击确定后，去除表达式里面的新增的上下文变量
            if (context.length > 0) {
                _this.expr.exprEntity.contextEntities = _this.expr.exprEntity.contextEntities.filter((/**
                 * @param {?} x
                 * @return {?}
                 */
                function (x) { return !context.some((/**
                 * @param {?} y
                 * @return {?}
                 */
                function (y) { return y.key === x.key; })); }));
            }
        }));
    };
    /**
     * @param {?} event
     * @return {?}
     */
    UserPerformerComponent.prototype.usersSelect = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        var _this = this;
        this.users = event.data.map((/**
         * @param {?} u
         * @return {?}
         */
        function (u) {
            /** @type {?} */
            var user = new UserPerformerEntity(u.userId, u.name, 'wf.UserParticipantExpression');
            user.orgId = u.defaultOrgId;
            user.orgName = u.orgAllPath;
            user.userType = _this.userTypeCollection[0].value;
            return user;
        }));
    };
    /**
     * @return {?}
     */
    UserPerformerComponent.prototype.showExprHelp = /**
     * @return {?}
     */
    function () {
        var _this = this;
        var e_5, _a, e_6, _b, e_7, _c, e_8, _d, e_9, _e;
        // this.expr.clearContext();
        this.expr.setEditPattern(ExprEditMode.Advanced);
        if (this.designerUIState.schemas.length > 0) {
            try {
                for (var _f = __values(this.designerUIState.schemas), _g = _f.next(); !_g.done; _g = _f.next()) {
                    var schema = _g.value;
                    this.expr.addSchema('Schema', schema);
                }
            }
            catch (e_5_1) { e_5 = { error: e_5_1 }; }
            finally {
                try {
                    if (_g && !_g.done && (_a = _f.return)) _a.call(_f);
                }
                finally { if (e_5) throw e_5.error; }
            }
            if (this.designerUIState.schemas[0].entityTypes && this.designerUIState.schemas[0].entityTypes.length > 0) {
                /** @type {?} */
                var entityType = this.designerUIState.schemas[0].entityTypes[0];
                this.expr.addInjectedEntity(entityType.name, 'Schema', entityType.name, InjectedType.EntityType);
            }
        }
        /** @type {?} */
        var context = new Array();
        if (this.designerUIState.participantContext.length > 0) {
            try {
                for (var _h = __values(this.designerUIState.participantContext), _j = _h.next(); !_j.done; _j = _h.next()) {
                    var variable = _j.value;
                    context.push(variable);
                }
            }
            catch (e_6_1) { e_6 = { error: e_6_1 }; }
            finally {
                try {
                    if (_j && !_j.done && (_b = _h.return)) _b.call(_h);
                }
                finally { if (e_6) throw e_6.error; }
            }
        }
        if (this.designerUIState.subActivityContext.length > 0) {
            var _loop_3 = function (variable) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    context.push(variable);
                }
            };
            try {
                for (var _k = __values(this.designerUIState.subActivityContext), _l = _k.next(); !_l.done; _l = _k.next()) {
                    var variable = _l.value;
                    _loop_3(variable);
                }
            }
            catch (e_7_1) { e_7 = { error: e_7_1 }; }
            finally {
                try {
                    if (_l && !_l.done && (_c = _k.return)) _c.call(_k);
                }
                finally { if (e_7) throw e_7.error; }
            }
        }
        if (this.designerUIState.processVariableContext.length > 0) {
            var _loop_4 = function (variable) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    context.push(variable);
                }
            };
            try {
                for (var _m = __values(this.designerUIState.processVariableContext), _o = _m.next(); !_o.done; _o = _m.next()) {
                    var variable = _o.value;
                    _loop_4(variable);
                }
            }
            catch (e_8_1) { e_8 = { error: e_8_1 }; }
            finally {
                try {
                    if (_o && !_o.done && (_d = _m.return)) _d.call(_m);
                }
                finally { if (e_8) throw e_8.error; }
            }
        }
        if (context.length > 0) {
            try {
                for (var context_2 = __values(context), context_2_1 = context_2.next(); !context_2_1.done; context_2_1 = context_2.next()) {
                    var v = context_2_1.value;
                    this.expr.addContext(v);
                }
            }
            catch (e_9_1) { e_9 = { error: e_9_1 }; }
            finally {
                try {
                    if (context_2_1 && !context_2_1.done && (_e = context_2.return)) _e.call(context_2);
                }
                finally { if (e_9) throw e_9.error; }
            }
        }
        if (this.users.length > 0) {
            this.expr.addExpressionText(this.users[0].performerId);
        }
        else {
            this.expr.addExpressionText('');
        }
        this.expr.buildExpression().then((/**
         * @param {?} expressioninfo
         * @return {?}
         */
        function (expressioninfo) {
            var e_10, _a;
            /** @type {?} */
            var user = new UserPerformerEntity(expressioninfo, '', 'wf.UserParticipantExpression');
            user.tag = 'expression';
            user.performerName = _this.variableParticipantName(expressioninfo);
            user.userType = _this.userTypeCollection[1].value;
            if (_this.variableParticipantName(expressioninfo) === '') {
                _this.message.error(_this.localePipe.transform('component.userPerformer.cantUseContext'));
                _this.users = [];
            }
            else {
                _this.users = [user];
            }
            try {
                for (var _b = __values(_this.designerUIState.participantContext), _c = _b.next(); !_c.done; _c = _b.next()) { // 根据表达式中的函数名判断是否使用的是上下文变量,除三种特殊上下文变量其余放开限制
                    var c = _c.value;
                    if (user.performerId.indexOf(c.key) >= 0) {
                        _this.variableOrgTypes = [
                            { name: _this.localePipe.transform('component.userPerformer.sys'), value: 'Sys' }
                        ];
                        break;
                    }
                    else {
                        _this.variableOrgTypes = [
                            { name: _this.localePipe.transform('component.userPerformer.sys'), value: 'Sys' },
                            { name: _this.localePipe.transform('component.userPerformer.administrative_organization'), value: 'Administrative_organization' }
                        ];
                    }
                }
            }
            catch (e_10_1) { e_10 = { error: e_10_1 }; }
            finally {
                try {
                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                }
                finally { if (e_10) throw e_10.error; }
            }
            //点击确定后，去除表达式里面的新增的上下文变量
            if (context.length > 0) {
                _this.expr.exprEntity.contextEntities = _this.expr.exprEntity.contextEntities.filter((/**
                 * @param {?} x
                 * @return {?}
                 */
                function (x) { return !context.some((/**
                 * @param {?} y
                 * @return {?}
                 */
                function (y) { return y.key === x.key; })); }));
            }
        }));
    };
    /**
     * @return {?}
     */
    UserPerformerComponent.prototype.getPerformers = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.users.map((/**
         * @param {?} user
         * @return {?}
         */
        function (user) {
            if (user.orgId === undefined) {
                user.orgType = _this.curOrgType;
                return user;
            }
        }));
        if (!this.condition) {
            this.condition = '';
        }
        if (this.condition || this.condition === '') {
            this.users = this.users.map((/**
             * @param {?} user
             * @return {?}
             */
            function (user) {
                user.condition = _this.condition;
                return user;
            }));
        }
        return this.users;
    };
    /**
     * @private
     * @param {?} expr
     * @return {?}
     */
    UserPerformerComponent.prototype.variableParticipantName = /**
     * @private
     * @param {?} expr
     * @return {?}
     */
    function (expr) {
        var e_11, _a, e_12, _b;
        try {
            for (var _c = __values(this.designerUIState.participantContext), _d = _c.next(); !_d.done; _d = _c.next()) {
                var c = _d.value;
                if (expr.indexOf(c.key) > -1) {
                    if (this.curOrgType !== 'Sys') { // 行政人员类型不允许使用上下文变量
                        return '';
                    }
                    return c.name;
                }
            }
        }
        catch (e_11_1) { e_11 = { error: e_11_1 }; }
        finally {
            try {
                if (_d && !_d.done && (_a = _c.return)) _a.call(_c);
            }
            finally { if (e_11) throw e_11.error; }
        }
        try {
            for (var _e = __values(this.designerUIState.processVariableContext), _f = _e.next(); !_f.done; _f = _e.next()) {
                var c = _f.value;
                if (expr.indexOf(c.key) > -1) {
                    return c.name;
                }
            }
        }
        catch (e_12_1) { e_12 = { error: e_12_1 }; }
        finally {
            try {
                if (_f && !_f.done && (_b = _e.return)) _b.call(_e);
            }
            finally { if (e_12) throw e_12.error; }
        }
        return JSON.parse(expr).expr;
    };
    /**
     * @param {?} data
     * @return {?}
     */
    UserPerformerComponent.prototype.orgTypeChange = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        if (data === 'Sys') {
            this.curOrgType = this.variableOrgTypes[0].value;
        }
        else {
            this.curOrgType = this.variableOrgTypes[1].value;
        }
    };
    UserPerformerComponent.decorators = [
        { type: Component, args: [{
                    selector: 'app-user-performer',
                    template: "<div class=\"d-flex flex-fill farris-overflow-y-auto p-md-2\" style=\"background: #FFF;\">\r\n  <div class=\"d-flex flex-fill farris-overflow-y-auto mx-3 my-2\" style=\"border-radius:16px;border: 1.5px solid #F1F3F7;\">\r\n  <form style=\"width: 100%;\" >\r\n    <div class=\"d-flex m-2 flex-column w-100\">\r\n      <div class=\"d-flex flex-column\">\r\n        <div class=\"farris-form form-inline  farris-form-inline mr-5\">\r\n          <div class=\"col-12 farris-group-auto my-4\">\r\n            <div class=\"farris-group-wrap\">\r\n              <div class=\"form-group farris-form-group\">\r\n                <label class=\"col-form-label\">\r\n                  <span class=\"farris-label-info text-danger\">*</span>\r\n                  <span class=\"farris-label-text\" *ngIf=\"userType === 'user'\">{{'component.userPerformer.user'|wfLocale}}</span>\r\n                  <span class=\"farris-label-text\" *ngIf=\"userType === 'variable'\">{{'component.userPerformer.variable'|wfLocale}}</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap\">\r\n                  <div #inputGroup class=\"input-group\">\r\n                    <input type=\"text\" class=\"form-control\" [value]=\"users | usersName \" name=\"users\" [readOnly]=\"true\" />\r\n                    <div *ngIf=\"multiSelect\" class=\"input-group-append\">\r\n                      <span [style.display]=\"showClearButton ? '' : 'none'\" class=\"input-group-text input-group-clear\"\r\n                        (click)=\"clear($event)\">\r\n                        <i class=\"f-icon modal_close\"></i>\r\n                      </span>\r\n                      <span class=\"input-group-text\" (click)=\"selectUsers($event)\" style=\"background: #FFF;\">\r\n                        <i class=\"f-icon f-icon-lookup\"></i>\r\n                      </span>\r\n                    </div>\r\n                  </div>\r\n                  <div class=\"farris-feedback valid-feedback\"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div class=\"d-flex flex-column\">\r\n        <div class=\"farris-form form-inline farris-form-inline mr-5\">\r\n          <div class=\"col-12 farris-group-auto my-4\">\r\n            <div class=\"farris-group-wrap\">\r\n              <div class=\"form-group farris-form-group\">\r\n                <label class=\"col-form-label\">\r\n                  <span class=\"farris-label-text\">{{'component.userPerformer.condition'|wfLocale}}</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap\">\r\n                  <div class=\"input-group\">\r\n                    <input type=\"text\" class=\"form-control\" [(ngModel)]=\"condition\" name=\"conditon\" [readOnly]=\"true\" />\r\n                    <div class=\"input-group-append\">\r\n                      <span class=\"input-group-text\" (click)=\"editConditon()\" style=\"background: #FFF;\">\r\n                        <i class=\"f-icon f-icon-lookup\"></i>\r\n                      </span>\r\n                    </div>\r\n                  </div>\r\n                  <div class=\"farris-feedback valid-feedback\"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </form>\r\n</div>\r\n</div>\r\n\r\n<farris-personnel-selector #userHelp style=\"display: none\" [readonly]=\"false\" [width]=\"'100%'\"\r\n  [multiSelect]=\"multiSelect\" [includeJobLeavers]=\"false\" [includeCurrentUser]=\"true\" [unSelectedUserIds]=\"users | usersId \"\r\n  [enableChildHierarchy]=\"true\" [showTabIds]=\"farrisUserHelpShowTabIds\" [activeTabId]=\"activeTabId\"\r\n  [userIds]=\"selectedUserIds\" [personnelOrderField]=\"'orderby_ordernum'\" [userTypeMode]=\"'WfMode'\"\r\n  [includeStopUser]=\"false\" (selectionsChange)=\"usersSelect($event)\">\r\n</farris-personnel-selector>\r\n",
                    providers: [
                        WfLocalePipe,
                    ],
                    styles: [""]
                }] }
    ];
    /** @nocollapse */
    UserPerformerComponent.ctorParameters = function () { return [
        { type: ProcessDesignerUIState },
        { type: ExpressionService },
        { type: Injector },
        { type: PerformerConfigService },
        { type: NgZone },
        { type: ChangeDetectorRef, decorators: [{ type: Optional }] },
        { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
        { type: undefined, decorators: [{ type: Inject, args: [WF_LANG_RESOURCES,] }] },
        { type: WfLocalePipe, decorators: [{ type: Optional }] },
        { type: HttpService },
        { type: MessagerService }
    ]; };
    UserPerformerComponent.propDecorators = {
        cls: [{ type: HostBinding, args: ['class',] }],
        userHelp: [{ type: ViewChild, args: [PersonnelSelectorComponent,] }],
        inputGroup: [{ type: ViewChild, args: ['inputGroup',] }]
    };
    return UserPerformerComponent;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var ComponentPerformerService = /** @class */ (function () {
    function ComponentPerformerService(http) {
        this.http = http;
    }
    /**
     * @param {?} helpId
     * @param {?} su
     * @param {?} pageIndex
     * @param {?} pageSiza
     * @param {?=} search
     * @return {?}
     */
    ComponentPerformerService.prototype.getLookUpData = /**
     * @param {?} helpId
     * @param {?} su
     * @param {?} pageIndex
     * @param {?} pageSiza
     * @param {?=} search
     * @return {?}
     */
    function (helpId, su, pageIndex, pageSiza, search) {
        /** @type {?} */
        var url = "/api/runtime/wf/v1.0/dtProcDefs/getHelpData?helpId=" + helpId + "&pageIndex=" + pageIndex + "&pageSize=" + pageSiza;
        if (search) {
            url += "&searchValue=" + JSON.stringify(search);
        }
        return this.http.get(url);
    };
    /**
     * @param {?} helpId
     * @param {?} su
     * @return {?}
     */
    ComponentPerformerService.prototype.getHelpMetaData = /**
     * @param {?} helpId
     * @param {?} su
     * @return {?}
     */
    function (helpId, su) {
        /** @type {?} */
        var url = "/api/runtime/lcm/v1.0/rt-metadatas/" + helpId;
        return this.http.get(url);
    };
    ComponentPerformerService.decorators = [
        { type: Injectable }
    ];
    /** @nocollapse */
    ComponentPerformerService.ctorParameters = function () { return [
        { type: HttpService }
    ]; };
    return ComponentPerformerService;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var ComponentPerformer = /** @class */ (function () {
    function ComponentPerformer() {
        this.id = ProcessDeUtil.GenerateElementId();
    }
    return ComponentPerformer;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var ComponentPerformerComponent = /** @class */ (function () {
    function ComponentPerformerComponent(designerState, expr, resolver, injector, sessionSrc, modalService, componentService, ngZone, service, util, http, cdr, localeId, resources, localePipe) {
        var _this = this;
        this.designerState = designerState;
        this.expr = expr;
        this.resolver = resolver;
        this.injector = injector;
        this.sessionSrc = sessionSrc;
        this.modalService = modalService;
        this.componentService = componentService;
        this.ngZone = ngZone;
        this.service = service;
        this.util = util;
        this.http = http;
        this.cdr = cdr;
        this.localeId = localeId;
        this.resources = resources;
        this.localePipe = localePipe;
        this.cls = 'farris-main-area flex-column';
        this.showClearButton = false;
        this.helpId = '';
        this.lookupDisplayText = '';
        this.columns = [
            { field: 'code', width: 60, title: this.localePipe.transform('component.componentPerformer.code') },
            { field: 'name', width: 60, title: this.localePipe.transform('component.componentPerformer.name') },
            { field: 'description', width: 60, title: this.localePipe.transform('component.componentPerformer.description'), showTips: true },
            {
                field: 'valueText', width: 100, title: this.localePipe.transform('component.componentPerformer.valueText'),
                editor: {
                    type: 'input-group',
                    options: {
                        groupText: '<i class="f-icon f-icon-lookup"></i>',
                        editable: false,
                        clickHandle: (/**
                         * @param {?} e
                         * @return {?}
                         */
                        function (e) {
                            e.formControl.setValue(e.instance.value ? e.instance.value : '');
                            _this.showExprHelp(e);
                        }),
                        clear: (/**
                         * @param {?} e
                         * @return {?}
                         */
                        function (e) {
                            var e_1, _a;
                            // 清理valueText，也应该清理value
                            e.rowData.value = '';
                            try {
                                for (var _b = __values(_this.component.actualParameters), _c = _b.next(); !_c.done; _c = _b.next()) {
                                    var p = _c.value;
                                    if (p.code === e.rowId) {
                                        p.value = '';
                                    }
                                }
                            }
                            catch (e_1_1) { e_1 = { error: e_1_1 }; }
                            finally {
                                try {
                                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                                }
                                finally { if (e_1) throw e_1.error; }
                            }
                        })
                    }
                }
            }
        ];
        this.helpInfo = {
            helpId: '',
            su: '',
            columns: [],
            displayType: 'List',
            items: [],
            pageInfo: {
                pageIndex: 1,
                pageList: [10, 20, 30, 50],
                pageSize: 20
            },
            search: { category: 'all' },
            title: this.localePipe.transform('component.componentPerformer.help'),
            total: 100,
            fieldInfo: {
                idField: 'id',
                textField: 'name',
                valueField: 'id'
            }
        };
        this.beforeEdit = (/**
         * @param {?} param
         * @return {?}
         */
        function (param) {
            /** @type {?} */
            var rowData = (/** @type {?} */ (param.rowData));
            _this.curParameter = rowData;
            switch (rowData.fetchValueMode) {
                case ParameterFetchValueMode.express:
                    param.column.editor = {
                        type: 'input-group',
                        options: {
                            groupText: '<i class="f-icon f-icon-lookup"></i>',
                            editable: false,
                            clickHandle: (/**
                             * @param {?} e
                             * @return {?}
                             */
                            function (e) {
                                e.formControl.setValue(e.instance.value ? e.instance.value : '');
                                _this.showExprHelp(e);
                            }),
                            clear: (/**
                             * @param {?} e
                             * @return {?}
                             */
                            function (e) {
                                var e_2, _a;
                                // 清理valueText，也应该清理value
                                e.rowData.value = '';
                                try {
                                    for (var _b = __values(_this.component.actualParameters), _c = _b.next(); !_c.done; _c = _b.next()) {
                                        var p = _c.value;
                                        if (p.code === e.rowId) {
                                            p.value = '';
                                        }
                                    }
                                }
                                catch (e_2_1) { e_2 = { error: e_2_1 }; }
                                finally {
                                    try {
                                        if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                                    }
                                    finally { if (e_2) throw e_2.error; }
                                }
                            })
                        }
                    };
                    break;
                case ParameterFetchValueMode.none:
                    param.column.editor = {
                        type: 'input-group',
                        options: {
                            groupText: '<i class="f-icon f-icon-lookup"></i>',
                            editable: false,
                            clickHandle: (/**
                             * @param {?} e
                             * @return {?}
                             */
                            function (e) {
                                e.formControl.setValue(e.instance.value ? e.instance.value : '');
                                _this.showExprHelp(e);
                            }),
                            clear: (/**
                             * @param {?} e
                             * @return {?}
                             */
                            function (e) {
                                var e_3, _a;
                                // 清理valueText，也应该清理value
                                e.rowData.value = '';
                                try {
                                    for (var _b = __values(_this.component.actualParameters), _c = _b.next(); !_c.done; _c = _b.next()) {
                                        var p = _c.value;
                                        if (p.code === e.rowId) {
                                            p.value = '';
                                        }
                                    }
                                }
                                catch (e_3_1) { e_3 = { error: e_3_1 }; }
                                finally {
                                    try {
                                        if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                                    }
                                    finally { if (e_3) throw e_3.error; }
                                }
                            })
                        }
                    };
                    break;
                case ParameterFetchValueMode.const:
                    param.column.editor = { type: EditorTypes.TEXTBOX, options: {} };
                    break;
                case ParameterFetchValueMode.enum:
                    param.column.editor = { type: EditorTypes.TEXTBOX, options: {} };
                    break;
                case ParameterFetchValueMode.help:
                    param.column.editor = {
                        type: 'input-group',
                        options: {
                            groupText: '<i class="f-icon f-icon-lookup"></i>',
                            editable: false,
                            clickHandle: (/**
                             * @param {?} e
                             * @return {?}
                             */
                            function (e) {
                                _this.cell = e;
                                _this.helpInfo.helpId = ((/** @type {?} */ (rowData.fetchValueSetting))).helpId;
                                _this.helpInfo.su = ((/** @type {?} */ (rowData.fetchValueSetting))).serviceUnit;
                                _this.helpInfo.pageInfo = {
                                    pageIndex: 1,
                                    pageList: [10, 20, 30, 50],
                                    pageSize: 20
                                };
                                _this.helpInfo.search = { category: 'all' };
                                _this.getHelpInfo();
                            }),
                            clear: (/**
                             * @param {?} e
                             * @return {?}
                             */
                            function (e) {
                                var e_4, _a;
                                // 清理valueText，也应该清理value
                                e.rowData.value = '';
                                try {
                                    for (var _b = __values(_this.component.actualParameters), _c = _b.next(); !_c.done; _c = _b.next()) {
                                        var p = _c.value;
                                        if (p.code === e.rowId) {
                                            p.value = '';
                                        }
                                    }
                                }
                                catch (e_4_1) { e_4 = { error: e_4_1 }; }
                                finally {
                                    try {
                                        if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                                    }
                                    finally { if (e_4) throw e_4.error; }
                                }
                            })
                        }
                    };
                    break;
            }
            return of$1(true);
        });
        this.afterEdit = (/**
         * @param {?} rowIndex
         * @param {?} rowData
         * @param {?=} column
         * @return {?}
         */
        function (rowIndex, rowData, column) {
            return of$1(true);
        });
        /**
         * 帮助前事件
         * @param e
         * @return
         */
        this.onDictPicking = (/**
         * @param {?} e
         * @return {?}
         */
        function (e) {
            e.instance.http = {
                getData: (/**
                 * @param {?} url
                 * @param {?} params
                 * @return {?}
                 */
                function (url, params) {
                    /** @type {?} */
                    var _url = "/api/runtime/bcc/v1.0/help/data/" + _this.helpInfo.helpId;
                    params = Object.assign(params || {}, { withSpecificField: true });
                    return _this.http.put(_url, params).pipe(catchError((/**
                     * @param {?} e
                     * @return {?}
                     */
                    function (e) {
                        if (e.error && e.error.innerMessage && e.error.innerMessage.indexOf('Could not find metadata') > -1) {
                            e.error.Message = _this.localePipe.transform('component.componentPerformer.serverSideNotFound');
                        }
                        return throwError(e);
                    })));
                })
            };
            return of$1(true);
        });
        this.dictPicked = (/**
         * @param {?} rowData
         * @return {?}
         */
        function (rowData) {
            var e_5, _a;
            if (_this.cell) {
                _this.cell.formControl.setValue(_this.util.getValue(rowData, _this.helpInfo.fieldInfo.textField));
                _this.cell.instance.cd.detectChanges();
                _this.cell.rowData.value = _this.util.getValue(rowData, _this.helpInfo.fieldInfo.valueField);
                try {
                    for (var _b = __values(_this.component.actualParameters), _c = _b.next(); !_c.done; _c = _b.next()) {
                        var p = _c.value;
                        if (p.code === _this.cell.rowId) {
                            p.value = _this.util.getValue(rowData, _this.helpInfo.fieldInfo.valueField);
                        }
                    }
                }
                catch (e_5_1) { e_5 = { error: e_5_1 }; }
                finally {
                    try {
                        if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                    }
                    finally { if (e_5) throw e_5.error; }
                }
                return of$1(true);
            }
        });
        this.localePipe = this.localePipe || new WfLocalePipe(localeId, resources);
    }
    Object.defineProperty(ComponentPerformerComponent.prototype, "component", {
        get: /**
         * @return {?}
         */
        function () {
            return this.componentPerformer;
        },
        set: /**
         * @param {?} cmp
         * @return {?}
         */
        function (cmp) {
            var _this = this;
            if (cmp && cmp.methodCode) {
                this.service.getHelpMetaData(cmp.metadataId, '').subscribe((/**
                 * @param {?} re
                 * @return {?}
                 */
                function (re) {
                    /** @type {?} */
                    var c = JSON.parse(re.content);
                    /** @type {?} */
                    var operation = c.operations.find((/**
                     * @param {?} o
                     * @return {?}
                     */
                    function (o) { return o.code === cmp.methodCode; }));
                    if (operation) {
                        cmp.actualParameters = cmp.actualParameters.map((/**
                         * @param {?} a
                         * @return {?}
                         */
                        function (a) {
                            /** @type {?} */
                            var p = operation.parameters.find((/**
                             * @param {?} i
                             * @return {?}
                             */
                            function (i) { return i.code === a.code; }));
                            if (p) {
                                return {
                                    code: a.code,
                                    name: p.name,
                                    value: a.value,
                                    valueText: a.valueText ? a.valueText : a.value,
                                    description: p.description,
                                    tag: a.tag,
                                    fetchValueMode: p.fetchValueMode,
                                    fetchValueSetting: p.fetchValueSetting
                                };
                            }
                            else {
                                throw new Error(_this.localePipe.transform('component.componentPerformer.componentMethod'));
                            }
                        }));
                        _this.componentPerformer = cmp;
                    }
                    else {
                        throw new Error(_this.localePipe.transform('component.componentPerformer.methodNotExist'));
                    }
                }));
            }
            else {
                this.componentPerformer = new ComponentPerformer();
            }
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    ComponentPerformerComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
    };
    /**
     * @return {?}
     */
    ComponentPerformerComponent.prototype.ngAfterViewInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.ngZone.runOutsideAngular((/**
         * @return {?}
         */
        function () {
            _this.inputGroup.nativeElement.addEventListener('mouseenter', _this.onMouseEnter.bind(_this));
            _this.inputGroup.nativeElement.addEventListener('mouseleave', _this.onMouseLeave.bind(_this));
        }));
    };
    /**
     * @param {?} event
     * @return {?}
     */
    ComponentPerformerComponent.prototype.onMouseEnter = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        this.showClearButton = true;
        if (this.showClearButton) {
            this.toggleClearIcon(event, true);
        }
    };
    /**
     * @param {?} event
     * @return {?}
     */
    ComponentPerformerComponent.prototype.onMouseLeave = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        this.showClearButton = false;
        this.toggleClearIcon(event, false);
    };
    /**
     * @private
     * @param {?} event
     * @param {?=} isShow
     * @return {?}
     */
    ComponentPerformerComponent.prototype.toggleClearIcon = /**
     * @private
     * @param {?} event
     * @param {?=} isShow
     * @return {?}
     */
    function (event, isShow) {
        if (isShow === void 0) { isShow = false; }
        /** @type {?} */
        var str = isShow ? '' : 'none';
        /** @type {?} */
        var clearIcon = event.target.querySelector('.input-group-clear');
        if (clearIcon) {
            clearIcon.style.display = str;
        }
    };
    /**
     * @param {?} event
     * @return {?}
     */
    ComponentPerformerComponent.prototype.selectChanged = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        this.curParameter = event.data;
    };
    /**
     * @param {?} e
     * @return {?}
     */
    ComponentPerformerComponent.prototype.endEdit = /**
     * @param {?} e
     * @return {?}
     */
    function (e) {
        // 文本框编辑同时修改value
        if (e.rowData.fetchValueMode === ParameterFetchValueMode.const || e.rowData.fetchValueMode === ParameterFetchValueMode.enum) {
            this.component.actualParameters[e.rowIndex].value = this.component.actualParameters[e.rowIndex].valueText;
        }
    };
    /**
     * @return {?}
     */
    ComponentPerformerComponent.prototype.clear = /**
     * @return {?}
     */
    function () {
        this.componentPerformer.name = '';
        this.componentPerformer.metadataId = '';
        this.componentPerformer.methodCode = '';
        this.componentPerformer.methodName = '';
        this.componentPerformer.condition = '';
        this.componentPerformer.actualParameters = new Array();
    };
    /**
     * @return {?}
     */
    ComponentPerformerComponent.prototype.selectComponent = /**
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var compFactory = this.resolver.resolveComponentFactory(SelectMetadataRTComponent);
        /** @type {?} */
        var compRef = compFactory.create(this.injector);
        compRef.instance.typeList = 'WebServiceComponent'; // 目前只能根据元数据类型过滤，后续添加标签过滤
        compRef.instance.selectedMetadata.subscribe((/**
         * @param {?} $event
         * @return {?}
         */
        function ($event) {
            try {
                /** @type {?} */
                var meta = $event.metadata;
                _this.openComponentSelectorNew(meta.id, _this.sessionSrc.getUserSessionId());
            }
            catch (_a) {
                console.log('$event', $event);
                throw new Error(_this.localePipe.transform('component.componentPerformer.errorObtaining') + $event);
            }
        }));
        /** @type {?} */
        var modalConfig = {
            title: this.localePipe.transform('component.componentPerformer.componentSelection'),
            width: 980,
            height: 548,
            showButtons: false
        };
        /** @type {?} */
        var dialog = this.modalService.show(compRef, modalConfig);
        compRef.instance.closeModalEmitter.subscribe((/**
         * @param {?} $event
         * @return {?}
         */
        function ($event) { return dialog.close(); }));
    };
    /**
     * @private
     * @param {?} metadataId
     * @param {?} sessionId
     * @return {?}
     */
    ComponentPerformerComponent.prototype.openComponentSelectorNew = /**
     * @private
     * @param {?} metadataId
     * @param {?} sessionId
     * @return {?}
     */
    function (metadataId, sessionId) {
        var _this = this;
        this.componentService.openSelector(metadataId, sessionId).subscribe((/**
         * @param {?} selectorResult
         * @return {?}
         */
        function (selectorResult) {
            selectorResult.confirmEvent.subscribe((/**
             * @param {?} result
             * @return {?}
             */
            function (result) {
                if (result) {
                    _this.component.name = result.name;
                    _this.component.metadataId = result.id;
                    _this.component.methodCode = result.operations[0].code;
                    _this.component.methodName = result.operations[0].name;
                    _this.component.actualParameters = [];
                    if (result.operations[0].parameters && result.operations[0].parameters.length > 0) {
                        _this.component.actualParameters = result.operations[0].parameters
                            .map((/**
                         * @param {?} p
                         * @return {?}
                         */
                        function (p) { return (/** @type {?} */ (({
                            code: p.code,
                            name: p.name,
                            value: '',
                            valueText: '',
                            description: p.description,
                            fetchValueMode: p.fetchValueMode,
                            fetchValueSetting: p.fetchValueSetting
                        }))); }));
                    }
                }
            }));
        }));
    };
    /**
     * @param {?} e
     * @return {?}
     */
    ComponentPerformerComponent.prototype.showExprHelp = /**
     * @param {?} e
     * @return {?}
     */
    function (e) {
        var _this = this;
        var e_6, _a, e_7, _b, e_8, _c;
        // this.expr.clearContext();
        if (this.designerState.schemas.length > 0) {
            try {
                for (var _d = __values(this.designerState.schemas), _e = _d.next(); !_e.done; _e = _d.next()) {
                    var schema = _e.value;
                    this.expr.addSchema('Schema', schema);
                }
            }
            catch (e_6_1) { e_6 = { error: e_6_1 }; }
            finally {
                try {
                    if (_e && !_e.done && (_a = _d.return)) _a.call(_d);
                }
                finally { if (e_6) throw e_6.error; }
            }
            if (this.designerState.schemas[0].entityTypes && this.designerState.schemas[0].entityTypes.length > 0) {
                /** @type {?} */
                var entityType = this.designerState.schemas[0].entityTypes[0];
                this.expr.addInjectedEntity(entityType.name, 'Schema', entityType.name, InjectedType.EntityType);
            }
        }
        /** @type {?} */
        var context = new Array();
        context = this.designerState.addContext(context);
        if (this.designerState.subActivityContext.length > 0) {
            var _loop_1 = function (variable) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    context.push(variable);
                }
            };
            try {
                for (var _f = __values(this.designerState.subActivityContext), _g = _f.next(); !_g.done; _g = _f.next()) {
                    var variable = _g.value;
                    _loop_1(variable);
                }
            }
            catch (e_7_1) { e_7 = { error: e_7_1 }; }
            finally {
                try {
                    if (_g && !_g.done && (_b = _f.return)) _b.call(_f);
                }
                finally { if (e_7) throw e_7.error; }
            }
        }
        if (context.length > 0) {
            try {
                for (var context_1 = __values(context), context_1_1 = context_1.next(); !context_1_1.done; context_1_1 = context_1.next()) {
                    var v = context_1_1.value;
                    this.expr.addContext(v);
                }
            }
            catch (e_8_1) { e_8 = { error: e_8_1 }; }
            finally {
                try {
                    if (context_1_1 && !context_1_1.done && (_c = context_1.return)) _c.call(context_1);
                }
                finally { if (e_8) throw e_8.error; }
            }
        }
        this.expr.setEditPattern(ExprEditMode.Advanced); // 默认打开高级表达式编辑器
        this.expr.addExpressionText(e.instance.value);
        this.expr.buildExpression().then((/**
         * @param {?} d
         * @return {?}
         */
        function (d) {
            var e_9, _a;
            if (d) {
                e.formControl.setValue(d);
                e.instance.cd.detectChanges();
                e.rowData.value = d;
                try {
                    for (var _b = __values(_this.component.actualParameters), _c = _b.next(); !_c.done; _c = _b.next()) {
                        var p = _c.value;
                        if (p.code === e.rowId) {
                            p.value = d;
                        }
                    }
                }
                catch (e_9_1) { e_9 = { error: e_9_1 }; }
                finally {
                    try {
                        if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                    }
                    finally { if (e_9) throw e_9.error; }
                }
            }
            //点击确定后，去除表达式里面的新增的上下文变量
            if (context.length > 0) {
                _this.expr.exprEntity.contextEntities = _this.expr.exprEntity.contextEntities.filter((/**
                 * @param {?} x
                 * @return {?}
                 */
                function (x) { return !context.some((/**
                 * @param {?} y
                 * @return {?}
                 */
                function (y) { return y.key === x.key; })); }));
            }
        }));
    };
    /**
     * @return {?}
     */
    ComponentPerformerComponent.prototype.getPerformers = /**
     * @return {?}
     */
    function () {
        this.grid.endCellEdit();
        console.log(this.component);
        return this.component;
    };
    /**
     * @private
     * @return {?}
     */
    ComponentPerformerComponent.prototype.getHelpInfo = /**
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        // 2023年6月29日 此处获取帮助的结构
        this.service.getHelpMetaData(this.helpInfo.helpId, this.helpInfo.su).subscribe((/**
         * @param {?} re
         * @return {?}
         */
        function (re) {
            if (re) {
                /** @type {?} */
                var meta = re;
                /** @type {?} */
                var help = (/** @type {?} */ (JSON.parse(meta.content)));
                _this.helpInfo.columns = help.dataSource.columns;
                _this.helpInfo.displayType = help.displayType;
                _this.helpInfo.fieldInfo = {
                    idField: help.idField,
                    valueField: help.valueField,
                    textField: help.textField
                };
            }
            else {
                throw new Error(_this.localePipe.transform('component.componentPerformer.metadataNotExist'));
            }
        }));
        // 打开帮助
        this.lookup.showDialog();
    };
    /**
     * @param {?} data
     * @return {?}
     */
    ComponentPerformerComponent.prototype.pagerChanged = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        var _this = this;
        if (data) {
            this.helpInfo.pageInfo.pageIndex = data.pageIndex;
            this.helpInfo.pageInfo.pageSize = data.pageSize;
            this.service.getLookUpData(this.helpInfo.helpId, this.helpInfo.su, this.helpInfo.pageInfo.pageIndex, this.helpInfo.pageInfo.pageSize, this.helpInfo.search)
                .subscribe((/**
             * @param {?} re
             * @return {?}
             */
            function (re) {
                _this.helpInfo.items = re.items;
                _this.helpInfo.title = re.title;
                _this.helpInfo.total = re.total;
                _this.lookup.loadData(re);
            }));
        }
    };
    /**
     * @param {?} data
     * @return {?}
     */
    ComponentPerformerComponent.prototype.search = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        var _this = this;
        console.log(data);
        this.helpInfo.search = { category: 'search' };
        if (data) {
            /** @type {?} */
            var searchInfo = {
                searchField: data.field || data.search.field,
                searchValue: data.value || data.search.value
            };
            this.helpInfo.search = Object.assign(this.helpInfo.search, searchInfo);
            this.service.getLookUpData(this.helpInfo.helpId, this.helpInfo.su, this.helpInfo.pageInfo.pageIndex, this.helpInfo.pageInfo.pageSize, this.helpInfo.search)
                .subscribe((/**
             * @param {?} re
             * @return {?}
             */
            function (re) {
                _this.helpInfo.items = re.items;
                _this.helpInfo.title = re.title;
                _this.helpInfo.total = re.total;
                _this.lookup.loadData(re);
            }));
        }
    };
    ComponentPerformerComponent.decorators = [
        { type: Component, args: [{
                    selector: 'app-component-performer',
                    template: "\r\n    <div class=\"f-utils-fill-flex-column farris-overflow-y-auto h-100\">\r\n      <div class=\"f-utils-fill-flex-column h-100 mx-3\" style=\"border-radius:16px;border: 1.5px solid #F1F3F7;\">\r\n      <form class=\"farris-form farris-card-content-bg farris-card-section mx-2\">\r\n        <div class=\"d-flex flex-wrap flex-column mb-2 pr-4\">\r\n          <div class=\"farris-form-controls-inline farris-form-auto mb-2\">\r\n            <div class=\"farris-group-wrap mx-3\">\r\n              <div class=\"form-group\">\r\n                <label class=\"col-form-label\">\r\n                  <span class=\"farris-label-info text-danger\">*</span>\r\n                  <span class=\"farris-label-text\">{{'component.componentPerformer.componentName'|wfLocale}}</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap ml-2\">\r\n                  <input type=\"text\" class=\"k-textbox form-control\" name=\"name\"\r\n                    [(ngModel)]=\"component.name\" />\r\n                  <div class=\"farris-feedback valid-feedback\"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"farris-form-controls-inline farris-form-auto\">\r\n            <div class=\"farris-group-wrap mx-3\">\r\n              <div class=\"form-group\">\r\n                <label class=\"col-form-label\">\r\n                  <span class=\"farris-label-info text-danger\">*</span>\r\n                  <span class=\"farris-label-text\">{{'component.componentPerformer.componentSelect'|wfLocale}}</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap ml-2\">\r\n                  <div #inputGroup class=\"input-group\">\r\n                    <input type=\"text\" class=\"form-control\" [(ngModel)]=\"component.methodCode\" name=\"methodCode\" [readOnly]=\"true\" />\r\n                    <div class=\"input-group-append\">\r\n                      <span [style.display]=\"showClearButton ? '' : 'none'\" class=\"input-group-text input-group-clear\" (click)=\"clear()\">\r\n                        <i class=\"f-icon modal_close\"></i>\r\n                      </span>\r\n                      <span class=\"input-group-text\" (click)=\"selectComponent()\" style=\"background: #FFF;\">\r\n                        <i class=\"f-icon f-icon-lookup\"></i>\r\n                      </span>\r\n                    </div>\r\n                  </div>\r\n                  <div class=\"farris-feedback valid-feedback\"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </form>\r\n      <farris-tabs class=\"f-utils-fill mx-3\" #params [value]=\"'params'\" [contentFill]=\"true\">\r\n        <farris-tab title=\"{{'component.componentPerformer.parameterList' | wfLocale}}\" [id]=\"'params'\">\r\n          <ng-template #content>\r\n            <div class=\"f-utils-fill-flex-column h-100\">\r\n              <farris-datagrid #grid [data]=\"component.actualParameters\" [columns]=\"columns\" [idField]=\"'code'\" [fit]=\"true\"\r\n                [fitColumns]=\"true\" [editable]=\"true\" [editMode]=\"'cell'\" [pagination]=\"false\" [showCheckbox]=\"false\"\r\n                [multiSelect]=\"false\" [afterEdit]=\"afterEdit\" [beforeEdit]=\"beforeEdit\"\r\n                (selectChanged)=\"selectChanged($event)\" (endEdit)=\"endEdit($event)\"></farris-datagrid>\r\n            </div>\r\n          </ng-template>\r\n        </farris-tab>\r\n      </farris-tabs>\r\n    </div>\r\n    </div>\r\n\r\n<!-- <farris-lookup-grid style=\"display: none;\" [items]=\"helpInfo.items\" [columns]=\"helpInfo.columns\" [resizable]=\"true\"\r\n  [singleSelect]=\"true\" [idField]=\"helpInfo.fieldInfo.idField\" [textField]=\"helpInfo.fieldInfo.textField\"\r\n  [valueField]=\"helpInfo.fieldInfo.valueField\" [pagination]=\"true\" [pageIndex]=\"helpInfo.pageInfo.pageIndex\"\r\n  [pageSize]=\"helpInfo.pageInfo.pageSize\" [pageList]=\"helpInfo.pageInfo.pageList\" [total]=\"helpInfo.total\"\r\n  title=\"helpInfo.title\" [displayType]=\"helpInfo.displayType\" [dictPicked]=\"dictPicked\" [remoteSearch]='false'\r\n  (pagerChanged)=\"pagerChanged($event)\" (search)=\"search($event)\">\r\n</farris-lookup-grid> -->\r\n<!-- 2023-6-28 DD\u9700\u6C42\uFF0C\u76F4\u63A5\u7528\u5E2E\u52A9id\u6253\u5F00\u800C\u4E0D\u662F\u81EA\u5DF1\u7EC4\u7EC7\u6570\u636E\u6E90\uFF0C\u4EE5\u5B9E\u73B0\u5206\u5C42\u52A0\u8F7D -->\r\n<farris-lookup-grid\r\nstyle=\"display: none;\"\r\n[uri]=\"'testLookupUri'\"\r\n[displayType]=\"'List'\"\r\n[idField]=\"'id'\"\r\n[pagination]=\"true\"\r\n[editable]=\"false\"\r\n[singleSelect]=\"true\"\r\n[textField]=\"'name'\"\r\n[helpId]=\"helpId\"\r\n[dictPicking]=\"onDictPicking\"\r\n[dictPicked]=\"dictPicked\"\r\n>\r\n</farris-lookup-grid>\r\n",
                    providers: [
                        ComponentPerformerService,
                        WfLocalePipe
                    ],
                    styles: [""]
                }] }
    ];
    /** @nocollapse */
    ComponentPerformerComponent.ctorParameters = function () { return [
        { type: ProcessDesignerUIState },
        { type: ExpressionService },
        { type: ComponentFactoryResolver },
        { type: Injector },
        { type: SessionService },
        { type: BsModalService },
        { type: CommonComponentUiRTService },
        { type: NgZone },
        { type: ComponentPerformerService },
        { type: ProcessDeUtil },
        { type: HttpService },
        { type: ChangeDetectorRef, decorators: [{ type: Optional }] },
        { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
        { type: undefined, decorators: [{ type: Inject, args: [WF_LANG_RESOURCES,] }] },
        { type: WfLocalePipe, decorators: [{ type: Optional }] }
    ]; };
    ComponentPerformerComponent.propDecorators = {
        cls: [{ type: HostBinding, args: ['class',] }],
        grid: [{ type: ViewChild, args: [DatagridComponent,] }],
        lookup: [{ type: ViewChild, args: [LookupGridComponent,] }],
        inputGroup: [{ type: ViewChild, args: ['inputGroup',] }],
        component: [{ type: Input }]
    };
    return ComponentPerformerComponent;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var ReportingLineDataEntity = /** @class */ (function (_super) {
    __extends(ReportingLineDataEntity, _super);
    function ReportingLineDataEntity(id, name, type) {
        return _super.call(this, id, name, type) || this;
    }
    return ReportingLineDataEntity;
}(PerformerEntity));

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var WfReportDefHelpService = /** @class */ (function () {
    function WfReportDefHelpService(http) {
        this.http = http;
    }
    /**
     * @param {?} url
     * @param {?=} params
     * @return {?}
     */
    WfReportDefHelpService.prototype.getData = /**
     * @param {?} url
     * @param {?=} params
     * @return {?}
     */
    function (url, params) {
        var e_1, _a;
        /** @type {?} */
        var customData = params.customData;
        /** @type {?} */
        var index = params.pageIndex || 1;
        /** @type {?} */
        var size = params.pageSize || 20;
        /** @type {?} */
        var searchValue = JSON.parse(params.searchValue);
        if (searchValue.searchValue || customData.filter) {
            /** @type {?} */
            var query = '{';
            if (searchValue.searchValue) {
                if (searchValue.searchField === '*') {
                    query += "\"codeOrNameLike\":\"" + searchValue.searchValue + "\",";
                }
                else {
                    query += "\"" + searchValue.searchField + "\":\"" + searchValue.searchValue + "\",";
                }
            }
            if (customData.filter) {
                /** @type {?} */
                var keys = Object.keys(customData.filter);
                if (keys && keys.length > 0) {
                    try {
                        for (var keys_1 = __values(keys), keys_1_1 = keys_1.next(); !keys_1_1.done; keys_1_1 = keys_1.next()) {
                            var key = keys_1_1.value;
                            if (customData.filter[key]) {
                                query += "\"" + key + "\":\"" + customData.filter[key] + "\",";
                            }
                        }
                    }
                    catch (e_1_1) { e_1 = { error: e_1_1 }; }
                    finally {
                        try {
                            if (keys_1_1 && !keys_1_1.done && (_a = keys_1.return)) _a.call(keys_1);
                        }
                        finally { if (e_1) throw e_1.error; }
                    }
                }
            }
            if (query.substr(query.length - 1, 1) === ',') {
                query = query.substring(0, query.length - 1);
            }
            query += '}';
            query = encodeURIComponent(query);
            query += "&pageIndex=" + index + "&pageSize=" + size;
            url += '?pageFilter=' + query;
        }
        else {
            url += "?pageIndex=" + index + "&pageSize=" + size;
        }
        return this.http.get(url).pipe(map((/**
         * @param {?} re
         * @return {?}
         */
        function (re) { return ({
            items: re.content,
            total: re.totalElements,
            pageInfo: {
                pageIndex: re.pageable.pageNumber + 1,
                pageSize: re.pageable.pageSize,
                pageList: [20, 40, 60, 80, 100],
                enablePager: true
            }
        }); })));
    };
    WfReportDefHelpService.decorators = [
        { type: Injectable }
    ];
    /** @nocollapse */
    WfReportDefHelpService.ctorParameters = function () { return [
        { type: HttpService }
    ]; };
    return WfReportDefHelpService;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var WfReportDefHelpComponent = /** @class */ (function () {
    function WfReportDefHelpComponent(localePipe) {
        var _this = this;
        this.localePipe = localePipe;
        /**
         * 宽度
         */
        this.width = 550;
        /**
         * 只读
         */
        this.disabled = false;
        /**
         * 是否单选
         */
        this.singleSelect = true;
        /**
         * 是否分页，默认true
         */
        this.pagination = true;
        /**
         * 首次加载第几页，默认1
         */
        this.pageIndex = 1;
        /**
         * 每页加载数，默认20
         */
        this.pageSize = 20;
        /**
         * 过滤条件
         */
        this.filter = {};
        // @Input() beforeClose: (selectData: any) => Observable<PickedResult>;
        /**
         * 帮助选择后事件
         */
        this.afterConfirm = new EventEmitter();
        this.dialogClosed = new EventEmitter();
        this.clear = new EventEmitter();
        this.columns = [];
        /**
         * 帮助前事件,强行传递过滤条件
         */
        this.beforeOpen = (/**
         * @param {?} arg
         * @return {?}
         */
        function (arg) {
            // 把过滤数据和当前的数据传递到service层
            return of$1({
                showDialog: true, data: {
                    filter: _this.filter
                }
            });
        });
        this.dictPicked = (/**
         * @param {?} arg
         * @return {?}
         */
        function (arg) {
            _this.afterConfirm.next(arg);
            return of$1({ closeDialog: true });
        });
    }
    /**
     * @return {?}
     */
    WfReportDefHelpComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        this.columns = [
            { title: this.localePipe.transform('component.reportingLine.code'), field: 'code', width: '80', searchField: 'code', },
            { title: this.localePipe.transform('component.reportingLine.name'), field: 'name', width: '100', searchField: 'name', }
        ];
        // this.dataUri = this.uiState.dataUri;
        this.dataUri = '/api/runtime/wf/v1.0/reportingLineDefinitions/query';
        // 必须要有，否则初始选中不起作用
        this.lookUp.mapFields = { id: 'id', name: 'name' };
    };
    /**
     * @param {?} arg
     * @return {?}
     */
    WfReportDefHelpComponent.prototype.afterClear = /**
     * @param {?} arg
     * @return {?}
     */
    function (arg) {
        this.clear.next(arg);
    };
    /** 手动显示帮助 */
    /**
     * 手动显示帮助
     * @return {?}
     */
    WfReportDefHelpComponent.prototype.showHelp = /**
     * 手动显示帮助
     * @return {?}
     */
    function () {
        this.lookUp.showDialog();
    };
    WfReportDefHelpComponent.decorators = [
        { type: Component, args: [{
                    selector: 'app-wf-report-def-help',
                    template: "\n    <farris-lookup-grid #lookup\n      [disabled]=\"disabled\"\n      [editable]=\"false\"\n      [bindingData]=\"bindingData\"\n      [(ngModel)]=\"displayTxt\"\n      [columns]=\"columns\"\n      [singleSelect]=\"singleSelect\"\n      title=\"title\"\n      [displayType]=\"'List'\"\n      [uri]=\"dataUri\"\n      [idField]=\"'id'\"\n      [pageIndex]=\"pageIndex\"\n      [pageSize]=\"pageSize\"\n      [pagination]=\"pagination\"\n      [valueField]=\"'id'\"\n      [textField]=\"'name'\"\n      (clear)=\"afterClear($event)\"\n      [dialogWidth]=\"width\"\n      [dictPicking]=\"beforeOpen\"\n      [dictPicked]=\"dictPicked\">\n    </farris-lookup-grid>\n  ",
                    providers: [{ provide: ServerSideToken, useClass: WfReportDefHelpService }]
                }] }
    ];
    /** @nocollapse */
    WfReportDefHelpComponent.ctorParameters = function () { return [
        { type: WfLocalePipe }
    ]; };
    WfReportDefHelpComponent.propDecorators = {
        title: [{ type: Input }],
        width: [{ type: Input }],
        sourceType: [{ type: Input }],
        disabled: [{ type: Input }],
        singleSelect: [{ type: Input }],
        pagination: [{ type: Input }],
        pageIndex: [{ type: Input }],
        pageSize: [{ type: Input }],
        displayTxt: [{ type: Input }],
        bindingData: [{ type: Input }],
        filter: [{ type: Input }],
        afterConfirm: [{ type: Output }],
        dialogClosed: [{ type: Output }],
        clear: [{ type: Output }],
        lookUp: [{ type: ViewChild, args: ['lookup',] }]
    };
    return WfReportDefHelpComponent;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var ReportingLineComponent = /** @class */ (function () {
    function ReportingLineComponent(http, designerUIState, expr, ngZone, cdr, localeId, resources, localePipe) {
        this.http = http;
        this.designerUIState = designerUIState;
        this.expr = expr;
        this.ngZone = ngZone;
        this.cdr = cdr;
        this.localeId = localeId;
        this.resources = resources;
        this.localePipe = localePipe;
        this.cls = 'd-flex flex-fill h-100';
        this.treeFilter = '';
        this.display = 'none';
        this.typeReadOnly = false;
        this.groupIcon2 = '<i class="f-icon f-icon-lookup"></i>';
        this.defName = '';
        /**
         * 汇报关系数据
         */
        this.reportingLineDataEntity = new ReportingLineDataEntity();
        /**
         * 汇报关系定义列表
         */
        this.reportingLineDefinitionList = [];
        this.reportingLineDimension = [];
        this.showClearButton = false;
        this.items = [];
        this.users = [];
        this.departments = [];
        this.pageIndex = 1;
        this.pageSize = 20;
        this.pageList = [10, 20, 30, 50, 100];
        this.total = 0;
        /**
         * 汇报类型显示列
         */
        this.columns = [
            { title: this.localePipe.transform('component.reportingLine.code'), field: 'code', width: 100 },
            { title: this.localePipe.transform('component.reportingLine.name'), field: 'name', width: 100 }
        ];
        /**
         *  参与者列表汇报关系显示字段
         */
        this.reportingReferObjects = [
            { name: this.localePipe.transform('component.reportingLine.dept'), value: 'dept' },
            { name: this.localePipe.transform('component.reportingLine.sysUser'), value: 'sysUser' },
            { name: this.localePipe.transform('component.reportingLine.employee'), value: 'employee' }
        ];
        this.curReportingRefer = this.reportingReferObjects[0].value;
        this.localePipe = this.localePipe || new WfLocalePipe(localeId, resources);
        this.getReportingLineType();
    }
    Object.defineProperty(ReportingLineComponent.prototype, "setReportingLineDataEntity", {
        set: /**
         * @param {?} dataEntity
         * @return {?}
         */
        function (dataEntity) {
            var _this = this;
            this.defName = dataEntity.reportingLineDefName;
            this.reportingLineDataEntity = dataEntity;
            /** @type {?} */
            var defUrl = '/api/runtime/wf/v1.0/reportingLineDefinitions/' + dataEntity.reportingLineDefId;
            this.http.get(defUrl).subscribe((/**
             * @param {?} re
             * @return {?}
             */
            function (re) {
                var e_1, _a;
                _this.reportingLineDefinition = re;
                _this.designerUIState.dimensions = [
                    { value: 'higherSuperior', text: _this.localePipe.transform('component.reportingLine.higherSuperior') }
                ];
                // 兼容历史数据
                if (JSON.parse(_this.reportingLineDefinition.dimensions)[0].code !== 'directSuperior') {
                    /** @type {?} */
                    var di = {
                        value: 'directSuperior',
                        text: _this.localePipe.transform('component.reportingLine.directSuperior')
                    };
                    _this.designerUIState.dimensions.push(di);
                }
                try {
                    for (var _b = __values(JSON.parse(_this.reportingLineDefinition.dimensions)), _c = _b.next(); !_c.done; _c = _b.next()) {
                        var dimension = _c.value;
                        /** @type {?} */
                        var di = {
                            value: dimension.code,
                            text: dimension.name
                        };
                        _this.designerUIState.dimensions.push(di);
                    }
                }
                catch (e_1_1) { e_1 = { error: e_1_1 }; }
                finally {
                    try {
                        if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                    }
                    finally { if (e_1) throw e_1.error; }
                }
            }));
            this.users = [dataEntity];
            if (dataEntity.refUserId) {
                this.users[0].performerName = this.variableParticipantName(dataEntity.refUserId);
                this.curReportingRefer = this.reportingReferObjects[1].value;
                this.display = 'block';
            }
            else if (dataEntity.refEmployeeId) {
                this.users[0].performerName = dataEntity.refEmployeeId;
                this.curReportingRefer = this.reportingReferObjects[2].value;
                this.display = 'block';
            }
            else {
                this.curReportingRefer = this.reportingReferObjects[0].value;
            }
            if (dataEntity.reportingLineDefId) {
                this.typeReadOnly = true;
            }
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    ReportingLineComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
    };
    /**
     * 获取汇报关系类型
     */
    /**
     * 获取汇报关系类型
     * @return {?}
     */
    ReportingLineComponent.prototype.getReportingLineType = /**
     * 获取汇报关系类型
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var url = '/api/runtime/wf/v1.0/reportingLineDefinitions';
        this.http.get(url).subscribe((/**
         * @param {?} re
         * @return {?}
         */
        function (re) {
            _this.reportingLineDefinitionList = re;
            _this.items = _this.reportingLineDefinitionList.slice(0, _this.pageSize);
            _this.total = _this.reportingLineDefinitionList.length;
        }));
    };
    /**
     * @return {?}
     */
    ReportingLineComponent.prototype.onclear = /**
     * @return {?}
     */
    function () {
        this.reportingLineDataEntity = new ReportingLineDataEntity();
    };
    // 参照类型改变
    // 参照类型改变
    /**
     * @param {?} data
     * @return {?}
     */
    ReportingLineComponent.prototype.referObjectChange = 
    // 参照类型改变
    /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        if (data === 'dept') {
            this.display = 'none';
            this.curReportingRefer = this.reportingReferObjects[0].value;
            this.reportingLineDataEntity.refUserId = null;
            this.reportingLineDataEntity.refEmployeeId = null;
        }
        else if (data === 'sysUser') {
            this.display = 'block';
            this.curReportingRefer = this.reportingReferObjects[1].value;
            this.reportingLineDataEntity.refOrgId = null;
            this.reportingLineDataEntity.refOrgName = null;
            this.reportingLineDataEntity.refEmployeeId = null;
        }
        else { // 员工的情况
            this.display = 'block';
            this.curReportingRefer = this.reportingReferObjects[2].value;
            this.reportingLineDataEntity.refOrgId = null;
            this.reportingLineDataEntity.refOrgName = null;
            this.reportingLineDataEntity.refUserId = null;
        }
        // 参照对象切换时，清空user和department
        this.users = [];
        this.departments = [];
    };
    /**
     * 参照用户改变
     */
    /**
     * 参照用户改变
     * @param {?} data
     * @return {?}
     */
    ReportingLineComponent.prototype.referUserChange = /**
     * 参照用户改变
     * @param {?} data
     * @return {?}
     */
    function (data) {
        console.log(data);
    };
    /**
     * 维度改变
     */
    /**
     * 维度改变
     * @param {?} data
     * @return {?}
     */
    ReportingLineComponent.prototype.reportingDimensionChange = /**
     * 维度改变
     * @param {?} data
     * @return {?}
     */
    function (data) {
    };
    /**
     * 组织帮助选完后
     */
    /**
     * 组织帮助选完后
     * @param {?} org
     * @return {?}
     */
    ReportingLineComponent.prototype.orgSelected = /**
     * 组织帮助选完后
     * @param {?} org
     * @return {?}
     */
    function (org) {
        this.reportingLineDataEntity.refOrgId = org.id;
        this.reportingLineDataEntity.refOrgName = org.name;
    };
    /**
     * 编辑条件
     */
    /**
     * 编辑条件
     * @return {?}
     */
    ReportingLineComponent.prototype.editCondition = /**
     * 编辑条件
     * @return {?}
     */
    function () {
        var _this = this;
        var e_2, _a, e_3, _b, e_4, _c, e_5, _d;
        // this.expr.clearContext();
        if (this.designerUIState.schemas.length > 0) {
            try {
                for (var _e = __values(this.designerUIState.schemas), _f = _e.next(); !_f.done; _f = _e.next()) {
                    var schema = _f.value;
                    this.expr.addSchema('Schema', schema);
                }
            }
            catch (e_2_1) { e_2 = { error: e_2_1 }; }
            finally {
                try {
                    if (_f && !_f.done && (_a = _e.return)) _a.call(_e);
                }
                finally { if (e_2) throw e_2.error; }
            }
            if (this.designerUIState.schemas[0].entityTypes && this.designerUIState.schemas[0].entityTypes.length > 0) {
                /** @type {?} */
                var entityType = this.designerUIState.schemas[0].entityTypes[0];
                this.expr.addInjectedEntity(entityType.name, 'Schema', entityType.name, InjectedType.EntityType);
            }
        }
        /** @type {?} */
        var context = new Array();
        context = this.designerUIState.addContext(context);
        if (this.designerUIState.subActivityContext.length > 0) {
            var _loop_1 = function (variable) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    context.push(variable);
                }
            };
            try {
                for (var _g = __values(this.designerUIState.subActivityContext), _h = _g.next(); !_h.done; _h = _g.next()) {
                    var variable = _h.value;
                    _loop_1(variable);
                }
            }
            catch (e_3_1) { e_3 = { error: e_3_1 }; }
            finally {
                try {
                    if (_h && !_h.done && (_b = _g.return)) _b.call(_g);
                }
                finally { if (e_3) throw e_3.error; }
            }
        }
        if (this.designerUIState.activityComponentContext.length > 0) {
            var _loop_2 = function (variable) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    context.push(variable);
                }
            };
            try {
                for (var _j = __values(this.designerUIState.activityComponentContext), _k = _j.next(); !_k.done; _k = _j.next()) {
                    var variable = _k.value;
                    _loop_2(variable);
                }
            }
            catch (e_4_1) { e_4 = { error: e_4_1 }; }
            finally {
                try {
                    if (_k && !_k.done && (_c = _j.return)) _c.call(_j);
                }
                finally { if (e_4) throw e_4.error; }
            }
        }
        if (context.length > 0) {
            try {
                for (var context_1 = __values(context), context_1_1 = context_1.next(); !context_1_1.done; context_1_1 = context_1.next()) {
                    var v = context_1_1.value;
                    this.expr.addContext(v);
                }
            }
            catch (e_5_1) { e_5 = { error: e_5_1 }; }
            finally {
                try {
                    if (context_1_1 && !context_1_1.done && (_d = context_1.return)) _d.call(context_1);
                }
                finally { if (e_5) throw e_5.error; }
            }
        }
        this.expr.setEditPattern(ExprEditMode.Conditional); // 表达式展现模式：默认简易版
        this.expr.addExpressionText(this.reportingLineDataEntity.condition); // this.reportingLineDataEntity.condition
        this.expr.buildExpression().then((/**
         * @param {?} expressioninfo
         * @return {?}
         */
        function (expressioninfo) {
            _this.reportingLineDataEntity.condition = expressioninfo;
            //点击确定后，去除表达式里面的新增的上下文变量
            if (context.length > 0) {
                _this.expr.exprEntity.contextEntities = _this.expr.exprEntity.contextEntities.filter((/**
                 * @param {?} x
                 * @return {?}
                 */
                function (x) { return !context.some((/**
                 * @param {?} y
                 * @return {?}
                 */
                function (y) { return y.key === x.key; })); }));
            }
        }));
    };
    /**
     * @param {?=} value
     * @return {?}
     */
    ReportingLineComponent.prototype.getReportingTypes = /**
     * @param {?=} value
     * @return {?}
     */
    function (value) {
        /** @type {?} */
        var start = (this.pageIndex - 1) * this.pageSize;
        /** @type {?} */
        var end = start + this.pageSize;
        /** @type {?} */
        var items = [];
        if (value) {
            items = this.reportingLineDefinitionList.filter((/**
             * @param {?} f
             * @return {?}
             */
            function (f) { return f.name.indexOf(value) > -1 || f.code.indexOf(value) > -1; }));
        }
        else {
            items = this.reportingLineDefinitionList;
        }
        this.total = items.length;
        this.items = items.slice(start, end);
        this.lookup.componentRef.instance.loadData({
            total: this.total,
            pageSize: this.pageSize,
            pageIndex: this.pageIndex,
            data: this.items
        });
    };
    /**
     * @return {?}
     */
    ReportingLineComponent.prototype.ngAfterViewInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.ngZone.runOutsideAngular((/**
         * @return {?}
         */
        function () {
            _this.inputGroup.nativeElement.addEventListener('mouseenter', _this.onMouseEnter.bind(_this));
            _this.inputGroup.nativeElement.addEventListener('mouseleave', _this.onMouseLeave.bind(_this));
            _this.inputGroup1.nativeElement.addEventListener('mouseenter', _this.onMouseEnter.bind(_this));
            _this.inputGroup1.nativeElement.addEventListener('mouseleave', _this.onMouseLeave.bind(_this));
        }));
    };
    /**
     * @param {?} event
     * @return {?}
     */
    ReportingLineComponent.prototype.onMouseEnter = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        this.showClearButton = true;
        if (this.showClearButton) {
            this.toggleClearIcon(event, true);
        }
    };
    /**
     * @param {?} event
     * @return {?}
     */
    ReportingLineComponent.prototype.onMouseLeave = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        this.showClearButton = false;
        this.toggleClearIcon(event, false);
    };
    /**
     * @private
     * @param {?} event
     * @param {?=} isShow
     * @return {?}
     */
    ReportingLineComponent.prototype.toggleClearIcon = /**
     * @private
     * @param {?} event
     * @param {?=} isShow
     * @return {?}
     */
    function (event, isShow) {
        if (isShow === void 0) { isShow = false; }
        /** @type {?} */
        var str = isShow ? '' : 'none';
        /** @type {?} */
        var clearIcon = event.target.querySelector('.input-group-clear');
        if (clearIcon) {
            clearIcon.style.display = str;
        }
    };
    /**
     * @param {?} data
     * @return {?}
     */
    ReportingLineComponent.prototype.clear = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        this.reportingLineDataEntity.refOrgId = '';
        this.reportingLineDataEntity.refOrgName = '';
    };
    /**
     * @return {?}
     */
    ReportingLineComponent.prototype.clearUser = /**
     * @return {?}
     */
    function () {
        this.users = [];
        this.reportingLineDataEntity.refUserId = '';
        this.reportingLineDataEntity.refEmployeeId = '';
    };
    /**
     * @return {?}
     */
    ReportingLineComponent.prototype.clearOrg = /**
     * @return {?}
     */
    function () {
        this.departments = [];
        this.reportingLineDataEntity.refOrgId = '';
    };
    /**
     * @param {?} data
     * @return {?}
     */
    ReportingLineComponent.prototype.selectOrg = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        this.showExprHelp(data);
    };
    /**
     * @param {?} data
     * @return {?}
     */
    ReportingLineComponent.prototype.selectUsers = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        this.showExprHelp(data);
    };
    /**
     * @param {?} data
     * @return {?}
     */
    ReportingLineComponent.prototype.showExprHelp = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        var _this = this;
        var e_6, _a, e_7, _b, e_8, _c, e_9, _d, e_10, _e;
        // this.expr.clearContext();
        this.expr.setEditPattern(ExprEditMode.Advanced); // 表达式展现模式：默认高级
        if (this.designerUIState.schemas.length > 0) {
            try {
                for (var _f = __values(this.designerUIState.schemas), _g = _f.next(); !_g.done; _g = _f.next()) {
                    var schema = _g.value;
                    this.expr.addSchema('Schema', schema);
                }
            }
            catch (e_6_1) { e_6 = { error: e_6_1 }; }
            finally {
                try {
                    if (_g && !_g.done && (_a = _f.return)) _a.call(_f);
                }
                finally { if (e_6) throw e_6.error; }
            }
            if (this.designerUIState.schemas[0].entityTypes && this.designerUIState.schemas[0].entityTypes.length > 0) {
                /** @type {?} */
                var entityType = this.designerUIState.schemas[0].entityTypes[0];
                this.expr.addInjectedEntity(entityType.name, 'Schema', entityType.name, InjectedType.EntityType);
            }
        }
        /** @type {?} */
        var context = new Array();
        if (this.designerUIState.participantContext.length > 0) {
            try {
                for (var _h = __values(this.designerUIState.participantContext), _j = _h.next(); !_j.done; _j = _h.next()) {
                    var variable = _j.value;
                    context.push(variable);
                }
            }
            catch (e_7_1) { e_7 = { error: e_7_1 }; }
            finally {
                try {
                    if (_j && !_j.done && (_b = _h.return)) _b.call(_h);
                }
                finally { if (e_7) throw e_7.error; }
            }
        }
        if (this.designerUIState.subActivityContext.length > 0) {
            var _loop_3 = function (variable) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    context.push(variable);
                }
            };
            try {
                for (var _k = __values(this.designerUIState.subActivityContext), _l = _k.next(); !_l.done; _l = _k.next()) {
                    var variable = _l.value;
                    _loop_3(variable);
                }
            }
            catch (e_8_1) { e_8 = { error: e_8_1 }; }
            finally {
                try {
                    if (_l && !_l.done && (_c = _k.return)) _c.call(_k);
                }
                finally { if (e_8) throw e_8.error; }
            }
        }
        if (this.designerUIState.processVariableContext.length > 0) {
            var _loop_4 = function (variable) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    context.push(variable);
                }
            };
            try {
                for (var _m = __values(this.designerUIState.processVariableContext), _o = _m.next(); !_o.done; _o = _m.next()) {
                    var variable = _o.value;
                    _loop_4(variable);
                }
            }
            catch (e_9_1) { e_9 = { error: e_9_1 }; }
            finally {
                try {
                    if (_o && !_o.done && (_d = _m.return)) _d.call(_m);
                }
                finally { if (e_9) throw e_9.error; }
            }
        }
        if (context.length > 0) {
            try {
                for (var context_2 = __values(context), context_2_1 = context_2.next(); !context_2_1.done; context_2_1 = context_2.next()) {
                    var v = context_2_1.value;
                    this.expr.addContext(v);
                }
            }
            catch (e_10_1) { e_10 = { error: e_10_1 }; }
            finally {
                try {
                    if (context_2_1 && !context_2_1.done && (_e = context_2.return)) _e.call(context_2);
                }
                finally { if (e_10) throw e_10.error; }
            }
        }
        if (data === 'sysUser') {
            if (this.reportingLineDataEntity.refUserId && this.reportingLineDataEntity.refUserId.length > 0) {
                this.expr.addExpressionText(this.reportingLineDataEntity.refUserId);
            }
            else {
                this.expr.addExpressionText('');
            }
        }
        else if (data === 'org') {
            if (this.reportingLineDataEntity.refOrgId && this.reportingLineDataEntity.refOrgId.length > 0) {
                this.expr.addExpressionText(this.reportingLineDataEntity.refOrgId);
            }
            else {
                this.expr.addExpressionText('');
            }
        }
        else { // 员工及其他汇报对象类型
            if (this.reportingLineDataEntity.refEmployeeId && this.reportingLineDataEntity.refEmployeeId.length > 0) {
                this.expr.addExpressionText(this.reportingLineDataEntity.refEmployeeId);
            }
            else {
                this.expr.addExpressionText('');
            }
        }
        this.expr.buildExpression().then((/**
         * @param {?} expressionInfo
         * @return {?}
         */
        function (expressionInfo) {
            if (data === 'sysUser') {
                /** @type {?} */
                var user = new PerformerEntity(expressionInfo, '', 'wf.ReportingLineParticipantExpression');
                user.tag = 'expression';
                user.performerName = _this.variableParticipantName(expressionInfo);
                _this.reportingLineDataEntity.refUserId = user.performerId;
                _this.reportingLineDataEntity.tag = user.tag;
                _this.reportingLineDataEntity.performerName = user.performerName;
                _this.users = [_this.reportingLineDataEntity];
            }
            else if (data === 'org') {
                /** @type {?} */
                var dept = new PerformerEntity(expressionInfo, '', 'wf.ReportingLineParticipantExpression');
                dept.tag = 'expression';
                _this.reportingLineDataEntity.refOrgName = expressionInfo;
                _this.reportingLineDataEntity.refOrgId = expressionInfo;
                _this.departments = [_this.reportingLineDataEntity];
            }
            else {
                /** @type {?} */
                var employee = new PerformerEntity(expressionInfo, '', 'wf.ReportingLineParticipantExpression');
                employee.performerName = expressionInfo;
                employee.tag = 'expression';
                _this.reportingLineDataEntity.refEmployeeId = expressionInfo;
                _this.reportingLineDataEntity.performerName = employee.performerName;
                _this.users = [_this.reportingLineDataEntity];
            }
            //点击确定后，去除表达式里面的新增的上下文变量
            if (context.length > 0) {
                _this.expr.exprEntity.contextEntities = _this.expr.exprEntity.contextEntities.filter((/**
                 * @param {?} x
                 * @return {?}
                 */
                function (x) { return !context.some((/**
                 * @param {?} y
                 * @return {?}
                 */
                function (y) { return y.key === x.key; })); }));
            }
        }));
    };
    /**
     * @private
     * @param {?} expr
     * @return {?}
     */
    ReportingLineComponent.prototype.variableParticipantName = /**
     * @private
     * @param {?} expr
     * @return {?}
     */
    function (expr) {
        var e_11, _a, e_12, _b;
        try {
            for (var _c = __values(this.designerUIState.participantContext), _d = _c.next(); !_d.done; _d = _c.next()) {
                var c = _d.value;
                if (expr.indexOf(c.key) > -1) {
                    return c.name;
                }
            }
        }
        catch (e_11_1) { e_11 = { error: e_11_1 }; }
        finally {
            try {
                if (_d && !_d.done && (_a = _c.return)) _a.call(_c);
            }
            finally { if (e_11) throw e_11.error; }
        }
        try {
            for (var _e = __values(this.designerUIState.processVariableContext), _f = _e.next(); !_f.done; _f = _e.next()) {
                var c = _f.value;
                if (expr.indexOf(c.key) > -1) {
                    return c.name;
                }
            }
        }
        catch (e_12_1) { e_12 = { error: e_12_1 }; }
        finally {
            try {
                if (_f && !_f.done && (_b = _e.return)) _b.call(_e);
            }
            finally { if (e_12) throw e_12.error; }
        }
        return this.localePipe.transform('component.reportingLine.businessFields');
    };
    /**
     * @return {?}
     */
    ReportingLineComponent.prototype.defChanged = /**
     * @return {?}
     */
    function () {
        var _this = this;
        System.import('/platform/runtime/wf/web/wf-reporting-data/reportingLineDefHelp.js?v=20231123').then((/**
         * @return {?}
         */
        function () {
            ((/** @type {?} */ (window))).gspWfReportingLineDef.ReportingLineDefHelpUtil.getReportingLineHelp().then((/**
             * @param {?} data
             * @return {?}
             */
            function (data) {
                _this.defSelected(data);
            }));
        }));
    };
    /**
     * @param {?} data
     * @return {?}
     */
    ReportingLineComponent.prototype.defSelected = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        var e_13, _a;
        this.defName = data.name;
        this.reportingLineDataEntity.reportingLineDefId = data.id;
        this.reportingLineDataEntity.reportingLineDefName = data.name;
        this.reportingLineDimension = JSON.parse(data.dimensions);
        this.designerUIState.dimensions = [
            { value: 'higherSuperior', text: this.localePipe.transform('component.reportingLine.higherSuperior') }
        ];
        // 兼容历史数据
        if (this.reportingLineDimension[0].code !== 'directSuperior') {
            /** @type {?} */
            var di = {
                value: 'directSuperior',
                text: this.localePipe.transform('component.reportingLine.directSuperior')
            };
            this.designerUIState.dimensions.push(di);
        }
        try {
            for (var _b = __values(this.reportingLineDimension), _c = _b.next(); !_c.done; _c = _b.next()) {
                var dimension = _c.value;
                /** @type {?} */
                var di = {
                    value: dimension.code,
                    text: dimension.name
                };
                this.designerUIState.dimensions.push(di);
            }
        }
        catch (e_13_1) { e_13 = { error: e_13_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_13) throw e_13.error; }
        }
        // 定义切换后，默认是参照组织
        this.curReportingRefer = this.reportingReferObjects[0].value;
        // 下边的参照人也得隐藏 2023-5-18
        this.display = 'none';
        this.reportingLineDataEntity.refUserId = null;
        this.reportingLineDataEntity.refEmployeeId = null;
        return of$1(true);
    };
    /**
     * @return {?}
     */
    ReportingLineComponent.prototype.getPerformers = /**
     * @return {?}
     */
    function () {
        this.reportingLineDataEntity.type = 'wf.ReportingLineParticipantExpression';
        this.reportingLineDataEntity.reportingReferObject = this.curReportingRefer;
        return this.reportingLineDataEntity;
    };
    ReportingLineComponent.decorators = [
        { type: Component, args: [{
                    selector: 'app-reporting-line',
                    template: "<sys-farris-tree-help class=\"flex-fill\" #orgHelp style=\"display: none;\"\r\n                      [singleSelect]=\"true\" [sourceType]=\"'org'\" [disabled]=\"false\" [filter]=\"treeFilter\"\r\n                      [useBeforeCloseEvent]=\"false\" [async]=\"true\"\r\n                      (afterConfirm)=\"orgSelected($event)\">\r\n</sys-farris-tree-help>\r\n\r\n<div class=\"d-flex flex-fill farris-overflow-y-auto p-md-2\" style=\"background: #FFF;\">\r\n  <div class=\"d-flex flex-fill farris-overflow-y-auto mx-3 my-2\" style=\"border-radius:16px;border: 1.5px solid #F1F3F7;\">\r\n  <form style=\"width: 100%\">\r\n    <div class=\"d-flex m-2 flex-column w-100\">\r\n      <div class=\"d-flex flex-column\">\r\n        <div class=\"farris-form form-inline  farris-form-inline mr-5\">\r\n          <div class=\"col-12 farris-group-auto my-4\">\r\n            <div class=\"farris-group-wrap\">\r\n              <div class=\"form-group farris-form-group\">\r\n                <label class=\"col-form-label\">\r\n                  <span class=\"farris-label-info text-danger\">*</span>\r\n                  <span class=\"farris-label-text\">{{'component.reportingLine.defName'|wfLocale}}</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap\">\r\n                  <input-group [editable]=\"false\" [customCls]=\"'custom-cls'\" [groupText]=\"groupIcon2\"\r\n                               [(value)]=\"defName\"\r\n                               (clickHandle)=\"defChanged()\" [enableClear]=\"false\"\r\n                  ></input-group>\r\n                  <div class=\"farris-feedback valid-feedback\"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"col-12 farris-group-auto my-4\">\r\n            <div class=\"farris-group-wrap\">\r\n              <div class=\"form-group farris-form-group\">\r\n                <label class=\"col-form-label\">\r\n                  <span class=\"farris-label-info text-danger\">*</span>\r\n                  <span class=\"farris-label-text\">{{'component.reportingLine.dimension'|wfLocale}}</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap\">\r\n                  <farris-combo-list [(ngModel)]=\"reportingLineDataEntity.dimension\" name=\"dimension\" [panelHeight]=\"200\"\r\n                                     [idField]=\"'value'\" [textField]=\"'text'\" [data]=\"this.designerUIState.dimensions\" (valueChange)=\"reportingDimensionChange($event)\"\r\n                                     ></farris-combo-list>\r\n                  <div class=\"farris-feedback valid-feedback\"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"col-12 farris-group-auto my-4\">\r\n            <div class=\"farris-group-wrap\">\r\n              <div class=\"form-group farris-form-group\">\r\n                <label class=\"col-form-label\">\r\n                  <span class=\"farris-label-info text-danger\">*</span>\r\n                  <span class=\"farris-label-text\">{{'component.reportingLine.curReportingRefer'|wfLocale}}</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap\">\r\n                  <farris-radiogroup [data]=\"reportingReferObjects\" [horizontal]=\"true\"\r\n                                     [(ngModel)]=\"curReportingRefer\" name=\"referObject\"\r\n                                     (changeValue)=\"referObjectChange($event)\"\r\n                  ></farris-radiogroup>\r\n                  <div class=\"farris-feedback valid-feedback\"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"col-12 farris-group-auto my-4\" [ngStyle]=\"{'display':display}\">\r\n            <div class=\"farris-group-wrap\">\r\n              <div class=\"form-group farris-form-group\">\r\n                <label class=\"col-form-label\">\r\n                  <span class=\"farris-label-info text-danger\">*</span>\r\n                  <span class=\"farris-label-text\">{{'component.reportingLine.usersName'|wfLocale}}</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap\">\r\n                  <div #inputGroup1 class=\"input-group\">\r\n                    <input type=\"text\" class=\"form-control\" [value]=\"users | usersName \" [(ngModel)]=\"reportingLineDataEntity.performerName\" name=\"users\" [readOnly]=\"true\" />\r\n                    <div class=\"input-group-append\">\r\n                      <span [style.display]=\"showClearButton ? '' : 'none'\" class=\"input-group-text input-group-clear\"\r\n                            (click)=\"clearUser()\">\r\n                        <i class=\"f-icon modal_close\"></i>\r\n                      </span>\r\n                      <span *ngIf=\"curReportingRefer === 'sysUser'\" class=\"input-group-text\" (click)=\"selectUsers('sysUser')\" style=\"background: #FFF;\">\r\n                        <i class=\"f-icon f-icon-lookup\"></i>\r\n                      </span>\r\n                      <span *ngIf=\"curReportingRefer === 'employee'\" class=\"input-group-text\" (click)=\"selectUsers('employee')\" style=\"background: #FFF;\">\r\n                        <i class=\"f-icon f-icon-lookup\"></i>\r\n                      </span>\r\n                    </div>\r\n                  </div>\r\n                  <div class=\"farris-feedback valid-feedback\"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"col-12 farris-group-auto my-4\">\r\n            <div class=\"farris-group-wrap\">\r\n              <div class=\"form-group farris-form-group\">\r\n                <label class=\"col-form-label\">\r\n                  <span class=\"farris-label-info text-danger\" [ngStyle]=\"{'display':display === 'none' ? 'block':'none'}\">*</span>\r\n                  <span class=\"farris-label-text\">{{'component.reportingLine.refOrgId'|wfLocale}}</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap\">\r\n                  <div #inputGroup class=\"input-group\">\r\n                    <input type=\"text\" class=\"form-control\" [(ngModel)]=\"reportingLineDataEntity.refOrgId\" name=\"dept\" [readOnly]=\"true\" />\r\n                    <div class=\"input-group-append\">\r\n                      <span [style.display]=\"showClearButton ? '' : 'none'\" class=\"input-group-text input-group-clear\"\r\n                            (click)=\"clearOrg()\">\r\n                        <i class=\"f-icon modal_close\"></i>\r\n                      </span>\r\n                      <span class=\"input-group-text\" (click)=\"selectOrg('org')\" style=\"background: #FFF;\">\r\n                        <i class=\"f-icon f-icon-lookup\"></i>\r\n                      </span>\r\n                    </div>\r\n                  </div>\r\n                  <div class=\"farris-feedback valid-feedback\"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div class=\"d-flex flex-column\">\r\n        <div class=\"farris-form form-inline farris-form-inline mr-5\">\r\n          <div class=\"col-12 farris-group-auto my-4\">\r\n            <div class=\"farris-group-wrap\">\r\n              <div class=\"form-group farris-form-group\">\r\n                <label class=\"col-form-label\">\r\n                  <span class=\"farris-label-text\">{{'component.reportingLine.condition'|wfLocale}}</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap\">\r\n                  <div class=\"input-group\">\r\n                    <input type=\"text\" class=\"form-control\" [(ngModel)]=\"reportingLineDataEntity.condition\" name=\"conditon\" [readOnly]=\"true\" />\r\n                    <div class=\"input-group-append\">\r\n                      <span class=\"input-group-text\" (click)=\"editCondition()\" style=\"background: #FFF;\">\r\n                        <i class=\"f-icon f-icon-lookup\"></i>\r\n                      </span>\r\n                    </div>\r\n                  </div>\r\n                  <div class=\"farris-feedback valid-feedback\"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </form>\r\n</div>\r\n</div>\r\n\r\n<app-wf-report-def-help style=\"display: none;\" [singleSelect]=\"true\" title=\"{{'component.reportingLine.definitionOfReport'|wfLocale}}\" (afterConfirm)=\"defSelected($event)\">\r\n\r\n</app-wf-report-def-help>\r\n",
                    providers: [
                        WfLocalePipe,
                    ],
                    styles: [""]
                }] }
    ];
    /** @nocollapse */
    ReportingLineComponent.ctorParameters = function () { return [
        { type: HttpService },
        { type: ProcessDesignerUIState },
        { type: ExpressionService },
        { type: NgZone },
        { type: ChangeDetectorRef, decorators: [{ type: Optional }] },
        { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
        { type: undefined, decorators: [{ type: Inject, args: [WF_LANG_RESOURCES,] }] },
        { type: WfLocalePipe, decorators: [{ type: Optional }] }
    ]; };
    ReportingLineComponent.propDecorators = {
        cls: [{ type: HostBinding, args: ['class',] }],
        reportingLineDefHelp: [{ type: ViewChild, args: [WfReportDefHelpComponent,] }],
        setReportingLineDataEntity: [{ type: Input }],
        lookup: [{ type: ViewChild, args: [LookupGridComponent,] }],
        orgHelp: [{ type: ViewChild, args: [SysFarrisTreeHelpComponent,] }],
        inputGroup: [{ type: ViewChild, args: ['inputGroup',] }],
        inputGroup1: [{ type: ViewChild, args: ['inputGroup1',] }]
    };
    return ReportingLineComponent;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var MatrixDefInfoEntity = /** @class */ (function () {
    function MatrixDefInfoEntity() {
    }
    return MatrixDefInfoEntity;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var MatrixDataInfoEntity = /** @class */ (function (_super) {
    __extends(MatrixDataInfoEntity, _super);
    function MatrixDataInfoEntity(id, name, type) {
        return _super.call(this, id, name, type) || this;
    }
    return MatrixDataInfoEntity;
}(PerformerEntity));

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var EnumListComponent = /** @class */ (function () {
    function EnumListComponent(messageService, injector, cdr, localeId, resources, localePipe) {
        this.messageService = messageService;
        this.injector = injector;
        this.cdr = cdr;
        this.localeId = localeId;
        this.resources = resources;
        this.localePipe = localePipe;
        this.cls = 'farris-main-area flex-column';
        this.columns = [
            { field: 'key', width: 100, title: this.localePipe.transform('component.matrixPerformer.key') },
            { field: 'value', width: 100, title: this.localePipe.transform('component.matrixPerformer.value') }
        ];
        this.confirm = new Subject$1();
        this.closeModalEmitter = new Subject$1();
        /**
         * 显示值
         */
        this.data = new Array();
        this.selectedIds = new Array();
        this.localePipe = this.localePipe || new WfLocalePipe(localeId, resources);
    }
    /**
     * @return {?}
     */
    EnumListComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
    };
    /**
     * 加载显示数据
     */
    /**
     * 加载显示数据
     * @param {?} enumValues
     * @return {?}
     */
    EnumListComponent.prototype.load = /**
     * 加载显示数据
     * @param {?} enumValues
     * @return {?}
     */
    function (enumValues) {
        this.data = __spread(enumValues);
    };
    /**
     * 确认
     */
    /**
     * 确认
     * @return {?}
     */
    EnumListComponent.prototype.onConfirm = /**
     * 确认
     * @return {?}
     */
    function () {
        var _this = this;
        if (this.selectedIds.length === 0) {
            this.messageService.warning(this.localePipe.transform('component.matrixPerformer.notSelectEnum'));
        }
        /** @type {?} */
        var enumValues = this.data.filter((/**
         * @param {?} d
         * @return {?}
         */
        function (d) { return _this.selectedIds.findIndex((/**
         * @param {?} id
         * @return {?}
         */
        function (id) { return id === d.key; })) > -1; }));
        this.confirm.next(enumValues);
        this.closeModalEmitter.next();
    };
    /**
     * 取消
     */
    /**
     * 取消
     * @return {?}
     */
    EnumListComponent.prototype.cancel = /**
     * 取消
     * @return {?}
     */
    function () {
        this.closeModalEmitter.next();
    };
    EnumListComponent.decorators = [
        { type: Component, args: [{
                    selector: 'app-enum-list',
                    template: "<ng-template #buttons>\r\n  <button class=\"btn btn-secondary\" (click)=\"cancel()\">{{'component.matrixPerformer.cancel'|wfLocale}}</button>\r\n  <button class=\"btn btn-primary\" (click)=\"onConfirm()\">{{'component.matrixPerformer.onConfirm'|wfLocale}}</button>\r\n</ng-template>\r\n\r\n<div class=\"f-page\">\r\n  <div class=\"f-page-main f-utils-fill-flex-column h-100\">\r\n    <div class=\"f-utils-fill-flex-column farris-overflow-y-auto h-100\">\r\n      <farris-datagrid [data]=\"data\" [columns]=\"columns\" #dg=\"datagrid\" [fit]=\"true\"\r\n                       [idField]=\"'key'\" [fitColumns]=\"true\" [showLineNumber]=\"true\" [(checkValues)]=\"selectedIds\"\r\n                       [showAllCheckbox]=\"true\" [showCheckbox]=\"true\" [multiSelect]=\"false\" [checkOnSelect]=\"true\" [selectOnCheck]=\"true\"\r\n                       lineNumberTitle=\"{{'component.matrixPerformer.lineNumber'|wfLocale}}\" [lineNumberWidth]=\"50\" [striped]=\"true\" [virtualized]=\"true\" [pagination]=\"false\">\r\n      </farris-datagrid>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n",
                    providers: [
                        WfLocalePipe,
                    ],
                    styles: [""]
                }] }
    ];
    /** @nocollapse */
    EnumListComponent.ctorParameters = function () { return [
        { type: MessagerService },
        { type: Injector },
        { type: ChangeDetectorRef, decorators: [{ type: Optional }] },
        { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
        { type: undefined, decorators: [{ type: Inject, args: [WF_LANG_RESOURCES,] }] },
        { type: WfLocalePipe, decorators: [{ type: Optional }] }
    ]; };
    EnumListComponent.propDecorators = {
        cls: [{ type: HostBinding, args: ['class',] }],
        dg: [{ type: ViewChild, args: ['dg',] }],
        btnRef: [{ type: ViewChild, args: ['buttons',] }]
    };
    return EnumListComponent;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var MatrixDefHelpService = /** @class */ (function () {
    function MatrixDefHelpService(http) {
        this.http = http;
    }
    /**
     * @param {?} url
     * @param {?=} params
     * @return {?}
     */
    MatrixDefHelpService.prototype.getData = /**
     * @param {?} url
     * @param {?=} params
     * @return {?}
     */
    function (url, params) {
        if (url.indexOf('getMatrixDef') > -1) {
            /** @type {?} */
            var index = params.pageIndex || 1;
            /** @type {?} */
            var size = params.pageSize || 20;
            /** @type {?} */
            var searchValue = JSON.parse(params.searchValue);
            if (searchValue.searchValue) {
                /** @type {?} */
                var query = '{';
                if (searchValue.searchValue) {
                    if (searchValue.searchField === '*') {
                        query += "\"codeOrNameLike\":\"" + searchValue.searchValue + "\",";
                    }
                    else {
                        query += "\"" + searchValue.searchField + "\":\"" + searchValue.searchValue + "\",";
                    }
                }
                if (query.substr(query.length - 1, 1) === ',') {
                    query = query.substring(0, query.length - 1);
                }
                query += '}';
                query = encodeURIComponent(query);
                query += "&pageIndex=" + index + "&pageSize=" + size;
                url += '?searchValue=' + query;
            }
            else {
                url += "?pageIndex=" + index + "&pageSize=" + size;
            }
            return this.http.get(url).pipe(map((/**
             * @param {?} re
             * @return {?}
             */
            function (re) { return ({
                items: re.content,
                total: re.totalElements,
                pageInfo: {
                    pageIndex: re.pageable.pageNumber + 1,
                    pageSize: re.pageable.pageSize,
                    pageList: [20, 40, 60, 80, 100],
                    enablePager: true
                }
            }); })));
        }
    };
    MatrixDefHelpService.decorators = [
        { type: Injectable }
    ];
    /** @nocollapse */
    MatrixDefHelpService.ctorParameters = function () { return [
        { type: HttpService }
    ]; };
    return MatrixDefHelpService;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var MatrixPerformerComponent = /** @class */ (function () {
    function MatrixPerformerComponent(http, designerUIState, expr, modalService, resolver, injector, matDefService, cdr, localeId, resources, localePipe) {
        var _this = this;
        this.http = http;
        this.designerUIState = designerUIState;
        this.expr = expr;
        this.modalService = modalService;
        this.resolver = resolver;
        this.injector = injector;
        this.matDefService = matDefService;
        this.cdr = cdr;
        this.localeId = localeId;
        this.resources = resources;
        this.localePipe = localePipe;
        this.cls = 'd-flex flex-fill h-100';
        this.display = 'none';
        this.typeReadOnly = false;
        this.items = [];
        this.pageIndex = 1;
        this.pageSize = 20;
        this.pageList = [10, 20, 30, 50, 100];
        this.total = 0;
        this.groupIcon2 = '<i class="f-icon f-icon-lookup"></i>';
        this.fieldId = '';
        /**
         * 矩阵定义显示列
         */
        this.columns = [
            { title: this.localePipe.transform('component.matrixPerformer.code'), field: 'code', width: 100 },
            { title: this.localePipe.transform('component.matrixPerformer.name'), field: 'name', width: 100 }
        ];
        this.users = [];
        this.dataFieldAndValues = []; // { text: '部门', value: 'department' },
        // { text: '部门', value: 'department' },
        this.curDataFieldValue = '';
        this.matrixDefEntityList = [];
        this.curMatrixDefEntity = new MatrixDefInfoEntity();
        this.curMatrixDataEntity = new MatrixDataInfoEntity();
        this.conditionFields = [];
        this.exprGroup = [
            { name: this.localePipe.transform('component.matrixPerformer.help'), value: 'help' }
        ];
        this.mulGroup = [
            { name: this.localePipe.transform('component.matrixPerformer.multivalue'), value: 'Multivalue' }
        ];
        this.condition1ExprAble = true;
        this.condition2ExprAble = true;
        this.condition3ExprAble = true;
        this.condition1Multivalue = false;
        this.condition2Multivalue = false;
        this.condition3Multivalue = false;
        /**
         * 编辑器页面显示文字，防范浅拷贝问题（对于条件字段的值和显示文字都不要在当前实体中进行修改只有点击确定时，才将其保存至当前实体并返回）
         */
        this.condition1Text = '';
        this.condition1Value = '';
        this.condition2Text = '';
        this.condition2Value = '';
        this.condition3Text = '';
        this.condition3Value = '';
        this.dictPicked = (/**
         * @param {?} rowData
         * @return {?}
         */
        function (rowData) {
            // 先将当前绑定的数据清空
            _this.curMatrixDataEntity = new MatrixDataInfoEntity();
            _this.curDataFieldValue = '';
            _this.curMatrixDefEntity = rowData;
            _this.curMatrixDataEntity.matrixDefId = rowData.id;
            _this.curMatrixDataEntity.matrixDefName = rowData.name;
            _this.setFields();
            return of$1(true);
        });
        this.dictHelpPicked = (/**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            _this.value = null;
            return of$1({ closeDialog: true });
        });
        this.onBeforeHelp = (/**
         * @param {?} e
         * @return {?}
         */
        function (e) {
            /** @type {?} */
            var lookupIns = e.instance;
            if (lookupIns) {
                /** @type {?} */
                var getDataFn_1 = lookupIns.http.getData;
                lookupIns.http.getData = _this.matDefService.getData;
                lookupIns.dialogClosed.subscribe((/**
                 * @return {?}
                 */
                function () {
                    lookupIns.http.getData = getDataFn_1;
                }));
            }
            return of$1(true);
        });
        this.localePipe = this.localePipe || new WfLocalePipe(localeId, resources);
        // this.getMatrixLineType();
    }
    Object.defineProperty(MatrixPerformerComponent.prototype, "setMatrixDataEntity", {
        set: /**
         * @param {?} dataEntity
         * @return {?}
         */
        function (dataEntity) {
            var _this = this;
            this.curMatrixDataEntity = dataEntity;
            /** @type {?} */
            var url = '/api/runtime/wf/v1.0/matrixDefinition/' + dataEntity.matrixDefId;
            this.http.get(url).subscribe((/**
             * @param {?} re
             * @return {?}
             */
            function (re) {
                _this.curMatrixDefEntity = re;
                _this.setFields();
                _this.curDataFieldValue = dataEntity.dataFieldAlias;
            }));
            if (dataEntity.matrixDefId) {
                this.typeReadOnly = true;
            }
            if (!this.curMatrixDataEntity.conditionField1) {
                this.condition1 = 'expr';
                this.condition1ExprAble = true;
            }
            else if (this.curMatrixDataEntity.conditionField1.charAt(0) === '{') {
                this.condition1 = 'expr';
                this.condition1ExprAble = true;
            }
            else {
                this.condition1 = 'help';
                this.condition1ExprAble = false;
            }
            if (!this.curMatrixDataEntity.conditionField2) {
                this.condition2 = 'expr';
                this.condition2ExprAble = true;
            }
            else if (this.curMatrixDataEntity.conditionField2.charAt(0) === '{') {
                this.condition2 = 'expr';
                this.condition2ExprAble = true;
            }
            else {
                this.condition2 = 'help';
                this.condition2ExprAble = false;
            }
            if (!this.curMatrixDataEntity.conditionField3) {
                this.condition3 = 'expr';
                this.condition3ExprAble = true;
            }
            else if (this.curMatrixDataEntity.conditionField3.charAt(0) === '{') {
                this.condition3 = 'expr';
                this.condition3ExprAble = true;
            }
            else {
                this.condition3 = 'help';
                this.condition3ExprAble = false;
            }
            if (this.curMatrixDataEntity.multivaluedCondition === 'condition1') {
                this.MultivalueOption1 = 'Multivalue';
                this.condition1Multivalue = true;
            }
            else if (this.curMatrixDataEntity.multivaluedCondition === 'condition2') {
                this.MultivalueOption2 = 'Multivalue';
                this.condition2Multivalue = true;
            }
            else if (this.curMatrixDataEntity.multivaluedCondition === 'condition3') {
                this.MultivalueOption3 = 'Multivalue';
                this.condition3Multivalue = true;
            }
            this.condition1Text = this.curMatrixDataEntity.conditionFieldText1 ? this.curMatrixDataEntity.conditionFieldText1 : '';
            this.condition1Value = this.curMatrixDataEntity.conditionField1 ? this.curMatrixDataEntity.conditionField1 : '';
            this.condition2Text = this.curMatrixDataEntity.conditionFieldText2 ? this.curMatrixDataEntity.conditionFieldText2 : '';
            this.condition2Value = this.curMatrixDataEntity.conditionField2 ? this.curMatrixDataEntity.conditionField2 : '';
            this.condition3Text = this.curMatrixDataEntity.conditionFieldText3 ? this.curMatrixDataEntity.conditionFieldText3 : '';
            this.condition3Value = this.curMatrixDataEntity.conditionField3 ? this.curMatrixDataEntity.conditionField3 : '';
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    MatrixPerformerComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var rootPath = '';
        try {
            rootPath = ((/** @type {?} */ (window))).gspframeworkService.common.getBasePath.get();
        }
        catch (error) {
        }
        this.dataUri = rootPath + '/api/runtime/wf/v1.0/matrixDefinition/getMatrixDef';
    };
    /**
     * 获取矩阵定义
     */
    /**
     * 获取矩阵定义
     * @return {?}
     */
    MatrixPerformerComponent.prototype.getMatrixLineType = /**
     * 获取矩阵定义
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var url = '/api/runtime/wf/v1.0/matrixDefinition';
        this.http.get(url).subscribe((/**
         * @param {?} re
         * @return {?}
         */
        function (re) {
            _this.matrixDefEntityList = re;
            _this.items = _this.matrixDefEntityList.slice(0, _this.pageSize);
            _this.total = _this.matrixDefEntityList.length;
        }));
    };
    /**
     * @private
     * @return {?}
     */
    MatrixPerformerComponent.prototype.setFields = /**
     * @private
     * @return {?}
     */
    function () {
        var e_1, _a, e_2, _b;
        this.conditionFields = [];
        this.dataFieldAndValues = [];
        // 先对条件字段按照排序号进行排序
        this.curMatrixDefEntity.conditionField.sort((/**
         * @param {?} a
         * @param {?} b
         * @return {?}
         */
        function (a, b) {
            return a.sortOrder - b.sortOrder;
        }));
        try {
            // 将排序后的条件放入条件字段数组中
            for (var _c = __values(this.curMatrixDefEntity.conditionField), _d = _c.next(); !_d.done; _d = _c.next()) {
                var condition = _d.value;
                this.conditionFields.push(condition);
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (_d && !_d.done && (_a = _c.return)) _a.call(_c);
            }
            finally { if (e_1) throw e_1.error; }
        }
        // 先对数据字段按照排序号进行排序
        this.curMatrixDefEntity.dataField.sort((/**
         * @param {?} a
         * @param {?} b
         * @return {?}
         */
        function (a, b) {
            return a.sortOrder - b.sortOrder;
        }));
        try {
            // 填充数据字段的下拉列表
            for (var _e = __values(this.curMatrixDefEntity.dataField), _f = _e.next(); !_f.done; _f = _e.next()) {
                var data = _f.value;
                /** @type {?} */
                var temp = {
                    text: data.alias,
                    value: data.alias
                };
                this.dataFieldAndValues.push(temp);
            }
        }
        catch (e_2_1) { e_2 = { error: e_2_1 }; }
        finally {
            try {
                if (_f && !_f.done && (_b = _e.return)) _b.call(_e);
            }
            finally { if (e_2) throw e_2.error; }
        }
    };
    /**
     * @return {?}
     */
    MatrixPerformerComponent.prototype.onClear = /**
     * @return {?}
     */
    function () {
        this.curMatrixDataEntity = new MatrixDataInfoEntity();
    };
    /**
     * 编辑条件
     */
    /**
     * 编辑条件
     * @return {?}
     */
    MatrixPerformerComponent.prototype.editCondition = /**
     * 编辑条件
     * @return {?}
     */
    function () {
        var _this = this;
        var e_3, _a, e_4, _b, e_5, _c;
        // this.expr.clearContext();
        if (this.designerUIState.schemas.length > 0) {
            try {
                for (var _d = __values(this.designerUIState.schemas), _e = _d.next(); !_e.done; _e = _d.next()) {
                    var schema = _e.value;
                    this.expr.addSchema('Schema', schema);
                }
            }
            catch (e_3_1) { e_3 = { error: e_3_1 }; }
            finally {
                try {
                    if (_e && !_e.done && (_a = _d.return)) _a.call(_d);
                }
                finally { if (e_3) throw e_3.error; }
            }
            if (this.designerUIState.schemas[0].entityTypes && this.designerUIState.schemas[0].entityTypes.length > 0) {
                /** @type {?} */
                var entityType = this.designerUIState.schemas[0].entityTypes[0];
                this.expr.addInjectedEntity(entityType.name, 'Schema', entityType.name, InjectedType.EntityType);
            }
        }
        /** @type {?} */
        var context = new Array();
        context = this.designerUIState.addContext(context);
        if (this.designerUIState.subActivityContext.length > 0) {
            var _loop_1 = function (variable) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    context.push(variable);
                }
            };
            try {
                for (var _f = __values(this.designerUIState.subActivityContext), _g = _f.next(); !_g.done; _g = _f.next()) {
                    var variable = _g.value;
                    _loop_1(variable);
                }
            }
            catch (e_4_1) { e_4 = { error: e_4_1 }; }
            finally {
                try {
                    if (_g && !_g.done && (_b = _f.return)) _b.call(_f);
                }
                finally { if (e_4) throw e_4.error; }
            }
        }
        if (context.length > 0) {
            try {
                for (var context_1 = __values(context), context_1_1 = context_1.next(); !context_1_1.done; context_1_1 = context_1.next()) {
                    var v = context_1_1.value;
                    this.expr.addContext(v);
                }
            }
            catch (e_5_1) { e_5 = { error: e_5_1 }; }
            finally {
                try {
                    if (context_1_1 && !context_1_1.done && (_c = context_1.return)) _c.call(context_1);
                }
                finally { if (e_5) throw e_5.error; }
            }
        }
        this.expr.setEditPattern(ExprEditMode.Conditional); // 表达式展现模式：默认简易版
        this.expr.addExpressionText(this.curMatrixDataEntity.condition); // this.reportingLineDataEntity.condition
        this.expr.buildExpression().then((/**
         * @param {?} expressioninfo
         * @return {?}
         */
        function (expressioninfo) {
            _this.curMatrixDataEntity.condition = expressioninfo;
            //点击确定后，去除表达式里面的新增的上下文变量
            if (context.length > 0) {
                _this.expr.exprEntity.contextEntities = _this.expr.exprEntity.contextEntities.filter((/**
                 * @param {?} x
                 * @return {?}
                 */
                function (x) { return !context.some((/**
                 * @param {?} y
                 * @return {?}
                 */
                function (y) { return y.key === x.key; })); }));
            }
        }));
    };
    /**
     * @param {?} data
     * @param {?} index
     * @param {?} id
     * @return {?}
     */
    MatrixPerformerComponent.prototype.onHelpSearch = /**
     * @param {?} data
     * @param {?} index
     * @param {?} id
     * @return {?}
     */
    function (data, index, id) {
        this.index = index;
        this.fieldId = id;
        this.helpId = this.curMatrixDefEntity.conditionField[this.index].smartHelp;
        this.lookUp.onClear();
        this.lookUp.showDialog();
    };
    /**
     * @param {?} index
     * @param {?} id
     * @return {?}
     */
    MatrixPerformerComponent.prototype.openEnumValue = /**
     * @param {?} index
     * @param {?} id
     * @return {?}
     */
    function (index, id) {
        this.index = index;
        this.fieldId = id;
        this.showEnumList(JSON.parse(this.curMatrixDefEntity.conditionField[this.index].enumList));
    };
    /**
     * @private
     * @param {?} enumList
     * @return {?}
     */
    MatrixPerformerComponent.prototype.showEnumList = /**
     * @private
     * @param {?} enumList
     * @return {?}
     */
    function (enumList) {
        var _this = this;
        /** @type {?} */
        var compFactory = this.resolver.resolveComponentFactory(EnumListComponent);
        /** @type {?} */
        var compRef = compFactory.create(this.injector);
        /** @type {?} */
        var modalConfig = {
            title: this.localePipe.transform('component.matrixPerformer.enumSelection'),
            width: 650,
            height: 450,
            showButtons: true,
            buttons: compRef.instance.btnRef,
        };
        if (enumList && enumList.length > 0) {
            compRef.instance.load(enumList);
        }
        compRef.instance.confirm.subscribe((/**
         * @param {?} re
         * @return {?}
         */
        function (re) {
            if (_this.index === 0) {
                _this.condition1Text = re[0].value;
                _this.condition1Value = re[0].value;
            }
            else if (_this.index === 1) {
                _this.condition2Text = re[0].value;
                _this.condition2Value = re[0].value;
            }
            else if (_this.index === 2) {
                _this.condition3Text = re[0].value;
                _this.condition3Value = re[0].value;
            }
        }));
        /** @type {?} */
        var dialog = this.modalService.show(compRef, modalConfig);
        compRef.instance.closeModalEmitter.subscribe((/**
         * @return {?}
         */
        function () {
            dialog.close();
        }));
    };
    /**
     * @param {?} data
     * @return {?}
     */
    MatrixPerformerComponent.prototype.dataFieldChange = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        this.curMatrixDataEntity.dataFieldAlias = data.data.value;
    };
    /**
     * @param {?} data
     * @return {?}
     */
    MatrixPerformerComponent.prototype.selectedDataHandler = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        if (this.index === 0) {
            this.condition1Text = data.name;
            this.condition1Value = data.id;
        }
        else if (this.index === 1) {
            this.condition2Text = data.name;
            this.condition2Value = data.id;
        }
        else if (this.index === 2) {
            this.condition3Text = data.name;
            this.condition3Value = data.id;
        }
    };
    /**
     * @return {?}
     */
    MatrixPerformerComponent.prototype.getPerformers = /**
     * @return {?}
     */
    function () {
        this.curMatrixDataEntity.type = 'wf.MatrixParticipantExpression';
        this.curMatrixDataEntity.conditionFieldText1 = this.condition1Text;
        this.curMatrixDataEntity.conditionField1 = this.condition1Text === '' ? '' : this.condition1Value;
        this.curMatrixDataEntity.conditionFieldText2 = this.condition2Text;
        this.curMatrixDataEntity.conditionField2 = this.condition2Text === '' ? '' : this.condition2Value;
        this.curMatrixDataEntity.conditionFieldText3 = this.condition3Text;
        this.curMatrixDataEntity.conditionField3 = this.condition3Text === '' ? '' : this.condition3Value;
        if (this.condition1Multivalue) {
            this.curMatrixDataEntity.multivaluedCondition = 'condition1';
        }
        else if (this.condition2Multivalue) {
            this.curMatrixDataEntity.multivaluedCondition = 'condition2';
        }
        else if (this.condition3Multivalue) {
            this.curMatrixDataEntity.multivaluedCondition = 'condition3';
        }
        return this.curMatrixDataEntity;
    };
    /**
     * 打开表达式编辑器
     * @param data 编辑第几个条件字段，值为（condition1，condition2，condition3）
     */
    /**
     * 打开表达式编辑器
     * @param {?} data 编辑第几个条件字段，值为（condition1，condition2，condition3）
     * @return {?}
     */
    MatrixPerformerComponent.prototype.showExprHelp = /**
     * 打开表达式编辑器
     * @param {?} data 编辑第几个条件字段，值为（condition1，condition2，condition3）
     * @return {?}
     */
    function (data) {
        var _this = this;
        var e_6, _a, e_7, _b, e_8, _c, e_9, _d, e_10, _e;
        // this.expr.clearContext();
        if (this.designerUIState.schemas.length > 0) {
            try {
                for (var _f = __values(this.designerUIState.schemas), _g = _f.next(); !_g.done; _g = _f.next()) {
                    var schema = _g.value;
                    // this.expr.addCommonObject(co);
                    this.expr.addSchema('Schema', schema);
                }
            }
            catch (e_6_1) { e_6 = { error: e_6_1 }; }
            finally {
                try {
                    if (_g && !_g.done && (_a = _f.return)) _a.call(_f);
                }
                finally { if (e_6) throw e_6.error; }
            }
            if (this.designerUIState.schemas[0].entityTypes && this.designerUIState.schemas[0].entityTypes.length > 0) {
                /** @type {?} */
                var entityType = this.designerUIState.schemas[0].entityTypes[0];
                this.expr.addInjectedEntity(entityType.name, 'Schema', entityType.name, InjectedType.EntityType);
            }
        }
        /** @type {?} */
        var context = new Array();
        if (this.designerUIState.participantContext.length > 0) {
            try {
                for (var _h = __values(this.designerUIState.participantContext), _j = _h.next(); !_j.done; _j = _h.next()) {
                    var variable = _j.value;
                    context.push(variable);
                    // this.expr.addContext(variable);
                }
            }
            catch (e_7_1) { e_7 = { error: e_7_1 }; }
            finally {
                try {
                    if (_j && !_j.done && (_b = _h.return)) _b.call(_h);
                }
                finally { if (e_7) throw e_7.error; }
            }
        }
        if (this.designerUIState.processVariableContext.length > 0) {
            var _loop_2 = function (variable) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    context.push(variable);
                }
            };
            try {
                for (var _k = __values(this.designerUIState.processVariableContext), _l = _k.next(); !_l.done; _l = _k.next()) {
                    var variable = _l.value;
                    _loop_2(variable);
                }
            }
            catch (e_8_1) { e_8 = { error: e_8_1 }; }
            finally {
                try {
                    if (_l && !_l.done && (_c = _k.return)) _c.call(_k);
                }
                finally { if (e_8) throw e_8.error; }
            }
        }
        if (this.designerUIState.subActivityContext.length > 0) {
            var _loop_3 = function (variable) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    context.push(variable);
                }
            };
            try {
                for (var _m = __values(this.designerUIState.subActivityContext), _o = _m.next(); !_o.done; _o = _m.next()) {
                    var variable = _o.value;
                    _loop_3(variable);
                }
            }
            catch (e_9_1) { e_9 = { error: e_9_1 }; }
            finally {
                try {
                    if (_o && !_o.done && (_d = _m.return)) _d.call(_m);
                }
                finally { if (e_9) throw e_9.error; }
            }
        }
        if (context.length > 0) {
            try {
                for (var context_2 = __values(context), context_2_1 = context_2.next(); !context_2_1.done; context_2_1 = context_2.next()) {
                    var v = context_2_1.value;
                    this.expr.addContext(v);
                }
            }
            catch (e_10_1) { e_10 = { error: e_10_1 }; }
            finally {
                try {
                    if (context_2_1 && !context_2_1.done && (_e = context_2.return)) _e.call(context_2);
                }
                finally { if (e_10) throw e_10.error; }
            }
        }
        if (data === 'condition1') {
            if (this.curMatrixDataEntity.conditionField1) {
                this.expr.addExpressionText(this.curMatrixDataEntity.conditionField1);
            }
            else {
                this.expr.addExpressionText('');
            }
        }
        else if (data === 'condition2') {
            if (this.curMatrixDataEntity.conditionField2) {
                this.expr.addExpressionText(this.curMatrixDataEntity.conditionField2);
            }
            else {
                this.expr.addExpressionText('');
            }
        }
        else if (data === 'condition3') {
            if (this.curMatrixDataEntity.conditionField3) {
                this.expr.addExpressionText(this.curMatrixDataEntity.conditionField3);
            }
            else {
                this.expr.addExpressionText('');
            }
        }
        this.expr.buildExpression().then((/**
         * @param {?} expressionInfo
         * @return {?}
         */
        function (expressionInfo) {
            if (data === 'condition1') {
                _this.condition1Text = expressionInfo;
                _this.condition1Value = expressionInfo;
            }
            else if (data === 'condition2') {
                _this.condition2Text = expressionInfo;
                _this.condition2Value = expressionInfo;
            }
            else {
                _this.condition3Text = expressionInfo;
                _this.condition3Value = expressionInfo;
            }
            //点击确定后，去除表达式里面的新增的上下文变量
            if (context.length > 0) {
                _this.expr.exprEntity.contextEntities = _this.expr.exprEntity.contextEntities.filter((/**
                 * @param {?} x
                 * @return {?}
                 */
                function (x) { return !context.some((/**
                 * @param {?} y
                 * @return {?}
                 */
                function (y) { return y.key === x.key; })); }));
            }
        }));
    };
    /**
     * @param {?} data
     * @return {?}
     */
    MatrixPerformerComponent.prototype.condition1Expr = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        this.showExprHelp(data);
    };
    /**
     * @return {?}
     */
    MatrixPerformerComponent.prototype.condition1ExprClick = /**
     * @return {?}
     */
    function () {
        this.condition1ExprAble = !this.condition1ExprAble;
        this.condition1Multivalue = false;
        this.MultivalueOption1 = '';
        this.condition1Text = '';
        this.condition1Value = '';
    };
    /**
     * @return {?}
     */
    MatrixPerformerComponent.prototype.condition1MulClick = /**
     * @return {?}
     */
    function () {
        this.MultivalueOption2 = '';
        this.MultivalueOption3 = '';
        this.condition2Multivalue = false;
        this.condition3Multivalue = false;
        this.condition1Multivalue = !this.condition1Multivalue;
    };
    /**
     * @param {?} data
     * @return {?}
     */
    MatrixPerformerComponent.prototype.condition2Expr = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        this.showExprHelp(data);
    };
    /**
     * @return {?}
     */
    MatrixPerformerComponent.prototype.condition2ExprClick = /**
     * @return {?}
     */
    function () {
        this.condition2ExprAble = !this.condition2ExprAble;
        this.condition2Multivalue = false;
        this.MultivalueOption2 = '';
        this.condition2Text = '';
        this.condition2Value = '';
    };
    /**
     * @return {?}
     */
    MatrixPerformerComponent.prototype.condition2MulClick = /**
     * @return {?}
     */
    function () {
        this.MultivalueOption1 = '';
        this.MultivalueOption3 = '';
        this.condition1Multivalue = false;
        this.condition3Multivalue = false;
        this.condition2Multivalue = !this.condition2Multivalue;
    };
    /**
     * @param {?} data
     * @return {?}
     */
    MatrixPerformerComponent.prototype.condition3Expr = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        this.showExprHelp(data);
    };
    /**
     * @return {?}
     */
    MatrixPerformerComponent.prototype.condition3ExprClick = /**
     * @return {?}
     */
    function () {
        this.condition3ExprAble = !this.condition3ExprAble;
        this.condition3Multivalue = false;
        this.MultivalueOption3 = '';
        this.condition3Text = '';
        this.condition3Value = '';
    };
    /**
     * @return {?}
     */
    MatrixPerformerComponent.prototype.condition3MulClick = /**
     * @return {?}
     */
    function () {
        this.MultivalueOption1 = '';
        this.MultivalueOption2 = '';
        this.condition1Multivalue = false;
        this.condition2Multivalue = false;
        this.condition3Multivalue = !this.condition3Multivalue;
    };
    MatrixPerformerComponent.decorators = [
        { type: Component, args: [{
                    selector: 'app-matrix-performer',
                    template: "<div class=\"d-flex flex-fill farris-overflow-y-auto p-md-2\" style=\"background: #FFF;\">\r\n  <div class=\"d-flex flex-fill farris-overflow-y-auto mx-3 my-2\" style=\"border-radius:16px;border: 1.5px solid #F1F3F7;\">\r\n  <form style=\"width: 100%;\">\r\n    <div class=\"d-flex m-2 flex-column w-100\">\r\n      <div class=\"d-flex flex-column\">\r\n        <div class=\"farris-form form-inline  farris-form-inline\"><!--mr-5-->\r\n          <div class=\"col-12 farris-group-auto my-4\">\r\n            <div class=\"farris-group-wrap\">\r\n              <div class=\"form-group farris-form-group\">\r\n                <label class=\"col-form-label\" style=\"width: 14%\">\r\n                  <span class=\"farris-label-info text-danger\">*</span>\r\n                  <span class=\"farris-label-text\">{{'component.matrixPerformer.refMatrixTable'|wfLocale}}</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap\" style=\"width: 77.5%\">\r\n                  <farris-lookup-grid [items]=\"items\" [columns]=\"columns\" [(ngModel)]=\"curMatrixDataEntity.matrixDefName\"\r\n                                      name=\"definitionId\" [resizable]=\"true\" [singleSelect]=\"true\" [idField]=\"'id'\" [pagination]=\"true\"\r\n                                      [pageIndex]=\"pageIndex\" [pageSize]=\"pageSize\" [pageList]=\"pageList\" [total]=\"total\" [textField]=\"'name'\"\r\n                                      [valueField]=\"'id'\" title=\"{{'component.matrixPerformer.matrixTable'|wfLocale}}\" [dictPicked]=\"dictPicked\" (clear)=\"onClear()\" [readonly]=\"typeReadOnly\"\r\n                                      [customDisplayType] = \"true\" [displayType]=\"'LIST'\" [uri]=\"dataUri\" [dictPicking]=\"onBeforeHelp\">\r\n                  </farris-lookup-grid>\r\n                  <div class=\"farris-feedback valid-feedback\"></div>\r\n                </div>\r\n                <div style=\"width: 7.5%\"></div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"col-12 farris-group-auto my-4\">\r\n            <div class=\"farris-group-wrap\">\r\n              <div class=\"form-group farris-form-group\">\r\n                <label class=\"col-form-label\" style=\"width: 14%\">\r\n                  <span class=\"farris-label-info text-danger\">*</span>\r\n                  <span class=\"farris-label-text\">{{'component.matrixPerformer.curDataFieldValue'|wfLocale}}</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap\" style=\"width: 77.5%\">\r\n                  <!--\u4E0B\u62C9\u5217\u8868-->\r\n                  <farris-combo-list [(ngModel)]=\"curDataFieldValue\" name=\"referObject\" [panelHeight]=\"200\" [idField]=\"'value'\"\r\n                                     [textField]=\"'text'\" [data]=\"dataFieldAndValues\" (selectChange)='dataFieldChange($event)'>\r\n                  </farris-combo-list>\r\n                  <div class=\"farris-feedback valid-feedback\"></div>\r\n                </div>\r\n                <div style=\"width: 7.5%\"></div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"col-12 farris-group-auto my-4\" *ngIf=\"conditionFields && conditionFields.length > 0\">\r\n            <div class=\"farris-group-wrap\">\r\n              <div class=\"form-group farris-form-group\" style=\"margin-top: -17px; margin-bottom: -22px\">\r\n                <label class=\"col-form-label\" style=\"width: 14%\">\r\n                  <span class=\"farris-label-text\" style=\"color: rgb(180,180,180)\">{{'component.matrixPerformer.conditionFields'|wfLocale}}</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap\" style=\"width: 77.5%\">\r\n                  <hr size=\"3px\">\r\n                </div>\r\n                <div style=\"width: 7.5%\"></div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"col-12 farris-group-auto my-4\" *ngIf=\"conditionFields && conditionFields.length > 0\">\r\n            <div class=\"farris-group-wrap\">\r\n              <div class=\"form-group farris-form-group\">\r\n                <label class=\"col-form-label\" style=\"width: 14%\">\r\n                  <span class=\"farris-label-text\">{{conditionFields[0].alias}}</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap\" style=\"width: 60%\" *ngIf=\"conditionFields[0].inputType === 'help' && !condition1ExprAble\">\r\n                  <input-group name=\"condition1\" [editable]=\"false\" [customCls]=\"'custom-cls'\" [groupText]=\"groupIcon2\" [(ngModel)]=\"condition1Text\" (clickHandle)=\"onHelpSearch($event,0,conditionFields[0].id)\"></input-group>\r\n                </div>\r\n                <div class=\"farris-input-wrap\" style=\"width: 60%\" *ngIf=\"conditionFields[0].inputType === 'enum' && !condition1ExprAble\">\r\n                  <input-group name=\"condition1\" [editable]=\"false\" [customCls]=\"'custom-cls'\" [groupText]=\"groupIcon2\" [(ngModel)]=\"condition1Text\" (clickHandle)=\"openEnumValue(0,conditionFields[0].id)\"></input-group>\r\n                </div>\r\n                <div class=\"farris-input-wrap\" style=\"width: 60%\" *ngIf=\"condition1ExprAble\">\r\n                  <input-group name=\"condition1\" [editable]=\"false\" [customCls]=\"'custom-cls'\" [groupText]=\"groupIcon2\"\r\n                               [(ngModel)]=\"condition1Text\" (clickHandle)=\"condition1Expr('condition1')\">\r\n                  </input-group>\r\n                </div>\r\n                <farris-checkboxgroup style=\"width: 10%; padding-left: 5px\" [(ngModel)]=\"condition1\" name=\"Expr1Able\" [horizontal]=\"true\"\r\n                                      [data]=\"exprGroup\" (changeValue)=\"condition1ExprClick()\">\r\n                </farris-checkboxgroup>\r\n                <farris-checkboxgroup style=\"width: 10%\" [(ngModel)]=\"MultivalueOption1\" name=\"Expr1Mul\" [horizontal]=\"true\" [disable]=\"!condition1ExprAble\"\r\n                [data]=\"mulGroup\" (changeValue)=\"condition1MulClick()\">\r\n                </farris-checkboxgroup>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"col-12 farris-group-auto my-4\" *ngIf=\"conditionFields && conditionFields.length > 1\">\r\n            <div class=\"farris-group-wrap\">\r\n              <div class=\"form-group farris-form-group\">\r\n                <label class=\"col-form-label\" style=\"width: 14%\">\r\n                  <span class=\"farris-label-text\">{{conditionFields[1].alias}}</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap\" style=\"width: 60%\" *ngIf=\"conditionFields[1].inputType === 'help' && !condition2ExprAble\">\r\n                  <input-group name=\"condition2\" [editable]=\"false\" [customCls]=\"'custom-cls'\" [groupText]=\"groupIcon2\" [(ngModel)]=\"condition2Text\" (clickHandle)=\"onHelpSearch($event,1,conditionFields[1].id)\"></input-group>\r\n                </div>\r\n                <div class=\"farris-input-wrap\" style=\"width: 60%\" *ngIf=\"conditionFields[1].inputType === 'enum' && !condition2ExprAble\">\r\n                  <input-group name=\"condition2\" [editable]=\"false\" [customCls]=\"'custom-cls'\" [groupText]=\"groupIcon2\" [(ngModel)]=\"condition2Text\" (clickHandle)=\"openEnumValue(1,conditionFields[1].id)\"></input-group>\r\n                </div>\r\n                <div class=\"farris-input-wrap\" style=\"width: 60%\" *ngIf=\"condition2ExprAble\">\r\n                  <input-group name=\"condition2\" [editable]=\"false\" [customCls]=\"'custom-cls'\" [groupText]=\"groupIcon2\"\r\n                               [(ngModel)]=\"condition2Text\" (clickHandle)=\"condition2Expr('condition2')\">\r\n                  </input-group>\r\n                </div>\r\n                <farris-checkboxgroup style=\"width: 10%; padding-left: 5px\" [(ngModel)]=\"condition2\" name=\"Expr2Able\" [horizontal]=\"true\"\r\n                                      [data]=\"exprGroup\" (changeValue)=\"condition2ExprClick()\">\r\n                </farris-checkboxgroup>\r\n                <farris-checkboxgroup style=\"width: 10%\" [(ngModel)]=\"MultivalueOption2\" name=\"Expr2Mul\" [horizontal]=\"true\" [disable]=\"!condition2ExprAble\"\r\n                [data]=\"mulGroup\" (changeValue)=\"condition2MulClick()\">\r\n                </farris-checkboxgroup>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"col-12 farris-group-auto my-4\" *ngIf=\"conditionFields && conditionFields.length > 2\">\r\n            <div class=\"farris-group-wrap\">\r\n              <div class=\"form-group farris-form-group\">\r\n                <label class=\"col-form-label\" style=\"width: 14%\">\r\n                  <span class=\"farris-label-text\">{{conditionFields[2].alias}}</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap\" style=\"width: 60%\" *ngIf=\"conditionFields[2].inputType === 'help' && !condition3ExprAble\">\r\n                  <input-group name=\"condition3\" [editable]=\"false\" [customCls]=\"'custom-cls'\" [groupText]=\"groupIcon2\" [(ngModel)]=\"condition3Text\" (clickHandle)=\"onHelpSearch($event,2,conditionFields[2].id)\"></input-group>\r\n                </div>\r\n                <div class=\"farris-input-wrap\" style=\"width: 60%\" *ngIf=\"conditionFields[2].inputType === 'enum' && !condition3ExprAble\">\r\n                  <input-group name=\"condition3\" [editable]=\"false\" [customCls]=\"'custom-cls'\" [groupText]=\"groupIcon2\" [(ngModel)]=\"condition3Text\" (clickHandle)=\"openEnumValue(2,conditionFields[2].id)\"></input-group>\r\n                </div>\r\n                <div class=\"farris-input-wrap\" style=\"width: 60%\" *ngIf=\"condition3ExprAble\">\r\n                  <input-group name=\"condition3\" [editable]=\"false\" [customCls]=\"'custom-cls'\" [groupText]=\"groupIcon2\"\r\n                               [(ngModel)]=\"condition3Text\" (clickHandle)=\"condition3Expr('condition3')\">\r\n                  </input-group>\r\n                </div>\r\n                <farris-checkboxgroup style=\"width: 10%; padding-left: 5px\" [(ngModel)]=\"condition3\" name=\"Expr3Able\" [horizontal]=\"true\"\r\n                                      [data]=\"exprGroup\" (changeValue)=\"condition3ExprClick()\">\r\n                </farris-checkboxgroup>\r\n                <farris-checkboxgroup style=\"width: 10%\" [(ngModel)]=\"MultivalueOption3\" name=\"Expr3Mul\" [horizontal]=\"true\" [disable]=\"!condition3ExprAble\"\r\n                [data]=\"mulGroup\" (changeValue)=\"condition3MulClick()\">\r\n                </farris-checkboxgroup>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div class=\"d-flex flex-column\">\r\n        <div class=\"farris-form form-inline farris-form-inline mr-5\">\r\n          <div class=\"col-12 farris-group-auto my-4\">\r\n            <div class=\"farris-group-wrap\">\r\n              <div class=\"form-group farris-form-group\">\r\n                <label class=\"col-form-label\">\r\n                  <span class=\"farris-label-text\">{{'component.matrixPerformer.condition'|wfLocale}}</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap\">\r\n                  <div class=\"input-group\">\r\n                    <input type=\"text\" class=\"form-control\" [(ngModel)]=\"curMatrixDataEntity.condition\" name=\"conditon\" [readOnly]=\"true\" />\r\n                    <div class=\"input-group-append\">\r\n                      <span class=\"input-group-text\" (click)=\"editCondition()\" style=\"background: #FFF;\">\r\n                        <i class=\"f-icon f-icon-lookup\"></i>\r\n                      </span>\r\n                    </div>\r\n                  </div>\r\n                  <div class=\"farris-feedback valid-feedback\"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </form>\r\n</div>\r\n</div>\r\n\r\n<farris-lookup-grid style=\"display: none;\" #lookup [(ngModel)]=\"value\" name=\"value\" [helpId]=\"helpId\"\r\n  [singleSelect]=\"true\" [uri]=\"'assets/data/tree-list-help.json'\" (selectedData)=\"selectedDataHandler($event)\"\r\n  [dictPicked]=\"dictHelpPicked\" [enableCascade]=\"false\">\r\n</farris-lookup-grid>\r\n",
                    providers: [
                        { provide: ServerSideToken, useClass: LookupDataService },
                        WfLocalePipe,
                    ],
                    styles: [""]
                }] }
    ];
    /** @nocollapse */
    MatrixPerformerComponent.ctorParameters = function () { return [
        { type: HttpService },
        { type: ProcessDesignerUIState },
        { type: ExpressionService },
        { type: BsModalService },
        { type: ComponentFactoryResolver },
        { type: Injector },
        { type: MatrixDefHelpService },
        { type: ChangeDetectorRef, decorators: [{ type: Optional }] },
        { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
        { type: undefined, decorators: [{ type: Inject, args: [WF_LANG_RESOURCES,] }] },
        { type: WfLocalePipe, decorators: [{ type: Optional }] }
    ]; };
    MatrixPerformerComponent.propDecorators = {
        cls: [{ type: HostBinding, args: ['class',] }],
        setMatrixDataEntity: [{ type: Input }],
        lookUp: [{ type: ViewChild, args: ['lookup',] }]
    };
    return MatrixPerformerComponent;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var ActivityExecutorParticipant = /** @class */ (function (_super) {
    __extends(ActivityExecutorParticipant, _super);
    function ActivityExecutorParticipant(id, name, type) {
        return _super.call(this, id, name, type) || this;
    }
    return ActivityExecutorParticipant;
}(PerformerEntity));

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var ActivityExecutorPerformerComponent = /** @class */ (function () {
    function ActivityExecutorPerformerComponent(ngZone, designerUIState, expr, cdr, localeId, resources, localePipe) {
        this.ngZone = ngZone;
        this.designerUIState = designerUIState;
        this.expr = expr;
        this.cdr = cdr;
        this.localeId = localeId;
        this.resources = resources;
        this.localePipe = localePipe;
        this.cls = 'd-flex flex-fill h-100';
        this.showClearButton = false;
        this.activityExecutors = [];
        this.cols = [
            { title: this.localePipe.transform('component.activityExecutor.name'), field: 'Name', width: 60 },
            { title: 'ID', field: 'Id', width: 90 }
        ];
        this.localePipe = this.localePipe || new WfLocalePipe(localeId, resources);
    }
    /**
     * @return {?}
     */
    ActivityExecutorPerformerComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
    };
    /**
     * @return {?}
     */
    ActivityExecutorPerformerComponent.prototype.ngAfterViewInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.ngZone.runOutsideAngular((/**
         * @return {?}
         */
        function () {
            _this.inputGroup.nativeElement.addEventListener('mouseenter', _this.onMouseEnter.bind(_this));
            _this.inputGroup.nativeElement.addEventListener('mouseleave', _this.onMouseLeave.bind(_this));
        }));
    };
    /**
     * @param {?} event
     * @return {?}
     */
    ActivityExecutorPerformerComponent.prototype.onMouseEnter = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        this.showClearButton = true;
        if (this.showClearButton) {
            this.toggleClearIcon(event, true);
        }
    };
    /**
     * @param {?} event
     * @return {?}
     */
    ActivityExecutorPerformerComponent.prototype.onMouseLeave = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        this.showClearButton = false;
        this.toggleClearIcon(event, false);
    };
    /**
     * @private
     * @param {?} event
     * @param {?=} isShow
     * @return {?}
     */
    ActivityExecutorPerformerComponent.prototype.toggleClearIcon = /**
     * @private
     * @param {?} event
     * @param {?=} isShow
     * @return {?}
     */
    function (event, isShow) {
        if (isShow === void 0) { isShow = false; }
        /** @type {?} */
        var str = isShow ? '' : 'none';
        /** @type {?} */
        var clearIcon = event.target.querySelector('.input-group-clear');
        if (clearIcon) {
            clearIcon.style.display = str;
        }
    };
    /**
     * @param {?} data
     * @return {?}
     */
    ActivityExecutorPerformerComponent.prototype.clear = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        this.activityExecutors = [];
    };
    /**
     * @param {?} data
     * @return {?}
     */
    ActivityExecutorPerformerComponent.prototype.selectUsers = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        var e_1, _a;
        // 已办用户
        /** @type {?} */
        var selectedUser = [];
        if (this.activityExecutors && this.activityExecutors.length > 0) {
            try {
                for (var _b = __values(this.activityExecutors), _c = _b.next(); !_c.done; _c = _b.next()) {
                    var handler = _c.value;
                    /** @type {?} */
                    var data_1 = {
                        data: {
                            Id: handler.activityDefId,
                            Name: handler.activityDefName
                        },
                        id: handler.activityDefId
                    };
                    selectedUser.push(data_1);
                }
            }
            catch (e_1_1) { e_1 = { error: e_1_1 }; }
            finally {
                try {
                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                }
                finally { if (e_1) throw e_1.error; }
            }
        }
        this.allActivityTable.setCurrentPagerData(selectedUser);
        this.allActivityDialog.show();
    };
    /**
     * @return {?}
     */
    ActivityExecutorPerformerComponent.prototype.editConditon = /**
     * @return {?}
     */
    function () {
        var _this = this;
        var e_2, _a, e_3, _b, e_4, _c, e_5, _d;
        // this.expr.clearContext();
        if (this.designerUIState.schemas.length > 0) {
            try {
                for (var _e = __values(this.designerUIState.schemas), _f = _e.next(); !_f.done; _f = _e.next()) {
                    var schema = _f.value;
                    this.expr.addSchema('Schema', schema);
                }
            }
            catch (e_2_1) { e_2 = { error: e_2_1 }; }
            finally {
                try {
                    if (_f && !_f.done && (_a = _e.return)) _a.call(_e);
                }
                finally { if (e_2) throw e_2.error; }
            }
            if (this.designerUIState.schemas[0].entityTypes && this.designerUIState.schemas[0].entityTypes.length > 0) {
                /** @type {?} */
                var entityType = this.designerUIState.schemas[0].entityTypes[0];
                this.expr.addInjectedEntity(entityType.name, 'Schema', entityType.name, InjectedType.EntityType);
            }
        }
        /** @type {?} */
        var context = new Array();
        context = this.designerUIState.addContext(context);
        if (this.designerUIState.subActivityContext.length > 0) {
            var _loop_1 = function (variable) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    context.push(variable);
                }
            };
            try {
                for (var _g = __values(this.designerUIState.subActivityContext), _h = _g.next(); !_h.done; _h = _g.next()) {
                    var variable = _h.value;
                    _loop_1(variable);
                }
            }
            catch (e_3_1) { e_3 = { error: e_3_1 }; }
            finally {
                try {
                    if (_h && !_h.done && (_b = _g.return)) _b.call(_g);
                }
                finally { if (e_3) throw e_3.error; }
            }
        }
        if (this.designerUIState.activityComponentContext.length > 0) {
            var _loop_2 = function (variable) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    context.push(variable);
                }
            };
            try {
                for (var _j = __values(this.designerUIState.activityComponentContext), _k = _j.next(); !_k.done; _k = _j.next()) {
                    var variable = _k.value;
                    _loop_2(variable);
                }
            }
            catch (e_4_1) { e_4 = { error: e_4_1 }; }
            finally {
                try {
                    if (_k && !_k.done && (_c = _j.return)) _c.call(_j);
                }
                finally { if (e_4) throw e_4.error; }
            }
        }
        if (context.length > 0) {
            try {
                for (var context_1 = __values(context), context_1_1 = context_1.next(); !context_1_1.done; context_1_1 = context_1.next()) {
                    var v = context_1_1.value;
                    this.expr.addContext(v);
                }
            }
            catch (e_5_1) { e_5 = { error: e_5_1 }; }
            finally {
                try {
                    if (context_1_1 && !context_1_1.done && (_d = context_1.return)) _d.call(context_1);
                }
                finally { if (e_5) throw e_5.error; }
            }
        }
        this.expr.setEditPattern(ExprEditMode.Conditional); // 表达式展现模式：默认简易版
        this.expr.addExpressionText(this.condition);
        this.expr.buildExpression().then((/**
         * @param {?} expressioninfo
         * @return {?}
         */
        function (expressioninfo) {
            _this.condition = expressioninfo;
            //点击确定后，去除表达式里面的新增的上下文变量
            if (context.length > 0) {
                _this.expr.exprEntity.contextEntities = _this.expr.exprEntity.contextEntities.filter((/**
                 * @param {?} x
                 * @return {?}
                 */
                function (x) { return !context.some((/**
                 * @param {?} y
                 * @return {?}
                 */
                function (y) { return y.key === x.key; })); }));
            }
        }));
    };
    /**
     * @return {?}
     */
    ActivityExecutorPerformerComponent.prototype.activitiesSelect = /**
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var selectedActivities = this.allActivityTable.checkeds;
        this.activityExecutors = selectedActivities.map((/**
         * @param {?} activity
         * @return {?}
         */
        function (activity) {
            /** @type {?} */
            var handler = new ActivityExecutorParticipant(activity.data.Id, activity.data.Name, 'wf.ActivityExecutorParticipantExpression');
            handler.performerName = '<' + activity.data.Name + _this.localePipe.transform('component.activityExecutor.eventHandler');
            handler.activityDefId = activity.data.Id;
            handler.activityDefName = activity.data.Name;
            handler.condition = _this.condition;
            return handler;
        }));
        this.allActivityDialog.close();
    };
    /**
     * @return {?}
     */
    ActivityExecutorPerformerComponent.prototype.getPerformers = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.activityExecutors.map((/**
         * @param {?} x
         * @return {?}
         */
        function (x) { return x.condition = _this.condition; }));
        return this.activityExecutors;
    };
    ActivityExecutorPerformerComponent.decorators = [
        { type: Component, args: [{
                    selector: 'app-activity-handler-performer',
                    template: "<div class=\"d-flex flex-fill farris-overflow-y-auto p-md-2\" style=\"background: #FFF;\">\r\n  <div class=\"d-flex flex-fill farris-overflow-y-auto mx-3 my-2\" style=\"border-radius:16px;border: 1.5px solid #F1F3F7;\">\r\n  <form style=\"width: 100%;\" >\r\n    <div class=\"d-flex m-2 flex-column w-100\">\r\n      <div class=\"d-flex flex-column\">\r\n        <div class=\"farris-form form-inline  farris-form-inline mr-5 my-2\">\r\n          <div class=\"col-12 farris-group-auto my-4\">\r\n            <div class=\"farris-group-wrap\">\r\n              <div class=\"form-group farris-form-group\">\r\n                <label class=\"col-form-label\">\r\n                  <span class=\"farris-label-info text-danger\">*</span>\r\n                  <span class=\"farris-label-text\">{{'component.activityExecutor.nodeName'|wfLocale}}</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap\">\r\n                  <div #inputGroup class=\"input-group\">\r\n                    <input type=\"text\" class=\"form-control\" [value]=\"activityExecutors | activityExecutor \" name=\"users\" [readOnly]=\"true\" />\r\n                    <div class=\"input-group-append\">\r\n                      <span [style.display]=\"showClearButton ? '' : 'none'\" class=\"input-group-text input-group-clear\"\r\n                            (click)=\"clear($event)\">\r\n                        <i class=\"f-icon modal_close\"></i>\r\n                      </span>\r\n                      <span class=\"input-group-text\" (click)=\"selectUsers($event)\" style=\"background: #FFF;\">\r\n                        <i class=\"f-icon f-icon-lookup\"></i>\r\n                      </span>\r\n                    </div>\r\n                  </div>\r\n                  <div class=\"farris-feedback valid-feedback\"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div class=\"d-flex flex-column\">\r\n        <div class=\"farris-form form-inline farris-form-inline mr-5\">\r\n          <div class=\"col-12 farris-group-auto my-4\">\r\n            <div class=\"farris-group-wrap\">\r\n              <div class=\"form-group farris-form-group\">\r\n                <label class=\"col-form-label\">\r\n                  <span class=\"farris-label-text\">{{'component.activityExecutor.enablingConditions'|wfLocale}}</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap\">\r\n                  <div class=\"input-group\">\r\n                    <input type=\"text\" class=\"form-control\" [(ngModel)]=\"condition\" name=\"conditon\" [readOnly]=\"true\" />\r\n                    <div class=\"input-group-append\">\r\n                      <span class=\"input-group-text\" (click)=\"editConditon()\" style=\"background: #FFF;\">\r\n                        <i class=\"f-icon f-icon-lookup\"></i>\r\n                      </span>\r\n                    </div>\r\n                  </div>\r\n                  <div class=\"farris-feedback valid-feedback\"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </form>\r\n</div>\r\n</div>\r\n\r\n<farris-dialog #allActivityDialog [buttons]=\"buttonRef\" [width]=\"700\" [height]=\"520\" title=\"{{'component.activityExecutor.activityList'|wfLocale}}\">\r\n  <div class=\"f-utils-fill-flex-column farris-overflow-y-auto h-100 m-2\">\r\n    <farris-datagrid #allActivityTable [columns]=\"cols\" [data]=\"designerUIState.userActList\"  [idField]=\"'Id'\" [fit]=\"true\"\r\n                     [fitColumns]=\"true\" [pagination]='false' [multiSelect]=\"true\" [showCheckbox]=\"true\"\r\n                     [checkOnSelect]=\"true\" [selectOnCheck]=\"true\">\r\n    </farris-datagrid>\r\n  </div>\r\n</farris-dialog>\r\n<ng-template #buttonRef>\r\n  <button class=\"btn btn-sm btn-default\" (click)=\"allActivityDialog.close()\">{{'component.activityExecutor.clickCancel'|wfLocale}}</button>\r\n  <button class=\"btn btn-sm btn-primary mx-2\" (click)=\"activitiesSelect()\">{{'component.activityExecutor.clickOK'|wfLocale}}</button>\r\n</ng-template>\r\n",
                    providers: [
                        WfLocalePipe,
                    ],
                    styles: [""]
                }] }
    ];
    /** @nocollapse */
    ActivityExecutorPerformerComponent.ctorParameters = function () { return [
        { type: NgZone },
        { type: ProcessDesignerUIState },
        { type: ExpressionService },
        { type: ChangeDetectorRef, decorators: [{ type: Optional }] },
        { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
        { type: undefined, decorators: [{ type: Inject, args: [WF_LANG_RESOURCES,] }] },
        { type: WfLocalePipe, decorators: [{ type: Optional }] }
    ]; };
    ActivityExecutorPerformerComponent.propDecorators = {
        cls: [{ type: HostBinding, args: ['class',] }],
        inputGroup: [{ type: ViewChild, args: ['inputGroup',] }],
        allActivityDialog: [{ type: ViewChild, args: ['allActivityDialog',] }],
        allActivityTable: [{ type: ViewChild, args: ['allActivityTable',] }]
    };
    return ActivityExecutorPerformerComponent;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var OrganizationParticipantExpression$1 = /** @class */ (function () {
    function OrganizationParticipantExpression$$1() {
    }
    return OrganizationParticipantExpression$$1;
}());
/** @enum {string} */
var ActionScope$1 = {
    /**
     * 指派
     */
    AssignUser: 'AssignUser',
    /**
     * 移交
     */
    Transfer: 'Transfer',
    /**
     * 征询
     */
    AddSignFront: 'AddSignFront',
    /**
     * 加签
     */
    AddSignBehind: 'AddSignBehind',
    /**
     * 知会
     */
    Notify: "Notify",
};
/** @enum {string} */
var OrganizationLevel$1 = {
    /**
     * 部门
     */
    DEPARTMENT: 'DEPARTMENT',
    /**
     * 单位
     */
    UNIT: 'UNIT',
    /**
    * 默认值
    */
    DEFAULT: 'DEFAULT',
    VARORGANIZATION: 'VARORGANIZATION',
};

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var VariablePerformerEntity = /** @class */ (function (_super) {
    __extends(VariablePerformerEntity, _super);
    function VariablePerformerEntity(id, name, type) {
        return _super.call(this, id, name, type) || this;
    }
    return VariablePerformerEntity;
}(PerformerEntity));

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var VariablePerformerComponent = /** @class */ (function () {
    function VariablePerformerComponent(designerUIState, expr, ngZone, cdr, localeId, resources, localePipe, http, message) {
        this.designerUIState = designerUIState;
        this.expr = expr;
        this.ngZone = ngZone;
        this.cdr = cdr;
        this.localeId = localeId;
        this.resources = resources;
        this.localePipe = localePipe;
        this.http = http;
        this.message = message;
        this.cls = 'd-flex flex-fill h-100';
        this.showClearButton = false;
        this.editState = true;
        this.bindingData = {};
        this.inSuiteField = [];
        this.variableOrgTypes = [
            { name: this.localePipe.transform('component.variablePerformer.sys'), value: 'Sys' },
            { name: this.localePipe.transform('component.variablePerformer.administrative_staff'), value: 'Administrative_staff' },
        ];
        this.userTypeButtonNeedShow = false;
        this.personnelRelationShipTypes = [
            { name: this.localePipe.transform('component.variablePerformer.oneself'), value: 'oneself' },
        ];
        this.curOrgType = this.variableOrgTypes[0].value;
        this.relationShipType = this.designerUIState.scene !== 'inSuite' ? this.personnelRelationShipTypes[0].value : null;
        this.scene = this.designerUIState.scene;
        this.users = [];
        this.user = new VariablePerformerEntity();
        this.localePipe = this.localePipe || new WfLocalePipe(localeId, resources);
    }
    /**
     * @return {?}
     */
    VariablePerformerComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var url = '/api/runtime/wf/v1.0/reportingOrgType/hasAdminOrg';
        this.http.get(url).subscribe((/**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            _this.userTypeButtonNeedShow = data;
            if (_this.designerUIState.scene === 'inSuite') {
                _this.userTypeButtonNeedShow = true;
                _this.variableOrgTypes = [
                    { name: _this.localePipe.transform('component.variablePerformer.sys'), value: 'Sys' },
                    { name: _this.localePipe.transform('component.variablePerformer.administrative_staff'), value: 'Administrative_staff' },
                    { name: _this.localePipe.transform('component.variablePerformer.administrative_organization'), value: 'Administrative_organization' }
                ];
                _this.getInSuiteField(_this.user.varType ? _this.user.varType : 'Sys');
            }
        }));
    };
    /**
     * @return {?}
     */
    VariablePerformerComponent.prototype.ngAfterViewInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.ngZone.runOutsideAngular((/**
         * @return {?}
         */
        function () {
            _this.inputGroup.nativeElement.addEventListener('mouseenter', _this.onMouseEnter.bind(_this));
            _this.inputGroup.nativeElement.addEventListener('mouseleave', _this.onMouseLeave.bind(_this));
        }));
    };
    /**
     * @param {?} event
     * @return {?}
     */
    VariablePerformerComponent.prototype.onMouseEnter = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        this.showClearButton = true;
        if (this.showClearButton) {
            this.toggleClearIcon(event, true);
        }
    };
    /**
     * @param {?} event
     * @return {?}
     */
    VariablePerformerComponent.prototype.onMouseLeave = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        this.showClearButton = false;
        this.toggleClearIcon(event, false);
    };
    /**
     * @private
     * @param {?} event
     * @param {?=} isShow
     * @return {?}
     */
    VariablePerformerComponent.prototype.toggleClearIcon = /**
     * @private
     * @param {?} event
     * @param {?=} isShow
     * @return {?}
     */
    function (event, isShow) {
        if (isShow === void 0) { isShow = false; }
        /** @type {?} */
        var str = isShow ? '' : 'none';
        /** @type {?} */
        var clearIcon = event.target.querySelector('.input-group-clear');
        if (clearIcon) {
            clearIcon.style.display = str;
        }
    };
    /**
     * @param {?} data
     * @return {?}
     */
    VariablePerformerComponent.prototype.clear = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        // 流程变量表达式编辑器清空
        this.bindingData = {};
        this.users = [];
        this.user = null;
        this.variableOrgTypes = [
            { name: this.localePipe.transform('component.variablePerformer.sys'), value: 'Sys' },
            { name: this.localePipe.transform('component.variablePerformer.administrative_staff'), value: 'Administrative_staff' },
        ];
        if (this.designerUIState.scene === 'inSuite') {
            this.variableOrgTypes = [
                { name: this.localePipe.transform('component.variablePerformer.sys'), value: 'Sys' },
                { name: this.localePipe.transform('component.variablePerformer.administrative_staff'), value: 'Administrative_staff' },
                { name: this.localePipe.transform('component.variablePerformer.administrative_organization'), value: 'Administrative_organization' }
            ];
        }
    };
    /**
     * @param {?} data
     * @return {?}
     */
    VariablePerformerComponent.prototype.selectUsers = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        this.showExprHelp();
    };
    /**
     * @return {?}
     */
    VariablePerformerComponent.prototype.editConditon = /**
     * @return {?}
     */
    function () {
        var _this = this;
        var e_1, _a, e_2, _b, e_3, _c, e_4, _d;
        // this.expr.clearContext();
        if (this.designerUIState.schemas.length > 0) {
            try {
                for (var _e = __values(this.designerUIState.schemas), _f = _e.next(); !_f.done; _f = _e.next()) {
                    var schema = _f.value;
                    this.expr.addSchema('Schema', schema);
                }
            }
            catch (e_1_1) { e_1 = { error: e_1_1 }; }
            finally {
                try {
                    if (_f && !_f.done && (_a = _e.return)) _a.call(_e);
                }
                finally { if (e_1) throw e_1.error; }
            }
            if (this.designerUIState.schemas[0].entityTypes && this.designerUIState.schemas[0].entityTypes.length > 0) {
                /** @type {?} */
                var entityType = this.designerUIState.schemas[0].entityTypes[0];
                this.expr.addInjectedEntity(entityType.name, 'Schema', entityType.name, InjectedType.EntityType);
            }
        }
        /** @type {?} */
        var context = new Array();
        context = this.designerUIState.addContext(context);
        if (this.designerUIState.subActivityContext.length > 0) {
            var _loop_1 = function (variable) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    context.push(variable);
                }
            };
            try {
                for (var _g = __values(this.designerUIState.subActivityContext), _h = _g.next(); !_h.done; _h = _g.next()) {
                    var variable = _h.value;
                    _loop_1(variable);
                }
            }
            catch (e_2_1) { e_2 = { error: e_2_1 }; }
            finally {
                try {
                    if (_h && !_h.done && (_b = _g.return)) _b.call(_g);
                }
                finally { if (e_2) throw e_2.error; }
            }
        }
        if (this.designerUIState.activityComponentContext.length > 0) {
            var _loop_2 = function (variable) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    context.push(variable);
                }
            };
            try {
                for (var _j = __values(this.designerUIState.activityComponentContext), _k = _j.next(); !_k.done; _k = _j.next()) {
                    var variable = _k.value;
                    _loop_2(variable);
                }
            }
            catch (e_3_1) { e_3 = { error: e_3_1 }; }
            finally {
                try {
                    if (_k && !_k.done && (_c = _j.return)) _c.call(_j);
                }
                finally { if (e_3) throw e_3.error; }
            }
        }
        if (context.length > 0) {
            try {
                for (var context_1 = __values(context), context_1_1 = context_1.next(); !context_1_1.done; context_1_1 = context_1.next()) {
                    var v = context_1_1.value;
                    this.expr.addContext(v);
                }
            }
            catch (e_4_1) { e_4 = { error: e_4_1 }; }
            finally {
                try {
                    if (context_1_1 && !context_1_1.done && (_d = context_1.return)) _d.call(context_1);
                }
                finally { if (e_4) throw e_4.error; }
            }
        }
        this.expr.setEditPattern(ExprEditMode.Conditional); // 表达式展现模式：默认简易版
        this.expr.addExpressionText(this.condition);
        this.expr.buildExpression().then((/**
         * @param {?} expressioninfo
         * @return {?}
         */
        function (expressioninfo) {
            _this.condition = expressioninfo;
            //点击确定后，去除表达式里面的新增的上下文变量
            if (context.length > 0) {
                _this.expr.exprEntity.contextEntities = _this.expr.exprEntity.contextEntities.filter((/**
                 * @param {?} x
                 * @return {?}
                 */
                function (x) { return !context.some((/**
                 * @param {?} y
                 * @return {?}
                 */
                function (y) { return y.key === x.key; })); }));
            }
        }));
    };
    /**
     * @return {?}
     */
    VariablePerformerComponent.prototype.showExprHelp = /**
     * @return {?}
     */
    function () {
        var _this = this;
        var e_5, _a, e_6, _b, e_7, _c, e_8, _d, e_9, _e;
        // this.expr.clearContext();
        this.expr.setEditPattern(ExprEditMode.Advanced);
        if (this.designerUIState.schemas.length > 0) {
            try {
                for (var _f = __values(this.designerUIState.schemas), _g = _f.next(); !_g.done; _g = _f.next()) {
                    var schema = _g.value;
                    this.expr.addSchema('Schema', schema);
                }
            }
            catch (e_5_1) { e_5 = { error: e_5_1 }; }
            finally {
                try {
                    if (_g && !_g.done && (_a = _f.return)) _a.call(_f);
                }
                finally { if (e_5) throw e_5.error; }
            }
            if (this.designerUIState.schemas[0].entityTypes && this.designerUIState.schemas[0].entityTypes.length > 0) {
                /** @type {?} */
                var entityType = this.designerUIState.schemas[0].entityTypes[0];
                this.expr.addInjectedEntity(entityType.name, 'Schema', entityType.name, InjectedType.EntityType);
            }
        }
        /** @type {?} */
        var context = new Array();
        if (this.designerUIState.participantContext.length > 0) {
            try {
                for (var _h = __values(this.designerUIState.participantContext), _j = _h.next(); !_j.done; _j = _h.next()) {
                    var variable = _j.value;
                    context.push(variable);
                }
            }
            catch (e_6_1) { e_6 = { error: e_6_1 }; }
            finally {
                try {
                    if (_j && !_j.done && (_b = _h.return)) _b.call(_h);
                }
                finally { if (e_6) throw e_6.error; }
            }
        }
        if (this.designerUIState.subActivityContext.length > 0) {
            var _loop_3 = function (variable) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    context.push(variable);
                }
            };
            try {
                for (var _k = __values(this.designerUIState.subActivityContext), _l = _k.next(); !_l.done; _l = _k.next()) {
                    var variable = _l.value;
                    _loop_3(variable);
                }
            }
            catch (e_7_1) { e_7 = { error: e_7_1 }; }
            finally {
                try {
                    if (_l && !_l.done && (_c = _k.return)) _c.call(_k);
                }
                finally { if (e_7) throw e_7.error; }
            }
        }
        if (this.designerUIState.processVariableContext.length > 0) {
            var _loop_4 = function (variable) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    context.push(variable);
                }
            };
            try {
                for (var _m = __values(this.designerUIState.processVariableContext), _o = _m.next(); !_o.done; _o = _m.next()) {
                    var variable = _o.value;
                    _loop_4(variable);
                }
            }
            catch (e_8_1) { e_8 = { error: e_8_1 }; }
            finally {
                try {
                    if (_o && !_o.done && (_d = _m.return)) _d.call(_m);
                }
                finally { if (e_8) throw e_8.error; }
            }
        }
        if (context.length > 0) {
            try {
                for (var context_2 = __values(context), context_2_1 = context_2.next(); !context_2_1.done; context_2_1 = context_2.next()) {
                    var v = context_2_1.value;
                    this.expr.addContext(v);
                }
            }
            catch (e_9_1) { e_9 = { error: e_9_1 }; }
            finally {
                try {
                    if (context_2_1 && !context_2_1.done && (_e = context_2.return)) _e.call(context_2);
                }
                finally { if (e_9) throw e_9.error; }
            }
        }
        if (this.users.length > 0) {
            this.expr.addExpressionText(this.users[0].varValue ? this.users[0].varValue : this.users[0].performerId);
        }
        else {
            this.expr.addExpressionText('');
        }
        // 2023-6-13 编辑时表达式编辑器只读
        this.expr.buildExpression().then((/**
         * @param {?} expressioninfo
         * @return {?}
         */
        function (expressioninfo) {
            var e_10, _a;
            if (expressioninfo) {
                /** @type {?} */
                var user = new VariablePerformerEntity(expressioninfo, '', 'wf.VariableParticipantExpression');
                user.tag = 'expression';
                user.performerName = _this.variableParticipantName(expressioninfo);
                user.name = _this.variableParticipantName(expressioninfo);
                user.varType = _this.curOrgType;
                if (_this.designerUIState.scene === 'inSuite') {
                    user.relation = _this.relationShipType;
                }
                else {
                    user.relation = _this.personnelRelationShipTypes[0].value;
                }
                if (_this.variableParticipantName(expressioninfo) === '') {
                    // 如果先勾选行政人员id，再选择上下文变量，则提示并将变量值类型置为1
                    _this.message.info(_this.localePipe.transform('component.variablePerformer.cantUseContext'));
                    _this.curOrgType = _this.variableOrgTypes[0].value;
                }
                else {
                    _this.users = [user];
                    _this.user = user;
                }
                try {
                    for (var _b = __values(_this.designerUIState.participantContext), _c = _b.next(); !_c.done; _c = _b.next()) {
                        var c = _c.value;
                        // 根据表达式中的函数名判断是否使用的是上下文变量,除三种特殊上下文变量其余放开限制
                        if (user.performerId.indexOf(c.key) >= 0) {
                            _this.variableOrgTypes = [
                                { name: _this.localePipe.transform('component.variablePerformer.sys'), value: 'Sys' }
                            ];
                            break;
                        }
                        else {
                            _this.variableOrgTypes = [
                                { name: _this.localePipe.transform('component.variablePerformer.sys'), value: 'Sys' },
                                { name: _this.localePipe.transform('component.variablePerformer.administrative_staff'), value: 'Administrative_staff' },
                            ];
                            if (_this.designerUIState.scene === 'inSuite') {
                                _this.variableOrgTypes = [
                                    { name: _this.localePipe.transform('component.variablePerformer.sys'), value: 'Sys' },
                                    { name: _this.localePipe.transform('component.variablePerformer.administrative_staff'), value: 'Administrative_staff' },
                                    { name: _this.localePipe.transform('component.variablePerformer.administrative_organization'), value: 'Administrative_organization' }
                                ];
                            }
                        }
                    }
                }
                catch (e_10_1) { e_10 = { error: e_10_1 }; }
                finally {
                    try {
                        if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                    }
                    finally { if (e_10) throw e_10.error; }
                }
            }
            else {
                _this.users = [];
                _this.user = null;
                _this.variableOrgTypes = [
                    { name: _this.localePipe.transform('component.variablePerformer.sys'), value: 'Sys' },
                    { name: _this.localePipe.transform('component.variablePerformer.administrative_staff'), value: 'Administrative_staff' },
                ];
                if (_this.designerUIState.scene === 'inSuite') {
                    _this.variableOrgTypes = [
                        { name: _this.localePipe.transform('component.variablePerformer.sys'), value: 'Sys' },
                        { name: _this.localePipe.transform('component.variablePerformer.administrative_staff'), value: 'Administrative_staff' },
                        { name: _this.localePipe.transform('component.variablePerformer.administrative_organization'), value: 'Administrative_organization' }
                    ];
                }
            }
            //点击确定后，去除表达式里面的新增的上下文变量
            if (context.length > 0) {
                _this.expr.exprEntity.contextEntities = _this.expr.exprEntity.contextEntities.filter((/**
                 * @param {?} x
                 * @return {?}
                 */
                function (x) { return !context.some((/**
                 * @param {?} y
                 * @return {?}
                 */
                function (y) { return y.key === x.key; })); }));
            }
        }));
    };
    /**
     * @return {?}
     */
    VariablePerformerComponent.prototype.getPerformers = /**
     * @return {?}
     */
    function () {
        if (this.user) {
            this.user.varValue = this.user.performerId ? this.user.performerId : this.user.varValue;
            this.user.name = this.user.performerName ? this.user.performerName : this.user.name;
            // this.user.name = this.getRealName(this.user);
            this.user.varType = this.curOrgType;
            this.user.relation = this.relationShipType;
            this.user.condition = this.condition ? this.condition : '';
        }
        return this.user;
    };
    // TODO: 变量参与者选多个值时名称只能显示一个，待调整
    // getRealName(user: any) {
    //   // 2023-6-15 计算是否是多值，排除表达式里自带的一个逗号
    //   let r = user.name;
    //   let id = user.varValue;
    //   let char = ',';
    //   let count = id.split(char).length - 1;
    //   if (count > 1) {
    //     r += ' 等';
    //   }
    //   return r;
    // }
    // TODO: 变量参与者选多个值时名称只能显示一个，待调整
    // getRealName(user: any) {
    //   // 2023-6-15 计算是否是多值，排除表达式里自带的一个逗号
    //   let r = user.name;
    //   let id = user.varValue;
    //   let char = ',';
    //   let count = id.split(char).length - 1;
    //   if (count > 1) {
    //     r += ' 等';
    //   }
    //   return r;
    // }
    /**
     * @private
     * @param {?} expr
     * @return {?}
     */
    VariablePerformerComponent.prototype.variableParticipantName = 
    // TODO: 变量参与者选多个值时名称只能显示一个，待调整
    // getRealName(user: any) {
    //   // 2023-6-15 计算是否是多值，排除表达式里自带的一个逗号
    //   let r = user.name;
    //   let id = user.varValue;
    //   let char = ',';
    //   let count = id.split(char).length - 1;
    //   if (count > 1) {
    //     r += ' 等';
    //   }
    //   return r;
    // }
    /**
     * @private
     * @param {?} expr
     * @return {?}
     */
    function (expr) {
        var e_11, _a, e_12, _b;
        try {
            for (var _c = __values(this.designerUIState.participantContext), _d = _c.next(); !_d.done; _d = _c.next()) {
                var c = _d.value;
                if (expr.indexOf(c.key) > -1) {
                    if (this.curOrgType !== 'Sys') { // 行政人员类型不允许使用上下文变量
                        return '';
                    }
                    return c.name;
                }
            }
        }
        catch (e_11_1) { e_11 = { error: e_11_1 }; }
        finally {
            try {
                if (_d && !_d.done && (_a = _c.return)) _a.call(_c);
            }
            finally { if (e_11) throw e_11.error; }
        }
        try {
            for (var _e = __values(this.designerUIState.processVariableContext), _f = _e.next(); !_f.done; _f = _e.next()) {
                var c = _f.value;
                if (expr.indexOf(c.key) > -1) {
                    return c.name;
                }
            }
        }
        catch (e_12_1) { e_12 = { error: e_12_1 }; }
        finally {
            try {
                if (_f && !_f.done && (_b = _e.return)) _b.call(_e);
            }
            finally { if (e_12) throw e_12.error; }
        }
        return JSON.parse(expr).expr;
    };
    /**
     * @param {?} data
     * @return {?}
     */
    VariablePerformerComponent.prototype.orgTypeChange = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        if (data === 'Sys') {
            this.curOrgType = this.variableOrgTypes[0].value;
        }
        else if (data === 'Administrative_staff') {
            this.curOrgType = this.variableOrgTypes[1].value;
        }
        else {
            this.curOrgType = this.variableOrgTypes[2].value;
        }
        // 如果是inSuite场景需要获取inSuite部门的负责人，分管领导等关系
        if (this.designerUIState.scene === 'inSuite') {
            this.getInSuiteField(data);
            this.relationShipType = null;
        }
        else {
            this.relationShipType = this.personnelRelationShipTypes[0].value;
        }
    };
    /**
     * @param {?} data
     * @return {?}
     */
    VariablePerformerComponent.prototype.enabledStateChange = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        this.relationShipType = data.value;
    };
    /**
     * @param {?} fieldType
     * @return {?}
     */
    VariablePerformerComponent.prototype.getInSuiteField = /**
     * @param {?} fieldType
     * @return {?}
     */
    function (fieldType) {
        var _this = this;
        /** @type {?} */
        var url = "/api/runtime/wf/v1.0/dtProcDefs/getInSuiteFields/" + fieldType;
        this.http.get(url).subscribe((/**
         * @param {?} field
         * @return {?}
         */
        function (field) {
            var e_13, _a;
            _this.inSuiteField = [];
            try {
                for (var field_1 = __values(field), field_1_1 = field_1.next(); !field_1_1.done; field_1_1 = field_1.next()) {
                    var f = field_1_1.value;
                    /** @type {?} */
                    var type = {
                        name: f.field_description,
                        value: f.field
                    };
                    // 清空inSuiteField
                    _this.inSuiteField.push(type);
                }
            }
            catch (e_13_1) { e_13 = { error: e_13_1 }; }
            finally {
                try {
                    if (field_1_1 && !field_1_1.done && (_a = field_1.return)) _a.call(field_1);
                }
                finally { if (e_13) throw e_13.error; }
            }
        }));
    };
    VariablePerformerComponent.decorators = [
        { type: Component, args: [{
                    selector: 'app-variable-performer',
                    template: "<div class=\"d-flex flex-fill farris-overflow-y-auto p-md-2\" style=\"background: #FFF;\">\r\n  <div class=\"d-flex flex-fill farris-overflow-y-auto mx-3 my-2\" style=\"border-radius:16px;border: 1.5px solid #F1F3F7;\">\r\n  <form style=\"width: 100%;\" >\r\n    <div class=\"d-flex m-2 flex-column w-100\">\r\n      <div class=\"d-flex flex-column\">\r\n        <div class=\"farris-form form-inline  farris-form-inline mr-5 my-2\">\r\n          <div class=\"col-12 farris-group-auto my-4\">\r\n            <div class=\"farris-group-wrap\">\r\n              <div class=\"form-group farris-form-group\">\r\n                <label class=\"col-form-label\">\r\n                  <span class=\"farris-label-info text-danger\">*</span>\r\n                  <span class=\"farris-label-text\">{{'component.variablePerformer.processVariables'|wfLocale}}</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap\">\r\n                  <div #inputGroup class=\"input-group\">\r\n                    <input type=\"text\" class=\"form-control\" [value]=\"users | variableName \" name=\"users\" [readOnly]=\"true\" />\r\n                    <div class=\"input-group-append\">\r\n                      <span [style.display]=\"showClearButton ? '' : 'none'\" class=\"input-group-text input-group-clear\"\r\n                        (click)=\"clear($event)\">\r\n                        <i class=\"f-icon modal_close\"></i>\r\n                      </span>\r\n                      <span class=\"input-group-text\" (click)=\"selectUsers($event)\" style=\"background: #FFF;\">\r\n                        <i class=\"f-icon f-icon-lookup\"></i>\r\n                      </span>\r\n                    </div>\r\n                  </div>\r\n                  <div class=\"farris-feedback valid-feedback\"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <ng-container *ngIf=\"userTypeButtonNeedShow\">\r\n            <div class=\"col-12 farris-group-auto my-4\">\r\n              <div class=\"farris-group-wrap\">\r\n                <div class=\"form-group farris-form-group\">\r\n                  <label class=\"col-form-label\">\r\n                    <span class=\"farris-label-info text-danger\">*</span>\r\n                    <span class=\"farris-label-text\">{{'component.variablePerformer.variableOrgTypes'|wfLocale}}</span>\r\n                  </label>\r\n                  <div class=\"farris-input-wrap\">\r\n                    <farris-radiogroup [data]=\"variableOrgTypes\" [horizontal]=\"true\"\r\n                                       [(ngModel)]=\"curOrgType\" name=\"referObject\"\r\n                                       (changeValue)=\"orgTypeChange($event)\"\r\n                    ></farris-radiogroup>\r\n                    <div class=\"farris-feedback valid-feedback\"></div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </ng-container>\r\n            <div class=\"col-12 farris-group-auto my-4\">\r\n            <div class=\"farris-group-wrap\">\r\n              <div class=\"form-group farris-form-group\">\r\n                <label class=\"col-form-label\">\r\n                  <span class=\"farris-label-info text-danger\">*</span>\r\n                  <span class=\"farris-label-text\">{{'component.variablePerformer.relationShipType'|wfLocale}}</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap\">\r\n                  <farris-combo-list [data]=\"scene !== 'inSuite'?personnelRelationShipTypes:inSuiteField\"\r\n                                     [idField]=\"'value'\" [textField]=\"'name'\" [valueField]=\"'value'\" [readonly]=\"scene !== 'inSuite'\"\r\n                                     [(ngModel)]=\"relationShipType\" name=\"relationShipObject\" (valueChange)=\"enabledStateChange($event)\"\r\n                  ></farris-combo-list>\r\n                  <div class=\"farris-feedback valid-feedback\"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div class=\"d-flex flex-column\" style=\"background: #FFF;\">\r\n        <div class=\"farris-form form-inline farris-form-inline mr-5\">\r\n          <div class=\"col-12 farris-group-auto my-4\">\r\n            <div class=\"farris-group-wrap\">\r\n              <div class=\"form-group farris-form-group\">\r\n                <label class=\"col-form-label\">\r\n                  <span class=\"farris-label-text\">{{'component.variablePerformer.condition'|wfLocale}}</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap\">\r\n                  <div class=\"input-group\">\r\n                    <input type=\"text\" class=\"form-control\" [(ngModel)]=\"condition\" name=\"conditon\" [readOnly]=\"true\" />\r\n                    <div class=\"input-group-append\">\r\n                      <span class=\"input-group-text\" (click)=\"editConditon()\" style=\"background: #FFF;\">\r\n                        <i class=\"f-icon f-icon-lookup\"></i>\r\n                      </span>\r\n                    </div>\r\n                  </div>\r\n                  <div class=\"farris-feedback valid-feedback\"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </form>\r\n</div>\r\n</div>\r\n",
                    providers: [
                        WfLocalePipe,
                    ],
                    styles: [""]
                }] }
    ];
    /** @nocollapse */
    VariablePerformerComponent.ctorParameters = function () { return [
        { type: ProcessDesignerUIState },
        { type: ExpressionService },
        { type: NgZone },
        { type: ChangeDetectorRef, decorators: [{ type: Optional }] },
        { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
        { type: undefined, decorators: [{ type: Inject, args: [WF_LANG_RESOURCES,] }] },
        { type: WfLocalePipe, decorators: [{ type: Optional }] },
        { type: HttpService },
        { type: MessagerService }
    ]; };
    VariablePerformerComponent.propDecorators = {
        cls: [{ type: HostBinding, args: ['class',] }],
        inputGroup: [{ type: ViewChild, args: ['inputGroup',] }]
    };
    return VariablePerformerComponent;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var PerformerEditComponent = /** @class */ (function () {
    function PerformerEditComponent(designerUIState, expr, http, localeId, resources, localePipe) {
        this.designerUIState = designerUIState;
        this.expr = expr;
        this.http = http;
        this.localeId = localeId;
        this.resources = resources;
        this.localePipe = localePipe;
        this.cls = 'farris-main-area flex-column';
        this.tab = 'user';
        this.display = true;
        this.organizationLevelCollection = [
            {
                value: 'UNIT',
                text: this.localePipe.transform('component.participant.currentUnit'),
                orgId: 'currentUnit'
            }, {
                value: 'DEPARTMENT',
                text: this.localePipe.transform('component.participant.currentDepartment'),
                orgId: 'currentDepartment'
            }, {
                value: 'VARORGANIZATION',
                text: this.localePipe.transform('component.participant.variableOrganization'),
                orgId: ''
            }
        ];
        this.localePipe = this.localePipe || new WfLocalePipe(localeId, resources);
        this.organizationParticipant = new OrganizationParticipantExpression$1();
        this.organizationParticipant.actionScope = ActionScope$1.AssignUser;
        this.organizationParticipant.organizationLevel = OrganizationLevel$1.DEPARTMENT;
        this.organizationParticipant.organizationId = 'currentDepartment';
        this.organizationParticipant.organizationName = this.localePipe.transform('component.participant.currentDepartment');
        this.organizationParticipant.includeChildren = false;
        this.organizationParticipant.tag = 'variable';
    }
    /**
     * @return {?}
     */
    PerformerEditComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
    };
    /**
     * @return {?}
     */
    PerformerEditComponent.prototype.ngAfterViewInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        if (this.performer) {
            switch (this.performer.type) {
                case 'wf.UserParticipantExpression':
                    this.usersCmp.users = [];
                    this.usersCmp.users.push(this.performer.value);
                    // 2023-5-23 用户参与者支持编辑时单选+显示已选用户；
                    this.usersCmp.multiSelect = this.editState === 'edit' ? false : true;
                    // 考虑到兼容历史数据，暂时不使用用户参与者实体类中的userType属性
                    if (this.performer.value.performerId && this.performer.value.performerId.charAt(0) === '{') {
                        /** @type {?} */
                        var url = '/api/runtime/wf/v1.0/reportingOrgType/hasAdminOrg';
                        this.http.get(url).subscribe((/**
                         * @param {?} data
                         * @return {?}
                         */
                        function (data) {
                            _this.usersCmp.userTypeButtonNeedShow = data;
                            _this.usersCmp.userType = 'variable';
                            _this.usersCmp.curOrgType = _this.performer.value.orgType === 'Sys' ? 'Sys' : 'Administrative_organization';
                            _this.usersCmp.condition = _this.performer.value.condition;
                            // 根据表达式中的函数名判断是否使用的是上下文变量
                            /** @type {?} */
                            var isContextVariable = _this.performer.value.performerId.indexOf('GetContextParameter') >= 0;
                            _this.usersCmp.variableOrgTypes = isContextVariable ? [
                                { name: '系统用户', value: 'Sys' }
                            ] : [
                                { name: '系统用户', value: 'Sys' },
                                { name: '员工', value: 'Administrative_organization' }
                            ];
                        }));
                    }
                    else {
                        this.usersCmp.userType = 'user';
                        this.usersCmp.condition = this.performer.value.condition;
                    }
                    break;
                case 'wf.VariableParticipantExpression':
                    // TODO:参与者只保留一份最好
                    this.varCmp.users = [];
                    this.varCmp.users.push(this.performer.value);
                    this.varCmp.user = this.performer.value;
                    this.varCmp.editState = this.editState === 'edit' ? false : true;
                    // 判断是变量参与者
                    if (this.performer.value.varValue && this.performer.value.varValue.charAt(0) === '{') {
                        // 根据表达式中的函数名判断是否使用的是上下文变量
                        /** @type {?} */
                        var isContextVariable = this.performer.value.varValue.indexOf('GetContextParameter') >= 0;
                        // 上下文变量的变量值类型只有系统用户id
                        this.varCmp.variableOrgTypes = isContextVariable ? [
                            { name: '用户ID', value: 'Sys' }
                        ] : [
                            { name: '用户ID', value: 'Sys' },
                            { name: '员工ID', value: 'Administrative_staff' },
                        ];
                        // 如果是insuite场景还要增加行政组织id
                        this.varCmp.curOrgType = this.performer.value.varType;
                        this.varCmp.relationShipType = this.performer.value.relation;
                        this.varCmp.condition = this.performer.value.condition;
                    }
                    break;
                case 'wf.PositionParticipantExpression':
                    this.posiCmp.editState = this.editState === 'edit' ? false : true;
                    this.posiCmp.position = Object.assign({}, this.performer.value);
                    this.posiCmp.performerName = this.posiCmp.position.performerName;
                    if (this.posiCmp.position.positionType === '0') {
                        this.posiCmp.newFilter = { positionType: '0' };
                    }
                    else {
                        this.posiCmp.newFilter = { positionType: '1' };
                    }
                    break;
                case 'wf.ReportingLineParticipantExpression':
                    // this.tab = 'report';
                    this.reportingLineCmp.setReportingLineDataEntity = this.performer.value;
                    break;
                case 'wf.ComponentParticipantExpression':
                    // this.tab = 'component';
                    this.cmpCmp.component = this.performer.value;
                    break;
                case 'wf.MatrixParticipantExpression':
                    // this.tab = 'matrix';
                    this.matrixCmp.setMatrixDataEntity = this.performer.value;
                    break;
                case 'wf.ActivityExecutorParticipantExpression':
                    // this.tab = 'activityExecutor';
                    this.activityExecutorCmp.activityExecutors = [];
                    this.activityExecutorCmp.activityExecutors.push(this.performer.value);
                    this.activityExecutorCmp.condition = this.performer.value.condition;
                    break;
                case 'wf.OrganizationParticipantExpression':
                    if (this.performer.value.organizationLevel === OrganizationLevel$1.DEFAULT && this.performer.value.tag === 'expression') {
                        this.performer.value.organizationLevel = OrganizationLevel$1.VARORGANIZATION;
                    }
                    this.organizationParticipant = this.performer.value;
                    if (this.performer.value.OrganizationLevel === OrganizationLevel$1.DEPARTMENT && this.performer.value.tag === 'expression') {
                        this.performer.value.OrganizationLevel === OrganizationLevel$1.VARORGANIZATION;
                    }
                    break;
            }
        }
        if (this.performerType) {
            switch (this.performerType) {
                case 'wf.UserParticipantExpression':
                    this.usersCmp.userType = 'user';
                    break;
            }
        }
    };
    /**
     * @param {?} event
     * @return {?}
     */
    PerformerEditComponent.prototype.valueChange = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        switch (event.value) {
            case this.organizationLevelCollection[0].value:
                this.organizationParticipant.organizationId = this.organizationLevelCollection[0].orgId;
                this.organizationParticipant.organizationName = this.organizationLevelCollection[0].text;
                this.organizationParticipant.includeChildren = true;
                break;
            case this.organizationLevelCollection[1].value:
                this.organizationParticipant.organizationId = this.organizationLevelCollection[1].orgId;
                this.organizationParticipant.organizationName = this.organizationLevelCollection[1].text;
                break;
            case this.organizationLevelCollection[2].value:
                this.organizationParticipant.organizationId = this.organizationLevelCollection[2].orgId;
                this.organizationParticipant.organizationName = this.organizationLevelCollection[2].text;
                this.organizationParticipant.includeChildren = true;
                this.organizationParticipant.tag = 'expression';
                break;
        }
    };
    /**
     * @return {?}
     */
    PerformerEditComponent.prototype.getPerformers = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var users = this.usersCmp ? this.usersCmp.getPerformers() : [];
        /** @type {?} */
        var variable = this.varCmp ? this.varCmp.getPerformers() : null;
        /** @type {?} */
        var positions = this.posiCmp ? this.posiCmp.getPerformers() : [];
        /** @type {?} */
        var component = this.cmpCmp ? this.cmpCmp.getPerformers() : null;
        /** @type {?} */
        var reportingLine = this.reportingLineCmp ? this.reportingLineCmp.getPerformers() : null;
        /** @type {?} */
        var matrix = this.matrixCmp ? this.matrixCmp.getPerformers() : null;
        /** @type {?} */
        var activityExecutors = this.activityExecutorCmp ? this.activityExecutorCmp.getPerformers() : [];
        /** @type {?} */
        var userPerformers = [];
        // 用户参与者
        /** @type {?} */
        var activityExecutorPerformers = [];
        if ((users && users.length > 0)) {
            userPerformers = userPerformers.concat(users);
        }
        if (activityExecutors && activityExecutors.length > 0) {
            activityExecutorPerformers = activityExecutorPerformers.concat(activityExecutors);
        }
        /** @type {?} */
        var organizationParticipant;
        if (this.performerType === 'wf.OrganizationParticipantExpression') {
            if (this.organizationParticipant.organizationLevel === OrganizationLevel$1.VARORGANIZATION && this.organizationParticipant.tag === 'expression') {
                this.organizationParticipant.organizationLevel = OrganizationLevel$1.DEFAULT;
            }
            organizationParticipant = this.organizationParticipant;
        }
        return { userPerformers: userPerformers, variable: variable, positions: positions, component: component, reportingLine: reportingLine, matrix: matrix, activityExecutorPerformers: activityExecutorPerformers, organizationParticipant: organizationParticipant };
    };
    /**
     * @return {?}
     */
    PerformerEditComponent.prototype.editConditon = /**
     * @return {?}
     */
    function () {
        var _this = this;
        var e_1, _a, e_2, _b, e_3, _c, e_4, _d;
        // this.expr.clearContext();
        if (this.designerUIState.schemas.length > 0) {
            try {
                for (var _e = __values(this.designerUIState.schemas), _f = _e.next(); !_f.done; _f = _e.next()) {
                    var schema = _f.value;
                    this.expr.addSchema('Schema', schema);
                }
            }
            catch (e_1_1) { e_1 = { error: e_1_1 }; }
            finally {
                try {
                    if (_f && !_f.done && (_a = _e.return)) _a.call(_e);
                }
                finally { if (e_1) throw e_1.error; }
            }
            if (this.designerUIState.schemas[0].entityTypes && this.designerUIState.schemas[0].entityTypes.length > 0) {
                /** @type {?} */
                var entityType = this.designerUIState.schemas[0].entityTypes[0];
                this.expr.addInjectedEntity(entityType.name, 'Schema', entityType.name, InjectedType.EntityType);
            }
        }
        /** @type {?} */
        var context = new Array();
        context = this.designerUIState.addContext(context);
        if (this.designerUIState.subActivityContext.length > 0) {
            var _loop_1 = function (variable) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    context.push(variable);
                }
            };
            try {
                for (var _g = __values(this.designerUIState.subActivityContext), _h = _g.next(); !_h.done; _h = _g.next()) {
                    var variable = _h.value;
                    _loop_1(variable);
                }
            }
            catch (e_2_1) { e_2 = { error: e_2_1 }; }
            finally {
                try {
                    if (_h && !_h.done && (_b = _g.return)) _b.call(_g);
                }
                finally { if (e_2) throw e_2.error; }
            }
        }
        if (this.designerUIState.activityComponentContext.length > 0) {
            var _loop_2 = function (variable) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    context.push(variable);
                }
            };
            try {
                for (var _j = __values(this.designerUIState.activityComponentContext), _k = _j.next(); !_k.done; _k = _j.next()) {
                    var variable = _k.value;
                    _loop_2(variable);
                }
            }
            catch (e_3_1) { e_3 = { error: e_3_1 }; }
            finally {
                try {
                    if (_k && !_k.done && (_c = _j.return)) _c.call(_j);
                }
                finally { if (e_3) throw e_3.error; }
            }
        }
        if (context.length > 0) {
            try {
                for (var context_1 = __values(context), context_1_1 = context_1.next(); !context_1_1.done; context_1_1 = context_1.next()) {
                    var v = context_1_1.value;
                    this.expr.addContext(v);
                }
            }
            catch (e_4_1) { e_4 = { error: e_4_1 }; }
            finally {
                try {
                    if (context_1_1 && !context_1_1.done && (_d = context_1.return)) _d.call(context_1);
                }
                finally { if (e_4) throw e_4.error; }
            }
        }
        this.expr.setEditPattern(ExprEditMode.Conditional); // 表达式展现模式：默认简易版
        this.expr.addExpressionText(this.organizationParticipant.condition);
        this.expr.buildExpression().then((/**
         * @param {?} expressioninfo
         * @return {?}
         */
        function (expressioninfo) {
            _this.organizationParticipant.condition = expressioninfo;
            //点击确定后，去除表达式里面的新增的上下文变量
            if (context.length > 0) {
                _this.expr.exprEntity.contextEntities = _this.expr.exprEntity.contextEntities.filter((/**
                 * @param {?} x
                 * @return {?}
                 */
                function (x) { return !context.some((/**
                 * @param {?} y
                 * @return {?}
                 */
                function (y) { return y.key === x.key; })); }));
            }
        }));
    };
    /**
     * @return {?}
     */
    PerformerEditComponent.prototype.editOrganizationId = /**
     * @return {?}
     */
    function () {
        var _this = this;
        var e_5, _a, e_6, _b, e_7, _c, e_8, _d;
        // this.expr.clearContext();
        if (this.designerUIState.schemas.length > 0) {
            try {
                for (var _e = __values(this.designerUIState.schemas), _f = _e.next(); !_f.done; _f = _e.next()) {
                    var schema = _f.value;
                    this.expr.addSchema('Schema', schema);
                }
            }
            catch (e_5_1) { e_5 = { error: e_5_1 }; }
            finally {
                try {
                    if (_f && !_f.done && (_a = _e.return)) _a.call(_e);
                }
                finally { if (e_5) throw e_5.error; }
            }
            if (this.designerUIState.schemas[0].entityTypes && this.designerUIState.schemas[0].entityTypes.length > 0) {
                /** @type {?} */
                var entityType = this.designerUIState.schemas[0].entityTypes[0];
                this.expr.addInjectedEntity(entityType.name, 'Schema', entityType.name, InjectedType.EntityType);
            }
        }
        /** @type {?} */
        var context = new Array();
        context = this.designerUIState.addContext(context);
        if (this.designerUIState.subActivityContext.length > 0) {
            var _loop_3 = function (variable) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    context.push(variable);
                }
            };
            try {
                for (var _g = __values(this.designerUIState.subActivityContext), _h = _g.next(); !_h.done; _h = _g.next()) {
                    var variable = _h.value;
                    _loop_3(variable);
                }
            }
            catch (e_6_1) { e_6 = { error: e_6_1 }; }
            finally {
                try {
                    if (_h && !_h.done && (_b = _g.return)) _b.call(_g);
                }
                finally { if (e_6) throw e_6.error; }
            }
        }
        if (this.designerUIState.activityComponentContext.length > 0) {
            var _loop_4 = function (variable) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    context.push(variable);
                }
            };
            try {
                for (var _j = __values(this.designerUIState.activityComponentContext), _k = _j.next(); !_k.done; _k = _j.next()) {
                    var variable = _k.value;
                    _loop_4(variable);
                }
            }
            catch (e_7_1) { e_7 = { error: e_7_1 }; }
            finally {
                try {
                    if (_k && !_k.done && (_c = _j.return)) _c.call(_j);
                }
                finally { if (e_7) throw e_7.error; }
            }
        }
        if (context.length > 0) {
            try {
                for (var context_2 = __values(context), context_2_1 = context_2.next(); !context_2_1.done; context_2_1 = context_2.next()) {
                    var v = context_2_1.value;
                    this.expr.addContext(v);
                }
            }
            catch (e_8_1) { e_8 = { error: e_8_1 }; }
            finally {
                try {
                    if (context_2_1 && !context_2_1.done && (_d = context_2.return)) _d.call(context_2);
                }
                finally { if (e_8) throw e_8.error; }
            }
        }
        this.expr.setEditPattern(ExprEditMode.Advanced);
        this.expr.addExpressionText(this.organizationParticipant.organizationId);
        this.expr.buildExpression().then((/**
         * @param {?} expressioninfo
         * @return {?}
         */
        function (expressioninfo) {
            _this.organizationParticipant.organizationId = expressioninfo;
            //点击确定后，去除表达式里面的新增的上下文变量
            if (context.length > 0) {
                _this.expr.exprEntity.contextEntities = _this.expr.exprEntity.contextEntities.filter((/**
                 * @param {?} x
                 * @return {?}
                 */
                function (x) { return !context.some((/**
                 * @param {?} y
                 * @return {?}
                 */
                function (y) { return y.key === x.key; })); }));
            }
        }));
    };
    PerformerEditComponent.decorators = [
        { type: Component, args: [{
                    selector: 'app-performer-edit',
                    template: "<app-user-performer *ngIf=\"performerType === 'wf.UserParticipantExpression'\"></app-user-performer>\r\n<app-variable-performer *ngIf=\"performerType === 'wf.VariableParticipantExpression'\"></app-variable-performer>\r\n<app-position-performer *ngIf=\"performerType === 'wf.PositionParticipantExpression'\"></app-position-performer>\r\n<app-reporting-line *ngIf=\"performerType === 'wf.ReportingLineParticipantExpression'\"></app-reporting-line>\r\n<app-matrix-performer *ngIf=\"performerType === 'wf.MatrixParticipantExpression'\"></app-matrix-performer>\r\n<app-activity-handler-performer\r\n  *ngIf=\"performerType === 'wf.ActivityExecutorParticipantExpression'\"></app-activity-handler-performer>\r\n<app-component-performer [component]=\"component\" style=\"background: #FFF;\"\r\n  *ngIf=\"performerType === 'wf.ComponentParticipantExpression'\"></app-component-performer>\r\n\r\n<div *ngIf=\"performerType === 'wf.OrganizationParticipantExpression'\" class=\"f-page\">\r\n  <div class=\"f-utils-fill-flex-column farris-split-section m-2 h-100\" style=\"background: #FFF;\">\r\n    <div class=\"f-utils-fill-flex-column farris-split-section mx-1 h-100\"\r\n      style=\"border-radius:16px;border: 1.5px solid #F1F3F7;\">\r\n      <form style=\"width: 100%; height: 100%;\">\r\n        <div class=\"d-flex m-2 flex-column w-100\">\r\n          <div class=\"d-flex flex-column\" style=\"height: 120px;\">\r\n            <div class=\"farris-form form-inline  farris-form-inline mr-5 my-2 pt-3\">\r\n              <div class=\"col-12 farris-group-auto\">\r\n                <div class=\"farris-group-wrap\">\r\n                  <div class=\"form-group farris-form-group\">\r\n                    <label class=\"col-form-label\">\r\n                      <span class=\"farris-label-text\">{{'component.participant.alternativeScope'|wfLocale}}</span>\r\n                    </label>\r\n                    <div class=\"farris-input-wrap ml-1\">\r\n                      <farris-combo-list [panelHeight]=\"100\" [(ngModel)]=\"organizationParticipant.organizationLevel\"\r\n                        name=\"actionScope\" [idField]=\"'value'\" [enableClear]=\"false\" [textField]=\"'text'\"\r\n                        [valueField]=\"'value'\" [data]=\"organizationLevelCollection\" [readonly]=\"false\"\r\n                        (valueChange)=\"valueChange($event)\">\r\n                      </farris-combo-list>\r\n                      <div class=\"farris-feedback valid-feedback\"></div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <!-- \u5355\u4F4D/\u90E8\u95E8\u53C2\u4E0E\u8005\u652F\u6301\u5355\u4F4DID -->\r\n              <div *ngIf=\"organizationParticipant.organizationLevel===organizationLevelCollection[2].value\"\r\n                class=\"col-12 farris-group-auto my-3 pr-3\">\r\n                <div class=\"farris-group-wrap\">\r\n                  <div class=\"form-group farris-form-group\">\r\n                    <label class=\"col-form-label\">\r\n                      <span class=\"farris-label-text\">{{'component.participant.orgId'|wfLocale}}</span>\r\n                    </label>\r\n                    <div class=\"farris-input-wrap ml-1\">\r\n                      <div class=\"input-group\">\r\n                        <input type=\"text\" class=\"form-control\" [(ngModel)]=\"organizationParticipant.organizationId\"\r\n                          name=\"organizationId\" [readOnly]=\"true\" />\r\n                        <div class=\"input-group-append\">\r\n                          <span class=\"input-group-text\" (click)=\"editOrganizationId()\" style=\"background: #FFF;\">\r\n                            <i class=\"f-icon f-icon-lookup\"></i>\r\n                          </span>\r\n                        </div>\r\n                      </div>\r\n                      <div class=\"farris-feedback valid-feedback\"></div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <div *ngIf=\"organizationParticipant.organizationLevel!=organizationLevelCollection[0].value\"\r\n                class=\"col-12 farris-group-auto my-3 pr-5\">\r\n                <div class=\"farris-group-wrap\">\r\n                  <div class=\"form-group farris-form-group\">\r\n                    <label class=\"col-form-label\">\r\n                      <span class=\"farris-label-text\">{{'component.participant.includeChildren'|wfLocale}}</span>\r\n                    </label>\r\n                    <div class=\"farris-input-wrap ml-1\">\r\n                      <farris-switch [(ngModel)]=\"organizationParticipant.includeChildren\"\r\n                        name=\"includeChildren\"></farris-switch>\r\n                      <div class=\"farris-feedback valid-feedback\"></div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"d-flex flex-column m-2 w-100\">\r\n            <div class=\"farris-form form-inline farris-form-inline mr-5\">\r\n              <div class=\"col-12 farris-group-auto my-4\" style=\"padding-left: 6px;padding-right: 21px;\">\r\n                <div class=\"farris-group-wrap\">\r\n                  <div class=\"form-group farris-form-group\">\r\n                    <label class=\"col-form-label\">\r\n                      <span class=\"farris-label-text\">{{'component.participant.conditon'|wfLocale}}</span>\r\n                    </label>\r\n                    <div class=\"farris-input-wrap\">\r\n                      <div class=\"input-group\">\r\n                        <input type=\"text\" class=\"form-control\" [(ngModel)]=\"organizationParticipant.condition\"\r\n                          name=\"conditon\" [readOnly]=\"true\" />\r\n                        <div class=\"input-group-append\">\r\n                          <span class=\"input-group-text\" (click)=\"editConditon()\" style=\"background: #FFF;\">\r\n                            <i class=\"f-icon f-icon-lookup\"></i>\r\n                          </span>\r\n                        </div>\r\n                      </div>\r\n                      <div class=\"farris-feedback valid-feedback\"></div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </form>\r\n    </div>\r\n  </div>\r\n</div>",
                    providers: [
                        WfLocalePipe,
                    ],
                    styles: [""]
                }] }
    ];
    /** @nocollapse */
    PerformerEditComponent.ctorParameters = function () { return [
        { type: ProcessDesignerUIState },
        { type: ExpressionService },
        { type: HttpService },
        { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
        { type: undefined, decorators: [{ type: Inject, args: [WF_LANG_RESOURCES,] }] },
        { type: WfLocalePipe, decorators: [{ type: Optional }] }
    ]; };
    PerformerEditComponent.propDecorators = {
        cls: [{ type: HostBinding, args: ['class',] }],
        display: [{ type: Input }],
        usersCmp: [{ type: ViewChild, args: [UserPerformerComponent,] }],
        varCmp: [{ type: ViewChild, args: [VariablePerformerComponent,] }],
        posiCmp: [{ type: ViewChild, args: [PositionPerformerComponent,] }],
        cmpCmp: [{ type: ViewChild, args: [ComponentPerformerComponent,] }],
        reportingLineCmp: [{ type: ViewChild, args: [ReportingLineComponent,] }],
        matrixCmp: [{ type: ViewChild, args: [MatrixPerformerComponent,] }],
        activityExecutorCmp: [{ type: ViewChild, args: [ActivityExecutorPerformerComponent,] }]
    };
    return PerformerEditComponent;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var PerformerOptionsComponent = /** @class */ (function () {
    function PerformerOptionsComponent(ngZone, designerState, expr, message, cdr, localeId, resources, localePipe) {
        this.ngZone = ngZone;
        this.designerState = designerState;
        this.expr = expr;
        this.message = message;
        this.cdr = cdr;
        this.localeId = localeId;
        this.resources = resources;
        this.localePipe = localePipe;
        this.cls = 'farris-main-area flex-column';
        this.editorParams = {};
        this.closeModal = new EventEmitter();
        this.submitModal = new EventEmitter();
        this.performerOptionsLocation = '';
        this.showClearButton = false;
        this.historicFirst = false;
        this.excludeProcInstCreator = false;
        this.excludePreActExecutors = false;
        this.excludeAllPassExecutors = false;
        this.autoProcInstCreator = false;
        this.autoPreActExecutors = false;
        this.autoAllPassExecutors = false;
        this.noPerformerStrategyList = [
            { text: this.localePipe.transform('component.performerOptions.leave'), value: 'leave' },
            { text: this.localePipe.transform('component.performerOptions.throwException'), value: 'throwException' }
        ];
        this.variableOrgTypes = [
            { name: this.localePipe.transform('component.performerOptions.sys'), value: 'Sys' },
            { name: this.localePipe.transform('component.performerOptions.administrative_staff'), value: 'Administrative_staff' },
        ];
        this.exclusionPerformersOptions = [
            { value: 'procInstCreator', name: this.localePipe.transform('component.performerOptions.procInstCreator') },
            { value: 'preActExecutors', name: this.localePipe.transform('component.performerOptions.preActExecutors') },
            { value: 'allPassExecutors', name: this.localePipe.transform('component.performerOptions.allPassExecutors') }
        ];
        this.exprPerformerType = this.variableOrgTypes[0].value;
        this.noPerformerStrategy = this.noPerformerStrategyList[0].value;
        this.modalConfig = {
            title: this.localePipe.transform('component.performerOptions.performerOptions'),
            width: 760,
            height: 606,
            showButtons: true
        };
        this.localePipe = this.localePipe || new WfLocalePipe(localeId, resources);
    }
    Object.defineProperty(PerformerOptionsComponent.prototype, "value", {
        set: /**
         * @param {?} options
         * @return {?}
         */
        function (options) {
            if (options) {
                this.exclusionPerformers = options.ExclusionPerformers;
                this.noPerformerStrategy = options.NoPerformerStrategy;
                this.historicFirst = options.HistoricFirst;
                this.automaticPerformers = options.automaticPerformers;
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(PerformerOptionsComponent.prototype, "exclusionPerformers", {
        set: /**
         * @param {?} e
         * @return {?}
         */
        function (e) {
            if (e) {
                if (typeof e === 'string') {
                    this.excludeProcInstCreator = e.indexOf('procInstCreator') > -1;
                    this.excludePreActExecutors = e.indexOf('preActExecutors') > -1;
                }
                else {
                    this.excludeProcInstCreator = e.findIndex((/**
                     * @param {?} i
                     * @return {?}
                     */
                    function (i) { return i === 'procInstCreator'; })) > -1;
                    this.excludePreActExecutors = e.findIndex((/**
                     * @param {?} i
                     * @return {?}
                     */
                    function (i) { return i === 'preActExecutors'; })) > -1;
                    this.excludeAllPassExecutors = e.findIndex((/**
                     * @param {?} i
                     * @return {?}
                     */
                    function (i) { return i === 'allPassExecutors'; })) > -1;
                    this.excludeExprPerformer = e.find((/**
                     * @param {?} i
                     * @return {?}
                     */
                    function (i) { return i.indexOf('expr') > -1; }));
                    if (this.excludeExprPerformer != null && (this.excludeExprPerformer.startsWith('Sys#') ||
                        this.excludeExprPerformer.startsWith('Administrative_staff#'))) {
                        /** @type {?} */
                        var excludeValue = this.excludeExprPerformer.split("#");
                        this.exprPerformerType = excludeValue[0];
                        this.excludeExprPerformer = excludeValue[1];
                    }
                }
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(PerformerOptionsComponent.prototype, "automaticPerformers", {
        set: /**
         * @param {?} e
         * @return {?}
         */
        function (e) {
            if (e && e.length > 0) {
                this.autoProcInstCreator = e.findIndex((/**
                 * @param {?} i
                 * @return {?}
                 */
                function (i) { return i === 'procInstCreator'; })) > -1;
                this.autoPreActExecutors = e.findIndex((/**
                 * @param {?} i
                 * @return {?}
                 */
                function (i) { return i === 'preActExecutors'; })) > -1;
                this.autoAllPassExecutors = e.findIndex((/**
                 * @param {?} i
                 * @return {?}
                 */
                function (i) { return i === 'allPassExecutors'; })) > -1;
            }
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    PerformerOptionsComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        this.performerOptionsLocation = this.editorParams.location;
    };
    /**
     * @return {?}
     */
    PerformerOptionsComponent.prototype.ngAfterViewInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.ngZone.runOutsideAngular((/**
         * @return {?}
         */
        function () {
            _this.inputGroup.nativeElement.addEventListener('mouseenter', _this.onMouseEnter.bind(_this));
            _this.inputGroup.nativeElement.addEventListener('mouseleave', _this.onMouseLeave.bind(_this));
        }));
    };
    /**
     * @param {?} event
     * @return {?}
     */
    PerformerOptionsComponent.prototype.onMouseEnter = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        this.showClearButton = true;
        if (this.showClearButton) {
            this.toggleClearIcon(event, true);
        }
    };
    /**
     * @param {?} event
     * @return {?}
     */
    PerformerOptionsComponent.prototype.onMouseLeave = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        this.showClearButton = false;
        this.toggleClearIcon(event, false);
    };
    /**
     * @private
     * @param {?} event
     * @param {?=} isShow
     * @return {?}
     */
    PerformerOptionsComponent.prototype.toggleClearIcon = /**
     * @private
     * @param {?} event
     * @param {?=} isShow
     * @return {?}
     */
    function (event, isShow) {
        if (isShow === void 0) { isShow = false; }
        /** @type {?} */
        var str = isShow ? '' : 'none';
        /** @type {?} */
        var clearIcon = event.target.querySelector('.input-group-clear');
        if (clearIcon) {
            clearIcon.style.display = str;
        }
    };
    /**
     * @return {?}
     */
    PerformerOptionsComponent.prototype.clickOK = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var options = {
            ExclusionPerformers: this.getExclusionPerformers(),
            NoPerformerStrategy: this.noPerformerStrategy,
            HistoricFirst: this.historicFirst,
            automaticPerformers: this.getAutoPerformers()
        };
        /** @type {?} */
        var object = {
            value: options, parameters: null
        };
        this.submitModal.emit(object);
    };
    /**
     * @return {?}
     */
    PerformerOptionsComponent.prototype.cancel = /**
     * @return {?}
     */
    function () {
        this.closeModal.emit();
    };
    /**
     * @param {?} event
     * @return {?}
     */
    PerformerOptionsComponent.prototype.excludeProcInstCreatorClick = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        // this.excludeProcInstCreator = !this.excludeProcInstCreator;
        if (this.excludeProcInstCreator && this.autoProcInstCreator) {
            this.autoProcInstCreator = false;
        }
    };
    /**
     * @param {?} event
     * @return {?}
     */
    PerformerOptionsComponent.prototype.excludePreActExecutorsClick = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        var _this = this;
        // this.excludePreActExecutors = !this.excludePreActExecutors;
        if (this.autoAllPassExecutors === true && this.excludePreActExecutors === true) {
            this.message.info(this.localePipe.transform('component.performerOptions.exclusionNotAllowed'), (/**
             * @return {?}
             */
            function () {
                _this.excludePreActExecutors = false;
            }));
            return;
        }
        if (this.excludePreActExecutors && this.autoPreActExecutors) {
            this.autoPreActExecutors = false;
        }
    };
    /**
     * @param {?} event
     * @return {?}
     */
    PerformerOptionsComponent.prototype.excludeAllPassExecutorsClick = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        // this.excludeAllPassExecutors = !this.excludeAllPassExecutors;
        if (this.excludeAllPassExecutors) {
            if (this.autoPreActExecutors) {
                this.autoPreActExecutors = false;
            }
            if (this.autoAllPassExecutors) {
                this.autoAllPassExecutors = false;
            }
        }
    };
    /**
     * @param {?} event
     * @return {?}
     */
    PerformerOptionsComponent.prototype.autoProcInstCreatorClick = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        var _this = this;
        // if (this.designerState.propertyData.CompleteStrategy !== this.designerState.completeIterator[0].key
        //   && this.autoProcInstCreator === true ) {
        //   this.message.info('【完成策略】为【会签】时，不允许设置自动审批，请了解！', () => {
        //     this.autoProcInstCreator = false;
        //   });
        //   return;
        // }
        if (this.designerState.propertyData.AssignStrategy === this.designerState.assignIterator[2].key
            && this.autoProcInstCreator === true) {
            this.message.info(this.localePipe.transform('component.performerOptions.approvalNotAllowedAsSet'), (/**
             * @return {?}
             */
            function () {
                _this.autoProcInstCreator = false;
            }));
            return;
        }
        // this.autoProcInstCreator = !this.autoProcInstCreator;
        if (this.autoProcInstCreator && this.excludeProcInstCreator) {
            this.excludeProcInstCreator = false;
        }
    };
    /**
     * @param {?} event
     * @return {?}
     */
    PerformerOptionsComponent.prototype.autoPreActExecutorsClick = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        var _this = this;
        // if (this.designerState.propertyData.CompleteStrategy !== this.designerState.completeIterator[0].key
        //   && this.autoPreActExecutors === true) {
        //   this.message.info('【完成策略】为【会签】时，不允许设置自动审批，请了解！', () => {
        //     this.autoPreActExecutors = false;
        //   });
        //   return;
        // }
        if (this.designerState.propertyData.AssignStrategy === this.designerState.assignIterator[2].key
            && this.autoPreActExecutors === true) {
            this.message.info(this.localePipe.transform('component.performerOptions.approvalNotAllowed'), (/**
             * @return {?}
             */
            function () {
                _this.autoPreActExecutors = false;
            }));
            return;
        }
        if (this.excludeAllPassExecutors === true && this.autoPreActExecutors === true) {
            this.message.info(this.localePipe.transform('component.performerOptions.approvalNotAllowedAsSet'), (/**
             * @return {?}
             */
            function () {
                _this.autoPreActExecutors = false;
            }));
            return;
        }
        // this.autoPreActExecutors = !this.autoPreActExecutors;
        if (this.autoPreActExecutors && this.excludePreActExecutors) {
            this.excludePreActExecutors = false;
        }
    };
    /**
     * @param {?} event
     * @return {?}
     */
    PerformerOptionsComponent.prototype.autoAllPassExecutorsClick = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        var _this = this;
        // if (this.designerState.propertyData.CompleteStrategy !== this.designerState.completeIterator[0].key
        //   && this.autoAllPassExecutors === true) {
        //   this.message.info('【完成策略】为【会签】时，不允许设置自动审批，请了解！', () => {
        //     this.autoAllPassExecutors = false;
        //   });
        //   return;
        // }
        if (this.designerState.propertyData.AssignStrategy === this.designerState.assignIterator[2].key
            && this.autoAllPassExecutors === true) {
            this.message.info(this.localePipe.transform('component.performerOptions.allocationStrategyIsCollect'), (/**
             * @return {?}
             */
            function () {
                _this.autoAllPassExecutors = false;
            }));
            return;
        }
        // this.autoAllPassExecutors = !this.autoAllPassExecutors;
        if (this.autoAllPassExecutors) {
            if (this.excludeAllPassExecutors) {
                this.excludeAllPassExecutors = false;
            }
            if (this.excludePreActExecutors) {
                this.excludePreActExecutors = false;
            }
        }
    };
    /**
     * @return {?}
     */
    PerformerOptionsComponent.prototype.getPerformerOptions = /**
     * @return {?}
     */
    function () {
        return {
            ExclusionPerformers: this.getExclusionPerformers(),
            NoPerformerStrategy: this.noPerformerStrategy,
            HistoricFirst: this.historicFirst,
            automaticPerformers: this.getAutoPerformers()
        };
    };
    /**
     * @private
     * @return {?}
     */
    PerformerOptionsComponent.prototype.getExclusionPerformers = /**
     * @private
     * @return {?}
     */
    function () {
        /** @type {?} */
        var exclusionPerf = [];
        if (this.excludeProcInstCreator) {
            exclusionPerf.push('procInstCreator');
        }
        if (this.excludePreActExecutors) {
            exclusionPerf.push('preActExecutors');
        }
        if (this.excludeAllPassExecutors) {
            exclusionPerf.push('allPassExecutors');
        }
        if (this.excludeExprPerformer) {
            exclusionPerf.push(this.exprPerformerType + "#" + this.excludeExprPerformer);
        }
        return exclusionPerf;
    };
    /**
     * @private
     * @return {?}
     */
    PerformerOptionsComponent.prototype.getAutoPerformers = /**
     * @private
     * @return {?}
     */
    function () {
        /** @type {?} */
        var autoPerf = new Array();
        if (this.autoProcInstCreator) {
            autoPerf.push('procInstCreator');
        }
        if (this.autoPreActExecutors) {
            autoPerf.push('preActExecutors');
        }
        if (this.autoAllPassExecutors) {
            autoPerf.push('allPassExecutors');
        }
        return autoPerf;
    };
    /**
     * @return {?}
     */
    PerformerOptionsComponent.prototype.openExprEditor = /**
     * @return {?}
     */
    function () {
        var _this = this;
        var e_1, _a, e_2, _b, e_3, _c;
        // this.expr.clearContext();
        this.expr.setEditPattern(ExprEditMode.Advanced);
        if (this.designerState.schemas.length > 0) {
            try {
                for (var _d = __values(this.designerState.schemas), _e = _d.next(); !_e.done; _e = _d.next()) {
                    var schema = _e.value;
                    this.expr.addSchema('Schema', schema);
                }
            }
            catch (e_1_1) { e_1 = { error: e_1_1 }; }
            finally {
                try {
                    if (_e && !_e.done && (_a = _d.return)) _a.call(_d);
                }
                finally { if (e_1) throw e_1.error; }
            }
            if (this.designerState.schemas[0].entityTypes && this.designerState.schemas[0].entityTypes.length > 0) {
                /** @type {?} */
                var entityType = this.designerState.schemas[0].entityTypes[0];
                this.expr.addInjectedEntity(entityType.name, 'Schema', entityType.name, InjectedType.EntityType);
            }
        }
        /** @type {?} */
        var context = new Array();
        context = this.designerState.addContext(context);
        if (this.designerState.subActivityContext.length > 0) {
            var _loop_1 = function (variable) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    context.push(variable);
                }
            };
            try {
                for (var _f = __values(this.designerState.subActivityContext), _g = _f.next(); !_g.done; _g = _f.next()) {
                    var variable = _g.value;
                    _loop_1(variable);
                }
            }
            catch (e_2_1) { e_2 = { error: e_2_1 }; }
            finally {
                try {
                    if (_g && !_g.done && (_b = _f.return)) _b.call(_f);
                }
                finally { if (e_2) throw e_2.error; }
            }
        }
        if (context.length > 0) {
            try {
                for (var context_1 = __values(context), context_1_1 = context_1.next(); !context_1_1.done; context_1_1 = context_1.next()) {
                    var v = context_1_1.value;
                    this.expr.addContext(v);
                }
            }
            catch (e_3_1) { e_3 = { error: e_3_1 }; }
            finally {
                try {
                    if (context_1_1 && !context_1_1.done && (_c = context_1.return)) _c.call(context_1);
                }
                finally { if (e_3) throw e_3.error; }
            }
        }
        // if (this.excludeExprPerformer) {
        this.expr.addExpressionText(this.excludeExprPerformer);
        // }
        this.expr.buildExpression().then((/**
         * @param {?} d
         * @return {?}
         */
        function (d) {
            _this.excludeExprPerformer = d;
            //点击确定后，去除表达式里面的新增的上下文变量
            if (context.length > 0) {
                _this.expr.exprEntity.contextEntities = _this.expr.exprEntity.contextEntities.filter((/**
                 * @param {?} x
                 * @return {?}
                 */
                function (x) { return !context.some((/**
                 * @param {?} y
                 * @return {?}
                 */
                function (y) { return y.key === x.key; })); }));
            }
        }));
    };
    /**
     * @param {?} data
     * @return {?}
     */
    PerformerOptionsComponent.prototype.orgTypeChange = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        if (data === 'Sys') {
            this.exprPerformerType = this.variableOrgTypes[0].value;
        }
        else if (data === 'Administrative_staff') {
            this.exprPerformerType = this.variableOrgTypes[1].value;
        }
    };
    /**
     * @return {?}
     */
    PerformerOptionsComponent.prototype.clear = /**
     * @return {?}
     */
    function () {
        this.excludeExprPerformer = '';
    };
    PerformerOptionsComponent.decorators = [
        { type: Component, args: [{
                    selector: 'app-performer-options',
                    template: "<div class=\"f-page\">\r\n  <div class=\"f-utils-fill-flex-column h-100\">\r\n    <section class=\"f-utils-fill-flex-column h-100 mx-3\" style=\"border-radius:16px;border: 1.5px solid #F1F3F7;\">\r\n      <div class=\"f-utils-fill-flex-column h-100 pl-3\">\r\n        <perfect-scrollbar [config]=\"{}\">\r\n          <form class=\"h-100\" style=\"overflow-x: hidden;\">\r\n            <div class=\"f-form-layout farris-form pb-4\">\r\n              <div class=\"farris-form form-inline farris-form-inline\">\r\n                <div class=\"mx-2 mt-3\">\r\n                  <div class=\"title-content\">\r\n                    <h5 class=\"title-text\">{{'component.performerOptions.advancedOptions'|wfLocale}}</h5><span class=\"title-line\"></span>\r\n                  </div>\r\n                </div>\r\n                <div class=\"col-12 farris-group-auto my-2\" style=\"margin-left: 100px;\">\r\n                  <div class=\"farris-group-wrap pl-3\">\r\n                    <div class=\"form-group farris-form-group\">\r\n                      <div class=\"farris-input-wrap\">\r\n                        <div class=\"custom-control custom-checkbox\">\r\n                          <input class=\"custom-control-input\" name=\"historicFirst\" type=\"checkbox\" id=\"historicFirst\"\r\n                            [(ngModel)]=\"historicFirst\" />\r\n                          <label class=\"custom-control-label\" for=\"historicFirst\">{{'component.performerOptions.historicFirst'|wfLocale}}</label>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n                <div class=\"col-12 farris-group-auto mt-3 pr-4\">\r\n                  <div class=\"farris-group-wrap f-form-lable-auto pl-3\">\r\n                    <div class=\"form-group farris-form-group\">\r\n                      <label class=\"col-form-label\">\r\n                        <span class=\"farris-label-text\">{{'component.performerOptions.noPerformerStrategy'|wfLocale}}</span>\r\n                      </label>\r\n                      <div class=\"farris-input-wrap\">\r\n                        <farris-combo-list [(ngModel)]=\"noPerformerStrategy\" name=\"noPerformerStrategy\" [idField]=\"'value'\"\r\n                          [textField]=\"'text'\" [valueField]=\"'value'\" [data]=\"noPerformerStrategyList\" [panelHeight]=\"60\">\r\n                        </farris-combo-list>\r\n                        <div class=\"farris-feedback valid-feedback\"></div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n                <div class=\"mx-2 mt-3\">\r\n                  <div class=\"title-content\">\r\n                    <h5 class=\"title-text\">{{'component.performerOptions.excludeProcInstCreator'|wfLocale}}</h5><span class=\"title-line\"></span>\r\n                  </div>\r\n                </div>\r\n                <div class=\"col-12 farris-group-auto my-2\" style=\"margin-left: 100px;\">\r\n                  <div class=\"farris-group-wrap pl-3\">\r\n                    <div class=\"form-group farris-form-group\">\r\n                      <div class=\"farris-input-wrap\">\r\n                        <div class=\"custom-control custom-checkbox\">\r\n                          <input class=\"custom-control-input\" name=\"excludeProcInstCreator\" type=\"checkbox\" id=\"excludeProcInstCreator\"\r\n                            [(ngModel)]=\"excludeProcInstCreator\" (change)=\"excludeProcInstCreatorClick($event)\" />\r\n                          <label class=\"custom-control-label\" for=\"excludeProcInstCreator\">{{'component.performerOptions.defaultNotParticipate'|wfLocale}}</label>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n                <div class=\"col-12 farris-group-auto my-2\" style=\"margin-left: 100px;\">\r\n                  <div class=\"farris-group-wrap pl-3\">\r\n                    <div class=\"form-group farris-form-group\">\r\n                      <div class=\"farris-input-wrap\">\r\n                        <div class=\"custom-control custom-checkbox\">\r\n                          <input class=\"custom-control-input\" name=\"excludePreActExecutors\" type=\"checkbox\" id=\"excludePreActExecutors\"\r\n                            [(ngModel)]=\"excludePreActExecutors\" (change)=\"excludePreActExecutorsClick($event)\"/>\r\n                          <label class=\"custom-control-label\" for=\"excludePreActExecutors\">{{'component.performerOptions.excludePreActExecutors'|wfLocale}}</label>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n                <div class=\"col-12 farris-group-auto my-2\" style=\"margin-left: 100px;\">\r\n                  <div class=\"farris-group-wrap pl-3\">\r\n                    <div class=\"form-group farris-form-group\">\r\n                      <div class=\"farris-input-wrap\">\r\n                        <div class=\"custom-control custom-checkbox\">\r\n                          <input class=\"custom-control-input\" name=\"excludeAllPassExecutors\" type=\"checkbox\" id=\"excludeAllPassExecutors\"\r\n                            [(ngModel)]=\"excludeAllPassExecutors\" (change)=\"excludeAllPassExecutorsClick($event)\"/>\r\n                          <label class=\"custom-control-label\" for=\"excludeAllPassExecutors\">{{'component.performerOptions.excludeAllPassExecutors'|wfLocale}}</label>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n                <div class=\"col-12 farris-group-auto pr-4 my-2\">\r\n                  <div class=\"farris-group-wrap f-form-lable-auto pl-3\">\r\n                    <div class=\"form-group farris-form-group\">\r\n                      <label class=\"col-form-label\">\r\n                        <span class=\"farris-label-text\">{{'component.performerOptions.excludeExprPerformer'|wfLocale}}</span>\r\n                      </label>\r\n                      <div class=\"farris-input-wrap\">\r\n                        <div #inputGroup class=\"input-group\">\r\n                          <input type=\"text\" class=\"form-control\" [(ngModel)]=\"excludeExprPerformer\" name=\"excludeExprPerformer\"\r\n                            [readOnly]=\"true\" />\r\n                          <div class=\"input-group-append\">\r\n                            <span [style.display]=\"showClearButton ? '' : 'none'\" class=\"input-group-text input-group-clear\"\r\n                              (click)=\"clear()\">\r\n                              <i class=\"f-icon modal_close\"></i>\r\n                            </span>\r\n                            <span class=\"input-group-text\" (click)=\"openExprEditor()\" style=\"background: #FFF;\">\r\n                              <i class=\"f-icon f-icon-lookup\"></i>\r\n                            </span>\r\n                          </div>\r\n                        </div>\r\n                        <div class=\"farris-feedback valid-feedback\"></div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n                <div *ngIf=\"excludeExprPerformer != null || excludeExprPerformer != ''\">\r\n                  <div class=\"col-9 farris-group-auto my-2 pr-4\">\r\n                    <div class=\"farris-group-wrap f-form-lable-auto pl-3\">\r\n                      <div class=\"form-group farris-form-group\">\r\n                        <label class=\"col-form-label\">\r\n                          <span class=\"farris-label-text\">{{'component.performerOptions.variableOrgTypes'|wfLocale}}</span>\r\n                        </label>\r\n                        <div class=\"farris-input-wrap\" style=\"margin-bottom: 5px;\">\r\n                          <div class=\"custom-control custom-checkbox\">\r\n                            <farris-radiogroup [data]=\"variableOrgTypes\" [horizontal]=\"true\" [(ngModel)]=\"exprPerformerType\" name=\"referObject\"\r\n                              (changeValue)=\"orgTypeChange($event)\"></farris-radiogroup>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n                <div *ngIf=\"performerOptionsLocation!='autoActivity'\">\r\n                <div class=\"mx-2 mt-3\">\r\n                  <div class=\"title-content\">\r\n                    <h5 class=\"title-text\">{{'component.performerOptions.automaticApprovalOptions'|wfLocale}}</h5><span class=\"title-line\"></span>\r\n                  </div>\r\n                </div>\r\n                <div class=\"col-12 farris-group-auto my-2\" style=\"margin-left: 100px;\">\r\n                  <div class=\"farris-group-wrap pl-3\">\r\n                    <div class=\"form-group farris-form-group\">\r\n                      <div class=\"farris-input-wrap\">\r\n                        <div class=\"custom-control custom-checkbox\">\r\n                          <input class=\"custom-control-input\" name=\"autoProcInstCreator\" type=\"checkbox\" id=\"autoProcInstCreator\"\r\n                            [(ngModel)]=\"autoProcInstCreator\" (change)=\"autoProcInstCreatorClick($event)\" />\r\n                          <label class=\"custom-control-label\" for=\"autoProcInstCreator\">{{'component.performerOptions.autoProcInstCreator'|wfLocale}}</label>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n                <div class=\"col-12 farris-group-auto my-2\" style=\"margin-left: 100px;\">\r\n                  <div class=\"farris-group-wrap pl-3\">\r\n                    <div class=\"form-group farris-form-group\">\r\n                      <div class=\"farris-input-wrap\">\r\n                        <div class=\"custom-control custom-checkbox\">\r\n                          <input class=\"custom-control-input\" name=\"autoPreActExecutors\" type=\"checkbox\" id=\"autoPreActExecutors\"\r\n                            [(ngModel)]=\"autoPreActExecutors\" (change)=\"autoPreActExecutorsClick($event)\" />\r\n                          <label class=\"custom-control-label\" for=\"autoPreActExecutors\">{{'component.performerOptions.autoPreActExecutors'|wfLocale}}</label>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n                <div class=\"col-12 farris-group-auto my-2\" style=\"margin-left: 100px;\">\r\n                  <div class=\"farris-group-wrap pl-3\">\r\n                    <div class=\"form-group farris-form-group\">\r\n                      <div class=\"farris-input-wrap\">\r\n                        <div class=\"custom-control custom-checkbox\">\r\n                          <input class=\"custom-control-input\" name=\"autoAllPassExecutors\" type=\"checkbox\" id=\"autoAllPassExecutors\"\r\n                            [(ngModel)]=\"autoAllPassExecutors\" (change)=\"autoAllPassExecutorsClick($event)\" />\r\n                          <label class=\"custom-control-label\" for=\"autoAllPassExecutors\">{{'component.performerOptions.autoAllPassExecutors'|wfLocale}}</label>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              </div>\r\n            </div>\r\n          </form>\r\n        </perfect-scrollbar>\r\n\r\n      </div>\r\n    </section>\r\n  </div>\r\n</div>\r\n\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type=\"button\" class=\"btn btn-secondary btn-sm mx-2\" (click)=\"cancel()\">{{'component.performerOptions.cancel'|wfLocale}}</button>\r\n  <button type=\"button\" class=\"btn btn-primary btn-sm mx-2\" (click)=\"clickOK()\">{{'component.performerOptions.clickOK'|wfLocale}}</button>\r\n</ng-template>\r\n",
                    providers: [
                        WfLocalePipe,
                    ],
                    styles: [".item-header{padding:1rem}.item{padding:.5rem 5rem}.title-content{color:#000;display:inline-flex;align-items:center;line-height:1.375rem;position:relative;overflow:hidden;padding:0 0 0 1rem;min-width:450px}.title-content ::before{content:'';width:.25rem;height:1.125rem;background:#59a1ff;border-radius:1px;position:absolute;top:50%;left:0;margin-top:-.5625rem}.title-text{font-size:1rem;line-height:1.375rem;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;margin-bottom:0;margin-right:10px}.title-line{flex-grow:1;border-bottom:1px dashed rgba(0,0,0,.1)}"]
                }] }
    ];
    /** @nocollapse */
    PerformerOptionsComponent.ctorParameters = function () { return [
        { type: NgZone },
        { type: ProcessDesignerUIState },
        { type: ExpressionService },
        { type: MessagerService },
        { type: ChangeDetectorRef, decorators: [{ type: Optional }] },
        { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
        { type: undefined, decorators: [{ type: Inject, args: [WF_LANG_RESOURCES,] }] },
        { type: WfLocalePipe, decorators: [{ type: Optional }] }
    ]; };
    PerformerOptionsComponent.propDecorators = {
        cls: [{ type: HostBinding, args: ['class',] }],
        editorParams: [{ type: Input }],
        closeModal: [{ type: Output }],
        submitModal: [{ type: Output }],
        modalFooter: [{ type: ViewChild, args: ['iconSelectFooter',] }],
        value: [{ type: Input }],
        exclusionPerformers: [{ type: Input }],
        inputGroup: [{ type: ViewChild, args: ['inputGroup',] }]
    };
    return PerformerOptionsComponent;
}());
var PerformerOptionsConverter = /** @class */ (function () {
    function PerformerOptionsConverter(localePipe) {
        this.localePipe = localePipe;
    }
    /**
     * @param {?} data
     * @return {?}
     */
    PerformerOptionsConverter.prototype.convertTo = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        return this.localePipe.transform("component.performerOptions.set");
    };
    return PerformerOptionsConverter;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var PerformerComponent = /** @class */ (function () {
    function PerformerComponent(viewModel, uistate, formBuilder, resolver, injector, modalService, message, designerUIState, expr, http) {
        var _this = this;
        this.viewModel = viewModel;
        this.uistate = uistate;
        this.formBuilder = formBuilder;
        this.resolver = resolver;
        this.injector = injector;
        this.modalService = modalService;
        this.message = message;
        this.designerUIState = designerUIState;
        this.expr = expr;
        this.http = http;
        this.display = true; // 控制矩阵参与者是否显示
        // 控制矩阵参与者是否显示
        this.type = 'defaultPerformer';
        this.nodeType = 'userActivity';
        // 解决选择意见后，下拉菜单无法收折的问题
        this.closeModal = new EventEmitter();
        this.submitModal = new EventEmitter();
        this.editorParams = {};
        this.isClose = true;
        this.modalConfig = {
            title: '参与者',
            width: 700,
            height: 400,
            showButtons: true
        };
        this.columns = [
            {
                field: 'type', width: 50, title: '类型',
                formatter: {
                    type: 'enum',
                    options: { valueField: 'value', textField: 'text', data: this.uistate.typeCollection }
                }
            },
            { field: 'performerName', width: 50, title: '名称' },
            { field: 'description', width: 100, title: '描述', showTips: true },
            {
                field: 'condition', width: 60, title: '启用条件', showTips: true,
                editor: {
                    type: 'input-group',
                    options: {
                        groupText: '<i class="f-icon f-icon-lookup"></i>',
                        editable: false,
                        clickHandle: (/**
                         * @param {?} e
                         * @return {?}
                         */
                        function (e) {
                            e.formControl.setValue(e.instance.value ? e.instance.value : '');
                            _this.editConditon(e);
                        }),
                        clear: (/**
                         * @param {?} e
                         * @return {?}
                         */
                        function (e) {
                            if (e.rowData.type === 'wf.ComponentParticipantExpression') {
                                /** @type {?} */
                                var i = _this.uistate.performerInfo.components.findIndex((/**
                                 * @param {?} item
                                 * @return {?}
                                 */
                                function (item) { return item.id === e.rowData.id; }));
                                _this.uistate.performerInfo.components[i].condition = '';
                            }
                            else if (e.rowData.type === 'wf.ReportingLineParticipantExpression') {
                                /** @type {?} */
                                var i = _this.uistate.performerInfo.reportingLines.findIndex((/**
                                 * @param {?} item
                                 * @return {?}
                                 */
                                function (item) { return item.id === e.rowData.id; }));
                                _this.uistate.performerInfo.reportingLines[i].condition = '';
                            }
                            else if (e.rowData.type === 'wf.MatrixParticipantExpression') {
                                /** @type {?} */
                                var i = _this.uistate.performerInfo.matrixParticipants.findIndex((/**
                                 * @param {?} item
                                 * @return {?}
                                 */
                                function (item) { return item.id === e.rowData.id; }));
                                _this.uistate.performerInfo.matrixParticipants[i].condition = '';
                            }
                            else if (e.rowData.type === 'wf.ActivityExecutorParticipantExpression') {
                                /** @type {?} */
                                var i = _this.uistate.performerInfo.activityExecutors.findIndex((/**
                                 * @param {?} item
                                 * @return {?}
                                 */
                                function (item) { return item.id === e.rowData.id; }));
                                _this.uistate.performerInfo.activityExecutors[i].condition = '';
                            }
                            else if (e.rowData.type === 'wf.OrganizationParticipantExpression') {
                                _this.uistate.performerInfo.organizationParticipants[0].condition = '';
                            }
                        })
                    }
                }
            }
        ];
        this.editState = 'new'; // 编辑状态，用于区分是新增还是编辑  new | edit
        this.afterEdit = (/**
         * @param {?} rowIndex
         * @param {?} rowData
         * @param {?=} column
         * @return {?}
         */
        function (rowIndex, rowData, column) {
            return of$1(true);
        });
        this.GetOrganizationType();
    }
    Object.defineProperty(PerformerComponent.prototype, "value", {
        set: /**
         * @param {?} partInfo
         * @return {?}
         */
        function (partInfo) {
            var _this = this;
            if (partInfo.performers && partInfo.performers.length > 0) {
                this.uistate.performerInfo.performers = partInfo.performers;
                this.uistate.performersList = this.uistate.performersList.concat((/** @type {?} */ (partInfo.performers)));
                this.uistate.performersList.map((/**
                 * @param {?} performer
                 * @return {?}
                 */
                function (performer) { return performer.description = _this.performerDescription((/** @type {?} */ (performer))); }));
            }
            if (partInfo.variablePerformers && partInfo.variablePerformers.length > 0) {
                this.uistate.performerInfo.variablePerformers = partInfo.variablePerformers;
                this.uistate.performersList = this.uistate.performersList.concat((/** @type {?} */ (partInfo.variablePerformers)));
                this.uistate.performersList.map((/**
                 * @param {?} variablePerformers
                 * @return {?}
                 */
                function (variablePerformers) { return variablePerformers.description = _this.performerDescription((/** @type {?} */ (variablePerformers))); }));
            }
            if (partInfo.components && partInfo.components.length > 0) {
                this.uistate.performerInfo.components = partInfo.components;
                partInfo.components.forEach((/**
                 * @param {?} cmp
                 * @return {?}
                 */
                function (cmp) {
                    _this.uistate.performersList.push({
                        id: cmp.id,
                        type: 'wf.ComponentParticipantExpression',
                        performerName: cmp.name,
                        description: _this.componentDescription(cmp),
                        condition: cmp.condition
                    });
                }));
            }
            if (partInfo.reportingLines && partInfo.reportingLines.length > 0) {
                this.uistate.performerInfo.reportingLines = partInfo.reportingLines;
                partInfo.reportingLines.forEach((/**
                 * @param {?} r
                 * @return {?}
                 */
                function (r) {
                    _this.uistate.performersList.push({
                        id: r.id,
                        type: 'wf.ReportingLineParticipantExpression',
                        performerName: r.reportingLineDefName + '-' + r.dimension,
                        description: _this.reportingLineDescription(r),
                        condition: r.condition
                    });
                }));
            }
            if (partInfo.activityExecutors && partInfo.activityExecutors.length > 0) {
                this.uistate.performerInfo.activityExecutors = partInfo.activityExecutors;
                partInfo.activityExecutors.forEach((/**
                 * @param {?} handler
                 * @return {?}
                 */
                function (handler) {
                    _this.uistate.performersList.push({
                        id: handler.id,
                        type: 'wf.ActivityExecutorParticipantExpression',
                        performerName: '<' + handler.activityDefName + '>活动办理人',
                        description: '<' + handler.activityDefName + '>活动办理人',
                        condition: handler.condition
                    });
                }));
            }
            if (partInfo.matrixParticipants && partInfo.matrixParticipants.length > 0) {
                this.uistate.performerInfo.matrixParticipants = partInfo.matrixParticipants;
                partInfo.matrixParticipants.forEach((/**
                 * @param {?} r
                 * @return {?}
                 */
                function (r) {
                    _this.uistate.performersList.push({
                        id: r.id,
                        type: 'wf.MatrixParticipantExpression',
                        performerName: r.matrixDefName + '-' + r.dataFieldAlias,
                        description: _this.matrixDescription(r),
                        condition: r.condition
                    });
                }));
            }
            if (partInfo.organizationParticipants && partInfo.organizationParticipants.length > 0) {
                this.uistate.performerInfo.organizationParticipants = partInfo.organizationParticipants;
                partInfo.organizationParticipants.forEach((/**
                 * @param {?} o
                 * @return {?}
                 */
                function (o) {
                    _this.uistate.performersList.push({
                        id: o.id,
                        type: 'wf.OrganizationParticipantExpression',
                        performerName: o.organizationName,
                        description: o.organizationName + '，' + (o.includeChildren ? '包含下级' : '不包含下级'),
                        condition: o.condition
                    });
                }));
            }
            if (partInfo.options) {
                this.uistate.performerInfo.options = partInfo.options;
            }
            this.uistate.performerInfo.isAllScope = partInfo.isAllScope;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    PerformerComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.type = this.editorParams.type;
        this.nodeType = this.editorParams.nodeType;
        this.getMatrixConfig().subscribe((/**
         * @param {?} re
         * @return {?}
         */
        function (re) {
            if (re && re.currentValue === 'false') {
                _this.display = false;
            }
        }));
    };
    /**
     * @param {?} data
     * @return {?}
     */
    PerformerComponent.prototype.switchChange = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        if (data) {
            this.uistate.clearPerformer();
        }
    };
    // add() {
    //   this.editState = 'new';
    //   const compFactory = this.resolver.resolveComponentFactory(PerformerEditComponent);
    //   this.compRef = compFactory.create(this.injector);
    //   this.compRef.instance.display = this.display;
    //   const modalConfig = {
    //     title: '参与者选择',
    //     width: 700,
    //     height: 400,
    //     buttons: this.editFooter,
    //     showButtons: true
    //   };
    //   this.editDialog = this.modalService.show(this.compRef, modalConfig);
    // }
    // add() {
    //   this.editState = 'new';
    //   const compFactory = this.resolver.resolveComponentFactory(PerformerEditComponent);
    //   this.compRef = compFactory.create(this.injector);
    //   this.compRef.instance.display = this.display;
    //   const modalConfig = {
    //     title: '参与者选择',
    //     width: 700,
    //     height: 400,
    //     buttons: this.editFooter,
    //     showButtons: true
    //   };
    //   this.editDialog = this.modalService.show(this.compRef, modalConfig);
    // }
    /**
     * @param {?} performerType
     * @return {?}
     */
    PerformerComponent.prototype.addPerformer = 
    // add() {
    //   this.editState = 'new';
    //   const compFactory = this.resolver.resolveComponentFactory(PerformerEditComponent);
    //   this.compRef = compFactory.create(this.injector);
    //   this.compRef.instance.display = this.display;
    //   const modalConfig = {
    //     title: '参与者选择',
    //     width: 700,
    //     height: 400,
    //     buttons: this.editFooter,
    //     showButtons: true
    //   };
    //   this.editDialog = this.modalService.show(this.compRef, modalConfig);
    // }
    /**
     * @param {?} performerType
     * @return {?}
     */
    function (performerType) {
        this.editState = 'new';
        /** @type {?} */
        var compFactory = this.resolver.resolveComponentFactory(PerformerEditComponent);
        this.compRef = compFactory.create(this.injector);
        this.compRef.instance.display = this.display;
        this.compRef.instance.performerType = performerType;
        /** @type {?} */
        var modalConfig = {
            title: '参与者选择',
            width: 700,
            height: 400,
            buttons: this.editFooter,
            showButtons: true
        };
        this.editDialog = this.modalService.show(this.compRef, modalConfig);
        this.dropDownEl.close();
    };
    /**
     * @return {?}
     */
    PerformerComponent.prototype.edit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.editState = 'edit';
        if (this.uistate.curPerformer) {
            /** @type {?} */
            var modalConfig_1 = {
                title: '参与者选择',
                width: 700,
                height: 400,
                buttons: this.editFooter,
                showButtons: true
            };
            /** @type {?} */
            var compFactory = this.resolver.resolveComponentFactory(PerformerEditComponent);
            this.compRef = compFactory.create(this.injector);
            this.compRef.instance.performerType = this.uistate.curPerformer.type;
            switch (this.uistate.curPerformer.type) {
                case 'wf.PositionParticipantExpression':
                    this.compRef.instance.performer = {
                        type: 'wf.PositionParticipantExpression',
                        value: this.uistate.performerInfo.performers.find((/**
                         * @param {?} p
                         * @return {?}
                         */
                        function (p) { return p.id === _this.uistate.curPerformer.id; }))
                    };
                    break;
                case 'wf.UserParticipantExpression':
                    this.compRef.instance.performer = {
                        type: 'wf.UserParticipantExpression',
                        value: this.uistate.performerInfo.performers.find((/**
                         * @param {?} p
                         * @return {?}
                         */
                        function (p) { return p.id === _this.uistate.curPerformer.id; }))
                    };
                    break;
                case 'wf.VariableParticipantExpression':
                    this.compRef.instance.performer = {
                        type: 'wf.VariableParticipantExpression',
                        value: this.uistate.performerInfo.variablePerformers.find((/**
                         * @param {?} p
                         * @return {?}
                         */
                        function (p) { return p.id === _this.uistate.curPerformer.id; }))
                    };
                    break;
                case 'wf.ReportingLineParticipantExpression':
                    /** @type {?} */
                    var reportingLine = this.uistate.performerInfo.reportingLines.find((/**
                     * @param {?} r
                     * @return {?}
                     */
                    function (r) {
                        return r.id === _this.uistate.curPerformer.id;
                    }));
                    this.compRef.instance.performer = {
                        type: 'wf.ReportingLineParticipantExpression',
                        value: reportingLine
                    };
                    /** @type {?} */
                    var url = '/api/runtime/wf/v1.0/reportingLineDefinitions/' + reportingLine.reportingLineDefId;
                    this.http.get(url).subscribe((/**
                     * @param {?} res
                     * @return {?}
                     */
                    function (res) {
                        if (!res) {
                            _this.message.error('该条汇报关系数据的定义已删除，该条数据将删除');
                            _this.remove();
                        }
                        else {
                            _this.editDialog = _this.modalService.show(_this.compRef, modalConfig_1);
                        }
                    }));
                    break;
                case 'wf.MatrixParticipantExpression':
                    /** @type {?} */
                    var matrix = this.uistate.performerInfo.matrixParticipants.find((/**
                     * @param {?} r
                     * @return {?}
                     */
                    function (r) {
                        return r.id === _this.uistate.curPerformer.id;
                    }));
                    this.compRef.instance.performer = {
                        type: 'wf.MatrixParticipantExpression',
                        value: matrix
                    };
                    /** @type {?} */
                    var urlMatrix = '/api/runtime/wf/v1.0/matrixDefinition/' + matrix.matrixDefId;
                    this.http.get(urlMatrix).subscribe((/**
                     * @param {?} res
                     * @return {?}
                     */
                    function (res) {
                        if (!res) {
                            _this.message.error('该条矩阵数据的定义已删除，该条数据将删除');
                            _this.remove();
                        }
                        else {
                            _this.editDialog = _this.modalService.show(_this.compRef, modalConfig_1);
                        }
                    }));
                    break;
                case 'wf.ComponentParticipantExpression':
                    this.compRef.instance.performer = {
                        type: 'wf.ComponentParticipantExpression',
                        value: this.uistate.performerInfo.components.find((/**
                         * @param {?} c
                         * @return {?}
                         */
                        function (c) {
                            return c.id === _this.uistate.curPerformer.id;
                        }))
                    };
                    break;
                case 'wf.ActivityExecutorParticipantExpression':
                    this.compRef.instance.performer = {
                        type: 'wf.ActivityExecutorParticipantExpression',
                        value: this.uistate.performerInfo.activityExecutors.find((/**
                         * @param {?} c
                         * @return {?}
                         */
                        function (c) {
                            return c.id === _this.uistate.curPerformer.id;
                        }))
                    };
                    break;
                case 'wf.OrganizationParticipantExpression':
                    this.compRef.instance.performer = {
                        type: 'wf.OrganizationParticipantExpression',
                        value: this.uistate.performerInfo.organizationParticipants[0]
                    };
                    break;
            }
            if (this.uistate.curPerformer.type !== 'wf.ReportingLineParticipantExpression' &&
                this.uistate.curPerformer.type !== 'wf.MatrixParticipantExpression') { // 汇报关系和矩阵单独处理
                this.editDialog = this.modalService.show(this.compRef, modalConfig_1);
            }
        }
    };
    /**
     * @return {?}
     */
    PerformerComponent.prototype.remove = /**
     * @return {?}
     */
    function () {
        var _this = this;
        if (this.grid.selectedRow) {
            this.grid.endCellEdit();
            if (this.grid.selectedRow.data.type === 'wf.ComponentParticipantExpression') {
                /** @type {?} */
                var i = this.uistate.performerInfo.components.findIndex((/**
                 * @param {?} item
                 * @return {?}
                 */
                function (item) { return item.id === _this.grid.selectedRow.data.id; }));
                this.uistate.performerInfo.components.splice(i, 1);
            }
            else if (this.grid.selectedRow.data.type === 'wf.ReportingLineParticipantExpression') {
                /** @type {?} */
                var i = this.uistate.performerInfo.reportingLines.findIndex((/**
                 * @param {?} item
                 * @return {?}
                 */
                function (item) { return item.id === _this.grid.selectedRow.data.id; }));
                this.uistate.performerInfo.reportingLines.splice(i, 1);
            }
            else if (this.grid.selectedRow.data.type === 'wf.MatrixParticipantExpression') {
                /** @type {?} */
                var i = this.uistate.performerInfo.matrixParticipants.findIndex((/**
                 * @param {?} item
                 * @return {?}
                 */
                function (item) { return item.id === _this.grid.selectedRow.data.id; }));
                this.uistate.performerInfo.matrixParticipants.splice(i, 1);
            }
            else if (this.grid.selectedRow.data.type === 'wf.ActivityExecutorParticipantExpression') {
                /** @type {?} */
                var i = this.uistate.performerInfo.activityExecutors.findIndex((/**
                 * @param {?} item
                 * @return {?}
                 */
                function (item) { return item.id === _this.grid.selectedRow.data.id; }));
                this.uistate.performerInfo.activityExecutors.splice(i, 1);
            }
            else if (this.grid.selectedRow.data.type === 'wf.OrganizationParticipantExpression') {
                /** @type {?} */
                var i = this.uistate.performerInfo.organizationParticipants = new Array();
            }
            else if (this.grid.selectedRow.data.type === 'wf.VariableParticipantExpression') {
                /** @type {?} */
                var i = this.uistate.performerInfo.variablePerformers.findIndex((/**
                 * @param {?} item
                 * @return {?}
                 */
                function (item) { return item.id === _this.grid.selectedRow.data.id; }));
                this.uistate.performerInfo.variablePerformers.splice(i, 1);
            }
            else {
                /** @type {?} */
                var i = this.uistate.performerInfo.performers.findIndex((/**
                 * @param {?} item
                 * @return {?}
                 */
                function (item) { return item.id === _this.grid.selectedRow.data.id; }));
                this.uistate.performerInfo.performers.splice(i, 1);
            }
            /** @type {?} */
            var index = this.uistate.performersList.findIndex((/**
             * @param {?} p
             * @return {?}
             */
            function (p) { return p.id === _this.grid.selectedRow.data.id; }));
            this.uistate.performersList.splice(index, 1);
            this.grid.loadData(this.uistate.performersList);
        }
        else {
            this.message.info('请先选中一条参与者信息！');
        }
    };
    /**
     * @return {?}
     */
    PerformerComponent.prototype.clear = /**
     * @return {?}
     */
    function () {
        this.uistate.performerInfo.performers = [];
        this.uistate.performerInfo.variablePerformers = [];
        this.uistate.performerInfo.components = [];
        this.uistate.performerInfo.reportingLines = [];
        this.uistate.performerInfo.matrixParticipants = [];
        this.uistate.performerInfo.activityExecutors = [];
        this.uistate.performerInfo.organizationParticipants = new Array();
        this.uistate.performersList = [];
        this.grid.loadData(this.uistate.performersList);
    };
    /**
     * @return {?}
     */
    PerformerComponent.prototype.clickOK = /**
     * @return {?}
     */
    function () {
        this.grid.endCellEdit();
        /** @type {?} */
        var object = {
            value: this.uistate.performerInfo, parameters: null
        };
        this.submitModal.emit(object);
    };
    /**
     * @return {?}
     */
    PerformerComponent.prototype.clickCancel = /**
     * @return {?}
     */
    function () {
        this.closeModal.emit();
    };
    /**
     * @return {?}
     */
    PerformerComponent.prototype.editOK = /**
     * @return {?}
     */
    function () {
        var _this = this;
        var e_1, _a;
        this.isClose = true;
        if (this.compRef) {
            /** @type {?} */
            var re_1 = this.compRef.instance.getPerformers();
            if (re_1.userPerformers && re_1.userPerformers.length > 0) {
                re_1.userPerformers.forEach((/**
                 * @param {?} p
                 * @return {?}
                 */
                function (p) {
                    /** @type {?} */
                    var i = _this.uistate.performerInfo.performers.findIndex((/**
                     * @param {?} a
                     * @return {?}
                     */
                    function (a) { return (a.id === p.id || a.performerId === p.performerId); }));
                    if (i > -1) {
                        /** @type {?} */
                        var id_1 = _this.uistate.performerInfo.performers[i].id;
                        _this.uistate.performerInfo.performers[i] = p;
                        /** @type {?} */
                        var index = _this.uistate.performersList.findIndex((/**
                         * @param {?} a
                         * @return {?}
                         */
                        function (a) { return a.id === id_1; }));
                        _this.uistate.performersList[index] = p;
                    }
                    else {
                        if (_this.editState === 'edit') {
                            _this.remove();
                        }
                        _this.uistate.performerInfo.performers.push(p);
                        _this.uistate.performersList = _this.uistate.performersList.concat([p]);
                    }
                }));
                this.uistate.performersList
                    .filter((/**
                 * @param {?} p
                 * @return {?}
                 */
                function (p) { return p.type === _this.uistate.typeCollection[0].value || p.type === _this.uistate.typeCollection[1].value; }))
                    .map((/**
                 * @param {?} performer
                 * @return {?}
                 */
                function (performer) { return performer.description =
                    _this.performerDescription((/** @type {?} */ (performer))); }));
            }
            if (re_1.positions && re_1.positions.length > 0) {
                var _loop_1 = function (position) {
                    if (position && position !== null && position.id) {
                        /** @type {?} */
                        var p_1 = position;
                        if (!p_1.performerId) {
                            this_1.message.info('尚未选择岗位！');
                            this_1.isClose = false;
                        }
                        else {
                            if ((!p_1.orgType || p_1.orgType == null) && (p_1.isRequired && p_1.positionType === '1')) {
                                this_1.message.info('尚未选择组织类型！');
                                this_1.isClose = false;
                            }
                            else if ((!p_1.orgId || p_1.orgId == null) && (p_1.isRequired && p_1.positionType === '1')) {
                                this_1.message.info('尚未填写组织！');
                                this_1.isClose = false;
                            }
                            else {
                                // (1)id一致，为编辑岗位；（2）performid一致，新增的用户，岗位已存在
                                /** @type {?} */
                                var i = this_1.uistate.performerInfo.performers.findIndex((/**
                                 * @param {?} a
                                 * @return {?}
                                 */
                                function (a) { return (a.id === p_1.id || (a.performerId === p_1.performerId && a.orgId === p_1.orgId)); }));
                                if (i > -1) {
                                    /** @type {?} */
                                    var id_2 = this_1.uistate.performerInfo.performers[i].id;
                                    this_1.uistate.performerInfo.performers[i] = p_1;
                                    /** @type {?} */
                                    var index = this_1.uistate.performersList.findIndex((/**
                                     * @param {?} a
                                     * @return {?}
                                     */
                                    function (a) { return a.id === id_2; }));
                                    this_1.uistate.performersList[index] = p_1;
                                }
                                else {
                                    this_1.uistate.performerInfo.performers.push(p_1);
                                    this_1.uistate.performersList = this_1.uistate.performersList.concat([p_1]);
                                }
                                this_1.uistate.performersList
                                    .filter((/**
                                 * @param {?} p
                                 * @return {?}
                                 */
                                function (p) { return p.type === _this.uistate.typeCollection[0].value || p.type === _this.uistate.typeCollection[1].value; }))
                                    .map((/**
                                 * @param {?} performer
                                 * @return {?}
                                 */
                                function (performer) { return performer.description =
                                    _this.performerDescription((/** @type {?} */ (performer))); }));
                            }
                        }
                    }
                };
                var this_1 = this;
                try {
                    for (var _b = __values(re_1.positions), _c = _b.next(); !_c.done; _c = _b.next()) {
                        var position = _c.value;
                        _loop_1(position);
                    }
                }
                catch (e_1_1) { e_1 = { error: e_1_1 }; }
                finally {
                    try {
                        if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                    }
                    finally { if (e_1) throw e_1.error; }
                }
            }
            if (re_1.component && re_1.component.metadataId && re_1.component.methodCode) {
                /** @type {?} */
                var i = this.uistate.performerInfo.components.findIndex((/**
                 * @param {?} a
                 * @return {?}
                 */
                function (a) { return a.id === re_1.component.id; }));
                if (i > -1) {
                    this.uistate.performerInfo.components[i] = re_1.component;
                    /** @type {?} */
                    var index = this.uistate.performersList.findIndex((/**
                     * @param {?} a
                     * @return {?}
                     */
                    function (a) { return a.id === re_1.component.id; }));
                    this.uistate.performersList[index] = {
                        id: re_1.component.id,
                        type: 'wf.ComponentParticipantExpression',
                        performerName: re_1.component.name,
                        description: this.componentDescription(re_1.component),
                        condition: re_1.component.condition
                    };
                }
                else {
                    this.uistate.performerInfo.components.push(re_1.component);
                    this.uistate.performersList.push({
                        id: re_1.component.id,
                        type: 'wf.ComponentParticipantExpression',
                        performerName: re_1.component.name,
                        description: this.componentDescription(re_1.component),
                        condition: ''
                    });
                }
            }
            if (re_1.reportingLine && re_1.reportingLine.reportingLineDefId && re_1.reportingLine.dimension) {
                if (re_1.reportingLine.reportingReferObject === 'dept' && !re_1.reportingLine.refOrgId) {
                    this.isClose = false;
                    this.message.info('“部门”汇报关系类型下，参照人所在部门不能为空');
                }
                else if (re_1.reportingLine.reportingReferObject !== 'dept' && !re_1.reportingLine.refUserId && !re_1.reportingLine.refEmployeeId) { // 用户及其他人员汇报对象类型，参照用户和参照员工不能全部为空
                    this.isClose = false;
                    this.message.info('“用户”汇报关系类型下，参照人不能为空');
                }
                else {
                    this.isClose = true;
                    this.addReportingLineData(re_1);
                }
            }
            if (re_1.matrix && re_1.matrix.matrixDefId) {
                if (!re_1.matrix.conditionField1 && !re_1.matrix.conditionField2 && !re_1.matrix.conditionField3) {
                    this.isClose = false;
                    this.message.info('条件字段至少要存在一个');
                }
                else if (!re_1.matrix.dataFieldAlias) {
                    this.isClose = false;
                    this.message.info('数据字段不能为空');
                }
                else {
                    this.isClose = true;
                    this.addMatrixData(re_1);
                }
            }
            if (re_1.activityExecutorPerformers && re_1.activityExecutorPerformers.length > 0) {
                re_1.activityExecutorPerformers.forEach((/**
                 * @param {?} p
                 * @return {?}
                 */
                function (p) {
                    /** @type {?} */
                    var i = _this.uistate.performerInfo.activityExecutors.findIndex((/**
                     * @param {?} a
                     * @return {?}
                     */
                    function (a) { return (a.id === p.id || a.activityDefId === p.activityDefId); }));
                    if (i < 0) {
                        if (_this.editState === 'edit') {
                            _this.remove(); // 在编辑状态下配置了活动办理人参与者，先将选中的删除
                        }
                        _this.uistate.performerInfo.activityExecutors.push(p);
                        _this.uistate.performersList = _this.uistate.performersList.concat([p]);
                    }
                }));
                this.uistate.performersList
                    .filter((/**
                 * @param {?} p
                 * @return {?}
                 */
                function (p) { return p.type === _this.uistate.typeCollection[5].value; }))
                    .map((/**
                 * @param {?} performer
                 * @return {?}
                 */
                function (performer) { return performer.description =
                    _this.performerDescription((/** @type {?} */ (performer))); }));
            }
            if (re_1.organizationParticipant) {
                console.log(re_1.organizationParticipant);
                this.uistate.performerInfo.organizationParticipants = [re_1.organizationParticipant];
                this.uistate.performersList = this.uistate.performersList.filter((/**
                 * @param {?} p
                 * @return {?}
                 */
                function (p) { return p.type !== 'wf.OrganizationParticipantExpression'; }));
                this.uistate.performersList = this.uistate.performersList.concat({
                    id: re_1.organizationParticipant.id || ProcessDeUtil.GenerateElementId(),
                    type: 'wf.OrganizationParticipantExpression',
                    performerName: re_1.organizationParticipant.organizationName,
                    description: re_1.organizationParticipant.organizationName + '，且' + (re_1.organizationParticipant.includeChildren ? '包含下级' : '不包含下级'),
                    condition: re_1.organizationParticipant.condition
                });
            }
            this.grid.loadData(this.uistate.performersList);
        }
        if (this.editDialog && this.isClose) {
            this.editDialog.close();
        }
    };
    /**
     * @private
     * @param {?} re
     * @return {?}
     */
    PerformerComponent.prototype.addReportingLineData = /**
     * @private
     * @param {?} re
     * @return {?}
     */
    function (re) {
        var e_2, _a;
        /** @type {?} */
        var i = this.uistate.performerInfo.reportingLines.findIndex((/**
         * @param {?} a
         * @return {?}
         */
        function (a) { return a.id === re.reportingLine.id; }));
        if (i > -1) {
            this.uistate.performerInfo.reportingLines[i] = re.reportingLine;
            /** @type {?} */
            var index = this.uistate.performersList.findIndex((/**
             * @param {?} a
             * @return {?}
             */
            function (a) { return a.id === re.reportingLine.id; }));
            this.uistate.performersList[index] = {
                id: re.reportingLine.id,
                type: 'wf.ReportingLineParticipantExpression',
                performerName: re.reportingLine.reportingLineDefName + '-' + re.reportingLine.dimension,
                description: this.reportingLineDescription(re.reportingLine),
                condition: re.reportingLine.condition
            };
        }
        else {
            try {
                for (var _b = __values(this.uistate.performerInfo.reportingLines), _c = _b.next(); !_c.done; _c = _b.next()) {
                    var reportingLineData = _c.value;
                    if (reportingLineData.reportingLineDefId === re.reportingLine.definitionId &&
                        reportingLineData.dimension === re.reportingLine.dimension &&
                        reportingLineData.refUserId === re.reportingLine.referUserId &&
                        reportingLineData.refEmployeeId === re.reportingLine.refEmployeeId &&
                        reportingLineData.refOrgId === re.reportingLine.referDeptId) {
                        this.message.error('该汇报关系已经进行过配置');
                        return;
                    }
                }
            }
            catch (e_2_1) { e_2 = { error: e_2_1 }; }
            finally {
                try {
                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                }
                finally { if (e_2) throw e_2.error; }
            }
            this.uistate.performerInfo.reportingLines.push(re.reportingLine);
            this.uistate.performersList.push({
                id: re.reportingLine.id,
                type: 'wf.ReportingLineParticipantExpression',
                performerName: re.reportingLine.reportingLineDefName + '-' + re.reportingLine.dimension,
                description: this.reportingLineDescription(re.reportingLine),
                condition: re.reportingLine.condition
            });
        }
    };
    /**
     * @private
     * @param {?} re
     * @return {?}
     */
    PerformerComponent.prototype.addMatrixData = /**
     * @private
     * @param {?} re
     * @return {?}
     */
    function (re) {
        var e_3, _a;
        /** @type {?} */
        var i = this.uistate.performerInfo.matrixParticipants.findIndex((/**
         * @param {?} a
         * @return {?}
         */
        function (a) { return a.id === re.matrix.id; }));
        if (i > -1) {
            this.uistate.performerInfo.matrixParticipants[i] = re.matrix;
            /** @type {?} */
            var index = this.uistate.performersList.findIndex((/**
             * @param {?} a
             * @return {?}
             */
            function (a) { return a.id === re.matrix.id; }));
            this.uistate.performersList[index] = {
                id: re.matrix.id,
                type: 'wf.MatrixParticipantExpression',
                performerName: re.matrix.matrixDefName + '-' + re.matrix.dataFieldAlias,
                description: this.matrixDescription(re.matrix),
                condition: re.matrix.condition
            };
        }
        else {
            try {
                for (var _b = __values(this.uistate.performerInfo.matrixParticipants), _c = _b.next(); !_c.done; _c = _b.next()) {
                    var matrixData = _c.value;
                    if (matrixData.matrixDefId === re.matrix.matrixDefId &&
                        matrixData.conditionField1 === re.matrix.conditionField1 &&
                        matrixData.conditionField2 === re.matrix.conditionField2 &&
                        matrixData.conditionField3 === re.matrix.conditionField3 &&
                        matrixData.dataFieldAlias === re.matrix.dataFieldAlias) {
                        this.message.error('该矩阵已经进行过配置');
                        return;
                    }
                }
            }
            catch (e_3_1) { e_3 = { error: e_3_1 }; }
            finally {
                try {
                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                }
                finally { if (e_3) throw e_3.error; }
            }
            this.uistate.performerInfo.matrixParticipants.push(re.matrix);
            this.uistate.performersList.push({
                id: re.matrix.id,
                type: 'wf.MatrixParticipantExpression',
                performerName: re.matrix.matrixDefName + '-' + re.matrix.dataFieldAlias,
                description: this.matrixDescription(re.matrix),
                condition: re.matrix.condition
            });
        }
    };
    /**
     * @return {?}
     */
    PerformerComponent.prototype.editCancel = /**
     * @return {?}
     */
    function () {
        if (this.editDialog) {
            this.editDialog.close();
        }
    };
    /**
     * @return {?}
     */
    PerformerComponent.prototype.participantOptionsSet = /**
     * @return {?}
     */
    function () {
        this.uistate.performerInfo.options = this.options.getPerformerOptions();
        this.optionsDialog.close();
    };
    /**
     * @private
     * @param {?} performer
     * @return {?}
     */
    PerformerComponent.prototype.performerDescription = /**
     * @private
     * @param {?} performer
     * @return {?}
     */
    function (performer) {
        if (performer.type === 'wf.UserParticipantExpression' || performer.type === 'wf.VariableParticipantExpression') {
            if (performer.tag === 'expression') {
                return performer.performerId;
            }
            else {
                if (performer.orgName) {
                    return "\u7EC4\u7EC7\uFF1A" + performer.orgName;
                }
                else {
                    return '';
                }
            }
        }
        else if (performer.type === 'wf.PositionParticipantExpression') {
            if (this.designerUIState.scene === 'inSuite') {
                return null;
            }
            if (((/** @type {?} */ (performer))).positionType === '1') {
                if (performer.orgId) {
                    return "\u5C97\u4F4D\u7C7B\u578B\uFF1A\u901A\u7528\u5C97\u4F4D\uFF0C\u7EC4\u7EC7\uFF1A" + performer.orgId;
                }
                else {
                    return "\u5C97\u4F4D\u7C7B\u578B\uFF1A\u901A\u7528\u5C97\u4F4D";
                }
            }
            else if (((/** @type {?} */ (performer))).positionType === '0') {
                return '岗位类型：组织岗位';
            }
        }
        else if (performer.type === 'wf.ActivityExecutorParticipantExpression') {
            return performer.performerName;
        }
    };
    /**
     * @private
     * @param {?} component
     * @return {?}
     */
    PerformerComponent.prototype.componentDescription = /**
     * @private
     * @param {?} component
     * @return {?}
     */
    function (component) {
        /** @type {?} */
        var des = "\u6784\u4EF6\uFF1A" + component.name + ",\u53C2\u6570\uFF1A{";
        if (component.actualParameters && component.actualParameters.length > 0) {
            component.actualParameters.forEach((/**
             * @param {?} p
             * @return {?}
             */
            function (p) {
                des += p.code + "\uFF1A" + p.value + "\uFF0C";
            }));
            des = des.substring(0, des.length - 1);
        }
        des += '}';
        return des;
    };
    /**
     * @private
     * @param {?} reportingLine
     * @return {?}
     */
    PerformerComponent.prototype.reportingLineDescription = /**
     * @private
     * @param {?} reportingLine
     * @return {?}
     */
    function (reportingLine) {
        /** @type {?} */
        var description = '';
        if (reportingLine.refUserId) {
            description += "\u53C2\u7167\u4EBA\uFF1A" + reportingLine.refUserId;
        }
        if (reportingLine.refEmployeeId) {
            description += "\u53C2\u7167\u4EBA\uFF1A" + reportingLine.refEmployeeId;
        }
        if (reportingLine.refOrgId) {
            if (reportingLine.refUserId) {
                description += "\uFF0C";
            }
            if (reportingLine.refEmployeeId) {
                description += "\uFF0C";
            }
            description += "\u53C2\u7167\u7EC4\u7EC7\uFF1A" + reportingLine.refOrgId;
        }
        return description;
    };
    /**
     * @private
     * @param {?} matrix
     * @return {?}
     */
    PerformerComponent.prototype.matrixDescription = /**
     * @private
     * @param {?} matrix
     * @return {?}
     */
    function (matrix) {
        /** @type {?} */
        var description = '';
        if (matrix.conditionField1) {
            description += "\u6761\u4EF61\uFF1A" + matrix.conditionFieldText1 + "\uFF0C";
        }
        if (matrix.conditionField2) {
            description += "\u6761\u4EF62\uFF1A" + matrix.conditionFieldText2 + "\uFF0C";
        }
        if (matrix.conditionField3) {
            description += "\u6761\u4EF63\uFF1A" + matrix.conditionFieldText3 + "\uFF0C";
        }
        if (matrix.dataFieldAlias) {
            description += "\u6570\u636E\uFF1A" + matrix.dataFieldAlias + "\uFF0C";
        }
        return description.slice(0, description.length - 1);
    };
    /**
     * @param {?} e
     * @return {?}
     */
    PerformerComponent.prototype.editConditon = /**
     * @param {?} e
     * @return {?}
     */
    function (e) {
        var _this = this;
        var e_4, _a, e_5, _b, e_6, _c, e_7, _d;
        // this.expr.clearContext();
        if (this.designerUIState.schemas.length > 0) {
            try {
                for (var _e = __values(this.designerUIState.schemas), _f = _e.next(); !_f.done; _f = _e.next()) {
                    var schema = _f.value;
                    this.expr.addSchema('Schema', schema);
                }
            }
            catch (e_4_1) { e_4 = { error: e_4_1 }; }
            finally {
                try {
                    if (_f && !_f.done && (_a = _e.return)) _a.call(_e);
                }
                finally { if (e_4) throw e_4.error; }
            }
            if (this.designerUIState.schemas[0].entityTypes && this.designerUIState.schemas[0].entityTypes.length > 0) {
                /** @type {?} */
                var entityType = this.designerUIState.schemas[0].entityTypes[0];
                this.expr.addInjectedEntity(entityType.name, 'Schema', entityType.name, InjectedType.EntityType);
            }
        }
        /** @type {?} */
        var context = new Array();
        context = this.designerUIState.addContext(context);
        if (this.designerUIState.subActivityContext.length > 0) {
            var _loop_2 = function (variable) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    context.push(variable);
                }
            };
            try {
                for (var _g = __values(this.designerUIState.subActivityContext), _h = _g.next(); !_h.done; _h = _g.next()) {
                    var variable = _h.value;
                    _loop_2(variable);
                }
            }
            catch (e_5_1) { e_5 = { error: e_5_1 }; }
            finally {
                try {
                    if (_h && !_h.done && (_b = _g.return)) _b.call(_g);
                }
                finally { if (e_5) throw e_5.error; }
            }
        }
        if (this.designerUIState.activityComponentContext.length > 0) {
            var _loop_3 = function (variable) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    context.push(variable);
                }
            };
            try {
                for (var _j = __values(this.designerUIState.activityComponentContext), _k = _j.next(); !_k.done; _k = _j.next()) {
                    var variable = _k.value;
                    _loop_3(variable);
                }
            }
            catch (e_6_1) { e_6 = { error: e_6_1 }; }
            finally {
                try {
                    if (_k && !_k.done && (_c = _j.return)) _c.call(_j);
                }
                finally { if (e_6) throw e_6.error; }
            }
        }
        if (context.length > 0) {
            try {
                for (var context_1 = __values(context), context_1_1 = context_1.next(); !context_1_1.done; context_1_1 = context_1.next()) {
                    var v = context_1_1.value;
                    this.expr.addContext(v);
                }
            }
            catch (e_7_1) { e_7 = { error: e_7_1 }; }
            finally {
                try {
                    if (context_1_1 && !context_1_1.done && (_d = context_1.return)) _d.call(context_1);
                }
                finally { if (e_7) throw e_7.error; }
            }
        }
        this.expr.addExpressionText(e.instance.value);
        this.expr.setEditPattern(ExprEditMode.Conditional); // 默认打开简易表达式编辑器
        this.expr.buildExpression().then((/**
         * @param {?} cond
         * @return {?}
         */
        function (cond) {
            if (_this.grid.selectedRow.data.type === 'wf.ComponentParticipantExpression') {
                _this.uistate.performerInfo.components.find((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.id === _this.grid.selectedRow.data.id; })).condition = cond;
            }
            else if (_this.grid.selectedRow.data.type === 'wf.ReportingLineParticipantExpression') {
                _this.uistate.performerInfo.reportingLines.find((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.id === _this.grid.selectedRow.data.id; })).condition = cond;
            }
            else if (_this.grid.selectedRow.data.type === 'wf.MatrixParticipantExpression') {
                _this.uistate.performerInfo.matrixParticipants.find((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.id === _this.grid.selectedRow.data.id; })).condition = cond;
            }
            else if (_this.grid.selectedRow.data.type === 'wf.ActivityExecutorParticipantExpression') {
                _this.uistate.performerInfo.activityExecutors.find((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.id === _this.grid.selectedRow.data.id; })).condition = cond;
            }
            else {
                _this.uistate.performerInfo.performers.find((/**
                 * @param {?} p
                 * @return {?}
                 */
                function (p) { return p.id === _this.grid.selectedRow.data.id; })).condition = cond;
            }
            e.formControl.setValue(cond);
            e.instance.cd.detectChanges();
            //点击确定后，去除表达式里面的新增的上下文变量
            if (context.length > 0) {
                _this.expr.exprEntity.contextEntities = _this.expr.exprEntity.contextEntities.filter((/**
                 * @param {?} x
                 * @return {?}
                 */
                function (x) { return !context.some((/**
                 * @param {?} y
                 * @return {?}
                 */
                function (y) { return y.key === x.key; })); }));
            }
        }));
    };
    /**
     * @param {?} data
     * @return {?}
     */
    PerformerComponent.prototype.selectChanged = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        this.uistate.curPerformer = data.data;
    };
    /**
     * @private
     * @return {?}
     */
    PerformerComponent.prototype.GetOrganizationType = /**
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var url = '/api/runtime/sys/v1.0/authfields/globalauthfields';
        this.http.get(url)
            .subscribe((/**
         * @param {?} data
         * @return {?}
         */
        function (data) { return _this.designerUIState.orgTypeCollection = data.map((/**
         * @param {?} d
         * @return {?}
         */
        function (d) { return ({ value: d.id, text: d.name }); })); }));
    };
    /**
     * @private
     * @return {?}
     */
    PerformerComponent.prototype.getMatrixConfig = /**
     * @private
     * @return {?}
     */
    function () {
        /** @type {?} */
        var url = "/api/runtime/wf/v1.0/generalConfig/Is_EnableMatrix";
        return this.http.get(url);
    };
    PerformerComponent.decorators = [
        { type: Component, args: [{
                    selector: 'app-performer',
                    template: "<div class=\"f-page\">\r\n  <div class=\"f-page-header\">\r\n    <nav class=\"f-page-header-base\">\r\n      <div class=\"f-title\">\r\n        <span class=\"f-title-icon f-text-orna-bill\">\r\n          <i class=\"f-icon f-icon-page-title-administer\"></i>\r\n        </span>\r\n        <h4 *ngIf=\"nodeType==='notifyActivity' || type==='defaultPerformer'\"  class=\"f-title-text\">\u529E\u7406\u4EBA\u5217\u8868</h4>\r\n        <h5 *ngIf=\"type==='assignPerformer'\" class=\"f-title-subtitle\">\u5168\u5458\u8303\u56F4</h5>\r\n        <farris-switch *ngIf=\"type==='assignPerformer'\" style=\"height: 22px;\"\r\n          [(ngModel)]=\"uistate.performerInfo.isAllScope\" name=\"isAllScope\"\r\n          [readonly]=\"false\" (valueChange)=\"switchChange($event)\"></farris-switch>\r\n      </div>\r\n      <div class=\"btn-toolbar btn-group-lg\">\r\n      <!--<button class=\"btn btn-primary mr-2\" (click)=\"add()\">\u65B0\u589E</button>-->\r\n        <div *ngIf=\"type!=='assignPerformer' || !uistate.performerInfo.isAllScope\" class=\"btn-group mr-2\"  fDropdown #dropdownEl=\"fDropdown\">\r\n          <button class=\"btn btn-primary dropdown-toggle\" fDropdownToggle type=\"button\">\r\n            \u65B0\u589E\r\n          </button>\r\n          <div class=\"dropdown-menu\" fDropdownMenu>\r\n            <li class=\"dropdown-item\" (click)=\"addPerformer('wf.UserParticipantExpression')\"><span>\u7528\u6237</span></li>\r\n            <li class=\"dropdown-item\" (click)=\"addPerformer('wf.VariableParticipantExpression')\"><span>\u53D8\u91CF\u53C2\u4E0E\u8005</span></li>\r\n            <li class=\"dropdown-item\" (click)=\"addPerformer('wf.PositionParticipantExpression')\"><span>{{designerUIState.scene==='inSuite'?'\u89D2\u8272':'\u5C97\u4F4D'}}</span></li>\r\n            <li class=\"dropdown-item\" (click)=\"addPerformer('wf.ReportingLineParticipantExpression')\"><span>\u6C47\u62A5\u5173\u7CFB</span></li>\r\n            <li class=\"dropdown-item\" (click)=\"addPerformer('wf.ActivityExecutorParticipantExpression')\"><span>\u5386\u53F2\u6D3B\u52A8\u529E\u7406\u4EBA</span></li>\r\n            <li class=\"dropdown-item\" (click)=\"addPerformer('wf.MatrixParticipantExpression')\"><span>\u77E9\u9635\u5173\u7CFB</span></li>\r\n            <li class=\"dropdown-item\" (click)=\"addPerformer('wf.ComponentParticipantExpression')\"><span>\u53C2\u4E0E\u8005\u6784\u4EF6</span></li>\r\n            <li *ngIf=\"type==='assignPerformer'\" class=\"dropdown-item\" (click)=\"addPerformer('wf.OrganizationParticipantExpression')\"><span>\u5355\u4F4D/\u90E8\u95E8\r\n            </span></li>\r\n          </div>\r\n        </div>\r\n        <button *ngIf=\"type!=='assignPerformer' || !uistate.performerInfo.isAllScope\" class=\"btn btn-secondary mr-2\" [disabled]=\"(!uistate.curPerformer)\"\r\n        (click)=\"edit()\">\u7F16\u8F91</button>\r\n        <button *ngIf=\"type!=='assignPerformer' || !uistate.performerInfo.isAllScope\" class=\"btn btn-secondary mr-2\" (click)=\"remove()\">\u79FB\u9664</button>\r\n        <button *ngIf=\"type!=='assignPerformer' || !uistate.performerInfo.isAllScope\" class=\"btn btn-secondary mr-2\" (click)=\"clear()\">\u6E05\u7A7A</button>\r\n        <button *ngIf=\"nodeType==='userActivity' && type==='defaultPerformer'\" class=\"btn btn-secondary\" (click)=\"participantOptions.show()\">\u529E\u7406\u4EBA\u9009\u9879</button>\r\n      </div>\r\n    </nav>\r\n  </div>\r\n  <div class=\"f-page-main f-utils-fill-flex-column h-100\">\r\n    <div class=\"f-utils-fill-flex-column farris-overflow-y-auto h-100\">\r\n      <farris-datagrid #grid [data]=\"uistate.performersList\" [columns]=\"columns\" [idField]=\"'id'\" [fit]=\"true\"\r\n        [fitColumns]=\"true\" [editable]=\"true\" [editMode]=\"'cell'\" [pagination]=\"false\" [showCheckbox]=\"false\"\r\n        [multiSelect]=\"false\" [afterEdit]=\"afterEdit\" (selectChanged)=\"selectChanged($event)\">\r\n      </farris-datagrid>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type=\"button\" class=\"btn btn-secondary btn-sm px-3 mx-2\" (click)=\"clickCancel()\">\u53D6\u6D88</button>\r\n  <button type=\"button\" class=\"btn btn-primary btn-sm px-3 mx-2\" (click)=\"clickOK()\">\u786E\u5B9A</button>\r\n</ng-template>\r\n\r\n<ng-template #editFooter>\r\n  <button type=\"button\" class=\"btn btn-secondary btn-sm px-3 mx-2\" (click)=\"editCancel()\">\u53D6\u6D88</button>\r\n  <button type=\"button\" class=\"btn btn-primary btn-sm px-3 mx-2\" (click)=\"editOK()\">\u786E\u5B9A</button>\r\n</ng-template>\r\n\r\n<farris-dialog #participantOptions [buttons]=\"buttonRef\" [width]=\"500\" [height]=\"530\" title=\"'\u53C2\u4E0E\u8005\u9009\u9879'\">\r\n  <app-performer-options [value]=\"uistate.performerInfo.options\"></app-performer-options>\r\n</farris-dialog>\r\n<ng-template #buttonRef>\r\n  <button class=\"btn btn-sm btn-default px-3\" (click)=\"participantOptions.close()\">\u53D6\u6D88</button>\r\n  <button class=\"btn btn-sm btn-primary px-3\" (click)=\"participantOptionsSet()\">\u786E\u5B9A</button>\r\n</ng-template>\r\n",
                    providers: [PerformerViewModel, PerformerRepository, PerformerUIState],
                    styles: [""]
                }] }
    ];
    /** @nocollapse */
    PerformerComponent.ctorParameters = function () { return [
        { type: PerformerViewModel },
        { type: PerformerUIState },
        { type: FormBuilder },
        { type: ComponentFactoryResolver },
        { type: Injector },
        { type: BsModalService },
        { type: MessagerService },
        { type: ProcessDesignerUIState },
        { type: ExpressionService },
        { type: HttpService }
    ]; };
    PerformerComponent.propDecorators = {
        modalFooter: [{ type: ViewChild, args: ['iconSelectFooter',] }],
        editFooter: [{ type: ViewChild, args: ['editFooter',] }],
        options: [{ type: ViewChild, args: [PerformerOptionsComponent,] }],
        optionsDialog: [{ type: ViewChild, args: ['participantOptions',] }],
        grid: [{ type: ViewChild, args: [DatagridComponent,] }],
        dropDownEl: [{ type: ViewChild, args: ['dropdownEl',] }],
        closeModal: [{ type: Output }],
        submitModal: [{ type: Output }],
        value: [{ type: Input }],
        editorParams: [{ type: Input }]
    };
    return PerformerComponent;
}());
var PerformerConverter = /** @class */ (function () {
    function PerformerConverter() {
    }
    /**
     * @param {?} data
     * @return {?}
     */
    PerformerConverter.prototype.convertTo = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        if ((data.performers && data.performers.length > 0)
            || (data.variablePerformers && data.variablePerformers.length > 0)
            || (data.components && data.components.length > 0)
            || (data.reportingLines && data.reportingLines.length > 0)
            || (data.matrixParticipants && data.matrixParticipants.length > 0)
            || (data.activityExecutors && data.activityExecutors.length > 0)
            || (data.organizationParticipants && data.organizationParticipants.length > 0)
            || data.isAllScope) {
            return '（已设置）';
        }
        else {
            return '（未设置）';
        }
    };
    return PerformerConverter;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var ActionOrganizationScope = /** @class */ (function () {
    function ActionOrganizationScope() {
    }
    return ActionOrganizationScope;
}());
var ActionOrganizationScopeDesign = /** @class */ (function () {
    function ActionOrganizationScopeDesign() {
    }
    return ActionOrganizationScopeDesign;
}());
var OrganizationPotentialOwner = /** @class */ (function () {
    function OrganizationPotentialOwner() {
    }
    return OrganizationPotentialOwner;
}());
/** @enum {string} */
var ActionScope$2 = {
    /**
     * 指派
     */
    AssignUser: 'AssignUser',
    /**
     * 移交
     */
    Transfer: 'Transfer',
    /**
     * 征询
     */
    AddSignFront: 'AddSignFront',
    /**
     * 加签
     */
    AddSignBehind: 'AddSignBehind',
    /**
     * 知会
     */
    Notify: "Notify",
};
/** @enum {string} */
var OrganizationLevel$2 = {
    /**
     * 部门
     */
    DEPARTMENT: 'DEPARTMENT',
    /**
     * 单位
     */
    UNIT: 'UNIT',
    /**
     * 默认值
     */
    DEFAULT: 'DEFAULT',
    VARORGANIZATION: 'VARORGANIZATION',
};

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var AssignConfig = /** @class */ (function () {
    function AssignConfig() {
        this.operator = 'currentUser';
        this.multiSelect = true;
        this.necessary = false;
    }
    return AssignConfig;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var AssignStrategy = /** @class */ (function () {
    function AssignStrategy() {
        this.assignStrategy = 'ALL';
        this.assignConfig = new AssignConfig();
    }
    return AssignStrategy;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var ParticipantInfo = /** @class */ (function () {
    function ParticipantInfo() {
        this.assignStrategy = new AssignStrategy();
        this.humanPerformerList = new Array();
        this.potentialOwnerList = new Array();
        this.isAllScope = false;
    }
    return ParticipantInfo;
}());
var Participant = /** @class */ (function () {
    function Participant() {
    }
    return Participant;
}());
var UserParticipant = /** @class */ (function (_super) {
    __extends(UserParticipant, _super);
    function UserParticipant() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    return UserParticipant;
}(Participant));
var VariableParticipant = /** @class */ (function (_super) {
    __extends(VariableParticipant, _super);
    function VariableParticipant() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    return VariableParticipant;
}(UserParticipant));
var PositionParticipant = /** @class */ (function (_super) {
    __extends(PositionParticipant, _super);
    function PositionParticipant() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    return PositionParticipant;
}(UserParticipant));
var ComponentParticipant = /** @class */ (function (_super) {
    __extends(ComponentParticipant, _super);
    function ComponentParticipant() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    return ComponentParticipant;
}(Participant));
var ReportingLineParticipant = /** @class */ (function (_super) {
    __extends(ReportingLineParticipant, _super);
    function ReportingLineParticipant() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    return ReportingLineParticipant;
}(UserParticipant));
var MatrixParticipant = /** @class */ (function (_super) {
    __extends(MatrixParticipant, _super);
    function MatrixParticipant() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    return MatrixParticipant;
}(UserParticipant));
var ActivityExecutorParticipant$1 = /** @class */ (function (_super) {
    __extends(ActivityExecutorParticipant, _super);
    function ActivityExecutorParticipant() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    return ActivityExecutorParticipant;
}(UserParticipant));
var OrganizationParticipant = /** @class */ (function (_super) {
    __extends(OrganizationParticipant, _super);
    function OrganizationParticipant() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    return OrganizationParticipant;
}(Participant));

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var ParticipantUIState = /** @class */ (function () {
    function ParticipantUIState(localePipe) {
        this.localePipe = localePipe;
        this.typeCollection = [
            { text: this.localePipe.transform('component.participant.user'), value: 'wf.UserParticipantExpression' },
            { text: this.localePipe.transform('component.participant.variable'), value: 'wf.VariableParticipantExpression' },
            { text: this.localePipe.transform('component.participant.position'), value: 'wf.PositionParticipantExpression' },
            { text: this.localePipe.transform('component.participant.component'), value: 'wf.ComponentParticipantExpression' },
            { text: this.localePipe.transform('component.participant.reportingLine'), value: 'wf.ReportingLineParticipantExpression' },
            { text: this.localePipe.transform('component.participant.matrix'), value: 'wf.MatrixParticipantExpression' },
            { text: this.localePipe.transform('component.participant.activityExecutor'), value: 'wf.ActivityExecutorParticipantExpression' },
            { text: this.localePipe.transform('component.participant.organization'), value: 'wf.OrganizationParticipantExpression' }
        ];
    }
    ParticipantUIState.decorators = [
        { type: Injectable }
    ];
    /** @nocollapse */
    ParticipantUIState.ctorParameters = function () { return [
        { type: WfLocalePipe }
    ]; };
    return ParticipantUIState;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var AlternativeParticipantComponent = /** @class */ (function () {
    function AlternativeParticipantComponent(designerUIState, uistate, resolver, injector, modalService, message, expr, http, cdr, localeId, resources, localePipe) {
        var _this = this;
        this.designerUIState = designerUIState;
        this.uistate = uistate;
        this.resolver = resolver;
        this.injector = injector;
        this.modalService = modalService;
        this.message = message;
        this.expr = expr;
        this.http = http;
        this.cdr = cdr;
        this.localeId = localeId;
        this.resources = resources;
        this.localePipe = localePipe;
        this.closeModal = new EventEmitter();
        this.submitModal = new EventEmitter();
        this.editorParams = {};
        this.nodeType = 'notifyActivity';
        this.isClose = true;
        this.participant = new ParticipantInfo();
        this.editState = 'new'; // 编辑状态，用于区分是新增还是编辑  new | edit
        // 编辑状态，用于区分是新增还是编辑  new | edit
        this.type = 'potentialOwner';
        this.operatorCollection = [
            { text: this.localePipe.transform('component.participant.currentUser'), value: 'currentUser' },
            { text: this.localePipe.transform('component.participant.procInstCreator'), value: 'procInstCreator' }
        ];
        this.columns = [
            {
                field: 'order', width: 25, title: this.localePipe.transform('component.participant.order'),
                editor: {
                    type: EditorTypes.NUMBERBOX, options: {}
                },
            }, {
                field: 'type', width: 50, title: this.localePipe.transform('component.participant.type'),
                formatter: {
                    type: 'enum',
                    options: { valueField: 'value', textField: 'text', data: this.uistate.typeCollection }
                }
            }, {
                field: 'performerName', width: 50, title: this.localePipe.transform('component.participant.performerName'), showTips: true, formatter: (/**
                 * @param {?} v
                 * @param {?} d
                 * @param {?} i
                 * @return {?}
                 */
                function (v, d, i) {
                    switch (d.type) {
                        case 'wf.UserParticipantExpression':
                            return d.performerName;
                        case 'wf.VariableParticipantExpression':
                            return ((/** @type {?} */ (d))).name;
                        case 'wf.PositionParticipantExpression':
                            return ((/** @type {?} */ (d))).performerName;
                        case 'wf.ComponentParticipantExpression':
                            return ((/** @type {?} */ (d))).name;
                        case 'wf.ReportingLineParticipantExpression':
                            return ((/** @type {?} */ (d))).reportingLineDefName + '-' + ((/** @type {?} */ (d))).dimension;
                        case 'wf.MatrixParticipantExpression':
                            return ((/** @type {?} */ (d))).matrixDefName + '-' + ((/** @type {?} */ (d))).dataFieldAlias;
                        case 'wf.ActivityExecutorParticipantExpression':
                            return ((/** @type {?} */ (d))).performerName;
                        case 'wf.OrganizationParticipantExpression':
                            return ((/** @type {?} */ (d))).organizationName;
                        default:
                            return '';
                    }
                })
            },
            {
                field: 'description', width: 100, title: this.localePipe.transform('component.participant.description'), showTips: true,
                formatter: (/**
                 * @param {?} v
                 * @param {?} d
                 * @param {?} i
                 * @return {?}
                 */
                function (v, d, i) {
                    switch (d.type) {
                        case 'wf.UserParticipantExpression':
                            return _this.getUserPerformerDescription(d);
                        case 'wf.VariableParticipantExpression':
                            return _this.getVariablePerformerDescription(d);
                        case 'wf.PositionParticipantExpression':
                            return _this.getPositionPerformerDescription(d);
                        case 'wf.ComponentParticipantExpression':
                            return _this.getComponentPerformerDescription(d);
                        case 'wf.ReportingLineParticipantExpression':
                            return _this.getReportingLinePerformerDescription(d);
                        case 'wf.MatrixParticipantExpression':
                            return _this.getMatrixPerformerDescription(d);
                        case 'wf.ActivityExecutorParticipantExpression':
                            return ((/** @type {?} */ (d))).performerName;
                        case 'wf.OrganizationParticipantExpression':
                            return ((/** @type {?} */ (d))).organizationName + '，且' + (((/** @type {?} */ (d))).includeChildren ? '包含下级' : '不包含下级');
                        default:
                            return '';
                    }
                })
            },
            {
                field: 'condition', width: 60, title: this.localePipe.transform('component.participant.condition'), showTips: true,
                editor: {
                    type: 'input-group',
                    options: {
                        groupText: '<i class="f-icon f-icon-lookup"></i>',
                        editable: false,
                        clickHandle: (/**
                         * @param {?} e
                         * @return {?}
                         */
                        function (e) {
                            e.formControl.setValue(e.instance.value ? e.instance.value : '');
                            _this.editConditon(e);
                        }),
                    }
                }
            }
        ];
        this.localePipe = this.localePipe || new WfLocalePipe(localeId, resources);
        this.GetOrganizationType();
    }
    /**
     * @return {?}
     */
    AlternativeParticipantComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        this.nodeType = this.editorParams.nodeType;
    };
    /**
     * @param {?} data
     * @return {?}
     */
    AlternativeParticipantComponent.prototype.switchChange = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        if (data) {
            this.clearPerformer('potentialOwner');
        }
    };
    /**
     * @param {?} data
     * @return {?}
     */
    AlternativeParticipantComponent.prototype.assignStrategyChange = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        // this.preAssignStrategy = data;
        if (data === 'ALL') {
            this.participant.isAllScope = true;
            this.clearPerformer('potentialOwner');
        }
        else {
            this.participant.isAllScope = false;
        }
    };
    /**
     * @param {?} data
     * @return {?}
     */
    AlternativeParticipantComponent.prototype.isEnable = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        if (data) {
            this.participant.isAllScope = true;
            this.clearPerformer('potentialOwner');
        }
        else {
            this.participant.isAllScope = false;
        }
    };
    /**
     * @param {?} performerType
     * @param {?} type
     * @return {?}
     */
    AlternativeParticipantComponent.prototype.addPerformer = /**
     * @param {?} performerType
     * @param {?} type
     * @return {?}
     */
    function (performerType, type) {
        this.editState = 'new';
        this.type = type;
        /** @type {?} */
        var compFactory = this.resolver.resolveComponentFactory(PerformerEditComponent);
        this.compRef = compFactory.create(this.injector);
        this.compRef.instance.performerType = performerType;
        /** @type {?} */
        var boxsize = this.attributeBoxSize(performerType);
        /** @type {?} */
        var modalConfig = {
            title: this.localePipe.transform('component.participant.participantSelection'),
            width: boxsize.width,
            height: boxsize.height,
            buttons: this.editFooter,
            showButtons: true
        };
        this.editDialog = this.modalService.show(this.compRef, modalConfig);
        // this.dropDownEl.close();
        if (this.dropDownE2) {
            this.dropDownE2.close();
        }
    };
    /**
     * @return {?}
     */
    AlternativeParticipantComponent.prototype.editOK = /**
     * @return {?}
     */
    function () {
        var e_1, _a, e_2, _b;
        this.isClose = true;
        if (this.compRef) {
            /** @type {?} */
            var re = this.compRef.instance.getPerformers();
            if (re.userPerformers && re.userPerformers.length > 0) {
                try {
                    for (var _c = __values(re.userPerformers), _d = _c.next(); !_d.done; _d = _c.next()) {
                        var p = _d.value;
                        this.addUserPerformer(p);
                    }
                }
                catch (e_1_1) { e_1 = { error: e_1_1 }; }
                finally {
                    try {
                        if (_d && !_d.done && (_a = _c.return)) _a.call(_c);
                    }
                    finally { if (e_1) throw e_1.error; }
                }
            }
            if (re.variable && re.variable !== null && re.variable.performerId) {
                this.addvariablePerformer(re.variable);
            }
            // 2023-7-28 组织岗支持多选
            if (re.positions && re.positions.length > 0) {
                this.addPositionPerformer(re.positions);
            }
            if (re.component && re.component.metadataId && re.component.methodCode) {
                this.addComponentPerformer(re.component);
            }
            if (re.reportingLine && re.reportingLine.reportingLineDefId && re.reportingLine.dimension) {
                this.addReportingLinePerformer(re.reportingLine);
            }
            if (re.matrix && re.matrix.matrixDefId) {
                this.addMatrixPerformer(re.matrix);
            }
            if (re.activityExecutorPerformers && re.activityExecutorPerformers.length > 0) {
                try {
                    for (var _e = __values(re.activityExecutorPerformers), _f = _e.next(); !_f.done; _f = _e.next()) {
                        var a = _f.value;
                        this.addActivityExecutorPerformer(a);
                    }
                }
                catch (e_2_1) { e_2 = { error: e_2_1 }; }
                finally {
                    try {
                        if (_f && !_f.done && (_b = _e.return)) _b.call(_e);
                    }
                    finally { if (e_2) throw e_2.error; }
                }
            }
            if (re.organizationParticipant) {
                this.addOrganizationParticipant(re.organizationParticipant);
            }
        }
        if (this.editDialog && this.isClose) {
            this.editDialog.close();
        }
        // 编辑完成后刷新两个组件
        // this.humanPerformerGrid.refresh();
        this.potentialOwnerGrid.refresh();
    };
    /**
     * @private
     * @param {?} userPerformer
     * @return {?}
     */
    AlternativeParticipantComponent.prototype.addUserPerformer = /**
     * @private
     * @param {?} userPerformer
     * @return {?}
     */
    function (userPerformer) {
        if (this.type === 'potentialOwner') {
            /** @type {?} */
            var i = this.participant.potentialOwnerList.findIndex((/**
             * @param {?} a
             * @return {?}
             */
            function (a) { return (a.id === userPerformer.id || (((/** @type {?} */ (a))).performerId && ((/** @type {?} */ (a))).performerId === userPerformer.performerId)); }));
            if (i > -1) ;
            else {
                if (this.editState === 'edit') {
                    this.removePotentialOwner();
                }
                /** @type {?} */
                var index = void 0;
                if (this.participant.potentialOwnerList.length > 0) {
                    index = Math.max.apply(Math, __spread(this.participant.potentialOwnerList.map((/**
                     * @param {?} p
                     * @return {?}
                     */
                    function (p) { return p.order; })))) + 1;
                }
                else {
                    index = 1;
                }
                userPerformer.order = index;
                this.participant.potentialOwnerList.push(userPerformer);
            }
            this.potentialOwnerGrid.loadData(this.participant.potentialOwnerList);
        }
    };
    /**
     * @private
     * @param {?} variable
     * @return {?}
     */
    AlternativeParticipantComponent.prototype.addvariablePerformer = /**
     * @private
     * @param {?} variable
     * @return {?}
     */
    function (variable) {
        /** @type {?} */
        var v = variable;
        if (!v || !v.varValue) {
            this.message.info(this.localePipe.transform('component.participant.selectProcessVariables'));
            this.isClose = false;
        }
        else if (!v.varType) {
            this.message.info(this.localePipe.transform('component.participant.selectVariableValueType'));
            this.isClose = false;
        }
        else if (!v.relation) {
            this.message.info(this.localePipe.transform('component.participant.selectRelation'));
            this.isClose = false;
        }
        else {
            if (this.type === 'potentialOwner') {
                /** @type {?} */
                var i = this.participant.potentialOwnerList.findIndex((/**
                 * @param {?} a
                 * @return {?}
                 */
                function (a) { return (a.id === variable.id || (((/** @type {?} */ (a))).performerId && ((/** @type {?} */ (a))).performerId === variable.performerId)); }));
                if (i > -1) {
                    this.participant.potentialOwnerList[i] = variable;
                }
                else {
                    if (this.editState === 'edit') {
                        this.removePotentialOwner();
                    }
                    /** @type {?} */
                    var index = void 0;
                    if (this.participant.potentialOwnerList.length > 0) {
                        index = Math.max.apply(Math, __spread(this.participant.potentialOwnerList.map((/**
                         * @param {?} p
                         * @return {?}
                         */
                        function (p) { return p.order; })))) + 1;
                    }
                    else {
                        index = 1;
                    }
                    variable.order = index;
                    this.participant.potentialOwnerList.push(variable);
                }
                this.potentialOwnerGrid.loadData(this.participant.potentialOwnerList);
            }
        }
    };
    /**
     * @private
     * @param {?} positions
     * @return {?}
     */
    AlternativeParticipantComponent.prototype.addPositionPerformer = /**
     * @private
     * @param {?} positions
     * @return {?}
     */
    function (positions) {
        var e_3, _a;
        var _loop_1 = function (position) {
            if (!position.performerId) {
                this_1.message.info(this_1.localePipe.transform('component.participant.selectPosition'));
                this_1.isClose = false;
            }
            else {
                if ((!position.orgType || position.orgType == null) && (position.isRequired && position.positionType === '1')) {
                    this_1.message.info(this_1.localePipe.transform('component.participant.selectOrgType'));
                    this_1.isClose = false;
                }
                else if ((!position.orgId || position.orgId == null) && (position.isRequired && position.positionType === '1')) {
                    this_1.message.info(this_1.localePipe.transform('component.participant.orgFill'));
                    this_1.isClose = false;
                }
                else {
                    // (1)id一致，为编辑岗位；（2）performid一致，新增的用户，岗位已存在
                    if (this_1.type === 'potentialOwner') {
                        /** @type {?} */
                        var i = this_1.participant.potentialOwnerList.findIndex((/**
                         * @param {?} a
                         * @return {?}
                         */
                        function (a) {
                            if (a.type !== 'wf.PositionParticipantExpression') {
                                return false;
                            }
                            /** @type {?} */
                            var p = (/** @type {?} */ (a));
                            return (p.id === position.id);
                        }));
                        if (i > -1) {
                            this_1.participant.potentialOwnerList[i] = position;
                        }
                        else {
                            /** @type {?} */
                            var index = void 0;
                            if (this_1.participant.potentialOwnerList.length > 0) {
                                index = Math.max.apply(Math, __spread(this_1.participant.potentialOwnerList.map((/**
                                 * @param {?} p
                                 * @return {?}
                                 */
                                function (p) { return p.order; })))) + 1;
                            }
                            else {
                                index = 1;
                            }
                            position.order = index;
                            this_1.participant.potentialOwnerList.push(position);
                        }
                        this_1.potentialOwnerGrid.loadData(this_1.participant.potentialOwnerList);
                    }
                }
            }
        };
        var this_1 = this;
        try {
            for (var positions_1 = __values(positions), positions_1_1 = positions_1.next(); !positions_1_1.done; positions_1_1 = positions_1.next()) {
                var position = positions_1_1.value;
                _loop_1(position);
            }
        }
        catch (e_3_1) { e_3 = { error: e_3_1 }; }
        finally {
            try {
                if (positions_1_1 && !positions_1_1.done && (_a = positions_1.return)) _a.call(positions_1);
            }
            finally { if (e_3) throw e_3.error; }
        }
    };
    /**
     * @private
     * @param {?} component
     * @return {?}
     */
    AlternativeParticipantComponent.prototype.addComponentPerformer = /**
     * @private
     * @param {?} component
     * @return {?}
     */
    function (component) {
        /** @type {?} */
        var cmp = new ComponentParticipant();
        cmp.id = component.id;
        cmp.metadataId = component.metadataId;
        cmp.methodCode = component.methodCode;
        cmp.methodName = component.methodName;
        cmp.name = component.name;
        cmp.actualParameters = component.actualParameters;
        cmp.type = 'wf.ComponentParticipantExpression';
        cmp.condition = component.condition;
        if (this.type === 'potentialOwner') {
            /** @type {?} */
            var i = this.participant.potentialOwnerList.findIndex((/**
             * @param {?} a
             * @return {?}
             */
            function (a) { return a.id === cmp.id; }));
            if (i > -1) {
                this.participant.potentialOwnerList[i] = cmp;
            }
            else {
                /** @type {?} */
                var index = void 0;
                if (this.participant.potentialOwnerList.length > 0) {
                    index = Math.max.apply(Math, __spread(this.participant.potentialOwnerList.map((/**
                     * @param {?} p
                     * @return {?}
                     */
                    function (p) { return p.order; })))) + 1;
                }
                else {
                    index = 1;
                }
                cmp.order = index;
                this.participant.potentialOwnerList.push(cmp);
            }
            this.potentialOwnerGrid.loadData(this.participant.potentialOwnerList);
        }
    };
    /**
     * @private
     * @param {?} reportingLine
     * @return {?}
     */
    AlternativeParticipantComponent.prototype.addReportingLinePerformer = /**
     * @private
     * @param {?} reportingLine
     * @return {?}
     */
    function (reportingLine) {
        var e_4, _a;
        if (reportingLine.reportingReferObject === 'dept' && !reportingLine.refOrgId) {
            this.isClose = false;
            this.message.info(this.localePipe.transform('component.participant.refOrgIdNotNull'));
        }
        else if (reportingLine.reportingReferObject !== 'dept' && !reportingLine.refUserId && !reportingLine.refEmployeeId) { // 用户及其他人员汇报对象类型，参照用户和参照员工不能全部为空
            this.isClose = false;
            this.message.info(this.localePipe.transform('component.participant.refUserIdNotNull'));
        }
        else {
            this.isClose = true;
            if (this.type === 'potentialOwner') {
                /** @type {?} */
                var i = this.participant.potentialOwnerList.findIndex((/**
                 * @param {?} a
                 * @return {?}
                 */
                function (a) { return a.id === reportingLine.id; }));
                if (i > -1) {
                    this.participant.potentialOwnerList[i] = reportingLine;
                }
                else {
                    /** @type {?} */
                    var reportingLines = this.participant.potentialOwnerList.filter((/**
                     * @param {?} h
                     * @return {?}
                     */
                    function (h) { return h.type === 'wf.ReportingLineParticipantExpression'; }));
                    try {
                        for (var reportingLines_1 = __values(reportingLines), reportingLines_1_1 = reportingLines_1.next(); !reportingLines_1_1.done; reportingLines_1_1 = reportingLines_1.next()) {
                            var r = reportingLines_1_1.value;
                            /** @type {?} */
                            var reportingLineData = (/** @type {?} */ (r));
                            if (reportingLineData.reportingLineDefId === reportingLine.reportingLineDefId &&
                                reportingLineData.dimension === reportingLine.dimension &&
                                reportingLineData.refUserId === reportingLine.refUserId &&
                                reportingLineData.refEmployeeId === reportingLine.refEmployeeId &&
                                reportingLineData.refOrgId === reportingLine.refOrgId) {
                                this.message.error(this.localePipe.transform('component.participant.repDefConfigured'));
                                return;
                            }
                        }
                    }
                    catch (e_4_1) { e_4 = { error: e_4_1 }; }
                    finally {
                        try {
                            if (reportingLines_1_1 && !reportingLines_1_1.done && (_a = reportingLines_1.return)) _a.call(reportingLines_1);
                        }
                        finally { if (e_4) throw e_4.error; }
                    }
                    /** @type {?} */
                    var index = void 0;
                    if (this.participant.potentialOwnerList.length > 0) {
                        index = Math.max.apply(Math, __spread(this.participant.potentialOwnerList.map((/**
                         * @param {?} p
                         * @return {?}
                         */
                        function (p) { return p.order; })))) + 1;
                    }
                    else {
                        index = 1;
                    }
                    reportingLine.order = index;
                    this.participant.potentialOwnerList.push(reportingLine);
                }
                this.potentialOwnerGrid.loadData(this.participant.potentialOwnerList);
            }
        }
    };
    /**
     * @private
     * @param {?} matrix
     * @return {?}
     */
    AlternativeParticipantComponent.prototype.addMatrixPerformer = /**
     * @private
     * @param {?} matrix
     * @return {?}
     */
    function (matrix) {
        var e_5, _a;
        if (!matrix.conditionField1 && !matrix.conditionField2 && !matrix.conditionField3) {
            this.isClose = false;
            this.message.info(this.localePipe.transform('component.participant.atLeastOneCondition'));
        }
        else if (!matrix.dataFieldAlias) {
            this.isClose = false;
            this.message.info(this.localePipe.transform('component.participant.dataFieldAliasNotNull'));
        }
        else {
            this.isClose = true;
            if (this.type === 'potentialOwner') {
                /** @type {?} */
                var i = this.participant.potentialOwnerList.findIndex((/**
                 * @param {?} a
                 * @return {?}
                 */
                function (a) { return a.id === matrix.id; }));
                if (i > -1) {
                    this.participant.potentialOwnerList[i] = matrix;
                }
                else {
                    /** @type {?} */
                    var matrixParticipants = this.participant.potentialOwnerList.filter((/**
                     * @param {?} h
                     * @return {?}
                     */
                    function (h) { return h.type === 'wf.MatrixParticipantExpression'; }));
                    try {
                        for (var matrixParticipants_1 = __values(matrixParticipants), matrixParticipants_1_1 = matrixParticipants_1.next(); !matrixParticipants_1_1.done; matrixParticipants_1_1 = matrixParticipants_1.next()) {
                            var m = matrixParticipants_1_1.value;
                            /** @type {?} */
                            var matrixData = (/** @type {?} */ (m));
                            if (matrixData.matrixDefId === matrix.matrixDefId &&
                                matrixData.conditionField1 === matrix.conditionField1 &&
                                matrixData.conditionField2 === matrix.conditionField2 &&
                                matrixData.conditionField3 === matrix.conditionField3 &&
                                matrixData.dataFieldAlias === matrix.dataFieldAlias) {
                                this.message.error(this.localePipe.transform('component.participant.matrixConfigured'));
                                return;
                            }
                        }
                    }
                    catch (e_5_1) { e_5 = { error: e_5_1 }; }
                    finally {
                        try {
                            if (matrixParticipants_1_1 && !matrixParticipants_1_1.done && (_a = matrixParticipants_1.return)) _a.call(matrixParticipants_1);
                        }
                        finally { if (e_5) throw e_5.error; }
                    }
                    /** @type {?} */
                    var index = void 0;
                    if (this.participant.potentialOwnerList.length > 0) {
                        index = Math.max.apply(Math, __spread(this.participant.potentialOwnerList.map((/**
                         * @param {?} p
                         * @return {?}
                         */
                        function (p) { return p.order; })))) + 1;
                    }
                    else {
                        index = 1;
                    }
                    matrix.order = index;
                    this.participant.potentialOwnerList.push(matrix);
                }
                this.potentialOwnerGrid.loadData(this.participant.potentialOwnerList);
            }
        }
    };
    /**
     * @private
     * @param {?} activityExecutor
     * @return {?}
     */
    AlternativeParticipantComponent.prototype.addActivityExecutorPerformer = /**
     * @private
     * @param {?} activityExecutor
     * @return {?}
     */
    function (activityExecutor) {
        if (this.type === 'potentialOwner') {
            /** @type {?} */
            var i = this.participant.potentialOwnerList.findIndex((/**
             * @param {?} a
             * @return {?}
             */
            function (a) { return (a.id === activityExecutor.id ||
                (((/** @type {?} */ (a))).activityDefId && ((/** @type {?} */ (a))).activityDefId === activityExecutor.activityDefId)); }));
            if (i < 0) {
                if (this.editState === 'edit') {
                    this.removePotentialOwner(); // 在编辑状态下配置了活动办理人参与者，先将选中的删除
                }
                /** @type {?} */
                var index = void 0;
                if (this.participant.potentialOwnerList.length > 0) {
                    index = Math.max.apply(Math, __spread(this.participant.potentialOwnerList.map((/**
                     * @param {?} p
                     * @return {?}
                     */
                    function (p) { return p.order; })))) + 1;
                }
                else {
                    index = 1;
                }
                activityExecutor.order = index;
                this.participant.potentialOwnerList.push(activityExecutor);
            }
            this.potentialOwnerGrid.loadData(this.participant.potentialOwnerList);
        }
    };
    /**
     * @param {?} organization
     * @return {?}
     */
    AlternativeParticipantComponent.prototype.addOrganizationParticipant = /**
     * @param {?} organization
     * @return {?}
     */
    function (organization) {
        /** @type {?} */
        var organizationParticipant = new OrganizationParticipant();
        organizationParticipant.id = organization.id || ProcessDeUtil.GenerateElementId();
        organizationParticipant.type = 'wf.OrganizationParticipantExpression';
        organizationParticipant.condition = organization.condition;
        organizationParticipant.name = organization.name;
        organizationParticipant.actionScope = organization.actionScope;
        organizationParticipant.organizationLevel = organization.organizationLevel;
        organizationParticipant.organizationId = organization.organizationId;
        organizationParticipant.organizationCode = organization.organizationCode;
        organizationParticipant.organizationName = organization.organizationName;
        organizationParticipant.includeChildren = organization.includeChildren;
        organizationParticipant.parentsUntil = organization.parentsUntil;
        organizationParticipant.tag = organization.tag;
        if (this.type === 'potentialOwner') {
            this.participant.potentialOwnerList = this.participant.potentialOwnerList.filter((/**
             * @param {?} p
             * @return {?}
             */
            function (p) { return p.type !== 'wf.OrganizationParticipantExpression'; }));
            /** @type {?} */
            var index = void 0;
            if (this.participant.potentialOwnerList.length > 0) {
                index = Math.max.apply(Math, __spread(this.participant.potentialOwnerList.map((/**
                 * @param {?} p
                 * @return {?}
                 */
                function (p) { return p.order; })))) + 1;
            }
            else {
                index = 1;
            }
            organizationParticipant.order = index;
            this.participant.potentialOwnerList.push(organizationParticipant);
            this.potentialOwnerGrid.loadData(this.participant.potentialOwnerList);
        }
    };
    /**
     * @return {?}
     */
    AlternativeParticipantComponent.prototype.editCancel = /**
     * @return {?}
     */
    function () {
        if (this.editDialog) {
            this.editDialog.close();
        }
    };
    /**
     * @param {?} type
     * @return {?}
     */
    AlternativeParticipantComponent.prototype.editPerformer = /**
     * @param {?} type
     * @return {?}
     */
    function (type) {
        var _this = this;
        this.editState = 'edit';
        this.type = type;
        /** @type {?} */
        var selectedRow;
        if (type === 'potentialOwner') {
            selectedRow = this.potentialOwnerGrid.selectedRow;
        }
        if (!selectedRow) {
            this.message.info(this.localePipe.transform('component.participant.selectPerformer'));
            return;
        }
        /** @type {?} */
        var curPerformer = selectedRow.data;
        if (curPerformer) {
            /** @type {?} */
            var boxsize = this.attributeBoxSize(curPerformer.type);
            /** @type {?} */
            var modalConfig_1 = {
                title: this.localePipe.transform('component.participant.participantSelection'),
                width: boxsize.width,
                height: boxsize.height,
                buttons: this.editFooter,
                showButtons: true
            };
            /** @type {?} */
            var compFactory = this.resolver.resolveComponentFactory(PerformerEditComponent);
            this.compRef = compFactory.create(this.injector);
            this.compRef.instance.performerType = curPerformer.type;
            this.compRef.instance.editState = this.editState;
            switch (curPerformer.type) {
                case 'wf.PositionParticipantExpression':
                    this.compRef.instance.performer = {
                        type: 'wf.PositionParticipantExpression',
                        value: curPerformer
                    };
                    break;
                case 'wf.UserParticipantExpression':
                    this.compRef.instance.performer = {
                        type: 'wf.UserParticipantExpression',
                        value: curPerformer
                    };
                    break;
                case 'wf.VariableParticipantExpression':
                    this.compRef.instance.performer = {
                        type: 'wf.VariableParticipantExpression',
                        value: curPerformer
                    };
                    break;
                case 'wf.ReportingLineParticipantExpression':
                    this.compRef.instance.performer = {
                        type: 'wf.ReportingLineParticipantExpression',
                        value: curPerformer
                    };
                    /** @type {?} */
                    var url = '/api/runtime/wf/v1.0/reportingLineDefinitions/' + ((/** @type {?} */ (curPerformer))).reportingLineDefId;
                    this.http.get(url).subscribe((/**
                     * @param {?} res
                     * @return {?}
                     */
                    function (res) {
                        if (!res) {
                            _this.message.error(_this.localePipe.transform('component.participant.definitionDeleted'));
                            if (type === 'potentialOwner') {
                                _this.removePotentialOwner();
                            }
                        }
                        else {
                            _this.editDialog = _this.modalService.show(_this.compRef, modalConfig_1);
                        }
                    }));
                    break;
                case 'wf.MatrixParticipantExpression':
                    this.compRef.instance.performer = {
                        type: 'wf.MatrixParticipantExpression',
                        value: curPerformer
                    };
                    /** @type {?} */
                    var urlMatrix = '/api/runtime/wf/v1.0/matrixDefinition/' + ((/** @type {?} */ (curPerformer))).matrixDefId;
                    this.http.get(urlMatrix).subscribe((/**
                     * @param {?} res
                     * @return {?}
                     */
                    function (res) {
                        if (!res) {
                            _this.message.error(_this.localePipe.transform('component.participant.matrixDeleted'));
                            if (type === 'potentialOwner') {
                                _this.removePotentialOwner();
                            }
                        }
                        else {
                            _this.editDialog = _this.modalService.show(_this.compRef, modalConfig_1);
                        }
                    }));
                    break;
                case 'wf.ComponentParticipantExpression':
                    this.compRef.instance.performer = {
                        type: 'wf.ComponentParticipantExpression',
                        value: curPerformer
                    };
                    break;
                case 'wf.ActivityExecutorParticipantExpression':
                    this.compRef.instance.performer = {
                        type: 'wf.ActivityExecutorParticipantExpression',
                        value: curPerformer
                    };
                    break;
                case 'wf.OrganizationParticipantExpression':
                    this.compRef.instance.performer = {
                        type: 'wf.OrganizationParticipantExpression',
                        value: curPerformer
                    };
                    break;
            }
            if (curPerformer.type !== 'wf.ReportingLineParticipantExpression' &&
                curPerformer.type !== 'wf.MatrixParticipantExpression') { // 汇报关系和矩阵单独处理
                this.editDialog = this.modalService.show(this.compRef, modalConfig_1);
            }
        }
    };
    /**
     * @param {?} type
     * @return {?}
     */
    AlternativeParticipantComponent.prototype.removePerformer = /**
     * @param {?} type
     * @return {?}
     */
    function (type) {
        var _this = this;
        if (type === 'potentialOwner') {
            if (this.potentialOwnerGrid.selectedRow) {
                this.potentialOwnerGrid.endCellEdit();
                /** @type {?} */
                var index = this.participant.potentialOwnerList.findIndex((/**
                 * @param {?} p
                 * @return {?}
                 */
                function (p) { return p.id === _this.potentialOwnerGrid.selectedRow.data.id; }));
                this.participant.potentialOwnerList.splice(index, 1);
                this.potentialOwnerGrid.loadData(this.participant.potentialOwnerList);
            }
            else {
                this.message.info(this.localePipe.transform('component.participant.selectParticipantInfo'));
            }
        }
    };
    /**
     * @param {?} type
     * @return {?}
     */
    AlternativeParticipantComponent.prototype.clearPerformer = /**
     * @param {?} type
     * @return {?}
     */
    function (type) {
        if (type === 'potentialOwner') {
            this.participant.potentialOwnerList = new Array();
        }
        // this.humanPerformerGrid.loadData(this.participant.humanPerformerList);
        if (this.potentialOwnerGrid) {
            this.potentialOwnerGrid.loadData(this.participant.potentialOwnerList);
        }
    };
    /**
     * @param {?} type
     * @return {?}
     */
    AlternativeParticipantComponent.prototype.moveUp = /**
     * @param {?} type
     * @return {?}
     */
    function (type) {
        if (type === 'potentialOwner') {
            /** @type {?} */
            var selectedRow = this.potentialOwnerGrid.selectedRow;
            if (!selectedRow) {
                this.message.info(this.localePipe.transform('component.participant.noRowSelected'));
                return;
            }
            /** @type {?} */
            var performer_1 = selectedRow.data;
            /** @type {?} */
            var i = this.participant.potentialOwnerList.findIndex((/**
             * @param {?} c
             * @return {?}
             */
            function (c) { return c.id === performer_1.id; }));
            if (i === 0) {
                return;
            }
            /** @type {?} */
            var index = this.participant.potentialOwnerList[i].order;
            this.participant.potentialOwnerList[i].order = this.participant.potentialOwnerList[i - 1].order;
            this.participant.potentialOwnerList[i - 1].order = index;
            this.swapArray(this.participant.potentialOwnerList, i, i - 1);
            this.potentialOwnerGrid.loadData(this.participant.potentialOwnerList);
            this.potentialOwnerGrid.selectRow(performer_1.id, true);
        }
    };
    /**
     * @param {?} type
     * @return {?}
     */
    AlternativeParticipantComponent.prototype.moveDown = /**
     * @param {?} type
     * @return {?}
     */
    function (type) {
        if (type === 'potentialOwner') {
            /** @type {?} */
            var selectedRow = this.potentialOwnerGrid.selectedRow;
            if (!selectedRow) {
                this.message.info(this.localePipe.transform('component.participant.noRowSelected'));
                return;
            }
            /** @type {?} */
            var performer_2 = selectedRow.data;
            /** @type {?} */
            var i = this.participant.potentialOwnerList.findIndex((/**
             * @param {?} c
             * @return {?}
             */
            function (c) { return c.id === performer_2.id; }));
            if (i === this.participant.potentialOwnerList.length - 1) {
                return;
            }
            /** @type {?} */
            var index = this.participant.potentialOwnerList[i].order;
            this.participant.potentialOwnerList[i].order = this.participant.potentialOwnerList[i + 1].order;
            this.participant.potentialOwnerList[i + 1].order = index;
            this.swapArray(this.participant.potentialOwnerList, i, i + 1);
            this.potentialOwnerGrid.loadData(this.participant.potentialOwnerList);
            this.potentialOwnerGrid.selectRow(performer_2.id, true);
        }
    };
    /**
     * @private
     * @param {?} arr
     * @param {?} i1
     * @param {?} i2
     * @return {?}
     */
    AlternativeParticipantComponent.prototype.swapArray = /**
     * @private
     * @param {?} arr
     * @param {?} i1
     * @param {?} i2
     * @return {?}
     */
    function (arr, i1, i2) {
        arr[i1] = arr.splice(i2, 1, arr[i1])[0];
        return arr;
    };
    /**
     * @return {?}
     */
    AlternativeParticipantComponent.prototype.removePotentialOwner = /**
     * @return {?}
     */
    function () {
        var _this = this;
        if (this.potentialOwnerGrid.selectedRow) {
            this.potentialOwnerGrid.endCellEdit();
            /** @type {?} */
            var i = this.participant.potentialOwnerList.findIndex((/**
             * @param {?} item
             * @return {?}
             */
            function (item) { return item.id === _this.potentialOwnerGrid.selectedRow.data.id; }));
            this.participant.potentialOwnerList.splice(i, 1);
        }
        else {
            this.message.info(this.localePipe.transform('component.participant.selectpotentialtHandler'));
        }
    };
    /**
     * @private
     * @param {?} userPerformer
     * @return {?}
     */
    AlternativeParticipantComponent.prototype.getUserPerformerDescription = /**
     * @private
     * @param {?} userPerformer
     * @return {?}
     */
    function (userPerformer) {
        if (userPerformer.tag === 'expression') {
            return userPerformer.performerId;
        }
        else {
            if (userPerformer.orgName) {
                return this.localePipe.transform('component.participant.org') + userPerformer.orgName;
            }
            else {
                return '';
            }
        }
    };
    /**
     * @private
     * @param {?} variablePerformer
     * @return {?}
     */
    AlternativeParticipantComponent.prototype.getVariablePerformerDescription = /**
     * @private
     * @param {?} variablePerformer
     * @return {?}
     */
    function (variablePerformer) {
        if (variablePerformer.tag === 'expression') {
            return variablePerformer.varValue;
        }
    };
    /**
     * @private
     * @param {?} position
     * @return {?}
     */
    AlternativeParticipantComponent.prototype.getPositionPerformerDescription = /**
     * @private
     * @param {?} position
     * @return {?}
     */
    function (position) {
        if (this.designerUIState.scene === 'inSuite') {
            return null;
        }
        if (position.positionType === '1') {
            if (position.orgId) {
                return this.localePipe.transform('component.participant.positionType1') + position.orgId;
            }
            else {
                return this.localePipe.transform('component.participant.positionType2');
            }
        }
        else if (position.positionType === '0') {
            return this.localePipe.transform('component.participant.positionType3');
        }
    };
    /**
     * @private
     * @param {?} position
     * @return {?}
     */
    AlternativeParticipantComponent.prototype.getComponentPerformerDescription = /**
     * @private
     * @param {?} position
     * @return {?}
     */
    function (position) {
        /** @type {?} */
        var des = this.localePipe.transform('component.participant.comp') + position.name
            + this.localePipe.transform('component.participant.parameters');
        if (position.actualParameters && position.actualParameters.length > 0) {
            position.actualParameters.forEach((/**
             * @param {?} p
             * @return {?}
             */
            function (p) {
                des += p.code + "\uFF1A" + p.value + "\uFF0C";
            }));
            des = des.substring(0, des.length - 1);
        }
        des += '}';
        return des;
    };
    /**
     * @private
     * @param {?} reportingLine
     * @return {?}
     */
    AlternativeParticipantComponent.prototype.getReportingLinePerformerDescription = /**
     * @private
     * @param {?} reportingLine
     * @return {?}
     */
    function (reportingLine) {
        /** @type {?} */
        var description = '';
        if (reportingLine.refUserId) {
            description += this.localePipe.transform('component.participant.referencePerson') + reportingLine.refUserId;
        }
        if (reportingLine.refEmployeeId) {
            description += this.localePipe.transform('component.participant.referencePerson') + reportingLine.refEmployeeId;
        }
        if (reportingLine.refOrgId) {
            if (reportingLine.refUserId) {
                description += "\uFF0C";
            }
            if (reportingLine.refEmployeeId) {
                description += "\uFF0C";
            }
            description += this.localePipe.transform('component.participant.referenceOrganization') + reportingLine.refOrgId;
        }
        return description;
    };
    /**
     * @private
     * @param {?} matrix
     * @return {?}
     */
    AlternativeParticipantComponent.prototype.getMatrixPerformerDescription = /**
     * @private
     * @param {?} matrix
     * @return {?}
     */
    function (matrix) {
        /** @type {?} */
        var description = '';
        if (matrix.conditionField1) {
            description += this.localePipe.transform('component.participant.condition1') + matrix.conditionFieldText1 + "\uFF0C";
        }
        if (matrix.conditionField2) {
            description += this.localePipe.transform('component.participant.condition2') + matrix.conditionFieldText2 + "\uFF0C";
        }
        if (matrix.conditionField3) {
            description += this.localePipe.transform('component.participant.condition3') + matrix.conditionFieldText3 + "\uFF0C";
        }
        if (matrix.dataFieldAlias) {
            description += this.localePipe.transform('component.participant.data') + matrix.dataFieldAlias + "\uFF0C";
        }
        return description.slice(0, description.length - 1);
    };
    /**
     * @private
     * @param {?} e
     * @return {?}
     */
    AlternativeParticipantComponent.prototype.editConditon = /**
     * @private
     * @param {?} e
     * @return {?}
     */
    function (e) {
        var _this = this;
        var e_6, _a, e_7, _b, e_8, _c, e_9, _d;
        // this.expr.clearContext();
        if (this.designerUIState.schemas.length > 0) {
            try {
                for (var _e = __values(this.designerUIState.schemas), _f = _e.next(); !_f.done; _f = _e.next()) {
                    var schema = _f.value;
                    this.expr.addSchema('Schema', schema);
                }
            }
            catch (e_6_1) { e_6 = { error: e_6_1 }; }
            finally {
                try {
                    if (_f && !_f.done && (_a = _e.return)) _a.call(_e);
                }
                finally { if (e_6) throw e_6.error; }
            }
            if (this.designerUIState.schemas[0].entityTypes && this.designerUIState.schemas[0].entityTypes.length > 0) {
                /** @type {?} */
                var entityType = this.designerUIState.schemas[0].entityTypes[0];
                this.expr.addInjectedEntity(entityType.name, 'Schema', entityType.name, InjectedType.EntityType);
            }
        }
        /** @type {?} */
        var context = new Array();
        context = this.designerUIState.addContext(context);
        if (this.designerUIState.subActivityContext.length > 0) {
            var _loop_2 = function (variable) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    context.push(variable);
                }
            };
            try {
                for (var _g = __values(this.designerUIState.subActivityContext), _h = _g.next(); !_h.done; _h = _g.next()) {
                    var variable = _h.value;
                    _loop_2(variable);
                }
            }
            catch (e_7_1) { e_7 = { error: e_7_1 }; }
            finally {
                try {
                    if (_h && !_h.done && (_b = _g.return)) _b.call(_g);
                }
                finally { if (e_7) throw e_7.error; }
            }
        }
        if (this.designerUIState.activityComponentContext.length > 0) {
            var _loop_3 = function (variable) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    context.push(variable);
                }
            };
            try {
                for (var _j = __values(this.designerUIState.activityComponentContext), _k = _j.next(); !_k.done; _k = _j.next()) {
                    var variable = _k.value;
                    _loop_3(variable);
                }
            }
            catch (e_8_1) { e_8 = { error: e_8_1 }; }
            finally {
                try {
                    if (_k && !_k.done && (_c = _j.return)) _c.call(_j);
                }
                finally { if (e_8) throw e_8.error; }
            }
        }
        if (context.length > 0) {
            try {
                for (var context_1 = __values(context), context_1_1 = context_1.next(); !context_1_1.done; context_1_1 = context_1.next()) {
                    var v = context_1_1.value;
                    this.expr.addContext(v);
                }
            }
            catch (e_9_1) { e_9 = { error: e_9_1 }; }
            finally {
                try {
                    if (context_1_1 && !context_1_1.done && (_d = context_1.return)) _d.call(context_1);
                }
                finally { if (e_9) throw e_9.error; }
            }
        }
        this.expr.addExpressionText(e.instance.value);
        this.expr.setEditPattern(ExprEditMode.Conditional); // 默认打开简易表达式编辑器
        this.expr.buildExpression().then((/**
         * @param {?} cond
         * @return {?}
         */
        function (cond) {
            if (_this.potentialOwnerGrid && _this.potentialOwnerGrid.selectedRow && _this.potentialOwnerGrid.selectedRow.data) {
                /** @type {?} */
                var temp = _this.participant.potentialOwnerList.find((/**
                 * @param {?} h
                 * @return {?}
                 */
                function (h) { return h.id === _this.potentialOwnerGrid.selectedRow.data.id; }));
                temp.condition = cond;
            }
            e.formControl.setValue(cond);
            e.instance.cd.detectChanges();
            //点击确定后，去除表达式里面的新增的上下文变量
            if (context.length > 0) {
                _this.expr.exprEntity.contextEntities = _this.expr.exprEntity.contextEntities.filter((/**
                 * @param {?} x
                 * @return {?}
                 */
                function (x) { return !context.some((/**
                 * @param {?} y
                 * @return {?}
                 */
                function (y) { return y.key === x.key; })); }));
            }
        }));
    };
    /**
     * @private
     * @return {?}
     */
    AlternativeParticipantComponent.prototype.GetOrganizationType = /**
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var url = '/api/runtime/sys/v1.0/authfields/globalauthfields';
        this.http.get(url)
            .subscribe((/**
         * @param {?} data
         * @return {?}
         */
        function (data) { return _this.designerUIState.orgTypeCollection = data.map((/**
         * @param {?} d
         * @return {?}
         */
        function (d) { return ({ value: d.id, text: d.name }); })); }));
    };
    // 构造不同参与者选择界面的尺寸 2023-7-5
    // 构造不同参与者选择界面的尺寸 2023-7-5
    /**
     * @private
     * @param {?} boxType
     * @return {?}
     */
    AlternativeParticipantComponent.prototype.attributeBoxSize = 
    // 构造不同参与者选择界面的尺寸 2023-7-5
    /**
     * @private
     * @param {?} boxType
     * @return {?}
     */
    function (boxType) {
        /** @type {?} */
        var boxsize = {
            width: 760,
            height: 512
        };
        switch (boxType) {
            case 'wf.PositionParticipantExpression':
                boxsize.width = 760;
                boxsize.height = 455;
                return boxsize;
            case 'wf.UserParticipantExpression':
                boxsize.width = 760;
                boxsize.height = 320;
                return boxsize;
            case 'wf.VariableParticipantExpression':
                boxsize.width = 760;
                boxsize.height = 420;
                return boxsize;

            case 'wf.ReportingLineParticipantExpression':
                boxsize.width = 760;
                boxsize.height = 512;
                return boxsize;

            case 'wf.MatrixParticipantExpression':
                boxsize.width = 780;
                boxsize.height = 420;
                return boxsize;

            case 'wf.ComponentParticipantExpression':
                boxsize.width = 760;
                boxsize.height = 512;
                return boxsize;

            case 'wf.ActivityExecutorParticipantExpression':
                boxsize.width = 760;
                boxsize.height = 320;
                return boxsize;

            case 'wf.OrganizationParticipantExpression':
                boxsize.width = 760;
                boxsize.height = 360;
                return boxsize;

        }
    };
    AlternativeParticipantComponent.decorators = [
        { type: Component, args: [{
                    selector: 'wf-alternative-participant',
                    template: "<div class=\"f-page-main d-flex flex-column farris-overflow-y-auto farris-overflow-x-auto\" style=\"height: 300px\">\r\n  <div class=\"f-page-header\">\r\n    <div class=\"farris-group-wrap\">\r\n      <div class=\"form-group farris-form-group\">\r\n        <label class=\"col-form-label\" style=\"width: 4.9rem\">\r\n          <span class=\"farris-label-text\">{{'component.orgPotentialOwner.limit'|wfLocale}}</span>\r\n        </label>\r\n        <div class=\"farris-input-wrap ml-1\">\r\n          <farris-switch [(ngModel)]=\"participant.isAllScope\" name=\"enable\" (valueChange)=\"isEnable($event)\"></farris-switch>\r\n        </div>\r\n        <div class=\"f-toolbar last-div farris-form-controls-inline\" [ngStyle]=\"{'visibility' : participant.isAllScope ? 'visible' : 'hidden'}\">\r\n          <div class=\"btn-group mr-2\"  fDropdown #dropdownE2=\"fDropdown\" [autoRectify]=\"true\">\r\n            <farris-button class=\"dropdown-toggle\" fDropdownToggle [type]=\"'link'\">\r\n              {{'component.participant.new'|wfLocale}}\r\n            </farris-button>\r\n            <div class=\"dropdown-menu\" fDropdownMenu>\r\n              <li class=\"dropdown-item\" (click)=\"addPerformer('wf.UserParticipantExpression','potentialOwner')\"><span>{{'component.participant.user'|wfLocale}}</span></li>\r\n              <li class=\"dropdown-item\" (click)=\"addPerformer('wf.VariableParticipantExpression','potentialOwner')\"><span>{{'component.participant.variable'|wfLocale}}</span></li>\r\n              <li class=\"dropdown-item\" (click)=\"addPerformer('wf.PositionParticipantExpression','potentialOwner')\"><span>{{designerUIState.scene==='inSuite'?(('component.participant.role'|wfLocale)):('component.participant.position'|wfLocale)}}</span></li>\r\n              <li class=\"dropdown-item\" (click)=\"addPerformer('wf.ReportingLineParticipantExpression','potentialOwner')\"><span>{{'component.participant.reportingLine'|wfLocale}}</span></li>\r\n              <li class=\"dropdown-item\" (click)=\"addPerformer('wf.ActivityExecutorParticipantExpression','potentialOwner')\"><span>{{'component.participant.activityExecutor'|wfLocale}}</span></li>\r\n              <li class=\"dropdown-item\" (click)=\"addPerformer('wf.MatrixParticipantExpression','potentialOwner')\"><span>{{'component.participant.matrix'|wfLocale}}</span></li>\r\n              <li class=\"dropdown-item\" (click)=\"addPerformer('wf.ComponentParticipantExpression','potentialOwner')\"><span>{{'component.participant.component'|wfLocale}}</span></li>\r\n              <li class=\"dropdown-item\" (click)=\"addPerformer('wf.OrganizationParticipantExpression','potentialOwner')\"><span>{{'component.participant.organization'|wfLocale}}\r\n              </span></li>\r\n            </div>\r\n          </div>\r\n          <farris-button  [type]=\"'link'\" (click)=\"editPerformer('potentialOwner')\">{{'component.participant.editPerformer'|wfLocale}}</farris-button>\r\n          <farris-button  [type]=\"'link'\" (click)=\"removePerformer('potentialOwner')\">{{'component.participant.removePerformer'|wfLocale}}</farris-button>\r\n          <farris-button  [type]=\"'link'\" (click)=\"clearPerformer('potentialOwner')\">{{'component.participant.clearPerformer'|wfLocale}}</farris-button>\r\n          <farris-button  [type]=\"'link'\" (click)=\"moveUp('potentialOwner')\">{{'component.participant.moveUp'|wfLocale}}</farris-button>\r\n          <farris-button  [type]=\"'link'\" (click)=\"moveDown('potentialOwner')\">{{'component.participant.moveDown'|wfLocale}}</farris-button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n  <div class=\"f-utils-fill farris-overflow-y-auto\">\r\n    <farris-datagrid #potentialOwnerGrid class=\"f-component-grid\" [columns]=\"columns\" [data]=\"participant.potentialOwnerList\" #defaultPerformerGrid [idField]=\"'id'\" [showLineNumber]=\"false\"\r\n      [striped]=\"true\" [showCheckbox]=\"false\" [pagination]=\"false\" [fit]=\"true\" [fitColumns]=\"true\" [editable]=\"true\" [editMode]=\"'cell'\"\r\n      [multiSelect]=\"false\">\r\n    </farris-datagrid>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #editFooter>\r\n  <button type=\"button\" class=\"btn btn-secondary btn-sm px-3 mx-2\" (click)=\"editCancel()\">{{'component.participant.clickCancel'|wfLocale}}</button>\r\n  <button type=\"button\" class=\"btn btn-primary btn-sm px-3 mx-2\" (click)=\"editOK()\">{{'component.participant.clickOK'|wfLocale}}</button>\r\n</ng-template>\r\n",
                    providers: [
                        ParticipantUIState,
                        WfLocalePipe
                    ],
                    styles: [".container{display:flex;justify-content:space-between}.last-div{margin-left:auto}"]
                }] }
    ];
    /** @nocollapse */
    AlternativeParticipantComponent.ctorParameters = function () { return [
        { type: ProcessDesignerUIState },
        { type: ParticipantUIState },
        { type: ComponentFactoryResolver },
        { type: Injector },
        { type: BsModalService },
        { type: MessagerService },
        { type: ExpressionService },
        { type: HttpService },
        { type: ChangeDetectorRef, decorators: [{ type: Optional }] },
        { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
        { type: undefined, decorators: [{ type: Inject, args: [WF_LANG_RESOURCES,] }] },
        { type: WfLocalePipe, decorators: [{ type: Optional }] }
    ]; };
    AlternativeParticipantComponent.propDecorators = {
        closeModal: [{ type: Output }],
        submitModal: [{ type: Output }],
        modalFooter: [{ type: ViewChild, args: ['iconSelectFooter',] }],
        dropDownE2: [{ type: ViewChild, args: ['dropdownE2',] }],
        editFooter: [{ type: ViewChild, args: ['editFooter',] }],
        potentialOwnerGrid: [{ type: ViewChild, args: ['potentialOwnerGrid',] }],
        editorParams: [{ type: Input }]
    };
    return AlternativeParticipantComponent;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var OrganizationPotentialOwnerComponent = /** @class */ (function () {
    function OrganizationPotentialOwnerComponent(cdr, localeId, resources, localePipe, expr, message, designerUIState) {
        var _this = this;
        this.cdr = cdr;
        this.localeId = localeId;
        this.resources = resources;
        this.localePipe = localePipe;
        this.expr = expr;
        this.message = message;
        this.designerUIState = designerUIState;
        this.cls = 'farris-main-area flex-column';
        this.closeModal = new EventEmitter();
        this.submitModal = new EventEmitter();
        this.editorParams = {};
        this.organizationLevelCollection = [{
                value: 'GLOBAL',
                text: this.localePipe.transform('component.orgPotentialOwner.global'),
                orgId: 'global',
            }, {
                value: 'UNIT',
                text: this.localePipe.transform('component.orgPotentialOwner.currentUnit'),
                orgId: 'currentUnit'
            }, {
                value: 'DEPARTMENT',
                text: this.localePipe.transform('component.orgPotentialOwner.currentDepartment'),
                orgId: 'currentDepartment'
            },
            {
                value: 'VARORGANIZATION',
                text: this.localePipe.transform('component.orgPotentialOwner.variableOrganization'),
                orgId: ''
            }];
        this.actionCollection = [{
                value: ActionScope$2.AddSignBehind, name: this.localePipe.transform('component.orgPotentialOwner.addSignBehind')
            }, {
                value: ActionScope$2.AddSignFront, name: this.localePipe.transform('component.orgPotentialOwner.addSignFront')
            }, {
                value: ActionScope$2.Transfer, name: this.localePipe.transform('component.orgPotentialOwner.transfer')
            }, {
                value: ActionScope$2.Notify, name: this.localePipe.transform('component.orgPotentialOwner.notify')
            }];
        this.enable = false;
        this.organizationLevel = this.organizationLevelCollection[0].value;
        this.action = this.actionCollection[0].value;
        this.includeChildren = false;
        this.organizationId = '';
        this.showClearButton = false;
        this.actionName = (/**
         * @return {?}
         */
        function () {
            return _this.actionCollection.find((/**
             * @param {?} a
             * @return {?}
             */
            function (a) { return a.value === _this.action; })).name;
        });
        this.modalConfig = {
            title: this.localePipe.transform('component.orgPotentialOwner.optionSettings'),
            width: 760,
            height: 506,
            showButtons: true
        };
        this.localePipe = this.localePipe || new WfLocalePipe(localeId, resources);
    }
    Object.defineProperty(OrganizationPotentialOwnerComponent.prototype, "value", {
        set: /**
         * @param {?} v
         * @return {?}
         */
        function (v) {
            var _this = this;
            this.action = (/** @type {?} */ (v.action));
            if (this.action === this.actionCollection[2].value) {
                if (v.enable === null || v.enable === undefined) {
                    this.enable = true;
                }
                else {
                    this.enable = v.enable;
                }
            }
            else {
                this.enable = v.enable;
            }
            if (v.scope) {
                this.alternativeParticipant.participant.isAllScope = true;
                /** @type {?} */
                var organizationParticipantExpression = new OrganizationParticipantExpression$1();
                organizationParticipantExpression.actionScope = (/** @type {?} */ (v.action));
                if (v.scope.organizationLevel === OrganizationLevel$2.DEFAULT && v.scope.tag === 'expression') {
                    organizationParticipantExpression.organizationLevel = OrganizationLevel$2.VARORGANIZATION;
                    organizationParticipantExpression.tag = v.scope.tag;
                    this.organizationLevel = OrganizationLevel$2.VARORGANIZATION;
                }
                else if (v.scope.organizationLevel) {
                    this.organizationLevel = v.scope.organizationLevel;
                }
                this.includeChildren = v.scope.includeChildren;
                organizationParticipantExpression.includeChildren = v.scope.includeChildren;
                this.organizationId = v.scope.organizationId;
                organizationParticipantExpression.organizationId = v.scope.organizationId;
                organizationParticipantExpression.organizationName = this.organizationLevelCollection.find((/**
                 * @param {?} o
                 * @return {?}
                 */
                function (o) { return o.value === _this.organizationLevel; })).text;
                this.alternativeParticipant.addOrganizationParticipant(organizationParticipantExpression);
                if (v.scope.participantInfo) {
                    this.alternativeParticipant.participant = v.scope.participantInfo;
                }
                else {
                    this.alternativeParticipant.participant = new ParticipantInfo();
                }
            }
            else {
                this.alternativeParticipant.participant.isAllScope = false;
            }
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    OrganizationPotentialOwnerComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
    };
    /**
     * @return {?}
     */
    OrganizationPotentialOwnerComponent.prototype.clickOK = /**
     * @return {?}
     */
    function () {
        if (this.validate()) {
            /** @type {?} */
            var scope = new ActionOrganizationScopeDesign();
            scope.enable = this.enable;
            scope.action = (/** @type {?} */ (this.action));
            if (this.alternativeParticipant.participant.isAllScope) {
                /** @type {?} */
                var potential = new OrganizationPotentialOwner();
                potential.actionScope = this.action;
                // potential.organizationLevel = this.organizationLevel as OrganizationLevel;
                // potential.organizationId = this.organizationLevelCollection.find(o => o.value === this.organizationLevel).orgId || this.organizationId;
                // potential.organizationName = this.organizationLevelCollection.find(o => o.value === this.organizationLevel).text;
                // potential.includeChildren = this.includeChildren;
                // if (potential.organizationLevel === OrganizationLevel.VARORGANIZATION) {
                //   potential.tag = 'expression';
                //   potential.organizationLevel = OrganizationLevel.DEFAULT;
                // } else {
                //   potential.tag = 'variable';
                // }
                scope.scope = (/** @type {?} */ (potential));
                scope.scope.participantInfo = this.alternativeParticipant.participant;
            }
            /** @type {?} */
            var object = { value: scope, parameters: null };
            this.submitModal.emit(object);
        }
    };
    /**
     * @return {?}
     */
    OrganizationPotentialOwnerComponent.prototype.clickCancel = /**
     * @return {?}
     */
    function () {
        this.closeModal.emit();
    };
    /**
     * @return {?}
     */
    OrganizationPotentialOwnerComponent.prototype.validate = /**
     * @return {?}
     */
    function () {
        if (this.alternativeParticipant.participant.isAllScope &&
            (!this.alternativeParticipant.participant.potentialOwnerList || this.alternativeParticipant.participant.potentialOwnerList.length <= 0)) {
            this.message.info(this.localePipe.transform('component.orgPotentialOwner.turnOffPrompt'));
            return false;
        }
        else {
            return true;
        }
    };
    /**
     * @param {?} event
     * @return {?}
     */
    OrganizationPotentialOwnerComponent.prototype.valueChange = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        switch (event.value) {
            case this.organizationLevelCollection[0].value:
                this.includeChildren = false;
                break;
            case this.organizationLevelCollection[1].value:
                this.includeChildren = true;
                break;
            case this.organizationLevelCollection[2].value:
                this.includeChildren = false;
                break;
            case this.organizationLevelCollection[3].value:
                this.includeChildren = true;
                this.organizationId = '';
                break;
        }
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    OrganizationPotentialOwnerComponent.prototype.clear = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        this.organizationId = '';
    };
    /**
     * @param {?} data
     * @return {?}
     */
    OrganizationPotentialOwnerComponent.prototype.selectValue = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        this.showExprHelp();
    };
    /**
     * @return {?}
     */
    OrganizationPotentialOwnerComponent.prototype.showExprHelp = /**
     * @return {?}
     */
    function () {
        var _this = this;
        var e_1, _a, e_2, _b, e_3, _c, e_4, _d, e_5, _e;
        /** @type {?} */
        var context = new Array();
        // if(this.expr.exprEntity.contextEntities.find(x => x.key === 'CurrentLanguage')) {
        //   context.push(this.expr.exprEntity.contextEntities.find(x => x.key === 'CurrentLanguage'));
        // }
        // this.expr.clearContext();
        this.expr.setEditPattern(ExprEditMode.Advanced);
        if (this.designerUIState.schemas.length > 0) {
            try {
                for (var _f = __values(this.designerUIState.schemas), _g = _f.next(); !_g.done; _g = _f.next()) {
                    var schema = _g.value;
                    this.expr.addSchema('Schema', schema);
                }
            }
            catch (e_1_1) { e_1 = { error: e_1_1 }; }
            finally {
                try {
                    if (_g && !_g.done && (_a = _f.return)) _a.call(_f);
                }
                finally { if (e_1) throw e_1.error; }
            }
            if (this.designerUIState.schemas[0].entityTypes && this.designerUIState.schemas[0].entityTypes.length > 0) {
                /** @type {?} */
                var entityType = this.designerUIState.schemas[0].entityTypes[0];
                this.expr.addInjectedEntity(entityType.name, 'Schema', entityType.name, InjectedType.EntityType);
            }
        }
        if (this.designerUIState.participantContext.length > 0) {
            try {
                for (var _h = __values(this.designerUIState.participantContext), _j = _h.next(); !_j.done; _j = _h.next()) {
                    var variable = _j.value;
                    context.push(variable);
                }
            }
            catch (e_2_1) { e_2 = { error: e_2_1 }; }
            finally {
                try {
                    if (_j && !_j.done && (_b = _h.return)) _b.call(_h);
                }
                finally { if (e_2) throw e_2.error; }
            }
        }
        if (this.designerUIState.processVariableContext.length > 0) {
            var _loop_1 = function (variable) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    context.push(variable);
                }
            };
            try {
                for (var _k = __values(this.designerUIState.processVariableContext), _l = _k.next(); !_l.done; _l = _k.next()) {
                    var variable = _l.value;
                    _loop_1(variable);
                }
            }
            catch (e_3_1) { e_3 = { error: e_3_1 }; }
            finally {
                try {
                    if (_l && !_l.done && (_c = _k.return)) _c.call(_k);
                }
                finally { if (e_3) throw e_3.error; }
            }
        }
        if (this.designerUIState.subActivityContext.length > 0) {
            var _loop_2 = function (variable) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    context.push(variable);
                }
            };
            try {
                for (var _m = __values(this.designerUIState.subActivityContext), _o = _m.next(); !_o.done; _o = _m.next()) {
                    var variable = _o.value;
                    _loop_2(variable);
                }
            }
            catch (e_4_1) { e_4 = { error: e_4_1 }; }
            finally {
                try {
                    if (_o && !_o.done && (_d = _m.return)) _d.call(_m);
                }
                finally { if (e_4) throw e_4.error; }
            }
        }
        if (context.length > 0) {
            try {
                for (var context_1 = __values(context), context_1_1 = context_1.next(); !context_1_1.done; context_1_1 = context_1.next()) {
                    var v = context_1_1.value;
                    this.expr.addContext(v);
                }
            }
            catch (e_5_1) { e_5 = { error: e_5_1 }; }
            finally {
                try {
                    if (context_1_1 && !context_1_1.done && (_e = context_1.return)) _e.call(context_1);
                }
                finally { if (e_5) throw e_5.error; }
            }
        }
        // 预置表达式展示文本
        if (this.organizationId) {
            this.expr.addExpressionText(this.organizationId);
        }
        else {
            this.expr.addExpressionText('');
        }
        this.expr.buildExpression().then((/**
         * @param {?} expressioninfo
         * @return {?}
         */
        function (expressioninfo) {
            if (expressioninfo) {
                _this.organizationId = expressioninfo;
                _this.organizationLevelCollection[3].orgId = expressioninfo;
            }
            //点击确定后，去除表达式里面的新增的上下文变量
            if (context.length > 0) {
                _this.expr.exprEntity.contextEntities = _this.expr.exprEntity.contextEntities.filter((/**
                 * @param {?} x
                 * @return {?}
                 */
                function (x) { return !context.some((/**
                 * @param {?} y
                 * @return {?}
                 */
                function (y) { return y.key === x.key; })); }));
            }
        }));
    };
    OrganizationPotentialOwnerComponent.decorators = [
        { type: Component, args: [{
                    selector: 'app-organization-potential-owner',
                    template: "<div class=\"f-page\">\r\n  <div class=\"f-utils-fill-flex-column farris-split-section m-2 h-100 farris-overflow-y-auto farris-overflow-y-auto\">\r\n    <section class=\"f-utils-fill-flex-column h-100\">\r\n      <div class=\"f-utils-fill-flex-column h-100 farris-overflow-y-auto\" style=\"border-radius:16px;border: 1.5px solid #F1F3F7;\">\r\n        <div class=\"farris-form form-inline farris-form-inline\">\r\n          <div class=\"col-12 farris-group-auto my-3 pr-5\">\r\n            <div class=\"farris-group-wrap\">\r\n              <div class=\"form-group farris-form-group\">\r\n                <label class=\"col-form-label\" style=\"width: 5.3rem\">\r\n                  <span class=\"farris-label-text\">{{('component.orgPotentialOwner.enable'|wfLocale) + actionName()}}</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap ml-1\">\r\n                  <farris-switch [(ngModel)]=\"enable\" name=\"enable\"></farris-switch>\r\n                  <div class=\"farris-feedback valid-feedback\"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"col-12 farris-group-auto my-3 pr-5\">\r\n            <wf-alternative-participant [editorParams] = \"editorParams.nodeType\">\r\n            </wf-alternative-participant>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </section>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type=\"button\" class=\"btn btn-secondary btn-sm mx-2\" (click)=\"clickCancel()\">{{'component.orgPotentialOwner.clickCancel'|wfLocale}}</button>\r\n  <button type=\"button\" class=\"btn btn-primary btn-sm mx-2\" (click)=\"clickOK()\">{{'component.orgPotentialOwner.clickOK'|wfLocale}}</button>\r\n</ng-template>\r\n",
                    providers: [
                        WfLocalePipe,
                    ],
                    styles: [".title-content{color:#000;display:inline-flex;align-items:center;line-height:1.375rem;position:relative;overflow:hidden;padding:0 0 0 1rem;min-width:390px}.title-content ::before{content:'';width:.25rem;height:1.125rem;background:#59a1ff;border-radius:1px;position:absolute;top:50%;left:0;margin-top:-.5625rem}.title-text{font-size:1rem;line-height:1.375rem;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;margin-bottom:0;margin-right:10px}.title-line{flex-grow:1;border-bottom:1px dashed rgba(0,0,0,.1)}"]
                }] }
    ];
    /** @nocollapse */
    OrganizationPotentialOwnerComponent.ctorParameters = function () { return [
        { type: ChangeDetectorRef, decorators: [{ type: Optional }] },
        { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
        { type: undefined, decorators: [{ type: Inject, args: [WF_LANG_RESOURCES,] }] },
        { type: WfLocalePipe, decorators: [{ type: Optional }] },
        { type: ExpressionService },
        { type: MessagerService },
        { type: ProcessDesignerUIState }
    ]; };
    OrganizationPotentialOwnerComponent.propDecorators = {
        cls: [{ type: HostBinding, args: ['class',] }],
        closeModal: [{ type: Output }],
        submitModal: [{ type: Output }],
        editorParams: [{ type: Input }],
        alternativeParticipant: [{ type: ViewChild, args: [AlternativeParticipantComponent,] }],
        value: [{ type: Input }],
        modalFooter: [{ type: ViewChild, args: ['iconSelectFooter',] }]
    };
    return OrganizationPotentialOwnerComponent;
}());
var OrganizationPotentialOwnerConverter = /** @class */ (function () {
    function OrganizationPotentialOwnerConverter(localePipe) {
        this.localePipe = localePipe;
    }
    /**
     * @param {?} data
     * @return {?}
     */
    OrganizationPotentialOwnerConverter.prototype.convertTo = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        if (data && data.action === (/** @type {?} */ (ActionScope$2.Transfer)) && (data.enable === null || data.enable === undefined)) {
            return this.localePipe.transform("component.orgPotentialOwner.set");
        }
        else {
            if (data && data.enable) {
                return this.localePipe.transform("component.orgPotentialOwner.set");
            }
            else {
                return this.localePipe.transform("component.orgPotentialOwner.notSet");
            }
        }
    };
    return OrganizationPotentialOwnerConverter;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var AnonymousSet = /** @class */ (function () {
    function AnonymousSet() {
        this.isAnonymity = false;
        this.anonymous = '审批人';
    }
    return AnonymousSet;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var AnonymousSetComponent = /** @class */ (function () {
    function AnonymousSetComponent(injector, cdr, localeId, resources, localePipe) {
        this.injector = injector;
        this.cdr = cdr;
        this.localeId = localeId;
        this.resources = resources;
        this.localePipe = localePipe;
        this.cls = 'farris-main-area flex-column';
        this.closeModal = new EventEmitter();
        this.submitModal = new EventEmitter();
        this.anonymousSet = new AnonymousSet();
        this.modalConfig = {
            title: this.localePipe.transform('component.anonymousSet.anonymousOpt'),
            width: 450,
            height: 360,
            showButtons: true
        };
        this.localePipe = this.localePipe || new WfLocalePipe(localeId, resources);
    }
    Object.defineProperty(AnonymousSetComponent.prototype, "value", {
        set: /**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            this.anonymousSet.isAnonymity = data.isAnonymity || false;
            this.anonymousSet.anonymous = data.anonymous || this.localePipe.transform('component.anonymousSet.approver');
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    AnonymousSetComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
    };
    /**
     * @return {?}
     */
    AnonymousSetComponent.prototype.clickOK = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var object = { value: this.anonymousSet, parameters: null };
        this.submitModal.emit(object);
    };
    /**
     * @return {?}
     */
    AnonymousSetComponent.prototype.clickCancel = /**
     * @return {?}
     */
    function () {
        this.closeModal.emit();
    };
    AnonymousSetComponent.decorators = [
        { type: Component, args: [{
                    selector: 'lib-anonymous-set',
                    template: "<div class=\"f-page\">\r\n  <div class=\"f-utils-fill-flex-column farris-split-section m-2 h-100\">\r\n    <section class=\"f-utils-fill-flex-column h-100\">\r\n      <div class=\"f-section-header pt-2 mx-2\">\r\n        <div class=\"f-title\">\r\n          <h4 class=\"f-title-text\">{{'component.anonymousSet.anonymousSet'|wfLocale}}</h4>\r\n        </div>\r\n      </div>\r\n      <div class=\"f-utils-fill-flex-column h-100\">\r\n        <div class=\"farris-form form-inline farris-form-inline\">\r\n          <div class=\"col-12 farris-group-auto my-3 pr-5\">\r\n            <div class=\"farris-group-wrap\">\r\n              <div class=\"form-group farris-form-group\">\r\n                <label class=\"col-form-label\">\r\n                  <span class=\"farris-label-text\">{{'component.anonymousSet.isAnonymity'|wfLocale}}</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap ml-1\">\r\n                  <farris-switch [(ngModel)]=\"anonymousSet.isAnonymity\" name=\"isAnonymity\"></farris-switch>\r\n                  <div class=\"farris-feedback valid-feedback\"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"col-12 farris-group-auto mt-4 pr-5\">\r\n            <div class=\"farris-group-wrap\">\r\n              <div class=\"form-group farris-form-group\">\r\n                <label class=\"col-form-label\">\r\n                  <span class=\"farris-label-text\">{{'component.anonymousSet.anonymous'|wfLocale}}</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap ml-1\">\r\n                  <textarea class=\"form-control\" type=\"text\" value=\"anonymous\" [(ngModel)]=\"anonymousSet.anonymous\" name=\"anonymous\"\r\n                  style=\"height: 50px;\" [readOnly]=\"!anonymousSet.isAnonymity\"></textarea>\r\n                  <div class=\"farris-feedback valid-feedback\"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </section>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type=\"button\" class=\"btn btn-secondary btn-sm mx-2\" (click)=\"clickCancel()\">{{'component.anonymousSet.clickCancel'|wfLocale}}</button>\r\n  <button type=\"button\" class=\"btn btn-primary btn-sm mx-2\" (click)=\"clickOK()\">{{'component.anonymousSet.clickOK'|wfLocale}}</button>\r\n</ng-template>\r\n",
                    providers: [
                        WfLocalePipe,
                    ],
                    styles: [""]
                }] }
    ];
    /** @nocollapse */
    AnonymousSetComponent.ctorParameters = function () { return [
        { type: Injector },
        { type: ChangeDetectorRef, decorators: [{ type: Optional }] },
        { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
        { type: undefined, decorators: [{ type: Inject, args: [WF_LANG_RESOURCES,] }] },
        { type: WfLocalePipe, decorators: [{ type: Optional }] }
    ]; };
    AnonymousSetComponent.propDecorators = {
        cls: [{ type: HostBinding, args: ['class',] }],
        closeModal: [{ type: Output }],
        submitModal: [{ type: Output }],
        value: [{ type: Input }],
        modalFooter: [{ type: ViewChild, args: ['iconSelectFooter',] }]
    };
    return AnonymousSetComponent;
}());
var AnonymousSetConverter = /** @class */ (function () {
    function AnonymousSetConverter(localePipe) {
        this.localePipe = localePipe;
    }
    /**
     * @param {?} data
     * @return {?}
     */
    AnonymousSetConverter.prototype.convertTo = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        if (data && data.isAnonymity) {
            return this.localePipe.transform("component.anonymousSet.set");
        }
        else {
            return this.localePipe.transform("component.anonymousSet.notSet");
        }
    };
    return AnonymousSetConverter;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var VariableSetting$1 = /** @class */ (function () {
    function VariableSetting$$1() {
    }
    return VariableSetting$$1;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var VariableSettingComponent = /** @class */ (function () {
    function VariableSettingComponent(resolver, injector, modalService, message, uistate, expr, cdr, localeId, resources, localePipe) {
        var _this = this;
        this.resolver = resolver;
        this.injector = injector;
        this.modalService = modalService;
        this.message = message;
        this.uistate = uistate;
        this.expr = expr;
        this.cdr = cdr;
        this.localeId = localeId;
        this.resources = resources;
        this.localePipe = localePipe;
        this.cls = 'farris-main-area flex-column';
        this.closeModal = new EventEmitter();
        this.submitModal = new EventEmitter();
        this.value = new Array();
        this.editorParams = {};
        this.columns = [];
        this.tags = [
            { value: 'constant', text: this.localePipe.transform("component.variableSetting.constant") },
            { value: 'expression', text: this.localePipe.transform("component.variableSetting.expression") },
            { value: 'component', text: this.localePipe.transform("component.variableSetting.component") }
        ];
        this.opportunities = [
            { value: 'ACTIVITY_STARTED', text: this.localePipe.transform("component.variableSetting.ACTIVITY_STARTED") },
            { value: 'ACTIVITY_COMPLETED', text: this.localePipe.transform("component.variableSetting.ACTIVITY_COMPLETED") }
        ];
        this.modalConfig = {
            title: this.localePipe.transform("component.variableSetting.varAssign"),
            width: 780,
            height: 460,
            showButtons: true
        };
        this.beforeEdit = (/**
         * @param {?} param
         * @return {?}
         */
        function (param) {
            /** @type {?} */
            var rowData = (/** @type {?} */ (param.rowData));
            /** @type {?} */
            var column = param.column;
            if (column.field === 'valueText') {
                if (((/** @type {?} */ (rowData))).tag === _this.tags[0].value) {
                    param.column.editor = { type: EditorTypes.TEXTBOX, options: {} };
                }
                else {
                    param.column.editor = {
                        type: 'input-group',
                        options: {
                            groupText: '<i class="f-icon f-icon-lookup"></i>',
                            editable: false,
                            showClear: false,
                            clickHandle: (/**
                             * @param {?} e
                             * @return {?}
                             */
                            function (e) {
                                e.formControl.setValue(e.instance.value ? e.instance.value : '');
                                _this.valueEdit(e);
                            }),
                            clear: (/**
                             * @param {?} e
                             * @return {?}
                             */
                            function (e) {
                                console.log('clear', e);
                            })
                        }
                    };
                }
            }
            return of$1(true);
        });
        this.localePipe = this.localePipe || new WfLocalePipe(localeId, resources);
    }
    /**
     * @return {?}
     */
    VariableSettingComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.columns = [
            {
                field: 'variableCode', width: 90, title: this.localePipe.transform("component.variableSetting.varNumber"), sortable: true,
                validators: [
                    { type: 'required', messager: '必填' }
                ]
            },
            {
                field: 'variableName', width: 90, title: this.localePipe.transform("component.variableSetting.varName"), sortable: true,
                validators: [
                    { type: 'required', messager: '必填' }
                ]
            }, {
                field: 'tag', width: 60, title: this.localePipe.transform("component.variableSetting.valueType"), sortable: true,
                formatter: {
                    type: 'enum',
                    options: { valueField: 'value', textField: 'text', data: this.tags }
                },
                editor: {
                    type: EditorTypes.COMBOLIST,
                    options: {
                        valueField: 'value', textField: 'text', data: this.tags, idField: 'value', panelHeight: 'auto', showClear: false,
                        selectChange: (/**
                         * @param {?} e
                         * @return {?}
                         */
                        function (e) {
                            _this.value = _this.value.map((/**
                             * @param {?} v
                             * @return {?}
                             */
                            function (v) {
                                if (v.variableCode === e.rowId) {
                                    v.value = null;
                                    v.valueText = null;
                                    if (v.component) {
                                        v.component = null;
                                    }
                                    return v;
                                }
                                else {
                                    return v;
                                }
                            }));
                        })
                    }
                },
                validators: [
                    { type: 'required', messager: '必填' }
                ]
            }, {
                field: 'executionTime', width: 80, title: this.localePipe.transform("component.variableSetting.executionTime"), sortable: true,
                formatter: {
                    type: 'enum',
                    options: { valueField: 'value', textField: 'text', data: this.opportunities }
                },
                editor: {
                    type: EditorTypes.COMBOLIST,
                    options: {
                        valueField: 'value', textField: 'text', data: this.opportunities, idField: 'value', panelHeight: 'auto', showClear: false,
                    }
                },
                validators: [
                    { type: 'required', messager: '必填' }
                ],
            },
            {
                field: 'valueText', width: 150, title: this.localePipe.transform("component.variableSetting.valueText"), showTips: true,
                editor: { type: EditorTypes.TEXTBOX, options: {} },
                validators: [
                    { type: 'required', messager: '必填' }
                ]
            }
        ];
    };
    /**
     * @return {?}
     */
    VariableSettingComponent.prototype.add = /**
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var dialog;
        /** @type {?} */
        var compFactory = this.resolver.resolveComponentFactory(ProcessVariablesComponent);
        /** @type {?} */
        var compRef = compFactory.create(this.injector);
        compRef.instance.variableSetting = true;
        compRef.instance.value = this.uistate.ProcessVariables;
        compRef.instance.selectedValue = this.value;
        compRef.instance.variableSetEmitter.subscribe((/**
         * @param {?} re
         * @return {?}
         */
        function (re) {
            var e_1, _a;
            var _loop_1 = function (v) {
                /** @type {?} */
                var variableSet = new VariableSetting$1();
                variableSet.variableCode = v.data.name;
                variableSet.variableName = v.data.documentation;
                variableSet.tag = v.data.tag || _this.tags[0].value;
                variableSet.executionTime = v.data.executionTime || _this.opportunities[0].value;
                if (_this.value.findIndex((/**
                 * @param {?} i
                 * @return {?}
                 */
                function (i) { return i.variableCode === variableSet.variableCode; })) === -1) {
                    _this.value = _this.value.concat([variableSet]);
                }
            };
            try {
                for (var re_1 = __values(re), re_1_1 = re_1.next(); !re_1_1.done; re_1_1 = re_1.next()) {
                    var v = re_1_1.value;
                    _loop_1(v);
                }
            }
            catch (e_1_1) { e_1 = { error: e_1_1 }; }
            finally {
                try {
                    if (re_1_1 && !re_1_1.done && (_a = re_1.return)) _a.call(re_1);
                }
                finally { if (e_1) throw e_1.error; }
            }
            dialog.close();
        }));
        compRef.instance.closeModal.subscribe((/**
         * @param {?} re
         * @return {?}
         */
        function (re) {
            dialog.close();
        }));
        /** @type {?} */
        var modalConfig = {
            title: this.localePipe.transform("component.variableSetting.processVariables"),
            width: 660,
            height: 460,
            showButtons: true,
            buttons: compRef.instance.modalFooter
        };
        dialog = this.modalService.show(compRef, modalConfig);
    };
    /**
     * @return {?}
     */
    VariableSettingComponent.prototype.delete = /**
     * @return {?}
     */
    function () {
        this.grid.endCellEdit();
        /** @type {?} */
        var selected = this.grid.selectedRow;
        if (!selected) {
            this.message.info(this.localePipe.transform("component.variableSetting.notSelectedVar"));
            return;
        }
        this.value = this.value.filter((/**
         * @param {?} v
         * @return {?}
         */
        function (v) { return v.variableCode !== selected.data.variableCode; }));
    };
    /**
     * @return {?}
     */
    VariableSettingComponent.prototype.clickOK = /**
     * @return {?}
     */
    function () {
        var _this = this;
        // 先结束编辑状态
        this.grid.endCellEdit();
        // 等待编辑状态结束后再进行校验
        setTimeout((/**
         * @return {?}
         */
        function () {
            if (_this.validator()) {
                /** @type {?} */
                var object = { value: _this.value, parameters: null };
                _this.submitModal.emit(object);
            }
        }), 300);
    };
    /**
     * @return {?}
     */
    VariableSettingComponent.prototype.clickCancel = /**
     * @return {?}
     */
    function () {
        this.closeModal.emit();
    };
    /**
     * @return {?}
     */
    VariableSettingComponent.prototype.validator = /**
     * @return {?}
     */
    function () {
        var e_2, _a;
        try {
            for (var _b = __values(this.value), _c = _b.next(); !_c.done; _c = _b.next()) {
                var item = _c.value;
                if (!item.value) {
                    this.message.warning(this.localePipe.transform("component.variableSetting.valueCannotEmpty"));
                    return false;
                }
            }
        }
        catch (e_2_1) { e_2 = { error: e_2_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_2) throw e_2.error; }
        }
        return true;
    };
    /**
     * @param {?} data
     * @return {?}
     */
    VariableSettingComponent.prototype.endEdit = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        if (data.column.field === 'valueText' && data.rowData.tag === this.tags[0].value) {
            data.rowData.value = data.rowData.valueText;
        }
    };
    /**
     * @param {?} e
     * @return {?}
     */
    VariableSettingComponent.prototype.valueEdit = /**
     * @param {?} e
     * @return {?}
     */
    function (e) {
        /** @type {?} */
        var rowdata = e.rowData;
        switch (rowdata.tag) {
            case this.tags[1].value:
                this.editExpression(e);
                break;
            case this.tags[2].value:
                this.editComponent(e);
                break;
        }
    };
    /**
     * @private
     * @param {?} e
     * @return {?}
     */
    VariableSettingComponent.prototype.editExpression = /**
     * @private
     * @param {?} e
     * @return {?}
     */
    function (e) {
        var _this = this;
        var e_3, _a, e_4, _b, e_5, _c;
        // this.expr.clearContext();
        /** @type {?} */
        var data = e.rowData;
        if (this.uistate.schemas.length > 0) {
            try {
                for (var _d = __values(this.uistate.schemas), _e = _d.next(); !_e.done; _e = _d.next()) {
                    var schema = _e.value;
                    this.expr.addSchema('Schema', schema);
                }
            }
            catch (e_3_1) { e_3 = { error: e_3_1 }; }
            finally {
                try {
                    if (_e && !_e.done && (_a = _d.return)) _a.call(_d);
                }
                finally { if (e_3) throw e_3.error; }
            }
            if (this.uistate.schemas[0].entityTypes && this.uistate.schemas[0].entityTypes.length > 0) {
                /** @type {?} */
                var entityType = this.uistate.schemas[0].entityTypes[0];
                this.expr.addInjectedEntity(entityType.name, 'Schema', entityType.name, InjectedType.EntityType);
            }
        }
        /** @type {?} */
        var context = new Array();
        context = this.uistate.addContext(context);
        if (this.uistate.subActivityContext.length > 0) {
            var _loop_2 = function (variable) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    context.push(variable);
                }
            };
            try {
                for (var _f = __values(this.uistate.subActivityContext), _g = _f.next(); !_g.done; _g = _f.next()) {
                    var variable = _g.value;
                    _loop_2(variable);
                }
            }
            catch (e_4_1) { e_4 = { error: e_4_1 }; }
            finally {
                try {
                    if (_g && !_g.done && (_b = _f.return)) _b.call(_f);
                }
                finally { if (e_4) throw e_4.error; }
            }
        }
        if (context.length > 0) {
            try {
                for (var context_1 = __values(context), context_1_1 = context_1.next(); !context_1_1.done; context_1_1 = context_1.next()) {
                    var v = context_1_1.value;
                    this.expr.addContext(v);
                }
            }
            catch (e_5_1) { e_5 = { error: e_5_1 }; }
            finally {
                try {
                    if (context_1_1 && !context_1_1.done && (_c = context_1.return)) _c.call(context_1);
                }
                finally { if (e_5) throw e_5.error; }
            }
        }
        this.expr.setEditPattern(ExprEditMode.Advanced); // 表达式展现模式：默认高级版
        this.expr.addExpressionText(data.value);
        this.expr.buildExpression().then((/**
         * @param {?} re
         * @return {?}
         */
        function (re) {
            e.formControl.setValue(re);
            e.instance.cd.detectChanges();
            data.value = re;
            e.form.bindingData.value = re;
            e.form.value.value = re;
            //点击确定后，去除表达式里面的新增的上下文变量
            if (context.length > 0) {
                _this.expr.exprEntity.contextEntities = _this.expr.exprEntity.contextEntities.filter((/**
                 * @param {?} x
                 * @return {?}
                 */
                function (x) { return !context.some((/**
                 * @param {?} y
                 * @return {?}
                 */
                function (y) { return y.key === x.key; })); }));
            }
        }));
    };
    /**
     * @private
     * @param {?} e
     * @return {?}
     */
    VariableSettingComponent.prototype.editComponent = /**
     * @private
     * @param {?} e
     * @return {?}
     */
    function (e) {
        /** @type {?} */
        var data = e.rowData;
        /** @type {?} */
        var dialog;
        /** @type {?} */
        var compFactory = this.resolver.resolveComponentFactory(ComponentEditComponent);
        /** @type {?} */
        var compRef = compFactory.create(this.injector);
        compRef.instance.component = data.component;
        compRef.instance.submitEmitter.subscribe((/**
         * @param {?} re
         * @return {?}
         */
        function (re) {
            e.formControl.setValue(re.Name + '-' + re.MethodCode);
            e.instance.cd.detectChanges();
            data.value = re.Id;
            data.component = re;
            e.form.bindingData.value = re.Id;
            e.form.value.value = re.Id;
            e.form.value.component = re;
            e.form.bindingData.component = re;
            dialog.close();
        }));
        compRef.instance.closeEmitter.subscribe((/**
         * @param {?} re
         * @return {?}
         */
        function (re) {
            dialog.close();
        }));
        /** @type {?} */
        var modalConfig = {
            title: this.localePipe.transform("component.variableSetting.component"),
            width: 800,
            height: 515,
            showButtons: true,
            buttons: compRef.instance.footer
        };
        dialog = this.modalService.show(compRef, modalConfig);
    };
    VariableSettingComponent.decorators = [
        { type: Component, args: [{
                    selector: 'lib-variable-setting',
                    template: "<div class=\"f-page\">\r\n  <div class=\"f-page-header\">\r\n    <nav class=\"f-page-header-base\">\r\n      <div class=\"f-title\">\r\n      </div>\r\n      <div class=\"btn-toolbar btn-group-lg\">\r\n        <button class=\"btn btn-primary mr-2\" (click)=\"add()\">{{'component.variableSetting.add' | wfLocale}}</button>\r\n        <button class=\"btn btn-secondary\" (click)=\"delete()\">{{'component.variableSetting.delete' | wfLocale}}</button>\r\n      </div>\r\n    </nav>\r\n  </div>\r\n  <div class=\"f-page-main f-utils-fill-flex-column h-100\">\r\n    <div class=\"f-utils-fill-flex-column farris-overflow-y-auto h-100\">\r\n      <farris-datagrid #grid [data]=\"value\" [columns]=\"columns\" [idField]=\"'variableCode'\" [fit]=\"true\" [fitColumns]=\"true\"\r\n        [editable]=\"true\" [editMode]=\"'cell'\" [pagination]=\"false\" [showCheckbox]=\"false\" [multiSelect]=\"false\"\r\n        [showLineNumber]=\"true\" lineNumberTitle=\"{{'component.variableSetting.lineNumber' | wfLocale}}\" [lineNumberWidth]=\"50\" [striped]=\"true\"\r\n        (endEdit)=\"endEdit($event)\" [beforeEdit]=\"beforeEdit\">\r\n      </farris-datagrid>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type=\"button\" class=\"btn btn-secondary btn-sm px-3 mx-2\" (click)=\"clickCancel()\">{{'component.variableSetting.clickCancel' | wfLocale}}</button>\r\n  <button type=\"button\" class=\"btn btn-primary btn-sm px-3 mx-2\" (click)=\"clickOK()\">{{'component.variableSetting.clickOK' | wfLocale}}</button>\r\n</ng-template>\r\n\r\n<ng-template #cell let-ctx>\r\n  <span (click)=\"valueEdit(ctx)\" class=\"link\">\r\n    {{ ctx.rowData.value ? ('component.variableSetting.set' | wfLocale) : ('component.variableSetting.notSet' | wfLocale) }}\r\n  </span>\r\n</ng-template>\r\n",
                    providers: [
                        WfLocalePipe,
                    ],
                    styles: [".link{color:#1206bb;font-size:14px}.link:hover{color:#5d478b;font-size:14px}"]
                }] }
    ];
    /** @nocollapse */
    VariableSettingComponent.ctorParameters = function () { return [
        { type: ComponentFactoryResolver },
        { type: Injector },
        { type: BsModalService },
        { type: MessagerService },
        { type: ProcessDesignerUIState },
        { type: ExpressionService },
        { type: ChangeDetectorRef, decorators: [{ type: Optional }] },
        { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
        { type: undefined, decorators: [{ type: Inject, args: [WF_LANG_RESOURCES,] }] },
        { type: WfLocalePipe, decorators: [{ type: Optional }] }
    ]; };
    VariableSettingComponent.propDecorators = {
        cls: [{ type: HostBinding, args: ['class',] }],
        closeModal: [{ type: Output }],
        submitModal: [{ type: Output }],
        value: [{ type: Input }],
        editorParams: [{ type: Input }],
        modalFooter: [{ type: ViewChild, args: ['iconSelectFooter',] }],
        grid: [{ type: ViewChild, args: ['grid',] }],
        cell: [{ type: ViewChild, args: ['cell',] }]
    };
    return VariableSettingComponent;
}());
var VariableSettingConverter = /** @class */ (function () {
    function VariableSettingConverter(localePipe) {
        this.localePipe = localePipe;
    }
    /**
     * @param {?} data
     * @return {?}
     */
    VariableSettingConverter.prototype.convertTo = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        if (data && data.length > 0) {
            return this.localePipe.transform("component.variableSetting.set");
        }
        else {
            return this.localePipe.transform("component.variableSetting.notSet");
        }
    };
    return VariableSettingConverter;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var ApprovalPivotConfig$1 = /** @class */ (function () {
    function ApprovalPivotConfig$$1() {
        this.localePipe = null;
        this.enable = false;
        this.title = '审批要点';
        this.approvalPivots = new Array();
    }
    return ApprovalPivotConfig$$1;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var ApprovalPivot$1 = /** @class */ (function () {
    function ApprovalPivot$$1() {
        this.id = ProcessDeUtil.GenerateElementId();
        this.type = 'REMIND';
    }
    return ApprovalPivot$$1;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var ApprovalPivotComponent = /** @class */ (function () {
    function ApprovalPivotComponent(designerUIState, expr, message, cdr, localeId, resources, localePipe) {
        var _this = this;
        this.designerUIState = designerUIState;
        this.expr = expr;
        this.message = message;
        this.cdr = cdr;
        this.localeId = localeId;
        this.resources = resources;
        this.localePipe = localePipe;
        this.cls = 'farris-main-area flex-column';
        this.closeModal = new EventEmitter();
        this.submitModal = new EventEmitter();
        this.config = new ApprovalPivotConfig$1();
        this.typeList = [
            { value: 'REMIND', text: this.localePipe.transform('component.approvalPivot.remind') }
        ];
        this.columns = [
            {
                field: 'type', width: 80, title: this.localePipe.transform('component.approvalPivot.type'),
                formatter: {
                    type: 'enum',
                    options: { valueField: 'value', textField: 'text', data: this.typeList }
                },
                editor: {
                    type: EditorTypes.COMBOLIST,
                    options: { valueField: 'value', textField: 'text', data: this.typeList, idField: 'value', panelHeight: 'auto', enableClear: false }
                },
                validators: [
                    { type: 'required', messager: '必填' }
                ]
            },
            {
                field: 'condition', width: 120, title: this.localePipe.transform('component.approvalPivot.condition'), showTips: true,
                editor: {
                    type: 'input-group',
                    options: {
                        groupText: '<i class="f-icon f-icon-lookup"></i>',
                        editable: false,
                        clickHandle: (/**
                         * @param {?} e
                         * @return {?}
                         */
                        function (e) {
                            e.formControl.setValue(e.instance.value ? e.instance.value : '');
                            _this.editConditon(e);
                        }),
                        clear: (/**
                         * @param {?} e
                         * @return {?}
                         */
                        function (e) {
                            console.log('clear', e);
                        })
                    }
                }
            },
            {
                field: 'title', width: 80, title: this.localePipe.transform('component.approvalPivot.title'),
                editor: { type: EditorTypes.TEXTBOX, options: {} }
            }, {
                field: 'description', width: 100, title: this.localePipe.transform('component.approvalPivot.description'), showTips: true,
                editor: { type: EditorTypes.TEXTBOX, options: {} }
            }
        ];
        this.modalConfig = {
            title: this.localePipe.transform('component.approvalPivot.approvalPivot'),
            width: 800,
            height: 480,
            showButtons: true
        };
        this.localePipe = this.localePipe || new WfLocalePipe(localeId, resources);
    }
    Object.defineProperty(ApprovalPivotComponent.prototype, "value", {
        set: /**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            var e_1, _a;
            this.config.localePipe = this.localePipe;
            if (data) {
                this.config.enable = data.enable;
                this.config.title = data.title;
                this.config.expand = data.expand;
                if (data.approvalPivots && data.approvalPivots.length > 0) {
                    try {
                        for (var _b = __values(data.approvalPivots), _c = _b.next(); !_c.done; _c = _b.next()) {
                            var a = _c.value;
                            /** @type {?} */
                            var approvalPivot = new ApprovalPivot$1();
                            approvalPivot.type = a.type;
                            approvalPivot.title = a.title;
                            approvalPivot.description = a.description;
                            if (a.condition) {
                                if (typeof (a.condition) === 'string') {
                                    approvalPivot.condition = a.condition;
                                }
                                else {
                                    approvalPivot.condition = a.condition._value;
                                }
                            }
                            this.config.approvalPivots = this.config.approvalPivots.concat([approvalPivot]);
                        }
                    }
                    catch (e_1_1) { e_1 = { error: e_1_1 }; }
                    finally {
                        try {
                            if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                        }
                        finally { if (e_1) throw e_1.error; }
                    }
                }
            }
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    ApprovalPivotComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
    };
    /**
     * @return {?}
     */
    ApprovalPivotComponent.prototype.add = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var approvalPivot = new ApprovalPivot$1();
        this.config.approvalPivots = this.config.approvalPivots.concat([approvalPivot]);
    };
    /**
     * @return {?}
     */
    ApprovalPivotComponent.prototype.delete = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var selectedRow = this.grid.selectedRow;
        if (!selectedRow) {
            this.message.info(this.localePipe.transform('component.approvalPivot.selectedRow'));
            return;
        }
        this.config.approvalPivots = this.config.approvalPivots.filter((/**
         * @param {?} a
         * @return {?}
         */
        function (a) { return a.id !== selectedRow.id; }));
    };
    /**
     * @return {?}
     */
    ApprovalPivotComponent.prototype.clickOK = /**
     * @return {?}
     */
    function () {
        if (!this.config.title && this.config.enable) {
            this.message.info(this.localePipe.transform('component.approvalPivot.configTitle'));
            return;
        }
        this.grid.endCellEdit();
        if (this.validator()) {
            /** @type {?} */
            var object = { value: this.config, parameters: null };
            this.submitModal.emit(object);
        }
    };
    /**
     * @return {?}
     */
    ApprovalPivotComponent.prototype.clickCancel = /**
     * @return {?}
     */
    function () {
        this.closeModal.emit();
    };
    /**
     * @private
     * @return {?}
     */
    ApprovalPivotComponent.prototype.validator = /**
     * @private
     * @return {?}
     */
    function () {
        return true;
    };
    /**
     * @param {?} e
     * @return {?}
     */
    ApprovalPivotComponent.prototype.editConditon = /**
     * @param {?} e
     * @return {?}
     */
    function (e) {
        var _this = this;
        var e_2, _a, e_3, _b, e_4, _c, e_5, _d;
        /** @type {?} */
        var context = new Array();
        // if(this.expr.exprEntity.contextEntities.find(x => x.key === 'CurrentLanguage')) {
        //   context.push(this.expr.exprEntity.contextEntities.find(x => x.key === 'CurrentLanguage'));
        // }
        // this.expr.clearContext();
        if (this.designerUIState.schemas.length > 0) {
            try {
                for (var _e = __values(this.designerUIState.schemas), _f = _e.next(); !_f.done; _f = _e.next()) {
                    var schema = _f.value;
                    this.expr.addSchema('Schema', schema);
                }
            }
            catch (e_2_1) { e_2 = { error: e_2_1 }; }
            finally {
                try {
                    if (_f && !_f.done && (_a = _e.return)) _a.call(_e);
                }
                finally { if (e_2) throw e_2.error; }
            }
            if (this.designerUIState.schemas[0].entityTypes && this.designerUIState.schemas[0].entityTypes.length > 0) {
                /** @type {?} */
                var entityType = this.designerUIState.schemas[0].entityTypes[0];
                this.expr.addInjectedEntity(entityType.name, 'Schema', entityType.name, InjectedType.EntityType);
            }
        }
        context = this.designerUIState.addContext(context);
        if (this.designerUIState.subActivityContext.length > 0) {
            var _loop_1 = function (variable) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    context.push(variable);
                }
            };
            try {
                for (var _g = __values(this.designerUIState.subActivityContext), _h = _g.next(); !_h.done; _h = _g.next()) {
                    var variable = _h.value;
                    _loop_1(variable);
                }
            }
            catch (e_3_1) { e_3 = { error: e_3_1 }; }
            finally {
                try {
                    if (_h && !_h.done && (_b = _g.return)) _b.call(_g);
                }
                finally { if (e_3) throw e_3.error; }
            }
        }
        if (this.designerUIState.activityComponentContext.length > 0) {
            var _loop_2 = function (variable) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    context.push(variable);
                }
            };
            try {
                for (var _j = __values(this.designerUIState.activityComponentContext), _k = _j.next(); !_k.done; _k = _j.next()) {
                    var variable = _k.value;
                    _loop_2(variable);
                }
            }
            catch (e_4_1) { e_4 = { error: e_4_1 }; }
            finally {
                try {
                    if (_k && !_k.done && (_c = _j.return)) _c.call(_j);
                }
                finally { if (e_4) throw e_4.error; }
            }
        }
        if (context.length > 0) {
            try {
                for (var context_1 = __values(context), context_1_1 = context_1.next(); !context_1_1.done; context_1_1 = context_1.next()) {
                    var v = context_1_1.value;
                    this.expr.addContext(v);
                }
            }
            catch (e_5_1) { e_5 = { error: e_5_1 }; }
            finally {
                try {
                    if (context_1_1 && !context_1_1.done && (_d = context_1.return)) _d.call(context_1);
                }
                finally { if (e_5) throw e_5.error; }
            }
        }
        this.expr.addExpressionText(e.instance.value);
        this.expr.setEditPattern(ExprEditMode.Conditional);
        this.expr.buildExpression().then((/**
         * @param {?} cond
         * @return {?}
         */
        function (cond) {
            e.formControl.setValue(cond);
            e.instance.cd.detectChanges();
            //点击确定后，去除表达式里面的新增的上下文变量
            if (context.length > 0) {
                _this.expr.exprEntity.contextEntities = _this.expr.exprEntity.contextEntities.filter((/**
                 * @param {?} x
                 * @return {?}
                 */
                function (x) { return !context.some((/**
                 * @param {?} y
                 * @return {?}
                 */
                function (y) { return y.key === x.key; })); }));
            }
        }));
    };
    ApprovalPivotComponent.decorators = [
        { type: Component, args: [{
                    selector: 'lib-approval-pivot',
                    template: "<div class=\"f-page\">\r\n  <section class=\"f-page-main d-flex flex-column\">\r\n    <farris-section class=\"pt-0 f-section-form f-section-in-mainsubcard\" mainTitle=\"{{'component.approvalPivot.approvalPivot'|wfLocale}}\" [enableAccordion]=\"'default'\"\r\n      [enableMaximize]=\"false\">\r\n      <div class=\"wf-process-pivot\">\r\n        <div class=\"wf-process-pivot-actions\">\r\n          <span class=\"wf-process-pivot-actions-text\">{{'component.approvalPivot.enable'|wfLocale}}</span>\r\n          <farris-switch [(ngModel)]=\"config.enable\" name=\"enable\"></farris-switch>\r\n        </div>\r\n        <div class=\"wf-process-pivot-actions\">\r\n          <span class=\"wf-process-pivot-actions-text\">{{'component.approvalPivot.expand'|wfLocale}}</span>\r\n          <farris-switch [(ngModel)]=\"config.expand\" name=\"expand\" [disabled]=\"!config.enable\"></farris-switch>\r\n        </div>\r\n        <div class=\"wf-process-pivot-actions\">\r\n          <span class=\"farris-label-info text-danger\">*</span>\r\n          <span class=\"wf-process-pivot-actions-text\">{{'component.approvalPivot.showTitle'|wfLocale}}</span>\r\n          <div class=\"farris-input-wrap\">\r\n            <input type=\"text\" class=\"form-control\" [(ngModel)]=\"config.title\" name=\"title\" [readonly]=\"!config.enable\"/>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </farris-section>\r\n    <farris-section class=\"pt-0 f-section-grid f-section-in-managelist\" mainTitle=\"{{'component.approvalPivot.list'|wfLocale}}\" [enableAccordion]=\"''\"\r\n      [enableMaximize]=\"false\" [fill]=\"true\">\r\n      <ng-template farrisSectionToolbar>\r\n        <button class=\"btn btn-link pr-2 mr-2\" (click)=\"add()\" [disabled]=\"!config.enable\">{{'component.approvalPivot.add'|wfLocale}}</button>\r\n        <button class=\"btn btn-link mr-0\" (click)=\"delete()\" [disabled]=\"!config.enable\">{{'component.approvalPivot.delete'|wfLocale}}</button>\r\n      </ng-template>\r\n      <farris-datagrid class=\"f-component-grid\" [columns]=\"columns\" [data]=\"config.approvalPivots\" #grid [idField]=\"'id'\" [showLineNumber]=\"true\"\r\n        [striped]=\"true\" [showCheckbox]=\"false\" [pagination]=\"false\" [fit]=\"true\" [fitColumns]=\"true\" [editable]=\"true\" [editMode]=\"'cell'\"\r\n        [multiSelect]=\"false\" [disabled]=\"!config.enable\">\r\n      </farris-datagrid>\r\n    </farris-section>\r\n  </section>\r\n</div>\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type=\"button\" class=\"btn btn-secondary btn-sm px-3\" (click)=\"clickCancel()\">{{'component.approvalPivot.clickCancel'|wfLocale}}</button>\r\n  <button type=\"button\" class=\"btn btn-primary btn-sm px-3 mx-2\" (click)=\"clickOK()\">{{'component.approvalPivot.clickOK'|wfLocale}}</button>\r\n</ng-template>\r\n",
                    providers: [
                        WfLocalePipe,
                    ],
                    styles: [".wf-process-pivot{display:flex;align-items:center;margin-bottom:20px}.wf-process-pivot-actions{display:flex;padding-left:30px;align-items:center}.wf-process-pivot-actions-text{padding-right:10px}"]
                }] }
    ];
    /** @nocollapse */
    ApprovalPivotComponent.ctorParameters = function () { return [
        { type: ProcessDesignerUIState },
        { type: ExpressionService },
        { type: MessagerService },
        { type: ChangeDetectorRef, decorators: [{ type: Optional }] },
        { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
        { type: undefined, decorators: [{ type: Inject, args: [WF_LANG_RESOURCES,] }] },
        { type: WfLocalePipe, decorators: [{ type: Optional }] }
    ]; };
    ApprovalPivotComponent.propDecorators = {
        cls: [{ type: HostBinding, args: ['class',] }],
        closeModal: [{ type: Output }],
        submitModal: [{ type: Output }],
        modalFooter: [{ type: ViewChild, args: ['iconSelectFooter',] }],
        grid: [{ type: ViewChild, args: ['grid',] }],
        value: [{ type: Input }]
    };
    return ApprovalPivotComponent;
}());
var ApprovalPivotConverter = /** @class */ (function () {
    function ApprovalPivotConverter(localePipe) {
        this.localePipe = localePipe;
    }
    /**
     * @param {?} data
     * @return {?}
     */
    ApprovalPivotConverter.prototype.convertTo = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        if (data && data.enable) {
            return this.localePipe.transform('component.approvalPivot.set');
        }
        else {
            return this.localePipe.transform('component.approvalPivot.notSet');
        }
    };
    return ApprovalPivotConverter;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var UrgeHandleRule$1 = /** @class */ (function () {
    function UrgeHandleRule$$1() {
    }
    /**
     * @return {?}
     */
    UrgeHandleRule$$1.prototype.cconstructor = /**
     * @return {?}
     */
    function () {
        this.urgeHandleAble = false;
        this.earlyTime = 0;
        this.intervalTime = 0;
        this.urgeMessageSubject = "{\"expr\":\"'催办审批：' + DefaultFunction.GetContextParameter(\\\"bizDefName\\\")\",\"sexpr\":\"\"}";
        this.urgeMessageContent = "{\"expr\":\"'请您尽快审批' + DefaultFunction.GetContextParameter(\\\"procInstCreatorName\\\") + '的' + DefaultFunction.GetContextParameter(\\\"bizDefName\\\") + '。'\",\"sexpr\":\"\"}";
        this.addReminder = false;
        this.subjectEditable = true;
        this.contentEditable = true;
    };
    return UrgeHandleRule$$1;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var UrgeHandleRuleComponent = /** @class */ (function () {
    function UrgeHandleRuleComponent(designerUIState, expr, message, cdr, localeId, resources, localePipe) {
        this.designerUIState = designerUIState;
        this.expr = expr;
        this.message = message;
        this.cdr = cdr;
        this.localeId = localeId;
        this.resources = resources;
        this.localePipe = localePipe;
        this.groupIcon2 = '<i class="f-icon f-icon-lookup"></i>';
        this.closeModal = new EventEmitter();
        this.submitModal = new EventEmitter();
        this.urgeHandleRule = new UrgeHandleRule$1();
        this.typeGroup = this.designerUIState.messageChannels.map((/**
         * @param {?} m
         * @return {?}
         */
        function (m) { return ({ value: m.code, name: m.name }); }));
        this.modalConfig = {
            title: this.localePipe.transform("component.urgeHandleRule.urgeHandle"),
            width: 800,
            height: 515,
            showButtons: true
        };
        this.hasSmsTemplate = false;
        this.parser = (/**
         * @param {?} val
         * @return {?}
         */
        function (val) {
            return Number(val);
        });
        this.localePipe = this.localePipe || new WfLocalePipe(localeId, resources);
    }
    Object.defineProperty(UrgeHandleRuleComponent.prototype, "value", {
        set: /**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            if (!data) {
                this.urgeHandleRule.urgeHandleAble = true;
                this.urgeHandleRule.earlyTime = 0;
                this.urgeHandleRule.intervalTime = 0;
                this.urgeHandleRule.sendType = 'cloudplus,inmail';
                this.urgeHandleRule.urgeMessageSubject = "{\"expr\":\"'" + this.localePipe.transform("component.urgeHandleRule.urgentApproval") + "' + DefaultFunction.GetContextParameter(\\\"bizDefName\\\")\",\"sexpr\":\"\"}";
                this.urgeHandleRule.urgeMessageContent = "{\"expr\":\"'" + this.localePipe.transform("component.urgeHandleRule.pleaseApprove") + "' + DefaultFunction.GetContextParameter(\\\"procInstCreatorName\\\") + '" + this.localePipe.transform("component.urgeHandleRule.soOn") + "' + DefaultFunction.GetContextParameter(\\\"bizDefName\\\") + '\u3002'\",\"sexpr\":\"\"}";
            }
            else {
                this.urgeHandleRule = data;
                if (this.hasSmsMessage(this.urgeHandleRule.sendType)) {
                    this.hasSmsTemplate = true;
                    if (!this.urgeHandleRule.smsMessageTemplate) {
                        this.urgeHandleRule.smsMessageTemplate = new SmsMessageTemplate$1();
                    }
                }
            }
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    UrgeHandleRuleComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
    };
    /**
     * @return {?}
     */
    UrgeHandleRuleComponent.prototype.clickOK = /**
     * @return {?}
     */
    function () {
        if (this.SmsTemplate) {
            this.SmsTemplate.endGridEdit();
        }
        if (this.hasSmsTemplate) {
            this.urgeHandleRule.smsMessageTemplate = this.SmsTemplate.smsMessageTemplate;
            if (this.urgeHandleRule.smsMessageTemplate.smsMessageVariables && this.urgeHandleRule.smsMessageTemplate.smsMessageVariables.length > 0) {
                this.urgeHandleRule.smsMessageTemplate.smsMessageVariables = this.urgeHandleRule.smsMessageTemplate.smsMessageVariables.filter((/**
                 * @param {?} variable
                 * @return {?}
                 */
                function (variable) { return variable.code; }));
            }
        }
        else {
            this.urgeHandleRule.smsMessageTemplate = null;
        }
        if (this.validator()) {
            /** @type {?} */
            var object = { value: this.urgeHandleRule, parameters: null };
            this.submitModal.emit(object);
        }
    };
    /**
     * @return {?}
     */
    UrgeHandleRuleComponent.prototype.clickCancel = /**
     * @return {?}
     */
    function () {
        this.closeModal.emit();
    };
    /**
     * @private
     * @return {?}
     */
    UrgeHandleRuleComponent.prototype.validator = /**
     * @private
     * @return {?}
     */
    function () {
        if (!this.urgeHandleRule.sendType) {
            this.message.info(this.localePipe.transform("component.urgeHandleRule.noSendingMethod"));
            return false;
        }
        //去除消息模板编号校验
        // if (this.hasSmsTemplate) {
        //   if (!this.urgeHandleRule.smsMessageTemplate) {
        //     this.message.info(this.localePipe.transform("component.urgeHandleRule.setMessageTemplate"));
        //     return;
        //   }
        //   if (!this.urgeHandleRule.smsMessageTemplate.code) {
        //     this.message.info(this.localePipe.transform("component.urgeHandleRule.codeEmpty"));
        //     return;
        //   }
        // }
        if (!this.urgeHandleRule.urgeMessageSubject) {
            this.message.info(this.localePipe.transform("component.urgeHandleRule.noMessageSubject"));
            return false;
        }
        if (!this.urgeHandleRule.urgeMessageContent) {
            this.message.info(this.localePipe.transform("component.urgeHandleRule.noMessageContent"));
            return false;
        }
        if (!this.urgeHandleRule.earlyTime && this.urgeHandleRule.earlyTime !== 0) {
            this.message.info(this.localePipe.transform("component.urgeHandleRule.earliestTimeNotEmpty"));
            return false;
        }
        if (!this.urgeHandleRule.intervalTime && this.urgeHandleRule.intervalTime !== 0) {
            this.message.info(this.localePipe.transform("component.urgeHandleRule.minimumTimeNotEmpty"));
            return false;
        }
        return true;
    };
    /**
     * @param {?} sendType
     * @return {?}
     */
    UrgeHandleRuleComponent.prototype.sendTypeChange = /**
     * @param {?} sendType
     * @return {?}
     */
    function (sendType) {
        if (this.hasSmsMessage(sendType)) {
            this.hasSmsTemplate = true;
            if (!this.urgeHandleRule.smsMessageTemplate) {
                this.urgeHandleRule.smsMessageTemplate = new SmsMessageTemplate$1();
            }
        }
        else {
            this.hasSmsTemplate = false;
            this.urgeHandleRule.smsMessageTemplate = null;
        }
    };
    /**
     * @param {?} data
     * @return {?}
     */
    UrgeHandleRuleComponent.prototype.titleExpr = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        this.showTitleHelp(data);
    };
    /**
     * @param {?} data
     * @return {?}
     */
    UrgeHandleRuleComponent.prototype.contentExpr = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        this.showContentHelp(data);
    };
    /**
     * @param {?} data
     * @return {?}
     */
    UrgeHandleRuleComponent.prototype.showTitleHelp = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        var _this = this;
        /** @type {?} */
        var context = this.showExpr();
        if (this.urgeHandleRule.urgeMessageSubject && this.urgeHandleRule.urgeMessageSubject.length > 0) {
            this.expr.addExpressionText(this.urgeHandleRule.urgeMessageSubject);
        }
        else {
            this.expr.addExpressionText('');
        }
        this.expr.buildExpression().then((/**
         * @param {?} expressionInfo
         * @return {?}
         */
        function (expressionInfo) {
            _this.urgeHandleRule.urgeMessageSubject = expressionInfo;
            //点击确定后，去除表达式里面的新增的上下文变量
            if (context.length > 0) {
                _this.expr.exprEntity.contextEntities = _this.expr.exprEntity.contextEntities.filter((/**
                 * @param {?} x
                 * @return {?}
                 */
                function (x) { return !context.some((/**
                 * @param {?} y
                 * @return {?}
                 */
                function (y) { return y.key === x.key; })); }));
            }
        }));
    };
    /**
     * @param {?} data
     * @return {?}
     */
    UrgeHandleRuleComponent.prototype.showContentHelp = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        var _this = this;
        /** @type {?} */
        var context = this.showExpr();
        if (this.urgeHandleRule.urgeMessageContent && this.urgeHandleRule.urgeMessageContent.length > 0) {
            this.expr.addExpressionText(this.urgeHandleRule.urgeMessageContent);
        }
        else {
            this.expr.addExpressionText('');
        }
        this.expr.buildExpression().then((/**
         * @param {?} expressionInfo
         * @return {?}
         */
        function (expressionInfo) {
            _this.urgeHandleRule.urgeMessageContent = expressionInfo;
            //点击确定后，去除表达式里面的新增的上下文变量
            if (context.length > 0) {
                _this.expr.exprEntity.contextEntities = _this.expr.exprEntity.contextEntities.filter((/**
                 * @param {?} x
                 * @return {?}
                 */
                function (x) { return !context.some((/**
                 * @param {?} y
                 * @return {?}
                 */
                function (y) { return y.key === x.key; })); }));
            }
        }));
    };
    /**
     * @return {?}
     */
    UrgeHandleRuleComponent.prototype.showExpr = /**
     * @return {?}
     */
    function () {
        var e_1, _a, e_2, _b, e_3, _c, e_4, _d, e_5, _e;
        // this.expr.clearContext();
        if (this.designerUIState.schemas.length > 0) {
            try {
                for (var _f = __values(this.designerUIState.schemas), _g = _f.next(); !_g.done; _g = _f.next()) {
                    var schema = _g.value;
                    // this.expr.addCommonObject(co);
                    this.expr.addSchema('Schema', schema);
                }
            }
            catch (e_1_1) { e_1 = { error: e_1_1 }; }
            finally {
                try {
                    if (_g && !_g.done && (_a = _f.return)) _a.call(_f);
                }
                finally { if (e_1) throw e_1.error; }
            }
            if (this.designerUIState.schemas[0].entityTypes && this.designerUIState.schemas[0].entityTypes.length > 0) {
                /** @type {?} */
                var entityType = this.designerUIState.schemas[0].entityTypes[0];
                this.expr.addInjectedEntity(entityType.name, 'Schema', entityType.name, InjectedType.EntityType);
            }
        }
        /** @type {?} */
        var context = new Array();
        if (this.designerUIState.urgeContext.length > 0) {
            try {
                for (var _h = __values(this.designerUIState.urgeContext), _j = _h.next(); !_j.done; _j = _h.next()) {
                    var variable = _j.value;
                    context.push(variable);
                    // this.expr.addContext(variable);
                }
            }
            catch (e_2_1) { e_2 = { error: e_2_1 }; }
            finally {
                try {
                    if (_j && !_j.done && (_b = _h.return)) _b.call(_h);
                }
                finally { if (e_2) throw e_2.error; }
            }
        }
        if (this.designerUIState.processVariableContext.length > 0) {
            var _loop_1 = function (variable) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    context.push(variable);
                }
            };
            try {
                for (var _k = __values(this.designerUIState.processVariableContext), _l = _k.next(); !_l.done; _l = _k.next()) {
                    var variable = _l.value;
                    _loop_1(variable);
                }
            }
            catch (e_3_1) { e_3 = { error: e_3_1 }; }
            finally {
                try {
                    if (_l && !_l.done && (_c = _k.return)) _c.call(_k);
                }
                finally { if (e_3) throw e_3.error; }
            }
        }
        if (this.designerUIState.subActivityContext.length > 0) {
            var _loop_2 = function (variable) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    context.push(variable);
                }
            };
            try {
                for (var _m = __values(this.designerUIState.subActivityContext), _o = _m.next(); !_o.done; _o = _m.next()) {
                    var variable = _o.value;
                    _loop_2(variable);
                }
            }
            catch (e_4_1) { e_4 = { error: e_4_1 }; }
            finally {
                try {
                    if (_o && !_o.done && (_d = _m.return)) _d.call(_m);
                }
                finally { if (e_4) throw e_4.error; }
            }
        }
        if (context.length > 0) {
            try {
                for (var context_1 = __values(context), context_1_1 = context_1.next(); !context_1_1.done; context_1_1 = context_1.next()) {
                    var v = context_1_1.value;
                    this.expr.addContext(v);
                }
            }
            catch (e_5_1) { e_5 = { error: e_5_1 }; }
            finally {
                try {
                    if (context_1_1 && !context_1_1.done && (_e = context_1.return)) _e.call(context_1);
                }
                finally { if (e_5) throw e_5.error; }
            }
        }
        return context;
    };
    /**
     * @private
     * @param {?} sendType
     * @return {?}
     */
    UrgeHandleRuleComponent.prototype.hasSmsMessage = /**
     * @private
     * @param {?} sendType
     * @return {?}
     */
    function (sendType) {
        var _this = this;
        if (sendType) {
            /** @type {?} */
            var sendTypeList = sendType.split(',');
            /** @type {?} */
            var messageChannel = sendTypeList.find((/**
             * @param {?} val
             * @return {?}
             */
            function (val) { return _this.designerUIState.messageChannels.find((/**
             * @param {?} channel
             * @return {?}
             */
            function (channel) { return channel.code == val && channel.channelType == 'Sms'; })); }));
            if (messageChannel) {
                return true;
            }
            else {
                return false;
            }
        }
        else {
            return false;
        }
    };
    UrgeHandleRuleComponent.decorators = [
        { type: Component, args: [{
                    selector: 'lib-urge-handle-rule',
                    template: "<div class=\"f-page\">\r\n  <div class=\"f-utils-fill-flex-column farris-split-section m-2 h-100\">\r\n    <perfect-scrollbar [config]=\"{}\">\r\n      <form class=\"h-100\">\r\n        <div class=\"f-form-layout farris-form farris-form-controls-inline farris-form-auto\">\r\n          <fieldset class=\"f-section-formgroup\">\r\n            <div class=\"f-section-formgroup-inputs\">\r\n              <div class=\"col-12 mt-2\">\r\n                <div class=\"farris-group-wrap\">\r\n                  <div class=\"form-group farris-form-group\">\r\n                    <label class=\"col-form-label\">\r\n                      <span class=\"farris-label-info text-danger\">*</span>\r\n                      <span class=\"farris-label-text\">{{'component.urgeHandleRule.enableUrgeHandle' | wfLocale}}</span>\r\n                    </label>\r\n                    <div class=\"farris-input-wrap ml-1\">\r\n                      <farris-switch [(ngModel)]=\"urgeHandleRule.urgeHandleAble\" name=\"urgeHandleEnable\"></farris-switch>\r\n                      <div class=\"farris-feedback valid-feedback\"></div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <div class=\"col-10 mt-2\">\r\n                <div class=\"farris-group-wrap\">\r\n                  <div class=\"form-group farris-form-group\">\r\n                    <label class=\"col-form-label\">\r\n                      <span class=\"farris-label-info text-danger\">*</span>\r\n                      <span class=\"farris-label-text\">{{'component.urgeHandleRule.timeSetting' | wfLocale}}</span>\r\n                    </label>\r\n                    <label class=\"mb-0\">\r\n                      <span class=\"farris-label-text\">{{'component.urgeHandleRule.earliestTime' | wfLocale}}</span>\r\n                    </label>\r\n                    <div class=\"farris-input-wrap\" style=\"width: 300px;\">\r\n                      <farris-number-spinner [(ngModel)]=\"urgeHandleRule.earlyTime\" name=\"earlyTime\" [editable]=\"true\" [precision]=\"0\"\r\n                        [parser]=\"parser\" [min]=\"0\"></farris-number-spinner>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <div class=\"col-10\">\r\n                <div class=\"farris-group-wrap\">\r\n                  <div class=\"form-group farris-form-group\">\r\n                    <label class=\"col-form-label\">\r\n                      <span class=\"farris-label-text\"></span>\r\n                    </label>\r\n                    <label class=\"mb-0\">\r\n                      <span class=\"farris-label-text\">{{'component.urgeHandleRule.minimumInterval' | wfLocale}}</span>\r\n                    </label>\r\n                    <div class=\"farris-input-wrap\" style=\"width: 300px;\">\r\n                      <farris-number-spinner [(ngModel)]=\"urgeHandleRule.intervalTime\" name=\"intervalTime\" [editable]=\"true\" [precision]=\"0\"\r\n                        [parser]=\"parser\" [min]=\"0\"></farris-number-spinner>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <div class=\"col-12 mt-2\">\r\n                <div class=\"farris-group-wrap\">\r\n                  <div class=\"form-group farris-form-group\">\r\n                    <label class=\"col-form-label\">\r\n                      <span class=\"farris-label-info text-danger\">*</span>\r\n                      <span class=\"farris-label-text\">{{'component.urgeHandleRule.sendingMethod' | wfLocale}}</span>\r\n                    </label>\r\n                    <div class=\"farris-input-wrap\">\r\n                      <farris-checkboxgroup #checkboxGroup [(ngModel)]=\"urgeHandleRule.sendType\" name=\"sendType\" [horizontal]=\"true\"\r\n                        [data]=\"typeGroup\" (changeValue)=\"sendTypeChange($event)\">\r\n                      </farris-checkboxgroup>\r\n                      <div class=\"farris-feedback valid-feedback\"></div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <div class=\"col-12 mt-2\">\r\n                <div class=\"farris-group-wrap\">\r\n                  <div class=\"form-group farris-form-group\">\r\n                    <label class=\"col-form-label\">\r\n                      <span class=\"farris-label-info text-danger\">*</span>\r\n                      <span class=\"farris-label-text\">{{'component.urgeHandleRule.messageSubject' | wfLocale}}</span>\r\n                    </label>\r\n                    <div class=\"farris-input-wrap\" style=\"width: 300px;\">\r\n                      <input-group [editable]=\"false\" [customCls]=\"'custom-cls'\" [groupText]=\"groupIcon2\"\r\n                                    [(value)]=\"urgeHandleRule.urgeMessageSubject\" (clickHandle)=\"titleExpr($event)\">\r\n                      </input-group>\r\n                      <div class=\"farris-feedback valid-feedback\"></div>\r\n                    </div>\r\n                    <label class=\"col-form-label\">\r\n                      <span class=\"farris-label-text\">{{'component.urgeHandleRule.supportEditing' | wfLocale}}</span>\r\n                    </label>\r\n                    <!-- 2023-6-14 \u5728\u6D4B\u8BD5\u73AF\u5883\u4E2D\u51FA\u73B0\u6309\u94AE\u9760\u6700\u53F3\u7684\u60C5\u51B5\uFF0C\u5220\u9664style=\"text-align: right\"\u540E\u6B63\u5E38 -->\r\n                    <div class=\"farris-input-wrap\">\r\n                      <farris-switch [(ngModel)]=\"urgeHandleRule.subjectEditable\" name=\"enable1\" size=\"small\"></farris-switch>\r\n                      <div class=\"farris-feedback valid-feedback\"></div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <div class=\"col-12 mt-2\">\r\n                <div class=\"farris-group-wrap\">\r\n                  <div class=\"form-group farris-form-group\">\r\n                    <label class=\"col-form-label\">\r\n                      <span class=\"farris-label-info text-danger\">*</span>\r\n                      <span class=\"farris-label-text\">{{'component.urgeHandleRule.messageContent' | wfLocale}}</span>\r\n                    </label>\r\n                    <div class=\"farris-input-wrap\" style=\"width: 300px;\">\r\n                      <input-group [editable]=\"false\" [customCls]=\"'custom-cls'\" [groupText]=\"groupIcon2\"\r\n                                    [(value)]=\"urgeHandleRule.urgeMessageContent\" (clickHandle)=\"contentExpr($event)\">\r\n                      </input-group>\r\n                      <div class=\"farris-feedback valid-feedback\"></div>\r\n                    </div>\r\n                    <label class=\"col-form-label\">\r\n                      <span class=\"farris-label-text\">{{'component.urgeHandleRule.supportEditing' | wfLocale}}</span>\r\n                    </label>\r\n                    <div class=\"farris-input-wrap\">\r\n                      <farris-switch [(ngModel)]=\"urgeHandleRule.contentEditable\" name=\"enable2\" size=\"small\"></farris-switch>\r\n                      <div class=\"farris-feedback valid-feedback\"></div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <div class=\"col-12 mt-2\">\r\n                <div class=\"farris-group-wrap\">\r\n                  <div class=\"form-group farris-form-group\">\r\n                    <label class=\"col-form-label\">\r\n                      <span class=\"farris-label-text\">{{'component.urgeHandleRule.displayReminder' | wfLocale}}</span>\r\n                    </label>\r\n                    <div class=\"farris-input-wrap\">\r\n                      <farris-switch [(ngModel)]=\"urgeHandleRule.addReminder\" name=\"enable\" size=\"small\"></farris-switch>\r\n                      <div class=\"farris-feedback valid-feedback\"></div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </fieldset>\r\n        </div>\r\n        <lib-sms-message-template *ngIf=\"hasSmsTemplate\" [smsMessageTemplate]=\"urgeHandleRule.smsMessageTemplate\"></lib-sms-message-template>\r\n      </form>\r\n    </perfect-scrollbar>\r\n</div>\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type=\"button\" class=\"btn btn-secondary btn-sm px-3\" (click)=\"clickCancel()\">{{'component.urgeHandleRule.clickCancel' | wfLocale}}</button>\r\n  <button type=\"button\" class=\"btn btn-primary btn-sm px-3 mx-2\" (click)=\"clickOK()\">{{'component.urgeHandleRule.clickOK' | wfLocale}}</button>\r\n</ng-template>\r\n",
                    providers: [
                        WfLocalePipe,
                    ],
                    styles: [""]
                }] }
    ];
    /** @nocollapse */
    UrgeHandleRuleComponent.ctorParameters = function () { return [
        { type: ProcessDesignerUIState },
        { type: ExpressionService },
        { type: MessagerService },
        { type: ChangeDetectorRef, decorators: [{ type: Optional }] },
        { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
        { type: undefined, decorators: [{ type: Inject, args: [WF_LANG_RESOURCES,] }] },
        { type: WfLocalePipe, decorators: [{ type: Optional }] }
    ]; };
    UrgeHandleRuleComponent.propDecorators = {
        closeModal: [{ type: Output }],
        submitModal: [{ type: Output }],
        modalFooter: [{ type: ViewChild, args: ['iconSelectFooter',] }],
        SmsTemplate: [{ type: ViewChild, args: [SmsMessageTemplateComponent,] }],
        value: [{ type: Input }]
    };
    return UrgeHandleRuleComponent;
}());
var UrgeHandleRuleConverter = /** @class */ (function () {
    function UrgeHandleRuleConverter(localePipe) {
        this.localePipe = localePipe;
    }
    /**
     * @param {?} data
     * @return {?}
     */
    UrgeHandleRuleConverter.prototype.convertTo = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        if (!data) {
            return this.localePipe.transform("component.urgeHandleRule.set");
        }
        else if (data.urgeHandleAble) {
            return this.localePipe.transform("component.urgeHandleRule.set");
        }
        else {
            return this.localePipe.transform("component.urgeHandleRule.notSet");
        }
    };
    return UrgeHandleRuleConverter;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var CheckCondition$1 = /** @class */ (function () {
    function CheckCondition$$1(checkTime) {
        this.checkTime = checkTime;
    }
    return CheckCondition$$1;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var CheckConditionComponent = /** @class */ (function () {
    function CheckConditionComponent(injector, message, designerUIState, expr, http, cdr, localeId, resources, localePipe) {
        this.injector = injector;
        this.message = message;
        this.designerUIState = designerUIState;
        this.expr = expr;
        this.http = http;
        this.cdr = cdr;
        this.localeId = localeId;
        this.resources = resources;
        this.localePipe = localePipe;
        this.groupIcon = '<i class="f-icon f-icon-lookup"></i>';
        this.closeModal = new EventEmitter();
        this.submitModal = new EventEmitter();
        this.languages = [
            { code: 'zh-CHS', name: this.localePipe.transform('component.checkCondition.zhChs') },
            { code: 'zh-CHT', name: this.localePipe.transform('component.checkCondition.zhCht') },
            { code: 'en', name: this.localePipe.transform('component.checkCondition.en') }
        ];
        this.activityBeforeStarted = new CheckCondition$1('ACTIVITY_BEFORE_STARTED');
        this.activityBeforeCompleted = new CheckCondition$1('ACTIVITY_BEFORE_COMPLETED');
        this.modalConfig = {
            title: this.localePipe.transform('component.checkCondition.checkCondition'),
            width: 440,
            height: 460,
            showButtons: true
        };
        this.localePipe = this.localePipe || new WfLocalePipe(localeId, resources);
    }
    Object.defineProperty(CheckConditionComponent.prototype, "value", {
        set: /**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            if (data && data.length > 0) {
                console.log(data);
                this.activityBeforeStarted = data.find((/**
                 * @param {?} d
                 * @return {?}
                 */
                function (d) { return d.checkTime === 'ACTIVITY_BEFORE_STARTED'; })) || new CheckCondition$1('ACTIVITY_BEFORE_STARTED');
                this.activityBeforeCompleted = data.find((/**
                 * @param {?} d
                 * @return {?}
                 */
                function (d) { return d.checkTime === 'ACTIVITY_BEFORE_COMPLETED'; })) || new CheckCondition$1('ACTIVITY_BEFORE_COMPLETED');
            }
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    CheckConditionComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
    };
    /**
     * @param {?} checkTime
     * @return {?}
     */
    CheckConditionComponent.prototype.editCondition = /**
     * @param {?} checkTime
     * @return {?}
     */
    function (checkTime) {
        var _this = this;
        var e_1, _a, e_2, _b, e_3, _c, e_4, _d;
        /** @type {?} */
        var context = new Array();
        // if(this.expr.exprEntity.contextEntities.find(x => x.key === 'CurrentLanguage')) {
        //   context.push(this.expr.exprEntity.contextEntities.find(x => x.key === 'CurrentLanguage'));
        // }
        // this.expr.clearContext();
        if (this.designerUIState.schemas.length > 0) {
            try {
                for (var _e = __values(this.designerUIState.schemas), _f = _e.next(); !_f.done; _f = _e.next()) {
                    var schema = _f.value;
                    this.expr.addSchema('Schema', schema);
                }
            }
            catch (e_1_1) { e_1 = { error: e_1_1 }; }
            finally {
                try {
                    if (_f && !_f.done && (_a = _e.return)) _a.call(_e);
                }
                finally { if (e_1) throw e_1.error; }
            }
            if (this.designerUIState.schemas[0].entityTypes && this.designerUIState.schemas[0].entityTypes.length > 0) {
                /** @type {?} */
                var entityType = this.designerUIState.schemas[0].entityTypes[0];
                this.expr.addInjectedEntity(entityType.name, 'Schema', entityType.name, InjectedType.EntityType);
            }
        }
        context = this.designerUIState.addContext(context);
        if (this.designerUIState.subActivityContext.length > 0) {
            var _loop_1 = function (variable) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    context.push(variable);
                }
            };
            try {
                for (var _g = __values(this.designerUIState.subActivityContext), _h = _g.next(); !_h.done; _h = _g.next()) {
                    var variable = _h.value;
                    _loop_1(variable);
                }
            }
            catch (e_2_1) { e_2 = { error: e_2_1 }; }
            finally {
                try {
                    if (_h && !_h.done && (_b = _g.return)) _b.call(_g);
                }
                finally { if (e_2) throw e_2.error; }
            }
        }
        if (this.designerUIState.activityComponentContext.length > 0) {
            var _loop_2 = function (variable) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    context.push(variable);
                }
            };
            try {
                for (var _j = __values(this.designerUIState.activityComponentContext), _k = _j.next(); !_k.done; _k = _j.next()) {
                    var variable = _k.value;
                    _loop_2(variable);
                }
            }
            catch (e_3_1) { e_3 = { error: e_3_1 }; }
            finally {
                try {
                    if (_k && !_k.done && (_c = _j.return)) _c.call(_j);
                }
                finally { if (e_3) throw e_3.error; }
            }
        }
        if (context.length > 0) {
            try {
                for (var context_1 = __values(context), context_1_1 = context_1.next(); !context_1_1.done; context_1_1 = context_1.next()) {
                    var v = context_1_1.value;
                    this.expr.addContext(v);
                }
            }
            catch (e_4_1) { e_4 = { error: e_4_1 }; }
            finally {
                try {
                    if (context_1_1 && !context_1_1.done && (_d = context_1.return)) _d.call(context_1);
                }
                finally { if (e_4) throw e_4.error; }
            }
        }
        /** @type {?} */
        var text = checkTime === 'ACTIVITY_BEFORE_STARTED' ? this.activityBeforeStarted.value : this.activityBeforeCompleted.value;
        this.expr.addExpressionText(text);
        this.expr.setEditPattern(ExprEditMode.Conditional); // 默认打开简易表达式编辑器
        this.expr.buildExpression().then((/**
         * @param {?} cond
         * @return {?}
         */
        function (cond) {
            if (checkTime === 'ACTIVITY_BEFORE_STARTED') {
                _this.activityBeforeStarted.value = cond;
            }
            else {
                _this.activityBeforeCompleted.value = cond;
            }
            //点击确定后，去除表达式里面的新增的上下文变量
            if (context.length > 0) {
                _this.expr.exprEntity.contextEntities = _this.expr.exprEntity.contextEntities.filter((/**
                 * @param {?} x
                 * @return {?}
                 */
                function (x) { return !context.some((/**
                 * @param {?} y
                 * @return {?}
                 */
                function (y) { return y.key === x.key; })); }));
            }
        }));
    };
    /**
     * @param {?} checkTime
     * @return {?}
     */
    CheckConditionComponent.prototype.clearCondition = /**
     * @param {?} checkTime
     * @return {?}
     */
    function (checkTime) {
        if (checkTime === 'ACTIVITY_BEFORE_STARTED') {
            this.activityBeforeStarted.value = null;
        }
        else {
            this.activityBeforeCompleted.value = null;
        }
    };
    /**
     * @return {?}
     */
    CheckConditionComponent.prototype.clickOK = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var checkConditions = new Array();
        if (this.activityBeforeStarted.value || this.activityBeforeStarted.errorTips) {
            checkConditions.push(this.activityBeforeStarted);
        }
        if (this.activityBeforeCompleted.value || this.activityBeforeCompleted.errorTips) {
            checkConditions.push(this.activityBeforeCompleted);
        }
        /** @type {?} */
        var object = { value: checkConditions, parameters: null };
        this.submitModal.emit(object);
    };
    /**
     * @return {?}
     */
    CheckConditionComponent.prototype.clickCancel = /**
     * @return {?}
     */
    function () {
        this.closeModal.emit();
    };
    /**
     * @return {?}
     */
    CheckConditionComponent.prototype.validator = /**
     * @return {?}
     */
    function () {
    };
    CheckConditionComponent.decorators = [
        { type: Component, args: [{
                    selector: 'lib-check-condition',
                    template: "<div class=\"f-page\">\r\n  <section class=\"f-page-main d-flex flex-column\">\r\n    <farris-section class=\"pt-0 f-section-form f-section-in-mainsubcard\" mainTitle=\"{{'component.checkCondition.nodeEntry'|wfLocale}}\" [enableAccordion]=\"'default'\"\r\n      [enableMaximize]=\"false\">\r\n      <div class=\"f-form-layout farris-form mx-3\">\r\n        <fieldset class=\"f-section-formgroup\">\r\n          <div class=\"f-section-formgroup-inputs\">\r\n            <div class=\"col-12\">\r\n              <div class=\"farris-group-wrap\">\r\n                <div class=\"form-group farris-form-group\">\r\n                  <label class=\"col-form-label\">\r\n                    <span class=\"farris-label-text\">{{'component.checkCondition.activityBeforeStarted' | wfLocale}}</span>\r\n                  </label>\r\n                  <div class=\"farris-input-wrap\">\r\n                    <input-group [editable]=\"false\" [(ngModel)]=\"activityBeforeStarted.value\" name= \"activityBeforeStarted\" (clickHandle)=\"editCondition('ACTIVITY_BEFORE_STARTED')\" [groupText]=\"groupIcon\" (clear)=\"clearCondition('ACTIVITY_BEFORE_STARTED')\"></input-group>\r\n                    <div class=\"farris-feedback valid-feedback\"></div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div class=\"col-12\">\r\n              <div class=\"farris-group-wrap\">\r\n                <div class=\"form-group farris-form-group\">\r\n                  <label class=\"col-form-label\">\r\n                    <span class=\"farris-label-info text-danger\"></span>\r\n                    <span class=\"farris-label-text\">{{'component.checkCondition.enterErrorTips' | wfLocale}}</span>\r\n                  </label>\r\n                  <div class=\"farris-input-wrap\">\r\n                    <language-textbox [languages]=\"languages\" [(ngModel)]=\"activityBeforeStarted.errorTips\" name=\"activityBeforeStartedErrorTips\"></language-textbox>\r\n                    <div class=\"farris-feedback valid-feedback\"></div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </fieldset>\r\n      </div>\r\n    </farris-section>\r\n    <farris-section class=\"pt-0 f-section-form f-section-in-mainsubcard\" mainTitle=\"{{'component.checkCondition.activityBeforeCompleted'|wfLocale}}\" [enableAccordion]=\"'default'\"\r\n      [enableMaximize]=\"false\" [fill]=\"true\">\r\n      <div class=\"f-form-layout farris-form mx-3\">\r\n        <fieldset class=\"f-section-formgroup\">\r\n          <div class=\"f-section-formgroup-inputs\">\r\n            <div class=\"col-12\">\r\n              <div class=\"farris-group-wrap\">\r\n                <div class=\"form-group farris-form-group\">\r\n                  <label class=\"col-form-label\">\r\n                    <span class=\"farris-label-text\">{{'component.checkCondition.activityBeforeCompletedValue' | wfLocale}}</span>\r\n                  </label>\r\n                  <div class=\"farris-input-wrap\">\r\n                    <input-group [editable]=\"false\" [(ngModel)]=\"activityBeforeCompleted.value\" name= \"activityBeforeCompleted\" (clickHandle)=\"editCondition('ACTIVITY_BEFORE_COMPLETED')\" [groupText]=\"groupIcon\" (clear)=\"clearCondition('ACTIVITY_BEFORE_COMPLETED')\"></input-group>\r\n                    <div class=\"farris-feedback valid-feedback\"></div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div class=\"col-12\">\r\n              <div class=\"farris-group-wrap\">\r\n                <div class=\"form-group farris-form-group\">\r\n                  <label class=\"col-form-label\">\r\n                    <span class=\"farris-label-info text-danger\"></span>\r\n                    <span class=\"farris-label-text\">{{'component.checkCondition.leaveErrorTips' | wfLocale}}</span>\r\n                  </label>\r\n                  <div class=\"farris-input-wrap\">\r\n                    <language-textbox [languages]=\"languages\" [(ngModel)]=\"activityBeforeCompleted.errorTips\" name=\"activityBeforeCompletedErrorTips\"></language-textbox>\r\n                    <div class=\"farris-feedback valid-feedback\"></div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </fieldset>\r\n      </div>\r\n    </farris-section>\r\n  </section>\r\n</div>\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type=\"button\" class=\"btn btn-secondary btn-sm mx-2\" (click)=\"clickCancel()\">{{'component.checkCondition.clickCancel' | wfLocale}}</button>\r\n  <button type=\"button\" class=\"btn btn-primary btn-sm mx-2\" (click)=\"clickOK()\">{{'component.checkCondition.clickOK' | wfLocale}}</button>\r\n</ng-template>\r\n",
                    providers: [
                        WfLocalePipe,
                    ],
                    styles: [""]
                }] }
    ];
    /** @nocollapse */
    CheckConditionComponent.ctorParameters = function () { return [
        { type: Injector },
        { type: MessagerService },
        { type: ProcessDesignerUIState },
        { type: ExpressionService },
        { type: HttpService },
        { type: ChangeDetectorRef, decorators: [{ type: Optional }] },
        { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
        { type: undefined, decorators: [{ type: Inject, args: [WF_LANG_RESOURCES,] }] },
        { type: WfLocalePipe, decorators: [{ type: Optional }] }
    ]; };
    CheckConditionComponent.propDecorators = {
        closeModal: [{ type: Output }],
        submitModal: [{ type: Output }],
        value: [{ type: Input }],
        modalFooter: [{ type: ViewChild, args: ['iconSelectFooter',] }]
    };
    return CheckConditionComponent;
}());
var CheckConditionConverter = /** @class */ (function () {
    function CheckConditionConverter(localePipe) {
        this.localePipe = localePipe;
    }
    /**
     * @param {?} data
     * @return {?}
     */
    CheckConditionConverter.prototype.convertTo = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        if (data && data.length > 0) {
            return this.localePipe.transform("component.checkCondition.set");
        }
        return this.localePipe.transform("component.checkCondition.notSet");
    };
    return CheckConditionConverter;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var AssignStrategyComponent = /** @class */ (function () {
    function AssignStrategyComponent(injector, message, designerUIState, http, cdr, localeId, resources, localePipe) {
        this.injector = injector;
        this.message = message;
        this.designerUIState = designerUIState;
        this.http = http;
        this.cdr = cdr;
        this.localeId = localeId;
        this.resources = resources;
        this.localePipe = localePipe;
        this.closeModal = new EventEmitter();
        this.submitModal = new EventEmitter();
        this.assingPerformerConfigForm = new FormGroup({
            multiSelect: new FormControl(true),
            necessary: new FormControl(false)
        });
        this.assignStrategy = new AssignStrategy();
        this.assignStrategyList = [
            { value: 'ALL', name: this.localePipe.transform('component.assignStrategy.all') },
            { value: 'ASSIGN', name: this.localePipe.transform('component.assignStrategy.assign') },
            { value: 'CLAIM', name: this.localePipe.transform('component.assignStrategy.claim') }
        ];
        this.operatorCollection = [
            { text: this.localePipe.transform('component.assignStrategy.currentUser'), value: 'currentUser' },
            { text: this.localePipe.transform('component.assignStrategy.procInstCreator'), value: 'procInstCreator' }
        ];
        this.modalConfig = {
            title: this.localePipe.transform('component.assignStrategy.assignStrategy'),
            width: 405,
            height: 350,
            showButtons: true
        };
        this.localePipe = this.localePipe || new WfLocalePipe(localeId, resources);
    }
    Object.defineProperty(AssignStrategyComponent.prototype, "value", {
        set: /**
         * @param {?} assignStrategy
         * @return {?}
         */
        function (assignStrategy) {
            this.assignStrategy = assignStrategy || new AssignStrategy();
            if (!this.assignStrategy.assignConfig) {
                this.assignStrategy.assignConfig = new AssignConfig();
            }
            this.assingPerformerConfigForm.setValue({
                multiSelect: this.assignStrategy.assignConfig.multiSelect,
                necessary: this.assignStrategy.assignConfig.necessary
            });
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    AssignStrategyComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
    };
    /**
     * @param {?} event
     * @return {?}
     */
    AssignStrategyComponent.prototype.changeValue = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        if (event === 'ASSIGN') {
            if (!this.assignStrategy.assignConfig) {
                this.assignStrategy.assignConfig = new AssignConfig();
            }
            this.assingPerformerConfigForm.setValue({
                multiSelect: this.assignStrategy.assignConfig.multiSelect,
                necessary: this.assignStrategy.assignConfig.necessary
            });
        }
    };
    /**
     * @return {?}
     */
    AssignStrategyComponent.prototype.clickOK = /**
     * @return {?}
     */
    function () {
        this.assignStrategy.assignConfig.multiSelect = this.assingPerformerConfigForm.get('multiSelect').value;
        this.assignStrategy.assignConfig.necessary = this.assingPerformerConfigForm.get('necessary').value;
        console.log(this.assignStrategy);
        /** @type {?} */
        var object = { value: this.assignStrategy, parameters: null };
        this.submitModal.emit(object);
    };
    /**
     * @return {?}
     */
    AssignStrategyComponent.prototype.clickCancel = /**
     * @return {?}
     */
    function () {
        this.closeModal.emit();
    };
    AssignStrategyComponent.decorators = [
        { type: Component, args: [{
                    selector: 'lib-assign-strategy',
                    template: "<div class=\"f-page\">\r\n  <section class=\"f-page-main d-flex flex-column\">\r\n    <farris-section class=\"pt-0 f-section-form f-section-in-mainsubcard\" mainTitle=\"{{'component.assignStrategy.option' | wfLocale}}\" [enableAccordion]=\"''\"\r\n      [enableMaximize]=\"false\">\r\n      <div class=\"f-form-layout farris-form farris-form-controls-inline\">\r\n        <fieldset class=\"f-section-formgroup\">\r\n          <div class=\"f-section-formgroup-inputs\">\r\n            <div class=\"col-12\">\r\n              <div class=\"farris-group-wrap ml-2 pl-4\">\r\n                <div class=\"form-group\">\r\n                  <div class=\"farris-input-wrap\">\r\n                    <farris-radiogroup [(ngModel)]=\"assignStrategy.assignStrategy\" [data]=\"assignStrategyList\" name=\"assignStrategy\"\r\n                      [horizontal]=\"true\">\r\n                    </farris-radiogroup>\r\n                    <div class=\"farris-feedback valid-feedback\"></div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </fieldset>\r\n      </div>\r\n    </farris-section>\r\n    <farris-section *ngIf=\"assignStrategy.assignStrategy==='ASSIGN'\" class=\"pt-0 f-section-form f-section-in-mainsubcard\" mainTitle=\"{{'component.assignStrategy.assignmentRules' | wfLocale}}\" [enableAccordion]=\"''\"\r\n      [enableMaximize]=\"false\">\r\n      <form class=\"h-100\" [formGroup]=\"assingPerformerConfigForm\">\r\n        <div class=\"f-form-layout farris-form farris-form-controls-inline\">\r\n          <fieldset class=\"f-section-formgroup\">\r\n            <div class=\"f-section-formgroup-inputs\">\r\n              <div class=\"col-12\">\r\n                <div class=\"farris-group-wrap\">\r\n                  <div class=\"form-group\">\r\n                    <label class=\"col-form-label\">\r\n                      <span class=\"farris-label-text\">{{'component.assignStrategy.operator' | wfLocale}}</span>\r\n                    </label>\r\n                    <div class=\"farris-input-wrap\" style=\"width: 300px;\">\r\n                      <farris-combo-list [(ngModel)]=\"assignStrategy.assignConfig.operator\" name=\"operator\" [ngModelOptions]=\"{standalone: true}\"\r\n                        [idField]=\"'value'\" [textField]=\"'text'\" [valueField]=\"'value'\" [data]=\"operatorCollection\"\r\n                        [panelHeight]=\"60\">\r\n                      </farris-combo-list>\r\n                      <div class=\"farris-feedback valid-feedback\"></div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <div class=\"col-12 mt-2\">\r\n                <div class=\"farris-group-wrap ml-2 pl-4\">\r\n                  <div class=\"form-group farris-form-group\">\r\n                    <div class=\"farris-input-wrap\">\r\n                      <div class=\"custom-control custom-checkbox\">\r\n                        <input class=\"custom-control-input\" type=\"checkbox\" id=\"multiSelect\" formControlName=\"multiSelect\"\r\n                          [readOnly]=\"false\" />\r\n                        <label class=\"custom-control-label\" for=\"multiSelect\">{{'component.assignStrategy.multiSelect' | wfLocale}}</label>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <div class=\"col-12 mt-2\">\r\n                <div class=\"farris-group-wrap ml-2 pl-4\">\r\n                  <div class=\"form-group farris-form-group\">\r\n                    <div class=\"farris-input-wrap\">\r\n                      <div class=\"custom-control custom-checkbox\">\r\n                        <input class=\"custom-control-input\" type=\"checkbox\" id=\"necessary\" formControlName=\"necessary\" [readOnly]=\"false\" />\r\n                        <label class=\"custom-control-label\" for=\"necessary\">{{'component.assignStrategy.necessary' | wfLocale}}</label>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </fieldset>\r\n        </div>\r\n      </form>\r\n    </farris-section>\r\n  </section>\r\n</div>\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type=\"button\" class=\"btn btn-secondary btn-sm px-3 mx-2\" (click)=\"clickCancel()\">{{'component.assignStrategy.clickCancel' | wfLocale}}</button>\r\n  <button type=\"button\" class=\"btn btn-primary btn-sm px-3 mx-2\" (click)=\"clickOK()\">{{'component.assignStrategy.clickOK' | wfLocale}}</button>\r\n</ng-template>\r\n\r\n",
                    providers: [
                        WfLocalePipe,
                    ],
                    styles: [""]
                }] }
    ];
    /** @nocollapse */
    AssignStrategyComponent.ctorParameters = function () { return [
        { type: Injector },
        { type: MessagerService },
        { type: ProcessDesignerUIState },
        { type: HttpService },
        { type: ChangeDetectorRef, decorators: [{ type: Optional }] },
        { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
        { type: undefined, decorators: [{ type: Inject, args: [WF_LANG_RESOURCES,] }] },
        { type: WfLocalePipe, decorators: [{ type: Optional }] }
    ]; };
    AssignStrategyComponent.propDecorators = {
        closeModal: [{ type: Output }],
        submitModal: [{ type: Output }],
        value: [{ type: Input }],
        modalFooter: [{ type: ViewChild, args: ['iconSelectFooter',] }]
    };
    return AssignStrategyComponent;
}());
var AssignStrategyConverter = /** @class */ (function () {
    function AssignStrategyConverter(localePipe) {
        this.localePipe = localePipe;
    }
    /**
     * @param {?} data
     * @return {?}
     */
    AssignStrategyConverter.prototype.convertTo = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        switch (data.assignStrategy) {
            case 'ALL':
                return this.localePipe.transform('component.assignStrategy.all');
            case 'ASSIGN':
                return this.localePipe.transform('component.assignStrategy.assign');
            case 'CLAIM':
                return this.localePipe.transform('component.assignStrategy.claim');
            default:
                return '';
        }
    };
    return AssignStrategyConverter;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var AssignConfig$1 = /** @class */ (function () {
    function AssignConfig() {
        this.operator = 'currentUser';
        this.multiSelect = true;
        this.necessary = false;
    }
    return AssignConfig;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var ParticipantComponent = /** @class */ (function () {
    function ParticipantComponent(designerUIState, uistate, resolver, injector, modalService, message, expr, http, cdr, localeId, resources, localePipe) {
        var _this = this;
        this.designerUIState = designerUIState;
        this.uistate = uistate;
        this.resolver = resolver;
        this.injector = injector;
        this.modalService = modalService;
        this.message = message;
        this.expr = expr;
        this.http = http;
        this.cdr = cdr;
        this.localeId = localeId;
        this.resources = resources;
        this.localePipe = localePipe;
        this.closeModal = new EventEmitter();
        this.submitModal = new EventEmitter();
        this.editorParams = {};
        this.nodeType = 'notifyActivity';
        this.isClose = true;
        this.participant = new ParticipantInfo();
        this.editState = 'new'; // 编辑状态，用于区分是新增还是编辑  new | edit
        // 编辑状态，用于区分是新增还是编辑  new | edit
        this.type = 'humanPerformer';
        this.assignStrategyList = [
            { value: 'ALL', name: this.localePipe.transform('component.participant.all') },
            { value: 'ASSIGN', name: this.localePipe.transform('component.participant.assign') },
            { value: 'CLAIM', name: this.localePipe.transform('component.participant.claim') }
        ];
        this.operatorCollection = [
            { text: this.localePipe.transform('component.participant.currentUser'), value: 'currentUser' },
            { text: this.localePipe.transform('component.participant.procInstCreator'), value: 'procInstCreator' }
        ];
        this.modalConfig = {
            title: this.localePipe.transform('component.participant.participantSet'),
            width: 900,
            height: 662,
            showButtons: true
        };
        this.columns = [
            {
                field: 'order', width: 25, title: this.localePipe.transform('component.participant.order'),
                editor: {
                    type: EditorTypes.NUMBERBOX, options: {}
                },
            }, {
                field: 'type', width: 50, title: this.localePipe.transform('component.participant.type'),
                formatter: {
                    type: 'enum',
                    options: { valueField: 'value', textField: 'text', data: this.uistate.typeCollection }
                }
            }, {
                field: 'performerName', width: 50, title: this.localePipe.transform('component.participant.performerName'), showTips: true, formatter: (/**
                 * @param {?} v
                 * @param {?} d
                 * @param {?} i
                 * @return {?}
                 */
                function (v, d, i) {
                    switch (d.type) {
                        case 'wf.UserParticipantExpression':
                            return d.performerName;
                        case 'wf.VariableParticipantExpression':
                            return ((/** @type {?} */ (d))).name;
                        case 'wf.PositionParticipantExpression':
                            return ((/** @type {?} */ (d))).performerName;
                        case 'wf.ComponentParticipantExpression':
                            return ((/** @type {?} */ (d))).name;
                        case 'wf.ReportingLineParticipantExpression':
                            return ((/** @type {?} */ (d))).reportingLineDefName + '-' + ((/** @type {?} */ (d))).dimension;
                        case 'wf.MatrixParticipantExpression':
                            return ((/** @type {?} */ (d))).matrixDefName + '-' + ((/** @type {?} */ (d))).dataFieldAlias;
                        case 'wf.ActivityExecutorParticipantExpression':
                            return ((/** @type {?} */ (d))).performerName;
                        case 'wf.OrganizationParticipantExpression':
                            return ((/** @type {?} */ (d))).organizationName;
                        default:
                            return '';
                    }
                })
            },
            {
                field: 'description', width: 100, title: this.localePipe.transform('component.participant.description'), showTips: true,
                formatter: (/**
                 * @param {?} v
                 * @param {?} d
                 * @param {?} i
                 * @return {?}
                 */
                function (v, d, i) {
                    switch (d.type) {
                        case 'wf.UserParticipantExpression':
                            return _this.getUserPerformerDescription(d);
                        case 'wf.VariableParticipantExpression':
                            return _this.getVariablePerformerDescription(d);
                        case 'wf.PositionParticipantExpression':
                            return _this.getPositionPerformerDescription(d);
                        case 'wf.ComponentParticipantExpression':
                            return _this.getComponentPerformerDescription(d);
                        case 'wf.ReportingLineParticipantExpression':
                            return _this.getReportingLinePerformerDescription(d);
                        case 'wf.MatrixParticipantExpression':
                            return _this.getMatrixPerformerDescription(d);
                        case 'wf.ActivityExecutorParticipantExpression':
                            return ((/** @type {?} */ (d))).performerName;
                        case 'wf.OrganizationParticipantExpression':
                            return ((/** @type {?} */ (d))).organizationName + '，且' + (((/** @type {?} */ (d))).includeChildren ? '包含下级' : '不包含下级');
                        default:
                            return '';
                    }
                })
            },
            {
                field: 'condition', width: 60, title: this.localePipe.transform('component.participant.condition'), showTips: true,
                editor: {
                    type: 'input-group',
                    options: {
                        groupText: '<i class="f-icon f-icon-lookup"></i>',
                        editable: false,
                        clickHandle: (/**
                         * @param {?} e
                         * @return {?}
                         */
                        function (e) {
                            e.formControl.setValue(e.instance.value ? e.instance.value : '');
                            _this.editConditon(e);
                        }),
                    }
                }
            }
        ];
        this.localePipe = this.localePipe || new WfLocalePipe(localeId, resources);
        this.GetOrganizationType();
    }
    Object.defineProperty(ParticipantComponent.prototype, "value", {
        set: /**
         * @param {?} participant
         * @return {?}
         */
        function (participant) {
            var e_1, _a, e_2, _b;
            this.participant = JSON.parse(JSON.stringify(participant));
            if (!this.participant.assignStrategy.assignConfig) {
                this.participant.assignStrategy.assignConfig = new AssignConfig$1();
            }
            this.preAssignStrategy = participant.assignStrategy.assignStrategy;
            if (this.participant.humanPerformerList
                && this.participant.humanPerformerList.length > 0) {
                if (Math.max.apply(Math, __spread(this.participant.humanPerformerList.map((/**
                 * @param {?} p
                 * @return {?}
                 */
                function (p) { return p.order; })))) === 0) {
                    /** @type {?} */
                    var index = 1;
                    try {
                        for (var _c = __values(this.participant.humanPerformerList), _d = _c.next(); !_d.done; _d = _c.next()) {
                            var humanPerformer = _d.value;
                            humanPerformer.order = index;
                            index++;
                        }
                    }
                    catch (e_1_1) { e_1 = { error: e_1_1 }; }
                    finally {
                        try {
                            if (_d && !_d.done && (_a = _c.return)) _a.call(_c);
                        }
                        finally { if (e_1) throw e_1.error; }
                    }
                }
                this.participant.humanPerformerList = this.participant.humanPerformerList.sort((/**
                 * @param {?} a
                 * @param {?} b
                 * @return {?}
                 */
                function (a, b) { return a.order - b.order; }));
            }
            if (this.participant.potentialOwnerList
                && this.participant.potentialOwnerList.length > 0) {
                if (Math.max.apply(Math, __spread(this.participant.potentialOwnerList.map((/**
                 * @param {?} p
                 * @return {?}
                 */
                function (p) { return p.order; })))) === 0) {
                    /** @type {?} */
                    var index = 1;
                    try {
                        for (var _e = __values(this.participant.potentialOwnerList), _f = _e.next(); !_f.done; _f = _e.next()) {
                            var potentialOwner = _f.value;
                            potentialOwner.order = index;
                            index++;
                        }
                    }
                    catch (e_2_1) { e_2 = { error: e_2_1 }; }
                    finally {
                        try {
                            if (_f && !_f.done && (_b = _e.return)) _b.call(_e);
                        }
                        finally { if (e_2) throw e_2.error; }
                    }
                }
                this.participant.potentialOwnerList = this.participant.potentialOwnerList.sort((/**
                 * @param {?} a
                 * @param {?} b
                 * @return {?}
                 */
                function (a, b) { return a.order - b.order; }));
            }
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    ParticipantComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        this.nodeType = this.editorParams.nodeType;
    };
    /**
     * @return {?}
     */
    ParticipantComponent.prototype.clickOK = /**
     * @return {?}
     */
    function () {
        this.humanPerformerGrid.endCellEdit();
        if (this.potentialOwnerGrid) {
            this.potentialOwnerGrid.endCellEdit();
        }
        /** @type {?} */
        var object = {
            value: this.participant, parameters: null
        };
        this.submitModal.emit(object);
    };
    /**
     * @return {?}
     */
    ParticipantComponent.prototype.clickCancel = /**
     * @return {?}
     */
    function () {
        this.closeModal.emit();
    };
    /**
     * @param {?} data
     * @return {?}
     */
    ParticipantComponent.prototype.assignStrategyChange = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        var _this = this;
        if (this.preAssignStrategy !== 'ASSIGN' && data === 'ASSIGN' && this.participant.humanPerformerList.length > 0) {
            if (!this.participant.assignStrategy.assignConfig) {
                this.participant.assignStrategy.assignConfig = new AssignConfig$1();
            }
            this.message.question(this.localePipe.transform('component.participant.dataMovement1'), (/**
             * @return {?}
             */
            function () {
                _this.humanPerformerCopyToPotentialOwner();
            }));
        }
        else if (this.preAssignStrategy === 'ASSIGN' && data !== 'ASSIGN' && this.participant.potentialOwnerList.length > 0) {
            this.message.question(this.localePipe.transform('component.participant.dataMovement2'), (/**
             * @return {?}
             */
            function () {
                _this.potentialOwnerCopyToHumanPerformer();
            }));
        }
        this.preAssignStrategy = data;
    };
    /**
     * @param {?} data
     * @return {?}
     */
    ParticipantComponent.prototype.switchChange = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        if (data) {
            this.clearPerformer('potentialOwner');
        }
    };
    /**
     * @param {?} performerType
     * @param {?} type
     * @return {?}
     */
    ParticipantComponent.prototype.addPerformer = /**
     * @param {?} performerType
     * @param {?} type
     * @return {?}
     */
    function (performerType, type) {
        this.editState = 'new';
        this.type = type;
        /** @type {?} */
        var compFactory = this.resolver.resolveComponentFactory(PerformerEditComponent);
        this.compRef = compFactory.create(this.injector);
        this.compRef.instance.performerType = performerType;
        /** @type {?} */
        var boxsize = this.attributeBoxSize(performerType);
        /** @type {?} */
        var modalConfig = {
            title: this.localePipe.transform('component.participant.participantSelection'),
            width: boxsize.width,
            height: boxsize.height,
            buttons: this.editFooter,
            showButtons: true
        };
        this.editDialog = this.modalService.show(this.compRef, modalConfig);
        this.dropDownEl.close();
        if (this.dropDownE2) {
            this.dropDownE2.close();
        }
    };
    /**
     * @return {?}
     */
    ParticipantComponent.prototype.editOK = /**
     * @return {?}
     */
    function () {
        var e_3, _a, e_4, _b;
        this.isClose = true;
        if (this.compRef) {
            /** @type {?} */
            var re = this.compRef.instance.getPerformers();
            if (re.userPerformers && re.userPerformers.length > 0) {
                try {
                    for (var _c = __values(re.userPerformers), _d = _c.next(); !_d.done; _d = _c.next()) {
                        var p = _d.value;
                        this.addUserPerformer(p);
                    }
                }
                catch (e_3_1) { e_3 = { error: e_3_1 }; }
                finally {
                    try {
                        if (_d && !_d.done && (_a = _c.return)) _a.call(_c);
                    }
                    finally { if (e_3) throw e_3.error; }
                }
            }
            if (re.variable && re.variable !== null && re.variable.performerId) {
                this.addvariablePerformer(re.variable);
            }
            // 2023-7-28 组织岗支持多选
            if (re.positions && re.positions.length > 0) {
                this.addPositionPerformer(re.positions);
            }
            if (re.component && re.component.metadataId && re.component.methodCode) {
                this.addComponentPerformer(re.component);
            }
            if (re.reportingLine && re.reportingLine.reportingLineDefId && re.reportingLine.dimension) {
                this.addReportingLinePerformer(re.reportingLine);
            }
            if (re.matrix && re.matrix.matrixDefId) {
                this.addMatrixPerformer(re.matrix);
            }
            if (re.activityExecutorPerformers && re.activityExecutorPerformers.length > 0) {
                try {
                    for (var _e = __values(re.activityExecutorPerformers), _f = _e.next(); !_f.done; _f = _e.next()) {
                        var a = _f.value;
                        this.addActivityExecutorPerformer(a);
                    }
                }
                catch (e_4_1) { e_4 = { error: e_4_1 }; }
                finally {
                    try {
                        if (_f && !_f.done && (_b = _e.return)) _b.call(_e);
                    }
                    finally { if (e_4) throw e_4.error; }
                }
            }
            if (re.organizationParticipant) {
                this.addOrganizationParticipant(re.organizationParticipant);
            }
        }
        if (this.editDialog && this.isClose) {
            this.editDialog.close();
        }
        // 编辑完成后刷新两个组件
        this.humanPerformerGrid.refresh();
        this.potentialOwnerGrid.refresh();
    };
    /**
     * @private
     * @param {?} userPerformer
     * @return {?}
     */
    ParticipantComponent.prototype.addUserPerformer = /**
     * @private
     * @param {?} userPerformer
     * @return {?}
     */
    function (userPerformer) {
        if (this.type === 'humanPerformer') {
            /** @type {?} */
            var i = this.participant.humanPerformerList.findIndex((/**
             * @param {?} a
             * @return {?}
             */
            function (a) { return (a.id === userPerformer.id || (((/** @type {?} */ (a))).performerId && ((/** @type {?} */ (a))).performerId === userPerformer.performerId)); }));
            if (i > -1) ;
            else {
                if (this.editState === 'edit') {
                    this.removeHumanPerformer();
                }
                /** @type {?} */
                var index = void 0;
                if (this.participant.humanPerformerList.length > 0) {
                    index = Math.max.apply(Math, __spread(this.participant.humanPerformerList.map((/**
                     * @param {?} h
                     * @return {?}
                     */
                    function (h) { return h.order; })))) + 1;
                }
                else {
                    index = 1;
                }
                userPerformer.order = index;
                this.participant.humanPerformerList.push(userPerformer);
            }
            this.humanPerformerGrid.loadData(this.participant.humanPerformerList);
        }
        else if (this.type === 'potentialOwner') {
            /** @type {?} */
            var i = this.participant.potentialOwnerList.findIndex((/**
             * @param {?} a
             * @return {?}
             */
            function (a) { return (a.id === userPerformer.id || (((/** @type {?} */ (a))).performerId && ((/** @type {?} */ (a))).performerId === userPerformer.performerId)); }));
            if (i > -1) ;
            else {
                if (this.editState === 'edit') {
                    this.removePotentialOwner();
                }
                /** @type {?} */
                var index = void 0;
                if (this.participant.potentialOwnerList.length > 0) {
                    index = Math.max.apply(Math, __spread(this.participant.potentialOwnerList.map((/**
                     * @param {?} p
                     * @return {?}
                     */
                    function (p) { return p.order; })))) + 1;
                }
                else {
                    index = 1;
                }
                userPerformer.order = index;
                this.participant.potentialOwnerList.push(userPerformer);
            }
            this.potentialOwnerGrid.loadData(this.participant.potentialOwnerList);
        }
    };
    /**
     * @private
     * @param {?} variable
     * @return {?}
     */
    ParticipantComponent.prototype.addvariablePerformer = /**
     * @private
     * @param {?} variable
     * @return {?}
     */
    function (variable) {
        /** @type {?} */
        var v = variable;
        if (!v || !v.varValue) {
            this.message.info(this.localePipe.transform('component.participant.selectProcessVariables'));
            this.isClose = false;
        }
        else if (!v.varType) {
            this.message.info(this.localePipe.transform('component.participant.selectVariableValueType'));
            this.isClose = false;
        }
        else if (!v.relation) {
            this.message.info(this.localePipe.transform('component.participant.selectRelation'));
            this.isClose = false;
        }
        else {
            if (this.type === 'humanPerformer') {
                /** @type {?} */
                var i = this.participant.humanPerformerList.findIndex((/**
                 * @param {?} a
                 * @return {?}
                 */
                function (a) { return (a.id === variable.id || (((/** @type {?} */ (a))).performerId && ((/** @type {?} */ (a))).performerId === variable.performerId)); }));
                if (i > -1) {
                    this.participant.humanPerformerList[i] = variable;
                }
                else {
                    if (this.editState === 'edit') {
                        this.removeHumanPerformer();
                    }
                    /** @type {?} */
                    var index = void 0;
                    if (this.participant.humanPerformerList.length > 0) {
                        index = Math.max.apply(Math, __spread(this.participant.humanPerformerList.map((/**
                         * @param {?} h
                         * @return {?}
                         */
                        function (h) { return h.order; })))) + 1;
                    }
                    else {
                        index = 1;
                    }
                    variable.order = index;
                    this.participant.humanPerformerList.push(variable);
                }
                this.humanPerformerGrid.loadData(this.participant.humanPerformerList);
            }
            else if (this.type === 'potentialOwner') {
                /** @type {?} */
                var i = this.participant.potentialOwnerList.findIndex((/**
                 * @param {?} a
                 * @return {?}
                 */
                function (a) { return (a.id === variable.id || (((/** @type {?} */ (a))).performerId && ((/** @type {?} */ (a))).performerId === variable.performerId)); }));
                if (i > -1) {
                    this.participant.potentialOwnerList[i] = variable;
                }
                else {
                    if (this.editState === 'edit') {
                        this.removePotentialOwner();
                    }
                    /** @type {?} */
                    var index = void 0;
                    if (this.participant.potentialOwnerList.length > 0) {
                        index = Math.max.apply(Math, __spread(this.participant.potentialOwnerList.map((/**
                         * @param {?} p
                         * @return {?}
                         */
                        function (p) { return p.order; })))) + 1;
                    }
                    else {
                        index = 1;
                    }
                    variable.order = index;
                    this.participant.potentialOwnerList.push(variable);
                }
                this.potentialOwnerGrid.loadData(this.participant.potentialOwnerList);
            }
        }
    };
    /**
     * @private
     * @param {?} positions
     * @return {?}
     */
    ParticipantComponent.prototype.addPositionPerformer = /**
     * @private
     * @param {?} positions
     * @return {?}
     */
    function (positions) {
        var e_5, _a;
        var _loop_1 = function (position) {
            if (!position.performerId) {
                this_1.message.info(this_1.localePipe.transform('component.participant.selectPosition'));
                this_1.isClose = false;
            }
            else {
                if ((!position.orgType || position.orgType == null) && (position.isRequired && position.positionType === '1')) {
                    this_1.message.info(this_1.localePipe.transform('component.participant.selectOrgType'));
                    this_1.isClose = false;
                }
                else if ((!position.orgId || position.orgId == null) && (position.isRequired && position.positionType === '1')) {
                    this_1.message.info(this_1.localePipe.transform('component.participant.orgFill'));
                    this_1.isClose = false;
                }
                else {
                    // (1)id一致，为编辑岗位；（2）performid一致，新增的用户，岗位已存在
                    if (this_1.type === 'humanPerformer') {
                        /** @type {?} */
                        var i = this_1.participant.humanPerformerList.findIndex((/**
                         * @param {?} a
                         * @return {?}
                         */
                        function (a) {
                            if (a.type !== 'wf.PositionParticipantExpression') {
                                return false;
                            }
                            /** @type {?} */
                            var p = (/** @type {?} */ (a));
                            return (p.id === position.id);
                        }));
                        if (i > -1) {
                            this_1.participant.humanPerformerList[i] = position;
                        }
                        else {
                            /** @type {?} */
                            var index = void 0;
                            if (this_1.participant.humanPerformerList.length > 0) {
                                index = Math.max.apply(Math, __spread(this_1.participant.humanPerformerList.map((/**
                                 * @param {?} h
                                 * @return {?}
                                 */
                                function (h) { return h.order; })))) + 1;
                            }
                            else {
                                index = 1;
                            }
                            position.order = index;
                            this_1.participant.humanPerformerList.push(position);
                        }
                        this_1.humanPerformerGrid.loadData(this_1.participant.humanPerformerList);
                    }
                    else if (this_1.type === 'potentialOwner') {
                        /** @type {?} */
                        var i = this_1.participant.potentialOwnerList.findIndex((/**
                         * @param {?} a
                         * @return {?}
                         */
                        function (a) {
                            if (a.type !== 'wf.PositionParticipantExpression') {
                                return false;
                            }
                            /** @type {?} */
                            var p = (/** @type {?} */ (a));
                            return (p.id === position.id);
                        }));
                        if (i > -1) {
                            this_1.participant.potentialOwnerList[i] = position;
                        }
                        else {
                            /** @type {?} */
                            var index = void 0;
                            if (this_1.participant.potentialOwnerList.length > 0) {
                                index = Math.max.apply(Math, __spread(this_1.participant.potentialOwnerList.map((/**
                                 * @param {?} p
                                 * @return {?}
                                 */
                                function (p) { return p.order; })))) + 1;
                            }
                            else {
                                index = 1;
                            }
                            position.order = index;
                            this_1.participant.potentialOwnerList.push(position);
                        }
                        this_1.potentialOwnerGrid.loadData(this_1.participant.potentialOwnerList);
                    }
                }
            }
        };
        var this_1 = this;
        try {
            for (var positions_1 = __values(positions), positions_1_1 = positions_1.next(); !positions_1_1.done; positions_1_1 = positions_1.next()) {
                var position = positions_1_1.value;
                _loop_1(position);
            }
        }
        catch (e_5_1) { e_5 = { error: e_5_1 }; }
        finally {
            try {
                if (positions_1_1 && !positions_1_1.done && (_a = positions_1.return)) _a.call(positions_1);
            }
            finally { if (e_5) throw e_5.error; }
        }
    };
    /**
     * @private
     * @param {?} component
     * @return {?}
     */
    ParticipantComponent.prototype.addComponentPerformer = /**
     * @private
     * @param {?} component
     * @return {?}
     */
    function (component) {
        /** @type {?} */
        var cmp = new ComponentParticipant();
        cmp.id = component.id;
        cmp.metadataId = component.metadataId;
        cmp.methodCode = component.methodCode;
        cmp.methodName = component.methodName;
        cmp.name = component.name;
        cmp.actualParameters = component.actualParameters;
        cmp.type = 'wf.ComponentParticipantExpression';
        cmp.condition = component.condition;
        if (this.type === 'humanPerformer') {
            /** @type {?} */
            var i = this.participant.humanPerformerList.findIndex((/**
             * @param {?} a
             * @return {?}
             */
            function (a) { return a.id === cmp.id; }));
            if (i > -1) {
                this.participant.humanPerformerList[i] = cmp;
            }
            else {
                /** @type {?} */
                var index = void 0;
                if (this.participant.humanPerformerList.length > 0) {
                    index = Math.max.apply(Math, __spread(this.participant.humanPerformerList.map((/**
                     * @param {?} h
                     * @return {?}
                     */
                    function (h) { return h.order; })))) + 1;
                }
                else {
                    index = 1;
                }
                cmp.order = index;
                this.participant.humanPerformerList.push(cmp);
            }
            this.humanPerformerGrid.loadData(this.participant.humanPerformerList);
        }
        else if (this.type === 'potentialOwner') {
            /** @type {?} */
            var i = this.participant.potentialOwnerList.findIndex((/**
             * @param {?} a
             * @return {?}
             */
            function (a) { return a.id === cmp.id; }));
            if (i > -1) {
                this.participant.potentialOwnerList[i] = cmp;
            }
            else {
                /** @type {?} */
                var index = void 0;
                if (this.participant.potentialOwnerList.length > 0) {
                    index = Math.max.apply(Math, __spread(this.participant.potentialOwnerList.map((/**
                     * @param {?} p
                     * @return {?}
                     */
                    function (p) { return p.order; })))) + 1;
                }
                else {
                    index = 1;
                }
                cmp.order = index;
                this.participant.potentialOwnerList.push(cmp);
            }
            this.potentialOwnerGrid.loadData(this.participant.potentialOwnerList);
        }
    };
    /**
     * @private
     * @param {?} reportingLine
     * @return {?}
     */
    ParticipantComponent.prototype.addReportingLinePerformer = /**
     * @private
     * @param {?} reportingLine
     * @return {?}
     */
    function (reportingLine) {
        var e_6, _a, e_7, _b;
        if (reportingLine.reportingReferObject === 'dept' && !reportingLine.refOrgId) {
            this.isClose = false;
            this.message.info(this.localePipe.transform('component.participant.refOrgIdNotNull'));
        }
        else if (reportingLine.reportingReferObject !== 'dept' && !reportingLine.refUserId && !reportingLine.refEmployeeId) { // 用户及其他人员汇报对象类型，参照用户和参照员工不能全部为空
            this.isClose = false;
            this.message.info(this.localePipe.transform('component.participant.refUserIdNotNull'));
        }
        else {
            this.isClose = true;
            if (this.type === 'humanPerformer') {
                /** @type {?} */
                var i = this.participant.humanPerformerList.findIndex((/**
                 * @param {?} a
                 * @return {?}
                 */
                function (a) { return a.id === reportingLine.id; }));
                if (i > -1) {
                    this.participant.humanPerformerList[i] = reportingLine;
                }
                else {
                    /** @type {?} */
                    var reportingLines = this.participant.humanPerformerList.filter((/**
                     * @param {?} h
                     * @return {?}
                     */
                    function (h) { return h.type === 'wf.ReportingLineParticipantExpression'; }));
                    try {
                        for (var reportingLines_1 = __values(reportingLines), reportingLines_1_1 = reportingLines_1.next(); !reportingLines_1_1.done; reportingLines_1_1 = reportingLines_1.next()) {
                            var r = reportingLines_1_1.value;
                            /** @type {?} */
                            var reportingLineData = (/** @type {?} */ (r));
                            if (reportingLineData.reportingLineDefId === reportingLine.reportingLineDefId &&
                                reportingLineData.dimension === reportingLine.dimension &&
                                reportingLineData.refUserId === reportingLine.refUserId &&
                                reportingLineData.refEmployeeId === reportingLine.refEmployeeId &&
                                reportingLineData.refOrgId === reportingLine.refOrgId) {
                                this.message.error(this.localePipe.transform('component.participant.repDefConfigured'));
                                return;
                            }
                        }
                    }
                    catch (e_6_1) { e_6 = { error: e_6_1 }; }
                    finally {
                        try {
                            if (reportingLines_1_1 && !reportingLines_1_1.done && (_a = reportingLines_1.return)) _a.call(reportingLines_1);
                        }
                        finally { if (e_6) throw e_6.error; }
                    }
                    /** @type {?} */
                    var index = void 0;
                    if (this.participant.humanPerformerList.length > 0) {
                        index = Math.max.apply(Math, __spread(this.participant.humanPerformerList.map((/**
                         * @param {?} h
                         * @return {?}
                         */
                        function (h) { return h.order; })))) + 1;
                    }
                    else {
                        index = 1;
                    }
                    reportingLine.order = index;
                    this.participant.humanPerformerList.push(reportingLine);
                }
                this.humanPerformerGrid.loadData(this.participant.humanPerformerList);
            }
            else if (this.type === 'potentialOwner') {
                /** @type {?} */
                var i = this.participant.potentialOwnerList.findIndex((/**
                 * @param {?} a
                 * @return {?}
                 */
                function (a) { return a.id === reportingLine.id; }));
                if (i > -1) {
                    this.participant.potentialOwnerList[i] = reportingLine;
                }
                else {
                    /** @type {?} */
                    var reportingLines = this.participant.potentialOwnerList.filter((/**
                     * @param {?} h
                     * @return {?}
                     */
                    function (h) { return h.type === 'wf.ReportingLineParticipantExpression'; }));
                    try {
                        for (var reportingLines_2 = __values(reportingLines), reportingLines_2_1 = reportingLines_2.next(); !reportingLines_2_1.done; reportingLines_2_1 = reportingLines_2.next()) {
                            var r = reportingLines_2_1.value;
                            /** @type {?} */
                            var reportingLineData = (/** @type {?} */ (r));
                            if (reportingLineData.reportingLineDefId === reportingLine.reportingLineDefId &&
                                reportingLineData.dimension === reportingLine.dimension &&
                                reportingLineData.refUserId === reportingLine.refUserId &&
                                reportingLineData.refEmployeeId === reportingLine.refEmployeeId &&
                                reportingLineData.refOrgId === reportingLine.refOrgId) {
                                this.message.error(this.localePipe.transform('component.participant.repDefConfigured'));
                                return;
                            }
                        }
                    }
                    catch (e_7_1) { e_7 = { error: e_7_1 }; }
                    finally {
                        try {
                            if (reportingLines_2_1 && !reportingLines_2_1.done && (_b = reportingLines_2.return)) _b.call(reportingLines_2);
                        }
                        finally { if (e_7) throw e_7.error; }
                    }
                    /** @type {?} */
                    var index = void 0;
                    if (this.participant.potentialOwnerList.length > 0) {
                        index = Math.max.apply(Math, __spread(this.participant.potentialOwnerList.map((/**
                         * @param {?} p
                         * @return {?}
                         */
                        function (p) { return p.order; })))) + 1;
                    }
                    else {
                        index = 1;
                    }
                    reportingLine.order = index;
                    this.participant.potentialOwnerList.push(reportingLine);
                }
                this.potentialOwnerGrid.loadData(this.participant.potentialOwnerList);
            }
        }
    };
    /**
     * @private
     * @param {?} matrix
     * @return {?}
     */
    ParticipantComponent.prototype.addMatrixPerformer = /**
     * @private
     * @param {?} matrix
     * @return {?}
     */
    function (matrix) {
        var e_8, _a, e_9, _b;
        if (!matrix.conditionField1 && !matrix.conditionField2 && !matrix.conditionField3) {
            this.isClose = false;
            this.message.info(this.localePipe.transform('component.participant.atLeastOneCondition'));
        }
        else if (!matrix.dataFieldAlias) {
            this.isClose = false;
            this.message.info(this.localePipe.transform('component.participant.dataFieldAliasNotNull'));
        }
        else {
            this.isClose = true;
            if (this.type === 'humanPerformer') {
                /** @type {?} */
                var i = this.participant.humanPerformerList.findIndex((/**
                 * @param {?} a
                 * @return {?}
                 */
                function (a) { return a.id === matrix.id; }));
                if (i > -1) {
                    this.participant.humanPerformerList[i] = matrix;
                }
                else {
                    /** @type {?} */
                    var matrixParticipants = this.participant.humanPerformerList.filter((/**
                     * @param {?} h
                     * @return {?}
                     */
                    function (h) { return h.type === 'wf.MatrixParticipantExpression'; }));
                    try {
                        for (var matrixParticipants_1 = __values(matrixParticipants), matrixParticipants_1_1 = matrixParticipants_1.next(); !matrixParticipants_1_1.done; matrixParticipants_1_1 = matrixParticipants_1.next()) {
                            var m = matrixParticipants_1_1.value;
                            /** @type {?} */
                            var matrixData = (/** @type {?} */ (m));
                            if (matrixData.matrixDefId === matrix.matrixDefId &&
                                matrixData.conditionField1 === matrix.conditionField1 &&
                                matrixData.conditionField2 === matrix.conditionField2 &&
                                matrixData.conditionField3 === matrix.conditionField3 &&
                                matrixData.dataFieldAlias === matrix.dataFieldAlias) {
                                this.message.error(this.localePipe.transform('component.participant.matrixConfigured'));
                                return;
                            }
                        }
                    }
                    catch (e_8_1) { e_8 = { error: e_8_1 }; }
                    finally {
                        try {
                            if (matrixParticipants_1_1 && !matrixParticipants_1_1.done && (_a = matrixParticipants_1.return)) _a.call(matrixParticipants_1);
                        }
                        finally { if (e_8) throw e_8.error; }
                    }
                    /** @type {?} */
                    var index = void 0;
                    if (this.participant.humanPerformerList.length > 0) {
                        index = Math.max.apply(Math, __spread(this.participant.humanPerformerList.map((/**
                         * @param {?} h
                         * @return {?}
                         */
                        function (h) { return h.order; })))) + 1;
                    }
                    else {
                        index = 1;
                    }
                    matrix.order = index;
                    this.participant.humanPerformerList.push(matrix);
                }
                this.humanPerformerGrid.loadData(this.participant.humanPerformerList);
            }
            else if (this.type === 'potentialOwner') {
                /** @type {?} */
                var i = this.participant.potentialOwnerList.findIndex((/**
                 * @param {?} a
                 * @return {?}
                 */
                function (a) { return a.id === matrix.id; }));
                if (i > -1) {
                    this.participant.potentialOwnerList[i] = matrix;
                }
                else {
                    /** @type {?} */
                    var matrixParticipants = this.participant.potentialOwnerList.filter((/**
                     * @param {?} h
                     * @return {?}
                     */
                    function (h) { return h.type === 'wf.MatrixParticipantExpression'; }));
                    try {
                        for (var matrixParticipants_2 = __values(matrixParticipants), matrixParticipants_2_1 = matrixParticipants_2.next(); !matrixParticipants_2_1.done; matrixParticipants_2_1 = matrixParticipants_2.next()) {
                            var m = matrixParticipants_2_1.value;
                            /** @type {?} */
                            var matrixData = (/** @type {?} */ (m));
                            if (matrixData.matrixDefId === matrix.matrixDefId &&
                                matrixData.conditionField1 === matrix.conditionField1 &&
                                matrixData.conditionField2 === matrix.conditionField2 &&
                                matrixData.conditionField3 === matrix.conditionField3 &&
                                matrixData.dataFieldAlias === matrix.dataFieldAlias) {
                                this.message.error(this.localePipe.transform('component.participant.matrixConfigured'));
                                return;
                            }
                        }
                    }
                    catch (e_9_1) { e_9 = { error: e_9_1 }; }
                    finally {
                        try {
                            if (matrixParticipants_2_1 && !matrixParticipants_2_1.done && (_b = matrixParticipants_2.return)) _b.call(matrixParticipants_2);
                        }
                        finally { if (e_9) throw e_9.error; }
                    }
                    /** @type {?} */
                    var index = void 0;
                    if (this.participant.potentialOwnerList.length > 0) {
                        index = Math.max.apply(Math, __spread(this.participant.potentialOwnerList.map((/**
                         * @param {?} p
                         * @return {?}
                         */
                        function (p) { return p.order; })))) + 1;
                    }
                    else {
                        index = 1;
                    }
                    matrix.order = index;
                    this.participant.potentialOwnerList.push(matrix);
                }
                this.potentialOwnerGrid.loadData(this.participant.potentialOwnerList);
            }
        }
    };
    /**
     * @private
     * @param {?} activityExecutor
     * @return {?}
     */
    ParticipantComponent.prototype.addActivityExecutorPerformer = /**
     * @private
     * @param {?} activityExecutor
     * @return {?}
     */
    function (activityExecutor) {
        if (this.type === 'humanPerformer') {
            /** @type {?} */
            var i = this.participant.humanPerformerList.findIndex((/**
             * @param {?} a
             * @return {?}
             */
            function (a) { return (a.id === activityExecutor.id ||
                (((/** @type {?} */ (a))).activityDefId && ((/** @type {?} */ (a))).activityDefId === activityExecutor.activityDefId)); }));
            if (i < 0) {
                if (this.editState === 'edit') {
                    this.removeHumanPerformer(); // 在编辑状态下配置了活动办理人参与者，先将选中的删除
                }
                /** @type {?} */
                var index = void 0;
                if (this.participant.humanPerformerList.length > 0) {
                    index = Math.max.apply(Math, __spread(this.participant.humanPerformerList.map((/**
                     * @param {?} h
                     * @return {?}
                     */
                    function (h) { return h.order; })))) + 1;
                }
                else {
                    index = 1;
                }
                activityExecutor.order = index;
                this.participant.humanPerformerList.push(activityExecutor);
            }
            this.humanPerformerGrid.loadData(this.participant.humanPerformerList);
        }
        else if (this.type === 'potentialOwner') {
            /** @type {?} */
            var i = this.participant.potentialOwnerList.findIndex((/**
             * @param {?} a
             * @return {?}
             */
            function (a) { return (a.id === activityExecutor.id ||
                (((/** @type {?} */ (a))).activityDefId && ((/** @type {?} */ (a))).activityDefId === activityExecutor.activityDefId)); }));
            if (i < 0) {
                if (this.editState === 'edit') {
                    this.removePotentialOwner(); // 在编辑状态下配置了活动办理人参与者，先将选中的删除
                }
                /** @type {?} */
                var index = void 0;
                if (this.participant.potentialOwnerList.length > 0) {
                    index = Math.max.apply(Math, __spread(this.participant.potentialOwnerList.map((/**
                     * @param {?} p
                     * @return {?}
                     */
                    function (p) { return p.order; })))) + 1;
                }
                else {
                    index = 1;
                }
                activityExecutor.order = index;
                this.participant.potentialOwnerList.push(activityExecutor);
            }
            this.potentialOwnerGrid.loadData(this.participant.potentialOwnerList);
        }
    };
    /**
     * @private
     * @param {?} organization
     * @return {?}
     */
    ParticipantComponent.prototype.addOrganizationParticipant = /**
     * @private
     * @param {?} organization
     * @return {?}
     */
    function (organization) {
        /** @type {?} */
        var organizationParticipant = new OrganizationParticipant();
        organizationParticipant.id = organization.id || ProcessDeUtil.GenerateElementId();
        organizationParticipant.type = 'wf.OrganizationParticipantExpression';
        organizationParticipant.condition = organization.condition;
        organizationParticipant.name = organization.name;
        organizationParticipant.actionScope = organization.actionScope;
        organizationParticipant.organizationLevel = organization.organizationLevel;
        organizationParticipant.organizationId = organization.organizationId;
        organizationParticipant.organizationCode = organization.organizationCode;
        organizationParticipant.organizationName = organization.organizationName;
        organizationParticipant.includeChildren = organization.includeChildren;
        organizationParticipant.parentsUntil = organization.parentsUntil;
        organizationParticipant.tag = organization.tag;
        if (this.type === 'humanPerformer') {
            this.participant.humanPerformerList = this.participant.humanPerformerList.filter((/**
             * @param {?} p
             * @return {?}
             */
            function (p) { return p.type !== 'wf.OrganizationParticipantExpression'; }));
            /** @type {?} */
            var index = void 0;
            if (this.participant.humanPerformerList.length > 0) {
                index = Math.max.apply(Math, __spread(this.participant.humanPerformerList.map((/**
                 * @param {?} h
                 * @return {?}
                 */
                function (h) { return h.order; })))) + 1;
            }
            else {
                index = 1;
            }
            organizationParticipant.order = index;
            this.participant.humanPerformerList.push(organizationParticipant);
            this.humanPerformerGrid.loadData(this.participant.humanPerformerList);
        }
        else if (this.type === 'potentialOwner') {
            this.participant.potentialOwnerList = this.participant.potentialOwnerList.filter((/**
             * @param {?} p
             * @return {?}
             */
            function (p) { return p.type !== 'wf.OrganizationParticipantExpression'; }));
            /** @type {?} */
            var index = void 0;
            if (this.participant.potentialOwnerList.length > 0) {
                index = Math.max.apply(Math, __spread(this.participant.potentialOwnerList.map((/**
                 * @param {?} p
                 * @return {?}
                 */
                function (p) { return p.order; })))) + 1;
            }
            else {
                index = 1;
            }
            organizationParticipant.order = index;
            this.participant.potentialOwnerList.push(organizationParticipant);
            this.potentialOwnerGrid.loadData(this.participant.potentialOwnerList);
        }
    };
    /**
     * @return {?}
     */
    ParticipantComponent.prototype.editCancel = /**
     * @return {?}
     */
    function () {
        if (this.editDialog) {
            this.editDialog.close();
        }
    };
    /**
     * @param {?} type
     * @return {?}
     */
    ParticipantComponent.prototype.editPerformer = /**
     * @param {?} type
     * @return {?}
     */
    function (type) {
        var _this = this;
        this.editState = 'edit';
        this.type = type;
        /** @type {?} */
        var selectedRow;
        if (type === 'humanPerformer') {
            selectedRow = this.humanPerformerGrid.selectedRow;
        }
        else if (type === 'potentialOwner') {
            selectedRow = this.potentialOwnerGrid.selectedRow;
        }
        if (!selectedRow) {
            this.message.info(this.localePipe.transform('component.participant.selectPerformer'));
            return;
        }
        /** @type {?} */
        var curPerformer = selectedRow.data;
        if (curPerformer) {
            /** @type {?} */
            var boxsize = this.attributeBoxSize(curPerformer.type);
            /** @type {?} */
            var modalConfig_1 = {
                title: this.localePipe.transform('component.participant.participantSelection'),
                width: boxsize.width,
                height: boxsize.height,
                buttons: this.editFooter,
                showButtons: true
            };
            /** @type {?} */
            var compFactory = this.resolver.resolveComponentFactory(PerformerEditComponent);
            this.compRef = compFactory.create(this.injector);
            this.compRef.instance.performerType = curPerformer.type;
            this.compRef.instance.editState = this.editState;
            switch (curPerformer.type) {
                case 'wf.PositionParticipantExpression':
                    this.compRef.instance.performer = {
                        type: 'wf.PositionParticipantExpression',
                        value: curPerformer
                    };
                    break;
                case 'wf.UserParticipantExpression':
                    this.compRef.instance.performer = {
                        type: 'wf.UserParticipantExpression',
                        value: curPerformer
                    };
                    break;
                case 'wf.VariableParticipantExpression':
                    this.compRef.instance.performer = {
                        type: 'wf.VariableParticipantExpression',
                        value: curPerformer
                    };
                    break;
                case 'wf.ReportingLineParticipantExpression':
                    this.compRef.instance.performer = {
                        type: 'wf.ReportingLineParticipantExpression',
                        value: curPerformer
                    };
                    /** @type {?} */
                    var url = '/api/runtime/wf/v1.0/reportingLineDefinitions/' + ((/** @type {?} */ (curPerformer))).reportingLineDefId;
                    this.http.get(url).subscribe((/**
                     * @param {?} res
                     * @return {?}
                     */
                    function (res) {
                        if (!res) {
                            _this.message.error(_this.localePipe.transform('component.participant.definitionDeleted'));
                            if (type === 'humanPerformer') {
                                _this.removeHumanPerformer();
                            }
                            else if (type === 'potentialOwner') {
                                _this.removePotentialOwner();
                            }
                        }
                        else {
                            _this.editDialog = _this.modalService.show(_this.compRef, modalConfig_1);
                        }
                    }));
                    break;
                case 'wf.MatrixParticipantExpression':
                    this.compRef.instance.performer = {
                        type: 'wf.MatrixParticipantExpression',
                        value: curPerformer
                    };
                    /** @type {?} */
                    var urlMatrix = '/api/runtime/wf/v1.0/matrixDefinition/' + ((/** @type {?} */ (curPerformer))).matrixDefId;
                    this.http.get(urlMatrix).subscribe((/**
                     * @param {?} res
                     * @return {?}
                     */
                    function (res) {
                        if (!res) {
                            _this.message.error(_this.localePipe.transform('component.participant.matrixDeleted'));
                            if (type === 'humanPerformer') {
                                _this.removeHumanPerformer();
                            }
                            else if (type === 'potentialOwner') {
                                _this.removePotentialOwner();
                            }
                        }
                        else {
                            _this.editDialog = _this.modalService.show(_this.compRef, modalConfig_1);
                        }
                    }));
                    break;
                case 'wf.ComponentParticipantExpression':
                    this.compRef.instance.performer = {
                        type: 'wf.ComponentParticipantExpression',
                        value: curPerformer
                    };
                    break;
                case 'wf.ActivityExecutorParticipantExpression':
                    this.compRef.instance.performer = {
                        type: 'wf.ActivityExecutorParticipantExpression',
                        value: curPerformer
                    };
                    break;
                case 'wf.OrganizationParticipantExpression':
                    this.compRef.instance.performer = {
                        type: 'wf.OrganizationParticipantExpression',
                        value: curPerformer
                    };
                    break;
            }
            if (curPerformer.type !== 'wf.ReportingLineParticipantExpression' &&
                curPerformer.type !== 'wf.MatrixParticipantExpression') { // 汇报关系和矩阵单独处理
                this.editDialog = this.modalService.show(this.compRef, modalConfig_1);
            }
        }
    };
    /**
     * @param {?} type
     * @return {?}
     */
    ParticipantComponent.prototype.removePerformer = /**
     * @param {?} type
     * @return {?}
     */
    function (type) {
        var _this = this;
        if (type === 'humanPerformer') {
            if (this.humanPerformerGrid.selectedRow) {
                this.humanPerformerGrid.endCellEdit();
                /** @type {?} */
                var index = this.participant.humanPerformerList.findIndex((/**
                 * @param {?} p
                 * @return {?}
                 */
                function (p) { return p.id === _this.humanPerformerGrid.selectedRow.data.id; }));
                this.participant.humanPerformerList.splice(index, 1);
                this.humanPerformerGrid.loadData(this.participant.humanPerformerList);
            }
            else {
                this.message.info(this.localePipe.transform('component.participant.selectParticipantInfo'));
            }
        }
        else if (type === 'potentialOwner') {
            if (this.potentialOwnerGrid.selectedRow) {
                this.potentialOwnerGrid.endCellEdit();
                /** @type {?} */
                var index = this.participant.potentialOwnerList.findIndex((/**
                 * @param {?} p
                 * @return {?}
                 */
                function (p) { return p.id === _this.potentialOwnerGrid.selectedRow.data.id; }));
                this.participant.potentialOwnerList.splice(index, 1);
                this.potentialOwnerGrid.loadData(this.participant.potentialOwnerList);
            }
            else {
                this.message.info(this.localePipe.transform('component.participant.selectParticipantInfo'));
            }
        }
    };
    /**
     * @param {?} type
     * @return {?}
     */
    ParticipantComponent.prototype.clearPerformer = /**
     * @param {?} type
     * @return {?}
     */
    function (type) {
        if (type === 'humanPerformer') {
            this.participant.humanPerformerList = new Array();
        }
        else if (type === 'potentialOwner') {
            this.participant.potentialOwnerList = new Array();
        }
        this.humanPerformerGrid.loadData(this.participant.humanPerformerList);
        if (this.potentialOwnerGrid) {
            this.potentialOwnerGrid.loadData(this.participant.potentialOwnerList);
        }
    };
    /**
     * @param {?} type
     * @return {?}
     */
    ParticipantComponent.prototype.moveUp = /**
     * @param {?} type
     * @return {?}
     */
    function (type) {
        if (type === 'humanPerformer') {
            /** @type {?} */
            var selectedRow = this.humanPerformerGrid.selectedRow;
            if (!selectedRow) {
                this.message.info(this.localePipe.transform('component.participant.noRowSelected'));
                return;
            }
            /** @type {?} */
            var performer_1 = selectedRow.data;
            /** @type {?} */
            var i = this.participant.humanPerformerList.findIndex((/**
             * @param {?} c
             * @return {?}
             */
            function (c) { return c.id === performer_1.id; }));
            if (i === 0) {
                return;
            }
            /** @type {?} */
            var index = this.participant.humanPerformerList[i].order;
            this.participant.humanPerformerList[i].order = this.participant.humanPerformerList[i - 1].order;
            this.participant.humanPerformerList[i - 1].order = index;
            this.swapArray(this.participant.humanPerformerList, i, i - 1);
            this.humanPerformerGrid.loadData(this.participant.humanPerformerList);
            this.humanPerformerGrid.selectRow(performer_1.id, true);
        }
        else if (type === 'potentialOwner') {
            /** @type {?} */
            var selectedRow = this.potentialOwnerGrid.selectedRow;
            if (!selectedRow) {
                this.message.info(this.localePipe.transform('component.participant.noRowSelected'));
                return;
            }
            /** @type {?} */
            var performer_2 = selectedRow.data;
            /** @type {?} */
            var i = this.participant.potentialOwnerList.findIndex((/**
             * @param {?} c
             * @return {?}
             */
            function (c) { return c.id === performer_2.id; }));
            if (i === 0) {
                return;
            }
            /** @type {?} */
            var index = this.participant.potentialOwnerList[i].order;
            this.participant.potentialOwnerList[i].order = this.participant.potentialOwnerList[i - 1].order;
            this.participant.potentialOwnerList[i - 1].order = index;
            this.swapArray(this.participant.potentialOwnerList, i, i - 1);
            this.potentialOwnerGrid.loadData(this.participant.potentialOwnerList);
            this.potentialOwnerGrid.selectRow(performer_2.id, true);
        }
    };
    /**
     * @param {?} type
     * @return {?}
     */
    ParticipantComponent.prototype.moveDown = /**
     * @param {?} type
     * @return {?}
     */
    function (type) {
        if (type === 'humanPerformer') {
            /** @type {?} */
            var selectedRow = this.humanPerformerGrid.selectedRow;
            if (!selectedRow) {
                this.message.info(this.localePipe.transform('component.participant.noRowSelected'));
                return;
            }
            /** @type {?} */
            var performer_3 = selectedRow.data;
            /** @type {?} */
            var i = this.participant.humanPerformerList.findIndex((/**
             * @param {?} c
             * @return {?}
             */
            function (c) { return c.id === performer_3.id; }));
            if (i === this.participant.humanPerformerList.length - 1) {
                return;
            }
            /** @type {?} */
            var index = this.participant.humanPerformerList[i].order;
            this.participant.humanPerformerList[i].order = this.participant.humanPerformerList[i + 1].order;
            this.participant.humanPerformerList[i + 1].order = index;
            this.swapArray(this.participant.humanPerformerList, i, i + 1);
            this.humanPerformerGrid.loadData(this.participant.humanPerformerList);
            this.humanPerformerGrid.selectRow(performer_3.id, true);
        }
        else if (type === 'potentialOwner') {
            /** @type {?} */
            var selectedRow = this.potentialOwnerGrid.selectedRow;
            if (!selectedRow) {
                this.message.info(this.localePipe.transform('component.participant.noRowSelected'));
                return;
            }
            /** @type {?} */
            var performer_4 = selectedRow.data;
            /** @type {?} */
            var i = this.participant.potentialOwnerList.findIndex((/**
             * @param {?} c
             * @return {?}
             */
            function (c) { return c.id === performer_4.id; }));
            if (i === this.participant.potentialOwnerList.length - 1) {
                return;
            }
            /** @type {?} */
            var index = this.participant.potentialOwnerList[i].order;
            this.participant.potentialOwnerList[i].order = this.participant.potentialOwnerList[i + 1].order;
            this.participant.potentialOwnerList[i + 1].order = index;
            this.swapArray(this.participant.potentialOwnerList, i, i + 1);
            this.potentialOwnerGrid.loadData(this.participant.potentialOwnerList);
            this.potentialOwnerGrid.selectRow(performer_4.id, true);
        }
    };
    /**
     * @private
     * @param {?} arr
     * @param {?} i1
     * @param {?} i2
     * @return {?}
     */
    ParticipantComponent.prototype.swapArray = /**
     * @private
     * @param {?} arr
     * @param {?} i1
     * @param {?} i2
     * @return {?}
     */
    function (arr, i1, i2) {
        arr[i1] = arr.splice(i2, 1, arr[i1])[0];
        return arr;
    };
    /**
     * @return {?}
     */
    ParticipantComponent.prototype.removeHumanPerformer = /**
     * @return {?}
     */
    function () {
        var _this = this;
        if (this.humanPerformerGrid.selectedRow) {
            this.humanPerformerGrid.endCellEdit();
            /** @type {?} */
            var i = this.participant.humanPerformerList.findIndex((/**
             * @param {?} item
             * @return {?}
             */
            function (item) { return item.id === _this.humanPerformerGrid.selectedRow.data.id; }));
            this.participant.humanPerformerList.splice(i, 1);
        }
        else {
            this.message.info(this.localePipe.transform('component.participant.selectDefaultHandler'));
        }
    };
    /**
     * @return {?}
     */
    ParticipantComponent.prototype.removePotentialOwner = /**
     * @return {?}
     */
    function () {
        var _this = this;
        if (this.potentialOwnerGrid.selectedRow) {
            this.potentialOwnerGrid.endCellEdit();
            /** @type {?} */
            var i = this.participant.potentialOwnerList.findIndex((/**
             * @param {?} item
             * @return {?}
             */
            function (item) { return item.id === _this.potentialOwnerGrid.selectedRow.data.id; }));
            this.participant.potentialOwnerList.splice(i, 1);
        }
        else {
            this.message.info(this.localePipe.transform('component.participant.selectpotentialtHandler'));
        }
    };
    /**
     * @private
     * @param {?} userPerformer
     * @return {?}
     */
    ParticipantComponent.prototype.getUserPerformerDescription = /**
     * @private
     * @param {?} userPerformer
     * @return {?}
     */
    function (userPerformer) {
        if (userPerformer.tag === 'expression') {
            return userPerformer.performerId;
        }
        else {
            if (userPerformer.orgName) {
                return this.localePipe.transform('component.participant.org') + userPerformer.orgName;
            }
            else {
                return '';
            }
        }
    };
    /**
     * @private
     * @param {?} variablePerformer
     * @return {?}
     */
    ParticipantComponent.prototype.getVariablePerformerDescription = /**
     * @private
     * @param {?} variablePerformer
     * @return {?}
     */
    function (variablePerformer) {
        if (variablePerformer.tag === 'expression') {
            return variablePerformer.varValue;
        }
    };
    /**
     * @private
     * @param {?} position
     * @return {?}
     */
    ParticipantComponent.prototype.getPositionPerformerDescription = /**
     * @private
     * @param {?} position
     * @return {?}
     */
    function (position) {
        if (this.designerUIState.scene === 'inSuite') {
            return null;
        }
        if (position.positionType === '1') {
            if (position.orgId) {
                return this.localePipe.transform('component.participant.positionType1') + position.orgId;
            }
            else {
                return this.localePipe.transform('component.participant.positionType2');
            }
        }
        else if (position.positionType === '0') {
            return this.localePipe.transform('component.participant.positionType3');
        }
    };
    /**
     * @private
     * @param {?} position
     * @return {?}
     */
    ParticipantComponent.prototype.getComponentPerformerDescription = /**
     * @private
     * @param {?} position
     * @return {?}
     */
    function (position) {
        /** @type {?} */
        var des = this.localePipe.transform('component.participant.comp') + position.name
            + this.localePipe.transform('component.participant.parameters');
        if (position.actualParameters && position.actualParameters.length > 0) {
            position.actualParameters.forEach((/**
             * @param {?} p
             * @return {?}
             */
            function (p) {
                des += p.code + "\uFF1A" + p.value + "\uFF0C";
            }));
            des = des.substring(0, des.length - 1);
        }
        des += '}';
        return des;
    };
    /**
     * @private
     * @param {?} reportingLine
     * @return {?}
     */
    ParticipantComponent.prototype.getReportingLinePerformerDescription = /**
     * @private
     * @param {?} reportingLine
     * @return {?}
     */
    function (reportingLine) {
        /** @type {?} */
        var description = '';
        if (reportingLine.refUserId) {
            description += this.localePipe.transform('component.participant.referencePerson') + reportingLine.refUserId;
        }
        if (reportingLine.refEmployeeId) {
            description += this.localePipe.transform('component.participant.referencePerson') + reportingLine.refEmployeeId;
        }
        if (reportingLine.refOrgId) {
            if (reportingLine.refUserId) {
                description += "\uFF0C";
            }
            if (reportingLine.refEmployeeId) {
                description += "\uFF0C";
            }
            description += this.localePipe.transform('component.participant.referenceOrganization') + reportingLine.refOrgId;
        }
        return description;
    };
    /**
     * @private
     * @param {?} matrix
     * @return {?}
     */
    ParticipantComponent.prototype.getMatrixPerformerDescription = /**
     * @private
     * @param {?} matrix
     * @return {?}
     */
    function (matrix) {
        /** @type {?} */
        var description = '';
        if (matrix.conditionField1) {
            description += this.localePipe.transform('component.participant.condition1') + matrix.conditionFieldText1 + "\uFF0C";
        }
        if (matrix.conditionField2) {
            description += this.localePipe.transform('component.participant.condition2') + matrix.conditionFieldText2 + "\uFF0C";
        }
        if (matrix.conditionField3) {
            description += this.localePipe.transform('component.participant.condition3') + matrix.conditionFieldText3 + "\uFF0C";
        }
        if (matrix.dataFieldAlias) {
            description += this.localePipe.transform('component.participant.data') + matrix.dataFieldAlias + "\uFF0C";
        }
        return description.slice(0, description.length - 1);
    };
    /**
     * @private
     * @param {?} e
     * @return {?}
     */
    ParticipantComponent.prototype.editConditon = /**
     * @private
     * @param {?} e
     * @return {?}
     */
    function (e) {
        // this.expr.clearContext();
        var _this = this;
        var e_10, _a, e_11, _b, e_12, _c, e_13, _d;
        if (this.designerUIState.schemas.length > 0) {
            try {
                for (var _e = __values(this.designerUIState.schemas), _f = _e.next(); !_f.done; _f = _e.next()) {
                    var schema = _f.value;
                    this.expr.addSchema('Schema', schema);
                }
            }
            catch (e_10_1) { e_10 = { error: e_10_1 }; }
            finally {
                try {
                    if (_f && !_f.done && (_a = _e.return)) _a.call(_e);
                }
                finally { if (e_10) throw e_10.error; }
            }
            if (this.designerUIState.schemas[0].entityTypes && this.designerUIState.schemas[0].entityTypes.length > 0) {
                /** @type {?} */
                var entityType = this.designerUIState.schemas[0].entityTypes[0];
                this.expr.addInjectedEntity(entityType.name, 'Schema', entityType.name, InjectedType.EntityType);
            }
        }
        /** @type {?} */
        var context = new Array();
        context = this.designerUIState.addContext(context);
        if (this.designerUIState.subActivityContext.length > 0) {
            var _loop_2 = function (variable) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    context.push(variable);
                }
            };
            try {
                for (var _g = __values(this.designerUIState.subActivityContext), _h = _g.next(); !_h.done; _h = _g.next()) {
                    var variable = _h.value;
                    _loop_2(variable);
                }
            }
            catch (e_11_1) { e_11 = { error: e_11_1 }; }
            finally {
                try {
                    if (_h && !_h.done && (_b = _g.return)) _b.call(_g);
                }
                finally { if (e_11) throw e_11.error; }
            }
        }
        if (this.designerUIState.activityComponentContext.length > 0) {
            var _loop_3 = function (variable) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    context.push(variable);
                }
            };
            try {
                for (var _j = __values(this.designerUIState.activityComponentContext), _k = _j.next(); !_k.done; _k = _j.next()) {
                    var variable = _k.value;
                    _loop_3(variable);
                }
            }
            catch (e_12_1) { e_12 = { error: e_12_1 }; }
            finally {
                try {
                    if (_k && !_k.done && (_c = _j.return)) _c.call(_j);
                }
                finally { if (e_12) throw e_12.error; }
            }
        }
        if (context.length > 0) {
            try {
                for (var context_1 = __values(context), context_1_1 = context_1.next(); !context_1_1.done; context_1_1 = context_1.next()) {
                    var v = context_1_1.value;
                    this.expr.addContext(v);
                }
            }
            catch (e_13_1) { e_13 = { error: e_13_1 }; }
            finally {
                try {
                    if (context_1_1 && !context_1_1.done && (_d = context_1.return)) _d.call(context_1);
                }
                finally { if (e_13) throw e_13.error; }
            }
        }
        this.expr.addExpressionText(e.instance.value);
        this.expr.setEditPattern(ExprEditMode.Conditional); // 默认打开简易表达式编辑器
        this.expr.buildExpression().then((/**
         * @param {?} cond
         * @return {?}
         */
        function (cond) {
            if (_this.humanPerformerGrid && _this.humanPerformerGrid.selectedRow && _this.humanPerformerGrid.selectedRow.data) {
                /** @type {?} */
                var temp = _this.participant.humanPerformerList.find((/**
                 * @param {?} h
                 * @return {?}
                 */
                function (h) { return h.id === _this.humanPerformerGrid.selectedRow.data.id; }));
                temp.condition = cond;
            }
            if (_this.potentialOwnerGrid && _this.potentialOwnerGrid.selectedRow && _this.potentialOwnerGrid.selectedRow.data) {
                /** @type {?} */
                var temp = _this.participant.potentialOwnerList.find((/**
                 * @param {?} h
                 * @return {?}
                 */
                function (h) { return h.id === _this.potentialOwnerGrid.selectedRow.data.id; }));
                temp.condition = cond;
            }
            e.formControl.setValue(cond);
            e.instance.cd.detectChanges();
            //点击确定后，去除表达式里面的新增的上下文变量
            if (context.length > 0) {
                _this.expr.exprEntity.contextEntities = _this.expr.exprEntity.contextEntities.filter((/**
                 * @param {?} x
                 * @return {?}
                 */
                function (x) { return !context.some((/**
                 * @param {?} y
                 * @return {?}
                 */
                function (y) { return y.key === x.key; })); }));
            }
        }));
    };
    /**
     * @private
     * @return {?}
     */
    ParticipantComponent.prototype.humanPerformerCopyToPotentialOwner = /**
     * @private
     * @return {?}
     */
    function () {
        var _a;
        if (this.participant.humanPerformerList && this.participant.humanPerformerList.length > 0) {
            if (!this.participant.potentialOwnerList) {
                this.participant.potentialOwnerList = new Array();
            }
            (_a = this.participant.potentialOwnerList).push.apply(_a, __spread(this.participant.humanPerformerList));
            this.participant.humanPerformerList = new Array();
            this.humanPerformerGrid.loadData(this.participant.humanPerformerList);
            if (this.potentialOwnerGrid) {
                this.potentialOwnerGrid.loadData(this.participant.potentialOwnerList);
            }
        }
    };
    /**
     * @private
     * @return {?}
     */
    ParticipantComponent.prototype.potentialOwnerCopyToHumanPerformer = /**
     * @private
     * @return {?}
     */
    function () {
        var _a;
        if (this.participant.potentialOwnerList && this.participant.potentialOwnerList.length > 0) {
            if (!this.participant.humanPerformerList) {
                this.participant.humanPerformerList = new Array();
            }
            /** @type {?} */
            var performers = this.participant.potentialOwnerList.filter((/**
             * @param {?} p
             * @return {?}
             */
            function (p) { return p.type !== 'wf.OrganizationParticipantExpression'; }));
            if (performers && performers.length > 0) {
                // 此处直接push会导致order重复,需要重新排序
                (_a = this.participant.humanPerformerList).push.apply(_a, __spread(performers));
                this.participant.humanPerformerList.forEach((/**
                 * @param {?} human
                 * @param {?} index
                 * @return {?}
                 */
                function (human, index) {
                    human.order = index + 1;
                }));
                this.participant.potentialOwnerList = this.participant.potentialOwnerList.filter((/**
                 * @param {?} p
                 * @return {?}
                 */
                function (p) { return p.type === 'wf.OrganizationParticipantExpression'; }));
                this.humanPerformerGrid.loadData(this.participant.humanPerformerList);
                if (this.potentialOwnerGrid) {
                    this.potentialOwnerGrid.loadData(this.participant.potentialOwnerList);
                }
            }
        }
    };
    /**
     * @private
     * @return {?}
     */
    ParticipantComponent.prototype.GetOrganizationType = /**
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var url = '/api/runtime/sys/v1.0/authfields/globalauthfields';
        this.http.get(url)
            .subscribe((/**
         * @param {?} data
         * @return {?}
         */
        function (data) { return _this.designerUIState.orgTypeCollection = data.map((/**
         * @param {?} d
         * @return {?}
         */
        function (d) { return ({ value: d.id, text: d.name }); })); }));
    };
    // 构造不同参与者选择界面的尺寸 2023-7-5
    // 构造不同参与者选择界面的尺寸 2023-7-5
    /**
     * @private
     * @param {?} boxType
     * @return {?}
     */
    ParticipantComponent.prototype.attributeBoxSize = 
    // 构造不同参与者选择界面的尺寸 2023-7-5
    /**
     * @private
     * @param {?} boxType
     * @return {?}
     */
    function (boxType) {
        /** @type {?} */
        var boxsize = {
            width: 760,
            height: 512
        };
        switch (boxType) {
            case 'wf.PositionParticipantExpression':
                boxsize.width = 760;
                boxsize.height = 455;
                return boxsize;
            case 'wf.UserParticipantExpression':
                boxsize.width = 760;
                boxsize.height = 320;
                return boxsize;
            case 'wf.VariableParticipantExpression':
                boxsize.width = 760;
                boxsize.height = 420;
                return boxsize;

            case 'wf.ReportingLineParticipantExpression':
                boxsize.width = 760;
                boxsize.height = 512;
                return boxsize;

            case 'wf.MatrixParticipantExpression':
                boxsize.width = 780;
                boxsize.height = 420;
                return boxsize;

            case 'wf.ComponentParticipantExpression':
                boxsize.width = 760;
                boxsize.height = 512;
                return boxsize;

            case 'wf.ActivityExecutorParticipantExpression':
                boxsize.width = 760;
                boxsize.height = 320;
                return boxsize;

            case 'wf.OrganizationParticipantExpression':
                boxsize.width = 760;
                boxsize.height = 360;
                return boxsize;

        }
    };
    ParticipantComponent.decorators = [
        { type: Component, args: [{
                    selector: 'lib-participant',
                    template: "<div class=\"f-page f-utils-overflow-xhya\">\r\n  <div class=\"f-page-main d-flex flex-column farris-overflow-y-auto\" style=\"border-radius:16px;border: 1.5px solid #F1F3F7;\">\r\n  <section class=\"f-page-main d-flex flex-column\">\r\n    <farris-section *ngIf=\"nodeType === 'userActivity'\" class=\"pt-0 f-section-form f-section-in-mainsubcard mb-1\" [showHeader]=\"false\" >\r\n      <div class=\"f-form-layout farris-form f-form-lable-auto farris-form-controls-inline\">\r\n        <div class=\"col-12 farris-group-wrap\">\r\n          <div class=\"form-group\">\r\n            <label class=\"col-form-label\">\r\n              <span class=\"farris-label-text\">{{'component.participant.allocationPolicy'|wfLocale}}</span>\r\n            </label>\r\n            <div class=\"farris-input-wrap\">\r\n              <farris-radiogroup [(ngModel)]=\"participant.assignStrategy.assignStrategy\" [data]=\"assignStrategyList\" name=\"assignStrategy\"\r\n                [horizontal]=\"true\" (changeValue)=\"assignStrategyChange($event)\">\r\n              </farris-radiogroup>\r\n              <div class=\"farris-feedback valid-feedback\"></div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </farris-section>\r\n    <farris-section *ngIf=\"nodeType === 'userActivity' && participant.assignStrategy.assignStrategy==='ASSIGN'\" class=\"pt-0 f-section-form f-section-in-mainsubcard\" [showHeader]=\"false\">\r\n      <div class=\"f-form-layout farris-form f-form-lable-auto farris-form-controls-inline\">\r\n        <div class=\"col-12 px-0 d-flex\">\r\n          <div class=\"col-4 farris-group-wrap\">\r\n            <div class=\"form-group\">\r\n              <label class=\"col-form-label\">\r\n                <span class=\"farris-label-text\">{{'component.participant.operator'|wfLocale}}</span>\r\n              </label>\r\n              <div class=\"farris-input-wrap\">\r\n                <farris-combo-list [(ngModel)]=\"participant.assignStrategy.assignConfig.operator\" name=\"operator\" [ngModelOptions]=\"{standalone: true}\"\r\n                  [idField]=\"'value'\" [textField]=\"'text'\" [valueField]=\"'value'\" [data]=\"operatorCollection\"\r\n                  [panelHeight]=\"60\">\r\n                </farris-combo-list>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"col-auto farris-group-wrap f-form-label-xl\">\r\n            <div class=\"form-group\">\r\n              <label class=\"col-form-label\">\r\n                <span class=\"farris-label-text\">{{'component.participant.multiSelect'|wfLocale}}</span>\r\n              </label>\r\n              <div class=\"farris-input-wrap\">\r\n                <farris-switch size=\"small\" [(ngModel)]=\"participant.assignStrategy.assignConfig.multiSelect\" name=\"multiSelect\">\r\n                </farris-switch>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"col-auto farris-group-wrap f-form-label-el\">\r\n            <div class=\"form-group\">\r\n              <label class=\"col-form-label\">\r\n                <span class=\"farris-label-text\">{{'component.participant.necessary'|wfLocale}}</span>\r\n              </label>\r\n              <div class=\"farris-input-wrap\">\r\n                <farris-switch size=\"small\" [(ngModel)]=\"participant.assignStrategy.assignConfig.necessary\" name=\"necessary\">\r\n                </farris-switch>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </farris-section>\r\n    <div class=\"d-flex flex-column\" [ngStyle]=\"{'height':nodeType === 'notifyActivity'? '470px': participant.assignStrategy.assignStrategy==='ASSIGN' ? '220px':'470px'}\">\r\n      <farris-section class=\"pt-0 f-section-grid\" [mainTitle]=\"nodeType === 'notifyActivity' ? ('component.participant.notifyRecipient' | wfLocale) : ('component.participant.defaultHandler' | wfLocale)\" [enableAccordion]=\"''\"\r\n      [enableMaximize]=\"false\" [fill]=\"true\" style=\"overflow: initial;\">\r\n      <ng-template farrisSectionToolbar>\r\n        <div class=\"btn-group mr-2\"  fDropdown #dropdownEl=\"fDropdown\" [autoRectify]=\"true\">\r\n          <farris-button class=\"dropdown-toggle\" fDropdownToggle [type]=\"'link'\">\r\n            {{'component.participant.new'|wfLocale}}\r\n          </farris-button>\r\n          <div class=\"dropdown-menu\" fDropdownMenu>\r\n            <li class=\"dropdown-item\" (click)=\"addPerformer('wf.UserParticipantExpression' ,'humanPerformer')\"><span>{{'component.participant.user'|wfLocale}}</span></li>\r\n            <li class=\"dropdown-item\" (click)=\"addPerformer('wf.VariableParticipantExpression','humanPerformer')\"><span>{{'component.participant.variable'|wfLocale}}</span></li>\r\n            <li class=\"dropdown-item\" (click)=\"addPerformer('wf.PositionParticipantExpression','humanPerformer')\"><span>{{designerUIState.scene==='inSuite'?(('component.participant.role'|wfLocale)):('component.participant.position'|wfLocale)}}</span></li>\r\n            <li class=\"dropdown-item\" (click)=\"addPerformer('wf.ReportingLineParticipantExpression','humanPerformer')\"><span>{{'component.participant.reportingLine'|wfLocale}}</span></li>\r\n            <li class=\"dropdown-item\" (click)=\"addPerformer('wf.ActivityExecutorParticipantExpression','humanPerformer')\"><span>{{'component.participant.activityExecutor'|wfLocale}}</span></li>\r\n            <li class=\"dropdown-item\" (click)=\"addPerformer('wf.MatrixParticipantExpression','humanPerformer')\"><span>{{'component.participant.matrix'|wfLocale}}</span></li>\r\n            <li class=\"dropdown-item\" (click)=\"addPerformer('wf.ComponentParticipantExpression','humanPerformer')\"><span>{{'component.participant.component'|wfLocale}}</span></li>\r\n          </div>\r\n        </div>\r\n        <farris-button  [type]=\"'link'\" (click)=\"editPerformer('humanPerformer')\">{{'component.participant.editPerformer'|wfLocale}}</farris-button>\r\n        <farris-button  [type]=\"'link'\" (click)=\"removePerformer('humanPerformer')\">{{'component.participant.removePerformer'|wfLocale}}</farris-button>\r\n        <farris-button  [type]=\"'link'\" (click)=\"clearPerformer('humanPerformer')\">{{'component.participant.clearPerformer'|wfLocale}}</farris-button>\r\n        <farris-button  [type]=\"'link'\" (click)=\"moveUp('humanPerformer')\">{{'component.participant.moveUp'|wfLocale}}</farris-button>\r\n        <farris-button  [type]=\"'link'\" (click)=\"moveDown('humanPerformer')\">{{'component.participant.moveDown'|wfLocale}}</farris-button>\r\n      </ng-template>\r\n      <div class=\"f-utils-fill\">\r\n        <farris-datagrid #humanPerformerGrid class=\"f-component-grid\" [columns]=\"columns\" [data]=\"participant.humanPerformerList\" #defaultPerformerGrid [idField]=\"'id'\" [showLineNumber]=\"false\"\r\n          [striped]=\"true\" [showCheckbox]=\"false\" [pagination]=\"false\" [fit]=\"true\" [fitColumns]=\"true\" [editable]=\"true\" [editMode]=\"'cell'\"\r\n          [multiSelect]=\"false\">\r\n        </farris-datagrid>\r\n      </div>\r\n    </farris-section>\r\n    </div>\r\n    <div *ngIf=\"nodeType === 'userActivity' && participant.assignStrategy.assignStrategy==='ASSIGN'\" class=\"d-flex flex-column\" style=\"height: 220px;\">\r\n      <farris-section class=\"pt-0 f-section-grid\" mainTitle=\"{{'component.participant.alternativeHandler'|wfLocale}}\" [enableAccordion]=\"''\"\r\n        [enableMaximize]=\"false\" [fill]=\"true\" style=\"overflow: initial;\">\r\n      <ng-template farrisSectionHeader>\r\n        <div class=\"f-title\">\r\n          <h4 class=\"f-title-text\">{{'component.participant.alternativeHandler'|wfLocale}}</h4>\r\n        </div>\r\n        <label class=\"col-form-label mr-2 mb-0\">\r\n          <span class=\"farris-label-text\">{{'component.participant.isAllScope'|wfLocale}}</span>\r\n        </label>\r\n        <farris-switch size=\"small\" [(ngModel)]=\"participant.isAllScope\" name=\"isAllScope\" (valueChange)=\"switchChange($event)\">\r\n        </farris-switch>\r\n        <div class=\"f-toolbar\" [ngStyle]=\"{'visibility' : participant.isAllScope ? 'hidden' : 'visible'}\">\r\n          <div class=\"btn-group mr-2\"  fDropdown #dropdownE2=\"fDropdown\" [autoRectify]=\"true\">\r\n            <farris-button class=\"dropdown-toggle\" fDropdownToggle [type]=\"'link'\">\r\n              {{'component.participant.new'|wfLocale}}\r\n            </farris-button>\r\n            <div class=\"dropdown-menu\" fDropdownMenu>\r\n              <li class=\"dropdown-item\" (click)=\"addPerformer('wf.UserParticipantExpression','potentialOwner')\"><span>{{'component.participant.user'|wfLocale}}</span></li>\r\n              <li class=\"dropdown-item\" (click)=\"addPerformer('wf.VariableParticipantExpression','potentialOwner')\"><span>{{'component.participant.variable'|wfLocale}}</span></li>\r\n              <li class=\"dropdown-item\" (click)=\"addPerformer('wf.PositionParticipantExpression','potentialOwner')\"><span>{{designerUIState.scene==='inSuite'?(('component.participant.role'|wfLocale)):('component.participant.position'|wfLocale)}}</span></li>\r\n              <li class=\"dropdown-item\" (click)=\"addPerformer('wf.ReportingLineParticipantExpression','potentialOwner')\"><span>{{'component.participant.reportingLine'|wfLocale}}</span></li>\r\n              <li class=\"dropdown-item\" (click)=\"addPerformer('wf.ActivityExecutorParticipantExpression','potentialOwner')\"><span>{{'component.participant.activityExecutor'|wfLocale}}</span></li>\r\n              <li class=\"dropdown-item\" (click)=\"addPerformer('wf.MatrixParticipantExpression','potentialOwner')\"><span>{{'component.participant.matrix'|wfLocale}}</span></li>\r\n              <li class=\"dropdown-item\" (click)=\"addPerformer('wf.ComponentParticipantExpression','potentialOwner')\"><span>{{'component.participant.component'|wfLocale}}</span></li>\r\n              <li class=\"dropdown-item\" (click)=\"addPerformer('wf.OrganizationParticipantExpression','potentialOwner')\"><span>{{'component.participant.organization'|wfLocale}}\r\n              </span></li>\r\n            </div>\r\n          </div>\r\n          <farris-button  [type]=\"'link'\" (click)=\"editPerformer('potentialOwner')\">{{'component.participant.editPerformer'|wfLocale}}</farris-button>\r\n          <farris-button  [type]=\"'link'\" (click)=\"removePerformer('potentialOwner')\">{{'component.participant.removePerformer'|wfLocale}}</farris-button>\r\n          <farris-button  [type]=\"'link'\" (click)=\"clearPerformer('potentialOwner')\">{{'component.participant.clearPerformer'|wfLocale}}</farris-button>\r\n          <farris-button  [type]=\"'link'\" (click)=\"moveUp('potentialOwner')\">{{'component.participant.moveUp'|wfLocale}}</farris-button>\r\n          <farris-button  [type]=\"'link'\" (click)=\"moveDown('potentialOwner')\">{{'component.participant.moveDown'|wfLocale}}</farris-button>\r\n        </div>\r\n      </ng-template>\r\n      <div class=\"f-utils-fill\">\r\n        <farris-datagrid #potentialOwnerGrid class=\"f-component-grid\" [columns]=\"columns\" [data]=\"participant.potentialOwnerList\" #defaultPerformerGrid [idField]=\"'id'\" [showLineNumber]=\"false\"\r\n          [striped]=\"true\" [showCheckbox]=\"false\" [pagination]=\"false\" [fit]=\"true\" [fitColumns]=\"true\" [editable]=\"true\" [editMode]=\"'cell'\"\r\n          [multiSelect]=\"false\">\r\n        </farris-datagrid>\r\n      </div>\r\n    </farris-section>\r\n    </div>\r\n  </section>\r\n</div>\r\n</div>\r\n\r\n\r\n\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type=\"button\" class=\"btn btn-secondary btn-sm px-3 mx-2\" (click)=\"clickCancel()\">{{'component.participant.clickCancel'|wfLocale}}</button>\r\n  <button type=\"button\" class=\"btn btn-primary btn-sm px-3 mx-2\" (click)=\"clickOK()\">{{'component.participant.clickOK'|wfLocale}}</button>\r\n</ng-template>\r\n\r\n\r\n<ng-template #editFooter>\r\n  <button type=\"button\" class=\"btn btn-secondary btn-sm px-3 mx-2\" (click)=\"editCancel()\">{{'component.participant.clickCancel'|wfLocale}}</button>\r\n  <button type=\"button\" class=\"btn btn-primary btn-sm px-3 mx-2\" (click)=\"editOK()\">{{'component.participant.clickOK'|wfLocale}}</button>\r\n</ng-template>\r\n",
                    providers: [
                        ParticipantUIState,
                        WfLocalePipe
                    ],
                    styles: [""]
                }] }
    ];
    /** @nocollapse */
    ParticipantComponent.ctorParameters = function () { return [
        { type: ProcessDesignerUIState },
        { type: ParticipantUIState },
        { type: ComponentFactoryResolver },
        { type: Injector },
        { type: BsModalService },
        { type: MessagerService },
        { type: ExpressionService },
        { type: HttpService },
        { type: ChangeDetectorRef, decorators: [{ type: Optional }] },
        { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
        { type: undefined, decorators: [{ type: Inject, args: [WF_LANG_RESOURCES,] }] },
        { type: WfLocalePipe, decorators: [{ type: Optional }] }
    ]; };
    ParticipantComponent.propDecorators = {
        closeModal: [{ type: Output }],
        submitModal: [{ type: Output }],
        modalFooter: [{ type: ViewChild, args: ['iconSelectFooter',] }],
        dropDownEl: [{ type: ViewChild, args: ['dropdownEl',] }],
        dropDownE2: [{ type: ViewChild, args: ['dropdownE2',] }],
        editFooter: [{ type: ViewChild, args: ['editFooter',] }],
        humanPerformerGrid: [{ type: ViewChild, args: ['humanPerformerGrid',] }],
        potentialOwnerGrid: [{ type: ViewChild, args: ['potentialOwnerGrid',] }],
        editorParams: [{ type: Input }],
        value: [{ type: Input }]
    };
    return ParticipantComponent;
}());
var ParticipantConverter = /** @class */ (function () {
    function ParticipantConverter(localePipe) {
        this.localePipe = localePipe;
    }
    /**
     * @param {?} data
     * @return {?}
     */
    ParticipantConverter.prototype.convertTo = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        if (data && data.humanPerformerList && data.humanPerformerList.length > 0) {
            return this.localePipe.transform("component.participant.set");
        }
        if (data && data.potentialOwnerList && data.potentialOwnerList.length > 0) {
            return this.localePipe.transform("component.participant.set");
        }
        if (data && data.isAllScope) {
            return this.localePipe.transform("component.participant.set");
        }
        return this.localePipe.transform("component.participant.notSet");
    };
    return ParticipantConverter;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var Condition$1 = /** @class */ (function () {
    function Condition$$1() {
    }
    return Condition$$1;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var DisplayInfor = /** @class */ (function () {
    function DisplayInfor(name, id) {
        this.name = name;
        this.activityDefinitionId = id;
        this.required = false;
    }
    return DisplayInfor;
}());
var OtherAssignActivityNodeInfo$1 = /** @class */ (function () {
    function OtherAssignActivityNodeInfo$$1(id, condition, required) {
        this.activityDefinitionId = id;
        this.condition = new Condition$1();
        this.condition.Value = condition;
        this.required = required;
    }
    return OtherAssignActivityNodeInfo$$1;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var AssignScopeComponent = /** @class */ (function () {
    function AssignScopeComponent(uistate, message, exprService, cdr, localeId, resources, localePipe) {
        var _this = this;
        this.uistate = uistate;
        this.message = message;
        this.exprService = exprService;
        this.cdr = cdr;
        this.localeId = localeId;
        this.resources = resources;
        this.localePipe = localePipe;
        this.closeModal = new EventEmitter();
        this.submitModal = new EventEmitter();
        this.editorParams = {};
        this.items = new Array();
        this.listItems = new Array();
        this.modalConfig = {
            title: this.localePipe.transform('component.assignScope.assignScopeList'),
            width: 600,
            height: 520,
            showButtons: true
        };
        this.cols = [
            { title: this.localePipe.transform('component.assignScope.name'), field: 'name', width: 80 },
            { title: 'ID', field: 'activityDefinitionId', width: 100 },
            { title: this.localePipe.transform('component.assignScope.required'), field: 'required', width: 50,
                editor: {
                    type: EditorTypes.SWITCH,
                    options: {}
                },
                formatter: { type: 'boolean', options: { trueText: this.localePipe.transform('component.assignScope.yes'), falseText: this.localePipe.transform('component.assignScope.no') } },
                validators: [
                    { type: 'required', messager: '必填' }
                ]
            },
            { title: this.localePipe.transform('component.assignScope.condition'), field: 'condition', width: 70,
                editor: {
                    type: 'input-group',
                    options: {
                        groupText: '<i class="f-icon f-icon-lookup"></i>',
                        editable: false,
                        clickHandle: (/**
                         * @param {?} e
                         * @return {?}
                         */
                        function (e) {
                            e.formControl.setValue(e.instance.value ? e.instance.value : '');
                            _this.editConditon(e);
                        }),
                        clear: (/**
                         * @param {?} e
                         * @return {?}
                         */
                        function (e) {
                            console.log('clear', e);
                        })
                    }
                }
            }
        ];
        this.nodeCols = [
            { title: this.localePipe.transform('component.assignScope.name'), field: 'Name', width: 100, filter: true },
            { title: 'ID', field: 'Id', width: 100, filter: true },
        ];
        // otherAssignActivities = new Array();
        this.otherAssignActivityNodeInfos = new Array();
        this.localePipe = this.localePipe || new WfLocalePipe(localeId, resources);
    }
    Object.defineProperty(AssignScopeComponent.prototype, "value", {
        set: /**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            var _this = this;
            if (data && data.length > 0) {
                // this.otherAssignActivities = [...data];
                data.forEach((/**
                 * @param {?} data1
                 * @return {?}
                 */
                function (data1) {
                    /** @type {?} */
                    var otherAssignActivityNodeInfo = new OtherAssignActivityNodeInfo$1(data1.activityDefinitionId, data1.condition ? data1.condition.Value : data1.condition, data1.required);
                    _this.otherAssignActivityNodeInfos.push(otherAssignActivityNodeInfo);
                }));
                this.otherAssignActivityNodeInfos.forEach((/**
                 * @param {?} other
                 * @return {?}
                 */
                function (other) {
                    /** @type {?} */
                    var displayInfo = new DisplayInfor(null, other.activityDefinitionId);
                    displayInfo.required = other.required;
                    if (other.condition) {
                        displayInfo.condition = other.condition.Value;
                    }
                    // displayInfo.name = this.items.find(item => item.Id === displayInfo.activityDefinitionId).Name;
                    _this.listItems.push(displayInfo);
                }));
            }
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    AssignScopeComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        var e_1, _a, e_2, _b;
        if (!this.location) {
            this.location = this.editorParams.location;
        }
        /** @type {?} */
        var activities = new Array();
        if (this.location === 'startActivity') {
            activities = __spread(this.uistate.userActList.filter((/**
             * @param {?} a
             * @return {?}
             */
            function (a) { return a.Id !== _this.uistate.propertyData.Id
                && a.AssignmentStrategy === 'ASSIGN'
                && a.AssignPerformerConfig
                && a.AssignPerformerConfig.Operator === 'procInstCreator'; })));
        }
        else {
            activities = __spread(this.uistate.userActList.filter((/**
             * @param {?} a
             * @return {?}
             */
            function (a) { return a.Id !== _this.uistate.propertyData.Id && a.AssignmentStrategy === 'ASSIGN'; })));
        }
        if (this.otherAssignActivityNodeInfos && this.otherAssignActivityNodeInfos.length > 0) {
            var _loop_1 = function (other) {
                /** @type {?} */
                var activity = activities.find((/**
                 * @param {?} a
                 * @return {?}
                 */
                function (a) { return a.Id === other.activityDefinitionId; }));
                if (activity) {
                    this_1.items = this_1.items.concat([activity]);
                }
            };
            var this_1 = this;
            try {
                for (var _c = __values(this.otherAssignActivityNodeInfos), _d = _c.next(); !_d.done; _d = _c.next()) {
                    var other = _d.value;
                    _loop_1(other);
                }
            }
            catch (e_1_1) { e_1 = { error: e_1_1 }; }
            finally {
                try {
                    if (_d && !_d.done && (_a = _c.return)) _a.call(_c);
                }
                finally { if (e_1) throw e_1.error; }
            }
            var _loop_2 = function (activity) {
                if (this_2.items.findIndex((/**
                 * @param {?} item
                 * @return {?}
                 */
                function (item) { return item.Id === activity.Id; })) === -1) {
                    this_2.items = this_2.items.concat([activity]);
                }
            };
            var this_2 = this;
            try {
                for (var activities_1 = __values(activities), activities_1_1 = activities_1.next(); !activities_1_1.done; activities_1_1 = activities_1.next()) {
                    var activity = activities_1_1.value;
                    _loop_2(activity);
                }
            }
            catch (e_2_1) { e_2 = { error: e_2_1 }; }
            finally {
                try {
                    if (activities_1_1 && !activities_1_1.done && (_b = activities_1.return)) _b.call(activities_1);
                }
                finally { if (e_2) throw e_2.error; }
            }
        }
        else {
            this.items = activities;
        }
        this.listItems.forEach((/**
         * @param {?} listItem
         * @return {?}
         */
        function (listItem) {
            listItem.name = _this.items.find((/**
             * @param {?} item
             * @return {?}
             */
            function (item) { return item.Id === listItem.activityDefinitionId; })).Name;
        }));
    };
    /**
     * @return {?}
     */
    AssignScopeComponent.prototype.ngAfterViewInit = /**
     * @return {?}
     */
    function () {
        var e_3, _a;
        if (this.otherAssignActivityNodeInfos && this.otherAssignActivityNodeInfos.length > 0) {
            try {
                for (var _b = __values(this.otherAssignActivityNodeInfos), _c = _b.next(); !_c.done; _c = _b.next()) {
                    var other = _c.value;
                    this.grid.checkRow(other.activityDefinitionId);
                }
            }
            catch (e_3_1) { e_3 = { error: e_3_1 }; }
            finally {
                try {
                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                }
                finally { if (e_3) throw e_3.error; }
            }
        }
    };
    /**
     * @return {?}
     */
    AssignScopeComponent.prototype.delete = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.grid.endCellEdit();
        if (this.grid.selectedRow && this.grid.selectedRow.data) {
            /** @type {?} */
            var i = this.listItems.findIndex((/**
             * @param {?} d
             * @return {?}
             */
            function (d) { return d.activityDefinitionId === _this.grid.selectedRow.data.activityDefinitionId; }));
            this.listItems.splice(i, 1);
            this.grid.loadData(this.listItems);
        }
        else {
            this.message.info(this.localePipe.transform('component.assignScope.deleteRow'));
        }
    };
    /**
     * @return {?}
     */
    AssignScopeComponent.prototype.moveUp = /**
     * @return {?}
     */
    function () {
        if (!this.curActivity) {
            this.message.info(this.localePipe.transform('component.assignScope.curActivity'));
            return;
        }
        /** @type {?} */
        var curCmpId = this.curActivity.activityDefinitionId;
        /** @type {?} */
        var i = this.listItems.findIndex((/**
         * @param {?} c
         * @return {?}
         */
        function (c) { return c.activityDefinitionId === curCmpId; }));
        if (i === 0) {
            return;
        }
        this.swapArray(this.listItems, i, i - 1);
        this.grid.loadData(this.listItems);
        this.grid.selectRow(curCmpId, true);
        // const selectedRow = this.grid.selectedRow;
        // debugger;
        // if (!selectedRow) {
        //   this.message.info('尚未选中行');
        //   return;
        // }
        // if (selectedRow.index === 0) {
        //   return;
        // }
        // this.swapArray(this.items, selectedRow.index, selectedRow.index - 1);
        // this.grid.loadData(this.items);
        // this.grid.selectRow(selectedRow.id, true);
    };
    /**
     * @return {?}
     */
    AssignScopeComponent.prototype.moveDown = /**
     * @return {?}
     */
    function () {
        if (!this.curActivity) {
            this.message.info(this.localePipe.transform('component.assignScope.curActivity'));
            return;
        }
        /** @type {?} */
        var curCmpId = this.curActivity.activityDefinitionId;
        /** @type {?} */
        var i = this.listItems.findIndex((/**
         * @param {?} c
         * @return {?}
         */
        function (c) { return c.activityDefinitionId === curCmpId; }));
        if (i === this.listItems.length - 1) {
            return;
        }
        this.swapArray(this.listItems, i, i + 1);
        this.grid.loadData(this.listItems);
        this.grid.selectRow(curCmpId, true);
        // const selectedRow = this.grid.selectedRow;
        // if (!selectedRow) {
        //   this.message.info('尚未选中行');
        //   return;
        // }
        // if (selectedRow.index === this.items.length - 1) {
        //   return;
        // }
        // this.swapArray(this.items, selectedRow.index, selectedRow.index + 1);
        // this.grid.loadData(this.items);
        // this.grid.selectRow(selectedRow.id, true);
    };
    /**
     * @param {?} data
     * @return {?}
     */
    AssignScopeComponent.prototype.selectionChange = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        this.curActivity = data.data;
    };
    /**
     * @private
     * @param {?} arr
     * @param {?} i1
     * @param {?} i2
     * @return {?}
     */
    AssignScopeComponent.prototype.swapArray = /**
     * @private
     * @param {?} arr
     * @param {?} i1
     * @param {?} i2
     * @return {?}
     */
    function (arr, i1, i2) {
        arr[i1] = arr.splice(i2, 1, arr[i1])[0];
        return arr;
    };
    /**
     * @return {?}
     */
    AssignScopeComponent.prototype.clickOK = /**
     * @return {?}
     */
    function () {
        var e_4, _a;
        this.otherAssignActivityNodeInfos = new Array();
        try {
            for (var _b = __values(this.listItems), _c = _b.next(); !_c.done; _c = _b.next()) {
                var item = _c.value;
                this.otherAssignActivityNodeInfos.push(new OtherAssignActivityNodeInfo$1(item.activityDefinitionId, item.condition, item.required));
            }
        }
        catch (e_4_1) { e_4 = { error: e_4_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_4) throw e_4.error; }
        }
        /** @type {?} */
        var object = { value: this.otherAssignActivityNodeInfos, parameters: null };
        this.submitModal.emit(object);
    };
    /**
     * @return {?}
     */
    AssignScopeComponent.prototype.clickCancel = /**
     * @return {?}
     */
    function () {
        this.closeModal.emit();
    };
    /**
     * @return {?}
     */
    AssignScopeComponent.prototype.actionsSelect = /**
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var selections = this.actionsTable1.checkeds;
        if (selections && selections.length > 0) {
            selections.forEach((/**
             * @param {?} action
             * @return {?}
             */
            function (action) {
                /** @type {?} */
                var item = new DisplayInfor(action.data.Name, action.data.Id);
                /** @type {?} */
                var index = _this.listItems.findIndex((/**
                 * @param {?} act
                 * @return {?}
                 */
                function (act) { return act.activityDefinitionId === action.data.Id; }));
                if (index > -1) {
                    _this.listItems.splice(index, 1);
                }
                _this.listItems.push(item);
            }));
            this.grid.loadData(this.listItems);
        }
        // 2023-6-13 关闭前清空已选数据
        this.actionsTable1.clearCheckeds(true);
        this.actionsDialog1.close();
    };
    /**
     * @return {?}
     */
    AssignScopeComponent.prototype.SelectCancel = /**
     * @return {?}
     */
    function () {
        // 2023-6-13 关闭前清空已选数据
        this.actionsTable1.clearCheckeds(true);
        this.actionsDialog1.close();
    };
    /**
     * @param {?} e
     * @return {?}
     */
    AssignScopeComponent.prototype.editConditon = /**
     * @param {?} e
     * @return {?}
     */
    function (e) {
        var _this = this;
        var e_5, _a, e_6, _b, e_7, _c, e_8, _d;
        /** @type {?} */
        var context = new Array();
        // if(this.expr.exprEntity.contextEntities.find(x => x.key === 'CurrentLanguage')) {
        //   context.push(this.expr.exprEntity.contextEntities.find(x => x.key === 'CurrentLanguage'));
        // }
        // this.expr.clearContext();
        if (this.uistate.schemas.length > 0) {
            try {
                for (var _e = __values(this.uistate.schemas), _f = _e.next(); !_f.done; _f = _e.next()) {
                    var schema = _f.value;
                    this.exprService.addSchema('Schema', schema);
                }
            }
            catch (e_5_1) { e_5 = { error: e_5_1 }; }
            finally {
                try {
                    if (_f && !_f.done && (_a = _e.return)) _a.call(_e);
                }
                finally { if (e_5) throw e_5.error; }
            }
            if (this.uistate.schemas[0].entityTypes && this.uistate.schemas[0].entityTypes.length > 0) {
                /** @type {?} */
                var entityType = this.uistate.schemas[0].entityTypes[0];
                this.exprService.addInjectedEntity(entityType.name, 'Schema', entityType.name, InjectedType.EntityType);
            }
        }
        context = this.uistate.addContext(context);
        if (this.uistate.subActivityContext.length > 0) {
            var _loop_3 = function (variable) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    context.push(variable);
                }
            };
            try {
                for (var _g = __values(this.uistate.subActivityContext), _h = _g.next(); !_h.done; _h = _g.next()) {
                    var variable = _h.value;
                    _loop_3(variable);
                }
            }
            catch (e_6_1) { e_6 = { error: e_6_1 }; }
            finally {
                try {
                    if (_h && !_h.done && (_b = _g.return)) _b.call(_g);
                }
                finally { if (e_6) throw e_6.error; }
            }
        }
        if (this.uistate.activityComponentContext.length > 0) {
            var _loop_4 = function (variable) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    context.push(variable);
                }
            };
            try {
                for (var _j = __values(this.uistate.activityComponentContext), _k = _j.next(); !_k.done; _k = _j.next()) {
                    var variable = _k.value;
                    _loop_4(variable);
                }
            }
            catch (e_7_1) { e_7 = { error: e_7_1 }; }
            finally {
                try {
                    if (_k && !_k.done && (_c = _j.return)) _c.call(_j);
                }
                finally { if (e_7) throw e_7.error; }
            }
        }
        if (context.length > 0) {
            try {
                for (var context_1 = __values(context), context_1_1 = context_1.next(); !context_1_1.done; context_1_1 = context_1.next()) {
                    var v = context_1_1.value;
                    this.exprService.addContext(v);
                }
            }
            catch (e_8_1) { e_8 = { error: e_8_1 }; }
            finally {
                try {
                    if (context_1_1 && !context_1_1.done && (_d = context_1.return)) _d.call(context_1);
                }
                finally { if (e_8) throw e_8.error; }
            }
        }
        this.exprService.setEditPattern(ExprEditMode.Conditional);
        this.exprService.addExpressionText(e.instance.value);
        this.exprService.buildExpression().then((/**
         * @param {?} cond
         * @return {?}
         */
        function (cond) {
            e.formControl.setValue(cond);
            e.instance.cd.detectChanges();
            //点击确定后，去除表达式里面的新增的上下文变量
            if (context.length > 0) {
                _this.exprService.exprEntity.contextEntities = _this.exprService.exprEntity.contextEntities.filter((/**
                 * @param {?} x
                 * @return {?}
                 */
                function (x) { return !context.some((/**
                 * @param {?} y
                 * @return {?}
                 */
                function (y) { return y.key === x.key; })); }));
            }
        }));
    };
    AssignScopeComponent.decorators = [
        { type: Component, args: [{
                    selector: 'lib-assign-scope',
                    template: "<div class=\"f-page\">\r\n  <section class=\"f-page-main d-flex flex-column\">\r\n    <farris-section class=\"pt-0 f-section-grid f-section-in-managelist\" mainTitle=\"{{'component.assignScope.set'|wfLocale}}\" [enableAccordion]=\"''\"\r\n      [enableMaximize]=\"false\" [fill]=\"true\">\r\n      <ng-template farrisSectionToolbar>\r\n        <button class=\"btn btn-secondary mr-2\" (click)=\"actionsDialog1.show()\">{{'component.assignScope.add'|wfLocale}}</button>\r\n        <button class=\"btn btn-secondary mr-2\" (click)=\"delete()\">{{'component.assignScope.delete'|wfLocale}}</button>\r\n        <button class=\"btn btn-secondary mr-2\" (click)=\"moveUp()\">{{'component.assignScope.moveUp'|wfLocale}}</button>\r\n        <button class=\"btn btn-secondary\" (click)=\"moveDown()\">{{'component.assignScope.moveDown'|wfLocale}}</button>\r\n      </ng-template>\r\n      <div class=\"f-utils-fill-flex-column farris-overflow-y-auto h-100\" style=\"border-radius:16px;border: 1.5px solid #F1F3F7;\">\r\n        <farris-datagrid class=\"f-component-grid\" [columns]=\"cols\" [data]=\"listItems\" #grid [idField]=\"'activityDefinitionId'\" [showLineNumber]=\"true\"\r\n          [striped]=\"true\" [multiSelect]=\"true\" [editMode]=\"'cell'\"\r\n          [checkOnSelect]=\"true\" [selectOnCheck]=\"true\"  [pagination]=\"false\" [fit]=\"true\" [fitColumns]=\"true\" [editable]=\"true\"\r\n          (selectChanged)=\"selectionChange($event)\">\r\n        </farris-datagrid>\r\n      </div>\r\n    </farris-section>\r\n  </section>\r\n</div>\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type=\"button\" class=\"btn btn-secondary btn-sm px-3\" (click)=\"clickCancel()\">{{'component.assignScope.clickCancel' | wfLocale}}</button>\r\n  <button type=\"button\" class=\"btn btn-primary btn-sm px-3 mx-2\" (click)=\"clickOK()\">{{'component.assignScope.clickOK' | wfLocale}}</button>\r\n</ng-template>\r\n\r\n<ng-template #buttonRef>\r\n  <button class=\"btn btn-sm btn-default px-3\" (click)=\"SelectCancel()\">{{'component.approvelItems.clickCancel' | wfLocale}}</button>\r\n  <button class=\"btn btn-sm btn-primary px-3\" (click)=\"actionsSelect()\">{{'component.approvelItems.clickOK' | wfLocale}}</button>\r\n</ng-template>\r\n<farris-dialog #actionsDialog1 [buttons]=\"buttonRef\" [width]=\"700\" [height]=\"520\" title='\u8282\u70B9\u5217\u8868'>\r\n  <!-- 2023-6-1 \u89E3\u51B3\u5BA1\u6279\u52A8\u4F5C\u5F39\u7A97\u53CC\u6EDA\u52A8\u6761\u7684\u95EE\u9898 -->\r\n  <div class=\"f-utils-fill-flex-column farris-overflow-y-hidden h-100\" style=\"margin-left: 8px;margin-right: 8px;\">\r\n    <farris-datagrid #actionsTable1 [columns]=\"nodeCols\" [data]=\"items\"\r\n      [idField]=\"'Id'\" [fit]=\"true\" [fitColumns]=\"true\" [pagination]='false' \r\n      [showCheckbox]=\"true\" [multiSelect]=\"true\" [checkOnSelect]=\"true\" [selectOnCheck]=\"true\" [showAllCheckbox]=\"true\" [striped]=\"true\">\r\n    </farris-datagrid>\r\n  </div>\r\n</farris-dialog>\r\n",
                    providers: [
                        WfLocalePipe,
                    ],
                    styles: [""]
                }] }
    ];
    /** @nocollapse */
    AssignScopeComponent.ctorParameters = function () { return [
        { type: ProcessDesignerUIState },
        { type: MessagerService },
        { type: ExpressionService },
        { type: ChangeDetectorRef, decorators: [{ type: Optional }] },
        { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
        { type: undefined, decorators: [{ type: Inject, args: [WF_LANG_RESOURCES,] }] },
        { type: WfLocalePipe, decorators: [{ type: Optional }] }
    ]; };
    AssignScopeComponent.propDecorators = {
        closeModal: [{ type: Output }],
        submitModal: [{ type: Output }],
        modalFooter: [{ type: ViewChild, args: ['iconSelectFooter',] }],
        grid: [{ type: ViewChild, args: ['grid',] }],
        actionsTable1: [{ type: ViewChild, args: ['actionsTable1',] }],
        actionsDialog1: [{ type: ViewChild, args: ['actionsDialog1',] }],
        editorParams: [{ type: Input }],
        value: [{ type: Input }]
    };
    return AssignScopeComponent;
}());
var AssignScopeConverter = /** @class */ (function () {
    function AssignScopeConverter(uistate, localePipe) {
        this.uistate = uistate;
        this.localePipe = localePipe;
        this.actList = new Array();
        this.actList = __spread(this.uistate.userActList.filter((/**
         * @param {?} a
         * @return {?}
         */
        function (a) { return a.AssignmentStrategy === 'ASSIGN'; })));
    }
    /**
     * @param {?} data
     * @return {?}
     */
    AssignScopeConverter.prototype.convertTo = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        if (data && data.length > 0) {
            return this.localePipe.transform("component.assignScope.set");
        }
        else {
            return this.localePipe.transform("component.assignScope.notSet");
        }
    };
    return AssignScopeConverter;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/** @enum {string} */
var UserActivityPropertyKeys = {
    Id: "Id",
    Name: "Name",
    NameLanguage: "NameLanguage",
    ClrTypeID: "ClrTypeID",
    /**
     * 参与者设置
     */
    ParticipantSchemes: 'ParticipantSchemes',
    /**
     * 参与者选项
     */
    ParticipantOptions: 'ParticipantOptions',
    /**
     * 审批项
     */
    ApprovalItems: 'ApprovalItems',
    /**
     * 分配策略
     */
    AssignStrategy: 'AssignStrategy',
    /**
     * 指派规则
     */
    OperatorConfig: 'OperatorConfig',
    /**
     * 完成策略
     */
    CompleteStrategy: 'CompleteStrategy',
    /**
     * 会签规则
     */
    SignRule: 'SignRule',
    /**
     * 多实例设置
     */
    MultiInstanceLoopCharacteristics: 'MultiInstanceLoopCharacteristics',
    /**
     * 允许取回
     */
    Retrievable: 'Retrievable',
    /**
     * 允许征询
     */
    AddSignFrontAble: 'AddSignFrontAble',
    /**
     * 允许加签
     */
    AddSignBehindAble: 'AddSignBehindAble',
    /**
     * 允许知会
     */
    NotifyAble: 'NotifyAble',
    /**
     * 表单定义
     */
    ExecuteForms: 'ExecuteForms',
    /**
     * 是否允许选择目标节点
     */
    SelectTargetAble: 'SelectTargetAble',
    /**
     * 跳转范围
     */
    JumpScope: 'JumpScope',
    /**
     * 驳回规则
     */
    BackWardRule: 'BackWardRule',
    /**
     * 活动构件
     */
    Tools: 'Tools',
    /**
     * 选择后续分支
     */
    SelectBranch: 'SelectBranch',
    /**
     * 活动标题
     */
    wf_TitleExpression: 'wf_TitleExpression',
    /**
     * 默认分支
     */
    Default: 'Default',
    /**
     * 移交范围
     */
    transferScope: 'transferScope',
    /**
     * 隐藏web端待办任务
     */
    DisplayTerminal: 'DisplayTerminal',
    timeLimitControl: 'timeLimitControl',
    anonymousSet: 'anonymousSet',
    variableSettings: 'variableSettings',
    messageNotice: 'messageNotice',
    wf_ExecuteForms_PC: 'wf_ExecuteForms_PC',
    wf_ExecuteForms_Mobile: 'wf_ExecuteForms_Mobile',
    /**
     * 审批要点
     */
    approvalPivotConfig: 'approvalPivotConfig',
    urgeHandleRule: 'urgeHandleRule',
    /**
     * 影像设置
     */
    imageSettings: 'imageSettings',
    checkConditions: 'checkConditions',
    AssignPerformer: 'AssignPerformer',
    wf_CustomizeAction: 'wf_CustomizeAction',
    otherAssignNodes: 'otherAssignNodes',
    otherAssignActivities: 'otherAssignActivities',
    otherAssignActivityNodeInfos: 'OtherAssignActivityNodeInfos',
    ConditionExpression: "ConditionExpression",
    sendBackedTask: "sendBackedTask",
    BizActivityID: "BizActivityID",
};

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var MultiInstanceLoopCharacteristics$1 = /** @class */ (function () {
    function MultiInstanceLoopCharacteristics$$1() {
        this.ClrTypeID = MultiInstanceLoopCharacteristics$$1.Clr_Type_ID;
        this.enable = false;
        this.sequential = false;
        this.loopCardinality = null;
        this.completionCondition = null;
        this.completionConditionRules = new Array();
    }
    MultiInstanceLoopCharacteristics$$1.Clr_Type_ID = 'wf.MultiInstanceLoopCharacteristics';
    return MultiInstanceLoopCharacteristics$$1;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var MultiInstanceLoopCharacteristicsComponent = /** @class */ (function () {
    function MultiInstanceLoopCharacteristicsComponent(resolver, injector, uistate, expr, modalService, message, http, cdr, localeId, resources, localePipe) {
        this.resolver = resolver;
        this.injector = injector;
        this.uistate = uistate;
        this.expr = expr;
        this.modalService = modalService;
        this.message = message;
        this.http = http;
        this.cdr = cdr;
        this.localeId = localeId;
        this.resources = resources;
        this.localePipe = localePipe;
        this.cls = 'farris-main-area flex-column';
        this.groupIcon2 = '<i class="f-icon f-icon-lookup"></i>';
        this.closeModal = new EventEmitter();
        this.submitModal = new EventEmitter();
        this.editorParams = {};
        this.preEnable = false;
        this.preSequential = false;
        this.loopCharacteristics = new MultiInstanceLoopCharacteristics$1();
        this.loopCharacteristicsTemp = null;
        // peopleList: string;
        this.conditionRulesIsSet = this.localePipe.transform('multiInstanceLoopCharacteristics.conditionRulesSet');
        this.bpmnModel = this.uistate.bpmnModel;
        this.modalConfig = {
            title: this.localePipe.transform('multiInstanceLoopCharacteristics.loopCharacteristics'),
            width: 550,
            height: 450,
            showButtons: true
        };
        this.localePipe = this.localePipe || new WfLocalePipe(localeId, resources);
    }
    Object.defineProperty(MultiInstanceLoopCharacteristicsComponent.prototype, "value", {
        set: /**
         * @param {?} v
         * @return {?}
         */
        function (v) {
            var e_1, _a;
            this.loopCharacteristics = new MultiInstanceLoopCharacteristics$1();
            if (v) {
                this.loopCharacteristics.enable = v.enable;
                this.loopCharacteristics.sequential = v.sequential;
                this.preEnable = v.enable;
                this.preSequential = v.sequential;
                if (v.loopCardinality && (v.loopCardinality instanceof Expression) && ((v.loopCardinality).MexExpression)) {
                    this.loopCharacteristics.loopCardinality = ((/** @type {?} */ ((v.loopCardinality).MexExpression))).Value;
                    // this.loopCharacteristics.loopCardinality = this.peopleList;
                }
                if (v.completionConditionRules && v.completionConditionRules.length > 0) {
                    /** @type {?} */
                    var signRuleEntityArray = new Array();
                    try {
                        for (var _b = __values(v.completionConditionRules), _c = _b.next(); !_c.done; _c = _b.next()) {
                            var rule = _c.value;
                            /** @type {?} */
                            var signRule = new CounterSignRule(this.bpmnModel);
                            signRule.ConclusionValue = rule.ConclusionValue;
                            signRule.CalculateType = rule.CalculateType;
                            signRule.ConditionValue = rule.ConditionValue;
                            signRule.WaitAllVotes = rule.WaitAllVotes;
                            if (!signRule.CompletionCondition) {
                                signRule.CompletionCondition = new Condition(this.bpmnModel);
                            }
                            signRule.CompletionCondition.Value = rule.CompletionCondition ? rule.CompletionCondition.Value : null;
                            signRuleEntityArray.push(signRule);
                        }
                    }
                    catch (e_1_1) { e_1 = { error: e_1_1 }; }
                    finally {
                        try {
                            if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                        }
                        finally { if (e_1) throw e_1.error; }
                    }
                    this.loopCharacteristics.completionConditionRules = signRuleEntityArray;
                }
            }
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    MultiInstanceLoopCharacteristicsComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        if (this.editorParams.location && this.editorParams.location == 'activity') {
            this.promptAct = true;
        }
        else {
            this.promptAct = false;
        }
    };
    /**
     * @param {?} data
     * @return {?}
     */
    MultiInstanceLoopCharacteristicsComponent.prototype.loopCardinalityExpr = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        this.showloopCardinalityHelp(data);
    };
    /**
     * @param {?} data
     * @return {?}
     */
    MultiInstanceLoopCharacteristicsComponent.prototype.showloopCardinalityHelp = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        var _this = this;
        this.showExpr();
        if (this.loopCharacteristics.loopCardinality) {
            this.expr.addExpressionText(this.loopCharacteristics.loopCardinality);
        }
        else {
            this.expr.addExpressionText('');
        }
        this.expr.buildExpression().then((/**
         * @param {?} expressionInfo
         * @return {?}
         */
        function (expressionInfo) {
            // this.peopleList = expressionInfo;
            _this.loopCharacteristics.loopCardinality = expressionInfo;
        }));
    };
    /**
     * @return {?}
     */
    MultiInstanceLoopCharacteristicsComponent.prototype.showExpr = /**
     * @return {?}
     */
    function () {
        var e_2, _a, e_3, _b, e_4, _c, e_5, _d;
        // this.expr.clearContext();
        if (this.uistate.schemas.length > 0) {
            try {
                for (var _e = __values(this.uistate.schemas), _f = _e.next(); !_f.done; _f = _e.next()) {
                    var schema = _f.value;
                    // this.expr.addCommonObject(co);
                    this.expr.addSchema('Schema', schema);
                }
            }
            catch (e_2_1) { e_2 = { error: e_2_1 }; }
            finally {
                try {
                    if (_f && !_f.done && (_a = _e.return)) _a.call(_e);
                }
                finally { if (e_2) throw e_2.error; }
            }
            if (this.uistate.schemas[0].entityTypes && this.uistate.schemas[0].entityTypes.length > 0) {
                /** @type {?} */
                var entityType = this.uistate.schemas[0].entityTypes[0];
                this.expr.addInjectedEntity(entityType.name, 'Schema', entityType.name, InjectedType.EntityType);
            }
        }
        /** @type {?} */
        var context = new Array();
        if (this.uistate.procInstContext.length > 0) {
            try {
                for (var _g = __values(this.uistate.procInstContext), _h = _g.next(); !_h.done; _h = _g.next()) {
                    var variable = _h.value;
                    context.push(variable);
                    // this.expr.addContext(variable);
                }
            }
            catch (e_3_1) { e_3 = { error: e_3_1 }; }
            finally {
                try {
                    if (_h && !_h.done && (_b = _g.return)) _b.call(_g);
                }
                finally { if (e_3) throw e_3.error; }
            }
        }
        if (this.uistate.processVariableContext.length > 0) {
            var _loop_1 = function (variable) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    context.push(variable);
                }
            };
            try {
                for (var _j = __values(this.uistate.processVariableContext), _k = _j.next(); !_k.done; _k = _j.next()) {
                    var variable = _k.value;
                    _loop_1(variable);
                }
            }
            catch (e_4_1) { e_4 = { error: e_4_1 }; }
            finally {
                try {
                    if (_k && !_k.done && (_c = _j.return)) _c.call(_j);
                }
                finally { if (e_4) throw e_4.error; }
            }
        }
        if (context.length > 0) {
            try {
                for (var context_1 = __values(context), context_1_1 = context_1.next(); !context_1_1.done; context_1_1 = context_1.next()) {
                    var v = context_1_1.value;
                    this.expr.addContext(v);
                }
            }
            catch (e_5_1) { e_5 = { error: e_5_1 }; }
            finally {
                try {
                    if (context_1_1 && !context_1_1.done && (_d = context_1.return)) _d.call(context_1);
                }
                finally { if (e_5) throw e_5.error; }
            }
        }
    };
    /**
     * @param {?} data
     * @return {?}
     */
    MultiInstanceLoopCharacteristicsComponent.prototype.isEnable = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        var _this = this;
        if (!data) {
            this.loopCharacteristicsTemp = new MultiInstanceLoopCharacteristics$1();
            this.loopCharacteristicsTemp.enable = true;
            this.loopCharacteristicsTemp.sequential = this.loopCharacteristics.sequential;
            this.loopCharacteristicsTemp.loopCardinality = this.loopCharacteristics.loopCardinality;
            this.loopCharacteristicsTemp.completionConditionRules = new Array();
            if (this.loopCharacteristics && this.loopCharacteristics.completionConditionRules) {
                this.loopCharacteristics.completionConditionRules.forEach((/**
                 * @param {?} com
                 * @return {?}
                 */
                function (com) { return _this.loopCharacteristicsTemp.completionConditionRules.push((/** @type {?} */ (com.clone()))); }));
            }
            this.loopCharacteristics = new MultiInstanceLoopCharacteristics$1();
        }
        else {
            if (this.loopCharacteristicsTemp) {
                this.loopCharacteristics.enable = true;
                this.loopCharacteristics.sequential = this.loopCharacteristicsTemp.sequential;
                this.loopCharacteristics.loopCardinality = this.loopCharacteristicsTemp.loopCardinality;
                this.loopCharacteristics.completionConditionRules = new Array();
                if (this.loopCharacteristicsTemp.completionConditionRules) {
                    this.loopCharacteristicsTemp.completionConditionRules.forEach((/**
                     * @param {?} com
                     * @return {?}
                     */
                    function (com) { return _this.loopCharacteristics.completionConditionRules.push((/** @type {?} */ (com.clone()))); }));
                }
                this.loopCharacteristicsTemp = null;
            }
        }
        this.validate(data);
    };
    /**
     * @param {?} data
     * @return {?}
     */
    MultiInstanceLoopCharacteristicsComponent.prototype.validate = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        if (data == true) {
            if (!this.loopCharacteristics.completionConditionRules || this.loopCharacteristics.completionConditionRules.length < 1) {
                this.setCompletionConditionRules(this.loopCharacteristics.completionConditionRules);
            }
        }
    };
    /**
     * @param {?} completionConditionRules
     * @return {?}
     */
    MultiInstanceLoopCharacteristicsComponent.prototype.setCompletionConditionRules = /**
     * @param {?} completionConditionRules
     * @return {?}
     */
    function (completionConditionRules) {
        var _this = this;
        /** @type {?} */
        var dialog;
        /** @type {?} */
        var compFactory = this.resolver.resolveComponentFactory(SignRuleComponent);
        /** @type {?} */
        var compRef = compFactory.create(this.injector);
        compRef.instance.value1 = completionConditionRules;
        // compRef.instance.data = this.loopCharacteristics.completionConditionRules;
        compRef.instance.submitModal.subscribe((/**
         * @param {?} re
         * @return {?}
         */
        function (re) {
            _this.loopCharacteristics.completionConditionRules = re;
            dialog.close();
        }));
        compRef.instance.closeModal.subscribe((/**
         * @param {?} re
         * @return {?}
         */
        function (re) {
            dialog.close();
        }));
        /** @type {?} */
        var modalConfig = {
            title: this.localePipe.transform("multiInstanceLoopCharacteristics.completionConditionRules"),
            width: 800,
            height: 515,
            buttons: compRef.instance.modalFooter1,
            showButtons: true
        };
        dialog = this.modalService.show(compRef, modalConfig);
    };
    /**
     * @return {?}
     */
    MultiInstanceLoopCharacteristicsComponent.prototype.clickOK = /**
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var object = { value: this.loopCharacteristics, parameters: null };
        if (this.preEnable != this.loopCharacteristics.enable || this.preSequential != this.loopCharacteristics.sequential) {
            /** @type {?} */
            var url = "/api/runtime/wf/v1.0/processInstances/runtimeActivityInstances?procDefId=" + this.uistate.procDefId + "&activityDefinitionId=" + this.uistate.propertyData.Id;
            this.http.get(url).subscribe((/**
             * @param {?} re
             * @return {?}
             */
            function (re) {
                if (_this.uistate.time === ProcessTime.rt && re && re.length > 0) {
                    _this.message.info(_this.localePipe.transform('multiInstanceLoopCharacteristics.checkPrompt'));
                }
                else {
                    _this.submitModal.emit(object);
                }
            }));
        }
        else {
            this.submitModal.emit(object);
        }
    };
    /**
     * @return {?}
     */
    MultiInstanceLoopCharacteristicsComponent.prototype.clickCancel = /**
     * @return {?}
     */
    function () {
        this.closeModal.emit();
    };
    MultiInstanceLoopCharacteristicsComponent.decorators = [
        { type: Component, args: [{
                    selector: 'lib-multi-instance-loop-characteristics',
                    template: "<div class=\"f-page\">\r\n  <div class=\"f-utils-fill-flex-column farris-split-section m-2 h-100\">\r\n    <section class=\"f-utils-fill-flex-column h-100\">\r\n      <div class=\"f-utils-fill-flex-column farris-overflow-y-auto h-100\" style=\"border-radius:16px;border: 1.5px solid #F1F3F7;\">\r\n        <div class=\"farris-form form-inline farris-form-inline\">\r\n          <div class=\"col-12 farris-group-auto my-3 pr-5\">\r\n            <div class=\"farris-group-wrap\">\r\n              <div class=\"form-group\">\r\n                <label class=\"col-form-label\">\r\n                  <span class=\"farris-label-text\">{{'multiInstanceLoopCharacteristics.isEnable' | wfLocale}}</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap mr-5\">\r\n                  <farris-switch [(ngModel)]=\"loopCharacteristics.enable\" name=\"enable\" (valueChange)=\"isEnable($event)\"></farris-switch>\r\n                  <div class=\"farris-feedback valid-feedback\"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"col-12 farris-group-auto my-3 pr-5\">\r\n            <div class=\"farris-group-wrap\">\r\n              <div class=\"form-group\">\r\n                <label class=\"col-form-label\">\r\n                  <span class=\"farris-label-text\">{{'multiInstanceLoopCharacteristics.isSequential' | wfLocale}}</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap mr-5\">\r\n                  <farris-switch [(ngModel)]=\"loopCharacteristics.sequential\" name=\"sequential\"></farris-switch>\r\n                  <div class=\"farris-feedback valid-feedback\"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"col-12 farris-group-auto my-3 pr-5\">\r\n            <div class=\"farris-group-wrap\">\r\n              <div class=\"form-group farris-form-group\">\r\n                <label class=\"col-form-label\">\r\n                  <span class=\"farris-label-text\">{{'multiInstanceLoopCharacteristics.loopCardinality' | wfLocale}}</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap ml-1\">\r\n                  <input-group [editable]=\"false\" [enableClear]=\"false\" [customCls]=\"'custom-cls'\" [groupText]=\"groupIcon2\"\r\n                    [(value)]=\"loopCharacteristics.loopCardinality\" (clickHandle)=\"loopCardinalityExpr($event)\">\r\n                  </input-group>\r\n                  <div class=\"farris-feedback valid-feedback\"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"col-12 farris-group-auto my-3 pr-5\">\r\n            <div class=\"farris-group-wrap\">\r\n              <div class=\"form-group farris-form-group\">\r\n                <label class=\"col-form-label\">\r\n                  <span class=\"farris-label-text\"></span>\r\n                </label>\r\n                <div class=\"farris-input-wrap\" style=\"padding-right: 30px;border-radius:15px\">\r\n                  <div class=\"page-friendly-reminder\" style=\"background:#ECF4FF;padding: 0.5rem!important;border-radius:6px\">\r\n                    <div class=\"reminder-message\">\r\n                      <span class=\"reminder-title\">\r\n                        <span class=\"f-icon f-icon-info\">\r\n                        </span>\r\n                        <span class=\"reminder-name\" style=\"padding-left: 0.25rem\">\r\n                        </span>\r\n                      </span>\r\n                      <span class=\"message\" *ngIf=\"promptAct\"><br/>{{'multiInstanceLoopCharacteristics.promptAct1' | wfLocale}}<br/>\r\n                        {{'multiInstanceLoopCharacteristics.promptAct2' | wfLocale}}<br/>\r\n                      </span>\r\n                      <span class=\"message\" *ngIf=\"!promptAct\"><br/>{{'multiInstanceLoopCharacteristics.promptProc1' | wfLocale}}<br/>\r\n                        {{'multiInstanceLoopCharacteristics.promptProc2' | wfLocale}}<br/>\r\n                      </span>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"col-12 farris-group-auto my-3 pr-5\" *ngIf=\"loopCharacteristics.enable\">\r\n            <div class=\"farris-group-wrap\">\r\n              <div class=\"form-group farris-form-group\">\r\n                <label class=\"col-form-label\">\r\n                  <span class=\"farris-label-text\">{{'multiInstanceLoopCharacteristics.completionConditionRules' | wfLocale}}</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap ml-1\">\r\n                  <input-group [editable]=\"false\" [enableClear]=\"false\" [customCls]=\"'custom-cls'\" [groupText]=\"groupIcon2\" \r\n                    [(value)]=\"conditionRulesIsSet\" (clickHandle)=\"setCompletionConditionRules(loopCharacteristics.completionConditionRules)\">\r\n                  </input-group>\r\n                  <div class=\"farris-feedback valid-feedback\"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </section>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type=\"button\" class=\"btn btn-secondary btn-sm\" (click)=\"clickCancel()\">{{'component.timeLimitControl.clickCancel' | wfLocale }}</button>\r\n  <button type=\"button\" class=\"btn btn-primary btn-sm mx-2\" (click)=\"clickOK()\">{{'component.timeLimitControl.clickOK' | wfLocale }}</button>\r\n</ng-template>",
                    providers: [
                        WfLocalePipe,
                    ],
                    styles: [""]
                }] }
    ];
    /** @nocollapse */
    MultiInstanceLoopCharacteristicsComponent.ctorParameters = function () { return [
        { type: ComponentFactoryResolver },
        { type: Injector },
        { type: ProcessDesignerUIState },
        { type: ExpressionService },
        { type: BsModalService },
        { type: MessagerService },
        { type: HttpService },
        { type: ChangeDetectorRef, decorators: [{ type: Optional }] },
        { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
        { type: undefined, decorators: [{ type: Inject, args: [WF_LANG_RESOURCES,] }] },
        { type: WfLocalePipe, decorators: [{ type: Optional }] }
    ]; };
    MultiInstanceLoopCharacteristicsComponent.propDecorators = {
        cls: [{ type: HostBinding, args: ['class',] }],
        closeModal: [{ type: Output }],
        submitModal: [{ type: Output }],
        value: [{ type: Input }],
        editorParams: [{ type: Input }],
        modalFooter: [{ type: ViewChild, args: ['iconSelectFooter',] }],
        cell: [{ type: ViewChild, args: ['cell',] }],
        grid: [{ type: ViewChild, args: ['grid',] }]
    };
    return MultiInstanceLoopCharacteristicsComponent;
}());
var MultiInstanceLoopCharacteristicsConverter = /** @class */ (function () {
    function MultiInstanceLoopCharacteristicsConverter(localePipe) {
        this.localePipe = localePipe;
    }
    /**
     * @param {?} data
     * @return {?}
     */
    MultiInstanceLoopCharacteristicsConverter.prototype.convertTo = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        if (data && ((/** @type {?} */ (data))).enable) {
            return this.localePipe.transform('multiInstanceLoopCharacteristics.set');
        }
        return this.localePipe.transform('multiInstanceLoopCharacteristics.notSet');
    };
    return MultiInstanceLoopCharacteristicsConverter;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var WFFlowElementsViewModel = /** @class */ (function () {
    function WFFlowElementsViewModel(uiState, message, injector, modalService, resolver, localPipe) {
        this.uiState = uiState;
        this.message = message;
        this.injector = injector;
        this.modalService = modalService;
        this.resolver = resolver;
        this.localPipe = localPipe;
    }
    /**
     * 设置流程元素属性框
     * @param obj
     */
    /**
     * 设置流程元素属性框
     * @param {?} obj
     * @return {?}
     */
    WFFlowElementsViewModel.prototype.setFlowElementProperty = /**
     * 设置流程元素属性框
     * @param {?} obj
     * @return {?}
     */
    function (obj) {
        this.uiState.propertyData = obj.propertyData;
        this.uiState.propertyConfig = this.setFlowEleConfig(obj.propertyConfig);
    };
    /**
     * @private
     * @param {?} obj
     * @return {?}
     */
    WFFlowElementsViewModel.prototype.setFlowEleConfig = /**
     * @private
     * @param {?} obj
     * @return {?}
     */
    function (obj) {
        var _this = this;
        /** @type {?} */
        var propertyConfig = [];
        if (obj) {
            obj.forEach((/**
             * @param {?} element
             * @return {?}
             */
            function (element) {
                _this.setFlowEleEntity(element.properties);
                propertyConfig.push(element);
            }));
        }
        return propertyConfig;
    };
    /**
     * @private
     * @param {?} obj
     * @return {?}
     */
    WFFlowElementsViewModel.prototype.setFlowEleEntity = /**
     * @private
     * @param {?} obj
     * @return {?}
     */
    function (obj) {
        var _this = this;
        if (obj && obj.length > 0) {
            obj.forEach((/**
             * @param {?} item
             * @return {?}
             */
            function (item) {
                switch (item.propertyID) {
                    case UserActivityPropertyKeys.Id: // 标识
                        break;
                    case UserActivityPropertyKeys.ConditionExpression: // 条件表达式
                        item.editor = ExpressionEditorComponent;
                        item.converter = new ExpressionEditorConverter(_this.localPipe);
                        item.editorParams = {};
                        break;
                    case UserActivityPropertyKeys.wf_ExecuteForms_PC: // 开始活动的表单构件
                        item.editor = ExecuteFormsComponent;
                        /** @type {?} */
                        var params = {
                            location: 'startActivity',
                            tab: 'web'
                        };
                        item.converter = new ExecuteFormsConverter(params, _this.localPipe);
                        item.editorParams = params;
                        break;
                    case UserActivityPropertyKeys.wf_ExecuteForms_Mobile: // 开始活动的表单构件
                        item.editor = ExecuteFormsComponent;
                        /** @type {?} */
                        var editorParams = {
                            location: 'startActivity',
                            tab: 'mobile'
                        };
                        item.converter = new ExecuteFormsConverter(editorParams, _this.localPipe);
                        item.editorParams = editorParams;
                        break;
                    case UserActivityPropertyKeys.sendBackedTask: // 开始活动的发送驳回任务
                        item.iterator = _this.uiState.boolIterator;
                        break;
                    case UserActivityPropertyKeys.SelectTargetAble: // 允许跳转
                        item.iterator = _this.uiState.boolIterator;
                        break;
                    case UserActivityPropertyKeys.JumpScope: // 跳转规则
                        item.editor = JumpScopeComponent;
                        item.converter = new JumpScopeConverter(_this.localPipe);
                        break;
                    case UserActivityPropertyKeys.Default: // 默认分支
                        item.iterator = _this.uiState.boolIterator;
                        break;
                    case UserActivityPropertyKeys.otherAssignNodes:
                        item.iterator = _this.uiState.boolIterator;
                        break;
                    case UserActivityPropertyKeys.otherAssignActivityNodeInfos:
                        /** @type {?} */
                        var assignScopeParams = {
                            location: 'startActivity',
                        };
                        item.editor = AssignScopeComponent;
                        item.converter = new AssignScopeConverter(_this.uiState, _this.localPipe);
                        item.editorParams = assignScopeParams;
                        break;
                    default:
                        item.editor = ExtendPropertyComponent;
                        item.converter = new ExtendPropertyConverter(_this.localPipe);
                        break;
                }
            }));
        }
    };
    /**
     * 设置审批活动节点的属性框
     * @param obj
     */
    /**
     * 设置审批活动节点的属性框
     * @param {?} obj
     * @param {?} activityType
     * @return {?}
     */
    WFFlowElementsViewModel.prototype.setUserActivityProperty = /**
     * 设置审批活动节点的属性框
     * @param {?} obj
     * @param {?} activityType
     * @return {?}
     */
    function (obj, activityType) {
        if (obj.propertyData.ApprovalItems) {
            this.buildApprovalItems(obj.propertyData.ApprovalItems);
            this.buildCounterSignVariables(obj.propertyData.ApprovalItems);
            this.buildSignRules(obj.propertyData.SignRule); // 设置会签规则的结论名称
        }
        this.uiState.propertyData = obj.propertyData;
        this.uiState.bizActivityId = obj.propertyData.BizActivityID;
        this.uiState.propertyConfig = this.setUserActConfig(obj.propertyConfig, activityType);
    };
    /**
     * @private
     * @param {?} obj
     * @param {?} activityType
     * @return {?}
     */
    WFFlowElementsViewModel.prototype.setUserActConfig = /**
     * @private
     * @param {?} obj
     * @param {?} activityType
     * @return {?}
     */
    function (obj, activityType) {
        var _this = this;
        /** @type {?} */
        var propertyConfig = [];
        if (obj) {
            obj.forEach((/**
             * @param {?} element
             * @return {?}
             */
            function (element) {
                _this.setUserActEntity(element.properties, activityType);
                propertyConfig.push(element);
            }));
        }
        return propertyConfig;
    };
    /**
     * @private
     * @param {?} obj
     * @param {?} activityType
     * @return {?}
     */
    WFFlowElementsViewModel.prototype.setUserActEntity = /**
     * @private
     * @param {?} obj
     * @param {?} activityType
     * @return {?}
     */
    function (obj, activityType) {
        var _this = this;
        if (obj && obj.length > 0) {
            obj.forEach((/**
             * @param {?} item
             * @return {?}
             */
            function (item) {
                switch (item.propertyID) {
                    case UserActivityPropertyKeys.Id: // 标识
                        break;
                    case UserActivityPropertyKeys.ParticipantSchemes: // 参与者
                        item.editor = ParticipantComponent;
                        item.converter = new ParticipantConverter(_this.localPipe);
                        item.editorParams = {
                            nodeType: 'userActivity'
                        };
                        break;
                    case UserActivityPropertyKeys.ParticipantOptions: // 参与者选项
                        item.editor = PerformerOptionsComponent;
                        item.converter = new PerformerOptionsConverter(_this.localPipe);
                        item.editorParams = {
                            location: activityType
                        };
                        break;
                    case UserActivityPropertyKeys.AssignPerformer:
                        item.editor = PerformerComponent;
                        item.converter = new PerformerConverter();
                        item.editorParams = {
                            nodeType: 'userActivity',
                            type: 'assignPerformer'
                        };
                        break;
                    case UserActivityPropertyKeys.wf_ExecuteForms_PC: // 表单定义
                        item.editor = ExecuteFormsComponent;
                        /** @type {?} */
                        var params = {
                            location: 'userActivity',
                            tab: 'web'
                        };
                        item.converter = new ExecuteFormsConverter(params, _this.localPipe);
                        item.editorParams = params;
                        break;
                    case UserActivityPropertyKeys.wf_ExecuteForms_Mobile: // 表单定义
                        item.editor = ExecuteFormsComponent;
                        /** @type {?} */
                        var editorParams = {
                            location: 'userActivity',
                            tab: 'mobile'
                        };
                        item.converter = new ExecuteFormsConverter(editorParams, _this.localPipe);
                        item.editorParams = editorParams;
                        break;
                    case UserActivityPropertyKeys.AssignStrategy: // 分配策略
                        item.editor = AssignStrategyComponent;
                        item.converter = new AssignStrategyConverter(_this.localPipe);
                        break;
                    // case UserActivityPropertyKeys.OperatorConfig: // 指派规则
                    //   item.editor = AssignPerformerConfigComponent;
                    //   item.converter = new AssignConfigConverter();
                    //   break;
                    case UserActivityPropertyKeys.CompleteStrategy: // 完成策略
                        if (_this.uiState.propertyData.AssignStrategy === _this.uiState.assignIterator[2].key) {
                            item.iterator = _this.uiState.completeIterator4Claim; // 分配策略为领用时，完成策略只能是抢占模式
                        }
                        else {
                            item.iterator = _this.uiState.completeIterator;
                        }
                        break;
                    case UserActivityPropertyKeys.SignRule: // 会签规则
                        item.editor = SignRuleComponent;
                        item.converter = new SignRuleConverter(_this.localPipe);
                        item.editorParams = {
                            variables: _this.uiState.counterSignVariables,
                            approvalItems: _this.uiState.approvalItems,
                        };
                        break;
                    case UserActivityPropertyKeys.ApprovalItems: // 审批项
                        item.editor = ApprovelItemsComponent;
                        item.converter = new ApprovelItemsConverter(_this.localPipe);
                        break;
                    case UserActivityPropertyKeys.Retrievable: // 允许取回
                        item.iterator = _this.uiState.boolIterator;
                        break;
                    case UserActivityPropertyKeys.AddSignFrontAble: // 允许征询
                        item.editor = OrganizationPotentialOwnerComponent;
                        item.converter = new OrganizationPotentialOwnerConverter(_this.localPipe);
                        item.editorParams = {
                            nodeType: 'userActivity',
                            tabId: 'approvalProperty',
                        };
                        break;
                    case UserActivityPropertyKeys.AddSignBehindAble: // 允许加签
                        item.editor = OrganizationPotentialOwnerComponent;
                        item.converter = new OrganizationPotentialOwnerConverter(_this.localPipe);
                        item.editorParams = {
                            nodeType: 'userActivity',
                            tabId: 'approvalProperty',
                        };
                        break;
                    case UserActivityPropertyKeys.NotifyAble: // 允许知会
                        item.editor = OrganizationPotentialOwnerComponent;
                        item.converter = new OrganizationPotentialOwnerConverter(_this.localPipe);
                        item.editorParams = {
                            nodeType: 'userActivity',
                            tabId: 'approvalProperty',
                        };
                        break;
                    case UserActivityPropertyKeys.transferScope: // 移交范围
                        item.editor = OrganizationPotentialOwnerComponent;
                        item.converter = new OrganizationPotentialOwnerConverter(_this.localPipe);
                        item.editorParams = {
                            nodeType: 'userActivity',
                            tabId: 'approvalProperty',
                        };
                        break;
                    case UserActivityPropertyKeys.SelectBranch: // 允许指定后续分支
                        item.iterator = _this.uiState.boolIterator;
                        break;
                    case UserActivityPropertyKeys.SelectTargetAble: // 允许跳转
                        if (_this.uiState.propertyData.CompleteStrategy
                            && _this.uiState.propertyData.CompleteStrategy !== _this.uiState.completeIterator[0].key) {
                            item.iterator = _this.uiState.noJump4Sign;
                        }
                        else {
                            item.iterator = _this.uiState.boolIterator;
                        }
                        break;
                    case UserActivityPropertyKeys.JumpScope: // 跳转规则
                        item.editor = JumpScopeComponent;
                        item.converter = new JumpScopeConverter(_this.localPipe);
                        break;
                    case UserActivityPropertyKeys.BackWardRule: // 驳回规则
                        item.editor = BackwardRuleComponent;
                        item.converter = new BackwardRuleConverter(_this.localPipe);
                        item.editorParams = {
                            nodeType: 'UserActivity'
                        };
                        break;
                    case UserActivityPropertyKeys.wf_TitleExpression:
                        item.editor = TitleExpressionComponent;
                        item.converter = new TitleExpressionConverter(_this.localPipe);
                        break;
                    case UserActivityPropertyKeys.Tools: // 活动构件
                        item.editor = ActivityComponentComponent;
                        item.converter = new ActivityComponentConverter(_this.localPipe);
                        item.editorParams = {
                            location: 'activity'
                        };
                        break;
                    case UserActivityPropertyKeys.wf_CustomizeAction: // 活动构件
                        item.editor = CustomizeActionComponent;
                        item.converter = new CustomizeActionConverter(_this.localPipe);
                        break;
                    case UserActivityPropertyKeys.timeLimitControl: // 超时预警
                        item.editor = TimeLimitControlComponent;
                        item.converter = new TimeLimitControlConverter(_this.localPipe);
                        item.editorParams = {
                            location: 'activity'
                        };
                        break;
                    case UserActivityPropertyKeys.MultiInstanceLoopCharacteristics: // 多实例
                        item.editor = MultiInstanceLoopCharacteristicsComponent;
                        item.converter = new MultiInstanceLoopCharacteristicsConverter(_this.localPipe);
                        item.editorParams = {
                            location: 'activity'
                        };
                        break;
                    case UserActivityPropertyKeys.anonymousSet: // 匿名设置
                        item.editor = AnonymousSetComponent;
                        item.converter = new AnonymousSetConverter(_this.localPipe);
                        break;
                    case UserActivityPropertyKeys.variableSettings: // 变量设置
                        item.editor = VariableSettingComponent;
                        item.converter = new VariableSettingConverter(_this.localPipe);
                        break;
                    case UserActivityPropertyKeys.messageNotice: // 消息通知
                        item.editor = MessageNoticeComponent;
                        item.converter = new MessageNoticeConverter(_this.localPipe);
                        item.editorParams = {
                            location: 'activity'
                        };
                        break;
                    case UserActivityPropertyKeys.approvalPivotConfig: // 审批要点
                        item.editor = ApprovalPivotComponent;
                        item.converter = new ApprovalPivotConverter(_this.localPipe);
                        break;
                    case UserActivityPropertyKeys.DisplayTerminal: // 显示终端
                        item.iterator = _this.uiState.displayTerminal;
                        break;
                    case UserActivityPropertyKeys.urgeHandleRule: // 显示终端
                        item.editor = UrgeHandleRuleComponent;
                        item.converter = new UrgeHandleRuleConverter(_this.localPipe);
                        break;
                    case UserActivityPropertyKeys.imageSettings: // 影像设置
                        item.editor = ImageSetComponent;
                        item.converter = new ImageSetConverter(_this.localPipe);
                        break;
                    case UserActivityPropertyKeys.checkConditions:
                        item.editor = CheckConditionComponent;
                        item.converter = new CheckConditionConverter(_this.localPipe);
                        break;
                    case UserActivityPropertyKeys.otherAssignNodes:
                        item.iterator = _this.uiState.boolIterator;
                        break;
                    case UserActivityPropertyKeys.otherAssignActivities:
                    case UserActivityPropertyKeys.otherAssignActivityNodeInfos:
                        item.editor = AssignScopeComponent;
                        /** @type {?} */
                        var assignScopeParams = {
                            location: 'userActivity',
                        };
                        item.editorParams = assignScopeParams;
                        item.converter = new AssignScopeConverter(_this.uiState, _this.localPipe);
                        break;
                    default:
                        item.editor = ExtendPropertyComponent;
                        item.converter = new ExtendPropertyConverter(_this.localPipe);
                        break;
                }
            }));
        }
    };
    /**
     * 创建会签规则变量
     */
    /**
     * 创建会签规则变量
     * @param {?} conclusions
     * @return {?}
     */
    WFFlowElementsViewModel.prototype.buildCounterSignVariables = /**
     * 创建会签规则变量
     * @param {?} conclusions
     * @return {?}
     */
    function (conclusions) {
        var e_1, _a;
        this.uiState.counterSignVariables = [];
        this.uiState.counterSignVariables = this.uiState.counterSignVariables.concat([{
                key: 'nrOfInstances',
                name: '总任务数',
                description: '总任务数'
            }, {
                key: 'nrOfCompletedInstances',
                name: '已完成任务数',
                description: '已完成任务数'
            }
        ]);
        if (conclusions && conclusions.length > 0) {
            try {
                for (var conclusions_1 = __values(conclusions), conclusions_1_1 = conclusions_1.next(); !conclusions_1_1.done; conclusions_1_1 = conclusions_1.next()) {
                    var conclusion = conclusions_1_1.value;
                    /** @type {?} */
                    var variable = new VarEntity();
                    variable.key = "nrOf" + conclusion.Value;
                    variable.name = conclusion.Text + "_\u4EFB\u52A1\u6570";
                    variable.description = conclusion.Text + "_\u4EFB\u52A1\u6570";
                    this.uiState.counterSignVariables.push(variable);
                }
            }
            catch (e_1_1) { e_1 = { error: e_1_1 }; }
            finally {
                try {
                    if (conclusions_1_1 && !conclusions_1_1.done && (_a = conclusions_1.return)) _a.call(conclusions_1);
                }
                finally { if (e_1) throw e_1.error; }
            }
        }
    };
    /**
     * 创建自定义项
     * @param conclusions
     */
    /**
     * 创建自定义项
     * @param {?} conclusions
     * @return {?}
     */
    WFFlowElementsViewModel.prototype.buildApprovalItems = /**
     * 创建自定义项
     * @param {?} conclusions
     * @return {?}
     */
    function (conclusions) {
        var e_2, _a;
        this.uiState.approvalItems = [];
        if (conclusions && conclusions.length > 0) {
            try {
                for (var conclusions_2 = __values(conclusions), conclusions_2_1 = conclusions_2.next(); !conclusions_2_1.done; conclusions_2_1 = conclusions_2.next()) {
                    var item = conclusions_2_1.value;
                    /** @type {?} */
                    var conclusion = new ApprovalItemEntity();
                    conclusion.value = item.Value;
                    conclusion.text = item.Text;
                    conclusion.workFlowAction = item.WorkFlowAction;
                    conclusion.isDefault = item.IsDefault;
                    this.uiState.approvalItems.push(conclusion);
                }
            }
            catch (e_2_1) { e_2 = { error: e_2_1 }; }
            finally {
                try {
                    if (conclusions_2_1 && !conclusions_2_1.done && (_a = conclusions_2.return)) _a.call(conclusions_2);
                }
                finally { if (e_2) throw e_2.error; }
            }
        }
    };
    /**
     * 会签规则绑定审批项名称
     * @param signRules 会签规则
     */
    /**
     * 会签规则绑定审批项名称
     * @private
     * @param {?} signRules 会签规则
     * @return {?}
     */
    WFFlowElementsViewModel.prototype.buildSignRules = /**
     * 会签规则绑定审批项名称
     * @private
     * @param {?} signRules 会签规则
     * @return {?}
     */
    function (signRules) {
        var e_3, _a;
        if (signRules && signRules.length > 0) {
            var _loop_1 = function (signRule) {
                /** @type {?} */
                var approvalItem = this_1.uiState.approvalItems.find((/**
                 * @param {?} item
                 * @return {?}
                 */
                function (item) { return item.value === signRule.ConclusionValue; }));
                if (!approvalItem) {
                    // if (!info) {
                    //   this.message.info('审批项发生改变，请调整会签规则！');
                    //   info = true;
                    // }
                    signRule.ConclusionName = '已删除';
                }
                else {
                    signRule.ConclusionName = approvalItem.text;
                }
            };
            var this_1 = this;
            try {
                // let info = false;
                for (var signRules_1 = __values(signRules), signRules_1_1 = signRules_1.next(); !signRules_1_1.done; signRules_1_1 = signRules_1.next()) {
                    var signRule = signRules_1_1.value;
                    _loop_1(signRule);
                }
            }
            catch (e_3_1) { e_3 = { error: e_3_1 }; }
            finally {
                try {
                    if (signRules_1_1 && !signRules_1_1.done && (_a = signRules_1.return)) _a.call(signRules_1);
                }
                finally { if (e_3) throw e_3.error; }
            }
        }
    };
    WFFlowElementsViewModel.decorators = [
        { type: Injectable }
    ];
    /** @nocollapse */
    WFFlowElementsViewModel.ctorParameters = function () { return [
        { type: ProcessDesignerUIState },
        { type: MessagerService },
        { type: Injector },
        { type: BsModalService },
        { type: ComponentFactoryResolver },
        { type: WfLocalePipe }
    ]; };
    return WFFlowElementsViewModel;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var SaveAsEditComponent = /** @class */ (function () {
    function SaveAsEditComponent(injector, http, message, cdr, localeId, resources, localePipe) {
        var _this = this;
        this.injector = injector;
        this.http = http;
        this.message = message;
        this.cdr = cdr;
        this.localeId = localeId;
        this.resources = resources;
        this.localePipe = localePipe;
        this.submit = new EventEmitter();
        this.cancel = new EventEmitter();
        this.accessLevel = 'public';
        this.isAdministratorConfig = false;
        this.enableAdminOrgAut = false;
        this.dataUri = '/api/runtime/sys/v1.0/sysOrgs';
        this.loadType = 'layerload';
        this.disabled = false;
        // private _organizations: any[];
        // set organizations(data: any[]) {
        //   this._organizations = data;
        //   if (this._organizations && this._organizations.length > 0) {
        //     this.items = this.makeTreeByParent(this._organizations, 'parentId', 'id');
        //   } else {
        //     this.items = new Array();
        //   }
        // }
        // get organizations() {
        //   return this._organizations;
        // }
        this.items = new Array();
        this.accessLevelCollection = [
            { value: 'public', text: this.localePipe.transform('component.saveAsEdit.public') },
            { value: 'private', text: this.localePipe.transform('component.saveAsEdit.private') }
        ];
        this.columns = [
            { title: this.localePipe.transform('component.saveAsEdit.code'), field: 'code', width: '100', searchField: 'code' },
            { title: this.localePipe.transform('component.saveAsEdit.name'), field: 'name', width: '100', searchField: 'name' },
        ];
        this.dictPicking = (/**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            _this.lookUp.http = {
                getData: (/**
                 * @param {?} uri
                 * @param {?} params
                 * @return {?}
                 */
                function (uri, params) {
                    console.log(params);
                    /** @type {?} */
                    var searchValue = JSON.parse(params.searchValue);
                    /** @type {?} */
                    var parent = searchValue.parentId;
                    /** @type {?} */
                    var param;
                    if (_this.lookUp._searchState && _this.lookUp._searchState.field && _this.lookUp._searchState.value) {
                        if (_this.lookUp._searchState.field === '*') {
                            param = { codeOrName: _this.lookUp._searchState.value };
                        }
                        else if (_this.lookUp._searchState.field === 'name') {
                            param = { name: _this.lookUp._searchState.value };
                        }
                        else {
                            param = { code: _this.lookUp._searchState.value };
                        }
                    }
                    /** @type {?} */
                    var filter;
                    if (_this.isAdministratorConfig) {
                        filter = _this.administrator.administratorAuthorities.map((/**
                         * @param {?} a
                         * @return {?}
                         */
                        function (a) { return ({
                            id: a.organization, rule: a.includeSubordinate ? 'SelectedAndChild' : 'Selected'
                        }); }));
                    }
                    return _this.getSysOrgs(parent, param, filter).pipe(switchMap((/**
                     * @param {?} re
                     * @return {?}
                     */
                    function (re) {
                        console.log(re);
                        return of$1((/** @type {?} */ ({
                            columns: _this.columns,
                            displayInfo: { idField: 'id', valueField: 'id', textField: 'name' },
                            displayType: 'TreeList',
                            idField: 'id',
                            valueField: 'id',
                            textField: 'name',
                            searchFields: [
                                { label: 'code', value: 'code' }, { label: 'name', value: 'name' }
                            ],
                            title: _this.localePipe.transform('component.saveAsEdit.organization'),
                            total: 0,
                            treeInfo: {
                                dataField: 'treeinfo',
                                isDetailField: 'isDetail',
                                layerField: 'layer',
                                layerType: 'parentId',
                                loadDataType: 'async',
                                onlySelectLeaf: false,
                                parentField: 'parentElement',
                                pathField: 'path',
                                treeDataIsInit: true
                            },
                            items: _this.orgTreeData(re, param)
                        })));
                    })));
                })
            };
            return of$1(true);
        });
        this.dictPicked = (/**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            _this.organizationName = data.name;
            _this.organization = data.id;
            return of$1(true);
        });
        this.localePipe = this.localePipe || new WfLocalePipe(localeId, resources);
    }
    /**
     * @return {?}
     */
    SaveAsEditComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
    };
    /**
     * @return {?}
     */
    SaveAsEditComponent.prototype.saveAsOK = /**
     * @return {?}
     */
    function () {
        this.disabled = true;
        if (this.validator()) {
            this.submit.next({
                procName: this.procName,
                accessLevel: this.accessLevel,
                organization: this.organization,
                organizationName: this.organizationName
            });
        }
    };
    /**
     * @return {?}
     */
    SaveAsEditComponent.prototype.saveAsCancel = /**
     * @return {?}
     */
    function () {
        this.cancel.emit();
    };
    /**
     * @return {?}
     */
    SaveAsEditComponent.prototype.validator = /**
     * @return {?}
     */
    function () {
        if (!this.procName) {
            this.message.warning(this.localePipe.transform('component.saveAsEdit.nameNotEmpty'));
            this.disabled = false;
            return false;
        }
        if (!this.organization) {
            this.message.warning(this.localePipe.transform('component.saveAsEdit.organizationNotEmpty'));
            this.disabled = false;
            return false;
        }
        return true;
    };
    /**
     * @param {?} data
     * @return {?}
     */
    SaveAsEditComponent.prototype.search = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        /** @type {?} */
        var tt = (/** @type {?} */ (this.lookUp.componentRef.instance));
        tt.searchHandle.search(data.field, data.value, 'client');
    };
    /**
     * @param {?} data
     * @return {?}
     */
    SaveAsEditComponent.prototype.selectedDataHandler = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        this.organization = data.id;
        this.organizationName = data.name;
    };
    /**
     * @private
     * @param {?} orgs
     * @param {?} searchValue
     * @return {?}
     */
    SaveAsEditComponent.prototype.orgTreeData = /**
     * @private
     * @param {?} orgs
     * @param {?} searchValue
     * @return {?}
     */
    function (orgs, searchValue) {
        var e_1, _a;
        /** @type {?} */
        var result = new Array();
        /** @type {?} */
        var treeData = new Array();
        try {
            for (var orgs_1 = __values(orgs), orgs_1_1 = orgs_1.next(); !orgs_1_1.done; orgs_1_1 = orgs_1.next()) {
                var org = orgs_1_1.value;
                /** @type {?} */
                var entity = {};
                entity.data = org;
                entity.children = [];
                entity.id = org.id;
                entity.leaf = org.isDetail;
                entity.selectable = org.farris_selectable;
                treeData.push(entity);
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (orgs_1_1 && !orgs_1_1.done && (_a = orgs_1.return)) _a.call(orgs_1);
            }
            finally { if (e_1) throw e_1.error; }
        }
        /** @type {?} */
        var obj = {};
        // 使用对象重新存储数据
        /** @type {?} */
        var len = treeData.length;
        for (var i = 0; i < len; i++) {
            obj[treeData[i].id] = treeData[i];
        }
        // 遍历数据
        for (var j = 0; j < len; j++) {
            /** @type {?} */
            var data = treeData[j];
            /** @type {?} */
            var parentData = obj[data.data.parentId];
            if (parentData) {
                if (!parentData.children) {
                    parentData.children = new Array();
                }
                parentData.children.push(data);
            }
            else {
                result.push(data);
            }
        }
        // 过滤的情况下，不包含下级的节点设置为叶子节点
        if (searchValue) {
            this.treeIterator(result);
        }
        return result;
    };
    /**
     * @private
     * @param {?} treeData
     * @return {?}
     */
    SaveAsEditComponent.prototype.treeIterator = /**
     * @private
     * @param {?} treeData
     * @return {?}
     */
    function (treeData) {
        var e_2, _a;
        if (treeData && treeData.length > 0) {
            try {
                for (var treeData_1 = __values(treeData), treeData_1_1 = treeData_1.next(); !treeData_1_1.done; treeData_1_1 = treeData_1.next()) {
                    var d = treeData_1_1.value;
                    if (d.children && d.children.length > 0) {
                        this.treeIterator(d.children);
                    }
                    else {
                        d.leaf = true;
                    }
                }
            }
            catch (e_2_1) { e_2 = { error: e_2_1 }; }
            finally {
                try {
                    if (treeData_1_1 && !treeData_1_1.done && (_a = treeData_1.return)) _a.call(treeData_1);
                }
                finally { if (e_2) throw e_2.error; }
            }
        }
    };
    /**
     * @private
     * @param {?} item
     * @param {?} orgs
     * @return {?}
     */
    SaveAsEditComponent.prototype.findChild = /**
     * @private
     * @param {?} item
     * @param {?} orgs
     * @return {?}
     */
    function (item, orgs) {
        var _this = this;
        /** @type {?} */
        var childList = orgs.filter((/**
         * @param {?} childitem
         * @return {?}
         */
        function (childitem) {
            if (childitem.parentId === item.id) {
                return true;
            }
        }));
        if (childList && childList.length > 0) {
            childList.forEach((/**
             * @param {?} child
             * @return {?}
             */
            function (child) {
                /** @type {?} */
                var childEntity = {};
                childEntity.data = child;
                childEntity.children = [];
                childEntity.id = child.id;
                childEntity.leaf = child.isDetail;
                childEntity.selectable = child.farris_selectable;
                item.children.push(childEntity);
                _this.findChild(childEntity, orgs);
            }));
        }
    };
    /** 按照parent码构造树 */
    /**
     * 按照parent码构造树
     * @private
     * @param {?} datas
     * @param {?} parentField
     * @param {?} keyField
     * @return {?}
     */
    SaveAsEditComponent.prototype.makeTreeByParent = /**
     * 按照parent码构造树
     * @private
     * @param {?} datas
     * @param {?} parentField
     * @param {?} keyField
     * @return {?}
     */
    function (datas, parentField, keyField) {
        var _this = this;
        // 上級爲空，或者沒有上級的
        /** @type {?} */
        var pathLayerOnes = datas.filter((/**
         * @param {?} x
         * @return {?}
         */
        function (x) {
            if (!x[parentField]) {
                return true;
            }
            /** @type {?} */
            var p = datas.find((/**
             * @param {?} parent
             * @return {?}
             */
            function (parent) { return parent[keyField] === x[parentField]; }));
            if (!p) {
                return true;
            }
        }));
        /** @type {?} */
        var treedata = [];
        pathLayerOnes.forEach((/**
         * @param {?} x
         * @return {?}
         */
        function (x) {
            /** @type {?} */
            var entity = {};
            entity.data = x;
            entity.children = [];
            treedata.push(entity);
            // this.root = x['id'];
        }));
        treedata.forEach((/**
         * @param {?} item
         * @return {?}
         */
        function (item) {
            _this.findChildrenByParent(item, datas, parentField, keyField);
        }));
        return treedata;
    };
    /** 找到子节点 */
    /**
     * 找到子节点
     * @private
     * @param {?} parent
     * @param {?} datas
     * @param {?} parentField
     * @param {?} keyField
     * @return {?}
     */
    SaveAsEditComponent.prototype.findChildrenByParent = /**
     * 找到子节点
     * @private
     * @param {?} parent
     * @param {?} datas
     * @param {?} parentField
     * @param {?} keyField
     * @return {?}
     */
    function (parent, datas, parentField, keyField) {
        var _this = this;
        /** @type {?} */
        var childList = datas.filter((/**
         * @param {?} childitem
         * @return {?}
         */
        function (childitem) {
            if (childitem[parentField] === parent.data[keyField]) {
                return true;
            }
        }));
        if (childList && childList.length > 0) {
            childList.forEach((/**
             * @param {?} child
             * @return {?}
             */
            function (child) {
                /** @type {?} */
                var childEntity = {};
                childEntity.data = child;
                childEntity.children = [];
                parent.children.push(childEntity);
                _this.findChildrenByParent(childEntity, datas, parentField, keyField);
            }));
        }
    };
    /**
     * @private
     * @param {?} parent
     * @param {?} searchValue
     * @param {?} filter
     * @return {?}
     */
    SaveAsEditComponent.prototype.getSysOrgs = /**
     * @private
     * @param {?} parent
     * @param {?} searchValue
     * @param {?} filter
     * @return {?}
     */
    function (parent, searchValue, filter) {
        /** @type {?} */
        var url = "/api/runtime/sys/v1.0/sysOrgs";
        /** @type {?} */
        var param;
        if (searchValue) {
            param = Object.assign(searchValue, {
                IsSearchTree: true,
                withPermission: true,
                ruleFilter: filter
            });
        }
        else {
            if (parent) {
                param = Object.assign({}, {
                    parentId: parent,
                    withPermission: true,
                    ruleFilter: filter
                });
            }
            else {
                param = Object.assign({}, {
                    parentId: '',
                    layer: 1,
                    withPermission: true,
                    ruleFilter: filter
                });
            }
        }
        url += "?param=" + JSON.stringify(param);
        return this.http.get(url);
    };
    SaveAsEditComponent.decorators = [
        { type: Component, args: [{
                    selector: 'app-save-as-edit',
                    template: "<!-- <div class=\"f-page\">\r\n  <div class=\"f-page-main\">\r\n    <div class=\"d-flex m-2 py-2 farris-row\">\r\n      <div class=\"w-100 px-4\">\r\n        <label class=\"col-form-label\">\r\n          <span class=\"farris-label-text\">\u6D41\u7A0B\u540D\u79F0</span>\r\n        </label>\r\n        <div class=\"farris-input-wrap\">\r\n          <input type=\"text\" class=\"form-control\" [(ngModel)]=\"procName\" name=\"procName\" />\r\n          <div class=\"farris-feedback valid-feedback\"></div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=\"d-flex m-2 py-2 farris-row\">\r\n      <div class=\"px-4 w-100\">\r\n        <label class=\"col-form-label\">\r\n          <span class=\"farris-label-text\">\u6D41\u7A0BKey\u503C</span>\r\n        </label>\r\n        <div class=\"farris-input-wrap\">\r\n          <input type=\"text\" class=\"form-control\" [(ngModel)]=\"procKey\" name=\"procKey\" [readonly]=\"true\" />\r\n          <div class=\"farris-feedback valid-feedback\"></div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div> -->\r\n\r\n<div class=\"f-page f-page-card f-page-is-mainsubcard\">\r\n  <section class=\"f-page-main\">\r\n    <!--\u4E0D\u786E\u8BA4---------------------------\u5361\u7247\u7EC4\u4EF6\u4E0D\u540C\u7684Section\u662F\u5728\u4E0D\u540C\u7684\u7EC4\u4EF6\u91CC\uFF0C\u8FD8\u662F\u5728\u540C\u4E00\u4E2A\u5361\u7247\u7EC4\u4EF6\u91CC-->\r\n    <!--\u8868\u5355\u533A\u57DF-->\r\n    <!--\u9700\u8981\u5D4C\u5957\u7684\u5C42---------------------------IDE\u8F6C\u5316\u6210\u7EC4\u4EF6----------->\r\n    <div class=\"f-struct-wrapper\">\r\n      <farris-section class=\"f-section-form f-section-in-mainsubcard\" [enableAccordion]=\"''\" mainTitle=\"{{'component.saveAsEdit.basicAttributes'|wfLocale}}\"\r\n        [subTitle]=\"''\" [enableMaximize]=\"false\">\r\n\r\n        <!--\u8F93\u5165\u63A7\u4EF6 \u6CA1\u6709\u5206\u7EC4-->\r\n        <div class=\"f-form-layout farris-form farris-form-controls-inline pr-4 m-2\">\r\n          <div class=\"col-12 px-0 my-2\">\r\n            <div class=\"farris-group-wrap\">\r\n              <div class=\"form-group farris-form-group\">\r\n                <label class=\"col-form-label\">\r\n                  <span class=\"farris-label-info text-danger\">*</span>\r\n                  <span class=\"farris-label-text\">{{'component.saveAsEdit.processName' | wfLocale}}</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap\">\r\n                  <input type=\"text\" class=\"form-control\" [(ngModel)]=\"procName\" name=\"procName\" />\r\n                  <div class=\"farris-feedback valid-feedback\"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"col-12 px-0 my-2\">\r\n            <div class=\"farris-group-wrap\">\r\n              <div class=\"form-group farris-form-group\">\r\n                <label class=\"col-form-label\">\r\n                  <span class=\"farris-label-text\">{{'component.saveAsEdit.processKeyValue' | wfLocale}}</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap\">\r\n                  <input type=\"text\" class=\"form-control\" [(ngModel)]=\"procKey\" name=\"procKey\" [readonly]=\"true\" />\r\n                  <div class=\"farris-feedback valid-feedback\"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"col-12 px-0 my-2\">\r\n            <div class=\"farris-group-wrap\">\r\n              <div class=\"form-group farris-form-group\">\r\n                <label class=\"col-form-label\">\r\n                  <span class=\"farris-label-info text-danger\">*</span>\r\n                  <span class=\"farris-label-text\">{{'component.saveAsEdit.maintenanceOrg' | wfLocale}}</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap\">\r\n                  <farris-lookup-grid *ngIf=\"!enableAdminOrgAut; else adminOrg\" #lookup [(ngModel)]=\"organizationName\" name=\"orgName\"\r\n                    [singleSelect]=\"true\" [dictPicked]=\"dictPicked\"\r\n                    [enableClear]=\"false\"\r\n                    [editable]=\"false\"\r\n                    [dictPicking]=\"dictPicking\"\r\n                    [uri]=\"dataUri\"\r\n                    [loadTreeDataType]=\"loadType\">\r\n                  </farris-lookup-grid>\r\n                  <div class=\"farris-feedback valid-feedback\"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"col-12 px-0 my-2\">\r\n            <div class=\"farris-group-wrap\">\r\n              <div class=\"form-group farris-form-group\">\r\n                <label class=\"col-form-label\">\r\n                  <span class=\"farris-label-info text-danger\">*</span>\r\n                  <span class=\"farris-label-text\">{{'component.saveAsEdit.accessLevel' | wfLocale}}</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap\">\r\n                  <farris-combo-list [(ngModel)]=\"accessLevel\" name=\"accessLevel\"\r\n                    [ngModelOptions]=\"{standalone: true}\" [idField]=\"'value'\" [textField]=\"'text'\"\r\n                    [valueField]=\"'value'\" [data]=\"accessLevelCollection\" [panelHeight]=\"'auto'\" [enableClear]=\"false\">\r\n                  </farris-combo-list>\r\n                  <div class=\"farris-feedback valid-feedback\"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </farris-section>\r\n    </div>\r\n  </section>\r\n</div>\r\n\r\n<ng-template #buttonRef>\r\n  <button type=\"button\" class=\"btn btn-secondary btn-sm mx-2\" (click)=\"saveAsCancel()\">{{'component.saveAsEdit.saveAsCancel' | wfLocale}}</button>\r\n  <button type=\"button\" class=\"btn btn-sm btn-primary mx-2\" [disabled]=\"disabled\" (click)=\"saveAsOK()\">{{'component.saveAsEdit.saveAsOK' | wfLocale}}</button>\r\n</ng-template>\r\n\r\n\r\n<ng-template #adminOrg>\r\n  <farris-lookup-grid #adminOrgLookup [(ngModel)]=\"organizationName\" name=\"adminOrgName\"\r\n    [helpId]=\"'processdesigneradminorgdataaut'\" [enableClear]=\"false\" [editable]=\"false\"\r\n    [singleSelect]=\"true\" [uri]=\"'assets/data/tree-list-help.json'\" (selectedData)=\"selectedDataHandler($event)\">\r\n  </farris-lookup-grid>\r\n</ng-template>\r\n",
                    providers: [
                        { provide: ServerSideToken, useClass: LookupDataService },
                        WfLocalePipe,
                    ],
                    styles: [""]
                }] }
    ];
    /** @nocollapse */
    SaveAsEditComponent.ctorParameters = function () { return [
        { type: Injector },
        { type: HttpService },
        { type: MessagerService },
        { type: ChangeDetectorRef, decorators: [{ type: Optional }] },
        { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
        { type: undefined, decorators: [{ type: Inject, args: [WF_LANG_RESOURCES,] }] },
        { type: WfLocalePipe, decorators: [{ type: Optional }] }
    ]; };
    SaveAsEditComponent.propDecorators = {
        btnRef: [{ type: ViewChild, args: ['buttonRef',] }],
        procName: [{ type: Input }],
        procKey: [{ type: Input }],
        lookUp: [{ type: ViewChild, args: ['lookup',] }],
        submit: [{ type: Output }],
        cancel: [{ type: Output }]
    };
    return SaveAsEditComponent;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/** @enum {string} */
var BillSourceType = {
    InheritParent: 'SameWithParent',
    VariablesExpression: 'VariablesExpression',
    AutoCreation: 'AutoGenerateDownBill',
};

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/** @enum {string} */
var SubProcessType = {
    Dynamic: "Dynamic",
    Specified: "Specified",
};

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var CallActivitySubProcess$1 = /** @class */ (function () {
    function CallActivitySubProcess$$1() {
        this.subProcessType = SubProcessType.Specified;
        this.billSourceType = BillSourceType.InheritParent;
    }
    return CallActivitySubProcess$$1;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var BifMonitorConstant = /** @class */ (function () {
    function BifMonitorConstant() {
    }
    BifMonitorConstant.bifMonitorAppId = "BillIntegrationFrameworkRT";
    BifMonitorConstant.bifManagerAppEntrance = "bif-manager";
    BifMonitorConstant.bifDiagnostorFuncId = "BifDiagnostor";
    BifMonitorConstant.bifManagerFuncId = "BifManager";
    return BifMonitorConstant;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/** @enum {string} */
var BifMetadataType = {
    BifCreationProcess: "BifCreationProcess",
    BifWritebackProcess: "BifWritebackProcess",
};

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/**
 * @abstract
 */
var /**
 * @abstract
 */
AbstractShowEntity = /** @class */ (function (_super) {
    __extends(AbstractShowEntity, _super);
    function AbstractShowEntity() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this.sysInit = false;
        return _this;
    }
    /**
     * @protected
     * @return {?}
     */
    AbstractShowEntity.prototype.ResetBeforeLoadFrom = /**
     * @protected
     * @return {?}
     */
    function () {
        _super.prototype.ResetBeforeLoadFrom.call(this);
        this.id = null;
        this.code = null;
        this.name = null;
        this.upBillVoName = null;
        this.downBillVoName = null;
        this.parentId = null;
        this.bifMetadataType = null;
        this.lastModifiedTime = null;
        this.sysInit = false;
        this.originId = null;
        this.rootId = null;
    };
    /**
     * @return {?}
     */
    AbstractShowEntity.prototype.ConvertToJsonObject = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var obj = _super.prototype.ConvertToJsonObject.call(this);
        BpmnModelJsonHelper.SetAttributeValue(obj, "id", this.id);
        BpmnModelJsonHelper.SetAttributeValue(obj, "code", this.code);
        BpmnModelJsonHelper.SetAttributeValue(obj, "name", this.name);
        BpmnModelJsonHelper.SetAttributeValue(obj, "upBillVoName", this.upBillVoName);
        BpmnModelJsonHelper.SetAttributeValue(obj, "downBillVoName", this.downBillVoName);
        BpmnModelJsonHelper.SetAttributeValue(obj, "parentId", this.parentId);
        BpmnModelJsonHelper.SetAttributeValue(obj, "bifMetadataType", this.bifMetadataType);
        BpmnModelJsonHelper.SetAttributeValue(obj, "lastModifiedTime", this.lastModifiedTime);
        BpmnModelJsonHelper.SetAttributeValue(obj, "sysInit", this.sysInit);
        BpmnModelJsonHelper.SetAttributeValue(obj, "originId", this.originId);
        BpmnModelJsonHelper.SetAttributeValue(obj, "rootId", this.rootId);
        return obj;
    };
    /**
     * @param {?} obj
     * @return {?}
     */
    AbstractShowEntity.prototype.LoadFromJsonObject = /**
     * @param {?} obj
     * @return {?}
     */
    function (obj) {
        _super.prototype.LoadFromJsonObject.call(this, obj);
        this.id = BpmnModelJsonHelper.GetAttributeValueAsString(obj, "id");
        this.code = BpmnModelJsonHelper.GetAttributeValueAsString(obj, "code");
        this.name = BpmnModelJsonHelper.GetAttributeValueAsString(obj, "name");
        this.upBillVoName = BpmnModelJsonHelper.GetAttributeValueAsString(obj, "upBillVoName");
        this.downBillVoName = BpmnModelJsonHelper.GetAttributeValueAsString(obj, "downBillVoName");
        this.parentId = BpmnModelJsonHelper.GetAttributeValueAsString(obj, "parentId");
        this.bifMetadataType = BifMetadataType[BpmnModelJsonHelper.GetAttributeValueAsString(obj, "bifMetadataType")];
        this.lastModifiedTime = BpmnModelJsonHelper.GetAttributeValueAsDateTime(obj, "lastModifiedTime");
        this.sysInit = BpmnModelJsonHelper.GetAttributeValueAsBoolean(obj, "sysInit");
        this.originId = BpmnModelJsonHelper.GetAttributeValueAsString(obj, "originId");
        this.rootId = BpmnModelJsonHelper.GetAttributeValueAsString(obj, "rootId");
    };
    return AbstractShowEntity;
}(JsonConvertableImpl));

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var RtShowEntity = /** @class */ (function (_super) {
    __extends(RtShowEntity, _super);
    function RtShowEntity() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    /**
     * @protected
     * @return {?}
     */
    RtShowEntity.prototype.ResetBeforeLoadFrom = /**
     * @protected
     * @return {?}
     */
    function () {
        _super.prototype.ResetBeforeLoadFrom.call(this);
        this.isEnabled = false;
    };
    /**
     * @return {?}
     */
    RtShowEntity.prototype.ConvertToJsonObject = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var obj = _super.prototype.ConvertToJsonObject.call(this);
        BpmnModelJsonHelper.SetAttributeValue(obj, "isEnabled", this.isEnabled);
        return obj;
    };
    /**
     * @param {?} obj
     * @return {?}
     */
    RtShowEntity.prototype.LoadFromJsonObject = /**
     * @param {?} obj
     * @return {?}
     */
    function (obj) {
        _super.prototype.LoadFromJsonObject.call(this, obj);
        this.isEnabled = BpmnModelJsonHelper.GetAttributeValueAsBoolean(obj, "isEnabled");
    };
    return RtShowEntity;
}(AbstractShowEntity));

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var RtShowEntitiesWithCustomization = /** @class */ (function (_super) {
    __extends(RtShowEntitiesWithCustomization, _super);
    function RtShowEntitiesWithCustomization() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this.customizationEntities = new Array();
        return _this;
    }
    /**
     * @protected
     * @return {?}
     */
    RtShowEntitiesWithCustomization.prototype.ResetBeforeLoadFrom = /**
     * @protected
     * @return {?}
     */
    function () {
        _super.prototype.ResetBeforeLoadFrom.call(this);
        this.isEnabled = false;
        this.customizationEntities.length = 0;
    };
    /**
     * @return {?}
     */
    RtShowEntitiesWithCustomization.prototype.ConvertToJsonObject = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var obj = _super.prototype.ConvertToJsonObject.call(this);
        BpmnModelJsonHelper.SetAttributeValue(obj, "isEnabled", this.isEnabled);
        BpmnModelJsonHelper.SetAttributeValue(obj, "customizationEntities", this.customizationEntities);
        return obj;
    };
    /**
     * @param {?} obj
     * @return {?}
     */
    RtShowEntitiesWithCustomization.prototype.LoadFromJsonObject = /**
     * @param {?} obj
     * @return {?}
     */
    function (obj) {
        _super.prototype.LoadFromJsonObject.call(this, obj);
        this.isEnabled = BpmnModelJsonHelper.GetAttributeValueAsBoolean(obj, "isEnabled");
        this.customizationEntities = BpmnModelJsonHelper.GetAttributeValueAsList(obj, "customizationEntities", RtShowEntitiesWithCustomization);
    };
    /**
     * @protected
     * @return {?}
     */
    RtShowEntitiesWithCustomization.prototype.getTClass = /**
     * @protected
     * @return {?}
     */
    function () {
        return RtShowEntitiesWithCustomization;
    };
    return RtShowEntitiesWithCustomization;
}(RtShowEntity));

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var RtBillProcessListResult = /** @class */ (function (_super) {
    __extends(RtBillProcessListResult, _super);
    function RtBillProcessListResult() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this.entities = new Array();
        return _this;
    }
    /**
     * @protected
     * @return {?}
     */
    RtBillProcessListResult.prototype.ResetBeforeLoadFrom = /**
     * @protected
     * @return {?}
     */
    function () {
        _super.prototype.ResetBeforeLoadFrom.call(this);
        this.totalCount = 0;
        this.pageCount = 0;
        this.pageIndex = 0;
        this.pageSize = 0;
        this.entities.length = 0;
    };
    /**
     * @return {?}
     */
    RtBillProcessListResult.prototype.ConvertToJsonObject = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var obj = _super.prototype.ConvertToJsonObject.call(this);
        BpmnModelJsonHelper.SetAttributeValue(obj, "totalCount", this.totalCount);
        BpmnModelJsonHelper.SetAttributeValue(obj, "pageCount", this.pageCount);
        BpmnModelJsonHelper.SetAttributeValue(obj, "pageIndex", this.pageIndex);
        BpmnModelJsonHelper.SetAttributeValue(obj, "pageSize", this.pageSize);
        BpmnModelJsonHelper.SetAttributeValue(obj, "entities", this.entities);
        return obj;
    };
    /**
     * @param {?} obj
     * @return {?}
     */
    RtBillProcessListResult.prototype.LoadFromJsonObject = /**
     * @param {?} obj
     * @return {?}
     */
    function (obj) {
        _super.prototype.LoadFromJsonObject.call(this, obj);
        this.totalCount = BpmnModelJsonHelper.GetAttributeValueAsNumber(obj, "totalCount");
        this.pageCount = BpmnModelJsonHelper.GetAttributeValueAsNumber(obj, "pageCount");
        this.pageIndex = BpmnModelJsonHelper.GetAttributeValueAsNumber(obj, "pageIndex");
        this.pageSize = BpmnModelJsonHelper.GetAttributeValueAsNumber(obj, "pageSize");
        this.entities = BpmnModelJsonHelper.GetAttributeValueAsList(obj, "entities", RtShowEntitiesWithCustomization);
    };
    return RtBillProcessListResult;
}(JsonConvertableImpl));

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var ProcessListHelpService = /** @class */ (function () {
    function ProcessListHelpService(appService, frameworkService, httpService) {
        this.appService = appService;
        this.frameworkService = frameworkService;
        this.httpService = httpService;
        this.baseUrl = "/api/runtime/aif/v1.0/rtbillprocess";
    }
    /**
     * @param {?} entity
     * @return {?}
     */
    ProcessListHelpService.prototype.openBifManagerApp = /**
     * @param {?} entity
     * @return {?}
     */
    function (entity) {
        /** @type {?} */
        var map$$1 = new Map();
        map$$1.set("id", entity.id);
        map$$1.set("type", entity.bifMetadataType);
        map$$1.set("srcFuncId", BifMonitorConstant.bifDiagnostorFuncId);
        /** @type {?} */
        var opt = {
            funcId: BifMonitorConstant.bifManagerFuncId,
            appId: BifMonitorConstant.bifMonitorAppId,
            appEntrance: BifMonitorConstant.bifManagerAppEntrance,
            appType: "menu",
            entityParams: {},
            queryStringParams: map$$1,
            tabId: entity.id,
            tabName: entity.name
        };
        this.frameworkService.openMenu(opt);
    };
    /**
     * @param {?} args
     * @return {?}
     */
    ProcessListHelpService.prototype.getDatagridData = /**
     * @param {?} args
     * @return {?}
     */
    function (args) {
        /** @type {?} */
        var body = args.ConvertToJson();
        /** @type {?} */
        var data$ = null;
        //有业务种类参数时不分页
        if (args.bizType != null) {
            data$ = this.httpService.post(this.baseUrl + "/getpatch", body);
            return data$.pipe(map((/**
             * @param {?} res
             * @return {?}
             */
            function (res) {
                /** @type {?} */
                var listRes = new RtBillProcessListResult();
                listRes.entities = res.map((/**
                 * @param {?} elt
                 * @return {?}
                 */
                function (elt) {
                    /** @type {?} */
                    var e = new RtShowEntity();
                    e.LoadFromJsonObject(elt);
                    return e;
                }));
                return listRes;
            })));
        }
        else {
            data$ = this.httpService.post(this.baseUrl + "/getpagedpatch", body);
            return data$.pipe(map((/**
             * @param {?} res
             * @return {?}
             */
            function (res) {
                /** @type {?} */
                var listRes = new RtBillProcessListResult();
                listRes.LoadFromJsonObject(res);
                return listRes;
            })));
        }
    };
    /**
     * 根据流程编号查询流程名称
     * @param code
     * @returns
     */
    /**
     * 根据流程编号查询流程名称
     * @param {?} code
     * @return {?}
     */
    ProcessListHelpService.prototype.getProcessNameByCode = /**
     * 根据流程编号查询流程名称
     * @param {?} code
     * @return {?}
     */
    function (code) {
        return this.httpService.request("GET", "/api/runtime/aif/v1.0/rtbillcreationprocess/getname/" + code, { responseType: 'text' });
    };
    ProcessListHelpService.decorators = [
        { type: Injectable }
    ];
    /** @nocollapse */
    ProcessListHelpService.ctorParameters = function () { return [
        { type: AppService },
        { type: FrameworkService },
        { type: HttpService }
    ]; };
    return ProcessListHelpService;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var ProcessFilterConditionArgs = /** @class */ (function (_super) {
    __extends(ProcessFilterConditionArgs, _super);
    function ProcessFilterConditionArgs() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    /**
     * @protected
     * @return {?}
     */
    ProcessFilterConditionArgs.prototype.ResetBeforeLoadFrom = /**
     * @protected
     * @return {?}
     */
    function () {
        _super.prototype.ResetBeforeLoadFrom.call(this);
        this.name = null;
        this.upBillVoId = null;
        this.downBillVoId = null;
        this.isEnabled = null;
        this.billProcessType = null;
        this.sysInit = null;
        this.bizType = null;
        this.orderByCode = null;
        this.orderByName = null;
        this.OrderByLastModifiedTime = null;
        this.pageSize = 0;
        this.pageIndex = 0;
    };
    /**
     * @return {?}
     */
    ProcessFilterConditionArgs.prototype.ConvertToJsonObject = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var obj = _super.prototype.ConvertToJsonObject.call(this);
        BpmnModelJsonHelper.SetAttributeValue(obj, "name", this.name);
        BpmnModelJsonHelper.SetAttributeValue(obj, "upBillVoId", this.upBillVoId);
        BpmnModelJsonHelper.SetAttributeValue(obj, "downBillVoId", this.downBillVoId);
        BpmnModelJsonHelper.SetAttributeValue(obj, "isEnabled", this.isEnabled);
        BpmnModelJsonHelper.SetAttributeValue(obj, "billProcessType", this.billProcessType);
        BpmnModelJsonHelper.SetAttributeValue(obj, "sysInit", this.sysInit);
        BpmnModelJsonHelper.SetAttributeValue(obj, "bizType", this.bizType);
        BpmnModelJsonHelper.SetAttributeValue(obj, "orderByCode", this.orderByCode);
        BpmnModelJsonHelper.SetAttributeValue(obj, "orderByName", this.orderByName);
        BpmnModelJsonHelper.SetAttributeValue(obj, "OrderByLastModifiedTime", this.OrderByLastModifiedTime);
        BpmnModelJsonHelper.SetAttributeValue(obj, "pageSize", this.pageSize);
        BpmnModelJsonHelper.SetAttributeValue(obj, "pageIndex", this.pageIndex);
        return obj;
    };
    /**
     * @param {?} obj
     * @return {?}
     */
    ProcessFilterConditionArgs.prototype.LoadFromJsonObject = /**
     * @param {?} obj
     * @return {?}
     */
    function (obj) {
        _super.prototype.LoadFromJsonObject.call(this, obj);
        this.name = BpmnModelJsonHelper.GetAttributeValueAsJsonSerializable(obj, "name", TextValue);
        this.upBillVoId = BpmnModelJsonHelper.GetAttributeValueAsJsonSerializable(obj, "upBillVoId", TextValue);
        this.downBillVoId = BpmnModelJsonHelper.GetAttributeValueAsJsonSerializable(obj, "downBillVoId", TextValue);
        this.isEnabled = BpmnModelJsonHelper.GetAttributeValueAsJsonSerializable(obj, "isEnabled", TextValue);
        this.billProcessType = BpmnModelJsonHelper.GetAttributeValueAsJsonSerializable(obj, "billProcessType", TextValue);
        this.sysInit = BpmnModelJsonHelper.GetAttributeValueAsJsonSerializable(obj, "sysInit", TextValue);
        this.bizType = BpmnModelJsonHelper.GetAttributeValueAsJsonSerializable(obj, "bizType", TextValue);
        this.orderByCode = BpmnModelJsonHelper.GetAttributeValueAsJsonSerializable(obj, "orderByCode", TextValue);
        this.orderByName = BpmnModelJsonHelper.GetAttributeValueAsJsonSerializable(obj, "orderByName", TextValue);
        this.OrderByLastModifiedTime = BpmnModelJsonHelper.GetAttributeValueAsJsonSerializable(obj, "OrderByLastModifiedTime", TextValue);
        this.pageSize = BpmnModelJsonHelper.GetAttributeValueAsNumber(obj, "pageSize");
        this.pageIndex = BpmnModelJsonHelper.GetAttributeValueAsNumber(obj, "pageIndex");
    };
    return ProcessFilterConditionArgs;
}(JsonConvertableImpl));

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/** @enum {string} */
var OrderByDirection = {
    Asc: "Asc",
    Desc: "Desc",
};

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/** @type {?} */
var AIF_PROCESS_LIST_HELP_LANG_RESOURCES = {
    "zh-CHS": {
        "code": "编号",
        "name": "名称",
        "lastModifiedTime": "最后修改时间",
        "upBill": "上游单据",
        "downBill": "下游单据",
        "processName": "流程名称",
        "processType": "流程类型",
        "creation": "生单",
        "writeback": "回写",
        "enabledState": "启用状态",
        "sysInit": "系统预置",
        "filter": "筛选",
        "all": "全部",
        "enabled": "已启用",
        "disabled": "已禁用",
        "yes": "是",
        "no": "否",
        "billSelector": "单据选择",
        "querySolution": "筛选方案",
        "collapse": "收起",
        "expand": "展开",
        "loading": "加载中",
        "pleaseSelectNonVirtualVO": "请选择非虚拟VO",
        "pleaseSelectOneItemOnly": "请选中一条数据",
        "isExtendProcess": "扩展流程",
        "creationProcess": "生单流程",
        "clickCancel": "取消",
        "clickOk": "确定",
        "set": "（已设置）",
        "notSet": "（未设置）",
        "setProcess": "已设置：",
    },
    "en": {
        "code": "Code",
        "name": "Name",
        "lastModifiedTime": "Last Modified Time",
        "upBill": "Upstream Bill",
        "downBill": "Downstream Bill",
        "processName": "Process Name",
        "processType": "Process Type",
        "creation": "Creation",
        "writeback": "Writeback",
        "enabledState": "Enabled State",
        "sysInit": "System Init",
        "filter": "Filter",
        "all": "All",
        "enabled": "Enabled",
        "disabled": "Disabled",
        "yes": "Yes",
        "no": "No",
        "billSelector": "Bill Selector",
        "querySolution": "Query Solution",
        "collapse": "Collapse",
        "expand": "Expand",
        "loading": "Loading...",
        "pleaseSelectNonVirtualVO": "Please select non-virtual VO",
        "pleaseSelectOneItemOnly": "Please select only one item",
        "isExtendProcess": "Extend Process",
        "creationProcess": "Rreation Process",
        "clickCancel": "Cancel",
        "clickOk": "Ok",
        "set": "(Set)",
        "notSet": "(Not set)",
        "setProcess": "Set: ",
    },
    "zh-CHT": {
        "code": "編號",
        "name": "名稱",
        "lastModifiedTime": "最後修改時間",
        "upBill": "上遊單據",
        "downBill": "下遊單據",
        "processName": "流程名稱",
        "processType": "流程類型",
        "creation": "生單",
        "writeback": "回寫",
        "enabledState": "啟用狀態",
        "sysInit": "系統預置",
        "filter": "篩選",
        "all": "全部",
        "enabled": "已啟用",
        "disabled": "已禁用",
        "yes": "是",
        "no": "否",
        "billSelector": "單據選擇",
        "querySolution": "篩選方案",
        "collapse": "收起",
        "expand": "展開",
        "loading": "加載中",
        "pleaseSelectNonVirtualVO": "請選擇非虛擬VO",
        "pleaseSelectOneItemOnly": "請選中壹條數據",
        "isExtendProcess": "擴展流程",
        "creationProcess": "生單流程",
        "clickCancel": "取消",
        "clickOk": "確定",
        "set": "（已設置）",
        "notSet": "（未設置）",
        "setProcess": "已設置：",
    }
};

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var ɵ0$1 = AIF_PROCESS_LIST_HELP_LANG_RESOURCES;
var ProcessListHelpComponent = /** @class */ (function () {
    function ProcessListHelpComponent(procHelpService, messager, notify, modalService, frameworkService, router, activatedRoute, loading, localeId, localePipe) {
        this.procHelpService = procHelpService;
        this.messager = messager;
        this.notify = notify;
        this.modalService = modalService;
        this.frameworkService = frameworkService;
        this.router = router;
        this.activatedRoute = activatedRoute;
        this.loading = loading;
        this.localePipe = localePipe;
        this.closeModal = new EventEmitter();
        this.submitModal = new EventEmitter();
        this.editorParams = {};
        this.modalConfig = {
            title: this.localePipe.transform("creationProcess"),
            width: 1250,
            height: 500,
            showButtons: true
        };
        this.procEmitter = new EventEmitter();
        this.ttIdField = "id";
        this.ttData = [];
        this.ttColumns = [];
        this.cascadeCheck = false;
        this.cascadeDown = false;
        this.cascadeUp = false;
        this.defaultPageSize = 30;
        this.pageList = [this.defaultPageSize, 50, 100, 200, 500];
        /**
         * 已设置流程
         */
        this.setProcess = {
            showText: ""
        };
        this.queryParam = this.createDefaultQueryParam();
    }
    Object.defineProperty(ProcessListHelpComponent.prototype, "value", {
        set: /**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            if (data) {
                this.processCode = data;
                this.setProcess.code = this.processCode;
                this.setProcess.showText = this.processCode;
            }
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    ProcessListHelpComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.configTtColumns();
        // if (this.editorParams && this.editorParams.bizTypeId) {
        //   this.queryParam.filterArgs.bizType = new TextValue();
        //   this.queryParam.filterArgs.bizType.value = this.editorParams.bizTypeId;
        //   this.queryParam.filterArgs.bizType.hasValue = true;
        // }
        if (this.processCode != null) {
            this.procHelpService.getProcessNameByCode(this.processCode).subscribe((/**
             * @param {?} processName
             * @return {?}
             */
            function (processName) {
                _this.setProcess.name = processName;
                if (_this.setProcess.name) {
                    _this.setProcess.showText = _this.setProcess.name + "(" + _this.setProcess.code + ")";
                }
                else {
                    _this.setProcess.showText = _this.setProcess.code;
                }
            }));
        }
        this.loadItems(this.queryParam.filterArgs).subscribe((/**
         * @return {?}
         */
        function () {
            setTimeout((/**
             * @return {?}
             */
            function () {
                if (_this.ttData && _this.ttData.length > 0) {
                    /** @type {?} */
                    var proc = _this.processCode != null ? _this.ttData.find((/**
                     * @param {?} it
                     * @return {?}
                     */
                    function (it) { return it.code == _this.processCode; })) : _this.ttData[0];
                    proc && _this.tt.selectRow(proc.id);
                }
            }), 300);
        }));
    };
    /**
     * @param {?=} evt
     * @return {?}
     */
    ProcessListHelpComponent.prototype.clickOk = /**
     * @param {?=} evt
     * @return {?}
     */
    function (evt) {
        if (this.tt.selectedRow == null) {
            this.notify.warning(this.localePipe.transform("pleaseSelectOneItemOnly"));
            return;
        }
        this.procEmitter.emit(this.tt.selectedRow.data);
        /** @type {?} */
        var object = { value: this.tt.selectedRow.data.code, parameters: null };
        this.submitModal.emit(object);
        this.modalRef && this.modalRef.close();
    };
    /**
     * @param {?=} evt
     * @return {?}
     */
    ProcessListHelpComponent.prototype.clickCancel = /**
     * @param {?=} evt
     * @return {?}
     */
    function (evt) {
        this.procEmitter.complete();
        this.closeModal.emit();
        this.modalRef && this.modalRef.close();
    };
    /**
     * @param {?} param
     * @return {?}
     */
    ProcessListHelpComponent.prototype.onSearch = /**
     * @param {?} param
     * @return {?}
     */
    function (param) {
        var _this = this;
        this.queryParam = param;
        console.log(this.queryParam);
        this.loadItems(this.queryParam.filterArgs).subscribe((/**
         * @return {?}
         */
        function () {
            _this.tt.clearCheckeds();
            _this.tt.clearSelections();
        }));
    };
    /**
     * @param {?} ctx
     * @return {?}
     */
    ProcessListHelpComponent.prototype.clickNameCell = /**
     * @param {?} ctx
     * @return {?}
     */
    function (ctx) {
        this.procHelpService.openBifManagerApp(ctx.rowData);
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    ProcessListHelpComponent.prototype.onPageSizeChanged = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        var _this = this;
        // console.log('PageSize Changed:', $event);
        /** @type {?} */
        var checkedIds = this.tt.checkeds.map((/**
         * @param {?} r
         * @return {?}
         */
        function (r) { return r.data.id; }));
        this.queryParam.filterArgs.pageSize = $event.pageSize;
        this.loadItems(this.queryParam.filterArgs).subscribe((/**
         * @return {?}
         */
        function () {
            setTimeout((/**
             * @return {?}
             */
            function () {
                _this.tt.checkRows(checkedIds, true);
                _this.tt.refresh();
            }), 0);
        }));
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    ProcessListHelpComponent.prototype.onPageChanged = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        var _this = this;
        // console.log('PageNumber Changed:', $event);
        /** @type {?} */
        var checkedIds = this.tt.checkeds.map((/**
         * @param {?} r
         * @return {?}
         */
        function (r) { return r.data.id; }));
        this.queryParam.filterArgs.pageIndex = $event.pageIndex - 1;
        this.queryParam.filterArgs.pageSize = $event.pageSize;
        this.loadItems(this.queryParam.filterArgs).subscribe((/**
         * @return {?}
         */
        function () {
            setTimeout((/**
             * @return {?}
             */
            function () {
                _this.tt.checkRows(checkedIds, true);
                _this.tt.refresh();
            }), 0);
        }));
    };
    /**
     * @param {?} pageInfo
     * @return {?}
     */
    ProcessListHelpComponent.prototype.pageChangeHandler = /**
     * @param {?} pageInfo
     * @return {?}
     */
    function (pageInfo) {
        var _this = this;
        /** @type {?} */
        var checkedIds = this.tt.checkeds.map((/**
         * @param {?} r
         * @return {?}
         */
        function (r) { return r.data.id; }));
        this.queryParam.filterArgs.pageIndex = pageInfo.pageIndex - 1;
        this.queryParam.filterArgs.pageSize = pageInfo.pageSize;
        this.loadItems(this.queryParam.filterArgs).subscribe((/**
         * @return {?}
         */
        function () {
            setTimeout((/**
             * @return {?}
             */
            function () {
                _this.tt.checkRows(checkedIds, true);
                _this.tt.refresh();
            }), 0);
        }));
    };
    /**
     * @param {?} size
     * @return {?}
     */
    ProcessListHelpComponent.prototype.pageSizeChangeHandler = /**
     * @param {?} size
     * @return {?}
     */
    function (size) {
        var _this = this;
        /** @type {?} */
        var checkedIds = this.tt.checkeds.map((/**
         * @param {?} r
         * @return {?}
         */
        function (r) { return r.data.id; }));
        this.queryParam.filterArgs.pageSize = size;
        this.loadItems(this.queryParam.filterArgs).subscribe((/**
         * @return {?}
         */
        function () {
            setTimeout((/**
             * @return {?}
             */
            function () {
                _this.tt.checkRows(checkedIds, true);
                _this.tt.refresh();
            }), 0);
        }));
    };
    /**
     * @return {?}
     */
    ProcessListHelpComponent.prototype.removeSetProcess = /**
     * @return {?}
     */
    function () {
    };
    /**
     * @private
     * @param {?} args
     * @return {?}
     */
    ProcessListHelpComponent.prototype.loadItems = /**
     * @private
     * @param {?} args
     * @return {?}
     */
    function (args) {
        var _this = this;
        /** @type {?} */
        var loadingComp = this.loading.show({ message: this.localePipe.transform("loading") });
        return this.procHelpService.getDatagridData(args).pipe(switchMap((/**
         * @param {?} listRes
         * @return {?}
         */
        function (listRes) {
            _this.ttData = __spread(listRes.entities);
            //更新分页信息
            _this.tt.setPageIndex(listRes.pageIndex + 1);
            _this.tt.total = listRes.totalCount;
            _this.tt.pageSize = listRes.pageSize;
            // this.page.setCurrentPage(this.paginationId, listRes.pageIndex + 1);
            // this.page.setItemsPerPage(this.paginationId, listRes.pageSize);
            // this.page.setTotalItems(this.paginationId, listRes.totalCount);
            loadingComp.close();
            return of$1(listRes);
        })), catchError((/**
         * @param {?} err
         * @return {?}
         */
        function (err) {
            loadingComp.close();
            setTimeout((/**
             * @return {?}
             */
            function () {
                //todo 确定异常结构, 目前采用兼容取值方式
                _this.messager.error(err.error == null ? err.message : (err.error.Message || err.error.message || err.message));
            }), 300);
            throw err;
        })));
    };
    /**
     * @private
     * @return {?}
     */
    ProcessListHelpComponent.prototype.configTtColumns = /**
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        this.ttColumns = [
            // {
            //   field: "isEnabled", title: this.localePipe.transform("enabledState"), width: 100, sortable: false,
            //   formatter: (value: boolean, rowData, rowIndex) => {
            //     if (value == true) {
            //       return this.localePipe.transform("enabled");
            //     } else if (value == false) {
            //       return this.localePipe.transform("disabled");
            //     } else {
            //       return "-";
            //     }
            //   }
            // },
            { field: "code", title: this.localePipe.transform("code"), width: 120, sortable: true },
            {
                field: "name", title: this.localePipe.transform("name"), width: 250, sortable: true,
                template: this.nameCellTemp,
            },
            { field: "upBillVoName", title: this.localePipe.transform("upBill"), width: 120, sortable: true },
            { field: "downBillVoName", title: this.localePipe.transform("downBill"), width: 120, sortable: true },
            // {
            //   field: "bifMetadataType", title: this.localePipe.transform("processType"), width: 120, sortable: false,
            //   formatter: (value: BifMetadataType, rowData, rowIndex) => {
            //     if (value == BifMetadataType.BifCreationProcess) {
            //       return this.localePipe.transform("creation");
            //     } else if (value == BifMetadataType.BifWritebackProcess) {
            //       return this.localePipe.transform("writeback");
            //     } else {
            //       return "-";
            //     }
            //   }
            // },
            {
                field: "sysInit", title: this.localePipe.transform("sysInit"), width: 80, sortable: false,
                formatter: (/**
                 * @param {?} value
                 * @param {?} rowData
                 * @param {?} rowIndex
                 * @return {?}
                 */
                function (value, rowData, rowIndex) {
                    if (value == true) {
                        return _this.localePipe.transform("yes");
                    }
                    else if (value == false) {
                        return _this.localePipe.transform("no");
                    }
                    else {
                        return "-";
                    }
                })
            },
        ];
    };
    /**
     * @private
     * @return {?}
     */
    ProcessListHelpComponent.prototype.createDefaultQueryParam = /**
     * @private
     * @return {?}
     */
    function () {
        /** @type {?} */
        var queryParam = {
            filterArgs: new ProcessFilterConditionArgs(),
            filterArgsExt: {}
        };
        queryParam.filterArgs.pageSize = this.defaultPageSize;
        queryParam.filterArgs.pageIndex = 0;
        queryParam.filterArgs.OrderByLastModifiedTime = new TextValue();
        queryParam.filterArgs.OrderByLastModifiedTime.value = OrderByDirection.Desc;
        queryParam.filterArgs.OrderByLastModifiedTime.hasValue = true;
        queryParam.filterArgs.billProcessType = new TextValue();
        queryParam.filterArgs.billProcessType.value = BifMetadataType.BifCreationProcess;
        queryParam.filterArgs.billProcessType.hasValue = true;
        queryParam.filterArgs.isEnabled = new TextValue();
        queryParam.filterArgs.isEnabled.value = "true";
        queryParam.filterArgs.isEnabled.hasValue = true;
        return queryParam;
    };
    ProcessListHelpComponent.decorators = [
        { type: Component, args: [{
                    selector: 'app-process-list-help',
                    template: "<div class=\"f-page f-page-is-managelist\" id=\"bif-manager-list\">\r\n  <app-proc-help-query-solution id=\"query-solution\" #querySolution [(queryParam)]=\"queryParam\"\r\n    (onSearch)=\"onSearch($event)\">\r\n  </app-proc-help-query-solution>\r\n\r\n  <div class=\"f-page-main\" id=\"page-main\">\r\n    <div *ngIf=\"setProcess&&setProcess.code\" class=\"d-flex px-2\" style=\"line-height: 32px; height: 32px;\">\r\n      <div>\r\n        {{\"setProcess\" | aifLocale}}\r\n      </div>\r\n      <div class=\"farris-tags\">\r\n        <ul class=\"farris-tags-item-container\">\r\n          <li class=\"farris-tag-item farris-tag-item-info\">\r\n            <span class=\"tag-box\">\r\n              {{setProcess&&setProcess.showText}}\r\n            </span>\r\n            <span *ngIf=\"false\" class=\"tag-delete\" (click)=\"removeSetProcess()\">\r\n              <i class=\"f-icon f-icon-close\"></i>\r\n            </span>\r\n          </li>\r\n        </ul>\r\n      </div>\r\n    </div>\r\n    <div class=\"f-utils-fill-flex-column\">\r\n      <farris-datagrid id=\"tt\" #tt [data]=\"ttData\" [columns]=\"ttColumns\" [idField]=\"ttIdField\" [multiSelect]=\"true\"\r\n        [showCheckbox]=\"false\" [showAllCheckbox]=\"false\" [onlySelectSelf]=\"true\" [keepSelect]=\"true\"\r\n        [selectOnCheck]=\"true\" [checkOnSelect]=\"false\" [showHeader]=\"true\" [fit]=\"true\" [fitColumns]=\"true\"\r\n        [pagination]=\"true\" [showPageList]=\"true\" [pageSize]=\"defaultPageSize\" [pageList]=\"pageList\"\r\n        (pageChanged)=\"onPageChanged($event)\" (pageSizeChanged)=\"onPageSizeChanged($event)\" [remoteSort]=\"false\">\r\n      </farris-datagrid>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #nameCellTemp let-ctx>\r\n  <a href=\"javascript: void(0);\" (click)=\"clickNameCell(ctx)\">{{ctx?.rowData?.name}}</a>\r\n</ng-template>\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type=\"button\" class=\"btn btn-secondary btn-sm px-3 mx-2\" (click)=\"clickCancel()\">\r\n    {{'clickCancel' | aifLocale}}\r\n  </button>\r\n  <button type=\"button\" class=\"btn btn-primary btn-sm px-3 mx-2\" (click)=\"clickOk()\">\r\n    {{'clickOk' | aifLocale}}\r\n  </button>\r\n</ng-template>\r\n",
                    providers: [
                        { provide: BIF_LANG_RESOURCES, useValue: ɵ0$1 },
                        AifLocalePipe,
                    ],
                    styles: [""]
                }] }
    ];
    /** @nocollapse */
    ProcessListHelpComponent.ctorParameters = function () { return [
        { type: ProcessListHelpService },
        { type: MessagerService },
        { type: NotifyService },
        { type: BsModalService },
        { type: FrameworkService },
        { type: Router },
        { type: ActivatedRoute },
        { type: LoadingService },
        { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
        { type: AifLocalePipe }
    ]; };
    ProcessListHelpComponent.propDecorators = {
        closeModal: [{ type: Output }],
        submitModal: [{ type: Output }],
        value: [{ type: Input }],
        editorParams: [{ type: Input }],
        tt: [{ type: ViewChild, args: ["tt",] }],
        nameCellTemp: [{ type: ViewChild, args: ['nameCellTemp',] }],
        modalFooter: [{ type: ViewChild, args: ['iconSelectFooter',] }]
    };
    return ProcessListHelpComponent;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var CallActivitySubProcess2Component = /** @class */ (function () {
    function CallActivitySubProcess2Component(notify, modalService, message, util, http, designerState, expr, cfr, inj, cdr, localeId, resources, localePipe) {
        this.notify = notify;
        this.modalService = modalService;
        this.message = message;
        this.util = util;
        this.http = http;
        this.designerState = designerState;
        this.expr = expr;
        this.cfr = cfr;
        this.inj = inj;
        this.cdr = cdr;
        this.localeId = localeId;
        this.resources = resources;
        this.localePipe = localePipe;
        this.cls = 'farris-main-area flex-column';
        this.editorParams = {};
        this.closeModal = new EventEmitter();
        this.submitModal = new EventEmitter();
        this.modalConfig = {
            title: this.localePipe.transform('component.subProcess.subProcessSet'),
            width: 600,
            height: 342,
            showButtons: true
        };
        this.callActivitySubProcess = new CallActivitySubProcess$1();
        this.groupIcon = '<i class="f-icon f-icon-lookup"></i>';
        this.subProcessType = SubProcessType;
        this.billSourceType = BillSourceType;
        this.radioGroupProcessTypeData = [
            { value: "Specified", name: this.localePipe.transform('component.subProcess.specified') },
            { value: "Dynamic", name: this.localePipe.transform('component.subProcess.dynamic') },
        ];
        this.radioGroupBillSourceData = [
            { value: BillSourceType.InheritParent, name: this.localePipe.transform('component.subProcess.inheritParent') },
            { value: BillSourceType.AutoCreation, name: this.localePipe.transform('component.subProcess.autoCreation') },
            { value: BillSourceType.VariablesExpression, name: this.localePipe.transform('component.subProcess.variablesExpression') },
        ];
        this.localePipe = this.localePipe || new WfLocalePipe(localeId, resources);
    }
    Object.defineProperty(CallActivitySubProcess2Component.prototype, "value", {
        set: /**
         * @param {?} v
         * @return {?}
         */
        function (v) {
            if (v) {
                this.callActivitySubProcess = v;
                // 为子流程类型赋值
                if (this.callActivitySubProcess.calledElement == null || this.callActivitySubProcess.calledElement == "") {
                    if (this.callActivitySubProcess.calledBizDefKey == null || this.callActivitySubProcess.calledBizDefKey == "") {
                        this.callActivitySubProcess.subProcessType = SubProcessType.Specified;
                    }
                    else {
                        this.callActivitySubProcess.subProcessType = SubProcessType.Dynamic;
                    }
                }
                else {
                    this.callActivitySubProcess.subProcessType = SubProcessType.Specified;
                }
                // 为单据来源类型赋值
                if (this.callActivitySubProcess.inheritBizDataId === true) {
                    this.callActivitySubProcess.billSourceType = BillSourceType.InheritParent;
                }
                else if (this.callActivitySubProcess.inheritBizDataId === false && this.callActivitySubProcess.useAutoCreationData === false) {
                    this.callActivitySubProcess.billSourceType = BillSourceType.VariablesExpression;
                }
                else if (this.callActivitySubProcess.inheritBizDataId === false && this.callActivitySubProcess.useAutoCreationData === true) {
                    this.callActivitySubProcess.billSourceType = BillSourceType.AutoCreation;
                }
                this.getProcessDefKey(this.callActivitySubProcess.calledElement);
                this.getFlowForm(this.callActivitySubProcess.calledBizDefKey);
                this.getAifProcessName(this.callActivitySubProcess.aifProcessCode);
            }
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    CallActivitySubProcess2Component.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
    };
    /**
     * @return {?}
     */
    CallActivitySubProcess2Component.prototype.clickOK = /**
     * @return {?}
     */
    function () {
        if (this.validator()) {
            /** @type {?} */
            var object = { value: this.callActivitySubProcess, parameters: null };
            this.submitModal.emit(object);
        }
    };
    /**
     * @return {?}
     */
    CallActivitySubProcess2Component.prototype.clickCancel = /**
     * @return {?}
     */
    function () {
        this.closeModal.emit();
    };
    /**
     * @param {?} args
     * @return {?}
     */
    CallActivitySubProcess2Component.prototype.processConfirm = /**
     * @param {?} args
     * @return {?}
     */
    function (args) {
        if (args) {
            this.callActivitySubProcess.calledElement = args.procDefKey;
            this.callActivitySubProcess.calledElementName = args.name;
        }
    };
    /**
     * @param {?} val
     * @return {?}
     */
    CallActivitySubProcess2Component.prototype.processTypeChange = /**
     * @param {?} val
     * @return {?}
     */
    function (val) {
        console.log(val);
        if (val == SubProcessType.Specified) {
            this.callActivitySubProcess.calledBizDefKey = null;
            this.callActivitySubProcess.calledBizDefName = null;
        }
        else if (val == SubProcessType.Dynamic) {
            this.callActivitySubProcess.calledElement = null;
            this.callActivitySubProcess.calledElementName = null;
        }
    };
    /**
     * @param {?} val
     * @return {?}
     */
    CallActivitySubProcess2Component.prototype.billSourceChange = /**
     * @param {?} val
     * @return {?}
     */
    function (val) {
        console.log(val);
        if (val == BillSourceType.InheritParent) {
            this.callActivitySubProcess.inheritBizDataId = true;
            this.callActivitySubProcess.useAutoCreationData = false;
        }
        else if (val == BillSourceType.AutoCreation) {
            this.callActivitySubProcess.inheritBizDataId = false;
            this.callActivitySubProcess.useAutoCreationData = true;
        }
        else if (val == BillSourceType.VariablesExpression) {
            this.callActivitySubProcess.inheritBizDataId = false;
            this.callActivitySubProcess.useAutoCreationData = false;
        }
    };
    /**
     * @return {?}
     */
    CallActivitySubProcess2Component.prototype.selectProcess = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.openProcHelp().subscribe((/**
         * @param {?} rte
         * @return {?}
         */
        function (rte) {
            if (rte == null) {
                _this.notify.warning(_this.localePipe.transform('component.subProcess.rteNull'));
                return;
            }
            _this.callActivitySubProcess.aifProcessCode = rte.code;
            _this.callActivitySubProcess.aifProcessName = rte.name;
        }));
    };
    /**
     * @return {?}
     */
    CallActivitySubProcess2Component.prototype.clearProcess = /**
     * @return {?}
     */
    function () {
        this.callActivitySubProcess.aifProcessCode = null;
        this.callActivitySubProcess.aifProcessName = null;
    };
    /**
     * @return {?}
     */
    CallActivitySubProcess2Component.prototype.openProcHelp = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var cmpF = this.cfr.resolveComponentFactory(ProcessListHelpComponent);
        /** @type {?} */
        var cmpR = cmpF.create(this.inj, []);
        cmpR.instance.editorParams = this.editorParams;
        /** @type {?} */
        var modalRef = this.modalService.show(cmpR, {
            title: this.localePipe.transform('component.subProcess.orderProcess'),
            width: 1250,
            height: 500,
            resizable: true,
            buttons: [
                {
                    text: this.localePipe.transform('component.subProcess.clickOk'),
                    cls: "btn btn-primary",
                    handle: (/**
                     * @param {?} evt
                     * @return {?}
                     */
                    function (evt) {
                        cmpR.instance.clickOk(evt);
                        modalRef.close();
                    })
                },
                {
                    text: this.localePipe.transform('component.subProcess.clickCancel'),
                    cls: "btn btn-secondary",
                    handle: (/**
                     * @param {?} evt
                     * @return {?}
                     */
                    function (evt) {
                        cmpR.instance.clickCancel(evt);
                        modalRef.close();
                    })
                }
            ],
            closed: (/**
             * @return {?}
             */
            function () {
                modalRef.dialog.destroy();
            })
        });
        cmpR.instance.modalRef = modalRef;
        return cmpR.instance.procEmitter.asObservable();
    };
    /**
     * @param {?} args
     * @return {?}
     */
    CallActivitySubProcess2Component.prototype.clearProcessDef = /**
     * @param {?} args
     * @return {?}
     */
    function (args) {
        this.callActivitySubProcess.calledElement = '';
        this.callActivitySubProcess.calledElementName = '';
    };
    /**
     * @param {?} args
     * @return {?}
     */
    CallActivitySubProcess2Component.prototype.flowFormConfirm = /**
     * @param {?} args
     * @return {?}
     */
    function (args) {
        if (args) {
            this.callActivitySubProcess.calledBizDefKey = args.id;
            this.callActivitySubProcess.calledBizDefName = args.name;
        }
    };
    /**
     * @param {?} args
     * @return {?}
     */
    CallActivitySubProcess2Component.prototype.clearFlowForm = /**
     * @param {?} args
     * @return {?}
     */
    function (args) {
        this.callActivitySubProcess.calledBizDefKey = '';
        this.callActivitySubProcess.calledBizDefName = '';
    };
    /**
     * @return {?}
     */
    CallActivitySubProcess2Component.prototype.setBizDataId = /**
     * @return {?}
     */
    function () {
        this.showExprHelp();
    };
    /**
     * @private
     * @return {?}
     */
    CallActivitySubProcess2Component.prototype.showExprHelp = /**
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        var e_1, _a, e_2, _b, e_3, _c;
        /** @type {?} */
        var context = new Array();
        // if(this.expr.exprEntity.contextEntities.find(x => x.key === 'CurrentLanguage')) {
        //   context.push(this.expr.exprEntity.contextEntities.find(x => x.key === 'CurrentLanguage'));
        // }
        // this.expr.clearContext();
        if (this.designerState.schemas.length > 0) {
            try {
                for (var _d = __values(this.designerState.schemas), _e = _d.next(); !_e.done; _e = _d.next()) {
                    var schema = _e.value;
                    this.expr.addSchema('Schema', schema);
                }
            }
            catch (e_1_1) { e_1 = { error: e_1_1 }; }
            finally {
                try {
                    if (_e && !_e.done && (_a = _d.return)) _a.call(_d);
                }
                finally { if (e_1) throw e_1.error; }
            }
            if (this.designerState.schemas[0].entityTypes && this.designerState.schemas[0].entityTypes.length > 0) {
                /** @type {?} */
                var entityType = this.designerState.schemas[0].entityTypes[0];
                this.expr.addInjectedEntity(entityType.name, 'Schema', entityType.name, InjectedType.EntityType);
            }
        }
        context = this.designerState.addContext(context);
        if (this.designerState.subActivityContext.length > 0) {
            try {
                for (var _f = __values(this.designerState.subActivityContext), _g = _f.next(); !_g.done; _g = _f.next()) {
                    var variable = _g.value;
                    context.push(variable);
                    // this.expr.addContext(variable);
                }
            }
            catch (e_2_1) { e_2 = { error: e_2_1 }; }
            finally {
                try {
                    if (_g && !_g.done && (_b = _f.return)) _b.call(_f);
                }
                finally { if (e_2) throw e_2.error; }
            }
        }
        if (context.length > 0) {
            try {
                for (var context_1 = __values(context), context_1_1 = context_1.next(); !context_1_1.done; context_1_1 = context_1.next()) {
                    var v = context_1_1.value;
                    this.expr.addContext(v);
                }
            }
            catch (e_3_1) { e_3 = { error: e_3_1 }; }
            finally {
                try {
                    if (context_1_1 && !context_1_1.done && (_c = context_1.return)) _c.call(context_1);
                }
                finally { if (e_3) throw e_3.error; }
            }
        }
        this.expr.addExpressionText(this.callActivitySubProcess.bizDataId);
        this.expr.buildExpression().then((/**
         * @param {?} expressioninfo
         * @return {?}
         */
        function (expressioninfo) {
            _this.callActivitySubProcess.bizDataId = expressioninfo;
            //点击确定后，去除表达式里面的新增的上下文变量
            if (context.length > 0) {
                _this.expr.exprEntity.contextEntities = _this.expr.exprEntity.contextEntities.filter((/**
                 * @param {?} x
                 * @return {?}
                 */
                function (x) { return !context.some((/**
                 * @param {?} y
                 * @return {?}
                 */
                function (y) { return y.key === x.key; })); }));
            }
        }));
    };
    /**
     * @param {?} bool
     * @return {?}
     */
    CallActivitySubProcess2Component.prototype.valueChange = /**
     * @param {?} bool
     * @return {?}
     */
    function (bool) {
        if (bool) {
            this.callActivitySubProcess.bizDataId = null;
        }
    };
    /**
     * @private
     * @return {?}
     */
    CallActivitySubProcess2Component.prototype.validator = /**
     * @private
     * @return {?}
     */
    function () {
        if (!this.callActivitySubProcess.inheritBizDataId && !this.callActivitySubProcess.useAutoCreationData && !this.callActivitySubProcess.bizDataId) {
            this.message.warning(this.localePipe.transform('component.subProcess.inheritBizDataId'));
            return false;
        }
        return true;
    };
    /**
     * @private
     * @param {?} key
     * @return {?}
     */
    CallActivitySubProcess2Component.prototype.getProcessDefKey = /**
     * @private
     * @param {?} key
     * @return {?}
     */
    function (key) {
        var _this = this;
        /** @type {?} */
        var url = this.util.getProcessDefinitionWebApi();
        if (key) {
            url += "/procDefKey/" + key;
            this.http.get(url).subscribe((/**
             * @param {?} re
             * @return {?}
             */
            function (re) {
                _this.callActivitySubProcess.calledElementName = re.name;
            }));
        }
    };
    /**
     * @private
     * @param {?} id
     * @return {?}
     */
    CallActivitySubProcess2Component.prototype.getFlowForm = /**
     * @private
     * @param {?} id
     * @return {?}
     */
    function (id) {
        var _this = this;
        /** @type {?} */
        var url = this.util.getFlowFormWebApi();
        if (id) {
            url += "/" + id;
            this.http.get(url).subscribe((/**
             * @param {?} re
             * @return {?}
             */
            function (re) {
                _this.callActivitySubProcess.calledBizDefName = re.name;
            }));
        }
    };
    /**
     * @param {?} code
     * @return {?}
     */
    CallActivitySubProcess2Component.prototype.getAifProcessName = /**
     * @param {?} code
     * @return {?}
     */
    function (code) {
        var _this = this;
        if (code != null && code != "") {
            this.http.request("GET", "/api/runtime/aif/v1.0/rtbillcreationprocess/getname/" + code, { responseType: 'text' }).subscribe((/**
             * @param {?} res
             * @return {?}
             */
            function (res) {
                _this.callActivitySubProcess.aifProcessName = res;
            }), (/**
             * @param {?} err
             * @return {?}
             */
            function (err) {
                if (err.error && typeof err.error == "string") {
                    err.error = JSON.parse(err.error);
                }
                setTimeout((/**
                 * @return {?}
                 */
                function () {
                    //todo 确定异常结构, 目前采用兼容取值方式
                    _this.message.error(err.error == null ? err.message : (err.error.Message || err.error.message || err.message));
                }), 300);
                throw err;
            }));
        }
    };
    CallActivitySubProcess2Component.decorators = [
        { type: Component, args: [{
                    selector: 'lib-call-activity-sub-process2',
                    template: "<div class=\"f-page\">\r\n  <div class=\"f-utils-fill-flex-column farris-split-section my-2 mx-3 h-100\" style=\"border-radius:16px;border: 1.5px solid #F1F3F7;\">\r\n    <section>\r\n      <div class=\"f-utils-fill-flex-column h-100\" style=\"margin-top: 15px;\">\r\n        <div class=\"h-100\">\r\n          <div class=\"farris-form form-inline farris-form-inline\">\r\n            <div class=\"farris-group-wrap mt-1\">\r\n              <div class=\"form-group farris-form-group\">\r\n                <label class=\"col-form-label\">\r\n                  <span class=\"farris-label-text\">{{'component.subProcess.radioGroupProcessType' | wfLocale}}</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap ml-1\">\r\n                  <farris-radiogroup #radioGroupProcessType\r\n                    [(ngModel)]=\"callActivitySubProcess&&callActivitySubProcess.subProcessType\" [horizontal]=\"false\"\r\n                    [data]=\"radioGroupProcessTypeData\" (changeValue)=\"processTypeChange($event)\">\r\n                  </farris-radiogroup>\r\n                  <div class=\"farris-feedback valid-feedback\"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <div class=\"farris-group-wrap mt-1\" *ngIf=\"callActivitySubProcess.subProcessType==subProcessType.Dynamic\">\r\n              <div class=\"form-group farris-form-group\">\r\n                <label class=\"col-form-label\">\r\n                  <span class=\"farris-label-text\">{{'component.subProcess.flowForm' | wfLocale}}</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap ml-1\">\r\n                  <wf-bizprocess-lookup title=\"{{'component.subProcess.flowForm' | wfLocale}}\" [sourceType]=\"'flowform'\"\r\n                    [displayTxt]=\"callActivitySubProcess.calledBizDefName\" (afterConfirm)=\"flowFormConfirm($event)\"\r\n                    (clear)=\"clearFlowForm($event)\">\r\n                  </wf-bizprocess-lookup>\r\n                  <div class=\"farris-feedback valid-feedback\"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <div class=\"farris-group-wrap mt-1\" *ngIf=\"callActivitySubProcess.subProcessType==subProcessType.Specified\">\r\n              <div class=\"form-group farris-form-group\">\r\n                <label class=\"col-form-label\">\r\n                  <span class=\"farris-label-text\">{{'component.subProcess.processDef' | wfLocale}}</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap ml-1\">\r\n                  <wf-bizprocess-lookup title=\"{{'component.subProcess.processDef' | wfLocale}}\" [displayTxt]=\"callActivitySubProcess.calledElementName\"\r\n                    (afterConfirm)=\"processConfirm($event)\" (clear)=\"clearProcessDef($event)\">\r\n                  </wf-bizprocess-lookup>\r\n                  <div class=\"farris-feedback valid-feedback\"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </section>\r\n    <section class=\"\">\r\n      <div class=\"f-utils-fill-flex-column h-100\">\r\n        <div class=\"h-100\">\r\n          <div class=\"farris-form form-inline farris-form-inline\">\r\n\r\n            <div class=\"farris-group-wrap mt-1\">\r\n              <div class=\"form-group farris-form-group\">\r\n                <label class=\"col-form-label\">\r\n                  <span class=\"farris-label-text\">{{'component.subProcess.radioGroupBillSource' | wfLocale}}</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap ml-1\">\r\n                  <farris-radiogroup #radioGroupBillSource\r\n                    [(ngModel)]=\"callActivitySubProcess&&callActivitySubProcess.billSourceType\" [horizontal]=\"false\"\r\n                    [data]=\"radioGroupBillSourceData\" (changeValue)=\"billSourceChange($event)\">\r\n                  </farris-radiogroup>\r\n                </div>\r\n                <div class=\"farris-feedback valid-feedback\"></div>\r\n              </div>\r\n            </div>\r\n\r\n            <div class=\"farris-group-wrap mt-1\"\r\n              *ngIf=\"callActivitySubProcess.billSourceType==billSourceType.AutoCreation\">\r\n              <div class=\"form-group farris-form-group\">\r\n                <label class=\"col-form-label\">\r\n                  <span class=\"farris-label-text\">{{'component.subProcess.autoCreationProcess' | wfLocale}}</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap ml-1\">\r\n                  <input-group [ngModel]=\"callActivitySubProcess&&callActivitySubProcess.aifProcessName\"\r\n                    [editable]=\"false\" (clickHandle)=\"selectProcess()\" [groupText]=\"groupIcon\" (clear)=\"clearProcess()\">\r\n                  </input-group>\r\n                  <div class=\"farris-feedback valid-feedback\"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <div class=\"farris-group-wrap mt-1\"\r\n              *ngIf=\"callActivitySubProcess.billSourceType==billSourceType.VariablesExpression\">\r\n              <div class=\"form-group farris-form-group\">\r\n                <label class=\"col-form-label\">\r\n                  <span class=\"farris-label-text\">{{'component.subProcess.bizDataId' | wfLocale}}</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap ml-1\">\r\n                  <input-group [ngModel]=\"callActivitySubProcess.bizDataId\" [enableClear]=\"false\"\r\n                    [ngModel]=\"callActivitySubProcess.bizDataId\" name=\"bizDataId\" [editable]=\"false\"\r\n                    (clickHandle)=\"setBizDataId()\" [groupText]=\"groupIcon\">\r\n                  </input-group>\r\n                  <div class=\"farris-feedback valid-feedback\"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </section>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type=\"button\" class=\"btn btn-secondary btn-sm mx-2\" (click)=\"clickCancel()\">{{'component.subProcess.clickCancel' | wfLocale}}</button>\r\n  <button type=\"button\" class=\"btn btn-primary btn-sm mx-2\" (click)=\"clickOK()\">{{'component.subProcess.clickOk' | wfLocale}}</button>\r\n</ng-template>\r\n",
                    providers: [
                        WfLocalePipe,
                    ]
                }] }
    ];
    /** @nocollapse */
    CallActivitySubProcess2Component.ctorParameters = function () { return [
        { type: NotifyService },
        { type: BsModalService },
        { type: MessagerService },
        { type: ProcessDeUtil },
        { type: HttpService },
        { type: ProcessDesignerUIState },
        { type: ExpressionService },
        { type: ComponentFactoryResolver },
        { type: Injector },
        { type: ChangeDetectorRef, decorators: [{ type: Optional }] },
        { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
        { type: undefined, decorators: [{ type: Inject, args: [WF_LANG_RESOURCES,] }] },
        { type: WfLocalePipe, decorators: [{ type: Optional }] }
    ]; };
    CallActivitySubProcess2Component.propDecorators = {
        cls: [{ type: HostBinding, args: ['class',] }],
        editorParams: [{ type: Input }],
        value: [{ type: Input }],
        closeModal: [{ type: Output }],
        submitModal: [{ type: Output }],
        modalFooter: [{ type: ViewChild, args: ['iconSelectFooter',] }],
        radioGroupProcessType: [{ type: ViewChild, args: ["radioGroupProcessType",] }],
        radioGroupBillSource: [{ type: ViewChild, args: ["radioGroupBillSource",] }]
    };
    return CallActivitySubProcess2Component;
}());
var CallActivitySubProcess2Converter = /** @class */ (function () {
    function CallActivitySubProcess2Converter(localePipe) {
        this.localePipe = localePipe;
    }
    /**
     * @param {?} data
     * @return {?}
     */
    CallActivitySubProcess2Converter.prototype.convertTo = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        if (data && (data.calledBizDefKey || data.calledElement)) {
            return this.localePipe.transform("component.subProcess.set");
        }
        return this.localePipe.transform("component.subProcess.notSet");
    };
    return CallActivitySubProcess2Converter;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/** @enum {string} */
var CallActivitySubProcessPropertyKeys = {
    Id: "Id",
    Name: "Name",
    NameLanguage: "NameLanguage",
    ClrTypeID: "ClrTypeID",
    callActivitySubProcess: 'callActivitySubProcess',
    /**
     * 驳回规则
     */
    BackWardRule: 'BackWardRule',
    variableSettings: 'variableSettings',
    /**
    * 多实例设置
    */
    MultiInstanceLoopCharacteristics: 'MultiInstanceLoopCharacteristics',
};

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var SubProcessViewModel = /** @class */ (function () {
    function SubProcessViewModel(uiState, localPipe) {
        this.uiState = uiState;
        this.localPipe = localPipe;
    }
    /**
     * @param {?} obj
     * @return {?}
     */
    SubProcessViewModel.prototype.setProperty = /**
     * @param {?} obj
     * @return {?}
     */
    function (obj) {
        this.uiState.propertyData = obj.propertyData;
        this.uiState.propertyConfig = this.setConfig(obj.propertyConfig);
    };
    /**
     * @private
     * @param {?} obj
     * @return {?}
     */
    SubProcessViewModel.prototype.setConfig = /**
     * @private
     * @param {?} obj
     * @return {?}
     */
    function (obj) {
        var _this = this;
        /** @type {?} */
        var propertyConfig = [];
        if (obj) {
            obj.forEach((/**
             * @param {?} element
             * @return {?}
             */
            function (element) {
                _this.setEntity(element.properties);
                propertyConfig.push(element);
            }));
        }
        return propertyConfig;
    };
    /**
     * @private
     * @param {?} obj
     * @return {?}
     */
    SubProcessViewModel.prototype.setEntity = /**
     * @private
     * @param {?} obj
     * @return {?}
     */
    function (obj) {
        var _this = this;
        if (obj && obj.length > 0) {
            obj.forEach((/**
             * @param {?} item
             * @return {?}
             */
            function (item) {
                switch (item.propertyID) {
                    case CallActivitySubProcessPropertyKeys.callActivitySubProcess: // 参与者
                        // item.editor = CallActivitySubProcessComponent;
                        // item.converter = new CallActivitySubProcessConverter();
                        item.editor = CallActivitySubProcess2Component;
                        item.converter = new CallActivitySubProcess2Converter(_this.localPipe);
                        item.editorParams = {
                            bizTypeId: _this.uiState.flowFormInfo.flowForm.businessObjectId,
                        };
                        break;
                    case CallActivitySubProcessPropertyKeys.BackWardRule:
                        item.editor = BackwardRuleComponent;
                        item.converter = new BackwardRuleConverter(_this.localPipe);
                        item.editorParams = {
                            nodeType: 'CallActivitySubProcess'
                        };
                        break;
                    case CallActivitySubProcessPropertyKeys.MultiInstanceLoopCharacteristics:
                        item.editor = MultiInstanceLoopCharacteristicsComponent;
                        item.converter = new MultiInstanceLoopCharacteristicsConverter(_this.localPipe);
                        item.editorParams = {
                            location: 'CallActivitySubProcess'
                        };
                        break;
                    case CallActivitySubProcessPropertyKeys.variableSettings: // 变量设置
                        item.editor = VariableSettingComponent;
                        item.converter = new VariableSettingConverter(_this.localPipe);
                        break;
                    default:
                        break;
                }
            }));
        }
    };
    SubProcessViewModel.decorators = [
        { type: Injectable }
    ];
    /** @nocollapse */
    SubProcessViewModel.ctorParameters = function () { return [
        { type: ProcessDesignerUIState },
        { type: WfLocalePipe }
    ]; };
    return SubProcessViewModel;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/** @enum {string} */
var AutoActivityPropertyKeys = {
    Id: "Id",
    Name: "Name",
    NameLanguage: "NameLanguage",
    ClrTypeID: "ClrTypeID",
    Tools: 'Tools',
    variableSettings: 'variableSettings',
    ParticipantOptions: 'ParticipantOptions',
};

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var AutoActivityAdapter = /** @class */ (function () {
    function AutoActivityAdapter(uiState, localPipe) {
        this.uiState = uiState;
        this.localPipe = localPipe;
    }
    /**
     * @param {?} obj
     * @return {?}
     */
    AutoActivityAdapter.prototype.setProperty = /**
     * @param {?} obj
     * @return {?}
     */
    function (obj) {
        this.uiState.propertyData = obj.propertyData;
        this.uiState.propertyConfig = this.setConfig(obj.propertyConfig);
    };
    /**
     * @private
     * @param {?} obj
     * @return {?}
     */
    AutoActivityAdapter.prototype.setConfig = /**
     * @private
     * @param {?} obj
     * @return {?}
     */
    function (obj) {
        var _this = this;
        /** @type {?} */
        var propertyConfig = [];
        if (obj) {
            obj.forEach((/**
             * @param {?} element
             * @return {?}
             */
            function (element) {
                _this.setEntity(element.properties);
                propertyConfig.push(element);
            }));
        }
        return propertyConfig;
    };
    /**
     * @private
     * @param {?} obj
     * @return {?}
     */
    AutoActivityAdapter.prototype.setEntity = /**
     * @private
     * @param {?} obj
     * @return {?}
     */
    function (obj) {
        var _this = this;
        if (obj && obj.length > 0) {
            obj.forEach((/**
             * @param {?} item
             * @return {?}
             */
            function (item) {
                switch (item.propertyID) {
                    case AutoActivityPropertyKeys.Tools: // 参与者
                        item.editor = ActivityComponentComponent;
                        item.converter = new ActivityComponentConverter(_this.localPipe);
                        item.editorParams = {
                            location: 'autoActivity'
                        };
                        break;
                    case AutoActivityPropertyKeys.variableSettings: // 变量设置
                        item.editor = VariableSettingComponent;
                        item.converter = new VariableSettingConverter(_this.localPipe);
                        break;
                    case AutoActivityPropertyKeys.ParticipantOptions: // 参与者选项
                        item.editor = PerformerOptionsComponent;
                        item.converter = new PerformerOptionsConverter(_this.localPipe);
                        item.editorParams = {
                            location: 'autoActivity'
                        };
                        break;
                    default:
                        break;
                }
            }));
        }
    };
    AutoActivityAdapter.decorators = [
        { type: Injectable }
    ];
    /** @nocollapse */
    AutoActivityAdapter.ctorParameters = function () { return [
        { type: ProcessDesignerUIState },
        { type: WfLocalePipe }
    ]; };
    return AutoActivityAdapter;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var EventDefinition = /** @class */ (function () {
    function EventDefinition() {
        this.triggerAction = 'Pass';
        this.Async = false;
    }
    return EventDefinition;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var EventDefinitionComponent = /** @class */ (function () {
    function EventDefinitionComponent(message, util, injector, cdr, localeId, resources, localePipe) {
        this.message = message;
        this.util = util;
        this.injector = injector;
        this.cdr = cdr;
        this.localeId = localeId;
        this.resources = resources;
        this.localePipe = localePipe;
        this.cls = 'farris-main-area flex-column';
        this.closeModal = new EventEmitter();
        this.submitModal = new EventEmitter();
        this.modalConfig = {
            title: this.localePipe.transform('component.eventDefinition.eventDefinition'),
            width: 560,
            height: 420,
            showButtons: true
        };
        this.triggerActionCollection = [
            { text: this.localePipe.transform('component.eventDefinition.pass'), value: 'Pass' },
            { text: this.localePipe.transform('component.eventDefinition.back'), value: 'Back' },
            { text: this.localePipe.transform('component.eventDefinition.abort'), value: 'Abort' }
        ];
        this.columns = new Array();
        this.data = new Array();
        this.localePipe = this.localePipe || new WfLocalePipe(localeId, resources);
    }
    Object.defineProperty(EventDefinitionComponent.prototype, "value", {
        set: /**
         * @param {?} items
         * @return {?}
         */
        function (items) {
            var e_1, _a;
            if (items && items.length > 0) {
                try {
                    for (var items_1 = __values(items), items_1_1 = items_1.next(); !items_1_1.done; items_1_1 = items_1.next()) {
                        var item = items_1_1.value;
                        /** @type {?} */
                        var event_1 = new EventDefinition();
                        event_1.Id = item.Id;
                        event_1.name = item.name;
                        event_1.triggerAction = item.triggerAction;
                        event_1.Async = item.Async;
                        event_1.SignalRef = item.SignalRef;
                        this.data.push(event_1);
                    }
                }
                catch (e_1_1) { e_1 = { error: e_1_1 }; }
                finally {
                    try {
                        if (items_1_1 && !items_1_1.done && (_a = items_1.return)) _a.call(items_1);
                    }
                    finally { if (e_1) throw e_1.error; }
                }
            }
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    EventDefinitionComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        this.columns = [{
                field: 'SignalRef', width: 100, title: this.localePipe.transform('component.eventDefinition.signalRef'),
                editor: { type: EditorTypes.TEXTBOX, options: {} },
                validators: [
                    { type: 'required', messager: '必填' }
                ]
            },
            {
                field: 'name', width: 100, title: this.localePipe.transform('component.eventDefinition.name'),
                editor: { type: EditorTypes.TEXTBOX, options: {} },
                validators: [
                    { type: 'required', messager: '必填' }
                ]
            },
            {
                field: 'triggerAction', width: 100, title: this.localePipe.transform('component.eventDefinition.triggerAction'),
                formatter: {
                    type: 'enum',
                    options: { valueField: 'value', textField: 'text', data: this.triggerActionCollection }
                },
                editor: {
                    type: EditorTypes.COMBOLIST,
                    options: { valueField: 'value', textField: 'text', data: this.triggerActionCollection, idField: 'value', panelHeight: 'auto', showClear: false }
                },
                validators: [
                    { type: 'required', messager: '必填' }
                ]
            }];
    };
    /**
     * @return {?}
     */
    EventDefinitionComponent.prototype.add = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var event = new EventDefinition();
        event.Id = ProcessDeUtil.GenerateElementId();
        this.data.push(event);
        this.grid.loadData(this.data);
    };
    /**
     * @return {?}
     */
    EventDefinitionComponent.prototype.delete = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.grid.endCellEdit();
        if (this.grid.selectedRow && this.grid.selectedRow.data) {
            /** @type {?} */
            var i = this.data.findIndex((/**
             * @param {?} d
             * @return {?}
             */
            function (d) { return d.Id === _this.grid.selectedRow.data.Id; }));
            this.data.splice(i, 1);
            this.grid.loadData(this.data);
        }
        else {
            this.message.info(this.localePipe.transform('component.eventDefinition.selectedRow'));
        }
    };
    /**
     * @return {?}
     */
    EventDefinitionComponent.prototype.clickOK = /**
     * @return {?}
     */
    function () {
        this.grid.endCellEdit();
        if (this.validator()) {
            /** @type {?} */
            var object = { value: this.data, parameters: null };
            this.submitModal.emit(object);
        }
    };
    /**
     * @return {?}
     */
    EventDefinitionComponent.prototype.clickCancel = /**
     * @return {?}
     */
    function () {
        this.closeModal.emit();
    };
    /**
     * @private
     * @return {?}
     */
    EventDefinitionComponent.prototype.validator = /**
     * @private
     * @return {?}
     */
    function () {
        var e_2, _a;
        if (this.data.length === 0) {
            this.message.info(this.localePipe.transform('component.eventDefinition.dataLength'));
            return false;
        }
        else {
            try {
                for (var _b = __values(this.data), _c = _b.next(); !_c.done; _c = _b.next()) {
                    var d = _c.value;
                    if (!d.SignalRef) {
                        this.message.info(this.localePipe.transform('component.eventDefinition.codeNotNull'));
                        return false;
                    }
                    else if (!d.name) {
                        this.message.info(this.localePipe.transform('component.eventDefinition.nameNotNull'));
                        return false;
                    }
                    else if (!isNaN(Number(d.SignalRef))) {
                        this.message.info(this.localePipe.transform('component.eventDefinition.codeNotNumber'));
                        return false;
                    }
                }
            }
            catch (e_2_1) { e_2 = { error: e_2_1 }; }
            finally {
                try {
                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                }
                finally { if (e_2) throw e_2.error; }
            }
            if (this.data.length > 1) {
                for (var i = 0; i < this.data.length; i++) {
                    /** @type {?} */
                    var code1 = this.data[i].SignalRef;
                    for (var j = i + 1; j < this.data.length; j++) {
                        /** @type {?} */
                        var code2 = this.data[j].SignalRef;
                        if (code1 === code2) {
                            this.message.warning(this.localePipe.transform('component.eventDefinition.codeRepeat'));
                            return false;
                        }
                    }
                }
            }
        }
        return true;
    };
    EventDefinitionComponent.decorators = [
        { type: Component, args: [{
                    selector: 'lib-event-definition',
                    template: "<div class=\"f-page\">\r\n  <div class=\"f-page-header\">\r\n    <nav class=\"f-page-header-base\">\r\n      <div class=\"f-title\">\r\n        <!-- <span class=\"f-title-icon f-text-orna-bill\">\r\n          <i class=\"f-icon f-icon-page-title-administer\"></i>\r\n        </span> -->\r\n        <!-- <h4 class=\"f-title-text\">\u5217\u8868</h4> -->\r\n      </div>\r\n      <div class=\"btn-toolbar btn-group-lg\">\r\n        <button class=\"btn btn-primary mr-2\" (click)=\"add()\">{{'component.eventDefinition.add' | wfLocale}}</button>\r\n        <button class=\"btn btn-secondary\" (click)=\"delete()\">{{'component.eventDefinition.delete' | wfLocale}}</button>\r\n      </div>\r\n    </nav>\r\n  </div>\r\n  <div class=\"f-page-main f-utils-fill-flex-column h-100\">\r\n    <div class=\"f-utils-fill-flex-column farris-overflow-y-auto h-100\">\r\n      <farris-datagrid #grid [data]=\"data\" [columns]=\"columns\" [idField]=\"'Id'\" [fit]=\"true\" [fitColumns]=\"true\"\r\n        [editable]=\"true\" [editMode]=\"'cell'\" [pagination]=\"false\" [showCheckbox]=\"false\" [multiSelect]=\"false\">\r\n      </farris-datagrid>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type=\"button\" class=\"btn btn-secondary btn-sm px-3 mx-2\" (click)=\"clickCancel()\">{{'component.eventDefinition.clickCancel' | wfLocale}}</button>\r\n  <button type=\"button\" class=\"btn btn-primary btn-sm px-3 mx-2\" (click)=\"clickOK()\">{{'component.eventDefinition.clickOK' | wfLocale}}</button>\r\n</ng-template>\r\n",
                    providers: [
                        WfLocalePipe,
                    ],
                    styles: [""]
                }] }
    ];
    /** @nocollapse */
    EventDefinitionComponent.ctorParameters = function () { return [
        { type: MessagerService },
        { type: ProcessDeUtil },
        { type: Injector },
        { type: ChangeDetectorRef, decorators: [{ type: Optional }] },
        { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
        { type: undefined, decorators: [{ type: Inject, args: [WF_LANG_RESOURCES,] }] },
        { type: WfLocalePipe, decorators: [{ type: Optional }] }
    ]; };
    EventDefinitionComponent.propDecorators = {
        cls: [{ type: HostBinding, args: ['class',] }],
        closeModal: [{ type: Output }],
        submitModal: [{ type: Output }],
        value: [{ type: Input }],
        modalFooter: [{ type: ViewChild, args: ['iconSelectFooter',] }],
        grid: [{ type: ViewChild, args: ['grid',] }]
    };
    return EventDefinitionComponent;
}());
var EventDefinitionConverter = /** @class */ (function () {
    function EventDefinitionConverter(localePipe) {
        this.localePipe = localePipe;
    }
    /**
     * @param {?} data
     * @return {?}
     */
    EventDefinitionConverter.prototype.convertTo = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        if (data && data.length > 0) {
            return this.localePipe.transform('component.eventDefinition.set');
        }
        else {
            return this.localePipe.transform('component.eventDefinition.notSet');
        }
    };
    return EventDefinitionConverter;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/** @enum {string} */
var IntermediateCatchEventImplPropertyKeys = {
    Id: "Id",
    Name: "Name",
    NameLanguage: "NameLanguage",
    ClrTypeID: "ClrTypeID",
    /**
     * 驳回规则
     */
    BackWardRule: 'BackWardRule',
    EventDefinitions: 'EventDefinitions',
    variableSettings: 'variableSettings',
};

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var CatchEventAdapter = /** @class */ (function () {
    function CatchEventAdapter(uiState, injector, localPipe) {
        this.uiState = uiState;
        this.injector = injector;
        this.localPipe = localPipe;
    }
    /**
     * @param {?} obj
     * @return {?}
     */
    CatchEventAdapter.prototype.setProperty = /**
     * @param {?} obj
     * @return {?}
     */
    function (obj) {
        this.uiState.propertyData = obj.propertyData;
        this.uiState.propertyConfig = this.setConfig(obj.propertyConfig);
    };
    /**
     * @private
     * @param {?} obj
     * @return {?}
     */
    CatchEventAdapter.prototype.setConfig = /**
     * @private
     * @param {?} obj
     * @return {?}
     */
    function (obj) {
        var _this = this;
        /** @type {?} */
        var propertyConfig = [];
        if (obj) {
            obj.forEach((/**
             * @param {?} element
             * @return {?}
             */
            function (element) {
                _this.setEntity(element.properties);
                propertyConfig.push(element);
            }));
        }
        return propertyConfig;
    };
    /**
     * @private
     * @param {?} obj
     * @return {?}
     */
    CatchEventAdapter.prototype.setEntity = /**
     * @private
     * @param {?} obj
     * @return {?}
     */
    function (obj) {
        var _this = this;
        if (obj && obj.length > 0) {
            obj.forEach((/**
             * @param {?} item
             * @return {?}
             */
            function (item) {
                switch (item.propertyID) {
                    case IntermediateCatchEventImplPropertyKeys.BackWardRule:
                        item.editor = BackwardRuleComponent;
                        item.converter = new BackwardRuleConverter(_this.localPipe);
                        item.editorParams = {
                            nodeType: 'CallActivitySubProcess'
                        };
                        break;
                    case IntermediateCatchEventImplPropertyKeys.EventDefinitions:
                        item.editor = EventDefinitionComponent;
                        item.converter = new EventDefinitionConverter(_this.localPipe);
                        break;
                    case IntermediateCatchEventImplPropertyKeys.variableSettings: // 变量设置
                        item.editor = VariableSettingComponent;
                        item.converter = new VariableSettingConverter(_this.localPipe);
                        break;
                    default:
                        break;
                }
            }));
        }
    };
    CatchEventAdapter.decorators = [
        { type: Injectable }
    ];
    /** @nocollapse */
    CatchEventAdapter.ctorParameters = function () { return [
        { type: ProcessDesignerUIState },
        { type: Injector },
        { type: WfLocalePipe }
    ]; };
    return CatchEventAdapter;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/** @enum {string} */
var MessageActivityPropertyKeys = {
    Id: "Id",
    Name: "Name",
    NameLanguage: "NameLanguage",
    ClrTypeID: "ClrTypeID",
    messageNotice: 'messageNotice',
    variableSettings: 'variableSettings',
};

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var MessageActivityAdapter = /** @class */ (function () {
    function MessageActivityAdapter(uiState, localPipe) {
        this.uiState = uiState;
        this.localPipe = localPipe;
    }
    /**
     * @param {?} obj
     * @return {?}
     */
    MessageActivityAdapter.prototype.setProperty = /**
     * @param {?} obj
     * @return {?}
     */
    function (obj) {
        this.uiState.propertyData = obj.propertyData;
        this.uiState.propertyConfig = this.setConfig(obj.propertyConfig);
    };
    /**
     * @private
     * @param {?} obj
     * @return {?}
     */
    MessageActivityAdapter.prototype.setConfig = /**
     * @private
     * @param {?} obj
     * @return {?}
     */
    function (obj) {
        var _this = this;
        /** @type {?} */
        var propertyConfig = [];
        if (obj) {
            obj.forEach((/**
             * @param {?} element
             * @return {?}
             */
            function (element) {
                _this.setEntity(element.properties);
                propertyConfig.push(element);
            }));
        }
        return propertyConfig;
    };
    /**
     * @private
     * @param {?} obj
     * @return {?}
     */
    MessageActivityAdapter.prototype.setEntity = /**
     * @private
     * @param {?} obj
     * @return {?}
     */
    function (obj) {
        var _this = this;
        if (obj && obj.length > 0) {
            obj.forEach((/**
             * @param {?} item
             * @return {?}
             */
            function (item) {
                switch (item.propertyID) {
                    case MessageActivityPropertyKeys.messageNotice: // 参与者
                        item.editor = MessageNoticeComponent;
                        item.converter = new MessageNoticeConverter(_this.localPipe);
                        item.editorParams = {
                            location: 'messageActivity'
                        };
                        break;
                    case MessageActivityPropertyKeys.variableSettings: // 变量设置
                        item.editor = VariableSettingComponent;
                        item.converter = new VariableSettingConverter(_this.localPipe);
                        break;
                    default:
                        break;
                }
            }));
        }
    };
    MessageActivityAdapter.decorators = [
        { type: Injectable }
    ];
    /** @nocollapse */
    MessageActivityAdapter.ctorParameters = function () { return [
        { type: ProcessDesignerUIState },
        { type: WfLocalePipe }
    ]; };
    return MessageActivityAdapter;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var AuditProcessDefInfo = /** @class */ (function () {
    function AuditProcessDefInfo() {
    }
    return AuditProcessDefInfo;
}());
/** @enum {string} */
var AuditEvent = {
    WF_ProcessDef_SaveDT: 'WF_ProcessDef_SaveDT',
    WF_ProcessDef_SaveRT: 'WF_ProcessDef_SaveRT',
    WF_ProcessDef_Deploy: 'WF_ProcessDef_Deploy',
    WF_ProcessDef_Import: 'WF_ProcessDef_Import',
    WF_ProcessDef_Export: 'WF_ProcessDef_Export',
    WF_ProcessDef_SyncDT: 'WF_ProcessDef_SyncDT',
};

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var ProcessInfo = /** @class */ (function () {
    function ProcessInfo() {
    }
    return ProcessInfo;
}());
var ProcessOrganization = /** @class */ (function () {
    function ProcessOrganization() {
    }
    return ProcessOrganization;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/** @enum {string} */
var NotifyActivityPropertyKeys = {
    Id: "Id",
    Name: "Name",
    NameLanguage: "NameLanguage",
    ClrTypeID: "ClrTypeID",
    /**
     * 参与者
     */
    ParticipantSchemes: 'ParticipantSchemes',
    /**
     * PC表单
     */
    wf_ExecuteForms_PC: 'wf_ExecuteForms_PC',
    /**
     * 移动表单
     */
    wf_ExecuteForms_Mobile: 'wf_ExecuteForms_Mobile',
    /**
     * 消息通知
     */
    messageNotice: 'messageNotice',
    NotifyAble: 'NotifyAble',
};

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var NotifyActivityAdapter = /** @class */ (function () {
    function NotifyActivityAdapter(uiState, localPipe) {
        this.uiState = uiState;
        this.localPipe = localPipe;
    }
    /**
     * @param {?} obj
     * @return {?}
     */
    NotifyActivityAdapter.prototype.setProperty = /**
     * @param {?} obj
     * @return {?}
     */
    function (obj) {
        this.uiState.propertyData = obj.propertyData;
        this.uiState.propertyConfig = this.setConfig(obj.propertyConfig);
    };
    /**
     * @private
     * @param {?} obj
     * @return {?}
     */
    NotifyActivityAdapter.prototype.setConfig = /**
     * @private
     * @param {?} obj
     * @return {?}
     */
    function (obj) {
        var _this = this;
        /** @type {?} */
        var propertyConfig = [];
        if (obj) {
            obj.forEach((/**
             * @param {?} element
             * @return {?}
             */
            function (element) {
                _this.setEntity(element.properties);
                propertyConfig.push(element);
            }));
        }
        return propertyConfig;
    };
    /**
     * @private
     * @param {?} obj
     * @return {?}
     */
    NotifyActivityAdapter.prototype.setEntity = /**
     * @private
     * @param {?} obj
     * @return {?}
     */
    function (obj) {
        var _this = this;
        if (obj && obj.length > 0) {
            obj.forEach((/**
             * @param {?} item
             * @return {?}
             */
            function (item) {
                switch (item.propertyID) {
                    case NotifyActivityPropertyKeys.Id: // 标识
                        break;
                    case NotifyActivityPropertyKeys.ParticipantSchemes: // 参与者
                        item.editor = ParticipantComponent;
                        item.converter = new ParticipantConverter(_this.localPipe);
                        item.editorParams = {
                            nodeType: 'notifyActivity'
                        };
                        break;
                    case NotifyActivityPropertyKeys.wf_ExecuteForms_PC: // 表单定义
                        item.editor = ExecuteFormsComponent;
                        /** @type {?} */
                        var params = {
                            location: 'notifyActivity',
                            tab: 'web'
                        };
                        item.converter = new ExecuteFormsConverter(params, _this.localPipe);
                        item.editorParams = params;
                        break;
                    case NotifyActivityPropertyKeys.wf_ExecuteForms_Mobile: // 表单定义
                        item.editor = ExecuteFormsComponent;
                        /** @type {?} */
                        var editorParams = {
                            location: 'notifyActivity',
                            tab: 'mobile'
                        };
                        item.converter = new ExecuteFormsConverter(editorParams, _this.localPipe);
                        item.editorParams = editorParams;
                        break;
                    case NotifyActivityPropertyKeys.messageNotice: // 消息通知
                        item.editor = MessageNoticeComponent;
                        item.converter = new MessageNoticeConverter(_this.localPipe);
                        item.editorParams = {
                            location: 'activity'
                        };
                        break;
                    case NotifyActivityPropertyKeys.NotifyAble: // 允许知会
                        item.editor = OrganizationPotentialOwnerComponent;
                        item.converter = new OrganizationPotentialOwnerConverter(_this.localPipe);
                        item.editorParams = {
                            nodeType: 'notifyActivity',
                        };
                        break;
                    default:
                        item.editor = ExtendPropertyComponent;
                        item.converter = new ExtendPropertyConverter(_this.localPipe);
                        break;
                }
            }));
        }
    };
    NotifyActivityAdapter.decorators = [
        { type: Injectable }
    ];
    /** @nocollapse */
    NotifyActivityAdapter.ctorParameters = function () { return [
        { type: ProcessDesignerUIState },
        { type: WfLocalePipe }
    ]; };
    return NotifyActivityAdapter;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var AifCreationBillProcessConverter = /** @class */ (function () {
    function AifCreationBillProcessConverter(localePipe) {
        this.localePipe = localePipe;
    }
    /**
     * @param {?} data
     * @return {?}
     */
    AifCreationBillProcessConverter.prototype.convertTo = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        if (data) {
            return data.name || data.code || this.localePipe.transform("set");
        }
        else {
            return this.localePipe.transform("notSet");
        }
    };
    return AifCreationBillProcessConverter;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/** @enum {string} */
var AifCreationBillActivityPropertyKeys = {
    Id: "Id",
    Name: "Name",
    NameLanguage: "NameLanguage",
    ClrTypeID: "ClrTypeID",
    /**
     * 生单流程编号
     */
    aifProcessCode: 'aifProcessCode',
    /**
     * VoNodePath
     */
    voNodePath: 'voNodePath',
    /**
     * isRelied
     */
    isRelied: 'isRelied',
};

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var AifCreationBillActivityAdapter = /** @class */ (function () {
    function AifCreationBillActivityAdapter(uiState, localPipe) {
        this.uiState = uiState;
        this.localPipe = localPipe;
    }
    /**
     * @param {?} obj
     * @return {?}
     */
    AifCreationBillActivityAdapter.prototype.setProperty = /**
     * @param {?} obj
     * @return {?}
     */
    function (obj) {
        this.uiState.propertyData = obj.propertyData;
        this.uiState.propertyConfig = this.setConfig(obj.propertyConfig);
    };
    /**
     * @private
     * @param {?} obj
     * @return {?}
     */
    AifCreationBillActivityAdapter.prototype.setConfig = /**
     * @private
     * @param {?} obj
     * @return {?}
     */
    function (obj) {
        var _this = this;
        /** @type {?} */
        var propertyConfig = [];
        if (obj) {
            obj.forEach((/**
             * @param {?} element
             * @return {?}
             */
            function (element) {
                _this.setEntity(element.properties);
                propertyConfig.push(element);
            }));
        }
        return propertyConfig;
    };
    /**
     * @private
     * @param {?} obj
     * @return {?}
     */
    AifCreationBillActivityAdapter.prototype.setEntity = /**
     * @private
     * @param {?} obj
     * @return {?}
     */
    function (obj) {
        var _this = this;
        if (obj && obj.length > 0) {
            obj.forEach((/**
             * @param {?} item
             * @return {?}
             */
            function (item) {
                switch (item.propertyID) {
                    case AifCreationBillActivityPropertyKeys.aifProcessCode: // 单据流编号
                        item.editor = ProcessListHelpComponent;
                        item.converter = new AifCreationBillProcessConverter(_this.localPipe);
                        item.editorParams = {
                            bizTypeId: _this.uiState.flowFormInfo.flowForm.businessObjectId
                        };
                        break;
                    default:
                        break;
                }
            }));
        }
    };
    AifCreationBillActivityAdapter.decorators = [
        { type: Injectable }
    ];
    /** @nocollapse */
    AifCreationBillActivityAdapter.ctorParameters = function () { return [
        { type: ProcessDesignerUIState },
        { type: AifLocalePipe }
    ]; };
    return AifCreationBillActivityAdapter;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/**
 * Global EventEmitter
 * @template Events
 */
var EventBusService = /** @class */ (function () {
    function EventBusService() {
        /**
         * Map event name to Subject
         */
        this._subjects = new Map();
    }
    /**
     *
     * @param eventName
     * @param handler
     * @returns
     */
    /**
     *
     * @param {?} eventName
     * @param {?} handler
     * @return {?}
     */
    EventBusService.prototype.on = /**
     *
     * @param {?} eventName
     * @param {?} handler
     * @return {?}
     */
    function (eventName, handler) {
        var _this = this;
        if (!this._subjects.has(eventName)) {
            this._subjects.set(eventName, new Subject$1());
        }
        /** @type {?} */
        var _subject = this._subjects.get(eventName);
        /** @type {?} */
        var subscription = _subject.subscribe(handler);
        return {
            unsubscribe: (/**
             * @return {?}
             */
            function () {
                subscription.unsubscribe();
                if (_subject.observers.length > 0) {
                    _this._subjects.delete(eventName);
                }
            })
        };
    };
    /**
     *
     * @param eventName
     * @param data
     */
    /**
     *
     * @param {?} eventName
     * @param {?} data
     * @return {?}
     */
    EventBusService.prototype.emit = /**
     *
     * @param {?} eventName
     * @param {?} data
     * @return {?}
     */
    function (eventName, data) {
        if (this._subjects.has(eventName)) {
            this._subjects.get(eventName).next(data);
        }
    };
    /**
     * Destory all subscription and clear the map
     */
    /**
     * Destory all subscription and clear the map
     * @return {?}
     */
    EventBusService.prototype.destroy = /**
     * Destory all subscription and clear the map
     * @return {?}
     */
    function () {
        this._subjects.forEach((/**
         * @param {?} subject
         * @param {?} _
         * @return {?}
         */
        function (subject, _) {
            subject.unsubscribe();
        }));
        this._subjects.clear();
    };
    EventBusService.decorators = [
        { type: Injectable }
    ];
    return EventBusService;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var ReleaseComponent = /** @class */ (function () {
    function ReleaseComponent(uiState, submitService, cdr, localeId, resources, localePipe) {
        this.uiState = uiState;
        this.submitService = submitService;
        this.cdr = cdr;
        this.localeId = localeId;
        this.resources = resources;
        this.localePipe = localePipe;
        this.submit = new EventEmitter();
        this.cancel = new EventEmitter();
        this.accessLevel = 'public';
        this.isAdministratorConfig = false;
        this.dataUri = '/api/runtime/sys/v1.0/sysOrgs';
        this.loadType = 'layerload';
        this.releaseType = 'release';
        this.items = new Array();
        this.releaseTypeList = [
            { value: 'release', name: this.localePipe.transform('component.release.release') },
            { value: 'update', name: this.localePipe.transform('component.release.update') },
        ];
        this.localePipe = this.localePipe || new WfLocalePipe(localeId, resources);
    }
    /**
     * @return {?}
     */
    ReleaseComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.releaseType = this.procVersion === 1 ? 'release' : 'update';
        this.uiState.getUserInfo().subscribe((/**
         * @param {?} re
         * @return {?}
         */
        function (re) {
            _this.applicantName = re.name;
            _this.applicantDepartment = re.orgName;
            _this.applicantId = re.id;
        }));
    };
    /**
     * @return {?}
     */
    ReleaseComponent.prototype.saveAsOK = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.uiState.createData().subscribe((/**
         * @param {?} saveData
         * @return {?}
         */
        function (saveData) {
            /** @type {?} */
            var dataId = saveData.returnValue.id;
            /** @type {?} */
            var data = {
                DataId: dataId,
                applicantName: _this.applicantName,
                applicantDepartment: _this.applicantDepartment,
                procName: _this.procName,
                procVersion: _this.procVersion,
                releaseType: _this.releaseType,
                textDetail: _this.textDetail,
                processDefinitionKey: _this.processDefinitionKey,
                applicantId: _this.applicantId
            };
            /** @type {?} */
            var Info = {
                ChangeType: 'Modify',
                ChangeInfo: data
            };
            _this.uiState.releaseSave(Info).subscribe((/**
             * @param {?} re
             * @return {?}
             */
            function (re) {
                _this.mySubmit(dataId, '03bdca37-8439-4924-8aef-20f3f4092b59');
                _this.submit.next();
            }));
        }));
    };
    /**
     * @return {?}
     */
    ReleaseComponent.prototype.saveAsCancel = /**
     * @return {?}
     */
    function () {
        this.cancel.emit();
    };
    /**
     * @param {?} quill
     * @return {?}
     */
    ReleaseComponent.prototype.editorCreated = /**
     * @param {?} quill
     * @return {?}
     */
    function (quill) {
        /** @type {?} */
        var toolbar = quill.getModule('toolbar');
        this.editor = quill;
    };
    /**
     * @param {?} v
     * @return {?}
     */
    ReleaseComponent.prototype.contentChanged = /**
     * @param {?} v
     * @return {?}
     */
    function (v) {
        console.log(v);
    };
    /**
     * @return {?}
     */
    ReleaseComponent.prototype.validator = /**
     * @return {?}
     */
    function () {
        return true;
    };
    /**
     * @param {?} data
     * @return {?}
     */
    ReleaseComponent.prototype.changeValue = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        this.releaseType = data;
    };
    /**
     * 发布前审核：提交审批
     */
    /**
     * 发布前审核：提交审批
     * @private
     * @param {?} dataId
     * @param {?} bizDefKey
     * @return {?}
     */
    ReleaseComponent.prototype.mySubmit = /**
     * 发布前审核：提交审批
     * @private
     * @param {?} dataId
     * @param {?} bizDefKey
     * @return {?}
     */
    function (dataId, bizDefKey) {
        this.submitService.submitWithBizDefKey(dataId, bizDefKey);
    };
    ReleaseComponent.decorators = [
        { type: Component, args: [{
                    selector: 'lib-release-component',
                    template: "<div class=\"f-page f-page-card f-page-is-mainsubcard\">\r\n  <section class=\"f-page-main\">\r\n    <div class=\"f-struct-wrapper\">\r\n      <!-- <farris-section class=\"f-section-form f-section-in-mainsubcard\" [enableAccordion]=\"''\"\r\n        [subTitle]=\"''\" [enableMaximize]=\"false\"> -->\r\n        <div class=\"f-form-layout farris-form farris-form-controls-inline pr-4 m-2\">\r\n          <div class=\"col-12 px-0 my-2\">\r\n            <div class=\"farris-group-wrap\">\r\n              <div class=\"form-group farris-form-group\">\r\n                <label class=\"col-form-label\">\r\n                  <span class=\"farris-label-text\">{{'component.release.applicantName' | wfLocale}}</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap\">\r\n                  <input type=\"text\" class=\"form-control\" [(ngModel)]=\"applicantName\" name=\"procName\" [readOnly]=\"true\"/>\r\n                  <div class=\"farris-feedback valid-feedback\"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"col-12 px-0 my-2\">\r\n            <div class=\"farris-group-wrap\">\r\n              <div class=\"form-group farris-form-group\">\r\n                <label class=\"col-form-label\">\r\n                  <span class=\"farris-label-text\">{{'component.release.applicantDepartment' | wfLocale}}</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap\">\r\n                  <input type=\"text\" class=\"form-control\" [(ngModel)]=\"applicantDepartment\" name=\"procKey\" [readOnly]=\"true\"/>\r\n                  <div class=\"farris-feedback valid-feedback\"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"col-12 px-0 my-2\">\r\n            <div class=\"farris-group-wrap\">\r\n              <div class=\"form-group farris-form-group\">\r\n                <label class=\"col-form-label\">\r\n                  <span class=\"farris-label-text\">{{'component.release.procName' | wfLocale}}</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap\">\r\n                  <input type=\"text\" class=\"form-control\" [(ngModel)]=\"procName\" name=\"procName\" [readOnly]=\"true\"/>\r\n                  <div class=\"farris-feedback valid-feedback\"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"col-12 px-0 my-2\">\r\n            <div class=\"farris-group-wrap\">\r\n              <div class=\"form-group farris-form-group\">\r\n                <label class=\"col-form-label\">\r\n                  <span class=\"farris-label-text\">{{'component.release.procVersion' | wfLocale}}</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap\">\r\n                  <input type=\"text\" class=\"form-control\" [(ngModel)]=\"procVersion\" name=\"procVersion\" [readOnly]=\"true\"/>\r\n                  <div class=\"farris-feedback valid-feedback\"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"col-12 px-0 my-2\">\r\n            <div class=\"farris-group-wrap\">\r\n              <div class=\"form-group farris-form-group\">\r\n                <label class=\"col-form-label\">\r\n                  <span class=\"farris-label-text\">{{'component.release.releaseType' | wfLocale}}</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap\">\r\n                  <farris-radiogroup [(ngModel)]=\"releaseType\" name=\"releaseType\" [data]=\"releaseTypeList\"\r\n                  [horizontal]=\"true\" (changeValue)=\"changeValue($event)\" [disabled]=\"true\">\r\n                  </farris-radiogroup>\r\n                  <div class=\"farris-feedback valid-feedback\"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"col-12 px-0 my-2\">\r\n            <div class=\"farris-group-wrap\">\r\n              <div class=\"form-group farris-form-group\">\r\n                <label class=\"col-form-label\">\r\n                  <span class=\"farris-label-text\">{{'component.release.textDetail' | wfLocale}}</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap\">\r\n                  <textarea [(ngModel)]=\"textDetail\" name=\"textarea\" id=\"textarea\" style=\"height: 250px; width: 100%\"\r\n                  [auto-size]=\"true\" [maxHeight]=\"500\" [textarea-zoom]=\"true\"></textarea>\r\n                  <div class=\"farris-feedback valid-feedback\"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      <!-- </farris-section> -->\r\n    </div>\r\n  </section>\r\n</div>\r\n\r\n<ng-template #buttonRef>\r\n  <button type=\"button\" class=\"btn btn-secondary btn-sm mx-2\" (click)=\"saveAsCancel()\">{{'component.release.saveAsCancel' | wfLocale}}</button>\r\n  <button type=\"button\" class=\"btn btn-sm btn-primary mx-2\" (click)=\"saveAsOK()\">{{'component.release.saveAsOK' | wfLocale}}</button>\r\n</ng-template>\r\n",
                    providers: [
                        WfLocalePipe,
                    ],
                    styles: [""]
                }] }
    ];
    /** @nocollapse */
    ReleaseComponent.ctorParameters = function () { return [
        { type: ProcessDesignerUIState },
        { type: WfTaskHandlerService },
        { type: ChangeDetectorRef, decorators: [{ type: Optional }] },
        { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
        { type: undefined, decorators: [{ type: Inject, args: [WF_LANG_RESOURCES,] }] },
        { type: WfLocalePipe, decorators: [{ type: Optional }] }
    ]; };
    ReleaseComponent.propDecorators = {
        btnRef: [{ type: ViewChild, args: ['buttonRef',] }],
        procName: [{ type: Input }],
        procVersion: [{ type: Input }],
        processDefinitionKey: [{ type: Input }],
        lookUp: [{ type: ViewChild, args: ['lookup',] }],
        submit: [{ type: Output }],
        cancel: [{ type: Output }]
    };
    return ReleaseComponent;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var DocuTypeHelperEntity = /** @class */ (function (_super) {
    __extends(DocuTypeHelperEntity, _super);
    function DocuTypeHelperEntity() {
        return _super.call(this) || this;
    }
    /**
     * @protected
     * @return {?}
     */
    DocuTypeHelperEntity.prototype.ResetBeforeLoadFrom = /**
     * @protected
     * @return {?}
     */
    function () {
        _super.prototype.ResetBeforeLoadFrom.call(this);
        this.id = null;
        this.moduleName = null;
        this.bizKindName = null;
        this.bizTypeName = null;
        this.code = null;
        this.name = null;
    };
    /**
     * @return {?}
     */
    DocuTypeHelperEntity.prototype.ConvertToJsonObject = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var obj = _super.prototype.ConvertToJsonObject.call(this);
        BpmnModelJsonHelper$1.SetAttributeValue(obj, "id", this.id);
        BpmnModelJsonHelper$1.SetAttributeValue(obj, "moduleName", this.moduleName);
        BpmnModelJsonHelper$1.SetAttributeValue(obj, "bizKindName", this.bizKindName);
        BpmnModelJsonHelper$1.SetAttributeValue(obj, "bizTypeName", this.bizTypeName);
        BpmnModelJsonHelper$1.SetAttributeValue(obj, "code", this.code);
        BpmnModelJsonHelper$1.SetAttributeValue(obj, "name", this.name);
        return obj;
    };
    /**
     * @param {?} obj
     * @return {?}
     */
    DocuTypeHelperEntity.prototype.LoadFromJsonObject = /**
     * @param {?} obj
     * @return {?}
     */
    function (obj) {
        _super.prototype.LoadFromJsonObject.call(this, obj);
        this.id = BpmnModelJsonHelper$1.GetAttributeValueAsString(obj, "id");
        this.moduleName = BpmnModelJsonHelper$1.GetAttributeValueAsString(obj, "moduleName");
        this.bizKindName = BpmnModelJsonHelper$1.GetAttributeValueAsString(obj, "bizKindName");
        this.bizTypeName = BpmnModelJsonHelper$1.GetAttributeValueAsString(obj, "bizTypeName");
        this.code = BpmnModelJsonHelper$1.GetAttributeValueAsString(obj, "code");
        this.name = BpmnModelJsonHelper$1.GetAttributeValueAsString(obj, "name");
    };
    return DocuTypeHelperEntity;
}(JsonConvertableImpl$1));

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var BillTypeHelpService = /** @class */ (function () {
    function BillTypeHelpService(boRtService, httpClient, httpService, sessionService, notify, translate) {
        this.boRtService = boRtService;
        this.httpClient = httpClient;
        this.httpService = httpService;
        this.sessionService = sessionService;
        this.notify = notify;
        this.translate = translate;
        this.documentTypeUrl = "/api/runtime/aif/v1.0/documenttype";
    }
    /**
     * @return {?}
     */
    BillTypeHelpService.prototype.findDocumentTypeEntites = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var body = {};
        return this.httpService.post(this.documentTypeUrl + "/docutypehelper", body).pipe(map((/**
         * @param {?} res
         * @return {?}
         */
        function (res) {
            return res.map((/**
             * @param {?} it
             * @return {?}
             */
            function (it) {
                /** @type {?} */
                var e = new DocuTypeHelperEntity();
                e.LoadFromJsonObject(it);
                return e;
            }));
        })));
    };
    BillTypeHelpService.decorators = [
        { type: Injectable }
    ];
    /** @nocollapse */
    BillTypeHelpService.ctorParameters = function () { return [
        { type: BusinessObjectRtService },
        { type: HttpService },
        { type: HttpService },
        { type: SessionService },
        { type: NotifyService },
        { type: TranslateService }
    ]; };
    return BillTypeHelpService;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/** @type {?} */
var BILL_TYPE_HELP_LANG_RESOURCES = {
    "zh-CHS": {
        "code": "编号",
        "name": "名称",
        "busineseCategory": "业务种类",
        "module": "模块",
        "busineseType": "业务类型",
        "collapse": "收起",
        "expand": "展开",
        "loading": "加载中",
        "allColumns": "所有列",
    },
    "en": {
        "code": "Code",
        "name": "Name",
        "busineseCategory": "Businese Category",
        "module": "Module",
        "busineseType": "Businese Type",
        "collapse": "Collapse",
        "expand": "Expand",
        "loading": "Loading",
        "allColumns": "All Columns",
    },
    "zh-CHT": {
        "code": "編號",
        "name": "名稱",
        "busineseCategory": "業務種類",
        "module": "模塊",
        "busineseType": "業務類型",
        "collapse": "收起",
        "expand": "展開",
        "loading": "加載中",
        "allColumns": "所有列",
    }
};

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var ɵ0$2 = BILL_TYPE_HELP_LANG_RESOURCES;
var BillTypeHelpComponent = /** @class */ (function () {
    function BillTypeHelpComponent(entityService, messager, notify, modal, loading, localePipe, router, activatedRoute) {
        this.entityService = entityService;
        this.messager = messager;
        this.notify = notify;
        this.modal = modal;
        this.loading = loading;
        this.localePipe = localePipe;
        this.router = router;
        this.activatedRoute = activatedRoute;
        this.onselected = new EventEmitter();
        this.ttIdField = 'id';
        this.ttSearchFields = [];
        this.ttAllColumnsTitle = this.localePipe.instant("allColumns");
        this.docuTypeList = [];
    }
    /**
     * @return {?}
     */
    BillTypeHelpComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        this.configLookupColumns();
        this.loadItems();
    };
    /**
     * @return {?}
     */
    BillTypeHelpComponent.prototype.getSelectedDocuType = /**
     * @return {?}
     */
    function () {
        return this.tt.selectedRow && this.tt.selectedRow.data;
    };
    /**
     * 左侧树表搜索事件
     */
    /**
     * 左侧树表搜索事件
     * @param {?} obj
     * @return {?}
     */
    BillTypeHelpComponent.prototype.ttSearch = /**
     * 左侧树表搜索事件
     * @param {?} obj
     * @return {?}
     */
    function (obj) {
        this.ttSearchObj = obj;
        this.ttSearchObj && this.tt.searchHandle.search(this.ttSearchObj.field, this.ttSearchObj.value);
    };
    /**
     * @return {?}
     */
    BillTypeHelpComponent.prototype.loadItems = /**
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var entities$ = null;
        entities$ = this.entityService.findDocumentTypeEntites();
        /** @type {?} */
        var l = this.loading.show({ message: this.localePipe.instant("loading") });
        entities$.subscribe((/**
         * @param {?} entities
         * @return {?}
         */
        function (entities) {
            l.close();
            _this.ttData = __spread(_this.buildTreeData(entities));
            _this.docuTypeList = entities;
            setTimeout((/**
             * @return {?}
             */
            function () {
                _this.tt.expandAll();
                if (_this.docuTypeId) {
                    _this.tt.selectNode(_this.docuTypeId);
                }
                else {
                    //默认选中第一条数据
                    _this.docuTypeList && _this.docuTypeList.length > 0 && _this.tt.selectNode(_this.docuTypeList[0].id);
                }
            }), 100);
        }), (/**
         * @param {?} err
         * @return {?}
         */
        function (err) {
            l.close();
            //todo 确定异常结构, 目前采用兼容取值方式
            _this.messager.error(err.error == null ? err.message : (err.error.Message || err.error.message || err.message));
            throw err;
        }));
    };
    /**
     * @param {?} nsp
     * @return {?}
     */
    BillTypeHelpComponent.prototype.ttNodeSelected = /**
     * @param {?} nsp
     * @return {?}
     */
    function (nsp) {
        /** @type {?} */
        var rows = [];
        if (Array.isArray(nsp.node)) {
            /** @type {?} */
            var arr = nsp.node;
            arr.forEach((/**
             * @param {?} it
             * @return {?}
             */
            function (it) {
                rows.push(it);
            }));
        }
        else {
            rows.push(nsp.node);
        }
        if (rows.length == 0) {
            return;
        }
        /** @type {?} */
        var row = rows[0];
        this.docuTypeId = row.id;
    };
    /**
     * @param {?} entities
     * @return {?}
     */
    BillTypeHelpComponent.prototype.buildTreeData = /**
     * @param {?} entities
     * @return {?}
     */
    function (entities) {
        /** @type {?} */
        var nodes = [];
        /** @type {?} */
        var map$$1 = {};
        entities && entities.forEach((/**
         * @param {?} it
         * @return {?}
         */
        function (it) {
            if (map$$1[it.bizKindName] == null) {
                map$$1[it.bizKindName] = [it];
            }
            else {
                map$$1[it.bizKindName].push(it);
            }
        }));
        Object.keys(map$$1).forEach((/**
         * @param {?} key
         * @return {?}
         */
        function (key) {
            /** @type {?} */
            var node = {
                id: key,
                data: {
                    id: key,
                    bizKindName: key,
                    treeInfo: {
                        layer: 1,
                    }
                },
                selectable: false,
                leaf: false,
            };
            /** @type {?} */
            var children = map$$1[key].map((/**
             * @param {?} it
             * @return {?}
             */
            function (it) {
                /** @type {?} */
                var node = {
                    id: it.id,
                    data: __assign({}, it, { treeInfo: {
                            layer: 2,
                            parentId: key,
                        } }),
                    selectable: true,
                    leaf: true
                };
                return node;
            }));
            node.children = children;
            nodes.push(node);
        }));
        return nodes;
    };
    /**
     * @private
     * @return {?}
     */
    BillTypeHelpComponent.prototype.configLookupColumns = /**
     * @private
     * @return {?}
     */
    function () {
        this.ttCols = [
            { field: "bizKindName", title: this.localePipe.instant("busineseCategory"), width: 100 },
            { field: "name", title: this.localePipe.instant("name"), width: 80 },
            { field: "code", title: this.localePipe.instant("code"), width: 80 },
            { field: "moduleName", title: this.localePipe.instant("module"), width: 100 },
            { field: "bizTypeName", title: this.localePipe.instant("busineseType"), width: 100 },
        ];
    };
    BillTypeHelpComponent.decorators = [
        { type: Component, args: [{
                    selector: 'app-bill-type-help',
                    template: "<div class=\"g-main\" style=\"padding-left: 24px; padding-right: 24px;\">\r\n  <div class=\"h-100 d-flex flex-column\">\r\n    <farris-treetable #tt class=\"f-utils-fill-flex-column\" [data]=\"ttData\" [columns]=\"ttCols\" [idField]=\"ttIdField\"\r\n      [fit]=\"true\" [showFilterBar]=\"true\" [searchFields]=\"ttSearchFields\" [showIcon]=\"false\" [resizableColumns]=\"true\"\r\n      [showBorder]=\"true\" [striped]=\"true\" [allColumnsTitle]=\"ttAllColumnsTitle\" [expandLevel]=\"0\" [showHeader]=\"true\"\r\n      [fixedHeader]=\"true\" [singleSelect]=\"true\" [showCheckbox]=\"false\" [showCheckAll]=\"false\" [checkOnSelect]=\"true\"\r\n      [selectOnCheck]=\"true\" (search)=\"ttSearch($event)\" (nodeSelected)=\"ttNodeSelected($event)\">\r\n    </farris-treetable>\r\n  </div>\r\n</div>",
                    providers: [
                        { provide: BIF_LANG_RESOURCES, useValue: ɵ0$2 },
                        AifLocalePipe,
                    ],
                    styles: [""]
                }] }
    ];
    /** @nocollapse */
    BillTypeHelpComponent.ctorParameters = function () { return [
        { type: BillTypeHelpService },
        { type: MessagerService },
        { type: NotifyService },
        { type: BsModalService },
        { type: LoadingService },
        { type: AifLocalePipe },
        { type: Router },
        { type: ActivatedRoute }
    ]; };
    BillTypeHelpComponent.propDecorators = {
        onselected: [{ type: Output, args: ["onselected",] }],
        tt: [{ type: ViewChild, args: ['tt',] }]
    };
    return BillTypeHelpComponent;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var VoConfigComponent = /** @class */ (function () {
    function VoConfigComponent(messager, notify, modal, framework, router, activatedRoute, loading, cfr, inj, cdr, localeId, resources, localePipe) {
        this.messager = messager;
        this.notify = notify;
        this.modal = modal;
        this.framework = framework;
        this.router = router;
        this.activatedRoute = activatedRoute;
        this.loading = loading;
        this.cfr = cfr;
        this.inj = inj;
        this.cdr = cdr;
        this.localeId = localeId;
        this.resources = resources;
        this.localePipe = localePipe;
        this.groupIcon = '<i class="f-icon f-icon-lookup"></i>';
        this.closeModal = new EventEmitter();
        this.submitModal = new EventEmitter();
        this.editorParams = {};
        this.modalConfig = {
            title: this.localePipe.transform("component.voConfig.documentInfo"),
            width: 500,
            height: 240,
            showButtons: true
        };
        this.entity = {};
        this.localePipe = this.localePipe || new WfLocalePipe(localeId, resources);
    }
    Object.defineProperty(VoConfigComponent.prototype, "value", {
        set: /**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            if (data) {
                this.entity = data || {};
            }
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    VoConfigComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
    };
    /**
     * @return {?}
     */
    VoConfigComponent.prototype.clickOk = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var obj = { value: this.entity, parameters: null };
        this.submitModal.emit(obj);
    };
    /**
     * @return {?}
     */
    VoConfigComponent.prototype.clickCancel = /**
     * @return {?}
     */
    function () {
        this.closeModal.emit();
    };
    /**
     * @return {?}
     */
    VoConfigComponent.prototype.selectVo = /**
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var compFactory = this.cfr.resolveComponentFactory(SelectMetadataRTComponent);
        /** @type {?} */
        var compRef = compFactory.create(this.inj);
        compRef.instance.typeList = 'GSPViewModel';
        // 元数据选择器bizTypeId表示业务种类Id
        compRef.instance.bizTypeId = this.editorParams && this.editorParams.bizTypeId;
        compRef.instance.selectedMetadata.subscribe((/**
         * @param {?} metadata4RefDto
         * @return {?}
         */
        function (metadata4RefDto) {
            _this.clearVo();
            /** @type {?} */
            var voDto = metadata4RefDto.metadata;
            /** @type {?} */
            var vo = JSON.parse(voDto.content);
            _this.entity.currentVoId = vo.ID;
            _this.entity.currentVoName = vo.Name;
        }), (/**
         * @param {?} err
         * @return {?}
         */
        function (err) {
            console.error(err);
            // todo 确定异常结构, 目前采用兼容取值方式
            _this.messager.error(err.error == null ? err.message : (err.error.Message || err.error.message || err.message));
            _this.clearVo();
        }));
        /** @type {?} */
        var modalConfig = {
            title: this.localePipe.transform("component.voConfig.viewModelSelection"),
            width: 930,
            height: 573,
            showButtons: false
        };
        /** @type {?} */
        var dialog = this.modal.show(compRef, modalConfig);
        compRef.instance.closeModalEmitter.subscribe((/**
         * @param {?} $event
         * @return {?}
         */
        function ($event) { return dialog.close(); }));
    };
    /**
     * @return {?}
     */
    VoConfigComponent.prototype.clearVo = /**
     * @return {?}
     */
    function () {
        this.entity.currentVoId = undefined;
        this.entity.currentVoName = undefined;
    };
    /**
     * @return {?}
     */
    VoConfigComponent.prototype.selectDocuType = /**
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var cmpF = this.cfr.resolveComponentFactory(BillTypeHelpComponent);
        /** @type {?} */
        var cmpR = cmpF.create(this.inj, []);
        cmpR.instance.docuTypeId = this.entity.currentDocumentTypeId;
        /** @type {?} */
        var buttons = [];
        buttons.push({
            text: this.localePipe.transform("component.voConfig.cancel"),
            cls: "btn btn-secondary",
            handle: (/**
             * @return {?}
             */
            function () {
                bsModal && bsModal.close();
            })
        });
        buttons.push({
            text: this.localePipe.transform("component.voConfig.clickOk"),
            cls: "btn btn-primary",
            handle: (/**
             * @return {?}
             */
            function () {
                /** @type {?} */
                var docuType = cmpR.instance.getSelectedDocuType();
                if (docuType == null) {
                    _this.notify.warning(_this.localePipe.transform("component.voConfig.selectOne"));
                    return;
                }
                _this.entity.currentDocumentTypeId = docuType.id;
                _this.entity.currentDocumentTypeName = docuType.name;
                bsModal && bsModal.close();
            })
        });
        /** @type {?} */
        var bsModal = this.modal.show(cmpR, {
            title: this.localePipe.transform("component.voConfig.documentTypeSelect"),
            height: 573,
            width: 930,
            buttons: buttons,
            showMaxButton: false,
        });
    };
    /**
     * @return {?}
     */
    VoConfigComponent.prototype.clearDocuType = /**
     * @return {?}
     */
    function () {
        this.entity.currentDocumentTypeId = undefined;
        this.entity.currentDocumentTypeName = undefined;
    };
    VoConfigComponent.decorators = [
        { type: Component, args: [{
                    selector: 'lib-vo-config',
                    template: "<div class=\"f-page f-page-card f-page-is-mainsubcard\" id=\"bif-manager-list\">\r\n  <div class=\"f-page-main\" id=\"page-main\" style=\"overflow-y: auto;\">\r\n    <div class=\"f-form-layout farris-form farris-form-controls-inline\">\r\n      <div class=\"col-12\">\r\n        <div class=\"farris-group-wrap\">\r\n          <div class=\"form-group farris-form-group\">\r\n            <label class=\"col-form-label\" title=\"{{'component.voConfig.viewModel' | wfLocale}}\" for=\"vo\">\r\n              <span class=\"farris-label-text\">{{'component.voConfig.viewModel' | wfLocale}}</span>\r\n            </label>\r\n            <div class=\"farris-input-wrap\">\r\n              <input-group id=\"vo\" [ngModel]=\"entity&&entity.currentVoName\" [editable]=\"false\" [enableClear]=\"false\"\r\n                (clickHandle)=\"selectVo()\" (clear)=\"clearVo()\" [groupText]=\"groupIcon\" placeholder=\"{{'component.voConfig.placeholder' | wfLocale}}\">\r\n              </input-group>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div class=\"col-12\">\r\n        <div class=\"farris-group-wrap\">\r\n          <div class=\"form-group farris-form-group\">\r\n            <label class=\"col-form-label\" title=\"{{'component.voConfig.documenttype' | wfLocale}}\" for=\"vo\">\r\n              <span class=\"farris-label-text\">{{'component.voConfig.documenttype' | wfLocale}}</span>\r\n            </label>\r\n            <div class=\"farris-input-wrap\">\r\n              <input-group id=\"vo\" [ngModel]=\"entity&&entity.currentDocumentTypeName\" [editable]=\"false\"\r\n                [enableClear]=\"false\" (clickHandle)=\"selectDocuType()\" (clear)=\"clearDocuType()\" [groupText]=\"groupIcon\"\r\n                placeholder=\"{{'component.voConfig.placeholder' | wfLocale}}\">\r\n              </input-group>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type=\"button\" class=\"btn btn-secondary btn-sm px-3 mx-2\" (click)=\"clickCancel()\">{{'component.voConfig.cancel' | wfLocale}}</button>\r\n  <button type=\"button\" class=\"btn btn-primary btn-sm px-3 mx-2\" (click)=\"clickOk()\">{{'component.voConfig.clickOk' | wfLocale}}</button>\r\n</ng-template>\r\n",
                    providers: [
                        WfLocalePipe,
                    ]
                }] }
    ];
    /** @nocollapse */
    VoConfigComponent.ctorParameters = function () { return [
        { type: MessagerService },
        { type: NotifyService },
        { type: BsModalService },
        { type: FrameworkService },
        { type: Router },
        { type: ActivatedRoute },
        { type: LoadingService },
        { type: ComponentFactoryResolver },
        { type: Injector },
        { type: ChangeDetectorRef, decorators: [{ type: Optional }] },
        { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
        { type: undefined, decorators: [{ type: Inject, args: [WF_LANG_RESOURCES,] }] },
        { type: WfLocalePipe, decorators: [{ type: Optional }] }
    ]; };
    VoConfigComponent.propDecorators = {
        closeModal: [{ type: Output }],
        submitModal: [{ type: Output }],
        value: [{ type: Input }],
        editorParams: [{ type: Input }],
        modalFooter: [{ type: ViewChild, args: ['iconSelectFooter',] }]
    };
    return VoConfigComponent;
}());
var VoConfigConverter = /** @class */ (function () {
    function VoConfigConverter(localePipe) {
        this.localePipe = localePipe;
    }
    /**
     * @param {?} data
     * @return {?}
     */
    VoConfigConverter.prototype.convertTo = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        if (data && data.currentVoId) {
            return data.currentVoName || data.currentVoId || this.localePipe.transform("component.voConfig.set");
        }
        return this.localePipe.transform("component.voConfig.notSet");
    };
    return VoConfigConverter;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var WfOptionsComponent = /** @class */ (function () {
    function WfOptionsComponent(notify, modalService, message, util, http, designerState, expr, cfr, inj, cdr, localeId, resources, localePipe) {
        this.notify = notify;
        this.modalService = modalService;
        this.message = message;
        this.util = util;
        this.http = http;
        this.designerState = designerState;
        this.expr = expr;
        this.cfr = cfr;
        this.inj = inj;
        this.cdr = cdr;
        this.localeId = localeId;
        this.resources = resources;
        this.localePipe = localePipe;
        this.editorParams = {};
        this.closeModal = new EventEmitter();
        this.submitModal = new EventEmitter();
        this.modalConfig = {
            title: this.localePipe.transform("component.optins.wfOptions"),
            width: 500,
            height: 240,
            showButtons: true
        };
        this.subProcessType = SubProcessType;
        this.radioGroupProcessTypeData = [
            { value: "Specified", name: this.localePipe.transform("component.optins.specified") },
            { value: "Dynamic", name: this.localePipe.transform("component.optins.dynamic") },
        ];
        this.localePipe = this.localePipe || new WfLocalePipe(localeId, resources);
    }
    Object.defineProperty(WfOptionsComponent.prototype, "value", {
        set: /**
         * @param {?} v
         * @return {?}
         */
        function (v) {
            if (v) {
                this.entity = v;
                // 为子流程类型赋值
                if (this.entity.calledElement == null || this.entity.calledElement == "") {
                    if (this.entity.calledBizDefKey == null || this.entity.calledBizDefKey == "") {
                        this.entity.subProcessType = SubProcessType.Specified;
                    }
                    else {
                        this.entity.subProcessType = SubProcessType.Dynamic;
                    }
                }
                else {
                    this.entity.subProcessType = SubProcessType.Specified;
                }
                this.getProcessDefKey(this.entity.calledElement);
                this.getFlowForm(this.entity.calledBizDefKey);
            }
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    WfOptionsComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
    };
    /**
     * @return {?}
     */
    WfOptionsComponent.prototype.clickOk = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var obj = { value: this.entity, parameters: null };
        this.submitModal.emit(obj);
    };
    /**
     * @return {?}
     */
    WfOptionsComponent.prototype.clickCancel = /**
     * @return {?}
     */
    function () {
        this.closeModal.emit();
    };
    /**
     * @param {?} val
     * @return {?}
     */
    WfOptionsComponent.prototype.processTypeChange = /**
     * @param {?} val
     * @return {?}
     */
    function (val) {
        console.log(val);
        if (val == SubProcessType.Specified) {
            this.entity.calledBizDefKey = null;
            this.entity.calledBizDefName = null;
        }
        else if (val == SubProcessType.Dynamic) {
            this.entity.calledElement = null;
            this.entity.calledElementName = null;
        }
    };
    /**
     * @param {?} args
     * @return {?}
     */
    WfOptionsComponent.prototype.processConfirm = /**
     * @param {?} args
     * @return {?}
     */
    function (args) {
        if (args) {
            this.entity.calledElement = args.procDefKey;
            this.entity.calledElementName = args.name;
        }
    };
    /**
     * @param {?} args
     * @return {?}
     */
    WfOptionsComponent.prototype.clearProcessDef = /**
     * @param {?} args
     * @return {?}
     */
    function (args) {
        this.entity.calledElement = '';
        this.entity.calledElementName = '';
    };
    /**
     * @param {?} args
     * @return {?}
     */
    WfOptionsComponent.prototype.flowFormConfirm = /**
     * @param {?} args
     * @return {?}
     */
    function (args) {
        if (args) {
            this.entity.calledBizDefKey = args.id;
            this.entity.calledBizDefName = args.name;
        }
    };
    /**
     * @param {?} args
     * @return {?}
     */
    WfOptionsComponent.prototype.clearFlowForm = /**
     * @param {?} args
     * @return {?}
     */
    function (args) {
        this.entity.calledBizDefKey = '';
        this.entity.calledBizDefName = '';
    };
    /**
     * @param {?} key
     * @return {?}
     */
    WfOptionsComponent.prototype.getProcessDefKey = /**
     * @param {?} key
     * @return {?}
     */
    function (key) {
        var _this = this;
        /** @type {?} */
        var url = this.util.getProcessDefinitionWebApi();
        if (key) {
            url += "/procDefKey/" + key;
            this.http.get(url).subscribe((/**
             * @param {?} re
             * @return {?}
             */
            function (re) {
                _this.entity.calledElementName = re.name;
            }));
        }
    };
    /**
     * @param {?} id
     * @return {?}
     */
    WfOptionsComponent.prototype.getFlowForm = /**
     * @param {?} id
     * @return {?}
     */
    function (id) {
        var _this = this;
        /** @type {?} */
        var url = this.util.getFlowFormWebApi();
        if (id) {
            url += "/" + id;
            this.http.get(url).subscribe((/**
             * @param {?} re
             * @return {?}
             */
            function (re) {
                _this.entity.calledBizDefName = re.name;
            }));
        }
    };
    WfOptionsComponent.decorators = [
        { type: Component, args: [{
                    selector: 'lib-wf-options',
                    template: "<div class=\"f-page f-page-card f-page-is-mainsubcard\" id=\"bif-manager-list\">\r\n  <div class=\"f-page-main\" id=\"page-main\" style=\"overflow-y: auto;\">\r\n    <div class=\"f-form-layout farris-form farris-form-controls-inline\">\r\n      <div class=\"col-12\">\r\n        <div class=\"farris-group-wrap\">\r\n          <div class=\"form-group farris-form-group\">\r\n            <label class=\"col-form-label\" title=\"{{'component.optins.subProcessType' | wfLocale}}\" for=\"processType\">\r\n              <span class=\"farris-label-text\">{{'component.optins.processType' | wfLocale}}</span>\r\n            </label>\r\n            <div class=\"farris-input-wrap\">\r\n              <farris-radiogroup #radioGroupProcessType [(ngModel)]=\"entity&&entity.subProcessType\" [horizontal]=\"false\"\r\n                [data]=\"radioGroupProcessTypeData\" (changeValue)=\"processTypeChange($event)\">\r\n              </farris-radiogroup>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div class=\"col-12\" *ngIf=\"entity&&entity.subProcessType&&entity.subProcessType==subProcessType.Dynamic\">\r\n        <div class=\"farris-group-wrap\">\r\n          <div class=\"form-group farris-form-group\">\r\n            <label class=\"col-form-label\" title=\"{{'component.optins.bizDef' | wfLocale}}\" for=\"calledBizDefKey\">\r\n              <span class=\"farris-label-text\">{{'component.optins.bizDef' | wfLocale}}</span>\r\n            </label>\r\n            <div class=\"farris-input-wrap\">\r\n              <wf-bizprocess-lookup title=\"{{'component.optins.bizDef' | wfLocale}}\" [sourceType]=\"'flowform'\" [displayTxt]=\"entity.calledBizDefName\"\r\n                (afterConfirm)=\"flowFormConfirm($event)\" (clear)=\"clearFlowForm($event)\">\r\n              </wf-bizprocess-lookup>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div class=\"col-12\" *ngIf=\"entity&&entity.subProcessType&&entity.subProcessType==subProcessType.Specified\">\r\n        <div class=\"farris-group-wrap\">\r\n          <div class=\"form-group farris-form-group\">\r\n            <label class=\"col-form-label\" title=\"{{'component.optins.procDef' | wfLocale}}\" for=\"calledElement\">\r\n              <span class=\"farris-label-text\">{{'component.optins.procDef' | wfLocale}}</span>\r\n            </label>\r\n            <div class=\"farris-input-wrap\">\r\n              <wf-bizprocess-lookup title=\"{{'component.optins.procDef' | wfLocale}}\" [displayTxt]=\"entity.calledElementName\"\r\n                (afterConfirm)=\"processConfirm($event)\" (clear)=\"clearProcessDef($event)\">\r\n              </wf-bizprocess-lookup>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type=\"button\" class=\"btn btn-secondary btn-sm px-3 mx-2\" (click)=\"clickCancel()\">{{'component.optins.clickCancel' | wfLocale}}</button>\r\n  <button type=\"button\" class=\"btn btn-primary btn-sm px-3 mx-2\" (click)=\"clickOk()\">{{'component.optins.clickOk' | wfLocale}}</button>\r\n</ng-template>\r\n",
                    providers: [
                        WfLocalePipe,
                    ]
                }] }
    ];
    /** @nocollapse */
    WfOptionsComponent.ctorParameters = function () { return [
        { type: NotifyService },
        { type: BsModalService },
        { type: MessagerService },
        { type: ProcessDeUtil },
        { type: HttpService },
        { type: ProcessDesignerUIState },
        { type: ExpressionService },
        { type: ComponentFactoryResolver },
        { type: Injector },
        { type: ChangeDetectorRef, decorators: [{ type: Optional }] },
        { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
        { type: undefined, decorators: [{ type: Inject, args: [WF_LANG_RESOURCES,] }] },
        { type: WfLocalePipe, decorators: [{ type: Optional }] }
    ]; };
    WfOptionsComponent.propDecorators = {
        editorParams: [{ type: Input }],
        value: [{ type: Input }],
        closeModal: [{ type: Output }],
        submitModal: [{ type: Output }],
        modalFooter: [{ type: ViewChild, args: ['iconSelectFooter',] }],
        radioGroupProcessType: [{ type: ViewChild, args: ["radioGroupProcessType",] }]
    };
    return WfOptionsComponent;
}());
var WfOptionsConverter = /** @class */ (function () {
    function WfOptionsConverter(localePipe) {
        this.localePipe = localePipe;
    }
    /**
     * @param {?} data
     * @return {?}
     */
    WfOptionsConverter.prototype.convertTo = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        if (data && (data.calledBizDefKey || data.calledElement)) {
            return this.localePipe.transform("component.optins.set");
        }
        return this.localePipe.transform("component.optins.notSet");
    };
    return WfOptionsConverter;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var BillNodeActivityAdapter = /** @class */ (function () {
    function BillNodeActivityAdapter(uiState, localPipe) {
        this.uiState = uiState;
        this.localPipe = localPipe;
    }
    /**
     * @param {?} obj
     * @return {?}
     */
    BillNodeActivityAdapter.prototype.setProperty = /**
     * @param {?} obj
     * @return {?}
     */
    function (obj) {
        this.uiState.propertyData = obj.propertyData;
        this.uiState.propertyConfig = this.setConfig(obj.propertyConfig);
    };
    /**
     * @private
     * @param {?} obj
     * @return {?}
     */
    BillNodeActivityAdapter.prototype.setConfig = /**
     * @private
     * @param {?} obj
     * @return {?}
     */
    function (obj) {
        var _this = this;
        /** @type {?} */
        var propertyConfig = [];
        if (obj) {
            obj.forEach((/**
             * @param {?} element
             * @return {?}
             */
            function (element) {
                _this.setEntity(element.properties);
                propertyConfig.push(element);
            }));
        }
        return propertyConfig;
    };
    /**
     * @private
     * @param {?} obj
     * @return {?}
     */
    BillNodeActivityAdapter.prototype.setEntity = /**
     * @private
     * @param {?} obj
     * @return {?}
     */
    function (obj) {
        var _this = this;
        if (obj && obj.length > 0) {
            obj.forEach((/**
             * @param {?} item
             * @return {?}
             */
            function (item) {
                switch (item.propertyID) {
                    case "VoConfig":
                        item.converter = new VoConfigConverter(_this.localPipe);
                        item.editor = VoConfigComponent;
                        item.editorParams = {
                            bizTypeId: _this.uiState.flowFormInfo.flowForm.businessObjectId
                        };
                        break;
                    case "WfOpts":
                        item.converter = new WfOptionsConverter(_this.localPipe);
                        item.editor = WfOptionsComponent;
                        item.editorParams = {
                            bizTypeId: _this.uiState.flowFormInfo.flowForm.businessObjectId
                        };
                        break;
                    case "wfConfig": //启用工作流
                        item.iterator = _this.uiState.boolIterator;
                        break;
                    default:
                        break;
                }
            }));
        }
    };
    BillNodeActivityAdapter.decorators = [
        { type: Injectable }
    ];
    /** @nocollapse */
    BillNodeActivityAdapter.ctorParameters = function () { return [
        { type: ProcessDesignerUIState },
        { type: WfLocalePipe }
    ]; };
    return BillNodeActivityAdapter;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/** @enum {string} */
var SequenceFlowPropertyKeys = {
    Id: "Id",
    Name: "Name",
    NameLanguage: "NameLanguage",
    ClrTypeID: "ClrTypeID",
    ConditionExpression: "ConditionExpression",
    Default: "Default",
    billCreationType: "billCreationType",
    billRelationType: "billRelationType",
    aifAutoProcessCode: "aifAutoProcessCode",
    aifPushProcessCode: "aifPushProcessCode",
    aifPullProcessCode: "aifPullProcessCode",
};

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var SequenceActivityAdapter = /** @class */ (function () {
    function SequenceActivityAdapter(uiState, localePipe) {
        this.uiState = uiState;
        this.localePipe = localePipe;
    }
    /**
     * @param {?} obj
     * @return {?}
     */
    SequenceActivityAdapter.prototype.setProperty = /**
     * @param {?} obj
     * @return {?}
     */
    function (obj) {
        this.uiState.propertyData = obj.propertyData;
        this.uiState.propertyConfig = this.setConfig(obj.propertyConfig);
    };
    /**
     * @private
     * @param {?} obj
     * @return {?}
     */
    SequenceActivityAdapter.prototype.setConfig = /**
     * @private
     * @param {?} obj
     * @return {?}
     */
    function (obj) {
        var _this = this;
        /** @type {?} */
        var propertyConfig = [];
        if (obj) {
            obj.forEach((/**
             * @param {?} element
             * @return {?}
             */
            function (element) {
                _this.setEntity(element.properties);
                propertyConfig.push(element);
            }));
        }
        return propertyConfig;
    };
    /**
     * @private
     * @param {?} obj
     * @return {?}
     */
    SequenceActivityAdapter.prototype.setEntity = /**
     * @private
     * @param {?} obj
     * @return {?}
     */
    function (obj) {
        var _this = this;
        if (obj && obj.length > 0) {
            obj.forEach((/**
             * @param {?} item
             * @return {?}
             */
            function (item) {
                switch (item.propertyID) {
                    case SequenceFlowPropertyKeys.billCreationType:
                        item.iterator = billCreationTypeKeyMap;
                        break;
                    case SequenceFlowPropertyKeys.billRelationType:
                        item.iterator = billRelationTypeKeyMap;
                        break;
                    case SequenceFlowPropertyKeys.aifAutoProcessCode:
                        item.editor = ProcessListHelpComponent;
                        item.converter = new AifCreationBillProcessConverter(_this.localePipe);
                        item.editorParams = {
                            bizTypeId: _this.uiState.flowFormInfo.flowForm.businessObjectId
                        };
                        break;
                    case SequenceFlowPropertyKeys.aifPushProcessCode:
                        item.editor = ProcessListHelpComponent;
                        item.converter = new AifCreationBillProcessConverter(_this.localePipe);
                        item.editorParams = {
                            bizTypeId: _this.uiState.flowFormInfo.flowForm.businessObjectId
                        };
                        break;
                    case SequenceFlowPropertyKeys.aifPullProcessCode:
                        item.editor = ProcessListHelpComponent;
                        item.converter = new AifCreationBillProcessConverter(_this.localePipe);
                        item.editorParams = {
                            bizTypeId: _this.uiState.flowFormInfo.flowForm.businessObjectId
                        };
                        break;
                    default:
                        break;
                }
            }));
        }
    };
    SequenceActivityAdapter.decorators = [
        { type: Injectable }
    ];
    /** @nocollapse */
    SequenceActivityAdapter.ctorParameters = function () { return [
        { type: ProcessDesignerUIState },
        { type: AifLocalePipe }
    ]; };
    return SequenceActivityAdapter;
}());
/** @type {?} */
var billCreationTypeKeyMap = [
    { key: "AUTO", value: "自动生单" },
    { key: "PUSH", value: "推式生单" },
    { key: "PULL", value: "拉式生单" },
];
/** @type {?} */
var billRelationTypeKeyMap = [
    { key: "CREATION", value: "通过生单流程生成目标单" },
];

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var ProcessDesignerViewModel = /** @class */ (function () {
    function ProcessDesignerViewModel(uiState, service, util, notify, message, process, activity, subProcess, autoActAdapter, catchEventAdapter, messageActAdapter, notifyActAdapter, creationActAdapter, billNodeActivityAdapter, sequenceActivityAdapter, modalService, injector, resolver, http, eventBus, localePipe) {
        this.uiState = uiState;
        this.service = service;
        this.util = util;
        this.notify = notify;
        this.message = message;
        this.process = process;
        this.activity = activity;
        this.subProcess = subProcess;
        this.autoActAdapter = autoActAdapter;
        this.catchEventAdapter = catchEventAdapter;
        this.messageActAdapter = messageActAdapter;
        this.notifyActAdapter = notifyActAdapter;
        this.creationActAdapter = creationActAdapter;
        this.billNodeActivityAdapter = billNodeActivityAdapter;
        this.sequenceActivityAdapter = sequenceActivityAdapter;
        this.modalService = modalService;
        this.injector = injector;
        this.resolver = resolver;
        this.http = http;
        this.eventBus = eventBus;
        this.localePipe = localePipe;
    }
    // 初始加载流程属性
    // 初始加载流程属性
    /**
     * @param {?} obj
     * @return {?}
     */
    ProcessDesignerViewModel.prototype.initProcessProperty = 
    // 初始加载流程属性
    /**
     * @param {?} obj
     * @return {?}
     */
    function (obj) {
        /** @type {?} */
        var pptData = obj.propertyData;
        /** @type {?} */
        var ffId = pptData.EntryForm;
        if (ffId) {
            pptData.EntryForm = this.uiState.flowFormInfo.flowForm;
            this.uiState.propertyConfig = this.process.setProcessConfig(obj.propertyConfig);
            this.uiState.propertyData = pptData;
        }
        else {
            this.uiState.propertyConfig = this.process.setProcessConfig(obj.propertyConfig);
            this.uiState.propertyData = pptData;
        }
    };
    /**
     * @param {?} obj
     * @return {?}
     */
    ProcessDesignerViewModel.prototype.setProperty = /**
     * @param {?} obj
     * @return {?}
     */
    function (obj) {
        // 更新属性框数据与配置
        /** @type {?} */
        var propertyData = obj.propertyData;
        switch (propertyData.ClrTypeID) {
            case ProcessClrTypeID.process:
                this.process.setProcessProperty(obj);
                break;
            case ProcessClrTypeID.userActivity:
                this.activity.setUserActivityProperty(obj, 'userActivity');
                break;
            case ProcessClrTypeID.subProcess:
                this.subProcess.setProperty(obj);
                break;
            case ProcessClrTypeID.autoActivity:
                this.autoActAdapter.setProperty(obj);
                break;
            case ProcessClrTypeID.catchEvent:
                this.catchEventAdapter.setProperty(obj);
                break;
            case ProcessClrTypeID.operationActivity:
                this.activity.setUserActivityProperty(obj, 'autoActivity');
                break;
            case ProcessClrTypeID.messageActivity:
                this.messageActAdapter.setProperty(obj);
                break;
            case ProcessClrTypeID.notifyActivity:
                this.notifyActAdapter.setProperty(obj);
                break;
            case ProcessClrTypeID.aifCreationBillActivity:
                this.creationActAdapter.setProperty(obj);
                break;
            case ProcessClrTypeID.billNodeActivity:
                this.billNodeActivityAdapter.setProperty(obj);
                break;
            case ProcessClrTypeID.sequenceActivity:
                this.sequenceActivityAdapter.setProperty(obj);
                break;
            default:
                this.activity.setFlowElementProperty(obj);
                break;
        }
    };
    /**
     * @return {?}
     */
    ProcessDesignerViewModel.prototype.updateSchemas = /**
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var $schemas = new Subject();
        this.uiState.schemas = [];
        // 检查是否有精简be，如果有则覆盖原有be
        if (this.uiState.flowFormInfo.formalParameters && this.uiState.flowFormInfo.formalParameters.length > 0) {
            /** @type {?} */
            var schemaParams_1 = this.uiState.flowFormInfo.formalParameters.filter((/**
             * @param {?} p
             * @return {?}
             */
            function (p) { return p.dataType === 'CDTSchema' && p.schemaMetadataId; }));
            /** @type {?} */
            var bizDefKey = this.uiState.flowFormInfo.flowForm.id;
            this.getBeMappingByBizDefKey(bizDefKey).subscribe((/**
             * @param {?} re
             * @return {?}
             */
            function (re) {
                if (re && re.enable) {
                    return _this.service.getBusinessEntitybyId(re.newSchemaMetaDataId).subscribe((/**
                     * @param {?} d
                     * @return {?}
                     */
                    function (d) {
                        /** @type {?} */
                        var data = [d];
                        if (data && data.length > 0) {
                            data.forEach((/**
                             * @param {?} d
                             * @return {?}
                             */
                            function (d) {
                                _this.uiState.schemas.push(d);
                            }));
                        }
                        $schemas.next(true);
                    }), (/**
                     * @param {?} err
                     * @return {?}
                     */
                    function (err) {
                        _this.uiState.schemas = [];
                        $schemas.next(true);
                    }));
                }
                else {
                    forkJoin$1(schemaParams_1.map((/**
                     * @param {?} para
                     * @return {?}
                     */
                    function (para) {
                        return _this.service.getBusinessEntitybyId(para.schemaMetadataId);
                    }))).subscribe((/**
                     * @param {?} data
                     * @return {?}
                     */
                    function (data) {
                        if (data && data.length > 0) {
                            data.forEach((/**
                             * @param {?} d
                             * @return {?}
                             */
                            function (d) {
                                _this.uiState.schemas.push(d);
                            }));
                        }
                        $schemas.next(true);
                    }), (/**
                     * @param {?} err
                     * @return {?}
                     */
                    function (err) {
                        _this.uiState.schemas = [];
                        $schemas.next(true);
                    }));
                }
            }));
        }
        else {
            this.uiState.schemas = [];
            $schemas.next(true);
        }
        return $schemas.asObservable();
    };
    /**
     * @param {?} formId
     * @return {?}
     */
    ProcessDesignerViewModel.prototype.getFlowFormInfoById = /**
     * @param {?} formId
     * @return {?}
     */
    function (formId) {
        var _this = this;
        /** @type {?} */
        var $flowform = new Subject();
        if (formId) {
            forkJoin$1(this.service.GetFlowFormbyId(formId), this.service.getParametersbyFlowFormKey(formId).pipe(map((/**
             * @param {?} params
             * @return {?}
             */
            function (params) {
                _this.setFormParamCxt(params);
                return params;
            }))), this.service.getComponentsbyFlowformkey(formId), this.service.getExecuteFormbyFlowFormKey(formId), this.service.getBizActivities(formId), this.service.getCustomizeActions(formId)).subscribe((/**
             * @param {?} re
             * @return {?}
             */
            function (re) {
                /** @type {?} */
                var flowform = new FlowFormInfo();
                flowform.flowForm = re[0];
                flowform.formalParameters = re[1];
                flowform.bizComponents = re[2].filter((/**
                 * @param {?} cmp
                 * @return {?}
                 */
                function (cmp) { return cmp.ownerType !== 'Activity'; }));
                flowform.excuteForms = re[3];
                flowform.bizActivities = re[4];
                flowform.customizeActions = re[5];
                _this.uiState.flowFormInfo = flowform;
                _this.updateSchemas().subscribe((/**
                 * @param {?} re
                 * @return {?}
                 */
                function (re) {
                    $flowform.next(flowform);
                }));
            }));
        }
        return $flowform.asObservable();
    };
    /**
     * @return {?}
     */
    ProcessDesignerViewModel.prototype.getFormFormatsByBizCategory = /**
     * @return {?}
     */
    function () {
        if (this.uiState.flowFormInfo.flowForm.businessObjectId) {
            /** @type {?} */
            var url = "/api/runtime/wf/v1.0/formFormat/query?param=";
            /** @type {?} */
            var param = "{\"bizCategory\":\"" + this.uiState.flowFormInfo.flowForm.businessObjectId + "\"}";
            param = encodeURIComponent(param);
            url += param;
            return this.http.get(url);
        }
        else {
            return from(new Array());
        }
    };
    /**
     * 保存流程
     * @param content 流程上下文
     */
    /**
     * 保存流程
     * @param {?} content 流程上下文
     * @param {?} processInfo
     * @param {?} state
     * @return {?}
     */
    ProcessDesignerViewModel.prototype.saveProcess = /**
     * 保存流程
     * @param {?} content 流程上下文
     * @param {?} processInfo
     * @param {?} state
     * @return {?}
     */
    function (content, processInfo, state) {
        return this.service.saveProcess(content, processInfo, state);
    };
    /**
     * 发布流程
     * @param content 流程上下文
     */
    /**
     * 发布流程
     * @param {?} content 流程上下文
     * @return {?}
     */
    ProcessDesignerViewModel.prototype.deployProcess = /**
     * 发布流程
     * @param {?} content 流程上下文
     * @return {?}
     */
    function (content) {
        return this.service.deployProcess(content);
    };
    /**
     * 带审核的发布流程
     * @param content 流程上下文
     */
    /**
     * 带审核的发布流程
     * @param {?} content 流程上下文
     * @param {?} version
     * @return {?}
     */
    ProcessDesignerViewModel.prototype.releaseProcess = /**
     * 带审核的发布流程
     * @param {?} content 流程上下文
     * @param {?} version
     * @return {?}
     */
    function (content, version) {
        /** @type {?} */
        var process = JSON.parse(content);
        /** @type {?} */
        var compFactory = this.resolver.resolveComponentFactory(ReleaseComponent);
        /** @type {?} */
        var compRef = compFactory.create(this.injector);
        compRef.instance.procName = process.DefaultProcess.Name;
        compRef.instance.procVersion = version === 1 ? 1 : version + 1;
        compRef.instance.processDefinitionKey = process.DefaultProcess.Key;
        /** @type {?} */
        var modalOptions = {
            title: this.localePipe.transform('app.processDesigner.releaseProcess'),
            width: 500, height: 550,
            buttons: compRef.instance.btnRef,
            showButtons: true
        };
        /** @type {?} */
        var dlg = this.modalService.show(compRef, modalOptions);
        compRef.instance.submit.subscribe((/**
         * @param {?} re
         * @return {?}
         */
        function (re) {
            dlg.close();
        }));
        compRef.instance.cancel.subscribe((/**
         * @param {?} re
         * @return {?}
         */
        function (re) {
            dlg.close();
        }));
    };
    /**
     * @param {?} auditId
     * @param {?} success
     * @param {?} key
     * @return {?}
     */
    ProcessDesignerViewModel.prototype.auditProcessDef = /**
     * @param {?} auditId
     * @param {?} success
     * @param {?} key
     * @return {?}
     */
    function (auditId, success, key) {
        /** @type {?} */
        var info = new AuditProcessDefInfo();
        info.auditId = auditId;
        info.success = success;
        info.processDefKey = key;
        this.service.auditProcessDef(info);
    };
    /**
     * 保存运行时流程
     * @param content 流程上下文
     */
    /**
     * 保存运行时流程
     * @param {?} content 流程上下文
     * @param {?} procDefId
     * @return {?}
     */
    ProcessDesignerViewModel.prototype.saveRTProcess = /**
     * 保存运行时流程
     * @param {?} content 流程上下文
     * @param {?} procDefId
     * @return {?}
     */
    function (content, procDefId) {
        return this.service.saveRTProcess(content, procDefId);
    };
    /**
     * @param {?} process
     * @param {?} processInfo
     * @return {?}
     */
    ProcessDesignerViewModel.prototype.saveAsProcess = /**
     * @param {?} process
     * @param {?} processInfo
     * @return {?}
     */
    function (process, processInfo) {
        var _this = this;
        /** @type {?} */
        var compFactory = this.resolver.resolveComponentFactory(SaveAsEditComponent);
        /** @type {?} */
        var compRef = compFactory.create(this.injector);
        compRef.instance.procKey = process.DefaultProcess.Key;
        compRef.instance.procName = process.DefaultProcess.Name + this.localePipe.transform('app.processDesigner.copy');
        compRef.instance.isAdministratorConfig = this.uiState.isAdministratorConfig;
        compRef.instance.enableAdminOrgAut = this.uiState.enableAdminOrgAut;
        compRef.instance.administrator = this.uiState.administrator;
        compRef.instance.accessLevel = processInfo.accessLevel;
        if (!this.uiState.enableAdminOrgAut && !this.uiState.isAdministratorConfig) {
            compRef.instance.organization = processInfo.procOrg.orgId;
            compRef.instance.organizationName = processInfo.procOrg.orgName;
        }
        /** @type {?} */
        var modalOptions = {
            title: this.localePipe.transform('app.processDesigner.saveAs'),
            width: 450, height: 400,
            buttons: compRef.instance.btnRef,
            showButtons: true
        };
        /** @type {?} */
        var dlg = this.modalService.show(compRef, modalOptions);
        compRef.instance.submit.subscribe((/**
         * @param {?} re
         * @return {?}
         */
        function (re) {
            process.DefaultProcess.Name = re.procName;
            /** @type {?} */
            var procInfo = new ProcessInfo();
            procInfo.accessLevel = re.accessLevel;
            procInfo.procOrg = {
                orgId: re.organization,
                orgName: re.organizationName
            };
            _this.saveProcess(process.ConvertToJson(), procInfo, 1).subscribe((/**
             * @param {?} r
             * @return {?}
             */
            function (r) {
                _this.notify.success((/** @type {?} */ ({
                    title: _this.localePipe.transform('app.processDesigner.tips'), msg: _this.localePipe.transform('app.processDesigner.saveAsSuccess'), timeout: 3000
                })));
            }), (/**
             * @param {?} err
             * @return {?}
             */
            function (err) {
                _this.notify.error((/** @type {?} */ ({
                    title: _this.localePipe.transform('app.processDesigner.tips'), msg: _this.localePipe.transform('app.processDesigner.saveAsFail'), timeout: 3000
                })));
            }));
            dlg.close();
        }));
        compRef.instance.cancel.subscribe((/**
         * @param {?} r
         * @return {?}
         */
        function (r) {
            dlg.close();
        }));
    };
    /**
     * 同步设计器时流程定义
     */
    /**
     * 同步设计器时流程定义
     * @param {?} content
     * @param {?} rtProcessInfo
     * @param {?=} showTip
     * @return {?}
     */
    ProcessDesignerViewModel.prototype.syncDtProcess = /**
     * 同步设计器时流程定义
     * @param {?} content
     * @param {?} rtProcessInfo
     * @param {?=} showTip
     * @return {?}
     */
    function (content, rtProcessInfo, showTip) {
        var _this = this;
        if (showTip === void 0) { showTip = true; }
        if (content) {
            /** @type {?} */
            var process_1 = JSON.parse(content);
            if (showTip) {
                this.message.question(this.localePipe.transform('app.processDesigner.syncDt'), (/**
                 * @return {?}
                 */
                function () {
                    _this.service.syncDtProcess(content, rtProcessInfo).subscribe((/**
                     * @param {?} data
                     * @return {?}
                     */
                    function (data) {
                        _this.notify.success((/** @type {?} */ ({
                            title: _this.localePipe.transform('app.processDesigner.tips'), msg: _this.localePipe.transform('app.processDesigner.syncSuccess'), timeout: 3000
                        })));
                        _this.auditProcessDef(AuditEvent.WF_ProcessDef_SyncDT, true, process_1.DefaultProcess.Key);
                    }), (/**
                     * @param {?} error
                     * @return {?}
                     */
                    function (error) {
                        _this.notify.error((/** @type {?} */ ({
                            title: _this.localePipe.transform('app.processDesigner.tips'), msg: error.error.Message, timeout: 3000
                        })));
                        _this.auditProcessDef(AuditEvent.WF_ProcessDef_SyncDT, false, process_1.DefaultProcess.Key);
                    }));
                }));
            }
            else {
                this.service.syncDtProcess(content, rtProcessInfo).subscribe((/**
                 * @param {?} data
                 * @return {?}
                 */
                function (data) {
                    _this.notify.success((/** @type {?} */ ({
                        title: _this.localePipe.transform('app.processDesigner.tips'), msg: _this.localePipe.transform('app.processDesigner.syncSuccess'), timeout: 3000
                    })));
                    _this.auditProcessDef(AuditEvent.WF_ProcessDef_SyncDT, true, process_1.DefaultProcess.Key);
                }), (/**
                 * @param {?} error
                 * @return {?}
                 */
                function (error) {
                    _this.notify.error((/** @type {?} */ ({
                        title: _this.localePipe.transform('app.processDesigner.tips'), msg: error.error.Message, timeout: 3000
                    })));
                    _this.auditProcessDef(AuditEvent.WF_ProcessDef_SyncDT, false, process_1.DefaultProcess.Key);
                }));
            }
        }
    };
    /**
     * @param {?} data
     * @param {?} processInfo
     * @return {?}
     */
    ProcessDesignerViewModel.prototype.beforeCompleteStrategyChange = /**
     * @param {?} data
     * @param {?} processInfo
     * @return {?}
     */
    function (data, processInfo) {
        var _this = this;
        /** @type {?} */
        var url = "/api/runtime/wf/v1.0/processInstances/runtimeActivityInstances?procDefId=" + processInfo.rtProcDefId + "&activityDefinitionId=" + data.Id;
        return this.http.get(url).pipe(switchMap((/**
         * @param {?} re
         * @return {?}
         */
        function (re) {
            if (re && re.length > 0) {
                _this.message.info(_this.localePipe.transform('app.processDesigner.beforeCompleteStrategyChange'));
                return of$1(false);
            }
            else {
                return of$1(true);
            }
        })));
    };
    /**
     * @param {?} procCategoryId
     * @return {?}
     */
    ProcessDesignerViewModel.prototype.getProcessCategory = /**
     * @param {?} procCategoryId
     * @return {?}
     */
    function (procCategoryId) {
        return this.service.GetFlowFormbyId(procCategoryId);
    };
    /**
     * @private
     * @param {?} params
     * @return {?}
     */
    ProcessDesignerViewModel.prototype.setFormParamCxt = /**
     * @private
     * @param {?} params
     * @return {?}
     */
    function (params) {
        var _this = this;
        this.uiState.formalParameterContext = [];
        if (params && params.length > 0) {
            params.forEach((/**
             * @param {?} param
             * @return {?}
             */
            function (param) {
                if (param.dataType === 'CDTSchema') {
                    /** @type {?} */
                    var formalParameterContext = [{
                            key: "schemaId_" + param.code,
                            name: "schemaId_" + param.name,
                            description: "schemaId_" + param.name
                        }, {
                            key: "metadataId_" + param.code,
                            name: "metadataId_" + param.name,
                            description: "metadataId_" + param.name
                        }];
                    _this.uiState.formalParameterContext = _this.uiState.formalParameterContext.concat(formalParameterContext);
                }
            }));
        }
    };
    /**
     * @param {?} ResourceKeys
     * @param {?} data
     * @return {?}
     */
    ProcessDesignerViewModel.prototype.copy = /**
     * @param {?} ResourceKeys
     * @param {?} data
     * @return {?}
     */
    function (ResourceKeys, data) {
        this.eventBus.emit(ResourceKeys, data);
    };
    /**
     * @param {?} ResourceKeys
     * @param {?} data
     * @return {?}
     */
    ProcessDesignerViewModel.prototype.batchSet = /**
     * @param {?} ResourceKeys
     * @param {?} data
     * @return {?}
     */
    function (ResourceKeys, data) {
        this.eventBus.emit(ResourceKeys, data);
    };
    /**
     * @param {?} key
     * @return {?}
     */
    ProcessDesignerViewModel.prototype.getProcDefsByKey = /**
     * @param {?} key
     * @return {?}
     */
    function (key) {
        if (key) {
            /** @type {?} */
            var url = "/api/runtime/wf/v1.0/procDefs/key?procDefKey=" + key;
            return this.http.get(url);
        }
    };
    /**
     * @param {?} bizDefKey
     * @param {?} schema
     * @return {?}
     */
    ProcessDesignerViewModel.prototype.checkExpressionsByPayload = /**
     * @param {?} bizDefKey
     * @param {?} schema
     * @return {?}
     */
    function (bizDefKey, schema) {
        /** @type {?} */
        var checkExpressionsPayload = {
            bizDefKey: bizDefKey,
            schema: schema
        };
        /** @type {?} */
        var url = "/api/runtime/wf/v1.0/flowForm/checkExpressionsByPayload";
        return this.http.post(url, checkExpressionsPayload);
    };
    /**
     * @param {?} bizDefKey
     * @return {?}
     */
    ProcessDesignerViewModel.prototype.getBeMappingByBizDefKey = /**
     * @param {?} bizDefKey
     * @return {?}
     */
    function (bizDefKey) {
        /** @type {?} */
        var url = "/api/runtime/wf/v1.0/flowForm/getBeMappingByBizDefKey?bizDefKey=" + bizDefKey;
        return this.http.get(url);
    };
    ProcessDesignerViewModel.decorators = [
        { type: Injectable }
    ];
    /** @nocollapse */
    ProcessDesignerViewModel.ctorParameters = function () { return [
        { type: ProcessDesignerUIState },
        { type: ProcessDesignerDataService },
        { type: ProcessDeUtil },
        { type: NotifyService },
        { type: MessagerService },
        { type: BpmnProcessViewModel },
        { type: WFFlowElementsViewModel },
        { type: SubProcessViewModel },
        { type: AutoActivityAdapter },
        { type: CatchEventAdapter },
        { type: MessageActivityAdapter },
        { type: NotifyActivityAdapter },
        { type: AifCreationBillActivityAdapter },
        { type: BillNodeActivityAdapter },
        { type: SequenceActivityAdapter },
        { type: BsModalService },
        { type: Injector },
        { type: ComponentFactoryResolver },
        { type: HttpService },
        { type: EventBusService },
        { type: WfLocalePipe }
    ]; };
    return ProcessDesignerViewModel;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var RTProcessInfo = /** @class */ (function () {
    function RTProcessInfo() {
    }
    return RTProcessInfo;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var NoteComponent = /** @class */ (function () {
    function NoteComponent(cdr, localeId, resources, localePipe) {
        this.cdr = cdr;
        this.localeId = localeId;
        this.resources = resources;
        this.localePipe = localePipe;
        this.submit = new Subject();
        this.cancel = new Subject();
        this.placeholder = this.localePipe.transform('component.note.placeholder');
        this.localePipe = this.localePipe || new WfLocalePipe(localeId, resources);
    }
    /**
     * @return {?}
     */
    NoteComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
    };
    /**
     * @return {?}
     */
    NoteComponent.prototype.clickOK = /**
     * @return {?}
     */
    function () {
        this.submit.next(this.record);
    };
    /**
     * @return {?}
     */
    NoteComponent.prototype.clickCancel = /**
     * @return {?}
     */
    function () {
        this.cancel.next();
    };
    NoteComponent.decorators = [
        { type: Component, args: [{
                    selector: 'lib-note',
                    template: "<div class=\"f-page\">\r\n  <div class=\"f-page-main f-utils-fill-flex-column h-100\">\r\n    <div class=\"f-utils-fill-flex-column farris-overflow-y-auto h-100\">\r\n      <textarea class=\"form-control content-textarea\" style=\"height: 100%;\" [(ngModel)]=\"record\" [placeholder]=\"placeholder\"></textarea>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #footer>\r\n  <button type=\"button\" class=\"btn btn-secondary btn-sm\" (click)=\"clickCancel()\">{{'component.note.clickCancel' | wfLocale}}</button>\r\n  <button type=\"button\" class=\"btn btn-primary btn-sm mx-2\" (click)=\"clickOK()\">{{'component.note.clickOK' | wfLocale}}</button>\r\n</ng-template>\r\n",
                    providers: [
                        WfLocalePipe,
                    ],
                    styles: [""]
                }] }
    ];
    /** @nocollapse */
    NoteComponent.ctorParameters = function () { return [
        { type: ChangeDetectorRef, decorators: [{ type: Optional }] },
        { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
        { type: undefined, decorators: [{ type: Inject, args: [WF_LANG_RESOURCES,] }] },
        { type: WfLocalePipe, decorators: [{ type: Optional }] }
    ]; };
    NoteComponent.propDecorators = {
        footer: [{ type: ViewChild, args: ['footer',] }]
    };
    return NoteComponent;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var MessageReceiver$1 = /** @class */ (function () {
    function MessageReceiver() {
    }
    return MessageReceiver;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var BizComponent = /** @class */ (function () {
    function BizComponent() {
    }
    return BizComponent;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var BizParameter = /** @class */ (function () {
    function BizParameter() {
    }
    return BizParameter;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/**
 * Wf相关常量
 */
var WfConstants = /** @class */ (function () {
    function WfConstants() {
    }
    /**
     * @return {?}
     */
    WfConstants.getBasePath = /**
     * @return {?}
     */
    function () {
        try {
            return ((/** @type {?} */ (window))).gspframeworkService.common.getBasePath.get();
        }
        catch (error) {
        }
    };
    WfConstants.PF_CMP_ID1 = '7433df25-9260-4c24-86f0-9da3e89450fb';
    WfConstants.PF_CMP_ID2 = 'd0783800-ed60-488c-b053-8806a15947fe';
    WfConstants.PF_CMP_ID3 = 'b89e9b9a-2e2d-4bd0-b354-187219544d34';
    WfConstants.PF_CMP_ID4 = 'a8b8f7a4-49ae-4b7d-88d2-b3772b9d0ae5';
    WfConstants.IMAGE_PATH = WfConstants.getBasePath() + "/platform/runtime/common/web/@gsp-wf/wf-process-editor/images";
    return WfConstants;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var WfDesignerUtils = /** @class */ (function () {
    function WfDesignerUtils() {
    }
    /**
     * 是否为共享流程构件
     * @param metadataId
     * @returns
     */
    /**
     * 是否为共享流程构件
     * @param {?} metadataId
     * @return {?}
     */
    WfDesignerUtils.isPfComponent = /**
     * 是否为共享流程构件
     * @param {?} metadataId
     * @return {?}
     */
    function (metadataId) {
        if (metadataId === WfConstants.PF_CMP_ID1
            || metadataId === WfConstants.PF_CMP_ID2
            || metadataId === WfConstants.PF_CMP_ID3
            || metadataId === WfConstants.PF_CMP_ID4) {
            return true;
        }
        return false;
    };
    /**
     * 创建内码
     */
    /**
     * 创建内码
     * @return {?}
     */
    WfDesignerUtils.createNM = /**
     * 创建内码
     * @return {?}
     */
    function () {
        /**
         * @return {?}
         */
        function S4() {
            return (((1 + Math.random()) * 0x10000) | 0).toString(16).substring(1);
        }
        return (S4() + S4() + '-' + S4() + '-' + S4() + '-' + S4() + '-' + S4() + S4() + S4());
    };
    return WfDesignerUtils;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/** @enum {string} */
var WfEvents = {
    ShowTips: "ShowTips",
};

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var Participant$1 = /** @class */ (function () {
    function Participant() {
    }
    return Participant;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var UserParticipant$1 = /** @class */ (function (_super) {
    __extends(UserParticipant, _super);
    function UserParticipant() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    return UserParticipant;
}(Participant$1));

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var VariablePerformer = /** @class */ (function (_super) {
    __extends(VariablePerformer, _super);
    function VariablePerformer() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    return VariablePerformer;
}(UserParticipant$1));

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var PositionParticipant$1 = /** @class */ (function (_super) {
    __extends(PositionParticipant, _super);
    function PositionParticipant() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    return PositionParticipant;
}(UserParticipant$1));

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var ComponentParticipant$1 = /** @class */ (function (_super) {
    __extends(ComponentParticipant, _super);
    function ComponentParticipant() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    return ComponentParticipant;
}(Participant$1));

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var ReportingLineParticipant$1 = /** @class */ (function (_super) {
    __extends(ReportingLineParticipant, _super);
    function ReportingLineParticipant() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    return ReportingLineParticipant;
}(UserParticipant$1));

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var ActivityExecutorParticipant$2 = /** @class */ (function (_super) {
    __extends(ActivityExecutorParticipant, _super);
    function ActivityExecutorParticipant() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    return ActivityExecutorParticipant;
}(UserParticipant$1));

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var MatrixParticipant$1 = /** @class */ (function (_super) {
    __extends(MatrixParticipant, _super);
    function MatrixParticipant() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    return MatrixParticipant;
}(UserParticipant$1));

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var OrganizationParticipant$1 = /** @class */ (function (_super) {
    __extends(OrganizationParticipant, _super);
    function OrganizationParticipant() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    return OrganizationParticipant;
}(Participant$1));

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/** @enum {string} */
var ActionScope$4 = {
    /**
     * 指派
     */
    AssignUser: 'AssignUser',
    /**
     * 移交
     */
    Transfer: 'Transfer',
    /**
     * 征询
     */
    AddSignFront: 'AddSignFront',
    /**
     * 加签
     */
    AddSignBehind: 'AddSignBehind',
    /**
     * 知会
     */
    Notify: 'Notify',
};

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/**
 * 属性工具
 */
var  /**
 * 属性工具
 */
PropertyHelper = /** @class */ (function () {
    function PropertyHelper() {
    }
    /**
     * 获取变量赋值列表
     * @param bpmnModel
     * @param variablesSetting
     * @returns
     */
    /**
     * 获取变量赋值列表
     * @param {?} bpmnModel
     * @param {?} variablesSetting
     * @return {?}
     */
    PropertyHelper.getVariableSettings = /**
     * 获取变量赋值列表
     * @param {?} bpmnModel
     * @param {?} variablesSetting
     * @return {?}
     */
    function (bpmnModel, variablesSetting) {
        var e_1, _a, e_2, _b, e_3, _c;
        /** @type {?} */
        var variables = new Array();
        /** @type {?} */
        var extendElements = bpmnModel.DefaultProcess.GetExtensionElements();
        if (variablesSetting && variablesSetting.length > 0) {
            try {
                for (var variablesSetting_1 = __values(variablesSetting), variablesSetting_1_1 = variablesSetting_1.next(); !variablesSetting_1_1.done; variablesSetting_1_1 = variablesSetting_1.next()) {
                    var v = variablesSetting_1_1.value;
                    /** @type {?} */
                    var variable = {
                        variableCode: v.variableCode,
                        variableName: v.variableName,
                        tag: v.tag,
                        executionTime: v.executionTime,
                        value: v.value,
                        valueText: v.valueText
                    };
                    if (v.tag === 'component') {
                        if (extendElements.length > 0) {
                            try {
                                for (var extendElements_1 = __values(extendElements), extendElements_1_1 = extendElements_1.next(); !extendElements_1_1.done; extendElements_1_1 = extendElements_1.next()) {
                                    var e = extendElements_1_1.value;
                                    if (e instanceof Component$1 && e.Id === v.value) {
                                        /** @type {?} */
                                        var component = {
                                            Id: e.Id,
                                            Name: e.Name,
                                            MetadataId: e.MetadataId,
                                            MethodCode: e.MethodCode,
                                            ActualParameters: []
                                        };
                                        if (e.ActualParameters && e.ActualParameters.length > 0) {
                                            try {
                                                for (var _d = __values(e.ActualParameters), _e = _d.next(); !_e.done; _e = _d.next()) {
                                                    var p = _e.value;
                                                    /** @type {?} */
                                                    var parameter = {
                                                        Name: p.Name,
                                                        Value: p.Value,
                                                        Tag: p.Tag,
                                                    };
                                                    component.ActualParameters.push(parameter);
                                                }
                                            }
                                            catch (e_3_1) { e_3 = { error: e_3_1 }; }
                                            finally {
                                                try {
                                                    if (_e && !_e.done && (_c = _d.return)) _c.call(_d);
                                                }
                                                finally { if (e_3) throw e_3.error; }
                                            }
                                        }
                                        variable.component = component;
                                    }
                                }
                            }
                            catch (e_2_1) { e_2 = { error: e_2_1 }; }
                            finally {
                                try {
                                    if (extendElements_1_1 && !extendElements_1_1.done && (_b = extendElements_1.return)) _b.call(extendElements_1);
                                }
                                finally { if (e_2) throw e_2.error; }
                            }
                        }
                    }
                    variables.push(variable);
                }
            }
            catch (e_1_1) { e_1 = { error: e_1_1 }; }
            finally {
                try {
                    if (variablesSetting_1_1 && !variablesSetting_1_1.done && (_a = variablesSetting_1.return)) _a.call(variablesSetting_1);
                }
                finally { if (e_1) throw e_1.error; }
            }
        }
        return variables;
    };
    /**
     *
     * @param messageNotices
     * @returns
     */
    /**
     *
     * @param {?} messageNotices
     * @return {?}
     */
    PropertyHelper.getMessageNotices = /**
     *
     * @param {?} messageNotices
     * @return {?}
     */
    function (messageNotices) {
        if (!messageNotices || messageNotices.length == 0) {
            return null;
        }
        return messageNotices.map((/**
         * @param {?} m
         * @return {?}
         */
        function (m) {
            var e_4, _a, e_5, _b;
            /** @type {?} */
            var message = new Object;
            message.content = m.content;
            message.sendTime = m.sendTime;
            message.sendType = m.sendType;
            message.subject = m.subject;
            if (m.smsMessageTemplate) {
                /** @type {?} */
                var smsTemplate = new Object;
                smsTemplate.code = m.smsMessageTemplate.code;
                smsTemplate.content = m.smsMessageTemplate.content;
                smsTemplate.smsMessageVariables = new Array();
                if (m.smsMessageTemplate.smsMessageVariables && m.smsMessageTemplate.smsMessageVariables.length > 0) {
                    try {
                        for (var _c = __values(m.smsMessageTemplate.smsMessageVariables), _d = _c.next(); !_d.done; _d = _c.next()) {
                            var v = _d.value;
                            /** @type {?} */
                            var variable = new Object;
                            variable.id = WfDesignerUtils.createNM();
                            variable.code = v.code;
                            variable.value = v.value;
                            variable.tag = v.tag;
                            smsTemplate.smsMessageVariables.push(variable);
                        }
                    }
                    catch (e_4_1) { e_4 = { error: e_4_1 }; }
                    finally {
                        try {
                            if (_d && !_d.done && (_a = _c.return)) _a.call(_c);
                        }
                        finally { if (e_4) throw e_4.error; }
                    }
                }
                message.smsMessageTemplate = smsTemplate;
            }
            /** @type {?} */
            var receiverExpressions = new Array();
            if (m.receiver) {
                /** @type {?} */
                var receivers = m.receiver.split(',');
                /** @type {?} */
                var receiverTexts = m.receiverText.split(',');
                /** @type {?} */
                var userReceiver = new MessageReceiver$1();
                userReceiver.type = 'userParticipant';
                userReceiver.userIds = '';
                userReceiver.userNames = '';
                for (var i in receivers) {
                    if (receivers[i] === 'procInstCreator') {
                        /** @type {?} */
                        var procInstCreator = new MessageReceiver$1();
                        procInstCreator.type = 'processParticipant';
                        procInstCreator.processParticipant = 'procInstCreator';
                        receiverExpressions.push(procInstCreator);
                    }
                    else if (receivers[i] === 'workItemParticipant') {
                        /** @type {?} */
                        var workItemParticipant = new MessageReceiver$1();
                        workItemParticipant.type = 'processParticipant';
                        workItemParticipant.processParticipant = 'workItemParticipant';
                        receiverExpressions.push(workItemParticipant);
                    }
                    else {
                        userReceiver.userIds += (receivers[i] + ',');
                        userReceiver.userNames += (receiverTexts[i] + ',');
                    }
                }
                if (userReceiver.userIds) {
                    userReceiver.userIds = userReceiver.userIds.substring(0, userReceiver.userIds.length - 1);
                    userReceiver.userNames = userReceiver.userNames.substring(0, userReceiver.userNames.length - 1);
                    receiverExpressions.push(userReceiver);
                }
            }
            if (m.receiverExpressions && m.receiverExpressions.length > 0) {
                try {
                    for (var _e = __values(m.receiverExpressions), _f = _e.next(); !_f.done; _f = _e.next()) {
                        var e = _f.value;
                        if (e instanceof ActivityExecutorParticipantExpression) {
                            /** @type {?} */
                            var activityExecutorParticipant = new MessageReceiver$1();
                            activityExecutorParticipant.type = 'processParticipant';
                            activityExecutorParticipant.processParticipant = 'activityExecutorParticipant';
                            activityExecutorParticipant.activityDefId = e.activityDefId;
                            activityExecutorParticipant.activityDefName = e.activityDefName;
                            receiverExpressions.push(activityExecutorParticipant);
                        }
                        else if (e instanceof UserParticipantExpression) {
                            /** @type {?} */
                            var variableReceiver = new MessageReceiver$1();
                            variableReceiver.type = 'variableParticipant';
                            variableReceiver.variableParticipant = e.UserId;
                            variableReceiver.variableName = e.name;
                            variableReceiver.orgType = e.OrgType;
                            receiverExpressions.push(variableReceiver);
                        }
                        else if (e instanceof PositionParticipantExpression) {
                            /** @type {?} */
                            var positionReceiver = new MessageReceiver$1();
                            positionReceiver.type = 'positionParticipant';
                            positionReceiver.positionId = e.PositionId;
                            positionReceiver.positionName = e.PositionName;
                            positionReceiver.positionType = e.PositionType;
                            if (positionReceiver.positionType === '1') {
                                positionReceiver.orgId = e.OrgId;
                                positionReceiver.orgType = e.OrgType;
                            }
                            receiverExpressions.push(positionReceiver);
                        }
                    }
                }
                catch (e_5_1) { e_5 = { error: e_5_1 }; }
                finally {
                    try {
                        if (_f && !_f.done && (_b = _e.return)) _b.call(_e);
                    }
                    finally { if (e_5) throw e_5.error; }
                }
            }
            if (receiverExpressions.length > 0) {
                message.receivers = receiverExpressions;
            }
            return message;
        }));
    };
    /**
     *
     * @param components
     * @returns
     */
    /**
     *
     * @param {?} components
     * @return {?}
     */
    PropertyHelper.getBizComponentList = /**
     *
     * @param {?} components
     * @return {?}
     */
    function (components) {
        var e_6, _a, e_7, _b;
        /** @type {?} */
        var bizComponentList = new Array();
        if (components && components.length > 0) {
            try {
                for (var components_1 = __values(components), components_1_1 = components_1.next(); !components_1_1.done; components_1_1 = components_1.next()) {
                    var component = components_1_1.value;
                    /** @type {?} */
                    var bizComponent = new BizComponent();
                    bizComponent.id = component.Id;
                    bizComponent.name = component.Name;
                    bizComponent.metadataId = component.MetadataId;
                    bizComponent.methodCode = component.MethodCode;
                    bizComponent.executionTime = component.Time;
                    bizComponent.isForCompensation = component.isForCompensation;
                    bizComponent.scopeType = component.ScopeType || null;
                    bizComponent.actualParameters = new Array();
                    if (component.ActualParameters && component.ActualParameters.length > 0) {
                        try {
                            for (var _c = __values(component.ActualParameters), _d = _c.next(); !_d.done; _d = _c.next()) {
                                var param = _d.value;
                                /** @type {?} */
                                var bizParam = new BizParameter();
                                bizParam.code = param.Name;
                                bizParam.name = param.Name;
                                bizParam.value = param.Value;
                                bizComponent.actualParameters.push(bizParam);
                            }
                        }
                        catch (e_7_1) { e_7 = { error: e_7_1 }; }
                        finally {
                            try {
                                if (_d && !_d.done && (_b = _c.return)) _b.call(_c);
                            }
                            finally { if (e_7) throw e_7.error; }
                        }
                    }
                    bizComponentList.push(bizComponent);
                }
            }
            catch (e_6_1) { e_6 = { error: e_6_1 }; }
            finally {
                try {
                    if (components_1_1 && !components_1_1.done && (_a = components_1.return)) _a.call(components_1);
                }
                finally { if (e_6) throw e_6.error; }
            }
        }
        return bizComponentList;
    };
    /**
     *
     * @param roles
     * @param type
     * @returns
     */
    /**
     *
     * @param {?} roles
     * @return {?}
     */
    PropertyHelper.getPerformerList = /**
     *
     * @param {?} roles
     * @return {?}
     */
    function (roles) {
        /** @type {?} */
        var performers = new Array();
        roles.forEach((/**
         * @param {?} role
         * @return {?}
         */
        function (role) {
            if (role == null) {
                return;
            }
            if (role.participantExpression instanceof UserParticipantExpression) {
                /** @type {?} */
                var user = (/** @type {?} */ (role.participantExpression));
                if (user) {
                    /** @type {?} */
                    var userPerformer = new UserParticipant$1();
                    userPerformer.id = user.id;
                    userPerformer.performerId = user.UserId;
                    userPerformer.performerName = user.name;
                    userPerformer.type = user.ClrTypeID;
                    userPerformer.orgId = user.OrgId;
                    userPerformer.orgName = user.OrgName;
                    userPerformer.orgType = user.OrgType;
                    userPerformer.condition = role.condition ? role.condition.Value : '';
                    userPerformer.tag = user.Tag;
                    userPerformer.order = role.order;
                    performers.push(userPerformer);
                }
            }
            else if (role.participantExpression instanceof VariableParticipantExpression) {
                /** @type {?} */
                var variable = (/** @type {?} */ (role.participantExpression));
                if (variable) {
                    /** @type {?} */
                    var variablePerformer = new VariablePerformer();
                    variablePerformer.id = variable.id,
                        variablePerformer.name = variable.Name,
                        variablePerformer.type = variable.ClrTypeID,
                        variablePerformer.condition = role.condition ? role.condition.Value : '',
                        variablePerformer.tag = variable.Tag;
                    variablePerformer.relation = variable.Relation;
                    variablePerformer.varType = variable.VarType;
                    variablePerformer.varValue = variable.VarValue;
                    variablePerformer.order = role.order;
                    performers.push(variablePerformer);
                }
            }
            else if (role.participantExpression instanceof PositionParticipantExpression) {
                /** @type {?} */
                var position = (/** @type {?} */ (role.participantExpression));
                if (position) {
                    /** @type {?} */
                    var positionPerformer = new PositionParticipant$1();
                    positionPerformer.id = position.id;
                    positionPerformer.performerId = position.PositionId;
                    positionPerformer.positionType = position.PositionType;
                    positionPerformer.performerName = position.PositionName;
                    positionPerformer.type = position.ClrTypeID;
                    positionPerformer.orgId = position.OrgId || '';
                    positionPerformer.orgName = position.OrgName || '';
                    positionPerformer.orgType = position.OrgType || '';
                    positionPerformer.condition = role.condition ? role.condition.Value : '';
                    positionPerformer.order = role.order;
                    performers.push(positionPerformer);
                }
            }
            else if (role.participantExpression instanceof ComponentParticipantExpression) {
                /** @type {?} */
                var cmp = (/** @type {?} */ (role.participantExpression));
                if (cmp) {
                    /** @type {?} */
                    var componentPerformer = new ComponentParticipant$1();
                    componentPerformer.id = cmp.id;
                    componentPerformer.name = cmp.componentName;
                    componentPerformer.metadataId = cmp.componentId;
                    componentPerformer.methodCode = cmp.methodCode;
                    componentPerformer.methodName = cmp.methodName;
                    componentPerformer.type = cmp.ClrTypeID;
                    componentPerformer.actualParameters = new Array();
                    if (cmp.actualParameters && cmp.actualParameters.length > 0) {
                        /** @type {?} */
                        var paramters_1 = [];
                        cmp.actualParameters.forEach((/**
                         * @param {?} p
                         * @return {?}
                         */
                        function (p) { return paramters_1.push({ code: p.Name, value: p.Value, valueText: p.ValueText, tag: p.Tag }); }));
                        componentPerformer.actualParameters = paramters_1;
                    }
                    if (role.condition) {
                        componentPerformer.condition = role.condition.Value;
                    }
                    componentPerformer.order = role.order;
                    performers.push(componentPerformer);
                }
            }
            else if (role.participantExpression instanceof ReportingLineParticipantExpression) {
                /** @type {?} */
                var r = (/** @type {?} */ (role.participantExpression));
                if (r) {
                    /** @type {?} */
                    var reportingLine = new ReportingLineParticipant$1();
                    reportingLine.id = r.id;
                    reportingLine.reportingLineDefId = r.ReportingLineDefId;
                    reportingLine.reportingLineDefName = r.ReportingLineDefName;
                    reportingLine.refOrgId = r.RefOrgId;
                    reportingLine.refUserId = r.RefUserId;
                    reportingLine.refEmployeeId = r.RefEmployeeId;
                    reportingLine.dimension = r.Dimension;
                    reportingLine.performerName = r.RefUserId;
                    reportingLine.tag = r.Tag;
                    reportingLine.type = r.ClrTypeID;
                    if (role.condition) {
                        reportingLine.condition = role.condition.Value;
                    }
                    reportingLine.order = role.order;
                    performers.push(reportingLine);
                }
            }
            else if (role.participantExpression instanceof ActivityExecutorParticipantExpression) {
                /** @type {?} */
                var r = (/** @type {?} */ (role.participantExpression));
                if (r) {
                    /** @type {?} */
                    var activityExecutor = new ActivityExecutorParticipant$2();
                    activityExecutor.id = r.id;
                    activityExecutor.type = r.ClrTypeID;
                    activityExecutor.activityDefId = r.activityDefId;
                    activityExecutor.activityDefName = r.activityDefName;
                    activityExecutor.performerName = '<' + r.activityDefName + mxResources.get('eventHandler');
                    if (role.condition) {
                        activityExecutor.condition = role.condition.Value;
                    }
                    activityExecutor.order = role.order;
                    performers.push(activityExecutor);
                }
            }
            else if (role.participantExpression instanceof MatrixParticipantExpression) {
                /** @type {?} */
                var r = (/** @type {?} */ (role.participantExpression));
                if (r) {
                    /** @type {?} */
                    var matrix = new MatrixParticipant$1();
                    matrix.id = r.id;
                    matrix.matrixDefId = r.matrixDefId;
                    matrix.matrixDefName = r.matrixDefName;
                    matrix.conditionField1 = r.conditionField1;
                    matrix.conditionFieldText1 = r.conditionFieldText1;
                    matrix.conditionField2 = r.conditionField2;
                    matrix.conditionFieldText2 = r.conditionFieldText2;
                    matrix.conditionField3 = r.conditionField3;
                    matrix.conditionFieldText3 = r.conditionFieldText3;
                    matrix.multivaluedCondition = r.multivaluedCondition;
                    matrix.dataFieldAlias = r.dataFieldAlias;
                    matrix.type = r.ClrTypeID;
                    matrix.order = role.order;
                    if (role.condition) {
                        matrix.condition = role.condition.Value;
                    }
                    performers.push(matrix);
                }
            }
            else if (role.participantExpression instanceof OrganizationParticipantExpression) {
                /** @type {?} */
                var r = (/** @type {?} */ (role.participantExpression));
                if (r) {
                    /** @type {?} */
                    var organization = new OrganizationParticipant$1;
                    organization.id = r.id;
                    organization.type = r.ClrTypeID;
                    organization.name = r.name;
                    organization.actionScope = (/** @type {?} */ (r.actionScope));
                    organization.organizationLevel = r.organizationLevel;
                    organization.organizationId = r.organizationId;
                    organization.organizationCode = r.organizationCode;
                    organization.organizationName = r.organizationName;
                    organization.includeChildren = r.includeChildren;
                    organization.parentsUntil = r.parentsUntil;
                    organization.tag = r.tag;
                    organization.order = role.order;
                    if (role.condition) {
                        organization.condition = role.condition.Value;
                    }
                    performers.push(organization);
                }
            }
        }));
        return performers;
    };
    /**
     * 移交等的范围，与上个方法比这里传入的是具体的参与者类型（用户参与者、岗位参与者，balbala）
     * @param roles
     * @param type
     * @returns
     */
    /**
     * 移交等的范围，与上个方法比这里传入的是具体的参与者类型（用户参与者、岗位参与者，balbala）
     * @param {?} roles
     * @return {?}
     */
    PropertyHelper.getPerformerListTest = /**
     * 移交等的范围，与上个方法比这里传入的是具体的参与者类型（用户参与者、岗位参与者，balbala）
     * @param {?} roles
     * @return {?}
     */
    function (roles) {
        /** @type {?} */
        var performers = new Array();
        roles.forEach((/**
         * @param {?} role
         * @return {?}
         */
        function (role) {
            if (role == null) {
                return;
            }
            if (role instanceof UserParticipantExpression) {
                /** @type {?} */
                var user = (/** @type {?} */ (role));
                if (user) {
                    /** @type {?} */
                    var userPerformer = new UserParticipant$1();
                    userPerformer.id = user.id;
                    userPerformer.performerId = user.UserId;
                    userPerformer.performerName = user.name;
                    userPerformer.type = user.ClrTypeID;
                    userPerformer.orgId = user.OrgId;
                    userPerformer.orgName = user.OrgName;
                    userPerformer.orgType = user.OrgType;
                    userPerformer.condition = role.condition ? role.condition.Value : '';
                    userPerformer.tag = user.Tag;
                    userPerformer.order = role.order;
                    performers.push(userPerformer);
                }
            }
            else if (role instanceof VariableParticipantExpression) {
                /** @type {?} */
                var variable = (/** @type {?} */ (role));
                if (variable) {
                    /** @type {?} */
                    var variablePerformer = new VariablePerformer();
                    variablePerformer.id = variable.id,
                        variablePerformer.name = variable.Name,
                        variablePerformer.type = variable.ClrTypeID,
                        variablePerformer.condition = role.condition ? role.condition.Value : '',
                        variablePerformer.tag = variable.Tag;
                    variablePerformer.relation = variable.Relation;
                    variablePerformer.varType = variable.VarType;
                    variablePerformer.varValue = variable.VarValue;
                    variablePerformer.order = role.order;
                    performers.push(variablePerformer);
                }
            }
            else if (role instanceof PositionParticipantExpression) {
                /** @type {?} */
                var position = (/** @type {?} */ (role));
                if (position) {
                    /** @type {?} */
                    var positionPerformer = new PositionParticipant$1();
                    positionPerformer.id = position.id;
                    positionPerformer.performerId = position.PositionId;
                    positionPerformer.positionType = position.PositionType;
                    positionPerformer.performerName = position.PositionName;
                    positionPerformer.type = position.ClrTypeID;
                    positionPerformer.orgId = position.OrgId || '';
                    positionPerformer.orgName = position.OrgName || '';
                    positionPerformer.orgType = position.OrgType || '';
                    positionPerformer.condition = role.condition ? role.condition.Value : '';
                    positionPerformer.order = role.order;
                    performers.push(positionPerformer);
                }
            }
            else if (role instanceof ComponentParticipantExpression) {
                /** @type {?} */
                var cmp = (/** @type {?} */ (role));
                if (cmp) {
                    /** @type {?} */
                    var componentPerformer = new ComponentParticipant$1();
                    componentPerformer.id = cmp.id;
                    componentPerformer.name = cmp.componentName;
                    componentPerformer.metadataId = cmp.componentId;
                    componentPerformer.methodCode = cmp.methodCode;
                    componentPerformer.methodName = cmp.methodName;
                    componentPerformer.type = cmp.ClrTypeID;
                    componentPerformer.actualParameters = new Array();
                    if (cmp.actualParameters && cmp.actualParameters.length > 0) {
                        /** @type {?} */
                        var paramters_2 = [];
                        cmp.actualParameters.forEach((/**
                         * @param {?} p
                         * @return {?}
                         */
                        function (p) { return paramters_2.push({ code: p.Name, value: p.Value, valueText: p.ValueText, tag: p.Tag }); }));
                        componentPerformer.actualParameters = paramters_2;
                    }
                    if (role.condition) {
                        componentPerformer.condition = role.condition.Value;
                    }
                    componentPerformer.order = role.order;
                    performers.push(componentPerformer);
                }
            }
            else if (role instanceof ReportingLineParticipantExpression) {
                /** @type {?} */
                var r = (/** @type {?} */ (role));
                if (r) {
                    /** @type {?} */
                    var reportingLine = new ReportingLineParticipant$1();
                    reportingLine.id = r.id;
                    reportingLine.reportingLineDefId = r.ReportingLineDefId;
                    reportingLine.reportingLineDefName = r.ReportingLineDefName;
                    reportingLine.refOrgId = r.RefOrgId;
                    reportingLine.refUserId = r.RefUserId;
                    reportingLine.refEmployeeId = r.RefEmployeeId;
                    reportingLine.dimension = r.Dimension;
                    reportingLine.performerName = r.RefUserId;
                    reportingLine.tag = r.Tag;
                    reportingLine.type = r.ClrTypeID;
                    if (role.condition) {
                        reportingLine.condition = role.condition.Value;
                    }
                    reportingLine.order = role.order;
                    performers.push(reportingLine);
                }
            }
            else if (role instanceof ActivityExecutorParticipantExpression) {
                /** @type {?} */
                var r = (/** @type {?} */ (role));
                if (r) {
                    /** @type {?} */
                    var activityExecutor = new ActivityExecutorParticipant$2();
                    activityExecutor.id = r.id;
                    activityExecutor.type = r.ClrTypeID;
                    activityExecutor.activityDefId = r.activityDefId;
                    activityExecutor.activityDefName = r.activityDefName;
                    activityExecutor.performerName = '<' + r.activityDefName + mxResources.get('eventHandler');
                    if (role.condition) {
                        activityExecutor.condition = role.condition.Value;
                    }
                    activityExecutor.order = role.order;
                    performers.push(activityExecutor);
                }
            }
            else if (role instanceof MatrixParticipantExpression) {
                /** @type {?} */
                var r = (/** @type {?} */ (role));
                if (r) {
                    /** @type {?} */
                    var matrix = new MatrixParticipant$1();
                    matrix.id = r.id;
                    matrix.matrixDefId = r.matrixDefId;
                    matrix.matrixDefName = r.matrixDefName;
                    matrix.conditionField1 = r.conditionField1;
                    matrix.conditionFieldText1 = r.conditionFieldText1;
                    matrix.conditionField2 = r.conditionField2;
                    matrix.conditionFieldText2 = r.conditionFieldText2;
                    matrix.conditionField3 = r.conditionField3;
                    matrix.conditionFieldText3 = r.conditionFieldText3;
                    matrix.multivaluedCondition = r.multivaluedCondition;
                    matrix.dataFieldAlias = r.dataFieldAlias;
                    matrix.type = r.ClrTypeID;
                    matrix.order = role.order;
                    if (role.condition) {
                        matrix.condition = role.condition.Value;
                    }
                    performers.push(matrix);
                }
            }
            else if (role instanceof OrganizationParticipantExpression) {
                /** @type {?} */
                var r = (/** @type {?} */ (role));
                if (r) {
                    /** @type {?} */
                    var organization = new OrganizationParticipant$1;
                    organization.id = r.id;
                    organization.type = r.ClrTypeID;
                    organization.name = r.name;
                    organization.actionScope = (/** @type {?} */ (r.actionScope));
                    organization.organizationLevel = r.organizationLevel;
                    organization.organizationId = r.organizationId;
                    organization.organizationCode = r.organizationCode;
                    organization.organizationName = r.organizationName;
                    organization.includeChildren = r.includeChildren;
                    organization.parentsUntil = r.parentsUntil;
                    organization.tag = r.tag;
                    organization.order = role.order;
                    if (role.condition) {
                        organization.condition = role.condition.Value;
                    }
                    performers.push(organization);
                }
            }
        }));
        return performers;
    };
    /**
     *
     * @param act
     * @returns
     */
    /**
     *
     * @param {?} notifyAble
     * @param {?} dynamicParticipants
     * @return {?}
     */
    PropertyHelper.getNotifyAble = /**
     *
     * @param {?} notifyAble
     * @param {?} dynamicParticipants
     * @return {?}
     */
    function (notifyAble, dynamicParticipants) {
        /** @type {?} */
        var notifyScope = new ActionOrganizationScope();
        notifyScope.action = ActionScope$4.Notify;
        notifyScope.enable = notifyAble;
        if (notifyAble) {
            /** @type {?} */
            var roles = dynamicParticipants.filter((/**
             * @param {?} r
             * @return {?}
             */
            function (r) { return r.actionScope === ActionScope$4.Notify; }));
            /** @type {?} */
            var res = roles.find((/**
             * @param {?} r
             * @return {?}
             */
            function (r) { return ((/** @type {?} */ (r))).organizationLevel && !((/** @type {?} */ (r))).order; }));
            /** @type {?} */
            var list = [];
            if (res) {
                /** @type {?} */
                var organization = new OrganizationParticipant$1;
                organization.id = res.id;
                organization.type = res.ClrTypeID;
                organization.name = res.name;
                organization.actionScope = (/** @type {?} */ (res.actionScope));
                organization.organizationLevel = ((/** @type {?} */ (res))).organizationLevel;
                organization.organizationId = ((/** @type {?} */ (res))).organizationId;
                organization.organizationCode = ((/** @type {?} */ (res))).organizationCode;
                organization.organizationName = ((/** @type {?} */ (res))).organizationName;
                organization.includeChildren = ((/** @type {?} */ (res))).includeChildren;
                organization.parentsUntil = ((/** @type {?} */ (res))).parentsUntil;
                organization.tag = ((/** @type {?} */ (res))).tag;
                organization.order = 1;
                list.push(organization);
            }
            else {
                list = PropertyHelper.getPerformerListTest(roles);
            }
            notifyScope.scope = new OrganizationPotentialOwner();
            if (list && list.length > 0) {
                notifyScope.scope.participantInfo = new ParticipantInfo();
                notifyScope.scope.participantInfo.potentialOwnerList = list;
                notifyScope.scope.participantInfo.isAllScope = true;
            }
            else {
                notifyScope.scope.participantInfo = new ParticipantInfo();
                notifyScope.scope.participantInfo.isAllScope = false;
            }
        }
        return notifyScope;
    };
    /**
     * @param {?} process
     * @param {?} parameters
     * @return {?}
     */
    PropertyHelper.updateFormalParameters = /**
     * @param {?} process
     * @param {?} parameters
     * @return {?}
     */
    function (process, parameters) {
        var e_8, _a, e_9, _b;
        if (!parameters) {
            parameters = [];
        }
        /** @type {?} */
        var objects = process.GetDataObjects();
        if (parameters !== null && parameters.length > 0) {
            try {
                for (var parameters_1 = __values(parameters), parameters_1_1 = parameters_1.next(); !parameters_1_1.done; parameters_1_1 = parameters_1.next()) {
                    var p = parameters_1_1.value;
                    /** @type {?} */
                    var dataType = new DataType(process.Model);
                    try {
                        // 先移除code相同的dataObject
                        for (var objects_1 = __values(objects), objects_1_1 = objects_1.next(); !objects_1_1.done; objects_1_1 = objects_1.next()) {
                            var o = objects_1_1.value;
                            if (o instanceof DataObject && o.Name === p.code) {
                                process.RemoveDataObject(o.Id);
                            }
                        }
                    }
                    catch (e_9_1) { e_9 = { error: e_9_1 }; }
                    finally {
                        try {
                            if (objects_1_1 && !objects_1_1.done && (_b = objects_1.return)) _b.call(objects_1);
                        }
                        finally { if (e_9) throw e_9.error; }
                    }
                    dataType.Category = DataTypes.BasicType;
                    dataType.BasicType = p.dataType;
                    dataType.Description = p.description;
                    // dataType.InitialValue = p.initialValue;
                    if (p.parameterMode === 0) {
                        /** @type {?} */
                        var dataObject = new ValuedDataObject(process.Model);
                        dataObject.Name = p.code;
                        dataObject.Documentation = p.name;
                        dataObject.DataType = dataType;
                        dataObject.IsAllowNull = p.allowNull;
                        if (p.initialValue || p.initialValueType) {
                            /** @type {?} */
                            var variableSetting = new VariableSetting(process.Model);
                            variableSetting.variableCode = p.code;
                            variableSetting.variableName = p.name;
                            variableSetting.tag = p.initialValueType;
                            variableSetting.value = p.initialValue;
                            variableSetting.valueText = p.initialValue;
                            dataObject.variableSetting = variableSetting;
                        }
                        process.AddDataObject(dataObject);
                    }
                }
            }
            catch (e_8_1) { e_8 = { error: e_8_1 }; }
            finally {
                try {
                    if (parameters_1_1 && !parameters_1_1.done && (_a = parameters_1.return)) _a.call(parameters_1);
                }
                finally { if (e_8) throw e_8.error; }
            }
        }
    };
    return PropertyHelper;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/**
 * 流程元素类。
 * 取名虽然Cell，但实际上不需要继承mxCell以及Cell类，仅持有流程与画布实例，方法属性获取与修改操作。
 */
var  /**
 * 流程元素类。
 * 取名虽然Cell，但实际上不需要继承mxCell以及Cell类，仅持有流程与画布实例，方法属性获取与修改操作。
 */
WfProcessCell = /** @class */ (function (_super) {
    __extends(WfProcessCell, _super);
    function WfProcessCell() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    /**
     * @return {?}
     */
    WfProcessCell.prototype.getFarrisPropConfig = /**
     * @return {?}
     */
    function () {
        var e_1, _a, e_2, _b, e_3, _c;
        /** @type {?} */
        var extendList = [];
        if (this.editorUi.procExtProps && this.editorUi.procExtProps.length > 0) {
            extendList = JSON.parse(JSON.stringify(this.editorUi.procExtProps)).sort((/**
             * @param {?} a
             * @param {?} b
             * @return {?}
             */
            function (a, b) {
                return a.sortOrder - b.sortOrder;
            }));
        }
        extendList = extendList.sort((/**
         * @param {?} a
         * @param {?} b
         * @return {?}
         */
        function (a, b) {
            return a.sortOrder - b.sortOrder;
        }));
        /** @type {?} */
        var propertyData = {};
        /** @type {?} */
        var usual = new ElementPropertyConfig();
        usual.categoryId = 'usual';
        usual.categoryName = mxResources.get("basicInfo");
        usual.tabId = 'basic';
        usual.tabName = mxResources.get("basic");
        usual.properties = [
            { propertyID: ProcessPropertyKeys.Name, propertyName: mxResources.get("name"), propertyType: 'string', visible: !this.editorUi.multiLangEnabled },
            { propertyID: ProcessPropertyKeys.NameLanguage, propertyName: mxResources.get("nameLanguage"), propertyType: 'multiLanguage', visible: this.editorUi.multiLangEnabled },
            { propertyID: ProcessPropertyKeys.Key, propertyName: mxResources.get("key"), propertyType: 'string', readonly: true },
            { propertyID: ProcessPropertyKeys.EntryForm, propertyName: mxResources.get("entryForm"), propertyType: 'modal' },
            { propertyID: ProcessPropertyKeys.startMode, propertyName: mxResources.get("startMode"), propertyType: 'select' },
            { propertyID: ProcessPropertyKeys.wf_TitleExpression, propertyName: mxResources.get("wfTitle"), propertyType: 'modal' },
        ];
        /** @type {?} */
        var formDef = new ElementPropertyConfig();
        formDef.categoryId = 'formDef';
        formDef.categoryName = mxResources.get("formDef");
        formDef.tabId = 'basic';
        formDef.tabName = mxResources.get("basic");
        formDef.properties = [
            { propertyID: ProcessPropertyKeys.wf_ExecuteForms_PC, propertyName: mxResources.get("formsPC"), propertyType: 'modal' },
            { propertyID: ProcessPropertyKeys.wf_ExecuteForms_Mobile, propertyName: mxResources.get("formsMobile"), propertyType: 'modal' },
        ];
        /** @type {?} */
        var process = new ElementPropertyConfig();
        process.categoryId = 'process';
        process.categoryName = mxResources.get("process");
        process.tabId = 'advanced';
        process.tabName = mxResources.get("advanced");
        process.properties = [
            { propertyID: ProcessPropertyKeys.wf_Component, propertyName: mxResources.get("wfComponent"), propertyType: 'modal' },
        ];
        /** @type {?} */
        var advanced = new ElementPropertyConfig();
        advanced.categoryId = 'advanced';
        advanced.categoryName = mxResources.get("otherConfig");
        advanced.tabId = 'advanced';
        advanced.tabName = mxResources.get("advanced");
        advanced.properties = [
            { propertyID: ProcessPropertyKeys.processVariables, propertyName: mxResources.get("processVariables"), propertyType: 'modal' },
            { propertyID: ProcessPropertyKeys.wf_CustomizeAction, propertyName: mxResources.get("customizeAction"), propertyType: 'modal' },
            { propertyID: ProcessPropertyKeys.enablePriority, propertyName: mxResources.get("enablePriority"), propertyType: 'select' },
            { propertyID: ProcessPropertyKeys.enableWholeOrderRetrieve, propertyName: mxResources.get("enableWholeOrderRetrieve"), propertyType: 'select', description: mxResources.get("description") },
            { propertyID: ProcessPropertyKeys.imageSettings, propertyName: mxResources.get("messageProperty"), propertyType: 'modal' },
        ];
        /** @type {?} */
        var time = new ElementPropertyConfig();
        time.categoryId = 'messageProperty'; // 消息属性
        time.categoryName = mxResources.get("timelinessInfo");
        time.tabId = 'advanced';
        time.tabName = mxResources.get("advanced");
        time.properties = [
            { propertyID: ProcessPropertyKeys.timeLimitControl, propertyName: mxResources.get("timeLimitControl"), propertyType: 'modal' },
            { propertyID: ProcessPropertyKeys.messageNotice, propertyName: mxResources.get("messageNotice"), propertyType: 'modal' },
        ];
        // 扩展属性分group处理，每个group包含父级属性和属于它的子扩展属性
        /** @type {?} */
        var groupList = new Array();
        try {
            for (var extendList_1 = __values(extendList), extendList_1_1 = extendList_1.next(); !extendList_1_1.done; extendList_1_1 = extendList_1.next()) {
                var extend = extendList_1_1.value;
                if (!extend.parentId) {
                    /** @type {?} */
                    var group = { parent: extend, childs: new Array() };
                    try {
                        for (var extendList_2 = __values(extendList), extendList_2_1 = extendList_2.next(); !extendList_2_1.done; extendList_2_1 = extendList_2.next()) {
                            var e = extendList_2_1.value;
                            if (e.parentId === extend.id) {
                                group.childs.push(e);
                            }
                        }
                    }
                    catch (e_2_1) { e_2 = { error: e_2_1 }; }
                    finally {
                        try {
                            if (extendList_2_1 && !extendList_2_1.done && (_b = extendList_2.return)) _b.call(extendList_2);
                        }
                        finally { if (e_2) throw e_2.error; }
                    }
                    groupList.push(group);
                }
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (extendList_1_1 && !extendList_1_1.done && (_a = extendList_1.return)) _a.call(extendList_1);
            }
            finally { if (e_1) throw e_1.error; }
        }
        // 没有扩展属性值的时候不显示扩展属性一栏
        if (groupList && groupList.length > 0) {
            /** @type {?} */
            var extendProperty = new ElementPropertyConfig();
            extendProperty.categoryId = 'extendProperty';
            extendProperty.categoryName = mxResources.get("extendProperty");
            extendProperty.tabId = 'advanced';
            extendProperty.tabName = mxResources.get("advanced");
            extendProperty.properties = new Array();
            try {
                // 组织扩展属性的二级list
                for (var groupList_1 = __values(groupList), groupList_1_1 = groupList_1.next(); !groupList_1_1.done; groupList_1_1 = groupList_1.next()) {
                    var g = groupList_1_1.value;
                    extendProperty.properties.push({ propertyID: g.parent.id, propertyName: g.parent.propertyTitle, propertyType: 'modal' });
                }
            }
            catch (e_3_1) { e_3 = { error: e_3_1 }; }
            finally {
                try {
                    if (groupList_1_1 && !groupList_1_1.done && (_c = groupList_1.return)) _c.call(groupList_1);
                }
                finally { if (e_3) throw e_3.error; }
            }
            this.setProcessPropertyValue(propertyData, groupList);
            return {
                propertyConfig: [usual, formDef, process, time, advanced, extendProperty],
                propertyData: propertyData
            };
        }
        else {
            this.setProcessPropertyValue(propertyData, groupList);
            return {
                propertyConfig: [usual, formDef, process, time, advanced],
                propertyData: propertyData
            };
        }
    };
    /**
     * @param {?} obj
     * @return {?}
     */
    WfProcessCell.prototype.updateProps = /**
     * @param {?} obj
     * @return {?}
     */
    function (obj) {
        /** @type {?} */
        var propertyID = obj.propertyID;
        if (propertyID) {
            switch (propertyID) {
                case 'EntryForm': //流程分类
                    // 更新流程分类名称（流程分类名称可能修改）
                    this.updateProcessHeader(obj.propertyValue.name, obj.propertyValue.businessObjectId, obj.propertyValue.id);
                    this.updateFlowFormInfo(obj.formalParameters, obj.processBizComponnets, obj.executeForms, obj.customizeActions, obj.bizCmps);
                    this.bindProcessTitleExpression(obj.flowForm.processDescription);
                    break;
                case ProcessPropertyKeys.wf_Component: // 流程构件
                    this.updateProcessComponents(obj.propertyValue);
                    break;
                case ProcessPropertyKeys.wf_ExecuteForms_PC:
                    this.updateExecuteForm(obj.propertyValue, 'PC');
                    if (obj.parameters && obj.parameters.length > 0) {
                        PropertyHelper.updateFormalParameters(this.process, obj.parameters);
                    }
                    break;
                case ProcessPropertyKeys.wf_ExecuteForms_Mobile:
                    this.updateExecuteForm(obj.propertyValue, 'MOBILE');
                    if (obj.parameters && obj.parameters.length > 0) {
                        PropertyHelper.updateFormalParameters(this.process, obj.parameters);
                    }
                    break;
                case ProcessPropertyKeys.wf_CustomizeAction:
                    this.updateCustomizeActions(obj.propertyValue);
                    break;
                case ProcessPropertyKeys.wf_TitleExpression:
                    this.modifyProcessTitleExpression(obj.propertyValue);
                    break;
                case ProcessPropertyKeys.allowPreAssign:
                    this.updateAllowPreAssign(obj.propertyValue);
                    break;
                case ProcessPropertyKeys.startMode:
                    this.updateStartMode(obj.propertyValue, obj.allBizCmps, obj.bizCmps);
                    break;
                case ProcessPropertyKeys.enablePriority:
                    this.updateEnablePriority(obj.propertyValue);
                    break;
                case ProcessPropertyKeys.enableWholeOrderRetrieve:
                    this.updateEnableWholeOrderRetrieve(obj.propertyValue);
                    break;
                case ProcessPropertyKeys.processVariables:
                    this.updateProcessVariables(obj.propertyValue);
                    break;
                case ProcessPropertyKeys.timeLimitControl:
                    this.updateProcessTimeLimitControl(obj.propertyValue);
                    break;
                case ProcessPropertyKeys.messageNotice:
                    this.updateProcessMessageNotices(obj.propertyValue);
                    break;
                case ProcessPropertyKeys.imageSettings:
                    this.updateImageSettings(obj.propertyValue);
                    break;
                default:
                    // 判断ResourceKeys是不是groupid,是就走resetExtendProperty
                    if (this.editorUi.procExtProps.findIndex((/**
                     * @param {?} p
                     * @return {?}
                     */
                    function (p) { return p.id === propertyID; })) > -1) {
                        this.resetExtendProperty(obj.propertyValue);
                    }
                    else {
                        _super.prototype.updateProps.call(this, obj);
                    }
                    break;
            }
        }
    };
    /**
    * 设置流程属性值
    * @param bpmnModel
    * @param propertyData
    * @param groupList
    */
    /**
     * 设置流程属性值
     * @param {?} propertyData
     * @param {?=} groupList
     * @return {?}
     */
    WfProcessCell.prototype.setProcessPropertyValue = /**
     * 设置流程属性值
     * @param {?} propertyData
     * @param {?=} groupList
     * @return {?}
     */
    function (propertyData, groupList) {
        var e_4, _a;
        /** @type {?} */
        var process = this.process;
        if (process) {
            if (!process.Name)
                process.Name = '默认流程';
            if (!process.Key)
                process.Key = BpmnModelHelper.GenerateElementId();
            propertyData[ProcessPropertyKeys.Id] = process.Id;
            propertyData[ProcessPropertyKeys.ClrTypeID] = process.ClrTypeID;
            propertyData[ProcessPropertyKeys.Name] = process.Name;
            propertyData[ProcessPropertyKeys.NameLanguage] = process.NameLanguage || {
                "zh-CHS": process.Name,
            };
            propertyData[ProcessPropertyKeys.Key] = process.Key;
            propertyData[ProcessPropertyKeys.wf_TitleExpression] = '';
            /** @type {?} */
            var extendElements = process.GetExtensionElements();
            /** @type {?} */
            var component = [];
            /** @type {?} */
            var webForm = void 0;
            /** @type {?} */
            var mobileForm = void 0;
            /** @type {?} */
            var customizeActions = [];
            /** @type {?} */
            var proExtendProperties_1 = [];
            /** @type {?} */
            var messagesNotices = new Array();
            // tslint:disable-next-line: forin
            for (var i in extendElements) {
                if (extendElements[i] instanceof ProcessHeader) {
                    propertyData[ProcessPropertyKeys.EntryForm] = {
                        id: ((/** @type {?} */ (extendElements[i]))).BizDefKey,
                        name: ((/** @type {?} */ (extendElements[i]))).BizDefName
                    };
                    propertyData[ProcessPropertyKeys.allowPreAssign] = ((/** @type {?} */ (extendElements[i]))).allowPreAssign;
                    propertyData[ProcessPropertyKeys.startMode] = ((/** @type {?} */ (extendElements[i]))).startMode;
                    propertyData[ProcessPropertyKeys.enablePriority] = ((/** @type {?} */ (extendElements[i]))).enablePriority ? ((/** @type {?} */ (extendElements[i]))).enablePriority : false;
                    propertyData[ProcessPropertyKeys.enableWholeOrderRetrieve] = ((/** @type {?} */ (extendElements[i]))).enableWholeOrderRetrieve ? ((/** @type {?} */ (extendElements[i]))).enableWholeOrderRetrieve : false;
                }
                if (extendElements[i] instanceof Component$1
                    && ((/** @type {?} */ (extendElements[i]))).Time !== ToolTime.UNDEFINITION) {
                    component.push(this.convert2Component((/** @type {?} */ (extendElements[i]))));
                }
                if (extendElements[i] instanceof ExecuteForm) {
                    /** @type {?} */
                    var form = (/** @type {?} */ (extendElements[i]));
                    if (form.TerminalType === 'PC') {
                        webForm = form;
                    }
                    else if (form.TerminalType === 'MOBILE') {
                        mobileForm = form;
                    }
                }
                if (extendElements[i] instanceof TitleExpression) {
                    propertyData[ProcessPropertyKeys.wf_TitleExpression] =
                        ((/** @type {?} */ (extendElements[i]))).valueLanguage ? ((/** @type {?} */ (extendElements[i]))).valueLanguage : ((/** @type {?} */ (extendElements[i]))).value;
                }
                if (extendElements[i] instanceof CustomizeAction) {
                    customizeActions.push(extendElements[i]);
                }
                if (extendElements[i] instanceof MessageNotice) {
                    messagesNotices.push(this.getMessageNotice((/** @type {?} */ (extendElements[i]))));
                }
                if (extendElements[i] instanceof TimeLimitControl) {
                    propertyData[ProcessPropertyKeys.timeLimitControl] = this.getPrcocessTimeLimitInfo((/** @type {?} */ (extendElements[i])));
                }
                if (extendElements[i] instanceof ExtendProperty) {
                    proExtendProperties_1.push(extendElements[i]);
                }
                if (extendElements[i] instanceof ImageSettings) {
                    // imageSettings.push(extendElements[i]);
                    propertyData[ProcessPropertyKeys.imageSettings] = extendElements[i];
                }
            }
            /** @type {?} */
            var processVariables = this.getProcessVariables(process);
            propertyData[ProcessPropertyKeys.processVariables] = processVariables;
            propertyData[ProcessPropertyKeys.wf_Component] = component;
            propertyData[ProcessPropertyKeys.wf_ExecuteForms_PC] = webForm;
            propertyData[ProcessPropertyKeys.wf_ExecuteForms_Mobile] = mobileForm;
            propertyData[ProcessPropertyKeys.wf_CustomizeAction] = customizeActions;
            propertyData[ProcessPropertyKeys.messageNotice] = messagesNotices;
            try {
                for (var groupList_2 = __values(groupList), groupList_2_1 = groupList_2.next(); !groupList_2_1.done; groupList_2_1 = groupList_2.next()) {
                    var g = groupList_2_1.value;
                    // 取回模型上的value值给到扩展属性组件里
                    if (proExtendProperties_1 && proExtendProperties_1.length > 0) {
                        g.childs.sort((/**
                         * @param {?} a
                         * @param {?} b
                         * @return {?}
                         */
                        function (a, b) {
                            return a.sortOrder - b.sortOrder;
                        })).forEach((/**
                         * @param {?} d
                         * @return {?}
                         */
                        function (d) {
                            proExtendProperties_1.forEach((/**
                             * @param {?} e
                             * @return {?}
                             */
                            function (e) {
                                if (e.key == d.code) {
                                    d.value = e.value;
                                }
                            }));
                        }));
                    }
                    propertyData[g.parent.id] = g.childs;
                }
            }
            catch (e_4_1) { e_4 = { error: e_4_1 }; }
            finally {
                try {
                    if (groupList_2_1 && !groupList_2_1.done && (_a = groupList_2.return)) _a.call(groupList_2);
                }
                finally { if (e_4) throw e_4.error; }
            }
        }
    };
    /**
     * @param {?} process
     * @return {?}
     */
    WfProcessCell.prototype.getProcessVariables = /**
     * @param {?} process
     * @return {?}
     */
    function (process) {
        var e_5, _a, e_6, _b, e_7, _c;
        /** @type {?} */
        var processVariables = new Array();
        /** @type {?} */
        var extendElements = process.GetExtensionElements();
        /** @type {?} */
        var dataObjects = process.GetDataObjects();
        if (dataObjects !== null && dataObjects.length > 0) {
            try {
                for (var dataObjects_1 = __values(dataObjects), dataObjects_1_1 = dataObjects_1.next(); !dataObjects_1_1.done; dataObjects_1_1 = dataObjects_1.next()) {
                    var obj = dataObjects_1_1.value;
                    if (obj instanceof ValuedDataObject && obj.DataType.Category !== DataTypes.CustomType) {
                        /** @type {?} */
                        var variable = {
                            id: obj.Id,
                            name: obj.Name,
                            documentation: obj.Documentation,
                            basicType: obj.DataType.BasicType,
                            tag: obj.variableSetting ? obj.variableSetting.tag : '',
                            value: obj.variableSetting ? obj.variableSetting.value : '',
                            valueText: obj.variableSetting ? obj.variableSetting.valueText : '',
                            description: obj.DataType.Description
                        };
                        if (obj.variableSetting && obj.variableSetting.tag === 'component') {
                            if (extendElements.length > 0) {
                                try {
                                    for (var extendElements_1 = __values(extendElements), extendElements_1_1 = extendElements_1.next(); !extendElements_1_1.done; extendElements_1_1 = extendElements_1.next()) {
                                        var e = extendElements_1_1.value;
                                        if (e instanceof Component$1 && e.Id === obj.variableSetting.value) {
                                            /** @type {?} */
                                            var component = {
                                                Id: e.Id,
                                                Name: e.Name,
                                                MetadataId: e.MetadataId,
                                                MethodCode: e.MethodCode,
                                                ActualParameters: []
                                            };
                                            if (e.ActualParameters && e.ActualParameters.length > 0) {
                                                try {
                                                    for (var _d = __values(e.ActualParameters), _e = _d.next(); !_e.done; _e = _d.next()) {
                                                        var p = _e.value;
                                                        /** @type {?} */
                                                        var parameter = {
                                                            Name: p.Name,
                                                            Value: p.Value,
                                                            Tag: p.Tag,
                                                        };
                                                        component.ActualParameters.push(parameter);
                                                    }
                                                }
                                                catch (e_7_1) { e_7 = { error: e_7_1 }; }
                                                finally {
                                                    try {
                                                        if (_e && !_e.done && (_c = _d.return)) _c.call(_d);
                                                    }
                                                    finally { if (e_7) throw e_7.error; }
                                                }
                                            }
                                            variable.component = component;
                                        }
                                    }
                                }
                                catch (e_6_1) { e_6 = { error: e_6_1 }; }
                                finally {
                                    try {
                                        if (extendElements_1_1 && !extendElements_1_1.done && (_b = extendElements_1.return)) _b.call(extendElements_1);
                                    }
                                    finally { if (e_6) throw e_6.error; }
                                }
                            }
                        }
                        processVariables.push(variable);
                    }
                }
            }
            catch (e_5_1) { e_5 = { error: e_5_1 }; }
            finally {
                try {
                    if (dataObjects_1_1 && !dataObjects_1_1.done && (_a = dataObjects_1.return)) _a.call(dataObjects_1);
                }
                finally { if (e_5) throw e_5.error; }
            }
        }
        return processVariables;
    };
    /**
     * @param {?} timeLimitControl
     * @return {?}
     */
    WfProcessCell.prototype.getPrcocessTimeLimitInfo = /**
     * @param {?} timeLimitControl
     * @return {?}
     */
    function (timeLimitControl) {
        var e_8, _a, e_9, _b;
        /** @type {?} */
        var timeLimit;
        if (timeLimitControl) {
            timeLimit = new TimeLimitControlInfo();
            timeLimit.enable = timeLimitControl.enable;
            timeLimit.tag = timeLimitControl.tag;
            timeLimit.dueTime = timeLimitControl.dueTime;
            timeLimit.timeUnit = timeLimitControl.timeUnit;
            timeLimit.expireOperations = new Array();
            if (timeLimitControl.expireOperations && timeLimitControl.expireOperations.length > 0) {
                /** @type {?} */
                var operations = timeLimitControl.expireOperations;
                try {
                    for (var operations_1 = __values(operations), operations_1_1 = operations_1.next(); !operations_1_1.done; operations_1_1 = operations_1.next()) {
                        var o = operations_1_1.value;
                        if (o.ClrTypeID.indexOf('SendMessageExpireOperation') > 0) {
                            /** @type {?} */
                            var operation = (/** @type {?} */ (o));
                            /** @type {?} */
                            var sendMessage = new SendMessageExpireOperationInfo();
                            sendMessage.timeDuration = operation.timeDuration;
                            sendMessage.durationType = operation.durationType;
                            sendMessage.timeUnit = operation.timeUnit;
                            sendMessage.message = operation.message;
                            sendMessage.sendType = operation.sendType;
                            sendMessage.subject = operation.subject;
                            sendMessage.id = operation.id;
                            sendMessage.receiver = operation.receiver;
                            sendMessage.receiverText = operation.receiverText;
                            sendMessage.cycleEnable = operation.cycleEnable;
                            sendMessage.cycleTime = operation.cycleTime;
                            sendMessage.cycleTimeUnit = operation.cycleTimeUnit;
                            sendMessage.operationTypeName = operation.operationTypeName ? operation.operationTypeName : 'SendMessageExpireOperation';
                            if (operation.smsMessageTemplate) {
                                /** @type {?} */
                                var smsTemplate = new Object;
                                smsTemplate.code = operation.smsMessageTemplate.code;
                                smsTemplate.content = operation.smsMessageTemplate.content;
                                smsTemplate.smsMessageVariables = new Array();
                                if (operation.smsMessageTemplate.smsMessageVariables && operation.smsMessageTemplate.smsMessageVariables.length > 0) {
                                    try {
                                        for (var _c = __values(operation.smsMessageTemplate.smsMessageVariables), _d = _c.next(); !_d.done; _d = _c.next()) {
                                            var v = _d.value;
                                            /** @type {?} */
                                            var variable = new Object;
                                            variable.id = WfDesignerUtils.createNM();
                                            variable.code = v.code;
                                            variable.value = v.value;
                                            variable.tag = v.tag;
                                            smsTemplate.smsMessageVariables.push(variable);
                                        }
                                    }
                                    catch (e_9_1) { e_9 = { error: e_9_1 }; }
                                    finally {
                                        try {
                                            if (_d && !_d.done && (_b = _c.return)) _b.call(_c);
                                        }
                                        finally { if (e_9) throw e_9.error; }
                                    }
                                }
                                sendMessage.smsMessageTemplate = smsTemplate;
                            }
                            timeLimit.expireOperations.push(sendMessage);
                        }
                        else if (o.ClrTypeID.indexOf('AutoHandleExpireOperation') > 0) {
                            /** @type {?} */
                            var operation = (/** @type {?} */ (o));
                            /** @type {?} */
                            var autoHandle = new AutoHandleExpireOperationInfo;
                            autoHandle.id = operation.id;
                            autoHandle.durationType = operation.durationType;
                            autoHandle.timeDuration = operation.timeDuration;
                            autoHandle.timeUnit = operation.timeUnit;
                            autoHandle.operationTypeName = operation.operationTypeName ? operation.operationTypeName : 'AutoHandleExpireOperation';
                            autoHandle.autoHandleType = operation.autoHandleType;
                            autoHandle.message = operation.message;
                            timeLimit.expireOperations.push(autoHandle);
                        }
                    }
                }
                catch (e_8_1) { e_8 = { error: e_8_1 }; }
                finally {
                    try {
                        if (operations_1_1 && !operations_1_1.done && (_a = operations_1.return)) _a.call(operations_1);
                    }
                    finally { if (e_8) throw e_8.error; }
                }
            }
        }
        return timeLimit;
    };
    /**
     * @param {?} messageNotice
     * @return {?}
     */
    WfProcessCell.prototype.getMessageNotice = /**
     * @param {?} messageNotice
     * @return {?}
     */
    function (messageNotice) {
        var e_10, _a, e_11, _b;
        /** @type {?} */
        var message = new Object;
        message.content = messageNotice.content;
        message.sendTime = messageNotice.sendTime;
        message.sendType = messageNotice.sendType;
        message.subject = messageNotice.subject;
        if (messageNotice.smsMessageTemplate) {
            /** @type {?} */
            var smsTemplate = new Object;
            smsTemplate.code = messageNotice.smsMessageTemplate.code;
            smsTemplate.content = messageNotice.smsMessageTemplate.content;
            smsTemplate.smsMessageVariables = new Array();
            if (messageNotice.smsMessageTemplate.smsMessageVariables && messageNotice.smsMessageTemplate.smsMessageVariables.length > 0) {
                try {
                    for (var _c = __values(messageNotice.smsMessageTemplate.smsMessageVariables), _d = _c.next(); !_d.done; _d = _c.next()) {
                        var v = _d.value;
                        /** @type {?} */
                        var variable = new Object;
                        variable.id = WfDesignerUtils.createNM();
                        variable.code = v.code;
                        variable.value = v.value;
                        variable.tag = v.tag;
                        smsTemplate.smsMessageVariables.push(variable);
                    }
                }
                catch (e_10_1) { e_10 = { error: e_10_1 }; }
                finally {
                    try {
                        if (_d && !_d.done && (_a = _c.return)) _a.call(_c);
                    }
                    finally { if (e_10) throw e_10.error; }
                }
            }
            message.smsMessageTemplate = smsTemplate;
        }
        /** @type {?} */
        var receiverExpressions = new Array();
        if (messageNotice.receiver) {
            /** @type {?} */
            var receivers = messageNotice.receiver.split(',');
            /** @type {?} */
            var receiverTexts = messageNotice.receiverText.split(',');
            /** @type {?} */
            var userReceiver = new MessageReceiver$1();
            userReceiver.type = 'userParticipant';
            userReceiver.userIds = '';
            userReceiver.userNames = '';
            for (var i in receivers) {
                if (receivers[i] === 'procInstCreator') {
                    /** @type {?} */
                    var procInstCreator = new MessageReceiver$1();
                    procInstCreator.type = 'processParticipant';
                    procInstCreator.processParticipant = 'procInstCreator';
                    receiverExpressions.push(procInstCreator);
                }
                else if (receivers[i] === 'workItemParticipant') {
                    /** @type {?} */
                    var workItemParticipant = new MessageReceiver$1();
                    workItemParticipant.type = 'processParticipant';
                    workItemParticipant.processParticipant = 'workItemParticipant';
                    receiverExpressions.push(workItemParticipant);
                }
                else {
                    userReceiver.userIds += (receivers[i] + ',');
                    userReceiver.userNames += (receiverTexts[i] + ',');
                }
            }
            if (userReceiver.userIds) {
                userReceiver.userIds = userReceiver.userIds.substring(0, userReceiver.userIds.length - 1);
                userReceiver.userNames = userReceiver.userNames.substring(0, userReceiver.userNames.length - 1);
                receiverExpressions.push(userReceiver);
            }
        }
        if (messageNotice.receiverExpressions && messageNotice.receiverExpressions.length > 0) {
            try {
                for (var _e = __values(messageNotice.receiverExpressions), _f = _e.next(); !_f.done; _f = _e.next()) {
                    var e = _f.value;
                    if (e instanceof ActivityExecutorParticipantExpression) {
                        /** @type {?} */
                        var activityExecutorParticipant = new MessageReceiver$1();
                        activityExecutorParticipant.type = 'processParticipant';
                        activityExecutorParticipant.processParticipant = 'activityExecutorParticipant';
                        activityExecutorParticipant.activityDefId = ((/** @type {?} */ (e))).activityDefId;
                        activityExecutorParticipant.activityDefName = ((/** @type {?} */ (e))).activityDefName;
                        receiverExpressions.push(activityExecutorParticipant);
                    }
                    else if (e instanceof UserParticipantExpression) {
                        /** @type {?} */
                        var variableReceiver = new MessageReceiver$1();
                        variableReceiver.type = 'variableParticipant';
                        variableReceiver.variableParticipant = ((/** @type {?} */ (e))).UserId;
                        variableReceiver.variableName = ((/** @type {?} */ (e))).name;
                        variableReceiver.orgType = ((/** @type {?} */ (e))).OrgType;
                        receiverExpressions.push(variableReceiver);
                    }
                    else if (e instanceof PositionParticipantExpression) {
                        /** @type {?} */
                        var positionReceiver = new MessageReceiver$1();
                        positionReceiver.type = 'positionParticipant';
                        positionReceiver.positionId = ((/** @type {?} */ (e))).PositionId;
                        positionReceiver.positionName = ((/** @type {?} */ (e))).PositionName;
                        positionReceiver.positionType = ((/** @type {?} */ (e))).PositionType;
                        if (positionReceiver.positionType === '1') {
                            positionReceiver.orgId = ((/** @type {?} */ (e))).OrgId;
                            positionReceiver.orgType = ((/** @type {?} */ (e))).OrgType;
                        }
                        receiverExpressions.push(positionReceiver);
                    }
                }
            }
            catch (e_11_1) { e_11 = { error: e_11_1 }; }
            finally {
                try {
                    if (_f && !_f.done && (_b = _e.return)) _b.call(_e);
                }
                finally { if (e_11) throw e_11.error; }
            }
        }
        if (receiverExpressions.length > 0) {
            message.receivers = receiverExpressions;
        }
        return message;
    };
    /**
     * @param {?} component
     * @return {?}
     */
    WfProcessCell.prototype.convert2Component = /**
     * @param {?} component
     * @return {?}
     */
    function (component) {
        var e_12, _a;
        /** @type {?} */
        var bizComponent = new BizComponent();
        bizComponent.id = component.Id;
        bizComponent.name = component.Name;
        bizComponent.metadataId = component.MetadataId;
        bizComponent.methodCode = component.MethodCode;
        bizComponent.executionTime = component.Time;
        bizComponent.isForCompensation = component.isForCompensation;
        bizComponent.scopeType = component.ScopeType || null;
        bizComponent.actualParameters = new Array();
        if (component.ActualParameters && component.ActualParameters.length > 0) {
            try {
                for (var _b = __values(component.ActualParameters), _c = _b.next(); !_c.done; _c = _b.next()) {
                    var param = _c.value;
                    /** @type {?} */
                    var bizParam = new BizParameter();
                    bizParam.code = param.Name;
                    bizParam.name = param.Name;
                    bizParam.value = param.Value;
                    bizComponent.actualParameters.push(bizParam);
                }
            }
            catch (e_12_1) { e_12 = { error: e_12_1 }; }
            finally {
                try {
                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                }
                finally { if (e_12) throw e_12.error; }
            }
        }
        return bizComponent;
    };
    /**
     * 设置ProcessHeader
     * @param ffId
     * @param bizObjId
     * @param ffName
     * @param startMode
     */
    /**
     * 设置ProcessHeader
     * @param {?} ffId
     * @param {?} bizObjId
     * @param {?} ffName
     * @param {?} startMode
     * @return {?}
     */
    WfProcessCell.prototype.setProcessHeader = /**
     * 设置ProcessHeader
     * @param {?} ffId
     * @param {?} bizObjId
     * @param {?} ffName
     * @param {?} startMode
     * @return {?}
     */
    function (ffId, bizObjId, ffName, startMode) {
        /** @type {?} */
        var process = this.process;
        /** @type {?} */
        var extendElements = process.GetExtensionElements();
        /** @type {?} */
        var processHeader = new ProcessHeader(process.Model, ffId, bizObjId, ffName, startMode);
        extendElements.push(processHeader);
    };
    /**
     * 更新流程分类绑定的参数，流程组件，表单信息
     * @param params 参数列表
     * @param cpts 流程组件
     * @param form 流程表单
     */
    /**
     * 更新流程分类绑定的参数，流程组件，表单信息
     * @param {?} params 参数列表
     * @param {?} cpts 流程组件
     * @param {?} forms
     * @param {?} customizeActions
     * @param {?} bizCmps
     * @return {?}
     */
    WfProcessCell.prototype.updateFlowFormInfo = /**
     * 更新流程分类绑定的参数，流程组件，表单信息
     * @param {?} params 参数列表
     * @param {?} cpts 流程组件
     * @param {?} forms
     * @param {?} customizeActions
     * @param {?} bizCmps
     * @return {?}
     */
    function (params, cpts, forms, customizeActions, bizCmps) {
        this.updateFormalParameters(params, cpts.filter((/**
         * @param {?} cpt
         * @return {?}
         */
        function (cpt) { return cpt.ownerType === 'Schema'; })));
        this.setProcessComponents(cpts, bizCmps);
        this.updateExecuteForms(forms);
        this.updateCustomizeActions(customizeActions);
    };
    /**
     * @param {?} parameters
     * @param {?=} cmps
     * @return {?}
     */
    WfProcessCell.prototype.updateFormalParameters = /**
     * @param {?} parameters
     * @param {?=} cmps
     * @return {?}
     */
    function (parameters, cmps) {
        if (cmps === void 0) { cmps = new Array(); }
        var e_13, _a;
        if (!parameters) {
            parameters = [];
        }
        /** @type {?} */
        var process = this.process;
        /** @type {?} */
        var objects = process.GetDataObjects();
        if (parameters !== null && parameters.length > 0) {
            var _loop_1 = function (p) {
                var e_14, _a, e_15, _b;
                /** @type {?} */
                var dataType = new DataType(process.Model);
                if (p.dataType === 'CDTSchema') {
                    try {
                        // 先清理CDTSchema类型的dataObject
                        for (var objects_1 = __values(objects), objects_1_1 = objects_1.next(); !objects_1_1.done; objects_1_1 = objects_1.next()) {
                            var o = objects_1_1.value;
                            //TODO:数据类型为customType暂时默认为参数预制
                            if (o instanceof DataObject && o.DataType.Category === DataTypes.CustomType) {
                                process.RemoveDataObject(o.Id);
                            }
                        }
                    }
                    catch (e_14_1) { e_14 = { error: e_14_1 }; }
                    finally {
                        try {
                            if (objects_1_1 && !objects_1_1.done && (_a = objects_1.return)) _a.call(objects_1);
                        }
                        finally { if (e_14) throw e_14.error; }
                    }
                    // 重新绑定流程分类支持精简be
                    /** @type {?} */
                    var customType = new CDTSchemaType(process.Model);
                    if (p.newSchemaId && p.newSchemaMetadataId) {
                        customType.SchemaId = p.newSchemaId;
                        customType.MetadataId = p.newSchemaMetadataId;
                    }
                    else {
                        customType.SchemaId = p.schemaId;
                        customType.MetadataId = p.schemaMetadataId;
                    }
                    customType.ComponentId = cmps.filter((/**
                     * @param {?} cmp
                     * @return {?}
                     */
                    function (cmp) { return cmp.owner === p.schemaId; }))[0].id;
                    dataType.Category = DataTypes.CustomType;
                    dataType.CustomType = customType;
                }
                else {
                    try {
                        // 先清理code相同的dataObject
                        for (var objects_2 = __values(objects), objects_2_1 = objects_2.next(); !objects_2_1.done; objects_2_1 = objects_2.next()) {
                            var o = objects_2_1.value;
                            if (o instanceof DataObject && o.Name === p.code) {
                                process.RemoveDataObject(o.Id);
                            }
                        }
                    }
                    catch (e_15_1) { e_15 = { error: e_15_1 }; }
                    finally {
                        try {
                            if (objects_2_1 && !objects_2_1.done && (_b = objects_2.return)) _b.call(objects_2);
                        }
                        finally { if (e_15) throw e_15.error; }
                    }
                    dataType.Category = DataTypes.BasicType;
                    dataType.BasicType = p.dataType;
                }
                dataType.Description = p.description;
                // dataType.InitialValue = p.initialValue;
                if (p.parameterMode === 0) {
                    /** @type {?} */
                    var dataObject = new ValuedDataObject(process.Model);
                    dataObject.Name = p.code;
                    dataObject.Documentation = p.name;
                    dataObject.DataType = dataType;
                    dataObject.IsAllowNull = p.allowNull;
                    if (p.initialValue || p.initialValueType) {
                        /** @type {?} */
                        var variableSetting = new VariableSetting(process.Model);
                        variableSetting.variableCode = p.code;
                        variableSetting.variableName = p.name;
                        variableSetting.tag = p.initialValueType;
                        variableSetting.value = p.initialValue;
                        variableSetting.valueText = p.initialValue;
                        dataObject.variableSetting = variableSetting;
                    }
                    process.AddDataObject(dataObject);
                }
            };
            try {
                for (var parameters_1 = __values(parameters), parameters_1_1 = parameters_1.next(); !parameters_1_1.done; parameters_1_1 = parameters_1.next()) {
                    var p = parameters_1_1.value;
                    _loop_1(p);
                }
            }
            catch (e_13_1) { e_13 = { error: e_13_1 }; }
            finally {
                try {
                    if (parameters_1_1 && !parameters_1_1.done && (_a = parameters_1.return)) _a.call(parameters_1);
                }
                finally { if (e_13) throw e_13.error; }
            }
        }
    };
    /**
     * 基于流程分类的切换更新流程构件
     */
    /**
     * 基于流程分类的切换更新流程构件
     * @param {?} procCpts
     * @param {?} bizCmps
     * @return {?}
     */
    WfProcessCell.prototype.setProcessComponents = /**
     * 基于流程分类的切换更新流程构件
     * @param {?} procCpts
     * @param {?} bizCmps
     * @return {?}
     */
    function (procCpts, bizCmps) {
        var e_16, _a, e_17, _b, e_18, _c, e_19, _d, e_20, _e, e_21, _f, e_22, _g, e_23, _h, e_24, _j, e_25, _k;
        /** @type {?} */
        var process = this.process;
        /** @type {?} */
        var processHeader;
        /** @type {?} */
        var extendElements = process.GetExtensionElements();
        //删除流程构件
        if (extendElements.length > 0) {
            for (var i = extendElements.length; i > 0; i--) {
                if (extendElements[i - 1] instanceof Component$1
                    && ((/** @type {?} */ (extendElements[i - 1]))).Time !== ToolTime.UNDEFINITION) {
                    extendElements.splice(i - 1, 1);
                }
                if (extendElements[i - 1] instanceof ProcessHeader) {
                    processHeader = (/** @type {?} */ (extendElements[i - 1]));
                }
            }
        }
        // 子流程和外部流程的情况先需要绑定取数构件
        if (processHeader.startMode !== StartMode.DIRECT) {
            /** @type {?} */
            var loadDataComponent = procCpts.find((/**
             * @param {?} p
             * @return {?}
             */
            function (p) { return p.executionTime === ToolTime.LOADDATA; }));
            if (loadDataComponent) {
                /** @type {?} */
                var ldCpt = new Component$1(process.Model);
                ldCpt.Time = (/** @type {?} */ (loadDataComponent.executionTime));
                ldCpt.MetadataId = loadDataComponent.metadataId;
                ldCpt.MethodCode = loadDataComponent.methodCode;
                ldCpt.Id = loadDataComponent.id;
                ldCpt.Name = loadDataComponent.name;
                ldCpt.isForCompensation = loadDataComponent.isForCompensation;
                ldCpt.ActualParameters = [];
                if (loadDataComponent.scopeType) {
                    ldCpt.ScopeType = loadDataComponent.scopeType;
                }
                else {
                    ldCpt.ScopeType = "Undefined";
                }
                if (loadDataComponent.actualParameters && loadDataComponent.actualParameters.length > 0) {
                    try {
                        for (var _l = __values(loadDataComponent.actualParameters), _m = _l.next(); !_m.done; _m = _l.next()) {
                            var item = _m.value;
                            /** @type {?} */
                            var parameter = new ActualParameter(process.Model, item.code, item.value);
                            ldCpt.ActualParameters.push(parameter);
                        }
                    }
                    catch (e_16_1) { e_16 = { error: e_16_1 }; }
                    finally {
                        try {
                            if (_m && !_m.done && (_a = _l.return)) _a.call(_l);
                        }
                        finally { if (e_16) throw e_16.error; }
                    }
                }
                // 把取数构件放进去
                extendElements.push(ldCpt);
                // 如果是外部流程，校验是否集成统一预制的外部流程构件
                if (processHeader.startMode == StartMode.EXTERNAL_PROCESS) {
                    /** @type {?} */
                    var externalCmps = false;
                    /** @type {?} */
                    var cmps = bizCmps;
                    if (cmps && cmps.length > 0) {
                        try {
                            // 此处标记有外部流程通用构件
                            for (var cmps_1 = __values(cmps), cmps_1_1 = cmps_1.next(); !cmps_1_1.done; cmps_1_1 = cmps_1.next()) {
                                var c = cmps_1_1.value;
                                if (c.scopeType === 'ExternalProcess') {
                                    externalCmps = true;
                                    break;
                                }
                            }
                        }
                        catch (e_17_1) { e_17 = { error: e_17_1 }; }
                        finally {
                            try {
                                if (cmps_1_1 && !cmps_1_1.done && (_b = cmps_1.return)) _b.call(cmps_1);
                            }
                            finally { if (e_17) throw e_17.error; }
                        }
                    }
                    // 如果没有外部流程构件
                    if (!externalCmps) {
                        if (procCpts && procCpts.length > 0) {
                            try {
                                for (var procCpts_1 = __values(procCpts), procCpts_1_1 = procCpts_1.next(); !procCpts_1_1.done; procCpts_1_1 = procCpts_1.next()) {
                                    var procCpt = procCpts_1_1.value;
                                    /** @type {?} */
                                    var cpt = new Component$1(process.Model);
                                    cpt.Time = (/** @type {?} */ (procCpt.executionTime));
                                    cpt.MetadataId = procCpt.metadataId;
                                    cpt.MethodCode = procCpt.methodCode;
                                    cpt.Id = procCpt.id;
                                    cpt.Name = procCpt.name;
                                    cpt.isForCompensation = procCpt.isForCompensation;
                                    cpt.ActualParameters = [];
                                    if (procCpt.scopeType) {
                                        cpt.ScopeType = procCpt.scopeType;
                                    }
                                    else {
                                        cpt.ScopeType = "Undefined";
                                    }
                                    if (procCpt.actualParameters && procCpt.actualParameters.length > 0) {
                                        try {
                                            for (var _o = __values(procCpt.actualParameters), _p = _o.next(); !_p.done; _p = _o.next()) {
                                                var item = _p.value;
                                                /** @type {?} */
                                                var parameter = new ActualParameter(process.Model, item.code, item.value);
                                                cpt.ActualParameters.push(parameter);
                                            }
                                        }
                                        catch (e_19_1) { e_19 = { error: e_19_1 }; }
                                        finally {
                                            try {
                                                if (_p && !_p.done && (_d = _o.return)) _d.call(_o);
                                            }
                                            finally { if (e_19) throw e_19.error; }
                                        }
                                    }
                                    // 避免重复的放入取数构件,不要取数，子流程和直接流程的构件，要未定义，外部，全量的
                                    if (cpt.Time !== ToolTime.LOADDATA
                                        && cpt.ScopeType !== StartMode.DIRECT
                                        && cpt.ScopeType !== StartMode.SUB_PROCESS) {
                                        extendElements.push(cpt);
                                    }
                                }
                            }
                            catch (e_18_1) { e_18 = { error: e_18_1 }; }
                            finally {
                                try {
                                    if (procCpts_1_1 && !procCpts_1_1.done && (_c = procCpts_1.return)) _c.call(procCpts_1);
                                }
                                finally { if (e_18) throw e_18.error; }
                            }
                        }
                    }
                    else {
                        try {
                            for (var procCpts_2 = __values(procCpts), procCpts_2_1 = procCpts_2.next(); !procCpts_2_1.done; procCpts_2_1 = procCpts_2.next()) {
                                var procCpt = procCpts_2_1.value;
                                /** @type {?} */
                                var cpt = new Component$1(process.Model);
                                cpt.Time = (/** @type {?} */ (procCpt.executionTime));
                                cpt.MetadataId = procCpt.metadataId;
                                cpt.MethodCode = procCpt.methodCode;
                                cpt.Id = procCpt.id;
                                cpt.Name = procCpt.name;
                                cpt.isForCompensation = procCpt.isForCompensation;
                                cpt.ActualParameters = [];
                                if (procCpt.scopeType) {
                                    cpt.ScopeType = procCpt.scopeType;
                                }
                                else {
                                    cpt.ScopeType = "Undefined";
                                }
                                if (procCpt.actualParameters && procCpt.actualParameters.length > 0) {
                                    try {
                                        for (var _q = __values(procCpt.actualParameters), _r = _q.next(); !_r.done; _r = _q.next()) {
                                            var item = _r.value;
                                            /** @type {?} */
                                            var parameter = new ActualParameter(process.Model, item.code, item.value);
                                            cpt.ActualParameters.push(parameter);
                                        }
                                    }
                                    catch (e_21_1) { e_21 = { error: e_21_1 }; }
                                    finally {
                                        try {
                                            if (_r && !_r.done && (_f = _q.return)) _f.call(_q);
                                        }
                                        finally { if (e_21) throw e_21.error; }
                                    }
                                }
                                // 避免重复的放入取数构件,不要取数，子流程和直接流程,未知的构件，外部，全量的
                                if (cpt.Time !== ToolTime.LOADDATA
                                    && cpt.ScopeType !== StartMode.DIRECT
                                    && cpt.ScopeType !== StartMode.SUB_PROCESS
                                    && cpt.ScopeType !== "Undefined") {
                                    extendElements.push(cpt);
                                }
                            }
                        }
                        catch (e_20_1) { e_20 = { error: e_20_1 }; }
                        finally {
                            try {
                                if (procCpts_2_1 && !procCpts_2_1.done && (_e = procCpts_2.return)) _e.call(procCpts_2);
                            }
                            finally { if (e_20) throw e_20.error; }
                        }
                    }
                    // 如果有外部流程构件，同样只保留取数构件，不需要其他处理(取数构件已经放进去了)
                    // 刷新一下属性框
                    this.editorUi.fireEvent(new mxEventObject(PmfEvents.ShowProperty));
                }
                else if (processHeader.startMode == StartMode.SUB_PROCESS) {
                    if (procCpts && procCpts.length > 0) {
                        try {
                            for (var procCpts_3 = __values(procCpts), procCpts_3_1 = procCpts_3.next(); !procCpts_3_1.done; procCpts_3_1 = procCpts_3.next()) {
                                var procCpt = procCpts_3_1.value;
                                /** @type {?} */
                                var cpt = new Component$1(process.Model);
                                cpt.Time = (/** @type {?} */ (procCpt.executionTime));
                                cpt.MetadataId = procCpt.metadataId;
                                cpt.MethodCode = procCpt.methodCode;
                                cpt.Id = procCpt.id;
                                cpt.Name = procCpt.name;
                                cpt.isForCompensation = procCpt.isForCompensation;
                                cpt.ActualParameters = [];
                                if (procCpt.scopeType) {
                                    cpt.ScopeType = procCpt.scopeType;
                                }
                                else {
                                    cpt.ScopeType = "Undefined";
                                }
                                if (procCpt.actualParameters && procCpt.actualParameters.length > 0) {
                                    try {
                                        for (var _s = __values(procCpt.actualParameters), _t = _s.next(); !_t.done; _t = _s.next()) {
                                            var item = _t.value;
                                            /** @type {?} */
                                            var parameter = new ActualParameter(process.Model, item.code, item.value);
                                            cpt.ActualParameters.push(parameter);
                                        }
                                    }
                                    catch (e_23_1) { e_23 = { error: e_23_1 }; }
                                    finally {
                                        try {
                                            if (_t && !_t.done && (_h = _s.return)) _h.call(_s);
                                        }
                                        finally { if (e_23) throw e_23.error; }
                                    }
                                }
                                // 避免重复的放入取数构件,不要取数，直接流程和外部流程，未定义的构件，要子流程，全量的
                                if (cpt.Time !== ToolTime.LOADDATA
                                    && cpt.ScopeType !== StartMode.DIRECT
                                    && cpt.ScopeType !== StartMode.EXTERNAL_PROCESS
                                    && cpt.ScopeType !== "Undefined") {
                                    extendElements.push(cpt);
                                }
                            }
                        }
                        catch (e_22_1) { e_22 = { error: e_22_1 }; }
                        finally {
                            try {
                                if (procCpts_3_1 && !procCpts_3_1.done && (_g = procCpts_3.return)) _g.call(procCpts_3);
                            }
                            finally { if (e_22) throw e_22.error; }
                        }
                    }
                }
                // 如果是子流程则不需要其他处理(取数构件已经放进去了)
            }
        }
        else { // 直接流程
            // 直接流程
            // 直接流程过滤掉共享的构件
            /** @type {?} */
            var actualCmps = procCpts.filter((/**
             * @param {?} p
             * @return {?}
             */
            function (p) { return WfDesignerUtils.isPfComponent(p.metadataId) === false; }));
            if (actualCmps && actualCmps.length > 0) {
                try {
                    for (var actualCmps_1 = __values(actualCmps), actualCmps_1_1 = actualCmps_1.next(); !actualCmps_1_1.done; actualCmps_1_1 = actualCmps_1.next()) {
                        var procCpt = actualCmps_1_1.value;
                        /** @type {?} */
                        var cpt = new Component$1(process.Model);
                        cpt.Time = (/** @type {?} */ (procCpt.executionTime));
                        cpt.MetadataId = procCpt.metadataId;
                        cpt.MethodCode = procCpt.methodCode;
                        cpt.Id = procCpt.id;
                        cpt.Name = procCpt.name;
                        cpt.isForCompensation = procCpt.isForCompensation;
                        if (procCpt.scopeType) {
                            cpt.ScopeType = procCpt.scopeType;
                        }
                        else {
                            cpt.ScopeType = "Undefined";
                        }
                        cpt.ActualParameters = [];
                        if (procCpt.actualParameters && procCpt.actualParameters.length > 0) {
                            try {
                                for (var _u = __values(procCpt.actualParameters), _v = _u.next(); !_v.done; _v = _u.next()) {
                                    var item = _v.value;
                                    /** @type {?} */
                                    var parameter = new ActualParameter(process.Model, item.code, item.value);
                                    cpt.ActualParameters.push(parameter);
                                }
                            }
                            catch (e_25_1) { e_25 = { error: e_25_1 }; }
                            finally {
                                try {
                                    if (_v && !_v.done && (_k = _u.return)) _k.call(_u);
                                }
                                finally { if (e_25) throw e_25.error; }
                            }
                        }
                        // 避免重复的放入取数构件,子流程和外部流程的构件，要未定义，直接，全量的
                        if (cpt.ScopeType !== StartMode.EXTERNAL_PROCESS
                            && cpt.ScopeType !== StartMode.SUB_PROCESS) {
                            extendElements.push(cpt);
                        }
                    }
                }
                catch (e_24_1) { e_24 = { error: e_24_1 }; }
                finally {
                    try {
                        if (actualCmps_1_1 && !actualCmps_1_1.done && (_j = actualCmps_1.return)) _j.call(actualCmps_1);
                    }
                    finally { if (e_24) throw e_24.error; }
                }
            }
        }
    };
    /**
     * @param {?} forms
     * @return {?}
     */
    WfProcessCell.prototype.updateExecuteForms = /**
     * @param {?} forms
     * @return {?}
     */
    function (forms) {
        var e_26, _a;
        /** @type {?} */
        var process = this.process;
        /** @type {?} */
        var extendElements = process.GetExtensionElements();
        //删除表单构件
        if (extendElements.length > 0) {
            for (var i = extendElements.length; i > 0; i--) {
                if (extendElements[i - 1] instanceof ExecuteForm) {
                    extendElements.splice(i - 1, 1);
                }
            }
        }
        try {
            for (var forms_1 = __values(forms), forms_1_1 = forms_1.next(); !forms_1_1.done; forms_1_1 = forms_1.next()) {
                var f = forms_1_1.value;
                this.updateExecuteForm(f);
            }
        }
        catch (e_26_1) { e_26 = { error: e_26_1 }; }
        finally {
            try {
                if (forms_1_1 && !forms_1_1.done && (_a = forms_1.return)) _a.call(forms_1);
            }
            finally { if (e_26) throw e_26.error; }
        }
    };
    /**
     * @param {?} form
     * @param {?=} terminal
     * @return {?}
     */
    WfProcessCell.prototype.updateExecuteForm = /**
     * @param {?} form
     * @param {?=} terminal
     * @return {?}
     */
    function (form, terminal) {
        var e_27, _a;
        /** @type {?} */
        var process = this.process;
        /** @type {?} */
        var extendElements = process.GetExtensionElements();
        //删除表单构件
        if (extendElements.length > 0) {
            for (var i = extendElements.length; i > 0; i--) {
                if (extendElements[i - 1] instanceof ExecuteForm) {
                    /** @type {?} */
                    var f = (/** @type {?} */ (extendElements[i - 1]));
                    if (f.TerminalType === (terminal ? terminal : form.TerminalType)) {
                        extendElements.splice(i - 1, 1);
                    }
                }
            }
        }
        if (form) {
            /** @type {?} */
            var params = (/** @type {?} */ (form.ActualParameters));
            /** @type {?} */
            var actParas = new Array();
            if (params && params.length > 0) {
                try {
                    for (var params_1 = __values(params), params_1_1 = params_1.next(); !params_1_1.done; params_1_1 = params_1.next()) {
                        var para = params_1_1.value;
                        /** @type {?} */
                        var actPara = new ActualParameter(process.Model, para.Name, para.Value);
                        if (para.Tag) {
                            actPara.Tag = para.Tag;
                        }
                        else {
                            if (para.Value) {
                                if (para.Value.length >= 8 && para.Value.slice(0, 8) === "{\"expr\":") {
                                    actPara.Tag = 'expression';
                                }
                                else {
                                    actPara.Tag = 'constant';
                                }
                            }
                            else {
                                actPara.Tag = 'variable';
                            }
                        }
                        actParas.push(actPara);
                    }
                }
                catch (e_27_1) { e_27 = { error: e_27_1 }; }
                finally {
                    try {
                        if (params_1_1 && !params_1_1.done && (_a = params_1.return)) _a.call(params_1);
                    }
                    finally { if (e_27) throw e_27.error; }
                }
            }
            /** @type {?} */
            var id = BpmnModelHelper.GenerateElementId();
            /** @type {?} */
            var item = new ExecuteForm(process.Model, id, form.Name, actParas);
            item.ComponentId = form.ComponentId;
            item.FormType = form.FormType;
            item.formFormatId = form.formFormatId;
            item.formatConfigId = form.formatConfigId;
            item.TerminalType = form.TerminalType;
            extendElements.push(item);
        }
    };
    /**
     * @param {?} customizeActions
     * @return {?}
     */
    WfProcessCell.prototype.updateCustomizeActions = /**
     * @param {?} customizeActions
     * @return {?}
     */
    function (customizeActions) {
        var e_28, _a, e_29, _b;
        /** @type {?} */
        var process = this.process;
        /** @type {?} */
        var extendElements = process.GetExtensionElements();
        //删除流程构件
        if (extendElements.length > 0) {
            for (var i = extendElements.length; i > 0; i--) {
                if (extendElements[i - 1] instanceof CustomizeAction) {
                    extendElements.splice(i - 1, 1);
                }
            }
        }
        //重新绑定
        if (customizeActions && customizeActions.length > 0) {
            try {
                for (var customizeActions_1 = __values(customizeActions), customizeActions_1_1 = customizeActions_1.next(); !customizeActions_1_1.done; customizeActions_1_1 = customizeActions_1.next()) {
                    var a = customizeActions_1_1.value;
                    /** @type {?} */
                    var action = new CustomizeAction(process.Model);
                    action.id = BpmnModelHelper.GenerateElementId();
                    action.code = a.code;
                    action.name = a.name;
                    action.terminalType = a.terminalType;
                    // action.enable = a.enable;
                    action.actualParameters = [];
                    if (a.actualParameters && a.actualParameters.length > 0) {
                        try {
                            for (var _c = __values(a.actualParameters), _d = _c.next(); !_d.done; _d = _c.next()) {
                                var p = _d.value;
                                /** @type {?} */
                                var parameter = new ActualParameter(process.Model, p.Name, p.Value, p.ValueText, p.Tag || 'expression');
                                action.actualParameters.push(parameter);
                            }
                        }
                        catch (e_29_1) { e_29 = { error: e_29_1 }; }
                        finally {
                            try {
                                if (_d && !_d.done && (_b = _c.return)) _b.call(_c);
                            }
                            finally { if (e_29) throw e_29.error; }
                        }
                    }
                    extendElements.push(action);
                }
            }
            catch (e_28_1) { e_28 = { error: e_28_1 }; }
            finally {
                try {
                    if (customizeActions_1_1 && !customizeActions_1_1.done && (_a = customizeActions_1.return)) _a.call(customizeActions_1);
                }
                finally { if (e_28) throw e_28.error; }
            }
        }
    };
    /**
     * 更新流程备注
     * @param bpmnModel
     * @param value
     */
    /**
     * 更新流程备注
     * @param {?} value
     * @return {?}
     */
    WfProcessCell.prototype.modifyProcessTitleExpression = /**
     * 更新流程备注
     * @param {?} value
     * @return {?}
     */
    function (value) {
        /** @type {?} */
        var process = this.process;
        /** @type {?} */
        var extendElements = process.GetExtensionElements();
        if (extendElements.length > 0) {
            for (var i = extendElements.length; i > 0; i--) {
                if (extendElements[i - 1] instanceof TitleExpression) {
                    extendElements.splice(i - 1, 1);
                }
            }
        }
        /** @type {?} */
        var title = new TitleExpression(process.Model);
        if (typeof (value) === 'string' || value == null) {
            title = new TitleExpression(process.Model, value);
        }
        else {
            title = new TitleExpression(process.Model, value['zh-CHS'], value);
        }
        extendElements.push(title);
    };
    /**
     * @param {?} ffName
     * @param {?=} bizObjId
     * @param {?=} ffId
     * @return {?}
     */
    WfProcessCell.prototype.updateProcessHeader = /**
     * @param {?} ffName
     * @param {?=} bizObjId
     * @param {?=} ffId
     * @return {?}
     */
    function (ffName, bizObjId, ffId) {
        /** @type {?} */
        var process = this.process;
        /** @type {?} */
        var extendElements = process.GetExtensionElements();
        if (extendElements !== null && extendElements.length > 0) {
            for (var i in extendElements) {
                if (extendElements[i] instanceof ProcessHeader) {
                    ((/** @type {?} */ (extendElements[i]))).BizDefName = ffName;
                    ((/** @type {?} */ (extendElements[i]))).BizObjId = bizObjId;
                    ((/** @type {?} */ (extendElements[i]))).BizDefKey = ffId;
                    return;
                }
            }
        }
    };
    /**
     * @param {?} value
     * @return {?}
     */
    WfProcessCell.prototype.bindProcessTitleExpression = /**
     * @param {?} value
     * @return {?}
     */
    function (value) {
        /** @type {?} */
        var process = this.process;
        /** @type {?} */
        var extendElements = process.GetExtensionElements();
        /** @type {?} */
        var titleExpression = (/** @type {?} */ (extendElements.find((/**
         * @param {?} e
         * @return {?}
         */
        function (e) { return e.ClrTypeID === TitleExpression.Clr_Type_ID; }))));
        if (titleExpression && titleExpression.value) {
            return;
        }
        /** @type {?} */
        var title = new TitleExpression(process.Model, value);
        extendElements.push(title);
    };
    /**
     * 基于流程分类的切换更新流程构件
     */
    /**
     * 基于流程分类的切换更新流程构件
     * @param {?} procCpts
     * @return {?}
     */
    WfProcessCell.prototype.updateProcessComponents = /**
     * 基于流程分类的切换更新流程构件
     * @param {?} procCpts
     * @return {?}
     */
    function (procCpts) {
        var e_30, _a, e_31, _b;
        /** @type {?} */
        var process = this.process;
        /** @type {?} */
        var extendElements = process.GetExtensionElements();
        //删除流程构件
        if (extendElements.length > 0) {
            for (var i = extendElements.length; i > 0; i--) {
                if (extendElements[i - 1] instanceof Component$1
                    && ((/** @type {?} */ (extendElements[i - 1]))).Time !== ToolTime.UNDEFINITION) {
                    extendElements.splice(i - 1, 1);
                }
            }
        }
        //重新绑定
        if (procCpts && procCpts.length > 0) {
            try {
                for (var procCpts_4 = __values(procCpts), procCpts_4_1 = procCpts_4.next(); !procCpts_4_1.done; procCpts_4_1 = procCpts_4.next()) {
                    var procCpt = procCpts_4_1.value;
                    /** @type {?} */
                    var cpt = new Component$1(process.Model);
                    cpt.Time = (/** @type {?} */ (procCpt.executionTime));
                    cpt.MetadataId = procCpt.metadataId;
                    cpt.MethodCode = procCpt.methodCode;
                    cpt.Id = procCpt.id;
                    cpt.Name = procCpt.name;
                    cpt.isForCompensation = procCpt.isForCompensation;
                    cpt.ActualParameters = [];
                    if (procCpt.actualParameters && procCpt.actualParameters.length > 0) {
                        try {
                            for (var _c = __values(procCpt.actualParameters), _d = _c.next(); !_d.done; _d = _c.next()) {
                                var item = _d.value;
                                /** @type {?} */
                                var parameter = new ActualParameter(process.Model, item.code, item.value);
                                cpt.ActualParameters.push(parameter);
                            }
                        }
                        catch (e_31_1) { e_31 = { error: e_31_1 }; }
                        finally {
                            try {
                                if (_d && !_d.done && (_b = _c.return)) _b.call(_c);
                            }
                            finally { if (e_31) throw e_31.error; }
                        }
                    }
                    extendElements.push(cpt);
                }
            }
            catch (e_30_1) { e_30 = { error: e_30_1 }; }
            finally {
                try {
                    if (procCpts_4_1 && !procCpts_4_1.done && (_a = procCpts_4.return)) _a.call(procCpts_4);
                }
                finally { if (e_30) throw e_30.error; }
            }
        }
    };
    /**
     * @param {?} assign
     * @return {?}
     */
    WfProcessCell.prototype.updateAllowPreAssign = /**
     * @param {?} assign
     * @return {?}
     */
    function (assign) {
        /** @type {?} */
        var process = this.process;
        /** @type {?} */
        var extendElements = process.GetExtensionElements();
        if (extendElements !== null && extendElements.length > 0) {
            for (var i in extendElements) {
                if (extendElements[i] instanceof ProcessHeader) {
                    ((/** @type {?} */ (extendElements[i]))).allowPreAssign = assign;
                    return;
                }
            }
        }
    };
    /**
     * @param {?} priority
     * @return {?}
     */
    WfProcessCell.prototype.updateEnablePriority = /**
     * @param {?} priority
     * @return {?}
     */
    function (priority) {
        /** @type {?} */
        var process = this.process;
        /** @type {?} */
        var extendElements = process.GetExtensionElements();
        if (extendElements !== null && extendElements.length > 0) {
            for (var i in extendElements) {
                if (extendElements[i] instanceof ProcessHeader) {
                    ((/** @type {?} */ (extendElements[i]))).enablePriority = priority;
                    return;
                }
            }
        }
    };
    /**
     * @param {?} startMode
     * @param {?} allCmps
     * @param {?} bizCmps
     * @return {?}
     */
    WfProcessCell.prototype.updateStartMode = /**
     * @param {?} startMode
     * @param {?} allCmps
     * @param {?} bizCmps
     * @return {?}
     */
    function (startMode, allCmps, bizCmps) {
        var e_32, _a;
        // 对于启动方式的提示信息
        switch (startMode) {
            case StartMode.DIRECT:
                this.editorUi.fireEvent(new mxEventObject(WfEvents.ShowTips, "data", {
                    type: 'message',
                    level: 'info',
                    message: mxResources.get("directTips"),
                }));
                break;
            case StartMode.EXTERNAL_PROCESS:
                this.editorUi.fireEvent(new mxEventObject(WfEvents.ShowTips, "data", {
                    type: 'message',
                    level: 'info',
                    message: mxResources.get("externalTips"),
                }));
                break;
            case StartMode.SUB_PROCESS:
                this.editorUi.fireEvent(new mxEventObject(WfEvents.ShowTips, "data", {
                    type: 'message',
                    level: 'info',
                    message: mxResources.get("subprocessTips"),
                }));
                break;
        }
        /** @type {?} */
        var process = this.process;
        /** @type {?} */
        var extendElements = process.GetExtensionElements();
        if (extendElements !== null && extendElements.length > 0) {
            /** @type {?} */
            var procHeader = (/** @type {?} */ (extendElements.filter((/**
             * @param {?} e
             * @return {?}
             */
            function (e) { return e instanceof ProcessHeader; }))));
            // 修改启动方式
            procHeader[0].startMode = startMode;
            //删除流程构件
            if (extendElements.length > 0) {
                for (var i = extendElements.length; i > 0; i--) {
                    if (extendElements[i - 1] instanceof Component$1
                        && ((/** @type {?} */ (extendElements[i - 1]))).Time !== ToolTime.UNDEFINITION
                        && ((/** @type {?} */ (extendElements[i - 1]))).Time !== ToolTime.LOADDATA) {
                        extendElements.splice(i - 1, 1);
                    }
                }
            }
            allCmps && allCmps.forEach((/**
             * @param {?} procCpt
             * @return {?}
             */
            function (procCpt) {
                /** @type {?} */
                var cpt = new Component$1(process.Model);
                cpt.Time = (/** @type {?} */ (procCpt.executionTime));
                cpt.MetadataId = procCpt.metadataId;
                cpt.MethodCode = procCpt.methodCode;
                cpt.Id = procCpt.id;
                cpt.Name = procCpt.name;
                cpt.isForCompensation = procCpt.isForCompensation;
                cpt.ActualParameters = [];
                if (procCpt.scopeType) {
                    cpt.ScopeType = procCpt.scopeType;
                }
                else {
                    cpt.ScopeType = "Undefined";
                }
                procCpt.actualParameters && procCpt.actualParameters.forEach((/**
                 * @param {?} item
                 * @return {?}
                 */
                function (item) {
                    /** @type {?} */
                    var parameter = new ActualParameter(process.Model, item.code, item.value);
                    cpt.ActualParameters.push(parameter);
                }));
                extendElements.push(cpt);
            }));
            /** @type {?} */
            var procCmps = (/** @type {?} */ (extendElements.filter((/**
             * @param {?} e
             * @return {?}
             */
            function (e) { return e instanceof Component$1; }))));
            // 如果启动方式是子流程,只保留取数构件
            if (startMode === StartMode.SUB_PROCESS) {
                // Utils.postMessage(ResourceKeys.wf_showTip, {
                //     type: 'message',
                //     level: 'info',
                //     message: `启动方式为子流程，需要移除取数构件以外的流程构件`,
                // });
                for (var i = extendElements.length; i > 0; i--) {
                    if (extendElements[i - 1] instanceof Component$1) {
                        /** @type {?} */
                        var cmp = (/** @type {?} */ (extendElements[i - 1]));
                        if (cmp.Time !== ToolTime.UNDEFINITION
                            && cmp.Time !== ToolTime.LOADDATA
                            && (cmp.ScopeType !== StartMode.SUB_PROCESS && cmp.ScopeType !== "All_Process")) {
                            extendElements.splice(i - 1, 1);
                        }
                    }
                }
            }
            // 如果启动方式是直接启动,不允许存在共享的构件
            if (startMode === StartMode.DIRECT) {
                // 判断有没有共享（PF）的流程构件
                /** @type {?} */
                var pfCmps = procCmps.filter((/**
                 * @param {?} p
                 * @return {?}
                 */
                function (p) { return WfDesignerUtils.isPfComponent(p.MetadataId); }));
                if (pfCmps && pfCmps.length > 0) {
                    // 删掉共享的构件和启动方式
                    for (var i = extendElements.length; i > 0; i--) {
                        if (extendElements[i - 1] instanceof Component$1) {
                            /** @type {?} */
                            var cmp = (/** @type {?} */ (extendElements[i - 1]));
                            if (WfDesignerUtils.isPfComponent(cmp.MetadataId)
                                || cmp.ScopeType === StartMode.EXTERNAL_PROCESS
                                || cmp.ScopeType === StartMode.SUB_PROCESS) {
                                extendElements.splice(i - 1, 1);
                            }
                        }
                    }
                }
                // 如果启动方式是外部流程
            }
            else if (startMode === StartMode.EXTERNAL_PROCESS) {
                // const otherCmps = procCmps.filter((p: Component) => (p.MetadataId !== ResourceKeys.pf_Cmp_Id1
                //     && p.MetadataId !== ResourceKeys.pf_Cmp_Id2
                //     && p.MetadataId !== ResourceKeys.pf_Cmp_Id3
                //     && p.MetadataId !== ResourceKeys.pf_Cmp_Id4
                //     && p.Time !== ToolTime.LOADDATA
                // ));
                // 判断有没有预制外部流程通用构件
                /** @type {?} */
                var externalCmps = false;
                /** @type {?} */
                var cmps = bizCmps;
                if (cmps && cmps.length > 0) {
                    try {
                        // 此处标记是外部流程通用构件
                        for (var cmps_2 = __values(cmps), cmps_2_1 = cmps_2.next(); !cmps_2_1.done; cmps_2_1 = cmps_2.next()) {
                            var c = cmps_2_1.value;
                            if (c.scopeType === 'ExternalProcess') {
                                externalCmps = true;
                                break;
                            }
                        }
                    }
                    catch (e_32_1) { e_32 = { error: e_32_1 }; }
                    finally {
                        try {
                            if (cmps_2_1 && !cmps_2_1.done && (_a = cmps_2.return)) _a.call(cmps_2);
                        }
                        finally { if (e_32) throw e_32.error; }
                    }
                    // 如果预制了外部流程通用构件,只保留取数构件，没有则不处理
                    if (externalCmps) {
                        for (var i = extendElements.length; i > 0; i--) {
                            if (extendElements[i - 1] instanceof Component$1) {
                                /** @type {?} */
                                var cmp = (/** @type {?} */ (extendElements[i - 1]));
                                if (cmp.Time !== ToolTime.UNDEFINITION
                                    && cmp.Time !== ToolTime.LOADDATA
                                    && (cmp.ScopeType === StartMode.DIRECT
                                        || cmp.ScopeType === StartMode.SUB_PROCESS
                                        || cmp.ScopeType === "Undefined")) {
                                    extendElements.splice(i - 1, 1);
                                }
                            }
                        }
                    }
                }
            }
        }
        this.editorUi.fireEvent(new mxEventObject(PmfEvents.ShowProperty));
    };
    /**
     * @param {?} variables
     * @return {?}
     */
    WfProcessCell.prototype.updateProcessVariables = /**
     * @param {?} variables
     * @return {?}
     */
    function (variables) {
        var e_33, _a, e_34, _b, e_35, _c;
        /** @type {?} */
        var process = this.process;
        /** @type {?} */
        var objects = process.GetDataObjects();
        /** @type {?} */
        var extendElements = process.GetExtensionElements();
        if (objects && objects.length > 0) {
            var _loop_2 = function (o) {
                if (o instanceof ValuedDataObject && o.DataType.Category !== DataTypes.CustomType) {
                    if (o.variableSetting && o.variableSetting.tag === 'component') {
                        /** @type {?} */
                        var i = extendElements.findIndex((/**
                         * @param {?} e
                         * @return {?}
                         */
                        function (e) { return (e instanceof Component$1 && e.Id === o.variableSetting.value); }));
                        extendElements.splice(i, 1);
                    }
                    process.RemoveDataObject(o.Id);
                }
            };
            try {
                for (var objects_3 = __values(objects), objects_3_1 = objects_3.next(); !objects_3_1.done; objects_3_1 = objects_3.next()) {
                    var o = objects_3_1.value;
                    _loop_2(o);
                }
            }
            catch (e_33_1) { e_33 = { error: e_33_1 }; }
            finally {
                try {
                    if (objects_3_1 && !objects_3_1.done && (_a = objects_3.return)) _a.call(objects_3);
                }
                finally { if (e_33) throw e_33.error; }
            }
        }
        if (variables !== null && variables.length > 0) {
            try {
                for (var variables_1 = __values(variables), variables_1_1 = variables_1.next(); !variables_1_1.done; variables_1_1 = variables_1.next()) {
                    var v = variables_1_1.value;
                    /** @type {?} */
                    var dataType = new DataType(process.Model);
                    dataType.Category = DataTypes.BasicType;
                    dataType.BasicType = v.basicType;
                    dataType.Description = v.description;
                    /** @type {?} */
                    var dataObject = new ValuedDataObject(process.Model);
                    dataObject.Id = v.id;
                    dataObject.Name = v.name;
                    dataObject.Documentation = v.documentation;
                    dataObject.DataType = dataType;
                    if (v.tag && v.value) {
                        /** @type {?} */
                        var variableSetting = new VariableSetting(process.Model);
                        variableSetting.variableCode = v.name;
                        variableSetting.variableName = v.documentation;
                        variableSetting.tag = v.tag;
                        variableSetting.value = v.value;
                        variableSetting.valueText = v.valueText;
                        dataObject.variableSetting = variableSetting;
                        if (variableSetting.tag === 'component') {
                            /** @type {?} */
                            var c = v.component;
                            if (c) {
                                /** @type {?} */
                                var cpt = new Component$1(process.Model);
                                cpt.MetadataId = c.MetadataId;
                                cpt.MethodCode = c.MethodCode;
                                cpt.Id = c.Id;
                                cpt.Name = c.Name;
                                cpt.ActualParameters = new Array();
                                if (c.ActualParameters && c.ActualParameters.length > 0) {
                                    try {
                                        for (var _d = __values(c.ActualParameters), _e = _d.next(); !_e.done; _e = _d.next()) {
                                            var a = _e.value;
                                            /** @type {?} */
                                            var parameter = new ActualParameter(process.Model, a.Name, a.Value);
                                            parameter.Tag = a.Tag;
                                            cpt.ActualParameters.push(parameter);
                                        }
                                    }
                                    catch (e_35_1) { e_35 = { error: e_35_1 }; }
                                    finally {
                                        try {
                                            if (_e && !_e.done && (_c = _d.return)) _c.call(_d);
                                        }
                                        finally { if (e_35) throw e_35.error; }
                                    }
                                }
                                extendElements.push(cpt);
                            }
                        }
                    }
                    process.AddDataObject(dataObject);
                }
            }
            catch (e_34_1) { e_34 = { error: e_34_1 }; }
            finally {
                try {
                    if (variables_1_1 && !variables_1_1.done && (_b = variables_1.return)) _b.call(variables_1);
                }
                finally { if (e_34) throw e_34.error; }
            }
        }
    };
    /**
     * @param {?} timeLimit
     * @return {?}
     */
    WfProcessCell.prototype.updateProcessTimeLimitControl = /**
     * @param {?} timeLimit
     * @return {?}
     */
    function (timeLimit) {
        var e_36, _a, e_37, _b;
        /** @type {?} */
        var process = this.process;
        /** @type {?} */
        var extendElements = process.GetExtensionElements();
        if (extendElements.length > 0) {
            for (var i = extendElements.length; i > 0; i--) {
                if (extendElements[i - 1] instanceof TimeLimitControl) {
                    extendElements.splice(i - 1, 1);
                }
            }
        }
        /** @type {?} */
        var timeLimitInfo = (/** @type {?} */ (timeLimit));
        if (timeLimitInfo) {
            /** @type {?} */
            var control = new TimeLimitControl(process.Model);
            control.enable = timeLimitInfo.enable;
            control.tag = timeLimitInfo.tag;
            control.dueTime = timeLimitInfo.dueTime;
            control.timeUnit = timeLimitInfo.timeUnit;
            control.expireOperations = new Array();
            if (timeLimitInfo.expireOperations && timeLimitInfo.expireOperations.length > 0) {
                try {
                    for (var _c = __values(timeLimitInfo.expireOperations), _d = _c.next(); !_d.done; _d = _c.next()) {
                        var o = _d.value;
                        if (o.operationTypeName === 'SendMessageExpireOperation' || !o.operationTypeName) {
                            /** @type {?} */
                            var operation = (/** @type {?} */ (o));
                            /** @type {?} */
                            var sendMessage = new SendMessageExpireOperation(process.Model);
                            sendMessage.id = BpmnModelHelper.GenerateElementId();
                            sendMessage.durationType = (/** @type {?} */ (operation.durationType));
                            sendMessage.timeDuration = operation.timeDuration;
                            sendMessage.timeUnit = operation.timeUnit;
                            sendMessage.operationTypeName = operation.operationTypeName ? operation.operationTypeName : 'SendMessageExpireOperation';
                            sendMessage.message = operation.message;
                            sendMessage.subject = operation.subject;
                            sendMessage.sendType = operation.sendType;
                            sendMessage.receiver = operation.receiver;
                            sendMessage.receiverText = operation.receiverText;
                            sendMessage.cycleEnable = operation.cycleEnable;
                            sendMessage.cycleTime = operation.cycleTime;
                            sendMessage.cycleTimeUnit = operation.cycleTimeUnit;
                            if (operation.smsMessageTemplate) {
                                /** @type {?} */
                                var smsMessageTemplate = new SmsMessageTemplate(process.Model);
                                smsMessageTemplate.code = operation.smsMessageTemplate.code;
                                smsMessageTemplate.content = operation.smsMessageTemplate.content;
                                smsMessageTemplate.smsMessageVariables = new Array();
                                if (operation.smsMessageTemplate.smsMessageVariables && operation.smsMessageTemplate.smsMessageVariables.length > 0) {
                                    try {
                                        for (var _e = __values(operation.smsMessageTemplate.smsMessageVariables), _f = _e.next(); !_f.done; _f = _e.next()) {
                                            var v = _f.value;
                                            /** @type {?} */
                                            var variable = new SmsMessageVariable(process.Model);
                                            variable.code = v.code;
                                            variable.value = v.value;
                                            variable.tag = v.tag;
                                            smsMessageTemplate.smsMessageVariables.push(variable);
                                        }
                                    }
                                    catch (e_37_1) { e_37 = { error: e_37_1 }; }
                                    finally {
                                        try {
                                            if (_f && !_f.done && (_b = _e.return)) _b.call(_e);
                                        }
                                        finally { if (e_37) throw e_37.error; }
                                    }
                                }
                                sendMessage.smsMessageTemplate = smsMessageTemplate;
                            }
                            control.expireOperations.push(sendMessage);
                        }
                        else if (o.operationTypeName === 'AutoHandleExpireOperation') {
                            /** @type {?} */
                            var operation = (/** @type {?} */ (o));
                            /** @type {?} */
                            var autoHandle = new AutoHandleExpireOperation(process.Model);
                            autoHandle.id = BpmnModelHelper.GenerateElementId();
                            autoHandle.durationType = (/** @type {?} */ (operation.durationType));
                            autoHandle.timeDuration = operation.timeDuration;
                            autoHandle.timeUnit = operation.timeUnit;
                            autoHandle.operationTypeName = operation.operationTypeName ? operation.operationTypeName : 'AutoHandleExpireOperation';
                            autoHandle.autoHandleType = operation.autoHandleType;
                            autoHandle.message = operation.message;
                            control.expireOperations.push(autoHandle);
                        }
                    }
                }
                catch (e_36_1) { e_36 = { error: e_36_1 }; }
                finally {
                    try {
                        if (_d && !_d.done && (_a = _c.return)) _a.call(_c);
                    }
                    finally { if (e_36) throw e_36.error; }
                }
            }
            extendElements.push(control);
        }
    };
    /**
     * @param {?} notices
     * @return {?}
     */
    WfProcessCell.prototype.updateProcessMessageNotices = /**
     * @param {?} notices
     * @return {?}
     */
    function (notices) {
        var e_38, _a, e_39, _b, e_40, _c, e_41, _d;
        /** @type {?} */
        var process = this.process;
        /** @type {?} */
        var extendElements = process.GetExtensionElements();
        if (extendElements.length > 0) {
            for (var i = extendElements.length; i > 0; i--) {
                if (extendElements[i - 1] instanceof MessageNotice) {
                    extendElements.splice(i - 1, 1);
                }
            }
        }
        if (notices && notices.length > 0) {
            try {
                for (var notices_1 = __values(notices), notices_1_1 = notices_1.next(); !notices_1_1.done; notices_1_1 = notices_1.next()) {
                    var n = notices_1_1.value;
                    /** @type {?} */
                    var messageNotice = new MessageNotice(process.Model);
                    messageNotice.sendType = n.sendType;
                    messageNotice.sendTime = n.sendTime;
                    messageNotice.subject = n.subject;
                    messageNotice.content = n.content;
                    // messageNotice.receiver = n.receiver;
                    // messageNotice.receiverText = n.receiverText;
                    n.receivers = n.receivers.filter((/**
                     * @param {?} r
                     * @return {?}
                     */
                    function (r) { return r.type; }));
                    if (n.receivers && n.receivers.length > 0) {
                        /** @type {?} */
                        var receivers = n.receivers.filter((/**
                         * @param {?} r
                         * @return {?}
                         */
                        function (r) { return r.type === 'userParticipant'
                            || (r.type === 'processParticipant' && r.processParticipant !== 'activityExecutorParticipant'); }));
                        /** @type {?} */
                        var participants = n.receivers.filter((/**
                         * @param {?} r
                         * @return {?}
                         */
                        function (r) { return r.type === 'variableParticipant' || r.type === 'positionParticipant'
                            || (r.type === 'processParticipant' && r.processParticipant === 'activityExecutorParticipant'); }));
                        if (receivers && receivers.length > 0) {
                            /** @type {?} */
                            var receiver = '';
                            /** @type {?} */
                            var receiverName = '';
                            try {
                                for (var receivers_1 = __values(receivers), receivers_1_1 = receivers_1.next(); !receivers_1_1.done; receivers_1_1 = receivers_1.next()) {
                                    var r = receivers_1_1.value;
                                    if (r.type === 'processParticipant') {
                                        receiver += (r.processParticipant + ',');
                                        if (r.processParticipant === 'procInstCreator') {
                                            receiverName += '流程发起人,';
                                        }
                                        else if (r.processParticipant === 'workItemParticipant') {
                                            receiverName += '任务接收人,';
                                        }
                                    }
                                    else if (r.type === 'userParticipant') {
                                        receiver += (r.userIds + ',');
                                        receiverName += (r.userNames + ',');
                                    }
                                }
                            }
                            catch (e_39_1) { e_39 = { error: e_39_1 }; }
                            finally {
                                try {
                                    if (receivers_1_1 && !receivers_1_1.done && (_b = receivers_1.return)) _b.call(receivers_1);
                                }
                                finally { if (e_39) throw e_39.error; }
                            }
                            if (receiver) {
                                receiver = receiver.substring(0, receiver.length - 1);
                            }
                            if (receiverName) {
                                receiverName = receiverName.substring(0, receiverName.length - 1);
                            }
                            messageNotice.receiver = receiver;
                            messageNotice.receiverText = receiverName;
                        }
                        if (participants && participants.length > 0) {
                            /** @type {?} */
                            var receiverExpressions = new Array();
                            try {
                                for (var participants_1 = __values(participants), participants_1_1 = participants_1.next(); !participants_1_1.done; participants_1_1 = participants_1.next()) {
                                    var p = participants_1_1.value;
                                    if (p.type === 'processParticipant') {
                                        /** @type {?} */
                                        var activityExecutor = new ActivityExecutorParticipantExpression(process.Model);
                                        activityExecutor.id = BpmnModelHelper.GenerateElementId();
                                        activityExecutor.activityDefId = p.activityDefId;
                                        activityExecutor.activityDefName = p.activityDefName;
                                        receiverExpressions.push(activityExecutor);
                                    }
                                    if (p.type === 'variableParticipant') {
                                        /** @type {?} */
                                        var variableParticipant = new UserParticipantExpression(process.Model, p.variableParticipant, p.variableName, p.orgType);
                                        variableParticipant.id = BpmnModelHelper.GenerateElementId();
                                        variableParticipant.Tag = 'expression';
                                        variableParticipant.OrgType = p.orgType;
                                        receiverExpressions.push(variableParticipant);
                                    }
                                    if (p.type === 'positionParticipant') {
                                        /** @type {?} */
                                        var posiParticipant = new PositionParticipantExpression(process.Model, p.positionId, p.positionName);
                                        posiParticipant.id = BpmnModelHelper.GenerateElementId();
                                        posiParticipant.PositionType = p.positionType;
                                        if (p.positionType === '1') {
                                            posiParticipant.OrgId = p.orgId;
                                            posiParticipant.OrgType = p.orgType;
                                        }
                                        receiverExpressions.push(posiParticipant);
                                    }
                                }
                            }
                            catch (e_40_1) { e_40 = { error: e_40_1 }; }
                            finally {
                                try {
                                    if (participants_1_1 && !participants_1_1.done && (_c = participants_1.return)) _c.call(participants_1);
                                }
                                finally { if (e_40) throw e_40.error; }
                            }
                            messageNotice.receiverExpressions = receiverExpressions;
                        }
                    }
                    if (n.smsMessageTemplate) {
                        /** @type {?} */
                        var smsMessageTemplate = new SmsMessageTemplate(process.Model);
                        smsMessageTemplate.code = n.smsMessageTemplate.code;
                        smsMessageTemplate.content = n.smsMessageTemplate.content;
                        smsMessageTemplate.smsMessageVariables = new Array();
                        if (n.smsMessageTemplate.smsMessageVariables && n.smsMessageTemplate.smsMessageVariables.length > 0) {
                            try {
                                for (var _e = __values(n.smsMessageTemplate.smsMessageVariables), _f = _e.next(); !_f.done; _f = _e.next()) {
                                    var v = _f.value;
                                    /** @type {?} */
                                    var variable = new SmsMessageVariable(process.Model);
                                    variable.code = v.code;
                                    variable.value = v.value;
                                    variable.tag = v.tag;
                                    smsMessageTemplate.smsMessageVariables.push(variable);
                                }
                            }
                            catch (e_41_1) { e_41 = { error: e_41_1 }; }
                            finally {
                                try {
                                    if (_f && !_f.done && (_d = _e.return)) _d.call(_e);
                                }
                                finally { if (e_41) throw e_41.error; }
                            }
                        }
                        messageNotice.smsMessageTemplate = smsMessageTemplate;
                    }
                    extendElements.push(messageNotice);
                }
            }
            catch (e_38_1) { e_38 = { error: e_38_1 }; }
            finally {
                try {
                    if (notices_1_1 && !notices_1_1.done && (_a = notices_1.return)) _a.call(notices_1);
                }
                finally { if (e_38) throw e_38.error; }
            }
        }
    };
    /**
     * @param {?} imageSettings
     * @return {?}
     */
    WfProcessCell.prototype.updateImageSettings = /**
     * @param {?} imageSettings
     * @return {?}
     */
    function (imageSettings) {
        /** @type {?} */
        var process = this.process;
        /** @type {?} */
        var extendElements = process.GetExtensionElements();
        if (extendElements.length > 0) {
            for (var i = extendElements.length; i > 0; i--) {
                if (extendElements[i - 1] instanceof ImageSettings) {
                    extendElements.splice(i - 1, 1);
                }
            }
        }
        if (imageSettings) {
            /** @type {?} */
            var imageSetting = new ImageSettings(process.Model);
            imageSetting.imageOperation = imageSettings.imageOperation;
            extendElements.push(imageSetting);
        }
    };
    /**
     * 更新扩展属性
     * @param bpmnModel
     * @param value
     */
    /**
     * 更新扩展属性
     * @param {?} value
     * @return {?}
     */
    WfProcessCell.prototype.resetExtendProperty = /**
     * 更新扩展属性
     * @param {?} value
     * @return {?}
     */
    function (value) {
        var e_42, _a, e_43, _b;
        /** @type {?} */
        var process = this.process;
        /** @type {?} */
        var extendElements = process.GetExtensionElements();
        try {
            for (var value_1 = __values(value), value_1_1 = value_1.next(); !value_1_1.done; value_1_1 = value_1.next()) {
                var o = value_1_1.value;
                try {
                    for (var extendElements_2 = __values(extendElements), extendElements_2_1 = extendElements_2.next(); !extendElements_2_1.done; extendElements_2_1 = extendElements_2.next()) {
                        var e = extendElements_2_1.value;
                        if (e instanceof ExtendProperty && e.key === o.code) {
                            /** @type {?} */
                            var index = extendElements.indexOf(e);
                            if (index > -1) {
                                extendElements.splice(index, 1);
                            }
                        }
                    }
                }
                catch (e_43_1) { e_43 = { error: e_43_1 }; }
                finally {
                    try {
                        if (extendElements_2_1 && !extendElements_2_1.done && (_b = extendElements_2.return)) _b.call(extendElements_2);
                    }
                    finally { if (e_43) throw e_43.error; }
                }
            }
        }
        catch (e_42_1) { e_42 = { error: e_42_1 }; }
        finally {
            try {
                if (value_1_1 && !value_1_1.done && (_a = value_1.return)) _a.call(value_1);
            }
            finally { if (e_42) throw e_42.error; }
        }
        /** @type {?} */
        var attributes = (/** @type {?} */ (value));
        if (attributes) {
            attributes.forEach((/**
             * @param {?} a
             * @return {?}
             */
            function (a) {
                /** @type {?} */
                var item = new ExtendProperty(process.Model);
                item.key = a.code;
                item.value = a.value;
                extendElements.push(item);
            }));
        }
    };
    /**
     * @param {?} wholeOrderRetrieve
     * @return {?}
     */
    WfProcessCell.prototype.updateEnableWholeOrderRetrieve = /**
     * @param {?} wholeOrderRetrieve
     * @return {?}
     */
    function (wholeOrderRetrieve) {
        /** @type {?} */
        var extendElements = this.process.GetExtensionElements();
        if (extendElements !== null && extendElements.length > 0) {
            for (var i in extendElements) {
                if (extendElements[i] instanceof ProcessHeader) {
                    ((/** @type {?} */ (extendElements[i]))).enableWholeOrderRetrieve = wholeOrderRetrieve;
                    return;
                }
            }
        }
    };
    return WfProcessCell;
}(ProcessCell));

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/**
 * 工作流画布类
 */
var  /**
 * 工作流画布类
 */
WfGraph = /** @class */ (function (_super) {
    __extends(WfGraph, _super);
    function WfGraph(editorUi, container, model, renderHint, stylesheet, themes) {
        var _this = _super.call(this, editorUi, container, model, renderHint, stylesheet, themes) || this;
        _this.localePipe = null;
        /**
         * 流程元素实例
         */
        _this.processCell = new WfProcessCell();
        return _this;
    }
    /**
     * @param {?} cells
     * @param {?} sender
     * @param {?} eventObject
     * @return {?}
     */
    WfGraph.prototype.bpmnCellsSelectionChanged = /**
     * @param {?} cells
     * @param {?} sender
     * @param {?} eventObject
     * @return {?}
     */
    function (cells, sender, eventObject) {
        var _this = this;
        _super.prototype.bpmnCellsSelectionChanged.call(this, cells, sender, eventObject);
        // 修改选中节点样式
        /** @type {?} */
        var selected = (/** @type {?} */ (this.getSelectionCells()));
        /** @type {?} */
        var all = (/** @type {?} */ (this.getChildVertices(this.getDefaultParent())));
        all.forEach((/**
         * @param {?} c
         * @return {?}
         */
        function (c) {
            if (selected.includes(c) && c.imgUrls && c.imgUrls[FlowNodeState.Selected]) {
                c.setStyle(mxUtils.setStyle(c.getStyle(), mxConstants.STYLE_IMAGE, c.imgUrls[FlowNodeState.Selected]));
            }
            else {
                c.setStyle(mxUtils.setStyle(c.getStyle(), mxConstants.STYLE_IMAGE, c.imgUrls[FlowNodeState.Default]));
            }
            _this.refresh(c);
        }));
    };
    /**
     * 重写创建流程元素实例方法
     * @param bpmnModel
     * @returns
     */
    /**
     * 重写创建流程元素实例方法
     * @param {?} bpmnModel
     * @return {?}
     */
    WfGraph.prototype.createProcessCell = /**
     * 重写创建流程元素实例方法
     * @param {?} bpmnModel
     * @return {?}
     */
    function (bpmnModel) {
        /** @type {?} */
        var processCell = new WfProcessCell();
        processCell.process = bpmnModel.DefaultProcess;
        processCell.plane = bpmnModel.DefaultDiagram.BpmnPlane;
        processCell.editorUi = this.editorUi;
        return processCell;
    };
    /**
     * 给定新流程信息创建BpmnModel
     * @param newProcInfo
     * @param bizCmps
     */
    /**
     * 给定新流程信息创建BpmnModel
     * @param {?} newProcInfo
     * @param {?} bizCmps
     * @return {?}
     */
    WfGraph.prototype.createBpmnModelWithProcInfo = /**
     * 给定新流程信息创建BpmnModel
     * @param {?} newProcInfo
     * @param {?} bizCmps
     * @return {?}
     */
    function (newProcInfo, bizCmps) {
        var _a;
        /** @type {?} */
        var bpmnModel = this.createBpmnModel();
        this.bpmnModel = bpmnModel;
        this.processCell = this.createProcessCell(this.bpmnModel);
        if (this.editorUi.langCode === 'zh-CHS') {
            this.bpmnModel.DefaultProcess.Name = newProcInfo.name || bpmnModel.DefaultProcess.Name;
        }
        this.bpmnModel.DefaultProcess.NameLanguage = (_a = {},
            _a[this.editorUi.langCode] = newProcInfo.name || bpmnModel.DefaultProcess.Name,
            _a);
        //设置流程Header(业务对象ID、流程分类ID)
        this.processCell.setProcessHeader(newProcInfo.ffId, newProcInfo.bizObjId, newProcInfo.ffName, (/** @type {?} */ (newProcInfo.startMode)));
        // 基于流程分类绑定参数，流程构件，流程表单
        this.processCell.updateFlowFormInfo(newProcInfo.formalParameters, newProcInfo.processBizComponnets, newProcInfo.executeForms, newProcInfo.customizeActions, bizCmps);
        this.processCell.modifyProcessTitleExpression(newProcInfo.processDescription);
    };
    /**
     * @return {?}
     */
    WfGraph.prototype.setDefaultStyles = /**
     * @return {?}
     */
    function () {
        _super.prototype.setDefaultStyles.call(this);
        /** @type {?} */
        var styleSheet = this.getStylesheet();
        // 连线样式默认为正交
        /** @type {?} */
        var edgeStyle = styleSheet.getDefaultEdgeStyle();
        edgeStyle[mxConstants.STYLE_ROUNDED] = 1;
    };
    return WfGraph;
}(Graph));

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var WfSidebar = /** @class */ (function (_super) {
    __extends(WfSidebar, _super);
    function WfSidebar() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this.bizActivities = [];
        return _this;
    }
    /**
     * 添加业务活动面板
     * @param bizActivities
     */
    /**
     * 添加业务活动面板
     * @param {?} bizActivities
     * @return {?}
     */
    WfSidebar.prototype.addBizActPalette = /**
     * 添加业务活动面板
     * @param {?} bizActivities
     * @return {?}
     */
    function (bizActivities) {
        var _this = this;
        //如果添加了业务活动面板，需要先移除
        if (this.palettes["bizactivitylib"]) {
            this.container.removeChild(this.palettes["bizactivitylib"][0]);
            this.container.removeChild(this.palettes["bizactivitylib"][1]);
            delete this.palettes["bizactivitylib"];
        }
        this.bizActivities = bizActivities;
        /** @type {?} */
        var bizActFactories = new Array();
        //添加业务活动
        this.bizActivities && this.bizActivities.forEach((/**
         * @param {?} activity
         * @return {?}
         */
        function (activity) {
            /** @type {?} */
            var style = 'image=' + WfConstants.IMAGE_PATH + '/bizActivity.png;';
            /** @type {?} */
            var cell = (/** @type {?} */ (BpmnCellHelper.generate(UserActivity.Clr_Type_ID, undefined, new mxGeometry(0, 0, _this.defaultImageWidth, _this.defaultImageHeight), style)));
            cell.name = activity.name;
            cell.bizActivity = activity;
            bizActFactories.push(_this.createItemFactory([cell], cell.name, _this.defaultImageWidth, _this.defaultImageHeight));
        }));
        if (bizActFactories.length > 0) {
            this.addPaletteFunctions('bizactivitylib', mxResources.get('bizactivitylib'), true, bizActFactories);
        }
    };
    return WfSidebar;
}(Sidebar));

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/**
 * 排他网关节点，增加状态图片信息
 */
var  /**
 * 排他网关节点，增加状态图片信息
 */
WfExclusiveGatewayCell = /** @class */ (function (_super) {
    __extends(WfExclusiveGatewayCell, _super);
    function WfExclusiveGatewayCell() {
        var _a;
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this.imgUrls = (_a = {},
            _a[FlowNodeState.Default] = WfConstants.IMAGE_PATH + "/ExclusiveGateway.png",
            _a[FlowNodeState.Selected] = WfConstants.IMAGE_PATH + "/ExclusiveGateway_select.svg",
            _a);
        return _this;
    }
    /**
     * @param {?=} flowElt
     * @return {?}
     */
    WfExclusiveGatewayCell.prototype.createFlowElement = /**
     * @param {?=} flowElt
     * @return {?}
     */
    function (flowElt) {
        /** @type {?} */
        var flowNode = (/** @type {?} */ (_super.prototype.createFlowElement.call(this, flowElt)));
        flowNode.Id = "ExclusiveGateway" + BpmnModelHelper.GenerateElementId();
        return flowNode;
    };
    return WfExclusiveGatewayCell;
}(ExclusiveGatewayCell));

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/**
 * 自动生单活动节点
 */
var AifCreationBillActivityCell = /** @class */ (function (_super) {
    __extends(AifCreationBillActivityCell, _super);
    function AifCreationBillActivityCell(value, geometry, style) {
        var _a;
        var _this = _super.call(this, value, geometry, style) || this;
        _this.clrTypeId = AifCreationBillActivityCell.CLR_TYPE_ID;
        _this.name = "自动生单";
        _this.nameLanguage = {
            "zh-CHS": "自动生单",
            "zh-CHT": "自動生單",
            "en": "Creation Bill ",
        };
        _this.imgUrls = (_a = {},
            _a[FlowNodeState.Default] = WfConstants.IMAGE_PATH + "/aifCreationActivity.png",
            _a[FlowNodeState.Selected] = WfConstants.IMAGE_PATH + "/aifCreationActivity_select.svg",
            _a);
        return _this;
    }
    /**
     * @param {?=} flowElt
     * @return {?}
     */
    AifCreationBillActivityCell.prototype.createFlowElement = /**
     * @param {?=} flowElt
     * @return {?}
     */
    function (flowElt) {
        /** @type {?} */
        var flowNode = (/** @type {?} */ (_super.prototype.createFlowElement.call(this, flowElt)));
        flowNode.Id = "AifCreationBillActivity" + BpmnModelHelper.GenerateElementId();
        return flowNode;
    };
    /**
     * @return {?}
     */
    AifCreationBillActivityCell.prototype.getFarrisPropConfig = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var act = this.flowElement;
        /** @type {?} */
        var PropertyConfig = new ElementPropertyConfig();
        /** @type {?} */
        var propertyData = new Object();
        PropertyConfig.categoryId = 'general';
        PropertyConfig.categoryName = mxResources.get('basicInformation');
        PropertyConfig.tabId = 'basic';
        PropertyConfig.tabName = mxResources.get('basicAttributes');
        PropertyConfig.properties = [
            { propertyID: AifCreationBillActivityPropertyKeys.Name, propertyName: mxResources.get('name'), propertyType: 'string', visible: !this.editorUi.multiLangEnabled },
            { propertyID: AifCreationBillActivityPropertyKeys.NameLanguage, propertyName: mxResources.get('nameLanguage'), propertyType: 'multiLanguage', visible: this.editorUi.multiLangEnabled },
            { propertyID: AifCreationBillActivityPropertyKeys.Id, propertyName: mxResources.get('id'), propertyType: 'string', readonly: true }
        ];
        /** @type {?} */
        var bifDef = new ElementPropertyConfig();
        bifDef.categoryId = 'bifDef';
        bifDef.categoryName = mxResources.get('bifDef');
        bifDef.tabId = 'basic';
        bifDef.tabName = mxResources.get('basicAttributes');
        bifDef.properties = [
            { propertyID: AifCreationBillActivityPropertyKeys.aifProcessCode, propertyName: mxResources.get('aifProcess'), propertyType: 'modal' },
        ];
        propertyData[AifCreationBillActivityPropertyKeys.Id] = act.Id;
        propertyData[AifCreationBillActivityPropertyKeys.ClrTypeID] = act.ClrTypeID;
        propertyData[AifCreationBillActivityPropertyKeys.Name] = act.Name || mxResources.get('autoAif');
        propertyData[AifCreationBillActivityPropertyKeys.NameLanguage] = act.NameLanguage || {
            "zh-CHS": act.Name,
        };
        propertyData[AifCreationBillActivityPropertyKeys.aifProcessCode] = act.aifProcessCode;
        propertyData[AifCreationBillActivityPropertyKeys.isRelied] = act.isRelied;
        return {
            propertyConfig: [PropertyConfig, bifDef],
            propertyData: propertyData
        };
    };
    /**
     * @param {?} obj
     * @return {?}
     */
    AifCreationBillActivityCell.prototype.updateProps = /**
     * @param {?} obj
     * @return {?}
     */
    function (obj) {
        /** @type {?} */
        var propertyId = obj.propertyID;
        switch (propertyId) {
            case AifCreationBillActivityPropertyKeys.aifProcessCode:
                this.resetProcessCode(this.flowElement, obj);
                break;
            default:
                _super.prototype.updateProps.call(this, obj);
                break;
        }
    };
    /**
     * @param {?} startActivity
     * @param {?} obj
     * @return {?}
     */
    AifCreationBillActivityCell.prototype.resetProcessCode = /**
     * @param {?} startActivity
     * @param {?} obj
     * @return {?}
     */
    function (startActivity, obj) {
        /** @type {?} */
        var data = obj.propertyValue;
        if (data) {
            startActivity.aifProcessCode = data;
        }
        else {
            startActivity.aifProcessCode = null;
        }
    };
    AifCreationBillActivityCell.CLR_TYPE_ID = AifCreationBillActivity.Clr_Type_ID;
    return AifCreationBillActivityCell;
}(NodeCell));

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/**
 * 服务活动节点
 */
var AutoActivityCell = /** @class */ (function (_super) {
    __extends(AutoActivityCell, _super);
    function AutoActivityCell(value, geometry, style) {
        var _a;
        var _this = _super.call(this, value, geometry, style) || this;
        _this.clrTypeId = AutoActivityCell.CLR_TYPE_ID;
        _this.name = "服务";
        _this.nameLanguage = {
            "zh-CHS": "服务",
            "zh-CHT": "服務",
            "en": "Service ",
        };
        _this.imgUrls = (_a = {},
            _a[FlowNodeState.Default] = WfConstants.IMAGE_PATH + "/auto.png",
            _a[FlowNodeState.Selected] = WfConstants.IMAGE_PATH + "/auto_select.svg",
            _a);
        return _this;
    }
    /**
     * @param {?=} flowElt
     * @return {?}
     */
    AutoActivityCell.prototype.createFlowElement = /**
     * @param {?=} flowElt
     * @return {?}
     */
    function (flowElt) {
        /** @type {?} */
        var flowNode = (/** @type {?} */ (_super.prototype.createFlowElement.call(this, flowElt)));
        flowNode.Id = "autoActivity" + BpmnModelHelper.GenerateElementId();
        return flowNode;
    };
    /**
     * @return {?}
     */
    AutoActivityCell.prototype.getFarrisPropConfig = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var act = this.flowElement;
        // 组织属性框
        /** @type {?} */
        var basicProperty = new ElementPropertyConfig();
        /** @type {?} */
        var activityProperty = new ElementPropertyConfig();
        /** @type {?} */
        var propertyData = {};
        basicProperty.categoryId = 'basicProperty';
        basicProperty.categoryName = mxResources.get('basicInformation');
        basicProperty.tabId = 'basic';
        basicProperty.tabName = mxResources.get('basicAttributes');
        basicProperty.properties = [
            { propertyID: AutoActivityPropertyKeys.Name, propertyName: mxResources.get('name'), propertyType: 'string', visible: !this.editorUi.multiLangEnabled },
            { propertyID: AutoActivityPropertyKeys.NameLanguage, propertyName: mxResources.get('nameLanguage'), propertyType: 'multiLanguage', visible: this.editorUi.multiLangEnabled },
            { propertyID: AutoActivityPropertyKeys.Id, propertyName: mxResources.get('id'), propertyType: 'string', readonly: true }
        ];
        activityProperty.categoryId = 'activityProperty';
        activityProperty.categoryName = mxResources.get('activityProperty');
        activityProperty.tabId = 'basic';
        activityProperty.tabName = mxResources.get('basicAttributes');
        activityProperty.properties = [
            { propertyID: AutoActivityPropertyKeys.Tools, propertyName: mxResources.get('tools'), propertyType: 'modal' },
            { propertyID: AutoActivityPropertyKeys.variableSettings, propertyName: mxResources.get('variableSettings'), propertyType: 'modal' },
        ];
        propertyData[AutoActivityPropertyKeys.Id] = act.Id;
        propertyData[AutoActivityPropertyKeys.ClrTypeID] = act.ClrTypeID;
        propertyData[AutoActivityPropertyKeys.Name] = act.Name;
        propertyData[AutoActivityPropertyKeys.NameLanguage] = act.NameLanguage || {
            "zh-CHS": act.Name,
        };
        propertyData[AutoActivityPropertyKeys.Tools] = PropertyHelper.getBizComponentList((/** @type {?} */ (act.tools)));
        propertyData[AutoActivityPropertyKeys.variableSettings] = PropertyHelper.getVariableSettings(act.Model, act.variableSettings);
        return {
            propertyConfig: [basicProperty, activityProperty],
            propertyData: propertyData
        };
    };
    /**
     * @param {?} obj
     * @return {?}
     */
    AutoActivityCell.prototype.updateProps = /**
     * @param {?} obj
     * @return {?}
     */
    function (obj) {
        /** @type {?} */
        var autoActivity = this.flowElement;
        /** @type {?} */
        var propertyId = obj.propertyID;
        switch (propertyId) {
            case AutoActivityPropertyKeys.Tools:
                this.updateAutoActivityTools(autoActivity, obj);
                break;
            case AutoActivityPropertyKeys.variableSettings:
                this.updateVariableSettings(autoActivity, obj);
                break;
            default:
                _super.prototype.updateProps.call(this, obj);
                break;
        }
    };
    /**
     * @param {?} autoActivity
     * @param {?} obj
     * @return {?}
     */
    AutoActivityCell.prototype.updateAutoActivityTools = /**
     * @param {?} autoActivity
     * @param {?} obj
     * @return {?}
     */
    function (autoActivity, obj) {
        var e_1, _a, e_2, _b;
        /** @type {?} */
        var tools = (/** @type {?} */ (obj.propertyValue));
        autoActivity.tools = new Array();
        if (tools && tools.length > 0) {
            try {
                for (var tools_1 = __values(tools), tools_1_1 = tools_1.next(); !tools_1_1.done; tools_1_1 = tools_1.next()) {
                    var tool = tools_1_1.value;
                    /** @type {?} */
                    var component = new Component$1(autoActivity.Model);
                    component.Id = tool.id;
                    component.Name = tool.name;
                    // component.Time = tool.executionTime;
                    // TODO 写死了构件类型
                    component.ComponentType = 'WebServiceComponent';
                    component.MetadataId = tool.metadataId;
                    component.MethodCode = tool.methodCode;
                    component.isForCompensation = tool.isForCompensation;
                    component.ActualParameters = [];
                    if (tool.actualParameters && ((/** @type {?} */ (tool.actualParameters))).length > 0) {
                        try {
                            for (var _c = __values(((/** @type {?} */ (tool.actualParameters)))), _d = _c.next(); !_d.done; _d = _c.next()) {
                                var a = _d.value;
                                /** @type {?} */
                                var parameter = new ActualParameter(autoActivity.Model, a.code, a.value);
                                component.ActualParameters.push(parameter);
                            }
                        }
                        catch (e_2_1) { e_2 = { error: e_2_1 }; }
                        finally {
                            try {
                                if (_d && !_d.done && (_b = _c.return)) _b.call(_c);
                            }
                            finally { if (e_2) throw e_2.error; }
                        }
                    }
                    autoActivity.tools.push(component);
                }
            }
            catch (e_1_1) { e_1 = { error: e_1_1 }; }
            finally {
                try {
                    if (tools_1_1 && !tools_1_1.done && (_a = tools_1.return)) _a.call(tools_1);
                }
                finally { if (e_1) throw e_1.error; }
            }
        }
    };
    /**
     * @param {?} autoActivity
     * @param {?} obj
     * @return {?}
     */
    AutoActivityCell.prototype.updateVariableSettings = /**
     * @param {?} autoActivity
     * @param {?} obj
     * @return {?}
     */
    function (autoActivity, obj) {
        var e_3, _a, e_4, _b, e_5, _c;
        /** @type {?} */
        var bpmnModel = autoActivity.Model;
        /** @type {?} */
        var extendElements = bpmnModel.DefaultProcess.GetExtensionElements();
        if (autoActivity.variableSettings && autoActivity.variableSettings.length > 0) {
            var _loop_1 = function (v) {
                if (v.tag === 'component') {
                    /** @type {?} */
                    var i = extendElements.findIndex((/**
                     * @param {?} e
                     * @return {?}
                     */
                    function (e) { return (e instanceof Component$1 && e.Id === v.value); }));
                    extendElements.splice(i, 1);
                }
            };
            try {
                for (var _d = __values(autoActivity.variableSettings), _e = _d.next(); !_e.done; _e = _d.next()) {
                    var v = _e.value;
                    _loop_1(v);
                }
            }
            catch (e_3_1) { e_3 = { error: e_3_1 }; }
            finally {
                try {
                    if (_e && !_e.done && (_a = _d.return)) _a.call(_d);
                }
                finally { if (e_3) throw e_3.error; }
            }
        }
        autoActivity.variableSettings = new Array();
        /** @type {?} */
        var variables = (/** @type {?} */ (obj.propertyValue));
        if (variables && variables.length > 0) {
            try {
                for (var variables_1 = __values(variables), variables_1_1 = variables_1.next(); !variables_1_1.done; variables_1_1 = variables_1.next()) {
                    var v = variables_1_1.value;
                    /** @type {?} */
                    var variableSetting = new VariableSetting(bpmnModel);
                    variableSetting.variableCode = v.variableCode;
                    variableSetting.variableName = v.variableName;
                    variableSetting.tag = v.tag;
                    variableSetting.executionTime = v.executionTime;
                    variableSetting.value = v.value;
                    variableSetting.valueText = v.valueText;
                    autoActivity.variableSettings.push(variableSetting);
                    if (variableSetting.tag === 'component') {
                        /** @type {?} */
                        var c = v.component;
                        if (c) {
                            /** @type {?} */
                            var cpt = new Component$1(bpmnModel);
                            cpt.MetadataId = c.MetadataId;
                            cpt.MethodCode = c.MethodCode;
                            cpt.Id = c.Id;
                            cpt.Name = c.Name;
                            cpt.ActualParameters = new Array();
                            if (c.ActualParameters && c.ActualParameters.length > 0) {
                                try {
                                    for (var _f = __values(c.ActualParameters), _g = _f.next(); !_g.done; _g = _f.next()) {
                                        var a = _g.value;
                                        /** @type {?} */
                                        var parameter = new ActualParameter(bpmnModel, a.Name, a.Value);
                                        parameter.Tag = a.Tag;
                                        cpt.ActualParameters.push(parameter);
                                    }
                                }
                                catch (e_5_1) { e_5 = { error: e_5_1 }; }
                                finally {
                                    try {
                                        if (_g && !_g.done && (_c = _f.return)) _c.call(_f);
                                    }
                                    finally { if (e_5) throw e_5.error; }
                                }
                            }
                            extendElements.push(cpt);
                        }
                    }
                }
            }
            catch (e_4_1) { e_4 = { error: e_4_1 }; }
            finally {
                try {
                    if (variables_1_1 && !variables_1_1.done && (_b = variables_1.return)) _b.call(variables_1);
                }
                finally { if (e_4) throw e_4.error; }
            }
        }
    };
    AutoActivityCell.CLR_TYPE_ID = AutoActivity.Clr_Type_ID;
    return AutoActivityCell;
}(NodeCell));

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/**
 * 子流程活动节点
 */
var CallActivitySubProcessCell = /** @class */ (function (_super) {
    __extends(CallActivitySubProcessCell, _super);
    function CallActivitySubProcessCell(value, geometry, style) {
        var _a;
        var _this = _super.call(this, value, geometry, style) || this;
        _this.clrTypeId = CallActivitySubProcessCell.CLR_TYPE_ID;
        _this.name = "子流程";
        _this.nameLanguage = {
            "zh-CHS": "子流程",
            "zh-CHT": "子流程",
            "en": "Sub-Process",
        };
        _this.imgUrls = (_a = {},
            _a[FlowNodeState.Default] = WfConstants.IMAGE_PATH + "/sub.png",
            _a[FlowNodeState.Selected] = WfConstants.IMAGE_PATH + "/sub_select.svg",
            _a);
        return _this;
    }
    /**
     * @param {?=} flowElt
     * @return {?}
     */
    CallActivitySubProcessCell.prototype.createFlowElement = /**
     * @param {?=} flowElt
     * @return {?}
     */
    function (flowElt) {
        /** @type {?} */
        var flowNode = (/** @type {?} */ (_super.prototype.createFlowElement.call(this, flowElt)));
        flowNode.Id = "CallActivitySubProcess" + BpmnModelHelper.GenerateElementId();
        return flowNode;
    };
    /**
     * @return {?}
     */
    CallActivitySubProcessCell.prototype.getFarrisPropConfig = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var act = this.flowElement;
        // 组织属性框
        /** @type {?} */
        var basicProperty = new ElementPropertyConfig();
        /** @type {?} */
        var activityProperty = new ElementPropertyConfig();
        /** @type {?} */
        var propertyData = {};
        // 基本属性（名称）
        basicProperty.categoryId = 'basicProperty';
        basicProperty.categoryName = mxResources.get('basicInformation');
        basicProperty.tabId = 'basic';
        basicProperty.tabName = mxResources.get('basicAttributes');
        basicProperty.properties = [
            { propertyID: CallActivitySubProcessPropertyKeys.Name, propertyName: mxResources.get('name'), propertyType: 'string', visible: !this.editorUi.multiLangEnabled },
            { propertyID: CallActivitySubProcessPropertyKeys.NameLanguage, propertyName: mxResources.get('nameLanguage'), propertyType: 'multiLanguage', visible: this.editorUi.multiLangEnabled },
            { propertyID: CallActivitySubProcessPropertyKeys.Id, propertyName: mxResources.get('id'), propertyType: 'string', readonly: true }
        ];
        // 活动选项（表单定义+活动构件）
        activityProperty.categoryId = 'activityProperty';
        activityProperty.categoryName = mxResources.get('activityProperty');
        activityProperty.tabId = 'basic';
        activityProperty.tabName = mxResources.get('basicAttributes');
        activityProperty.properties = [
            { propertyID: CallActivitySubProcessPropertyKeys.callActivitySubProcess, propertyName: mxResources.get('callActivitySubProcess'), propertyType: 'modal' },
            { propertyID: CallActivitySubProcessPropertyKeys.variableSettings, propertyName: mxResources.get('variableSettings'), propertyType: 'modal' },
            { propertyID: CallActivitySubProcessPropertyKeys.BackWardRule, propertyName: mxResources.get('backWardRule'), propertyType: 'modal' },
            { propertyID: CallActivitySubProcessPropertyKeys.MultiInstanceLoopCharacteristics, propertyName: mxResources.get('multiInstanceLoopCharacteristics'), propertyType: 'modal' }
        ];
        propertyData[CallActivitySubProcessPropertyKeys.Id] = act.Id;
        propertyData[CallActivitySubProcessPropertyKeys.ClrTypeID] = act.ClrTypeID;
        propertyData[CallActivitySubProcessPropertyKeys.Name] = act.Name;
        propertyData[CallActivitySubProcessPropertyKeys.NameLanguage] = act.NameLanguage || {
            "zh-CHS": act.Name,
        };
        propertyData[CallActivitySubProcessPropertyKeys.callActivitySubProcess] = {
            calledBizDefKey: act.calledBizDefKey,
            calledElement: act.CalledElement,
            inheritVariables: act.inheritVariables,
            inheritBizDataId: act.inheritBizDataId,
            bizDataId: act.bizDataId,
            aifProcessCode: act.aifProcessCode,
            useAutoCreationData: act.useAutoCreationData,
        };
        propertyData[CallActivitySubProcessPropertyKeys.BackWardRule] = act.backWardRule;
        propertyData[CallActivitySubProcessPropertyKeys.variableSettings] = PropertyHelper.getVariableSettings(act.Model, act.variableSettings);
        propertyData[CallActivitySubProcessPropertyKeys.MultiInstanceLoopCharacteristics] = act.LoopCharacteristics;
        return {
            propertyConfig: [basicProperty, activityProperty],
            propertyData: propertyData
        };
    };
    /**
     * @param {?} obj
     * @return {?}
     */
    CallActivitySubProcessCell.prototype.updateProps = /**
     * @param {?} obj
     * @return {?}
     */
    function (obj) {
        /** @type {?} */
        var subProcess = this.flowElement;
        /** @type {?} */
        var propertyId = obj.propertyID;
        switch (propertyId) {
            case CallActivitySubProcessPropertyKeys.callActivitySubProcess:
                this.updateSubProcessConfig(subProcess, obj);
                break;
            case CallActivitySubProcessPropertyKeys.BackWardRule:
                this.updateBackWardRule(subProcess, obj);
                break;
            case CallActivitySubProcessPropertyKeys.variableSettings:
                this.updateVariableSettings(subProcess, obj);
                break;
            case CallActivitySubProcessPropertyKeys.MultiInstanceLoopCharacteristics:
                this.updateMultiInstanceLoopCharacteristic(subProcess, obj);
                break;
            default:
                _super.prototype.updateProps.call(this, obj);
                break;
        }
    };
    /**
     * @param {?} subProcess
     * @param {?} obj
     * @return {?}
     */
    CallActivitySubProcessCell.prototype.updateSubProcessConfig = /**
     * @param {?} subProcess
     * @param {?} obj
     * @return {?}
     */
    function (subProcess, obj) {
        /** @type {?} */
        var config = obj.propertyValue;
        if (subProcess) {
            subProcess.calledBizDefKey = config.calledBizDefKey;
            subProcess.CalledElement = config.calledElement;
            subProcess.inheritBizDataId = config.inheritBizDataId;
            subProcess.inheritVariables = config.inheritVariables;
            subProcess.bizDataId = config.bizDataId;
            subProcess.aifProcessCode = config.aifProcessCode;
            subProcess.useAutoCreationData = config.useAutoCreationData;
        }
    };
    /**
     * @param {?} subProcess
     * @param {?} obj
     * @return {?}
     */
    CallActivitySubProcessCell.prototype.updateBackWardRule = /**
     * @param {?} subProcess
     * @param {?} obj
     * @return {?}
     */
    function (subProcess, obj) {
        /** @type {?} */
        var data = obj.propertyValue;
        /** @type {?} */
        var backWardRule = new BackWardRule(subProcess.Model);
        backWardRule.TargetRef = data.TargetRef;
        backWardRule.SelectTargetAble = data.SelectTargetAble;
        backWardRule.WaitReturn = data.WaitReturn;
        backWardRule.ResubmitEffect = data.ResubmitEffect;
        backWardRule.DynamicBackWardRuleAble = data.DynamicBackWardRuleAble;
        backWardRule.SelectTargetList = data.SelectTargetList;
        subProcess.backWardRule = backWardRule;
    };
    /**
     * @param {?} subProcess
     * @param {?} obj
     * @return {?}
     */
    CallActivitySubProcessCell.prototype.updateVariableSettings = /**
     * @param {?} subProcess
     * @param {?} obj
     * @return {?}
     */
    function (subProcess, obj) {
        var e_1, _a, e_2, _b, e_3, _c;
        /** @type {?} */
        var bpmnModel = this.flowElement.Model;
        /** @type {?} */
        var extendElements = bpmnModel.DefaultProcess.GetExtensionElements();
        if (subProcess.variableSettings && subProcess.variableSettings.length > 0) {
            var _loop_1 = function (v) {
                if (v.tag === 'component') {
                    /** @type {?} */
                    var i = extendElements.findIndex((/**
                     * @param {?} e
                     * @return {?}
                     */
                    function (e) { return (e instanceof Component$1 && e.Id === v.value); }));
                    extendElements.splice(i, 1);
                }
            };
            try {
                for (var _d = __values(subProcess.variableSettings), _e = _d.next(); !_e.done; _e = _d.next()) {
                    var v = _e.value;
                    _loop_1(v);
                }
            }
            catch (e_1_1) { e_1 = { error: e_1_1 }; }
            finally {
                try {
                    if (_e && !_e.done && (_a = _d.return)) _a.call(_d);
                }
                finally { if (e_1) throw e_1.error; }
            }
        }
        subProcess.variableSettings = new Array();
        /** @type {?} */
        var variables = (/** @type {?} */ (obj.propertyValue));
        if (variables && variables.length > 0) {
            try {
                for (var variables_1 = __values(variables), variables_1_1 = variables_1.next(); !variables_1_1.done; variables_1_1 = variables_1.next()) {
                    var v = variables_1_1.value;
                    /** @type {?} */
                    var variableSetting = new VariableSetting(bpmnModel);
                    // variableSetting.variableId = v.variableId;
                    variableSetting.variableCode = v.variableCode;
                    variableSetting.variableName = v.variableName;
                    variableSetting.tag = v.tag;
                    variableSetting.executionTime = v.executionTime;
                    variableSetting.value = v.value;
                    variableSetting.valueText = v.valueText;
                    subProcess.variableSettings.push(variableSetting);
                    if (variableSetting.tag === 'component') {
                        /** @type {?} */
                        var c = v.component;
                        if (c) {
                            /** @type {?} */
                            var cpt = new Component$1(bpmnModel);
                            cpt.MetadataId = c.MetadataId;
                            cpt.MethodCode = c.MethodCode;
                            cpt.Id = c.Id;
                            cpt.Name = c.Name;
                            cpt.ActualParameters = new Array();
                            if (c.ActualParameters && c.ActualParameters.length > 0) {
                                try {
                                    for (var _f = __values(c.ActualParameters), _g = _f.next(); !_g.done; _g = _f.next()) {
                                        var a = _g.value;
                                        /** @type {?} */
                                        var parameter = new ActualParameter(bpmnModel, a.Name, a.Value);
                                        parameter.Tag = a.Tag;
                                        cpt.ActualParameters.push(parameter);
                                    }
                                }
                                catch (e_3_1) { e_3 = { error: e_3_1 }; }
                                finally {
                                    try {
                                        if (_g && !_g.done && (_c = _f.return)) _c.call(_f);
                                    }
                                    finally { if (e_3) throw e_3.error; }
                                }
                            }
                            extendElements.push(cpt);
                        }
                    }
                }
            }
            catch (e_2_1) { e_2 = { error: e_2_1 }; }
            finally {
                try {
                    if (variables_1_1 && !variables_1_1.done && (_b = variables_1.return)) _b.call(variables_1);
                }
                finally { if (e_2) throw e_2.error; }
            }
        }
    };
    /**
     * @param {?} subProcess
     * @param {?} obj
     * @return {?}
     */
    CallActivitySubProcessCell.prototype.updateMultiInstanceLoopCharacteristic = /**
     * @param {?} subProcess
     * @param {?} obj
     * @return {?}
     */
    function (subProcess, obj) {
        var e_4, _a;
        /** @type {?} */
        var data = obj.propertyValue;
        /** @type {?} */
        var loopCharacteristics = new MultiInstanceLoopCharacteristics(subProcess.Model);
        loopCharacteristics.enable = data.enable;
        loopCharacteristics.sequential = data.sequential;
        loopCharacteristics.loopCardinality = data.loopCardinality;
        loopCharacteristics.completionCondition = data.completionCondition;
        loopCharacteristics.completionConditionRules = data.completionConditionRules;
        subProcess.LoopCharacteristics = loopCharacteristics;
        if (obj.propertyValue) {
            /** @type {?} */
            var data_1 = obj.propertyValue;
            /** @type {?} */
            var loopCharacteristics_1 = new MultiInstanceLoopCharacteristics(subProcess.Model);
            loopCharacteristics_1.enable = data_1.enable;
            loopCharacteristics_1.sequential = data_1.sequential;
            loopCharacteristics_1.loopCardinality = new Expression(subProcess.Model);
            if (data_1.loopCardinality) {
                /** @type {?} */
                var variableExpression = new SemanticExpression(subProcess.Model);
                variableExpression.Value = data_1.loopCardinality;
                loopCharacteristics_1.loopCardinality.MexExpression = variableExpression;
            }
            loopCharacteristics_1.completionCondition = data_1.completionCondition;
            /** @type {?} */
            var rules = (/** @type {?} */ (data_1.completionConditionRules));
            loopCharacteristics_1.completionConditionRules = null;
            if (rules && rules.length > 0) {
                loopCharacteristics_1.completionConditionRules = new Array();
                try {
                    for (var rules_1 = __values(rules), rules_1_1 = rules_1.next(); !rules_1_1.done; rules_1_1 = rules_1.next()) {
                        var rule = rules_1_1.value;
                        /** @type {?} */
                        var counterSignRule = new CounterSignRule(subProcess.Model);
                        /** @type {?} */
                        var condition = new Condition(subProcess.Model);
                        condition.Value = rule.CompletionCondition.Value;
                        counterSignRule.ConclusionValue = rule.ConclusionValue;
                        counterSignRule.CalculateType = rule.CalculateType;
                        counterSignRule.ConditionValue = rule.ConditionValue;
                        counterSignRule.WaitAllVotes = rule.WaitAllVotes;
                        counterSignRule.CompletionCondition = condition;
                        loopCharacteristics_1.completionConditionRules.push(counterSignRule);
                    }
                }
                catch (e_4_1) { e_4 = { error: e_4_1 }; }
                finally {
                    try {
                        if (rules_1_1 && !rules_1_1.done && (_a = rules_1.return)) _a.call(rules_1);
                    }
                    finally { if (e_4) throw e_4.error; }
                }
            }
            subProcess.LoopCharacteristics = loopCharacteristics_1;
        }
    };
    CallActivitySubProcessCell.CLR_TYPE_ID = CallActivitySubProcess.Clr_Type_ID;
    return CallActivitySubProcessCell;
}(NodeCell));

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/**
 * 信号捕获活动节点
 */
var IntermediateCatchEventImplCell = /** @class */ (function (_super) {
    __extends(IntermediateCatchEventImplCell, _super);
    function IntermediateCatchEventImplCell(value, geometry, style) {
        var _a;
        var _this = _super.call(this, value, geometry, style) || this;
        _this.clrTypeId = IntermediateCatchEventImplCell.CLR_TYPE_ID;
        _this.name = "信号捕获";
        _this.nameLanguage = {
            "zh-CHS": "信号捕获",
            "zh-CHT": "訊號捕獲",
            "en": "Acquisition",
        };
        _this.imgUrls = (_a = {},
            _a[FlowNodeState.Default] = WfConstants.IMAGE_PATH + "/catchEvent.png",
            _a[FlowNodeState.Selected] = WfConstants.IMAGE_PATH + "/catchEvent_select.svg",
            _a);
        return _this;
    }
    /**
     * @param {?=} flowElt
     * @return {?}
     */
    IntermediateCatchEventImplCell.prototype.createFlowElement = /**
     * @param {?=} flowElt
     * @return {?}
     */
    function (flowElt) {
        /** @type {?} */
        var flowNode = (/** @type {?} */ (_super.prototype.createFlowElement.call(this, flowElt)));
        flowNode.Id = "IntermediateCatchEvent" + BpmnModelHelper.GenerateElementId();
        // 创建而非复制时执行
        if (flowElt == null) {
            flowNode.initEventDefinitions();
        }
        return flowNode;
    };
    /**
     * @param {?=} flowElt
     * @param {?=} diagElt
     * @return {?}
     */
    IntermediateCatchEventImplCell.prototype.bindBpmnModel = /**
     * @param {?=} flowElt
     * @param {?=} diagElt
     * @return {?}
     */
    function (flowElt, diagElt) {
        _super.prototype.bindBpmnModel.call(this, flowElt, diagElt);
        /** @type {?} */
        var bpmnModel = this.editorUi.graph.bpmnModel;
        this.addSignals(this.flowElement);
    };
    /**
     * @param {?} catchEvent
     * @return {?}
     */
    IntermediateCatchEventImplCell.prototype.addSignals = /**
     * @param {?} catchEvent
     * @return {?}
     */
    function (catchEvent) {
        var e_1, _a;
        /** @type {?} */
        var bpmnModel = catchEvent.Model;
        if (catchEvent.EventDefinitions && catchEvent.EventDefinitions.length > 0) {
            if (!bpmnModel.signals) {
                bpmnModel.signals = [];
            }
            var _loop_1 = function (e) {
                /** @type {?} */
                var event_1 = (/** @type {?} */ (e));
                if (bpmnModel.signals.findIndex((/**
                 * @param {?} s
                 * @return {?}
                 */
                function (s) { return s.Name === event_1.SignalRef; })) === -1) {
                    /** @type {?} */
                    var signal = new Signal(bpmnModel);
                    signal.Name = event_1.SignalRef;
                    bpmnModel.signals.push(signal);
                }
            };
            try {
                for (var _b = __values(catchEvent.EventDefinitions), _c = _b.next(); !_c.done; _c = _b.next()) {
                    var e = _c.value;
                    _loop_1(e);
                }
            }
            catch (e_1_1) { e_1 = { error: e_1_1 }; }
            finally {
                try {
                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                }
                finally { if (e_1) throw e_1.error; }
            }
        }
    };
    /**
     * @return {?}
     */
    IntermediateCatchEventImplCell.prototype.getFarrisPropConfig = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var act = this.flowElement;
        /** @type {?} */
        var basicProperty = new ElementPropertyConfig();
        /** @type {?} */
        var activityProperty = new ElementPropertyConfig();
        /** @type {?} */
        var propertyData = {};
        basicProperty.categoryId = 'basicProperty';
        basicProperty.categoryName = mxResources.get('basicInformation');
        basicProperty.tabId = 'basic';
        basicProperty.tabName = mxResources.get('basicAttributes');
        basicProperty.properties = [
            { propertyID: IntermediateCatchEventImplPropertyKeys.Name, propertyName: mxResources.get('name'), propertyType: 'string', visible: !this.editorUi.multiLangEnabled },
            { propertyID: IntermediateCatchEventImplPropertyKeys.NameLanguage, propertyName: mxResources.get('nameLanguage'), propertyType: 'multiLanguage', visible: this.editorUi.multiLangEnabled },
            { propertyID: IntermediateCatchEventImplPropertyKeys.Id, propertyName: mxResources.get('id'), propertyType: 'string', readonly: true }
        ];
        activityProperty.categoryId = 'activityProperty';
        activityProperty.categoryName = mxResources.get('activityProperty');
        activityProperty.tabId = 'basic';
        activityProperty.tabName = mxResources.get('basicAttributes');
        activityProperty.properties = [
            { propertyID: IntermediateCatchEventImplPropertyKeys.EventDefinitions, propertyName: mxResources.get('eventDefinitions'), propertyType: 'modal' },
            { propertyID: IntermediateCatchEventImplPropertyKeys.variableSettings, propertyName: mxResources.get('variableSettings'), propertyType: 'modal' }
        ];
        if (act.EventDefinitions && this.isBackEventExist(act.EventDefinitions)) {
            activityProperty.properties.push({ propertyID: IntermediateCatchEventImplPropertyKeys.BackWardRule, propertyName: mxResources.get('backWardRule'), propertyType: 'modal' });
            propertyData[IntermediateCatchEventImplPropertyKeys.BackWardRule] = act.backWardRule;
        }
        propertyData[IntermediateCatchEventImplPropertyKeys.Id] = act.Id;
        propertyData[IntermediateCatchEventImplPropertyKeys.ClrTypeID] = act.ClrTypeID;
        propertyData[IntermediateCatchEventImplPropertyKeys.Name] = act.Name;
        propertyData[IntermediateCatchEventImplPropertyKeys.NameLanguage] = act.NameLanguage || {
            "zh-CHS": act.Name,
        };
        propertyData[IntermediateCatchEventImplPropertyKeys.EventDefinitions] = act.EventDefinitions;
        propertyData[IntermediateCatchEventImplPropertyKeys.variableSettings] = PropertyHelper.getVariableSettings(act.Model, act.variableSettings);
        return {
            propertyConfig: [basicProperty, activityProperty],
            propertyData: propertyData
        };
    };
    /**
     * 判断是否存在反向事件
     * @param
     */
    /**
     * 判断是否存在反向事件
     * @param {?} events
     * @return {?}
     */
    IntermediateCatchEventImplCell.prototype.isBackEventExist = /**
     * 判断是否存在反向事件
     * @param {?} events
     * @return {?}
     */
    function (events) {
        var e_2, _a;
        try {
            for (var events_1 = __values(events), events_1_1 = events_1.next(); !events_1_1.done; events_1_1 = events_1.next()) {
                var e = events_1_1.value;
                /** @type {?} */
                var event_2 = (/** @type {?} */ (e));
                if (event_2.triggerAction === 'Back') {
                    return true;
                }
            }
        }
        catch (e_2_1) { e_2 = { error: e_2_1 }; }
        finally {
            try {
                if (events_1_1 && !events_1_1.done && (_a = events_1.return)) _a.call(events_1);
            }
            finally { if (e_2) throw e_2.error; }
        }
        return false;
    };
    /**
     * @param {?} obj
     * @return {?}
     */
    IntermediateCatchEventImplCell.prototype.updateProps = /**
     * @param {?} obj
     * @return {?}
     */
    function (obj) {
        /** @type {?} */
        var catchEvent = this.flowElement;
        /** @type {?} */
        var propertyId = obj.propertyID;
        switch (propertyId) {
            case IntermediateCatchEventImplPropertyKeys.EventDefinitions:
                this.updateEventDefinitions(catchEvent, obj);
                break;
            case IntermediateCatchEventImplPropertyKeys.BackWardRule:
                this.updateBackWardRule(catchEvent, obj);
                break;
            case IntermediateCatchEventImplPropertyKeys.variableSettings:
                this.updateVariableSettings(catchEvent, obj);
                break;
            default:
                _super.prototype.updateProps.call(this, obj);
                break;
        }
    };
    /**
     * @param {?} catchEvent
     * @param {?} obj
     * @return {?}
     */
    IntermediateCatchEventImplCell.prototype.updateEventDefinitions = /**
     * @param {?} catchEvent
     * @param {?} obj
     * @return {?}
     */
    function (catchEvent, obj) {
        var e_3, _a;
        if (catchEvent) {
            this.removeSignals(catchEvent);
            /** @type {?} */
            var events = (/** @type {?} */ (obj.propertyValue));
            catchEvent.EventDefinitions = new Array();
            try {
                for (var events_2 = __values(events), events_2_1 = events_2.next(); !events_2_1.done; events_2_1 = events_2.next()) {
                    var e = events_2_1.value;
                    /** @type {?} */
                    var item = new SignalEventDefinitionImpl(catchEvent.Model);
                    item.name = e.name;
                    item.triggerAction = e.triggerAction;
                    item.Async = false;
                    item.SignalRef = e.SignalRef;
                    catchEvent.EventDefinitions.push(item);
                }
            }
            catch (e_3_1) { e_3 = { error: e_3_1 }; }
            finally {
                try {
                    if (events_2_1 && !events_2_1.done && (_a = events_2.return)) _a.call(events_2);
                }
                finally { if (e_3) throw e_3.error; }
            }
            this.addSignals(catchEvent);
        }
        // 判断审批项是否包含驳回？不包含时，驳回规则清空
        if (!this.isBackEventExist(catchEvent.EventDefinitions)) {
            catchEvent.backWardRule = null;
        }
        else if (!catchEvent.backWardRule) {
            catchEvent.backWardRule = new BackWardRule(catchEvent.Model);
        }
        // 更新属性框
        // Utils.postMessage(ResourceKeys.wf_showProperty, this.getPropConfig());
    };
    /**
     * @param {?} catchEvent
     * @param {?} obj
     * @return {?}
     */
    IntermediateCatchEventImplCell.prototype.updateBackWardRule = /**
     * @param {?} catchEvent
     * @param {?} obj
     * @return {?}
     */
    function (catchEvent, obj) {
        /** @type {?} */
        var data = obj.propertyValue;
        /** @type {?} */
        var backWardRule = new BackWardRule(catchEvent.Model);
        backWardRule.TargetRef = data.TargetRef;
        backWardRule.SelectTargetAble = data.SelectTargetAble;
        backWardRule.WaitReturn = data.WaitReturn;
        backWardRule.ResubmitEffect = data.ResubmitEffect;
        backWardRule.DynamicBackWardRuleAble = data.DynamicBackWardRuleAble;
        backWardRule.SelectTargetList = data.SelectTargetList;
        catchEvent.backWardRule = backWardRule;
    };
    /**
     * @param {?} catchEvent
     * @param {?} obj
     * @return {?}
     */
    IntermediateCatchEventImplCell.prototype.updateVariableSettings = /**
     * @param {?} catchEvent
     * @param {?} obj
     * @return {?}
     */
    function (catchEvent, obj) {
        var e_4, _a, e_5, _b, e_6, _c;
        /** @type {?} */
        var bpmnModel = catchEvent.Model;
        /** @type {?} */
        var extendElements = bpmnModel.DefaultProcess.GetExtensionElements();
        if (catchEvent.variableSettings && catchEvent.variableSettings.length > 0) {
            var _loop_2 = function (v) {
                if (v.tag === 'component') {
                    /** @type {?} */
                    var i = extendElements.findIndex((/**
                     * @param {?} e
                     * @return {?}
                     */
                    function (e) { return (e instanceof Component$1 && e.Id === v.value); }));
                    extendElements.splice(i, 1);
                }
            };
            try {
                for (var _d = __values(catchEvent.variableSettings), _e = _d.next(); !_e.done; _e = _d.next()) {
                    var v = _e.value;
                    _loop_2(v);
                }
            }
            catch (e_4_1) { e_4 = { error: e_4_1 }; }
            finally {
                try {
                    if (_e && !_e.done && (_a = _d.return)) _a.call(_d);
                }
                finally { if (e_4) throw e_4.error; }
            }
        }
        catchEvent.variableSettings = new Array();
        /** @type {?} */
        var variables = (/** @type {?} */ (obj.propertyValue));
        if (variables && variables.length > 0) {
            try {
                for (var variables_1 = __values(variables), variables_1_1 = variables_1.next(); !variables_1_1.done; variables_1_1 = variables_1.next()) {
                    var v = variables_1_1.value;
                    /** @type {?} */
                    var variableSetting = new VariableSetting(bpmnModel);
                    // variableSetting.variableId = v.variableId;
                    variableSetting.variableCode = v.variableCode;
                    variableSetting.variableName = v.variableName;
                    variableSetting.tag = v.tag;
                    variableSetting.executionTime = v.executionTime;
                    variableSetting.value = v.value;
                    variableSetting.valueText = v.valueText;
                    catchEvent.variableSettings.push(variableSetting);
                    if (variableSetting.tag === 'component') {
                        /** @type {?} */
                        var c = v.component;
                        if (c) {
                            /** @type {?} */
                            var cpt = new Component$1(bpmnModel);
                            cpt.MetadataId = c.MetadataId;
                            cpt.MethodCode = c.MethodCode;
                            cpt.Id = c.Id;
                            cpt.Name = c.Name;
                            cpt.ActualParameters = new Array();
                            if (c.ActualParameters && c.ActualParameters.length > 0) {
                                try {
                                    for (var _f = __values(c.ActualParameters), _g = _f.next(); !_g.done; _g = _f.next()) {
                                        var a = _g.value;
                                        /** @type {?} */
                                        var parameter = new ActualParameter(bpmnModel, a.Name, a.Value);
                                        parameter.Tag = a.Tag;
                                        cpt.ActualParameters.push(parameter);
                                    }
                                }
                                catch (e_6_1) { e_6 = { error: e_6_1 }; }
                                finally {
                                    try {
                                        if (_g && !_g.done && (_c = _f.return)) _c.call(_f);
                                    }
                                    finally { if (e_6) throw e_6.error; }
                                }
                            }
                            extendElements.push(cpt);
                        }
                    }
                }
            }
            catch (e_5_1) { e_5 = { error: e_5_1 }; }
            finally {
                try {
                    if (variables_1_1 && !variables_1_1.done && (_b = variables_1.return)) _b.call(variables_1);
                }
                finally { if (e_5) throw e_5.error; }
            }
        }
    };
    /**
     * @param {?} catchEvent
     * @return {?}
     */
    IntermediateCatchEventImplCell.prototype.removeSignals = /**
     * @param {?} catchEvent
     * @return {?}
     */
    function (catchEvent) {
        var e_7, _a, e_8, _b;
        /** @type {?} */
        var bpmnModel = catchEvent.Model;
        if (catchEvent.EventDefinitions && catchEvent.EventDefinitions.length > 0) {
            /** @type {?} */
            var flowElements = bpmnModel.DefaultProcess.GetFlowElements();
            /** @type {?} */
            var eventDefs = new Map();
            for (var key in flowElements) {
                if (flowElements[key] instanceof IntermediateCatchEventImpl && flowElements[key].Id !== catchEvent.Id) {
                    /** @type {?} */
                    var catchEvent_1 = (/** @type {?} */ (flowElements[key]));
                    try {
                        for (var _c = __values(catchEvent_1.EventDefinitions), _d = _c.next(); !_d.done; _d = _c.next()) {
                            var e = _d.value;
                            /** @type {?} */
                            var event_3 = (/** @type {?} */ (e));
                            if (!eventDefs.get(event_3.SignalRef)) {
                                eventDefs.set(event_3.SignalRef, event_3);
                            }
                        }
                    }
                    catch (e_7_1) { e_7 = { error: e_7_1 }; }
                    finally {
                        try {
                            if (_d && !_d.done && (_a = _c.return)) _a.call(_c);
                        }
                        finally { if (e_7) throw e_7.error; }
                    }
                }
            }
            var _loop_3 = function (e) {
                /** @type {?} */
                var eventDef = (/** @type {?} */ (e));
                if (!eventDefs.get(eventDef.SignalRef)) {
                    /** @type {?} */
                    var i = bpmnModel.signals.findIndex((/**
                     * @param {?} s
                     * @return {?}
                     */
                    function (s) { return s.Name === eventDef.SignalRef; }));
                    if (i > -1) {
                        bpmnModel.signals.splice(i, 1);
                    }
                }
            };
            try {
                for (var _e = __values(catchEvent.EventDefinitions), _f = _e.next(); !_f.done; _f = _e.next()) {
                    var e = _f.value;
                    _loop_3(e);
                }
            }
            catch (e_8_1) { e_8 = { error: e_8_1 }; }
            finally {
                try {
                    if (_f && !_f.done && (_b = _e.return)) _b.call(_e);
                }
                finally { if (e_8) throw e_8.error; }
            }
        }
    };
    IntermediateCatchEventImplCell.CLR_TYPE_ID = IntermediateCatchEventImpl.Clr_Type_ID;
    return IntermediateCatchEventImplCell;
}(NodeCell));

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/**
 * 消息活动节点
 */
var MessageActivityCell = /** @class */ (function (_super) {
    __extends(MessageActivityCell, _super);
    function MessageActivityCell(value, geometry, style) {
        var _a;
        var _this = _super.call(this, value, geometry, style) || this;
        _this.clrTypeId = MessageActivityCell.CLR_TYPE_ID;
        _this.name = "消息";
        _this.nameLanguage = {
            "zh-CHS": "消息",
            "zh-CHT": "消息",
            "en": "Message",
        };
        _this.imgUrls = (_a = {},
            _a[FlowNodeState.Default] = WfConstants.IMAGE_PATH + "/message.png",
            _a[FlowNodeState.Selected] = WfConstants.IMAGE_PATH + "/message_select.svg",
            _a);
        return _this;
    }
    /**
     * @param {?=} flowElt
     * @return {?}
     */
    MessageActivityCell.prototype.createFlowElement = /**
     * @param {?=} flowElt
     * @return {?}
     */
    function (flowElt) {
        /** @type {?} */
        var flowNode = (/** @type {?} */ (_super.prototype.createFlowElement.call(this, flowElt)));
        flowNode.Id = "MessageActivity" + BpmnModelHelper.GenerateElementId();
        return flowNode;
    };
    /**
     * @return {?}
     */
    MessageActivityCell.prototype.getFarrisPropConfig = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var act = this.flowElement;
        /** @type {?} */
        var basicProperty = new ElementPropertyConfig();
        /** @type {?} */
        var activityProperty = new ElementPropertyConfig();
        /** @type {?} */
        var propertyData = {};
        basicProperty.categoryId = 'basicProperty';
        basicProperty.categoryName = mxResources.get('basicInformation');
        basicProperty.tabId = 'basic';
        basicProperty.tabName = mxResources.get('basicAttributes');
        basicProperty.properties = [
            { propertyID: MessageActivityPropertyKeys.Name, propertyName: mxResources.get('name'), propertyType: 'string', visible: !this.editorUi.multiLangEnabled },
            { propertyID: MessageActivityPropertyKeys.NameLanguage, propertyName: mxResources.get('nameLanguage'), propertyType: 'multiLanguage', visible: this.editorUi.multiLangEnabled },
            { propertyID: MessageActivityPropertyKeys.Id, propertyName: mxResources.get('id'), propertyType: 'string', readonly: true }
        ];
        activityProperty.categoryId = 'activityProperty';
        activityProperty.categoryName = mxResources.get('activityProperty');
        activityProperty.tabId = 'basic';
        activityProperty.tabName = mxResources.get('basicAttributes');
        activityProperty.properties = [
            { propertyID: MessageActivityPropertyKeys.messageNotice, propertyName: mxResources.get('messageNotice'), propertyType: 'modal' },
            { propertyID: MessageActivityPropertyKeys.variableSettings, propertyName: mxResources.get('variableSettings'), propertyType: 'modal' }
        ];
        propertyData[MessageActivityPropertyKeys.Id] = act.Id;
        propertyData[MessageActivityPropertyKeys.ClrTypeID] = act.ClrTypeID;
        propertyData[MessageActivityPropertyKeys.Name] = act.Name;
        propertyData[MessageActivityPropertyKeys.NameLanguage] = act.NameLanguage || {
            "zh-CHS": act.Name,
        };
        propertyData[MessageActivityPropertyKeys.messageNotice] = PropertyHelper.getMessageNotices(act.messageNotices);
        propertyData[MessageActivityPropertyKeys.variableSettings] = PropertyHelper.getVariableSettings(act.Model, act.variableSettings);
        return {
            propertyConfig: [basicProperty, activityProperty],
            propertyData: propertyData
        };
    };
    /**
     * @param {?} obj
     * @return {?}
     */
    MessageActivityCell.prototype.updateProps = /**
     * @param {?} obj
     * @return {?}
     */
    function (obj) {
        /** @type {?} */
        var messageActivity = this.flowElement;
        /** @type {?} */
        var propertyId = obj.propertyID;
        switch (propertyId) {
            case MessageActivityPropertyKeys.messageNotice:
                this.updateMessageNotices(messageActivity, obj);
                break;
            case MessageActivityPropertyKeys.variableSettings:
                this.updateVariableSettings(messageActivity, obj);
                break;
            default:
                _super.prototype.updateProps.call(this, obj);
                break;
        }
    };
    /**
     * @param {?} messageActivity
     * @param {?} obj
     * @return {?}
     */
    MessageActivityCell.prototype.updateMessageNotices = /**
     * @param {?} messageActivity
     * @param {?} obj
     * @return {?}
     */
    function (messageActivity, obj) {
        var e_1, _a, e_2, _b, e_3, _c, e_4, _d;
        /** @type {?} */
        var bpmnModel = messageActivity.Model;
        /** @type {?} */
        var notices = (/** @type {?} */ (obj.propertyValue));
        messageActivity.messageNotices = new Array();
        if (notices && notices.length > 0) {
            try {
                for (var notices_1 = __values(notices), notices_1_1 = notices_1.next(); !notices_1_1.done; notices_1_1 = notices_1.next()) {
                    var n = notices_1_1.value;
                    /** @type {?} */
                    var messageNotice = new MessageNotice(bpmnModel);
                    messageNotice.sendType = n.sendType;
                    messageNotice.sendTime = n.sendTime;
                    messageNotice.subject = n.subject;
                    messageNotice.content = n.content;
                    if (n.smsMessageTemplate) {
                        /** @type {?} */
                        var smsMessageTemplate = new SmsMessageTemplate(bpmnModel);
                        smsMessageTemplate.code = n.smsMessageTemplate.code;
                        smsMessageTemplate.content = n.smsMessageTemplate.content;
                        smsMessageTemplate.smsMessageVariables = new Array();
                        if (n.smsMessageTemplate.smsMessageVariables && n.smsMessageTemplate.smsMessageVariables.length > 0) {
                            try {
                                for (var _e = __values(n.smsMessageTemplate.smsMessageVariables), _f = _e.next(); !_f.done; _f = _e.next()) {
                                    var v = _f.value;
                                    /** @type {?} */
                                    var variable = new SmsMessageVariable(bpmnModel);
                                    variable.code = v.code;
                                    variable.value = v.value;
                                    variable.tag = v.tag;
                                    smsMessageTemplate.smsMessageVariables.push(variable);
                                }
                            }
                            catch (e_2_1) { e_2 = { error: e_2_1 }; }
                            finally {
                                try {
                                    if (_f && !_f.done && (_b = _e.return)) _b.call(_e);
                                }
                                finally { if (e_2) throw e_2.error; }
                            }
                        }
                        messageNotice.smsMessageTemplate = smsMessageTemplate;
                    }
                    // messageNotice.receiver = n.receiver;
                    // messageNotice.receiverText = n.receiverText;
                    if (n.receivers && n.receivers.length > 0) {
                        /** @type {?} */
                        var receivers = n.receivers.filter((/**
                         * @param {?} r
                         * @return {?}
                         */
                        function (r) { return r.type === 'userParticipant'
                            || (r.type === 'processParticipant' && r.processParticipant !== 'activityExecutorParticipant'); }));
                        /** @type {?} */
                        var participants = n.receivers.filter((/**
                         * @param {?} r
                         * @return {?}
                         */
                        function (r) { return r.type === 'variableParticipant' || r.type === 'positionParticipant'
                            || (r.type === 'processParticipant' && r.processParticipant === 'activityExecutorParticipant'); }));
                        if (receivers && receivers.length > 0) {
                            /** @type {?} */
                            var receiver = '';
                            /** @type {?} */
                            var receiverName = '';
                            try {
                                for (var receivers_1 = __values(receivers), receivers_1_1 = receivers_1.next(); !receivers_1_1.done; receivers_1_1 = receivers_1.next()) {
                                    var r = receivers_1_1.value;
                                    if (r.type === 'processParticipant') {
                                        receiver += (r.processParticipant + ',');
                                        if (r.processParticipant === 'procInstCreator') {
                                            receiverName += '流程发起人,';
                                        }
                                        else if (r.processParticipant === 'workItemParticipant') {
                                            receiverName += '任务接收人,';
                                        }
                                    }
                                    else if (r.type === 'userParticipant') {
                                        receiver += (r.userIds + ',');
                                        receiverName += (r.userNames + ',');
                                    }
                                }
                            }
                            catch (e_3_1) { e_3 = { error: e_3_1 }; }
                            finally {
                                try {
                                    if (receivers_1_1 && !receivers_1_1.done && (_c = receivers_1.return)) _c.call(receivers_1);
                                }
                                finally { if (e_3) throw e_3.error; }
                            }
                            if (receiver) {
                                receiver = receiver.substring(0, receiver.length - 1);
                            }
                            if (receiverName) {
                                receiverName = receiverName.substring(0, receiverName.length - 1);
                            }
                            messageNotice.receiver = receiver;
                            messageNotice.receiverText = receiverName;
                        }
                        if (participants && participants.length > 0) {
                            /** @type {?} */
                            var receiverExpressions = new Array();
                            try {
                                for (var participants_1 = __values(participants), participants_1_1 = participants_1.next(); !participants_1_1.done; participants_1_1 = participants_1.next()) {
                                    var p = participants_1_1.value;
                                    if (p.type === 'processParticipant') {
                                        /** @type {?} */
                                        var activityExecutor = new ActivityExecutorParticipantExpression(messageActivity.Model);
                                        activityExecutor.id = BpmnModelHelper.GenerateElementId();
                                        activityExecutor.activityDefId = p.activityDefId;
                                        activityExecutor.activityDefName = p.activityDefName;
                                        receiverExpressions.push(activityExecutor);
                                    }
                                    if (p.type === 'variableParticipant') {
                                        /** @type {?} */
                                        var variableParticipant = new UserParticipantExpression(messageActivity.Model, p.variableParticipant, p.variableName, p.orgType);
                                        variableParticipant.id = BpmnModelHelper.GenerateElementId();
                                        variableParticipant.Tag = 'expression';
                                        variableParticipant.OrgType = p.orgType;
                                        receiverExpressions.push(variableParticipant);
                                    }
                                    if (p.type === 'positionParticipant') {
                                        /** @type {?} */
                                        var posiParticipant = new PositionParticipantExpression(messageActivity.Model, p.positionId, p.positionName);
                                        posiParticipant.id = BpmnModelHelper.GenerateElementId();
                                        posiParticipant.PositionType = p.positionType;
                                        if (p.positionType === '1') {
                                            posiParticipant.OrgId = p.orgId;
                                            posiParticipant.OrgType = p.orgType;
                                        }
                                        receiverExpressions.push(posiParticipant);
                                    }
                                }
                            }
                            catch (e_4_1) { e_4 = { error: e_4_1 }; }
                            finally {
                                try {
                                    if (participants_1_1 && !participants_1_1.done && (_d = participants_1.return)) _d.call(participants_1);
                                }
                                finally { if (e_4) throw e_4.error; }
                            }
                            messageNotice.receiverExpressions = receiverExpressions;
                        }
                    }
                    messageActivity.messageNotices.push(messageNotice);
                }
            }
            catch (e_1_1) { e_1 = { error: e_1_1 }; }
            finally {
                try {
                    if (notices_1_1 && !notices_1_1.done && (_a = notices_1.return)) _a.call(notices_1);
                }
                finally { if (e_1) throw e_1.error; }
            }
        }
    };
    /**
     * @param {?} messageActivity
     * @param {?} obj
     * @return {?}
     */
    MessageActivityCell.prototype.updateVariableSettings = /**
     * @param {?} messageActivity
     * @param {?} obj
     * @return {?}
     */
    function (messageActivity, obj) {
        var e_5, _a, e_6, _b, e_7, _c;
        /** @type {?} */
        var bpmnModel = messageActivity.Model;
        /** @type {?} */
        var extendElements = bpmnModel.DefaultProcess.GetExtensionElements();
        if (messageActivity.variableSettings && messageActivity.variableSettings.length > 0) {
            var _loop_1 = function (v) {
                if (v.tag === 'component') {
                    /** @type {?} */
                    var i = extendElements.findIndex((/**
                     * @param {?} e
                     * @return {?}
                     */
                    function (e) { return (e instanceof Component$1 && e.Id === v.value); }));
                    extendElements.splice(i, 1);
                }
            };
            try {
                for (var _d = __values(messageActivity.variableSettings), _e = _d.next(); !_e.done; _e = _d.next()) {
                    var v = _e.value;
                    _loop_1(v);
                }
            }
            catch (e_5_1) { e_5 = { error: e_5_1 }; }
            finally {
                try {
                    if (_e && !_e.done && (_a = _d.return)) _a.call(_d);
                }
                finally { if (e_5) throw e_5.error; }
            }
        }
        messageActivity.variableSettings = new Array();
        /** @type {?} */
        var variables = (/** @type {?} */ (obj.propertyValue));
        if (variables && variables.length > 0) {
            try {
                for (var variables_1 = __values(variables), variables_1_1 = variables_1.next(); !variables_1_1.done; variables_1_1 = variables_1.next()) {
                    var v = variables_1_1.value;
                    /** @type {?} */
                    var variableSetting = new VariableSetting(bpmnModel);
                    // variableSetting.variableId = v.variableId;
                    variableSetting.variableCode = v.variableCode;
                    variableSetting.variableName = v.variableName;
                    variableSetting.tag = v.tag;
                    variableSetting.executionTime = v.executionTime;
                    variableSetting.value = v.value;
                    variableSetting.valueText = v.valueText;
                    messageActivity.variableSettings.push(variableSetting);
                    if (variableSetting.tag === 'component') {
                        /** @type {?} */
                        var c = v.component;
                        if (c) {
                            /** @type {?} */
                            var cpt = new Component$1(bpmnModel);
                            cpt.MetadataId = c.MetadataId;
                            cpt.MethodCode = c.MethodCode;
                            cpt.Id = c.Id;
                            cpt.Name = c.Name;
                            cpt.ActualParameters = new Array();
                            if (c.ActualParameters && c.ActualParameters.length > 0) {
                                try {
                                    for (var _f = __values(c.ActualParameters), _g = _f.next(); !_g.done; _g = _f.next()) {
                                        var a = _g.value;
                                        /** @type {?} */
                                        var parameter = new ActualParameter(bpmnModel, a.Name, a.Value);
                                        parameter.Tag = a.Tag;
                                        cpt.ActualParameters.push(parameter);
                                    }
                                }
                                catch (e_7_1) { e_7 = { error: e_7_1 }; }
                                finally {
                                    try {
                                        if (_g && !_g.done && (_c = _f.return)) _c.call(_f);
                                    }
                                    finally { if (e_7) throw e_7.error; }
                                }
                            }
                            extendElements.push(cpt);
                        }
                    }
                }
            }
            catch (e_6_1) { e_6 = { error: e_6_1 }; }
            finally {
                try {
                    if (variables_1_1 && !variables_1_1.done && (_b = variables_1.return)) _b.call(variables_1);
                }
                finally { if (e_6) throw e_6.error; }
            }
        }
    };
    MessageActivityCell.CLR_TYPE_ID = MessageActivity.Clr_Type_ID;
    return MessageActivityCell;
}(NodeCell));

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var ActualParameter$5 = /** @class */ (function () {
    function ActualParameter$$1() {
    }
    return ActualParameter$$1;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var AssignConfig$2 = /** @class */ (function () {
    function AssignConfig() {
    }
    return AssignConfig;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var AssignStrategy$1 = /** @class */ (function () {
    function AssignStrategy() {
    }
    return AssignStrategy;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/** @enum {string} */
var OrganizationLevel$4 = {
    /**
     * 部门
     */
    DEPARTMENT: 'DEPARTMENT',
    /**
     * 单位
     */
    UNIT: 'UNIT',
    /**
     * 表单上的变量单位
     */
    EXPRESSION: 'EXPRESSION',
    /**
     * 默认
     */
    DEFAULT: 'DEFAULT',
};

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var ParticipantInfo$1 = /** @class */ (function () {
    function ParticipantInfo() {
        this.assignStrategy = new AssignStrategy$1();
        this.humanPerformerList = new Array();
        this.potentialOwnerList = new Array();
        this.isAllScope = false;
    }
    return ParticipantInfo;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var ProcExtendProperty = /** @class */ (function () {
    function ProcExtendProperty() {
    }
    return ProcExtendProperty;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/**
 * 知会活动节点
 */
var NotifyActivityCell = /** @class */ (function (_super) {
    __extends(NotifyActivityCell, _super);
    function NotifyActivityCell(value, geometry, style) {
        var _a;
        var _this = _super.call(this, value, geometry, style) || this;
        _this.clrTypeId = NotifyActivityCell.CLR_TYPE_ID;
        _this.name = "知会";
        _this.nameLanguage = {
            "zh-CHS": "知会",
            "zh-CHT": "知會",
            "en": "Notify",
        };
        _this.imgUrls = (_a = {},
            _a[FlowNodeState.Default] = WfConstants.IMAGE_PATH + "/notify.png",
            _a[FlowNodeState.Selected] = WfConstants.IMAGE_PATH + "/notify_backup.png",
            _a);
        return _this;
    }
    /**
     * @param {?=} flowElt
     * @return {?}
     */
    NotifyActivityCell.prototype.createFlowElement = /**
     * @param {?=} flowElt
     * @return {?}
     */
    function (flowElt) {
        /** @type {?} */
        var flowNode = (/** @type {?} */ (_super.prototype.createFlowElement.call(this, flowElt)));
        flowNode.Id = "NotifyActivity" + BpmnModelHelper.GenerateElementId();
        // 创建而非复制时执行
        if (flowElt == null) {
            flowNode.notifyAble = this.editorUi.generalConfig.enableNotify;
        }
        return flowNode;
    };
    /**
     * @return {?}
     */
    NotifyActivityCell.prototype.getFarrisPropConfig = /**
     * @return {?}
     */
    function () {
        var e_1, _a, e_2, _b, e_3, _c;
        /** @type {?} */
        var editorUi = this.editorUi;
        // const graph = editorUi.graph;
        /** @type {?} */
        var act = this.flowElement;
        // 过滤配置位置为节点的扩展属性，分离一级和二级属性：知会节点
        // 一级节点List
        /** @type {?} */
        var generalExtendList = [];
        if (editorUi.procExtProps && editorUi.procExtProps.length > 0) {
            JSON.parse(JSON.stringify(editorUi.procExtProps)).forEach((/**
             * @param {?} p
             * @return {?}
             */
            function (p) {
                if (p.propertyLocation && p.propertyLocation.indexOf('activity') != -1 && !p.parentId) {
                    generalExtendList.push(p);
                }
                else if (p.propertyLocation && p.propertyLocation.indexOf('activity') != -1 && p.parentId) ;
            }));
        }
        generalExtendList = generalExtendList.sort((/**
         * @param {?} a
         * @param {?} b
         * @return {?}
         */
        function (a, b) {
            return a.sortOrder - b.sortOrder;
        }));
        /** @type {?} */
        var extendList = [];
        if (editorUi.procExtProps && editorUi.procExtProps.length > 0) {
            extendList = JSON.parse(JSON.stringify(editorUi.procExtProps)).sort((/**
             * @param {?} a
             * @param {?} b
             * @return {?}
             */
            function (a, b) {
                return a.sortOrder - b.sortOrder;
            }));
        }
        extendList = extendList.sort((/**
         * @param {?} a
         * @param {?} b
         * @return {?}
         */
        function (a, b) {
            return a.sortOrder - b.sortOrder;
        }));
        /** @type {?} */
        var basicProperty = new ElementPropertyConfig();
        /** @type {?} */
        var activityProperty = new ElementPropertyConfig();
        /** @type {?} */
        var propertyData = {};
        basicProperty.categoryId = 'basicProperty';
        basicProperty.categoryName = mxResources.get('basicInformation');
        basicProperty.tabId = 'basic';
        basicProperty.tabName = mxResources.get('basicAttributes');
        basicProperty.properties = [
            { propertyID: NotifyActivityPropertyKeys.Name, propertyName: mxResources.get('name'), propertyType: 'string', visible: !this.editorUi.multiLangEnabled },
            { propertyID: NotifyActivityPropertyKeys.NameLanguage, propertyName: mxResources.get('nameLanguage'), propertyType: 'multiLanguage', visible: this.editorUi.multiLangEnabled },
            { propertyID: NotifyActivityPropertyKeys.Id, propertyName: mxResources.get('id'), propertyType: 'string', readonly: true }
        ];
        /** @type {?} */
        var performerProperty = new ElementPropertyConfig();
        performerProperty.categoryId = 'performerProperty';
        performerProperty.categoryName = mxResources.get('performerProperty');
        performerProperty.tabId = 'basic';
        performerProperty.tabName = mxResources.get('basicAttributes');
        performerProperty.properties = [
            { propertyID: NotifyActivityPropertyKeys.ParticipantSchemes, propertyName: mxResources.get('notifyRecipient'), propertyType: 'modal' }
        ];
        /** @type {?} */
        var formDef = new ElementPropertyConfig();
        formDef.categoryId = 'formDef';
        formDef.categoryName = mxResources.get('formDef');
        formDef.tabId = 'basic';
        formDef.tabName = mxResources.get('basicAttributes');
        formDef.properties = [
            { propertyID: NotifyActivityPropertyKeys.wf_ExecuteForms_PC, propertyName: mxResources.get('pcForm'), propertyType: 'modal' },
            { propertyID: NotifyActivityPropertyKeys.wf_ExecuteForms_Mobile, propertyName: mxResources.get('webForm'), propertyType: 'modal' },
        ];
        /** @type {?} */
        var approvalProperty = new ElementPropertyConfig();
        approvalProperty.categoryId = 'activityProperty';
        approvalProperty.categoryName = mxResources.get('activityProperty');
        approvalProperty.tabId = 'basic';
        approvalProperty.tabName = mxResources.get('basicAttributes');
        approvalProperty.properties = [
            { propertyID: NotifyActivityPropertyKeys.NotifyAble, propertyName: mxResources.get('notifyAble'), propertyType: 'modal' },
        ];
        activityProperty.categoryId = 'advanced';
        activityProperty.categoryName = mxResources.get('otherConfigurations');
        activityProperty.tabId = 'advanced';
        activityProperty.tabName = mxResources.get('advancedAttributes');
        activityProperty.properties = [
            { propertyID: NotifyActivityPropertyKeys.messageNotice, propertyName: mxResources.get('messageNotice'), propertyType: 'modal' },
        ];
        // 扩展属性分group处理，每个group包含父级属性和属于它的子扩展属性
        /** @type {?} */
        var groupList = new Array();
        try {
            for (var extendList_1 = __values(extendList), extendList_1_1 = extendList_1.next(); !extendList_1_1.done; extendList_1_1 = extendList_1.next()) {
                var extend = extendList_1_1.value;
                if (!extend.parentId) {
                    /** @type {?} */
                    var group = { parent: extend, childs: new Array() };
                    try {
                        for (var extendList_2 = __values(extendList), extendList_2_1 = extendList_2.next(); !extendList_2_1.done; extendList_2_1 = extendList_2.next()) {
                            var e = extendList_2_1.value;
                            if (e.parentId === extend.id) {
                                group.childs.push(e);
                            }
                        }
                    }
                    catch (e_2_1) { e_2 = { error: e_2_1 }; }
                    finally {
                        try {
                            if (extendList_2_1 && !extendList_2_1.done && (_b = extendList_2.return)) _b.call(extendList_2);
                        }
                        finally { if (e_2) throw e_2.error; }
                    }
                    groupList.push(group);
                }
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (extendList_1_1 && !extendList_1_1.done && (_a = extendList_1.return)) _a.call(extendList_1);
            }
            finally { if (e_1) throw e_1.error; }
        }
        // 没有扩展属性值的时候不显示扩展属性一栏
        if (groupList && groupList.length > 0) {
            /** @type {?} */
            var ExtendPropertyConfig = new ElementPropertyConfig();
            ExtendPropertyConfig.categoryId = 'extendPropertyConfig';
            ExtendPropertyConfig.categoryName = mxResources.get('extendPropertyConfig');
            ExtendPropertyConfig.tabId = 'advanced';
            ExtendPropertyConfig.tabName = mxResources.get('advancedAttributes');
            ExtendPropertyConfig.properties = new Array();
            try {
                for (var groupList_1 = __values(groupList), groupList_1_1 = groupList_1.next(); !groupList_1_1.done; groupList_1_1 = groupList_1.next()) {
                    var g = groupList_1_1.value;
                    ExtendPropertyConfig.properties.push({ propertyID: g.parent.id, propertyName: g.parent.propertyTitle, propertyType: 'modal' });
                }
            }
            catch (e_3_1) { e_3 = { error: e_3_1 }; }
            finally {
                try {
                    if (groupList_1_1 && !groupList_1_1.done && (_c = groupList_1.return)) _c.call(groupList_1);
                }
                finally { if (e_3) throw e_3.error; }
            }
            this.setPropertyData(act, propertyData, groupList);
            return {
                propertyConfig: [basicProperty, performerProperty, formDef, approvalProperty, activityProperty, ExtendPropertyConfig],
                propertyData: propertyData
            };
        }
        else {
            this.setPropertyData(act, propertyData, groupList);
            return {
                propertyConfig: [basicProperty, performerProperty, formDef, approvalProperty, activityProperty],
                propertyData: propertyData
            };
        }
    };
    /**
     * 组织UserActivity的属性值propertyData
     * @param act
     * @param propertyData
     */
    /**
     * 组织UserActivity的属性值propertyData
     * @param {?} act
     * @param {?} propertyData
     * @param {?=} groupList
     * @return {?}
     */
    NotifyActivityCell.prototype.setPropertyData = /**
     * 组织UserActivity的属性值propertyData
     * @param {?} act
     * @param {?} propertyData
     * @param {?=} groupList
     * @return {?}
     */
    function (act, propertyData, groupList) {
        var e_4, _a;
        propertyData[NotifyActivityPropertyKeys.Id] = act.Id;
        propertyData[NotifyActivityPropertyKeys.ClrTypeID] = act.ClrTypeID;
        propertyData[NotifyActivityPropertyKeys.Name] = act.Name;
        propertyData[NotifyActivityPropertyKeys.NameLanguage] = act.NameLanguage || {
            "zh-CHS": act.Name,
        };
        propertyData[NotifyActivityPropertyKeys.ParticipantSchemes] = this.getParticipantInfo(act);
        propertyData[NotifyActivityPropertyKeys.messageNotice] = PropertyHelper.getMessageNotices(act.messageNotices);
        propertyData[NotifyActivityPropertyKeys.wf_ExecuteForms_PC] =
            act.executeForms ? act.executeForms.find((/**
             * @param {?} e
             * @return {?}
             */
            function (e) { return e.TerminalType === 'PC'; })) : null;
        propertyData[NotifyActivityPropertyKeys.wf_ExecuteForms_Mobile] =
            act.executeForms ? act.executeForms.find((/**
             * @param {?} e
             * @return {?}
             */
            function (e) { return e.TerminalType === 'MOBILE'; })) : null;
        propertyData[NotifyActivityPropertyKeys.NotifyAble] = PropertyHelper.getNotifyAble(act.notifyAble, act.dynamicParticipants);
        try {
            for (var groupList_2 = __values(groupList), groupList_2_1 = groupList_2.next(); !groupList_2_1.done; groupList_2_1 = groupList_2.next()) {
                var g = groupList_2_1.value;
                // 取回模型上的value值给到扩展属性组件里
                if (act.extendProperties && act.extendProperties.length > 0) {
                    g.childs.sort((/**
                     * @param {?} a
                     * @param {?} b
                     * @return {?}
                     */
                    function (a, b) {
                        return a.sortOrder - b.sortOrder;
                    })).forEach((/**
                     * @param {?} d
                     * @return {?}
                     */
                    function (d) {
                        act.extendProperties.forEach((/**
                         * @param {?} e
                         * @return {?}
                         */
                        function (e) {
                            if (e.key == d.code) {
                                d.value = e.value;
                            }
                        }));
                    }));
                }
                propertyData[g.parent.id] = g.childs;
            }
        }
        catch (e_4_1) { e_4 = { error: e_4_1 }; }
        finally {
            try {
                if (groupList_2_1 && !groupList_2_1.done && (_a = groupList_2.return)) _a.call(groupList_2);
            }
            finally { if (e_4) throw e_4.error; }
        }
    };
    /**
     * @param {?} notifyActivity
     * @return {?}
     */
    NotifyActivityCell.prototype.getParticipantInfo = /**
     * @param {?} notifyActivity
     * @return {?}
     */
    function (notifyActivity) {
        /** @type {?} */
        var partiInfo = new ParticipantInfo$1();
        /** @type {?} */
        var roles = (/** @type {?} */ (notifyActivity.GetResourceRoles().filter((/**
         * @param {?} role
         * @return {?}
         */
        function (role) { return role instanceof HumanPerformerImpl; }))));
        partiInfo.humanPerformerList = PropertyHelper.getPerformerList(roles);
        return partiInfo;
    };
    /**
     * @param {?} obj
     * @return {?}
     */
    NotifyActivityCell.prototype.updateProps = /**
     * @param {?} obj
     * @return {?}
     */
    function (obj) {
        /** @type {?} */
        var notifyActivity = this.flowElement;
        /** @type {?} */
        var editorUi = this.editorUi;
        /** @type {?} */
        var propertyId = obj.propertyID;
        switch (propertyId) {
            // 参与者属性
            case NotifyActivityPropertyKeys.ParticipantSchemes:
                this.updateParticipant(notifyActivity, obj);
                break;
            case NotifyActivityPropertyKeys.messageNotice:
                this.updateMessageNotices(notifyActivity, obj);
                break;
            case NotifyActivityPropertyKeys.wf_ExecuteForms_PC:
                this.updateStartActivityForm(notifyActivity, obj, 'PC');
                if (obj.parameters && obj.parameters.length > 0) {
                    PropertyHelper.updateFormalParameters(editorUi.graph.bpmnModel.DefaultProcess, obj.parameters);
                }
                break;
            case NotifyActivityPropertyKeys.wf_ExecuteForms_Mobile:
                this.updateStartActivityForm(notifyActivity, obj, 'MOBILE');
                if (obj.parameters && obj.parameters.length > 0) {
                    PropertyHelper.updateFormalParameters(editorUi.graph.bpmnModel.DefaultProcess, obj.parameters);
                }
                break;
            case NotifyActivityPropertyKeys.NotifyAble:
                this.updateNotifySet(notifyActivity, obj);
                break;
            default:
                // 判断ResourceKeys是不是groupid,是就走resetExtendProperty
                if (this.editorUi.procExtProps.findIndex((/**
                 * @param {?} p
                 * @return {?}
                 */
                function (p) { return p.id === propertyId; })) > -1) {
                    this.resetExtendProperty(notifyActivity, obj);
                }
                else {
                    _super.prototype.updateProps.call(this, obj);
                }
                break;
        }
    };
    /**
     * @param {?} notifyActivity
     * @param {?} obj
     * @return {?}
     */
    NotifyActivityCell.prototype.updateParticipant = /**
     * @param {?} notifyActivity
     * @param {?} obj
     * @return {?}
     */
    function (notifyActivity, obj) {
        var e_5, _a;
        /** @type {?} */
        var performerInfo = obj.propertyValue;
        /** @type {?} */
        var resourceRoles = notifyActivity.GetResourceRoles();
        if (resourceRoles && resourceRoles.length > 0) {
            resourceRoles.forEach((/**
             * @param {?} r
             * @return {?}
             */
            function (r) {
                if (r instanceof HumanPerformerImpl) {
                    notifyActivity.RemoveResourceRole(r.Id);
                }
            }));
        }
        if (performerInfo.humanPerformerList && performerInfo.humanPerformerList.length > 0) {
            try {
                for (var _b = __values(performerInfo.humanPerformerList), _c = _b.next(); !_c.done; _c = _b.next()) {
                    var humanPerformer = _c.value;
                    switch (humanPerformer.type) {
                        case UserParticipantExpression.Clr_Type_ID:
                            this.addUserParticipant(notifyActivity, (/** @type {?} */ (humanPerformer)), 'humanPerformer', null);
                            break;
                        case PositionParticipantExpression.Clr_Type_ID:
                            this.addPositionParticipant(notifyActivity, (/** @type {?} */ (humanPerformer)), 'humanPerformer', null);
                            break;
                        case VariableParticipantExpression.Clr_Type_ID:
                            this.addVariableParticipant(notifyActivity, (/** @type {?} */ (humanPerformer)), 'humanPerformer', null);
                            break;
                        case ComponentParticipantExpression.Clr_Type_ID:
                            this.addComponentParticipant(notifyActivity, (/** @type {?} */ (humanPerformer)), 'humanPerformer', null);
                            break;
                        case ReportingLineParticipantExpression.Clr_Type_ID:
                            this.addReportingLineParticipant(notifyActivity, (/** @type {?} */ (humanPerformer)), 'humanPerformer', null);
                            break;
                        case ActivityExecutorParticipantExpression.Clr_Type_ID:
                            this.addActivityExecutorParticipant(notifyActivity, (/** @type {?} */ (humanPerformer)), 'humanPerformer', null);
                            break;
                        case MatrixParticipantExpression.Clr_Type_ID:
                            this.addMatrixParticipant(notifyActivity, (/** @type {?} */ (humanPerformer)), 'humanPerformer', null);
                            break;
                    }
                }
            }
            catch (e_5_1) { e_5 = { error: e_5_1 }; }
            finally {
                try {
                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                }
                finally { if (e_5) throw e_5.error; }
            }
        }
    };
    /**
     * @param {?} notifyActivity
     * @param {?} performer
     * @param {?} type
     * @param {?} scope
     * @return {?}
     */
    NotifyActivityCell.prototype.addUserParticipant = /**
     * @param {?} notifyActivity
     * @param {?} performer
     * @param {?} type
     * @param {?} scope
     * @return {?}
     */
    function (notifyActivity, performer, type, scope) {
        /** @type {?} */
        var userParticipant = new UserParticipantExpression(notifyActivity.Model, performer.performerId, performer.performerName, performer.orgType);
        userParticipant.id = performer.id;
        userParticipant.OrgId = performer.orgId;
        userParticipant.OrgName = performer.orgName;
        userParticipant.Tag = performer.tag;
        userParticipant.OrgType = performer.orgType;
        userParticipant.order = performer.order;
        if (type === 'humanPerformer') {
            /** @type {?} */
            var humanPerformerImpl = new HumanPerformerImpl(notifyActivity.Model);
            humanPerformerImpl.participantExpression = userParticipant;
            if (performer.condition) {
                /** @type {?} */
                var condition = new Condition(notifyActivity.Model);
                condition.Value = performer.condition;
                humanPerformerImpl.condition = condition;
            }
            humanPerformerImpl.order = performer.order;
            notifyActivity.AddResourceRole(humanPerformerImpl);
        }
        else if (type === 'potentialOwner') {
            /** @type {?} */
            var otentialOwnerImpl = new PotentialOwnerImpl(notifyActivity.Model);
            otentialOwnerImpl.participantExpression = userParticipant;
            if (performer.condition) {
                /** @type {?} */
                var condition = new Condition(notifyActivity.Model);
                condition.Value = performer.condition;
                otentialOwnerImpl.condition = condition;
            }
            otentialOwnerImpl.order = performer.order;
            if (scope) {
                userParticipant.actionScope = scope;
                notifyActivity.dynamicParticipants.push(userParticipant);
            }
            else {
                notifyActivity.AddResourceRole(otentialOwnerImpl);
            }
        }
    };
    /**
     * @param {?} notifyActivity
     * @param {?} performer
     * @param {?} type
     * @param {?} scope
     * @return {?}
     */
    NotifyActivityCell.prototype.addVariableParticipant = /**
     * @param {?} notifyActivity
     * @param {?} performer
     * @param {?} type
     * @param {?} scope
     * @return {?}
     */
    function (notifyActivity, performer, type, scope) {
        /** @type {?} */
        var variablePerformer = new VariableParticipantExpression(notifyActivity.Model, performer.performerId, performer.performerName, performer.orgType);
        variablePerformer.id = performer.id;
        variablePerformer.Name = performer.performerName ? performer.performerName : performer.name;
        variablePerformer.Tag = performer.tag;
        variablePerformer.VarValue = performer.varValue;
        variablePerformer.VarType = performer.varType;
        variablePerformer.Relation = performer.relation;
        variablePerformer.order = performer.order;
        if (type === 'humanPerformer') {
            /** @type {?} */
            var humanPerformerImpl = new HumanPerformerImpl(notifyActivity.Model);
            humanPerformerImpl.participantExpression = variablePerformer;
            if (performer.condition) {
                /** @type {?} */
                var condition = new Condition(notifyActivity.Model);
                condition.Value = performer.condition;
                humanPerformerImpl.condition = condition;
            }
            humanPerformerImpl.order = performer.order;
            notifyActivity.AddResourceRole(humanPerformerImpl);
        }
        else if (type === 'potentialOwner') {
            /** @type {?} */
            var otentialOwnerImpl = new PotentialOwnerImpl(notifyActivity.Model);
            otentialOwnerImpl.participantExpression = variablePerformer;
            if (performer.condition) {
                /** @type {?} */
                var condition = new Condition(notifyActivity.Model);
                condition.Value = performer.condition;
                otentialOwnerImpl.condition = condition;
            }
            otentialOwnerImpl.order = performer.order;
            if (scope) {
                variablePerformer.actionScope = scope;
                notifyActivity.dynamicParticipants.push(variablePerformer);
            }
            else {
                notifyActivity.AddResourceRole(otentialOwnerImpl);
            }
        }
    };
    /**
     * @param {?} notifyActivity
     * @param {?} performer
     * @param {?} type
     * @param {?} scope
     * @return {?}
     */
    NotifyActivityCell.prototype.addPositionParticipant = /**
     * @param {?} notifyActivity
     * @param {?} performer
     * @param {?} type
     * @param {?} scope
     * @return {?}
     */
    function (notifyActivity, performer, type, scope) {
        /** @type {?} */
        var posiParticipant = new PositionParticipantExpression(notifyActivity.Model, performer.performerId, performer.performerName);
        posiParticipant.id = performer.id;
        posiParticipant.PositionType = performer.positionType;
        posiParticipant.order = performer.order;
        if (performer.positionType === '1') {
            posiParticipant.OrgId = performer.orgId;
            posiParticipant.OrgName = performer.orgName;
            posiParticipant.OrgType = performer.orgType;
        }
        if (type === 'humanPerformer') {
            /** @type {?} */
            var humanPerformerImpl = new HumanPerformerImpl(notifyActivity.Model);
            humanPerformerImpl.participantExpression = posiParticipant;
            if (performer.condition) {
                /** @type {?} */
                var condition = new Condition(notifyActivity.Model);
                condition.Value = performer.condition;
                humanPerformerImpl.condition = condition;
            }
            humanPerformerImpl.order = performer.order;
            notifyActivity.AddResourceRole(humanPerformerImpl);
        }
        else if (type === 'potentialOwner') {
            /** @type {?} */
            var otentialOwnerImpl = new PotentialOwnerImpl(notifyActivity.Model);
            otentialOwnerImpl.participantExpression = posiParticipant;
            if (performer.condition) {
                /** @type {?} */
                var condition = new Condition(notifyActivity.Model);
                condition.Value = performer.condition;
                otentialOwnerImpl.condition = condition;
            }
            otentialOwnerImpl.order = performer.order;
            if (scope) {
                posiParticipant.actionScope = scope;
                notifyActivity.dynamicParticipants.push(posiParticipant);
            }
            else {
                notifyActivity.AddResourceRole(otentialOwnerImpl);
            }
        }
    };
    /**
     * @param {?} notifyActivity
     * @param {?} component
     * @param {?} type
     * @param {?} scope
     * @return {?}
     */
    NotifyActivityCell.prototype.addComponentParticipant = /**
     * @param {?} notifyActivity
     * @param {?} component
     * @param {?} type
     * @param {?} scope
     * @return {?}
     */
    function (notifyActivity, component, type, scope) {
        var e_6, _a;
        /** @type {?} */
        var componentParticipant = new ComponentParticipantExpression(notifyActivity.Model);
        componentParticipant.id = component.id;
        componentParticipant.componentId = component.metadataId;
        componentParticipant.componentName = component.name;
        componentParticipant.methodName = component.methodName;
        componentParticipant.methodCode = component.methodCode;
        componentParticipant.order = component.order;
        if (component.actualParameters && component.actualParameters.length > 0) {
            /** @type {?} */
            var actParas = new Array();
            try {
                for (var _b = __values(component.actualParameters), _c = _b.next(); !_c.done; _c = _b.next()) {
                    var para = _c.value;
                    /** @type {?} */
                    var actPara = new ActualParameter(notifyActivity.Model, para.code, para.value, para.valueText);
                    // TODO:更新参与者会默认把构件参数属性改为contant，临时修复，后续代码优化
                    actPara.Tag = para.tag;
                    if (para.fetchValueMode) {
                        switch (para.fetchValueMode) {
                            case 'express':
                                actPara.Tag = 'expression';
                                break;
                            case 'none':
                                actPara.Tag = 'expression';
                                break;
                            default:
                                actPara.Tag = 'constant';
                                break;
                        }
                    }
                    actParas.push(actPara);
                }
            }
            catch (e_6_1) { e_6 = { error: e_6_1 }; }
            finally {
                try {
                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                }
                finally { if (e_6) throw e_6.error; }
            }
            componentParticipant.actualParameters = actParas;
        }
        if (type === 'humanPerformer') {
            /** @type {?} */
            var humanPerformerImpl = new HumanPerformerImpl(notifyActivity.Model);
            humanPerformerImpl.participantExpression = componentParticipant;
            if (component.condition) {
                /** @type {?} */
                var condition = new Condition(notifyActivity.Model);
                condition.Value = component.condition;
                humanPerformerImpl.condition = condition;
            }
            humanPerformerImpl.order = component.order;
            notifyActivity.AddResourceRole(humanPerformerImpl);
        }
        else if (type === 'potentialOwner') {
            /** @type {?} */
            var otentialOwnerImpl = new PotentialOwnerImpl(notifyActivity.Model);
            otentialOwnerImpl.participantExpression = componentParticipant;
            if (component.condition) {
                /** @type {?} */
                var condition = new Condition(notifyActivity.Model);
                condition.Value = component.condition;
                otentialOwnerImpl.condition = condition;
            }
            otentialOwnerImpl.order = component.order;
            if (scope) {
                componentParticipant.actionScope = scope;
                notifyActivity.dynamicParticipants.push(componentParticipant);
            }
            else {
                notifyActivity.AddResourceRole(otentialOwnerImpl);
            }
        }
    };
    /**
     * @param {?} notifyActivity
     * @param {?} participant
     * @param {?} type
     * @param {?} scope
     * @return {?}
     */
    NotifyActivityCell.prototype.addReportingLineParticipant = /**
     * @param {?} notifyActivity
     * @param {?} participant
     * @param {?} type
     * @param {?} scope
     * @return {?}
     */
    function (notifyActivity, participant, type, scope) {
        /** @type {?} */
        var reportingLine = new ReportingLineParticipantExpression(notifyActivity.Model);
        reportingLine.id = participant.id;
        reportingLine.ReportingLineDefId = participant.reportingLineDefId;
        reportingLine.ReportingLineDefName = participant.reportingLineDefName;
        reportingLine.RefOrgId = participant.refOrgId;
        reportingLine.RefUserId = participant.refUserId;
        reportingLine.RefEmployeeId = participant.refEmployeeId;
        reportingLine.order = participant.order;
        reportingLine.Dimension = participant.dimension;
        reportingLine.Tag = participant.tag;
        if (type === 'humanPerformer') {
            /** @type {?} */
            var humanPerformerImpl = new HumanPerformerImpl(notifyActivity.Model);
            humanPerformerImpl.participantExpression = reportingLine;
            if (participant.condition) {
                /** @type {?} */
                var condition = new Condition(notifyActivity.Model);
                condition.Value = participant.condition;
                humanPerformerImpl.condition = condition;
            }
            humanPerformerImpl.order = participant.order;
            notifyActivity.AddResourceRole(humanPerformerImpl);
        }
        else if (type === 'potentialOwner') {
            /** @type {?} */
            var otentialOwnerImpl = new PotentialOwnerImpl(notifyActivity.Model);
            otentialOwnerImpl.participantExpression = reportingLine;
            if (participant.condition) {
                /** @type {?} */
                var condition = new Condition(notifyActivity.Model);
                condition.Value = participant.condition;
                otentialOwnerImpl.condition = condition;
            }
            otentialOwnerImpl.order = participant.order;
            if (scope) {
                reportingLine.actionScope = scope;
                notifyActivity.dynamicParticipants.push(reportingLine);
            }
            else {
                notifyActivity.AddResourceRole(otentialOwnerImpl);
            }
        }
    };
    /**
     * @param {?} notifyActivity
     * @param {?} participant
     * @param {?} type
     * @param {?} scope
     * @return {?}
     */
    NotifyActivityCell.prototype.addActivityExecutorParticipant = /**
     * @param {?} notifyActivity
     * @param {?} participant
     * @param {?} type
     * @param {?} scope
     * @return {?}
     */
    function (notifyActivity, participant, type, scope) {
        /** @type {?} */
        var activityExecutor = new ActivityExecutorParticipantExpression(notifyActivity.Model);
        activityExecutor.id = participant.id;
        activityExecutor.activityDefId = participant.activityDefId;
        activityExecutor.order = participant.order;
        activityExecutor.activityDefName = participant.activityDefName;
        if (type === 'humanPerformer') {
            /** @type {?} */
            var humanPerformerImpl = new HumanPerformerImpl(notifyActivity.Model);
            humanPerformerImpl.participantExpression = activityExecutor;
            if (participant.condition) {
                /** @type {?} */
                var condition = new Condition(notifyActivity.Model);
                condition.Value = participant.condition;
                humanPerformerImpl.condition = condition;
            }
            humanPerformerImpl.order = participant.order;
            notifyActivity.AddResourceRole(humanPerformerImpl);
        }
        else if (type === 'potentialOwner') {
            /** @type {?} */
            var otentialOwnerImpl = new PotentialOwnerImpl(notifyActivity.Model);
            otentialOwnerImpl.participantExpression = activityExecutor;
            if (participant.condition) {
                /** @type {?} */
                var condition = new Condition(notifyActivity.Model);
                condition.Value = participant.condition;
                otentialOwnerImpl.condition = condition;
            }
            otentialOwnerImpl.order = participant.order;
            if (scope) {
                activityExecutor.actionScope = scope;
                notifyActivity.dynamicParticipants.push(activityExecutor);
            }
            else {
                notifyActivity.AddResourceRole(otentialOwnerImpl);
            }
        }
    };
    /**
     * @param {?} notifyActivity
     * @param {?} participant
     * @param {?} type
     * @param {?} scope
     * @return {?}
     */
    NotifyActivityCell.prototype.addMatrixParticipant = /**
     * @param {?} notifyActivity
     * @param {?} participant
     * @param {?} type
     * @param {?} scope
     * @return {?}
     */
    function (notifyActivity, participant, type, scope) {
        /** @type {?} */
        var matrix = new MatrixParticipantExpression(notifyActivity.Model);
        matrix.order = participant.order;
        matrix.id = participant.id;
        matrix.matrixDefId = participant.matrixDefId;
        matrix.matrixDefName = participant.matrixDefName;
        matrix.conditionField1 = participant.conditionField1;
        matrix.conditionFieldText1 = participant.conditionFieldText1;
        matrix.conditionField2 = participant.conditionField2;
        matrix.conditionFieldText2 = participant.conditionFieldText2;
        matrix.conditionField3 = participant.conditionField3;
        matrix.conditionFieldText3 = participant.conditionFieldText3;
        matrix.multivaluedCondition = participant.multivaluedCondition;
        matrix.dataFieldAlias = participant.dataFieldAlias;
        if (type === 'humanPerformer') {
            /** @type {?} */
            var humanPerformerImpl = new HumanPerformerImpl(notifyActivity.Model);
            humanPerformerImpl.participantExpression = matrix;
            if (participant.condition) {
                /** @type {?} */
                var condition = new Condition(notifyActivity.Model);
                condition.Value = participant.condition;
                humanPerformerImpl.condition = condition;
            }
            humanPerformerImpl.order = participant.order;
            notifyActivity.AddResourceRole(humanPerformerImpl);
        }
        else if (type === 'potentialOwner') {
            /** @type {?} */
            var otentialOwnerImpl = new PotentialOwnerImpl(notifyActivity.Model);
            otentialOwnerImpl.participantExpression = matrix;
            if (participant.condition) {
                /** @type {?} */
                var condition = new Condition(notifyActivity.Model);
                condition.Value = participant.condition;
                otentialOwnerImpl.condition = condition;
            }
            otentialOwnerImpl.order = participant.order;
            if (scope) {
                matrix.actionScope = scope;
                notifyActivity.dynamicParticipants.push(matrix);
            }
            else {
                notifyActivity.AddResourceRole(otentialOwnerImpl);
            }
        }
    };
    /**
 *
 * @param userActivity
 * @param participant
 * @param type
 */
    /**
     *
     * @param {?} notifyActivity
     * @param {?} participant
     * @param {?} type
     * @param {?} scope
     * @return {?}
     */
    NotifyActivityCell.prototype.addOrganizationParticipant = /**
     *
     * @param {?} notifyActivity
     * @param {?} participant
     * @param {?} type
     * @param {?} scope
     * @return {?}
     */
    function (notifyActivity, participant, type, scope) {
        /** @type {?} */
        var potential = new OrganizationParticipantExpression(notifyActivity.Model);
        potential.id = participant.id;
        potential.order = participant.order;
        potential.actionScope = ActionScope.AssignUser;
        potential.organizationLevel = (/** @type {?} */ (participant.organizationLevel));
        potential.organizationId = participant.organizationId;
        potential.organizationName = participant.organizationName;
        potential.includeChildren = participant.includeChildren;
        potential.tag = participant.tag;
        if (participant.condition) {
            /** @type {?} */
            var condition = new Condition(notifyActivity.Model);
            condition.Value = participant.condition;
            potential.condition = condition;
        }
        if (type === 'humanPerformer') {
            /** @type {?} */
            var humanPerformerImpl = new HumanPerformerImpl(notifyActivity.Model);
            humanPerformerImpl.participantExpression = potential;
            if (participant.condition) {
                /** @type {?} */
                var condition = new Condition(notifyActivity.Model);
                condition.Value = participant.condition;
                humanPerformerImpl.condition = condition;
            }
            humanPerformerImpl.order = participant.order;
            notifyActivity.AddResourceRole(humanPerformerImpl);
        }
        else if (type === 'potentialOwner') {
            /** @type {?} */
            var otentialOwnerImpl = new PotentialOwnerImpl(notifyActivity.Model);
            otentialOwnerImpl.participantExpression = potential;
            if (participant.condition) {
                /** @type {?} */
                var condition = new Condition(notifyActivity.Model);
                condition.Value = participant.condition;
                otentialOwnerImpl.condition = condition;
            }
            otentialOwnerImpl.order = participant.order;
            if (scope) {
                potential.actionScope = scope;
                notifyActivity.dynamicParticipants.push(potential);
            }
            else {
                notifyActivity.AddResourceRole(otentialOwnerImpl);
            }
        }
    };
    /**
     * @param {?} notifyActivity
     * @param {?} obj
     * @param {?} terminal
     * @return {?}
     */
    NotifyActivityCell.prototype.updateStartActivityForm = /**
     * @param {?} notifyActivity
     * @param {?} obj
     * @param {?} terminal
     * @return {?}
     */
    function (notifyActivity, obj, terminal) {
        var e_7, _a;
        if (notifyActivity) {
            /** @type {?} */
            var form = (/** @type {?} */ (obj.propertyValue));
            if (!notifyActivity.executeForms) {
                notifyActivity.executeForms = new Array();
            }
            notifyActivity.executeForms = notifyActivity.executeForms.filter((/**
             * @param {?} e
             * @return {?}
             */
            function (e) { return e.TerminalType !== terminal; }));
            if (form) {
                /** @type {?} */
                var params = (/** @type {?} */ (form.ActualParameters));
                /** @type {?} */
                var actParas = new Array();
                if (params && params.length > 0) {
                    try {
                        for (var params_1 = __values(params), params_1_1 = params_1.next(); !params_1_1.done; params_1_1 = params_1.next()) {
                            var para = params_1_1.value;
                            /** @type {?} */
                            var actPara = new ActualParameter(notifyActivity.Model, para.Name, para.Value);
                            if (para.Tag) {
                                actPara.Tag = para.Tag;
                            }
                            else {
                                if (para.Value) {
                                    if (para.Value.length >= 8 && para.Value.slice(0, 8) === "{\"expr\":") {
                                        actPara.Tag = 'expression';
                                    }
                                    else {
                                        actPara.Tag = 'constant';
                                    }
                                }
                                else {
                                    actPara.Tag = 'variable';
                                }
                            }
                            actParas.push(actPara);
                        }
                    }
                    catch (e_7_1) { e_7 = { error: e_7_1 }; }
                    finally {
                        try {
                            if (params_1_1 && !params_1_1.done && (_a = params_1.return)) _a.call(params_1);
                        }
                        finally { if (e_7) throw e_7.error; }
                    }
                }
                /** @type {?} */
                var id = BpmnModelHelper.GenerateElementId();
                /** @type {?} */
                var item = new ExecuteForm(notifyActivity.Model, id, form.Name, actParas);
                item.ComponentId = form.ComponentId;
                item.FormType = form.FormType;
                item.formFormatId = form.formFormatId;
                item.formatConfigId = form.formatConfigId;
                item.TerminalType = form.TerminalType;
                notifyActivity.executeForms.push(item);
            }
        }
    };
    /**
     * @param {?} notifyActivity
     * @param {?} obj
     * @return {?}
     */
    NotifyActivityCell.prototype.updateNotifySet = /**
     * @param {?} notifyActivity
     * @param {?} obj
     * @return {?}
     */
    function (notifyActivity, obj) {
        var e_8, _a;
        /** @type {?} */
        var scope = (/** @type {?} */ (obj.propertyValue));
        notifyActivity.dynamicParticipants = notifyActivity.dynamicParticipants.filter((/**
         * @param {?} p
         * @return {?}
         */
        function (p) { return ((/** @type {?} */ (p))).actionScope !== ActionScope.Notify; }));
        notifyActivity.notifyAble = scope.enable;
        if (scope.scope) {
            if (scope.scope.organizationLevel) {
                /** @type {?} */
                var organizationParticipantExpression = new OrganizationParticipantExpression(notifyActivity.Model);
                organizationParticipantExpression.id = BpmnModelHelper.GenerateElementId();
                organizationParticipantExpression.actionScope = ActionScope.Notify;
                organizationParticipantExpression.organizationLevel = (/** @type {?} */ (scope.scope.organizationLevel));
                organizationParticipantExpression.organizationId = scope.scope.organizationId;
                organizationParticipantExpression.organizationName = scope.scope.organizationName;
                organizationParticipantExpression.includeChildren = scope.scope.includeChildren;
                organizationParticipantExpression.tag = scope.scope.tag;
                notifyActivity.dynamicParticipants.push(organizationParticipantExpression);
            }
            else {
                /** @type {?} */
                var performerInfo = (/** @type {?} */ (scope.scope.participantInfo));
                if (performerInfo.isAllScope && performerInfo.potentialOwnerList && performerInfo.potentialOwnerList.length > 0) {
                    try {
                        for (var _b = __values(performerInfo.potentialOwnerList), _c = _b.next(); !_c.done; _c = _b.next()) {
                            var potentialOwner = _c.value;
                            switch (potentialOwner.type) {
                                case UserParticipantExpression.Clr_Type_ID:
                                    this.addUserParticipant(notifyActivity, (/** @type {?} */ (potentialOwner)), 'potentialOwner', ActionScope.Notify);
                                    break;
                                case VariableParticipantExpression.Clr_Type_ID:
                                    this.addVariableParticipant(notifyActivity, (/** @type {?} */ (potentialOwner)), 'potentialOwner', ActionScope.Notify);
                                    break;
                                case PositionParticipantExpression.Clr_Type_ID:
                                    this.addPositionParticipant(notifyActivity, (/** @type {?} */ (potentialOwner)), 'potentialOwner', ActionScope.Notify);
                                    break;
                                case ComponentParticipantExpression.Clr_Type_ID:
                                    this.addComponentParticipant(notifyActivity, (/** @type {?} */ (potentialOwner)), 'potentialOwner', ActionScope.Notify);
                                    break;
                                case ReportingLineParticipantExpression.Clr_Type_ID:
                                    this.addReportingLineParticipant(notifyActivity, (/** @type {?} */ (potentialOwner)), 'potentialOwner', ActionScope.Notify);
                                    break;
                                case ActivityExecutorParticipantExpression.Clr_Type_ID:
                                    this.addActivityExecutorParticipant(notifyActivity, (/** @type {?} */ (potentialOwner)), 'potentialOwner', ActionScope.Notify);
                                    break;

                                case MatrixParticipantExpression.Clr_Type_ID:
                                    this.addMatrixParticipant(notifyActivity, (/** @type {?} */ (potentialOwner)), 'potentialOwner', ActionScope.Notify);
                                    break;
                                case OrganizationParticipantExpression.Clr_Type_ID:
                                    this.addOrganizationParticipant(notifyActivity, (/** @type {?} */ (potentialOwner)), 'potentialOwner', ActionScope.Notify);
                                    break;
                            }
                        }
                    }
                    catch (e_8_1) { e_8 = { error: e_8_1 }; }
                    finally {
                        try {
                            if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                        }
                        finally { if (e_8) throw e_8.error; }
                    }
                }
            }
        }
    };
    /**
     * 更新知会活动扩展属性
     * @param notifyActivity
     * @param obj
     */
    /**
     * 更新知会活动扩展属性
     * @param {?} notifyActivity
     * @param {?} obj
     * @return {?}
     */
    NotifyActivityCell.prototype.resetExtendProperty = /**
     * 更新知会活动扩展属性
     * @param {?} notifyActivity
     * @param {?} obj
     * @return {?}
     */
    function (notifyActivity, obj) {
        var e_9, _a;
        if (notifyActivity) {
            /** @type {?} */
            var attributes = (/** @type {?} */ (obj.propertyValue));
            if (!notifyActivity.extendProperties) {
                notifyActivity.extendProperties = new Array();
            }
            var _loop_1 = function (o) {
                /** @type {?} */
                var index = notifyActivity.extendProperties.findIndex((/**
                 * @param {?} e
                 * @return {?}
                 */
                function (e) { return e.key === o.code; }));
                if (index > -1) {
                    notifyActivity.extendProperties.splice(index, 1);
                }
            };
            try {
                for (var _b = __values(obj.propertyValue), _c = _b.next(); !_c.done; _c = _b.next()) {
                    var o = _c.value;
                    _loop_1(o);
                }
            }
            catch (e_9_1) { e_9 = { error: e_9_1 }; }
            finally {
                try {
                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                }
                finally { if (e_9) throw e_9.error; }
            }
            if (attributes) {
                attributes.forEach((/**
                 * @param {?} a
                 * @return {?}
                 */
                function (a) {
                    /** @type {?} */
                    var item = new ExtendProperty(notifyActivity.Model);
                    item.key = a.code;
                    item.value = a.value;
                    notifyActivity.extendProperties.push(item);
                }));
            }
        }
    };
    /**
     * @param {?} notifyActivity
     * @param {?} obj
     * @return {?}
     */
    NotifyActivityCell.prototype.updateMessageNotices = /**
     * @param {?} notifyActivity
     * @param {?} obj
     * @return {?}
     */
    function (notifyActivity, obj) {
        var e_10, _a, e_11, _b, e_12, _c, e_13, _d;
        /** @type {?} */
        var bpmnModel = notifyActivity.Model;
        /** @type {?} */
        var notices = (/** @type {?} */ (obj.propertyValue));
        notifyActivity.messageNotices = new Array();
        if (notices && notices.length > 0) {
            try {
                for (var notices_1 = __values(notices), notices_1_1 = notices_1.next(); !notices_1_1.done; notices_1_1 = notices_1.next()) {
                    var n = notices_1_1.value;
                    /** @type {?} */
                    var messageNotice = new MessageNotice(bpmnModel);
                    messageNotice.sendType = n.sendType;
                    messageNotice.sendTime = n.sendTime;
                    messageNotice.subject = n.subject;
                    messageNotice.content = n.content;
                    if (n.smsMessageTemplate) {
                        /** @type {?} */
                        var smsMessageTemplate = new SmsMessageTemplate(bpmnModel);
                        smsMessageTemplate.code = n.smsMessageTemplate.code;
                        smsMessageTemplate.content = n.smsMessageTemplate.content;
                        smsMessageTemplate.smsMessageVariables = new Array();
                        if (n.smsMessageTemplate.smsMessageVariables && n.smsMessageTemplate.smsMessageVariables.length > 0) {
                            try {
                                for (var _e = __values(n.smsMessageTemplate.smsMessageVariables), _f = _e.next(); !_f.done; _f = _e.next()) {
                                    var v = _f.value;
                                    /** @type {?} */
                                    var variable = new SmsMessageVariable(bpmnModel);
                                    variable.code = v.code;
                                    variable.value = v.value;
                                    variable.tag = v.tag;
                                    smsMessageTemplate.smsMessageVariables.push(variable);
                                }
                            }
                            catch (e_11_1) { e_11 = { error: e_11_1 }; }
                            finally {
                                try {
                                    if (_f && !_f.done && (_b = _e.return)) _b.call(_e);
                                }
                                finally { if (e_11) throw e_11.error; }
                            }
                        }
                        messageNotice.smsMessageTemplate = smsMessageTemplate;
                    }
                    // messageNotice.receiver = n.receiver;
                    // messageNotice.receiverText = n.receiverText;
                    n.receivers = n.receivers.filter((/**
                     * @param {?} r
                     * @return {?}
                     */
                    function (r) { return r.type; }));
                    if (n.receivers && n.receivers.length > 0) {
                        /** @type {?} */
                        var receivers = n.receivers.filter((/**
                         * @param {?} r
                         * @return {?}
                         */
                        function (r) { return r.type === 'userParticipant'
                            || (r.type === 'processParticipant' && r.processParticipant !== 'activityExecutorParticipant'); }));
                        /** @type {?} */
                        var participants = n.receivers.filter((/**
                         * @param {?} r
                         * @return {?}
                         */
                        function (r) { return r.type === 'variableParticipant' || r.type === 'positionParticipant'
                            || (r.type === 'processParticipant' && r.processParticipant === 'activityExecutorParticipant'); }));
                        if (receivers && receivers.length > 0) {
                            /** @type {?} */
                            var receiver = '';
                            /** @type {?} */
                            var receiverName = '';
                            try {
                                for (var receivers_1 = __values(receivers), receivers_1_1 = receivers_1.next(); !receivers_1_1.done; receivers_1_1 = receivers_1.next()) {
                                    var r = receivers_1_1.value;
                                    if (r.type === 'processParticipant') {
                                        receiver += (r.processParticipant + ',');
                                        if (r.processParticipant === 'procInstCreator') {
                                            receiverName += '流程发起人,';
                                        }
                                        else if (r.processParticipant === 'workItemParticipant') {
                                            receiverName += '任务接收人,';
                                        }
                                    }
                                    else if (r.type === 'userParticipant') {
                                        receiver += (r.userIds + ',');
                                        receiverName += (r.userNames + ',');
                                    }
                                }
                            }
                            catch (e_12_1) { e_12 = { error: e_12_1 }; }
                            finally {
                                try {
                                    if (receivers_1_1 && !receivers_1_1.done && (_c = receivers_1.return)) _c.call(receivers_1);
                                }
                                finally { if (e_12) throw e_12.error; }
                            }
                            if (receiver) {
                                receiver = receiver.substring(0, receiver.length - 1);
                            }
                            if (receiverName) {
                                receiverName = receiverName.substring(0, receiverName.length - 1);
                            }
                            messageNotice.receiver = receiver;
                            messageNotice.receiverText = receiverName;
                        }
                        if (participants && participants.length > 0) {
                            /** @type {?} */
                            var receiverExpressions = new Array();
                            try {
                                for (var participants_1 = __values(participants), participants_1_1 = participants_1.next(); !participants_1_1.done; participants_1_1 = participants_1.next()) {
                                    var p = participants_1_1.value;
                                    if (p.type === 'processParticipant') {
                                        /** @type {?} */
                                        var activityExecutor = new ActivityExecutorParticipantExpression(notifyActivity.Model);
                                        activityExecutor.id = BpmnModelHelper.GenerateElementId();
                                        activityExecutor.activityDefId = p.activityDefId;
                                        activityExecutor.activityDefName = p.activityDefName;
                                        receiverExpressions.push(activityExecutor);
                                    }
                                    if (p.type === 'variableParticipant') {
                                        /** @type {?} */
                                        var variableParticipant = new UserParticipantExpression(notifyActivity.Model, p.variableParticipant, p.variableName, p.orgType);
                                        variableParticipant.id = BpmnModelHelper.GenerateElementId();
                                        variableParticipant.Tag = 'expression';
                                        variableParticipant.OrgType = p.orgType;
                                        receiverExpressions.push(variableParticipant);
                                    }
                                    if (p.type === 'positionParticipant') {
                                        /** @type {?} */
                                        var posiParticipant = new PositionParticipantExpression(notifyActivity.Model, p.positionId, p.positionName);
                                        posiParticipant.id = BpmnModelHelper.GenerateElementId();
                                        posiParticipant.PositionType = p.positionType;
                                        if (p.positionType === '1') {
                                            posiParticipant.OrgId = p.orgId;
                                            posiParticipant.OrgType = p.orgType;
                                        }
                                        receiverExpressions.push(posiParticipant);
                                    }
                                }
                            }
                            catch (e_13_1) { e_13 = { error: e_13_1 }; }
                            finally {
                                try {
                                    if (participants_1_1 && !participants_1_1.done && (_d = participants_1.return)) _d.call(participants_1);
                                }
                                finally { if (e_13) throw e_13.error; }
                            }
                            messageNotice.receiverExpressions = receiverExpressions;
                        }
                    }
                    notifyActivity.messageNotices.push(messageNotice);
                }
            }
            catch (e_10_1) { e_10 = { error: e_10_1 }; }
            finally {
                try {
                    if (notices_1_1 && !notices_1_1.done && (_a = notices_1.return)) _a.call(notices_1);
                }
                finally { if (e_10) throw e_10.error; }
            }
        }
    };
    NotifyActivityCell.CLR_TYPE_ID = NotifyActivity.Clr_Type_ID;
    return NotifyActivityCell;
}(NodeCell));

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/**
 * 审批活动节点
 */
var UserActivityCell = /** @class */ (function (_super) {
    __extends(UserActivityCell, _super);
    function UserActivityCell(value, geometry, style) {
        var _a;
        var _this = _super.call(this, value, geometry, style) || this;
        _this.clrTypeId = UserActivityCell.CLR_TYPE_ID;
        _this.name = "审批";
        _this.nameLanguage = {
            "zh-CHS": "审批",
            "zh-CHT": "審批",
            "en": "Approve",
        };
        _this.imgUrls = (_a = {},
            _a[FlowNodeState.Default] = WfConstants.IMAGE_PATH + "/approval.png",
            _a[FlowNodeState.Selected] = WfConstants.IMAGE_PATH + "/approval_select.svg",
            _a);
        return _this;
    }
    /**
     * @param {?=} flowElt
     * @return {?}
     */
    UserActivityCell.prototype.createFlowElement = /**
     * @param {?=} flowElt
     * @return {?}
     */
    function (flowElt) {
        var e_1, _a, e_2, _b;
        /** @type {?} */
        var flowNode = (/** @type {?} */ (_super.prototype.createFlowElement.call(this, flowElt)));
        /** @type {?} */
        var editorUi = this.editorUi;
        /** @type {?} */
        var bpmnModel = editorUi.graph.bpmnModel;
        flowNode.Id = "UserActivity" + BpmnModelHelper.GenerateElementId();
        // 创建而非复制时执行
        if (flowElt == null) {
            flowNode.transferAble = editorUi.generalConfig.enableTransfer;
            flowNode.AddSignBehindAble = editorUi.generalConfig.enableAddSignBehind;
            flowNode.AddSignFrontAble = editorUi.generalConfig.enableAddSignFront;
            flowNode.NotifyAble = editorUi.generalConfig.enableNotify;
            if (this.bizActivity) {
                /** @type {?} */
                var bizActivity = this.bizActivity;
                flowNode.BizActivityID = bizActivity.id;
                flowNode.BizActivityName = bizActivity.name;
                flowNode.Tools = [];
                try {
                    for (var _c = __values(bizActivity.bizComponents), _d = _c.next(); !_d.done; _d = _c.next()) {
                        var c = _d.value;
                        /** @type {?} */
                        var tool = new Component$1(flowNode.Model);
                        tool.Id = c.id;
                        tool.Name = c.name;
                        tool.Time = c.executionTime;
                        // TODO 写死了构件类型
                        tool.ComponentType = 'CommonComponent';
                        tool.MetadataId = c.metadataId;
                        tool.MethodCode = c.methodCode;
                        tool.ActualParameters = [];
                        if (c.actualParameters && ((/** @type {?} */ (c.actualParameters))).length > 0) {
                            try {
                                for (var _e = __values(((/** @type {?} */ (c.actualParameters)))), _f = _e.next(); !_f.done; _f = _e.next()) {
                                    var a = _f.value;
                                    /** @type {?} */
                                    var parameter = new ActualParameter(bpmnModel, a.code, a.value);
                                    tool.ActualParameters.push(parameter);
                                }
                            }
                            catch (e_2_1) { e_2 = { error: e_2_1 }; }
                            finally {
                                try {
                                    if (_f && !_f.done && (_b = _e.return)) _b.call(_e);
                                }
                                finally { if (e_2) throw e_2.error; }
                            }
                        }
                        flowNode.Tools.push(tool);
                    }
                }
                catch (e_1_1) { e_1 = { error: e_1_1 }; }
                finally {
                    try {
                        if (_d && !_d.done && (_a = _c.return)) _a.call(_c);
                    }
                    finally { if (e_1) throw e_1.error; }
                }
                flowNode.setBizConclusions(bpmnModel, bizActivity.bizActions);
            }
            else {
                flowNode.BizActivityID = "";
                flowNode.initConclusions(bpmnModel);
            }
        }
        return flowNode;
    };
    /**
     * @return {?}
     */
    UserActivityCell.prototype.createDiagramElement = /**
     * @return {?}
     */
    function () {
        var _a;
        if (this.bizActivity != null) {
            this.imgUrls = (_a = {},
                _a[FlowNodeState.Default] = WfConstants.IMAGE_PATH + "/bizActivity.png",
                _a[FlowNodeState.Selected] = WfConstants.IMAGE_PATH + "/bizActivity_select.svg",
                _a);
        }
        /** @type {?} */
        var shape = _super.prototype.createDiagramElement.call(this);
        return shape;
    };
    /**
     * @return {?}
     */
    UserActivityCell.prototype.getFarrisPropConfig = /**
     * @return {?}
     */
    function () {
        return this.getFarrisPropConfigByIsOperation();
    };
    /**
     * @param {?=} isOperation
     * @return {?}
     */
    UserActivityCell.prototype.getFarrisPropConfigByIsOperation = /**
     * @param {?=} isOperation
     * @return {?}
     */
    function (isOperation) {
        if (isOperation === void 0) { isOperation = false; }
        var e_3, _a, e_4, _b, e_5, _c;
        /** @type {?} */
        var editorUi = this.editorUi;
        /** @type {?} */
        var extendList = [];
        if (editorUi.procExtProps && editorUi.procExtProps.length > 0) {
            extendList = JSON.parse(JSON.stringify(editorUi.procExtProps)).sort((/**
             * @param {?} a
             * @param {?} b
             * @return {?}
             */
            function (a, b) {
                return a.sortOrder - b.sortOrder;
            }));
        }
        extendList = extendList.sort((/**
         * @param {?} a
         * @param {?} b
         * @return {?}
         */
        function (a, b) {
            return a.sortOrder - b.sortOrder;
        }));
        /** @type {?} */
        var userAct = this.flowElement;
        /** @type {?} */
        var basicProperty = new ElementPropertyConfig();
        /** @type {?} */
        var propertyData = {};
        basicProperty.categoryId = 'basicProperty';
        basicProperty.categoryName = mxResources.get('basicInformation');
        basicProperty.tabId = 'basic';
        basicProperty.tabName = mxResources.get('basicAttributes');
        basicProperty.properties = [
            { propertyID: UserActivityPropertyKeys.Name, propertyName: mxResources.get('name'), propertyType: 'string', visible: !this.editorUi.multiLangEnabled },
            { propertyID: UserActivityPropertyKeys.NameLanguage, propertyName: mxResources.get('nameLanguage'), propertyType: 'multiLanguage', visible: this.editorUi.multiLangEnabled },
            { propertyID: UserActivityPropertyKeys.Id, propertyName: mxResources.get('id'), propertyType: 'string', readonly: true },
            { propertyID: UserActivityPropertyKeys.wf_TitleExpression, propertyName: mxResources.get('wfTitleExpression'), propertyType: 'modal' },
        ];
        /** @type {?} */
        var performerProperty = new ElementPropertyConfig();
        performerProperty.categoryId = 'performerProperty';
        performerProperty.categoryName = mxResources.get('participant');
        performerProperty.tabId = 'basic';
        performerProperty.tabName = mxResources.get('basicAttributes');
        performerProperty.properties = [
            { propertyID: UserActivityPropertyKeys.ParticipantSchemes, propertyName: mxResources.get('participantSchemes'), propertyType: 'modal' },
            { propertyID: UserActivityPropertyKeys.ParticipantOptions, propertyName: mxResources.get('participantOptions'), propertyType: 'modal' },
        ];
        // if (userAct.AssignmentStrategy !== AssignmentStrategy.ASSIGN) {
        //     performerProperty.properties.push(
        //         { propertyID: UserActivityPropertyKeys.AssignStrategy, propertyName: '分配策略', propertyType: 'modal' }
        //     );
        // } else {
        //     performerProperty.properties = performerProperty.properties.concat(
        //         [{ propertyID: UserActivityPropertyKeys.AssignStrategy, propertyName: '分配策略', propertyType: 'modal' },
        //         { propertyID: UserActivityPropertyKeys.AssignPerformer, propertyName: '备选办理人', propertyType: 'modal' }]);
        // }
        if (!isOperation) {
            if (userAct.ExecuteWorkItemMode === ExecuteWorkItemMode.Preempt) {
                performerProperty.properties.push({ propertyID: UserActivityPropertyKeys.CompleteStrategy, propertyName: mxResources.get('completeStrategy'), propertyType: 'select' });
                propertyData[UserActivityPropertyKeys.CompleteStrategy] = userAct.ExecuteWorkItemMode;
            }
            else {
                performerProperty.properties = performerProperty.properties.concat([
                    { propertyID: UserActivityPropertyKeys.CompleteStrategy, propertyName: mxResources.get('completeStrategy'), propertyType: 'select' },
                    { propertyID: UserActivityPropertyKeys.SignRule, propertyName: mxResources.get('signRule'), propertyType: 'modal' },
                ]);
                propertyData[UserActivityPropertyKeys.CompleteStrategy] = userAct.ExecuteWorkItemMode;
                propertyData[UserActivityPropertyKeys.SignRule] = userAct.CounterSignRules;
            }
        }
        /** @type {?} */
        var approvalProperty = new ElementPropertyConfig();
        approvalProperty.categoryId = 'approvalProperty';
        approvalProperty.categoryName = mxResources.get('operationsManage');
        approvalProperty.tabId = 'approvalProperty';
        approvalProperty.tabName = mxResources.get('operationsConfig');
        approvalProperty.properties = [
            { propertyID: UserActivityPropertyKeys.ApprovalItems, propertyName: mxResources.get('approvalItems'), propertyType: 'modal' },
            { propertyID: UserActivityPropertyKeys.wf_CustomizeAction, propertyName: mxResources.get('wfCustomizeAction'), propertyType: 'modal' },
        ];
        // 审批活动节点含“驳回”审批动作时，属性框支持驳回规则属性
        if (userAct.Conclusions && this.isBackConclusionExist(userAct.Conclusions)) {
            approvalProperty.properties.push({ propertyID: UserActivityPropertyKeys.BackWardRule, propertyName: mxResources.get('backWardRule'), propertyType: 'modal' });
            propertyData[UserActivityPropertyKeys.BackWardRule] = userAct.BackWardRule;
        }
        approvalProperty.properties = approvalProperty.properties.concat([
            { propertyID: UserActivityPropertyKeys.Retrievable, propertyName: mxResources.get('retrievable'), propertyType: 'select' },
        ]);
        if (!isOperation) {
            approvalProperty.properties = approvalProperty.properties.concat([
                { propertyID: UserActivityPropertyKeys.AddSignFrontAble, propertyName: mxResources.get('addSignFrontAble'), propertyType: 'modal' },
                { propertyID: UserActivityPropertyKeys.AddSignBehindAble, propertyName: mxResources.get('addSignBehindAble'), propertyType: 'modal' },
            ]);
        }
        if (editorUi.generalConfig.enableTransfer) {
            approvalProperty.properties = approvalProperty.properties.concat([
                { propertyID: UserActivityPropertyKeys.transferScope, propertyName: mxResources.get('transferScope'), propertyType: 'modal' },
            ]);
        }
        approvalProperty.properties = approvalProperty.properties.concat([
            { propertyID: UserActivityPropertyKeys.NotifyAble, propertyName: mxResources.get('notifyAble'), propertyType: 'modal' },
            { propertyID: UserActivityPropertyKeys.urgeHandleRule, propertyName: mxResources.get('urgeHandleRule'), propertyType: 'modal' }
        ]);
        if (userAct.SelectTargetAble) {
            approvalProperty.properties = approvalProperty.properties.concat([
                { propertyID: UserActivityPropertyKeys.SelectTargetAble, propertyName: mxResources.get('selectTargetAble'), propertyType: 'select' },
                { propertyID: UserActivityPropertyKeys.JumpScope, propertyName: mxResources.get('jumpScope'), propertyType: 'modal' },
            ]);
            propertyData[UserActivityPropertyKeys.SelectTargetAble] = userAct.SelectTargetAble;
            propertyData[UserActivityPropertyKeys.JumpScope] = userAct.JumpScope;
        }
        else {
            approvalProperty.properties = approvalProperty.properties.concat([
                { propertyID: UserActivityPropertyKeys.SelectTargetAble, propertyName: mxResources.get('selectTargetAble'), propertyType: 'select' },
            ]);
            propertyData[UserActivityPropertyKeys.SelectTargetAble] = userAct.SelectTargetAble;
        }
        if (userAct.otherAssignNodes) {
            approvalProperty.properties = approvalProperty.properties.concat([
                { propertyID: UserActivityPropertyKeys.otherAssignNodes, propertyName: mxResources.get('otherAssignNodes'), propertyType: 'select' },
                // { propertyID: UserActivityPropertyKeys.otherAssignActivities, propertyName: mxResources.get('otherAssignActivities'), propertyType: 'modal' },
                { propertyID: UserActivityPropertyKeys.otherAssignActivityNodeInfos, propertyName: mxResources.get('otherAssignActivityNodeInfos'), propertyType: 'modal' },
            ]);
            propertyData[UserActivityPropertyKeys.otherAssignNodes] = true;
            // propertyData[UserActivityPropertyKeys.otherAssignActivities] = userAct.otherAssignNodes.otherAssignActivities;
            propertyData[UserActivityPropertyKeys.otherAssignActivityNodeInfos] = userAct.otherAssignNodes.otherAssignActivityNodeInfos || userAct.otherAssignNodes.otherAssignActivityNodeInfos;
            if (userAct.otherAssignNodes.otherAssignActivities) {
                userAct.otherAssignNodes.otherAssignActivities = null;
            }
        }
        else {
            approvalProperty.properties = approvalProperty.properties.concat([
                { propertyID: UserActivityPropertyKeys.otherAssignNodes, propertyName: mxResources.get('otherAssignNodes'), propertyType: 'select' }
            ]);
            propertyData[UserActivityPropertyKeys.otherAssignNodes] = false;
        }
        /** @type {?} */
        var eventListeners = new ElementPropertyConfig();
        eventListeners.categoryId = 'eventListeners'; // 活动选项（表单定义+活动构件）
        eventListeners.categoryName = mxResources.get('eventListeners');
        eventListeners.tabId = 'advanced';
        eventListeners.tabName = mxResources.get('advancedAttributes');
        eventListeners.properties = [
            { propertyID: UserActivityPropertyKeys.Tools, propertyName: mxResources.get('tools'), propertyType: 'modal' },
            { propertyID: UserActivityPropertyKeys.checkConditions, propertyName: mxResources.get('checkConditions'), propertyType: 'modal' },
            { propertyID: UserActivityPropertyKeys.variableSettings, propertyName: mxResources.get('variableSettings'), propertyType: 'modal' }
        ];
        /** @type {?} */
        var ApprovalSettings = new ElementPropertyConfig();
        ApprovalSettings.categoryId = 'ApprovalSettings'; // 活动选项（表单定义+活动构件）
        ApprovalSettings.categoryName = mxResources.get('approvalSettings');
        ApprovalSettings.tabId = 'advanced';
        ApprovalSettings.tabName = mxResources.get('advancedAttributes');
        ApprovalSettings.properties = [
            { propertyID: UserActivityPropertyKeys.anonymousSet, propertyName: mxResources.get('anonymousSet'), propertyType: 'modal' },
            { propertyID: UserActivityPropertyKeys.approvalPivotConfig, propertyName: mxResources.get('approvalPivotConfig'), propertyType: 'modal' },
            { propertyID: UserActivityPropertyKeys.imageSettings, propertyName: mxResources.get('imageSettings'), propertyType: 'modal' },
            { propertyID: UserActivityPropertyKeys.MultiInstanceLoopCharacteristics, propertyName: mxResources.get('multiInstanceLoopCharacteristics'), propertyType: 'modal' }
        ];
        propertyData[UserActivityPropertyKeys.MultiInstanceLoopCharacteristics] = userAct.LoopCharacteristics;
        /** @type {?} */
        var taskTimeliness = new ElementPropertyConfig();
        taskTimeliness.categoryId = 'taskTimeliness'; // 活动选项（表单定义+活动构件）
        taskTimeliness.categoryName = mxResources.get('taskTimeliness');
        taskTimeliness.tabId = 'advanced';
        taskTimeliness.tabName = mxResources.get('advancedAttributes');
        taskTimeliness.properties = [
            { propertyID: UserActivityPropertyKeys.timeLimitControl, propertyName: mxResources.get('timeLimitControl'), propertyType: 'modal' },
            { propertyID: UserActivityPropertyKeys.messageNotice, propertyName: mxResources.get('messageNotice'), propertyType: 'modal' },
        ];
        /** @type {?} */
        var formDef = new ElementPropertyConfig();
        formDef.categoryId = 'formDef';
        formDef.categoryName = mxResources.get('formDef');
        formDef.tabId = 'basic';
        formDef.tabName = mxResources.get('basicAttributes');
        formDef.properties = [
            { propertyID: UserActivityPropertyKeys.DisplayTerminal, propertyName: mxResources.get('displayTerminal'), propertyType: 'select' },
            { propertyID: UserActivityPropertyKeys.wf_ExecuteForms_PC, propertyName: mxResources.get('pcForm'), propertyType: 'modal' },
            { propertyID: UserActivityPropertyKeys.wf_ExecuteForms_Mobile, propertyName: mxResources.get('webForm'), propertyType: 'modal' },
        ];
        // 扩展属性分group处理，每个group包含父级属性和属于它的子扩展属性
        /** @type {?} */
        var groupList = new Array();
        try {
            for (var extendList_1 = __values(extendList), extendList_1_1 = extendList_1.next(); !extendList_1_1.done; extendList_1_1 = extendList_1.next()) {
                var extend = extendList_1_1.value;
                if (!extend.parentId) {
                    /** @type {?} */
                    var group = { parent: extend, childs: new Array() };
                    try {
                        for (var extendList_2 = __values(extendList), extendList_2_1 = extendList_2.next(); !extendList_2_1.done; extendList_2_1 = extendList_2.next()) {
                            var e = extendList_2_1.value;
                            if (e.parentId === extend.id) {
                                group.childs.push(e);
                            }
                        }
                    }
                    catch (e_4_1) { e_4 = { error: e_4_1 }; }
                    finally {
                        try {
                            if (extendList_2_1 && !extendList_2_1.done && (_b = extendList_2.return)) _b.call(extendList_2);
                        }
                        finally { if (e_4) throw e_4.error; }
                    }
                    groupList.push(group);
                }
            }
        }
        catch (e_3_1) { e_3 = { error: e_3_1 }; }
        finally {
            try {
                if (extendList_1_1 && !extendList_1_1.done && (_a = extendList_1.return)) _a.call(extendList_1);
            }
            finally { if (e_3) throw e_3.error; }
        }
        // 没有扩展属性值的时候不显示扩展属性一栏
        if (groupList && groupList.length > 0) {
            /** @type {?} */
            var ExtendPropertyConfig = new ElementPropertyConfig();
            ExtendPropertyConfig.categoryId = 'extendPropertyConfig';
            ExtendPropertyConfig.categoryName = mxResources.get('extendPropertyConfig');
            ExtendPropertyConfig.tabId = 'advanced';
            ExtendPropertyConfig.tabName = mxResources.get('advancedAttributes');
            ExtendPropertyConfig.properties = new Array();
            try {
                for (var groupList_1 = __values(groupList), groupList_1_1 = groupList_1.next(); !groupList_1_1.done; groupList_1_1 = groupList_1.next()) {
                    var g = groupList_1_1.value;
                    ExtendPropertyConfig.properties.push({ propertyID: g.parent.id, propertyName: g.parent.propertyTitle, propertyType: 'modal' });
                }
            }
            catch (e_5_1) { e_5 = { error: e_5_1 }; }
            finally {
                try {
                    if (groupList_1_1 && !groupList_1_1.done && (_c = groupList_1.return)) _c.call(groupList_1);
                }
                finally { if (e_5) throw e_5.error; }
            }
            this.setPropertyData(userAct, propertyData, groupList);
            return {
                propertyConfig: [basicProperty, performerProperty, formDef, approvalProperty, eventListeners, taskTimeliness, ApprovalSettings, ExtendPropertyConfig],
                propertyData: propertyData
            };
        }
        else {
            this.setPropertyData(userAct, propertyData, groupList);
            return {
                propertyConfig: [basicProperty, performerProperty, formDef, approvalProperty, eventListeners, taskTimeliness, ApprovalSettings],
                propertyData: propertyData
            };
        }
    };
    /**
     * 判断是否存在反向流程动作
     * @param conclusions
     */
    /**
     * 判断是否存在反向流程动作
     * @param {?} conclusions
     * @return {?}
     */
    UserActivityCell.prototype.isBackConclusionExist = /**
     * 判断是否存在反向流程动作
     * @param {?} conclusions
     * @return {?}
     */
    function (conclusions) {
        var e_6, _a;
        try {
            for (var conclusions_1 = __values(conclusions), conclusions_1_1 = conclusions_1.next(); !conclusions_1_1.done; conclusions_1_1 = conclusions_1.next()) {
                var conclusion = conclusions_1_1.value;
                if (conclusion.WorkFlowAction === WorkFlowAction.Backward) {
                    return true;
                }
            }
        }
        catch (e_6_1) { e_6 = { error: e_6_1 }; }
        finally {
            try {
                if (conclusions_1_1 && !conclusions_1_1.done && (_a = conclusions_1.return)) _a.call(conclusions_1);
            }
            finally { if (e_6) throw e_6.error; }
        }
        return false;
    };
    /**
     * 组织UserActivity的属性值propertyData
     * @param act
     * @param propertyData
     */
    /**
     * 组织UserActivity的属性值propertyData
     * @param {?} act
     * @param {?} propertyData
     * @param {?} groupList
     * @return {?}
     */
    UserActivityCell.prototype.setPropertyData = /**
     * 组织UserActivity的属性值propertyData
     * @param {?} act
     * @param {?} propertyData
     * @param {?} groupList
     * @return {?}
     */
    function (act, propertyData, groupList) {
        var e_7, _a;
        propertyData[UserActivityPropertyKeys.Id] = act.Id;
        propertyData[UserActivityPropertyKeys.ClrTypeID] = act.ClrTypeID;
        propertyData[UserActivityPropertyKeys.Name] = act.Name;
        propertyData[UserActivityPropertyKeys.NameLanguage] = act.NameLanguage || {
            "zh-CHS": act.Name,
        };
        //活动传递bizActivityId
        propertyData[UserActivityPropertyKeys.BizActivityID] = act.BizActivityID;
        // 变量设置+流程变量
        propertyData[UserActivityPropertyKeys.variableSettings] = PropertyHelper.getVariableSettings(act.Model, act.variableSettings);
        propertyData[UserActivityPropertyKeys.ParticipantSchemes] = this.getParticipantInfo(act);
        propertyData[UserActivityPropertyKeys.ParticipantOptions] = this.getParticipantOptions(act);
        // if (userAct.AssignmentStrategy === AssignmentStrategy.ASSIGN) {
        //     propertyData[UserActivityPropertyKeys.AssignPerformer] = this.getPotentialOwnerImpl(userAct);
        // }
        propertyData[UserActivityPropertyKeys.ApprovalItems] = act.Conclusions;
        propertyData[UserActivityPropertyKeys.Tools] = PropertyHelper.getBizComponentList((/** @type {?} */ (act.Tools)));
        propertyData[UserActivityPropertyKeys.wf_CustomizeAction] = act.customizeActions || [];
        propertyData[UserActivityPropertyKeys.AssignStrategy] = this.getAssignStrategy(act);
        propertyData[UserActivityPropertyKeys.Retrievable] = act.Retrievable;
        propertyData[UserActivityPropertyKeys.SelectBranch] = act.SelectBranch;
        propertyData[UserActivityPropertyKeys.AddSignFrontAble] = this.getSignFrontInfo(act);
        propertyData[UserActivityPropertyKeys.AddSignBehindAble] = this.getSignBehindInfo(act);
        propertyData[UserActivityPropertyKeys.transferScope] = this.getTransferScopeInfo(act);
        propertyData[UserActivityPropertyKeys.NotifyAble] = this.getNotifyAble(act);
        propertyData[UserActivityPropertyKeys.timeLimitControl] = this.getTimeLimitInfo(act);
        propertyData[UserActivityPropertyKeys.wf_TitleExpression] = act.taskTitle ? (act.taskTitle.valueLanguage ? act.taskTitle.valueLanguage : act.taskTitle.value) : '';
        propertyData[UserActivityPropertyKeys.anonymousSet] = {
            isAnonymity: act.anonymous,
            anonymous: act.anonymousText
        };
        propertyData[UserActivityPropertyKeys.messageNotice] = PropertyHelper.getMessageNotices(act.messageNotices);
        // 影像设置
        propertyData[UserActivityPropertyKeys.imageSettings] = act.imageSettings;
        propertyData[UserActivityPropertyKeys.wf_ExecuteForms_PC] =
            act.ExecuteForms ? act.ExecuteForms.find((/**
             * @param {?} e
             * @return {?}
             */
            function (e) { return e.TerminalType === 'PC'; })) : null;
        propertyData[UserActivityPropertyKeys.wf_ExecuteForms_Mobile] =
            act.ExecuteForms ? act.ExecuteForms.find((/**
             * @param {?} e
             * @return {?}
             */
            function (e) { return e.TerminalType === 'MOBILE'; })) : null;
        propertyData[UserActivityPropertyKeys.approvalPivotConfig] = act.approvalPivotConfig;
        propertyData[UserActivityPropertyKeys.DisplayTerminal] = act.DisplayTerminal ? act.DisplayTerminal : DisplayTerminal.ALL;
        propertyData[UserActivityPropertyKeys.urgeHandleRule] = this.getUrgeHandleRule(act);
        try {
            for (var groupList_2 = __values(groupList), groupList_2_1 = groupList_2.next(); !groupList_2_1.done; groupList_2_1 = groupList_2.next()) {
                var g = groupList_2_1.value;
                // 取回模型上的value值给到扩展属性组件里
                if (act.extendProperties && act.extendProperties.length > 0) {
                    g.childs.sort((/**
                     * @param {?} a
                     * @param {?} b
                     * @return {?}
                     */
                    function (a, b) {
                        return a.sortOrder - b.sortOrder;
                    })).forEach((/**
                     * @param {?} d
                     * @return {?}
                     */
                    function (d) {
                        act.extendProperties.forEach((/**
                         * @param {?} e
                         * @return {?}
                         */
                        function (e) {
                            if (e.key == d.code) {
                                d.value = e.value;
                            }
                        }));
                    }));
                }
                propertyData[g.parent.id] = g.childs;
            }
        }
        catch (e_7_1) { e_7 = { error: e_7_1 }; }
        finally {
            try {
                if (groupList_2_1 && !groupList_2_1.done && (_a = groupList_2.return)) _a.call(groupList_2);
            }
            finally { if (e_7) throw e_7.error; }
        }
        propertyData[UserActivityPropertyKeys.checkConditions] = this.getCheckConditions(act);
    };
    /**
     * @param {?} userActivity
     * @return {?}
     */
    UserActivityCell.prototype.getParticipantInfo = /**
     * @param {?} userActivity
     * @return {?}
     */
    function (userActivity) {
        /** @type {?} */
        var partiInfo = new ParticipantInfo$1();
        partiInfo.assignStrategy.assignStrategy = userActivity.AssignmentStrategy;
        /** @type {?} */
        var roles = (/** @type {?} */ (userActivity.GetResourceRoles().filter((/**
         * @param {?} role
         * @return {?}
         */
        function (role) { return role instanceof HumanPerformerImpl; }))));
        partiInfo.humanPerformerList = PropertyHelper.getPerformerList(roles);
        if (userActivity.AssignmentStrategy === AssignmentStrategy.ASSIGN) {
            if (userActivity.AssignPerformerConfig) {
                /** @type {?} */
                var assignConfig = new AssignConfig$2();
                assignConfig.operator = userActivity.AssignPerformerConfig.Operator;
                assignConfig.multiSelect = userActivity.AssignPerformerConfig.MultiSelect;
                assignConfig.necessary = userActivity.AssignPerformerConfig.Necessary;
                partiInfo.assignStrategy.assignConfig = assignConfig;
                partiInfo.isAllScope = userActivity.AssignPerformerConfig.AllowGlobalAssign;
            }
            /** @type {?} */
            var roles_1 = (/** @type {?} */ (userActivity.GetResourceRoles().filter((/**
             * @param {?} role
             * @return {?}
             */
            function (role) { return role instanceof PotentialOwnerImpl; }))));
            partiInfo.potentialOwnerList = PropertyHelper.getPerformerList(roles_1);
        }
        return partiInfo;
    };
    /**
     * @param {?} userActivity
     * @return {?}
     */
    UserActivityCell.prototype.getParticipantOptions = /**
     * @param {?} userActivity
     * @return {?}
     */
    function (userActivity) {
        /** @type {?} */
        var options = {};
        if (userActivity.ParticipantSetting != null) {
            options.ExclusionPerformers = userActivity.ParticipantSetting.ExclusionPerformers;
            options.NoPerformerStrategy = userActivity.ParticipantSetting.NoPerformerStrategy;
            options.HistoricFirst = userActivity.ParticipantSetting.HistoricFirst;
            options.automaticPerformers = userActivity.ParticipantSetting.automaticPerformers;
        }
        return options;
    };
    /**
     * @param {?} userActivity
     * @return {?}
     */
    UserActivityCell.prototype.getAssignStrategy = /**
     * @param {?} userActivity
     * @return {?}
     */
    function (userActivity) {
        /** @type {?} */
        var assignStrategy = new AssignStrategy$1();
        assignStrategy.assignStrategy = userActivity.AssignmentStrategy;
        if (userActivity.AssignPerformerConfig) {
            /** @type {?} */
            var assignConfig = new AssignConfig$2();
            assignConfig.operator = userActivity.AssignPerformerConfig.Operator;
            assignConfig.multiSelect = userActivity.AssignPerformerConfig.MultiSelect;
            assignConfig.necessary = userActivity.AssignPerformerConfig.Necessary;
            assignStrategy.assignConfig = assignConfig;
        }
        return assignStrategy;
    };
    /**
     * @param {?} userActivity
     * @return {?}
     */
    UserActivityCell.prototype.getSignFrontInfo = /**
     * @param {?} userActivity
     * @return {?}
     */
    function (userActivity) {
        /** @type {?} */
        var signFrontTest = new ActionOrganizationScopeDesign();
        signFrontTest.action = (/** @type {?} */ (ActionScope.AddSignFront));
        if (userActivity.AddSignFrontAble) {
            signFrontTest.enable = true;
            /** @type {?} */
            var roles = userActivity.dynamicParticipants.filter((/**
             * @param {?} r
             * @return {?}
             */
            function (r) { return r.actionScope === ActionScope.AddSignFront; }));
            /** @type {?} */
            var res = roles.find((/**
             * @param {?} r
             * @return {?}
             */
            function (r) { return ((/** @type {?} */ (r))).organizationLevel && !((/** @type {?} */ (r))).order; }));
            /** @type {?} */
            var list = [];
            if (res) {
                /** @type {?} */
                var organization = new OrganizationParticipant$1;
                organization.id = res.id;
                organization.type = res.ClrTypeID;
                organization.name = res.name;
                organization.actionScope = (/** @type {?} */ (res.actionScope));
                organization.organizationLevel = ((/** @type {?} */ (res))).organizationLevel;
                organization.organizationId = ((/** @type {?} */ (res))).organizationId;
                organization.organizationCode = ((/** @type {?} */ (res))).organizationCode;
                organization.organizationName = ((/** @type {?} */ (res))).organizationName;
                organization.includeChildren = ((/** @type {?} */ (res))).includeChildren;
                organization.parentsUntil = ((/** @type {?} */ (res))).parentsUntil;
                organization.tag = ((/** @type {?} */ (res))).tag;
                organization.order = 1;
                list.push(organization);
            }
            else {
                list = PropertyHelper.getPerformerListTest(roles);
            }
            signFrontTest.scope = new OrganizationPotentialOwner();
            if (list && list.length > 0) {
                signFrontTest.scope.participantInfo = new ParticipantInfo$1();
                signFrontTest.scope.participantInfo.potentialOwnerList = list;
                signFrontTest.scope.participantInfo.isAllScope = true;
            }
            else {
                signFrontTest.scope.participantInfo = new ParticipantInfo$1();
                signFrontTest.scope.participantInfo.isAllScope = false;
            }
        }
        else {
            signFrontTest.enable = false;
        }
        return signFrontTest;
    };
    /**
     * @param {?} userActivity
     * @return {?}
     */
    UserActivityCell.prototype.getSignBehindInfo = /**
     * @param {?} userActivity
     * @return {?}
     */
    function (userActivity) {
        /** @type {?} */
        var signBehindTest = new ActionOrganizationScopeDesign();
        signBehindTest.action = (/** @type {?} */ (ActionScope.AddSignBehind));
        if (userActivity.AddSignBehindAble) {
            signBehindTest.enable = true;
            /** @type {?} */
            var roles = userActivity.dynamicParticipants.filter((/**
             * @param {?} r
             * @return {?}
             */
            function (r) { return r.actionScope === ActionScope.AddSignBehind; }));
            /** @type {?} */
            var res = roles.find((/**
             * @param {?} r
             * @return {?}
             */
            function (r) { return ((/** @type {?} */ (r))).organizationLevel && !((/** @type {?} */ (r))).order; }));
            /** @type {?} */
            var list = [];
            if (res) {
                /** @type {?} */
                var organization = new OrganizationParticipant$1;
                organization.id = res.id;
                organization.type = res.ClrTypeID;
                organization.name = res.name;
                organization.actionScope = (/** @type {?} */ (res.actionScope));
                organization.organizationLevel = ((/** @type {?} */ (res))).organizationLevel;
                organization.organizationId = ((/** @type {?} */ (res))).organizationId;
                organization.organizationCode = ((/** @type {?} */ (res))).organizationCode;
                organization.organizationName = ((/** @type {?} */ (res))).organizationName;
                organization.includeChildren = ((/** @type {?} */ (res))).includeChildren;
                organization.parentsUntil = ((/** @type {?} */ (res))).parentsUntil;
                organization.tag = ((/** @type {?} */ (res))).tag;
                organization.order = 1;
                list.push(organization);
            }
            else {
                list = PropertyHelper.getPerformerListTest(roles);
            }
            signBehindTest.scope = new OrganizationPotentialOwner();
            if (list && list.length > 0) {
                signBehindTest.scope.participantInfo = new ParticipantInfo$1();
                signBehindTest.scope.participantInfo.potentialOwnerList = list;
                signBehindTest.scope.participantInfo.isAllScope = true;
            }
            else {
                signBehindTest.scope.participantInfo = new ParticipantInfo$1();
                signBehindTest.scope.participantInfo.isAllScope = false;
            }
        }
        else {
            signBehindTest.enable = false;
        }
        return signBehindTest;
    };
    /**
     * @param {?} userActivity
     * @return {?}
     */
    UserActivityCell.prototype.getTransferScopeInfo = /**
     * @param {?} userActivity
     * @return {?}
     */
    function (userActivity) {
        /** @type {?} */
        var transferScopeTest = new ActionOrganizationScopeDesign();
        transferScopeTest.action = (/** @type {?} */ (ActionScope.Transfer));
        if (userActivity.transferAble) {
            transferScopeTest.enable = true;
            /** @type {?} */
            var roles = userActivity.dynamicParticipants.filter((/**
             * @param {?} r
             * @return {?}
             */
            function (r) { return r.actionScope === ActionScope.Transfer; }));
            /** @type {?} */
            var res = roles.find((/**
             * @param {?} r
             * @return {?}
             */
            function (r) { return ((/** @type {?} */ (r))).organizationLevel && !((/** @type {?} */ (r))).order; }));
            /** @type {?} */
            var list = [];
            if (res) {
                /** @type {?} */
                var organization = new OrganizationParticipant$1;
                organization.id = res.id;
                organization.type = res.ClrTypeID;
                organization.name = res.name;
                organization.actionScope = (/** @type {?} */ (res.actionScope));
                organization.organizationLevel = ((/** @type {?} */ (res))).organizationLevel;
                organization.organizationId = ((/** @type {?} */ (res))).organizationId;
                organization.organizationCode = ((/** @type {?} */ (res))).organizationCode;
                organization.organizationName = ((/** @type {?} */ (res))).organizationName;
                organization.includeChildren = ((/** @type {?} */ (res))).includeChildren;
                organization.parentsUntil = ((/** @type {?} */ (res))).parentsUntil;
                organization.tag = ((/** @type {?} */ (res))).tag;
                organization.order = 1;
                list.push(organization);
            }
            else {
                list = PropertyHelper.getPerformerListTest(roles);
            }
            transferScopeTest.scope = new OrganizationPotentialOwner();
            if (list && list.length > 0) {
                transferScopeTest.scope.participantInfo = new ParticipantInfo$1();
                transferScopeTest.scope.participantInfo.potentialOwnerList = list;
                transferScopeTest.scope.participantInfo.isAllScope = true;
            }
            else {
                transferScopeTest.scope.participantInfo = new ParticipantInfo$1();
                transferScopeTest.scope.participantInfo.isAllScope = false;
            }
        }
        else {
            transferScopeTest.enable = userActivity.transferAble;
        }
        return transferScopeTest;
    };
    /**
     * @param {?} userActivity
     * @return {?}
     */
    UserActivityCell.prototype.getNotifyAble = /**
     * @param {?} userActivity
     * @return {?}
     */
    function (userActivity) {
        /** @type {?} */
        var notifyScopeTest = new ActionOrganizationScopeDesign();
        notifyScopeTest.action = (/** @type {?} */ (ActionScope.Notify));
        if (userActivity.NotifyAble) {
            notifyScopeTest.enable = true;
            /** @type {?} */
            var roles = userActivity.dynamicParticipants.filter((/**
             * @param {?} r
             * @return {?}
             */
            function (r) { return r.actionScope === ActionScope.Notify; }));
            /** @type {?} */
            var res = roles.find((/**
             * @param {?} r
             * @return {?}
             */
            function (r) { return ((/** @type {?} */ (r))).organizationLevel && !((/** @type {?} */ (r))).order; }));
            /** @type {?} */
            var list = [];
            if (res) {
                /** @type {?} */
                var organization = new OrganizationParticipant$1;
                organization.id = res.id;
                organization.type = res.ClrTypeID;
                organization.name = res.name;
                organization.actionScope = (/** @type {?} */ (res.actionScope));
                organization.organizationLevel = ((/** @type {?} */ (res))).organizationLevel;
                organization.organizationId = ((/** @type {?} */ (res))).organizationId;
                organization.organizationCode = ((/** @type {?} */ (res))).organizationCode;
                organization.organizationName = ((/** @type {?} */ (res))).organizationName;
                organization.includeChildren = ((/** @type {?} */ (res))).includeChildren;
                organization.parentsUntil = ((/** @type {?} */ (res))).parentsUntil;
                organization.tag = ((/** @type {?} */ (res))).tag;
                organization.order = 1;
                list.push(organization);
            }
            else {
                list = PropertyHelper.getPerformerListTest(roles);
            }
            notifyScopeTest.scope = new OrganizationPotentialOwner();
            if (list && list.length > 0) {
                notifyScopeTest.scope.participantInfo = new ParticipantInfo$1();
                notifyScopeTest.scope.participantInfo.potentialOwnerList = list;
                notifyScopeTest.scope.participantInfo.isAllScope = true;
            }
            else {
                notifyScopeTest.scope.participantInfo = new ParticipantInfo$1();
                notifyScopeTest.scope.participantInfo.isAllScope = false;
            }
        }
        else {
            notifyScopeTest.enable = userActivity.NotifyAble;
        }
        return notifyScopeTest;
    };
    /**
     * @param {?} userActivity
     * @return {?}
     */
    UserActivityCell.prototype.getTimeLimitInfo = /**
     * @param {?} userActivity
     * @return {?}
     */
    function (userActivity) {
        var e_8, _a, e_9, _b;
        if (userActivity.timeLimitControl) {
            /** @type {?} */
            var timeLimit = new TimeLimitControlInfo();
            timeLimit.enable = userActivity.timeLimitControl.enable;
            timeLimit.tag = userActivity.timeLimitControl.tag;
            timeLimit.dueTime = userActivity.timeLimitControl.dueTime;
            timeLimit.timeUnit = userActivity.timeLimitControl.timeUnit;
            timeLimit.expireOperations = new Array();
            if (userActivity.timeLimitControl.expireOperations && userActivity.timeLimitControl.expireOperations.length > 0) {
                /** @type {?} */
                var operations = userActivity.timeLimitControl.expireOperations;
                try {
                    for (var operations_1 = __values(operations), operations_1_1 = operations_1.next(); !operations_1_1.done; operations_1_1 = operations_1.next()) {
                        var o = operations_1_1.value;
                        if (o.ClrTypeID.indexOf('SendMessageExpireOperation') > 0) {
                            /** @type {?} */
                            var operation = (/** @type {?} */ (o));
                            /** @type {?} */
                            var sendMessage = new SendMessageExpireOperationInfo();
                            sendMessage.timeDuration = operation.timeDuration;
                            sendMessage.durationType = operation.durationType;
                            sendMessage.timeUnit = operation.timeUnit;
                            sendMessage.message = operation.message;
                            sendMessage.sendType = operation.sendType;
                            sendMessage.subject = operation.subject;
                            sendMessage.id = operation.id;
                            sendMessage.receiver = operation.receiver;
                            sendMessage.cycleEnable = operation.cycleEnable;
                            sendMessage.cycleTime = operation.cycleTime;
                            sendMessage.cycleTimeUnit = operation.cycleTimeUnit;
                            sendMessage.operationTypeName = operation.operationTypeName ? operation.operationTypeName : 'SendMessageExpireOperation';
                            if (operation.smsMessageTemplate) {
                                /** @type {?} */
                                var smsTemplate = new Object;
                                smsTemplate.code = operation.smsMessageTemplate.code;
                                smsTemplate.content = operation.smsMessageTemplate.content;
                                smsTemplate.smsMessageVariables = new Array();
                                if (operation.smsMessageTemplate.smsMessageVariables && operation.smsMessageTemplate.smsMessageVariables.length > 0) {
                                    try {
                                        for (var _c = __values(operation.smsMessageTemplate.smsMessageVariables), _d = _c.next(); !_d.done; _d = _c.next()) {
                                            var v = _d.value;
                                            /** @type {?} */
                                            var variable = new Object;
                                            variable.id = WfDesignerUtils.createNM();
                                            variable.code = v.code;
                                            variable.value = v.value;
                                            variable.tag = v.tag;
                                            smsTemplate.smsMessageVariables.push(variable);
                                        }
                                    }
                                    catch (e_9_1) { e_9 = { error: e_9_1 }; }
                                    finally {
                                        try {
                                            if (_d && !_d.done && (_b = _c.return)) _b.call(_c);
                                        }
                                        finally { if (e_9) throw e_9.error; }
                                    }
                                }
                                sendMessage.smsMessageTemplate = smsTemplate;
                            }
                            timeLimit.expireOperations.push(sendMessage);
                        }
                        else if (o.ClrTypeID.indexOf('AutoHandleExpireOperation') > 0) {
                            /** @type {?} */
                            var operation = (/** @type {?} */ (o));
                            /** @type {?} */
                            var autoHandle = new AutoHandleExpireOperationInfo();
                            autoHandle.id = operation.id;
                            autoHandle.durationType = operation.durationType;
                            autoHandle.timeDuration = operation.timeDuration;
                            autoHandle.timeUnit = operation.timeUnit;
                            autoHandle.operationTypeName = operation.operationTypeName ? operation.operationTypeName : 'AutoHandleExpireOperation';
                            autoHandle.autoHandleType = operation.autoHandleType;
                            autoHandle.message = operation.message;
                            timeLimit.expireOperations.push(autoHandle);
                        }
                    }
                }
                catch (e_8_1) { e_8 = { error: e_8_1 }; }
                finally {
                    try {
                        if (operations_1_1 && !operations_1_1.done && (_a = operations_1.return)) _a.call(operations_1);
                    }
                    finally { if (e_8) throw e_8.error; }
                }
            }
            return timeLimit;
        }
        return null;
    };
    /**
     * @param {?} userActivity
     * @return {?}
     */
    UserActivityCell.prototype.getUrgeHandleRule = /**
     * @param {?} userActivity
     * @return {?}
     */
    function (userActivity) {
        var e_10, _a;
        if (!userActivity.urgeHandleRule) {
            return null;
        }
        /** @type {?} */
        var rule = userActivity.urgeHandleRule;
        /** @type {?} */
        var urgeHandleRule = {
            urgeHandleAble: rule.urgeHandleAble,
            sendType: rule.sendType,
            earlyTime: rule.earlyTime,
            intervalTime: rule.intervalTime,
            urgeMessageSubject: rule.urgeMessageSubject,
            urgeMessageContent: rule.urgeMessageContent,
            addReminder: rule.addReminder,
            subjectEditable: rule.subjectEditable,
            contentEditable: rule.contentEditable
        };
        if (rule.smsMessageTemplate) {
            /** @type {?} */
            var smsTemplate = new Object;
            smsTemplate.code = rule.smsMessageTemplate.code;
            smsTemplate.content = rule.smsMessageTemplate.content;
            smsTemplate.smsMessageVariables = new Array();
            if (rule.smsMessageTemplate.smsMessageVariables && rule.smsMessageTemplate.smsMessageVariables.length > 0) {
                try {
                    for (var _b = __values(rule.smsMessageTemplate.smsMessageVariables), _c = _b.next(); !_c.done; _c = _b.next()) {
                        var v = _c.value;
                        /** @type {?} */
                        var variable = new Object;
                        variable.id = WfDesignerUtils.createNM();
                        variable.code = v.code;
                        variable.value = v.value;
                        variable.tag = v.tag;
                        smsTemplate.smsMessageVariables.push(variable);
                    }
                }
                catch (e_10_1) { e_10 = { error: e_10_1 }; }
                finally {
                    try {
                        if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                    }
                    finally { if (e_10) throw e_10.error; }
                }
            }
            urgeHandleRule.smsMessageTemplate = smsTemplate;
        }
        return urgeHandleRule;
    };
    /**
     * @param {?} userActivity
     * @return {?}
     */
    UserActivityCell.prototype.getCheckConditions = /**
     * @param {?} userActivity
     * @return {?}
     */
    function (userActivity) {
        if (userActivity.checkConditions && userActivity.checkConditions.length > 0) {
            return userActivity.checkConditions.map((/**
             * @param {?} c
             * @return {?}
             */
            function (c) { return ({
                value: c.value,
                checkTime: c.checkTime,
                errorTips: c.errorTips ? Array.from(c.errorTips).reduce((/**
                 * @param {?} obj
                 * @param {?} __1
                 * @return {?}
                 */
                function (obj, _a) {
                    var _b = __read(_a, 2), key = _b[0], value = _b[1];
                    var _c;
                    return Object.assign(obj, (_c = {}, _c[key] = value, _c));
                }), {}) : null
            }); }));
        }
        return null;
    };
    /**
     * @param {?} obj
     * @return {?}
     */
    UserActivityCell.prototype.updateProps = /**
     * @param {?} obj
     * @return {?}
     */
    function (obj) {
        this.updatePropsByIsOperation(obj);
    };
    /**
     * @param {?} obj
     * @param {?=} isOperation
     * @return {?}
     */
    UserActivityCell.prototype.updatePropsByIsOperation = /**
     * @param {?} obj
     * @param {?=} isOperation
     * @return {?}
     */
    function (obj, isOperation) {
        if (isOperation === void 0) { isOperation = false; }
        /** @type {?} */
        var editorUi = this.editorUi;
        /** @type {?} */
        var userActivity = this.flowElement;
        /** @type {?} */
        var propertyId = obj.propertyID;
        switch (propertyId) {
            case UserActivityPropertyKeys.ParticipantSchemes: // 参与者属性
                this.updateParticipant(userActivity, obj, isOperation);
                break;
            case UserActivityPropertyKeys.ParticipantOptions: // 参与者选项
                this.updateParticipantOptions(userActivity, obj);
                break;
            // case UserActivityPropertyKeys.AssignPerformer:
            //     this.updatePotentialOwnerImpl(graph.bpmnModel, userActivity, obj);
            //     break;
            // case UserActivityPropertyKeys.AssignStrategy:
            //     this.updateAssignStrategy(graph, userActivity, obj, isOperation);
            //     break;
            // case UserActivityPropertyKeys.OperatorConfig:
            //     this.updateOperatorConfig(userActivity, obj);
            //     break;
            case UserActivityPropertyKeys.CompleteStrategy:
                this.resetExecuteWorkItemMode(userActivity, obj, isOperation);
                break;
            case UserActivityPropertyKeys.DisplayTerminal:
                this.resetDisplayTerminal(userActivity, obj);
                break;
            case UserActivityPropertyKeys.SignRule:
                this.resetSignRules(userActivity, obj, isOperation);
                break;
            case UserActivityPropertyKeys.ApprovalItems:
                this.resetApprovalItems(userActivity, obj, isOperation);
                break;
            case UserActivityPropertyKeys.wf_ExecuteForms_PC:
                this.resetExecuteForm(userActivity, obj, 'PC');
                if (obj.parameters && obj.parameters.length > 0) {
                    PropertyHelper.updateFormalParameters(editorUi.graph.bpmnModel.DefaultProcess, obj.parameters);
                }
                break;
            case UserActivityPropertyKeys.wf_ExecuteForms_Mobile:
                this.resetExecuteForm(userActivity, obj, 'MOBILE');
                if (obj.parameters && obj.parameters.length > 0) {
                    PropertyHelper.updateFormalParameters(editorUi.graph.bpmnModel.DefaultProcess, obj.parameters);
                }
                break;
            case UserActivityPropertyKeys.SelectTargetAble:
                this.resetSelectTargetAble(userActivity, obj, isOperation);
                break;
            case UserActivityPropertyKeys.JumpScope:
                this.resetJumpScope(userActivity, obj);
                break;
            case UserActivityPropertyKeys.BackWardRule:
                this.resetBackWardRule(userActivity, obj);
                break;
            case UserActivityPropertyKeys.MultiInstanceLoopCharacteristics:
                this.resetMultiInstanceLoopCharacteristics(userActivity, obj);
                break;
            case UserActivityPropertyKeys.Tools:
                this.resetTools(userActivity, obj);
                break;
            case UserActivityPropertyKeys.wf_TitleExpression:
                this.modifyTitleExpression(userActivity, obj);
                break;
            case UserActivityPropertyKeys.AddSignFrontAble:
                this.updateSignFrontSet(userActivity, obj);
                break;
            case UserActivityPropertyKeys.AddSignBehindAble:
                this.updateSignBehindsSet(userActivity, obj);
                break;
            case UserActivityPropertyKeys.NotifyAble:
                this.updateNotifySet(userActivity, obj);
                break;
            case UserActivityPropertyKeys.transferScope:
                this.updateTransferScope(userActivity, obj);
                break;
            case UserActivityPropertyKeys.wf_CustomizeAction:
                this.updateCustomizeActions(userActivity, obj);
                break;
            case UserActivityPropertyKeys.timeLimitControl:
                this.updateTimeLimitControl(userActivity, obj);
                break;
            case UserActivityPropertyKeys.anonymousSet:
                this.updateAnonymousSet(userActivity, obj);
                break;
            case UserActivityPropertyKeys.variableSettings:
                this.updateVariableSettings(userActivity, obj);
                break;
            case UserActivityPropertyKeys.messageNotice:
                this.updateMessageNotices(userActivity, obj);
                break;
            case UserActivityPropertyKeys.approvalPivotConfig:
                this.updateApprovalPivotConfig(userActivity, obj);
                break;
            case UserActivityPropertyKeys.urgeHandleRule:
                this.updateUrgeHandleRule(userActivity, obj);
                break;
            case UserActivityPropertyKeys.imageSettings: // 更新变量设置属性
                this.updateImageSettings(userActivity, obj);
                break;
            case UserActivityPropertyKeys.checkConditions:
                this.updateCheckConditions(userActivity, obj, isOperation);
                break;
            case UserActivityPropertyKeys.otherAssignActivities:
                this.updateOtherAssignActivities(userActivity, obj);
                break;
            case UserActivityPropertyKeys.otherAssignActivityNodeInfos:
                this.updateOtherAssignActivities(userActivity, obj);
                break;
            case UserActivityPropertyKeys.otherAssignNodes:
                this.updateOtherAssignNodes(userActivity, obj);
                break;
            default:
                // 判断ResourceKeys是不是groupid,是就走resetExtendProperty
                if (editorUi.procExtProps.findIndex((/**
                 * @param {?} p
                 * @return {?}
                 */
                function (p) { return p.id === propertyId; })) > -1) {
                    this.resetExtendProperty(userActivity, obj);
                }
                else {
                    _super.prototype.updateProps.call(this, obj);
                }
                break;
        }
    };
    /**
     * 修改参与者
     * @param graph
     * @param userActivity
     * @param obj
     * @param isOperation
     */
    /**
     * 修改参与者
     * @param {?} userActivity
     * @param {?} obj
     * @param {?=} isOperation
     * @return {?}
     */
    UserActivityCell.prototype.updateParticipant = /**
     * 修改参与者
     * @param {?} userActivity
     * @param {?} obj
     * @param {?=} isOperation
     * @return {?}
     */
    function (userActivity, obj, isOperation) {
        if (isOperation === void 0) { isOperation = false; }
        var e_11, _a, e_12, _b;
        /** @type {?} */
        var performerInfo = obj.propertyValue;
        if (performerInfo.assignStrategy.assignStrategy === AssignmentStrategy.CLAIM
            && userActivity.ParticipantSetting
            && userActivity.ParticipantSetting.automaticPerformers
            && userActivity.ParticipantSetting.automaticPerformers.length > 0) ;
        else {
            this.checkOtherAssignNodes(userActivity, performerInfo);
            userActivity.AssignPerformerConfig = null;
            userActivity.AssignmentStrategy = performerInfo.assignStrategy.assignStrategy;
            /** @type {?} */
            var resourceRoles = userActivity.GetResourceRoles();
            if (resourceRoles && resourceRoles.length > 0) {
                resourceRoles.forEach((/**
                 * @param {?} r
                 * @return {?}
                 */
                function (r) {
                    if (r instanceof HumanPerformerImpl) {
                        userActivity.RemoveResourceRole(r.Id);
                    }
                    else if (r instanceof PotentialOwnerImpl) {
                        userActivity.RemoveResourceRole(r.Id);
                    }
                }));
            }
            if (performerInfo.humanPerformerList && performerInfo.humanPerformerList.length > 0) {
                try {
                    for (var _c = __values(performerInfo.humanPerformerList), _d = _c.next(); !_d.done; _d = _c.next()) {
                        var humanPerformer = _d.value;
                        switch (humanPerformer.type) {
                            case UserParticipantExpression.Clr_Type_ID:
                                this.addUserParticipant(userActivity, (/** @type {?} */ (humanPerformer)), 'humanPerformer', null);
                                break;
                            case VariableParticipantExpression.Clr_Type_ID:
                                this.addVariableParticipant(userActivity, (/** @type {?} */ (humanPerformer)), 'humanPerformer', null);
                                break;
                            case PositionParticipantExpression.Clr_Type_ID:
                                this.addPositionParticipant(userActivity, (/** @type {?} */ (humanPerformer)), 'humanPerformer', null);
                                break;
                            case ComponentParticipantExpression.Clr_Type_ID:
                                this.addComponentParticipant(userActivity, (/** @type {?} */ (humanPerformer)), 'humanPerformer', null);
                                break;
                            case ReportingLineParticipantExpression.Clr_Type_ID:
                                this.addReportingLineParticipant(userActivity, (/** @type {?} */ (humanPerformer)), 'humanPerformer', null);
                                break;
                            case ActivityExecutorParticipantExpression.Clr_Type_ID:
                                this.addActivityExecutorParticipant(userActivity, (/** @type {?} */ (humanPerformer)), 'humanPerformer', null);
                                break;
                            case MatrixParticipantExpression.Clr_Type_ID:
                                this.addMatrixParticipant(userActivity, (/** @type {?} */ (humanPerformer)), 'humanPerformer', null);
                                break;
                        }
                    }
                }
                catch (e_11_1) { e_11 = { error: e_11_1 }; }
                finally {
                    try {
                        if (_d && !_d.done && (_a = _c.return)) _a.call(_c);
                    }
                    finally { if (e_11) throw e_11.error; }
                }
            }
            if (performerInfo.assignStrategy.assignStrategy === AssignmentStrategy.ASSIGN) {
                /** @type {?} */
                var assignPerformerConfig = new AssignPerformerConfig(userActivity.Model);
                assignPerformerConfig.Operator = performerInfo.assignStrategy.assignConfig.operator;
                assignPerformerConfig.MultiSelect = performerInfo.assignStrategy.assignConfig.multiSelect;
                assignPerformerConfig.Necessary = performerInfo.assignStrategy.assignConfig.necessary;
                assignPerformerConfig.AllowGlobalAssign = performerInfo.isAllScope;
                userActivity.AssignPerformerConfig = assignPerformerConfig;
                if (!performerInfo.isAllScope && performerInfo.potentialOwnerList && performerInfo.potentialOwnerList.length > 0) {
                    try {
                        for (var _e = __values(performerInfo.potentialOwnerList), _f = _e.next(); !_f.done; _f = _e.next()) {
                            var potentialOwner = _f.value;
                            switch (potentialOwner.type) {
                                case UserParticipantExpression.Clr_Type_ID:
                                    this.addUserParticipant(userActivity, (/** @type {?} */ (potentialOwner)), 'potentialOwner', null);
                                    break;
                                case VariableParticipantExpression.Clr_Type_ID:
                                    this.addVariableParticipant(userActivity, (/** @type {?} */ (potentialOwner)), 'potentialOwner', null);
                                    break;
                                case PositionParticipantExpression.Clr_Type_ID:
                                    this.addPositionParticipant(userActivity, (/** @type {?} */ (potentialOwner)), 'potentialOwner', null);
                                    break;
                                case ComponentParticipantExpression.Clr_Type_ID:
                                    this.addComponentParticipant(userActivity, (/** @type {?} */ (potentialOwner)), 'potentialOwner', null);
                                    break;
                                case ReportingLineParticipantExpression.Clr_Type_ID:
                                    this.addReportingLineParticipant(userActivity, (/** @type {?} */ (potentialOwner)), 'potentialOwner', null);
                                    break;
                                case ActivityExecutorParticipantExpression.Clr_Type_ID:
                                    this.addActivityExecutorParticipant(userActivity, (/** @type {?} */ (potentialOwner)), 'potentialOwner', null);
                                    break;
                                case MatrixParticipantExpression.Clr_Type_ID:
                                    this.addMatrixParticipant(userActivity, (/** @type {?} */ (potentialOwner)), 'potentialOwner', null);
                                    break;
                                case OrganizationParticipantExpression.Clr_Type_ID:
                                    this.addOrganizationParticipant(userActivity, (/** @type {?} */ (potentialOwner)), 'potentialOwner', null);
                                    break;
                            }
                        }
                    }
                    catch (e_12_1) { e_12 = { error: e_12_1 }; }
                    finally {
                        try {
                            if (_f && !_f.done && (_b = _e.return)) _b.call(_e);
                        }
                        finally { if (e_12) throw e_12.error; }
                    }
                }
            }
            // 分配策略为领用时，完成策略自动修改为抢占模式
            if (userActivity.AssignmentStrategy === AssignmentStrategy.CLAIM) {
                userActivity.ExecuteWorkItemMode = ExecuteWorkItemMode.Preempt;
                userActivity.CounterSignRules = null;
            }
        }
    };
    /**
     * @param {?} userActivity
     * @param {?} performerInfo
     * @return {?}
     */
    UserActivityCell.prototype.checkOtherAssignNodes = /**
     * @param {?} userActivity
     * @param {?} performerInfo
     * @return {?}
     */
    function (userActivity, performerInfo) {
        if (userActivity.AssignmentStrategy !== AssignmentStrategy.ASSIGN) {
            return;
        }
        /** @type {?} */
        var bpmnModel = userActivity.Model;
        /** @type {?} */
        var flowElements = bpmnModel.DefaultProcess.GetFlowElements();
        if (performerInfo.assignStrategy.assignStrategy !== AssignmentStrategy.ASSIGN) {
            for (var k in flowElements) {
                if (flowElements[k] instanceof UserActivity) {
                    /** @type {?} */
                    var activity = (/** @type {?} */ (flowElements[k]));
                    if (activity.otherAssignNodes && activity.otherAssignNodes.otherAssignActivities
                        && activity.otherAssignNodes.otherAssignActivities.length > 0
                        && activity.otherAssignNodes.otherAssignActivities.findIndex((/**
                         * @param {?} id
                         * @return {?}
                         */
                        function (id) { return id === userActivity.Id; })) > -1) {
                        activity.otherAssignNodes.otherAssignActivities = activity.otherAssignNodes.otherAssignActivities.filter((/**
                         * @param {?} id
                         * @return {?}
                         */
                        function (id) { return id !== userActivity.Id; }));
                    }
                }
                else if (flowElements[k] instanceof OperationActivity) {
                    /** @type {?} */
                    var operationActivity = (/** @type {?} */ (flowElements[k]));
                    if (operationActivity.otherAssignNodes && operationActivity.otherAssignNodes.otherAssignActivities
                        && operationActivity.otherAssignNodes.otherAssignActivities.length > 0
                        && operationActivity.otherAssignNodes.otherAssignActivities.findIndex((/**
                         * @param {?} id
                         * @return {?}
                         */
                        function (id) { return id === userActivity.Id; })) > -1) {
                        operationActivity.otherAssignNodes.otherAssignActivities = operationActivity.otherAssignNodes.otherAssignActivities.filter((/**
                         * @param {?} id
                         * @return {?}
                         */
                        function (id) { return id !== userActivity.Id; }));
                    }
                }
                else if (flowElements[k] instanceof StartActivity) {
                    /** @type {?} */
                    var startActivity = (/** @type {?} */ (flowElements[k]));
                    if (startActivity.otherAssignNodes && startActivity.otherAssignNodes.otherAssignActivities
                        && startActivity.otherAssignNodes.otherAssignActivities.length > 0
                        && startActivity.otherAssignNodes.otherAssignActivities.findIndex((/**
                         * @param {?} id
                         * @return {?}
                         */
                        function (id) { return id === userActivity.Id; })) > -1) {
                        startActivity.otherAssignNodes.otherAssignActivities = startActivity.otherAssignNodes.otherAssignActivities.filter((/**
                         * @param {?} id
                         * @return {?}
                         */
                        function (id) { return id !== userActivity.Id; }));
                    }
                }
            }
        }
        else {
            if (userActivity.AssignPerformerConfig.Operator === 'currentUser'
                && performerInfo.assignStrategy.assignConfig.operator !== 'currentUser') {
                for (var k in flowElements) {
                    if (flowElements[k] instanceof UserActivity) {
                        /** @type {?} */
                        var activity = (/** @type {?} */ (flowElements[k]));
                        if (activity.otherAssignNodes && activity.otherAssignNodes.otherAssignActivities
                            && activity.otherAssignNodes.otherAssignActivities.length > 0
                            && activity.otherAssignNodes.otherAssignActivities.findIndex((/**
                             * @param {?} id
                             * @return {?}
                             */
                            function (id) { return id === userActivity.Id; })) > -1) {
                            activity.otherAssignNodes.otherAssignActivities = activity.otherAssignNodes.otherAssignActivities.filter((/**
                             * @param {?} id
                             * @return {?}
                             */
                            function (id) { return id !== userActivity.Id; }));
                        }
                    }
                    else if (flowElements[k] instanceof OperationActivity) {
                        /** @type {?} */
                        var operationActivity = (/** @type {?} */ (flowElements[k]));
                        if (operationActivity.otherAssignNodes && operationActivity.otherAssignNodes.otherAssignActivities
                            && operationActivity.otherAssignNodes.otherAssignActivities.length > 0
                            && operationActivity.otherAssignNodes.otherAssignActivities.findIndex((/**
                             * @param {?} id
                             * @return {?}
                             */
                            function (id) { return id === userActivity.Id; })) > -1) {
                            operationActivity.otherAssignNodes.otherAssignActivities = operationActivity.otherAssignNodes.otherAssignActivities.filter((/**
                             * @param {?} id
                             * @return {?}
                             */
                            function (id) { return id !== userActivity.Id; }));
                        }
                    }
                }
            }
            else if (userActivity.AssignPerformerConfig.Operator === 'procInstCreator'
                && performerInfo.assignStrategy.assignConfig.operator !== 'procInstCreator') {
                for (var k in flowElements) {
                    if (flowElements[k] instanceof StartActivity) {
                        /** @type {?} */
                        var startActivity = (/** @type {?} */ (flowElements[k]));
                        if (startActivity.otherAssignNodes && startActivity.otherAssignNodes.otherAssignActivities
                            && startActivity.otherAssignNodes.otherAssignActivities.length > 0
                            && startActivity.otherAssignNodes.otherAssignActivities.findIndex((/**
                             * @param {?} id
                             * @return {?}
                             */
                            function (id) { return id === userActivity.Id; })) > -1) {
                            startActivity.otherAssignNodes.otherAssignActivities = startActivity.otherAssignNodes.otherAssignActivities.filter((/**
                             * @param {?} id
                             * @return {?}
                             */
                            function (id) { return id !== userActivity.Id; }));
                        }
                    }
                }
            }
        }
    };
    /**
     * 添加用户参与者
     * @param userActivity
     * @param performer
     * @param type
     */
    /**
     * 添加用户参与者
     * @param {?} userActivity
     * @param {?} performer
     * @param {?} type
     * @param {?} scope
     * @return {?}
     */
    UserActivityCell.prototype.addUserParticipant = /**
     * 添加用户参与者
     * @param {?} userActivity
     * @param {?} performer
     * @param {?} type
     * @param {?} scope
     * @return {?}
     */
    function (userActivity, performer, type, scope) {
        /** @type {?} */
        var userParticipant;
        if (performer instanceof UserParticipantExpression) {
            userParticipant = performer;
        }
        else {
            performer = (/** @type {?} */ (performer));
            userParticipant = new UserParticipantExpression(userActivity.Model, performer.performerId, performer.performerName, performer.orgType);
            userParticipant.id = performer.id;
            userParticipant.OrgId = performer.orgId;
            userParticipant.actionScope = ActionScope.Default;
            userParticipant.OrgName = performer.orgName;
            userParticipant.Tag = performer.tag;
            userParticipant.OrgType = performer.orgType;
            userParticipant.order = performer.order;
            if (performer.condition) {
                /** @type {?} */
                var condition = new Condition(userActivity.Model);
                condition.Value = performer.condition;
                userParticipant.condition = condition;
            }
        }
        if (type === 'humanPerformer') {
            /** @type {?} */
            var humanPerformerImpl = new HumanPerformerImpl(userActivity.Model);
            humanPerformerImpl.participantExpression = userParticipant;
            if (performer.condition) {
                /** @type {?} */
                var condition = new Condition(userActivity.Model);
                condition.Value = performer.condition;
                humanPerformerImpl.condition = condition;
            }
            humanPerformerImpl.order = performer.order;
            userActivity.AddResourceRole(humanPerformerImpl);
        }
        else if (type === 'potentialOwner') {
            /** @type {?} */
            var otentialOwnerImpl = new PotentialOwnerImpl(userActivity.Model);
            otentialOwnerImpl.participantExpression = userParticipant;
            if (performer.condition) {
                /** @type {?} */
                var condition = new Condition(userActivity.Model);
                condition.Value = performer.condition;
                otentialOwnerImpl.condition = condition;
            }
            otentialOwnerImpl.order = performer.order;
            if (scope) {
                userParticipant.actionScope = scope;
                userActivity.dynamicParticipants.push(userParticipant);
            }
            else {
                userActivity.AddResourceRole(otentialOwnerImpl);
            }
        }
    };
    /**
     * 添加变量参与者
     * @param userActivity
     * @param performer
     * @param type
     */
    /**
     * 添加变量参与者
     * @param {?} userActivity
     * @param {?} performer
     * @param {?} type
     * @param {?} scope
     * @return {?}
     */
    UserActivityCell.prototype.addVariableParticipant = /**
     * 添加变量参与者
     * @param {?} userActivity
     * @param {?} performer
     * @param {?} type
     * @param {?} scope
     * @return {?}
     */
    function (userActivity, performer, type, scope) {
        /** @type {?} */
        var variablePerformer;
        if (performer instanceof VariableParticipantExpression) {
            variablePerformer = performer;
        }
        else {
            performer = (/** @type {?} */ (performer));
            variablePerformer = new VariableParticipantExpression(userActivity.Model, performer.performerId, performer.performerName, performer.orgType);
            variablePerformer.id = performer.id;
            variablePerformer.actionScope = ActionScope.Default;
            variablePerformer.Name = performer.performerName ? performer.performerName : performer.name;
            variablePerformer.Tag = performer.tag;
            variablePerformer.VarValue = performer.varValue;
            variablePerformer.VarType = performer.varType;
            variablePerformer.order = performer.order;
            variablePerformer.Relation = performer.relation;
            if (performer.condition) {
                /** @type {?} */
                var condition = new Condition(userActivity.Model);
                condition.Value = performer.condition;
                variablePerformer.condition = condition;
            }
        }
        if (type === 'humanPerformer') {
            /** @type {?} */
            var humanPerformerImpl = new HumanPerformerImpl(userActivity.Model);
            humanPerformerImpl.participantExpression = variablePerformer;
            if (performer.condition) {
                /** @type {?} */
                var condition = new Condition(userActivity.Model);
                condition.Value = performer.condition;
                humanPerformerImpl.condition = condition;
            }
            humanPerformerImpl.order = performer.order;
            userActivity.AddResourceRole(humanPerformerImpl);
        }
        else if (type === 'potentialOwner') {
            /** @type {?} */
            var otentialOwnerImpl = new PotentialOwnerImpl(userActivity.Model);
            otentialOwnerImpl.participantExpression = variablePerformer;
            if (performer.condition) {
                /** @type {?} */
                var condition = new Condition(userActivity.Model);
                condition.Value = performer.condition;
                otentialOwnerImpl.condition = condition;
            }
            otentialOwnerImpl.order = performer.order;
            if (scope) {
                variablePerformer.actionScope = scope;
                userActivity.dynamicParticipants.push(variablePerformer);
            }
            else {
                userActivity.AddResourceRole(otentialOwnerImpl);
            }
        }
    };
    /**
     * 添加岗位参与者
     * @param userActivity
     * @param performer
     * @param type
     */
    /**
     * 添加岗位参与者
     * @param {?} userActivity
     * @param {?} performer
     * @param {?} type
     * @param {?} scope
     * @return {?}
     */
    UserActivityCell.prototype.addPositionParticipant = /**
     * 添加岗位参与者
     * @param {?} userActivity
     * @param {?} performer
     * @param {?} type
     * @param {?} scope
     * @return {?}
     */
    function (userActivity, performer, type, scope) {
        /** @type {?} */
        var posiParticipant;
        if (performer instanceof PositionParticipantExpression) {
            posiParticipant = performer;
        }
        else {
            performer = (/** @type {?} */ (performer));
            posiParticipant = new PositionParticipantExpression(userActivity.Model, performer.performerId, performer.performerName);
            posiParticipant.id = performer.id;
            posiParticipant.actionScope = ActionScope.Default;
            posiParticipant.PositionType = performer.positionType;
            posiParticipant.order = performer.order;
            if (performer.positionType === '1') {
                posiParticipant.OrgId = performer.orgId;
                posiParticipant.OrgName = performer.orgName;
                posiParticipant.OrgType = performer.orgType;
            }
            if (performer.condition) {
                /** @type {?} */
                var condition = new Condition(userActivity.Model);
                condition.Value = performer.condition;
                posiParticipant.condition = condition;
            }
        }
        if (type === 'humanPerformer') {
            /** @type {?} */
            var humanPerformerImpl = new HumanPerformerImpl(userActivity.Model);
            humanPerformerImpl.participantExpression = posiParticipant;
            if (performer.condition) {
                /** @type {?} */
                var condition = new Condition(userActivity.Model);
                condition.Value = performer.condition;
                humanPerformerImpl.condition = condition;
            }
            humanPerformerImpl.order = performer.order;
            userActivity.AddResourceRole(humanPerformerImpl);
        }
        else if (type === 'potentialOwner') {
            /** @type {?} */
            var otentialOwnerImpl = new PotentialOwnerImpl(userActivity.Model);
            otentialOwnerImpl.participantExpression = posiParticipant;
            if (performer.condition) {
                /** @type {?} */
                var condition = new Condition(userActivity.Model);
                condition.Value = performer.condition;
                otentialOwnerImpl.condition = condition;
            }
            otentialOwnerImpl.order = performer.order;
            if (scope) {
                posiParticipant.actionScope = scope;
                userActivity.dynamicParticipants.push(posiParticipant);
            }
            else {
                userActivity.AddResourceRole(otentialOwnerImpl);
            }
        }
    };
    /**
     * 添加构件参与者
     * @param userActivity
     * @param component
     * @param type
     */
    /**
     * 添加构件参与者
     * @param {?} userActivity
     * @param {?} component
     * @param {?} type
     * @param {?} scope
     * @return {?}
     */
    UserActivityCell.prototype.addComponentParticipant = /**
     * 添加构件参与者
     * @param {?} userActivity
     * @param {?} component
     * @param {?} type
     * @param {?} scope
     * @return {?}
     */
    function (userActivity, component, type, scope) {
        var e_13, _a;
        /** @type {?} */
        var componentParticipant;
        if (component instanceof ComponentParticipantExpression) {
            componentParticipant = component;
        }
        else {
            component = (/** @type {?} */ (component));
            componentParticipant = new ComponentParticipantExpression(userActivity.Model);
            componentParticipant.id = component.id;
            componentParticipant.componentId = component.metadataId;
            componentParticipant.actionScope = ActionScope.Default;
            componentParticipant.componentName = component.name;
            componentParticipant.methodName = component.methodName;
            componentParticipant.order = component.order;
            componentParticipant.methodCode = component.methodCode;
            if (component.actualParameters && component.actualParameters.length > 0) {
                /** @type {?} */
                var actParas = new Array();
                try {
                    for (var _b = __values(component.actualParameters), _c = _b.next(); !_c.done; _c = _b.next()) {
                        var para = _c.value;
                        /** @type {?} */
                        var actPara = new ActualParameter(userActivity.Model, para.code, para.value, para.valueText);
                        // TODO:更新参与者会默认把构件参数属性改为contant，临时修复，后续代码优化
                        actPara.Tag = para.tag;
                        if (para.fetchValueMode) {
                            switch (para.fetchValueMode) {
                                case 'express':
                                    actPara.Tag = 'expression';
                                    break;
                                case 'none':
                                    actPara.Tag = 'expression';
                                    break;
                                default:
                                    actPara.Tag = 'constant';
                                    break;
                            }
                        }
                        actParas.push(actPara);
                    }
                }
                catch (e_13_1) { e_13 = { error: e_13_1 }; }
                finally {
                    try {
                        if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                    }
                    finally { if (e_13) throw e_13.error; }
                }
                componentParticipant.actualParameters = actParas;
            }
            if (component.condition) {
                /** @type {?} */
                var condition = new Condition(userActivity.Model);
                condition.Value = component.condition;
                componentParticipant.condition = condition;
            }
        }
        if (type === 'humanPerformer') {
            /** @type {?} */
            var humanPerformerImpl = new HumanPerformerImpl(userActivity.Model);
            humanPerformerImpl.participantExpression = componentParticipant;
            if (component.condition) {
                /** @type {?} */
                var condition = new Condition(userActivity.Model);
                condition.Value = component.condition;
                humanPerformerImpl.condition = condition;
            }
            humanPerformerImpl.order = component.order;
            userActivity.AddResourceRole(humanPerformerImpl);
        }
        else if (type === 'potentialOwner') {
            /** @type {?} */
            var otentialOwnerImpl = new PotentialOwnerImpl(userActivity.Model);
            otentialOwnerImpl.participantExpression = componentParticipant;
            if (component.condition) {
                /** @type {?} */
                var condition = new Condition(userActivity.Model);
                condition.Value = component.condition;
                otentialOwnerImpl.condition = condition;
            }
            otentialOwnerImpl.order = component.order;
            if (scope) {
                componentParticipant.actionScope = scope;
                userActivity.dynamicParticipants.push(componentParticipant);
            }
            else {
                userActivity.AddResourceRole(otentialOwnerImpl);
            }
        }
    };
    /**
     *
     * @param userActivity
     * @param participant
     * @param type
     */
    /**
     *
     * @param {?} userActivity
     * @param {?} participant
     * @param {?} type
     * @param {?} scope
     * @return {?}
     */
    UserActivityCell.prototype.addReportingLineParticipant = /**
     *
     * @param {?} userActivity
     * @param {?} participant
     * @param {?} type
     * @param {?} scope
     * @return {?}
     */
    function (userActivity, participant, type, scope) {
        /** @type {?} */
        var reportingLine;
        if (participant instanceof ReportingLineParticipantExpression) {
            reportingLine = participant;
        }
        else {
            participant = (/** @type {?} */ (participant));
            reportingLine = new ReportingLineParticipantExpression(userActivity.Model);
            reportingLine.id = participant.id;
            reportingLine.actionScope = ActionScope.Default;
            reportingLine.ReportingLineDefId = participant.reportingLineDefId;
            reportingLine.ReportingLineDefName = participant.reportingLineDefName;
            reportingLine.RefOrgId = participant.refOrgId;
            reportingLine.RefUserId = participant.refUserId;
            reportingLine.RefEmployeeId = participant.refEmployeeId;
            reportingLine.order = participant.order;
            reportingLine.Dimension = participant.dimension;
            reportingLine.Tag = participant.tag;
            if (participant.condition) {
                /** @type {?} */
                var condition = new Condition(userActivity.Model);
                condition.Value = participant.condition;
                reportingLine.condition = condition;
            }
        }
        if (type === 'humanPerformer') {
            /** @type {?} */
            var humanPerformerImpl = new HumanPerformerImpl(userActivity.Model);
            humanPerformerImpl.participantExpression = reportingLine;
            if (participant.condition) {
                /** @type {?} */
                var condition = new Condition(userActivity.Model);
                condition.Value = participant.condition;
                humanPerformerImpl.condition = condition;
            }
            humanPerformerImpl.order = participant.order;
            userActivity.AddResourceRole(humanPerformerImpl);
        }
        else if (type === 'potentialOwner') {
            /** @type {?} */
            var otentialOwnerImpl = new PotentialOwnerImpl(userActivity.Model);
            otentialOwnerImpl.participantExpression = reportingLine;
            if (participant.condition) {
                /** @type {?} */
                var condition = new Condition(userActivity.Model);
                condition.Value = participant.condition;
                otentialOwnerImpl.condition = condition;
            }
            otentialOwnerImpl.order = participant.order;
            if (scope) {
                reportingLine.actionScope = scope;
                userActivity.dynamicParticipants.push(reportingLine);
            }
            else {
                userActivity.AddResourceRole(otentialOwnerImpl);
            }
        }
    };
    /**
     *
     * @param userActivity
     * @param participant
     * @param type
     */
    /**
     *
     * @param {?} userActivity
     * @param {?} participant
     * @param {?} type
     * @param {?} scope
     * @return {?}
     */
    UserActivityCell.prototype.addActivityExecutorParticipant = /**
     *
     * @param {?} userActivity
     * @param {?} participant
     * @param {?} type
     * @param {?} scope
     * @return {?}
     */
    function (userActivity, participant, type, scope) {
        /** @type {?} */
        var activityExecutor;
        if (participant instanceof ActivityExecutorParticipantExpression) {
            activityExecutor = participant;
        }
        else {
            participant = (/** @type {?} */ (participant));
            activityExecutor = new ActivityExecutorParticipantExpression(userActivity.Model);
            activityExecutor.id = participant.id;
            activityExecutor.activityDefId = participant.activityDefId;
            activityExecutor.actionScope = ActionScope.Default;
            activityExecutor.order = participant.order;
            activityExecutor.activityDefName = participant.activityDefName;
            if (participant.condition) {
                /** @type {?} */
                var condition = new Condition(userActivity.Model);
                condition.Value = participant.condition;
                activityExecutor.condition = condition;
            }
        }
        if (type === 'humanPerformer') {
            /** @type {?} */
            var humanPerformerImpl = new HumanPerformerImpl(userActivity.Model);
            humanPerformerImpl.participantExpression = activityExecutor;
            if (participant.condition) {
                /** @type {?} */
                var condition = new Condition(userActivity.Model);
                condition.Value = participant.condition;
                humanPerformerImpl.condition = condition;
            }
            humanPerformerImpl.order = participant.order;
            userActivity.AddResourceRole(humanPerformerImpl);
        }
        else if (type === 'potentialOwner') {
            /** @type {?} */
            var otentialOwnerImpl = new PotentialOwnerImpl(userActivity.Model);
            otentialOwnerImpl.participantExpression = activityExecutor;
            if (participant.condition) {
                /** @type {?} */
                var condition = new Condition(userActivity.Model);
                condition.Value = participant.condition;
                otentialOwnerImpl.condition = condition;
            }
            otentialOwnerImpl.order = participant.order;
            if (scope) {
                activityExecutor.actionScope = scope;
                userActivity.dynamicParticipants.push(activityExecutor);
            }
            else {
                userActivity.AddResourceRole(otentialOwnerImpl);
            }
        }
    };
    /**
     *
     * @param userActivity
     * @param participant
     * @param type
     */
    /**
     *
     * @param {?} userActivity
     * @param {?} participant
     * @param {?} type
     * @param {?} scope
     * @return {?}
     */
    UserActivityCell.prototype.addMatrixParticipant = /**
     *
     * @param {?} userActivity
     * @param {?} participant
     * @param {?} type
     * @param {?} scope
     * @return {?}
     */
    function (userActivity, participant, type, scope) {
        /** @type {?} */
        var matrix;
        matrix = new MatrixParticipantExpression(userActivity.Model);
        if (participant instanceof MatrixParticipantExpression) {
            matrix = participant;
        }
        else {
            participant = (/** @type {?} */ (participant));
            matrix = new MatrixParticipantExpression(userActivity.Model);
            matrix.order = participant.order;
            matrix.id = participant.id;
            matrix.actionScope = ActionScope.Default;
            matrix.matrixDefId = participant.matrixDefId;
            matrix.matrixDefName = participant.matrixDefName;
            matrix.conditionField1 = participant.conditionField1;
            matrix.conditionFieldText1 = participant.conditionFieldText1;
            matrix.conditionField2 = participant.conditionField2;
            matrix.conditionFieldText2 = participant.conditionFieldText2;
            matrix.conditionField3 = participant.conditionField3;
            matrix.conditionFieldText3 = participant.conditionFieldText3;
            matrix.multivaluedCondition = participant.multivaluedCondition;
            matrix.dataFieldAlias = participant.dataFieldAlias;
            if (participant.condition) {
                /** @type {?} */
                var condition = new Condition(userActivity.Model);
                condition.Value = participant.condition;
                matrix.condition = condition;
            }
        }
        if (type === 'humanPerformer') {
            /** @type {?} */
            var humanPerformerImpl = new HumanPerformerImpl(userActivity.Model);
            humanPerformerImpl.participantExpression = matrix;
            if (participant.condition) {
                /** @type {?} */
                var condition = new Condition(userActivity.Model);
                condition.Value = participant.condition;
                humanPerformerImpl.condition = condition;
            }
            humanPerformerImpl.order = participant.order;
            userActivity.AddResourceRole(humanPerformerImpl);
        }
        else if (type === 'potentialOwner') {
            /** @type {?} */
            var otentialOwnerImpl = new PotentialOwnerImpl(userActivity.Model);
            otentialOwnerImpl.participantExpression = matrix;
            if (participant.condition) {
                /** @type {?} */
                var condition = new Condition(userActivity.Model);
                condition.Value = participant.condition;
                otentialOwnerImpl.condition = condition;
            }
            otentialOwnerImpl.order = participant.order;
            if (scope) {
                matrix.actionScope = scope;
                userActivity.dynamicParticipants.push(matrix);
            }
            else {
                userActivity.AddResourceRole(otentialOwnerImpl);
            }
        }
    };
    /**
     *
     * @param userActivity
     * @param participant
     * @param type
     */
    /**
     *
     * @param {?} userActivity
     * @param {?} participant
     * @param {?} type
     * @param {?} scope
     * @return {?}
     */
    UserActivityCell.prototype.addOrganizationParticipant = /**
     *
     * @param {?} userActivity
     * @param {?} participant
     * @param {?} type
     * @param {?} scope
     * @return {?}
     */
    function (userActivity, participant, type, scope) {
        /** @type {?} */
        var potential;
        if (participant instanceof OrganizationParticipantExpression) {
            potential = participant;
        }
        else {
            participant = (/** @type {?} */ (participant));
            potential = new OrganizationParticipantExpression(userActivity.Model);
            potential.id = participant.id;
            potential.order = participant.order;
            potential.actionScope = ActionScope.AssignUser;
            // potential.organizationLevel = participant.organizationLevel;
            if (participant.organizationLevel === 'DEPARTMENT') {
                potential.organizationLevel = OrganizationLevel.DEPARTMENT;
            }
            else if (participant.organizationLevel === 'UNIT') {
                potential.organizationLevel = OrganizationLevel.UNIT;
            }
            else if (participant.organizationLevel === 'DEFAULT') {
                potential.organizationLevel = OrganizationLevel.DEFAULT;
            }
            potential.organizationId = participant.organizationId;
            potential.organizationName = participant.organizationName;
            potential.includeChildren = participant.includeChildren;
            potential.tag = participant.tag;
            if (participant.condition) {
                /** @type {?} */
                var condition = new Condition(userActivity.Model);
                condition.Value = participant.condition;
                potential.condition = condition;
            }
        }
        if (type === 'humanPerformer') {
            /** @type {?} */
            var humanPerformerImpl = new HumanPerformerImpl(userActivity.Model);
            humanPerformerImpl.participantExpression = potential;
            if (participant.condition) {
                /** @type {?} */
                var condition = new Condition(userActivity.Model);
                condition.Value = participant.condition;
                humanPerformerImpl.condition = condition;
            }
            humanPerformerImpl.order = participant.order;
            userActivity.AddResourceRole(humanPerformerImpl);
        }
        else if (type === 'potentialOwner') {
            /** @type {?} */
            var otentialOwnerImpl = new PotentialOwnerImpl(userActivity.Model);
            otentialOwnerImpl.participantExpression = potential;
            if (participant.condition) {
                /** @type {?} */
                var condition = new Condition(userActivity.Model);
                condition.Value = participant.condition;
                otentialOwnerImpl.condition = condition;
            }
            otentialOwnerImpl.order = participant.order;
            if (scope) {
                potential.actionScope = scope;
                userActivity.dynamicParticipants.push(potential);
            }
            else {
                userActivity.AddResourceRole(otentialOwnerImpl);
            }
        }
    };
    /**
     * 修改参与者选项
     * @param userActivity
     * @param obj
     */
    /**
     * 修改参与者选项
     * @param {?} userActivity
     * @param {?} obj
     * @return {?}
     */
    UserActivityCell.prototype.updateParticipantOptions = /**
     * 修改参与者选项
     * @param {?} userActivity
     * @param {?} obj
     * @return {?}
     */
    function (userActivity, obj) {
        /** @type {?} */
        var options = obj.propertyValue;
        if (userActivity.ParticipantSetting != null) {
            userActivity.ParticipantSetting.ExclusionPerformers = options.ExclusionPerformers;
            userActivity.ParticipantSetting.NoPerformerStrategy = options.NoPerformerStrategy;
            userActivity.ParticipantSetting.HistoricFirst = options.HistoricFirst;
            userActivity.ParticipantSetting.automaticPerformers = options.automaticPerformers;
        }
        else {
            /** @type {?} */
            var participantSetting = new ParticipantSetting(userActivity.Model);
            participantSetting.ExclusionPerformers = options.ExclusionPerformers;
            participantSetting.NoPerformerStrategy = options.NoPerformerStrategy;
            participantSetting.HistoricFirst = options.HistoricFirst;
            participantSetting.automaticPerformers = options.automaticPerformers;
            userActivity.ParticipantSetting = participantSetting;
        }
    };
    /**
     * 修改完成策略属性
     * @param graph
     * @param userActivity
     * @param obj
     * @param isOperation
     */
    /**
     * 修改完成策略属性
     * @param {?} userActivity
     * @param {?} obj
     * @param {?=} isOperation
     * @return {?}
     */
    UserActivityCell.prototype.resetExecuteWorkItemMode = /**
     * 修改完成策略属性
     * @param {?} userActivity
     * @param {?} obj
     * @param {?=} isOperation
     * @return {?}
     */
    function (userActivity, obj, isOperation) {
        if (isOperation === void 0) { isOperation = false; }
        if (userActivity) {
            userActivity.ExecuteWorkItemMode = obj.propertyValue;
            //抢占模式下清空会签规则
            if (userActivity.ExecuteWorkItemMode === ExecuteWorkItemMode.Preempt) {
                userActivity.CounterSignRules = null;
            }
            else {
                // 会签规则不存在时，即由抢占变为会签时，初始化会签规则
                // 并行会签和串行会签之间切换时，不刷新会签规则
                if (!userActivity.CounterSignRules) {
                    userActivity.CounterSignRules = new Array();
                }
                //会签策略时,不允许跳转；且驳回规则不允许动态选择驳回级次(驳回规则目前需要在流程设计器调整)
                userActivity.SelectTargetAble = false;
                userActivity.JumpScope = null;
                // 切换会签策略时，分配策略不能是领用,自动切换为所有
                // 2023-2-9 修复：由于新增了备选办理人，直接指派导致切换时时备选办理人丢失，修改为只有是领用才切到指所有
                if (userActivity.AssignmentStrategy === AssignmentStrategy.CLAIM) {
                    userActivity.AssignmentStrategy = AssignmentStrategy.ALL;
                }
            }
        }
    };
    /**
     * @param {?} userActivity
     * @param {?} obj
     * @param {?=} isOperation
     * @return {?}
     */
    UserActivityCell.prototype.resetDisplayTerminal = /**
     * @param {?} userActivity
     * @param {?} obj
     * @param {?=} isOperation
     * @return {?}
     */
    function (userActivity, obj, isOperation) {
        if (isOperation === void 0) { isOperation = false; }
        if (userActivity) {
            userActivity.DisplayTerminal = obj.propertyValue;
        }
    };
    /**
     * 更新会签规则属性
     * @param graph
     * @param userActivity
     * @param obj
     * @param isOperation
     */
    /**
     * 更新会签规则属性
     * @param {?} userActivity
     * @param {?} obj
     * @param {?=} isOperation
     * @return {?}
     */
    UserActivityCell.prototype.resetSignRules = /**
     * 更新会签规则属性
     * @param {?} userActivity
     * @param {?} obj
     * @param {?=} isOperation
     * @return {?}
     */
    function (userActivity, obj, isOperation) {
        if (isOperation === void 0) { isOperation = false; }
        var e_14, _a;
        if (userActivity) {
            /** @type {?} */
            var rules = (/** @type {?} */ (obj.propertyValue));
            userActivity.CounterSignRules = null;
            if (rules && rules.length > 0) {
                userActivity.CounterSignRules = new Array();
                try {
                    for (var rules_1 = __values(rules), rules_1_1 = rules_1.next(); !rules_1_1.done; rules_1_1 = rules_1.next()) {
                        var rule = rules_1_1.value;
                        /** @type {?} */
                        var counterSignRule = new CounterSignRule(userActivity.Model);
                        /** @type {?} */
                        var condition = new Condition(userActivity.Model);
                        condition.Value = rule.completionCondition;
                        counterSignRule.ConclusionValue = rule.conclusionValue;
                        counterSignRule.CalculateType = rule.calculateType;
                        counterSignRule.ConditionValue = rule.conditionValue;
                        counterSignRule.WaitAllVotes = rule.waitAllVotes;
                        counterSignRule.CompletionCondition = condition;
                        userActivity.CounterSignRules.push(counterSignRule);
                    }
                }
                catch (e_14_1) { e_14 = { error: e_14_1 }; }
                finally {
                    try {
                        if (rules_1_1 && !rules_1_1.done && (_a = rules_1.return)) _a.call(rules_1);
                    }
                    finally { if (e_14) throw e_14.error; }
                }
            }
        }
    };
    /**
     * 更新自定义项属性
     * @param graph
     * @param userActivity
     * @param obj
     * @param isOperation
     */
    /**
     * 更新自定义项属性
     * @param {?} userActivity
     * @param {?} obj
     * @param {?=} isOperation
     * @return {?}
     */
    UserActivityCell.prototype.resetApprovalItems = /**
     * 更新自定义项属性
     * @param {?} userActivity
     * @param {?} obj
     * @param {?=} isOperation
     * @return {?}
     */
    function (userActivity, obj, isOperation) {
        if (isOperation === void 0) { isOperation = false; }
        var e_15, _a;
        if (userActivity) {
            /** @type {?} */
            var conclusions = (/** @type {?} */ (obj.propertyValue));
            userActivity.Conclusions = new Array();
            try {
                for (var conclusions_2 = __values(conclusions), conclusions_2_1 = conclusions_2.next(); !conclusions_2_1.done; conclusions_2_1 = conclusions_2.next()) {
                    var conclusion = conclusions_2_1.value;
                    /** @type {?} */
                    var item = new ConclusionItem(userActivity.Model);
                    item.Value = conclusion.value;
                    item.Text = conclusion.text;
                    item.WorkFlowAction = conclusion.workFlowAction;
                    item.IsDefault = conclusion.isDefault;
                    item.commentNecessary = conclusion.commentNecessary;
                    item.certification = conclusion.certification;
                    item.attachmentNecessary = conclusion.attachmentNecessary;
                    item.signatureNecessary = conclusion.signatureNecessary;
                    item.defaultComment = conclusion.defaultComment;
                    userActivity.Conclusions.push(item);
                }
            }
            catch (e_15_1) { e_15 = { error: e_15_1 }; }
            finally {
                try {
                    if (conclusions_2_1 && !conclusions_2_1.done && (_a = conclusions_2.return)) _a.call(conclusions_2);
                }
                finally { if (e_15) throw e_15.error; }
            }
        }
        // 判断审批项是否包含驳回？不包含时，驳回规则清空
        if (!this.isBackConclusionExist(userActivity.Conclusions)) {
            userActivity.BackWardRule = null;
        }
        else if (!userActivity.BackWardRule) {
            userActivity.BackWardRule = new BackWardRule(userActivity.Model);
        }
    };
    /**
     * 更新审批活动表单定义属性
     * @param userActivity
     * @param obj
     * @param terminal
     */
    /**
     * 更新审批活动表单定义属性
     * @param {?} userActivity
     * @param {?} obj
     * @param {?} terminal
     * @return {?}
     */
    UserActivityCell.prototype.resetExecuteForm = /**
     * 更新审批活动表单定义属性
     * @param {?} userActivity
     * @param {?} obj
     * @param {?} terminal
     * @return {?}
     */
    function (userActivity, obj, terminal) {
        var e_16, _a;
        if (userActivity) {
            /** @type {?} */
            var form = (/** @type {?} */ (obj.propertyValue));
            if (!userActivity.ExecuteForms) {
                userActivity.ExecuteForms = new Array();
            }
            userActivity.ExecuteForms = userActivity.ExecuteForms.filter((/**
             * @param {?} e
             * @return {?}
             */
            function (e) { return e.TerminalType !== terminal; }));
            if (form) {
                /** @type {?} */
                var params = (/** @type {?} */ (form.ActualParameters));
                /** @type {?} */
                var actParas = new Array();
                if (params && params.length > 0) {
                    try {
                        for (var params_1 = __values(params), params_1_1 = params_1.next(); !params_1_1.done; params_1_1 = params_1.next()) {
                            var para = params_1_1.value;
                            /** @type {?} */
                            var actPara = new ActualParameter(userActivity.Model, para.Name, para.Value);
                            if (para.Tag) {
                                actPara.Tag = para.Tag;
                            }
                            else {
                                if (para.Value) {
                                    if (para.Value.length >= 8 && para.Value.slice(0, 8) === "{\"expr\":") {
                                        actPara.Tag = 'expression';
                                    }
                                    else {
                                        actPara.Tag = 'constant';
                                    }
                                }
                                else {
                                    actPara.Tag = 'variable';
                                }
                            }
                            actParas.push(actPara);
                        }
                    }
                    catch (e_16_1) { e_16 = { error: e_16_1 }; }
                    finally {
                        try {
                            if (params_1_1 && !params_1_1.done && (_a = params_1.return)) _a.call(params_1);
                        }
                        finally { if (e_16) throw e_16.error; }
                    }
                }
                /** @type {?} */
                var id = BpmnModelHelper.GenerateElementId();
                /** @type {?} */
                var item = new ExecuteForm(userActivity.Model, id, form.Name, actParas);
                item.ComponentId = form.ComponentId;
                item.FormType = form.FormType;
                item.formFormatId = form.formFormatId;
                item.formatConfigId = form.formatConfigId;
                item.TerminalType = form.TerminalType;
                userActivity.ExecuteForms.push(item);
            }
        }
    };
    /**
     * 更新是否允许跳转属性
     * @param graph
     * @param userActivity
     * @param obj
     * @param isOperation
     */
    /**
     * 更新是否允许跳转属性
     * @param {?} userActivity
     * @param {?} obj
     * @param {?=} isOperation
     * @return {?}
     */
    UserActivityCell.prototype.resetSelectTargetAble = /**
     * 更新是否允许跳转属性
     * @param {?} userActivity
     * @param {?} obj
     * @param {?=} isOperation
     * @return {?}
     */
    function (userActivity, obj, isOperation) {
        if (isOperation === void 0) { isOperation = false; }
        /** @type {?} */
        var SelectTargetAble = (/** @type {?} */ (obj.propertyValue));
        userActivity.SelectTargetAble = SelectTargetAble;
        if (userActivity.SelectTargetAble) ;
        else {
            userActivity.JumpScope = null;
        }
    };
    /**
     * @param {?} userActivity
     * @param {?} obj
     * @return {?}
     */
    UserActivityCell.prototype.resetJumpScope = /**
     * @param {?} userActivity
     * @param {?} obj
     * @return {?}
     */
    function (userActivity, obj) {
        /** @type {?} */
        var data = obj.propertyValue;
        if (data) {
            /** @type {?} */
            var jumpScope = new JumpScope(userActivity.Model);
            jumpScope.Category = data.Category;
            jumpScope.DefaultType = data.DefaultType;
            jumpScope.DestinationActivities = data.DestinationActivities;
            jumpScope.DefaultActivity = data.DefaultActivity;
            userActivity.JumpScope = jumpScope;
        }
        else {
            userActivity.JumpScope = null;
        }
    };
    /**
     * @param {?} userActivity
     * @param {?} obj
     * @return {?}
     */
    UserActivityCell.prototype.resetBackWardRule = /**
     * @param {?} userActivity
     * @param {?} obj
     * @return {?}
     */
    function (userActivity, obj) {
        /** @type {?} */
        var data = obj.propertyValue;
        /** @type {?} */
        var backWardRule = new BackWardRule(userActivity.Model);
        backWardRule.TargetRef = data.TargetRef;
        backWardRule.SelectTargetAble = data.SelectTargetAble;
        backWardRule.WaitReturn = data.WaitReturn;
        backWardRule.ResubmitEffect = data.ResubmitEffect;
        backWardRule.DynamicBackWardRuleAble = data.DynamicBackWardRuleAble;
        backWardRule.SelectTargetList = data.SelectTargetList;
        userActivity.BackWardRule = backWardRule;
    };
    /**
     * @param {?} userActivity
     * @param {?} obj
     * @return {?}
     */
    UserActivityCell.prototype.resetMultiInstanceLoopCharacteristics = /**
     * @param {?} userActivity
     * @param {?} obj
     * @return {?}
     */
    function (userActivity, obj) {
        var e_17, _a;
        if (obj.propertyValue) {
            /** @type {?} */
            var data = obj.propertyValue;
            /** @type {?} */
            var loopCharacteristics = new MultiInstanceLoopCharacteristics(userActivity.Model);
            loopCharacteristics.enable = data.enable;
            loopCharacteristics.sequential = data.sequential;
            loopCharacteristics.loopCardinality = new Expression(userActivity.Model);
            if (data.loopCardinality) {
                /** @type {?} */
                var variableExpression = new SemanticExpression(userActivity.Model);
                variableExpression.Value = data.loopCardinality;
                loopCharacteristics.loopCardinality.MexExpression = variableExpression;
            }
            loopCharacteristics.completionCondition = data.completionCondition;
            /** @type {?} */
            var rules = (/** @type {?} */ (data.completionConditionRules));
            loopCharacteristics.completionConditionRules = null;
            if (rules && rules.length > 0) {
                loopCharacteristics.completionConditionRules = new Array();
                try {
                    for (var rules_2 = __values(rules), rules_2_1 = rules_2.next(); !rules_2_1.done; rules_2_1 = rules_2.next()) {
                        var rule = rules_2_1.value;
                        /** @type {?} */
                        var counterSignRule = new CounterSignRule(userActivity.Model);
                        /** @type {?} */
                        var condition = new Condition(userActivity.Model);
                        condition.Value = rule.CompletionCondition.Value;
                        counterSignRule.ConclusionValue = rule.ConclusionValue;
                        counterSignRule.CalculateType = rule.CalculateType;
                        counterSignRule.ConditionValue = rule.ConditionValue;
                        counterSignRule.WaitAllVotes = rule.WaitAllVotes;
                        counterSignRule.CompletionCondition = condition;
                        loopCharacteristics.completionConditionRules.push(counterSignRule);
                    }
                }
                catch (e_17_1) { e_17 = { error: e_17_1 }; }
                finally {
                    try {
                        if (rules_2_1 && !rules_2_1.done && (_a = rules_2.return)) _a.call(rules_2);
                    }
                    finally { if (e_17) throw e_17.error; }
                }
            }
            userActivity.LoopCharacteristics = loopCharacteristics;
        }
    };
    /**
     * 更新活动节点标题
     * @param userActivity
     * @param obj
     */
    /**
     * 更新活动节点标题
     * @param {?} userActivity
     * @param {?} obj
     * @return {?}
     */
    UserActivityCell.prototype.modifyTitleExpression = /**
     * 更新活动节点标题
     * @param {?} userActivity
     * @param {?} obj
     * @return {?}
     */
    function (userActivity, obj) {
        if (userActivity.taskTitle) {
            userActivity.taskTitle.valueLanguage = obj.propertyValue;
            userActivity.taskTitle.value = obj.propertyValue['zh-CHS'];
        }
        else {
            /** @type {?} */
            var title = new TitleExpression(userActivity.Model, obj.propertyValue['zh-CHS'], obj.propertyValue);
            userActivity.taskTitle = title;
        }
    };
    /**
     * @param {?} userActivity
     * @param {?} obj
     * @return {?}
     */
    UserActivityCell.prototype.resetTools = /**
     * @param {?} userActivity
     * @param {?} obj
     * @return {?}
     */
    function (userActivity, obj) {
        var e_18, _a, e_19, _b;
        /** @type {?} */
        var tools = (/** @type {?} */ (obj.propertyValue));
        userActivity.Tools = new Array();
        if (tools && tools.length > 0) {
            try {
                for (var tools_1 = __values(tools), tools_1_1 = tools_1.next(); !tools_1_1.done; tools_1_1 = tools_1.next()) {
                    var tool = tools_1_1.value;
                    /** @type {?} */
                    var component = new Component$1(userActivity.Model);
                    component.Id = tool.id;
                    component.Name = tool.name;
                    component.Time = tool.executionTime;
                    // TODO 写死了构件类型
                    component.ComponentType = 'WebServiceComponent';
                    component.MetadataId = tool.metadataId;
                    component.MethodCode = tool.methodCode;
                    component.isForCompensation = tool.isForCompensation;
                    component.ActualParameters = [];
                    if (tool.actualParameters && ((/** @type {?} */ (tool.actualParameters))).length > 0) {
                        try {
                            for (var _c = __values(((/** @type {?} */ (tool.actualParameters)))), _d = _c.next(); !_d.done; _d = _c.next()) {
                                var a = _d.value;
                                /** @type {?} */
                                var parameter = new ActualParameter(userActivity.Model, a.code, a.value);
                                component.ActualParameters.push(parameter);
                            }
                        }
                        catch (e_19_1) { e_19 = { error: e_19_1 }; }
                        finally {
                            try {
                                if (_d && !_d.done && (_b = _c.return)) _b.call(_c);
                            }
                            finally { if (e_19) throw e_19.error; }
                        }
                    }
                    userActivity.Tools.push(component);
                }
            }
            catch (e_18_1) { e_18 = { error: e_18_1 }; }
            finally {
                try {
                    if (tools_1_1 && !tools_1_1.done && (_a = tools_1.return)) _a.call(tools_1);
                }
                finally { if (e_18) throw e_18.error; }
            }
        }
    };
    /**
     * @param {?} userActivity
     * @param {?} obj
     * @return {?}
     */
    UserActivityCell.prototype.updateSignFrontSet = /**
     * @param {?} userActivity
     * @param {?} obj
     * @return {?}
     */
    function (userActivity, obj) {
        var e_20, _a;
        /** @type {?} */
        var scope = (/** @type {?} */ (obj.propertyValue));
        userActivity.dynamicParticipants = userActivity.dynamicParticipants.filter((/**
         * @param {?} p
         * @return {?}
         */
        function (p) { return ((/** @type {?} */ (p))).actionScope !== ActionScope.AddSignFront; }));
        userActivity.AddSignFrontAble = scope.enable;
        if (scope.scope) {
            if (scope.scope.organizationLevel) {
                /** @type {?} */
                var organizationParticipantExpression = new OrganizationParticipantExpression(userActivity.Model);
                organizationParticipantExpression.id = BpmnModelHelper.GenerateElementId();
                organizationParticipantExpression.actionScope = ActionScope.AddSignFront;
                organizationParticipantExpression.organizationLevel = (/** @type {?} */ (scope.scope.organizationLevel));
                organizationParticipantExpression.organizationId = scope.scope.organizationId;
                organizationParticipantExpression.organizationName = scope.scope.organizationName;
                organizationParticipantExpression.includeChildren = scope.scope.includeChildren;
                organizationParticipantExpression.tag = scope.scope.tag;
                userActivity.dynamicParticipants.push(organizationParticipantExpression);
            }
            else {
                /** @type {?} */
                var performerInfo = (/** @type {?} */ (scope.scope.participantInfo));
                if (performerInfo.isAllScope && performerInfo.potentialOwnerList && performerInfo.potentialOwnerList.length > 0) {
                    try {
                        for (var _b = __values(performerInfo.potentialOwnerList), _c = _b.next(); !_c.done; _c = _b.next()) {
                            var potentialOwner = _c.value;
                            switch (potentialOwner.type ? potentialOwner.type : ((potentialOwner instanceof ParticipantExpression) ? potentialOwner.ClrTypeID : null)) {
                                case UserParticipantExpression.Clr_Type_ID:
                                    this.addUserParticipant(userActivity, (potentialOwner instanceof ParticipantExpression ? potentialOwner : (/** @type {?} */ (potentialOwner))), 'potentialOwner', ActionScope.AddSignFront);
                                    break;
                                case VariableParticipantExpression.Clr_Type_ID:
                                    this.addVariableParticipant(userActivity, (potentialOwner instanceof ParticipantExpression ? potentialOwner : (/** @type {?} */ (potentialOwner))), 'potentialOwner', ActionScope.AddSignFront);
                                    break;
                                case PositionParticipantExpression.Clr_Type_ID:
                                    this.addPositionParticipant(userActivity, (potentialOwner instanceof ParticipantExpression ? potentialOwner : (/** @type {?} */ (potentialOwner))), 'potentialOwner', ActionScope.AddSignFront);
                                    break;
                                case ComponentParticipantExpression.Clr_Type_ID:
                                    this.addComponentParticipant(userActivity, (potentialOwner instanceof ParticipantExpression ? potentialOwner : (/** @type {?} */ (potentialOwner))), 'potentialOwner', ActionScope.AddSignFront);
                                    break;
                                case ReportingLineParticipantExpression.Clr_Type_ID:
                                    this.addReportingLineParticipant(userActivity, (potentialOwner instanceof ParticipantExpression ? potentialOwner : (/** @type {?} */ (potentialOwner))), 'potentialOwner', ActionScope.AddSignFront);
                                    break;
                                case ActivityExecutorParticipantExpression.Clr_Type_ID:
                                    this.addActivityExecutorParticipant(userActivity, (potentialOwner instanceof ParticipantExpression ? potentialOwner : (/** @type {?} */ (potentialOwner))), 'potentialOwner', ActionScope.AddSignFront);
                                    break;
                                case MatrixParticipantExpression.Clr_Type_ID:
                                    this.addMatrixParticipant(userActivity, (potentialOwner instanceof ParticipantExpression ? potentialOwner : (/** @type {?} */ (potentialOwner))), 'potentialOwner', ActionScope.AddSignFront);
                                    break;
                                case OrganizationParticipantExpression.Clr_Type_ID:
                                    this.addOrganizationParticipant(userActivity, (potentialOwner instanceof ParticipantExpression ? potentialOwner : (/** @type {?} */ (potentialOwner))), 'potentialOwner', ActionScope.AddSignFront);
                                    break;
                            }
                        }
                    }
                    catch (e_20_1) { e_20 = { error: e_20_1 }; }
                    finally {
                        try {
                            if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                        }
                        finally { if (e_20) throw e_20.error; }
                    }
                }
            }
        }
    };
    /**
     * @param {?} userActivity
     * @param {?} obj
     * @return {?}
     */
    UserActivityCell.prototype.updateSignBehindsSet = /**
     * @param {?} userActivity
     * @param {?} obj
     * @return {?}
     */
    function (userActivity, obj) {
        var e_21, _a;
        /** @type {?} */
        var scope = (/** @type {?} */ (obj.propertyValue));
        userActivity.dynamicParticipants = userActivity.dynamicParticipants.filter((/**
         * @param {?} p
         * @return {?}
         */
        function (p) { return ((/** @type {?} */ (p))).actionScope !== ActionScope.AddSignBehind; }));
        userActivity.AddSignBehindAble = scope.enable;
        if (scope.scope) {
            if (scope.scope.organizationLevel) {
                /** @type {?} */
                var organizationParticipantExpression = new OrganizationParticipantExpression(userActivity.Model);
                organizationParticipantExpression.id = BpmnModelHelper.GenerateElementId();
                organizationParticipantExpression.actionScope = ActionScope.AddSignBehind;
                organizationParticipantExpression.organizationLevel = (/** @type {?} */ (scope.scope.organizationLevel));
                organizationParticipantExpression.organizationId = scope.scope.organizationId;
                organizationParticipantExpression.organizationName = scope.scope.organizationName;
                organizationParticipantExpression.includeChildren = scope.scope.includeChildren;
                organizationParticipantExpression.tag = scope.scope.tag;
                userActivity.dynamicParticipants.push(organizationParticipantExpression);
            }
            else {
                /** @type {?} */
                var performerInfo = (/** @type {?} */ (scope.scope.participantInfo));
                if (performerInfo.isAllScope && performerInfo.potentialOwnerList && performerInfo.potentialOwnerList.length > 0) {
                    try {
                        for (var _b = __values(performerInfo.potentialOwnerList), _c = _b.next(); !_c.done; _c = _b.next()) {
                            var potentialOwner = _c.value;
                            switch (potentialOwner.type ? potentialOwner.type : ((potentialOwner instanceof ParticipantExpression) ? potentialOwner.ClrTypeID : null)) {
                                case UserParticipantExpression.Clr_Type_ID:
                                    this.addUserParticipant(userActivity, potentialOwner instanceof ParticipantExpression ? potentialOwner : (/** @type {?} */ (potentialOwner)), 'potentialOwner', ActionScope.AddSignBehind);
                                    break;
                                case VariableParticipantExpression.Clr_Type_ID:
                                    this.addVariableParticipant(userActivity, potentialOwner instanceof ParticipantExpression ? potentialOwner : (/** @type {?} */ (potentialOwner)), 'potentialOwner', ActionScope.AddSignBehind);
                                    break;
                                case PositionParticipantExpression.Clr_Type_ID:
                                    this.addPositionParticipant(userActivity, potentialOwner instanceof ParticipantExpression ? potentialOwner : (/** @type {?} */ (potentialOwner)), 'potentialOwner', ActionScope.AddSignBehind);
                                    break;
                                case ComponentParticipantExpression.Clr_Type_ID:
                                    this.addComponentParticipant(userActivity, potentialOwner instanceof ParticipantExpression ? potentialOwner : (/** @type {?} */ (potentialOwner)), 'potentialOwner', ActionScope.AddSignBehind);
                                    break;
                                case ReportingLineParticipantExpression.Clr_Type_ID:
                                    this.addReportingLineParticipant(userActivity, potentialOwner instanceof ParticipantExpression ? potentialOwner : (/** @type {?} */ (potentialOwner)), 'potentialOwner', ActionScope.AddSignBehind);
                                    break;
                                case ActivityExecutorParticipantExpression.Clr_Type_ID:
                                    this.addActivityExecutorParticipant(userActivity, potentialOwner instanceof ParticipantExpression ? potentialOwner : (/** @type {?} */ (potentialOwner)), 'potentialOwner', ActionScope.AddSignBehind);
                                    break;
                                case MatrixParticipantExpression.Clr_Type_ID:
                                    this.addMatrixParticipant(userActivity, potentialOwner instanceof ParticipantExpression ? potentialOwner : (/** @type {?} */ (potentialOwner)), 'potentialOwner', ActionScope.AddSignBehind);
                                    break;
                                case OrganizationParticipantExpression.Clr_Type_ID:
                                    this.addOrganizationParticipant(userActivity, potentialOwner instanceof ParticipantExpression ? potentialOwner : (/** @type {?} */ (potentialOwner)), 'potentialOwner', ActionScope.AddSignBehind);
                                    break;
                            }
                        }
                    }
                    catch (e_21_1) { e_21 = { error: e_21_1 }; }
                    finally {
                        try {
                            if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                        }
                        finally { if (e_21) throw e_21.error; }
                    }
                }
            }
        }
    };
    /**
     * @param {?} userActivity
     * @param {?} obj
     * @return {?}
     */
    UserActivityCell.prototype.updateNotifySet = /**
     * @param {?} userActivity
     * @param {?} obj
     * @return {?}
     */
    function (userActivity, obj) {
        var e_22, _a;
        /** @type {?} */
        var scope = (/** @type {?} */ (obj.propertyValue));
        userActivity.dynamicParticipants = userActivity.dynamicParticipants.filter((/**
         * @param {?} p
         * @return {?}
         */
        function (p) { return ((/** @type {?} */ (p))).actionScope !== ActionScope.Notify; }));
        userActivity.NotifyAble = scope.enable;
        if (scope.scope) {
            if (scope.scope.organizationLevel) {
                /** @type {?} */
                var organizationParticipantExpression = new OrganizationParticipantExpression(userActivity.Model);
                organizationParticipantExpression.id = BpmnModelHelper.GenerateElementId();
                organizationParticipantExpression.actionScope = ActionScope.Notify;
                organizationParticipantExpression.organizationLevel = (/** @type {?} */ (scope.scope.organizationLevel));
                organizationParticipantExpression.organizationId = scope.scope.organizationId;
                organizationParticipantExpression.organizationName = scope.scope.organizationName;
                organizationParticipantExpression.includeChildren = scope.scope.includeChildren;
                organizationParticipantExpression.tag = scope.scope.tag;
                userActivity.dynamicParticipants.push(organizationParticipantExpression);
            }
            else {
                /** @type {?} */
                var performerInfo = (/** @type {?} */ (scope.scope.participantInfo));
                if (performerInfo.isAllScope && performerInfo.potentialOwnerList && performerInfo.potentialOwnerList.length > 0) {
                    try {
                        for (var _b = __values(performerInfo.potentialOwnerList), _c = _b.next(); !_c.done; _c = _b.next()) {
                            var potentialOwner = _c.value;
                            switch (potentialOwner.type ? potentialOwner.type : ((potentialOwner instanceof ParticipantExpression) ? potentialOwner.ClrTypeID : null)) {
                                case UserParticipantExpression.Clr_Type_ID:
                                    this.addUserParticipant(userActivity, potentialOwner instanceof ParticipantExpression ? potentialOwner : (/** @type {?} */ (potentialOwner)), 'potentialOwner', ActionScope.Notify);
                                    break;
                                case VariableParticipantExpression.Clr_Type_ID:
                                    this.addVariableParticipant(userActivity, potentialOwner instanceof ParticipantExpression ? potentialOwner : (/** @type {?} */ (potentialOwner)), 'potentialOwner', ActionScope.Notify);
                                    break;
                                case PositionParticipantExpression.Clr_Type_ID:
                                    this.addPositionParticipant(userActivity, potentialOwner instanceof ParticipantExpression ? potentialOwner : (/** @type {?} */ (potentialOwner)), 'potentialOwner', ActionScope.Notify);
                                    break;
                                case ComponentParticipantExpression.Clr_Type_ID:
                                    this.addComponentParticipant(userActivity, potentialOwner instanceof ParticipantExpression ? potentialOwner : (/** @type {?} */ (potentialOwner)), 'potentialOwner', ActionScope.Notify);
                                    break;
                                case ReportingLineParticipantExpression.Clr_Type_ID:
                                    this.addReportingLineParticipant(userActivity, potentialOwner instanceof ParticipantExpression ? potentialOwner : (/** @type {?} */ (potentialOwner)), 'potentialOwner', ActionScope.Notify);
                                    break;
                                case ActivityExecutorParticipantExpression.Clr_Type_ID:
                                    this.addActivityExecutorParticipant(userActivity, potentialOwner instanceof ParticipantExpression ? potentialOwner : (/** @type {?} */ (potentialOwner)), 'potentialOwner', ActionScope.Notify);
                                    break;
                                case MatrixParticipantExpression.Clr_Type_ID:
                                    this.addMatrixParticipant(userActivity, potentialOwner instanceof ParticipantExpression ? potentialOwner : (/** @type {?} */ (potentialOwner)), 'potentialOwner', ActionScope.Notify);
                                    break;
                                case OrganizationParticipantExpression.Clr_Type_ID:
                                    this.addOrganizationParticipant(userActivity, potentialOwner instanceof ParticipantExpression ? potentialOwner : (/** @type {?} */ (potentialOwner)), 'potentialOwner', ActionScope.Notify);
                                    break;
                            }
                        }
                    }
                    catch (e_22_1) { e_22 = { error: e_22_1 }; }
                    finally {
                        try {
                            if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                        }
                        finally { if (e_22) throw e_22.error; }
                    }
                }
            }
        }
    };
    /**
     * @param {?} userActivity
     * @param {?} obj
     * @return {?}
     */
    UserActivityCell.prototype.updateTransferScope = /**
     * @param {?} userActivity
     * @param {?} obj
     * @return {?}
     */
    function (userActivity, obj) {
        var e_23, _a;
        /** @type {?} */
        var scope = (/** @type {?} */ (obj.propertyValue));
        userActivity.dynamicParticipants = userActivity.dynamicParticipants.filter((/**
         * @param {?} p
         * @return {?}
         */
        function (p) { return ((/** @type {?} */ (p))).actionScope !== ActionScope.Transfer; }));
        userActivity.transferAble = scope.enable;
        if (scope.scope) {
            if (scope.scope.organizationLevel) {
                /** @type {?} */
                var organizationParticipantExpression = new OrganizationParticipantExpression(userActivity.Model);
                organizationParticipantExpression.id = BpmnModelHelper.GenerateElementId();
                organizationParticipantExpression.actionScope = ActionScope.Transfer;
                organizationParticipantExpression.organizationLevel = (/** @type {?} */ (scope.scope.organizationLevel));
                organizationParticipantExpression.organizationId = scope.scope.organizationId;
                organizationParticipantExpression.organizationName = scope.scope.organizationName;
                organizationParticipantExpression.includeChildren = scope.scope.includeChildren;
                organizationParticipantExpression.tag = scope.scope.tag;
                userActivity.dynamicParticipants.push(organizationParticipantExpression);
            }
            else {
                /** @type {?} */
                var performerInfo = (/** @type {?} */ (scope.scope.participantInfo));
                if (performerInfo.isAllScope && performerInfo.potentialOwnerList && performerInfo.potentialOwnerList.length > 0) {
                    try {
                        for (var _b = __values(performerInfo.potentialOwnerList), _c = _b.next(); !_c.done; _c = _b.next()) {
                            var potentialOwner = _c.value;
                            switch (potentialOwner.type ? potentialOwner.type : ((potentialOwner instanceof ParticipantExpression) ? potentialOwner.ClrTypeID : null)) {
                                case UserParticipantExpression.Clr_Type_ID:
                                    this.addUserParticipant(userActivity, potentialOwner instanceof ParticipantExpression ? potentialOwner : (/** @type {?} */ (potentialOwner)), 'potentialOwner', ActionScope.Transfer);
                                    break;
                                case VariableParticipantExpression.Clr_Type_ID:
                                    this.addVariableParticipant(userActivity, potentialOwner instanceof ParticipantExpression ? potentialOwner : (/** @type {?} */ (potentialOwner)), 'potentialOwner', ActionScope.Transfer);
                                    break;
                                case PositionParticipantExpression.Clr_Type_ID:
                                    this.addPositionParticipant(userActivity, potentialOwner instanceof ParticipantExpression ? potentialOwner : (/** @type {?} */ (potentialOwner)), 'potentialOwner', ActionScope.Transfer);
                                    break;
                                case ComponentParticipantExpression.Clr_Type_ID:
                                    this.addComponentParticipant(userActivity, potentialOwner instanceof ParticipantExpression ? potentialOwner : (/** @type {?} */ (potentialOwner)), 'potentialOwner', ActionScope.Transfer);
                                    break;
                                case ReportingLineParticipantExpression.Clr_Type_ID:
                                    this.addReportingLineParticipant(userActivity, potentialOwner instanceof ParticipantExpression ? potentialOwner : (/** @type {?} */ (potentialOwner)), 'potentialOwner', ActionScope.Transfer);
                                    break;
                                case ActivityExecutorParticipantExpression.Clr_Type_ID:
                                    this.addActivityExecutorParticipant(userActivity, potentialOwner instanceof ParticipantExpression ? potentialOwner : (/** @type {?} */ (potentialOwner)), 'potentialOwner', ActionScope.Transfer);
                                    break;
                                case MatrixParticipantExpression.Clr_Type_ID:
                                    this.addMatrixParticipant(userActivity, potentialOwner instanceof ParticipantExpression ? potentialOwner : (/** @type {?} */ (potentialOwner)), 'potentialOwner', ActionScope.Transfer);
                                    break;
                                case OrganizationParticipantExpression.Clr_Type_ID:
                                    this.addOrganizationParticipant(userActivity, potentialOwner instanceof ParticipantExpression ? potentialOwner : (/** @type {?} */ (potentialOwner)), 'potentialOwner', ActionScope.Transfer);
                                    break;
                            }
                        }
                    }
                    catch (e_23_1) { e_23 = { error: e_23_1 }; }
                    finally {
                        try {
                            if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                        }
                        finally { if (e_23) throw e_23.error; }
                    }
                }
            }
        }
    };
    /**
     * @param {?} userActivity
     * @param {?} obj
     * @return {?}
     */
    UserActivityCell.prototype.updateTimeLimitControl = /**
     * @param {?} userActivity
     * @param {?} obj
     * @return {?}
     */
    function (userActivity, obj) {
        var e_24, _a, e_25, _b;
        /** @type {?} */
        var timeLimitInfo = (/** @type {?} */ (obj.propertyValue));
        userActivity.timeLimitControl = null;
        if (timeLimitInfo) {
            /** @type {?} */
            var control = new TimeLimitControl(userActivity.Model);
            control.enable = timeLimitInfo.enable;
            control.tag = timeLimitInfo.tag;
            control.dueTime = timeLimitInfo.dueTime;
            control.timeUnit = timeLimitInfo.timeUnit;
            control.expireOperations = new Array();
            if (timeLimitInfo.expireOperations && timeLimitInfo.expireOperations.length > 0) {
                try {
                    for (var _c = __values(timeLimitInfo.expireOperations), _d = _c.next(); !_d.done; _d = _c.next()) {
                        var o = _d.value;
                        if (o.operationTypeName === 'SendMessageExpireOperation' || !o.operationTypeName) {
                            /** @type {?} */
                            var entity = (/** @type {?} */ (o));
                            /** @type {?} */
                            var sendMessage = new SendMessageExpireOperation(userActivity.Model);
                            sendMessage.id = BpmnModelHelper.GenerateElementId();
                            sendMessage.durationType = (/** @type {?} */ (entity.durationType));
                            sendMessage.timeDuration = entity.timeDuration;
                            sendMessage.timeUnit = entity.timeUnit;
                            sendMessage.message = entity.message;
                            sendMessage.subject = entity.subject;
                            sendMessage.sendType = entity.sendType;
                            sendMessage.receiver = entity.receiver;
                            sendMessage.cycleEnable = entity.cycleEnable;
                            sendMessage.cycleTime = entity.cycleTime;
                            sendMessage.cycleTimeUnit = entity.cycleTimeUnit;
                            sendMessage.operationTypeName = entity.operationTypeName ? entity.operationTypeName : 'SendMessageExpireOperation';
                            if (entity.smsMessageTemplate) {
                                /** @type {?} */
                                var smsMessageTemplate = new SmsMessageTemplate(userActivity.Model);
                                smsMessageTemplate.code = entity.smsMessageTemplate.code;
                                smsMessageTemplate.content = entity.smsMessageTemplate.content;
                                smsMessageTemplate.smsMessageVariables = new Array();
                                if (entity.smsMessageTemplate.smsMessageVariables && entity.smsMessageTemplate.smsMessageVariables.length > 0) {
                                    try {
                                        for (var _e = __values(entity.smsMessageTemplate.smsMessageVariables), _f = _e.next(); !_f.done; _f = _e.next()) {
                                            var v = _f.value;
                                            /** @type {?} */
                                            var variable = new SmsMessageVariable(userActivity.Model);
                                            variable.code = v.code;
                                            variable.value = v.value;
                                            variable.tag = v.tag;
                                            smsMessageTemplate.smsMessageVariables.push(variable);
                                        }
                                    }
                                    catch (e_25_1) { e_25 = { error: e_25_1 }; }
                                    finally {
                                        try {
                                            if (_f && !_f.done && (_b = _e.return)) _b.call(_e);
                                        }
                                        finally { if (e_25) throw e_25.error; }
                                    }
                                }
                                sendMessage.smsMessageTemplate = smsMessageTemplate;
                            }
                            control.expireOperations.push(sendMessage);
                        }
                        else if (o.operationTypeName === 'AutoHandleExpireOperation') {
                            /** @type {?} */
                            var operation = (/** @type {?} */ (o));
                            /** @type {?} */
                            var autoHandle = new AutoHandleExpireOperation(userActivity.Model);
                            autoHandle.id = o.id;
                            autoHandle.durationType = operation.durationType;
                            autoHandle.timeDuration = operation.timeDuration;
                            autoHandle.timeUnit = operation.timeUnit;
                            autoHandle.operationTypeName = operation.operationTypeName ? operation.operationTypeName : 'AutoHandleExpireOperation';
                            autoHandle.autoHandleType = operation.autoHandleType;
                            autoHandle.message = operation.message;
                            control.expireOperations.push(autoHandle);
                        }
                    }
                }
                catch (e_24_1) { e_24 = { error: e_24_1 }; }
                finally {
                    try {
                        if (_d && !_d.done && (_a = _c.return)) _a.call(_c);
                    }
                    finally { if (e_24) throw e_24.error; }
                }
            }
            userActivity.timeLimitControl = control;
        }
    };
    /**
     * @param {?} userActivity
     * @param {?} obj
     * @return {?}
     */
    UserActivityCell.prototype.updateAnonymousSet = /**
     * @param {?} userActivity
     * @param {?} obj
     * @return {?}
     */
    function (userActivity, obj) {
        /** @type {?} */
        var anonymousSet = obj.propertyValue;
        if (anonymousSet) {
            userActivity.anonymous = anonymousSet.isAnonymity;
            userActivity.anonymousText = anonymousSet.anonymous;
        }
    };
    /**
     * @param {?} userActivity
     * @param {?} obj
     * @return {?}
     */
    UserActivityCell.prototype.updateCustomizeActions = /**
     * @param {?} userActivity
     * @param {?} obj
     * @return {?}
     */
    function (userActivity, obj) {
        var e_26, _a, e_27, _b;
        /** @type {?} */
        var actions = (/** @type {?} */ (obj.propertyValue));
        userActivity.customizeActions = new Array();
        if (actions && actions.length > 0) {
            try {
                for (var actions_1 = __values(actions), actions_1_1 = actions_1.next(); !actions_1_1.done; actions_1_1 = actions_1.next()) {
                    var a = actions_1_1.value;
                    /** @type {?} */
                    var action = new CustomizeAction(userActivity.Model);
                    action.id = BpmnModelHelper.GenerateElementId();
                    action.code = a.code;
                    action.name = a.name;
                    action.terminalType = a.terminalType;
                    action.actualParameters = [];
                    if (a.actualParameters && a.actualParameters.length > 0) {
                        try {
                            for (var _c = __values(a.actualParameters), _d = _c.next(); !_d.done; _d = _c.next()) {
                                var p = _d.value;
                                /** @type {?} */
                                var parameter = new ActualParameter(userActivity.Model, p.Name, p.Value, p.ValueText, p.Tag || 'expression');
                                action.actualParameters.push(parameter);
                            }
                        }
                        catch (e_27_1) { e_27 = { error: e_27_1 }; }
                        finally {
                            try {
                                if (_d && !_d.done && (_b = _c.return)) _b.call(_c);
                            }
                            finally { if (e_27) throw e_27.error; }
                        }
                    }
                    userActivity.customizeActions.push(action);
                }
            }
            catch (e_26_1) { e_26 = { error: e_26_1 }; }
            finally {
                try {
                    if (actions_1_1 && !actions_1_1.done && (_a = actions_1.return)) _a.call(actions_1);
                }
                finally { if (e_26) throw e_26.error; }
            }
        }
    };
    /**
     * @param {?} userActivity
     * @param {?} obj
     * @return {?}
     */
    UserActivityCell.prototype.updateVariableSettings = /**
     * @param {?} userActivity
     * @param {?} obj
     * @return {?}
     */
    function (userActivity, obj) {
        var e_28, _a, e_29, _b, e_30, _c;
        /** @type {?} */
        var bpmnModel = userActivity.Model;
        /** @type {?} */
        var extendElements = bpmnModel.DefaultProcess.GetExtensionElements();
        if (userActivity.variableSettings && userActivity.variableSettings.length > 0) {
            var _loop_1 = function (v) {
                if (v.tag === 'component') {
                    /** @type {?} */
                    var i = extendElements.findIndex((/**
                     * @param {?} e
                     * @return {?}
                     */
                    function (e) { return (e instanceof Component$1 && e.Id === v.value); }));
                    extendElements.splice(i, 1);
                }
            };
            try {
                for (var _d = __values(userActivity.variableSettings), _e = _d.next(); !_e.done; _e = _d.next()) {
                    var v = _e.value;
                    _loop_1(v);
                }
            }
            catch (e_28_1) { e_28 = { error: e_28_1 }; }
            finally {
                try {
                    if (_e && !_e.done && (_a = _d.return)) _a.call(_d);
                }
                finally { if (e_28) throw e_28.error; }
            }
        }
        userActivity.variableSettings = new Array();
        /** @type {?} */
        var variables = (/** @type {?} */ (obj.propertyValue));
        if (variables && variables.length > 0) {
            try {
                for (var variables_1 = __values(variables), variables_1_1 = variables_1.next(); !variables_1_1.done; variables_1_1 = variables_1.next()) {
                    var v = variables_1_1.value;
                    /** @type {?} */
                    var variableSetting = new VariableSetting(bpmnModel);
                    variableSetting.variableCode = v.variableCode;
                    variableSetting.variableName = v.variableName;
                    variableSetting.tag = v.tag;
                    variableSetting.executionTime = v.executionTime;
                    variableSetting.value = v.value;
                    variableSetting.valueText = v.valueText;
                    userActivity.variableSettings.push(variableSetting);
                    if (variableSetting.tag === 'component') {
                        /** @type {?} */
                        var c = v.component;
                        if (c) {
                            /** @type {?} */
                            var cpt = new Component$1(bpmnModel);
                            cpt.MetadataId = c.MetadataId;
                            cpt.MethodCode = c.MethodCode;
                            cpt.Id = c.Id;
                            cpt.Name = c.Name;
                            cpt.ActualParameters = new Array();
                            if (c.ActualParameters && c.ActualParameters.length > 0) {
                                try {
                                    for (var _f = __values(c.ActualParameters), _g = _f.next(); !_g.done; _g = _f.next()) {
                                        var a = _g.value;
                                        /** @type {?} */
                                        var parameter = new ActualParameter(bpmnModel, a.Name, a.Value);
                                        parameter.Tag = a.Tag;
                                        cpt.ActualParameters.push(parameter);
                                    }
                                }
                                catch (e_30_1) { e_30 = { error: e_30_1 }; }
                                finally {
                                    try {
                                        if (_g && !_g.done && (_c = _f.return)) _c.call(_f);
                                    }
                                    finally { if (e_30) throw e_30.error; }
                                }
                            }
                            extendElements.push(cpt);
                        }
                    }
                }
            }
            catch (e_29_1) { e_29 = { error: e_29_1 }; }
            finally {
                try {
                    if (variables_1_1 && !variables_1_1.done && (_b = variables_1.return)) _b.call(variables_1);
                }
                finally { if (e_29) throw e_29.error; }
            }
        }
    };
    /**
     * @param {?} userActivity
     * @param {?} obj
     * @return {?}
     */
    UserActivityCell.prototype.updateImageSettings = /**
     * @param {?} userActivity
     * @param {?} obj
     * @return {?}
     */
    function (userActivity, obj) {
        /** @type {?} */
        var Settings = (/** @type {?} */ (obj.propertyValue));
        if (userActivity.imageSettings) {
            userActivity.imageSettings = new ImageSettings(userActivity.Model);
        }
        if (Settings && Settings.imageOperation) {
            /** @type {?} */
            var imageSettings = new ImageSettings(userActivity.Model);
            imageSettings.imageOperation = Settings.imageOperation;
            userActivity.imageSettings = imageSettings;
        }
    };
    /**
     * @param {?} userActivity
     * @param {?} obj
     * @param {?=} isOperation
     * @return {?}
     */
    UserActivityCell.prototype.updateCheckConditions = /**
     * @param {?} userActivity
     * @param {?} obj
     * @param {?=} isOperation
     * @return {?}
     */
    function (userActivity, obj, isOperation) {
        if (isOperation === void 0) { isOperation = false; }
        var e_31, _a;
        /** @type {?} */
        var checkConditions = (/** @type {?} */ (obj.propertyValue));
        userActivity.checkConditions = new Array();
        try {
            for (var checkConditions_1 = __values(checkConditions), checkConditions_1_1 = checkConditions_1.next(); !checkConditions_1_1.done; checkConditions_1_1 = checkConditions_1.next()) {
                var c = checkConditions_1_1.value;
                if (c.value) {
                    /** @type {?} */
                    var condition = new CheckCondition(userActivity.Model);
                    condition.value = c.value;
                    condition.checkTime = c.checkTime;
                    condition.errorTips = new Map();
                    if (c.errorTips) {
                        for (var key in c.errorTips) {
                            condition.errorTips.set(key, c.errorTips[key]);
                        }
                    }
                    userActivity.checkConditions.push(condition);
                }
            }
        }
        catch (e_31_1) { e_31 = { error: e_31_1 }; }
        finally {
            try {
                if (checkConditions_1_1 && !checkConditions_1_1.done && (_a = checkConditions_1.return)) _a.call(checkConditions_1);
            }
            finally { if (e_31) throw e_31.error; }
        }
    };
    /**
     * @param {?} userActivity
     * @param {?} obj
     * @return {?}
     */
    UserActivityCell.prototype.updateOtherAssignNodes = /**
     * @param {?} userActivity
     * @param {?} obj
     * @return {?}
     */
    function (userActivity, obj) {
        /** @type {?} */
        var data = obj.propertyValue;
        if (data) {
            // const otherAssignNodes = new OtherAssignNodes(userActivity.Model);
            // otherAssignNodes.otherAssignActivities = new Array();
            // userActivity.otherAssignNodes = otherAssignNodes;
            userActivity.otherAssignNodes = new OtherAssignNodes(userActivity.Model);
        }
        else {
            userActivity.otherAssignNodes = null;
        }
    };
    /**
     * @param {?} userActivity
     * @param {?} obj
     * @return {?}
     */
    UserActivityCell.prototype.updateOtherAssignActivities = /**
     * @param {?} userActivity
     * @param {?} obj
     * @return {?}
     */
    function (userActivity, obj) {
        /** @type {?} */
        var data = obj.propertyValue;
        if (data && data.length > 0) {
            if (typeof data[0] === "string") {
                userActivity.otherAssignNodes.otherAssignActivityNodeInfos = new Array();
                data.forEach((/**
                 * @param {?} d
                 * @return {?}
                 */
                function (d) {
                    /** @type {?} */
                    var other = new OtherAssignActivityNodeInfo(userActivity.Model);
                    other.activityDefinitionId = d;
                    other.required = false;
                    other.condition = new Condition(userActivity.Model);
                    userActivity.otherAssignNodes.otherAssignActivityNodeInfos.push(other);
                }));
            }
            else {
                userActivity.otherAssignNodes.otherAssignActivityNodeInfos = new Array();
                data.forEach((/**
                 * @param {?} d
                 * @return {?}
                 */
                function (d) {
                    /** @type {?} */
                    var other = new OtherAssignActivityNodeInfo(userActivity.Model);
                    other.activityDefinitionId = d.activityDefinitionId;
                    other.required = d.required;
                    other.condition = new Condition(userActivity.Model);
                    other.condition.Value = d.condition.Value;
                    userActivity.otherAssignNodes.otherAssignActivityNodeInfos.push(other);
                }));
            }
            // userActivity.otherAssignNodes.otherAssignActivities = [...data];
        }
        else {
            userActivity.otherAssignNodes.otherAssignActivityNodeInfos = new Array();
        }
    };
    /**
     * @param {?} userActivity
     * @param {?} obj
     * @return {?}
     */
    UserActivityCell.prototype.updateMessageNotices = /**
     * @param {?} userActivity
     * @param {?} obj
     * @return {?}
     */
    function (userActivity, obj) {
        var e_32, _a, e_33, _b, e_34, _c, e_35, _d;
        /** @type {?} */
        var notices = (/** @type {?} */ (obj.propertyValue));
        userActivity.messageNotices = new Array();
        if (notices && notices.length > 0) {
            try {
                for (var notices_1 = __values(notices), notices_1_1 = notices_1.next(); !notices_1_1.done; notices_1_1 = notices_1.next()) {
                    var n = notices_1_1.value;
                    /** @type {?} */
                    var messageNotice = new MessageNotice(userActivity.Model);
                    messageNotice.sendType = n.sendType;
                    messageNotice.sendTime = n.sendTime;
                    messageNotice.subject = n.subject;
                    messageNotice.content = n.content;
                    n.receivers = n.receivers.filter((/**
                     * @param {?} r
                     * @return {?}
                     */
                    function (r) { return r.type; }));
                    if (n.receivers && n.receivers.length > 0) {
                        /** @type {?} */
                        var receivers = n.receivers.filter((/**
                         * @param {?} r
                         * @return {?}
                         */
                        function (r) { return r.type === 'userParticipant'
                            || (r.type === 'processParticipant' && r.processParticipant !== 'activityExecutorParticipant'); }));
                        /** @type {?} */
                        var participants = n.receivers.filter((/**
                         * @param {?} r
                         * @return {?}
                         */
                        function (r) { return r.type === 'variableParticipant' || r.type === 'positionParticipant'
                            || (r.type === 'processParticipant' && r.processParticipant === 'activityExecutorParticipant'); }));
                        if (receivers && receivers.length > 0) {
                            /** @type {?} */
                            var receiver = '';
                            /** @type {?} */
                            var receiverName = '';
                            try {
                                for (var receivers_1 = __values(receivers), receivers_1_1 = receivers_1.next(); !receivers_1_1.done; receivers_1_1 = receivers_1.next()) {
                                    var r = receivers_1_1.value;
                                    if (r.type === 'processParticipant') {
                                        receiver += (r.processParticipant + ',');
                                        if (r.processParticipant === 'procInstCreator') {
                                            receiverName += '流程发起人,';
                                        }
                                        else if (r.processParticipant === 'workItemParticipant') {
                                            receiverName += '任务接收人,';
                                        }
                                    }
                                    else if (r.type === 'userParticipant') {
                                        receiver += (r.userIds + ',');
                                        receiverName += (r.userNames + ',');
                                    }
                                }
                            }
                            catch (e_33_1) { e_33 = { error: e_33_1 }; }
                            finally {
                                try {
                                    if (receivers_1_1 && !receivers_1_1.done && (_b = receivers_1.return)) _b.call(receivers_1);
                                }
                                finally { if (e_33) throw e_33.error; }
                            }
                            if (receiver) {
                                receiver = receiver.substring(0, receiver.length - 1);
                            }
                            if (receiverName) {
                                receiverName = receiverName.substring(0, receiverName.length - 1);
                            }
                            messageNotice.receiver = receiver;
                            messageNotice.receiverText = receiverName;
                        }
                        if (participants && participants.length > 0) {
                            /** @type {?} */
                            var receiverExpressions = new Array();
                            try {
                                for (var participants_1 = __values(participants), participants_1_1 = participants_1.next(); !participants_1_1.done; participants_1_1 = participants_1.next()) {
                                    var p = participants_1_1.value;
                                    if (p.type === 'processParticipant') {
                                        /** @type {?} */
                                        var activityExecutor = new ActivityExecutorParticipantExpression(userActivity.Model);
                                        activityExecutor.id = BpmnModelHelper.GenerateElementId();
                                        activityExecutor.activityDefId = p.activityDefId;
                                        activityExecutor.activityDefName = p.activityDefName;
                                        receiverExpressions.push(activityExecutor);
                                    }
                                    if (p.type === 'variableParticipant') {
                                        /** @type {?} */
                                        var variableParticipant = new UserParticipantExpression(userActivity.Model, p.variableParticipant, p.variableName, p.orgType);
                                        variableParticipant.id = BpmnModelHelper.GenerateElementId();
                                        variableParticipant.Tag = 'expression';
                                        variableParticipant.OrgType = p.orgType;
                                        receiverExpressions.push(variableParticipant);
                                    }
                                    if (p.type === 'positionParticipant') {
                                        /** @type {?} */
                                        var posiParticipant = new PositionParticipantExpression(userActivity.Model, p.positionId, p.positionName);
                                        posiParticipant.id = BpmnModelHelper.GenerateElementId();
                                        posiParticipant.PositionType = p.positionType;
                                        if (p.positionType === '1') {
                                            posiParticipant.OrgId = p.orgId;
                                            posiParticipant.OrgType = p.orgType;
                                        }
                                        receiverExpressions.push(posiParticipant);
                                    }
                                }
                            }
                            catch (e_34_1) { e_34 = { error: e_34_1 }; }
                            finally {
                                try {
                                    if (participants_1_1 && !participants_1_1.done && (_c = participants_1.return)) _c.call(participants_1);
                                }
                                finally { if (e_34) throw e_34.error; }
                            }
                            messageNotice.receiverExpressions = receiverExpressions;
                        }
                    }
                    if (n.smsMessageTemplate) {
                        /** @type {?} */
                        var smsMessageTemplate = new SmsMessageTemplate(userActivity.Model);
                        smsMessageTemplate.code = n.smsMessageTemplate.code;
                        smsMessageTemplate.content = n.smsMessageTemplate.content;
                        smsMessageTemplate.smsMessageVariables = new Array();
                        if (n.smsMessageTemplate.smsMessageVariables && n.smsMessageTemplate.smsMessageVariables.length > 0) {
                            try {
                                for (var _e = __values(n.smsMessageTemplate.smsMessageVariables), _f = _e.next(); !_f.done; _f = _e.next()) {
                                    var v = _f.value;
                                    /** @type {?} */
                                    var variable = new SmsMessageVariable(userActivity.Model);
                                    variable.code = v.code;
                                    variable.value = v.value;
                                    variable.tag = v.tag;
                                    smsMessageTemplate.smsMessageVariables.push(variable);
                                }
                            }
                            catch (e_35_1) { e_35 = { error: e_35_1 }; }
                            finally {
                                try {
                                    if (_f && !_f.done && (_d = _e.return)) _d.call(_e);
                                }
                                finally { if (e_35) throw e_35.error; }
                            }
                        }
                        messageNotice.smsMessageTemplate = smsMessageTemplate;
                    }
                    userActivity.messageNotices.push(messageNotice);
                }
            }
            catch (e_32_1) { e_32 = { error: e_32_1 }; }
            finally {
                try {
                    if (notices_1_1 && !notices_1_1.done && (_a = notices_1.return)) _a.call(notices_1);
                }
                finally { if (e_32) throw e_32.error; }
            }
        }
    };
    /**
     * @param {?} userActivity
     * @param {?} obj
     * @return {?}
     */
    UserActivityCell.prototype.updateApprovalPivotConfig = /**
     * @param {?} userActivity
     * @param {?} obj
     * @return {?}
     */
    function (userActivity, obj) {
        var e_36, _a;
        /** @type {?} */
        var config = obj.propertyValue;
        /** @type {?} */
        var approvalPivotConfig = new ApprovalPivotConfig(userActivity.Model);
        approvalPivotConfig.enable = config.enable;
        approvalPivotConfig.expand = config.expand;
        approvalPivotConfig.title = config.title;
        approvalPivotConfig.approvalPivots = new Array();
        if (config.approvalPivots && config.approvalPivots.length > 0) {
            try {
                for (var _b = __values(config.approvalPivots), _c = _b.next(); !_c.done; _c = _b.next()) {
                    var a = _c.value;
                    /** @type {?} */
                    var approvalPivot = new ApprovalPivot(userActivity.Model);
                    approvalPivot.type = a.type;
                    approvalPivot.title = a.title;
                    approvalPivot.description = a.description;
                    if (a.condition) {
                        /** @type {?} */
                        var condition = new Condition(userActivity.Model);
                        condition.Value = a.condition;
                        approvalPivot.condition = condition;
                    }
                    approvalPivotConfig.approvalPivots.push(approvalPivot);
                }
            }
            catch (e_36_1) { e_36 = { error: e_36_1 }; }
            finally {
                try {
                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                }
                finally { if (e_36) throw e_36.error; }
            }
        }
        userActivity.approvalPivotConfig = approvalPivotConfig;
    };
    /**
     * @param {?} userActivity
     * @param {?} obj
     * @return {?}
     */
    UserActivityCell.prototype.updateUrgeHandleRule = /**
     * @param {?} userActivity
     * @param {?} obj
     * @return {?}
     */
    function (userActivity, obj) {
        var e_37, _a;
        /** @type {?} */
        var rule = obj.propertyValue;
        /** @type {?} */
        var urgeHandleRule = new UrgeHandleRule(userActivity.Model);
        urgeHandleRule.urgeHandleAble = rule.urgeHandleAble;
        urgeHandleRule.sendType = rule.sendType;
        urgeHandleRule.earlyTime = rule.earlyTime;
        urgeHandleRule.intervalTime = rule.intervalTime;
        urgeHandleRule.urgeMessageSubject = rule.urgeMessageSubject;
        urgeHandleRule.urgeMessageContent = rule.urgeMessageContent;
        urgeHandleRule.addReminder = rule.addReminder;
        urgeHandleRule.subjectEditable = rule.subjectEditable;
        urgeHandleRule.contentEditable = rule.contentEditable;
        if (rule.smsMessageTemplate) {
            /** @type {?} */
            var smsMessageTemplate = new SmsMessageTemplate(userActivity.Model);
            smsMessageTemplate.code = rule.smsMessageTemplate.code;
            smsMessageTemplate.content = rule.smsMessageTemplate.content;
            smsMessageTemplate.smsMessageVariables = new Array();
            if (rule.smsMessageTemplate.smsMessageVariables && rule.smsMessageTemplate.smsMessageVariables.length > 0) {
                try {
                    for (var _b = __values(rule.smsMessageTemplate.smsMessageVariables), _c = _b.next(); !_c.done; _c = _b.next()) {
                        var v = _c.value;
                        /** @type {?} */
                        var variable = new SmsMessageVariable(userActivity.Model);
                        variable.code = v.code;
                        variable.value = v.value;
                        variable.tag = v.tag;
                        smsMessageTemplate.smsMessageVariables.push(variable);
                    }
                }
                catch (e_37_1) { e_37 = { error: e_37_1 }; }
                finally {
                    try {
                        if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                    }
                    finally { if (e_37) throw e_37.error; }
                }
            }
            urgeHandleRule.smsMessageTemplate = smsMessageTemplate;
        }
        userActivity.urgeHandleRule = urgeHandleRule;
    };
    /**
     * 删除节点或参与者时，对应删除HumanResourceRoles
     * @param bpmnModel
     * @param ids
     */
    /**
     * 删除节点或参与者时，对应删除HumanResourceRoles
     * @param {?} ids
     * @return {?}
     */
    UserActivityCell.prototype.removeHumanResourceRoles = /**
     * 删除节点或参与者时，对应删除HumanResourceRoles
     * @param {?} ids
     * @return {?}
     */
    function (ids) {
        /** @type {?} */
        var bpmnModel = this.flowElement.Model;
        if (ids && ids.length > 0) {
            /** @type {?} */
            var userActivitys = bpmnModel.DefaultProcess.GetFlowElements();
            /** @type {?} */
            var perfIds_1 = '';
            for (var key in userActivitys) {
                if (userActivitys[key] instanceof UserActivity) {
                    /** @type {?} */
                    var userAct = (/** @type {?} */ (userActivitys[key]));
                    if (userAct.ParticipantSchemes && userAct.ParticipantSchemes.length > 0 && userAct.ParticipantSchemes[0].Performers) {
                        perfIds_1 += (userAct.ParticipantSchemes[0].Performers + ',');
                    }
                }
            }
            /** @type {?} */
            var removeIds = ids.filter((/**
             * @param {?} id
             * @return {?}
             */
            function (id) { return perfIds_1.indexOf(id) < 0; }));
            removeIds.forEach((/**
             * @param {?} reId
             * @return {?}
             */
            function (reId) {
                bpmnModel.DefaultProcess.RemoveResourceRole(reId);
            }));
        }
    };
    /**
     * 更新审批活动扩展属性
     * @param userActivity
     * @param obj
     */
    /**
     * 更新审批活动扩展属性
     * @param {?} userActivity
     * @param {?} obj
     * @return {?}
     */
    UserActivityCell.prototype.resetExtendProperty = /**
     * 更新审批活动扩展属性
     * @param {?} userActivity
     * @param {?} obj
     * @return {?}
     */
    function (userActivity, obj) {
        var e_38, _a;
        if (userActivity) {
            /** @type {?} */
            var attributes = (/** @type {?} */ (obj.propertyValue));
            if (!userActivity.extendProperties) {
                userActivity.extendProperties = new Array();
            }
            var _loop_2 = function (o) {
                /** @type {?} */
                var index = userActivity.extendProperties.findIndex((/**
                 * @param {?} e
                 * @return {?}
                 */
                function (e) { return e.key === o.code; }));
                if (index > -1) {
                    userActivity.extendProperties.splice(index, 1);
                }
            };
            try {
                for (var _b = __values(obj.propertyValue), _c = _b.next(); !_c.done; _c = _b.next()) {
                    var o = _c.value;
                    _loop_2(o);
                }
            }
            catch (e_38_1) { e_38 = { error: e_38_1 }; }
            finally {
                try {
                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                }
                finally { if (e_38) throw e_38.error; }
            }
            if (attributes) {
                attributes.forEach((/**
                 * @param {?} a
                 * @return {?}
                 */
                function (a) {
                    /** @type {?} */
                    var item = new ExtendProperty(userActivity.Model);
                    item.key = a.code;
                    item.value = a.value;
                    userActivity.extendProperties.push(item);
                }));
            }
        }
    };
    UserActivityCell.CLR_TYPE_ID = UserActivity.Clr_Type_ID;
    return UserActivityCell;
}(NodeCell));

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/**
 * 人工操作活动节点
 */
var OperationActivityCell = /** @class */ (function (_super) {
    __extends(OperationActivityCell, _super);
    function OperationActivityCell(value, geometry, style) {
        var _a;
        var _this = _super.call(this, value, geometry, style) || this;
        _this.clrTypeId = OperationActivityCell.CLR_TYPE_ID;
        _this.name = "人工操作";
        _this.nameLanguage = {
            "zh-CHS": "人工操作",
            "zh-CHT": "人工操作",
            "en": "Operation",
        };
        _this.imgUrls = (_a = {},
            _a[FlowNodeState.Default] = WfConstants.IMAGE_PATH + "/bizActivity.png",
            _a[FlowNodeState.Selected] = WfConstants.IMAGE_PATH + "/bizActivity_select.svg",
            _a);
        return _this;
    }
    /**
     * @param {?=} flowElt
     * @return {?}
     */
    OperationActivityCell.prototype.createFlowElement = /**
     * @param {?=} flowElt
     * @return {?}
     */
    function (flowElt) {
        /** @type {?} */
        var flowNode = (/** @type {?} */ (_super.prototype.createFlowElement.call(this, flowElt)));
        return flowNode;
    };
    /**
     * @return {?}
     */
    OperationActivityCell.prototype.getFarrisPropConfig = /**
     * @return {?}
     */
    function () {
        return this.getFarrisPropConfigByIsOperation(true);
    };
    /**
     * @param {?} obj
     * @return {?}
     */
    OperationActivityCell.prototype.updateProps = /**
     * @param {?} obj
     * @return {?}
     */
    function (obj) {
        this.updatePropsByIsOperation(obj, true);
    };
    OperationActivityCell.CLR_TYPE_ID = OperationActivity.Clr_Type_ID;
    return OperationActivityCell;
}(UserActivityCell));

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/** @enum {string} */
var StartActivityPropertyKeys = {
    Id: "Id",
    Name: "Name",
    NameLanguage: "NameLanguage",
    ClrTypeID: "ClrTypeID",
    /**
     * 是否允许选择目标节点
     */
    SelectTargetAble: 'SelectTargetAble',
    /**
     * 跳转范围
     */
    JumpScope: 'JumpScope',
    ExecuteForms: 'ExecuteForms',
    wf_ExecuteForms_PC: 'wf_ExecuteForms_PC',
    wf_ExecuteForms_Mobile: 'wf_ExecuteForms_Mobile',
    otherAssignNodes: 'otherAssignNodes',
    otherAssignActivities: 'otherAssignActivities',
    otherAssignActivityNodeInfos: 'OtherAssignActivityNodeInfos',
    sendBackedTask: "sendBackedTask",
};

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/**
 * 开始活动节点
 */
var StartActivityCell = /** @class */ (function (_super) {
    __extends(StartActivityCell, _super);
    function StartActivityCell(value, geometry, style) {
        var _a;
        var _this = _super.call(this, value, geometry, style) || this;
        _this.clrTypeId = StartActivityCell.CLR_TYPE_ID;
        _this.name = "开始";
        _this.nameLanguage = {
            "zh-CHS": "开始",
            "zh-CHT": "開始",
            "en": "Start",
        };
        _this.imgUrls = (_a = {},
            _a[FlowNodeState.Default] = WfConstants.IMAGE_PATH + "/start.png",
            _a[FlowNodeState.Selected] = WfConstants.IMAGE_PATH + "/start_select.svg",
            _a);
        return _this;
    }
    /**
     * @param {?=} flowElt
     * @return {?}
     */
    StartActivityCell.prototype.createFlowElement = /**
     * @param {?=} flowElt
     * @return {?}
     */
    function (flowElt) {
        /** @type {?} */
        var flowNode = (/** @type {?} */ (_super.prototype.createFlowElement.call(this, flowElt)));
        /** @type {?} */
        var editorUi = this.editorUi;
        flowNode.Id = "startActivity" + BpmnModelHelper.GenerateElementId();
        // 创建而非复制时执行
        if (flowElt == null) {
            // 设置默认表单
            if (editorUi && editorUi.formFormats) {
                /** @type {?} */
                var formFormats = editorUi.formFormats;
                /** @type {?} */
                var startActivityForms = new Array();
                /** @type {?} */
                var pcForm = formFormats.filter((/**
                 * @param {?} f
                 * @return {?}
                 */
                function (f) { return f.terminal === 'PC' && f.status === 1; }))[0];
                if (pcForm) {
                    startActivityForms.push(pcForm);
                }
                /** @type {?} */
                var mobileForm = formFormats.filter((/**
                 * @param {?} f
                 * @return {?}
                 */
                function (f) { return f.terminal === 'Mobile' && f.status === 1; }))[0];
                if (mobileForm) {
                    startActivityForms.push(mobileForm);
                }
                if (startActivityForms && startActivityForms.length > 0) {
                    flowNode.setDefaultForms(startActivityForms);
                }
            }
        }
        return flowNode;
    };
    /**
     * @return {?}
     */
    StartActivityCell.prototype.getFarrisPropConfig = /**
     * @return {?}
     */
    function () {
        var e_1, _a, e_2, _b, e_3, _c;
        /** @type {?} */
        var editorUi = this.editorUi;
        /** @type {?} */
        var act = (/** @type {?} */ (this.flowElement));
        /** @type {?} */
        var extendList = [];
        if (editorUi.procExtProps && editorUi.procExtProps.length > 0) {
            extendList = JSON.parse(JSON.stringify(editorUi.procExtProps)).sort((/**
             * @param {?} a
             * @param {?} b
             * @return {?}
             */
            function (a, b) {
                return a.sortOrder - b.sortOrder;
            }));
        }
        extendList = extendList.sort((/**
         * @param {?} a
         * @param {?} b
         * @return {?}
         */
        function (a, b) {
            return a.sortOrder - b.sortOrder;
        }));
        /** @type {?} */
        var PropertyConfig = new ElementPropertyConfig();
        /** @type {?} */
        var propertyData = new Object();
        PropertyConfig.categoryId = 'general';
        PropertyConfig.categoryName = mxResources.get('basicInformation');
        PropertyConfig.tabId = 'basic';
        PropertyConfig.tabName = mxResources.get('basicAttributes');
        PropertyConfig.properties = [
            { propertyID: StartActivityPropertyKeys.Name, propertyName: mxResources.get('name'), propertyType: 'string', visible: !this.editorUi.multiLangEnabled },
            { propertyID: StartActivityPropertyKeys.NameLanguage, propertyName: mxResources.get('nameLanguage'), propertyType: 'multiLanguage', visible: this.editorUi.multiLangEnabled },
            { propertyID: StartActivityPropertyKeys.Id, propertyName: mxResources.get('id'), propertyType: 'string', readonly: true }
        ];
        /** @type {?} */
        var formDef = new ElementPropertyConfig();
        formDef.categoryId = 'formDef';
        formDef.categoryName = mxResources.get('formDef');
        formDef.tabId = 'basic';
        formDef.tabName = mxResources.get('basicAttributes');
        formDef.properties = [
            { propertyID: StartActivityPropertyKeys.wf_ExecuteForms_PC, propertyName: mxResources.get('pcForm'), propertyType: 'modal' },
            { propertyID: StartActivityPropertyKeys.wf_ExecuteForms_Mobile, propertyName: mxResources.get('webForm'), propertyType: 'modal' },
        ];
        /** @type {?} */
        var ActivityConfig = new ElementPropertyConfig();
        ActivityConfig.categoryId = 'activityConfig';
        ActivityConfig.categoryName = mxResources.get('activityProperty');
        ActivityConfig.tabId = 'basic';
        ActivityConfig.tabName = mxResources.get('basicAttributes');
        ActivityConfig.properties = [
            // { propertyID: StartActivityPropertyKeys.ExecuteForms, propertyName: mxResources.get('formDef'), propertyType: 'modal' },
            { propertyID: 'sendBackedTask', propertyName: mxResources.get('sendBackedTask'), propertyType: 'select' }
        ];
        if (act.selectTargetAble) {
            ActivityConfig.properties = ActivityConfig.properties.concat([
                { propertyID: StartActivityPropertyKeys.SelectTargetAble, propertyName: mxResources.get('selectTargetAble'), propertyType: 'select' },
                { propertyID: StartActivityPropertyKeys.JumpScope, propertyName: mxResources.get('jumpScope'), propertyType: 'modal' }
            ]);
            propertyData.SelectTargetAble = act.selectTargetAble || false;
            propertyData.JumpScope = act.jumpScope;
        }
        else {
            ActivityConfig.properties = ActivityConfig.properties.concat([
                { propertyID: StartActivityPropertyKeys.SelectTargetAble, propertyName: mxResources.get('selectTargetAble'), propertyType: 'select' }
            ]);
            propertyData.SelectTargetAble = act.selectTargetAble || false;
        }
        if (act.otherAssignNodes) {
            ActivityConfig.properties = ActivityConfig.properties.concat([
                { propertyID: StartActivityPropertyKeys.otherAssignNodes, propertyName: mxResources.get('otherAssignNodes'), propertyType: 'select' },
                // { propertyID: StartActivityPropertyKeys.otherAssignActivities, propertyName: mxResources.get('otherAssignActivities'), propertyType: 'modal' }
                { propertyID: StartActivityPropertyKeys.otherAssignActivityNodeInfos, propertyName: mxResources.get('otherAssignActivityNodeInfos'), propertyType: 'modal' }
            ]);
            propertyData[StartActivityPropertyKeys.otherAssignNodes] = true;
            // propertyData[StartActivityPropertyKeys.otherAssignActivities] = act.otherAssignNodes.otherAssignActivities;
            propertyData[StartActivityPropertyKeys.otherAssignActivityNodeInfos] = act.otherAssignNodes.otherAssignActivities || act.otherAssignNodes.otherAssignActivityNodeInfos;
            if (act.otherAssignNodes.otherAssignActivities) {
                act.otherAssignNodes.otherAssignActivities = null;
            }
        }
        else {
            ActivityConfig.properties = ActivityConfig.properties.concat([
                { propertyID: StartActivityPropertyKeys.otherAssignNodes, propertyName: mxResources.get('otherAssignNodes'), propertyType: 'select' }
            ]);
            propertyData[StartActivityPropertyKeys.otherAssignNodes] = false;
        }
        /** @type {?} */
        var groupList = new Array();
        try {
            for (var extendList_1 = __values(extendList), extendList_1_1 = extendList_1.next(); !extendList_1_1.done; extendList_1_1 = extendList_1.next()) {
                var extend = extendList_1_1.value;
                if (!extend.parentId) {
                    /** @type {?} */
                    var group = { parent: extend, childs: new Array() };
                    try {
                        for (var extendList_2 = __values(extendList), extendList_2_1 = extendList_2.next(); !extendList_2_1.done; extendList_2_1 = extendList_2.next()) {
                            var e = extendList_2_1.value;
                            if (e.parentId === extend.id) {
                                group.childs.push(e);
                            }
                        }
                    }
                    catch (e_2_1) { e_2 = { error: e_2_1 }; }
                    finally {
                        try {
                            if (extendList_2_1 && !extendList_2_1.done && (_b = extendList_2.return)) _b.call(extendList_2);
                        }
                        finally { if (e_2) throw e_2.error; }
                    }
                    groupList.push(group);
                }
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (extendList_1_1 && !extendList_1_1.done && (_a = extendList_1.return)) _a.call(extendList_1);
            }
            finally { if (e_1) throw e_1.error; }
        }
        // 没有扩展属性值的时候不显示扩展属性一栏
        if (groupList && groupList.length > 0) {
            /** @type {?} */
            var ExtendPropertyConfig = new ElementPropertyConfig();
            ExtendPropertyConfig.categoryId = 'extendPropertyConfig';
            ExtendPropertyConfig.categoryName = mxResources.get('extendPropertyConfig');
            ExtendPropertyConfig.tabId = 'advanced';
            ExtendPropertyConfig.tabName = mxResources.get('advancedAttributes');
            ExtendPropertyConfig.properties = new Array();
            try {
                for (var groupList_1 = __values(groupList), groupList_1_1 = groupList_1.next(); !groupList_1_1.done; groupList_1_1 = groupList_1.next()) {
                    var g = groupList_1_1.value;
                    ExtendPropertyConfig.properties.push({ propertyID: g.parent.id, propertyName: g.parent.propertyTitle, propertyType: 'modal' });
                    // 取回模型上的value值给到扩展属性组件里
                    if (act.extendProperties && act.extendProperties.length > 0) {
                        g.childs.sort((/**
                         * @param {?} a
                         * @param {?} b
                         * @return {?}
                         */
                        function (a, b) {
                            return a.sortOrder - b.sortOrder;
                        })).forEach((/**
                         * @param {?} d
                         * @return {?}
                         */
                        function (d) {
                            act.extendProperties.forEach((/**
                             * @param {?} e
                             * @return {?}
                             */
                            function (e) {
                                if (e.key == d.code) {
                                    d.value = e.value;
                                }
                            }));
                        }));
                    }
                    propertyData[g.parent.id] = g.childs;
                }
            }
            catch (e_3_1) { e_3 = { error: e_3_1 }; }
            finally {
                try {
                    if (groupList_1_1 && !groupList_1_1.done && (_c = groupList_1.return)) _c.call(groupList_1);
                }
                finally { if (e_3) throw e_3.error; }
            }
            // todo：与else分支代码重复，可提取至if语句外，本次修改仅针对名称多语，故暂不修改
            propertyData[StartActivityPropertyKeys.Id] = act.Id;
            propertyData[StartActivityPropertyKeys.ClrTypeID] = act.ClrTypeID;
            propertyData[StartActivityPropertyKeys.Name] = act.Name || mxResources.get('start');
            propertyData[StartActivityPropertyKeys.NameLanguage] = act.NameLanguage || {
                "zh-CHS": act.Name,
            };
            propertyData[StartActivityPropertyKeys.sendBackedTask] = act.sendBackedTask;
            propertyData[StartActivityPropertyKeys.wf_ExecuteForms_PC] =
                act.ExecuteForms ? act.ExecuteForms.find((/**
                 * @param {?} e
                 * @return {?}
                 */
                function (e) { return e.TerminalType === 'PC'; })) : null;
            propertyData[StartActivityPropertyKeys.wf_ExecuteForms_Mobile] =
                act.ExecuteForms ? act.ExecuteForms.find((/**
                 * @param {?} e
                 * @return {?}
                 */
                function (e) { return e.TerminalType === 'MOBILE'; })) : null;
            return {
                propertyConfig: [PropertyConfig, formDef, ActivityConfig, ExtendPropertyConfig],
                propertyData: propertyData
            };
        }
        else {
            propertyData[StartActivityPropertyKeys.Id] = act.Id;
            propertyData[StartActivityPropertyKeys.ClrTypeID] = act.ClrTypeID;
            propertyData[StartActivityPropertyKeys.Name] = act.Name || mxResources.get('start');
            propertyData[StartActivityPropertyKeys.NameLanguage] = act.NameLanguage || {
                "zh-CHS": act.Name,
            };
            propertyData[StartActivityPropertyKeys.sendBackedTask] = act.sendBackedTask;
            propertyData[StartActivityPropertyKeys.wf_ExecuteForms_PC] =
                act.ExecuteForms ? act.ExecuteForms.find((/**
                 * @param {?} e
                 * @return {?}
                 */
                function (e) { return e.TerminalType === 'PC'; })) : null;
            propertyData[StartActivityPropertyKeys.wf_ExecuteForms_Mobile] =
                act.ExecuteForms ? act.ExecuteForms.find((/**
                 * @param {?} e
                 * @return {?}
                 */
                function (e) { return e.TerminalType === 'MOBILE'; })) : null;
            return {
                propertyConfig: [PropertyConfig, formDef, ActivityConfig],
                propertyData: propertyData
            };
        }
    };
    /**
     * @param {?} obj
     * @return {?}
     */
    StartActivityCell.prototype.updateProps = /**
     * @param {?} obj
     * @return {?}
     */
    function (obj) {
        /** @type {?} */
        var editorUi = this.editorUi;
        /** @type {?} */
        var startActivity = this.flowElement;
        /** @type {?} */
        var propertyId = obj.propertyID;
        switch (propertyId) {
            case StartActivityPropertyKeys.wf_ExecuteForms_PC:
                this.updateStartActivityForm(startActivity, obj, 'PC');
                if (obj.parameters && obj.parameters.length > 0) {
                    PropertyHelper.updateFormalParameters(editorUi.graph.bpmnModel.DefaultProcess, obj.parameters);
                }
                break;
            case StartActivityPropertyKeys.wf_ExecuteForms_Mobile:
                this.updateStartActivityForm(startActivity, obj, 'MOBILE');
                if (obj.parameters && obj.parameters.length > 0) {
                    PropertyHelper.updateFormalParameters(editorUi.graph.bpmnModel.DefaultProcess, obj.parameters);
                }
                break;
            case StartActivityPropertyKeys.SelectTargetAble:
                this.resetSelectTargetAble(startActivity, obj);
                break;
            case StartActivityPropertyKeys.JumpScope:
                this.resetJumpScope(startActivity, obj);
                break;
            case StartActivityPropertyKeys.otherAssignNodes:
                this.updateOtherAssignNodes(startActivity, obj);
                break;
            case StartActivityPropertyKeys.otherAssignActivities:
                this.updateOtherAssignActivities(startActivity, obj);
                break;
            case StartActivityPropertyKeys.otherAssignActivityNodeInfos:
                this.updateOtherAssignActivities(startActivity, obj);
                break;
            default:
                // 判断ResourceKeys是不是groupid,是就走resetExtendProperty
                if (editorUi.procExtProps.findIndex((/**
                 * @param {?} p
                 * @return {?}
                 */
                function (p) { return p.id === propertyId; })) > -1) {
                    this.resetExtendProperty(startActivity, obj);
                }
                else {
                    _super.prototype.updateProps.call(this, obj);
                }
                break;
        }
    };
    /**
     * @param {?} start
     * @param {?} obj
     * @param {?} terminal
     * @return {?}
     */
    StartActivityCell.prototype.updateStartActivityForm = /**
     * @param {?} start
     * @param {?} obj
     * @param {?} terminal
     * @return {?}
     */
    function (start, obj, terminal) {
        var e_4, _a;
        if (start) {
            /** @type {?} */
            var form = (/** @type {?} */ (obj.propertyValue));
            if (!start.ExecuteForms) {
                start.ExecuteForms = new Array();
            }
            start.ExecuteForms = start.ExecuteForms.filter((/**
             * @param {?} e
             * @return {?}
             */
            function (e) { return e.TerminalType !== terminal; }));
            if (form) {
                /** @type {?} */
                var params = (/** @type {?} */ (form.ActualParameters));
                /** @type {?} */
                var actParas = new Array();
                if (params && params.length > 0) {
                    try {
                        for (var params_1 = __values(params), params_1_1 = params_1.next(); !params_1_1.done; params_1_1 = params_1.next()) {
                            var para = params_1_1.value;
                            /** @type {?} */
                            var actPara = new ActualParameter(start.Model, para.Name, para.Value);
                            if (para.Tag) {
                                actPara.Tag = para.Tag;
                            }
                            else {
                                if (para.Value) {
                                    if (para.Value.length >= 8 && para.Value.slice(0, 8) === "{\"expr\":") {
                                        actPara.Tag = 'expression';
                                    }
                                    else {
                                        actPara.Tag = 'constant';
                                    }
                                }
                                else {
                                    actPara.Tag = 'variable';
                                }
                            }
                            actParas.push(actPara);
                        }
                    }
                    catch (e_4_1) { e_4 = { error: e_4_1 }; }
                    finally {
                        try {
                            if (params_1_1 && !params_1_1.done && (_a = params_1.return)) _a.call(params_1);
                        }
                        finally { if (e_4) throw e_4.error; }
                    }
                }
                /** @type {?} */
                var id = BpmnModelHelper.GenerateElementId();
                /** @type {?} */
                var item = new ExecuteForm(start.Model, id, form.Name, actParas);
                item.ComponentId = form.ComponentId;
                item.FormType = form.FormType;
                item.formFormatId = form.formFormatId;
                item.formatConfigId = form.formatConfigId;
                item.TerminalType = form.TerminalType;
                start.ExecuteForms.push(item);
            }
        }
    };
    /**
     * 更新是否允许跳转属性
     * @param startActivity
     * @param obj
     */
    /**
     * 更新是否允许跳转属性
     * @param {?} startActivity
     * @param {?} obj
     * @return {?}
     */
    StartActivityCell.prototype.resetSelectTargetAble = /**
     * 更新是否允许跳转属性
     * @param {?} startActivity
     * @param {?} obj
     * @return {?}
     */
    function (startActivity, obj) {
        /** @type {?} */
        var selectTargetAble = (/** @type {?} */ (obj.propertyValue));
        startActivity.selectTargetAble = selectTargetAble;
        if (startActivity.selectTargetAble) {
            startActivity.jumpScope = new JumpScope(startActivity.Model);
        }
        else {
            startActivity.jumpScope = null;
        }
    };
    /**
     * @param {?} startActivity
     * @param {?} obj
     * @return {?}
     */
    StartActivityCell.prototype.resetJumpScope = /**
     * @param {?} startActivity
     * @param {?} obj
     * @return {?}
     */
    function (startActivity, obj) {
        /** @type {?} */
        var data = obj.propertyValue;
        if (data) {
            /** @type {?} */
            var jumpScope = new JumpScope(startActivity.Model);
            jumpScope.Category = data.Category;
            jumpScope.DefaultType = data.DefaultType;
            jumpScope.DefaultActivity = data.DefaultActivity;
            jumpScope.DestinationActivities = data.DestinationActivities;
            startActivity.jumpScope = jumpScope;
        }
        else {
            startActivity.jumpScope = null;
        }
    };
    /**
     * @param {?} startActivity
     * @param {?} obj
     * @return {?}
     */
    StartActivityCell.prototype.updateOtherAssignNodes = /**
     * @param {?} startActivity
     * @param {?} obj
     * @return {?}
     */
    function (startActivity, obj) {
        /** @type {?} */
        var data = obj.propertyValue;
        if (data) {
            // const otherAssignNodes = new OtherAssignNodes(startActivity.Model);
            // otherAssignNodes.otherAssignActivities = new Array();
            // startActivity.otherAssignNodes = otherAssignNodes;
            startActivity.otherAssignNodes = new OtherAssignNodes(startActivity.Model);
        }
        else {
            startActivity.otherAssignNodes = null;
        }
    };
    /**
     * @param {?} startActivity
     * @param {?} obj
     * @return {?}
     */
    StartActivityCell.prototype.updateOtherAssignActivities = /**
     * @param {?} startActivity
     * @param {?} obj
     * @return {?}
     */
    function (startActivity, obj) {
        /** @type {?} */
        var data = obj.propertyValue;
        if (data && data.length > 0) {
            if (typeof data[0] === "string") {
                startActivity.otherAssignNodes.otherAssignActivityNodeInfos = new Array();
                data.forEach((/**
                 * @param {?} d
                 * @return {?}
                 */
                function (d) {
                    /** @type {?} */
                    var other = new OtherAssignActivityNodeInfo(startActivity.Model);
                    other.activityDefinitionId = d;
                    other.required = false;
                    other.condition = new Condition(startActivity.Model);
                    startActivity.otherAssignNodes.otherAssignActivityNodeInfos.push(other);
                }));
            }
            else {
                // startActivity.otherAssignNodes.otherAssignActivityNodeInfos = [...data];  
                startActivity.otherAssignNodes.otherAssignActivityNodeInfos = new Array();
                data.forEach((/**
                 * @param {?} d
                 * @return {?}
                 */
                function (d) {
                    /** @type {?} */
                    var other = new OtherAssignActivityNodeInfo(startActivity.Model);
                    other.activityDefinitionId = d.activityDefinitionId;
                    other.required = d.required;
                    other.condition = new Condition(startActivity.Model);
                    other.condition.Value = d.condition.Value;
                    startActivity.otherAssignNodes.otherAssignActivityNodeInfos.push(other);
                }));
            }
        }
        else {
            startActivity.otherAssignNodes.otherAssignActivityNodeInfos = new Array();
        }
    };
    /**
     * 更新开始节点扩展属性
     * @param startActivity
     * @param obj
     */
    /**
     * 更新开始节点扩展属性
     * @param {?} startActivity
     * @param {?} obj
     * @return {?}
     */
    StartActivityCell.prototype.resetExtendProperty = /**
     * 更新开始节点扩展属性
     * @param {?} startActivity
     * @param {?} obj
     * @return {?}
     */
    function (startActivity, obj) {
        var e_5, _a;
        if (startActivity) {
            /** @type {?} */
            var attributes = (/** @type {?} */ (obj.propertyValue));
            if (!startActivity.extendProperties) {
                startActivity.extendProperties = new Array();
            }
            var _loop_1 = function (o) {
                /** @type {?} */
                var index = startActivity.extendProperties.findIndex((/**
                 * @param {?} e
                 * @return {?}
                 */
                function (e) { return e.key === o.code; }));
                if (index > -1) {
                    startActivity.extendProperties.splice(index, 1);
                }
            };
            try {
                for (var _b = __values(obj.propertyValue), _c = _b.next(); !_c.done; _c = _b.next()) {
                    var o = _c.value;
                    _loop_1(o);
                }
            }
            catch (e_5_1) { e_5 = { error: e_5_1 }; }
            finally {
                try {
                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                }
                finally { if (e_5) throw e_5.error; }
            }
            if (attributes) {
                attributes.forEach((/**
                 * @param {?} a
                 * @return {?}
                 */
                function (a) {
                    /** @type {?} */
                    var item = new ExtendProperty(startActivity.Model);
                    item.key = a.code;
                    item.value = a.value;
                    startActivity.extendProperties.push(item);
                }));
            }
        }
    };
    StartActivityCell.CLR_TYPE_ID = StartActivity.Clr_Type_ID;
    return StartActivityCell;
}(NodeCell));

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/**
 * 并行事件节点，增加状态图片信息
 */
var  /**
 * 并行事件节点，增加状态图片信息
 */
WfParallelGatewayCell = /** @class */ (function (_super) {
    __extends(WfParallelGatewayCell, _super);
    function WfParallelGatewayCell() {
        var _a;
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this.imgUrls = (_a = {},
            _a[FlowNodeState.Default] = WfConstants.IMAGE_PATH + "/ParallelGateway.png",
            _a[FlowNodeState.Selected] = WfConstants.IMAGE_PATH + "/ParallelGateway_select.svg",
            _a);
        return _this;
    }
    /**
     * @param {?=} flowElt
     * @return {?}
     */
    WfParallelGatewayCell.prototype.createFlowElement = /**
     * @param {?=} flowElt
     * @return {?}
     */
    function (flowElt) {
        /** @type {?} */
        var flowNode = (/** @type {?} */ (_super.prototype.createFlowElement.call(this, flowElt)));
        flowNode.Id = "ParallelGateway" + BpmnModelHelper.GenerateElementId();
        return flowNode;
    };
    return WfParallelGatewayCell;
}(ParallelGatewayCell));

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/**
 * 结束事件节点，增加状态图片信息
 */
var  /**
 * 结束事件节点，增加状态图片信息
 */
WfEndEventCell = /** @class */ (function (_super) {
    __extends(WfEndEventCell, _super);
    function WfEndEventCell() {
        var _a;
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this.imgUrls = (_a = {},
            _a[FlowNodeState.Default] = WfConstants.IMAGE_PATH + "/end.png",
            _a[FlowNodeState.Selected] = WfConstants.IMAGE_PATH + "/end_select.svg",
            _a);
        return _this;
    }
    /**
     * @param {?=} flowElt
     * @return {?}
     */
    WfEndEventCell.prototype.createFlowElement = /**
     * @param {?=} flowElt
     * @return {?}
     */
    function (flowElt) {
        /** @type {?} */
        var flowNode = (/** @type {?} */ (_super.prototype.createFlowElement.call(this, flowElt)));
        flowNode.Id = "EndEvent" + BpmnModelHelper.GenerateElementId();
        return flowNode;
    };
    return WfEndEventCell;
}(EndEventCell));

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/**
 * 排他网关节点，增加状态图片信息
 */
var  /**
 * 排他网关节点，增加状态图片信息
 */
WfInclusiveGatewayCell = /** @class */ (function (_super) {
    __extends(WfInclusiveGatewayCell, _super);
    function WfInclusiveGatewayCell() {
        var _a;
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this.imgUrls = (_a = {},
            _a[FlowNodeState.Default] = WfConstants.IMAGE_PATH + "/InclusiveGateway.png",
            _a[FlowNodeState.Selected] = WfConstants.IMAGE_PATH + "/InclusiveGateway_select.png",
            _a);
        return _this;
    }
    /**
     * @param {?=} flowElt
     * @return {?}
     */
    WfInclusiveGatewayCell.prototype.createFlowElement = /**
     * @param {?=} flowElt
     * @return {?}
     */
    function (flowElt) {
        /** @type {?} */
        var flowNode = (/** @type {?} */ (_super.prototype.createFlowElement.call(this, flowElt)));
        flowNode.Id = "InclusiveGateway" + BpmnModelHelper.GenerateElementId();
        return flowNode;
    };
    return WfInclusiveGatewayCell;
}(InclusiveGatewayCell));

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var BatchSetPropertiesComponent = /** @class */ (function () {
    function BatchSetPropertiesComponent(uistate, localeId, resources, localePipe, resolver, injector, modalService, viewModel) {
        var _this = this;
        this.uistate = uistate;
        this.localeId = localeId;
        this.resources = resources;
        this.localePipe = localePipe;
        this.resolver = resolver;
        this.injector = injector;
        this.modalService = modalService;
        this.viewModel = viewModel;
        this.groupIcon2 = '<i class="f-icon f-icon-lookup"></i>';
        this.submit = new Subject();
        this.cancel = new Subject();
        this.cols = [
            { title: this.localePipe.transform('component.batchSet.name'), field: 'Name', width: 60, searchField: 'Name' },
            { title: 'ID', field: 'Id', width: 90, searchField: 'Id' }
        ];
        this.useractivities = [];
        this.useroperationnotifyactivities = [];
        this.useroperationsubcatchactivities = [];
        this.actis1 = [];
        this.actis2 = [];
        this.actis3 = [];
        this.actis4 = [];
        this.actis5 = [];
        this.addSignFrontActis = [];
        this.addSignBehindActis = [];
        this.transferActis = [];
        this.notifyActis = [];
        this.backWardRuleActis = [];
        this.nullActis = [];
        this.addSignFrontEnable = false;
        this.addSignBehindEnable = false;
        this.transferEnable = false;
        this.notifyEnable = false;
        this.backWardRuleEnable = false;
        this.backWardRule = {};
        this.addSignFrontScope = {};
        this.addSignBehindScope = {};
        this.transferScope = {};
        this.notifyScope = {};
        this.pageInfo = {
            pageIndex: 1,
            pageList: [10, 20, 30, 50],
            pageSize: 20
        };
        this.frontActisSelect = (/**
         * @param {?} rowData
         * @return {?}
         */
        function (rowData) {
            _this.addSignFrontActis = rowData;
            return of$1({
                closeDialog: true
            });
        });
        this.behindActisSelect = (/**
         * @param {?} rowData
         * @return {?}
         */
        function (rowData) {
            _this.addSignBehindActis = rowData;
            return of$1({
                closeDialog: true
            });
        });
        this.notifyActisSelect = (/**
         * @param {?} rowData
         * @return {?}
         */
        function (rowData) {
            _this.notifyActis = rowData;
            return of$1({
                closeDialog: true
            });
        });
        this.transferActisSelect = (/**
         * @param {?} rowData
         * @return {?}
         */
        function (rowData) {
            _this.transferActis = rowData;
            return of$1({
                closeDialog: true
            });
        });
        this.backWardRuleActisSelect = (/**
         * @param {?} rowData
         * @return {?}
         */
        function (rowData) {
            _this.backWardRuleActis = rowData;
            return of$1({
                closeDialog: true
            });
        });
        this.actisSelect = (/**
         * @param {?} rowData
         * @return {?}
         */
        function (rowData) {
            return of$1({
                closeDialog: true
            });
        });
        // 过滤只有审批节点的
        this.useractivities = this.uistate.userActList.filter((/**
         * @param {?} item
         * @return {?}
         */
        function (item) {
            return item.ClrTypeID === UserActivity.Clr_Type_ID;
        }));
        // 拼接审批+人工+知会
        this.useroperationnotifyactivities = __spread(this.uistate.userActList, this.uistate.NotifyActKist);
        // 拼接审批人工子流程信号捕获
        this.useroperationsubcatchactivities = __spread(this.uistate.userActList, this.uistate.SubAndCatchActList);
        this.localePipe = this.localePipe || new WfLocalePipe(localeId, resources);
    }
    /**
     * @return {?}
     */
    BatchSetPropertiesComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var addSignFront = this.activityModel.dynamicParticipants.filter((/**
         * @param {?} participant
         * @return {?}
         */
        function (participant) {
            return participant.actionScope === "AddSignFront";
        }));
        /** @type {?} */
        var addSignBehind = this.activityModel.dynamicParticipants.filter((/**
         * @param {?} participant
         * @return {?}
         */
        function (participant) {
            return participant.actionScope === "AddSignBehind";
        }));
        /** @type {?} */
        var transfer = this.activityModel.dynamicParticipants.filter((/**
         * @param {?} participant
         * @return {?}
         */
        function (participant) {
            return participant.actionScope === "Transfer";
        }));
        /** @type {?} */
        var notify = this.activityModel.dynamicParticipants.filter((/**
         * @param {?} participant
         * @return {?}
         */
        function (participant) {
            return participant.actionScope === "Notify";
        }));
        if (!addSignFront[0] || addSignFront[0].organizationLevel) {
            this.addSignFrontScope = {
                enable: this.activityModel.AddSignFrontAble,
                action: "AddSignFront",
                scope: addSignFront[0]
            };
        }
        else {
            /** @type {?} */
            var scope = new OrganizationPotentialOwner();
            /** @type {?} */
            var participant = new ParticipantInfo();
            participant.potentialOwnerList = addSignFront;
            participant.isAllScope = true; //反的
            scope.participantInfo = participant;
            this.addSignFrontScope = {
                enable: this.activityModel.AddSignFrontAble,
                action: "AddSignFront",
                scope: scope
            };
        }
        if (!addSignBehind[0] || addSignBehind[0].organizationLevel) {
            this.addSignBehindScope = {
                enable: this.activityModel.AddSignBehindAble,
                action: "AddSignBehind",
                scope: addSignBehind[0]
            };
        }
        else {
            /** @type {?} */
            var scope = new OrganizationPotentialOwner();
            /** @type {?} */
            var participant = new ParticipantInfo();
            participant.potentialOwnerList = addSignBehind;
            participant.isAllScope = true; //反的
            scope.participantInfo = participant;
            this.addSignBehindScope = {
                enable: this.activityModel.AddSignBehindAble,
                action: "AddSignBehind",
                scope: scope
            };
        }
        if (!transfer[0] || transfer[0].organizationLevel) {
            this.transferScope = {
                enable: this.activityModel.transferAble,
                action: "Transfer",
                scope: transfer[0]
            };
        }
        else {
            /** @type {?} */
            var scope = new OrganizationPotentialOwner();
            /** @type {?} */
            var participant = new ParticipantInfo();
            participant.potentialOwnerList = transfer;
            participant.isAllScope = true; //反的
            scope.participantInfo = participant;
            this.transferScope = {
                enable: this.activityModel.transferAble,
                action: "Transfer",
                scope: scope
            };
        }
        if (!notify[0] || notify[0].organizationLevel) {
            this.notifyScope = {
                enable: this.activityModel.NotifyAble,
                action: "Notify",
                scope: notify[0]
            };
        }
        else {
            /** @type {?} */
            var scope = new OrganizationPotentialOwner();
            /** @type {?} */
            var participant = new ParticipantInfo();
            participant.potentialOwnerList = notify;
            participant.isAllScope = true; //反的
            scope.participantInfo = participant;
            this.notifyScope = {
                enable: this.activityModel.NotifyAble,
                action: "Notify",
                scope: scope
            };
        }
        this.backWardRule = this.activityModel.BackWardRule;
    };
    // addSignFrontConfig() {
    //   const compFactory = this.resolver.resolveComponentFactory(OrganizationPotentialOwnerComponent);
    //   const compRef = compFactory.create(this.injector);
    //   compRef.instance.action = ActionScope.AddSignFront
    //   const orgModalConfig = {
    //     title: this.localePipe.transform('component.orgPotentialOwner.optionSettings'),
    //     width: 517,
    //     height: 382,
    //     showButtons: true,
    //     buttons: compRef.instance.modalFooter
    //   };
    //   const dialog = this.modalService.show(compRef, orgModalConfig);
    //   compRef.instance.closeModal.subscribe($event => dialog.close());
    //   compRef.instance.submitModal.subscribe((data: any) => {
    //     this.addSignFrontScope = data.value;
    //     this.frontPlaceholder = '（已设置）'
    //     dialog.close();
    //   });
    // }
    // addSignBehindConfig() {
    //   const compFactory = this.resolver.resolveComponentFactory(OrganizationPotentialOwnerComponent);
    //   const compRef = compFactory.create(this.injector);
    //   compRef.instance.action = ActionScope.AddSignBehind
    //   const orgModalConfig = {
    //     title: this.localePipe.transform('component.orgPotentialOwner.optionSettings'),
    //     width: 517,
    //     height: 382,
    //     showButtons: true,
    //     buttons: compRef.instance.modalFooter
    //   };
    //   const dialog = this.modalService.show(compRef, orgModalConfig); compRef.instance.closeModal.subscribe($event => dialog.close());
    //   compRef.instance.submitModal.subscribe((data: any) => {
    //     this.addSignBehindScope = data.value;
    //     this.behindPlaceholder = '（已设置）'
    //     dialog.close();
    //   });
    // }
    // transferConfig() {
    //   const compFactory = this.resolver.resolveComponentFactory(OrganizationPotentialOwnerComponent);
    //   const compRef = compFactory.create(this.injector);
    //   compRef.instance.action = ActionScope.Transfer
    //   const orgModalConfig = {
    //     title: this.localePipe.transform('component.orgPotentialOwner.optionSettings'),
    //     width: 517,
    //     height: 382,
    //     showButtons: true,
    //     buttons: compRef.instance.modalFooter
    //   };
    //   const dialog = this.modalService.show(compRef, orgModalConfig); compRef.instance.closeModal.subscribe($event => dialog.close());
    //   compRef.instance.submitModal.subscribe((data: any) => {
    //     this.transferScope = data.value;
    //     this.transferPlaceholder = '（已设置）'
    //     dialog.close();
    //   });
    // }
    // notifyConfig() {
    //   const compFactory = this.resolver.resolveComponentFactory(OrganizationPotentialOwnerComponent);
    //   const compRef = compFactory.create(this.injector);
    //   compRef.instance.action = ActionScope.Notify
    //   const orgModalConfig = {
    //     title: this.localePipe.transform('component.orgPotentialOwner.optionSettings'),
    //     width: 517,
    //     height: 382,
    //     showButtons: true,
    //     buttons: compRef.instance.modalFooter
    //   };
    //   const dialog = this.modalService.show(compRef, orgModalConfig);
    //   compRef.instance.closeModal.subscribe($event => dialog.close());
    //   compRef.instance.submitModal.subscribe((data: any) => {
    //     this.notifyScope = data.value;
    //     this.notifyPlaceholder = '（已设置）'
    //     dialog.close();
    //   });
    // }
    // backWardRuleConfig() {
    //   const compFactory = this.resolver.resolveComponentFactory(BackwardRuleComponent);
    //   const compRef = compFactory.create(this.injector);
    //   compRef.instance.editorParams.nodeType = 'UserActivity';
    //   const modalConfig = {
    //     title: this.localePipe.transform('component.backwardRule.backwardRule'),
    //     width: 760,
    //     height: 505,
    //     buttons: compRef.instance.modalFooter
    //   };
    //   const dialog = this.modalService.show(compRef, modalConfig);
    //   compRef.instance.closeModal.subscribe($event => dialog.close());
    //   compRef.instance.submitModal.subscribe((data: any) => {
    //     this.backWardRule = data.value;
    //     this.backWardPlaceholder = '（已设置）'
    //     dialog.close();
    //   });
    // }
    // addSignFrontConfig() {
    //   const compFactory = this.resolver.resolveComponentFactory(OrganizationPotentialOwnerComponent);
    //   const compRef = compFactory.create(this.injector);
    //   compRef.instance.action = ActionScope.AddSignFront
    //   const orgModalConfig = {
    //     title: this.localePipe.transform('component.orgPotentialOwner.optionSettings'),
    //     width: 517,
    //     height: 382,
    //     showButtons: true,
    //     buttons: compRef.instance.modalFooter
    //   };
    //   const dialog = this.modalService.show(compRef, orgModalConfig);
    //   compRef.instance.closeModal.subscribe($event => dialog.close());
    //   compRef.instance.submitModal.subscribe((data: any) => {
    //     this.addSignFrontScope = data.value;
    //     this.frontPlaceholder = '（已设置）'
    //     dialog.close();
    //   });
    // }
    // addSignBehindConfig() {
    //   const compFactory = this.resolver.resolveComponentFactory(OrganizationPotentialOwnerComponent);
    //   const compRef = compFactory.create(this.injector);
    //   compRef.instance.action = ActionScope.AddSignBehind
    //   const orgModalConfig = {
    //     title: this.localePipe.transform('component.orgPotentialOwner.optionSettings'),
    //     width: 517,
    //     height: 382,
    //     showButtons: true,
    //     buttons: compRef.instance.modalFooter
    //   };
    //   const dialog = this.modalService.show(compRef, orgModalConfig); compRef.instance.closeModal.subscribe($event => dialog.close());
    //   compRef.instance.submitModal.subscribe((data: any) => {
    //     this.addSignBehindScope = data.value;
    //     this.behindPlaceholder = '（已设置）'
    //     dialog.close();
    //   });
    // }
    // transferConfig() {
    //   const compFactory = this.resolver.resolveComponentFactory(OrganizationPotentialOwnerComponent);
    //   const compRef = compFactory.create(this.injector);
    //   compRef.instance.action = ActionScope.Transfer
    //   const orgModalConfig = {
    //     title: this.localePipe.transform('component.orgPotentialOwner.optionSettings'),
    //     width: 517,
    //     height: 382,
    //     showButtons: true,
    //     buttons: compRef.instance.modalFooter
    //   };
    //   const dialog = this.modalService.show(compRef, orgModalConfig); compRef.instance.closeModal.subscribe($event => dialog.close());
    //   compRef.instance.submitModal.subscribe((data: any) => {
    //     this.transferScope = data.value;
    //     this.transferPlaceholder = '（已设置）'
    //     dialog.close();
    //   });
    // }
    // notifyConfig() {
    //   const compFactory = this.resolver.resolveComponentFactory(OrganizationPotentialOwnerComponent);
    //   const compRef = compFactory.create(this.injector);
    //   compRef.instance.action = ActionScope.Notify
    //   const orgModalConfig = {
    //     title: this.localePipe.transform('component.orgPotentialOwner.optionSettings'),
    //     width: 517,
    //     height: 382,
    //     showButtons: true,
    //     buttons: compRef.instance.modalFooter
    //   };
    //   const dialog = this.modalService.show(compRef, orgModalConfig);
    //   compRef.instance.closeModal.subscribe($event => dialog.close());
    //   compRef.instance.submitModal.subscribe((data: any) => {
    //     this.notifyScope = data.value;
    //     this.notifyPlaceholder = '（已设置）'
    //     dialog.close();
    //   });
    // }
    // backWardRuleConfig() {
    //   const compFactory = this.resolver.resolveComponentFactory(BackwardRuleComponent);
    //   const compRef = compFactory.create(this.injector);
    //   compRef.instance.editorParams.nodeType = 'UserActivity';
    //   const modalConfig = {
    //     title: this.localePipe.transform('component.backwardRule.backwardRule'),
    //     width: 760,
    //     height: 505,
    //     buttons: compRef.instance.modalFooter
    //   };
    //   const dialog = this.modalService.show(compRef, modalConfig);
    //   compRef.instance.closeModal.subscribe($event => dialog.close());
    //   compRef.instance.submitModal.subscribe((data: any) => {
    //     this.backWardRule = data.value;
    //     this.backWardPlaceholder = '（已设置）'
    //     dialog.close();
    //   });
    // }
    /**
     * @return {?}
     */
    BatchSetPropertiesComponent.prototype.clickOK = 
    // addSignFrontConfig() {
    //   const compFactory = this.resolver.resolveComponentFactory(OrganizationPotentialOwnerComponent);
    //   const compRef = compFactory.create(this.injector);
    //   compRef.instance.action = ActionScope.AddSignFront
    //   const orgModalConfig = {
    //     title: this.localePipe.transform('component.orgPotentialOwner.optionSettings'),
    //     width: 517,
    //     height: 382,
    //     showButtons: true,
    //     buttons: compRef.instance.modalFooter
    //   };
    //   const dialog = this.modalService.show(compRef, orgModalConfig);
    //   compRef.instance.closeModal.subscribe($event => dialog.close());
    //   compRef.instance.submitModal.subscribe((data: any) => {
    //     this.addSignFrontScope = data.value;
    //     this.frontPlaceholder = '（已设置）'
    //     dialog.close();
    //   });
    // }
    // addSignBehindConfig() {
    //   const compFactory = this.resolver.resolveComponentFactory(OrganizationPotentialOwnerComponent);
    //   const compRef = compFactory.create(this.injector);
    //   compRef.instance.action = ActionScope.AddSignBehind
    //   const orgModalConfig = {
    //     title: this.localePipe.transform('component.orgPotentialOwner.optionSettings'),
    //     width: 517,
    //     height: 382,
    //     showButtons: true,
    //     buttons: compRef.instance.modalFooter
    //   };
    //   const dialog = this.modalService.show(compRef, orgModalConfig); compRef.instance.closeModal.subscribe($event => dialog.close());
    //   compRef.instance.submitModal.subscribe((data: any) => {
    //     this.addSignBehindScope = data.value;
    //     this.behindPlaceholder = '（已设置）'
    //     dialog.close();
    //   });
    // }
    // transferConfig() {
    //   const compFactory = this.resolver.resolveComponentFactory(OrganizationPotentialOwnerComponent);
    //   const compRef = compFactory.create(this.injector);
    //   compRef.instance.action = ActionScope.Transfer
    //   const orgModalConfig = {
    //     title: this.localePipe.transform('component.orgPotentialOwner.optionSettings'),
    //     width: 517,
    //     height: 382,
    //     showButtons: true,
    //     buttons: compRef.instance.modalFooter
    //   };
    //   const dialog = this.modalService.show(compRef, orgModalConfig); compRef.instance.closeModal.subscribe($event => dialog.close());
    //   compRef.instance.submitModal.subscribe((data: any) => {
    //     this.transferScope = data.value;
    //     this.transferPlaceholder = '（已设置）'
    //     dialog.close();
    //   });
    // }
    // notifyConfig() {
    //   const compFactory = this.resolver.resolveComponentFactory(OrganizationPotentialOwnerComponent);
    //   const compRef = compFactory.create(this.injector);
    //   compRef.instance.action = ActionScope.Notify
    //   const orgModalConfig = {
    //     title: this.localePipe.transform('component.orgPotentialOwner.optionSettings'),
    //     width: 517,
    //     height: 382,
    //     showButtons: true,
    //     buttons: compRef.instance.modalFooter
    //   };
    //   const dialog = this.modalService.show(compRef, orgModalConfig);
    //   compRef.instance.closeModal.subscribe($event => dialog.close());
    //   compRef.instance.submitModal.subscribe((data: any) => {
    //     this.notifyScope = data.value;
    //     this.notifyPlaceholder = '（已设置）'
    //     dialog.close();
    //   });
    // }
    // backWardRuleConfig() {
    //   const compFactory = this.resolver.resolveComponentFactory(BackwardRuleComponent);
    //   const compRef = compFactory.create(this.injector);
    //   compRef.instance.editorParams.nodeType = 'UserActivity';
    //   const modalConfig = {
    //     title: this.localePipe.transform('component.backwardRule.backwardRule'),
    //     width: 760,
    //     height: 505,
    //     buttons: compRef.instance.modalFooter
    //   };
    //   const dialog = this.modalService.show(compRef, modalConfig);
    //   compRef.instance.closeModal.subscribe($event => dialog.close());
    //   compRef.instance.submitModal.subscribe((data: any) => {
    //     this.backWardRule = data.value;
    //     this.backWardPlaceholder = '（已设置）'
    //     dialog.close();
    //   });
    // }
    /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var value = [];
        if (this.addSignFrontEnable) {
            /** @type {?} */
            var frontData = {
                type: 'addSignfront',
                actis: this.addSignFrontActis,
                config: this.addSignFrontScope
            };
            value.push(frontData);
        }
        if (this.addSignBehindEnable) {
            /** @type {?} */
            var behindData = {
                type: 'addSignBehind',
                actis: this.addSignFrontActis,
                config: this.addSignBehindScope
            };
            value.push(behindData);
        }
        if (this.transferEnable) {
            /** @type {?} */
            var transferData = {
                type: 'transfer',
                actis: this.addSignFrontActis,
                config: this.transferScope
            };
            value.push(transferData);
        }
        if (this.notifyEnable) {
            /** @type {?} */
            var notifyData = {
                type: 'notify',
                actis: this.addSignFrontActis,
                config: this.notifyScope
            };
            value.push(notifyData);
        }
        if (this.backWardRuleEnable) {
            /** @type {?} */
            var backWardRuleData = {
                type: 'backWardRule',
                actis: this.addSignFrontActis,
                config: this.backWardRule
            };
            value.push(backWardRuleData);
        }
        if (value && value.length > 0) {
            this.batchSet(value);
        }
        this.submit.next();
    };
    /**
     * @return {?}
     */
    BatchSetPropertiesComponent.prototype.clickCancel = /**
     * @return {?}
     */
    function () {
        this.cancel.next();
    };
    /**
     * @param {?} value
     * @return {?}
     */
    BatchSetPropertiesComponent.prototype.batchSet = /**
     * @param {?} value
     * @return {?}
     */
    function (value) {
        this.viewModel.batchSet(ResourceKeys$1.batchSetProperty, value);
    };
    BatchSetPropertiesComponent.decorators = [
        { type: Component, args: [{
                    selector: 'lib-batch-set-properties',
                    template: "<div class=\"f-page\">\r\n  <section class=\"f-page-main d-flex flex-column\"\r\n    style=\"overflow:scroll;border-radius:10px;border: 1.5px solid #F1F3F7;\">\r\n    <div class=\"f-form-layout farris-form mx-3\">\r\n      <fieldset class=\"f-section-formgroup\">\r\n        <div class=\"f-section-formgroup-inputs\">\r\n          <div class=\"col-12 mt-3\">\r\n            <div class=\"farris-group-wrap\">\r\n              <div class=\"form-group farris-form-group\">\r\n                <label class=\"col-form-label\">\r\n                  <span class=\"farris-label-text\">{{'component.batchSet.targetNode' | wfLocale}}</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap\">\r\n                  <farris-lookup-grid #addSignFrontActisDialog [items]=\"useractivities\" [columns]=\"cols\"\r\n                    [resizable]=\"true\" [singleSelect]=\"false\" [idField]=\"'Id'\" [textField]=\"'Name'\" [(ngModel)]=\"actis1\"\r\n                    [valueField]=\"'Id'\" [pagination]=\"false\" [pageIndex]=\"pageInfo.pageIndex\" name=\"addSignFrontActis\"\r\n                    [pageSize]=\"pageInfo.pageSize\" [pageList]=\"pageInfo.pageList\" [total]=\"total\" [enableClear]=\"false\"\r\n                    title=\"{{'component.batchSet.targetNode'|wfLocale}}\" [displayType]=\"'List'\"\r\n                    [remoteSearch]='false' [enableToSelect]=\"false\"\r\n                    placeholder=\"{{'component.messageNoticeEdit.placeholder'|wfLocale}}\" [dictPicked]=\"frontActisSelect\"\r\n                    [nosearch]=\"true\" [showFilterBar]=\"false\">\r\n                  </farris-lookup-grid>\r\n                  <div class=\"farris-feedback valid-feedback\"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n    </fieldset>\r\n</div>\r\n<!-- \u5F81\u8BE2 -->\r\n  <div class=\"f-form-layout farris-form mx-3\">\r\n    <fieldset class=\"f-section-formgroup\">\r\n      <div class=\"f-section-formgroup-inputs\">\r\n        <div class=\"farris-form form-inline farris-form-inline col-12\">\r\n          <div class=\"farris-group-auto\">\r\n            <div class=\"form-group farris-form-group\">\r\n              <label class=\"col-3 col-form-label\" style=\"padding-right: 79px;padding-left: 0px;\">\r\n                <span class=\"farris-label-text\">{{'component.batchSet.addSignFront' | wfLocale}}</span>\r\n              </label>\r\n              <div class=\"col-9 col-form-label\">\r\n                <farris-switch [(ngModel)]=\"addSignFrontEnable\" name=\"addSignFrontEnable\"></farris-switch>\r\n                <div class=\"farris-feedback valid-feedback\"></div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </fieldset>\r\n  </div>\r\n<!-- \u52A0\u7B7E -->\r\n  <div class=\"f-form-layout farris-form mx-3\">\r\n    <fieldset class=\"f-section-formgroup\">\r\n      <div class=\"f-section-formgroup-inputs\">\r\n        <div class=\"farris-form form-inline farris-form-inline col-12\">\r\n          <div class=\"farris-group-auto\">\r\n            <div class=\"form-group farris-form-group\">\r\n              <label class=\"col-3 col-form-label\" style=\"padding-right: 79px;padding-left: 0px;\">\r\n                <span class=\"farris-label-text\">{{'component.batchSet.addSignBehind' | wfLocale}}</span>\r\n              </label>\r\n              <div class=\"col-9 col-form-label\">\r\n                <farris-switch [(ngModel)]=\"addSignBehindEnable\" name=\"addSignBehindEnable\"></farris-switch>\r\n                <div class=\"farris-feedback valid-feedback\"></div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </fieldset>\r\n  </div>\r\n  <div class=\"f-form-layout farris-form mx-3\">\r\n    <fieldset class=\"f-section-formgroup\">\r\n      <div class=\"f-section-formgroup-inputs\">\r\n        <div class=\"farris-form form-inline farris-form-inline col-12\">\r\n          <div class=\"farris-group-auto\">\r\n            <div class=\"form-group farris-form-group\">\r\n              <label class=\"col-3 col-form-label\" style=\"padding-right: 79px;padding-left: 0px;\">\r\n                <span class=\"farris-label-text\">{{'component.batchSet.transfer' | wfLocale}}</span>\r\n              </label>\r\n              <div class=\"col-9 col-form-label\">\r\n                <farris-switch [(ngModel)]=\"transferEnable\" name=\"transferEnable\"></farris-switch>\r\n                <div class=\"farris-feedback valid-feedback\"></div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </fieldset>\r\n  </div>\r\n  <div class=\"f-form-layout farris-form mx-3\">\r\n    <fieldset class=\"f-section-formgroup\">\r\n      <div class=\"f-section-formgroup-inputs\">\r\n        <div class=\"farris-form form-inline farris-form-inline col-12\">\r\n          <div class=\"farris-group-auto\">\r\n            <div class=\"form-group farris-form-group\">\r\n              <label class=\"col-3 col-form-label\" style=\"padding-right: 79px;padding-left: 0px;\">\r\n                <span class=\"farris-label-text\">{{'component.batchSet.notify' | wfLocale}}</span>\r\n              </label>\r\n              <div class=\"col-9 col-form-label\">\r\n                <farris-switch [(ngModel)]=\"notifyEnable\" name=\"notifyEnable\"></farris-switch>\r\n                <div class=\"farris-feedback valid-feedback\"></div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </fieldset>\r\n  </div>\r\n  <div class=\"f-form-layout farris-form mx-3\">\r\n    <fieldset class=\"f-section-formgroup\">\r\n      <div class=\"f-section-formgroup-inputs\">\r\n        <div class=\"farris-form form-inline farris-form-inline col-12\">\r\n          <div class=\"farris-group-auto\">\r\n            <div class=\"form-group farris-form-group\">\r\n              <label class=\"col-3 col-form-label\" style=\"padding-right: 54px;padding-left: 0px;\">\r\n                <span class=\"farris-label-text\">{{'component.batchSet.backWardRule' | wfLocale}}</span>\r\n              </label>\r\n              <div class=\"col-9 col-form-label\">\r\n                <farris-switch [(ngModel)]=\"backWardRuleEnable\" name=\"backWardRuleEnable\"></farris-switch>\r\n                <div class=\"farris-feedback valid-feedback\"></div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </fieldset>\r\n  </div>\r\n</section>\r\n</div>\r\n\r\n<ng-template #footer>\r\n  <button type=\"button\" class=\"btn btn-secondary btn-sm\" (click)=\"clickCancel()\">{{'component.note.clickCancel' |\r\n    wfLocale}}</button>\r\n  <button type=\"button\" class=\"btn btn-primary btn-sm mx-2\" (click)=\"clickOK()\">{{'component.note.clickOK' |\r\n    wfLocale}}</button>\r\n</ng-template>",
                    providers: [
                        WfLocalePipe,
                    ],
                    styles: [""]
                }] }
    ];
    /** @nocollapse */
    BatchSetPropertiesComponent.ctorParameters = function () { return [
        { type: ProcessDesignerUIState },
        { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
        { type: undefined, decorators: [{ type: Inject, args: [WF_LANG_RESOURCES,] }] },
        { type: WfLocalePipe, decorators: [{ type: Optional }] },
        { type: ComponentFactoryResolver },
        { type: Injector },
        { type: BsModalService },
        { type: ProcessDesignerViewModel }
    ]; };
    BatchSetPropertiesComponent.propDecorators = {
        footer: [{ type: ViewChild, args: ['footer',] }],
        modalFooter: [{ type: ViewChild, args: ['iconSelectFooter',] }]
    };
    return BatchSetPropertiesComponent;
}());
/** @enum {string} */
var ResourceKeys$1 = {
    batchSetProperty: 'batchSetProperty',
};

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var WfEditorUi = /** @class */ (function (_super) {
    __extends(WfEditorUi, _super);
    function WfEditorUi(time, action, container, injector, modalService, resolver, eventSource, importLinks) {
        if (importLinks === void 0) { importLinks = true; }
        var _this = _super.call(this, container, eventSource, importLinks) || this;
        _this.injector = injector;
        _this.modalService = modalService;
        _this.resolver = resolver;
        _this.generalConfig = {
            enableTransfer: true,
            enableNotify: false,
            enableAddSignBehind: false,
            enableAddSignFront: false,
        };
        /** @type {?} */
        var rootPath = '';
        try {
            rootPath = ((/** @type {?} */ (window))).gspframeworkService.common.getBasePath.get();
        }
        catch (error) {
        }
        mxResources.add(rootPath + "/platform/runtime/common/web/@gsp-wf/wf-process-editor/resources/wf-process-editor");
        _this.showToolbar = false;
        _this.time = time;
        _this.action = action;
        return _this;
    }
    /**
     * @return {?}
     */
    WfEditorUi.prototype.createActions = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var actions = _super.prototype.createActions.call(this);
        // 只有设计时编辑状态下才启用删除动作
        if (!(this.action === 'edit' && this.time !== 'rt')) {
            /** @type {?} */
            var deleteAction = actions.getAction(ActionKeys.pmf_delete);
            deleteAction.isEnabled = (/**
             * @return {?}
             */
            function () { return false; });
        }
        return actions;
    };
    /**
     * @return {?}
     */
    WfEditorUi.prototype.createToolbox = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var toolbox = _super.prototype.createToolbox.call(this);
        /** @type {?} */
        var g1 = new ToolboxGroup();
        g1.name = mxResources.get('basicElements');
        g1.items.push(new ToolboxItem(StartActivityCell.CLR_TYPE_ID), new ToolboxItem(WfExclusiveGatewayCell.CLR_TYPE_ID), new ToolboxItem(WfParallelGatewayCell.CLR_TYPE_ID), 
        // 暂时隐藏包容网关
        new ToolboxItem(WfInclusiveGatewayCell.CLR_TYPE_ID), new ToolboxItem(UserActivityCell.CLR_TYPE_ID), new ToolboxItem(OperationActivityCell.CLR_TYPE_ID), new ToolboxItem(NotifyActivityCell.CLR_TYPE_ID), new ToolboxItem(CallActivitySubProcessCell.CLR_TYPE_ID), new ToolboxItem(AutoActivityCell.CLR_TYPE_ID), new ToolboxItem(IntermediateCatchEventImplCell.CLR_TYPE_ID), new ToolboxItem(MessageActivityCell.CLR_TYPE_ID), new ToolboxItem(AifCreationBillActivityCell.CLR_TYPE_ID), new ToolboxItem(WfEndEventCell.CLR_TYPE_ID));
        toolbox.groups = [g1];
        return toolbox;
    };
    /**
     * @return {?}
     */
    WfEditorUi.prototype.createGraphInstance = /**
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var graph = new WfGraph(this, this.diagramContainer);
        if (this.action === 'view' || this.time === 'rt' || this.action === 'assignView') {
            graph.setCellsLocked(true);
        }
        else {
            graph.setDropEnabled(true);
            graph.setConnectable(true);
        }
        //TODO：右键查看只显示在审批节点上
        graph.popupMenuHandler.autoExpand = true;
        graph.popupMenuHandler.factoryMethod = (/**
         * @param {?} menu
         * @param {?} cell
         * @param {?} evt
         * @return {?}
         */
        function (menu, cell, evt) {
            /** @type {?} */
            var actList = graph.getChildCells(graph.getDefaultParent());
            if (cell != null
                && cell.clrTypeId.indexOf('wf.UserActivity') > -1
                && actList.findIndex((/**
                 * @param {?} a
                 * @return {?}
                 */
                function (a) { return a.id === cell.getId(); })) > -1) {
                menu.addItem('批量复制属性', null, (/**
                 * @return {?}
                 */
                function () {
                    /** @type {?} */
                    var compFactory = _this.resolver.resolveComponentFactory(BatchSetPropertiesComponent);
                    /** @type {?} */
                    var compRef = compFactory.create(_this.injector);
                    compRef.instance.activityModel = cell.flowElement;
                    /** @type {?} */
                    var modalConfig = {
                        title: '批量复制属性',
                        width: 512,
                        height: 465,
                        showButtons: true,
                        buttons: compRef.instance.footer
                    };
                    /** @type {?} */
                    var dialog = _this.modalService.show(compRef, modalConfig);
                    compRef.instance.cancel.subscribe((/**
                     * @param {?} $event
                     * @return {?}
                     */
                    function ($event) { return dialog.close(); }));
                    compRef.instance.submit.subscribe((/**
                     * @param {?} data
                     * @return {?}
                     */
                    function (data) {
                        dialog.close();
                    }));
                }));
            }
        });
        return graph;
    };
    /**
     * @return {?}
     */
    WfEditorUi.prototype.createSidebar = /**
     * @return {?}
     */
    function () {
        return new WfSidebar(this, this.sidebarContainer);
    };
    /**
     * @return {?}
     */
    WfEditorUi.prototype.show = /**
     * @return {?}
     */
    function () {
        var _this = this;
        _super.prototype.show.call(this);
        if (this.action === 'view' || this.action === 'assignView') {
            /** @type {?} */
            var span = this.createSpan('');
            span.style.fontSize = '14px';
            span.style.color = 'white';
            span.style.borderRadius = '20px';
            span.style.padding = '4px 20px';
            span.style.background = 'rgb(199, 194, 187)';
            /** @type {?} */
            var v = document.createTextNode(mxResources.get('readOnly'));
            span.appendChild(v);
            /** @type {?} */
            var d = this.createDiv('');
            d.style.position = 'absolute';
            d.style.top = '10px';
            d.style.right = '10px';
            d.style.zIndex = "2";
            d.appendChild(span);
            this.container.appendChild(d);
        }
        /** @type {?} */
        var buttonIn = document.createElement('a');
        buttonIn.setAttribute('href', 'javascript:void(0);');
        /** @type {?} */
        var buttonInImg = document.createElement('img');
        buttonIn.style.marginRight = '10px';
        buttonInImg.src = WfConstants.IMAGE_PATH + '/zoomIn.svg';
        buttonInImg.style.display = "inline-block";
        buttonInImg.style.verticalAlign = "middle";
        buttonIn.appendChild(buttonInImg);
        mxEvent.addListener(buttonIn, 'click', (/**
         * @param {?} evt
         * @return {?}
         */
        function (evt) {
            _this.actions.getAction(ActionKeys.pmf_zoomIn).execute(evt);
        }));
        /** @type {?} */
        var buttonOut = document.createElement('a');
        buttonOut.setAttribute('href', 'javascript:void(0);');
        /** @type {?} */
        var buttonOutImg = document.createElement('img');
        buttonOutImg.src = WfConstants.IMAGE_PATH + '/zoomOut.svg';
        buttonOutImg.style.display = "inline-block";
        buttonOutImg.style.verticalAlign = "middle";
        buttonOut.appendChild(buttonOutImg);
        mxEvent.addListener(buttonOut, 'click', (/**
         * @param {?} evt
         * @return {?}
         */
        function (evt) {
            _this.actions.getAction(ActionKeys.pmf_zoomOut).execute(evt);
        }));
        /** @type {?} */
        var zoomBar = this.createDiv('zoomBar');
        zoomBar.style.position = 'absolute';
        zoomBar.style.zIndex = "2";
        /** @type {?} */
        var t = 10;
        if (this.showMenubar) {
            t += this.menubarHeight;
        }
        if (this.showToolbar) {
            t += this.toolbarHeight;
        }
        zoomBar.style.top = t + 'px';
        zoomBar.style.left = (this.showSidebar ? this.sidebarSplitPosition + this.sidebarSplitSize : 0) + 10 + "px";
        zoomBar.appendChild(buttonIn);
        zoomBar.appendChild(buttonOut);
        this.container.appendChild(zoomBar);
        this.zoomBar = zoomBar;
    };
    /**
     * @param {?} value
     * @return {?}
     */
    WfEditorUi.prototype.sidebarSplitOnChange = /**
     * @param {?} value
     * @return {?}
     */
    function (value) {
        _super.prototype.sidebarSplitOnChange.call(this, value);
        // 分割条移动后更新缩放条位置
        if (this.zoomBar) {
            this.zoomBar.style.left = (this.showSidebar ? this.sidebarSplitPosition + this.sidebarSplitSize : 0) + 10 + "px";
        }
    };
    /**
     * 创建带指定样式类的span
     * @param classname
     * @returns
     */
    /**
     * 创建带指定样式类的span
     * @param {?} classname
     * @return {?}
     */
    WfEditorUi.prototype.createSpan = /**
     * 创建带指定样式类的span
     * @param {?} classname
     * @return {?}
     */
    function (classname) {
        /** @type {?} */
        var elt = document.createElement('span');
        elt.className = classname;
        return elt;
    };
    /**
     * 加载业务活动
     * @param bizActivities
     */
    /**
     * 加载业务活动
     * @param {?} bizActivities
     * @return {?}
     */
    WfEditorUi.prototype.loadBizActivities = /**
     * 加载业务活动
     * @param {?} bizActivities
     * @return {?}
     */
    function (bizActivities) {
        this.sidebar && this.sidebar.addBizActPalette(bizActivities);
    };
    /**
     * 批量复制属性
     * @param obj
     */
    /**
     * 批量复制属性
     * @param {?} obj
     * @return {?}
     */
    WfEditorUi.prototype.batchCopyProperty = /**
     * 批量复制属性
     * @param {?} obj
     * @return {?}
     */
    function (obj) {
        var e_1, _a;
        // 放弃不需要的参数
        /** @type {?} */
        var ids = obj.value.targetNodeID;
        obj.propertyValue = obj.value.messageNotice;
        // todo：多个活动具有同名属性时，如何更合理定义PropertyKey？
        obj.propertyID = UserActivityPropertyKeys.messageNotice;
        try {
            for (var ids_1 = __values(ids), ids_1_1 = ids_1.next(); !ids_1_1.done; ids_1_1 = ids_1.next()) {
                var id = ids_1_1.value;
                /** @type {?} */
                var cell = this.graph.getCellByFlowElementId(id);
                if (cell) {
                    cell.updateProps(obj);
                    this.graph.refresh();
                }
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (ids_1_1 && !ids_1_1.done && (_a = ids_1.return)) _a.call(ids_1);
            }
            finally { if (e_1) throw e_1.error; }
        }
    };
    /**
   * 批量设置属性
   * @param obj
   */
    /**
     * 批量设置属性
     * @param {?} obj
     * @return {?}
     */
    WfEditorUi.prototype.batchSetProperty = /**
     * 批量设置属性
     * @param {?} obj
     * @return {?}
     */
    function (obj) {
        var e_2, _a, e_3, _b, e_4, _c, e_5, _d, e_6, _e, e_7, _f;
        try {
            for (var obj_1 = __values(obj), obj_1_1 = obj_1.next(); !obj_1_1.done; obj_1_1 = obj_1.next()) {
                var v = obj_1_1.value;
                switch (v.type) {
                    case 'addSignfront':
                        /** @type {?} */
                        var afId = v.actis;
                        obj.propertyValue = v.config;
                        obj.propertyID = UserActivityPropertyKeys.AddSignFrontAble;
                        try {
                            for (var afId_1 = __values(afId), afId_1_1 = afId_1.next(); !afId_1_1.done; afId_1_1 = afId_1.next()) {
                                var id = afId_1_1.value;
                                /** @type {?} */
                                var cell = this.graph.getCellByFlowElementId(id.Id);
                                if (cell) {
                                    cell.updateProps(obj);
                                    this.graph.refresh();
                                }
                            }
                        }
                        catch (e_3_1) { e_3 = { error: e_3_1 }; }
                        finally {
                            try {
                                if (afId_1_1 && !afId_1_1.done && (_b = afId_1.return)) _b.call(afId_1);
                            }
                            finally { if (e_3) throw e_3.error; }
                        }
                        break;
                    case 'addSignBehind':
                        /** @type {?} */
                        var abId = v.actis;
                        obj.propertyValue = v.config;
                        obj.propertyID = UserActivityPropertyKeys.AddSignBehindAble;
                        try {
                            for (var abId_1 = __values(abId), abId_1_1 = abId_1.next(); !abId_1_1.done; abId_1_1 = abId_1.next()) {
                                var id = abId_1_1.value;
                                /** @type {?} */
                                var cell = this.graph.getCellByFlowElementId(id.Id);
                                if (cell) {
                                    cell.updateProps(obj);
                                    this.graph.refresh();
                                }
                            }
                        }
                        catch (e_4_1) { e_4 = { error: e_4_1 }; }
                        finally {
                            try {
                                if (abId_1_1 && !abId_1_1.done && (_c = abId_1.return)) _c.call(abId_1);
                            }
                            finally { if (e_4) throw e_4.error; }
                        }
                        break;
                    case 'transfer':
                        /** @type {?} */
                        var trId = v.actis;
                        obj.propertyValue = v.config;
                        obj.propertyID = UserActivityPropertyKeys.transferScope;
                        try {
                            for (var trId_1 = __values(trId), trId_1_1 = trId_1.next(); !trId_1_1.done; trId_1_1 = trId_1.next()) {
                                var id = trId_1_1.value;
                                /** @type {?} */
                                var cell = this.graph.getCellByFlowElementId(id.Id);
                                if (cell) {
                                    cell.updateProps(obj);
                                    this.graph.refresh();
                                }
                            }
                        }
                        catch (e_5_1) { e_5 = { error: e_5_1 }; }
                        finally {
                            try {
                                if (trId_1_1 && !trId_1_1.done && (_d = trId_1.return)) _d.call(trId_1);
                            }
                            finally { if (e_5) throw e_5.error; }
                        }
                        break;
                    case 'notify':
                        /** @type {?} */
                        var ntId = v.actis;
                        obj.propertyValue = v.config;
                        obj.propertyID = UserActivityPropertyKeys.NotifyAble;
                        try {
                            for (var ntId_1 = __values(ntId), ntId_1_1 = ntId_1.next(); !ntId_1_1.done; ntId_1_1 = ntId_1.next()) {
                                var id = ntId_1_1.value;
                                /** @type {?} */
                                var cell = this.graph.getCellByFlowElementId(id.Id);
                                if (cell) {
                                    cell.updateProps(obj);
                                    this.graph.refresh();
                                }
                            }
                        }
                        catch (e_6_1) { e_6 = { error: e_6_1 }; }
                        finally {
                            try {
                                if (ntId_1_1 && !ntId_1_1.done && (_e = ntId_1.return)) _e.call(ntId_1);
                            }
                            finally { if (e_6) throw e_6.error; }
                        }
                        break;
                    // 驳回规则需要特殊处理：子流程和信号的赋简版
                    case 'backWardRule':
                        /** @type {?} */
                        var bwId = v.actis;
                        obj.propertyValue = v.config;
                        obj.propertyID = UserActivityPropertyKeys.BackWardRule;
                        try {
                            for (var bwId_1 = __values(bwId), bwId_1_1 = bwId_1.next(); !bwId_1_1.done; bwId_1_1 = bwId_1.next()) {
                                var id = bwId_1_1.value;
                                /** @type {?} */
                                var cell = this.graph.getCellByFlowElementId(id.Id);
                                if (cell) {
                                    cell.updateProps(obj);
                                    this.graph.refresh();
                                }
                            }
                        }
                        catch (e_7_1) { e_7 = { error: e_7_1 }; }
                        finally {
                            try {
                                if (bwId_1_1 && !bwId_1_1.done && (_f = bwId_1.return)) _f.call(bwId_1);
                            }
                            finally { if (e_7) throw e_7.error; }
                        }
                        break;
                }
            }
        }
        catch (e_2_1) { e_2 = { error: e_2_1 }; }
        finally {
            try {
                if (obj_1_1 && !obj_1_1.done && (_a = obj_1.return)) _a.call(obj_1);
            }
            finally { if (e_2) throw e_2.error; }
        }
    };
    /**
     * 创建新流程
     * @param newProcInfo
     * @param bizCmps
     */
    /**
     * 创建新流程
     * @param {?} newProcInfo
     * @param {?=} bizCmps
     * @return {?}
     */
    WfEditorUi.prototype.createBpmnModel = /**
     * 创建新流程
     * @param {?} newProcInfo
     * @param {?=} bizCmps
     * @return {?}
     */
    function (newProcInfo, bizCmps) {
        this.graph.createBpmnModelWithProcInfo(newProcInfo, bizCmps);
    };
    /**
     * 打开流程
     * @param content
     */
    /**
     * 打开流程
     * @param {?} content
     * @return {?}
     */
    WfEditorUi.prototype.openBpmnModel = /**
     * 打开流程
     * @param {?} content
     * @return {?}
     */
    function (content) {
        this.graph.loadBpmnModel(content);
    };
    /**
     * 获取属性配置，刷新属性框
     * @param obj
     * @returns
     */
    /**
     * 获取属性配置，刷新属性框
     * @param {?} obj
     * @return {?}
     */
    WfEditorUi.prototype.refreshProperty = /**
     * 获取属性配置，刷新属性框
     * @param {?} obj
     * @return {?}
     */
    function (obj) {
        /** @type {?} */
        var cell = this.graph.getCellByFlowElementId(obj.Id);
        return this.getFarrisPropConfig([cell]);
    };
    /**
     * 获取用户活动
     * @returns
     */
    /**
     * 获取用户活动
     * @return {?}
     */
    WfEditorUi.prototype.getActivities = /**
     * 获取用户活动
     * @return {?}
     */
    function () {
        /** @type {?} */
        var list = [];
        /** @type {?} */
        var bpmnModel = this.graph.bpmnModel;
        /** @type {?} */
        var flowDict = bpmnModel.DefaultProcess.GetFlowElements();
        Object.keys(flowDict).forEach((/**
         * @param {?} key
         * @return {?}
         */
        function (key) {
            /** @type {?} */
            var flowElt = flowDict[key];
            if (flowElt.ClrTypeID === UserActivity.Clr_Type_ID
                || flowElt.ClrTypeID === OperationActivity.Clr_Type_ID) {
                list.push(flowElt);
            }
        }));
        return list;
    };
    /**
     * 获取结束事件
     * @returns
     */
    /**
     * 获取结束事件
     * @return {?}
     */
    WfEditorUi.prototype.getEndEvents = /**
     * 获取结束事件
     * @return {?}
     */
    function () {
        /** @type {?} */
        var userActArray = [];
        /** @type {?} */
        var bpmnModel = this.graph.bpmnModel;
        /** @type {?} */
        var flowDict = bpmnModel.DefaultProcess.GetFlowElements();
        Object.keys(flowDict).forEach((/**
         * @param {?} key
         * @return {?}
         */
        function (key) {
            /** @type {?} */
            var flowElt = flowDict[key];
            if (flowElt.ClrTypeID === 'bpmn.EndEvent' || flowElt.ClrTypeID === UserActivity.Clr_Type_ID
                || flowElt.ClrTypeID === OperationActivity.Clr_Type_ID) {
                userActArray.push(flowElt);
            }
        }));
        return userActArray;
    };
    /**
     * 获取知会事件
     * @returns
     */
    /**
     * 获取知会事件
     * @return {?}
     */
    WfEditorUi.prototype.getNotifyEvents = /**
     * 获取知会事件
     * @return {?}
     */
    function () {
        /** @type {?} */
        var list = [];
        /** @type {?} */
        var bpmnModel = this.graph.bpmnModel;
        /** @type {?} */
        var flowDict = bpmnModel.DefaultProcess.GetFlowElements();
        Object.keys(flowDict).forEach((/**
         * @param {?} key
         * @return {?}
         */
        function (key) {
            /** @type {?} */
            var flowElt = flowDict[key];
            if (flowElt.ClrTypeID === 'wf.NotifyActivity') {
                list.push(flowElt);
            }
        }));
        return list;
    };
    /**
     * 获取消息事件
     * @returns
     */
    /**
     * 获取消息事件
     * @return {?}
     */
    WfEditorUi.prototype.getMessageEvents = /**
     * 获取消息事件
     * @return {?}
     */
    function () {
        /** @type {?} */
        var list = [];
        /** @type {?} */
        var bpmnModel = this.graph.bpmnModel;
        /** @type {?} */
        var flowDict = bpmnModel.DefaultProcess.GetFlowElements();
        Object.keys(flowDict).forEach((/**
         * @param {?} key
         * @return {?}
         */
        function (key) {
            /** @type {?} */
            var flowElt = flowDict[key];
            if (flowElt.ClrTypeID === 'bpmn.MessageEvent') {
                list.push(flowElt);
            }
        }));
        return list;
    };
    /**
     * 获取子流程和信号捕获节点
     * @returns
     */
    /**
     * 获取子流程和信号捕获节点
     * @return {?}
     */
    WfEditorUi.prototype.getSubAndCatchEvents = /**
     * 获取子流程和信号捕获节点
     * @return {?}
     */
    function () {
        /** @type {?} */
        var list = [];
        /** @type {?} */
        var bpmnModel = this.graph.bpmnModel;
        /** @type {?} */
        var flowDict = bpmnModel.DefaultProcess.GetFlowElements();
        Object.keys(flowDict).forEach((/**
         * @param {?} key
         * @return {?}
         */
        function (key) {
            /** @type {?} */
            var flowElt = flowDict[key];
            if (flowElt.ClrTypeID === 'wf.CallActivitySubProcess' ||
                flowElt.ClrTypeID === 'wf.IntermediateCatchEventImpl') {
                list.push(flowElt);
            }
        }));
        return list;
    };
    /**
     * 获取启动方式
     * @returns
     */
    /**
     * 获取启动方式
     * @return {?}
     */
    WfEditorUi.prototype.getStartMode = /**
     * 获取启动方式
     * @return {?}
     */
    function () {
        var e_8, _a;
        /** @type {?} */
        var startMode = null;
        /** @type {?} */
        var bpmnModel = this.graph.bpmnModel;
        /** @type {?} */
        var extendElements = bpmnModel.DefaultProcess.GetExtensionElements();
        if (extendElements.length > 0) {
            try {
                for (var extendElements_1 = __values(extendElements), extendElements_1_1 = extendElements_1.next(); !extendElements_1_1.done; extendElements_1_1 = extendElements_1.next()) {
                    var e = extendElements_1_1.value;
                    if (e instanceof ProcessHeader) {
                        startMode = e.startMode;
                    }
                }
            }
            catch (e_8_1) { e_8 = { error: e_8_1 }; }
            finally {
                try {
                    if (extendElements_1_1 && !extendElements_1_1.done && (_a = extendElements_1.return)) _a.call(extendElements_1);
                }
                finally { if (e_8) throw e_8.error; }
            }
        }
        return startMode;
    };
    return WfEditorUi;
}(EditorUi));

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var WfValidatorAdapter = /** @class */ (function () {
    function WfValidatorAdapter() {
    }
    /**
     * @param {?} bpmnModel
     * @param {?} scene
     * @return {?}
     */
    WfValidatorAdapter.validator = /**
     * @param {?} bpmnModel
     * @param {?} scene
     * @return {?}
     */
    function (bpmnModel, scene) {
        // 校验节点标识是否合规
        /** @type {?} */
        var resActList = this.validateActivityList(bpmnModel);
        if (!resActList.valid) {
            return resActList;
        }
        // 校验流程变量
        /** @type {?} */
        var resProcVars = this.validatePrcoessVaris(bpmnModel);
        if (!resProcVars.valid) {
            return resProcVars;
        }
        /** @type {?} */
        var warningList = this.warningValidator(bpmnModel, scene);
        return {
            valid: true,
            warningList: warningList,
        };
    };
    /**
     * @private
     * @param {?} bpmnModel
     * @param {?} scene
     * @return {?}
     */
    WfValidatorAdapter.warningValidator = /**
     * @private
     * @param {?} bpmnModel
     * @param {?} scene
     * @return {?}
     */
    function (bpmnModel, scene) {
        /** @type {?} */
        var warningList = new Array();
        // 校验并行网关是否成对出现
        this.validateParallelGateway(bpmnModel, warningList);
        // 校验流程构件
        this.validateProcCmps(bpmnModel, scene, warningList);
        // 校验审批活动、人工操作参与者
        this.validateApprovalPerformers(bpmnModel, warningList);
        return warningList;
    };
    /**
     * @private
     * @param {?} bpmnModel
     * @param {?} scene
     * @param {?} warningList
     * @return {?}
     */
    WfValidatorAdapter.validateProcCmps = /**
     * @private
     * @param {?} bpmnModel
     * @param {?} scene
     * @param {?} warningList
     * @return {?}
     */
    function (bpmnModel, scene, warningList) {
        var e_1, _a;
        if (scene === 'inSuite') {
            return;
        }
        /** @type {?} */
        var extendElements = bpmnModel.DefaultProcess.GetExtensionElements();
        /** @type {?} */
        var processHeader = extendElements.find((/**
         * @param {?} e
         * @return {?}
         */
        function (e) { return e instanceof ProcessHeader; }));
        if (!processHeader) {
            console.error(this.localePipe.instant('validate.noProcessHeader'));
            return;
        }
        /** @type {?} */
        var procCmps = extendElements.filter((/**
         * @param {?} e
         * @return {?}
         */
        function (e) { return e instanceof Component$1; }));
        if (!procCmps || procCmps.length === 0) {
            /** @type {?} */
            var tip = {
                id: 'lackCmp',
                title: this.localePipe.instant('validate.cmpsEmpty'),
                msg: this.localePipe.instant('validate.cmpsEmptyMsg'),
                type: 'processWarning'
            };
            warningList.push(tip);
            return;
        }
        // 启用方式为直接方式时
        if (((/** @type {?} */ (processHeader))).startMode === StartMode.DIRECT) {
            // 直接启用方式时不允许存在共享的构件
            /** @type {?} */
            var pfCmps = procCmps.filter((/**
             * @param {?} p
             * @return {?}
             */
            function (p) { return WfDesignerUtils.isPfComponent(p.MetadataId); }));
            if (pfCmps && pfCmps.length > 0) {
                /** @type {?} */
                var pfCmpsName = '';
                try {
                    for (var pfCmps_1 = __values(pfCmps), pfCmps_1_1 = pfCmps_1.next(); !pfCmps_1_1.done; pfCmps_1_1 = pfCmps_1.next()) {
                        var cmp = pfCmps_1_1.value;
                        pfCmpsName = pfCmpsName.concat(((/** @type {?} */ (cmp))).Name + ", ");
                    }
                }
                catch (e_1_1) { e_1 = { error: e_1_1 }; }
                finally {
                    try {
                        if (pfCmps_1_1 && !pfCmps_1_1.done && (_a = pfCmps_1.return)) _a.call(pfCmps_1);
                    }
                    finally { if (e_1) throw e_1.error; }
                }
                pfCmpsName = pfCmpsName.slice(0, pfCmpsName.length - 1);
                /** @type {?} */
                var tip = {
                    id: 'directProcessWithPFCmp',
                    title: this.localePipe.instant('validate.directNoPf'),
                    msg: this.localePipe.instant('validate.directNoPfMsg') + (pfCmpsName + " "),
                    type: 'processWarning'
                };
                warningList.push(tip);
            }
            if (!procCmps.some((/**
             * @param {?} c
             * @return {?}
             */
            function (c) { return c.Time === ToolTime.LOADDATA; }))) {
                /** @type {?} */
                var tip = {
                    id: 'lackLoadDataCmp',
                    title: this.localePipe.instant('validate.noLoadDataCmp'),
                    msg: this.localePipe.instant('validate.noLoadDataCmpMsg'),
                    type: 'processWarning'
                };
                warningList.push(tip);
            }
            if (!procCmps.some((/**
             * @param {?} c
             * @return {?}
             */
            function (c) { return c.Time === ToolTime.PROCESSINSTANCE_STARTED; }))) {
                /** @type {?} */
                var tip = {
                    id: 'lackProcessStartCmp',
                    title: this.localePipe.instant('validate.noStartCmp'),
                    msg: this.localePipe.instant('validate.noStartCmpMsg'),
                    type: 'processWarning'
                };
                warningList.push(tip);
            }
            if (!procCmps.some((/**
             * @param {?} c
             * @return {?}
             */
            function (c) { return c.Time === ToolTime.PROCESSINSTANCE_COMPLETED; }))) {
                /** @type {?} */
                var tip = {
                    id: 'lackProcessCompleteCmp',
                    title: this.localePipe.instant('validate.lackProcessCompleteCmp'),
                    msg: this.localePipe.instant('validate.lackProcessCompleteCmpMsg'),
                    type: 'processWarning'
                };
                warningList.push(tip);
            }
            if (!procCmps.some((/**
             * @param {?} c
             * @return {?}
             */
            function (c) { return ((/** @type {?} */ (c.Time))) === 'PROCESSINSTANCE_ABORTED'; }))) {
                /** @type {?} */
                var tip = {
                    id: 'lackProcessAbortCmp',
                    title: this.localePipe.instant('validate.lackProcessAbortCmp'),
                    msg: this.localePipe.instant('validate.lackProcessAbortCmpMsg'),
                    type: 'processWarning'
                };
                warningList.push(tip);
            }
            if (!procCmps.some((/**
             * @param {?} c
             * @return {?}
             */
            function (c) { return c.Time === 'PROCESSINSTANCE_CANCELED'; }))) {
                /** @type {?} */
                var tip = {
                    id: 'lackProcessCancelCmp',
                    title: this.localePipe.instant('validate.lackProcessCancelCmp'),
                    msg: this.localePipe.instant('validate.lackProcessCancelCmpMsg'),
                    type: 'processWarning'
                };
                warningList.push(tip);
            }
            if (!procCmps.some((/**
             * @param {?} c
             * @return {?}
             */
            function (c) { return c.Time === 'PROCESSINSTANCE_ROLLBACK'; }))) {
                /** @type {?} */
                var tip = {
                    id: 'lackProcessBackCmp',
                    title: this.localePipe.instant('validate.lackProcessBackCmp'),
                    msg: this.localePipe.instant('validate.lackProcessBackCmpMsg'),
                    type: 'processWarning'
                };
                warningList.push(tip);
            }
            if (!procCmps.some((/**
             * @param {?} c
             * @return {?}
             */
            function (c) { return c.Time === 'PROCESSINSTANCE_RESUBMIT'; }))) {
                /** @type {?} */
                var tip = {
                    id: 'lackProcessReStartCmp',
                    title: this.localePipe.instant('validate.lackProcessReStartCmp'),
                    msg: this.localePipe.instant('validate.lackProcessReStartCmpMsg'),
                    type: 'processWarning'
                };
                warningList.push(tip);
            }
        }
    };
    /**
     * @private
     * @param {?} bpmnModel
     * @param {?} warningList
     * @return {?}
     */
    WfValidatorAdapter.validateParallelGateway = /**
     * @private
     * @param {?} bpmnModel
     * @param {?} warningList
     * @return {?}
     */
    function (bpmnModel, warningList) {
        /** @type {?} */
        var flowElements = bpmnModel.DefaultProcess.GetFlowElements();
        /** @type {?} */
        var parallelGatewayCount = 0;
        for (var k in flowElements) {
            if (flowElements[k] instanceof ParallelGateway) {
                parallelGatewayCount++;
            }
        }
        if (parallelGatewayCount % 2 !== 0) {
            /** @type {?} */
            var tip = {
                id: 'parallelGatewayCheck',
                title: this.localePipe.instant('validate.parallelGatewayCheck'),
                msg: this.localePipe.instant('validate.parallelGatewayCheckMsg'),
                type: 'processWarning'
            };
            warningList.push(tip);
        }
    };
    /**
     * @private
     * @param {?} bpmnModel
     * @param {?} warningList
     * @return {?}
     */
    WfValidatorAdapter.validateApprovalPerformers = /**
     * @private
     * @param {?} bpmnModel
     * @param {?} warningList
     * @return {?}
     */
    function (bpmnModel, warningList) {
        /** @type {?} */
        var flowElements = bpmnModel.DefaultProcess.GetFlowElements();
        /** @type {?} */
        var count = 0;
        for (var k in flowElements) {
            /** @type {?} */
            var act = flowElements[k];
            if (act instanceof UserActivity || act instanceof OperationActivity) {
                /** @type {?} */
                var roles = act.GetResourceRoles();
                if (roles.length == 0 && (!act.AssignPerformerConfig || !act.AssignPerformerConfig.AllowGlobalAssign)) {
                    /** @type {?} */
                    var tip = {
                        id: 'approvalPerformerCheck' + count,
                        title: "\u3010" + flowElements[k].Name + "\u3011" + this.localePipe.instant('validate.approvalPerformerCheck'),
                        msg: "",
                        type: 'processWarning'
                    };
                    warningList.push(tip);
                    count++;
                }
            }
        }
    };
    /**
     * @private
     * @param {?} bpmnModel
     * @return {?}
     */
    WfValidatorAdapter.validatePrcoessVaris = /**
     * @private
     * @param {?} bpmnModel
     * @return {?}
     */
    function (bpmnModel) {
        var e_2, _a;
        /** @type {?} */
        var objects = bpmnModel.DefaultProcess.GetDataObjects();
        /** @type {?} */
        var procVaris = new Array();
        if (objects && objects.length > 0) {
            procVaris = objects.filter((/**
             * @param {?} o
             * @return {?}
             */
            function (o) { return o.DataType.Category !== 'CustomType'; })).map((/**
             * @param {?} o
             * @return {?}
             */
            function (o) { return o.Name; }));
        }
        /** @type {?} */
        var flowElements = bpmnModel.DefaultProcess.GetFlowElements();
        for (var k in flowElements) {
            if (flowElements[k] instanceof UserActivity ||
                flowElements[k] instanceof OperationActivity ||
                flowElements[k] instanceof AutoActivity ||
                flowElements[k] instanceof MessageActivity ||
                flowElements[k] instanceof CallActivitySubProcess ||
                flowElements[k] instanceof IntermediateCatchEventImpl ||
                flowElements[k] instanceof NotifyActivity) {
                /** @type {?} */
                var variSets = ((/** @type {?} */ (flowElements[k]))).variableSettings;
                if (variSets) {
                    var _loop_1 = function (v) {
                        if (!procVaris.some((/**
                         * @param {?} p
                         * @return {?}
                         */
                        function (p) { return p === v.variableCode; }))) {
                            return { value: {
                                    valid: false,
                                    type: 'message',
                                    level: 'warning',
                                    message: "\u3010" + flowElements[k].Name + "\u3011" + this_1.localePipe.instant('validate.noVariable1')
                                        + ("\u3010" + v.variableName + "\u3011") + this_1.localePipe.instant('validate.noVariable2')
                                } };
                        }
                    };
                    var this_1 = this;
                    try {
                        for (var variSets_1 = __values(variSets), variSets_1_1 = variSets_1.next(); !variSets_1_1.done; variSets_1_1 = variSets_1.next()) {
                            var v = variSets_1_1.value;
                            var state_1 = _loop_1(v);
                            if (typeof state_1 === "object")
                                return state_1.value;
                        }
                    }
                    catch (e_2_1) { e_2 = { error: e_2_1 }; }
                    finally {
                        try {
                            if (variSets_1_1 && !variSets_1_1.done && (_a = variSets_1.return)) _a.call(variSets_1);
                        }
                        finally { if (e_2) throw e_2.error; }
                    }
                }
            }
        }
        return {
            valid: true,
        };
    };
    /**
     * @private
     * @param {?} bpmnModel
     * @return {?}
     */
    WfValidatorAdapter.validateActivityList = /**
     * @private
     * @param {?} bpmnModel
     * @return {?}
     */
    function (bpmnModel) {
        /** @type {?} */
        var flowElements = bpmnModel.DefaultProcess.GetFlowElements();
        /** @type {?} */
        var resActId = this.validateActivityId(flowElements);
        if (!resActId.valid) {
            return resActId;
        }
        /** @type {?} */
        var resActName = this.validateActivityName(flowElements);
        if (!resActName.valid) {
            return resActName;
        }
        return {
            valid: true,
        };
    };
    /**
     * @private
     * @param {?} flowElements
     * @return {?}
     */
    WfValidatorAdapter.validateActivityId = /**
     * @private
     * @param {?} flowElements
     * @return {?}
     */
    function (flowElements) {
        for (var k in flowElements) {
            switch (flowElements[k].ClrTypeID) {
                case 'wf.StartActivity':
                    /** @type {?} */
                    var startActivity = (/** @type {?} */ (flowElements[k]));
                    if (!startActivity.Id.startsWith('startActivity')) {
                        return {
                            valid: false,
                            type: 'message',
                            level: 'error',
                            message: this.localePipe.instant('validate.activity') +
                                ("" + startActivity.Name) + this.localePipe.instant('validate.noStartActivity')
                        };
                    }
                    break;
                case 'bpmn.ExclusiveGateway':
                    /** @type {?} */
                    var exclusiveGateway = (/** @type {?} */ (flowElements[k]));
                    if (!exclusiveGateway.Id.startsWith('ExclusiveGateway')) {
                        return {
                            valid: false,
                            type: 'message',
                            level: 'error',
                            message: this.localePipe.instant('validate.activity') +
                                ("" + exclusiveGateway.Name) + this.localePipe.instant('validate.noExclusiveGateway')
                        };
                    }
                    break;
                case 'bpmn.ParallelGateway':
                    /** @type {?} */
                    var parallelGateway = (/** @type {?} */ (flowElements[k]));
                    if (!parallelGateway.Id.startsWith('ParallelGateway')) {
                        return {
                            valid: false,
                            type: 'message',
                            level: 'error',
                            message: this.localePipe.instant('validate.activity') +
                                ("" + parallelGateway.Name) + this.localePipe.instant('validate.noParallelGateway')
                        };
                    }
                    break;
                case 'wf.UserActivity':
                    /** @type {?} */
                    var userActivity = (/** @type {?} */ (flowElements[k]));
                    if (!userActivity.Id.startsWith('UserActivity')) {
                        return {
                            valid: false,
                            type: 'message',
                            level: 'error',
                            message: this.localePipe.instant('validate.activity') +
                                ("" + userActivity.Name) + this.localePipe.instant('validate.noUserActivity')
                        };
                    }
                    break;
                case 'wf.OperationActivity':
                    /** @type {?} */
                    var operationActivity = (/** @type {?} */ (flowElements[k]));
                    if (!operationActivity.Id.startsWith('UserActivity')) {
                        return {
                            valid: false,
                            type: 'message',
                            level: 'error',
                            message: this.localePipe.instant('validate.activity') +
                                ("" + operationActivity.Name) + this.localePipe.instant('validate.noOperationActivity')
                        };
                    }
                    break;
                case 'wf.NotifyActivity':
                    /** @type {?} */
                    var notifyActivity = (/** @type {?} */ (flowElements[k]));
                    if (!notifyActivity.Id.startsWith('NotifyActivity')) {
                        return {
                            valid: false,
                            type: 'message',
                            level: 'error',
                            message: this.localePipe.instant('validate.activity') +
                                ("" + notifyActivity.Name) + this.localePipe.instant('validate.noNotifyActivity')
                        };
                    }
                    break;
                case 'wf.CallActivitySubProcess':
                    /** @type {?} */
                    var callActivitySubProcess = (/** @type {?} */ (flowElements[k]));
                    if (!callActivitySubProcess.Id.startsWith('CallActivitySubProcess')) {
                        return {
                            valid: false,
                            type: 'message',
                            level: 'error',
                            message: this.localePipe.instant('validate.activity') +
                                ("" + callActivitySubProcess.Name) + this.localePipe.instant('validate.noCallActivitySubProcess')
                        };
                    }
                    break;
                case 'wf.AutoActivity':
                    /** @type {?} */
                    var autoActivity = (/** @type {?} */ (flowElements[k]));
                    if (!autoActivity.Id.startsWith('autoActivity')) {
                        return {
                            valid: false,
                            type: 'message',
                            level: 'error',
                            message: this.localePipe.instant('validate.activity') +
                                ("" + autoActivity.Name) + this.localePipe.instant('validate.noAutoActivity')
                        };
                    }
                    break;
                case 'wf.IntermediateCatchEventImpl':
                    /** @type {?} */
                    var intermediateCatchEventImpl = (/** @type {?} */ (flowElements[k]));
                    if (!intermediateCatchEventImpl.Id.startsWith('IntermediateCatchEvent')) {
                        return {
                            valid: false,
                            type: 'message',
                            level: 'error',
                            message: this.localePipe.instant('validate.activity') +
                                ("" + intermediateCatchEventImpl.Name) + this.localePipe.instant('validate.noIntermediateCatchEvent')
                        };
                    }
                    break;
                case 'wf.MessageActivity':
                    /** @type {?} */
                    var messageActivity = (/** @type {?} */ (flowElements[k]));
                    if (!messageActivity.Id.startsWith('MessageActivity')) {
                        return {
                            valid: false,
                            type: 'message',
                            level: 'error',
                            message: this.localePipe.instant('validate.activity') +
                                ("" + messageActivity.Name) + this.localePipe.instant('validate.noMessageActivity')
                        };
                    }
                    break;
                case 'wf.AifCreationBillActivity':
                    /** @type {?} */
                    var aifCreationBillActivity = (/** @type {?} */ (flowElements[k]));
                    if (!aifCreationBillActivity.Id.startsWith('AifCreationBillActivity')) {
                        return {
                            valid: false,
                            type: 'message',
                            level: 'error',
                            message: this.localePipe.instant('validate.activity') +
                                ("" + aifCreationBillActivity.Name) + this.localePipe.instant('validate.noAifCreationBillActivity')
                        };
                    }
                    break;
                case 'bpmn.EndEvent':
                    /** @type {?} */
                    var endEvent = (/** @type {?} */ (flowElements[k]));
                    if (!endEvent.Id.startsWith('EndEvent')) {
                        return {
                            valid: false,
                            type: 'message',
                            level: 'error',
                            message: this.localePipe.instant('validate.activity') +
                                ("" + endEvent.Name) + this.localePipe.instant('validate.noEndEvent')
                        };
                    }
                    break;
            }
        }
        return {
            valid: true,
        };
    };
    /**
     * @private
     * @param {?} flowElements
     * @return {?}
     */
    WfValidatorAdapter.validateActivityName = /**
     * @private
     * @param {?} flowElements
     * @return {?}
     */
    function (flowElements) {
        for (var k in flowElements) {
            /** @type {?} */
            var flowNode = flowElements[k];
            switch (flowNode.ClrTypeID) {
                case "wf.StartActivity":
                case "bpmn.ExclusiveGateway":
                case "bpmn.ParallelGateway":
                case "wf.UserActivity":
                case "wf.OperationActivity":
                case "wf.NotifyActivity":
                case "wf.CallActivitySubProcess":
                case "wf.AutoActivity":
                case "wf.IntermediateCatchEventImpl":
                case "wf.MessageActivity":
                case "wf.AifCreationBillActivity":
                case "bpmn.EndEvent":
                    if (flowNode.Name == null || flowNode.Name == "") {
                        return {
                            valid: false,
                            type: 'message',
                            level: 'error',
                            message: this.localePipe.instant('validate.mark') +
                                ("" + flowNode.Id) + this.localePipe.instant('validate.noFlowNodeChsName')
                        };
                    }
                    if (new Blob([flowNode.Name]).size > 128) {
                        return {
                            valid: false,
                            type: 'message',
                            level: 'error',
                            message: this.localePipe.instant('validate.activity') +
                                ("" + flowNode.Name) + this.localePipe.instant('validate.nameExceedsLengthLimit')
                        };
                    }
                    break;
            }
        }
        return {
            valid: true,
        };
    };
    WfValidatorAdapter.localePipe = null;
    return WfValidatorAdapter;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/** @enum {string} */
var EventBusKeys = {
    new: "new",
    batchCopyProperty: "batchCopyProperty",
    batchSetProperty: 'batchSetProperty',
};

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/** @type {?} */
var WF_PROCESS_EDITOR_LANG_RESOURCES = {
    "zh-CHS": {
        "validate": {
            "noProcessHeader": "模型不存在processHeader属性",
            "cmpsEmpty": "流程构件为空",
            "cmpsEmptyMsg": "流程构件不允许为空，请联系表单开发确认问题",
            "directNoPf": "启动方式为【直接】的流程不应该包含共享（PF）的流程构件",
            "directNoPfMsg": "请移除以下共享（PF）的流程构件：",
            "noLoadDataCmp": "缺少执行时机为[获取数据]的流程构件",
            "noLoadDataCmpMsg": "流程定义不能缺少取数构件，请联系表单开发确认问题",
            "noStartCmp": "缺少执行时机为[流程启动]的流程构件",
            "noStartCmpMsg": "会导致流程启动时无法修改单据状态，请联系表单开发确认问题",
            "lackProcessCompleteCmp": "缺少执行时机为[流程完成]的流程构件",
            "lackProcessCompleteCmpMsg": "会导致流程完成时无法修改单据状态，请联系表单开发确认问题",
            "lackProcessAbortCmp": "缺少执行时机为[流程终止]的流程构件",
            "lackProcessAbortCmpMsg": "会导致流程终止时无法修改单据状态，请联系表单开发确认问题",
            "lackProcessCancelCmp": "缺少执行时机为[流程终止]的流程构件",
            "lackProcessCancelCmpMsg": "会导致流程终止时无法修改单据状态，请联系表单开发确认问题",
            "lackProcessBackCmp": "缺少执行时机为[流程驳回]的流程构件",
            "lackProcessBackCmpMsg": "会导致流程驳回时无法修改单据状态，请联系表单开发确认问题",
            "lackProcessReStartCmp": "缺少执行时机为[重新提交]的流程构件",
            "lackProcessReStartCmpMsg": "会导致流程重新提交时无法修改单据状态，请联系表单开发确认问题",
            "parallelGatewayCheck": "【并行网关】没有成对出现",
            "parallelGatewayCheckMsg": "【并行网关】需作为一条流程分支的拆分节点和汇聚节点成对出现，请修改",
            "approvalPerformerCheck": "活动，未设置参与者",
            "noVariable1": "活动【变量设置】属性中已设置变量",
            "noVariable2": "在流程属性【流程变量】中已不存在，请修改！",
            "activity": "活动【",
            "noStartActivity": "】的标识不合法，不是以[startActivity]开头",
            "noExclusiveGateway": "】的标识不合法，不是以[ExclusiveGateway]开头",
            "noParallelGateway": "】的标识不合法，不是以[ParallelGateway]开头",
            "noUserActivity": "】的标识不合法，不是以[UserActivity]开头",
            "noOperationActivity": "】的标识不合法，不是以[OperationActivity]开头",
            "noNotifyActivity": "】的标识不合法，不是以[NotifyActivity]开头",
            "noCallActivitySubProcess": "】的标识不合法，不是以[CallActivitySubProcess]开头",
            "noAutoActivity": "】的标识不合法，不是以[AutoActivity]开头",
            "noIntermediateCatchEvent": "】的标识不合法，不是以[IntermediateCatchEventImpl]开头",
            "noMessageActivity": "】的标识不合法，不是以[MessageActivity]开头",
            "noAifCreationBillActivity": "】的标识不合法，不是以[AifCreationBillActivity]开头",
            "noEndEvent": "】的标识不合法，不是以[EndEvent]开头",
            "mark": "标识为【",
            "noFlowNodeChsName": "】的活动简体中文名称为空，请修改",
            "nameExceedsLengthLimit": "】的名称超长，不能超过40个字符，请修改"
        },
        "processEditor": {
            "tip": "提示",
            "showButton": "显示查看模型按钮",
            "changeRecord": "流程变更记录",
            "noDtInfo": "不存在设计时流程信息！请先赋值！",
            "noRtInfo": "不存在运行时流程信息！请先赋值！",
            "wrongMoment": "设计器运行时机错误！",
            "prompted": "系统提示",
            "saveSuccess": "保存成功",
            "waitReview": "保存成功，等待发起审核",
            "successPublish": "发布成功",
            "publishFail": "发布失败，",
            "policyConflict": "会签策略下,“驳回规则”不允许“动态选择驳回级次”，请修改！",
            "noPermissionToSave": "当前用户不具备另存流程的权限",
            "closeProc1": "关闭此页面？",
            "closeProc2": "系统可能不会保存您所做的更改。",
            "viewModel": "查看模型",
            "copied": "模型已经复制到剪贴板",
            "button": {
                "saveProc": "保存",
                "releaseProc": "发布",
                "sync": "同步设计时包",
                "saveAs": "另存为",
                "procRecord": "流程记录",
                "viewProcModel": "查看模型",
                "closeProc": "关闭"
            }
        },
        "designer": {
            "wfEditorUi": {
                "basicElements": "基本元素",
                "readOnly": "只读"
            },
            "wfProcessCell": {
                "basicInfo": "基本信息",
                "name": "名称",
                "nameLanguage": "名称",
                "key": "标识",
                "entryForm": "流程分类",
                "startMode": "启动方式",
                "wfTitle": "流程摘要",
                "formDef": "表单定义",
                "formsPC": "PC表单",
                "formsMobile": "移动表单",
                "process": "事件监听",
                "advanced": "高级属性",
                "basic": "基础属性",
                "wfComponent": "流程构件",
                "otherConfig": "其他配置",
                "processVariables": "流程变量",
                "basicElements": "基本元素",
                "customizeAction": "自定义动作",
                "timelinessInfo": "时效信息",
                "enablePriority": "启用紧急程度",
                "enableWholeOrderRetrieve": "撤回在审单据",
                "messageProperty": "影像设置",
                "timeLimitControl": "超时操作",
                "messageNotice": "消息通知",
                "extendProperty": "扩展属性",
                "directTips": "提示：启动方式切换为直接，直接启动是默认的流程启动方式，切换后会移除共享(PF)相关构件，请知悉！",
                "externalTips": "提示：启动方式切换为外部流程，适用于作为共享流程的外部流程相关场景，切换后保留流程上的共享（PF)相关构件，请知悉！",
                "subprocessTips": "提示：启动方式切换为子流程，适用于调用式子流程的场景，切换后会移除除取数构件外的其他流程构件，请知悉！"
            },
            "WfSequenceFlowEdge": {
                "basicInfo": "基本信息",
                "basic": "基础属性",
                "name": "名称",
                "nameLanguage": "名称",
                "id": "标识",
                "condition": "条件选项",
                "ConditionExpression": "条件",
                "default": "缺省转移线"
            },
            "wfSidebar": {
                "bizactivitylib": "业务活动"
            }
        },
        "app": {
            "processDesigner": {
                "all": "所有",
                "assign": "指派",
                "claim": "领用",
                "preempt": "抢占模式",
                "parallel": "并行会签",
                "sequential": "串行会签",
                "true": "是",
                "false": "否",
                "dataId": "单据内码",
                "procInstId": "流程实例ID",
                "bizDefKey": "入口单据ID",
                "processDefinitionKey": "流程定义KEY",
                "procInstCreator": "流程发起人",
                "businessCreator": "业务发起人",
                "procInstDescription": "流程摘要",
                "comment": "审批意见",
                "bizDefName": "流程分类名称",
                "curLoginUsername": "当前登录人名称",
                "procInstCreatorName": "流程发起人名称",
                "currentParticipantId": "当前办理人ID",
                "currentParticipantName": "当前办理人名称",
                "currentUser": "当前登录用户",
                "preActExecutors": "上一个活动的执行人",
                "collectionElementVariable": "多实例子活动元素变量",
                "subCollectionElementVariable": "多实例子流程元素变量",
                "nrOfInstances": "多实例总数量",
                "nrOfCompletedInstances": "多实例已完成数量",
                "nrOfActiveInstances": "多实例正在运行中的数量",
                "nrOfForward": "通过实例数量",
                "nrOfBackward": "驳回实例数量",
                "nrOfAbort": "终止实例数量",
                "conclusionType": "结论类型",
                "conclusionValue": "结论值",
                "directSuperior": "直接上级",
                "higherSuperior": "间接上级",
                "DIRECT": "直接",
                "EXTERNAL_PROCESS": "外部流程",
                "SUB_PROCESS": "子流程",
                "ALL": "电脑端和移动端",
                "WEB": "电脑端",
                "APP": "移动端",
                "conclusionTypeTips": "审批项流转方向，1正向，2反向，3终止",
                "conclusionValueTips": "\u5BA1\u6279\u9879\u7F16\u53F7\uFF0C\u4F8B\u5982\uFF0C\"Pass\"\u3001\"Back\"\u3001\"Refuse\"",
                "copy": "_副本",
                "saveAs": "另存为",
                "tips": "系统提示",
                "saveAsSuccess": "另存为成功",
                "saveAsFail": "另存为失败，请检查流程是否正确！",
                "syncDt": "是否将当前版本流程定义同步到设计时流程定义包",
                "syncSuccess": "同步成功",
                "beforeCompleteStrategyChange": "当前节点存在运行中的活动实例，不允许调整完成策略，请了解！",
                "releaseProcess": "发布前审核",
                "auto": "自动生单",
                "push": "推式生单",
                "pull": "拉式生单",
                "creation": "通过生单流程生成目标单"
            }
        },
        "multiInstanceLoopCharacteristics": {
            "loopCharacteristics": "多实例设置",
            "set": "（已设置）",
            "notSet": "（未设置）",
            "isEnable": "是否启用",
            "isSequential": "是否串行",
            "loopCardinality": "元素集合",
            "completionConditionRules": "完成条件",
            "promptAct1": "1、[集合]中的元素个数为子活动启动实例数量。",
            "promptAct2": "2、子活动启动时系统会将[集合]中的元素拆分映射到各个子活动实例的[元素变量]。",
            "promptProc1": "1、[集合]中的元素个数为子流程启动实例数量。",
            "promptProc2": "2、子流程启动时系统会将[集合]中的元素拆分映射到各个子流程实例的[元素变量]。",
            "checkPrompt": "当前节点存在运行中的活动实例，不允许调整",
            "conditionRulesSet": "（已设置）",
            "completionConditionRulesList": {
                "forward": "正向",
                "backward": "反向",
                "abort": "终止"
            }
        },
        "component": {
            "optins": {
                "wfOptions": "工作流选项",
                "specified": "指定子流程",
                "dynamic": "动态子流程",
                "set": "（已设置）",
                "notSet": "（未设置）",
                "subProcessType": "子流程类型",
                "processType": "流程类型",
                "bizDef": "流程分类",
                "procDef": "流程定义",
                "clickCancel": "取消",
                "clickOk": "确定"
            },
            "voConfig": {
                "documentInfo": "单据信息",
                "viewModelSelection": "视图模型选择",
                "cancel": "取消",
                "clickOk": "确定",
                "selectOne": "确定",
                "documentTypeSelect": "单据类型选择",
                "set": "（已设置）",
                "notSet": "（未设置）",
                "viewModel": "视图模型",
                "documenttype": "单据类型",
                "placeholder": "请选择"
            },
            "variableSetting": {
                "constant": "常量",
                "expression": "表达式",
                "component": "构件",
                "ACTIVITY_STARTED": "活动开始",
                "ACTIVITY_COMPLETED": "活动结束",
                "varAssign": "变量赋值",
                "varNumber": "变量编号",
                "REQUIRED": "必填",
                "varName": "变量名称",
                "valueType": "值类型",
                "executionTime": "执行时机",
                "valueText": "变量值",
                "processVariables": "流程变量",
                "notSelectedVar": "尚未选中变量！",
                "valueCannotEmpty": "变量值不允许为空！",
                "set": "（已设置）",
                "notSet": "（未设置）",
                "add": "新增",
                "delete": "删除",
                "serialNumber": "序号",
                "clickCancel": "取消",
                "clickOK": "确定",
                "inconsistentParameters": "当前构件方法参数不一致，请更新！",
                "methodNotExist": "当前构件已不存在此方法，请更新！",
                "parameterName": "参数名",
                "parameterValue": "参数值",
                "methodnotSelected": "尚未选择构件方法",
                "metadataNotExist": "帮助元数据不存在，请联系系统管理员查看原因！",
                "errorObtainComponent": "获取解析构件出错",
                "componentSelection": "构件选择",
                "componentName": "构件名称",
                "parameterList": "参数列表",
                "lineNumber": "序号"
            },
            "urgeHandleRule": {
                "urgentApproval": "催办审批：",
                "pleaseApprove": "请您尽快审批",
                "soOn": "的",
                "urgeHandle": "催办",
                "noSendingMethod": "尚未选择发送方式！",
                "setMessageTemplate": "消息渠道启用短信时需设置消息模板",
                "codeEmpty": "短信模板编号不允许为空",
                "noMessageSubject": "尚未配置消息主题！",
                "noMessageContent": "尚未选择消息内容！",
                "earliestTimeNotEmpty": "最早允许催办时间不允许为空",
                "minimumTimeNotEmpty": "最小允许催办间隔不允许为空",
                "set": "（已设置）",
                "notSet": "（未设置）",
                "enableUrgeHandle": "启用催办",
                "timeSetting": "时间设置",
                "earliestTime": "最早允许催办时间（小时）",
                "minimumInterval": "最小允许催办间隔（小时）",
                "sendingMethod": "发送方式",
                "messageSubject": "消息主题",
                "supportEditing": "支持编辑",
                "messageContent": "消息内容",
                "displayReminder": "显示催办人",
                "clickCancel": "取消",
                "clickOK": "确定"
            },
            "titleExpression": {
                "zh-CHS": "中文简体",
                "zh-CHT": "中文繁体",
                "en": "英文",
                "taskDescription": "任务描述",
                "set": "（已设置）",
                "notSet": "（未设置）",
                "currentLanguage": "当前摘要语言:",
                "clickCancel": "取消",
                "clickOK": "确定"
            },
            "timeLimitControl": {
                "timedOutOperation": "超时操作",
                "constant": "固定值",
                "scope": "时间范围",
                "day": "天",
                "hour": "时",
                "minute": "分",
                "BeforeDuration": "到期之前",
                "OnDuration": "到期时",
                "AfterDuration": "到期之后",
                "SendMessageExpireOperation": "超时预警",
                "AutoHandleExpireOperation": "自动办理",
                "curDay": "当天",
                "durationType": "期限类型",
                "required": "必填",
                "timeDuration": "时长",
                "timeUnit": "单位",
                "operationTypeName": "操作类型名称",
                "sendType": "操作",
                "onlyBeInteger": "任务期限只能是整数！",
                "setOperation": "请设置超时操作！",
                "setType": "请设置自动办理类型！",
                "setComments": "请设置自动办理意见！",
                "selectedOperation": "尚未选中预警操作！",
                "notSupportAutomatic": "下一节点是由当前办理人指派的话，当前节点不支持任务自动办理",
                "warningMessage": "预警消息",
                "automaticProcessing": "自动办理",
                "set": "（已设置）",
                "notSet": "（未设置）",
                "timelinessControl": "任务处理时效控制",
                "isEnable": "是否启用",
                "taskDeadline": "任务期限",
                "timelyOperation": "时效预警操作",
                "actionList": "操作列表",
                "add": "新增",
                "remove": "删除",
                "clickCancel": "取消",
                "clickOK": "确定",
                "workItemParticipant": "当前节点办理人",
                "procInstCreator": "流程发起人",
                "to-doMessageTimeOut": "您有一条待办消息即将超时。",
                "messageTimeOut": "您有一条消息即将超时",
                "agree": "同意"
            },
            "sendMessageOperation": {
                "procInstCreator": "流程发起人",
                "workItemParticipant": "当前节点办理人",
                "preActExecutors": "上一节点办理人",
                "day": "天",
                "hour": "时",
                "minute": "分",
                "cycleTimeNotEmpty": "循环时间间隔不允许为空！",
                "sendMethodNotEmpty": "发送方式不允许为空！",
                "subjectNotEmpty": "消息主题不允许为空！",
                "contentNotEmpty": "消息内容不允许为空！",
                "recipientNotEmpty": "接收人不允许为空！",
                "messageTemplate": "消息渠道启用短信时需设置消息模板",
                "smsTemplateNumberNotEmpty": "短信模板编号不允许为空",
                "cycleEnable": "启用循环预警",
                "cycleTime": "循环时间间隔",
                "sendType": "发送方式",
                "subject": "消息主题",
                "message": "消息内容",
                "receiverVari": "接收人",
                "sysUsers": "系统用户",
                "clickCancel": "取消",
                "clickOK": "确定",
                "opinionsNotEmpty": "自动办理意见不允许为空！",
                "processingNotEmpty": "自动办理不允许为空！",
                "automaticProcessSet": "自动办理设置",
                "automaticProcessMethod": "自动办理方式",
                "automaticOpinionHandle": "自动办理意见"
            },
            "smsMessageTemplate": {
                "smsTemplateContent": "第三方短信服务商里定义的模板原文，例如:阿里云您的管控大数据平台账号已开通,用户名为:${username}，初始密码为:${code}，请及时登录系统",
                "code": "变量",
                "value": "值",
                "noRowsSelected": "尚未选中行",
                "smsMessageTemplate": "短信服务模板",
                "tips1": "消息模板是指已经在第三方短信服务商定义模板后，需要在GS Cloud里将短信服务商的模板变量和GS Cloud变量关联",
                "tips2": "第三方短信服务商里定义的模板编号，例如: 阿里云 SMS_220626324",
                "tips3": "将第三方短信服务商模板里的变量和GSCloud里的变量配置关联",
                "smsTemplateNumber": "短信模板编号",
                "smsVariableBinding": "短信变量绑定",
                "addSmsVariable": "新增",
                "deleteSmsVariable": "删除"
            },
            "signRule": {
                "countersignRules": "会签规则",
                "byNumber": "按数量",
                "byProportion": "按比例(%)",
                "customConditions": "自定义条件",
                "value": "编号",
                "text": "名称",
                "conclusionName": "结论名称",
                "conclusionValue": "结论值",
                "calculateType": "计算方式",
                "conditionValue": "条件值",
                "waitAllVotes": "等待全员办结",
                "yes": "是",
                "no": "否",
                "notEmpty": "完成策略为会签时，会签规则不允许为空，请了解！",
                "pleaseSelect": "请首先选中一条审批项！",
                "maxConditionValue": "条件值最大值是100",
                "minConditionValue": "条件值最小值是0",
                "noConditional": "结论执行方式为全票或一票时不需要条件值",
                "set": "（已设置）",
                "ruleList": "规则列表",
                "approvalOptions": "审批选项",
                "clickCancel": "取消",
                "deleteRow": "重置",
                "clickOK": "确定",
            },
            "saveAsEdit": {
                "public": "公有",
                "private": "私有",
                "code": "编号",
                "name": "名称",
                "nameNotEmpty": "流程名称不能为空",
                "organizationNotEmpty": "维护组织不能为空",
                "organization": "组织",
                "basicAttributes": "基础属性",
                "processName": "流程名称",
                "processKeyValue": "流程Key值",
                "maintenanceOrg": "维护组织",
                "accessLevel": "访问级别",
                "saveAsCancel": "取消",
                "saveAsOK": "确定"
            },
            "release": {
                "release": "流程发布",
                "update": "流程更新",
                "applicantName": "申请人名称",
                "applicantDepartment": "申请人部门",
                "procName": "流程名称",
                "procVersion": "流程版本",
                "releaseType": "发布类型",
                "textDetail": "说明",
                "saveAsCancel": "取消",
                "saveAsOK": "确定"
            },
            "processVariables": {
                "string": "字符",
                "integer": "整形",
                "decimal": "小数",
                "boolean": "布尔",
                "constant": "常量",
                "expression": "表达式",
                "component": "构件",
                "name": "变量编号",
                "required": "必填",
                "documentation": "变量名称",
                "basicType": "变量类型",
                "description": "描述",
                "tag": "初始值类型",
                "valueText": "初始值",
                "processVariables": "流程变量",
                "notSelected": "尚未选中流程变量！",
                "variableNumberEmpty": "变量编号不允许为空！",
                "variableNameEmpty": "变量名称不允许为空！",
                "variableNumberNotStandard": "变量编号只能包含字母、数字和下划线，且不能以数字开头！",
                "tagNotEmpty": "初始值类型不允许为空！",
                "codeDuplicates": "流程变量编号不允许重复！",
                "alreadyExists": "新增的变量已存在！",
                "set": "（已设置）",
                "notSet": "（未设置）",
                "add": "新增",
                "delete": "删除",
                "number": "序号",
                "clickCancel": "取消",
                "clickOK": "确定"
            },
            "participant": {
                "user": "用户",
                "variable": "变量参与者",
                "position": "岗位",
                "role": "角色",
                "component": "构件参与者",
                "reportingLine": "汇报关系",
                "matrix": "矩阵",
                "activityExecutor": "历史活动办理人",
                "organization": "单位/部门",
                "all": "所有",
                "assign": "指派",
                "claim": "领用",
                "currentUser": "当前办理人",
                "procInstCreator": "流程发起人",
                "participantSet": "参与者设置",
                "order": "序号",
                "type": "类型",
                "performerName": "名称",
                "description": "描述",
                "condition": "启用条件",
                "dataMovement1": "是否将默认办理人数据移动到到备选办理人？",
                "dataMovement2": "是否将备选办理人数据移动到默认办理人？",
                "participantSelection": "参与者选择",
                "selectProcessVariables": "尚未选择流程变量！",
                "selectVariableValueType": "尚未选择变量值类型！",
                "selectRelation": "尚未选择关系！",
                "selectPosition": "尚未选择岗位！",
                "selectOrgType": "尚未选择组织类型！",
                "orgFill": "尚未填写组织！",
                "refOrgIdNotNull": "参照类型为组织时，参照组织字段不能为空",
                "refUserIdNotNull": "参照类型为系统用户/员工时，参照人字段不能为空",
                "repDefConfigured": "该汇报关系已经进行过配置",
                "atLeastOneCondition": "条件字段至少要存在一个",
                "dataFieldAliasNotNull": "数据字段不能为空",
                "matrixConfigured": "该矩阵已经进行过配置",
                "selectPerformer": "尚未选择参与者",
                "definitionDeleted": "该条汇报关系数据的定义已删除，该条数据将删除",
                "matrixDeleted": "该条矩阵数据的定义已删除，该条数据将删除",
                "selectParticipantInfo": "请先选中一条参与者信息！",
                "noRowSelected": "尚未选中行！",
                "selectDefaultHandler": "请先选中一条默认办理人",
                "selectpotentialtHandler": "请先选中一条备选办理人",
                "org": "组织：",
                "positionType1": "岗位类型：通用岗位，组织：",
                "positionType2": "岗位类型：通用岗位",
                "positionType3": "岗位类型：组织岗位",
                "comp": "构件：",
                "parameters:": ",参数：{",
                "referencePerson:": "参照人：",
                "referenceOrganization:": "参照组织：",
                "condition1": "条件1：",
                "condition2": "条件2：",
                "condition3": "条件3：",
                "data": "数据：",
                "set": "（已设置）",
                "notSet": "（未设置）",
                "allocationPolicy": "分配策略",
                "operator": "指派操作人",
                "multiSelect": "允许多选",
                "necessary": "只有一个待选用户时，仍需手工选择",
                "notifyRecipient": "知会接收人",
                "defaultHandler": "默认办理人",
                "new": "新增",
                "editPerformer": "编辑",
                "removePerformer": "移除",
                "clearPerformer": "清空",
                "moveUp": "上移",
                "moveDown": "下移",
                "alternativeHandler": "备选办理人",
                "isAllScope": "指定参与人时不限范围，从全员用户中选择",
                "clickCancel": "取消",
                "clickOK": "确定",
                "alternativeScope": "备选范围",
                "orgId": "组织ID",
                "includeChildren": "包含下级",
                "conditon": "启用条件",
                "currentUnit": "本单位",
                "currentDepartment": "本部门",
                "variableOrganization": "变量组织"
            },
            "activityExecutor": {
                "name": "名称",
                "eventHandler": ">活动办理人",
                "nodeName": "节点名称",
                "enablingConditions": "启用条件",
                "activityList": "活动列表",
                "clickCancel": "取消",
                "clickOK": "确定"
            },
            "componentPerformer": {
                "componentMethod": "当前构件方法参数不一致，请更新！",
                "methodNotExist": "当前构件已不存在此方法，请更新！",
                "code": "编号",
                "name": "名称",
                "description": "描述",
                "valueText": "参数值",
                "help": "帮助",
                "errorObtaining": "获取解析构件出错",
                "componentSelection": "构件选择",
                "metadataNotExist": "帮助元数据不存在！",
                "serverSideNotFound": "服务器端未找到帮助元数据，请检查元数据是否已经部署到环境中",
                "componentName": "构件名称",
                "componentSelect": "构件选择",
                "parameterList": "参数列表"
            },
            "matrixPerformer": {
                "code": "编号",
                "name": "名称",
                "help": "帮助",
                "multivalue": "多值",
                "enumSelection": "枚举选择",
                "refMatrixTable": "引用矩阵表",
                "matrixTable": "矩阵表",
                "curDataFieldValue": "结果列",
                "conditionFields": "条件字段",
                "condition": "启用条件",
                "key": "键",
                "value": "值",
                "notSelectEnum": "尚未选中枚举值",
                "cancel": "取消",
                "onConfirm": "确定",
                "lineNumber": "序号"
            },
            "performerOptions": {
                "leave": "向下流转",
                "throwException": "异常提示",
                "sys": "用户ID",
                "administrative_staff": "员工ID",
                "procInstCreator": "流程发起人",
                "preActExecutors": "上一节点办理人",
                "allPassExecutors": "所有已办理人员",
                "performerOptions": "参与者选项",
                "exclusionNotAllowed": "所有已办理人员已设置自动审批，上个节点已办理人员默认不允许排除！",
                "approvalNotAllowed": "【分配策略】为【领用】时，不允许设置自动审批，请了解！",
                "approvalNotAllowedAsSet": "所有已办理人员已设置不允许审批，所以上个节点已办理人员默认不允许自动审批！",
                "allocationStrategyIsCollect": "【分配策略】为【领用】时，不允许设置自动审批，请了解！",
                "set": "（已设置）",
                "advancedOptions": "参与者高级选项",
                "historicFirst": "再次进入节点时，办理人是节点的已办人员",
                "noPerformerStrategy": "办理人为空策略：",
                "excludeProcInstCreator": "排除办理人选项",
                "defaultNotParticipate": "流程发起人默认不参与审批",
                "excludePreActExecutors": "上个节点已办理人员默认不参与审批",
                "excludeAllPassExecutors": "所有已办理人员默认不参与审批",
                "excludeExprPerformer": "流程变量：",
                "variableOrgTypes": "变量值类型：",
                "automaticApprovalOptions": "自动审批选项",
                "autoProcInstCreator": "流程发起人默认自动审批通过",
                "autoPreActExecutors": "上一节点办理人员默认自动审批通过",
                "autoAllPassExecutors": "所有已办理人员默认自动审批通过",
                "cancel": "取消",
                "clickOK": "确定"
            },
            "positionPerformer": {
                "orgPosition": "组织岗",
                "generalPosition": "通用岗",
                "sysPositions": "系统岗位",
                "positionType": "岗位类型",
                "role": "角色",
                "position": "岗位",
                "sysType": "组织类型",
                "placeholder": "请选择",
                "orgId": "组织ID",
                "condition": "启用条件",
                "clickCancel": "取消",
                "clickOK": "确定"
            },
            "reportingLine": {
                "higherSuperior": "间接上级",
                "directSuperior": "直接上级",
                "code": "编号",
                "name": "名称",
                "dept": "组织",
                "sysUser": "系统用户",
                "employee": "员工",
                "businessFields": "业务字段",
                "defName": "汇报定义",
                "dimension": "汇报级别",
                "curReportingRefer": "参照类型",
                "usersName": "参照人",
                "refOrgId": "参照组织",
                "condition": "启用条件",
                "definitionOfReport": "汇报关系定义"
            },
            "userPerformer": {
                "regularUser": "固定用户",
                "variablePart": "变量参与者",
                "sys": "系统用户",
                "administrative_organization": "员工",
                "cantUseContext": "行政人员类型不能使用此上下文变量",
                "user": "用户",
                "variable": "变量",
                "condition": "启用条件"
            },
            "variablePerformer": {
                "sys": "用户ID",
                "administrative_staff": "员工ID",
                "oneself": "本人",
                "administrative_organization": "部门ID",
                "cantUseContext": "行政人员类型不能使用此上下文变量",
                "processVariables": "流程变量",
                "variableOrgTypes": "变量值类型",
                "relationShipType": "关系",
                "condition": "启用条件",
            },
            "orgPotentialOwner": {
                "optionSettings": "选项设置",
                "global": "全员",
                "currentUnit": "本单位",
                "currentDepartment": "本部门",
                "addSignBehind": "加签",
                "addSignFront": "征询",
                "transfer": "移交",
                "notify": "知会",
                "set": "（已设置）",
                "notSet": "（未设置）",
                "option": "选项",
                "enable": "是否启用",
                "range": "范围",
                "orgId": "组织ID",
                "variableOrganization": "变量组织",
                "includeChildren": "包含下级",
                "clickCancel": "取消",
                "clickOK": "确定",
                "limit": "限定人员范围",
                "turnOffPrompt": "请关闭限定人员范围选项"
            },
            "note": {
                "placeholder": "请输入流程变更记录",
                "clickCancel": "取消",
                "clickOK": "确定"
            },
            "MessageNotice": {
                "notify": "消息通知",
                "subject": "消息主题",
                "content": "消息内容",
                "sendTime": "发送时机",
                "sendType": "发送方式",
                "receiverText": "消息接收人",
                "procInstCreator": "流程发起人，",
                "workItemParticipant": "任务接收人，",
                "messageSet": "消息设置",
                "selectedRow": "尚未选中消息通知！",
                "noCopy": "没有待复制的消息通知属性！",
                "batchCopy": "批量复制",
                "set": "（已设置）",
                "notSet": "（未设置）",
                "add": "新增",
                "edit": "编辑",
                "delete": "删除",
                "lineNumber": "序号",
                "clickCancel": "取消",
                "clickOK": "确定",
                "messContent": "{\"expr\":\"'\u60A8\u6709\u4E00\u6761\u6D88\u606F\u901A\u77E5\u3002'\",\"sexpr\":\"\"}",
                "procComplete": "流程完成",
                "procAborted": "流程终止",
                "procRollBack": "流程驳回",
                "workCreated": "任务创建",
                "actComplete": "活动完成",
                "actAborted": "活动终止",
                "email": "邮件",
                "sms": "短信",
                "cloudplus": "云",
                "processParticipant": "流程参与人",
                "variableParticipant": "变量参与者",
                "userParticipant": "指定用户",
                "positionParticipant": "岗位",
                "activityExecutorParticipant": "历史办理人",
                "sys": "系统用户",
                "administrative_organization": "员工",
                "name": "名称",
                "noTargetNode": "尚未选中节点！",
                "noMessageNotifyAttribute!": "没有消息通知属性！"
            },
            "messageNoticeEdit": {
                "procInstCreator": "流程发起人",
                "activityExecutorParticipant": "历史办理人",
                "workItemParticipant": "任务办理人",
                "sys": "系统用户",
                "administrative_organization": "员工",
                "processParticipant": "流程参与人",
                "workItemReceiveParticipant": "任务接收人",
                "variableParticipant": "变量参与者",
                "userParticipant": "指定用户",
                "positionParticipant": "岗位",
                "sendType": "发送方式不允许为空",
                "smsMessageTemplate": "消息渠道启用短信时需设置消息模板",
                "smsMessageTemplateCode": "短信模板编号不允许为空",
                "sendTime": "发送时机不允许为空",
                "subject": "消息主题不允许为空",
                "content": "消息内容不允许为空",
                "receivers": "接收人不允许为空！",
                "processParticipantNotNull": "流程参与人不允许为空",
                "activityDefIdNotNull": "流程参与人为历史办理人时，办理节点不允许为空",
                "variableParticipantNotNull": "变量参与者不允许为空",
                "orgType": "变量参与者组织类型不允许为空",
                "userIds": "指定用户不允许为空",
                "positionId": "岗位不允许为空",
                "activityList": "活动列表",
                "position": "岗位",
                "optionalNodes": "可选节点",
                "targetNodeList": "目标节点列表",
                "placeholder": "请选择目标节点",
                "optionalAttribute": "可选属性",
                "lineNumber": "序号",
                "clickCancel": "取消",
                "clickOK": "确定",
                "messSendType": "消息渠道",
                "messSubject": "消息主题",
                "enable": "启用表达式",
                "messContent": "消息内容",
                "recipient": "接收人",
                "addReceiver": "添加",
                "organization": "组织：",
                "posi": "岗位："
            },
            "jumpScope": {
                "targetNodeOptions": "目标节点选项",
                "name": "名称",
                "outConnectNode": "流程图连线节点",
                "global": "流程内所有节点",
                "afterNodes": "所有后继节点",
                "specifiedSet": "流程图连线节点+附加节点",
                "firstNode": "条件为true的连线节点，当有多条时默认选中首条",
                "nullNode": "默认为空，每次都手动选择",
                "specifyNode": "指定默认节点",
                "noSetTargetNode": "尚未设置目标节点选项，请了解！",
                "noSetSpecifyNode": "尚未指定默认节点，请了解！",
                "selectedRow": "请首先选中一条选项！",
                "optionalNodes": "可选节点",
                "listOfAdditional": "附加节点列表",
                "pleaseSelect1": "请选择附加节点",
                "defaultNode": "默认节点",
                "pleaseSelect2": "请选择默认节点",
                "defaultNodeList": "默认节点列表",
                "clickCancel": "取消",
                "clickOK": "确定",
                "set": "（已设置）"
            },
            "imageSet": {
                "imageSet": "影像设置",
                "onlyView": "仅可查看",
                "edit": "编辑",
                "reScanStart": "发起重扫",
                "reScanComplete": "重扫完成",
                "mutualExclusion": "【仅可查看】选项与其他选项互斥，请了解！",
                "set": "（已设置）",
                "notSet": "（未设置）",
                "imageOperation": "影像操作权限",
                "clickCancel": "取消",
                "clickOK": "确定"
            },
            "extendProperty": {
                "extendProperty": "扩展属性",
                "true": "是",
                "false": "否",
                "set": "（已设置）",
                "notSet": "（未设置）",
                "illustrate": "说明",
                "placeholder": "请选择",
                "cancel": "取消",
                "clickOK": "确定"
            },
            "expressionEditor": {
                "expressionEditor": "条件编辑",
                "notSet": "（未设置）",
                "clickCancel": "取消",
                "changeType": "切换类型",
                "clickOK": "确定"
            },
            "executeForms": {
                "executeForms": "表单定义",
                "parameters": "参数【",
                "typeAsvariable": "】类型为变量，但在流程变量里不存在",
                "parameterSettings": "参数设置",
                "formDefinitionList": "表单定义列表",
                "notSet": "（未设置）",
                "default": "流程默认表单",
                "processEmbeddedForm": "流程嵌表单",
                "formEmbedProcess": "表单嵌流程",
                "clickCancel": "取消",
                "clickOK": "确定",
                "noForm": "暂无表单格式",
                "form": "选择表单",
                "placeholder": "请选择",
                "parametersSet": "参数",
                "key": "变量编号",
                "name": "变量名称",
                "lineNumber": "序号",
                "code": "编号",
                "tag": "类型",
                "value": "参数值",
                "variable": "变量",
                "constant": "常量",
                "expression": "表达式",
                "method": "方法标识",
                "methodName": "方法名称",
                "description": "描述",
                "workFlowAction": "流转方向",
                "formOperations": "表单操作",
                "executionTime": "执行时机",
                "sortOrder": "执行顺序",
                "methodParameters": "参数",
                "selectFormActionConfig": "尚未选中表单操作配置！",
                "selectFormAction": "尚未选中表单操作！",
                "editParam": "设置",
                "formEvents": "表单事件",
                "buttonName": "按钮名称",
                "enable": "是否可用",
                "disabled": "是否禁用",
                "hidden": "是否隐藏",
                "fieldName": "字段名称",
                "editable": "是否可写",
                "readonly": "是否只读",
                "required": "是否必填",
                "saveFail": "保存配置失败，请联系管理员查看原因！",
                "checkedRows": "尚未选择按钮集合",
                "checkeds": "尚未选择字段集合",
                "enableBtn": "可用",
                "disabledBtn": "禁用",
                "hiddenBtn": "隐藏",
                "btnBatchReset": "重置",
                "editableBtn": "可写",
                "readonlyBtn": "只读",
                "requiredBtn": "必填",
                "add": "新增",
                "delete": "删除",
                "other": "其他",
                "formBtn": "表单按钮",
                "formfield": "表单字段",
                "apptag": "单据类型",
                "functionMenu": "功能菜单",
                "formFormat": "表单格式",
                "docFormatNumber": "单据格式编号",
                "docFormatName": "单据格式名称",
                "selectedRow": "尚未选择表单定义！",
                "set": "（已设置）"
            },
            "eventDefinition": {
                "eventDefinition": "信号定义",
                "pass": "正向",
                "back": "反向",
                "abort": "终止",
                "signalRef": "信号编号",
                "name": "信号名称",
                "triggerAction": "流转方向",
                "selectedRow": "尚未选中一条触发事件！",
                "dataLength": "至少需要一个信号定义，请了解！",
                "codeNotNull": "信号编号不允许为空！",
                "nameNotNull": "信号名称不允许为空！",
                "codeNotNumber": "信号编号不允许为纯数字！",
                "codeRepeat": "信号编号不允许重复！",
                "set": "（已设置）",
                "notSet": "（未设置）",
                "add": "新增",
                "delete": "删除",
                "clickCancel": "取消",
                "clickOK": "确定"
            },
            "entryFormEditor": {
                "flowForm": "流程分类",
                "code": "编号",
                "name": "名称",
                "base": "类型",
                "foundation": "基础",
                "extend": "扩展",
                "selectedRow": "尚未选择流程分类",
                "absent": "流程分类已经不存在",
                "lineNumber": "序号",
                "clickCancel": "取消",
                "clickOK": "重新绑定"
            },
            "editComponentParameter": {
                "code": "编号",
                "name": "名称",
                "required": "必填",
                "yes": "是",
                "no": "否",
                "value": "参数值",
                "openComponentFail": "获取解析构件出错",
                "componentSelection": "构件选择",
                "curComponent": "请选择流程构件",
                "executionTime": "请选择执行时机",
                "para": "参数",
                "paraRequired": "】必填",
                "execuTime": "执行时机",
                "parameterList": "参数列表",
                "clickCancel": "取消",
                "clickOK": "确定"
            },
            "customizeAction": {
                "customizeAction": "自定义动作",
                "app": "移动",
                "web": "web",
                "all": "web,移动",
                "name": "名称",
                "code": "编号",
                "terminalType": "适用终端",
                "isAll": "是否默认",
                "yes": "是",
                "no": "否",
                "paramName": "编号",
                "valueText": "名称",
                "value": "参数值",
                "addActions": "自定义动作选择",
                "actionExisted": "新增的自定义动作已经存在！",
                "selectedRow": "请首先选中一条选项！",
                "set": "（已设置）",
                "notSet": "（未设置）",
                "add": "新增",
                "delete": "删除",
                "parameterList": "参数列表",
                "clickCancel": "取消",
                "clickOK": "确定"
            },
            "checkCondition": {
                "zhChs": "简体中文",
                "zhCht": "繁体中文",
                "en": "英文",
                "checkCondition": "活动校验规则",
                "set": "（已设置）",
                "notSet": "（未设置）",
                "nodeEntry": "节点进入",
                "activityBeforeStarted": "节点进入条件",
                "enterErrorTips": "进入条件不匹配提示语",
                "activityBeforeCompleted": "节点离开",
                "activityBeforeCompletedValue": "节点离开条件",
                "leaveErrorTips": "离开条件不匹配提示语",
                "clickCancel": "取消",
                "clickOK": "确定"
            },
            "batchSet": {
                "targetNode": "目标节点",
                "addSignFront": "征询",
                "addSignBehind": "加签",
                "transfer": "移交",
                "notify": "知会",
                "backWardRule": "驳回规则",
                "name": "名称"
            },
            "subProcess": {
                "subProcessSet": "子流程设置",
                "specified": "指定子流程",
                "dynamic": "动态子流程",
                "inheritParent": "与父流程相同",
                "autoCreation": "自动生成下游单据",
                "variablesExpression": "变量表达式",
                "rteNull": "请选中一条生单流程",
                "orderProcess": "生单流程",
                "clickOk": "确定",
                "clickCancel": "取消",
                "inheritBizDataId": "当子流程与父流程单据不一致时，请设置子流程单据内码！",
                "set": "（已设置）",
                "notSet": "（未设置）",
                "radioGroupProcessType": "子流程类型",
                "flowForm": "流程分类",
                "processDef": "流程定义",
                "radioGroupBillSource": "单据来源",
                "autoCreationProcess": "生单流程",
                "bizDataId": "单据内码",
                "setOption": "设置选项",
                "SameParentProcess": "与父流程同一张业务单据",
                "setBizDataId": "设置单据内码",
                "subProcessOpt": "子流程选项"
            },
            "backwardRule": {
                "reEdit": "驳回活动节点已不存在，请重新编辑",
                "backwardRule": "驳回规则",
                "initialActityId": "开始节点",
                "precursorActivityId": "前置节点",
                "empty": "空",
                "name": "名称",
                "id": "标识",
                "sequence": "顺序流转",
                "backToMe": "返回我",
                "backToCurrentNode": "返回本节点",
                "popover": "1.顺序流转:按照流转线顺序进行流转; 2.返回我:完成策略为抢占：只给驳回人创建任务,完成策略为会签：驳回人与未审批人收到新任务，已审批人员自动审批通过; 3.返回本节点:实际效果受“再次进入节点时，办理人是否是节点已办人员影响”选项的影响",
                "selectAbleClick": "会签策略下，不允许动态选择驳回目标节点!",
                "dictPicked": "“驳回至空”选项请搭配“允许动态选择驳回目标节点”使用",
                "set": "（已设置）",
                "notSet": "（未设置）",
                "rejectedTo:": "驳回至：",
                "backScope": "驳回范围",
                "defaultPrompt": "默认选取全部历史驳回节点",
                "title": "活动列表",
                "dynamicSelection": "允许动态选择驳回目标节点",
                "resubmitEffectOptions": "返回设置",
                "popover1": "1.顺序流转:按照流转线顺序进行流转; ",
                "popover2": "2.返回我:完成策略为抢占：只给驳回人创建任务,完成策略为会签：驳回人与未审批人收到新任务，已审批人员自动审批通过;",
                "popover3": "3.返回本节点:实际效果受“再次进入节点时，办理人是否是节点已办人员影响”选项的影响",
                "allowModification": "允许修改返回设置",
                "clickCancel": "取消",
                "clickOk": "确定"
            },
            "assignStrategy": {
                "all": "所有",
                "assign": "指派",
                "claim": "领用",
                "currentUser": "当前办理人",
                "procInstCreator": "流程发起人",
                "assignStrategy": "分配策略",
                "option": "选项",
                "assignmentRules": "指派规则",
                "operator": "指派操作人",
                "multiSelect": "允许选择多个待选用户",
                "necessary": "只有一个待选用户时，仍需手工选择",
                "clickCancel": "取消",
                "clickOK": "确定"
            },
            "assignScope": {
                "assignScopeList": "指派节点列表",
                "required": "必填",
                "yes": "是",
                "no": "否",
                "condition": "条件",
                "add": "增加",
                "delete": "删除",
                "name": "名称",
                "deleteRow": "请首先选中一条选项！",
                "curActivity": "尚未选中行",
                "set": "（已设置）",
                "notSet": "（未设置）",
                "nodeList": "节点列表",
                "moveUp": "上移",
                "moveDown": "下移",
                "clickCancel": "取消",
                "clickOK": "确定"
            },
            "assignPerformer": {
                "currentUser": "当前办理人",
                "procInstCreator": "流程发起人",
                "global": "全员",
                "currentUnit": "本单位",
                "currentDepartment": "本部门",
                "assignPerformer": "指派规则",
                "set": "（已设置）",
                "operator": "指派操作人",
                "multiSelect": "允许选择多个待选用户",
                "necessary": "只有一个待选用户时，仍需手工选择",
                "clickCancel": "取消",
                "clickOK": "确定"
            },
            "approvelItems": {
                "approvalOptions": "审批选项",
                "forward": "正向",
                "backward": "反向",
                "abort": "终止",
                "value": "编号",
                "text": "名称",
                "workFlowAction": "流转方向",
                "isDefault": "默认",
                "no": "否",
                "yes": "是",
                "commentNecessary": "意见必填",
                "attachmentNecessary": "附件上传",
                "certification": "数字签名",
                "signatureNecessary": "手写签名必填",
                "defaultComment": "默认意见",
                "zh-CHS": "中文简体",
                "zh-CHT": "中文繁体",
                "en": "英文",
                "workFlowActionNotNull": "审批项流转方向不允许为空，请修改！",
                "deleteRow": "请首先选中一条选项！",
                "set": "（已设置）",
                "notSet": "（未设置）",
                "add": "新增",
                "delete": "删除",
                "clickCancel": "取消",
                "clickOK": "确定",
                "approvalAction": "审批动作",
                "lineNumber": "序号"
            },
            "approvalPivot": {
                "remind": "文字提示",
                "type": "类型",
                "condition": "条件",
                "title": "显示名称",
                "description": "详细说明",
                "approvalPivot": "审批要点",
                "selectedRow": "尚未选中审批要点！",
                "configTitle": "尚未填写显示标题！",
                "set": "（已设置）",
                "notSet": "（未设置）",
                "enable": "是否启用",
                "expand": "是否展开",
                "showTitle": "显示标题",
                "list": "列表",
                "add": "新增",
                "delete": "删除",
                "clickCancel": "取消",
                "clickOK": "确定"
            },
            "anonymousSet": {
                "anonymousOpt": "匿名选项",
                "approver": "审批人",
                "set": "（已设置）",
                "notSet": "（未设置）",
                "anonymousSet": "匿名设置",
                "isAnonymity": "是否启用",
                "anonymous": "匿名代称",
                "clickCancel": "取消",
                "clickOK": "确定"
            },
            "activityList": {
                "name": "名称",
                "checkeds": "尚未选择活动节点",
                "lineNumber": "序号",
                "clickCancel": "取消",
                "clickOK": "确定"
            },
            "activityComponent": {
                "component": "构件",
                "method": "构件方法",
                "inconsistentParameters": "参数不一致，请检查",
                "longerExists": "构件已不存在此构件方法",
                "absent": "取消",
                "pleaseCheck": "，请检查",
                "edit": "编辑",
                "deleteRow": "删除",
                "executionTime": "执行时机",
                "cmpName": "构件名称",
                "metadataId": "构件ID",
                "methodCode": "构件方法",
                "isForCompensation": "补偿操作",
                "yes": "是",
                "no": "否",
                "operate": "操作",
                "code": "编号",
                "name": "名称",
                "value": "参数值",
                "editComponent": "编辑构件",
                "confirmDelete": "确认是否删除构件？",
                "curComponent": "尚未选中构件！",
                "newComponent": "新建构件",
                "sameCmp": "存在相同的流程构件",
                "cmpMethod": "构件方法：",
                "executionTimeNotNull": "构件执行时机不允许为空！",
                "param": "的参数",
                "required": "必填",
                "set": "（已设置）",
                "notSet": "（未设置）",
                "PROCESSINSTANCE_STARTED": "流程启动",
                "PROCESSINSTANCE_SUSPENDED": "流程挂起",
                "PROCESSINSTANCE_RESUMED": "流程恢复",
                "PROCESSINSTANCE_COMPLETED": "流程完成",
                "PROCESSINSTANCE_ABORTED": "流程终止",
                "PROCESSINSTANCE_CANCELED": "流程取消",
                "PROCESSINSTANCE_REACTIVATED": "流程复活",
                "PROCESSINSTANCE_ROLLBACK": "流程驳回",
                "PROCESSINSTANCE_RESUBMIT": "重新提交",
                "ACTIVITY_AND_PARTICIPANT_UPDATED": "环节办理人变更",
                "PROCESSINSTANCE_ABORTED_BY_ADMIN": "管理员终止",
                "PROCESSINSTANCE_BEFORE_START": "流程启动前",
                "WORKITEM_BEFORE_COMPLETE": "任务完成前",
                "WORKITEM_AFTER_COMPLETE": "任务完成后",
                "LOADDATA": "获取数据",
                "ACTIVITY_STARTED": "活动启动",
                "ACTIVITY_COMPLETED": "活动完成",
                "ACTIVITY_ABORTED": "活动终止",
                "WORKITEM_CREATED": "工作项创建",
                "WORKITEM_COMPLETED": "工作项完成",
                "WORKITEM_SUSPENDED": "工作项挂起",
                "WORKITEM_RESUMED": "工作项恢复",
                "WORKITEM_ABORTED": "工作项终止",
                "WORKITEM_RETRIEVED": "工作项取回",
                "WORKITEM_CLAIMED": "工作项领用",
                "WORKITEM_UNCLAIMED": "工作项反领用",
                "ACTIVITY_ASSIGNMENT": "任务分配前",
                "deleteNotAllowed": "取数构件不允许删除，请了解！",
                "tips": "提示：",
                "prefabricated": "已经预制外部流程构件，此处只保留取数构件",
                "add": "新增",
                "moveUp": "上移",
                "moveDown": "下移",
                "clickCancel": "取消",
                "clickOK": "确定"
            }
        }
    },
    "en": {
        "validate": {
            "noProcessHeader": "processHeader attribute does not exist in the model",
            "cmpsEmpty": "Process component is empty",
            "cmpsEmptyMsg": "The process component cannot be empty, please contact the form development to confirm the problem",
            "directNoPf": "A process whose startup mode is [direct] should not contain shared (PF) process components",
            "directNoPfMsg": "Please remove the following process components of sharing (PF):",
            "noLoadDataCmp": "There is no process component whose execution opportunity is [get data]",
            "noLoadDataCmpMsg": "The process definition cannot be short of fetching components, please contact the form development to confirm the problem",
            "noStartCmp": "The process component whose execution opportunity is [Process Start] is missing",
            "noStartCmpMsg": "The document status cannot be modified when the process is started, please contact the form development to confirm the problem",
            "lackProcessCompleteCmp": "There is no process component whose execution opportunity is [Process Completion]",
            "lackProcessCompleteCmpMsg": "The document status cannot be modified when the process is completed, please contact the form development to confirm the problem",
            "lackProcessAbortCmp": "Lack of process component with execution timing of [process termination]",
            "lackProcessAbortCmpMsg": "The document status cannot be modified when the process is terminated, please contact the form development to confirm the problem",
            "lackProcessCancelCmp": "The process component with execution opportunity of [Process Termination] is missing",
            "lackProcessCancelCmpMsg": "The document status cannot be modified when the process is terminated, please contact the form development to confirm the problem",
            "lackProcessBackCmp": "Lack of process component with execution opportunity of [Process Rejection]",
            "lackProcessBackCmpMsg": "The document status cannot be modified when the process is rejected, please contact the form development to confirm the problem",
            "lackProcessReStartCmp": "Lack of process component with execution opportunity of [resubmit]",
            "lackProcessReStartCmpMsg": "It will lead to the failure to modify the document status when the process is resubmitted, please contact the form development to confirm the problem",
            "parallelGatewayCheck": "[Parallel Gateway] does not appear in pairs",
            "parallelGatewayCheckMsg": "Parallel Gateway needs to appear as a split node and a sink node of a process branch in pairs, please modify it",
            "approvalPerformerCheck": "activity, no participant set",
            "noVariable1": "A variable has been set in the variable setting attribute of the activity",
            "noVariable2": "It no longer exists in the process attribute Process Variable. Please modify it!",
            "activity": "activity [",
            "noStartActivity": "] is illegal and does not start with [startActivity]",
            "noExclusiveGateway": "] is illegal and does not start with [ExclusiveGateway]",
            "noParallelGateway": "] is illegal and does not start with [ParallelGateway]",
            "noUserActivity": "] is illegal and does not start with [UserActivity]",
            "noOperationActivity": "] is illegal and does not start with [OperationActivity]",
            "noNotifyActivity": "] is illegal and does not start with [NotifyActivity]",
            "noCallActivitySubProcess": "] is illegal and does not start with [CallActivitySubProcess]",
            "noAutoActivity": "] is illegal and does not start with [AutoActivity]",
            "noIntermediateCatchEvent": "] is illegal and does not start with [MediaTechEventTimpl]",
            "noMessageActivity": "] is illegal and does not start with [MessageActivity]",
            "noAifCreationBillActivity": "] is illegal and does not start with [AifCreationBillActivity]",
            "noEndEvent": "] is illegal and does not start with [EndEvent]",
            "mark": "The logo is [",
            "noFlowNodeChsName": "] is empty, please modify it",
            "nameExceedsLengthLimit": "] is too long and cannot exceed 40 characters. Please modify it."
        },
        "processEditor": {
            "tip": "Tip",
            "showButton": "Show Model View Button",
            "changeRecord": "Process Change Record",
            "noDtInfo": "No design time process information exists! Please assign it first!",
            "noRtInfo": "No runtime process information exists! Please assign it first!",
            "wrongMoment": "Wrong moment for the editor!",
            "prompted": "System Prompt",
            "saveSuccess": "Save successful",
            "waitReview": "Save successful, awaiting review initiation",
            "successPublish": "Publish successful",
            "publishFail": "Publish failed,",
            "policyConflict": "In countersign strategy, 'Rejection Rule' does not allow 'Dynamically Select Rejection Levels', please modify!",
            "noPermissionToSave": "The current user does not have permission to save the process",
            "closeProc1": "Close this page?",
            "closeProc2": "The system may not save the changes you made.",
            "viewModel": "View Model",
            "copied": "The model has been copied to the clipboard",
            "button": {
                "saveProc": "Save",
                "releaseProc": "Publish",
                "sync": "Synchronize Design Time Package",
                "saveAs": "Save As",
                "procRecord": "Process Record",
                "viewProcModel": "View Model",
                "closeProc": "Close"
            }
        },
        "designer": {
            "wfEditorUi": {
                "basicElements": "Basic Elements",
                "readOnly": "Read-only"
            },
            "wfProcessCell": {
                "basicInfo": "Basic Information",
                "name": "Name",
                "nameLanguage": "Name",
                "key": "Identifier",
                "entryForm": "Process Category",
                "startMode": "Start Mode",
                "wfTitle": "Process Summary",
                "formDef": "Form Definition",
                "formsPC": "PC Form",
                "formsMobile": "Mobile Form",
                "process": "Event Listener",
                "advanced": "Advanced Properties",
                "basic": "Basic Properties",
                "wfComponent": "Process Component",
                "otherConfig": "Other Configuration",
                "processVariables": "Process Variables",
                "basicElements": "Basic Elements",
                "customizeAction": "Custom Actions",
                "timelinessInfo": "Timeliness Information",
                "enablePriority": "Enable Priority",
                "enableWholeOrderRetrieve": "Withdraw Documents Under Review",
                "messageProperty": "Image Setting",
                "timeLimitControl": "Timeout Operation",
                "messageNotice": "Message Notification",
                "extendProperty": "Extended Properties",
                "directTips": "Tip: Switching start mode to 'Direct' will remove shared (PF) related components as it is the default start mode. Please be aware of this!",
                "externalTips": "Tip: Switching start mode to 'External Process' is suitable for scenarios where the process serves as an external process for sharing. After switching, shared (PF) related components on the process will be retained. Please be aware of this!",
                "subprocessTips": "Tip: Switching start mode to 'Subprocess' is suitable for invoking sub-processes. After switching, all process components except those for data extraction will be removed. Please be aware of this!"
            },
            "WfSequenceFlowEdge": {
                "basicInfo": "Basic Information",
                "basic": "Basic Properties",
                "name": "Name",
                "nameLanguage": "Name",
                "id": "Identifier",
                "condition": "Condition Options",
                "ConditionExpression": "Condition Expression",
                "default": "Default Transition"
            },
            "wfSidebar": {
                "bizactivitylib": "Business Activity Library"
            }
        },
        "app": {
            "processDesigner": {
                "all": "All",
                "assign": "Assign",
                "claim": "Claim",
                "preempt": "Preempt Mode",
                "parallel": "Parallel Countersignature",
                "sequential": "Sequential Countersignature",
                "true": "Yes",
                "false": "No",
                "dataId": "Document ID",
                "procInstId": "Process Instance ID",
                "bizDefKey": "Entrance Document ID",
                "processDefinitionKey": "Process Definition Key",
                "procInstCreator": "Process Initiator",
                "businessCreator": "Business Initiator",
                "procInstDescription": "Process Summary",
                "comment": "Approval Comment",
                "bizDefName": "Process Category Name",
                "curLoginUsername": "Current Login User Name",
                "procInstCreatorName": "Process Initiator Name",
                "currentParticipantId": "Current Participant ID",
                "currentParticipantName": "Current Participant Name",
                "currentUser": "Current Login User",
                "preActExecutors": "Executors of the Previous Activity",
                "collectionElementVariable": "MultiInstance Child activity element variables",
                "subCollectionElementVariable": "MultiInstance Sub-process element variables",
                "nrOfInstances": "Total number of multiple instances",
                "nrOfCompletedInstances": "Number of multi-instance completed",
                "nrOfActiveInstances": "The number of multiple instances running",
                "nrOfForward": "Number of Passed Instances",
                "nrOfBackward": "Number of rejected instances",
                "nrOfAbort": "Number of terminated instances",
                "conclusionType": "Conclusion Type",
                "conclusionValue": "Conclusion Value",
                "directSuperior": "Direct Superior",
                "higherSuperior": "Indirect Superior",
                "DIRECT": "Direct",
                "EXTERNAL_PROCESS": "External Process",
                "SUB_PROCESS": "Subprocess",
                "ALL": "PC and Mobile",
                "WEB": "PC",
                "APP": "Mobile",
                "conclusionTypeTips": "The direction of item circulation, 1 for forward, 2 for backward, 3 for termination",
                "conclusionValueTips": "Item number, for example, 'Pass', 'Back', 'Refuse'",
                "copy": "_Copy",
                "saveAs": "Save As",
                "tips": "System Tips",
                "saveAsSuccess": "Save As Successful",
                "saveAsFail": "Save As Failed, please check if the process is correct!",
                "syncDt": "Whether to synchronize the current version of the process definition to the design-time process definition package",
                "syncSuccess": "Synchronization Successful",
                "beforeCompleteStrategyChange": "There are running activity instances in the current node, adjusting the completion strategy is not allowed, please be aware!",
                "releaseProcess": "Review before Release",
                "auto": "Auto-generated Form",
                "push": "Push-generated Form",
                "pull": "Pull-generated Form",
                "creation": "Generate the target form through the form generation process"
            }
        },
        "multiInstanceLoopCharacteristics": {
            "loopCharacteristics": "Multi-instance Setup",
            "set": "(Set)",
            "notSet": "(Not Set)",
            "isEnable": "Enable",
            "isSequential": "Sequential",
            "loopCardinality": "Elements Collections",
            "completionConditionRules": "Completion COnditions",
            "promptAct1": "1. The number of elements in [Collection] is the number of instances of the sub-activity start.",
            "promptAct2": "2. When the sub-activity starts, the system will split and map the elements in the [Collection] to the [Element Variables] of each sub-activity instance.",
            "promptProc1": "1. The number of elements in [Collection] is the number of instances of the sub-process start.",
            "promptProc2": "2. When the sub-process starts, the system will split and map the elements in the [Collection] to the [Element Variables] of each sub-process instance.",
            "checkPrompt": "There are running activity instances in the current node, adjusting is not allowed",
            "conditionRulesSet": "(Set)",
            "completionConditionRulesList": {
                "forward": "Forward",
                "backward": "BackWard",
                "abort": "Abort"
            }
        },
        "component": {
            "optins": {
                "wfOptions": "Workflow Options",
                "specified": "Specified Subprocess",
                "dynamic": "Dynamic Subprocess",
                "set": "(Set)",
                "notSet": "(Not Set)",
                "subProcessType": "Subprocess Type",
                "processType": "Process Type",
                "bizDef": "Process Category",
                "procDef": "Process Definition",
                "clickCancel": "Cancel",
                "clickOk": "OK"
            },
            "voConfig": {
                "documentInfo": "Document Information",
                "viewModelSelection": "View Model Selection",
                "cancel": "Cancel",
                "clickOk": "OK",
                "selectOne": "Select One",
                "documentTypeSelect": "Document Type Selection",
                "set": "(Set)",
                "notSet": "(Not Set)",
                "viewModel": "View Model",
                "documenttype": "Document Type",
                "placeholder": "Please Select"
            },
            "variableSetting": {
                "constant": "Constant",
                "expression": "Expression",
                "component": "Component",
                "ACTIVITY_STARTED": "Activity Started",
                "ACTIVITY_COMPLETED": "Activity Completed",
                "varAssign": "Variable Assignment",
                "varNumber": "Variable Number",
                "REQUIRED": "Required",
                "varName": "Variable Name",
                "valueType": "Value Type",
                "executionTime": "Execution Time",
                "valueText": "Variable Value",
                "processVariables": "Process Variables",
                "notSelectedVar": "Variable Not Selected!",
                "valueCannotEmpty": "Variable Value Cannot be Empty!",
                "set": "(Set)",
                "notSet": "(Not Set)",
                "add": "Add",
                "delete": "Delete",
                "serialNumber": "Serial Number",
                "clickCancel": "Cancel",
                "clickOK": "OK",
                "inconsistentParameters": "Inconsistent Method Parameters for the Current Component, Please Update!",
                "methodNotExist": "The Current Component No Longer Exists This Method, Please Update!",
                "parameterName": "Parameter Name",
                "parameterValue": "Parameter Value",
                "methodnotSelected": "Component Method Not Selected Yet",
                "metadataNotExist": "Help Metadata Does Not Exist, Please Contact the System Administrator for Details!",
                "errorObtainComponent": "Error Obtaining Parsed Component",
                "componentSelection": "Component Selection",
                "componentName": "Component Name",
                "parameterList": "Parameter List",
                "lineNumber": "No."
            },
            "urgeHandleRule": {
                "urgentApproval": "Urge Approval:",
                "pleaseApprove": "Please Approve",
                "soOn": " ",
                "urgeHandle": "Urge Handle",
                "noSendingMethod": "No Sending Method Selected Yet!",
                "setMessageTemplate": "Message Template Needs to be Set When Using SMS as the Message Channel",
                "codeEmpty": "SMS Template Number Cannot be Empty",
                "noMessageSubject": "No Message Subject Configured Yet!",
                "noMessageContent": "No Message Content Selected Yet!",
                "earliestTimeNotEmpty": "Earliest Urge Time Cannot be Empty",
                "minimumTimeNotEmpty": "Minimum Urge Interval Cannot be Empty",
                "set": "(Set)",
                "notSet": "(Not Set)",
                "enableUrgeHandle": "Enable Urgent Handling",
                "timeSetting": "Time Setting",
                "earliestTime": "Earliest Urge Time (Hours)",
                "minimumInterval": "Minimum Urge Interval (Hours)",
                "sendingMethod": "Sending Method",
                "messageSubject": "Message Subject",
                "supportEditing": "Support Editing",
                "messageContent": "Message Content",
                "displayReminder": "Display Urgent Reminder",
                "clickCancel": "Cancel",
                "clickOK": "OK"
            },
            "titleExpression": {
                "zh-CHS": "Simplified Chinese",
                "zh-CHT": "Traditional Chinese",
                "en": "English",
                "taskDescription": "Task Description",
                "set": "(Set)",
                "notSet": "(Not Set)",
                "currentLanguage": "Current Summary Language:",
                "clickCancel": "Cancel",
                "clickOK": "OK"
            },
            "timeLimitControl": {
                "timedOutOperation": "Timed Out Operation",
                "constant": "Constant",
                "scope": "Time Scope",
                "day": "Day(s)",
                "hour": "Hour(s)",
                "minute": "Minute(s)",
                "BeforeDuration": "Before Due",
                "OnDuration": "On Due",
                "AfterDuration": "After Due",
                "SendMessageExpireOperation": "Expiring Alert",
                "AutoHandleExpireOperation": "Automatic Processing",
                "curDay": "Current Day",
                "durationType": "Duration Type",
                "required": "Required",
                "timeDuration": "Duration",
                "timeUnit": "Unit",
                "operationTypeName": "Operation Type Name",
                "sendType": "Operation",
                "onlyBeInteger": "Task Duration Can Only Be an Integer!",
                "setOperation": "Please Set Timeout Operation!",
                "setType": "Please Set Automatic Processing Type!",
                "setComments": "Please Set Automatic Processing Opinion!",
                "selectedOperation": "No Expiring Operation Selected Yet!",
                "notSupportAutomatic": "If the Next Node is Assigned by the Current Operator, the Current Node Does Not Support Automatic Task Processing",
                "warningMessage": "Warning Message",
                "automaticProcessing": "Automatic Processing",
                "set": "(Set)",
                "notSet": "(Not Set)",
                "timelinessControl": "Task Processing Timeliness Control",
                "isEnable": "Enable or Not",
                "taskDeadline": "Task Deadline",
                "timelyOperation": "Timely Alert Operation",
                "actionList": "Action List",
                "add": "Add",
                "remove": "Remove",
                "clickCancel": "Cancel",
                "clickOK": "OK",
                "workItemParticipant": "Current Node Operator",
                "procInstCreator": "Process Initiator",
                "to-doMessageTimeOut": "You Have a Pending Task Message About to Time Out.",
                "messageTimeOut": "You Have a Message About to Time Out",
                "agree": "Agree"
            },
            "sendMessageOperation": {
                "procInstCreator": "Process Initiator",
                "workItemParticipant": "Current Node Handler",
                "preActExecutors": "Previous Node Handlers",
                "day": "Day",
                "hour": "Hour",
                "minute": "Minute",
                "cycleTimeNotEmpty": "Cycle time interval cannot be empty!",
                "sendMethodNotEmpty": "Send method cannot be empty!",
                "subjectNotEmpty": "Message subject cannot be empty!",
                "contentNotEmpty": "Message content cannot be empty!",
                "recipientNotEmpty": "Recipient cannot be empty!",
                "messageTemplate": "Message template needs to be set when SMS channel is enabled",
                "smsTemplateNumberNotEmpty": "SMS template number cannot be empty",
                "cycleEnable": "Enable cycle warning",
                "cycleTime": "Cycle time interval",
                "sendType": "Send method",
                "subject": "Message subject",
                "message": "Message content",
                "receiverVari": "Recipient",
                "sysUsers": "System users",
                "clickCancel": "Cancel",
                "clickOK": "OK",
                "opinionsNotEmpty": "Automatic handling opinion cannot be empty!",
                "processingNotEmpty": "Automatic handling cannot be empty!",
                "automaticProcessSet": "Automatic handling settings",
                "automaticProcessMethod": "Automatic handling method",
                "automaticOpinionHandle": "Automatic handling opinion"
            },
            "smsMessageTemplate": {
                "smsTemplateContent": "Template text defined in third-party SMS service provider, for example: Your GS Cloud data platform account has been activated. Username: ${username}, initial password: ${code}. Please log in to the system in time.",
                "code": "Variable",
                "value": "Value",
                "noRowsSelected": "No rows selected",
                "smsMessageTemplate": "SMS Service Template",
                "tips1": "Message template refers to the association of template variables defined by third-party SMS service provider with GS Cloud variables after the template has been defined.",
                "tips2": "Template number defined in the third-party SMS service provider, for example: Aliyun SMS_220626324",
                "tips3": "Configure the association between variables in the third-party SMS service provider's template and variables in GSCloud",
                "smsTemplateNumber": "SMS template number",
                "smsVariableBinding": "SMS variable binding",
                "addSmsVariable": "Add",
                "deleteSmsVariable": "Delete"
            },
            "signRule": {
                "countersignRules": "Countersign rules",
                "byNumber": "By Quantity",
                "byProportion": "By Percentage (%)",
                "customConditions": "Custom Conditions",
                "value": "Number",
                "text": "Name",
                "conclusionName": "Conclusion Name",
                "conclusionValue": "Conclusion Value",
                "calculateType": "Calculation Method",
                "conditionValue": "Condition Value",
                "waitAllVotes": "Wait for all members to complete",
                "yes": "Yes",
                "no": "No",
                "notEmpty": "When the completion strategy is countersignature, the countersign rules cannot be empty. Please understand!",
                "pleaseSelect": "Please select an item first!",
                "maxConditionValue": "The maximum value of the condition must be 100",
                "minConditionValue": "The minimum value of the condition must be 0",
                "noConditional": "No conditional value is required when the execution mode is unanimous or one vote",
                "set": "(Set)",
                "ruleList": "Rule List",
                "approvalOptions": "Approval Options",
                "clickCancel": "Cancel",
                "deleteRow": "Reset",
                "clickOK": "OK"
            },
            "saveAsEdit": {
                "public": "Public",
                "private": "Private",
                "code": "Number",
                "name": "Name",
                "nameNotEmpty": "Process name cannot be empty",
                "organizationNotEmpty": "Maintenance organization cannot be empty",
                "organization": "Organization",
                "basicAttributes": "Basic Attributes",
                "processName": "Process name",
                "processKeyValue": "Process Key value",
                "maintenanceOrg": "Maintenance organization",
                "accessLevel": "Access level",
                "saveAsCancel": "Cancel",
                "saveAsOK": "OK"
            },
            "release": {
                "release": "Process Release",
                "update": "Process Update",
                "applicantName": "Applicant Name",
                "applicantDepartment": "Applicant Department",
                "procName": "Process name",
                "procVersion": "Process version",
                "releaseType": "Release type",
                "textDetail": "Description",
                "saveAsCancel": "Cancel",
                "saveAsOK": "OK"
            },
            "processVariables": {
                "string": "String",
                "integer": "Integer",
                "decimal": "Decimal",
                "boolean": "Boolean",
                "constant": "Constant",
                "expression": "Expression",
                "component": "Component",
                "name": "Variable number",
                "required": "Required",
                "documentation": "Variable name",
                "basicType": "Variable type",
                "description": "Description",
                "tag": "Initial value type",
                "valueText": "Initial value",
                "processVariables": "Process variables",
                "notSelected": "No process variables selected!",
                "variableNumberEmpty": "Variable number cannot be empty!",
                "variableNameEmpty": "Variable name cannot be empty!",
                "variableNumberNotStandard": "Variable number can only contain letters, numbers, and underscores, and cannot start with a number!",
                "tagNotEmpty": "Initial value type cannot be empty!",
                "codeDuplicates": "Process variable number cannot be duplicated!",
                "alreadyExists": "The added variable already exists!",
                "set": "(Set)",
                "notSet": "(Not Set)",
                "add": "Add",
                "delete": "Delete",
                "number": "Number",
                "clickCancel": "Cancel",
                "clickOK": "OK"
            },
            "participant": {
                "user": "User",
                "variable": "Variable Participant",
                "position": "Position",
                "role": "Role",
                "component": "Component Participant",
                "reportingLine": "Reporting Line",
                "matrix": "Matrix",
                "activityExecutor": "Historical Activity Executor",
                "organization": "Organization/Department",
                "all": "All",
                "assign": "Assign",
                "claim": "Claim",
                "currentUser": "Current Handler",
                "procInstCreator": "Process Initiator",
                "participantSet": "Participant Set",
                "order": "Order",
                "type": "Type",
                "performerName": "Name",
                "description": "Description",
                "condition": "Enable Condition",
                "dataMovement1": "Move default handler data to alternative handlers?",
                "dataMovement2": "Move alternative handler data to default handler?",
                "participantSelection": "Participant Selection",
                "selectProcessVariables": "Process variables not selected yet!",
                "selectVariableValueType": "Variable value type not selected yet!",
                "selectRelation": "Relation not selected yet!",
                "selectPosition": "Position not selected yet!",
                "selectOrgType": "Organization type not selected yet!",
                "orgFill": "Organization not filled yet!",
                "refOrgIdNotNull": "When reference type is organization, the reference organization field cannot be empty",
                "refUserIdNotNull": "When reference type is system user/employee, the reference person field cannot be empty",
                "repDefConfigured": "The reporting line has already been configured",
                "atLeastOneCondition": "At least one condition field must exist",
                "dataFieldAliasNotNull": "Data field cannot be empty",
                "matrixConfigured": "The matrix has already been configured",
                "selectPerformer": "Performer not selected yet",
                "definitionDeleted": "The definition of this reporting line data has been deleted, this data will be deleted",
                "matrixDeleted": "The definition of this matrix data has been deleted, this data will be deleted",
                "selectParticipantInfo": "Please select a participant information first!",
                "noRowSelected": "No row selected yet!",
                "selectDefaultHandler": "Please select a default handler first",
                "selectpotentialtHandler": "Please select an alternative handler first",
                "org": "Organization:",
                "positionType1": "Position type: General position, Organization:",
                "positionType2": "Position type: General position",
                "positionType3": "Position type: Organization position",
                "comp": "Component:",
                "parameters:": ", Parameters: {",
                "referencePerson:": "Reference person: ",
                "referenceOrganization:": "Reference organization: ",
                "condition1": "Condition 1: ",
                "condition2": "Condition 2: ",
                "condition3": "Condition 3: ",
                "data": "Data: ",
                "set": "(Set)",
                "notSet": "(Not set)",
                "allocationPolicy": "Allocation Policy",
                "operator": "Assign Operator",
                "multiSelect": "Allow Multiple Selection",
                "necessary": "Only one candidate user, still requires manual selection",
                "notifyRecipient": "Notify Recipient",
                "defaultHandler": "Default Handler",
                "new": "Add",
                "editPerformer": "Edit",
                "removePerformer": "Remove",
                "clearPerformer": "Clear",
                "moveUp": "Move Up",
                "moveDown": "Move Down",
                "alternativeHandler": "Alternative Handler",
                "isAllScope": "When specifying participants, there is no restriction, select from all users",
                "clickCancel": "Cancel",
                "clickOK": "OK",
                "alternativeScope": "Alternative Scope",
                "orgId": "OrgID",
                "includeChildren": "Include Children",
                "conditon": "Conditon",
                "currentUnit": "Current Unit",
                "currentDepartment": "Current Department",
                "variableOrganization": "Variable Org"
            },
            "activityExecutor": {
                "name": "Name",
                "eventHandler": ">Activity Executor",
                "nodeName": "Node Name",
                "enablingConditions": "Enable Conditions",
                "activityList": "Activity List",
                "clickCancel": "Cancel",
                "clickOK": "OK"
            },
            "componentPerformer": {
                "componentMethod": "Current component method parameters are inconsistent, please update!",
                "methodNotExist": "This method does not exist in the current component, please update!",
                "code": "Code",
                "name": "Name",
                "description": "Description",
                "valueText": "Parameter Value",
                "help": "Help",
                "errorObtaining": "Error obtaining parsing component",
                "componentSelection": "Component Selection",
                "metadataNotExist": "Help metadata does not exist!",
                "serverSideNotFound": "Server side did not find help metadata, please check if the metadata has been deployed to the environment",
                "componentName": "Component Name",
                "componentSelect": "Component Selection",
                "parameterList": "Parameter List"
            },
            "matrixPerformer": {
                "code": "Code",
                "name": "Name",
                "help": "Help",
                "multivalue": "Multi",
                "enumSelection": "Enum Selection",
                "refMatrixTable": "Reference Matrix Table",
                "matrixTable": "Matrix Table",
                "curDataFieldValue": "Result Column",
                "conditionFields": "Condition Fields",
                "condition": "Enable Condition",
                "key": "Key",
                "value": "Value",
                "notSelectEnum": "Enum value not selected yet",
                "cancel": "Cancel",
                "onConfirm": "Confirm",
                "lineNumber": "Line Number"
            },
            "performerOptions": {
                "leave": "Flow Down",
                "throwException": "Exception Prompt",
                "sys": "User ID",
                "administrative_staff": "Employee ID",
                "procInstCreator": "Process Initiator",
                "preActExecutors": "Previous Node Executors",
                "allPassExecutors": "All Approved Personnel",
                "performerOptions": "Performer Options",
                "exclusionNotAllowed": "All Approved Personnel have set automatic approval, previous node executors are not allowed to be excluded by default!",
                "approvalNotAllowed": "When [Allocation Policy] is [Claim], automatic approval is not allowed to be set, please be aware!",
                "approvalNotAllowedAsSet": "All Approved Personnel have set not allowed for approval, previous node executors are not allowed to be automatically approved by default!",
                "allocationStrategyIsCollect": "When [Allocation Policy] is [Claim], automatic approval is not allowed to be set, please be aware!",
                "set": "(Set)",
                "advancedOptions": "Advanced Performer Options",
                "historicFirst": "When entering the node again, the handler is the previously handled personnel of the node",
                "noPerformerStrategy": "Handler is Empty Strategy:",
                "excludeProcInstCreator": "Exclude Handler Options",
                "defaultNotParticipate": "Process Initiator does not participate in approval by default",
                "excludePreActExecutors": "Previous node executors do not participate in approval by default",
                "excludeAllPassExecutors": "All Approved Personnel do not participate in approval by default",
                "excludeExprPerformer": "Process Variable:",
                "variableOrgTypes": "Variable Value Types:",
                "automaticApprovalOptions": "Automatic Approval Options",
                "autoProcInstCreator": "Process Initiator is automatically approved by default",
                "autoPreActExecutors": "Previous node executors are automatically approved by default",
                "autoAllPassExecutors": "All Approved Personnel are automatically approved by default",
                "cancel": "Cancel",
                "clickOK": "OK"
            },
            "positionPerformer": {
                "orgPosition": "Organization Position",
                "generalPosition": "General Position",
                "sysPositions": "System Positions",
                "positionType": "Position Type",
                "role": "Role",
                "position": "Position",
                "sysType": "Organization Type",
                "placeholder": "Please select",
                "orgId": "Organization ID",
                "condition": "Enable Condition",
                "clickCancel": "Cancel",
                "clickOK": "OK"
            },
            "reportingLine": {
                "higherSuperior": "Indirect Supervisor",
                "directSuperior": "Direct Supervisor",
                "code": "Code",
                "name": "Name",
                "dept": "Organization",
                "sysUser": "System User",
                "employee": "Employee",
                "businessFields": "Business Fields",
                "defName": "Reporting Definition",
                "dimension": "Reporting Level",
                "curReportingRefer": "Reference Type",
                "usersName": "Reference Person",
                "refOrgId": "Reference Organization",
                "condition": "Enable Condition",
                "definitionOfReport": "Definition of Reporting Relationship"
            },
            "userPerformer": {
                "regularUser": "Regular User",
                "variablePart": "Variable Participant",
                "sys": "System User",
                "administrative_organization": "Employee",
                "cantUseContext": "Administrative staff type cannot use this context variable",
                "user": "User",
                "variable": "Variable",
                "condition": "Enable Condition"
            },
            "variablePerformer": {
                "sys": "User ID",
                "administrative_staff": "Employee ID",
                "oneself": "Self",
                "administrative_organization": "Department ID",
                "cantUseContext": "Administrative staff type cannot use this context variable",
                "processVariables": "Process Variables",
                "variableOrgTypes": "Variable Value Types",
                "relationShipType": "Relationship",
                "condition": "Enable Condition",
            },
            "orgPotentialOwner": {
                "optionSettings": "Option Settings",
                "global": "All Members",
                "currentUnit": "Current Unit",
                "currentDepartment": "Current Department",
                "addSignBehind": "Add Signature",
                "addSignFront": "Consult",
                "transfer": "Transfer",
                "notify": "Notify",
                "set": "(Set)",
                "notSet": "(Not Set)",
                "option": "Option",
                "enable": "Enable or Not",
                "range": "Range",
                "OrgId": "Org Id",
                "variableOrganization": "Variable Org",
                "includeChildren": "Include Subordinates",
                "clickCancel": "Cancel",
                "clickOK": "OK",
                "limit": "Limit Scope",
                "turnOffPrompt": "Please Turn off the Scope of People option!"
            },
            "note": {
                "placeholder": "Please enter process change record",
                "clickCancel": "Cancel",
                "clickOK": "OK"
            },
            "MessageNotice": {
                "notify": "Message Notice",
                "subject": "Message Subject",
                "content": "Message Content",
                "sendTime": "Sending Time",
                "sendType": "Send Method",
                "receiverText": "Message Receiver",
                "procInstCreator": "Process Initiator,",
                "workItemParticipant": "Task Receiver,",
                "messageSet": "Message Settings",
                "selectedRow": "No message notification selected yet!",
                "noCopy": "No message notification attributes to copy!",
                "batchCopy": "Batch Copy",
                "set": "(Set)",
                "notSet": "(Not Set)",
                "add": "Add",
                "edit": "Edit",
                "delete": "Delete",
                "lineNumber": "Number",
                "clickCancel": "Cancel",
                "clickOK": "OK",
                "messContent": { "expr": "\'You have a message notification.\'", "sexpr": "" },
                "procComplete": "Process Completed",
                "procAborted": "Process Aborted",
                "procRollBack": "Process Rejected",
                "workCreated": "Task Created",
                "actComplete": "Activity Completed",
                "actAborted": "Activity Aborted",
                "email": "Email",
                "sms": "SMS",
                "cloudplus": "Cloud",
                "processParticipant": "Process Participant",
                "variableParticipant": "Variable Participant",
                "userParticipant": "Designated User",
                "positionParticipant": "Position",
                "activityExecutorParticipant": "Historical Handler",
                "sys": "System User",
                "administrative_organization": "Employee",
                "name": "Name",
                "noTargetNode": "No node selected yet!",
                "noMessageNotifyAttribute!": "No message notification attribute!"
            },
            "messageNoticeEdit": {
                "procInstCreator": "Process Initiator",
                "activityExecutorParticipant": "Historical Handler",
                "workItemParticipant": "Task Handler",
                "sys": "System User",
                "administrative_organization": "Employee",
                "processParticipant": "Process Participant",
                "workItemReceiveParticipant": "Task Receiver",
                "variableParticipant": "Variable Participant",
                "userParticipant": "Designated User",
                "positionParticipant": "Position",
                "sendType": "Send method cannot be empty",
                "smsMessageTemplate": "Message channel requires SMS, please set the message template",
                "smsMessageTemplateCode": "SMS template code cannot be empty",
                "sendTime": "Sending time cannot be empty",
                "subject": "Message subject cannot be empty",
                "content": "Message content cannot be empty",
                "receivers": "Receiver cannot be empty!",
                "processParticipantNotNull": "Process participant cannot be empty",
                "activityDefIdNotNull": "When process participant is historical handler, the handling node cannot be empty",
                "variableParticipantNotNull": "Variable participant cannot be empty",
                "orgType": "Organization type of variable participant cannot be empty",
                "userIds": "Designated user cannot be empty",
                "positionId": "Position cannot be empty",
                "activityList": "Activity List",
                "position": "Position",
                "optionalNodes": "Optional Nodes",
                "targetNodeList": "Target Node List",
                "placeholder": "Please select target node",
                "optionalAttribute": "Optional Attributes",
                "lineNumber": "Number",
                "clickCancel": "Cancel",
                "clickOK": "OK",
                "messSendType": "Message Channel",
                "messSubject": "Message Subject",
                "enable": "Enable Expression",
                "messContent": "Message Content",
                "recipient": "Receiver",
                "addReceiver": "Add",
                "organization": "Organization:",
                "posi": "Position:"
            },
            "jumpScope": {
                "targetNodeOptions": "Target Node Options",
                "name": "Name",
                "outConnectNode": "Process Diagram Connection Node",
                "global": "All Nodes within the Process",
                "afterNodes": "All Successor Nodes",
                "specifiedSet": "Process Diagram Connection Node + Additional Nodes",
                "firstNode": "Conditional true connection node, when there are multiple options, the first one is selected by default",
                "nullNode": "Default is empty, manual selection every time",
                "specifyNode": "Specify the default node",
                "noSetTargetNode": "Target node options not set yet, please understand!",
                "noSetSpecifyNode": "Default node not specified yet, please understand!",
                "selectedRow": "Please select an option first!",
                "optionalNodes": "Optional Nodes",
                "listOfAdditional": "List of Additional Nodes",
                "pleaseSelect1": "Please select additional nodes",
                "defaultNode": "Default Node",
                "pleaseSelect2": "Please select default node",
                "defaultNodeList": "Default Node List",
                "clickCancel": "Cancel",
                "clickOK": "OK",
                "set": "(Set)"
            },
            "imageSet": {
                "imageSet": "Image Setting",
                "onlyView": "View Only",
                "edit": "Edit",
                "reScanStart": "Initiate Re-scan",
                "reScanComplete": "Re-scan Complete",
                "mutualExclusion": "[View Only] option is exclusive with other options, please understand!",
                "set": "(Set)",
                "notSet": "(Not Set)",
                "imageOperation": "Image Operation Permission",
                "clickCancel": "Cancel",
                "clickOK": "OK"
            },
            "extendProperty": {
                "extendProperty": "Extended Property",
                "true": "Yes",
                "false": "No",
                "set": "(Set)",
                "notSet": "(Not Set)",
                "illustrate": "Illustrate",
                "placeholder": "Please select",
                "cancel": "Cancel",
                "clickOK": "OK"
            },
            "expressionEditor": {
                "expressionEditor": "Expression Editor",
                "notSet": "(Not Set)",
                "clickCancel": "Cancel",
                "changeType": "Switch Type",
                "clickOK": "OK"
            },
            "executeForms": {
                "executeForms": "Form Definition",
                "parameters": "Parameters [",
                "typeAsvariable": "] is of variable type, but does not exist in process variables",
                "parameterSettings": "Parameter Settings",
                "formDefinitionList": "Form Definition List",
                "notSet": "(Not Set)",
                "default": "Process Default Form",
                "processEmbeddedForm": "Process-Embedded Form",
                "formEmbedProcess": "Form-Embedded Process",
                "clickCancel": "Cancel",
                "clickOK": "OK",
                "noForm": "No Form Format",
                "form": "Select Form",
                "placeholder": "Please select",
                "parametersSet": "Parameters",
                "key": "Variable ID",
                "name": "Variable Name",
                "lineNumber": "Serial Number",
                "code": "Code",
                "tag": "Type",
                "value": "Parameter Value",
                "variable": "Variable",
                "constant": "Constant",
                "expression": "Expression",
                "method": "Method Identifier",
                "methodName": "Method Name",
                "description": "Description",
                "workFlowAction": "Workflow Direction",
                "formOperations": "Form Operations",
                "executionTime": "Execution Time",
                "sortOrder": "Execution Order",
                "methodParameters": "Parameters",
                "selectFormActionConfig": "Form Action Configuration not selected!",
                "selectFormAction": "Form Action not selected!",
                "editParam": "Settings",
                "formEvents": "Form Events",
                "buttonName": "Button Name",
                "enable": "Enabled",
                "disabled": "Disabled",
                "hidden": "Hidden",
                "fieldName": "Field Name",
                "editable": "Editable",
                "readonly": "Read-only",
                "required": "Required",
                "saveFail": "Failed to save configuration. Please contact the administrator for details!",
                "checkedRows": "No button collection selected",
                "checkeds": "No field collection selected",
                "enableBtn": "Enabled",
                "disabledBtn": "Disabled",
                "hiddenBtn": "Hidden",
                "btnBatchReset": "Reset",
                "editableBtn": "Editable",
                "readonlyBtn": "Read-only",
                "requiredBtn": "Required",
                "add": "Add",
                "delete": "Delete",
                "other": "Other",
                "formBtn": "Form Button",
                "formfield": "Form Field",
                "apptag": "Document Type",
                "functionMenu": "Function Menu",
                "formFormat": "Form Format",
                "docFormatNumber": "Document Format Number",
                "docFormatName": "Document Format Name",
                "selectedRow": "No form definition selected!",
                "set": "(Set)"
            },
            "eventDefinition": {
                "eventDefinition": "Signal Definition",
                "pass": "Forward",
                "back": "Backward",
                "abort": "Abort",
                "signalRef": "Signal ID",
                "name": "Signal Name",
                "triggerAction": "Workflow Direction",
                "selectedRow": "No trigger event selected!",
                "dataLength": "At least one signal definition is required!",
                "codeNotNull": "Signal ID cannot be empty!",
                "nameNotNull": "Signal Name cannot be empty!",
                "codeNotNumber": "Signal ID cannot be pure numbers!",
                "codeRepeat": "Signal ID cannot be repeated!",
                "set": "(Set)",
                "notSet": "(Not Set)",
                "add": "Add",
                "delete": "Delete",
                "clickCancel": "Cancel",
                "clickOK": "OK"
            },
            "entryFormEditor": {
                "flowForm": "Process Category",
                "code": "Code",
                "name": "Name",
                "base": "Base",
                "foundation": "Foundation",
                "extend": "Extended",
                "selectedRow": "No process category selected",
                "absent": "Process category no longer exists",
                "lineNumber": "Serial Number",
                "clickCancel": "Cancel",
                "clickOK": "Rebind"
            },
            "editComponentParameter": {
                "code": "Code",
                "name": "Name",
                "required": "Required",
                "yes": "Yes",
                "no": "No",
                "value": "Parameter Value",
                "openComponentFail": "Failed to parse component",
                "componentSelection": "Component Selection",
                "curComponent": "Please select a process component",
                "executionTime": "Please select execution time",
                "para": "Parameter",
                "paraRequired": "] is required",
                "execuTime": "Execution Time",
                "parameterList": "Parameter List",
                "clickCancel": "Cancel",
                "clickOK": "OK"
            },
            "customizeAction": {
                "customizeAction": "Customize Action",
                "app": "Mobile",
                "web": "Web",
                "all": "Web, Mobile",
                "name": "Name",
                "code": "Code",
                "terminalType": "Terminal Type",
                "isAll": "Default",
                "yes": "Yes",
                "no": "No",
                "paramName": "Code",
                "valueText": "Name",
                "value": "Parameter Value",
                "addActions": "Select Custom Actions",
                "actionExisted": "The added custom action already exists!",
                "selectedRow": "Please select an option first!",
                "set": "(Set)",
                "notSet": "(Not set)",
                "add": "Add",
                "delete": "Delete",
                "parameterList": "Parameter List",
                "clickCancel": "Cancel",
                "clickOK": "OK"
            },
            "checkCondition": {
                "zhChs": "Simplified Chinese",
                "zhCht": "Traditional Chinese",
                "en": "English",
                "checkCondition": "Activity Validation Rule",
                "set": "(Set)",
                "notSet": "(Not set)",
                "nodeEntry": "Node Entry",
                "activityBeforeStarted": "Node Entry Condition",
                "enterErrorTips": "Enter Condition Mismatch Tips",
                "activityBeforeCompleted": "Node Exit",
                "activityBeforeCompletedValue": "Node Exit Condition",
                "leaveErrorTips": "Leave Condition Mismatch Tips",
                "clickCancel": "Cancel",
                "clickOK": "OK"
            },
            "batchSet": {
                "targetNode": "target Node",
                "addSignFront": "addSign Front",
                "addSignBehind": "addSign Behind",
                "transfer": "transfer",
                "notify": "notify",
                "backWardRule": "backWard Rule",
                "name": "name"
            },
            "subProcess": {
                "subProcessSet": "Subprocess Settings",
                "specified": "Specify Subprocess",
                "dynamic": "Dynamic Subprocess",
                "inheritParent": "Same as Parent Process",
                "autoCreation": "Auto Generate Downstream Documents",
                "variablesExpression": "Variable Expression",
                "rteNull": "Please select a document workflow",
                "orderProcess": "Document Workflow",
                "clickOk": "OK",
                "clickCancel": "Cancel",
                "inheritBizDataId": "When the subprocess is inconsistent with the parent process document, please set the subprocess document ID!",
                "set": "(Set)",
                "notSet": "(Not set)",
                "radioGroupProcessType": "Sub Type",
                "flowForm": "Flow Category",
                "processDef": "Process Definition",
                "radioGroupBillSource": "Source",
                "autoCreationProcess": "Auto Process",
                "bizDataId": "Document ID",
                "setOption": "Set options",
                "SameParentProcess": "The same business document as the parent process",
                "setBizDataId": "Set document ID",
                "subProcessOpt": "Subprocess Options"
            },
            "backwardRule": {
                "reEdit": "The rejected activity node no longer exists. Please re-edit.",
                "backwardRule": "Rejection Rule",
                "initialActityId": "Start Node",
                "precursorActivityId": "Predecessor Node",
                "empty": "Empty",
                "name": "Name",
                "id": "Identifier",
                "sequence": "Sequential Transition",
                "backToMe": "Return to Me",
                "backToCurrentNode": "Return to Current Node",
                "popover": "1. Sequential Transition: Transition according to the order of the flow lines; 2. Return to Me: If the completion strategy is Preemptive, only create tasks for the person who rejected it. If the completion strategy is Countersignature, the person who rejected it and the unapproved person will receive new tasks, and the approved personnel will automatically approve them; 3. Return to Current Node: The actual effect is affected by the option 'Is the executor a person who has already processed the node when entering the node again'",
                "selectAbleClick": "Under the Countersignature strategy, dynamic selection of rejection target nodes is not allowed!",
                "dictPicked": "Please use the 'Revert to Empty' option with the 'Allow dynamic selection of rejection target nodes' option",
                "set": "(Set)",
                "notSet": "(Not set)",
                "rejectedTo:": "Reverted to:",
                "backScope": "Scope of rejection",
                "defaultPrompt": "All historical rejection nodes are selected by default",
                "title": "Activity List",
                "dynamicSelection": "Allow dynamic selection of rejection target nodes",
                "resubmitEffectOptions": "Return Settings",
                "popover1": "1. Sequential Transition: Transition according to the order of the flow lines;",
                "popover2": "2. Return to Me: If the completion strategy is Preemptive, only create tasks for the person who rejected it. If the completion strategy is Countersignature, the person who rejected it and the unapproved person will receive new tasks, and the approved personnel will automatically approve them;",
                "popover3": "3. Return to Current Node: The actual effect is affected by the option 'Is the executor a person who has already processed the node when entering the node again'",
                "allowModification": "Allow modification of return settings",
                "clickCancel": "Cancel",
                "clickOk": "OK"
            },
            "assignStrategy": {
                "all": "All",
                "assign": "Assign",
                "claim": "Claim",
                "currentUser": "Current Executor",
                "procInstCreator": "Process Initiator",
                "assignStrategy": "Assignment Strategy",
                "option": "Option",
                "assignmentRules": "Assignment Rules",
                "operator": "Assign Operator",
                "multiSelect": "Multiple candidate users can be selected",
                "necessary": "Only one candidate user, still requires manual selection",
                "clickCancel": "Cancel",
                "clickOK": "OK"
            },
            "assignScope": {
                "assignScopeList": "Assigned Node List",
                "required": "Required",
                "yes": "Yes",
                "no": "No",
                "condition": "Condition",
                "add": "Add",
                "delete": "Delete",
                "name": "Name",
                "deleteRow": "Please select an option first!",
                "curActivity": "No row selected",
                "set": "(Set)",
                "notSet": "(Not set)",
                "nodeList": "Node List",
                "moveUp": "Move Up",
                "moveDown": "Move Down",
                "clickCancel": "Cancel",
                "clickOK": "OK"
            },
            "assignPerformer": {
                "currentUser": "Current User",
                "procInstCreator": "Process Initiator",
                "global": "Global",
                "currentUnit": "Current Unit",
                "currentDepartment": "Current Department",
                "assignPerformer": "Assign Rule",
                "set": "(Set)",
                "operator": "Assign Operator",
                "multiSelect": "Allow Selecting Multiple Candidates",
                "necessary": "When there is only one candidate, manual selection is still required",
                "clickCancel": "Cancel",
                "clickOK": "OK"
            },
            "approvelItems": {
                "approvalOptions": "Approval Options",
                "forward": "Forward",
                "backward": "Backward",
                "abort": "Abort",
                "value": "Number",
                "text": "Name",
                "workFlowAction": "Workflow Direction",
                "isDefault": "Default",
                "no": "No",
                "yes": "Yes",
                "commentNecessary": "Comment Required",
                "attachmentNecessary": "Attachment Upload",
                "certification": "Digital Signature",
                "signatureNecessary": "Manual Signature Required",
                "defaultComment": "Default Comment",
                "zh-CHS": "Simplified Chinese",
                "zh-CHT": "Traditional Chinese",
                "en": "English",
                "workFlowActionNotNull": "Approval item workflow direction cannot be empty, please modify!",
                "deleteRow": "Please select an option first!",
                "set": "(Set)",
                "notSet": "(Not Set)",
                "add": "Add",
                "delete": "Delete",
                "clickCancel": "Cancel",
                "clickOK": "OK",
                "approvalAction": "Approval Action",
                "lineNumber": "Number"
            },
            "approvalPivot": {
                "remind": "Text Prompt",
                "type": "Type",
                "condition": "Condition",
                "title": "Display Name",
                "description": "Detailed Description",
                "approvalPivot": "Approval Key Point",
                "selectedRow": "Approval key point not selected!",
                "configTitle": "Display title not filled!",
                "set": "(Set)",
                "notSet": "(Not Set)",
                "enable": "Enable",
                "expand": "Expand",
                "showTitle": "Display Title",
                "list": "List",
                "add": "Add",
                "delete": "Delete",
                "clickCancel": "Cancel",
                "clickOK": "OK"
            },
            "anonymousSet": {
                "anonymousOpt": "Anonymous Option",
                "approver": "Approver",
                "set": "(Set)",
                "notSet": "(Not Set)",
                "anonymousSet": "Anonymous Settings",
                "isAnonymity": "Enable",
                "anonymous": "Anonymous Alias",
                "clickCancel": "Cancel",
                "clickOK": "OK"
            },
            "activityList": {
                "name": "Name",
                "checkeds": "No activity nodes selected",
                "lineNumber": "Number",
                "clickCancel": "Cancel",
                "clickOK": "OK"
            },
            "activityComponent": {
                "component": "Component",
                "method": "Component Method",
                "inconsistentParameters": "Inconsistent parameters, please check",
                "longerExists": "The component no longer exists in this method",
                "absent": "Cancel",
                "pleaseCheck": ", please check",
                "edit": "Edit",
                "deleteRow": "Delete",
                "executionTime": "Execution Time",
                "cmpName": "Component Name",
                "metadataId": "Component ID",
                "methodCode": "Component Method",
                "isForCompensation": "Compensation Operation",
                "yes": "Yes",
                "no": "No",
                "operate": "Operate",
                "code": "Code",
                "name": "Name",
                "value": "Parameter Value",
                "editComponent": "Edit Component",
                "confirmDelete": "Confirm whether to delete the component?",
                "curComponent": "No component selected!",
                "newComponent": "New Component",
                "sameCmp": "There are duplicate process components",
                "cmpMethod": "Component Method:",
                "executionTimeNotNull": "Component execution time cannot be empty!",
                "param": " parameter",
                "required": "Required",
                "set": "(Set)",
                "notSet": "(Not Set)",
                "PROCESSINSTANCE_STARTED": "Process Started",
                "PROCESSINSTANCE_SUSPENDED": "Process Suspended",
                "PROCESSINSTANCE_RESUMED": "Process Resumed",
                "PROCESSINSTANCE_COMPLETED": "Process Completed",
                "PROCESSINSTANCE_ABORTED": "Process Aborted",
                "PROCESSINSTANCE_CANCELED": "Process Canceled",
                "PROCESSINSTANCE_REACTIVATED": "Process Reactivated",
                "PROCESSINSTANCE_ROLLBACK": "Process Rolled Back",
                "PROCESSINSTANCE_RESUBMIT": "Resubmit Process",
                "ACTIVITY_AND_PARTICIPANT_UPDATED": "Activity Participants Changed",
                "PROCESSINSTANCE_ABORTED_BY_ADMIN": "Terminated by Administrator",
                "PROCESSINSTANCE_BEFORE_START": "Before Process Start",
                "WORKITEM_BEFORE_COMPLETE": "Before Task Completion",
                "WORKITEM_AFTER_COMPLETE": "After Task Completion",
                "LOADDATA": "Retrieve Data",
                "ACTIVITY_STARTED": "Activity Started",
                "ACTIVITY_COMPLETED": "Activity Completed",
                "ACTIVITY_ABORTED": "Activity Aborted",
                "WORKITEM_CREATED": "Work Item Created",
                "WORKITEM_COMPLETED": "Work Item Completed",
                "WORKITEM_SUSPENDED": "Work Item Suspended",
                "WORKITEM_RESUMED": "Work Item Resumed",
                "WORKITEM_ABORTED": "Work Item Aborted",
                "WORKITEM_RETRIEVED": "Work Item Retrieved",
                "WORKITEM_CLAIMED": "Work Item Claimed",
                "WORKITEM_UNCLAIMED": "Work Item Unclaimed",
                "ACTIVITY_ASSIGNMENT": "Task Assignment",
                "deleteNotAllowed": "The data retrieval component cannot be deleted, please understand!",
                "tips": "Tips:",
                "prefabricated": "External process components have been prefabricated, only data retrieval components are retained here",
                "add": "Add",
                "moveUp": "Move Up",
                "moveDown": "Move Down",
                "clickCancel": "Cancel",
                "clickOK": "OK"
            }
        }
    },
    "zh-CHT": {
        "validate": {
            "noProcessHeader": "模型不存在processHeader内容",
            "cmpsEmpty": "流程構件為空",
            "cmpsEmptyMsg": "流程構件不允許為空,請聯系表單開發確認問題",
            "directNoPf": "啟動管道為【直接】的流程不應該包含共亯（PF）的流程構件",
            "directNoPfMsg": "請移除以下共亯（PF）的流程構件:",
            "noLoadDataCmp": "缺少執行時機為[獲取數據]的流程構件",
            "noLoadDataCmpMsg": "流程定義不能缺少取數構件,請聯系表單開發確認問題",
            "noStartCmp": "缺少執行時機為[流程啟動]的流程構件",
            "noStartCmpMsg": "會導致流程啟動時無法修改單據狀態,請聯系表單開發確認問題",
            "lackProcessCompleteCmp": "缺少執行時機為[流程完成]的流程構件",
            "lackProcessCompleteCmpMsg": "會導致流程完成時無法修改單據狀態,請聯系表單開發確認問題",
            "lackProcessAbortCmp": "缺少執行時機為[流程終止]的流程構件",
            "lackProcessAbortCmpMsg": "會導致流程終止時無法修改單據狀態,請聯系表單開發確認問題",
            "lackProcessCancelCmp": "缺少執行時機為[流程終止]的流程構件",
            "lackProcessCancelCmpMsg": "會導致流程終止時無法修改單據狀態,請聯系表單開發確認問題",
            "lackProcessBackCmp": "缺少執行時機為[流程駁回]的流程構件",
            "lackProcessBackCmpMsg": "會導致流程駁回時無法修改單據狀態,請聯系表單開發確認問題",
            "lackProcessReStartCmp": "缺少執行時機為[重新提交]的流程構件",
            "lackProcessReStartCmpMsg": "會導致流程重新提交時無法修改單據狀態,請聯系表單開發確認問題",
            "parallelGatewayCheck": "【並行閘道】沒有成對出現",
            "parallelGatewayCheckMsg": "【並行閘道】需作為一條流程分支的折開節點和彙聚節點成對出現,請修改",
            "approvalPerformerCheck": "活動,未設定參與者",
            "noVariable1": "活動【變數設定】内容中已設定變數",
            "noVariable2": "在流程内容【流程變數】中已不存在,請修改！",
            "activity": "活動【",
            "noStartActivity": "】的標識不合法,不是以[startActivity]開頭",
            "noExclusiveGateway": "】的標識不合法,不是以[ExclusiveGateway]開頭",
            "noParallelGateway": "】的標識不合法,不是以[ParallelGateway]開頭",
            "noUserActivity": "】的標識不合法,不是以[UserActivity]開頭",
            "noOperationActivity": "】的標識不合法,不是以[OperationActivity]開頭",
            "noNotifyActivity": "】的標識不合法,不是以[NotifyActivity]開頭",
            "noCallActivitySubProcess": "】的標識不合法,不是以[CallActivitySubProcess]開頭",
            "noAutoActivity": "】的標識不合法,不是以[AutoActivity]開頭",
            "noIntermediateCatchEvent": "】的標識不合法,不是以[IntermediateCatchEventImpl]開頭",
            "noMessageActivity": "】的標識不合法,不是以[MessageActivity]開頭",
            "noAifCreationBillActivity": "】的標識不合法,不是以[AifCreationBillActivity]開頭",
            "noEndEvent": "】的標識不合法,不是以[EndEvent]開頭",
            "mark": "標識為【",
            "noFlowNodeChsName": "】的活動簡體中文名稱為空，請修改",
            "nameExceedsLengthLimit": "】的名稱超長，不能超過40個字元，請修改"
        },
        "processEditor": {
            "tip": "提示",
            "showButton": "顯示查看模型按鈕",
            "changeRecord": "流程變更記錄",
            "noDtInfo": "不存在設計時流程信息！請先賦值！",
            "noRtInfo": "不存在運行時流程信息！請先賦值！",
            "wrongMoment": "設計者運行時機錯誤！",
            "prompted": "系統提示",
            "saveSuccess": "保存成功",
            "waitReview": "保存成功，等待發起審核",
            "successPublish": "發布成功",
            "publishFail": "發布失敗，",
            "policyConflict": "會簽策略下，“駁回規則”不允許“動態選擇駁回級次”，請修改！",
            "noPermissionToSave": "當前用戶不具備另存流程的權限",
            "closeProc1": "關閉此頁面？",
            "closeProc2": "系統可能不會保存您所做的更改。",
            "viewModel": "查看模型",
            "copied": "模型已經復制到剪貼板",
            "button": {
                "saveProc": "保存",
                "releaseProc": "發布",
                "sync": "同步設計時包",
                "saveAs": "另存為",
                "procRecord": "流程記錄",
                "viewProcModel": "查看模型",
                "closeProc": "關閉"
            }
        },
        "designer": {
            "wfEditorUi": {
                "basicElements": "基本元素",
                "readOnly": "只讀"
            },
            "wfProcessCell": {
                "basicInfo": "基本信息",
                "name": "名稱",
                "nameLanguage": "名稱",
                "key": "標識",
                "entryForm": "流程分類",
                "startMode": "啟動方式",
                "wfTitle": "流程摘要",
                "formDef": "表單定義",
                "formsPC": "PC表單",
                "formsMobile": "移動表單",
                "process": "事件監聽",
                "advanced": "高級屬性",
                "basic": "基礎屬性",
                "wfComponent": "流程構件",
                "otherConfig": "其他配置",
                "processVariables": "流程變量",
                "basicElements": "基本元素",
                "customizeAction": "自定義動作",
                "timelinessInfo": "時效信息",
                "enablePriority": "啟用緊急程度",
                "enableWholeOrderRetrieve": "撤回在審單據",
                "messageProperty": "影像設置",
                "timeLimitControl": "超時操作",
                "messageNotice": "消息通知",
                "extendProperty": "擴展屬性",
                "directTips": "提示：啟動方式切換為直接，直接啟動是默認的流程啟動方式，切換後會移除共享(PF)相關構件，請知悉！",
                "externalTips": "提示：啟動方式切換為外部流程，適用於作為共享流程的外部流程相關場景，切換後保留流程上的共享（PF)相關構件，請知悉！",
                "subprocessTips": "提示：啟動方式切換為子流程，適用於調用式子流程的場景，切換後會移除除取數構件外的其他流程構件，請知悉！"
            },
            "WfSequenceFlowEdge": {
                "basicInfo": "基本信息",
                "basic": "基礎屬性",
                "name": "名稱",
                "nameLanguage": "名稱",
                "id": "標識",
                "condition": "條件選項",
                "ConditionExpression": "條件",
                "default": "缺省轉移線"
            },
            "wfSidebar": {
                "bizactivitylib": "業務活動"
            }
        },
        "app": {
            "processDesigner": {
                "all": "所有",
                "assign": "指派",
                "claim": "領用",
                "preempt": "搶占模式",
                "parallel": "並行會簽",
                "sequential": "串行會簽",
                "true": "是",
                "false": "否",
                "dataId": "單據內碼",
                "procInstId": "流程實例ID",
                "bizDefKey": "入口單據ID",
                "processDefinitionKey": "流程定義KEY",
                "procInstCreator": "流程發起人",
                "businessCreator": "業務發起人",
                "procInstDescription": "流程摘要",
                "comment": "審批意見",
                "bizDefName": "流程分類名稱",
                "curLoginUsername": "當前登錄人名稱",
                "procInstCreatorName": "流程發起人名稱",
                "currentParticipantId": "當前辦理人ID",
                "currentParticipantName": "當前辦理人名稱",
                "currentUser": "當前登錄用戶",
                "preActExecutors": "上一個活動的執行人",
                "collectionElementVariable": "多實例子活動元素變數",
                "subCollectionElementVariable": "多實例子流程元素變數",
                "nrOfInstances": "多實例總數量",
                "nrOfCompletedInstances": "多實例已完成數量",
                "nrOfActiveInstances": "多實例正在運行中的數量",
                "nrOfForward": "通過實例數量",
                "nrOfBackward": "駁回實例數量",
                "nrOfAbort": "終止實例數量",
                "conclusionType": "結論類型",
                "conclusionValue": "結論值",
                "directSuperior": "直接上級",
                "higherSuperior": "間接上級",
                "DIRECT": "直接",
                "EXTERNAL_PROCESS": "外部流程",
                "SUB_PROCESS": "子流程",
                "ALL": "電腦端和移動端",
                "WEB": "電腦端",
                "APP": "移動端",
                "conclusionTypeTips": "審批項流轉方向，1正向，2反向，3終止",
                "conclusionValueTips": "審批項編號，例如，Pass、Back、Refuse",
                "copy": "_副本",
                "saveAs": "另存為",
                "tips": "系統提示",
                "saveAsSuccess": "另存為成功",
                "saveAsFail": "另存為失敗，請檢查流程是否正確！",
                "syncDt": "是否將當前版本流程定義同步到設計時流程定義包",
                "syncSuccess": "同步成功",
                "beforeCompleteStrategyChange": "當前節點存在運行中的活動實例，不允許調整完成策略，請了解！",
                "releaseProcess": "發布前審核",
                "auto": "自動生單",
                "push": "推式生單",
                "pull": "拉式生單",
                "creation": "通過生單流程生成目標單"
            }
        },
        "multiInstanceLoopCharacteristics": {
            "loopCharacteristics": "多實例設置",
            "set": "（已設置）",
            "notSet": "（未設置）",
            "isEnable": "是否啟用",
            "isSequential": "是否串行",
            "loopCardinality": "元素集合",
            "completionConditionRules": "完成條件",
            "promptAct1": "1、[集合]中的元素個數為子活動啟動實例數量。",
            "promptAct2": "2、子活動啟動時系統會將[集合]中的元素拆分映射到各個子活動實例的[元素變數]。",
            "promptProc1": "1、[集合]中的元素個數為子流程啟動實例數量。",
            "promptProc2": "2、子流程啟動時系統會將[集合]中的元素拆分映射到各個子流程實例的[元素變數]。",
            "checkPrompt": "當前節點存在運行中的活動實例，不允許調整",
            "conditionRulesSet": "（已設置）",
            "completionConditionRulesList": {
                "forward": "正向",
                "backward": "反向",
                "abort": "終止"
            }
        },
        "component": {
            "optins": {
                "wfOptions": "工作流選項",
                "specified": "指定子流程",
                "dynamic": "動態子流程",
                "set": "（已設置）",
                "notSet": "（未設置）",
                "subProcessType": "子流程類型",
                "processType": "流程類型",
                "bizDef": "流程分類",
                "procDef": "流程定義",
                "clickCancel": "取消",
                "clickOk": "確定"
            },
            "voConfig": {
                "documentInfo": "單據信息",
                "viewModelSelection": "視圖模型選擇",
                "cancel": "取消",
                "clickOk": "確定",
                "selectOne": "確定",
                "documentTypeSelect": "單據類型選擇",
                "set": "（已設置）",
                "notSet": "（未設置）",
                "viewModel": "視圖模型",
                "documenttype": "單據類型",
                "placeholder": "請選擇"
            },
            "variableSetting": {
                "constant": "常數",
                "expression": "表達式",
                "component": "構件",
                "ACTIVITY_STARTED": "活動開始",
                "ACTIVITY_COMPLETED": "活動結束",
                "varAssign": "變量賦值",
                "varNumber": "變量編號",
                "REQUIRED": "必填",
                "varName": "變量名稱",
                "valueType": "值類型",
                "executionTime": "執行時機",
                "valueText": "變量值",
                "processVariables": "流程變量",
                "notSelectedVar": "尚未選中變量！",
                "valueCannotEmpty": "變量值不允許為空！",
                "set": "（已設置）",
                "notSet": "（未設置）",
                "add": "新增",
                "delete": "刪除",
                "serialNumber": "序號",
                "clickCancel": "取消",
                "clickOK": "確定",
                "inconsistentParameters": "當前構件方法參數不一致，請更新！",
                "methodNotExist": "當前構件已不存在此方法，請更新！",
                "parameterName": "參數名",
                "parameterValue": "參數值",
                "methodnotSelected": "尚未選擇構件方法",
                "metadataNotExist": "幫助元數據不存在，請聯繫系統管理員查看原因！",
                "errorObtainComponent": "獲取解析構件錯誤",
                "componentSelection": "構件選擇",
                "componentName": "構件名稱",
                "parameterList": "參數列表",
                "lineNumber": "序號"
            },
            "urgeHandleRule": {
                "urgentApproval": "催辦審批：",
                "pleaseApprove": "請您儘快審批",
                "soOn": "的",
                "urgeHandle": "催辦",
                "noSendingMethod": "尚未選擇發送方式！",
                "setMessageTemplate": "消息渠道啟用簡訊時需設置消息模板",
                "codeEmpty": "簡訊模板編號不允許為空",
                "noMessageSubject": "尚未配置消息主題！",
                "noMessageContent": "尚未選擇消息內容！",
                "earliestTimeNotEmpty": "最早允許催辦時間不允許為空",
                "minimumTimeNotEmpty": "最小允許催辦間隔不允許為空",
                "set": "（已設置）",
                "notSet": "（未設置）",
                "enableUrgeHandle": "啟用催辦",
                "timeSetting": "時間設置",
                "earliestTime": "最早允許催辦時間（小時）",
                "minimumInterval": "最小允許催辦間隔（小時）",
                "sendingMethod": "發送方式",
                "messageSubject": "消息主題",
                "supportEditing": "支持編輯",
                "messageContent": "消息內容",
                "displayReminder": "顯示催辦人",
                "clickCancel": "取消",
                "clickOK": "確定"
            },
            "titleExpression": {
                "zh-CHS": "中文简体",
                "zh-CHT": "中文繁體",
                "en": "英文",
                "taskDescription": "任務描述",
                "set": "（已設置）",
                "notSet": "（未設置）",
                "currentLanguage": "當前摘要語言:",
                "clickCancel": "取消",
                "clickOK": "確定"
            },
            "timeLimitControl": {
                "timedOutOperation": "超時操作",
                "constant": "固定值",
                "scope": "時間範圍",
                "day": "天",
                "hour": "時",
                "minute": "分",
                "BeforeDuration": "到期之前",
                "OnDuration": "到期時",
                "AfterDuration": "到期之後",
                "SendMessageExpireOperation": "超時預警",
                "AutoHandleExpireOperation": "自動辦理",
                "curDay": "當天",
                "durationType": "期限類型",
                "required": "必填",
                "timeDuration": "時長",
                "timeUnit": "單位",
                "operationTypeName": "操作類型名稱",
                "sendType": "操作",
                "onlyBeInteger": "任務期限只能是整數！",
                "setOperation": "請設置超時操作！",
                "setType": "請設置自動辦理類型！",
                "setComments": "請設置自動辦理意見！",
                "selectedOperation": "尚未選中預警操作！",
                "notSupportAutomatic": "下一節點是由當前辦理人指派的話，當前節點不支持任務自動辦理",
                "warningMessage": "預警消息",
                "automaticProcessing": "自動辦理",
                "set": "（已設置）",
                "notSet": "（未設置）",
                "timelinessControl": "任務處理時效控制",
                "isEnable": "是否啟用",
                "taskDeadline": "任務期限",
                "timelyOperation": "時效預警操作",
                "actionList": "操作列表",
                "add": "新增",
                "remove": "刪除",
                "clickCancel": "取消",
                "clickOK": "確定",
                "workItemParticipant": "當前節點辦理人",
                "procInstCreator": "流程發起人",
                "to-doMessageTimeOut": "您有一條待辦消息即將超時。",
                "messageTimeOut": "您有一條消息即將超時",
                "agree": "同意"
            },
            "sendMessageOperation": {
                "procInstCreator": "流程發起人",
                "workItemParticipant": "當前節點辦理人",
                "preActExecutors": "上一節點辦理人",
                "day": "天",
                "hour": "時",
                "minute": "分",
                "cycleTimeNotEmpty": "循環時間間隔不允許為空！",
                "sendMethodNotEmpty": "發送方式不允許為空！",
                "subjectNotEmpty": "消息主題不允許為空！",
                "contentNotEmpty": "消息內容不允許為空！",
                "recipientNotEmpty": "接收人不允許為空！",
                "messageTemplate": "消息渠道啟用短信時需設置消息模板",
                "smsTemplateNumberNotEmpty": "短信模板編號不允許為空",
                "cycleEnable": "啟用循環預警",
                "cycleTime": "循環時間間隔",
                "sendType": "發送方式",
                "subject": "消息主題",
                "message": "消息內容",
                "receiverVari": "接收人",
                "sysUsers": "系統用戶",
                "clickCancel": "取消",
                "clickOK": "確定",
                "opinionsNotEmpty": "自動辦理意見不允許為空！",
                "processingNotEmpty": "自動辦理不允許為空！",
                "automaticProcessSet": "自動辦理設置",
                "automaticProcessMethod": "自動辦理方式",
                "automaticOpinionHandle": "自動辦理意見"
            },
            "smsMessageTemplate": {
                "smsTemplateContent": "協力廠商簡訊服務商裏定義的範本原文，例如：阿裡雲您的管控大數據平臺帳號已開通，用戶名為：${username}，初始密碼為：${code}，請及時登入系統",
                "code": "變量",
                "value": "值",
                "noRowsSelected": "尚未選中行",
                "smsMessageTemplate": "短信服務模板",
                "tips1": "消息模板是指已經在第三方短信服務商定義模板後，需要在GS Cloud裡將短信服務商的模板變量和GS Cloud變量關聯",
                "tips2": "第三方短信服務商裡定義的模板編號，例如: 阿里雲 SMS_220626324",
                "tips3": "將第三方短信服務商模板裡的變量和GSCloud裡的變量配置關聯",
                "smsTemplateNumber": "短信模板編號",
                "smsVariableBinding": "短信變量綁定",
                "addSmsVariable": "新增",
                "deleteSmsVariable": "刪除"
            },
            "signRule": {
                "countersignRules": "會簽規則",
                "byNumber": "按數量",
                "byProportion": "按比例(%)",
                "customConditions": "自定義條件",
                "value": "編號",
                "text": "名稱",
                "conclusionName": "結論名稱",
                "conclusionValue": "結論值",
                "calculateType": "計算方式",
                "conditionValue": "條件值",
                "waitAllVotes": "等待全員辦結",
                "yes": "是",
                "no": "否",
                "notEmpty": "完成策略為會簽時，會簽規則不允許為空，請了解！",
                "pleaseSelect": "請首先選中一條審批項！",
                "maxConditionValue": "條件值最大值是100",
                "minConditionValue": "條件值最小值是0",
                "noConditional": "結論執行方式為全票或一票時不需要條件值",
                "set": "（已設置）",
                "ruleList": "規則列表",
                "approvalOptions": "審批選項",
                "clickCancel": "取消",
                "deleteRow": "重置",
                "clickOK": "確定",
            },
            "saveAsEdit": {
                "public": "公有",
                "private": "私有",
                "code": "編號",
                "name": "名稱",
                "nameNotEmpty": "流程名稱不能為空",
                "organizationNotEmpty": "維護組織不能為空",
                "organization": "組織",
                "basicAttributes": "基礎屬性",
                "processName": "流程名稱",
                "processKeyValue": "流程Key值",
                "maintenanceOrg": "維護組織",
                "accessLevel": "訪問級別",
                "saveAsCancel": "取消",
                "saveAsOK": "確定"
            },
            "release": {
                "release": "流程發布",
                "update": "流程更新",
                "applicantName": "申請人名稱",
                "applicantDepartment": "申請人部門",
                "procName": "流程名稱",
                "procVersion": "流程版本",
                "releaseType": "發布類型",
                "textDetail": "說明",
                "saveAsCancel": "取消",
                "saveAsOK": "確定"
            },
            "processVariables": {
                "string": "字符",
                "integer": "整型",
                "decimal": "小數",
                "boolean": "布爾",
                "constant": "常量",
                "expression": "表達式",
                "component": "構件",
                "name": "變量編號",
                "required": "必填",
                "documentation": "變量名稱",
                "basicType": "變量類型",
                "description": "描述",
                "tag": "初始值類型",
                "valueText": "初始值",
                "processVariables": "流程變量",
                "notSelected": "尚未選中流程變量！",
                "variableNumberEmpty": "變量編號不允許為空！",
                "variableNameEmpty": "變量名稱不允許為空！",
                "variableNumberNotStandard": "變量編號只能包含字母、數字和下劃線，且不能以數字開頭！",
                "tagNotEmpty": "初始值類型不允許為空！",
                "codeDuplicates": "流程變量編號不允許重複！",
                "alreadyExists": "新增的變量已存在！",
                "set": "（已設置）",
                "notSet": "（未設置）",
                "add": "新增",
                "delete": "刪除",
                "number": "序號",
                "clickCancel": "取消",
                "clickOK": "確定"
            },
            "participant": {
                "user": "用戶",
                "variable": "變量參與者",
                "position": "崗位",
                "role": "角色",
                "component": "構件參與者",
                "reportingLine": "匯報關係",
                "matrix": "矩陣",
                "activityExecutor": "歷史活動辦理人",
                "organization": "單位/部門",
                "all": "所有",
                "assign": "指派",
                "claim": "領用",
                "currentUser": "當前辦理人",
                "procInstCreator": "流程發起人",
                "participantSet": "參與者設置",
                "order": "序號",
                "type": "類型",
                "performerName": "名稱",
                "description": "描述",
                "condition": "啟用條件",
                "dataMovement1": "是否將默認辦理人數據移動到到備選辦理人？",
                "dataMovement2": "是否將備選辦理人數據移動到默認辦理人？",
                "participantSelection": "參與者選擇",
                "selectProcessVariables": "尚未選擇流程變量！",
                "selectVariableValueType": "尚未選擇變量值類型！",
                "selectRelation": "尚未選擇關係！",
                "selectPosition": "尚未選擇崗位！",
                "selectOrgType": "尚未選擇組織類型！",
                "orgFill": "尚未填寫組織！",
                "refOrgIdNotNull": "參照類型為組織時，參照組織欄位不能為空",
                "refUserIdNotNull": "參照類型為系統用戶/員工時，參照人欄位不能為空",
                "repDefConfigured": "該匯報關係已經進行過配置",
                "atLeastOneCondition": "條件欄位至少要存在一個",
                "dataFieldAliasNotNull": "數據欄位不能為空",
                "matrixConfigured": "該矩陣已經進行過配置",
                "selectPerformer": "尚未選擇參與者",
                "definitionDeleted": "該條匯報關係數據的定義已刪除，該條數據將刪除",
                "matrixDeleted": "該條矩陣數據的定義已刪除，該條數據將刪除",
                "selectParticipantInfo": "請先選中一條參與者信息！",
                "noRowSelected": "尚未選中行！",
                "selectDefaultHandler": "請先選中一條默認辦理人",
                "selectpotentialtHandler": "請先選中一條備選辦理人",
                "org": "組織：",
                "positionType1": "崗位類型：通用崗位，組織：",
                "positionType2": "崗位類型：通用崗位",
                "positionType3": "崗位類型：組織崗位",
                "comp": "構件：",
                "parameters:": "，參數：{",
                "referencePerson:": "參照人：",
                "referenceOrganization:": "參照組織：",
                "condition1": "條件1：",
                "condition2": "條件2：",
                "condition3": "條件3：",
                "data": "數據：",
                "set": "（已設置）",
                "notSet": "（未設置）",
                "allocationPolicy": "分配策略",
                "operator": "指派操作人",
                "multiSelect": "允許多選",
                "necessary": "只有一個待選用戶時，仍需手工選擇",
                "notifyRecipient": "知會接收人",
                "defaultHandler": "默認辦理人",
                "new": "新增",
                "editPerformer": "編輯",
                "removePerformer": "移除",
                "clearPerformer": "清空",
                "moveUp": "上移",
                "moveDown": "下移",
                "alternativeHandler": "備選辦理人",
                "isAllScope": "指定參與人時不限範圍，從全員用戶中選擇",
                "clickCancel": "取消",
                "clickOK": "確定",
                "alternativeScope": "備選範圍",
                "orgId": "組織ID",
                "includeChildren": "包含下級",
                "conditon": "啟用條件",
                "currentUnit": "本組織",
                "currentDepartment": "本部門",
                "variableOrganization": "變量組織"
            },
            "activityExecutor": {
                "name": "名稱",
                "eventHandler": ">活動辦理人",
                "nodeName": "節點名稱",
                "enablingConditions": "啟用條件",
                "activityList": "活動列表",
                "clickCancel": "取消",
                "clickOK": "確定"
            },
            "componentPerformer": {
                "componentMethod": "當前構件方法參數不一致，請更新！",
                "methodNotExist": "當前構件已不存在此方法，請更新！",
                "code": "編號",
                "name": "名稱",
                "description": "描述",
                "valueText": "參數值",
                "help": "幫助",
                "errorObtaining": "獲取解析構件出錯",
                "componentSelection": "構件選擇",
                "metadataNotExist": "幫助元數據不存在！",
                "serverSideNotFound": "服務器端未找到幫助元數據，請檢查元數據是否已經部署到環境中",
                "componentName": "構件名稱",
                "componentSelect": "構件選擇",
                "parameterList": "參數列表"
            },
            "matrixPerformer": {
                "code": "編號",
                "name": "名稱",
                "help": "幫助",
                "multivalue": "多值",
                "enumSelection": "枚舉選擇",
                "refMatrixTable": "引用矩陣表",
                "matrixTable": "矩陣表",
                "curDataFieldValue": "結果列",
                "conditionFields": "條件字段",
                "condition": "啟用條件",
                "key": "鍵",
                "value": "值",
                "notSelectEnum": "尚未選中枚舉值",
                "cancel": "取消",
                "onConfirm": "確定",
                "lineNumber": "序號"
            },
            "performerOptions": {
                "leave": "向下流轉",
                "throwException": "異常提示",
                "sys": "用戶ID",
                "administrative_staff": "員工ID",
                "procInstCreator": "流程發起人",
                "preActExecutors": "上一節點辦理人",
                "allPassExecutors": "所有已辦理人員",
                "performerOptions": "參與者選項",
                "exclusionNotAllowed": "所有已辦理人員已設置自動審批，上個節點已辦理人員默認不允許排除！",
                "approvalNotAllowed": "【分配策略】為【領用】時，不允許設置自動審批，請了解！",
                "approvalNotAllowedAsSet": "所有已辦理人員已設置不允許審批，所以上個節點已辦理人員默認不允許自動審批！",
                "allocationStrategyIsCollect": "【分配策略】為【領用】時，不允許設置自動審批，請了解！",
                "set": "（已設置）",
                "advancedOptions": "參與者高級選項",
                "historicFirst": "再次進入節點時，辦理人是節點的已辦人員",
                "noPerformerStrategy": "辦理人為空策略：",
                "excludeProcInstCreator": "排除辦理人選項",
                "defaultNotParticipate": "流程發起人默認不參與審批",
                "excludePreActExecutors": "上個節點已辦理人員默認不參與審批",
                "excludeAllPassExecutors": "所有已辦理人員默認不參與審批",
                "excludeExprPerformer": "流程變量：",
                "variableOrgTypes": "變量值類型：",
                "automaticApprovalOptions": "自動審批選項",
                "autoProcInstCreator": "流程發起人默認自動審批通過",
                "autoPreActExecutors": "上一節點辦理人員默認自動審批通過",
                "autoAllPassExecutors": "所有已辦理人員默認自動審批通過",
                "cancel": "取消",
                "clickOK": "確定"
            },
            "positionPerformer": {
                "orgPosition": "組織岗",
                "generalPosition": "通用岗",
                "sysPositions": "系統岗位",
                "positionType": "岗位類型",
                "role": "角色",
                "position": "岗位",
                "sysType": "組織類型",
                "placeholder": "請選擇",
                "orgId": "組織ID",
                "condition": "啟用條件",
                "clickCancel": "取消",
                "clickOK": "確定"
            },
            "reportingLine": {
                "higherSuperior": "間接上級",
                "directSuperior": "直接上級",
                "code": "編號",
                "name": "名稱",
                "dept": "組織",
                "sysUser": "系統用戶",
                "employee": "員工",
                "businessFields": "業務字段",
                "defName": "匯報定義",
                "dimension": "匯報級別",
                "curReportingRefer": "參照類型",
                "usersName": "參照人",
                "refOrgId": "參照組織",
                "condition": "啟用條件",
                "definitionOfReport": "匯報關係定義"
            },
            "userPerformer": {
                "regularUser": "固定使用者",
                "variablePart": "變數參與者",
                "sys": "系統使用者",
                "administrative_organization": "員工",
                "cantUseContext": "行政人員類型不能使用此上下文變數",
                "user": "使用者",
                "variable": "變數",
                "condition": "啟用條件"
            },
            "variablePerformer": {
                "sys": "使用者ID",
                "administrative_staff": "員工ID",
                "oneself": "本人",
                "administrative_organization": "部門ID",
                "cantUseContext": "行政人員類型不能使用此上下文變數",
                "processVariables": "流程變數",
                "variableOrgTypes": "變數值類型",
                "relationShipType": "關係",
                "condition": "啟用條件",
            },
            "orgPotentialOwner": {
                "optionSettings": "選項設置",
                "global": "全體成員",
                "currentUnit": "本單位",
                "currentDepartment": "本部門",
                "addSignBehind": "加簽",
                "addSignFront": "徵詢",
                "transfer": "移交",
                "notify": "知會",
                "set": "（已設置）",
                "notSet": "（未設置）",
                "option": "選項",
                "enable": "是否啟用",
                "range": "範圍",
                "OrgId": "組織ID",
                "variableOrganization": "變數組織",
                "includeChildren": "包含下級",
                "clickCancel": "取消",
                "clickOK": "確定",
                "limit": "限定人員範圍",
                "turnOffPrompt": "請關閉限定人員範圍選項"
            },
            "note": {
                "placeholder": "請輸入流程變更記錄",
                "clickCancel": "取消",
                "clickOK": "確定"
            },
            "MessageNotice": {
                "notify": "消息通知",
                "subject": "消息主題",
                "content": "消息內容",
                "sendTime": "發送時機",
                "sendType": "發送方式",
                "receiverText": "消息接收人",
                "procInstCreator": "流程發起人，",
                "workItemParticipant": "任務接收人，",
                "messageSet": "消息設置",
                "selectedRow": "尚未選中消息通知！",
                "noCopy": "沒有待複製的消息通知屬性！",
                "batchCopy": "批量複製",
                "set": "（已設置）",
                "notSet": "（未設置）",
                "add": "新增",
                "edit": "編輯",
                "delete": "刪除",
                "lineNumber": "序號",
                "clickCancel": "取消",
                "clickOK": "確定",
                "messContent": "{\"expr\":\"'\u60A8\u6709\u4E00\u689D\u6D88\u606F\u901A\u77E5\u3002'\",\"sexpr\":\"\"}",
                "procComplete": "流程完成",
                "procAborted": "流程終止",
                "procRollBack": "流程驳回",
                "workCreated": "任務創建",
                "actComplete": "活動完成",
                "actAborted": "活動終止",
                "email": "郵件",
                "sms": "短信",
                "cloudplus": "雲",
                "processParticipant": "流程參與人",
                "variableParticipant": "變數參與者",
                "userParticipant": "指定使用者",
                "positionParticipant": "崗位",
                "activityExecutorParticipant": "歷史辦理人",
                "sys": "系統使用者",
                "administrative_organization": "員工",
                "name": "名稱",
                "noTargetNode": "尚未選中節點！",
                "noMessageNotifyAttribute!": "沒有消息通知屬性！"
            },
            "messageNoticeEdit": {
                "procInstCreator": "流程發起人",
                "activityExecutorParticipant": "歷史辦理人",
                "workItemParticipant": "任務辦理人",
                "sys": "系統使用者",
                "administrative_organization": "員工",
                "processParticipant": "流程參與人",
                "workItemReceiveParticipant": "任務接收人",
                "variableParticipant": "變數參與者",
                "userParticipant": "指定使用者",
                "positionParticipant": "崗位",
                "sendType": "發送方式不允許為空",
                "smsMessageTemplate": "消息渠道啟用短信時需設置消息模板",
                "smsMessageTemplateCode": "短信模板編號不允許為空",
                "sendTime": "發送時機不允許為空",
                "subject": "消息主題不允許為空",
                "content": "消息內容不允許為空",
                "receivers": "接收人不允許為空！",
                "processParticipantNotNull": "流程參與人不允許為空",
                "activityDefIdNotNull": "流程參與人為歷史辦理人時，辦理節點不允許為空",
                "variableParticipantNotNull": "變數參與者不允許為空",
                "orgType": "變數參與者組織類型不允許為空",
                "userIds": "指定使用者不允許為空",
                "positionId": "崗位不允許為空",
                "activityList": "活動列表",
                "position": "崗位",
                "optionalNodes": "可選節點",
                "targetNodeList": "目標節點列表",
                "placeholder": "請選擇目標節點",
                "optionalAttribute": "可選屬性",
                "lineNumber": "序號",
                "clickCancel": "取消",
                "clickOK": "確定",
                "messSendType": "消息渠道",
                "messSubject": "消息主題",
                "enable": "啟用表達式",
                "messContent": "消息內容",
                "recipient": "接收人",
                "addReceiver": "添加",
                "organization": "組織：",
                "posi": "崗位："
            },
            "jumpScope": {
                "targetNodeOptions": "目標節點選項",
                "name": "名稱",
                "outConnectNode": "流程圖連線節點",
                "global": "流程內所有節點",
                "afterNodes": "所有後繼節點",
                "specifiedSet": "流程圖連線節點+附加節點",
                "firstNode": "條件為true的連線節點，當有多條時默認選中首條",
                "nullNode": "默認為空，每次都手動選擇",
                "specifyNode": "指定默認節點",
                "noSetTargetNode": "尚未設置目標節點選項，請了解！",
                "noSetSpecifyNode": "尚未指定默認節點，請了解！",
                "selectedRow": "請首先選中一條選項！",
                "optionalNodes": "可選節點",
                "listOfAdditional": "附加節點列表",
                "pleaseSelect1": "請選擇附加節點",
                "defaultNode": "默認節點",
                "pleaseSelect2": "請選擇默認節點",
                "defaultNodeList": "默認節點列表",
                "clickCancel": "取消",
                "clickOK": "確定",
                "set": "（已設置）"
            },
            "imageSet": {
                "imageSet": "影像設置",
                "onlyView": "僅可查看",
                "edit": "編輯",
                "reScanStart": "發起重掃",
                "reScanComplete": "重掃完成",
                "mutualExclusion": "【僅可查看】選項與其他選項互斥，請了解！",
                "set": "（已設置）",
                "notSet": "（未設置）",
                "imageOperation": "影像操作權限",
                "clickCancel": "取消",
                "clickOK": "確定"
            },
            "extendProperty": {
                "extendProperty": "擴展屬性",
                "true": "是",
                "false": "否",
                "set": "（已設置）",
                "notSet": "（未設置）",
                "illustrate": "說明",
                "placeholder": "請選擇",
                "cancel": "取消",
                "clickOK": "確定"
            },
            "expressionEditor": {
                "expressionEditor": "條件編輯",
                "notSet": "（未設置）",
                "clickCancel": "取消",
                "changeType": "切換類型",
                "clickOK": "確定"
            },
            "executeForms": {
                "executeForms": "表單定義",
                "parameters": "參數【",
                "typeAsvariable": "】類型為變量，但在流程變量裡不存在",
                "parameterSettings": "參數設置",
                "formDefinitionList": "表單定義列表",
                "notSet": "（未設置）",
                "default": "流程默認表單",
                "processEmbeddedForm": "流程嵌表單",
                "formEmbedProcess": "表單嵌流程",
                "clickCancel": "取消",
                "clickOK": "確定",
                "noForm": "暫無表單格式",
                "form": "選擇表單",
                "placeholder": "請選擇",
                "parametersSet": "參數",
                "key": "變量編號",
                "name": "變量名稱",
                "lineNumber": "序號",
                "code": "編號",
                "tag": "類型",
                "value": "參數值",
                "variable": "變量",
                "constant": "常量",
                "expression": "表達式",
                "method": "方法標識",
                "methodName": "方法名稱",
                "description": "描述",
                "workFlowAction": "流轉方向",
                "formOperations": "表單操作",
                "executionTime": "執行時機",
                "sortOrder": "執行順序",
                "methodParameters": "參數",
                "selectFormActionConfig": "尚未選中表單操作配置！",
                "selectFormAction": "尚未選中表單操作！",
                "editParam": "設置",
                "formEvents": "表單事件",
                "buttonName": "按鈕名稱",
                "enable": "是否可用",
                "disabled": "是否禁用",
                "hidden": "是否隱藏",
                "fieldName": "字段名稱",
                "editable": "是否可寫",
                "readonly": "是否只讀",
                "required": "是否必填",
                "saveFail": "保存配置失敗，請聯繫管理員查看原因！",
                "checkedRows": "尚未選擇按鈕集合",
                "checkeds": "尚未選擇字段集合",
                "enableBtn": "可用",
                "disabledBtn": "禁用",
                "hiddenBtn": "隱藏",
                "btnBatchReset": "重置",
                "editableBtn": "可寫",
                "readonlyBtn": "只讀",
                "requiredBtn": "必填",
                "add": "新增",
                "delete": "刪除",
                "other": "其他",
                "formBtn": "表單按鈕",
                "formfield": "表單字段",
                "apptag": "單據類型",
                "functionMenu": "功能菜單",
                "formFormat": "表單格式",
                "docFormatNumber": "單據格式編號",
                "docFormatName": "單據格式名稱",
                "selectedRow": "尚未選擇表單定義！",
                "set": "（已設置）"
            },
            "eventDefinition": {
                "eventDefinition": "信號定義",
                "pass": "正向",
                "back": "反向",
                "abort": "終止",
                "signalRef": "信號編號",
                "name": "信號名稱",
                "triggerAction": "流轉方向",
                "selectedRow": "尚未選中一條觸發事件！",
                "dataLength": "至少需要一個信號定義，請了解！",
                "codeNotNull": "信號編號不允許為空！",
                "nameNotNull": "信號名稱不允許為空！",
                "codeNotNumber": "信號編號不允許為純數字！",
                "codeRepeat": "信號編號不允許重複！",
                "set": "（已設置）",
                "notSet": "（未設置）",
                "add": "新增",
                "delete": "刪除",
                "clickCancel": "取消",
                "clickOK": "確定"
            },
            "entryFormEditor": {
                "flowForm": "流程分類",
                "code": "編號",
                "name": "名稱",
                "base": "類型",
                "foundation": "基礎",
                "extend": "擴展",
                "selectedRow": "尚未選擇流程分類",
                "absent": "流程分類已經不存在",
                "lineNumber": "序號",
                "clickCancel": "取消",
                "clickOK": "重新綁定"
            },
            "editComponentParameter": {
                "code": "編號",
                "name": "名稱",
                "required": "必填",
                "yes": "是",
                "no": "否",
                "value": "參數值",
                "openComponentFail": "獲取解析構件出錯",
                "componentSelection": "構件選擇",
                "curComponent": "請選擇流程構件",
                "executionTime": "請選擇執行時機",
                "para": "參數",
                "paraRequired": "】必填",
                "execuTime": "執行時機",
                "parameterList": "參數列表",
                "clickCancel": "取消",
                "clickOK": "確定"
            },
            "customizeAction": {
                "customizeAction": "自定義動作",
                "app": "移動",
                "web": "web",
                "all": "web,移動",
                "name": "名稱",
                "code": "編號",
                "terminalType": "適用終端",
                "isAll": "是否默認",
                "yes": "是",
                "no": "否",
                "paramName": "編號",
                "valueText": "名稱",
                "value": "參數值",
                "addActions": "自定義動作選擇",
                "actionExisted": "新增的自定義動作已經存在！",
                "selectedRow": "請首先選中一條選項！",
                "set": "（已設置）",
                "notSet": "（未設置）",
                "add": "新增",
                "delete": "刪除",
                "parameterList": "參數列表",
                "clickCancel": "取消",
                "clickOK": "確定"
            },
            "checkCondition": {
                "zhChs": "簡體中文",
                "zhCht": "繁體中文",
                "en": "英文",
                "checkCondition": "活動校驗規則",
                "set": "（已設置）",
                "notSet": "（未設置）",
                "nodeEntry": "節點進入",
                "activityBeforeStarted": "節點進入條件",
                "enterErrorTips": "進入條件不匹配提示語",
                "activityBeforeCompleted": "節點離開",
                "activityBeforeCompletedValue": "節點離開條件",
                "leaveErrorTips": "離開條件不匹配提示語",
                "clickCancel": "取消",
                "clickOK": "確定"
            },
            "batchSet": {
                "targetNode": "目標節點",
                "addSignFront": "徵詢",
                "addSignBehind": "加簽",
                "transfer": "移交",
                "notify": "知會",
                "backWardRule": "駁回規則",
                "name": "名稱"
            },
            "subProcess": {
                "subProcessSet": "子流程設置",
                "specified": "指定子流程",
                "dynamic": "動態子流程",
                "inheritParent": "與父流程相同",
                "autoCreation": "自动生成下游單據",
                "variablesExpression": "變量表達式",
                "rteNull": "請選中一條生單流程",
                "orderProcess": "生單流程",
                "clickOk": "確定",
                "clickCancel": "取消",
                "inheritBizDataId": "當子流程與父流程單據不一致時，請設置子流程單據內碼！",
                "set": "（已設置）",
                "notSet": "（未設置）",
                "radioGroupProcessType": "子流程類型",
                "flowForm": "流程分類",
                "processDef": "流程定義",
                "radioGroupBillSource": "單據來源",
                "autoCreationProcess": "生單流程",
                "bizDataId": "單據內碼",
                "setOption": "設置選項",
                "SameParentProcess": "與父流程同一張業務單據",
                "setBizDataId": "設置單據內碼",
                "subProcessOpt": "子流程選項"
            },
            "backwardRule": {
                "reEdit": "駁回活動節點已不存在，請重新編輯",
                "backwardRule": "駁回規則",
                "initialActityId": "開始節點",
                "precursorActivityId": "前置節點",
                "empty": "空",
                "name": "名稱",
                "id": "標識",
                "sequence": "順序流轉",
                "backToMe": "返回我",
                "backToCurrentNode": "返回本節點",
                "popover": "1.順序流轉:按照流轉線順序進行流轉; 2.返回我:完成策略為搶佔：只給駁回人創建任務,完成策略為會簽：駁回人與未審批人收到新任務，已審批人員自動審批通過; 3.返回本節點:實際效果受“再次進入節點時，辦理人是否是節點已辦人員影響”選項的影響",
                "selectAbleClick": "會簽策略下，不允許動態選擇駁回目標節點!",
                "dictPicked": "“駁回至空”選項請搭配“允許動態選擇駁回目標節點”使用",
                "set": "（已設置）",
                "notSet": "（未設置）",
                "rejectedTo:": "駁回至：",
                "backScope": "駁回範圍",
                "defaultPrompt": "默認選取全部歷史駁回節點",
                "title": "活動列表",
                "dynamicSelection": "允許修改返回設置",
                "resubmitEffectOptions": "返回設置",
                "popover1": "1.順序流轉:按照流轉線順序進行流轉; ",
                "popover2": "2.返回我:完成策略為搶佔：只給駁回人創建任務,完成策略為會簽：駁回人與未審批人收到新任務，已審批人員自動審批通過;",
                "popover3": "3.返回本節點:實際效果受“再次進入節點時，辦理人是否是節點已辦人員影響”選項的影響",
                "allowModification": "允許修改返回設置",
                "clickCancel": "取消",
                "clickOk": "確定"
            },
            "assignStrategy": {
                "all": "所有",
                "assign": "指派",
                "claim": "領用",
                "currentUser": "當前辦理人",
                "procInstCreator": "流程發起人",
                "assignStrategy": "分配策略",
                "option": "選項",
                "assignmentRules": "指派規則",
                "operator": "指派操作人",
                "multiSelect": "允許選擇多個待選用戶",
                "necessary": "只有一個待選用戶時，仍需手工選擇",
                "clickCancel": "取消",
                "clickOK": "確定"
            },
            "assignScope": {
                "assignScopeList": "指派節點列表",
                "required": "必填",
                "yes": "是",
                "no": "否",
                "condition": "條件",
                "add": "增加",
                "delete": "刪除",
                "name": "名稱",
                "deleteRow": "請首先選中壹條選項！",
                "curActivity": "尚未選中行",
                "set": "（已設置）",
                "notSet": "（未設置）",
                "nodeList": "節點列表",
                "moveUp": "上移",
                "moveDown": "下移",
                "clickCancel": "取消",
                "clickOK": "確定"
            },
            "assignPerformer": {
                "currentUser": "當前辦理人",
                "procInstCreator": "流程發起人",
                "global": "全員",
                "currentUnit": "本單位",
                "currentDepartment": "本部門",
                "assignPerformer": "指派規則",
                "set": "（已設置）",
                "operator": "指派操作人",
                "multiSelect": "允許選擇多個待選用戶",
                "necessary": "只有一個待選用戶時，仍需手工選擇",
                "clickCancel": "取消",
                "clickOK": "確定"
            },
            "approvelItems": {
                "approvalOptions": "審批選項",
                "forward": "正向",
                "backward": "反向",
                "abort": "終止",
                "value": "編號",
                "text": "名稱",
                "workFlowAction": "流轉方向",
                "isDefault": "默認",
                "no": "否",
                "yes": "是",
                "commentNecessary": "意見必填",
                "attachmentNecessary": "附件上傳",
                "certification": "數字簽名",
                "signatureNecessary": "手寫簽名必填",
                "defaultComment": "默認意見",
                "zh-CHS": "中文簡體",
                "zh-CHT": "中文繁體",
                "en": "英文",
                "workFlowActionNotNull": "審批項流轉方向不允許為空，請修改！",
                "deleteRow": "請首先選中壹條選項！",
                "set": "（已設置）",
                "notSet": "（未設置）",
                "add": "新增",
                "delete": "刪除",
                "clickCancel": "取消",
                "clickOK": "確定",
                "approvalAction": "審批動作",
                "lineNumber": "序號"
            },
            "approvalPivot": {
                "remind": "文字提示",
                "type": "類型",
                "condition": "條件",
                "title": "顯示名稱",
                "description": "詳細說明",
                "approvalPivot": "審批要點",
                "selectedRow": "尚未選中審批要點！",
                "configTitle": "尚未填寫顯示標題！",
                "set": "（已設置）",
                "notSet": "（未設置）",
                "enable": "是否啟用",
                "expand": "是否展開",
                "showTitle": "顯示標題",
                "list": "列表",
                "add": "新增",
                "delete": "刪除",
                "clickCancel": "取消",
                "clickOK": "確定"
            },
            "anonymousSet": {
                "anonymousOpt": "匿名選項",
                "approver": "審批人",
                "set": "（已設置）",
                "notSet": "（未設置）",
                "anonymousSet": "匿名設置",
                "isAnonymity": "是否啟用",
                "anonymous": "匿名代稱",
                "clickCancel": "取消",
                "clickOK": "確定"
            },
            "activityList": {
                "name": "名稱",
                "checkeds": "尚未選擇活動節點",
                "lineNumber": "序號",
                "clickCancel": "取消",
                "clickOK": "確定"
            },
            "activityComponent": {
                "component": "構件",
                "method": "構件方法",
                "inconsistentParameters": "參數不壹致，請檢查",
                "longerExists": "構件已不存在此構件方法",
                "absent": "取消",
                "pleaseCheck": "，請檢查",
                "edit": "編輯",
                "deleteRow": "刪除",
                "executionTime": "執行時機",
                "cmpName": "構件名稱",
                "metadataId": "構件ID",
                "methodCode": "構件方法",
                "isForCompensation": "補償操作",
                "yes": "是",
                "no": "否",
                "operate": "操作",
                "code": "編號",
                "name": "名稱",
                "value": "參數值",
                "editComponent": "編輯構件",
                "confirmDelete": "確認是否刪除構件？",
                "curComponent": "尚未選中構件！",
                "newComponent": "新建構件",
                "sameCmp": "存在相同的流程構件",
                "cmpMethod": "構件方法：",
                "executionTimeNotNull": "構件執行時機不允許為空！",
                "param": "的參數",
                "required": "必填",
                "set": "（已設置）",
                "notSet": "（未設置）",
                "PROCESSINSTANCE_STARTED": "流程啟動",
                "PROCESSINSTANCE_SUSPENDED": "流程挂起",
                "PROCESSINSTANCE_RESUMED": "流程恢復",
                "PROCESSINSTANCE_COMPLETED": "流程完成",
                "PROCESSINSTANCE_ABORTED": "流程終止",
                "PROCESSINSTANCE_CANCELED": "流程取消",
                "PROCESSINSTANCE_REACTIVATED": "流程復活",
                "PROCESSINSTANCE_ROLLBACK": "流程驳回",
                "PROCESSINSTANCE_RESUBMIT": "重新提交",
                "ACTIVITY_AND_PARTICIPANT_UPDATED": "環節辦理人變更",
                "PROCESSINSTANCE_ABORTED_BY_ADMIN": "管理員終止",
                "PROCESSINSTANCE_BEFORE_START": "流程啟動前",
                "WORKITEM_BEFORE_COMPLETE": "任務完成前",
                "WORKITEM_AFTER_COMPLETE": "任務完成後",
                "LOADDATA": "獲取數據",
                "ACTIVITY_STARTED": "活動啟動",
                "ACTIVITY_COMPLETED": "活動完成",
                "ACTIVITY_ABORTED": "活動終止",
                "WORKITEM_CREATED": "工作項創建",
                "WORKITEM_COMPLETED": "工作項完成",
                "WORKITEM_SUSPENDED": "工作項挂起",
                "WORKITEM_RESUMED": "工作項恢復",
                "WORKITEM_ABORTED": "工作項終止",
                "WORKITEM_RETRIEVED": "工作項取回",
                "WORKITEM_CLAIMED": "工作項領用",
                "WORKITEM_UNCLAIMED": "工作項反領用",
                "ACTIVITY_ASSIGNMENT": "任務分配前",
                "deleteNotAllowed": "取數構件不允許刪除，請了解！",
                "tips": "提示：",
                "prefabricated": "已經預製外部流程構件，此處只保留取數構件",
                "add": "新增",
                "moveUp": "上移",
                "moveDown": "下移",
                "clickCancel": "取消",
                "clickOK": "確定"
            }
        }
    }
};

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var ɵ0$3 = WF_PROCESS_EDITOR_LANG_RESOURCES;
var WfProcessEditorComponent = /** @class */ (function () {
    function WfProcessEditorComponent(uiState, viewModel, service, loadService, notify, message, activity, injector, modalService, resolver, eventBus, cdr, localeId, resources, localePipe) {
        var _this = this;
        this.uiState = uiState;
        this.viewModel = viewModel;
        this.service = service;
        this.loadService = loadService;
        this.notify = notify;
        this.message = message;
        this.activity = activity;
        this.injector = injector;
        this.modalService = modalService;
        this.resolver = resolver;
        this.eventBus = eventBus;
        this.cdr = cdr;
        this.localeId = localeId;
        this.resources = resources;
        this.localePipe = localePipe;
        this.flag = true;
        this.cls = 'farris-main-area flex-column';
        this.action = 'edit';
        this.mode = 'general';
        this.procType = "wf";
        this.close = new EventEmitter();
        this.errorList = [];
        this.tabTypeList = [
            {
                id: 'processWarning',
                type: 'processWarning',
                title: this.localePipe.instant("processEditor.tip"),
                iconCls: 'f-icon-default',
                iconStyle: 'color:#f49730;'
            }
        ];
        this.panelWidth = 330;
        this.propertyPanelResizable = true;
        this.rightPanelWidth = 330; // 右侧面板宽度
        // localeId: string = "zh-CHS";
        /**
         * 界面是否发生变化标志，修改属性、移动节点等均会将此值设为true
         */
        this.changedFlag = false;
        this.showModelButton = false;
        this.localePipe = this.localePipe || new WfLocalePipe(localeId, resources);
        this.cdr = this.cdr || this.injector.get(ChangeDetectorRef, null);
        this.verifySer = this.injector.get(VerifyDetailService);
        this.localeId = this.injector.get(LOCALE_ID, null) || this.localeId;
        WfValidatorAdapter.localePipe = this.localePipe;
        forkJoin(this.uiState.getEnableAdminOrgAut(), this.uiState.getEnableFlowFormAut()).subscribe((/**
         * @param {?} re
         * @return {?}
         */
        function (re) {
            _this.uiState.enableAdminOrgAut = re[0];
            _this.uiState.enableFlowFormAut = re[1];
            if (!_this.uiState.enableAdminOrgAut) {
                _this.uiState.getAdministratorInfo();
            }
        }));
    }
    Object.defineProperty(WfProcessEditorComponent.prototype, "time", {
        get: /**
         * @return {?}
         */
        function () {
            return this._time;
        },
        set: /**
         * @param {?} t
         * @return {?}
         */
        function (t) {
            this._time = t;
            this.uiState.time = t;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(WfProcessEditorComponent.prototype, "scene", {
        get: /**
         * @return {?}
         */
        function () {
            return this.uiState.scene;
        },
        set: /**
         * @param {?} v
         * @return {?}
         */
        function (v) {
            this.uiState.scene = v;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    WfProcessEditorComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.procNameTitle = this.processInfo ? this.processInfo.processName : this.rtProcessInfo.procName;
        if (this.rtProcessInfo && this.rtProcessInfo.rtProcDefId) {
            this.uiState.procDefId = this.rtProcessInfo.rtProcDefId;
        }
        this.addEventBusListener();
        this.uiState.initUIState();
        this.showLoading();
        this.addPropertyChangedHandler();
        // 获取消息列表
        this.uiState.getMessageChannels();
        focus();
        document.body.addEventListener('keydown', (/**
         * @param {?} n
         * @return {?}
         */
        function (n) {
            if (!_this.showModelButton && n.shiftKey && 'Slash' === n.code) {
                _this.showModelButton = true;
                _this.notify.success(_this.localePipe.transform("processEditor.showButton"));
                _this.viewProcModel();
            }
        }));
        this.cdr && this.cdr.detectChanges();
        this.createEditorUi();
    };
    /**
     * @return {?}
     */
    WfProcessEditorComponent.prototype.createEditorUi = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.service.getGeneralConfig().subscribe((/**
         * @param {?} generalConfig
         * @return {?}
         */
        function (generalConfig) {
            /** @type {?} */
            var processCategoryId = _this._time === ProcessTime.rt ? _this.rtProcessInfo.flowFormId : _this.processInfo.flowFormId;
            _this.viewModel.getProcessCategory(processCategoryId).subscribe((/**
             * @param {?} procCategory
             * @return {?}
             */
            function (procCategory) {
                /** @type {?} */
                var bizCategoryId = _this._time === ProcessTime.dt ? procCategory.businessObjectId : undefined;
                _this.service.getFormFormat(bizCategoryId).pipe(switchMap((/**
                 * @param {?} formFormats
                 * @return {?}
                 */
                function (formFormats) {
                    _this.cdr && _this.cdr.detectChanges();
                    _this.editorUi = new WfEditorUi(_this._time, _this.action, _this.editorUiContainerER.nativeElement, _this.injector, _this.modalService, _this.resolver);
                    _this.editorUi.multiLangEnabled = true;
                    _this.editorUi.langCode = _this.localeId;
                    _this.editorUi.bizCategoryId = bizCategoryId;
                    _this.editorUi.mode = _this.mode;
                    _this.editorUi.scene = _this.uiState.scene;
                    _this.editorUi.procType = _this.procType;
                    _this.editorUi.generalConfig = generalConfig;
                    _this.editorUi.formFormats = formFormats;
                    return of$1({});
                })))
                    // 2023-5-30 为了解决网络较差场景下的加载问题修改了加载顺序
                    .pipe(delay(200))
                    .subscribe((/**
                 * @return {?}
                 */
                function () {
                    _this.openProcContent();
                }));
            }));
        }));
    };
    /**
     * @param {?} editorUi
     * @return {?}
     */
    WfProcessEditorComponent.prototype.addEditorUiListeners = /**
     * @param {?} editorUi
     * @return {?}
     */
    function (editorUi) {
        var _this = this;
        editorUi.addListener(PmfEvents.ShowProperty, (/**
         * @param {?} sender
         * @param {?} evt
         * @return {?}
         */
        function (sender, evt) {
            /** @type {?} */
            var cells = evt.getProperty("cells");
            _this.viewModel.setProperty(_this.editorUi.getFarrisPropConfig(cells));
        }));
        // 工具箱节点拖动至画布后更新
        editorUi.graph.addListener(PmfEvents.CellsInserted, (/**
         * @param {?} sender
         * @param {?} evt
         * @return {?}
         */
        function (sender, evt) {
            _this.uiState.getUserActList(_this.editorUi.getActivities());
            _this.uiState.getNotifyEventList(_this.editorUi.getNotifyEvents());
            _this.uiState.getEndEventList(_this.editorUi.getEndEvents());
        }));
        // 删除节点时触发更新
        editorUi.graph.addListener(mxEvent.CELLS_REMOVED, (/**
         * @return {?}
         */
        function () {
            _this.uiState.getUserActList(_this.editorUi.getActivities());
            _this.uiState.getNotifyEventList(_this.editorUi.getNotifyEvents());
            _this.uiState.getEndEventList(_this.editorUi.getEndEvents());
        }));
    };
    /**
     * 添加事件总线监听
     */
    /**
     * 添加事件总线监听
     * @private
     * @return {?}
     */
    WfProcessEditorComponent.prototype.addEventBusListener = /**
     * 添加事件总线监听
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        this.eventBus.on(EventBusKeys.batchCopyProperty, (/**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            if (data) {
                _this.editorUi.batchCopyProperty(data);
            }
        }));
        this.eventBus.on(EventBusKeys.batchSetProperty, (/**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            if (data) {
                _this.editorUi.batchSetProperty(data);
            }
        }));
    };
    /**
     * @private
     * @return {?}
     */
    WfProcessEditorComponent.prototype.addPropertyChangedHandler = /**
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        this.propertyPanel.propertyChanged.subscribe((/**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            _this.updateChangeProperty(data);
        }));
        this.propertyPanel.submitModal.subscribe((/**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            _this.updateChangeProperty(data.changeObject, data.parameters);
        }));
        return false; // 防止冒泡
    };
    /**
     * 更新属性
     */
    /**
     * 更新属性
     * @private
     * @param {?} data
     * @param {?=} parameters
     * @return {?}
     */
    WfProcessEditorComponent.prototype.updateChangeProperty = /**
     * 更新属性
     * @private
     * @param {?} data
     * @param {?=} parameters
     * @return {?}
     */
    function (data, parameters) {
        var _this = this;
        if (parameters === void 0) { parameters = null; }
        // 更新界面变更状态
        this.changedFlag = false;
        data.Id = this.uiState.propertyData.Id;
        if (parameters) {
            data.parameters = parameters;
        }
        switch (data.propertyID) {
            case ProcessPropertyKeys.EntryForm:
                this.bindEntryFormInfo(data);
                break;
            case UserActivityPropertyKeys.ApprovalItems:
                this.editorUi.updateProperty(data);
                this.activity.buildCounterSignVariables(data.propertyValue);
                break;
            case UserActivityPropertyKeys.CompleteStrategy:
                this.beforeCompleteStrategyChange(data).subscribe((/**
                 * @param {?} b
                 * @return {?}
                 */
                function (b) {
                    if (b) {
                        _this.editorUi.updateProperty(data);
                        _this.completeStrategyChanged(data.propertyValue);
                    }
                    _this.viewModel.setProperty(_this.editorUi.refreshProperty(data));
                }));
                break;
            // todo：多个活动具有同名属性时，如何更合理定义PropertyKey？
            // case UserActivityPropertyKeys.otherAssignNodes:
            // case StartActivityPropertyKeys.otherAssignNodes:
            //   if (data.propertyValue) {
            //     this.editorUi.updateProperty(data);
            //     this.OtherAssignNodesChanged(data);
            //   } else {
            //     this.editorUi.updateProperty(data);
            //   }
            //   break;
            case UserActivityPropertyKeys.SignRule:
                this.editorUi.updateProperty(data);
                break;
            // todo：多个活动具有同名属性时，如何更合理定义PropertyKey？
            case ProcessPropertyKeys.messageNotice: // 消息通知
            case UserActivityPropertyKeys.messageNotice: // 消息通知
            case MessageActivityPropertyKeys.messageNotice: // 消息通知
            case NotifyActivityPropertyKeys.messageNotice: // 消息通知
                if (data.propertyValue.isBatchCopy) { // 是否是消息通知属性批量复制
                    this.editorUi.batchCopyProperty(data);
                    break;
                }
                this.editorUi.updateProperty(data);
                break;
            case ProcessPropertyKeys.startMode:
                this.updateStartMode(data);
                break;
            default:
                this.editorUi.updateProperty(data);
                break;
        }
        this.uiState.getUserActList(this.editorUi.getActivities());
        this.uiState.getEndEventList(this.editorUi.getEndEvents());
        this.uiState.getNotifyEventList(this.editorUi.getNotifyEvents());
        this.uiState.getStartMode(this.editorUi.getStartMode());
        if (this.editorUi.getStartMode() == StartMode.SUB_PROCESS) {
            this.uiState.subActivityContext = this.uiState.subActivityContext.concat(this.uiState.subProcessElementContext);
        }
        else {
            this.uiState.subActivityContext = this.uiState.subActivityContext.filter((/**
             * @param {?} x
             * @return {?}
             */
            function (x) { return _this.uiState.subProcessElementContext.some((/**
             * @param {?} y
             * @return {?}
             */
            function (y) { return y.key != x.key; })); }));
        }
        this.viewModel.setProperty(this.editorUi.refreshProperty(data));
    };
    /**
     * 绑定流程分类的参数列表，流程构件，表单赋值
     * @param data
     */
    /**
     * 绑定流程分类的参数列表，流程构件，表单赋值
     * @private
     * @param {?} data
     * @return {?}
     */
    WfProcessEditorComponent.prototype.bindEntryFormInfo = /**
     * 绑定流程分类的参数列表，流程构件，表单赋值
     * @private
     * @param {?} data
     * @return {?}
     */
    function (data) {
        var _this = this;
        /** @type {?} */
        var flowformId = data.propertyValue.id;
        if (flowformId) {
            this.viewModel.getFlowFormInfoById(flowformId).subscribe((/**
             * @param {?} info
             * @return {?}
             */
            function (info) {
                data.flowForm = info.flowForm;
                data.formalParameters = info.formalParameters;
                data.processBizComponnets = info.bizComponents;
                data.executeForms = [];
                info.excuteForms.forEach((/**
                 * @param {?} form
                 * @return {?}
                 */
                function (form) {
                    if (form.isDefault) {
                        // 流程绑定默认单据
                        /** @type {?} */
                        var executeForms = _this.ConvertExecuteForm(form);
                        data.executeForms = data.executeForms.concat(executeForms);
                    }
                }));
                data.customizeActions = info.customizeActions.filter((/**
                 * @param {?} a
                 * @return {?}
                 */
                function (a) { return a.isAll === true; })).map((/**
                 * @param {?} a
                 * @return {?}
                 */
                function (a) { return ({
                    id: a.id, code: a.code, name: a.name, terminalType: a.terminal,
                    actualParameters: a.actualParameters.map((/**
                     * @param {?} p
                     * @return {?}
                     */
                    function (p) { return ({
                        Name: p.code, Value: p.value, ValueText: p.name, Tag: 'expression'
                    }); }))
                }); }));
                // 加载业务活动面板
                _this.editorUi.loadBizActivities(info.bizActivities || []);
                _this.service.getBizCmp().subscribe((/**
                 * @param {?} cmps
                 * @return {?}
                 */
                function (cmps) {
                    data.bizCmps = cmps;
                    _this.editorUi.updateProperty(data);
                    _this.uiState.getUserActList(_this.editorUi.getActivities());
                    _this.uiState.getEndEventList(_this.editorUi.getEndEvents());
                    _this.uiState.getNotifyEventList(_this.editorUi.getNotifyEvents());
                    _this.uiState.getStartMode(_this.editorUi.getStartMode());
                    if (_this.editorUi.getStartMode() == StartMode.SUB_PROCESS) {
                        _this.uiState.subActivityContext = _this.uiState.subActivityContext.concat(_this.uiState.subProcessElementContext);
                    }
                    else {
                        _this.uiState.subActivityContext = _this.uiState.subActivityContext.filter((/**
                         * @param {?} x
                         * @return {?}
                         */
                        function (x) { return _this.uiState.subProcessElementContext.some((/**
                         * @param {?} y
                         * @return {?}
                         */
                        function (y) { return y.key != x.key; })); }));
                    }
                    _this.viewModel.setProperty(_this.editorUi.refreshProperty(data));
                }));
            }));
        }
    };
    /**
     * @param {?} data
     * @return {?}
     */
    WfProcessEditorComponent.prototype.updateStartMode = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        var _this = this;
        /** @type {?} */
        var bpmnModel = this.editorUi.graph.bpmnModel;
        /** @type {?} */
        var extendElements = bpmnModel.DefaultProcess.GetExtensionElements();
        if (extendElements !== null && extendElements.length > 0) {
            /** @type {?} */
            var procHeader = (/** @type {?} */ (extendElements.filter((/**
             * @param {?} e
             * @return {?}
             */
            function (e) { return e instanceof ProcessHeader; }))));
            /** @type {?} */
            var flowFormKey = procHeader[0].BizDefKey;
            this.service.getAllBizCmp(flowFormKey).subscribe((/**
             * @param {?} allBizCmps
             * @return {?}
             */
            function (allBizCmps) {
                _this.service.getBizCmp().subscribe((/**
                 * @param {?} bizCmps
                 * @return {?}
                 */
                function (bizCmps) {
                    data.allBizCmps = allBizCmps;
                    data.bizCmps = bizCmps;
                    _this.editorUi.updateProperty(data);
                    _this.uiState.getUserActList(_this.editorUi.getActivities());
                    _this.uiState.getEndEventList(_this.editorUi.getEndEvents());
                    _this.uiState.getStartMode(_this.editorUi.getStartMode());
                    if (_this.editorUi.getStartMode() == StartMode.SUB_PROCESS) {
                        _this.uiState.subActivityContext = _this.uiState.subActivityContext.concat(_this.uiState.subProcessElementContext);
                    }
                    else {
                        _this.uiState.subActivityContext = _this.uiState.subActivityContext.filter((/**
                         * @param {?} x
                         * @return {?}
                         */
                        function (x) { return _this.uiState.subProcessElementContext.some((/**
                         * @param {?} y
                         * @return {?}
                         */
                        function (y) { return y.key != x.key; })); }));
                    }
                    _this.viewModel.setProperty(_this.editorUi.refreshProperty(data));
                }));
            }));
        }
    };
    /**
     * @private
     * @param {?} record
     * @return {?}
     */
    WfProcessEditorComponent.prototype.note = /**
     * @private
     * @param {?} record
     * @return {?}
     */
    function (record) {
        var _this = this;
        /** @type {?} */
        var compFactory = this.resolver.resolveComponentFactory(NoteComponent);
        /** @type {?} */
        var compRef = compFactory.create(this.injector);
        compRef.instance.record = record;
        /** @type {?} */
        var modalConfig = {
            title: this.localePipe.transform("processEditor.changeRecord"),
            width: 800,
            height: 520,
            showButtons: true,
            buttons: compRef.instance.footer
        };
        /** @type {?} */
        var dialog = this.modalService.show(compRef, modalConfig);
        compRef.instance.cancel.subscribe((/**
         * @param {?} $event
         * @return {?}
         */
        function ($event) { return dialog.close(); }));
        compRef.instance.submit.subscribe((/**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            // 更新流程记录
            _this.editorUi.graph.bpmnModel.DefaultProcess.Documentation = data;
            dialog.close();
        }));
    };
    /**
     * @private
     * @return {?}
     */
    WfProcessEditorComponent.prototype.openProcContent = /**
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        if (this.time === ProcessTime.dt) {
            if (this.processInfo) {
                if (this.processInfo.processKey === EventBusKeys.new && this.processInfo.flowFormId) {
                    this.openNewProcess(this.processInfo.flowFormId);
                }
                else {
                    // TODO：首先获取流程分类信息，确保流程分类和流程构件获取到（会稍微影响设计器打开速度）
                    this.viewModel.getFlowFormInfoById(this.processInfo.flowFormId).subscribe((/**
                     * @param {?} info
                     * @return {?}
                     */
                    function (info) {
                        _this.editorUi.loadBizActivities(info.bizActivities || []);
                        _this.getProcContent(_this.processInfo.processKey).subscribe((/**
                         * @param {?} re
                         * @return {?}
                         */
                        function (re) {
                            _this.uiState.content = _this.checkModelContent(JSON.stringify(re));
                            _this.openProcess(_this.uiState.content);
                        }));
                    }));
                }
            }
            else {
                throw new Error(this.localePipe.transform("processEditor.noDtInfo"));
            }
        }
        else if (this.time === ProcessTime.rt) {
            if (this.rtProcessInfo) {
                this.viewModel.getFlowFormInfoById(this.rtProcessInfo.flowFormId).subscribe((/**
                 * @param {?} info
                 * @return {?}
                 */
                function (info) {
                    _this.editorUi.loadBizActivities(info.bizActivities || []);
                    _this.getProcContent(_this.rtProcessInfo.rtProcDefId).subscribe((/**
                     * @param {?} re
                     * @return {?}
                     */
                    function (re) {
                        _this.uiState.content = _this.checkModelContent(JSON.stringify(re));
                        _this.openProcess(_this.uiState.content);
                    }));
                }));
            }
            else {
                throw new Error(this.localePipe.transform("processEditor.noRtInfo"));
            }
        }
    };
    /**
     * 新增流程，基于流程分类获取参数列表，构件和表单
     * @param ffId 流程分类ID
     */
    /**
     * 新增流程，基于流程分类获取参数列表，构件和表单
     * @param {?} ffId 流程分类ID
     * @return {?}
     */
    WfProcessEditorComponent.prototype.openNewProcess = /**
     * 新增流程，基于流程分类获取参数列表，构件和表单
     * @param {?} ffId 流程分类ID
     * @return {?}
     */
    function (ffId) {
        var _this = this;
        this.viewModel.getFlowFormInfoById(ffId).subscribe((/**
         * @param {?} info
         * @return {?}
         */
        function (info) {
            /** @type {?} */
            var processBizComponnets = info.bizComponents;
            /** @type {?} */
            var customizeActions = info.customizeActions.filter((/**
             * @param {?} a
             * @return {?}
             */
            function (a) { return a.isAll === true; })).map((/**
             * @param {?} a
             * @return {?}
             */
            function (a) { return ({
                id: a.id, code: a.code, name: a.name, terminalType: a.terminal,
                actualParameters: a.actualParameters.map((/**
                 * @param {?} p
                 * @return {?}
                 */
                function (p) { return ({
                    Name: p.code, Value: p.value, ValueText: p.name, Tag: 'expression'
                }); }))
            }); }));
            /** @type {?} */
            var executeForms = [];
            info.excuteForms.forEach((/**
             * @param {?} form
             * @return {?}
             */
            function (form) {
                if (form.isDefault) {
                    // 流程绑定默认单据
                    /** @type {?} */
                    var forms = _this.ConvertExecuteForm(form);
                    executeForms = executeForms.concat(forms);
                }
            }));
            // 如果不存在表单定义，需要去表单格式列表取一下
            if (executeForms.length === 0
                || executeForms.findIndex((/**
                 * @param {?} e
                 * @return {?}
                 */
                function (e) { return e.TerminalType === TerminalType.PC; })) === -1
                || executeForms.findIndex((/**
                 * @param {?} e
                 * @return {?}
                 */
                function (e) { return e.TerminalType === TerminalType.MOBILE; })) === -1) {
                _this.viewModel.getFormFormatsByBizCategory().subscribe((/**
                 * @param {?} formFormats
                 * @return {?}
                 */
                function (formFormats) {
                    if (formFormats && formFormats.length > 0) {
                        if (executeForms.findIndex((/**
                         * @param {?} e
                         * @return {?}
                         */
                        function (e) { return e.TerminalType === TerminalType.PC; })) === -1) {
                            /** @type {?} */
                            var formFormat = formFormats.filter((/**
                             * @param {?} f
                             * @return {?}
                             */
                            function (f) { return f.terminal === 'PC' && f.status === 0; }))[0];
                            if (formFormat) {
                                executeForms.push(_this.formFormat2ExecuteForm(formFormat));
                            }
                        }
                        if (executeForms.findIndex((/**
                         * @param {?} e
                         * @return {?}
                         */
                        function (e) { return e.TerminalType === TerminalType.MOBILE; })) === -1) {
                            /** @type {?} */
                            var formFormat = formFormats.filter((/**
                             * @param {?} f
                             * @return {?}
                             */
                            function (f) { return f.terminal === 'Mobile' && f.status === 0; }))[0];
                            if (formFormat) {
                                executeForms.push(_this.formFormat2ExecuteForm(formFormat));
                            }
                        }
                    }
                    /** @type {?} */
                    var newProcInfo = {
                        name: _this.processInfo.processName,
                        bizObjId: _this.processInfo.bizObjId,
                        ffId: ffId,
                        ffName: _this.processInfo.flowFormName,
                        startMode: _this.processInfo.startMode,
                        formalParameters: info.formalParameters,
                        processBizComponnets: processBizComponnets,
                        executeForms: executeForms,
                        customizeActions: customizeActions,
                        processDescription: info.flowForm.processDescription,
                    };
                    _this.createBpmnModel(info.bizActivities || [], newProcInfo);
                }));
            }
            else {
                /** @type {?} */
                var newProcInfo = {
                    name: _this.processInfo.processName,
                    bizObjId: _this.processInfo.bizObjId,
                    ffId: ffId,
                    ffName: _this.processInfo.flowFormName,
                    startMode: _this.processInfo.startMode,
                    formalParameters: info.formalParameters,
                    processBizComponnets: processBizComponnets,
                    executeForms: executeForms,
                    customizeActions: customizeActions,
                    processDescription: info.flowForm.processDescription,
                };
                _this.createBpmnModel(info.bizActivities || [], newProcInfo);
            }
        }));
    };
    /**
     * @param {?} bizActivities
     * @param {?} newProcInfo
     * @return {?}
     */
    WfProcessEditorComponent.prototype.createBpmnModel = /**
     * @param {?} bizActivities
     * @param {?} newProcInfo
     * @return {?}
     */
    function (bizActivities, newProcInfo) {
        var _this = this;
        this.service.getBizCmp().subscribe((/**
         * @param {?} cmps
         * @return {?}
         */
        function (cmps) {
            // 2023-5-30 为了解决网络较差场景下的加载问题修改了加载顺序 先加载数据再showeditorUi
            _this.editorUi.show();
            _this.addEditorUiListeners(_this.editorUi);
            _this.editorUi.loadBizActivities(bizActivities || []);
            _this.editorUi.createBpmnModel(newProcInfo, cmps);
            _this.service.getProcExtendProperty(newProcInfo.BizDefKey, newProcInfo.startMode, _this.editorUi.bizCategoryId).subscribe((/**
             * @param {?} property
             * @return {?}
             */
            function (property) {
                /** @type {?} */
                var props = [];
                property.forEach((/**
                 * @param {?} p
                 * @return {?}
                 */
                function (p) {
                    if ((p.bizCategoryId || p.bizDefKey) && ((p.bizCategoryId.indexOf(_this.editorUi.bizCategoryId) != -1 || p.bizCategoryId === '*') ||
                        (p.bizDefKey.indexOf(newProcInfo.BizDefKey) != -1 || p.bizDefKey === '*')) &&
                        (p.startMode.indexOf(newProcInfo.startMode) != -1 || p.startMode === '*')) {
                        props.push(p);
                    }
                }));
                _this.editorUi.procExtProps = props;
                if (_this.flag) {
                    _this.flag = false;
                    _this.closeLoading();
                }
                // 显示流程属性
                _this.viewModel.initProcessProperty(_this.editorUi.getFarrisPropConfig());
                // 获取启动方式
                _this.uiState.getStartMode(_this.editorUi.getStartMode());
                if (_this.editorUi.getStartMode() == StartMode.SUB_PROCESS) {
                    _this.uiState.subActivityContext = _this.uiState.subActivityContext.concat(_this.uiState.subProcessElementContext);
                }
                else {
                    _this.uiState.subActivityContext = _this.uiState.subActivityContext.filter((/**
                     * @param {?} x
                     * @return {?}
                     */
                    function (x) { return _this.uiState.subProcessElementContext.some((/**
                     * @param {?} y
                     * @return {?}
                     */
                    function (y) { return y.key != x.key; })); }));
                }
                _this.uiState.bpmnModel = _this.editorUi.graph.bpmnModel;
                _this.addGraphModelChangedListener();
            }));
        }));
    };
    /**
     * @param {?} content
     * @return {?}
     */
    WfProcessEditorComponent.prototype.openProcess = /**
     * @param {?} content
     * @return {?}
     */
    function (content) {
        var _this = this;
        // 取ProcessHeader
        /** @type {?} */
        var model = new BpmnModel();
        model.LoadFromJson(content);
        /** @type {?} */
        var processHeader = ((/** @type {?} */ (model.DefaultProcess.GetExtensionElements().filter((/**
         * @param {?} e
         * @return {?}
         */
        function (e) { return e instanceof ProcessHeader; }))[0])));
        this.service.getProcExtendProperty(processHeader.BizDefKey, processHeader.startMode, this.editorUi.bizCategoryId).subscribe((/**
         * @param {?} property
         * @return {?}
         */
        function (property) {
            /** @type {?} */
            var props = [];
            property.forEach((/**
             * @param {?} p
             * @return {?}
             */
            function (p) {
                if ((p.bizCategoryId || p.bizDefKey) && ((p.bizCategoryId.indexOf(_this.editorUi.bizCategoryId) != -1 || p.bizCategoryId === '*') ||
                    (p.bizDefKey.indexOf(processHeader.BizDefKey) != -1 || p.bizDefKey === '*')) &&
                    (p.startMode.indexOf(processHeader.startMode) != -1 || p.startMode === '*')) {
                    props.push(p);
                }
            }));
            _this.editorUi.procExtProps = props;
            // 2023-5-30 为了解决网络较差场景下的加载问题修改了加载顺序 先加载数据再showeditorUi
            _this.editorUi.show();
            _this.addEditorUiListeners(_this.editorUi);
            _this.editorUi.openBpmnModel(content);
            if (_this.flag) {
                _this.flag = false;
                _this.closeLoading();
            }
            // 显示流程属性
            _this.viewModel.initProcessProperty(_this.editorUi.getFarrisPropConfig());
            // 打开时获取所有活动节点信息
            _this.uiState.getUserActList(_this.editorUi.getActivities());
            // 打开时获取所有结束节点信息
            _this.uiState.getEndEventList(_this.editorUi.getEndEvents());
            // 打开时获取所有知会节点信息
            _this.uiState.getNotifyEventList(_this.editorUi.getNotifyEvents());
            // 打开时获取所有消息节点信息
            _this.uiState.getMessageEventList(_this.editorUi.getMessageEvents());
            // 打开时获取所有子流程和信号捕获节点信息
            _this.uiState.getSubAndCatchEventsList(_this.editorUi.getSubAndCatchEvents());
            _this.uiState.bpmnModel = _this.editorUi.graph.bpmnModel;
            // 获取启动方式
            _this.uiState.getStartMode(_this.editorUi.getStartMode());
            if (_this.editorUi.getStartMode() == StartMode.SUB_PROCESS) {
                _this.uiState.subActivityContext = _this.uiState.subActivityContext.concat(_this.uiState.subProcessElementContext);
            }
            else {
                _this.uiState.subActivityContext = _this.uiState.subActivityContext.filter((/**
                 * @param {?} x
                 * @return {?}
                 */
                function (x) { return _this.uiState.subProcessElementContext.some((/**
                 * @param {?} y
                 * @return {?}
                 */
                function (y) { return y.key != x.key; })); }));
            }
            _this.addGraphModelChangedListener();
        }));
    };
    /**
     * 添加graph model监听器，有变化则将changedFlag
     */
    /**
     * 添加graph model监听器，有变化则将changedFlag
     * @return {?}
     */
    WfProcessEditorComponent.prototype.addGraphModelChangedListener = /**
     * 添加graph model监听器，有变化则将changedFlag
     * @return {?}
     */
    function () {
        var _this = this;
        // 监听画布变化，更新界面变更状态
        /** @type {?} */
        var changedListener = (/**
         * @return {?}
         */
        function () {
            _this.changedFlag = false;
        });
        this.editorUi.graph.model.addListener(mxEvent.CHANGE, changedListener);
    };
    /**
     * @private
     * @param {?} data
     * @return {?}
     */
    WfProcessEditorComponent.prototype.showTip = /**
     * @private
     * @param {?} data
     * @return {?}
     */
    function (data) {
        var _this = this;
        if (data.type === 'message') {
            switch (data.level) {
                case 'warning':
                    this.message.warning(data.message);
                    break;
                case 'error':
                    this.message.error(data.message);
                    break;
                case 'question':
                    this.message.question(data.message, (/**
                     * @return {?}
                     */
                    function () {
                        _this.questionOKHandle(data);
                    }));
                    break;
                default:
                    this.message.info(data.message);
                    break;
            }
        }
        else if (data.type === 'notify') {
            switch (data.level) {
                case 'warning':
                    this.notify.warning(data.message);
                    break;
                case 'error':
                    this.notify.error(data.message);
                    break;
                default:
                    this.notify.info(data.message);
                    break;
            }
        }
    };
    /**
     * @private
     * @param {?} data
     * @return {?}
     */
    WfProcessEditorComponent.prototype.showVerify = /**
     * @private
     * @param {?} data
     * @return {?}
     */
    function (data) {
        this.errorList = data;
        this.createValidationTips();
    };
    /**
     * @private
     * @param {?} data
     * @return {?}
     */
    WfProcessEditorComponent.prototype.questionOKHandle = /**
     * @private
     * @param {?} data
     * @return {?}
     */
    function (data) {
        switch (data.action) {
        }
    };
    /**
     * 获取流程上下文
     * @param id 流程定义ID（设计时使用流程定义Key，运行时使用流程定义ID）
     */
    /**
     * 获取流程上下文
     * @param {?} id 流程定义ID（设计时使用流程定义Key，运行时使用流程定义ID）
     * @return {?}
     */
    WfProcessEditorComponent.prototype.getProcContent = /**
     * 获取流程上下文
     * @param {?} id 流程定义ID（设计时使用流程定义Key，运行时使用流程定义ID）
     * @return {?}
     */
    function (id) {
        if (id) {
            if (this.time === ProcessTime.dt) {
                return this.service.getProcContentbyKey(id);
            }
            else if (this.time === ProcessTime.rt) {
                return this.service.getRTProcContentbyId(id);
            }
            else {
                throw new Error(this.localePipe.transform("processEditor.wrongMoment"));
            }
        }
    };
    /**
     * @private
     * @param {?} content
     * @return {?}
     */
    WfProcessEditorComponent.prototype.save = /**
     * @private
     * @param {?} content
     * @return {?}
     */
    function (content) {
        var _this = this;
        this.uiState.content = content;
        this.showLoading();
        /** @type {?} */
        var process = JSON.parse(this.uiState.content);
        this.saveHttp().subscribe((/**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            _this.closeLoading();
            // 2023-6-13 保存后同步流程名称到标题栏
            _this.procNameTitle = process.DefaultProcess.Name;
            _this.notify.success((/** @type {?} */ ({
                title: _this.localePipe.transform("processEditor.prompted"),
                msg: _this.localePipe.transform("processEditor.saveSuccess"),
                timeout: 3000
            })));
            if (_this.time === ProcessTime.dt) {
                _this.viewModel.auditProcessDef(AuditEvent.WF_ProcessDef_SaveDT, true, process.DefaultProcess.Key);
            }
            else if (_this.time === ProcessTime.rt) {
                _this.viewModel.auditProcessDef(AuditEvent.WF_ProcessDef_SaveRT, true, process.DefaultProcess.Key);
            }
            // 重置界面变更状态
            _this.changedFlag = false;
        }), (/**
         * @param {?} error
         * @return {?}
         */
        function (error) {
            _this.closeLoading();
            _this.notify.error((/** @type {?} */ ({
                title: _this.localePipe.transform("processEditor.prompted"),
                msg: error.error.Message,
                timeout: 3000
            })));
            if (_this.time === ProcessTime.dt) {
                _this.viewModel.auditProcessDef(AuditEvent.WF_ProcessDef_SaveDT, false, process.DefaultProcess.Key);
            }
            else if (_this.time === ProcessTime.rt) {
                _this.viewModel.auditProcessDef(AuditEvent.WF_ProcessDef_SaveRT, false, process.DefaultProcess.Key);
            }
        }));
    };
    /**
     * @private
     * @param {?} content
     * @return {?}
     */
    WfProcessEditorComponent.prototype.release = /**
     * @private
     * @param {?} content
     * @return {?}
     */
    function (content) {
        var _this = this;
        this.uiState.content = content;
        this.showLoading();
        this.uiState.getReleaseConfig().subscribe((/**
         * @param {?} config
         * @return {?}
         */
        function (config) {
            if (config.currentValue === 'true') {
                // 展示发布前审批页面，同时保存，记审计
                _this.viewModel.saveProcess(_this.uiState.content, _this.processInfo, 1).subscribe((/**
                 * @param {?} re
                 * @return {?}
                 */
                function (re) {
                    _this.viewModel.getProcDefsByKey(JSON.parse(content).DefaultProcess.Key).subscribe((/**
                     * @param {?} ProcDefs
                     * @return {?}
                     */
                    function (ProcDefs) {
                        /** @type {?} */
                        var maxVersion = Math.max.apply(Math, ProcDefs.map((/**
                         * @param {?} item
                         * @return {?}
                         */
                        function (item) {
                            return item.version << 0;
                        })));
                        // 展示发布前审批页面，同时保存，记审计
                        _this.viewModel.releaseProcess(content, maxVersion === -Infinity ? 1 : maxVersion);
                        _this.closeLoading();
                    }));
                }));
                _this.notify.success((/** @type {?} */ ({
                    title: _this.localePipe.transform("processEditor.prompted"),
                    msg: _this.localePipe.transform("processEditor.waitReview"),
                    timeout: 3000
                })));
                /** @type {?} */
                var process = JSON.parse(_this.uiState.content);
                _this.viewModel.auditProcessDef(AuditEvent.WF_ProcessDef_Deploy, true, process.DefaultProcess.Key);
            }
            else {
                _this.viewModel.deployProcess(_this.uiState.content).subscribe((/**
                 * @param {?} data
                 * @return {?}
                 */
                function (data) {
                    _this.closeLoading();
                    _this.viewModel.saveProcess(_this.uiState.content, _this.processInfo, 0).subscribe((/**
                     * @param {?} r
                     * @return {?}
                     */
                    function (r) { }));
                    _this.notify.success((/** @type {?} */ ({
                        title: _this.localePipe.transform("processEditor.prompted"),
                        msg: _this.localePipe.transform("processEditor.successPublish"),
                        timeout: 3000
                    })));
                    /** @type {?} */
                    var process = JSON.parse(_this.uiState.content);
                    _this.viewModel.auditProcessDef(AuditEvent.WF_ProcessDef_Deploy, true, process.DefaultProcess.Key);
                }), (/**
                 * @param {?} e
                 * @return {?}
                 */
                function (e) {
                    _this.closeLoading();
                    _this.notify.error((/** @type {?} */ ({
                        title: _this.localePipe.transform("processEditor.prompted"),
                        msg: _this.localePipe.transform("processEditor.publishFail") + ("" + e.error.Message),
                        timeout: 3000
                    })));
                    /** @type {?} */
                    var process = JSON.parse(_this.uiState.content);
                    _this.viewModel.auditProcessDef(AuditEvent.WF_ProcessDef_Deploy, false, process.DefaultProcess.Key);
                }));
            }
        }));
    };
    /**
     * 保存流程定义（设计时+运行时）
     */
    /**
     * 保存流程定义（设计时+运行时）
     * @private
     * @return {?}
     */
    WfProcessEditorComponent.prototype.saveHttp = /**
     * 保存流程定义（设计时+运行时）
     * @private
     * @return {?}
     */
    function () {
        if (this.uiState.content) {
            if (this.time === ProcessTime.dt) {
                return this.viewModel.saveProcess(this.uiState.content, this.processInfo, 1);
            }
            else if (this.time === ProcessTime.rt) {
                return this.viewModel.saveRTProcess(this.uiState.content, this.rtProcessInfo.rtProcDefId);
            }
            else {
                throw new Error(this.localePipe.transform("processEditor.wrongMoment"));
            }
        }
    };
    /**
     * @return {?}
     */
    WfProcessEditorComponent.prototype.showLoading = /**
     * @return {?}
     */
    function () {
        this.loadService.show({ container: 'body', message: '', type: 1 });
    };
    /**
     * @return {?}
     */
    WfProcessEditorComponent.prototype.closeLoading = /**
     * @return {?}
     */
    function () {
        this.loadService.close();
    };
    /**
     * @private
     * @param {?} form
     * @return {?}
     */
    WfProcessEditorComponent.prototype.ConvertExecuteForm = /**
     * @private
     * @param {?} form
     * @return {?}
     */
    function (form) {
        /** @type {?} */
        var executeForms = new Array();
        if (form.terminal === 'web,app') {
            /** @type {?} */
            var webForm = new ExecuteFormModel();
            webForm.ComponentId = form.appId;
            webForm.formFormatId = form.formFormatId;
            webForm.FormType = form.formType;
            webForm.Name = form.name;
            webForm.TerminalType = TerminalType.PC;
            if (form.actualParameters && form.actualParameters.length > 0) {
                webForm.ActualParameters = form.actualParameters.map((/**
                 * @param {?} p
                 * @return {?}
                 */
                function (p) { return ({
                    Name: p.code,
                    Value: p.value
                }); }));
            }
            executeForms.push(webForm);
            /** @type {?} */
            var appForm = new ExecuteFormModel();
            appForm.ComponentId = form.appId;
            appForm.formFormatId = form.formFormatId;
            appForm.FormType = form.formType;
            appForm.Name = form.name;
            appForm.TerminalType = TerminalType.MOBILE;
            if (form.actualParameters && form.actualParameters.length > 0) {
                appForm.ActualParameters = form.actualParameters.map((/**
                 * @param {?} p
                 * @return {?}
                 */
                function (p) { return ({
                    Name: p.code,
                    Tag: p.valueType ? p.valueType : ProcessDeUtil.initVariableType(p.value),
                    Value: p.value
                }); }));
            }
            executeForms.push(appForm);
        }
        else {
            /** @type {?} */
            var executeForm = new ExecuteFormModel();
            executeForm.ComponentId = form.appId;
            executeForm.formFormatId = form.formFormatId;
            executeForm.FormType = form.formType;
            executeForm.Name = form.name;
            switch (form.terminal) {
                case 'web':
                    executeForm.TerminalType = TerminalType.PC;
                    break;
                case 'app':
                    executeForm.TerminalType = TerminalType.MOBILE;
                    break;
            }
            if (form.actualParameters && form.actualParameters.length > 0) {
                executeForm.ActualParameters = form.actualParameters.map((/**
                 * @param {?} p
                 * @return {?}
                 */
                function (p) { return ({
                    Name: p.code,
                    Tag: p.valueType ? p.valueType : ProcessDeUtil.initVariableType(p.value),
                    Value: p.value
                }); }));
            }
            executeForms.push(executeForm);
        }
        return executeForms;
    };
    /**
     * @private
     * @param {?} formformat
     * @return {?}
     */
    WfProcessEditorComponent.prototype.formFormat2ExecuteForm = /**
     * @private
     * @param {?} formformat
     * @return {?}
     */
    function (formformat) {
        /** @type {?} */
        var form = new ExecuteFormModel();
        form.Id = ProcessDeUtil.GenerateElementId();
        form.ComponentId = null;
        form.formFormatId = formformat.id;
        form.FormType = '0';
        form.Name = formformat.name;
        switch (formformat.terminal) {
            case 'PC':
                form.TerminalType = TerminalType.PC;
                break;
            case 'Mobile':
                form.TerminalType = TerminalType.MOBILE;
                break;
        }
        if (formformat.urlParameters && formformat.urlParameters.length > 0) {
            form.ActualParameters = formformat.urlParameters.map((/**
             * @param {?} p
             * @return {?}
             */
            function (p) { return ({
                Name: p.code,
                Tag: p.valueType ? p.valueType : ProcessDeUtil.initVariableType(p.value),
                Value: p.value
            }); }));
        }
        return form;
    };
    /**
     * @private
     * @param {?} strategy
     * @return {?}
     */
    WfProcessEditorComponent.prototype.completeStrategyChanged = /**
     * @private
     * @param {?} strategy
     * @return {?}
     */
    function (strategy) {
        var _this = this;
        if (strategy !== this.uiState.completeIterator[0].key) {
            // 参与者存在自动审批的情况下，不允许修改完成策略为会签规则
            // if (this.uiState.propertyData.ParticipantSchemes
            //   && this.uiState.propertyData.ParticipantSchemes.options
            //   && this.uiState.propertyData.ParticipantSchemes.options.automaticPerformers
            //   && this.uiState.propertyData.ParticipantSchemes.options.automaticPerformers.length > 0) {
            //   return;
            // } else {
            // 会签规则不存在，即由抢占模式，变为会签时
            if (!this.uiState.propertyData.SignRule) {
                // 会签是自动弹出会签规则编辑
                /** @type {?} */
                var compFactory = this.resolver.resolveComponentFactory(SignRuleComponent);
                /** @type {?} */
                var compRef = compFactory.create(this.injector);
                compRef.instance.value = [];
                // compRef.instance.counterSignVariables = this.uiState.counterSignVariables || [];
                // compRef.instance.approvalItems = this.uiState.approvalItems || [];
                /** @type {?} */
                var modalConfig = Object.assign(compRef.instance.modalConfig, { buttons: compRef.instance.modalFooter });
                /** @type {?} */
                var dialog_1 = this.modalService.show(compRef, modalConfig);
                compRef.instance.closeModal.subscribe((/**
                 * @param {?} $event
                 * @return {?}
                 */
                function ($event) { return dialog_1.close(); }));
                compRef.instance.submitModal.subscribe((/**
                 * @param {?} data
                 * @return {?}
                 */
                function (data) {
                    _this.updateChangeProperty({
                        categoryId: 'performerProperty',
                        propertyID: UserActivityPropertyKeys.SignRule,
                        propertyValue: data.value
                    });
                    dialog_1.close();
                }));
            }
            // 会签规则下，驳回规则约束
            if (((/** @type {?} */ (this.uiState.propertyData.BackWardRule))).SelectTargetAble === true) {
                setTimeout((/**
                 * @return {?}
                 */
                function () {
                    _this.message.warning(_this.localePipe.transform("processEditor.policyConflict"));
                }), 500);
            }
            // }
        }
    };
    /**
     * @private
     * @param {?} data
     * @return {?}
     */
    WfProcessEditorComponent.prototype.OtherAssignNodesChanged = /**
     * @private
     * @param {?} data
     * @return {?}
     */
    function (data) {
        var _this = this;
        /** @type {?} */
        var compFactory = this.resolver.resolveComponentFactory(AssignScopeComponent);
        /** @type {?} */
        var compRef = compFactory.create(this.injector);
        /** @type {?} */
        var location;
        if (data.Id.indexOf('startActivity') > -1) {
            location = 'startActivity';
        }
        else {
            location = 'userActivity';
        }
        if (location === 'startActivity') {
            compRef.instance.value = [];
            /** @type {?} */
            var activities = this.uiState.userActList.filter((/**
             * @param {?} a
             * @return {?}
             */
            function (a) { return a.Id !== _this.uiState.propertyData.Id
                && a.AssignmentStrategy === 'ASSIGN'
                && a.AssignPerformerConfig
                && a.AssignPerformerConfig.Operator === 'procInstCreator'; }));
            if (activities && activities.length > 0) {
                compRef.instance.value = activities.map((/**
                 * @param {?} a
                 * @return {?}
                 */
                function (a) { return a.Id; }));
            }
            else {
                compRef.instance.value = new Array();
            }
        }
        else {
            compRef.instance.value = [];
        }
        compRef.instance.location = location;
        /** @type {?} */
        var modalConfig = Object.assign(compRef.instance.modalConfig, { buttons: compRef.instance.modalFooter });
        /** @type {?} */
        var dialog = this.modalService.show(compRef, modalConfig);
        compRef.instance.closeModal.subscribe((/**
         * @param {?} $event
         * @return {?}
         */
        function ($event) { return dialog.close(); }));
        compRef.instance.submitModal.subscribe((/**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            _this.updateChangeProperty({
                categoryId: location = 'activityConfig',
                // todo：多个活动具有同名属性时，如何更合理定义PropertyKey？
                propertyID: UserActivityPropertyKeys.otherAssignActivities,
                propertyValue: data.value
            });
            dialog.close();
        }));
    };
    /**
     * 完成策略调整校验
     */
    /**
     * 完成策略调整校验
     * @private
     * @param {?} data
     * @return {?}
     */
    WfProcessEditorComponent.prototype.beforeCompleteStrategyChange = /**
     * 完成策略调整校验
     * @private
     * @param {?} data
     * @return {?}
     */
    function (data) {
        if (this.time === ProcessTime.rt) {
            return this.viewModel.beforeCompleteStrategyChange(data, this.rtProcessInfo);
        }
        else {
            return of$1(true);
        }
    };
    /**
     * 保存，发布，另存，同步操作时
     * 校验模型的流程分类ID与列表存储是否一致，不一致时，以列表为准
     */
    /**
     * 保存，发布，另存，同步操作时
     * 校验模型的流程分类ID与列表存储是否一致，不一致时，以列表为准
     * @private
     * @param {?} content
     * @return {?}
     */
    WfProcessEditorComponent.prototype.checkModelContent = /**
     * 保存，发布，另存，同步操作时
     * 校验模型的流程分类ID与列表存储是否一致，不一致时，以列表为准
     * @private
     * @param {?} content
     * @return {?}
     */
    function (content) {
        /** @type {?} */
        var process = JSON.parse(content);
        /** @type {?} */
        var modelBizDefKey = process.DefaultProcess.extensionElements.find((/**
         * @param {?} e
         * @return {?}
         */
        function (e) { return e.ClrTypeID === 'wf.ProcessHeader'; })).BizDefKey;
        if (this.time === ProcessTime.dt) {
            if (modelBizDefKey === this.processInfo.flowFormId) {
                return content;
            }
            else {
                process.DefaultProcess.extensionElements.find((/**
                 * @param {?} e
                 * @return {?}
                 */
                function (e) { return e.ClrTypeID === 'wf.ProcessHeader'; })).BizDefKey = this.processInfo.flowFormId;
                process.DefaultProcess.extensionElements.find((/**
                 * @param {?} e
                 * @return {?}
                 */
                function (e) { return e.ClrTypeID === 'wf.ProcessHeader'; })).BizDefName = this.uiState.flowFormInfo.flowForm.name;
                return JSON.stringify(process);
            }
        }
        else if (this.time === ProcessTime.rt) {
            if (modelBizDefKey === this.rtProcessInfo.flowFormId) {
                return content;
            }
            else {
                process.DefaultProcess.extensionElements.find((/**
                 * @param {?} e
                 * @return {?}
                 */
                function (e) { return e.ClrTypeID === 'wf.ProcessHeader'; })).BizDefKey = this.rtProcessInfo.flowFormId;
                process.DefaultProcess.extensionElements.find((/**
                 * @param {?} e
                 * @return {?}
                 */
                function (e) { return e.ClrTypeID === 'wf.ProcessHeader'; })).BizDefName = this.uiState.flowFormInfo.flowForm.name;
                return JSON.stringify(process);
            }
        }
    };
    /**
     * @param {?} event
     * @return {?}
     */
    WfProcessEditorComponent.prototype.showModeChange = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        var _a = event || {}, _b = _a.mode, mode = _b === void 0 ? ShowMode.panel : _b, _c = _a.wideWidth, wideWidth = _c === void 0 ? 330 : _c, _d = _a.smallWidth, smallWidth = _d === void 0 ? 41 : _d;
        if (mode === ShowMode.panel) {
            this.panelWidth = wideWidth;
            this.rightPanelWidth = wideWidth;
        }
        else if (mode === ShowMode.sidebar) {
            this.panelWidth = smallWidth;
            this.rightPanelWidth = smallWidth;
        }
    };
    /**
     * @return {?}
     */
    WfProcessEditorComponent.prototype.saveProc = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var model = this.editorUi.graph.bpmnModel;
        /** @type {?} */
        var res = WfValidatorAdapter.validator(model, this.scene);
        if (res.valid == false) {
            this.showTip(res);
            return;
        }
        if (res.warningList && res.warningList.length > 0) {
            this.showVerify(res.warningList);
        }
        else {
            this.clearValidationTips();
        }
        this.save(model.ConvertToJson());
    };
    /**
     * @return {?}
     */
    WfProcessEditorComponent.prototype.saveAs = /**
     * @return {?}
     */
    function () {
        if (!(this.uiState.enableAdminOrgAut || ((this.uiState.isAdministratorConfig &&
            this.uiState.administrator !== null) || (!this.uiState.isAdministratorConfig)))) {
            this.message.info(this.localePipe.transform("processEditor.noPermissionToSave"));
            return;
        }
        /** @type {?} */
        var model = this.editorUi.graph.bpmnModel;
        /** @type {?} */
        var res = WfValidatorAdapter.validator(model, this.scene);
        if (res.valid == false) {
            this.showTip(res);
            return;
        }
        if (res.warningList && res.warningList.length > 0) {
            this.showVerify(res.warningList);
        }
        else {
            this.clearValidationTips();
        }
        /** @type {?} */
        var process = new BpmnModel();
        process.LoadFromJson(model.ConvertToJson());
        process.DefaultProcess.Key = ProcessDeUtil.GenerateElementId();
        process.DefaultProcess.Id = ProcessDeUtil.GenerateElementId();
        process.DefaultDiagram.BpmnPlane.BpmnElementId = process.DefaultProcess.Id;
        this.viewModel.saveAsProcess(process, this.processInfo);
    };
    /**
     * @return {?}
     */
    WfProcessEditorComponent.prototype.releaseProc = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var model = this.editorUi.graph.bpmnModel;
        /** @type {?} */
        var res = WfValidatorAdapter.validator(model, this.scene);
        if (res.valid == false) {
            this.showTip(res);
            return;
        }
        if (res.warningList && res.warningList.length > 0) {
            this.showVerify(res.warningList);
        }
        else {
            this.clearValidationTips();
        }
        this.release(model.ConvertToJson());
    };
    /**
     * @return {?}
     */
    WfProcessEditorComponent.prototype.sync = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var model = this.editorUi.graph.bpmnModel;
        /** @type {?} */
        var res = WfValidatorAdapter.validator(model, this.scene);
        if (res.valid == false) {
            this.showTip(res);
            return;
        }
        if (res.warningList && res.warningList.length > 0) {
            this.showVerify(res.warningList);
        }
        else {
            this.clearValidationTips();
        }
        this.viewModel.syncDtProcess(model.ConvertToJson(), this.rtProcessInfo);
    };
    /**
     * @return {?}
     */
    WfProcessEditorComponent.prototype.procRecord = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var record = this.editorUi.graph.bpmnModel.DefaultProcess.Documentation;
        this.note(record);
    };
    /**
     * @return {?}
     */
    WfProcessEditorComponent.prototype.batchSet = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var compFactory = this.resolver.resolveComponentFactory(BatchSetPropertiesComponent);
        /** @type {?} */
        var compRef = compFactory.create(this.injector);
        /** @type {?} */
        var modalConfig = {
            title: '批量设置',
            width: 512,
            height: 565,
            showButtons: true,
            buttons: compRef.instance.footer
        };
        /** @type {?} */
        var dialog = this.modalService.show(compRef, modalConfig);
        compRef.instance.cancel.subscribe((/**
         * @param {?} $event
         * @return {?}
         */
        function ($event) { return dialog.close(); }));
        compRef.instance.submit.subscribe((/**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            dialog.close();
        }));
    };
    /**
     * @return {?}
     */
    WfProcessEditorComponent.prototype.closeProc = /**
     * @return {?}
     */
    function () {
        var _this = this;
        // 如果界面发生变化，增加确认框提示，无变化则直接关闭
        if (this.changedFlag) {
            this.message.confirm(this.localePipe.transform("processEditor.closeProc1"), this.localePipe.transform("processEditor.closeProc2")).subscribe((/**
             * @param {?} f
             * @return {?}
             */
            function (f) {
                if (f) {
                    _this.close.emit();
                }
            }));
        }
        else {
            this.close.emit();
        }
    };
    /**
     * @return {?}
     */
    WfProcessEditorComponent.prototype.viewProcModel = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var modalConfig = {
            title: this.localePipe.transform("processEditor.viewModel"),
            width: 800,
            height: 520,
            showButtons: false
        };
        // 模型自动复制到剪贴板
        this.notify.success(this.localePipe.transform("processEditor.copied"));
        this.copy(this.editorUi.graph.bpmnModel.ConvertToJson());
        this.modalService.show(this.editorUi.graph.bpmnModel.ConvertToJson(), modalConfig);
    };
    /**
     * 左右拖动后事件，event.size.width是左侧面板的宽度
     */
    /**
     * 左右拖动后事件，event.size.width是左侧面板的宽度
     * @param {?} event
     * @return {?}
     */
    WfProcessEditorComponent.prototype.rzStop = /**
     * 左右拖动后事件，event.size.width是左侧面板的宽度
     * @param {?} event
     * @return {?}
     */
    function (event) {
        this.panelWidth = event.size.width;
        this.editorUi && this.editorUi.graph.refresh();
    };
    // 展示表单验证组件，用于构件校验
    // 展示表单验证组件，用于构件校验
    /**
     * @return {?}
     */
    WfProcessEditorComponent.prototype.createValidationTips = 
    // 展示表单验证组件，用于构件校验
    /**
     * @return {?}
     */
    function () {
        this.verifySer.clear();
        this.verifyContainer = this.verifySer.createVerify({
            parent: this.contentEl,
            verifyList: this.errorList,
            verifyType: this.tabTypeList,
            showList: true,
            showType: 'processWarning',
            verifyResultTipsTmpl: this.tipsTmpl // 提示模板
        });
        this.listclick = this.verifyContainer.validatorClick.subscribe((/**
         * @param {?} e
         * @return {?}
         */
        function (e) {
            console.log(e);
        }));
        this.showchange = this.verifyContainer.listshowChange.subscribe((/**
         * @param {?} e
         * @return {?}
         */
        function (e) {
            console.log(e);
        }));
    };
    /**
     * @return {?}
     */
    WfProcessEditorComponent.prototype.clearValidationTips = /**
     * @return {?}
     */
    function () {
        this.errorList = [];
        if (this.verifySer) {
            this.verifySer.clear();
        }
    };
    /**
     * @param {?} text
     * @return {?}
     */
    WfProcessEditorComponent.prototype.copy = /**
     * @param {?} text
     * @return {?}
     */
    function (text) {
        /** @type {?} */
        var el = document.createElement('input');
        el.setAttribute('value', text);
        document.body.appendChild(el);
        el.select();
        document.execCommand('copy');
        document.body.removeChild(el);
    };
    WfProcessEditorComponent.decorators = [
        { type: Component, args: [{
                    selector: 'wf-process-editor',
                    template: "<div class=\"f-page\">\r\n  <div class=\"f-page-header mt-1\">\r\n    <nav class=\"f-page-header-base py-0\">\r\n      <div class=\"f-title\">\r\n        <span class=\"f-title-icon f-text-orna-manage\">\r\n          <i class=\"f-icon f-icon-page-title-administer\"></i>\r\n        </span>\r\n        <h4 class=\"f-title-text\">{{procNameTitle}}</h4>\r\n      </div>\r\n      <div class=\"btn-toolbar btn-group-lg\">\r\n        <ng-container *ngIf=\"action==='edit'&&time==='dt'\">\r\n          <button class=\"btn btn-primary btn-lg mr-2\" (click)=\"saveProc()\">{{ 'processEditor.button.saveProc' | wfLocale }}</button>\r\n          <button class=\"btn btn-secondary mr-2\" (click)=\"releaseProc()\">{{ 'processEditor.button.releaseProc' | wfLocale }}</button>\r\n        </ng-container>\r\n        <ng-container *ngIf=\"action==='edit'&&time==='rt'\">\r\n          <button class=\"btn btn-primary btn-lg mr-2\" (click)=\"saveProc()\">{{ 'processEditor.button.saveProc' | wfLocale }}</button>\r\n          <button class=\"btn btn-secondary mr-2\" (click)=\"sync()\">{{ 'processEditor.button.sync' | wfLocale }}</button>\r\n        </ng-container>\r\n        <ng-container *ngIf=\"time==='dt'&&action!='assignView'\">\r\n          <button class=\"btn btn-secondary btn-lg mr-2\" (click)=\"saveAs()\">{{ 'processEditor.button.saveAs' | wfLocale }}</button>\r\n        </ng-container>\r\n        <button class=\"btn btn-secondary mr-2\" (click)=\"procRecord()\">{{ 'processEditor.button.procRecord' | wfLocale }}</button>\r\n        <ng-container *ngIf=\"showModelButton\">\r\n          <button class=\"btn btn-secondary mr-2\" (click)=\"viewProcModel()\">{{ 'processEditor.button.viewProcModel' | wfLocale }}</button>\r\n          </ng-container>\r\n        <button class=\"btn btn-secondary mr-2\" (click)=\"closeProc()\">{{ 'processEditor.button.closeProc' | wfLocale }}</button>\r\n      </div>\r\n    </nav>\r\n  </div>\r\n  <div class=\"f-page-main\">\r\n    <div class=\"f-utils-flex-column h-100\">\r\n      <div class=\"flex-auto d-flex flex-fill flex-row\" style=\"position:relative; overflow: hidden\">\r\n        <farris-splitter style=\"display: flex; flex-grow: 1\">\r\n          <farris-splitter-pane style=\"display: flex; flex-grow: 1\" id=\"gspWfDesignerPane\">\r\n            <div class=\"flex-grow-1 h-100\">\r\n              <div style=\"position: relative; height: 100%; width: 100%;\">\r\n                <div id=\"editorUiContainer\" class=\"editorUiContainer geEditor\" #editorUiContainer>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </farris-splitter-pane>\r\n          <farris-splitter-pane class=\"f-page-content-main f-component-splitter-pane\" style=\"margin: 0 0 0 10px\"\r\n            ngResizable [rzHandles]=\"'w'\" [ngStyle]=\"{ width: rightPanelWidth + 'px' }\" (rzStop)=\"rzStop($event)\"\r\n            [relatedIframeParent]=\"'#gspWfDesignerPane'\">\r\n            <div class=\"h-100 d-flex flex-column\">\r\n              <div class=\"f-utils-fill-flex-column\">\r\n                <app-property-panel #propertyPanel [(propertyConfig)]=\"uiState.propertyConfig\"\r\n                  [(propertyData)]=\"uiState.propertyData\" [enableChangeMode]=\"true\" [showCloseBtn]=\"false\"\r\n                  isWhiteTheme=\"true\" (showModeChange)=\"showModeChange($event)\" style=\"height:100%;width:100%;\">\r\n                </app-property-panel>\r\n              </div>\r\n            </div>\r\n          </farris-splitter-pane>\r\n        </farris-splitter>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n<ng-template #tipsTmpl let-datas>\r\n  <span class=\"f-icon f-icon-question\" style=\"font-size:14px;\"></span>{{datas[0]['list'].length}}\r\n</ng-template>\r\n",
                    providers: [
                        { provide: WF_LANG_RESOURCES, useValue: ɵ0$3 },
                        WfLocalePipe,
                    ],
                    styles: ["\n    .bpmn-designer {\n      height: 100%;\n      min-height: 400px;\n      width: 100%;\n    }"]
                }] }
    ];
    /** @nocollapse */
    WfProcessEditorComponent.ctorParameters = function () { return [
        { type: ProcessDesignerUIState },
        { type: ProcessDesignerViewModel },
        { type: ProcessDesignerDataService },
        { type: LoadingService },
        { type: NotifyService },
        { type: MessagerService },
        { type: WFFlowElementsViewModel },
        { type: Injector },
        { type: BsModalService },
        { type: ComponentFactoryResolver },
        { type: EventBusService },
        { type: ChangeDetectorRef, decorators: [{ type: Optional }] },
        { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
        { type: undefined, decorators: [{ type: Inject, args: [WF_LANG_RESOURCES,] }] },
        { type: WfLocalePipe, decorators: [{ type: Optional }] }
    ]; };
    WfProcessEditorComponent.propDecorators = {
        cls: [{ type: HostBinding, args: ['class',] }],
        time: [{ type: Input }],
        processInfo: [{ type: Input }],
        rtProcessInfo: [{ type: Input }],
        action: [{ type: Input }],
        mode: [{ type: Input }],
        scene: [{ type: Input }],
        procType: [{ type: Input }],
        close: [{ type: Output }],
        propertyPanel: [{ type: ViewChild, args: ['propertyPanel',] }],
        tipsTmpl: [{ type: ViewChild, args: ['tipsTmpl',] }],
        iframe: [{ type: ViewChild, args: ['iframe',] }],
        contentEl: [{ type: ViewChild, args: ['content',] }],
        editorUiContainerER: [{ type: ViewChild, args: ["editorUiContainer",] }],
        editorUiContainerVCR: [{ type: ViewChild, args: ["editorUiContainer", { read: ViewContainerRef },] }]
    };
    return WfProcessEditorComponent;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var AssignPerformerConfigComponent = /** @class */ (function () {
    function AssignPerformerConfigComponent(cdr, localeId, resources, localePipe) {
        this.cdr = cdr;
        this.localeId = localeId;
        this.resources = resources;
        this.localePipe = localePipe;
        this.cls = 'farris-main-area flex-column';
        this.closeModal = new EventEmitter();
        this.submitModal = new EventEmitter();
        this.allowGlobalAssign = false;
        this.operatorCollection = [
            { text: this.localePipe.transform('component.assignPerformer.currentUser'), value: 'currentUser' },
            { text: this.localePipe.transform('component.assignPerformer.procInstCreator'), value: 'procInstCreator' }
        ];
        this.operator = 'currentUser';
        this.organizationLevelCollection = [
            { value: 'GLOBAL', text: this.localePipe.transform('component.assignPerformer.global'), orgId: 'global' },
            { value: 'UNIT', text: this.localePipe.transform('component.assignPerformer.currentUnit'), orgId: 'currentUnit' },
            { value: 'DEPARTMENT', text: this.localePipe.transform('component.assignPerformer.currentDepartment'), orgId: 'currentDepartment' }
        ];
        this.organizationLevel = this.organizationLevelCollection[0].value;
        this.includeChildren = false;
        this.modalConfig = {
            title: this.localePipe.transform('component.assignPerformer.assignPerformer'),
            width: 720,
            height: 490,
            showButtons: true
        };
        this.localePipe = this.localePipe || new WfLocalePipe(localeId, resources);
    }
    Object.defineProperty(AssignPerformerConfigComponent.prototype, "value", {
        set: /**
         * @param {?} v
         * @return {?}
         */
        function (v) {
            this.assingPerformerConfigForm = new FormGroup({
                multiSelect: new FormControl(v.multiSelect),
                necessary: new FormControl(v.necessary)
            });
            this.operator = v.operator || 'currentUser';
            this.allowGlobalAssign = v.allowGlobalAssign || false;
            if (v.assignScope) {
                this.organizationLevel = v.assignScope.organizationLevel;
                this.includeChildren = v.assignScope.includeChildren;
            }
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    AssignPerformerConfigComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
    };
    /**
     * @return {?}
     */
    AssignPerformerConfigComponent.prototype.clickOK = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.config = {
            operator: this.operator,
            multiSelect: this.assingPerformerConfigForm.get('multiSelect').value,
            necessary: this.assingPerformerConfigForm.get('necessary').value,
            allowGlobalAssign: this.allowGlobalAssign
        };
        if (this.allowGlobalAssign && this.organizationLevel !== this.organizationLevelCollection[0].value) {
            /** @type {?} */
            var potential = new OrganizationPotentialOwner();
            potential.actionScope = ActionScope$2.AssignUser;
            potential.organizationLevel = (/** @type {?} */ (this.organizationLevel));
            potential.organizationId = this.organizationLevelCollection.find((/**
             * @param {?} o
             * @return {?}
             */
            function (o) { return o.value === _this.organizationLevel; })).orgId;
            potential.organizationName = this.organizationLevelCollection.find((/**
             * @param {?} o
             * @return {?}
             */
            function (o) { return o.value === _this.organizationLevel; })).text;
            potential.includeChildren = this.includeChildren;
            potential.tag = 'variable';
            this.config.assignScope = potential;
        }
        /** @type {?} */
        var object = { value: this.config, parameters: null };
        this.submitModal.emit(object);
    };
    /**
     * @return {?}
     */
    AssignPerformerConfigComponent.prototype.clickCancel = /**
     * @return {?}
     */
    function () {
        this.closeModal.emit();
    };
    /**
     * @param {?} event
     * @return {?}
     */
    AssignPerformerConfigComponent.prototype.valueChange = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        switch (event.value) {
            case this.organizationLevelCollection[0].value:
                this.includeChildren = false;
                break;
            case this.organizationLevelCollection[1].value:
                this.includeChildren = true;
                break;
            case this.organizationLevelCollection[2].value:
                this.includeChildren = false;
                break;
        }
    };
    AssignPerformerConfigComponent.decorators = [
        { type: Component, args: [{
                    selector: 'app-assign-performer-config',
                    template: "<div class=\"f-page\">\r\n  <section class=\"f-page-main d-flex flex-column\">\r\n    <farris-section class=\"pt-0 f-section-form f-section-in-mainsubcard\" mainTitle=\"{{'component.assignPerformer.assignPerformer'|wfLocale}}\" [enableAccordion]=\"'default'\"\r\n      [enableMaximize]=\"false\">\r\n      <div class=\"f-form-layout farris-form farris-form-controls-inline\">\r\n        <fieldset class=\"f-section-formgroup\">\r\n          <div class=\"f-section-formgroup-inputs\">\r\n            <div class=\"col-12\">\r\n              <div class=\"farris-group-wrap\">\r\n                <div class=\"form-group\">\r\n                  <label class=\"col-form-label\">\r\n                    <span class=\"farris-label-text\">{{'component.assignPerformer.operator'|wfLocale}}</span>\r\n                  </label>\r\n                  <div class=\"farris-input-wrap\" style=\"width: 300px;\">\r\n                    <farris-combo-list [(ngModel)]=\"operator\" name=\"operator\" [ngModelOptions]=\"{standalone: true}\"\r\n                      [idField]=\"'value'\" [textField]=\"'text'\" [valueField]=\"'value'\" [data]=\"operatorCollection\"\r\n                      [panelHeight]=\"60\">\r\n                    </farris-combo-list>\r\n                    <div class=\"farris-feedback valid-feedback\"></div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div class=\"col-6\">\r\n              <div class=\"farris-group-wrap ml-2 pl-4\">\r\n                <div class=\"form-group farris-form-group\">\r\n                  <div class=\"farris-input-wrap\">\r\n                    <div class=\"custom-control custom-checkbox\">\r\n                      <input class=\"custom-control-input\" type=\"checkbox\" id=\"multiSelect\" formControlName=\"multiSelect\"\r\n                        [readOnly]=\"false\" />\r\n                      <label class=\"custom-control-label\" for=\"multiSelect\">{{'component.assignPerformer.multiSelect'|wfLocale}}</label>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div class=\"col-6\">\r\n              <div class=\"farris-group-wrap\">\r\n                <div class=\"form-group farris-form-group\">\r\n                  <div class=\"farris-input-wrap\">\r\n                    <div class=\"custom-control custom-checkbox\">\r\n                      <input class=\"custom-control-input\" type=\"checkbox\" id=\"necessary\" formControlName=\"necessary\" [readOnly]=\"false\" />\r\n                      <label class=\"custom-control-label\" for=\"necessary\">{{'component.assignPerformer.necessary'|wfLocale}}</label>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </fieldset>\r\n      </div>\r\n    </farris-section>\r\n    <!-- <farris-section class=\"pt-0 f-section-form f-section-in-mainsubcard\" [mainTitle]=\"'\u5907\u9009\u8303\u56F4'\" [enableAccordion]=\"'default'\"\r\n      [enableMaximize]=\"false\">\r\n      <div class=\"f-form-layout farris-form farris-form-controls-inline\">\r\n        <fieldset class=\"f-section-formgroup\">\r\n          <div class=\"f-section-formgroup-inputs\">\r\n            <div class=\"col-12\">\r\n              <div class=\"farris-group-wrap ml-2 pl-4\">\r\n                <div class=\"form-group\">\r\n                  <div class=\"farris-input-wrap\" style=\"width: 300px;\">\r\n                    <farris-radiogroup [(ngModel)]=\"assignScope\" [data]=\"assignScopeList\" name=\"assignScope\"\r\n                      [horizontal]=\"true\">\r\n                    </farris-radiogroup>\r\n                    <div class=\"farris-feedback valid-feedback\"></div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </fieldset>\r\n      </div>\r\n    </farris-section>\r\n    <farris-section class=\"pt-0 f-section-grid f-section-in-managelist\" [mainTitle]=\"'\u5907\u9009\u8303\u56F4'\" [enableAccordion]=\"'default'\"\r\n      [enableMaximize]=\"false\" style=\"height: 200px;\">\r\n      <app-performer [type]=\"'assignPerformer'\"></app-performer>\r\n    </farris-section> -->\r\n  </section>\r\n</div>\r\n\r\n<!--\r\n<div class=\"f-page\">\r\n  <div class=\"f-utils-fill-flex-column farris-split-section m-2 h-100\">\r\n    <section class=\"f-utils-fill-flex-column h-100\">\r\n      <div class=\"f-section-header pt-2 mx-2\">\r\n        <div class=\"f-title\">\r\n          <h4 class=\"f-title-text\">\u6307\u6D3E\u89C4\u5219\u9009\u9879</h4>\r\n        </div>\r\n      </div>\r\n      <div class=\"f-utils-fill-flex-column h-100\">\r\n        <form class=\"h-100\" [formGroup]=\"assingPerformerConfigForm\">\r\n          <div class=\"f-utils-fill-flex-column justify-content-center h-100 pb-4\">\r\n            <div class=\"my-2 mx-5\">\r\n              <div class=\"farris-group-wrap\">\r\n                <div class=\"form-group\">\r\n                  <label class=\"col-form-label\">\r\n                    <span class=\"farris-label-text\">\u6307\u6D3E\u64CD\u4F5C\u4EBA</span>\r\n                  </label>\r\n                  <div class=\"farris-input-wrap mt-1\" style=\"width: 300px;\">\r\n                    <farris-combo-list [(ngModel)]=\"operator\" name=\"operator\" [ngModelOptions]=\"{standalone: true}\"\r\n                      [idField]=\"'value'\" [textField]=\"'text'\" [valueField]=\"'value'\" [data]=\"operatorCollection\"\r\n                      [panelHeight]=\"60\">\r\n                    </farris-combo-list>\r\n                    <div class=\"farris-feedback valid-feedback\"></div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div class=\"my-2 mx-5\">\r\n              <div class=\"farris-input-wrap\">\r\n                <div class=\"custom-control custom-checkbox\">\r\n                  <input class=\"custom-control-input\" type=\"checkbox\" id=\"multiSelect\" formControlName=\"multiSelect\"\r\n                    [readOnly]=\"false\" />\r\n                  <label class=\"custom-control-label\" for=\"multiSelect\">\u5141\u8BB8\u9009\u62E9\u591A\u4E2A\u5F85\u9009\u7528\u6237</label>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div class=\"my-2 mx-5\">\r\n              <div class=\"farris-input-wrap\">\r\n                <div class=\"custom-control custom-checkbox\">\r\n                  <input class=\"custom-control-input\" type=\"checkbox\" id=\"necessary\" formControlName=\"necessary\" [readOnly]=\"false\" />\r\n                  <label class=\"custom-control-label\" for=\"necessary\">\u53EA\u6709\u4E00\u4E2A\u5F85\u9009\u7528\u6237\u65F6\uFF0C\u4ECD\u9700\u624B\u5DE5\u9009\u62E9</label>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div class=\"mx-2 mt-3\">\r\n              <div class=\"title-content\">\r\n                <h4 class=\"title-text\">\u8BBE\u5B9A\u7684\u53C2\u4E0E\u8005\u8303\u56F4\u5916\u6307\u6D3E</h4><span class=\"title-line\"></span>\r\n              </div>\r\n            </div>\r\n            <div class=\"farris-form form-inline farris-form-inline my-1\">\r\n              <div class=\"col-12 mt-3\">\r\n                <div class=\"farris-group-wrap\">\r\n                  <div class=\"form-group farris-form-group\">\r\n                    <label class=\"col-form-label\">\r\n                      <span class=\"farris-label-text\">\u662F\u5426\u542F\u7528</span>\r\n                    </label>\r\n                    <div class=\"farris-input-wrap ml-1\">\r\n                      <farris-switch [(ngModel)]=\"allowGlobalAssign\" [ngModelOptions]=\"{standalone: true}\" name=\"allowGlobalAssign\"></farris-switch>\r\n                      <div class=\"farris-feedback valid-feedback\"></div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <div class=\"d-flex flex-row\">\r\n                <div class=\"col-8 my-2\">\r\n                  <div class=\"farris-group-wrap\">\r\n                    <div class=\"form-group farris-form-group\">\r\n                      <label class=\"col-form-label\">\r\n                        <span class=\"farris-label-text\">\u7EC4\u7EC7\u8303\u56F4</span>\r\n                      </label>\r\n                      <div class=\"farris-input-wrap ml-1\">\r\n                        <farris-combo-list [panelHeight]=\"100\" [(ngModel)]=\"organizationLevel\" [ngModelOptions]=\"{standalone: true}\"\r\n                          name=\"organizationLevel\" [idField]=\"'value'\" [textField]=\"'text'\" [valueField]=\"'value'\"\r\n                          [data]=\"organizationLevelCollection\" [readonly]=\"allowGlobalAssign===false\" (valueChange)=\"valueChange($event)\">\r\n                        </farris-combo-list>\r\n                        <div class=\"farris-feedback valid-feedback\"></div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n                <div class=\"col-4 my-2\">\r\n                  <div class=\"farris-input-wrap pt-1\">\r\n                    <div class=\"custom-control custom-checkbox mr-3\">\r\n                      <input class=\"custom-control-input\" type=\"checkbox\" [(ngModel)]=\"includeChildren\" [ngModelOptions]=\"{standalone: true}\"\r\n                        name=\"includeChildren\" id=\"includeChildren\" [disabled]=\"!(allowGlobalAssign===true && organizationLevel === organizationLevelCollection[2].value)\" />\r\n                      <label class=\"custom-control-label\" for=\"includeChildren\">\u5305\u542B\u4E0B\u7EA7</label>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </section>\r\n  </div>\r\n</div> -->\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type=\"button\" class=\"btn btn-secondary btn-sm px-3 mx-2\" (click)=\"clickCancel()\">{{'component.assignPerformer.clickCancel'|wfLocale}}</button>\r\n  <button type=\"button\" class=\"btn btn-primary btn-sm px-3 mx-2\" (click)=\"clickOK()\">{{'component.assignPerformer.clickOK'|wfLocale}}</button>\r\n</ng-template>\r\n\r\n",
                    providers: [
                        WfLocalePipe,
                    ],
                    styles: [".title-content{color:#000;display:inline-flex;align-items:center;line-height:1.375rem;position:relative;overflow:hidden;padding:0 0 0 1rem;min-width:415px}.title-content ::before{content:'';width:.25rem;height:1.125rem;background:#59a1ff;border-radius:1px;position:absolute;top:50%;left:0;margin-top:-.5625rem}.title-text{font-size:1rem;line-height:1.375rem;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;margin-bottom:0;margin-right:10px}.title-line{flex-grow:1;border-bottom:1px dashed rgba(0,0,0,.1)}"]
                }] }
    ];
    /** @nocollapse */
    AssignPerformerConfigComponent.ctorParameters = function () { return [
        { type: ChangeDetectorRef, decorators: [{ type: Optional }] },
        { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
        { type: undefined, decorators: [{ type: Inject, args: [WF_LANG_RESOURCES,] }] },
        { type: WfLocalePipe, decorators: [{ type: Optional }] }
    ]; };
    AssignPerformerConfigComponent.propDecorators = {
        cls: [{ type: HostBinding, args: ['class',] }],
        closeModal: [{ type: Output }],
        submitModal: [{ type: Output }],
        value: [{ type: Input }],
        modalFooter: [{ type: ViewChild, args: ['iconSelectFooter',] }]
    };
    return AssignPerformerConfigComponent;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var JumpScopePipe = /** @class */ (function () {
    function JumpScopePipe() {
    }
    /**
     * @param {?} value
     * @param {?} nodeId
     * @return {?}
     */
    JumpScopePipe.prototype.transform = /**
     * @param {?} value
     * @param {?} nodeId
     * @return {?}
     */
    function (value, nodeId) {
        return value.filter((/**
         * @param {?} item
         * @return {?}
         */
        function (item) { return item.Id !== nodeId; }));
    };
    JumpScopePipe.decorators = [
        { type: Pipe, args: [{ name: 'jumpScopePipe' },] }
    ];
    return JumpScopePipe;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var UsersNamePipe = /** @class */ (function () {
    function UsersNamePipe() {
    }
    /**
     * @param {?} users
     * @param {?=} defaultVal
     * @return {?}
     */
    UsersNamePipe.prototype.transform = /**
     * @param {?} users
     * @param {?=} defaultVal
     * @return {?}
     */
    function (users, defaultVal) {
        if (defaultVal === void 0) { defaultVal = ''; }
        /** @type {?} */
        var r = '';
        users.forEach((/**
         * @param {?} u
         * @return {?}
         */
        function (u) {
            r += u.performerName + '，';
        }));
        if (r) {
            r = r.substring(0, r.length - 1);
        }
        return r ? r : defaultVal;
    };
    UsersNamePipe.decorators = [
        { type: Pipe, args: [{ name: 'usersName' },] }
    ];
    /** @nocollapse */
    UsersNamePipe.ctorParameters = function () { return []; };
    return UsersNamePipe;
}());
var UsersIdPipe = /** @class */ (function () {
    function UsersIdPipe() {
    }
    /**
     * @param {?} users
     * @param {?=} defaultVal
     * @return {?}
     */
    UsersIdPipe.prototype.transform = /**
     * @param {?} users
     * @param {?=} defaultVal
     * @return {?}
     */
    function (users, defaultVal) {
        if (defaultVal === void 0) { defaultVal = ''; }
        /** @type {?} */
        var r = '';
        users.forEach((/**
         * @param {?} u
         * @return {?}
         */
        function (u) {
            r += u.performerId + ',';
        }));
        if (r) {
            r = r.substring(0, r.length - 1);
        }
        return r ? r : defaultVal;
    };
    UsersIdPipe.decorators = [
        { type: Pipe, args: [{ name: 'usersId' },] }
    ];
    /** @nocollapse */
    UsersIdPipe.ctorParameters = function () { return []; };
    return UsersIdPipe;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/** @type {?} */
var PROCESS_DESIGNER_APP_PROVIDERS = [
    ProcessDesignerUIState,
    ProcessDesignerViewModel,
    BpmnProcessViewModel,
    WFFlowElementsViewModel,
    SubProcessViewModel,
    AutoActivityAdapter,
    CatchEventAdapter,
    MessageActivityAdapter,
    NotifyActivityAdapter,
    AifCreationBillActivityAdapter,
    BillNodeActivityAdapter,
    SequenceActivityAdapter,
];
/** @type {?} */
var PROCESS_DESIGNER_DOMAIN_PROVIDERS = [
    ProcessDesignerDataService
];
/** @type {?} */
var PROCESS_DESIGNER_PART_PROVIDERS = [];

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var CallActivitySubProcessComponent = /** @class */ (function () {
    function CallActivitySubProcessComponent(message, util, http, designerState, expr, cdr, localeId, resources, localePipe) {
        this.message = message;
        this.util = util;
        this.http = http;
        this.designerState = designerState;
        this.expr = expr;
        this.cdr = cdr;
        this.localeId = localeId;
        this.resources = resources;
        this.localePipe = localePipe;
        this.cls = 'farris-main-area flex-column';
        this.closeModal = new EventEmitter();
        this.submitModal = new EventEmitter();
        this.modalConfig = {
            title: this.localePipe.transform("component.subProcess.subProcessOpt"),
            width: 500,
            height: 380,
            showButtons: true
        };
        this.callActivitySubProcess = new CallActivitySubProcess$1();
        this.groupIcon = '<i class="f-icon f-icon-lookup"></i>';
        this.localePipe = this.localePipe || new WfLocalePipe(localeId, resources);
    }
    Object.defineProperty(CallActivitySubProcessComponent.prototype, "value", {
        set: /**
         * @param {?} v
         * @return {?}
         */
        function (v) {
            if (v) {
                this.callActivitySubProcess = v;
                this.getProcessDefKey(this.callActivitySubProcess.calledElement);
                this.getFlowForm(this.callActivitySubProcess.calledBizDefKey);
            }
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    CallActivitySubProcessComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
    };
    /**
     * @return {?}
     */
    CallActivitySubProcessComponent.prototype.clickOK = /**
     * @return {?}
     */
    function () {
        if (this.validator()) {
            /** @type {?} */
            var object = { value: this.callActivitySubProcess, parameters: null };
            this.submitModal.emit(object);
        }
    };
    /**
     * @return {?}
     */
    CallActivitySubProcessComponent.prototype.clickCancel = /**
     * @return {?}
     */
    function () {
        this.closeModal.emit();
    };
    /**
     * @param {?} args
     * @return {?}
     */
    CallActivitySubProcessComponent.prototype.processConfirm = /**
     * @param {?} args
     * @return {?}
     */
    function (args) {
        if (args) {
            this.callActivitySubProcess.calledElement = args.procDefKey;
            this.callActivitySubProcess.calledElementName = args.name;
        }
    };
    /**
     * @param {?} args
     * @return {?}
     */
    CallActivitySubProcessComponent.prototype.clearProcessDef = /**
     * @param {?} args
     * @return {?}
     */
    function (args) {
        this.callActivitySubProcess.calledElement = '';
        this.callActivitySubProcess.calledElementName = '';
    };
    /**
     * @param {?} args
     * @return {?}
     */
    CallActivitySubProcessComponent.prototype.flowFormConfirm = /**
     * @param {?} args
     * @return {?}
     */
    function (args) {
        if (args) {
            this.callActivitySubProcess.calledBizDefKey = args.id;
            this.callActivitySubProcess.calledBizDefName = args.name;
        }
    };
    /**
     * @param {?} args
     * @return {?}
     */
    CallActivitySubProcessComponent.prototype.clearFlowForm = /**
     * @param {?} args
     * @return {?}
     */
    function (args) {
        this.callActivitySubProcess.calledBizDefKey = '';
        this.callActivitySubProcess.calledBizDefName = '';
    };
    /**
     * @return {?}
     */
    CallActivitySubProcessComponent.prototype.setBizDataId = /**
     * @return {?}
     */
    function () {
        this.showExprHelp();
    };
    /**
     * @private
     * @return {?}
     */
    CallActivitySubProcessComponent.prototype.showExprHelp = /**
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        var e_1, _a, e_2, _b, e_3, _c;
        /** @type {?} */
        var context = new Array();
        // if(this.expr.exprEntity.contextEntities.find(x => x.key === 'CurrentLanguage')) {
        //   context.push(this.expr.exprEntity.contextEntities.find(x => x.key === 'CurrentLanguage'));
        // }
        // this.expr.clearContext();
        if (this.designerState.schemas.length > 0) {
            try {
                for (var _d = __values(this.designerState.schemas), _e = _d.next(); !_e.done; _e = _d.next()) {
                    var schema = _e.value;
                    this.expr.addSchema('Schema', schema);
                }
            }
            catch (e_1_1) { e_1 = { error: e_1_1 }; }
            finally {
                try {
                    if (_e && !_e.done && (_a = _d.return)) _a.call(_d);
                }
                finally { if (e_1) throw e_1.error; }
            }
            if (this.designerState.schemas[0].entityTypes && this.designerState.schemas[0].entityTypes.length > 0) {
                /** @type {?} */
                var entityType = this.designerState.schemas[0].entityTypes[0];
                this.expr.addInjectedEntity(entityType.name, 'Schema', entityType.name, InjectedType.EntityType);
            }
        }
        context = this.designerState.addContext(context);
        if (this.designerState.subActivityContext.length > 0) {
            try {
                for (var _f = __values(this.designerState.subActivityContext), _g = _f.next(); !_g.done; _g = _f.next()) {
                    var variable = _g.value;
                    context.push(variable);
                    // this.expr.addContext(variable);
                }
            }
            catch (e_2_1) { e_2 = { error: e_2_1 }; }
            finally {
                try {
                    if (_g && !_g.done && (_b = _f.return)) _b.call(_f);
                }
                finally { if (e_2) throw e_2.error; }
            }
        }
        if (context.length > 0) {
            try {
                for (var context_1 = __values(context), context_1_1 = context_1.next(); !context_1_1.done; context_1_1 = context_1.next()) {
                    var v = context_1_1.value;
                    this.expr.addContext(v);
                }
            }
            catch (e_3_1) { e_3 = { error: e_3_1 }; }
            finally {
                try {
                    if (context_1_1 && !context_1_1.done && (_c = context_1.return)) _c.call(context_1);
                }
                finally { if (e_3) throw e_3.error; }
            }
        }
        this.expr.addExpressionText(this.callActivitySubProcess.bizDataId);
        this.expr.buildExpression().then((/**
         * @param {?} expressioninfo
         * @return {?}
         */
        function (expressioninfo) {
            _this.callActivitySubProcess.bizDataId = expressioninfo;
            //点击确定后，去除表达式里面的新增的上下文变量
            if (context.length > 0) {
                _this.expr.exprEntity.contextEntities = _this.expr.exprEntity.contextEntities.filter((/**
                 * @param {?} x
                 * @return {?}
                 */
                function (x) { return !context.some((/**
                 * @param {?} y
                 * @return {?}
                 */
                function (y) { return y.key === x.key; })); }));
            }
        }));
    };
    /**
     * @param {?} bool
     * @return {?}
     */
    CallActivitySubProcessComponent.prototype.valueChange = /**
     * @param {?} bool
     * @return {?}
     */
    function (bool) {
        if (bool) {
            this.callActivitySubProcess.bizDataId = null;
        }
    };
    /**
     * @private
     * @return {?}
     */
    CallActivitySubProcessComponent.prototype.validator = /**
     * @private
     * @return {?}
     */
    function () {
        if (!this.callActivitySubProcess.inheritBizDataId && !this.callActivitySubProcess.bizDataId) {
            this.message.warning(this.localePipe.transform("component.subProcess.inheritBizDataId"));
            return false;
        }
        return true;
    };
    /**
     * @private
     * @param {?} key
     * @return {?}
     */
    CallActivitySubProcessComponent.prototype.getProcessDefKey = /**
     * @private
     * @param {?} key
     * @return {?}
     */
    function (key) {
        var _this = this;
        /** @type {?} */
        var url = this.util.getProcessDefinitionWebApi();
        if (key) {
            url += "/procDefKey/" + key;
            this.http.get(url).subscribe((/**
             * @param {?} re
             * @return {?}
             */
            function (re) {
                _this.callActivitySubProcess.calledElementName = re.name;
            }));
        }
    };
    /**
     * @private
     * @param {?} id
     * @return {?}
     */
    CallActivitySubProcessComponent.prototype.getFlowForm = /**
     * @private
     * @param {?} id
     * @return {?}
     */
    function (id) {
        var _this = this;
        /** @type {?} */
        var url = this.util.getFlowFormWebApi();
        if (id) {
            url += "/" + id;
            this.http.get(url).subscribe((/**
             * @param {?} re
             * @return {?}
             */
            function (re) {
                _this.callActivitySubProcess.calledBizDefName = re.name;
            }));
        }
    };
    CallActivitySubProcessComponent.decorators = [
        { type: Component, args: [{
                    selector: 'lib-call-activity-sub-process',
                    template: "<div class=\"f-page\">\r\n  <div class=\"f-utils-fill-flex-column farris-split-section m-2 h-100\">\r\n    <section class=\"f-utils-fill-flex-column h-100\">\r\n      <div class=\"f-section-header pt-2 mx-2\">\r\n        <div class=\"f-title\">\r\n          <h4 class=\"f-title-text\">{{'component.subProcess.setOption' | wfLocale}}</h4>\r\n        </div>\r\n      </div>\r\n      <div class=\"f-utils-fill-flex-column h-100\">\r\n        <form class=\"h-100\">\r\n          <div class=\"farris-form form-inline farris-form-inline\">\r\n            <div class=\"farris-group-wrap mt-1\">\r\n              <div class=\"form-group farris-form-group\">\r\n                <label class=\"col-form-label\">\r\n                  <span class=\"farris-label-text\">{{'component.subProcess.flowForm' | wfLocale}}</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap ml-1\">\r\n                  <wf-bizprocess-lookup title=\"{{'component.subProcess.flowForm' | wfLocale}}\" [sourceType]=\"'flowform'\" [displayTxt]=\"callActivitySubProcess.calledBizDefName\"\r\n                    (afterConfirm)=\"flowFormConfirm($event)\" (clear)=\"clearFlowForm($event)\">\r\n                  </wf-bizprocess-lookup>\r\n                  <div class=\"farris-feedback valid-feedback\"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div class=\"farris-group-wrap my-4\">\r\n              <div class=\"form-group farris-form-group\">\r\n                <label class=\"col-form-label\">\r\n                  <span class=\"farris-label-text\">{{'component.subProcess.processDef' | wfLocale}}</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap ml-1\">\r\n                  <wf-bizprocess-lookup title=\"{{'component.subProcess.processDef' | wfLocale}}\"  [displayTxt]=\"callActivitySubProcess.calledElementName\"\r\n                    (afterConfirm)=\"processConfirm($event)\" (clear)=\"clearProcessDef($event)\">\r\n                  </wf-bizprocess-lookup>\r\n                  <div class=\"farris-feedback valid-feedback\"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <!-- <div class=\"farris-group-wrap my-4\">\r\n              <div class=\"form-group farris-form-group\">\r\n                <label class=\"col-form-label\">\r\n                  <span class=\"farris-label-info text-danger\">*</span>\r\n                  <span class=\"farris-label-text\">\u7EE7\u627F\u53D8\u91CF</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap ml-1\">\r\n                  <farris-switch [(ngModel)]=\"callActivitySubProcess.inheritVariables\" name=\"inheritVariables\">\r\n                  </farris-switch>\r\n                  <div class=\"farris-feedback valid-feedback\"></div>\r\n                </div>\r\n              </div>\r\n            </div> -->\r\n            <div class=\"farris-group-wrap my-4\">\r\n              <div class=\"form-group farris-form-group\">\r\n                <label class=\"ml-4 pl-3\">\r\n                  <span class=\"farris-label-text\">{{'component.subProcess.SameParentProcess' | wfLocale}}</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap ml-3\">\r\n                  <farris-switch  [(ngModel)]=\"callActivitySubProcess.inheritBizDataId\" name=\"inheritBizDataId\"\r\n                    (valueChange)=\"valueChange($event)\">\r\n                  </farris-switch>\r\n                  <div class=\"farris-feedback valid-feedback\"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div *ngIf=\"!callActivitySubProcess.inheritBizDataId\" class=\"farris-group-wrap\">\r\n              <div class=\"form-group farris-form-group\">\r\n                <label class=\"ml-4 pl-3\">\r\n                  <span class=\"farris-label-text\">{{'component.subProcess.setBizDataId' | wfLocale}}</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap ml-3\">\r\n                  <input-group class=\"form-control\" style=\"width: 100%;padding:0;border:0;\" [enableClear]=\"false\"\r\n                    [ngModel]=\"callActivitySubProcess.bizDataId\" name=\"bizDataId\"\r\n                    [editable]=\"false\" (clickHandle)=\"setBizDataId()\" [groupText]=\"groupIcon\"></input-group>\r\n                  <div class=\"farris-feedback valid-feedback\"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </section>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type=\"button\" class=\"btn btn-secondary btn-sm mx-2\" (click)=\"clickCancel()\">{{'component.subProcess.clickCancel' | wfLocale}}</button>\r\n  <button type=\"button\" class=\"btn btn-primary btn-sm mx-2\" (click)=\"clickOK()\">{{'component.subProcess.clickOk' | wfLocale}}</button>\r\n</ng-template>\r\n",
                    providers: [
                        WfLocalePipe,
                    ],
                    styles: [""]
                }] }
    ];
    /** @nocollapse */
    CallActivitySubProcessComponent.ctorParameters = function () { return [
        { type: MessagerService },
        { type: ProcessDeUtil },
        { type: HttpService },
        { type: ProcessDesignerUIState },
        { type: ExpressionService },
        { type: ChangeDetectorRef, decorators: [{ type: Optional }] },
        { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
        { type: undefined, decorators: [{ type: Inject, args: [WF_LANG_RESOURCES,] }] },
        { type: WfLocalePipe, decorators: [{ type: Optional }] }
    ]; };
    CallActivitySubProcessComponent.propDecorators = {
        cls: [{ type: HostBinding, args: ['class',] }],
        value: [{ type: Input }],
        closeModal: [{ type: Output }],
        submitModal: [{ type: Output }],
        modalFooter: [{ type: ViewChild, args: ['iconSelectFooter',] }]
    };
    return CallActivitySubProcessComponent;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/** @enum {number} */
var VOTemplateType = {
    /**来自于BE的VO */
    FromBE: 0,
    /**来自于VO的VO，即VO代理 */
    FromVO: 1,
    /**没有来源的VO，即虚拟VO */
    FromNone: 2,
};
VOTemplateType[VOTemplateType.FromBE] = 'FromBE';
VOTemplateType[VOTemplateType.FromVO] = 'FromVO';
VOTemplateType[VOTemplateType.FromNone] = 'FromNone';

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var CommonModelTypeHelper = /** @class */ (function () {
    function CommonModelTypeHelper() {
    }
    /**
     * @param {?} cm
     * @return {?}
     */
    CommonModelTypeHelper.getCommonModelType = /**
     * @param {?} cm
     * @return {?}
     */
    function (cm) {
        /** @type {?} */
        var type = CommonModelUtil.GetGeneratedConfigID((/** @type {?} */ (cm)));
        type = "com." + type;
        return type;
    };
    /**
     * 判断VO来源于BE还是VO或者完全虚拟
     * @param gspViewModel
     */
    /**
     * 判断VO来源于BE还是VO或者完全虚拟
     * @param {?} gspViewModel
     * @return {?}
     */
    CommonModelTypeHelper.judgeVoTemplateType = /**
     * 判断VO来源于BE还是VO或者完全虚拟
     * @param {?} gspViewModel
     * @return {?}
     */
    function (gspViewModel) {
        if (gspViewModel.IsVirtual === true) {
            if (gspViewModel.TemplateVoInfo && gspViewModel.TemplateVoInfo.TemplateVoId != null) {
                return VOTemplateType.FromVO;
            }
            else {
                return VOTemplateType.FromNone;
            }
        }
        else {
            return VOTemplateType.FromBE;
        }
    };
    return CommonModelTypeHelper;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var ProcHelpQuerySolutionComponent = /** @class */ (function () {
    function ProcHelpQuerySolutionComponent(procHelpService, messager, notify, metadataService, modalService, injector, resolver, localePipe) {
        this.procHelpService = procHelpService;
        this.messager = messager;
        this.notify = notify;
        this.metadataService = metadataService;
        this.modalService = modalService;
        this.injector = injector;
        this.resolver = resolver;
        this.localePipe = localePipe;
        this.groupIcon = '<i class="f-icon f-icon-lookup"></i>';
        this.queryParamChange = new EventEmitter();
        this.onSearchEmitter = new EventEmitter();
        this.comboSysInitIdField = "value";
        this.comboSysInitValueField = "value";
        this.comboSysInitTextField = "text";
        this.comboSysInitData = [
            { value: "", text: this.localePipe.transform("all") },
            { value: "true", text: this.localePipe.transform("yes") },
            { value: "false", text: this.localePipe.transform("no") },
        ];
    }
    /**
     * @return {?}
     */
    ProcHelpQuerySolutionComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
    };
    /**
     * @param {?} name
     * @return {?}
     */
    ProcHelpQuerySolutionComponent.prototype.processNameChange = /**
     * @param {?} name
     * @return {?}
     */
    function (name) {
        this.queryParam.filterArgs.name = new TextValue();
        this.queryParam.filterArgs.name.hasValue = true;
        this.queryParam.filterArgs.name.value = name;
        this.queryParam.filterArgsExt.name = name;
    };
    /**
     * @param {?} __0
     * @return {?}
     */
    ProcHelpQuerySolutionComponent.prototype.processTypeChange = /**
     * @param {?} __0
     * @return {?}
     */
    function (_a) {
        var selections = _a.selections;
        /** @type {?} */
        var item = selections[0];
        this.queryParam.filterArgs.billProcessType = new TextValue();
        if (item != null) {
            if (item.value != "") {
                this.queryParam.filterArgs.billProcessType.hasValue = true;
            }
            this.queryParam.filterArgs.billProcessType.value = item.value;
        }
    };
    /**
     * @param {?} __0
     * @return {?}
     */
    ProcHelpQuerySolutionComponent.prototype.enabledStateChange = /**
     * @param {?} __0
     * @return {?}
     */
    function (_a) {
        var selections = _a.selections;
        /** @type {?} */
        var item = selections[0];
        this.queryParam.filterArgs.isEnabled = new TextValue();
        if (item != null) {
            if (item.value != "") {
                this.queryParam.filterArgs.isEnabled.hasValue = true;
            }
            this.queryParam.filterArgs.isEnabled.value = String(item.value);
        }
    };
    /**
     * @param {?} __0
     * @return {?}
     */
    ProcHelpQuerySolutionComponent.prototype.sysInitChange = /**
     * @param {?} __0
     * @return {?}
     */
    function (_a) {
        var selections = _a.selections;
        /** @type {?} */
        var item = selections[0];
        this.queryParam.filterArgs.sysInit = new TextValue();
        if (item != null) {
            if (item.value != "") {
                this.queryParam.filterArgs.sysInit.hasValue = true;
            }
            this.queryParam.filterArgs.sysInit.value = String(item.value);
        }
    };
    /**
     * 打开上游单据VO选择器
     */
    /**
     * 打开上游单据VO选择器
     * @return {?}
     */
    ProcHelpQuerySolutionComponent.prototype.selectUpBill = /**
     * 打开上游单据VO选择器
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var compFactory = this.resolver.resolveComponentFactory(SelectMetadataRTComponent);
        /** @type {?} */
        var compRef = compFactory.create(this.injector);
        compRef.instance.typeList = "GSPViewModel";
        compRef.instance.selectedMetadata.subscribe((/**
         * @param {?} metadata4RefDto
         * @return {?}
         */
        function (metadata4RefDto) {
            _this.clearUpBill();
            /** @type {?} */
            var upVODto = metadata4RefDto.metadata;
            /** @type {?} */
            var upVO = JSON.parse(upVODto.content);
            switch (CommonModelTypeHelper.judgeVoTemplateType(upVO)) {
                //非代理VO
                case VOTemplateType.FromBE:
                    {
                        _this.queryParam.filterArgs.upBillVoId = new TextValue();
                        _this.queryParam.filterArgs.upBillVoId.hasValue = true;
                        _this.queryParam.filterArgs.upBillVoId.value = upVO.ID;
                        _this.queryParam.filterArgsExt.upBillVoName = upVO.MainObject.Name;
                    }
                    break;
                default:
                    _this.notify.error(_this.localePipe.transform("pleaseSelectNonVirtualVO"));
                    break;
            }
        }), (/**
         * @param {?} err
         * @return {?}
         */
        function (err) {
            console.error(err);
            //todo 确定异常结构, 目前采用兼容取值方式
            _this.messager.error(err.error == null ? err.message : (err.error.Message || err.error.message || err.message));
            _this.clearUpBill();
        }));
        /** @type {?} */
        var modalConfig = {
            title: this.localePipe.transform("billSelector"),
            width: 930,
            height: 573,
            showButtons: false
        };
        /** @type {?} */
        var dialog = this.modalService.show(compRef, modalConfig);
        compRef.instance.closeModalEmitter.subscribe((/**
         * @param {?} $event
         * @return {?}
         */
        function ($event) { return dialog.close(); }));
    };
    /**
     * 打开下游单据VO选择器
     */
    /**
     * 打开下游单据VO选择器
     * @return {?}
     */
    ProcHelpQuerySolutionComponent.prototype.selectDownBill = /**
     * 打开下游单据VO选择器
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var compFactory = this.resolver.resolveComponentFactory(SelectMetadataRTComponent);
        /** @type {?} */
        var compRef = compFactory.create(this.injector);
        compRef.instance.typeList = "GSPViewModel";
        compRef.instance.selectedMetadata.subscribe((/**
         * @param {?} metadata4RefDto
         * @return {?}
         */
        function (metadata4RefDto) {
            _this.clearDownBill();
            /** @type {?} */
            var downVODto = metadata4RefDto.metadata;
            /** @type {?} */
            var downVO = JSON.parse(downVODto.content);
            switch (CommonModelTypeHelper.judgeVoTemplateType(downVO)) {
                //非代理VO
                case VOTemplateType.FromBE:
                    {
                        _this.queryParam.filterArgs.downBillVoId = new TextValue();
                        _this.queryParam.filterArgs.downBillVoId.hasValue = true;
                        _this.queryParam.filterArgs.downBillVoId.value = downVO.ID;
                        _this.queryParam.filterArgsExt.downBillVoName = downVO.MainObject.Name;
                    }
                    break;
                default:
                    _this.notify.error(_this.localePipe.transform("pleaseSelectNonVirtualVO"));
                    break;
            }
        }), (/**
         * @param {?} err
         * @return {?}
         */
        function (err) {
            console.error(err);
            //todo 确定异常结构, 目前采用兼容取值方式
            _this.messager.error(err.error == null ? err.message : (err.error.Message || err.error.message || err.message));
            _this.clearUpBill();
        }));
        /** @type {?} */
        var modalConfig = {
            title: this.localePipe.transform("billSelector"),
            width: 930,
            height: 573,
            showButtons: false
        };
        /** @type {?} */
        var dialog = this.modalService.show(compRef, modalConfig);
        compRef.instance.closeModalEmitter.subscribe((/**
         * @param {?} $event
         * @return {?}
         */
        function ($event) { return dialog.close(); }));
    };
    /**
     * 清除流程名称
     */
    /**
     * 清除流程名称
     * @return {?}
     */
    ProcHelpQuerySolutionComponent.prototype.clearProcessName = /**
     * 清除流程名称
     * @return {?}
     */
    function () {
        delete this.queryParam.filterArgs.name;
        this.queryParam.filterArgsExt.name = null;
    };
    /**
     * 清除选中的流程类型
     */
    /**
     * 清除选中的流程类型
     * @return {?}
     */
    ProcHelpQuerySolutionComponent.prototype.clearProcessType = /**
     * 清除选中的流程类型
     * @return {?}
     */
    function () {
        delete this.queryParam.filterArgs.billProcessType;
    };
    /**
     * 清除选中的上游单据信息
     */
    /**
     * 清除选中的上游单据信息
     * @return {?}
     */
    ProcHelpQuerySolutionComponent.prototype.clearUpBill = /**
     * 清除选中的上游单据信息
     * @return {?}
     */
    function () {
        delete this.queryParam.filterArgs.upBillVoId;
        this.queryParam.filterArgsExt.upBillVoName = null;
    };
    /**
     * 清除选中的下游单据信息
     */
    /**
     * 清除选中的下游单据信息
     * @return {?}
     */
    ProcHelpQuerySolutionComponent.prototype.clearDownBill = /**
     * 清除选中的下游单据信息
     * @return {?}
     */
    function () {
        delete this.queryParam.filterArgs.downBillVoId;
        this.queryParam.filterArgsExt.downBillVoName = null;
    };
    /**
     * 清除选中的启用状态
     */
    /**
     * 清除选中的启用状态
     * @return {?}
     */
    ProcHelpQuerySolutionComponent.prototype.clearIsEnabled = /**
     * 清除选中的启用状态
     * @return {?}
     */
    function () {
        delete this.queryParam.filterArgs.isEnabled;
    };
    /**
     * 清除选中的发布状态
     */
    /**
     * 清除选中的发布状态
     * @return {?}
     */
    ProcHelpQuerySolutionComponent.prototype.clearIsPublished = /**
     * 清除选中的发布状态
     * @return {?}
     */
    function () {
        // delete this.queryParam.filterArgs.isPublished;
    };
    /**
     * 清除选中的发布状态
     */
    /**
     * 清除选中的发布状态
     * @return {?}
     */
    ProcHelpQuerySolutionComponent.prototype.clearSysInit = /**
     * 清除选中的发布状态
     * @return {?}
     */
    function () {
        delete this.queryParam.filterArgs.sysInit;
    };
    /**
     * 点击筛选按钮
     */
    /**
     * 点击筛选按钮
     * @return {?}
     */
    ProcHelpQuerySolutionComponent.prototype.clickBtnFilter = /**
     * 点击筛选按钮
     * @return {?}
     */
    function () {
        this.queryParam.filterArgs.pageIndex = 0;
        this.onSearchEmitter.emit(this.queryParam);
    };
    /**
     * 点击清空按钮
     */
    /**
     * 点击清空按钮
     * @return {?}
     */
    ProcHelpQuerySolutionComponent.prototype.clickBtnClear = /**
     * 点击清空按钮
     * @return {?}
     */
    function () {
        //重置下拉框
        // this.comboProcessType.onClear();
        // this.comboProcessTypeData = this.comboProcessTypeData.map(item => ({ ...item }));
        //重置下拉框
        // this.comboProcessType.onClear();
        // this.comboProcessTypeData = this.comboProcessTypeData.map(item => ({ ...item }));
        // this.comboEnabledState.onClear();
        // this.comboEnabledStateData = this.comboEnabledStateData.map(item => ({ ...item }));
        // this.comboSysInit.onClear();
        // this.comboSysInitData = this.comboSysInitData.map(item => ({ ...item }));
        // this.comboPublishedState.onClear();
        // this.comboPublishedStateData = this.comboPublishedStateData.map(item => ({ ...item }));
        //重置查询参数
        // const queryParam = {
        //   filterArgs: new ProcessFilterConditionArgs(),
        //   filterArgsExt: {}
        // };
        // queryParam.filterArgs.LoadFromJsonObject(this.queryParam.filterArgs.ConvertToJsonObject());
        /** @type {?} */
        var queryParam = this.queryParam;
        queryParam.filterArgsExt = {};
        queryParam.filterArgs.upBillVoId = null;
        queryParam.filterArgs.downBillVoId = null;
        queryParam.filterArgs.sysInit = null;
        queryParam.filterArgs.name = null;
        // queryParam.filterArgs.pageSize = this.queryParam.filterArgs.pageSize;
        // queryParam.filterArgs.pageIndex = this.queryParam.filterArgs.pageIndex;
        // queryParam.filterArgs.orderByCode = this.queryParam.filterArgs.orderByCode;
        // queryParam.filterArgs.orderByName = this.queryParam.filterArgs.orderByName;
        // queryParam.filterArgs.OrderByLastModifiedTime = this.queryParam.filterArgs.OrderByLastModifiedTime;
        this.queryParam = queryParam;
    };
    ProcHelpQuerySolutionComponent.decorators = [
        { type: Component, args: [{
                    selector: 'app-proc-help-query-solution',
                    template: "<farris-section #sectionQuerySolution class=\"f-section-scheme f-section-in-managelist\" [expandStatus]=\"true\"\r\n  [enableMaximize]=\"false\" [enableAccordion]=\"''\" mainTitle=\"{{ 'querySolution' | aifLocale }}\" [fill]=\"false\"\r\n  [showHeader]=\"true\">\r\n  <ng-template farrisSectionTitle>\r\n    <div\r\n      style=\"border-radius: 6px; padding: 5px 12px; background: linear-gradient(-51deg, rgb(42, 135, 255, 0.2) 0%, rgb(50, 139, 255, 0.2) 100%);\">\r\n      <span style=\"font-size: 13px;color: #2A87FF;line-height: 16px;\">{{ 'querySolution' | aifLocale }}</span>\r\n    </div>\r\n  </ng-template>\r\n\r\n  <ng-template farrisSectionToolbar>\r\n    <div class=\"query-solution\">\r\n      <div class=\"solution-action\">\r\n        <ng-container *ngIf=\"sectionQuerySolution.expandStatus == true\">\r\n          <div class=\"btn-group\">\r\n            <button class=\"btn btn-primary\" (click)=\"clickBtnFilter()\">{{ 'filter' | aifLocale }}</button>\r\n          </div>\r\n          <div class=\"icon-group\">\r\n            <span class=\"icon-group-remove\" title=\"{{'clear' | aifLocale}}\" (click)=\"clickBtnClear()\">\r\n              <span class=\"f-icon f-icon-remove\"></span>\r\n            </span>\r\n            <span class=\"divide\"></span>\r\n            <span class=\"icon-group-setup\" *ngIf=\"false\">\r\n              <span class=\"f-icon f-icon-home-setup\"></span>\r\n            </span>\r\n            <span class=\"icon-group-packup\" title=\"{{ 'collapse' | aifLocale }}\"\r\n              (click)=\"sectionQuerySolution.expandStatus = false\">\r\n              <span class=\"f-icon f-icon-packup\"></span>\r\n            </span>\r\n          </div>\r\n        </ng-container>\r\n        <ng-container *ngIf=\"sectionQuerySolution.expandStatus == false\">\r\n          <div class=\"icon-group\">\r\n            <span class=\"icon-group-packup\" title=\"{{ 'expand' | aifLocale }}\"\r\n              (click)=\"sectionQuerySolution.expandStatus = true\">\r\n              <span class=\"f-icon f-icon-packup\" style=\"transform: rotate(180deg);\"></span>\r\n            </span>\r\n          </div>\r\n        </ng-container>\r\n      </div>\r\n    </div>\r\n  </ng-template>\r\n\r\n  <div class=\"form f-form-layout farris-form farris-form-controls-inline\"\r\n    *ngIf=\"sectionQuerySolution.expandStatus == true\">\r\n    <!-- \u6D41\u7A0B\u540D\u79F0 -->\r\n    <div class=\"col-12 col-md-6 col-xl-3\">\r\n      <div class=\"farris-group-wrap\">\r\n        <div class=\"form-group farris-form-group\">\r\n          <label for=\"\" class=\"col-form-label\" title=\"{{'processName' | aifLocale}}\">\r\n            <span class=\"farris-label-text\">{{\"processName\" | aifLocale}}</span>\r\n          </label>\r\n          <div class=\"farris-input-wrap\">\r\n            <input-group [ngModel]=\"queryParam.filterArgsExt.name\" (valueChange)=\"processNameChange($event)\"\r\n              (clear)=\"clearProcessName()\">\r\n            </input-group>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- \u6D41\u7A0B\u7C7B\u578B -->\r\n    <!-- <div class=\"col-12 col-md-6 col-xl-3\" *ngIf=\"true\">\r\n      <div class=\"farris-group-wrap\">\r\n        <div class=\"form-group farris-form-group\">\r\n          <label for=\"\" class=\"col-form-label\" title=\"{{'processType' | aifLocale}}\">\r\n            <span class=\"farris-label-text\">{{\"processType\" | aifLocale}}</span>\r\n          </label>\r\n          <div class=\"farris-input-wrap\">\r\n            <farris-combo-list #comboProcessType [ngModel]=\"queryParam.filterArgs.billProcessType?.value\"\r\n              [idField]=\"comboProcessTypeIdField\" [valueField]=\"comboProcessTypeValueField\"\r\n              [textField]=\"comboProcessTypeTextField\" [data]=\"comboProcessTypeData\" (clear)=\"clearProcessType()\"\r\n              (valueChange)=\"processTypeChange($event)\" [editable]=\"false\"></farris-combo-list>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div> -->\r\n\r\n    <!-- \u4E0A\u6E38\u5355\u636E -->\r\n    <div class=\"col-12 col-md-6 col-xl-3\">\r\n      <div class=\"farris-group-wrap\">\r\n        <div class=\"form-group farris-form-group\">\r\n          <label for=\"\" class=\"col-form-label\" title=\"{{'upBill' | aifLocale}}\">\r\n            <span class=\"farris-label-text\">{{\"upBill\" | aifLocale}}</span>\r\n          </label>\r\n          <div class=\"farris-input-wrap\">\r\n            <input-group [editable]=\"false\" [ngModel]=\"queryParam.filterArgsExt.upBillVoName\"\r\n              (clickHandle)=\"selectUpBill()\" [groupText]=\"groupIcon\" (clear)=\"clearUpBill()\"></input-group>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- \u4E0B\u6E38\u5355\u636E -->\r\n    <div class=\"col-12 col-md-6 col-xl-3\">\r\n      <div class=\"farris-group-wrap\">\r\n        <div class=\"form-group farris-form-group\">\r\n          <label for=\"\" class=\"col-form-label\" title=\"{{'downBill' | aifLocale}}\">\r\n            <span class=\"farris-label-text\">{{\"downBill\" | aifLocale}}</span>\r\n          </label>\r\n          <div class=\"farris-input-wrap\">\r\n            <input-group [editable]=\"false\" [ngModel]=\"queryParam.filterArgsExt.downBillVoName\"\r\n              (clickHandle)=\"selectDownBill()\" [groupText]=\"groupIcon\" (clear)=\"clearDownBill()\">\r\n            </input-group>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- \u542F\u7528\u72B6\u6001 -->\r\n    <!-- <div class=\"col-12 col-md-6 col-xl-3\">\r\n      <div class=\"farris-group-wrap\">\r\n        <div class=\"form-group farris-form-group\">\r\n          <label for=\"enabledState\" class=\"col-form-label\" title=\"{{'enabledState' | aifLocale}}\">\r\n            <span class=\"farris-label-text\">{{\"enabledState\" | aifLocale}}</span>\r\n          </label>\r\n          <div class=\"farris-input-wrap\">\r\n            <farris-combo-list #comboEnabledState [ngModel]=\"queryParam.filterArgs.isEnabled?.value\"\r\n              [idField]=\"comboEnabledStateIdField\" [valueField]=\"comboEnabledStateValueField\"\r\n              [textField]=\"comboEnabledStateTextField\" [data]=\"comboEnabledStateData\" (clear)=\"clearIsEnabled()\"\r\n              (valueChange)=\"enabledStateChange($event)\" [editable]=\"false\"></farris-combo-list>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div> -->\r\n\r\n    <!-- \u7CFB\u7EDF\u9884\u7F6E -->\r\n    <div class=\"col-12 col-md-6 col-xl-3\" *ngIf=\"true\">\r\n      <div class=\"farris-group-wrap\">\r\n        <div class=\"form-group farris-form-group\">\r\n          <label for=\"\" class=\"col-form-label\" title=\"{{'sysInit' | aifLocale}}\">\r\n            <span class=\"farris-label-text\">{{\"sysInit\" | aifLocale}}</span>\r\n          </label>\r\n          <div class=\"farris-input-wrap\">\r\n            <farris-combo-list #comboSysInit [ngModel]=\"queryParam.filterArgs.sysInit?.value\"\r\n              [idField]=\"comboSysInitIdField\" [valueField]=\"comboSysInitValueField\" [textField]=\"comboSysInitTextField\"\r\n              [data]=\"comboSysInitData\" (clear)=\"clearSysInit()\" (valueChange)=\"sysInitChange($event)\"\r\n              [editable]=\"false\">\r\n            </farris-combo-list>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</farris-section>",
                    styles: [".query-solution span{vertical-align:middle;margin:0 3px;cursor:pointer}"]
                }] }
    ];
    /** @nocollapse */
    ProcHelpQuerySolutionComponent.ctorParameters = function () { return [
        { type: ProcessListHelpService },
        { type: MessagerService },
        { type: NotifyService },
        { type: GSPMetadataRTService },
        { type: BsModalService },
        { type: Injector },
        { type: ComponentFactoryResolver },
        { type: AifLocalePipe }
    ]; };
    ProcHelpQuerySolutionComponent.propDecorators = {
        queryParam: [{ type: Input, args: ["queryParam",] }],
        queryParamChange: [{ type: Output, args: ["queryParamChange",] }],
        onSearchEmitter: [{ type: Output, args: ["onSearch",] }],
        comboSysInit: [{ type: ViewChild, args: ["comboSysInit",] }]
    };
    return ProcHelpQuerySolutionComponent;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var AifUiCommonModule = /** @class */ (function () {
    function AifUiCommonModule() {
    }
    /**
     * @param {?=} resources
     * @return {?}
     */
    AifUiCommonModule.forRoot = /**
     * @param {?=} resources
     * @return {?}
     */
    function (resources) {
        return {
            ngModule: AifUiCommonModule,
            providers: [
                { provide: BIF_LANG_RESOURCES, useValue: resources || {} },
            ],
        };
    };
    AifUiCommonModule.decorators = [
        { type: NgModule, args: [{
                    declarations: [
                        AifLocalePipe
                    ],
                    exports: [
                        AifLocalePipe
                    ]
                },] }
    ];
    return AifUiCommonModule;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var ProcessListHelpModule = /** @class */ (function () {
    function ProcessListHelpModule() {
    }
    ProcessListHelpModule.decorators = [
        { type: NgModule, args: [{
                    imports: [
                        CommonModule,
                        HttpClientModule,
                        MetadataRTSelectModule,
                        GSPMetadataRTServiceModule.forRoot(""),
                        FResponseToolbarModule,
                        ListFilterModule,
                        AngularDraggableModule,
                        FarrisCommonModule.forRoot(),
                        FarrisFormsModule,
                        FarrisSectionModule,
                        DatagridEditorsModule,
                        DatagridModule.forRoot(__spread(EditorProviders)),
                        ComboListModule,
                        InputGroupModule,
                        FarrisDialogModule,
                        SwitchModule,
                        FarrisTabsModule,
                        LookupModule,
                        LoadingModule.forRoot({
                            message: 'Loading...'
                        }),
                        NotifyModule.forRoot(),
                        MessagerModule.forRoot({
                            width: 550,
                            height: 450
                        }),
                        ModalModule.forRoot(),
                        AifUiCommonModule,
                    ],
                    providers: [
                        CacheService,
                        SessionService,
                        HttpService,
                        FrmEventBus,
                        FuncsService,
                        LoadingService,
                        AppService,
                        FrameworkService,
                        GSPMetadataRTService,
                        BusinessObjectRtService,
                        ProcessListHelpService,
                    ],
                    declarations: [
                        ProcessListHelpComponent,
                        ProcHelpQuerySolutionComponent,
                    ],
                    entryComponents: [
                        ProcessListHelpComponent,
                        ProcHelpQuerySolutionComponent,
                    ]
                },] }
    ];
    return ProcessListHelpModule;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var ActivityExecutorPipe = /** @class */ (function () {
    function ActivityExecutorPipe() {
    }
    /**
     * @param {?} activityExecutors
     * @param {?=} defaultVal
     * @return {?}
     */
    ActivityExecutorPipe.prototype.transform = /**
     * @param {?} activityExecutors
     * @param {?=} defaultVal
     * @return {?}
     */
    function (activityExecutors, defaultVal) {
        if (defaultVal === void 0) { defaultVal = ''; }
        /** @type {?} */
        var r = '';
        activityExecutors.forEach((/**
         * @param {?} u
         * @return {?}
         */
        function (u) {
            r += u.activityDefName + '，';
        }));
        if (r) {
            r = r.substring(0, r.length - 1);
        }
        return r ? r : defaultVal;
    };
    ActivityExecutorPipe.decorators = [
        { type: Pipe, args: [{ name: 'activityExecutor' },] }
    ];
    /** @nocollapse */
    ActivityExecutorPipe.ctorParameters = function () { return []; };
    return ActivityExecutorPipe;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var VariableNamePipe = /** @class */ (function () {
    function VariableNamePipe() {
    }
    /**
     * @param {?} users
     * @param {?=} defaultVal
     * @return {?}
     */
    VariableNamePipe.prototype.transform = /**
     * @param {?} users
     * @param {?=} defaultVal
     * @return {?}
     */
    function (users, defaultVal) {
        if (defaultVal === void 0) { defaultVal = ''; }
        /** @type {?} */
        var r = '';
        users.forEach((/**
         * @param {?} u
         * @return {?}
         */
        function (u) {
            r += u.name + '，';
        }));
        if (r) {
            r = r.substring(0, r.length - 1);
        }
        return r ? r : defaultVal;
    };
    VariableNamePipe.decorators = [
        { type: Pipe, args: [{ name: 'variableName' },] }
    ];
    /** @nocollapse */
    VariableNamePipe.ctorParameters = function () { return []; };
    return VariableNamePipe;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var ɵ0$4 = localStorage.getItem('languageCode') || 'zh-CHS';
var BillTypeHelpModule = /** @class */ (function () {
    function BillTypeHelpModule() {
    }
    BillTypeHelpModule.decorators = [
        { type: NgModule, args: [{
                    imports: [
                        CommonModule,
                        HttpClientModule,
                        FormsModule,
                        ReactiveFormsModule,
                        MetadataRTSelectModule,
                        GSPMetadataRTServiceModule.forRoot(""),
                        FResponseToolbarModule,
                        ListFilterModule,
                        AngularDraggableModule,
                        FarrisCommonModule.forRoot(),
                        FarrisFormsModule,
                        FarrisSectionModule,
                        DatagridEditorsModule,
                        DatagridModule.forRoot(__spread(EditorProviders)),
                        ComboListModule,
                        InputGroupModule,
                        FarrisDialogModule,
                        SwitchModule,
                        FarrisTabsModule,
                        LookupModule,
                        TreeTableModule,
                        LoadingModule.forRoot({
                            message: 'Loading...'
                        }),
                        NotifyModule.forRoot(),
                        MessagerModule.forRoot({
                            width: 550,
                            height: 450
                        }),
                        ModalModule.forRoot(),
                        PaginationModule,
                        SplitterModule,
                        LanguageTextboxModule,
                        AifUiCommonModule,
                    ],
                    providers: [
                        CacheService,
                        SessionService,
                        HttpService,
                        FrmEventBus,
                        FuncsService,
                        LoadingService$1,
                        AppService,
                        FrameworkService,
                        { provide: LOCALE_ID, useValue: ɵ0$4 },
                        GSPMetadataRTService,
                        BusinessObjectRtService,
                        BillTypeHelpService,
                    ],
                    declarations: [
                        BillTypeHelpComponent,
                    ],
                    entryComponents: [
                        BillTypeHelpComponent,
                    ],
                },] }
    ];
    return BillTypeHelpModule;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var TranslateResolveService = /** @class */ (function () {
    function TranslateResolveService(translate, curLanguage) {
        this.translate = translate;
        this.curLanguage = curLanguage;
    }
    /**
     * @param {?} route
     * @param {?} state
     * @return {?}
     */
    TranslateResolveService.prototype.resolve = /**
     * @param {?} route
     * @param {?} state
     * @return {?}
     */
    function (route, state) {
        this.translate.defaultLang = this.curLanguage;
        return this.translate.getTranslation(this.curLanguage);
    };
    TranslateResolveService.decorators = [
        { type: Injectable }
    ];
    /** @nocollapse */
    TranslateResolveService.ctorParameters = function () { return [
        { type: TranslateService },
        { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] }
    ]; };
    return TranslateResolveService;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/** @type {?} */
var routes = [
    {
        path: 'WfProcessEditor', component: WfProcessEditorComponent,
        children: [],
        resolve: {
            'translate': TranslateResolveService
        }
    }
];
var WfProcessEditorRoutingModule = /** @class */ (function () {
    function WfProcessEditorRoutingModule() {
    }
    WfProcessEditorRoutingModule.decorators = [
        { type: NgModule, args: [{
                    imports: [
                        CommonModule,
                        RouterModule.forChild(routes)
                    ],
                    exports: [
                        RouterModule
                    ]
                },] }
    ];
    return WfProcessEditorRoutingModule;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var WfLocaleModule = /** @class */ (function () {
    function WfLocaleModule() {
    }
    /**
     * @param {?=} resources
     * @return {?}
     */
    WfLocaleModule.forRoot = /**
     * @param {?=} resources
     * @return {?}
     */
    function (resources) {
        return {
            ngModule: WfLocaleModule,
            providers: [
                { provide: WF_LANG_RESOURCES, useValue: resources || {} },
            ],
        };
    };
    WfLocaleModule.decorators = [
        { type: NgModule, args: [{
                    declarations: [
                        WfLocalePipe
                    ],
                    exports: [
                        WfLocalePipe
                    ]
                },] }
    ];
    return WfLocaleModule;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
// 国际化相关
/**
 * @param {?} httpClient
 * @return {?}
 */
function HttpLoaderFactory(httpClient) {
    /** @type {?} */
    var languagePath = 'platform/runtime/common/web/@gsp-wf/wf-process-editor/i18n/';
    return new TranslateHttpLoader(httpClient, languagePath, '.json?v=' + new Date().getTime());
}
var ɵ0$5 = localStorage.getItem('languageCode') || 'zh-CHS', ɵ1 = WF_PROCESS_EDITOR_LANG_RESOURCES, ɵ2 = AIF_PROCESS_LIST_HELP_LANG_RESOURCES;
var WfProcessEditorModule = /** @class */ (function () {
    function WfProcessEditorModule() {
    }
    WfProcessEditorModule.decorators = [
        { type: NgModule, args: [{
                    declarations: [
                        WfProcessEditorComponent,
                        EntryFormEditorComponent,
                        ExpressionEditorComponent,
                        AssignPerformerConfigComponent,
                        SignRuleComponent,
                        ApprovelItemsComponent,
                        ExecuteFormsComponent,
                        JumpScopeComponent,
                        BackwardRuleComponent,
                        JumpScopePipe,
                        ActivityComponentComponent,
                        PerformerComponent,
                        PerformerEditComponent,
                        UserPerformerComponent,
                        ComponentPerformerComponent,
                        PositionPerformerComponent,
                        PerformerOptionsComponent,
                        UsersNamePipe,
                        UsersIdPipe,
                        VariableNamePipe,
                        ActivityExecutorPipe,
                        ReportingLineComponent,
                        TitleExpressionComponent,
                        SaveAsEditComponent,
                        OrganizationPotentialOwnerComponent,
                        CustomizeActionComponent,
                        CustomizeActionListComponent,
                        CallActivitySubProcessComponent,
                        TimeLimitControlComponent,
                        SendMessageOperationComponent,
                        EventDefinitionComponent,
                        AnonymousSetComponent,
                        ProcessVariablesComponent,
                        VariableSettingComponent,
                        ConstantEditComponent,
                        ComponentEditComponent,
                        MessageNoticeComponent,
                        MessageNoticeEditComponent,
                        AddExecuteFormComponent,
                        FormFormatConfigComponent,
                        FormConfigContainerComponent,
                        ParameterSettingComponent,
                        FormOperationConfigComponent,
                        ApprovalPivotComponent,
                        WfReportDefHelpComponent,
                        UrgeHandleRuleComponent,
                        NoteComponent,
                        MatrixPerformerComponent,
                        EnumListComponent,
                        AutoHandleOperationComponent,
                        ExtendPropertyComponent,
                        CallActivitySubProcess2Component,
                        ActivityExecutorPerformerComponent,
                        ImageSetComponent,
                        MessageNoticeCopyComponent,
                        CheckConditionComponent,
                        AssignStrategyComponent,
                        ActivityListComponent,
                        EditComponentParameterComponent,
                        VariablePerformerComponent,
                        ReleaseComponent,
                        ParticipantComponent,
                        VariableGridComponent,
                        VoConfigComponent,
                        WfOptionsComponent,
                        AssignScopeComponent,
                        SmsMessageTemplateComponent,
                        StartConditionComponent,
                        PositionsNamePipe,
                        BatchSetPropertiesComponent,
                        MultiInstanceLoopCharacteristicsComponent,
                        AlternativeParticipantComponent
                    ],
                    imports: [
                        TranslateModule.forRoot({
                            loader: {
                                provide: TranslateLoader,
                                useFactory: HttpLoaderFactory,
                                deps: [HttpClient]
                            }
                        }),
                        CommonModule,
                        ReactiveFormsModule,
                        FormsModule,
                        HttpClientModule,
                        SysManagerUIModule,
                        RtfAppHelpModule,
                        CommonComponentUiModule,
                        GSPMetadataRTServiceModule.forRoot(''),
                        MetadataRTSelectModule,
                        TreeTableModule,
                        DataTableModule,
                        LayoutModule,
                        NotifyModule,
                        FarrisDialogModule,
                        SplitterModule,
                        InputGroupModule,
                        LookupModule,
                        FlexLayoutModule,
                        FarrisPanelModule,
                        FarrisResponsiveModule,
                        FResponseToolbarModule,
                        ExpressionModule,
                        PropertyPanelModule,
                        FarrisTabsModule,
                        LoadingModule.forRoot({
                            message: '加载中...'
                        }),
                        MessagerModule.forRoot({
                            width: 500
                        }),
                        ModalModule,
                        PopoverModule,
                        PaginationModule,
                        FarrisDropdownModule,
                        DatagridEditorsModule,
                        DatagridModule.forRoot(__spread(EditorProviders, [
                            PersonnelSelectorDataGridEditorProvider
                        ])),
                        ComboListModule,
                        WizardModule,
                        FarrisFormsModule,
                        SwitchModule,
                        WfBizprocessLookupModule,
                        NumberSpinnerModule,
                        PerfectScrollbarModule,
                        FarrisSectionModule,
                        FarrisButtonModule,
                        ProcessListHelpModule,
                        BillTypeHelpModule,
                        FarrisButtonModule,
                        ComboLookupModule,
                        SysmgrLookupModule,
                        FDropdownDirectiveTypeModule,
                        LanguageTextboxModule,
                        VerifyDetailModule,
                        FarrisHtmlEditorModule,
                        WfTaskHandlerModule,
                        DatagridFilterRowModule.forRoot(),
                        AifUiCommonModule,
                        DataEntityModule,
                        BizProcessApiModule,
                        PersonnelSelectorModule,
                        WfProcessEditorRoutingModule,
                        WfLocaleModule,
                    ],
                    providers: [
                        SessionService,
                        HttpService,
                        ExpressionService,
                        CommonComponentUiRTService,
                        PROCESS_DESIGNER_APP_PROVIDERS,
                        PROCESS_DESIGNER_DOMAIN_PROVIDERS,
                        PROCESS_DESIGNER_PART_PROVIDERS,
                        PerformerConfigService,
                        ProcessDeUtil,
                        WfReportDefHelpService,
                        EventBusService,
                        MatrixDefHelpService,
                        { provide: LOCALE_ID, useValue: ɵ0$5 },
                        { provide: WF_LANG_RESOURCES, useValue: ɵ1 },
                        WfLocalePipe,
                        TranslateResolveService,
                        PositionsNamePipe,
                        AifLocalePipe,
                        { provide: BIF_LANG_RESOURCES, useValue: ɵ2 },
                    ],
                    exports: [WfProcessEditorComponent, AlternativeParticipantComponent],
                    entryComponents: [
                        EntryFormEditorComponent,
                        ExpressionEditorComponent,
                        AssignPerformerConfigComponent,
                        SignRuleComponent,
                        ApprovelItemsComponent,
                        ExecuteFormsComponent,
                        JumpScopeComponent,
                        BackwardRuleComponent,
                        ActivityComponentComponent,
                        SelectMetadataRTComponent,
                        PerformerComponent,
                        PerformerEditComponent,
                        UserPerformerComponent,
                        ComponentPerformerComponent,
                        PositionPerformerComponent,
                        PerformerOptionsComponent,
                        ReportingLineComponent,
                        TitleExpressionComponent,
                        SaveAsEditComponent,
                        OrganizationPotentialOwnerComponent,
                        CustomizeActionComponent,
                        CustomizeActionListComponent,
                        CallActivitySubProcessComponent,
                        TimeLimitControlComponent,
                        SendMessageOperationComponent,
                        EventDefinitionComponent,
                        AnonymousSetComponent,
                        ProcessVariablesComponent,
                        VariableSettingComponent,
                        ConstantEditComponent,
                        ComponentEditComponent,
                        MessageNoticeComponent,
                        MessageNoticeEditComponent,
                        MessageNoticeCopyComponent,
                        AddExecuteFormComponent,
                        FormFormatConfigComponent,
                        FormConfigContainerComponent,
                        ParameterSettingComponent,
                        FormOperationConfigComponent,
                        ApprovalPivotComponent,
                        UrgeHandleRuleComponent,
                        NoteComponent,
                        MatrixPerformerComponent,
                        EnumListComponent,
                        AutoHandleOperationComponent,
                        ProcessListHelpComponent,
                        ExtendPropertyComponent,
                        CallActivitySubProcess2Component,
                        ActivityExecutorPerformerComponent,
                        ImageSetComponent,
                        CheckConditionComponent,
                        AssignStrategyComponent,
                        ActivityListComponent,
                        EditComponentParameterComponent,
                        VariablePerformerComponent,
                        ReleaseComponent,
                        ParticipantComponent,
                        VariableGridComponent,
                        VoConfigComponent,
                        WfOptionsComponent,
                        AssignScopeComponent,
                        StartConditionComponent,
                        BatchSetPropertiesComponent,
                        MultiInstanceLoopCharacteristicsComponent,
                        AlternativeParticipantComponent
                    ],
                },] }
    ];
    return WfProcessEditorModule;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/**
 * 事件流连线，增加状态颜色信息
 */
var /**
 * 事件流连线，增加状态颜色信息
 */
WfSequenceFlowEdge = /** @class */ (function (_super) {
    __extends(WfSequenceFlowEdge, _super);
    function WfSequenceFlowEdge() {
        var _a;
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this.localePipe = null;
        _this.strokeColors = (_a = {},
            _a[SequenceFlowState.Default] = "#6482b9",
            _a);
        return _this;
    }
    /**
     * @return {?}
     */
    WfSequenceFlowEdge.prototype.getFarrisPropConfig = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var sequenceFlow = this.flowElement;
        /** @type {?} */
        var sourceNode = sequenceFlow.Model.DefaultProcess.GetFlowElement(sequenceFlow.SourceRef);
        /** @type {?} */
        var conditionConfig = new ElementPropertyConfig();
        /** @type {?} */
        var basicConfig = new ElementPropertyConfig();
        /** @type {?} */
        var propertyData = {};
        basicConfig.categoryId = 'basic';
        basicConfig.categoryName = mxResources.get('basicInfo');
        basicConfig.tabId = 'basic';
        basicConfig.tabName = mxResources.get('basic');
        basicConfig.properties = [
            { propertyID: SequenceFlowPropertyKeys.Name, propertyName: mxResources.get('name'), propertyType: 'string', visible: !this.editorUi.multiLangEnabled },
            { propertyID: SequenceFlowPropertyKeys.NameLanguage, propertyName: mxResources.get('nameLanguage'), propertyType: 'multiLanguage', visible: this.editorUi.multiLangEnabled },
            { propertyID: SequenceFlowPropertyKeys.Id, propertyName: mxResources.get('id'), propertyType: 'string', readonly: true }
        ];
        conditionConfig.categoryId = 'condition';
        conditionConfig.categoryName = mxResources.get('basicInfo');
        conditionConfig.tabId = 'basic';
        conditionConfig.tabName = mxResources.get('basic');
        conditionConfig.properties = [
            { propertyID: SequenceFlowPropertyKeys.ConditionExpression, propertyName: mxResources.get('ConditionExpression'), propertyType: 'modal' }
        ];
        // 源节点为排他网关和UserActivity时
        if (sourceNode.ClrTypeID === UserActivity.Clr_Type_ID || sourceNode.ClrTypeID === 'bpmn.ExclusiveGateway' || sourceNode.ClrTypeID === 'bpmn.InclusiveGateway') {
            conditionConfig.properties.push({ propertyID: SequenceFlowPropertyKeys.Default, propertyName: mxResources.get('default'), propertyType: 'select' });
        }
        this.setSequenceFlowValue(sequenceFlow, sourceNode, propertyData);
        return {
            propertyConfig: [basicConfig, conditionConfig],
            propertyData: propertyData
        };
    };
    /**
     * @param {?} obj
     * @return {?}
     */
    WfSequenceFlowEdge.prototype.updateProps = /**
     * @param {?} obj
     * @return {?}
     */
    function (obj) {
        /** @type {?} */
        var sequenceFlow = this.flowElement;
        /** @type {?} */
        var propertyId = obj.propertyID;
        switch (propertyId) {
            case SequenceFlowPropertyKeys.ConditionExpression: // 更新条件
                this.updateConditionExpr(sequenceFlow, obj.propertyValue);
                break;
            case SequenceFlowPropertyKeys.Default:
                this.modifyDefaultSequenceFlow(sequenceFlow, obj.propertyValue);
                break;
            default:
                _super.prototype.updateProps.call(this, obj);
                break;
        }
    };
    /**
     * 设置连接线属性值
     * @param sequence
     * @param propertyData
     */
    /**
     * 设置连接线属性值
     * @param {?} sequenceFlow
     * @param {?} sourceNode
     * @param {?} propertyData
     * @return {?}
     */
    WfSequenceFlowEdge.prototype.setSequenceFlowValue = /**
     * 设置连接线属性值
     * @param {?} sequenceFlow
     * @param {?} sourceNode
     * @param {?} propertyData
     * @return {?}
     */
    function (sequenceFlow, sourceNode, propertyData) {
        propertyData[SequenceFlowPropertyKeys.Id] = sequenceFlow.Id;
        propertyData[SequenceFlowPropertyKeys.ClrTypeID] = sequenceFlow.ClrTypeID;
        propertyData[SequenceFlowPropertyKeys.Name] = sequenceFlow.Name;
        propertyData[SequenceFlowPropertyKeys.NameLanguage] = sequenceFlow.NameLanguage || {
            "zh-CHS": sequenceFlow.Name,
        };
        if (!sequenceFlow.ConditionExpression || !sequenceFlow.ConditionExpression.MexExpression)
            propertyData[SequenceFlowPropertyKeys.ConditionExpression] = '';
        else
            propertyData[SequenceFlowPropertyKeys.ConditionExpression] =
                ((/** @type {?} */ (sequenceFlow.ConditionExpression.MexExpression))).Value;
        if (sourceNode.ClrTypeID === UserActivity.Clr_Type_ID) {
            /** @type {?} */
            var userActivity = (/** @type {?} */ (sourceNode));
            if (userActivity.Default === sequenceFlow.Id) {
                propertyData[SequenceFlowPropertyKeys.Default] = true;
            }
            else {
                propertyData[SequenceFlowPropertyKeys.Default] = false;
            }
        }
        if (sourceNode.ClrTypeID === 'bpmn.ExclusiveGateway') {
            /** @type {?} */
            var gateway = (/** @type {?} */ (sourceNode));
            if (gateway.Default === sequenceFlow.Id) {
                propertyData[SequenceFlowPropertyKeys.Default] = true;
            }
            else {
                propertyData[SequenceFlowPropertyKeys.Default] = false;
            }
        }
        if (sourceNode.ClrTypeID === 'bpmn.InclusiveGateway') {
            /** @type {?} */
            var gateway = (/** @type {?} */ (sourceNode));
            if (gateway.Default === sequenceFlow.Id) {
                propertyData[SequenceFlowPropertyKeys.Default] = true;
            }
            else {
                propertyData[SequenceFlowPropertyKeys.Default] = false;
            }
        }
    };
    /**
     * 更新分支条件
     * @param seqFlow
     * @param val
     */
    /**
     * 更新分支条件
     * @param {?} seqFlow
     * @param {?} val
     * @return {?}
     */
    WfSequenceFlowEdge.prototype.updateConditionExpr = /**
     * 更新分支条件
     * @param {?} seqFlow
     * @param {?} val
     * @return {?}
     */
    function (seqFlow, val) {
        seqFlow.ConditionExpression = null;
        if (val) {
            /** @type {?} */
            var expression = new Expression(seqFlow.Model);
            /** @type {?} */
            var condition = new Condition(seqFlow.Model);
            condition.Value = val;
            expression.MexExpression = condition;
            seqFlow.ConditionExpression = expression;
        }
    };
    /**
     * 更新默认分支(当前适用：排他网关+活动节点)
     * @param seqFlow
     * @param val
     */
    /**
     * 更新默认分支(当前适用：排他网关+活动节点)
     * @param {?} seqFlow
     * @param {?} val
     * @return {?}
     */
    WfSequenceFlowEdge.prototype.modifyDefaultSequenceFlow = /**
     * 更新默认分支(当前适用：排他网关+活动节点)
     * @param {?} seqFlow
     * @param {?} val
     * @return {?}
     */
    function (seqFlow, val) {
        // 获取流转线源节点
        /** @type {?} */
        var node = (/** @type {?} */ (seqFlow.Model.DefaultProcess.GetFlowElement(seqFlow.SourceRef)));
        if (node.ClrTypeID === UserActivity.Clr_Type_ID) {
            // 节点为UserActivity类型
            /** @type {?} */
            var userActivity = (/** @type {?} */ (node));
            if (val === true) {
                userActivity.Default = seqFlow.Id;
            }
            else if (val === false) {
                // 源节点的默认分支===流转分支ID
                if (userActivity.Default === seqFlow.Id) {
                    userActivity.Default = null;
                }
            }
        }
        else if (node.ClrTypeID === 'bpmn.ExclusiveGateway') {
            // 排他网关
            /** @type {?} */
            var gateway = (/** @type {?} */ (node));
            if (val === true) {
                gateway.Default = seqFlow.Id;
            }
            else if (val === false) {
                // 源节点的默认分支===流转分支ID
                if (gateway.Default === seqFlow.Id) {
                    gateway.Default = null;
                }
            }
        }
        else if (node.ClrTypeID === 'bpmn.InclusiveGateway') {
            // 包容网关
            /** @type {?} */
            var gateway = (/** @type {?} */ (node));
            if (val === true) {
                gateway.Default = seqFlow.Id;
            }
            else if (val === false) {
                // 源节点的默认分支===流转分支ID
                if (gateway.Default === seqFlow.Id) {
                    gateway.Default = null;
                }
            }
        }
    };
    return WfSequenceFlowEdge;
}(SequenceFlowEdge));

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
BpmnCellHelper.register(AifCreationBillActivityCell.CLR_TYPE_ID, AifCreationBillActivityCell);
BpmnCellHelper.register(AutoActivityCell.CLR_TYPE_ID, AutoActivityCell);
BpmnCellHelper.register(CallActivitySubProcessCell.CLR_TYPE_ID, CallActivitySubProcessCell);
BpmnCellHelper.register(IntermediateCatchEventImplCell.CLR_TYPE_ID, IntermediateCatchEventImplCell);
BpmnCellHelper.register(MessageActivityCell.CLR_TYPE_ID, MessageActivityCell);
BpmnCellHelper.register(NotifyActivityCell.CLR_TYPE_ID, NotifyActivityCell);
BpmnCellHelper.register(OperationActivityCell.CLR_TYPE_ID, OperationActivityCell);
BpmnCellHelper.register(StartActivityCell.CLR_TYPE_ID, StartActivityCell);
BpmnCellHelper.register(UserActivityCell.CLR_TYPE_ID, UserActivityCell);
BpmnCellHelper.register(WfEndEventCell.CLR_TYPE_ID, WfEndEventCell);
BpmnCellHelper.register(WfExclusiveGatewayCell.CLR_TYPE_ID, WfExclusiveGatewayCell);
// 暂时隐藏包容网关
BpmnCellHelper.register(WfInclusiveGatewayCell.CLR_TYPE_ID, WfInclusiveGatewayCell);
BpmnCellHelper.register(WfParallelGatewayCell.CLR_TYPE_ID, WfParallelGatewayCell);
BpmnCellHelper.register(WfSequenceFlowEdge.CLR_TYPE_ID, WfSequenceFlowEdge);

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */

export { WfProcessEditorService, WfProcessEditorComponent, HttpLoaderFactory, WfProcessEditorModule, ProcessTime, ProcessInfo, ProcessOrganization, RTProcessInfo, ActionScope$4 as ActionScope, ActivityExecutorParticipant$2 as ActivityExecutorParticipant, ActualParameter$5 as ActualParameter, AssignConfig$2 as AssignConfig, AssignStrategy$1 as AssignStrategy, BizComponent, BizParameter, ComponentParticipant$1 as ComponentParticipant, MatrixParticipant$1 as MatrixParticipant, MessageReceiver$1 as MessageReceiver, OrganizationLevel$4 as OrganizationLevel, OrganizationParticipant$1 as OrganizationParticipant, Participant$1 as Participant, ParticipantInfo$1 as ParticipantInfo, PositionParticipant$1 as PositionParticipant, ProcExtendProperty, ReportingLineParticipant$1 as ReportingLineParticipant, UserParticipant$1 as UserParticipant, VariablePerformer, AifCreationBillActivityCell, AutoActivityCell, CallActivitySubProcessCell, IntermediateCatchEventImplCell, MessageActivityCell, NotifyActivityCell, OperationActivityCell, PropertyHelper, StartActivityCell, UserActivityCell, WfEndEventCell, WfExclusiveGatewayCell, WfInclusiveGatewayCell, WfParallelGatewayCell, WfProcessCell, WfConstants, WfDesignerUtils, WfEditorUi, WfEvents, WfGraph, WfSidebar, WfValidatorAdapter, AifCreationBillActivityAdapter as ɵo, AutoActivityAdapter as ɵk, BillNodeActivityAdapter as ɵr, BpmnProcessViewModel as ɵh, CatchEventAdapter as ɵl, MessageActivityAdapter as ɵm, NotifyActivityAdapter as ɵn, ProcessDesignerUIState as ɵd, ProcessDesignerViewModel as ɵe, SequenceActivityAdapter as ɵs, SubProcessViewModel as ɵj, WFFlowElementsViewModel as ɵi, ProcessDeUtil as ɵg, ProcessDesignerDataService as ɵf, WF_PROCESS_EDITOR_LANG_RESOURCES as ɵc, WF_LANG_RESOURCES as ɵa, WfLocalePipe as ɵb, WfLocaleModule as ɵet, PROCESS_DESIGNER_APP_PROVIDERS as ɵeu, PROCESS_DESIGNER_DOMAIN_PROVIDERS as ɵev, PROCESS_DESIGNER_PART_PROVIDERS as ɵew, TranslateResolveService as ɵes, ActivityComponentComponent as ɵbg, ActivityComponentRepository as ɵbh, ActivityComponentUIState as ɵbi, ActivityComponentViewModel as ɵbj, ActivityListComponent as ɵdt, ProcHelpQuerySolutionComponent as ɵem, ProcessListHelpComponent as ɵek, AIF_PROCESS_LIST_HELP_LANG_RESOURCES as ɵel, ProcessListHelpModule as ɵeh, ProcessListHelpService as ɵej, AifUiCommonModule as ɵei, AifLocalePipe as ɵq, BIF_LANG_RESOURCES as ɵp, AnonymousSetComponent as ɵct, ApprovalPivotComponent as ɵdi, ApprovelItemsComponent as ɵy, AssignPerformerConfigComponent as ɵw, AssignScopeComponent as ɵea, AssignStrategyComponent as ɵds, BackwardRuleComponent as ɵbe, BatchSetPropertiesComponent as ɵef, BillTypeHelpModule as ɵen, BillTypeHelpService as ɵeo, BillTypeHelpComponent as ɵep, BILL_TYPE_HELP_LANG_RESOURCES as ɵeq, CallActivitySubProcessComponent as ɵco, CallActivitySubProcess2Component as ɵdo, CheckConditionComponent as ɵdr, CustomizeActionComponent as ɵcm, CustomizeActionListComponent as ɵcn, EditComponentParameterComponent as ɵdu, EntryFormEditorComponent as ɵu, EventDefinitionComponent as ɵcs, AddExecuteFormComponent as ɵdc, FormFormatService as ɵdd, ExecuteFormsComponent as ɵz, ExecuteFormsRepository as ɵbc, ExecuteFormsUIState as ɵba, ExecuteFormsViewModel as ɵbb, FormConfigContainerComponent as ɵdg, FormFormatConfigComponent as ɵde, FormOperationConfigComponent as ɵdf, ParameterSettingComponent as ɵdh, VariableGridComponent as ɵdx, ExpressionEditorComponent as ɵv, ExtendPropertyComponent as ɵdn, ImageSetComponent as ɵdp, JumpScopeComponent as ɵbd, JumpScopePipe as ɵbf, MessageNoticeCopyComponent as ɵdq, MessageNoticeEditComponent as ɵdb, MessageNoticeComponent as ɵda, MultiInstanceLoopCharacteristicsComponent as ɵeg, NoteComponent as ɵdk, OrganizationPotentialOwnerComponent as ɵcj, AlternativeParticipantComponent as ɵck, ParticipantComponent as ɵdw, ParticipantUIState as ɵcl, PerformerConfigService as ɵbr, PerformerComponent as ɵbk, PerformerRepository as ɵbm, PerformerUIState as ɵbn, PerformerViewModel as ɵbl, ActivityExecutorPerformerComponent as ɵcc, ActivityExecutorPipe as ɵcg, ComponentPerformerComponent as ɵbv, ComponentPerformerService as ɵbw, EnumListComponent as ɵdl, MatrixPerformerComponent as ɵca, MatrixDefHelpService as ɵcb, PerformerEditComponent as ɵbp, PerformerOptionsComponent as ɵbo, PositionPerformerComponent as ɵbt, PositionsNamePipe as ɵbu, ReportingLineComponent as ɵbx, WfReportDefHelpComponent as ɵby, WfReportDefHelpService as ɵbz, UserPerformerComponent as ɵbq, UsersIdPipe as ɵce, UsersNamePipe as ɵcd, VariableNamePipe as ɵcf, VariablePerformerComponent as ɵbs, ProcessVariablesComponent as ɵcu, ReleaseComponent as ɵdv, SaveAsEditComponent as ɵci, EventBusService as ɵt, SignRuleComponent as ɵx, SmsMessageTemplateComponent as ɵcr, AbstractDatagridComponent as ɵec, LANG_RESOURCES as ɵed, StartConditionComponent as ɵeb, StartConditionService as ɵee, AutoHandleOperationComponent as ɵdm, SendMessageOperationComponent as ɵcq, TimeLimitControlComponent as ɵcp, TitleExpressionComponent as ɵch, UrgeHandleRuleComponent as ɵdj, VariableSettingComponent as ɵcv, ComponentEditLookUpService as ɵcz, ComponentEditComponent as ɵcx, ComponentEditService as ɵcy, ConstantEditComponent as ɵcw, VoConfigComponent as ɵdy, WfOptionsComponent as ɵdz, WfProcessEditorRoutingModule as ɵer };

//# sourceMappingURL=gsp-wf-wf-process-editor.js.map