/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, HostBinding, Output, EventEmitter, Input, ViewChild, TemplateRef, ChangeDetectorRef, Optional, Inject, LOCALE_ID } from '@angular/core';
import { ActionOrganizationScopeDesign, ActionScope, OrganizationPotentialOwner, OrganizationLevel } from './actionOrganizationScope';
import { WF_LANG_RESOURCES, WfLocalePipe } from '../../i18n/pipe/wf-process-editor-locale.pipe';
import { ExprEditMode, ExpressionService, InjectedType } from '@gsp-svc/expression';
import { ProcessDesignerUIState } from '../../app/process-designer.uistate';
import { AlternativeParticipantComponent } from '../participant/alternative-participant/alternative-participant.component';
import { OrganizationParticipantExpression } from '../../domain/entities/organization-participant-expression';
import { ParticipantInfo } from '../participant/participant.info';
import { MessagerService } from '@farris/ui-messager';
export class OrganizationPotentialOwnerComponent {
    /**
     * @param {?} cdr
     * @param {?} localeId
     * @param {?} resources
     * @param {?} localePipe
     * @param {?} expr
     * @param {?} message
     * @param {?} designerUIState
     */
    constructor(cdr, localeId, resources, localePipe, expr, message, designerUIState) {
        this.cdr = cdr;
        this.localeId = localeId;
        this.resources = resources;
        this.localePipe = localePipe;
        this.expr = expr;
        this.message = message;
        this.designerUIState = designerUIState;
        this.cls = 'farris-main-area flex-column';
        this.closeModal = new EventEmitter();
        this.submitModal = new EventEmitter();
        this.editorParams = {};
        this.organizationLevelCollection = [{
                value: 'GLOBAL',
                text: this.localePipe.transform('component.orgPotentialOwner.global'),
                orgId: 'global',
            }, {
                value: 'UNIT',
                text: this.localePipe.transform('component.orgPotentialOwner.currentUnit'),
                orgId: 'currentUnit'
            }, {
                value: 'DEPARTMENT',
                text: this.localePipe.transform('component.orgPotentialOwner.currentDepartment'),
                orgId: 'currentDepartment'
            },
            {
                value: 'VARORGANIZATION',
                text: this.localePipe.transform('component.orgPotentialOwner.variableOrganization'),
                orgId: ''
            }];
        this.actionCollection = [{
                value: ActionScope.AddSignBehind, name: this.localePipe.transform('component.orgPotentialOwner.addSignBehind')
            }, {
                value: ActionScope.AddSignFront, name: this.localePipe.transform('component.orgPotentialOwner.addSignFront')
            }, {
                value: ActionScope.Transfer, name: this.localePipe.transform('component.orgPotentialOwner.transfer')
            }, {
                value: ActionScope.Notify, name: this.localePipe.transform('component.orgPotentialOwner.notify')
            }];
        this.enable = false;
        this.organizationLevel = this.organizationLevelCollection[0].value;
        this.action = this.actionCollection[0].value;
        this.includeChildren = false;
        this.organizationId = '';
        this.showClearButton = false;
        this.actionName = (/**
         * @return {?}
         */
        () => {
            return this.actionCollection.find((/**
             * @param {?} a
             * @return {?}
             */
            a => a.value === this.action)).name;
        });
        this.modalConfig = {
            title: this.localePipe.transform('component.orgPotentialOwner.optionSettings'),
            width: 760,
            height: 506,
            showButtons: true
        };
        this.localePipe = this.localePipe || new WfLocalePipe(localeId, resources);
    }
    /**
     * @param {?} v
     * @return {?}
     */
    set value(v) {
        this.action = (/** @type {?} */ (v.action));
        if (this.action === this.actionCollection[2].value) {
            if (v.enable === null || v.enable === undefined) {
                this.enable = true;
            }
            else {
                this.enable = v.enable;
            }
        }
        else {
            this.enable = v.enable;
        }
        if (v.scope) {
            this.alternativeParticipant.participant.isAllScope = true;
            /** @type {?} */
            let organizationParticipantExpression = new OrganizationParticipantExpression();
            organizationParticipantExpression.actionScope = (/** @type {?} */ (v.action));
            if (v.scope.organizationLevel === OrganizationLevel.DEFAULT && v.scope.tag === 'expression') {
                organizationParticipantExpression.organizationLevel = OrganizationLevel.VARORGANIZATION;
                organizationParticipantExpression.tag = v.scope.tag;
                this.organizationLevel = OrganizationLevel.VARORGANIZATION;
            }
            else if (v.scope.organizationLevel) {
                this.organizationLevel = v.scope.organizationLevel;
            }
            this.includeChildren = v.scope.includeChildren;
            organizationParticipantExpression.includeChildren = v.scope.includeChildren;
            this.organizationId = v.scope.organizationId;
            organizationParticipantExpression.organizationId = v.scope.organizationId;
            organizationParticipantExpression.organizationName = this.organizationLevelCollection.find((/**
             * @param {?} o
             * @return {?}
             */
            o => o.value === this.organizationLevel)).text;
            this.alternativeParticipant.addOrganizationParticipant(organizationParticipantExpression);
            if (v.scope.participantInfo) {
                this.alternativeParticipant.participant = v.scope.participantInfo;
            }
            else {
                this.alternativeParticipant.participant = new ParticipantInfo();
            }
        }
        else {
            this.alternativeParticipant.participant.isAllScope = false;
        }
    }
    /**
     * @return {?}
     */
    ngOnInit() {
    }
    /**
     * @return {?}
     */
    clickOK() {
        if (this.validate()) {
            /** @type {?} */
            const scope = new ActionOrganizationScopeDesign();
            scope.enable = this.enable;
            scope.action = (/** @type {?} */ (this.action));
            if (this.alternativeParticipant.participant.isAllScope) {
                /** @type {?} */
                const potential = new OrganizationPotentialOwner();
                potential.actionScope = this.action;
                // potential.organizationLevel = this.organizationLevel as OrganizationLevel;
                // potential.organizationId = this.organizationLevelCollection.find(o => o.value === this.organizationLevel).orgId || this.organizationId;
                // potential.organizationName = this.organizationLevelCollection.find(o => o.value === this.organizationLevel).text;
                // potential.includeChildren = this.includeChildren;
                // if (potential.organizationLevel === OrganizationLevel.VARORGANIZATION) {
                //   potential.tag = 'expression';
                //   potential.organizationLevel = OrganizationLevel.DEFAULT;
                // } else {
                //   potential.tag = 'variable';
                // }
                scope.scope = (/** @type {?} */ (potential));
                scope.scope.participantInfo = this.alternativeParticipant.participant;
            }
            /** @type {?} */
            const object = { value: scope, parameters: null };
            this.submitModal.emit(object);
        }
    }
    /**
     * @return {?}
     */
    clickCancel() {
        this.closeModal.emit();
    }
    /**
     * @return {?}
     */
    validate() {
        if (this.alternativeParticipant.participant.isAllScope &&
            (!this.alternativeParticipant.participant.potentialOwnerList || this.alternativeParticipant.participant.potentialOwnerList.length <= 0)) {
            this.message.info(this.localePipe.transform('component.orgPotentialOwner.turnOffPrompt'));
            return false;
        }
        else {
            return true;
        }
    }
    /**
     * @param {?} event
     * @return {?}
     */
    valueChange(event) {
        switch (event.value) {
            case this.organizationLevelCollection[0].value:
                this.includeChildren = false;
                break;
            case this.organizationLevelCollection[1].value:
                this.includeChildren = true;
                break;
            case this.organizationLevelCollection[2].value:
                this.includeChildren = false;
                break;
            case this.organizationLevelCollection[3].value:
                this.includeChildren = true;
                this.organizationId = '';
                break;
        }
    }
    /**
     * @param {?} $event
     * @return {?}
     */
    clear($event) {
        this.organizationId = '';
    }
    /**
     * @param {?} data
     * @return {?}
     */
    selectValue(data) {
        this.showExprHelp();
    }
    /**
     * @return {?}
     */
    showExprHelp() {
        /** @type {?} */
        const context = new Array();
        // if(this.expr.exprEntity.contextEntities.find(x => x.key === 'CurrentLanguage')) {
        //   context.push(this.expr.exprEntity.contextEntities.find(x => x.key === 'CurrentLanguage'));
        // }
        // this.expr.clearContext();
        this.expr.setEditPattern(ExprEditMode.Advanced);
        if (this.designerUIState.schemas.length > 0) {
            for (const schema of this.designerUIState.schemas) {
                this.expr.addSchema('Schema', schema);
            }
            if (this.designerUIState.schemas[0].entityTypes && this.designerUIState.schemas[0].entityTypes.length > 0) {
                /** @type {?} */
                const entityType = this.designerUIState.schemas[0].entityTypes[0];
                this.expr.addInjectedEntity(entityType.name, 'Schema', entityType.name, InjectedType.EntityType);
            }
        }
        if (this.designerUIState.participantContext.length > 0) {
            for (const variable of this.designerUIState.participantContext) {
                context.push(variable);
            }
        }
        if (this.designerUIState.processVariableContext.length > 0) {
            for (const variable of this.designerUIState.processVariableContext) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                c => c.key === variable.key))) {
                    context.push(variable);
                }
            }
        }
        if (this.designerUIState.subActivityContext.length > 0) {
            for (const variable of this.designerUIState.subActivityContext) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                c => c.key === variable.key))) {
                    context.push(variable);
                }
            }
        }
        if (context.length > 0) {
            for (const v of context) {
                this.expr.addContext(v);
            }
        }
        // 预置表达式展示文本
        if (this.organizationId) {
            this.expr.addExpressionText(this.organizationId);
        }
        else {
            this.expr.addExpressionText('');
        }
        this.expr.buildExpression().then((/**
         * @param {?} expressioninfo
         * @return {?}
         */
        (expressioninfo) => {
            if (expressioninfo) {
                this.organizationId = expressioninfo;
                this.organizationLevelCollection[3].orgId = expressioninfo;
            }
            //点击确定后，去除表达式里面的新增的上下文变量
            if (context.length > 0) {
                this.expr.exprEntity.contextEntities = this.expr.exprEntity.contextEntities.filter((/**
                 * @param {?} x
                 * @return {?}
                 */
                x => !context.some((/**
                 * @param {?} y
                 * @return {?}
                 */
                y => y.key === x.key))));
            }
        }));
    }
}
OrganizationPotentialOwnerComponent.decorators = [
    { type: Component, args: [{
                selector: 'app-organization-potential-owner',
                template: "<div class=\"f-page\">\r\n  <div class=\"f-utils-fill-flex-column farris-split-section m-2 h-100 farris-overflow-y-auto farris-overflow-y-auto\">\r\n    <section class=\"f-utils-fill-flex-column h-100\">\r\n      <div class=\"f-utils-fill-flex-column h-100 farris-overflow-y-auto\" style=\"border-radius:16px;border: 1.5px solid #F1F3F7;\">\r\n        <div class=\"farris-form form-inline farris-form-inline\">\r\n          <div class=\"col-12 farris-group-auto my-3 pr-5\">\r\n            <div class=\"farris-group-wrap\">\r\n              <div class=\"form-group farris-form-group\">\r\n                <label class=\"col-form-label\" style=\"width: 5.3rem\">\r\n                  <span class=\"farris-label-text\">{{('component.orgPotentialOwner.enable'|wfLocale) + actionName()}}</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap ml-1\">\r\n                  <farris-switch [(ngModel)]=\"enable\" name=\"enable\"></farris-switch>\r\n                  <div class=\"farris-feedback valid-feedback\"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"col-12 farris-group-auto my-3 pr-5\">\r\n            <wf-alternative-participant [editorParams] = \"editorParams.nodeType\">\r\n            </wf-alternative-participant>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </section>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type=\"button\" class=\"btn btn-secondary btn-sm mx-2\" (click)=\"clickCancel()\">{{'component.orgPotentialOwner.clickCancel'|wfLocale}}</button>\r\n  <button type=\"button\" class=\"btn btn-primary btn-sm mx-2\" (click)=\"clickOK()\">{{'component.orgPotentialOwner.clickOK'|wfLocale}}</button>\r\n</ng-template>\r\n",
                providers: [
                    WfLocalePipe,
                ],
                styles: [".title-content{color:#000;display:inline-flex;align-items:center;line-height:1.375rem;position:relative;overflow:hidden;padding:0 0 0 1rem;min-width:390px}.title-content ::before{content:'';width:.25rem;height:1.125rem;background:#59a1ff;border-radius:1px;position:absolute;top:50%;left:0;margin-top:-.5625rem}.title-text{font-size:1rem;line-height:1.375rem;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;margin-bottom:0;margin-right:10px}.title-line{flex-grow:1;border-bottom:1px dashed rgba(0,0,0,.1)}"]
            }] }
];
/** @nocollapse */
OrganizationPotentialOwnerComponent.ctorParameters = () => [
    { type: ChangeDetectorRef, decorators: [{ type: Optional }] },
    { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
    { type: undefined, decorators: [{ type: Inject, args: [WF_LANG_RESOURCES,] }] },
    { type: WfLocalePipe, decorators: [{ type: Optional }] },
    { type: ExpressionService },
    { type: MessagerService },
    { type: ProcessDesignerUIState }
];
OrganizationPotentialOwnerComponent.propDecorators = {
    cls: [{ type: HostBinding, args: ['class',] }],
    closeModal: [{ type: Output }],
    submitModal: [{ type: Output }],
    editorParams: [{ type: Input }],
    alternativeParticipant: [{ type: ViewChild, args: [AlternativeParticipantComponent,] }],
    value: [{ type: Input }],
    modalFooter: [{ type: ViewChild, args: ['iconSelectFooter',] }]
};
if (false) {
    /** @type {?} */
    OrganizationPotentialOwnerComponent.prototype.cls;
    /** @type {?} */
    OrganizationPotentialOwnerComponent.prototype.closeModal;
    /** @type {?} */
    OrganizationPotentialOwnerComponent.prototype.submitModal;
    /** @type {?} */
    OrganizationPotentialOwnerComponent.prototype.editorParams;
    /** @type {?} */
    OrganizationPotentialOwnerComponent.prototype.alternativeParticipant;
    /** @type {?} */
    OrganizationPotentialOwnerComponent.prototype.modalFooter;
    /** @type {?} */
    OrganizationPotentialOwnerComponent.prototype.organizationLevelCollection;
    /** @type {?} */
    OrganizationPotentialOwnerComponent.prototype.actionCollection;
    /** @type {?} */
    OrganizationPotentialOwnerComponent.prototype.enable;
    /** @type {?} */
    OrganizationPotentialOwnerComponent.prototype.organizationLevel;
    /** @type {?} */
    OrganizationPotentialOwnerComponent.prototype.action;
    /** @type {?} */
    OrganizationPotentialOwnerComponent.prototype.includeChildren;
    /** @type {?} */
    OrganizationPotentialOwnerComponent.prototype.organizationId;
    /** @type {?} */
    OrganizationPotentialOwnerComponent.prototype.showClearButton;
    /** @type {?} */
    OrganizationPotentialOwnerComponent.prototype.actionName;
    /** @type {?} */
    OrganizationPotentialOwnerComponent.prototype.modalConfig;
    /**
     * @type {?}
     * @private
     */
    OrganizationPotentialOwnerComponent.prototype.cdr;
    /**
     * @type {?}
     * @private
     */
    OrganizationPotentialOwnerComponent.prototype.localeId;
    /**
     * @type {?}
     * @private
     */
    OrganizationPotentialOwnerComponent.prototype.resources;
    /**
     * @type {?}
     * @private
     */
    OrganizationPotentialOwnerComponent.prototype.localePipe;
    /**
     * @type {?}
     * @private
     */
    OrganizationPotentialOwnerComponent.prototype.expr;
    /**
     * @type {?}
     * @private
     */
    OrganizationPotentialOwnerComponent.prototype.message;
    /**
     * @type {?}
     * @private
     */
    OrganizationPotentialOwnerComponent.prototype.designerUIState;
}
export class OrganizationPotentialOwnerConverter {
    /**
     * @param {?} localePipe
     */
    constructor(localePipe) {
        this.localePipe = localePipe;
    }
    /**
     * @param {?} data
     * @return {?}
     */
    convertTo(data) {
        if (data && data.action === (/** @type {?} */ (ActionScope.Transfer)) && (data.enable === null || data.enable === undefined)) {
            return this.localePipe.transform("component.orgPotentialOwner.set");
        }
        else {
            if (data && data.enable) {
                return this.localePipe.transform("component.orgPotentialOwner.set");
            }
            else {
                return this.localePipe.transform("component.orgPotentialOwner.notSet");
            }
        }
    }
}
if (false) {
    /**
     * @type {?}
     * @private
     */
    OrganizationPotentialOwnerConverter.prototype.localePipe;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoib3JnYW5pemF0aW9uLXBvdGVudGlhbC1vd25lci5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZ3NwLXdmL3dmLXByb2Nlc3MtZWRpdG9yLyIsInNvdXJjZXMiOlsibGliL3ZpZXdzL29yZ2FuaXphdGlvbi1wb3RlbnRpYWwtb3duZXIvb3JnYW5pemF0aW9uLXBvdGVudGlhbC1vd25lci5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQVUsV0FBVyxFQUFFLE1BQU0sRUFBRSxZQUFZLEVBQUUsS0FBSyxFQUFFLFNBQVMsRUFBRSxXQUFXLEVBQUUsaUJBQWlCLEVBQUUsUUFBUSxFQUFFLE1BQU0sRUFBRSxTQUFTLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFFcEssT0FBTyxFQUFFLDZCQUE2QixFQUFFLFdBQVcsRUFBRSwwQkFBMEIsRUFBRSxpQkFBaUIsRUFBRSxNQUFNLDJCQUEyQixDQUFDO0FBQ3RJLE9BQU8sRUFBRSxpQkFBaUIsRUFBRSxZQUFZLEVBQUUsTUFBTSwrQ0FBK0MsQ0FBQztBQUNoRyxPQUFPLEVBQUUsWUFBWSxFQUFFLGlCQUFpQixFQUFFLFlBQVksRUFBYSxNQUFNLHFCQUFxQixDQUFDO0FBQy9GLE9BQU8sRUFBRSxzQkFBc0IsRUFBRSxNQUFNLG9DQUFvQyxDQUFDO0FBQzVFLE9BQU8sRUFBRSwrQkFBK0IsRUFBRSxNQUFNLDBFQUEwRSxDQUFDO0FBQzNILE9BQU8sRUFBRSxpQ0FBaUMsRUFBRSxNQUFNLDJEQUEyRCxDQUFDO0FBQzlHLE9BQU8sRUFBZSxlQUFlLEVBQUUsTUFBTSxpQ0FBaUMsQ0FBQztBQUMvRSxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFVdEQsTUFBTSxPQUFPLG1DQUFtQzs7Ozs7Ozs7OztJQXNGOUMsWUFDc0IsR0FBc0IsRUFDZixRQUFnQixFQUNSLFNBQWMsRUFDN0IsVUFBd0IsRUFDcEMsSUFBdUIsRUFDdkIsT0FB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REFBb0I7O0lBQ3BCLDhEQUF3Qjs7SUF3RXhCLHlEQUVDOztJQW1FRCwwREFLRTs7Ozs7SUEvSUEsa0RBQTBDOzs7OztJQUMxQyx1REFBMkM7Ozs7O0lBQzNDLHdEQUFpRDs7Ozs7SUFDakQseURBQTRDOzs7OztJQUM1QyxtREFBK0I7Ozs7O0lBQy9CLHNEQUFnQzs7Ozs7SUFDaEMsOERBQStDOztBQTJJbkQsTUFBTSxPQUFPLG1DQUFtQzs7OztJQUM5QyxZQUNVLFVBQXdCO1FBQXhCLGVBQVUsR0FBVixVQUFVLENBQWM7SUFDOUIsQ0FBQzs7Ozs7SUFFTCxTQUFTLENBQUMsSUFBbUM7UUFDM0MsSUFBSSxJQUFJLElBQUksSUFBSSxDQUFDLE1BQU0sS0FBSyxtQkFBQSxXQUFXLENBQUMsUUFBUSxFQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsTUFBTSxLQUFLLElBQUksSUFBSSxJQUFJLENBQUMsTUFBTSxLQUFLLFNBQVMsQ0FBQyxFQUFFO1lBQzlHLE9BQU8sSUFBSSxDQUFDLFVBQVUsQ0FBQyxTQUFTLENBQUMsaUNBQWlDLENBQUMsQ0FBQztTQUNyRTthQUFNO1lBQ0wsSUFBSSxJQUFJLElBQUksSUFBSSxDQUFDLE1BQU0sRUFBRTtnQkFDdkIsT0FBTyxJQUFJLENBQUMsVUFBVSxDQUFDLFNBQVMsQ0FBQyxpQ0FBaUMsQ0FBQyxDQUFDO2FBQ3JFO2lCQUFNO2dCQUNMLE9BQU8sSUFBSSxDQUFDLFVBQVUsQ0FBQyxTQUFTLENBQUMsb0NBQW9DLENBQUMsQ0FBQzthQUN4RTtTQUNGO0lBQ0gsQ0FBQztDQUNGOzs7Ozs7SUFkRyx5REFBZ0MiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIE9uSW5pdCwgSG9zdEJpbmRpbmcsIE91dHB1dCwgRXZlbnRFbWl0dGVyLCBJbnB1dCwgVmlld0NoaWxkLCBUZW1wbGF0ZVJlZiwgQ2hhbmdlRGV0ZWN0b3JSZWYsIE9wdGlvbmFsLCBJbmplY3QsIExPQ0FMRV9JRCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBUeXBlQ29udmVydGVyIH0gZnJvbSAnQGZhcnJpcy9pZGUtcHJvcGVydHktcGFuZWwnO1xyXG5pbXBvcnQgeyBBY3Rpb25Pcmdhbml6YXRpb25TY29wZURlc2lnbiwgQWN0aW9uU2NvcGUsIE9yZ2FuaXphdGlvblBvdGVudGlhbE93bmVyLCBPcmdhbml6YXRpb25MZXZlbCB9IGZyb20gJy4vYWN0aW9uT3JnYW5pemF0aW9uU2NvcGUnO1xyXG5pbXBvcnQgeyBXRl9MQU5HX1JFU09VUkNFUywgV2ZMb2NhbGVQaXBlIH0gZnJvbSAnLi4vLi4vaTE4bi9waXBlL3dmLXByb2Nlc3MtZWRpdG9yLWxvY2FsZS5waXBlJztcclxuaW1wb3J0IHsgRXhwckVkaXRNb2RlLCBFeHByZXNzaW9uU2VydmljZSwgSW5qZWN0ZWRUeXBlLCBWYXJFbnRpdHkgfSBmcm9tICdAZ3NwLXN2Yy9leHByZXNzaW9uJztcclxuaW1wb3J0IHsgUHJvY2Vzc0Rlc2lnbmVyVUlTdGF0ZSB9IGZyb20gJy4uLy4uL2FwcC9wcm9jZXNzLWRlc2lnbmVyLnVpc3RhdGUnO1xyXG5pbXBvcnQgeyBBbHRlcm5hdGl2ZVBhcnRpY2lwYW50Q29tcG9uZW50IH0gZnJvbSAnLi4vcGFydGljaXBhbnQvYWx0ZXJuYXRpdmUtcGFydGljaXBhbnQvYWx0ZXJuYXRpdmUtcGFydGljaXBhbnQuY29tcG9uZW50JztcclxuaW1wb3J0IHsgT3JnYW5pemF0aW9uUGFydGljaXBhbnRFeHByZXNzaW9uIH0gZnJvbSAnLi4vLi4vZG9tYWluL2VudGl0aWVzL29yZ2FuaXphdGlvbi1wYXJ0aWNpcGFudC1leHByZXNzaW9uJztcclxuaW1wb3J0IHsgUGFydGljaXBhbnQsIFBhcnRpY2lwYW50SW5mbyB9IGZyb20gJy4uL3BhcnRpY2lwYW50L3BhcnRpY2lwYW50LmluZm8nO1xyXG5pbXBvcnQgeyBNZXNzYWdlclNlcnZpY2UgfSBmcm9tICdAZmFycmlzL3VpLW1lc3NhZ2VyJztcclxuXHJcbkBDb21wb25lbnQoe1xyXG4gIHNlbGVjdG9yOiAnYXBwLW9yZ2FuaXphdGlvbi1wb3RlbnRpYWwtb3duZXInLFxyXG4gIHRlbXBsYXRlVXJsOiAnLi9vcmdhbml6YXRpb24tcG90ZW50aWFsLW93bmVyLmNvbXBvbmVudC5odG1sJyxcclxuICBzdHlsZVVybHM6IFsnLi9vcmdhbml6YXRpb24tcG90ZW50aWFsLW93bmVyLmNvbXBvbmVudC5zY3NzJ10sXHJcbiAgcHJvdmlkZXJzOiBbXHJcbiAgICAgV2ZMb2NhbGVQaXBlLFxyXG4gIF1cclxufSlcclxuZXhwb3J0IGNsYXNzIE9yZ2FuaXphdGlvblBvdGVudGlhbE93bmVyQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0IHtcclxuICBASG9zdEJpbmRpbmcoJ2NsYXNzJylcclxuICBjbHMgPSAnZmFycmlzLW1haW4tYXJlYSBmbGV4LWNvbHVtbic7XHJcblxyXG4gIEBPdXRwdXQoKSBjbG9zZU1vZGFsID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XHJcbiAgQE91dHB1dCgpIHN1Ym1pdE1vZGFsID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XHJcblxyXG4gIEBJbnB1dCgpIGVkaXRvclBhcmFtczogYW55ID0ge307XHJcblxyXG4gIEBWaWV3Q2hpbGQoQWx0ZXJuYXRpdmVQYXJ0aWNpcGFudENvbXBvbmVudCkgYWx0ZXJuYXRpdmVQYXJ0aWNpcGFudDogQWx0ZXJuYXRpdmVQYXJ0aWNpcGFudENvbXBvbmVudDtcclxuXHJcbiAgQElucHV0KClcclxuICBzZXQgdmFsdWUodjogQWN0aW9uT3JnYW5pemF0aW9uU2NvcGVEZXNpZ24pIHtcclxuICAgIHRoaXMuYWN0aW9uID0gdi5hY3Rpb24gYXMgYW55O1xyXG4gICAgaWYgKHRoaXMuYWN0aW9uID09PSB0aGlzLmFjdGlvbkNvbGxlY3Rpb25bMl0udmFsdWUpIHtcclxuICAgICAgaWYgKHYuZW5hYmxlID09PSBudWxsIHx8IHYuZW5hYmxlID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICB0aGlzLmVuYWJsZSA9IHRydWU7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgdGhpcy5lbmFibGUgPSB2LmVuYWJsZTtcclxuICAgICAgfVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5lbmFibGUgPSB2LmVuYWJsZTtcclxuICAgIH1cclxuICAgIGlmICh2LnNjb3BlKSB7XHJcbiAgICAgIHRoaXMuYWx0ZXJuYXRpdmVQYXJ0aWNpcGFudC5wYXJ0aWNpcGFudC5pc0FsbFNjb3BlID0gdHJ1ZTtcclxuICAgICAgbGV0IG9yZ2FuaXphdGlvblBhcnRpY2lwYW50RXhwcmVzc2lvbiA9IG5ldyBPcmdhbml6YXRpb25QYXJ0aWNpcGFudEV4cHJlc3Npb24oKTtcclxuICAgICAgb3JnYW5pemF0aW9uUGFydGljaXBhbnRFeHByZXNzaW9uLmFjdGlvblNjb3BlID0gdi5hY3Rpb24gYXMgYW55O1xyXG4gICAgICBpZiAodi5zY29wZS5vcmdhbml6YXRpb25MZXZlbCA9PT0gT3JnYW5pemF0aW9uTGV2ZWwuREVGQVVMVCAmJiB2LnNjb3BlLnRhZyA9PT0gJ2V4cHJlc3Npb24nKSB7XHJcbiAgICAgICAgb3JnYW5pemF0aW9uUGFydGljaXBhbnRFeHByZXNzaW9uLm9yZ2FuaXphdGlvbkxldmVsID0gT3JnYW5pemF0aW9uTGV2ZWwuVkFST1JHQU5JWkFUSU9OO1xyXG4gICAgICAgIG9yZ2FuaXphdGlvblBhcnRpY2lwYW50RXhwcmVzc2lvbi50YWcgPSB2LnNjb3BlLnRhZztcclxuICAgICAgICB0aGlzLm9yZ2FuaXphdGlvbkxldmVsID0gT3JnYW5pemF0aW9uTGV2ZWwuVkFST1JHQU5JWkFUSU9OO1xyXG4gICAgICB9IGVsc2UgaWYodi5zY29wZS5vcmdhbml6YXRpb25MZXZlbCl7XHJcbiAgICAgICAgdGhpcy5vcmdhbml6YXRpb25MZXZlbCA9IHYuc2NvcGUub3JnYW5pemF0aW9uTGV2ZWw7XHJcbiAgICAgIH1cclxuICAgICAgdGhpcy5pbmNsdWRlQ2hpbGRyZW4gPSB2LnNjb3BlLmluY2x1ZGVDaGlsZHJlbjtcclxuICAgICAgb3JnYW5pemF0aW9uUGFydGljaXBhbnRFeHByZXNzaW9uLmluY2x1ZGVDaGlsZHJlbiA9IHYuc2NvcGUuaW5jbHVkZUNoaWxkcmVuO1xyXG4gICAgICB0aGlzLm9yZ2FuaXphdGlvbklkID0gdi5zY29wZS5vcmdhbml6YXRpb25JZDtcclxuICAgICAgb3JnYW5pemF0aW9uUGFydGljaXBhbnRFeHByZXNzaW9uLm9yZ2FuaXphdGlvbklkID0gdi5zY29wZS5vcmdhbml6YXRpb25JZDtcclxuICAgICAgb3JnYW5pemF0aW9uUGFydGljaXBhbnRFeHByZXNzaW9uLm9yZ2FuaXphdGlvbk5hbWUgPSB0aGlzLm9yZ2FuaXphdGlvbkxldmVsQ29sbGVjdGlvbi5maW5kKG8gPT4gby52YWx1ZSA9PT0gdGhpcy5vcmdhbml6YXRpb25MZXZlbCkudGV4dDtcclxuICAgICAgdGhpcy5hbHRlcm5hdGl2ZVBhcnRpY2lwYW50LmFkZE9yZ2FuaXphdGlvblBhcnRpY2lwYW50KG9yZ2FuaXphdGlvblBhcnRpY2lwYW50RXhwcmVzc2lvbik7XHJcbiAgICAgIGlmKHYuc2NvcGUucGFydGljaXBhbnRJbmZvKXtcclxuICAgICAgICB0aGlzLmFsdGVybmF0aXZlUGFydGljaXBhbnQucGFydGljaXBhbnQgPSB2LnNjb3BlLnBhcnRpY2lwYW50SW5mbztcclxuICAgICAgfWVsc2Uge1xyXG4gICAgICAgIHRoaXMuYWx0ZXJuYXRpdmVQYXJ0aWNpcGFudC5wYXJ0aWNpcGFudCA9IG5ldyBQYXJ0aWNpcGFudEluZm8oKTtcclxuICAgICAgfVxyXG4gICAgfWVsc2Uge1xyXG4gICAgICB0aGlzLmFsdGVybmF0aXZlUGFydGljaXBhbnQucGFydGljaXBhbnQuaXNBbGxTY29wZSA9IGZhbHNlO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgQFZpZXdDaGlsZCgnaWNvblNlbGVjdEZvb3RlcicpIG1vZGFsRm9vdGVyOiBUZW1wbGF0ZVJlZjxhbnk+O1xyXG5cclxuICBvcmdhbml6YXRpb25MZXZlbENvbGxlY3Rpb24gPSBbe1xyXG4gICAgdmFsdWU6ICdHTE9CQUwnLFxyXG4gICAgdGV4dDogdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybSgnY29tcG9uZW50Lm9yZ1BvdGVudGlhbE93bmVyLmdsb2JhbCcpLFxyXG4gICAgb3JnSWQ6ICdnbG9iYWwnLFxyXG4gIH0sIHtcclxuICAgIHZhbHVlOiAnVU5JVCcsXHJcbiAgICB0ZXh0OiB0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKCdjb21wb25lbnQub3JnUG90ZW50aWFsT3duZXIuY3VycmVudFVuaXQnKSxcclxuICAgIG9yZ0lkOiAnY3VycmVudFVuaXQnXHJcbiAgfSwge1xyXG4gICAgdmFsdWU6ICdERVBBUlRNRU5UJyxcclxuICAgIHRleHQ6IHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oJ2NvbXBvbmVudC5vcmdQb3RlbnRpYWxPd25lci5jdXJyZW50RGVwYXJ0bWVudCcpLFxyXG4gICAgb3JnSWQ6ICdjdXJyZW50RGVwYXJ0bWVudCdcclxuICB9LFxyXG4gIHtcclxuICAgIHZhbHVlOiAnVkFST1JHQU5JWkFUSU9OJyxcclxuICAgIHRleHQ6IHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oJ2NvbXBvbmVudC5vcmdQb3RlbnRpYWxPd25lci52YXJpYWJsZU9yZ2FuaXphdGlvbicpLFxyXG4gICAgb3JnSWQ6ICcnXHJcbiAgfV07XHJcbiAgYWN0aW9uQ29sbGVjdGlvbiA9IFt7XHJcbiAgICAgIHZhbHVlOiBBY3Rpb25TY29wZS5BZGRTaWduQmVoaW5kLCBuYW1lOiB0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKCdjb21wb25lbnQub3JnUG90ZW50aWFsT3duZXIuYWRkU2lnbkJlaGluZCcpXHJcbiAgfSwge1xyXG4gICAgICB2YWx1ZTogQWN0aW9uU2NvcGUuQWRkU2lnbkZyb250LCBuYW1lOiB0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKCdjb21wb25lbnQub3JnUG90ZW50aWFsT3duZXIuYWRkU2lnbkZyb250JylcclxuICB9LCB7XHJcbiAgICAgIHZhbHVlOiBBY3Rpb25TY29wZS5UcmFuc2ZlciwgbmFtZTogdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybSgnY29tcG9uZW50Lm9yZ1BvdGVudGlhbE93bmVyLnRyYW5zZmVyJylcclxuICB9LCB7XHJcbiAgICB2YWx1ZTogQWN0aW9uU2NvcGUuTm90aWZ5LCBuYW1lOiB0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKCdjb21wb25lbnQub3JnUG90ZW50aWFsT3duZXIubm90aWZ5JylcclxufV07XHJcbiAgZW5hYmxlID0gZmFsc2U7XHJcbiAgb3JnYW5pemF0aW9uTGV2ZWwgPSB0aGlzLm9yZ2FuaXphdGlvbkxldmVsQ29sbGVjdGlvblswXS52YWx1ZTtcclxuICBhY3Rpb24gPSB0aGlzLmFjdGlvbkNvbGxlY3Rpb25bMF0udmFsdWU7XHJcbiAgaW5jbHVkZUNoaWxkcmVuID0gZmFsc2U7XHJcbiAgb3JnYW5pemF0aW9uSWQgPSAnJztcclxuICBzaG93Q2xlYXJCdXR0b24gPSBmYWxzZTtcclxuXHJcbiAgY29uc3RydWN0b3IoXHJcbiAgICBAT3B0aW9uYWwoKSBwcml2YXRlIGNkcjogQ2hhbmdlRGV0ZWN0b3JSZWYsXHJcbiAgICBASW5qZWN0KExPQ0FMRV9JRCkgcHJpdmF0ZSBsb2NhbGVJZDogc3RyaW5nLFxyXG4gICAgQEluamVjdChXRl9MQU5HX1JFU09VUkNFUykgcHJpdmF0ZSByZXNvdXJjZXM6IGFueSxcclxuICAgIEBPcHRpb25hbCgpIHByaXZhdGUgbG9jYWxlUGlwZTogV2ZMb2NhbGVQaXBlLFxyXG4gICAgcHJpdmF0ZSBleHByOiBFeHByZXNzaW9uU2VydmljZSxcclxuICAgIHByaXZhdGUgbWVzc2FnZTogTWVzc2FnZXJTZXJ2aWNlLFxyXG4gICAgcHJpdmF0ZSBkZXNpZ25lclVJU3RhdGU6IFByb2Nlc3NEZXNpZ25lclVJU3RhdGVcclxuICApIHtcclxuICAgIHRoaXMubG9jYWxlUGlwZSA9IHRoaXMubG9jYWxlUGlwZSB8fCBuZXcgV2ZMb2NhbGVQaXBlKGxvY2FsZUlkLCByZXNvdXJjZXMpO1xyXG4gICB9XHJcblxyXG4gIG5nT25Jbml0KCkge1xyXG4gIH1cclxuXHJcbiAgY2xpY2tPSygpIHtcclxuICAgIGlmKHRoaXMudmFsaWRhdGUoKSl7XHJcbiAgICAgIGNvbnN0IHNjb3BlID0gbmV3IEFjdGlvbk9yZ2FuaXphdGlvblNjb3BlRGVzaWduKCk7XHJcbiAgICAgIHNjb3BlLmVuYWJsZSA9IHRoaXMuZW5hYmxlO1xyXG4gICAgICBzY29wZS5hY3Rpb24gPSB0aGlzLmFjdGlvbiBhcyBhbnk7XHJcbiAgICAgIGlmICh0aGlzLmFsdGVybmF0aXZlUGFydGljaXBhbnQucGFydGljaXBhbnQuaXNBbGxTY29wZSkge1xyXG4gICAgICAgIGNvbnN0IHBvdGVudGlhbCA9IG5ldyBPcmdhbml6YXRpb25Qb3RlbnRpYWxPd25lcigpO1xyXG4gICAgICAgIHBvdGVudGlhbC5hY3Rpb25TY29wZSA9IHRoaXMuYWN0aW9uO1xyXG4gICAgICAgIC8vIHBvdGVudGlhbC5vcmdhbml6YXRpb25MZXZlbCA9IHRoaXMub3JnYW5pemF0aW9uTGV2ZWwgYXMgT3JnYW5pemF0aW9uTGV2ZWw7XHJcbiAgICAgICAgLy8gcG90ZW50aWFsLm9yZ2FuaXphdGlvbklkID0gdGhpcy5vcmdhbml6YXRpb25MZXZlbENvbGxlY3Rpb24uZmluZChvID0+IG8udmFsdWUgPT09IHRoaXMub3JnYW5pemF0aW9uTGV2ZWwpLm9yZ0lkIHx8IHRoaXMub3JnYW5pemF0aW9uSWQ7XHJcbiAgICAgICAgLy8gcG90ZW50aWFsLm9yZ2FuaXphdGlvbk5hbWUgPSB0aGlzLm9yZ2FuaXphdGlvbkxldmVsQ29sbGVjdGlvbi5maW5kKG8gPT4gby52YWx1ZSA9PT0gdGhpcy5vcmdhbml6YXRpb25MZXZlbCkudGV4dDtcclxuICAgICAgICAvLyBwb3RlbnRpYWwuaW5jbHVkZUNoaWxkcmVuID0gdGhpcy5pbmNsdWRlQ2hpbGRyZW47XHJcbiAgICAgICAgLy8gaWYgKHBvdGVudGlhbC5vcmdhbml6YXRpb25MZXZlbCA9PT0gT3JnYW5pemF0aW9uTGV2ZWwuVkFST1JHQU5JWkFUSU9OKSB7XHJcbiAgICAgICAgLy8gICBwb3RlbnRpYWwudGFnID0gJ2V4cHJlc3Npb24nO1xyXG4gICAgICAgIC8vICAgcG90ZW50aWFsLm9yZ2FuaXphdGlvbkxldmVsID0gT3JnYW5pemF0aW9uTGV2ZWwuREVGQVVMVDtcclxuICAgICAgICAvLyB9IGVsc2Uge1xyXG4gICAgICAgIC8vICAgcG90ZW50aWFsLnRhZyA9ICd2YXJpYWJsZSc7XHJcbiAgICAgICAgLy8gfVxyXG4gICAgICAgIHNjb3BlLnNjb3BlID0gcG90ZW50aWFsIGFzIGFueTtcclxuICAgICAgICBzY29wZS5zY29wZS5wYXJ0aWNpcGFudEluZm8gPSB0aGlzLmFsdGVybmF0aXZlUGFydGljaXBhbnQucGFydGljaXBhbnQ7XHJcbiAgICAgIH1cclxuICAgICAgY29uc3Qgb2JqZWN0ID0geyB2YWx1ZTogc2NvcGUsIHBhcmFtZXRlcnM6IG51bGwgfTtcclxuICAgICAgdGhpcy5zdWJtaXRNb2RhbC5lbWl0KG9iamVjdCk7XHJcbiAgICB9XHJcbiAgfVxyXG4gIGNsaWNrQ2FuY2VsKCkge1xyXG4gICAgdGhpcy5jbG9zZU1vZGFsLmVtaXQoKTtcclxuICB9XHJcblxyXG4gIHZhbGlkYXRlKCkge1xyXG4gICAgaWYodGhpcy5hbHRlcm5hdGl2ZVBhcnRpY2lwYW50LnBhcnRpY2lwYW50LmlzQWxsU2NvcGUgJiYgXHJcbiAgICAgICghdGhpcy5hbHRlcm5hdGl2ZVBhcnRpY2lwYW50LnBhcnRpY2lwYW50LnBvdGVudGlhbE93bmVyTGlzdCB8fCB0aGlzLmFsdGVybmF0aXZlUGFydGljaXBhbnQucGFydGljaXBhbnQucG90ZW50aWFsT3duZXJMaXN0Lmxlbmd0aCA8PSAwKSkge1xyXG4gICAgICAgIHRoaXMubWVzc2FnZS5pbmZvKHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oJ2NvbXBvbmVudC5vcmdQb3RlbnRpYWxPd25lci50dXJuT2ZmUHJvbXB0JykpO1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgfWVsc2Uge1xyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICB9XHJcbiAgfVxyXG4gIHZhbHVlQ2hhbmdlKGV2ZW50OiBhbnkpIHtcclxuICAgIHN3aXRjaCAoZXZlbnQudmFsdWUpIHtcclxuICAgICAgY2FzZSB0aGlzLm9yZ2FuaXphdGlvbkxldmVsQ29sbGVjdGlvblswXS52YWx1ZTpcclxuICAgICAgICB0aGlzLmluY2x1ZGVDaGlsZHJlbiA9IGZhbHNlO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlIHRoaXMub3JnYW5pemF0aW9uTGV2ZWxDb2xsZWN0aW9uWzFdLnZhbHVlOlxyXG4gICAgICAgIHRoaXMuaW5jbHVkZUNoaWxkcmVuID0gdHJ1ZTtcclxuICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSB0aGlzLm9yZ2FuaXphdGlvbkxldmVsQ29sbGVjdGlvblsyXS52YWx1ZTpcclxuICAgICAgICB0aGlzLmluY2x1ZGVDaGlsZHJlbiA9IGZhbHNlO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlIHRoaXMub3JnYW5pemF0aW9uTGV2ZWxDb2xsZWN0aW9uWzNdLnZhbHVlOlxyXG4gICAgICAgIHRoaXMuaW5jbHVkZUNoaWxkcmVuID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLm9yZ2FuaXphdGlvbklkID0gJyc7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICB9XHJcbiAgfVxyXG4gIGFjdGlvbk5hbWUgPSAoKSA9PiB7XHJcbiAgICByZXR1cm4gdGhpcy5hY3Rpb25Db2xsZWN0aW9uLmZpbmQoYSA9PiBhLnZhbHVlID09PSB0aGlzLmFjdGlvbikubmFtZTtcclxuICB9XHJcbiAgY2xlYXIoJGV2ZW50KSB7XHJcbiAgICB0aGlzLm9yZ2FuaXphdGlvbklkID0gJyc7XHJcbiAgfVxyXG4gIHNlbGVjdFZhbHVlKGRhdGE6IGFueSkge1xyXG4gICAgdGhpcy5zaG93RXhwckhlbHAoKTtcclxuICB9XHJcblxyXG4gIHNob3dFeHBySGVscCgpIHtcclxuICAgIGNvbnN0IGNvbnRleHQgPSBuZXcgQXJyYXk8VmFyRW50aXR5PigpO1xyXG4gICAgLy8gaWYodGhpcy5leHByLmV4cHJFbnRpdHkuY29udGV4dEVudGl0aWVzLmZpbmQoeCA9PiB4LmtleSA9PT0gJ0N1cnJlbnRMYW5ndWFnZScpKSB7XHJcbiAgICAvLyAgIGNvbnRleHQucHVzaCh0aGlzLmV4cHIuZXhwckVudGl0eS5jb250ZXh0RW50aXRpZXMuZmluZCh4ID0+IHgua2V5ID09PSAnQ3VycmVudExhbmd1YWdlJykpO1xyXG4gICAgLy8gfVxyXG4gICAgLy8gdGhpcy5leHByLmNsZWFyQ29udGV4dCgpO1xyXG4gICAgdGhpcy5leHByLnNldEVkaXRQYXR0ZXJuKEV4cHJFZGl0TW9kZS5BZHZhbmNlZCk7XHJcbiAgICBpZiAodGhpcy5kZXNpZ25lclVJU3RhdGUuc2NoZW1hcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgIGZvciAoY29uc3Qgc2NoZW1hIG9mIHRoaXMuZGVzaWduZXJVSVN0YXRlLnNjaGVtYXMpIHtcclxuICAgICAgICB0aGlzLmV4cHIuYWRkU2NoZW1hKCdTY2hlbWEnLCBzY2hlbWEpO1xyXG4gICAgICB9XHJcbiAgICAgIGlmICh0aGlzLmRlc2lnbmVyVUlTdGF0ZS5zY2hlbWFzWzBdLmVudGl0eVR5cGVzICYmIHRoaXMuZGVzaWduZXJVSVN0YXRlLnNjaGVtYXNbMF0uZW50aXR5VHlwZXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgIGNvbnN0IGVudGl0eVR5cGUgPSB0aGlzLmRlc2lnbmVyVUlTdGF0ZS5zY2hlbWFzWzBdLmVudGl0eVR5cGVzWzBdO1xyXG4gICAgICAgIHRoaXMuZXhwci5hZGRJbmplY3RlZEVudGl0eShlbnRpdHlUeXBlLm5hbWUsICdTY2hlbWEnLFxyXG4gICAgICAgICAgZW50aXR5VHlwZS5uYW1lLCBJbmplY3RlZFR5cGUuRW50aXR5VHlwZSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIGlmICh0aGlzLmRlc2lnbmVyVUlTdGF0ZS5wYXJ0aWNpcGFudENvbnRleHQubGVuZ3RoID4gMCkge1xyXG4gICAgICBmb3IgKGNvbnN0IHZhcmlhYmxlIG9mIHRoaXMuZGVzaWduZXJVSVN0YXRlLnBhcnRpY2lwYW50Q29udGV4dCkge1xyXG4gICAgICAgIGNvbnRleHQucHVzaCh2YXJpYWJsZSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIGlmICh0aGlzLmRlc2lnbmVyVUlTdGF0ZS5wcm9jZXNzVmFyaWFibGVDb250ZXh0Lmxlbmd0aCA+IDApIHtcclxuICAgICAgZm9yIChjb25zdCB2YXJpYWJsZSBvZiB0aGlzLmRlc2lnbmVyVUlTdGF0ZS5wcm9jZXNzVmFyaWFibGVDb250ZXh0KSB7XHJcbiAgICAgICAgaWYgKCFjb250ZXh0LnNvbWUoYyA9PiBjLmtleSA9PT0gdmFyaWFibGUua2V5KSkge1xyXG4gICAgICAgICAgY29udGV4dC5wdXNoKHZhcmlhYmxlKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIGlmICh0aGlzLmRlc2lnbmVyVUlTdGF0ZS5zdWJBY3Rpdml0eUNvbnRleHQubGVuZ3RoID4gMCkge1xyXG4gICAgICBmb3IgKGNvbnN0IHZhcmlhYmxlIG9mIHRoaXMuZGVzaWduZXJVSVN0YXRlLnN1YkFjdGl2aXR5Q29udGV4dCkge1xyXG4gICAgICAgIGlmICghY29udGV4dC5zb21lKGMgPT4gYy5rZXkgPT09IHZhcmlhYmxlLmtleSkpIHtcclxuICAgICAgICAgIGNvbnRleHQucHVzaCh2YXJpYWJsZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBpZiAoY29udGV4dC5sZW5ndGggPiAwKSB7XHJcbiAgICAgIGZvciAoY29uc3QgdiBvZiBjb250ZXh0KSB7XHJcbiAgICAgICAgdGhpcy5leHByLmFkZENvbnRleHQodik7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIC8vIOmihOe9ruihqOi+vuW8j+WxleekuuaWh+acrFxyXG4gICAgaWYgKHRoaXMub3JnYW5pemF0aW9uSWQpIHtcclxuICAgICAgdGhpcy5leHByLmFkZEV4cHJlc3Npb25UZXh0KHRoaXMub3JnYW5pemF0aW9uSWQpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5leHByLmFkZEV4cHJlc3Npb25UZXh0KCcnKTtcclxuICAgIH1cclxuICAgIHRoaXMuZXhwci5idWlsZEV4cHJlc3Npb24oKS50aGVuKChleHByZXNzaW9uaW5mbzogc3RyaW5nKSA9PiB7XHJcbiAgICAgIGlmIChleHByZXNzaW9uaW5mbykge1xyXG4gICAgICAgIHRoaXMub3JnYW5pemF0aW9uSWQgPSBleHByZXNzaW9uaW5mbztcclxuICAgICAgICB0aGlzLm9yZ2FuaXphdGlvbkxldmVsQ29sbGVjdGlvblszXS5vcmdJZCA9IGV4cHJlc3Npb25pbmZvO1xyXG4gICAgICB9XHJcbiAgICAgIC8v54K55Ye756Gu5a6a5ZCO77yM5Y676Zmk6KGo6L6+5byP6YeM6Z2i55qE5paw5aKe55qE5LiK5LiL5paH5Y+Y6YePXHJcbiAgICAgIGlmKGNvbnRleHQubGVuZ3RoID4gMCkge1xyXG4gICAgICAgIHRoaXMuZXhwci5leHByRW50aXR5LmNvbnRleHRFbnRpdGllcyA9IHRoaXMuZXhwci5leHByRW50aXR5LmNvbnRleHRFbnRpdGllcy5maWx0ZXIoeCA9PiAhY29udGV4dC5zb21lKHkgPT4geS5rZXkgPT09IHgua2V5KSk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgbW9kYWxDb25maWcgPSB7XHJcbiAgICB0aXRsZTogdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybSgnY29tcG9uZW50Lm9yZ1BvdGVudGlhbE93bmVyLm9wdGlvblNldHRpbmdzJyksXHJcbiAgICB3aWR0aDogNzYwLFxyXG4gICAgaGVpZ2h0OiA1MDYsXHJcbiAgICBzaG93QnV0dG9uczogdHJ1ZVxyXG4gIH07XHJcbn1cclxuZXhwb3J0IGNsYXNzIE9yZ2FuaXphdGlvblBvdGVudGlhbE93bmVyQ29udmVydGVyIGltcGxlbWVudHMgVHlwZUNvbnZlcnRlciB7XHJcbiAgY29uc3RydWN0b3IoXHJcbiAgICBwcml2YXRlIGxvY2FsZVBpcGU6IFdmTG9jYWxlUGlwZVxyXG4gICkgeyB9XHJcblxyXG4gIGNvbnZlcnRUbyhkYXRhOiBBY3Rpb25Pcmdhbml6YXRpb25TY29wZURlc2lnbik6IHN0cmluZyB7XHJcbiAgICBpZiAoZGF0YSAmJiBkYXRhLmFjdGlvbiA9PT0gQWN0aW9uU2NvcGUuVHJhbnNmZXIgYXMgYW55ICYmIChkYXRhLmVuYWJsZSA9PT0gbnVsbCB8fCBkYXRhLmVuYWJsZSA9PT0gdW5kZWZpbmVkKSkge1xyXG4gICAgICByZXR1cm4gdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybShcImNvbXBvbmVudC5vcmdQb3RlbnRpYWxPd25lci5zZXRcIik7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBpZiAoZGF0YSAmJiBkYXRhLmVuYWJsZSkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKFwiY29tcG9uZW50Lm9yZ1BvdGVudGlhbE93bmVyLnNldFwiKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybShcImNvbXBvbmVudC5vcmdQb3RlbnRpYWxPd25lci5ub3RTZXRcIik7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcbn1cclxuIl19