/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, HostBinding, Output, EventEmitter, Input, ViewChild, TemplateRef, Optional, ChangeDetectorRef, LOCALE_ID, Inject } from '@angular/core';
import { ProcessDesignerUIState } from '../../app/process-designer.uistate';
import { DialogComponent } from '@farris/ui-dialog';
import { MessagerService } from '@farris/ui-messager';
import { DatagridComponent } from '@farris/ui-datagrid';
import { LookupGridComponent } from '@farris/ui-lookup';
import { of } from 'rxjs';
import { WF_LANG_RESOURCES, WfLocalePipe } from '../../i18n/pipe/wf-process-editor-locale.pipe';
export class JumpScopeComponent {
    /**
     * @param {?} uistate
     * @param {?} message
     * @param {?} cdr
     * @param {?} localeId
     * @param {?} resources
     * @param {?} localePipe
     */
    constructor(uistate, message, cdr, localeId, resources, localePipe) {
        this.uistate = uistate;
        this.message = message;
        this.cdr = cdr;
        this.localeId = localeId;
        this.resources = resources;
        this.localePipe = localePipe;
        this.cls = 'farris-main-area flex-column';
        this.closeModal = new EventEmitter();
        this.submitModal = new EventEmitter();
        this.modalConfig = {
            title: this.localePipe.transform('component.jumpScope.targetNodeOptions'),
            width: 520,
            height: 460,
            showButtons: true
        };
        this.cols = [
            { title: this.localePipe.transform('component.jumpScope.name'), field: 'Name', width: 60, searchField: 'Name' },
            { title: 'ID', field: 'Id', width: 90, searchField: 'Id' }
        ];
        // ==========================================================
        this.actis = [];
        this.fullActis = [];
        this.defaultacty = '';
        this.categoryListItems = [
            { value: 'OutConnectNode', name: this.localePipe.transform('component.jumpScope.outConnectNode') },
            { value: 'Global', name: this.localePipe.transform('component.jumpScope.global') },
            { value: 'AfterNodes', name: this.localePipe.transform('component.jumpScope.afterNodes') },
            { value: 'SpecifiedSet', name: this.localePipe.transform('component.jumpScope.specifiedSet') }
        ];
        this.category = '';
        this.defaultType = '';
        this.defaultTypeListItems = [
            { value: 'FirstNode', name: this.localePipe.transform('component.jumpScope.firstNode') },
            { value: 'NullNode', name: this.localePipe.transform('component.jumpScope.nullNode') },
            { value: 'SpecifyNode', name: this.localePipe.transform('component.jumpScope.specifyNode') }
        ];
        this.defaultActivity = '';
        this.pageInfo = {
            pageIndex: 1,
            pageList: [10, 20, 30, 50],
            pageSize: 20
        };
        this.actisSelect = (/**
         * @param {?} rowData
         * @return {?}
         */
        (rowData) => {
            // 附加节点的帮助后事件，把选中的数据赋给fullActis（此处处理的目的是为了显示Name同时取Id值）
            // console.log(rowData);
            this.fullActis = rowData;
            return of({
                closeDialog: true
            });
        });
        this.defaultActivitySelect = (/**
         * @param {?} rowData
         * @return {?}
         */
        (rowData) => {
            // 默认节点的帮助后事件，把选中的id赋给defaultActivity（此处处理的目的是为了显示Name同时取Id值）
            this.defaultActivity = rowData.Id;
            return of({
                closeDialog: true
            });
        });
        this.localePipe = this.localePipe || new WfLocalePipe(localeId, resources);
    }
    /**
     * @param {?} data
     * @return {?}
     */
    set value(data) {
        if (data) {
            this.category = data.Category;
            this.defaultType = data.DefaultType;
            // 取到DefaultActivity的节点Id，遍历出Name绑定到radiogroup上去（defaultacty）
            /** @type {?} */
            const acty = data.DefaultActivity;
            if (acty != null) {
                for (const act of this.uistate.allActList) {
                    if (act.Id === acty) {
                        this.defaultacty = act.Name;
                    }
                }
            }
            // 取到DestinationActivities的节点Id，遍历出Id和Name绑定到radiogroup上去（actis）
            /** @type {?} */
            const strs = data.DestinationActivities;
            if (strs && strs.length > 0) {
                for (const str of strs) {
                    /** @type {?} */
                    const name = this.uistate.allActList.filter((/**
                     * @param {?} act
                     * @return {?}
                     */
                    act => act.Id === str))[0].Name;
                    // const acti = { Id: str, Name: name };
                    this.actis.push(name);
                }
            }
        }
        else {
            this.category = 'OutConnectNode';
            this.defaultType = 'FirstNode';
        }
    }
    /**
     * @return {?}
     */
    ngOnInit() {
    }
    /**
     * @return {?}
     */
    clickOK() {
        if (this.validator()) {
            /** @type {?} */
            let value;
            /** @type {?} */
            const list = [];
            // 重新打开设置界面，没有进行节点配置的情况（DefaultActivity）
            if (this.defaultActivity === '' && this.defaultacty !== '') {
                for (const defAct of this.uistate.allActList) {
                    if (defAct.Name === this.defaultacty) {
                        this.defaultActivity = defAct.Id;
                    }
                }
            }
            // 重新打开设置界面，没有进行节点配置的情况（DestinationActivities）
            if (this.fullActis.length === 0 && this.actis.length > 0) {
                for (const act of this.actis) {
                    for (const allAct of this.uistate.allActList) {
                        if (act === allAct.Name) {
                            list.push(allAct.Id);
                        }
                    }
                }
            }
            else if (this.category === 'SpecifiedSet' && this.fullActis && this.fullActis.length > 0) {
                // 附加节点的id传给模型上的DestinationActivities
                this.fullActis.forEach((/**
                 * @param {?} act
                 * @return {?}
                 */
                act => list.push(act.Id)));
            }
            value = {
                Category: this.category,
                DefaultType: this.defaultType,
                DefaultActivity: this.defaultActivity,
                DestinationActivities: list,
            };
            /** @type {?} */
            const object = { value, parameters: null };
            this.submitModal.emit(object);
        }
    }
    /**
     * @return {?}
     */
    clickCancel() {
        this.closeModal.emit();
    }
    /**
     * @private
     * @return {?}
     */
    validator() {
        if (!this.category) {
            this.message.warning(this.localePipe.transform('component.jumpScope.noSetTargetNode'));
            return false;
        }
        // if (this.category === 'SpecifiedSet' && Object.prototype.isPrototypeOf(this.actis)) {
        //   this.message.info('尚未选择附加节点，请了解！');
        //   return false;
        // }
        if (this.defaultType === 'SpecifyNode' && this.defaultacty === '') {
            this.message.warning(this.localePipe.transform('component.jumpScope.noSetSpecifyNode'));
            return false;
        }
        return true;
    }
    /**
     * @param {?} arg
     * @return {?}
     */
    searchDefault(arg) {
        this.pageInfo.pageIndex = arg.pageInfo.pageIndex;
        this.pageInfo.pageSize = arg.pageInfo.pageSize;
        /** @type {?} */
        const search = arg.search;
        this.loadDefault(search);
    }
    /**
     * @param {?=} search
     * @return {?}
     */
    loadDefault(search) {
        /** @type {?} */
        const start = (this.pageInfo.pageIndex - 1) * this.pageInfo.pageSize;
        /** @type {?} */
        const end = start + this.pageInfo.pageSize;
        /** @type {?} */
        let items = [];
        if (search && search.value) {
            if (search.field === '*') {
                items = this.uistate.allActList.filter((/**
                 * @param {?} i
                 * @return {?}
                 */
                i => i.Name.indexOf(search.value) > -1 || i.Id.indexOf(search.value) > -1));
            }
            else {
                items = this.uistate.allActList.filter((/**
                 * @param {?} f
                 * @return {?}
                 */
                f => f[search.field].indexOf(search.value) > -1));
            }
        }
        else {
            items = this.uistate.allActList;
        }
        this.total = items.length;
        // this.items = items;
        if (items) {
            this.allActisTable.componentRef.instance.loadData({
                data: items
            });
        }
    }
    /**
     * @param {?} arg
     * @return {?}
     */
    searchSelect(arg) {
        this.pageInfo.pageIndex = arg.pageInfo.pageIndex;
        this.pageInfo.pageSize = arg.pageInfo.pageSize;
        /** @type {?} */
        const search = arg.search;
        this.loadSelect(search);
    }
    /**
     * @param {?=} search
     * @return {?}
     */
    loadSelect(search) {
        /** @type {?} */
        const start = (this.pageInfo.pageIndex - 1) * this.pageInfo.pageSize;
        /** @type {?} */
        const end = start + this.pageInfo.pageSize;
        /** @type {?} */
        let items = [];
        if (search && search.value) {
            if (search.field === '*') {
                items = this.uistate.allActList.filter((/**
                 * @param {?} i
                 * @return {?}
                 */
                i => i.Name.indexOf(search.value) > -1 || i.Id.indexOf(search.value) > -1));
            }
            else {
                items = this.uistate.allActList.filter((/**
                 * @param {?} f
                 * @return {?}
                 */
                f => f[search.field].indexOf(search.value) > -1));
            }
        }
        else {
            items = this.uistate.allActList;
        }
        this.total = items.length;
        // this.items = items;
        if (items) {
            this.userActis.componentRef.instance.loadData({
                data: items
            });
        }
    }
    /**
     * @return {?}
     */
    deleteRow() {
        if (this.actTable.selectedRow && this.actTable.selectedRow.data) {
            /** @type {?} */
            const i = this.actis.findIndex((/**
             * @param {?} d
             * @return {?}
             */
            d => d.id === this.actTable.selectedRow.data.id));
            this.actis.splice(i, 1);
            this.actTable.loadData(this.actis);
        }
        else {
            this.message.info(this.localePipe.transform('component.jumpScope.selectedRow'));
        }
    }
}
JumpScopeComponent.decorators = [
    { type: Component, args: [{
                selector: 'app-jump-scope',
                template: "<div class=\"f-page\">\r\n  <div class=\"f-utils-fill-flex-column farris-split-section m-2 h-100\">\r\n    <section class=\"f-utils-fill-flex-column h-100\">\r\n      <div class=\"f-utils-fill-flex-column h-100\">\r\n        <form class=\"h-100\">\r\n          <div class=\"f-utils-fill-flex-column h-100\">\r\n            <!-- \u5141\u8BB8\u9009\u62E9\u76EE\u6807\u8282\u70B9\u5355\u9009\u9879 -->\r\n            <!-- <div class=\"mx-4 mt-3 farris-form-controls-inline\">\r\n              <div class=\"farris-group-wrap\">\r\n                <div class=\"form-group farris-form-group\">\r\n                  <div class=\"farris-input-wrap\">\r\n                    <div class=\"custom-control custom-checkbox\">\r\n                      <input class=\"custom-control-input\" name=\"submitterAutoPass\" type=\"checkbox\"\r\n                        id=\"submitterAutoPass\" [(ngModel)]=\"outConnectNode\" />\r\n                      <label class=\"custom-control-label\" for=\"submitterAutoPass\">\u5141\u8BB8\u9009\u62E9\u76EE\u6807\u8282\u70B9</label>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div> -->\r\n            <!-- \u53EF\u9009\u8282\u70B9\u5C0F\u6807\u9898 -->\r\n            <div class=\"mx-2 mt-1\">\r\n              <div class=\"title-content\">\r\n                <h4 class=\"title-text\">{{'component.jumpScope.optionalNodes'|wfLocale}}</h4><span class=\"title-line\"></span>\r\n              </div>\r\n            </div>\r\n            <div class=\"mt-2 mx-4 farris-form-controls-inline\">\r\n              <div class=\"farris-group-wrap\">\r\n                <div class=\"form-group\">\r\n                  <!-- \u7AD6\u5217\u679A\u4E3E\u7684category\u9009\u9879 -->\r\n                  <farris-radiogroup [(ngModel)]=\"category\" [data]=\"categoryListItems\" name=\"category\"\r\n                    [horizontal]=false>\r\n                  </farris-radiogroup>\r\n                </div>\r\n                <!-- \u9644\u52A0\u8282\u70B9\u5E2E\u52A9 -->\r\n                <farris-lookup-grid #userActisDialog\r\n                  [items]=\"uistate.allActList | jumpScopePipe:uistate.propertyData.Id \" [columns]=\"cols\"\r\n                  [disabled]=\"!(category === 'SpecifiedSet')\" [resizable]=\"true\" [singleSelect]=\"false\" [idField]=\"'Id'\"\r\n                  [textField]=\"'Name'\" [(ngModel)]=\"actis\" [valueField]=\"'Id'\" [pagination]=\"true\"\r\n                  [pageIndex]=\"pageInfo.pageIndex\" name=\"defaultActivities\" [pageSize]=\"pageInfo.pageSize\" (search)=\"searchSelect($event)\"\r\n                  [pageList]=\"pageInfo.pageList\" [total]=\"total\" [enableClear]=\"false\" title=\"{{'component.jumpScope.listOfAdditional'|wfLocale}}\"\r\n                  [displayType]=\"'List'\" [remoteSearch]='false' [enableToSelect]=\"false\" placeholder=\"{{'component.jumpScope.pleaseSelect1'|wfLocale}}\" [dictPicked]=\"actisSelect\">\r\n                </farris-lookup-grid>\r\n              </div>\r\n            </div>\r\n            <!-- \u9ED8\u8BA4\u8282\u70B9\u5C0F\u6807\u9898 -->\r\n            <div class=\"mx-2 mt-1\">\r\n              <div class=\"title-content\">\r\n                <h4 class=\"title-text\">{{'component.jumpScope.defaultNode'|wfLocale}}</h4><span class=\"title-line\"></span>\r\n              </div>\r\n            </div>\r\n            <div class=\"mt-2 mx-4 farris-form-controls-inline\">\r\n              <div class=\"farris-group-wrap\">\r\n                <div class=\"form-group\">\r\n                  <!-- \u7AD6\u5217\u679A\u4E3E\u7684DefaultType\u9009\u9879 -->\r\n                  <farris-radiogroup [(ngModel)]=\"defaultType\" [data]=\"defaultTypeListItems\" name=\"defaultType\"\r\n                    [horizontal]=false>\r\n                  </farris-radiogroup>\r\n                </div>\r\n                <!-- \u9ED8\u8BA4\u8282\u70B9\u5E2E\u52A9 -->\r\n                <farris-lookup-grid #allActisTable [items]=\"uistate.allActList | jumpScopePipe:uistate.propertyData.Id \"\r\n                  [columns]=\"cols\" [disabled]=\"!(defaultType === 'SpecifyNode')\" [resizable]=\"true\"\r\n                  [singleSelect]=\"true\" [idField]=\"'Id'\" [textField]=\"'Name'\" [(ngModel)]=\"defaultacty\"\r\n                  [valueField]=\"'Id'\" [pagination]=\"true\" placeholder=\"{{'component.jumpScope.pleaseSelect2'|wfLocale}}\" [pageIndex]=\"pageInfo.pageIndex\"\r\n                  name=\"defaultActivity\" [pageSize]=\"pageInfo.pageSize\" [pageList]=\"pageInfo.pageList\" [total]=\"total\"\r\n                  [enableClear]=\"false\" title=\"{{'component.jumpScope.defaultNodeList'|wfLocale}}\" (search)=\"searchDefault($event)\" [displayType]=\"'List'\" [remoteSearch]='false' [dictPicked]=\"defaultActivitySelect\">\r\n                </farris-lookup-grid>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </section>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type=\"button\" class=\"btn btn-secondary btn-sm\" (click)=\"clickCancel()\">{{'component.jumpScope.clickCancel'|wfLocale}}</button>\r\n  <button type=\"button\" class=\"btn btn-primary btn-sm mx-2\" (click)=\"clickOK()\">{{'component.jumpScope.clickOK'|wfLocale}}</button>\r\n</ng-template>\r\n\r\n<!-- <ng-template #buttonRef>\r\n  <button class=\"btn btn-sm btn-primary mx-2\" (click)=\"actisSelect()\">\u786E\u5B9A</button>\r\n  <button class=\"btn btn-sm btn-default\" (click)=\"allActisDialog.close()\">\u53D6\u6D88</button>\r\n</ng-template> -->\r\n<!-- <farris-dialog #allActisDialog [buttons]=\"buttonRef\" [width]=\"700\" [height]=\"520\" title=\"'\u6D3B\u52A8\u5217\u8868'\">\r\n  <div class=\"f-utils-fill-flex-column farris-overflow-y-auto h-100 m-2\">\r\n    <farris-datagrid #allActisTable [columns]=\"cols\"\r\n      [data]=\"uistate.userActList | jumpScopePipe:uistate.propertyData.Id\" [idField]=\"'Id'\" [fit]=\"true\"\r\n      [fitColumns]=\"true\" [pagination]='false' [multiSelect]=\"true\" [showCheckbox]=\"true\" [multiSelect]=\"true\"\r\n      [checkOnSelect]=\"true\" [selectOnCheck]=\"true\">\r\n    </farris-datagrid>\r\n  </div>\r\n</farris-dialog> -->\r\n",
                providers: [
                    WfLocalePipe,
                ],
                styles: [".title-content{color:#000;display:inline-flex;align-items:center;line-height:1.375rem;position:relative;overflow:hidden;padding:0 0 0 1rem;min-width:760px}.title-content ::before{content:'';width:.25rem;height:1.125rem;background:#59a1ff;border-radius:1px;position:absolute;top:50%;left:0;margin-top:-.5625rem}.title-text{font-size:1rem;line-height:1.375rem;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;margin-bottom:0;margin-right:10px}.title-line{flex-grow:1;border-bottom:1px dashed rgba(0,0,0,.1)}"]
            }] }
];
/** @nocollapse */
JumpScopeComponent.ctorParameters = () => [
    { type: ProcessDesignerUIState },
    { type: MessagerService },
    { type: ChangeDetectorRef, decorators: [{ type: Optional }] },
    { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
    { type: undefined, decorators: [{ type: Inject, args: [WF_LANG_RESOURCES,] }] },
    { type: WfLocalePipe, decorators: [{ type: Optional }] }
];
JumpScopeComponent.propDecorators = {
    cls: [{ type: HostBinding, args: ['class',] }],
    closeModal: [{ type: Output }],
    submitModal: [{ type: Output }],
    value: [{ type: Input }],
    modalFooter: [{ type: ViewChild, args: ['iconSelectFooter',] }],
    allActisTable: [{ type: ViewChild, args: ['allActisTable',] }],
    allActisDialog: [{ type: ViewChild, args: ['allActisDialog',] }],
    actTable: [{ type: ViewChild, args: ['actTable',] }],
    lookup: [{ type: ViewChild, args: ['lookup',] }],
    userActis: [{ type: ViewChild, args: ['userActisDialog',] }]
};
if (false) {
    /** @type {?} */
    JumpScopeComponent.prototype.cls;
    /** @type {?} */
    JumpScopeComponent.prototype.closeModal;
    /** @type {?} */
    JumpScopeComponent.prototype.submitModal;
    /** @type {?} */
    JumpScopeComponent.prototype.modalFooter;
    /** @type {?} */
    JumpScopeComponent.prototype.modalConfig;
    /** @type {?} */
    JumpScopeComponent.prototype.allActisTable;
    /** @type {?} */
    JumpScopeComponent.prototype.allActisDialog;
    /** @type {?} */
    JumpScopeComponent.prototype.actTable;
    /** @type {?} */
    JumpScopeComponent.prototype.lookup;
    /** @type {?} */
    JumpScopeComponent.prototype.userActis;
    /** @type {?} */
    JumpScopeComponent.prototype.cols;
    /** @type {?} */
    JumpScopeComponent.prototype.actis;
    /** @type {?} */
    JumpScopeComponent.prototype.fullActis;
    /** @type {?} */
    JumpScopeComponent.prototype.defaultacty;
    /** @type {?} */
    JumpScopeComponent.prototype.categoryListItems;
    /** @type {?} */
    JumpScopeComponent.prototype.category;
    /** @type {?} */
    JumpScopeComponent.prototype.defaultType;
    /** @type {?} */
    JumpScopeComponent.prototype.defaultTypeListItems;
    /** @type {?} */
    JumpScopeComponent.prototype.defaultActivity;
    /** @type {?} */
    JumpScopeComponent.prototype.pageInfo;
    /** @type {?} */
    JumpScopeComponent.prototype.outConnectNode;
    /** @type {?} */
    JumpScopeComponent.prototype.total;
    /** @type {?} */
    JumpScopeComponent.prototype.actisSelect;
    /** @type {?} */
    JumpScopeComponent.prototype.defaultActivitySelect;
    /** @type {?} */
    JumpScopeComponent.prototype.uistate;
    /**
     * @type {?}
     * @private
     */
    JumpScopeComponent.prototype.message;
    /**
     * @type {?}
     * @private
     */
    JumpScopeComponent.prototype.cdr;
    /**
     * @type {?}
     * @private
     */
    JumpScopeComponent.prototype.localeId;
    /**
     * @type {?}
     * @private
     */
    JumpScopeComponent.prototype.resources;
    /**
     * @type {?}
     * @private
     */
    JumpScopeComponent.prototype.localePipe;
}
export class JumpScopeConverter {
    /**
     * @param {?} localePipe
     */
    constructor(localePipe) {
        this.localePipe = localePipe;
    }
    /**
     * @return {?}
     */
    convertTo() {
        return this.localePipe.transform('component.jumpScope.set');
    }
}
if (false) {
    /**
     * @type {?}
     * @private
     */
    JumpScopeConverter.prototype.localePipe;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoianVtcC1zY29wZS5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZ3NwLXdmL3dmLXByb2Nlc3MtZWRpdG9yLyIsInNvdXJjZXMiOlsibGliL3ZpZXdzL2p1bXAtc2NvcGUvanVtcC1zY29wZS5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQVUsV0FBVyxFQUFFLE1BQU0sRUFBRSxZQUFZLEVBQUUsS0FBSyxFQUFFLFNBQVMsRUFBRSxXQUFXLEVBQUUsUUFBUSxFQUFFLGlCQUFpQixFQUFFLFNBQVMsRUFBRSxNQUFNLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFFcEssT0FBTyxFQUFFLHNCQUFzQixFQUFFLE1BQU0sb0NBQW9DLENBQUM7QUFDNUUsT0FBTyxFQUFFLGVBQWUsRUFBRSxNQUFNLG1CQUFtQixDQUFDO0FBQ3BELE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUN0RCxPQUFPLEVBQUUsaUJBQWlCLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUN4RCxPQUFPLEVBQUUsbUJBQW1CLEVBQWdCLE1BQU0sbUJBQW1CLENBQUM7QUFDdEUsT0FBTyxFQUFjLEVBQUUsRUFBRSxNQUFNLE1BQU0sQ0FBQztBQUN0QyxPQUFPLEVBQUUsaUJBQWlCLEVBQUUsWUFBWSxFQUFFLE1BQU0sK0NBQStDLENBQUM7QUFXaEcsTUFBTSxPQUFPLGtCQUFrQjs7Ozs7Ozs7O0lBNEU3QixZQUNTLE9BQStCLEVBQzlCLE9BQXdCLEVBQ1osR0FBc0IsRUFDZixRQUFnQixFQUNSLFNBQWMsRUFDN0IsVUFBd0I7UUFMckMsWUFBTyxHQUFQLE9BQU8sQ0FBd0I7UUFDOUIsWUFBTyxHQUFQLE9BQU8sQ0FBaUI7UUFDWixRQUFHLEdBQUgsR0FBRyxDQUFtQjtRQUNmLGFBQVEsR0FBUixRQUFRLENBQVE7UUFDUixjQUFTLEdBQVQsU0FBUyxDQUFLO1FBQzdCLGVBQVUsR0FBVixVQUFVLENBQWM7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LENBQWM7SUFDOUIsQ0FBQzs7OztJQUVMLFNBQVM7UUFDUCxPQUFPLElBQUksQ0FBQyxVQUFVLENBQUMsU0FBUyxDQUFDLHlCQUF5QixDQUFDLENBQUM7SUFDOUQsQ0FBQztDQUNGOzs7Ozs7SUFORyx3Q0FBZ0MiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIE9uSW5pdCwgSG9zdEJpbmRpbmcsIE91dHB1dCwgRXZlbnRFbWl0dGVyLCBJbnB1dCwgVmlld0NoaWxkLCBUZW1wbGF0ZVJlZiwgT3B0aW9uYWwsIENoYW5nZURldGVjdG9yUmVmLCBMT0NBTEVfSUQsIEluamVjdCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBUeXBlQ29udmVydGVyIH0gZnJvbSAnQGZhcnJpcy9pZGUtcHJvcGVydHktcGFuZWwnO1xyXG5pbXBvcnQgeyBQcm9jZXNzRGVzaWduZXJVSVN0YXRlIH0gZnJvbSAnLi4vLi4vYXBwL3Byb2Nlc3MtZGVzaWduZXIudWlzdGF0ZSc7XHJcbmltcG9ydCB7IERpYWxvZ0NvbXBvbmVudCB9IGZyb20gJ0BmYXJyaXMvdWktZGlhbG9nJztcclxuaW1wb3J0IHsgTWVzc2FnZXJTZXJ2aWNlIH0gZnJvbSAnQGZhcnJpcy91aS1tZXNzYWdlcic7XHJcbmltcG9ydCB7IERhdGFncmlkQ29tcG9uZW50IH0gZnJvbSAnQGZhcnJpcy91aS1kYXRhZ3JpZCc7XHJcbmltcG9ydCB7IExvb2t1cEdyaWRDb21wb25lbnQsIFBpY2tlZFJlc3VsdCB9IGZyb20gJ0BmYXJyaXMvdWktbG9va3VwJztcclxuaW1wb3J0IHsgT2JzZXJ2YWJsZSwgb2YgfSBmcm9tICdyeGpzJztcclxuaW1wb3J0IHsgV0ZfTEFOR19SRVNPVVJDRVMsIFdmTG9jYWxlUGlwZSB9IGZyb20gJy4uLy4uL2kxOG4vcGlwZS93Zi1wcm9jZXNzLWVkaXRvci1sb2NhbGUucGlwZSc7XHJcbmltcG9ydCB7IFdGX1BST0NFU1NfRURJVE9SX0xBTkdfUkVTT1VSQ0VTIH0gZnJvbSAnLi4vLi4vaTE4bi9hc3NldHMvbGFuZy5yZXNvdXJjZSc7XHJcblxyXG5AQ29tcG9uZW50KHtcclxuICBzZWxlY3RvcjogJ2FwcC1qdW1wLXNjb3BlJyxcclxuICB0ZW1wbGF0ZVVybDogJy4vanVtcC1zY29wZS5jb21wb25lbnQuaHRtbCcsXHJcbiAgc3R5bGVVcmxzOiBbJy4vanVtcC1zY29wZS5jb21wb25lbnQuY3NzJ10sXHJcbiAgcHJvdmlkZXJzOiBbXHJcbiAgICAgV2ZMb2NhbGVQaXBlLFxyXG4gIF1cclxufSlcclxuZXhwb3J0IGNsYXNzIEp1bXBTY29wZUNvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCB7XHJcbiAgQEhvc3RCaW5kaW5nKCdjbGFzcycpXHJcbiAgY2xzID0gJ2ZhcnJpcy1tYWluLWFyZWEgZmxleC1jb2x1bW4nO1xyXG5cclxuICBAT3V0cHV0KCkgY2xvc2VNb2RhbCA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xyXG4gIEBPdXRwdXQoKSBzdWJtaXRNb2RhbCA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xyXG5cclxuICBASW5wdXQoKVxyXG4gIHNldCB2YWx1ZShkYXRhOiBhbnkpIHtcclxuICAgIGlmIChkYXRhKSB7XHJcbiAgICAgIHRoaXMuY2F0ZWdvcnkgPSBkYXRhLkNhdGVnb3J5O1xyXG4gICAgICB0aGlzLmRlZmF1bHRUeXBlID0gZGF0YS5EZWZhdWx0VHlwZTtcclxuICAgICAgLy8g5Y+W5YiwRGVmYXVsdEFjdGl2aXR555qE6IqC54K5SWTvvIzpgY3ljoblh7pOYW1l57uR5a6a5YiwcmFkaW9ncm91cOS4iuWOu++8iGRlZmF1bHRhY3R577yJXHJcbiAgICAgIGNvbnN0IGFjdHk6IHN0cmluZyA9IGRhdGEuRGVmYXVsdEFjdGl2aXR5O1xyXG4gICAgICBpZiAoYWN0eSAhPSBudWxsKSB7XHJcbiAgICAgICAgZm9yIChjb25zdCBhY3Qgb2YgdGhpcy51aXN0YXRlLmFsbEFjdExpc3QpIHtcclxuICAgICAgICAgIGlmIChhY3QuSWQgPT09IGFjdHkpIHtcclxuICAgICAgICAgICAgdGhpcy5kZWZhdWx0YWN0eSA9IGFjdC5OYW1lO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICAvLyDlj5bliLBEZXN0aW5hdGlvbkFjdGl2aXRpZXPnmoToioLngrlJZO+8jOmBjeWOhuWHuklk5ZKMTmFtZee7keWumuWIsHJhZGlvZ3JvdXDkuIrljrvvvIhhY3Rpc++8iVxyXG4gICAgICBjb25zdCBzdHJzOiBzdHJpbmdbXSA9IGRhdGEuRGVzdGluYXRpb25BY3Rpdml0aWVzO1xyXG4gICAgICBpZiAoc3RycyAmJiBzdHJzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICBmb3IgKGNvbnN0IHN0ciBvZiBzdHJzKSB7XHJcbiAgICAgICAgICBjb25zdCBuYW1lID0gdGhpcy51aXN0YXRlLmFsbEFjdExpc3QuZmlsdGVyKGFjdCA9PiBhY3QuSWQgPT09IHN0cilbMF0uTmFtZTtcclxuICAgICAgICAgIC8vIGNvbnN0IGFjdGkgPSB7IElkOiBzdHIsIE5hbWU6IG5hbWUgfTtcclxuICAgICAgICAgIHRoaXMuYWN0aXMucHVzaChuYW1lKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuY2F0ZWdvcnkgPSAnT3V0Q29ubmVjdE5vZGUnO1xyXG4gICAgICB0aGlzLmRlZmF1bHRUeXBlID0gJ0ZpcnN0Tm9kZSc7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBAVmlld0NoaWxkKCdpY29uU2VsZWN0Rm9vdGVyJykgbW9kYWxGb290ZXI6IFRlbXBsYXRlUmVmPGFueT47XHJcbiAgbW9kYWxDb25maWcgPSB7XHJcbiAgICB0aXRsZTogdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybSgnY29tcG9uZW50Lmp1bXBTY29wZS50YXJnZXROb2RlT3B0aW9ucycpLFxyXG4gICAgd2lkdGg6IDUyMCxcclxuICAgIGhlaWdodDogNDYwLFxyXG4gICAgc2hvd0J1dHRvbnM6IHRydWVcclxuICB9O1xyXG4gIC8vIOa0u+WKqOiKgueCueihqOS/oeaBrz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbiAgQFZpZXdDaGlsZCgnYWxsQWN0aXNUYWJsZScpIGFsbEFjdGlzVGFibGU6IExvb2t1cEdyaWRDb21wb25lbnQ7XHJcbiAgQFZpZXdDaGlsZCgnYWxsQWN0aXNEaWFsb2cnKSBhbGxBY3Rpc0RpYWxvZzogRGlhbG9nQ29tcG9uZW50O1xyXG4gIEBWaWV3Q2hpbGQoJ2FjdFRhYmxlJykgYWN0VGFibGU6IERhdGFncmlkQ29tcG9uZW50O1xyXG4gIEBWaWV3Q2hpbGQoJ2xvb2t1cCcpIGxvb2t1cDogTG9va3VwR3JpZENvbXBvbmVudDtcclxuICBAVmlld0NoaWxkKCd1c2VyQWN0aXNEaWFsb2cnKSB1c2VyQWN0aXM6IExvb2t1cEdyaWRDb21wb25lbnQ7XHJcblxyXG4gIGNvbHMgPSBbXHJcbiAgICB7IHRpdGxlOiB0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKCdjb21wb25lbnQuanVtcFNjb3BlLm5hbWUnKSwgZmllbGQ6ICdOYW1lJywgd2lkdGg6IDYwLCBzZWFyY2hGaWVsZDogJ05hbWUnIH0sXHJcbiAgICB7IHRpdGxlOiAnSUQnLCBmaWVsZDogJ0lkJywgd2lkdGg6IDkwLCBzZWFyY2hGaWVsZDogJ0lkJyB9XTtcclxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbiAgYWN0aXMgPSBbXTtcclxuICBmdWxsQWN0aXMgPSBbXTtcclxuICBkZWZhdWx0YWN0eSA9ICcnO1xyXG4gIGNhdGVnb3J5TGlzdEl0ZW1zID0gW1xyXG4gICAgeyB2YWx1ZTogJ091dENvbm5lY3ROb2RlJywgbmFtZTogdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybSgnY29tcG9uZW50Lmp1bXBTY29wZS5vdXRDb25uZWN0Tm9kZScpfSxcclxuICAgIHsgdmFsdWU6ICdHbG9iYWwnLCBuYW1lOiB0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKCdjb21wb25lbnQuanVtcFNjb3BlLmdsb2JhbCcpfSxcclxuICAgIHsgdmFsdWU6ICdBZnRlck5vZGVzJywgbmFtZTogdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybSgnY29tcG9uZW50Lmp1bXBTY29wZS5hZnRlck5vZGVzJyl9LFxyXG4gICAgeyB2YWx1ZTogJ1NwZWNpZmllZFNldCcsIG5hbWU6IHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oJ2NvbXBvbmVudC5qdW1wU2NvcGUuc3BlY2lmaWVkU2V0JykgfV07XHJcbiAgY2F0ZWdvcnkgPSAnJztcclxuICBkZWZhdWx0VHlwZSA9ICcnO1xyXG4gIGRlZmF1bHRUeXBlTGlzdEl0ZW1zID0gW1xyXG4gICAgeyB2YWx1ZTogJ0ZpcnN0Tm9kZScsIG5hbWU6IHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oJ2NvbXBvbmVudC5qdW1wU2NvcGUuZmlyc3ROb2RlJyl9LFxyXG4gICAgeyB2YWx1ZTogJ051bGxOb2RlJywgbmFtZTogdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybSgnY29tcG9uZW50Lmp1bXBTY29wZS5udWxsTm9kZScpfSxcclxuICAgIHsgdmFsdWU6ICdTcGVjaWZ5Tm9kZScsIG5hbWU6IHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oJ2NvbXBvbmVudC5qdW1wU2NvcGUuc3BlY2lmeU5vZGUnKSB9XTtcclxuICBkZWZhdWx0QWN0aXZpdHkgPSAnJztcclxuICBwYWdlSW5mbyA9IHtcclxuICAgIHBhZ2VJbmRleDogMSxcclxuICAgIHBhZ2VMaXN0OiBbMTAsIDIwLCAzMCwgNTBdLFxyXG4gICAgcGFnZVNpemU6IDIwXHJcbiAgfTtcclxuICBvdXRDb25uZWN0Tm9kZTogdHJ1ZTtcclxuICB0b3RhbDogbnVtYmVyO1xyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgcHVibGljIHVpc3RhdGU6IFByb2Nlc3NEZXNpZ25lclVJU3RhdGUsXHJcbiAgICBwcml2YXRlIG1lc3NhZ2U6IE1lc3NhZ2VyU2VydmljZSxcclxuICAgIEBPcHRpb25hbCgpIHByaXZhdGUgY2RyOiBDaGFuZ2VEZXRlY3RvclJlZixcclxuICAgIEBJbmplY3QoTE9DQUxFX0lEKSBwcml2YXRlIGxvY2FsZUlkOiBzdHJpbmcsXHJcbiAgICBASW5qZWN0KFdGX0xBTkdfUkVTT1VSQ0VTKSBwcml2YXRlIHJlc291cmNlczogYW55LFxyXG4gICAgQE9wdGlvbmFsKCkgcHJpdmF0ZSBsb2NhbGVQaXBlOiBXZkxvY2FsZVBpcGVcclxuICAgICkge1xyXG4gICAgICB0aGlzLmxvY2FsZVBpcGUgPSB0aGlzLmxvY2FsZVBpcGUgfHwgbmV3IFdmTG9jYWxlUGlwZShsb2NhbGVJZCwgcmVzb3VyY2VzKTtcclxuICAgICB9XHJcblxyXG4gIG5nT25Jbml0KCkge1xyXG4gIH1cclxuXHJcbiAgY2xpY2tPSygpIHtcclxuICAgIGlmICh0aGlzLnZhbGlkYXRvcigpKSB7XHJcbiAgICAgIGxldCB2YWx1ZTtcclxuICAgICAgY29uc3QgbGlzdCA9IFtdO1xyXG4gICAgICAvLyDph43mlrDmiZPlvIDorr7nva7nlYzpnaLvvIzmsqHmnInov5vooYzoioLngrnphY3nva7nmoTmg4XlhrXvvIhEZWZhdWx0QWN0aXZpdHnvvIlcclxuICAgICAgaWYgKCB0aGlzLmRlZmF1bHRBY3Rpdml0eSA9PT0gJycgJiYgdGhpcy5kZWZhdWx0YWN0eSAhPT0gJycpIHtcclxuICAgICAgICBmb3IgKGNvbnN0IGRlZkFjdCBvZiB0aGlzLnVpc3RhdGUuYWxsQWN0TGlzdCkge1xyXG4gICAgICAgICAgaWYgKGRlZkFjdC5OYW1lID09PSB0aGlzLmRlZmF1bHRhY3R5KSB7XHJcbiAgICAgICAgICAgIHRoaXMuZGVmYXVsdEFjdGl2aXR5ID0gZGVmQWN0LklkO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICAvLyDph43mlrDmiZPlvIDorr7nva7nlYzpnaLvvIzmsqHmnInov5vooYzoioLngrnphY3nva7nmoTmg4XlhrXvvIhEZXN0aW5hdGlvbkFjdGl2aXRpZXPvvIlcclxuICAgICAgaWYgKHRoaXMuZnVsbEFjdGlzLmxlbmd0aCA9PT0gMCAmJiB0aGlzLmFjdGlzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICBmb3IgKGNvbnN0IGFjdCBvZiB0aGlzLmFjdGlzKSB7XHJcbiAgICAgICAgICBmb3IgKGNvbnN0IGFsbEFjdCBvZiB0aGlzLnVpc3RhdGUuYWxsQWN0TGlzdCkge1xyXG4gICAgICAgICAgICBpZiAoYWN0ID09PSBhbGxBY3QuTmFtZSkge1xyXG4gICAgICAgICAgICAgIGxpc3QucHVzaChhbGxBY3QuSWQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9IGVsc2UgaWYgKHRoaXMuY2F0ZWdvcnkgPT09ICdTcGVjaWZpZWRTZXQnICYmIHRoaXMuZnVsbEFjdGlzICYmIHRoaXMuZnVsbEFjdGlzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAvLyDpmYTliqDoioLngrnnmoRpZOS8oOe7meaooeWei+S4iueahERlc3RpbmF0aW9uQWN0aXZpdGllc1xyXG4gICAgICAgIHRoaXMuZnVsbEFjdGlzLmZvckVhY2goYWN0ID0+IGxpc3QucHVzaChhY3QuSWQpKTtcclxuICAgICAgfVxyXG4gICAgICB2YWx1ZSA9IHtcclxuICAgICAgICBDYXRlZ29yeTogdGhpcy5jYXRlZ29yeSxcclxuICAgICAgICBEZWZhdWx0VHlwZTogdGhpcy5kZWZhdWx0VHlwZSxcclxuICAgICAgICBEZWZhdWx0QWN0aXZpdHk6IHRoaXMuZGVmYXVsdEFjdGl2aXR5LFxyXG4gICAgICAgIERlc3RpbmF0aW9uQWN0aXZpdGllczogbGlzdCxcclxuICAgICAgfTtcclxuICAgICAgY29uc3Qgb2JqZWN0ID0geyB2YWx1ZSwgcGFyYW1ldGVyczogbnVsbCB9O1xyXG4gICAgICB0aGlzLnN1Ym1pdE1vZGFsLmVtaXQob2JqZWN0KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGNsaWNrQ2FuY2VsKCkge1xyXG4gICAgdGhpcy5jbG9zZU1vZGFsLmVtaXQoKTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgdmFsaWRhdG9yKCk6IGJvb2xlYW4ge1xyXG4gICAgaWYgKCF0aGlzLmNhdGVnb3J5KSB7XHJcbiAgICAgIHRoaXMubWVzc2FnZS53YXJuaW5nKHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oJ2NvbXBvbmVudC5qdW1wU2NvcGUubm9TZXRUYXJnZXROb2RlJykpO1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgICAvLyBpZiAodGhpcy5jYXRlZ29yeSA9PT0gJ1NwZWNpZmllZFNldCcgJiYgT2JqZWN0LnByb3RvdHlwZS5pc1Byb3RvdHlwZU9mKHRoaXMuYWN0aXMpKSB7XHJcbiAgICAvLyAgIHRoaXMubWVzc2FnZS5pbmZvKCflsJrmnKrpgInmi6npmYTliqDoioLngrnvvIzor7fkuobop6PvvIEnKTtcclxuICAgIC8vICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgLy8gfVxyXG4gICAgaWYgKHRoaXMuZGVmYXVsdFR5cGUgPT09ICdTcGVjaWZ5Tm9kZScgJiYgdGhpcy5kZWZhdWx0YWN0eSA9PT0gJycpIHtcclxuICAgICAgdGhpcy5tZXNzYWdlLndhcm5pbmcodGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybSgnY29tcG9uZW50Lmp1bXBTY29wZS5ub1NldFNwZWNpZnlOb2RlJykpO1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdHJ1ZTtcclxuICB9XHJcblxyXG4gIHNlYXJjaERlZmF1bHQoYXJnOiBhbnkpIHtcclxuICAgIHRoaXMucGFnZUluZm8ucGFnZUluZGV4ID0gYXJnLnBhZ2VJbmZvLnBhZ2VJbmRleDtcclxuICAgIHRoaXMucGFnZUluZm8ucGFnZVNpemUgPSBhcmcucGFnZUluZm8ucGFnZVNpemU7XHJcbiAgICBjb25zdCBzZWFyY2ggPSBhcmcuc2VhcmNoO1xyXG5cclxuICAgIHRoaXMubG9hZERlZmF1bHQoc2VhcmNoKTtcclxuICB9XHJcblxyXG4gIGxvYWREZWZhdWx0KHNlYXJjaD86IHsgZmllbGQ6IHN0cmluZywgdmFsdWU6IHN0cmluZ30pIHtcclxuICAgIGNvbnN0IHN0YXJ0ID0gKHRoaXMucGFnZUluZm8ucGFnZUluZGV4IC0gMSkgKiB0aGlzLnBhZ2VJbmZvLnBhZ2VTaXplO1xyXG4gICAgY29uc3QgZW5kID0gc3RhcnQgKyB0aGlzLnBhZ2VJbmZvLnBhZ2VTaXplO1xyXG4gICAgbGV0IGl0ZW1zID0gW107XHJcbiAgICBpZiAoc2VhcmNoICYmIHNlYXJjaC52YWx1ZSkge1xyXG4gICAgICBpZiAoc2VhcmNoLmZpZWxkID09PSAnKicpIHtcclxuICAgICAgICBpdGVtcyA9IHRoaXMudWlzdGF0ZS5hbGxBY3RMaXN0LmZpbHRlcihpID0+IGkuTmFtZS5pbmRleE9mKHNlYXJjaC52YWx1ZSkgPiAtMSB8fCBpLklkLmluZGV4T2Yoc2VhcmNoLnZhbHVlKSA+IC0xKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBpdGVtcyA9IHRoaXMudWlzdGF0ZS5hbGxBY3RMaXN0LmZpbHRlcihmID0+IGZbc2VhcmNoLmZpZWxkXS5pbmRleE9mKHNlYXJjaC52YWx1ZSkgPiAtMSk7XHJcbiAgICAgIH1cclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGl0ZW1zID0gdGhpcy51aXN0YXRlLmFsbEFjdExpc3Q7XHJcbiAgICB9XHJcbiAgICB0aGlzLnRvdGFsID0gaXRlbXMubGVuZ3RoO1xyXG4gICAgLy8gdGhpcy5pdGVtcyA9IGl0ZW1zO1xyXG4gICAgaWYoaXRlbXMpe1xyXG4gICAgICB0aGlzLmFsbEFjdGlzVGFibGUuY29tcG9uZW50UmVmLmluc3RhbmNlLmxvYWREYXRhKHtcclxuICAgICAgICBkYXRhOiBpdGVtc1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHNlYXJjaFNlbGVjdChhcmc6IGFueSkge1xyXG4gICAgdGhpcy5wYWdlSW5mby5wYWdlSW5kZXggPSBhcmcucGFnZUluZm8ucGFnZUluZGV4O1xyXG4gICAgdGhpcy5wYWdlSW5mby5wYWdlU2l6ZSA9IGFyZy5wYWdlSW5mby5wYWdlU2l6ZTtcclxuICAgIGNvbnN0IHNlYXJjaCA9IGFyZy5zZWFyY2g7XHJcblxyXG4gICAgdGhpcy5sb2FkU2VsZWN0KHNlYXJjaCk7XHJcbiAgfVxyXG5cclxuICBsb2FkU2VsZWN0KHNlYXJjaD86IHsgZmllbGQ6IHN0cmluZywgdmFsdWU6IHN0cmluZ30pIHtcclxuICAgIGNvbnN0IHN0YXJ0ID0gKHRoaXMucGFnZUluZm8ucGFnZUluZGV4IC0gMSkgKiB0aGlzLnBhZ2VJbmZvLnBhZ2VTaXplO1xyXG4gICAgY29uc3QgZW5kID0gc3RhcnQgKyB0aGlzLnBhZ2VJbmZvLnBhZ2VTaXplO1xyXG4gICAgbGV0IGl0ZW1zID0gW107XHJcbiAgICBpZiAoc2VhcmNoICYmIHNlYXJjaC52YWx1ZSkge1xyXG4gICAgICBpZiAoc2VhcmNoLmZpZWxkID09PSAnKicpIHtcclxuICAgICAgICBpdGVtcyA9IHRoaXMudWlzdGF0ZS5hbGxBY3RMaXN0LmZpbHRlcihpID0+IGkuTmFtZS5pbmRleE9mKHNlYXJjaC52YWx1ZSkgPiAtMSB8fCBpLklkLmluZGV4T2Yoc2VhcmNoLnZhbHVlKSA+IC0xKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBpdGVtcyA9IHRoaXMudWlzdGF0ZS5hbGxBY3RMaXN0LmZpbHRlcihmID0+IGZbc2VhcmNoLmZpZWxkXS5pbmRleE9mKHNlYXJjaC52YWx1ZSkgPiAtMSk7XHJcbiAgICAgIH1cclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGl0ZW1zID0gdGhpcy51aXN0YXRlLmFsbEFjdExpc3Q7XHJcbiAgICB9XHJcbiAgICB0aGlzLnRvdGFsID0gaXRlbXMubGVuZ3RoO1xyXG4gICAgLy8gdGhpcy5pdGVtcyA9IGl0ZW1zO1xyXG4gICAgaWYoaXRlbXMpe1xyXG4gICAgICB0aGlzLnVzZXJBY3Rpcy5jb21wb25lbnRSZWYuaW5zdGFuY2UubG9hZERhdGEoe1xyXG4gICAgICAgIGRhdGE6IGl0ZW1zXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgYWN0aXNTZWxlY3QgPSAocm93RGF0YSk6IE9ic2VydmFibGU8UGlja2VkUmVzdWx0PiA9PiB7XHJcbiAgICAvLyDpmYTliqDoioLngrnnmoTluK7liqnlkI7kuovku7bvvIzmiorpgInkuK3nmoTmlbDmja7otYvnu5lmdWxsQWN0aXPvvIjmraTlpITlpITnkIbnmoTnm67nmoTmmK/kuLrkuobmmL7npLpOYW1l5ZCM5pe25Y+WSWTlgLzvvIlcclxuICAgIC8vIGNvbnNvbGUubG9nKHJvd0RhdGEpO1xyXG4gICAgdGhpcy5mdWxsQWN0aXMgPSByb3dEYXRhO1xyXG4gICAgcmV0dXJuIG9mKHtcclxuICAgICAgY2xvc2VEaWFsb2c6IHRydWVcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZGVmYXVsdEFjdGl2aXR5U2VsZWN0ID0gKHJvd0RhdGEpOiBPYnNlcnZhYmxlPFBpY2tlZFJlc3VsdD4gPT4ge1xyXG4gICAgLy8g6buY6K6k6IqC54K555qE5biu5Yqp5ZCO5LqL5Lu277yM5oqK6YCJ5Lit55qEaWTotYvnu5lkZWZhdWx0QWN0aXZpdHnvvIjmraTlpITlpITnkIbnmoTnm67nmoTmmK/kuLrkuobmmL7npLpOYW1l5ZCM5pe25Y+WSWTlgLzvvIlcclxuICAgIHRoaXMuZGVmYXVsdEFjdGl2aXR5ID0gcm93RGF0YS5JZDtcclxuICAgIHJldHVybiBvZih7XHJcbiAgICAgIGNsb3NlRGlhbG9nOiB0cnVlXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGRlbGV0ZVJvdygpIHtcclxuICAgIGlmICh0aGlzLmFjdFRhYmxlLnNlbGVjdGVkUm93ICYmIHRoaXMuYWN0VGFibGUuc2VsZWN0ZWRSb3cuZGF0YSkge1xyXG4gICAgICBjb25zdCBpID0gdGhpcy5hY3Rpcy5maW5kSW5kZXgoZCA9PiBkLmlkID09PSB0aGlzLmFjdFRhYmxlLnNlbGVjdGVkUm93LmRhdGEuaWQpO1xyXG4gICAgICB0aGlzLmFjdGlzLnNwbGljZShpLCAxKTtcclxuICAgICAgdGhpcy5hY3RUYWJsZS5sb2FkRGF0YSh0aGlzLmFjdGlzKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMubWVzc2FnZS5pbmZvKHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oJ2NvbXBvbmVudC5qdW1wU2NvcGUuc2VsZWN0ZWRSb3cnKSk7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcbmV4cG9ydCBjbGFzcyBKdW1wU2NvcGVDb252ZXJ0ZXIgaW1wbGVtZW50cyBUeXBlQ29udmVydGVyIHtcclxuICBjb25zdHJ1Y3RvcihcclxuICAgIHByaXZhdGUgbG9jYWxlUGlwZTogV2ZMb2NhbGVQaXBlXHJcbiAgKSB7IH1cclxuXHJcbiAgY29udmVydFRvKCk6IHN0cmluZyB7XHJcbiAgICByZXR1cm4gdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybSgnY29tcG9uZW50Lmp1bXBTY29wZS5zZXQnKTtcclxuICB9XHJcbn1cclxuXHJcbiJdfQ==