/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, ViewChild, TemplateRef, EventEmitter, Output, ChangeDetectorRef, Optional, Inject, LOCALE_ID } from '@angular/core';
import { DatagridComponent } from '@farris/ui-datagrid';
import { DialogComponent } from '@farris/ui-dialog';
import { LookupGridComponent } from '@farris/ui-lookup';
import { MessagerService } from '@farris/ui-messager';
import { of } from 'rxjs';
import { ProcessDesignerUIState } from '../../../app/process-designer.uistate';
import { MessageNoticeBatchSet } from '../message-notice-batchSet';
import { WF_LANG_RESOURCES, WfLocalePipe } from '../../../i18n/pipe/wf-process-editor-locale.pipe';
export class MessageNoticeCopyComponent {
    /**
     * @param {?} uistate
     * @param {?} message
     * @param {?} cdr
     * @param {?} localeId
     * @param {?} resources
     * @param {?} localePipe
     */
    constructor(uistate, message, cdr, localeId, resources, localePipe) {
        this.uistate = uistate;
        this.message = message;
        this.cdr = cdr;
        this.localeId = localeId;
        this.resources = resources;
        this.localePipe = localePipe;
        this.closeEmitter = new EventEmitter();
        this.submitEmitter = new EventEmitter();
        this.cols = [
            { title: this.localePipe.transform('component.MessageNotice.name'), field: 'Name', width: 60, searchField: 'Name' },
            { title: 'ID', field: 'Id', width: 90, searchField: 'Id' }
        ];
        // ==========================================================
        this.actis = [];
        this.fullActis = [];
        this.pageInfo = {
            pageIndex: 1,
            pageList: [10, 20, 30, 50],
            pageSize: 20
        };
        this.messageNotice = [];
        this.messageNoticeValue = [];
        this.targetNodeID = [];
        this.activitySendTime = [
            { value: 'WORKITEM_CREATED', text: this.localePipe.transform('component.MessageNotice.workCreated') },
            { value: 'ACTIVITY_COMPLETED', text: this.localePipe.transform('component.MessageNotice.actComplete') },
            { value: 'ACTIVITY_ABORTED', text: this.localePipe.transform('component.MessageNotice.actAborted') },
        ];
        this.columns = [
            {
                field: 'subject', width: 100, title: this.localePipe.transform('component.MessageNotice.subject'),
            }, {
                field: 'content', width: 150, title: this.localePipe.transform('component.MessageNotice.content'), showTips: true,
            }, {
                field: 'sendTime', width: 100, title: this.localePipe.transform('component.MessageNotice.sendTime'),
                formatter: {
                    type: 'enum',
                    options: { valueField: 'value', textField: 'text', data: this.activitySendTime }
                },
            }, {
                field: 'sendType', width: 100, title: this.localePipe.transform('component.MessageNotice.sendType'),
                formatter: {
                    type: 'enum',
                    options: { valueField: 'value', textField: 'name', data: this.uistate.messageChannels.map((/**
                         * @param {?} m
                         * @return {?}
                         */
                        m => ({ value: m.code, name: m.name }))) }
                },
            }, {
                field: 'receiverText', width: 120, title: this.localePipe.transform('component.MessageNotice.receiverText'), showTips: true
            }
        ];
        this.actisSelect = (/**
         * @param {?} rowData
         * @return {?}
         */
        (rowData) => {
            for (const r of rowData) {
                this.targetNodeID.push(r.Id);
            }
            return of({
                closeDialog: true
            });
        });
        this.paramAfterEdit = (/**
         * @param {?} rowIndex
         * @param {?} rowData
         * @param {?=} column
         * @return {?}
         */
        (rowIndex, rowData, column) => {
            console.log(rowData);
            console.log(rowIndex);
            return of(true);
        });
        this.localePipe = this.localePipe || new WfLocalePipe(localeId, resources);
    }
    /**
     * @return {?}
     */
    ngOnInit() { }
    /**
     * @param {?} e
     * @return {?}
     */
    endEdit(e) {
        console.log(e);
    }
    /**
     * @return {?}
     */
    get messageNotices() {
        return this.messageNotice;
    }
    /**
     * @param {?} m
     * @return {?}
     */
    set messageNotices(m) {
        this.messageNotice = m;
    }
    /**
     * @return {?}
     */
    clickOK() {
        if (!this.targetNodeID && this.targetNodeID.length === 0) {
            this.message.info(this.localePipe.transform('component.MessageNotice.noTargetNode'));
            return;
        }
        if (!this.messageNotice && this.messageNotice.length === 0) {
            this.message.info(this.localePipe.transform('component.MessageNotice.noMessageNotifyAttribute'));
            return;
        }
        /** @type {?} */
        const batchSetValue = new MessageNoticeBatchSet();
        batchSetValue.messageNotice = this.messageNotice;
        batchSetValue.targetNodeID = this.targetNodeID;
        batchSetValue.isBatchCopy = true;
        /** @type {?} */
        const object = { value: batchSetValue, parameters: null };
        this.submitEmitter.emit(object);
    }
    /**
     * @return {?}
     */
    clickCancel() {
        this.closeEmitter.emit();
    }
}
MessageNoticeCopyComponent.decorators = [
    { type: Component, args: [{
                selector: 'lib-message-notice-copy',
                template: "<div class=\"f-page\">\r\n  <div class=\"f-utils-fill-flex-column farris-split-section m-2 h-100\">\r\n    <section class=\"f-utils-fill-flex-column h-100\">\r\n      <div class=\"f-utils-fill-flex-column h-100\">\r\n        <form class=\"h-100\">\r\n          <div class=\"f-utils-fill-flex-column h-100\">\r\n            <!-- \u53EF\u9009\u8282\u70B9\u76EE\u6807\u5C0F\u6807\u9898 -->\r\n            <div class=\"mx-2 mt-1\">\r\n              <div class=\"title-content\">\r\n                <h4 class=\"title-text\">{{'component.messageNoticeEdit.optionalNodes'|wfLocale}}</h4><span class=\"title-line\"></span>\r\n              </div>\r\n            </div>\r\n            <div class=\"mt-2 mx-4 farris-form-controls-inline\">\r\n              <div class=\"farris-group-wrap\">\r\n                <!-- \u9644\u52A0\u8282\u70B9\u5E2E\u52A9 -->\r\n                <farris-lookup-grid #userActisDialog [items]=\"uistate.userActList\" [columns]=\"cols\" [resizable]=\"true\"\r\n                  [singleSelect]=\"false\" [idField]=\"'Id'\" [textField]=\"'Name'\" [(ngModel)]=\"actis\" [valueField]=\"'Id'\"\r\n                  [pagination]=\"false\" [pageIndex]=\"pageInfo.pageIndex\" name=\"defaultActivities\"\r\n                  [pageSize]=\"pageInfo.pageSize\" [pageList]=\"pageInfo.pageList\" [total]=\"total\" [enableClear]=\"false\"\r\n                  title=\"{{'component.messageNoticeEdit.targetNodeList'|wfLocale}}\" [displayType]=\"'List'\" [remoteSearch]='false' [enableToSelect]=\"false\"\r\n                  placeholder=\"{{'component.messageNoticeEdit.placeholder'|wfLocale}}\" [dictPicked]=\"actisSelect\" [nosearch]=\"true\" [showFilterBar]=\"false\">\r\n                </farris-lookup-grid>\r\n              </div>\r\n            </div>\r\n            <!-- \u53EF\u9009\u5C5E\u6027\u76EE\u6807\u5C0F\u6807\u9898 -->\r\n            <div class=\"mx-2 mt-1\">\r\n              <div class=\"title-content\">\r\n                <h4 class=\"title-text\">{{'component.messageNoticeEdit.optionalAttribute'|wfLocale}}</h4><span class=\"title-line\"></span>\r\n              </div>\r\n            </div>\r\n            <!-- \u6D88\u606F\u901A\u77E5\u5C5E\u6027 -->\r\n            <div class=\"f-page-main f-utils-fill-flex-column h-100\">\r\n              <div class=\"f-utils-fill-flex-column farris-overflow-y-auto h-100\">\r\n                <farris-datagrid #grid [data]=\"messageNotices\" [columns]=\"columns\" [idField]=\"'id'\" [fit]=\"true\"\r\n                  [fitColumns]=\"true\" [editable]=\"false\" [pagination]=\"false\" [showCheckbox]=\"false\"\r\n                  [multiSelect]=\"false\" [showLineNumber]=\"true\" lineNumberTitle=\"{{'component.messageNoticeEdit.lineNumber'|wfLocale}}\" [lineNumberWidth]=\"50\"\r\n                  [striped]=\"true\" [showAllCheckbox]=\"false\" [afterEdit]=\"paramAfterEdit\" (endEdit)=\"endEdit($event)\">\r\n                </farris-datagrid>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </section>\r\n  </div>\r\n</div>\r\n\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type=\"button\" class=\"btn btn-secondary btn-sm\" (click)=\"clickCancel()\">{{'component.messageNoticeEdit.clickCancel'|wfLocale}}</button>\r\n  <button type=\"button\" class=\"btn btn-primary btn-sm mx-2\" (click)=\"clickOK()\">{{'component.messageNoticeEdit.clickOK'|wfLocale}}</button>\r\n</ng-template>\r\n",
                providers: [
                    WfLocalePipe,
                ],
                styles: [".title-content{color:#000;display:inline-flex;align-items:center;line-height:1.375rem;position:relative;overflow:hidden;padding:0 0 0 1rem;min-width:760px}.title-content ::before{content:'';width:.25rem;height:1.125rem;background:#59a1ff;border-radius:1px;position:absolute;top:50%;left:0;margin-top:-.5625rem}.title-text{font-size:1rem;line-height:1.375rem;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;margin-bottom:0;margin-right:10px}.title-line{flex-grow:1;border-bottom:1px dashed rgba(0,0,0,.1)}"]
            }] }
];
/** @nocollapse */
MessageNoticeCopyComponent.ctorParameters = () => [
    { type: ProcessDesignerUIState },
    { type: MessagerService },
    { type: ChangeDetectorRef, decorators: [{ type: Optional }] },
    { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
    { type: undefined, decorators: [{ type: Inject, args: [WF_LANG_RESOURCES,] }] },
    { type: WfLocalePipe, decorators: [{ type: Optional }] }
];
MessageNoticeCopyComponent.propDecorators = {
    modalFooter: [{ type: ViewChild, args: ['iconSelectFooter',] }],
    closeEmitter: [{ type: Output }],
    submitEmitter: [{ type: Output }],
    allActisTable: [{ type: ViewChild, args: ['allActisTable',] }],
    allActisDialog: [{ type: ViewChild, args: ['allActisDialog',] }],
    actTable: [{ type: ViewChild, args: ['actTable',] }],
    lookup: [{ type: ViewChild, args: ['lookup',] }]
};
if (false) {
    /** @type {?} */
    MessageNoticeCopyComponent.prototype.modalFooter;
    /** @type {?} */
    MessageNoticeCopyComponent.prototype.closeEmitter;
    /** @type {?} */
    MessageNoticeCopyComponent.prototype.submitEmitter;
    /** @type {?} */
    MessageNoticeCopyComponent.prototype.allActisTable;
    /** @type {?} */
    MessageNoticeCopyComponent.prototype.allActisDialog;
    /** @type {?} */
    MessageNoticeCopyComponent.prototype.actTable;
    /** @type {?} */
    MessageNoticeCopyComponent.prototype.lookup;
    /** @type {?} */
    MessageNoticeCopyComponent.prototype.cols;
    /** @type {?} */
    MessageNoticeCopyComponent.prototype.actis;
    /** @type {?} */
    MessageNoticeCopyComponent.prototype.fullActis;
    /** @type {?} */
    MessageNoticeCopyComponent.prototype.pageInfo;
    /** @type {?} */
    MessageNoticeCopyComponent.prototype.total;
    /** @type {?} */
    MessageNoticeCopyComponent.prototype.messageNotice;
    /** @type {?} */
    MessageNoticeCopyComponent.prototype.messageNoticeValue;
    /** @type {?} */
    MessageNoticeCopyComponent.prototype.targetNodeID;
    /** @type {?} */
    MessageNoticeCopyComponent.prototype.activitySendTime;
    /** @type {?} */
    MessageNoticeCopyComponent.prototype.columns;
    /** @type {?} */
    MessageNoticeCopyComponent.prototype.actisSelect;
    /** @type {?} */
    MessageNoticeCopyComponent.prototype.paramAfterEdit;
    /** @type {?} */
    MessageNoticeCopyComponent.prototype.uistate;
    /**
     * @type {?}
     * @private
     */
    MessageNoticeCopyComponent.prototype.message;
    /**
     * @type {?}
     * @private
     */
    MessageNoticeCopyComponent.prototype.cdr;
    /**
     * @type {?}
     * @private
     */
    MessageNoticeCopyComponent.prototype.localeId;
    /**
     * @type {?}
     * @private
     */
    MessageNoticeCopyComponent.prototype.resources;
    /**
     * @type {?}
     * @private
     */
    MessageNoticeCopyComponent.prototype.localePipe;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWVzc2FnZS1ub3RpY2UtY29weS5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZ3NwLXdmL3dmLXByb2Nlc3MtZWRpdG9yLyIsInNvdXJjZXMiOlsibGliL3ZpZXdzL21lc3NhZ2Utbm90aWNlL21lc3NhZ2Utbm90aWNlLWNvcHkvbWVzc2FnZS1ub3RpY2UtY29weS5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQVUsU0FBUyxFQUFFLFdBQVcsRUFBRSxZQUFZLEVBQUUsTUFBTSxFQUFFLGlCQUFpQixFQUFFLFFBQVEsRUFBRSxNQUFNLEVBQUUsU0FBUyxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQ2hKLE9BQU8sRUFBYyxpQkFBaUIsRUFBRSxNQUFNLHFCQUFxQixDQUFDO0FBQ3BFLE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQztBQUNwRCxPQUFPLEVBQUUsbUJBQW1CLEVBQWdCLE1BQU0sbUJBQW1CLENBQUM7QUFDdEUsT0FBTyxFQUFFLGVBQWUsRUFBRSxNQUFNLHFCQUFxQixDQUFDO0FBQ3RELE9BQU8sRUFBYyxFQUFFLEVBQUUsTUFBTSxNQUFNLENBQUM7QUFDdEMsT0FBTyxFQUFFLHNCQUFzQixFQUFFLE1BQU0sdUNBQXVDLENBQUM7QUFDL0UsT0FBTyxFQUFFLHFCQUFxQixFQUFFLE1BQU0sNEJBQTRCLENBQUM7QUFFbkUsT0FBTyxFQUFFLGlCQUFpQixFQUFFLFlBQVksRUFBRSxNQUFNLGtEQUFrRCxDQUFDO0FBVW5HLE1BQU0sT0FBTywwQkFBMEI7Ozs7Ozs7OztJQWtEckMsWUFDUyxPQUErQixFQUM5QixPQUF3QixFQUNaLEdBQXNCLEVBQ2YsUUFBZ0IsRUFDUixTQUFjLEVBQzdCLFVBQXdCO1FBTHJDLFlBQU8sR0FBUCxPQUFPLENBQXdCO1FBQzlCLFlBQU8sR0FBUCxPQUFPLENBQWlCO1FBQ1osUUFBRyxHQUFILEdBQUcsQ0FBbUI7UUFDZixhQUFR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TSxTQUFDLGlCQUFpQjtZQWpFRCxZQUFZLHVCQWtFbkMsUUFBUTs7OzBCQXZEVixTQUFTLFNBQUMsa0JBQWtCOzJCQUM1QixNQUFNOzRCQUNOLE1BQU07NEJBRU4sU0FBUyxTQUFDLGVBQWU7NkJBQ3pCLFNBQVMsU0FBQyxnQkFBZ0I7dUJBQzFCLFNBQVMsU0FBQyxVQUFVO3FCQUNwQixTQUFTLFNBQUMsUUFBUTs7OztJQVBuQixpREFBNkQ7O0lBQzdELGtEQUFpRDs7SUFDakQsbURBQWtEOztJQUVsRCxtREFBNkQ7O0lBQzdELG9EQUE2RDs7SUFDN0QsOENBQW1EOztJQUNuRCw0Q0FBaUQ7O0lBQ2pELDBDQUU4RDs7SUFFOUQsMkNBQVc7O0lBQ1gsK0NBQWU7O0lBQ2YsOENBSUU7O0lBQ0YsMkNBQWM7O0lBQ2QsbURBQW1COztJQUNuQix3REFBd0I7O0lBQ3hCLGtEQUFrQjs7SUFDbEIsc0RBSUE7O0lBQ0EsNkNBbUJLOztJQW1CTCxpREFPQzs7SUFFRCxvREFJQzs7SUE3QkMsNkNBQXNDOzs7OztJQUN0Qyw2Q0FBZ0M7Ozs7O0lBQ2hDLHlDQUEwQzs7Ozs7SUFDMUMsOENBQTJDOzs7OztJQUMzQywrQ0FBaUQ7Ozs7O0lBQ2pELGdEQUE0QyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCwgT25Jbml0LCBWaWV3Q2hpbGQsIFRlbXBsYXRlUmVmLCBFdmVudEVtaXR0ZXIsIE91dHB1dCwgQ2hhbmdlRGV0ZWN0b3JSZWYsIE9wdGlvbmFsLCBJbmplY3QsIExPQ0FMRV9JRCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBEYXRhQ29sdW1uLCBEYXRhZ3JpZENvbXBvbmVudCB9IGZyb20gJ0BmYXJyaXMvdWktZGF0YWdyaWQnO1xyXG5pbXBvcnQgeyBEaWFsb2dDb21wb25lbnQgfSBmcm9tICdAZmFycmlzL3VpLWRpYWxvZyc7XHJcbmltcG9ydCB7IExvb2t1cEdyaWRDb21wb25lbnQsIFBpY2tlZFJlc3VsdCB9IGZyb20gJ0BmYXJyaXMvdWktbG9va3VwJztcclxuaW1wb3J0IHsgTWVzc2FnZXJTZXJ2aWNlIH0gZnJvbSAnQGZhcnJpcy91aS1tZXNzYWdlcic7XHJcbmltcG9ydCB7IE9ic2VydmFibGUsIG9mIH0gZnJvbSAncnhqcyc7XHJcbmltcG9ydCB7IFByb2Nlc3NEZXNpZ25lclVJU3RhdGUgfSBmcm9tICcuLi8uLi8uLi9hcHAvcHJvY2Vzcy1kZXNpZ25lci51aXN0YXRlJztcclxuaW1wb3J0IHsgTWVzc2FnZU5vdGljZUJhdGNoU2V0IH0gZnJvbSAnLi4vbWVzc2FnZS1ub3RpY2UtYmF0Y2hTZXQnO1xyXG5pbXBvcnQgeyBXRl9QUk9DRVNTX0VESVRPUl9MQU5HX1JFU09VUkNFUyB9IGZyb20gJy4uLy4uLy4uL2kxOG4vYXNzZXRzL2xhbmcucmVzb3VyY2UnO1xyXG5pbXBvcnQgeyBXRl9MQU5HX1JFU09VUkNFUywgV2ZMb2NhbGVQaXBlIH0gZnJvbSAnLi4vLi4vLi4vaTE4bi9waXBlL3dmLXByb2Nlc3MtZWRpdG9yLWxvY2FsZS5waXBlJztcclxuXHJcbkBDb21wb25lbnQoe1xyXG4gIHNlbGVjdG9yOiAnbGliLW1lc3NhZ2Utbm90aWNlLWNvcHknLFxyXG4gIHRlbXBsYXRlVXJsOiAnLi9tZXNzYWdlLW5vdGljZS1jb3B5LmNvbXBvbmVudC5odG1sJyxcclxuICBzdHlsZVVybHM6IFsnLi9tZXNzYWdlLW5vdGljZS1jb3B5LmNvbXBvbmVudC5jc3MnXSxcclxuICBwcm92aWRlcnM6IFtcclxuICAgICBXZkxvY2FsZVBpcGUsXHJcbiAgXVxyXG59KVxyXG5leHBvcnQgY2xhc3MgTWVzc2FnZU5vdGljZUNvcHlDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQge1xyXG4gIEBWaWV3Q2hpbGQoJ2ljb25TZWxlY3RGb290ZXInKSBtb2RhbEZvb3RlcjogVGVtcGxhdGVSZWY8YW55PjtcclxuICBAT3V0cHV0KCkgY2xvc2VFbWl0dGVyID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XHJcbiAgQE91dHB1dCgpIHN1Ym1pdEVtaXR0ZXIgPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcclxuICAvLyDmtLvliqjoioLngrnooajkv6Hmga89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4gIEBWaWV3Q2hpbGQoJ2FsbEFjdGlzVGFibGUnKSBhbGxBY3Rpc1RhYmxlOiBEYXRhZ3JpZENvbXBvbmVudDtcclxuICBAVmlld0NoaWxkKCdhbGxBY3Rpc0RpYWxvZycpIGFsbEFjdGlzRGlhbG9nOiBEaWFsb2dDb21wb25lbnQ7XHJcbiAgQFZpZXdDaGlsZCgnYWN0VGFibGUnKSBhY3RUYWJsZTogRGF0YWdyaWRDb21wb25lbnQ7XHJcbiAgQFZpZXdDaGlsZCgnbG9va3VwJykgbG9va3VwOiBMb29rdXBHcmlkQ29tcG9uZW50O1xyXG4gIGNvbHMgPSBbXHJcbiAgICB7IHRpdGxlOiB0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKCdjb21wb25lbnQuTWVzc2FnZU5vdGljZS5uYW1lJyksIGZpZWxkOiAnTmFtZScsIHdpZHRoOiA2MCwgc2VhcmNoRmllbGQ6ICdOYW1lJyB9LFxyXG4gICAgeyB0aXRsZTogJ0lEJywgZmllbGQ6ICdJZCcsIHdpZHRoOiA5MCwgc2VhcmNoRmllbGQ6ICdJZCcgfV07XHJcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4gIGFjdGlzID0gW107XHJcbiAgZnVsbEFjdGlzID0gW107XHJcbiAgcGFnZUluZm8gPSB7XHJcbiAgICBwYWdlSW5kZXg6IDEsXHJcbiAgICBwYWdlTGlzdDogWzEwLCAyMCwgMzAsIDUwXSxcclxuICAgIHBhZ2VTaXplOiAyMFxyXG4gIH07XHJcbiAgdG90YWw6IG51bWJlcjtcclxuICBtZXNzYWdlTm90aWNlID0gW107XHJcbiAgbWVzc2FnZU5vdGljZVZhbHVlID0gW107XHJcbiAgdGFyZ2V0Tm9kZUlEID0gW107XHJcbiAgYWN0aXZpdHlTZW5kVGltZSA9IFtcclxuICAgIHsgdmFsdWU6ICdXT1JLSVRFTV9DUkVBVEVEJywgdGV4dDogdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybSgnY29tcG9uZW50Lk1lc3NhZ2VOb3RpY2Uud29ya0NyZWF0ZWQnKSB9LFxyXG4gICAgeyB2YWx1ZTogJ0FDVElWSVRZX0NPTVBMRVRFRCcsIHRleHQ6IHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oJ2NvbXBvbmVudC5NZXNzYWdlTm90aWNlLmFjdENvbXBsZXRlJykgfSxcclxuICAgIHsgdmFsdWU6ICdBQ1RJVklUWV9BQk9SVEVEJywgdGV4dDogdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybSgnY29tcG9uZW50Lk1lc3NhZ2VOb3RpY2UuYWN0QWJvcnRlZCcpIH0sXHJcbl07XHJcbiAgY29sdW1ucyA9IFtcclxuICAgIHtcclxuICAgICAgZmllbGQ6ICdzdWJqZWN0Jywgd2lkdGg6IDEwMCwgdGl0bGU6IHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oJ2NvbXBvbmVudC5NZXNzYWdlTm90aWNlLnN1YmplY3QnKSxcclxuICAgIH0sIHtcclxuICAgICAgZmllbGQ6ICdjb250ZW50Jywgd2lkdGg6IDE1MCwgdGl0bGU6IHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oJ2NvbXBvbmVudC5NZXNzYWdlTm90aWNlLmNvbnRlbnQnKSwgc2hvd1RpcHM6IHRydWUsXHJcbiAgICB9LCB7XHJcbiAgICAgIGZpZWxkOiAnc2VuZFRpbWUnLCB3aWR0aDogMTAwLCB0aXRsZTogdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybSgnY29tcG9uZW50Lk1lc3NhZ2VOb3RpY2Uuc2VuZFRpbWUnKSxcclxuICAgICAgZm9ybWF0dGVyOiB7XHJcbiAgICAgICAgdHlwZTogJ2VudW0nLFxyXG4gICAgICAgIG9wdGlvbnM6IHsgdmFsdWVGaWVsZDogJ3ZhbHVlJywgdGV4dEZpZWxkOiAndGV4dCcsIGRhdGE6IHRoaXMuYWN0aXZpdHlTZW5kVGltZSB9XHJcbiAgICAgIH0sXHJcbiAgICB9LCB7XHJcbiAgICAgIGZpZWxkOiAnc2VuZFR5cGUnLCB3aWR0aDogMTAwLCB0aXRsZTogdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybSgnY29tcG9uZW50Lk1lc3NhZ2VOb3RpY2Uuc2VuZFR5cGUnKSxcclxuICAgICAgZm9ybWF0dGVyOiB7XHJcbiAgICAgICAgdHlwZTogJ2VudW0nLFxyXG4gICAgICAgIG9wdGlvbnM6IHsgdmFsdWVGaWVsZDogJ3ZhbHVlJywgdGV4dEZpZWxkOiAnbmFtZScsIGRhdGE6IHRoaXMudWlzdGF0ZS5tZXNzYWdlQ2hhbm5lbHMubWFwKG0gPT4gKHsgdmFsdWU6IG0uY29kZSwgbmFtZTogbS5uYW1lIH0pKSB9XHJcbiAgICAgIH0sXHJcbiAgICB9LCB7XHJcbiAgICAgIGZpZWxkOiAncmVjZWl2ZXJUZXh0Jywgd2lkdGg6IDEyMCwgdGl0bGU6IHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oJ2NvbXBvbmVudC5NZXNzYWdlTm90aWNlLnJlY2VpdmVyVGV4dCcpLCBzaG93VGlwczogdHJ1ZVxyXG4gICAgfV07XHJcblxyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgcHVibGljIHVpc3RhdGU6IFByb2Nlc3NEZXNpZ25lclVJU3RhdGUsXHJcbiAgICBwcml2YXRlIG1lc3NhZ2U6IE1lc3NhZ2VyU2VydmljZSxcclxuICAgIEBPcHRpb25hbCgpIHByaXZhdGUgY2RyOiBDaGFuZ2VEZXRlY3RvclJlZixcclxuICAgIEBJbmplY3QoTE9DQUxFX0lEKSBwcml2YXRlIGxvY2FsZUlkOiBzdHJpbmcsXHJcbiAgICBASW5qZWN0KFdGX0xBTkdfUkVTT1VSQ0VTKSBwcml2YXRlIHJlc291cmNlczogYW55LFxyXG4gICAgQE9wdGlvbmFsKCkgcHJpdmF0ZSBsb2NhbGVQaXBlOiBXZkxvY2FsZVBpcGUsXHJcbiAgKSB7XHJcbiAgICB0aGlzLmxvY2FsZVBpcGUgPSB0aGlzLmxvY2FsZVBpcGUgfHwgbmV3IFdmTG9jYWxlUGlwZShsb2NhbGVJZCwgcmVzb3VyY2VzKTtcclxuICB9XHJcblxyXG4gIG5nT25Jbml0KCkge31cclxuXHJcbiAgZW5kRWRpdChlOiBhbnkpIHtcclxuICAgIGNvbnNvbGUubG9nKGUpO1xyXG4gIH1cclxuXHJcbiAgYWN0aXNTZWxlY3QgPSAocm93RGF0YSk6IE9ic2VydmFibGU8UGlja2VkUmVzdWx0PiA9PiB7XHJcbiAgICBmb3IgKGNvbnN0IHIgb2Ygcm93RGF0YSkge1xyXG4gICAgICB0aGlzLnRhcmdldE5vZGVJRC5wdXNoKHIuSWQpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIG9mKHtcclxuICAgICAgY2xvc2VEaWFsb2c6IHRydWVcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgcGFyYW1BZnRlckVkaXQgPSAocm93SW5kZXg6IG51bWJlciwgcm93RGF0YTogYW55LCBjb2x1bW4/OiBEYXRhQ29sdW1uKSA9PiB7XHJcbiAgICBjb25zb2xlLmxvZyhyb3dEYXRhKTtcclxuICAgIGNvbnNvbGUubG9nKHJvd0luZGV4KTtcclxuICAgIHJldHVybiBvZih0cnVlKTtcclxuICB9XHJcblxyXG4gIGdldCBtZXNzYWdlTm90aWNlcygpIHtcclxuICAgIHJldHVybiB0aGlzLm1lc3NhZ2VOb3RpY2U7XHJcbiAgfVxyXG5cclxuICBzZXQgbWVzc2FnZU5vdGljZXMobSkge1xyXG4gICAgdGhpcy5tZXNzYWdlTm90aWNlID0gbTtcclxuICB9XHJcblxyXG4gIGNsaWNrT0soKSB7XHJcbiAgICBpZiAoIXRoaXMudGFyZ2V0Tm9kZUlEICYmIHRoaXMudGFyZ2V0Tm9kZUlELmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICB0aGlzLm1lc3NhZ2UuaW5mbyh0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKCdjb21wb25lbnQuTWVzc2FnZU5vdGljZS5ub1RhcmdldE5vZGUnKSk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGlmICghdGhpcy5tZXNzYWdlTm90aWNlICYmIHRoaXMubWVzc2FnZU5vdGljZS5sZW5ndGggPT09IDApIHtcclxuICAgICAgdGhpcy5tZXNzYWdlLmluZm8odGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybSgnY29tcG9uZW50Lk1lc3NhZ2VOb3RpY2Uubm9NZXNzYWdlTm90aWZ5QXR0cmlidXRlJykpO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBjb25zdCBiYXRjaFNldFZhbHVlID0gbmV3IE1lc3NhZ2VOb3RpY2VCYXRjaFNldCgpO1xyXG4gICAgYmF0Y2hTZXRWYWx1ZS5tZXNzYWdlTm90aWNlID0gdGhpcy5tZXNzYWdlTm90aWNlO1xyXG4gICAgYmF0Y2hTZXRWYWx1ZS50YXJnZXROb2RlSUQgPSB0aGlzLnRhcmdldE5vZGVJRDtcclxuICAgIGJhdGNoU2V0VmFsdWUuaXNCYXRjaENvcHkgPSB0cnVlO1xyXG4gICAgY29uc3Qgb2JqZWN0ID0geyB2YWx1ZTogYmF0Y2hTZXRWYWx1ZSwgcGFyYW1ldGVyczogbnVsbCB9O1xyXG4gICAgdGhpcy5zdWJtaXRFbWl0dGVyLmVtaXQob2JqZWN0KTtcclxuICB9XHJcblxyXG4gIGNsaWNrQ2FuY2VsKCkge1xyXG4gICAgdGhpcy5jbG9zZUVtaXR0ZXIuZW1pdCgpO1xyXG4gIH1cclxufVxyXG4iXX0=