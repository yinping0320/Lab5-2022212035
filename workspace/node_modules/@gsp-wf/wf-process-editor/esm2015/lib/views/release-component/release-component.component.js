/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input, Output, EventEmitter, ViewChild, TemplateRef, ChangeDetectorRef, Optional, Inject, LOCALE_ID } from '@angular/core';
import { LookupGridComponent } from '@farris/ui-lookup';
import { WfTaskHandlerService } from '@gsp-wf/wf-task-handler';
import { ProcessDesignerUIState } from '../../app/process-designer.uistate';
import { WF_LANG_RESOURCES, WfLocalePipe } from '../../i18n/pipe/wf-process-editor-locale.pipe';
export class ReleaseComponent {
    /**
     * @param {?} uiState
     * @param {?} submitService
     * @param {?} cdr
     * @param {?} localeId
     * @param {?} resources
     * @param {?} localePipe
     */
    constructor(uiState, submitService, cdr, localeId, resources, localePipe) {
        this.uiState = uiState;
        this.submitService = submitService;
        this.cdr = cdr;
        this.localeId = localeId;
        this.resources = resources;
        this.localePipe = localePipe;
        this.submit = new EventEmitter();
        this.cancel = new EventEmitter();
        this.accessLevel = 'public';
        this.isAdministratorConfig = false;
        this.dataUri = '/api/runtime/sys/v1.0/sysOrgs';
        this.loadType = 'layerload';
        this.releaseType = 'release';
        this.items = new Array();
        this.releaseTypeList = [
            { value: 'release', name: this.localePipe.transform('component.release.release') },
            { value: 'update', name: this.localePipe.transform('component.release.update') },
        ];
        this.localePipe = this.localePipe || new WfLocalePipe(localeId, resources);
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        this.releaseType = this.procVersion === 1 ? 'release' : 'update';
        this.uiState.getUserInfo().subscribe((/**
         * @param {?} re
         * @return {?}
         */
        re => {
            this.applicantName = re.name;
            this.applicantDepartment = re.orgName;
            this.applicantId = re.id;
        }));
    }
    /**
     * @return {?}
     */
    saveAsOK() {
        this.uiState.createData().subscribe((/**
         * @param {?} saveData
         * @return {?}
         */
        (saveData) => {
            /** @type {?} */
            const dataId = saveData.returnValue.id;
            /** @type {?} */
            const data = {
                DataId: dataId,
                applicantName: this.applicantName,
                applicantDepartment: this.applicantDepartment,
                procName: this.procName,
                procVersion: this.procVersion,
                releaseType: this.releaseType,
                textDetail: this.textDetail,
                processDefinitionKey: this.processDefinitionKey,
                applicantId: this.applicantId
            };
            /** @type {?} */
            const Info = {
                ChangeType: 'Modify',
                ChangeInfo: data
            };
            this.uiState.releaseSave(Info).subscribe((/**
             * @param {?} re
             * @return {?}
             */
            (re) => {
                this.mySubmit(dataId, '03bdca37-8439-4924-8aef-20f3f4092b59');
                this.submit.next();
            }));
        }));
    }
    /**
     * @return {?}
     */
    saveAsCancel() {
        this.cancel.emit();
    }
    /**
     * @param {?} quill
     * @return {?}
     */
    editorCreated(quill) {
        /** @type {?} */
        const toolbar = quill.getModule('toolbar');
        this.editor = quill;
    }
    /**
     * @param {?} v
     * @return {?}
     */
    contentChanged(v) {
        console.log(v);
    }
    /**
     * @return {?}
     */
    validator() {
        return true;
    }
    /**
     * @param {?} data
     * @return {?}
     */
    changeValue(data) {
        this.releaseType = data;
    }
    /**
     * 发布前审核：提交审批
     * @private
     * @param {?} dataId
     * @param {?} bizDefKey
     * @return {?}
     */
    mySubmit(dataId, bizDefKey) {
        this.submitService.submitWithBizDefKey(dataId, bizDefKey);
    }
}
ReleaseComponent.decorators = [
    { type: Component, args: [{
                selector: 'lib-release-component',
                template: "<div class=\"f-page f-page-card f-page-is-mainsubcard\">\r\n  <section class=\"f-page-main\">\r\n    <div class=\"f-struct-wrapper\">\r\n      <!-- <farris-section class=\"f-section-form f-section-in-mainsubcard\" [enableAccordion]=\"''\"\r\n        [subTitle]=\"''\" [enableMaximize]=\"false\"> -->\r\n        <div class=\"f-form-layout farris-form farris-form-controls-inline pr-4 m-2\">\r\n          <div class=\"col-12 px-0 my-2\">\r\n            <div class=\"farris-group-wrap\">\r\n              <div class=\"form-group farris-form-group\">\r\n                <label class=\"col-form-label\">\r\n                  <span class=\"farris-label-text\">{{'component.release.applicantName' | wfLocale}}</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap\">\r\n                  <input type=\"text\" class=\"form-control\" [(ngModel)]=\"applicantName\" name=\"procName\" [readOnly]=\"true\"/>\r\n                  <div class=\"farris-feedback valid-feedback\"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"col-12 px-0 my-2\">\r\n            <div class=\"farris-group-wrap\">\r\n              <div class=\"form-group farris-form-group\">\r\n                <label class=\"col-form-label\">\r\n                  <span class=\"farris-label-text\">{{'component.release.applicantDepartment' | wfLocale}}</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap\">\r\n                  <input type=\"text\" class=\"form-control\" [(ngModel)]=\"applicantDepartment\" name=\"procKey\" [readOnly]=\"true\"/>\r\n                  <div class=\"farris-feedback valid-feedback\"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"col-12 px-0 my-2\">\r\n            <div class=\"farris-group-wrap\">\r\n              <div class=\"form-group farris-form-group\">\r\n                <label class=\"col-form-label\">\r\n                  <span class=\"farris-label-text\">{{'component.release.procName' | wfLocale}}</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap\">\r\n                  <input type=\"text\" class=\"form-control\" [(ngModel)]=\"procName\" name=\"procName\" [readOnly]=\"true\"/>\r\n                  <div class=\"farris-feedback valid-feedback\"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"col-12 px-0 my-2\">\r\n            <div class=\"farris-group-wrap\">\r\n              <div class=\"form-group farris-form-group\">\r\n                <label class=\"col-form-label\">\r\n                  <span class=\"farris-label-text\">{{'component.release.procVersion' | wfLocale}}</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap\">\r\n                  <input type=\"text\" class=\"form-control\" [(ngModel)]=\"procVersion\" name=\"procVersion\" [readOnly]=\"true\"/>\r\n                  <div class=\"farris-feedback valid-feedback\"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"col-12 px-0 my-2\">\r\n            <div class=\"farris-group-wrap\">\r\n              <div class=\"form-group farris-form-group\">\r\n                <label class=\"col-form-label\">\r\n                  <span class=\"farris-label-text\">{{'component.release.releaseType' | wfLocale}}</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap\">\r\n                  <farris-radiogroup [(ngModel)]=\"releaseType\" name=\"releaseType\" [data]=\"releaseTypeList\"\r\n                  [horizontal]=\"true\" (changeValue)=\"changeValue($event)\" [disabled]=\"true\">\r\n                  </farris-radiogroup>\r\n                  <div class=\"farris-feedback valid-feedback\"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"col-12 px-0 my-2\">\r\n            <div class=\"farris-group-wrap\">\r\n              <div class=\"form-group farris-form-group\">\r\n                <label class=\"col-form-label\">\r\n                  <span class=\"farris-label-text\">{{'component.release.textDetail' | wfLocale}}</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap\">\r\n                  <textarea [(ngModel)]=\"textDetail\" name=\"textarea\" id=\"textarea\" style=\"height: 250px; width: 100%\"\r\n                  [auto-size]=\"true\" [maxHeight]=\"500\" [textarea-zoom]=\"true\"></textarea>\r\n                  <div class=\"farris-feedback valid-feedback\"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      <!-- </farris-section> -->\r\n    </div>\r\n  </section>\r\n</div>\r\n\r\n<ng-template #buttonRef>\r\n  <button type=\"button\" class=\"btn btn-secondary btn-sm mx-2\" (click)=\"saveAsCancel()\">{{'component.release.saveAsCancel' | wfLocale}}</button>\r\n  <button type=\"button\" class=\"btn btn-sm btn-primary mx-2\" (click)=\"saveAsOK()\">{{'component.release.saveAsOK' | wfLocale}}</button>\r\n</ng-template>\r\n",
                providers: [
                    WfLocalePipe,
                ],
                styles: [""]
            }] }
];
/** @nocollapse */
ReleaseComponent.ctorParameters = () => [
    { type: ProcessDesignerUIState },
    { type: WfTaskHandlerService },
    { type: ChangeDetectorRef, decorators: [{ type: Optional }] },
    { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
    { type: undefined, decorators: [{ type: Inject, args: [WF_LANG_RESOURCES,] }] },
    { type: WfLocalePipe, decorators: [{ type: Optional }] }
];
ReleaseComponent.propDecorators = {
    btnRef: [{ type: ViewChild, args: ['buttonRef',] }],
    procName: [{ type: Input }],
    procVersion: [{ type: Input }],
    processDefinitionKey: [{ type: Input }],
    lookUp: [{ type: ViewChild, args: ['lookup',] }],
    submit: [{ type: Output }],
    cancel: [{ type: Output }]
};
if (false) {
    /** @type {?} */
    ReleaseComponent.prototype.btnRef;
    /** @type {?} */
    ReleaseComponent.prototype.applicantName;
    /** @type {?} */
    ReleaseComponent.prototype.applicantDepartment;
    /** @type {?} */
    ReleaseComponent.prototype.procName;
    /** @type {?} */
    ReleaseComponent.prototype.procVersion;
    /** @type {?} */
    ReleaseComponent.prototype.processDefinitionKey;
    /** @type {?} */
    ReleaseComponent.prototype.lookUp;
    /** @type {?} */
    ReleaseComponent.prototype.submit;
    /** @type {?} */
    ReleaseComponent.prototype.cancel;
    /** @type {?} */
    ReleaseComponent.prototype.session;
    /** @type {?} */
    ReleaseComponent.prototype.accessLevel;
    /** @type {?} */
    ReleaseComponent.prototype.organization;
    /** @type {?} */
    ReleaseComponent.prototype.organizationName;
    /** @type {?} */
    ReleaseComponent.prototype.textDetail;
    /** @type {?} */
    ReleaseComponent.prototype.isAdministratorConfig;
    /** @type {?} */
    ReleaseComponent.prototype.editor;
    /** @type {?} */
    ReleaseComponent.prototype.administrator;
    /** @type {?} */
    ReleaseComponent.prototype.dataUri;
    /** @type {?} */
    ReleaseComponent.prototype.applicantId;
    /** @type {?} */
    ReleaseComponent.prototype.loadType;
    /** @type {?} */
    ReleaseComponent.prototype.releaseType;
    /** @type {?} */
    ReleaseComponent.prototype.items;
    /** @type {?} */
    ReleaseComponent.prototype.releaseTypeList;
    /**
     * @type {?}
     * @private
     */
    ReleaseComponent.prototype.uiState;
    /**
     * @type {?}
     * @private
     */
    ReleaseComponent.prototype.submitService;
    /**
     * @type {?}
     * @private
     */
    ReleaseComponent.prototype.cdr;
    /**
     * @type {?}
     * @private
     */
    ReleaseComponent.prototype.localeId;
    /**
     * @type {?}
     * @private
     */
    ReleaseComponent.prototype.resources;
    /**
     * @type {?}
     * @private
     */
    ReleaseComponent.prototype.localePipe;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmVsZWFzZS1jb21wb25lbnQuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGdzcC13Zi93Zi1wcm9jZXNzLWVkaXRvci8iLCJzb3VyY2VzIjpbImxpYi92aWV3cy9yZWxlYXNlLWNvbXBvbmVudC9yZWxlYXNlLWNvbXBvbmVudC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQVUsS0FBSyxFQUFFLE1BQU0sRUFBRSxZQUFZLEVBQUUsU0FBUyxFQUFFLFdBQVcsRUFBRSxpQkFBaUIsRUFBRSxRQUFRLEVBQUUsTUFBTSxFQUFFLFNBQVMsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUN2SixPQUFPLEVBQUUsbUJBQW1CLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQztBQUV4RCxPQUFPLEVBQUUsb0JBQW9CLEVBQUUsTUFBTSx5QkFBeUIsQ0FBQztBQUMvRCxPQUFPLEVBQUUsc0JBQXNCLEVBQUUsTUFBTSxvQ0FBb0MsQ0FBQztBQUM1RSxPQUFPLEVBQUUsaUJBQWlCLEVBQUUsWUFBWSxFQUFFLE1BQU0sK0NBQStDLENBQUM7QUFXaEcsTUFBTSxPQUFPLGdCQUFnQjs7Ozs7Ozs7O0lBaUMzQixZQUNVLE9BQStCLEVBQy9CLGFBQW1DLEVBQ3ZCLEdBQXNCLEVBQ2YsUUFBZ0IsRUFDUixTQUFjLEVBQzdCLFVBQXdCO1FBTHBDLFlBQU8sR0FBUCxPQUFPLENBQXdCO1FBQy9CLGtCQUFhLEdBQWIsYUFBYSxDQUFzQjtRQUN2QixRQUFHLEdBQUgsR0FBRyxDQUFtQjtRQUNmLGFBQVEsR0FBUixRQUFRLENBQVE7UUFDUixjQUFTLEdBQVQsU0FBUyxDQUFLO1FBQzdCLGVBQVUsR0FBVixVQUFVLENBQWM7UUExQnBDLFdBQU0sR0FBRyxJQUFJLFlBQVksRUFBTyxDQUFDO1FBQ2pDLFdBQU0sR0FBRyxJQUFJLFlBQVksRUFBTyxDQUFDO1FBRTNDLGdCQUFXLEdBQUcsUUFBUSxDQUFDO1FBSXZCLDBCQUFxQixH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SUFDM0MscUNBQWlEOzs7OztJQUNqRCxzQ0FBNEMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIE9uSW5pdCwgSW5wdXQsIE91dHB1dCwgRXZlbnRFbWl0dGVyLCBWaWV3Q2hpbGQsIFRlbXBsYXRlUmVmLCBDaGFuZ2VEZXRlY3RvclJlZiwgT3B0aW9uYWwsIEluamVjdCwgTE9DQUxFX0lEIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IExvb2t1cEdyaWRDb21wb25lbnQgfSBmcm9tICdAZmFycmlzL3VpLWxvb2t1cCc7XHJcbmltcG9ydCB7IE1lc3NhZ2VyU2VydmljZSB9IGZyb20gJ0BmYXJyaXMvdWktbWVzc2FnZXInO1xyXG5pbXBvcnQgeyBXZlRhc2tIYW5kbGVyU2VydmljZSB9IGZyb20gJ0Bnc3Atd2Yvd2YtdGFzay1oYW5kbGVyJztcclxuaW1wb3J0IHsgUHJvY2Vzc0Rlc2lnbmVyVUlTdGF0ZSB9IGZyb20gJy4uLy4uL2FwcC9wcm9jZXNzLWRlc2lnbmVyLnVpc3RhdGUnO1xyXG5pbXBvcnQgeyBXRl9MQU5HX1JFU09VUkNFUywgV2ZMb2NhbGVQaXBlIH0gZnJvbSAnLi4vLi4vaTE4bi9waXBlL3dmLXByb2Nlc3MtZWRpdG9yLWxvY2FsZS5waXBlJztcclxuaW1wb3J0IHsgV0ZfUFJPQ0VTU19FRElUT1JfTEFOR19SRVNPVVJDRVMgfSBmcm9tICcuLi8uLi9pMThuL2Fzc2V0cy9sYW5nLnJlc291cmNlJztcclxuXHJcbkBDb21wb25lbnQoe1xyXG4gIHNlbGVjdG9yOiAnbGliLXJlbGVhc2UtY29tcG9uZW50JyxcclxuICB0ZW1wbGF0ZVVybDogJy4vcmVsZWFzZS1jb21wb25lbnQuY29tcG9uZW50Lmh0bWwnLFxyXG4gIHN0eWxlVXJsczogWycuL3JlbGVhc2UtY29tcG9uZW50LmNvbXBvbmVudC5jc3MnXSxcclxuICBwcm92aWRlcnM6IFtcclxuICAgICBXZkxvY2FsZVBpcGUsXHJcbiAgXVxyXG59KVxyXG5leHBvcnQgY2xhc3MgUmVsZWFzZUNvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCB7XHJcbiAgQFZpZXdDaGlsZCgnYnV0dG9uUmVmJykgYnRuUmVmOiBUZW1wbGF0ZVJlZjxhbnk+O1xyXG5cclxuICBhcHBsaWNhbnROYW1lOiBzdHJpbmc7XHJcbiAgYXBwbGljYW50RGVwYXJ0bWVudDogc3RyaW5nO1xyXG4gIEBJbnB1dCgpXHJcbiAgcHJvY05hbWU6IGFueTtcclxuICBASW5wdXQoKVxyXG4gIHByb2NWZXJzaW9uOiBudW1iZXI7XHJcbiAgQElucHV0KClcclxuICBwcm9jZXNzRGVmaW5pdGlvbktleTogc3RyaW5nO1xyXG4gIEBWaWV3Q2hpbGQoJ2xvb2t1cCcpIHB1YmxpYyBsb29rVXA6IExvb2t1cEdyaWRDb21wb25lbnQ7XHJcblxyXG4gIEBPdXRwdXQoKSBzdWJtaXQgPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcclxuICBAT3V0cHV0KCkgY2FuY2VsID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XHJcbiAgc2Vzc2lvbjogc3RyaW5nO1xyXG4gIGFjY2Vzc0xldmVsID0gJ3B1YmxpYyc7XHJcbiAgb3JnYW5pemF0aW9uO1xyXG4gIG9yZ2FuaXphdGlvbk5hbWU7XHJcbiAgdGV4dERldGFpbDtcclxuICBpc0FkbWluaXN0cmF0b3JDb25maWcgPSBmYWxzZTtcclxuICBlZGl0b3I6IGFueTtcclxuXHJcbiAgYWRtaW5pc3RyYXRvcjogYW55O1xyXG4gIGRhdGFVcmkgPSAnL2FwaS9ydW50aW1lL3N5cy92MS4wL3N5c09yZ3MnO1xyXG4gIGFwcGxpY2FudElkOiBzdHJpbmc7XHJcbiAgbG9hZFR5cGUgPSAnbGF5ZXJsb2FkJztcclxuICByZWxlYXNlVHlwZSA9ICdyZWxlYXNlJztcclxuICBpdGVtcyA9IG5ldyBBcnJheSgpO1xyXG4gIHJlbGVhc2VUeXBlTGlzdCA9IFtcclxuICAgIHsgdmFsdWU6ICdyZWxlYXNlJywgbmFtZTogdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybSgnY29tcG9uZW50LnJlbGVhc2UucmVsZWFzZScpIH0sXHJcbiAgICB7IHZhbHVlOiAndXBkYXRlJywgbmFtZTogdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybSgnY29tcG9uZW50LnJlbGVhc2UudXBkYXRlJykgfSxcclxuICBdO1xyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgcHJpdmF0ZSB1aVN0YXRlOiBQcm9jZXNzRGVzaWduZXJVSVN0YXRlLFxyXG4gICAgcHJpdmF0ZSBzdWJtaXRTZXJ2aWNlOiBXZlRhc2tIYW5kbGVyU2VydmljZSxcclxuICAgIEBPcHRpb25hbCgpIHByaXZhdGUgY2RyOiBDaGFuZ2VEZXRlY3RvclJlZixcclxuICAgIEBJbmplY3QoTE9DQUxFX0lEKSBwcml2YXRlIGxvY2FsZUlkOiBzdHJpbmcsXHJcbiAgICBASW5qZWN0KFdGX0xBTkdfUkVTT1VSQ0VTKSBwcml2YXRlIHJlc291cmNlczogYW55LFxyXG4gICAgQE9wdGlvbmFsKCkgcHJpdmF0ZSBsb2NhbGVQaXBlOiBXZkxvY2FsZVBpcGUsXHJcbiAgKSB7XHJcbiAgICB0aGlzLmxvY2FsZVBpcGUgPSB0aGlzLmxvY2FsZVBpcGUgfHwgbmV3IFdmTG9jYWxlUGlwZShsb2NhbGVJZCwgcmVzb3VyY2VzKTtcclxuICB9XHJcblxyXG4gIG5nT25Jbml0KCkge1xyXG4gICAgdGhpcy5yZWxlYXNlVHlwZSA9IHRoaXMucHJvY1ZlcnNpb24gPT09IDEgPyAncmVsZWFzZScgOiAndXBkYXRlJztcclxuICAgIHRoaXMudWlTdGF0ZS5nZXRVc2VySW5mbygpLnN1YnNjcmliZShyZSA9PiB7XHJcbiAgICAgIHRoaXMuYXBwbGljYW50TmFtZSA9IHJlLm5hbWU7XHJcbiAgICAgIHRoaXMuYXBwbGljYW50RGVwYXJ0bWVudCA9IHJlLm9yZ05hbWU7XHJcbiAgICAgIHRoaXMuYXBwbGljYW50SWQgPSByZS5pZDtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgc2F2ZUFzT0soKSB7XHJcbiAgICB0aGlzLnVpU3RhdGUuY3JlYXRlRGF0YSgpLnN1YnNjcmliZSgoc2F2ZURhdGEpID0+IHtcclxuICAgICAgY29uc3QgZGF0YUlkID0gc2F2ZURhdGEucmV0dXJuVmFsdWUuaWQ7XHJcbiAgICAgIGNvbnN0IGRhdGEgPSB7XHJcbiAgICAgICAgRGF0YUlkOiBkYXRhSWQsXHJcbiAgICAgICAgYXBwbGljYW50TmFtZTogdGhpcy5hcHBsaWNhbnROYW1lLFxyXG4gICAgICAgIGFwcGxpY2FudERlcGFydG1lbnQ6IHRoaXMuYXBwbGljYW50RGVwYXJ0bWVudCxcclxuICAgICAgICBwcm9jTmFtZTogdGhpcy5wcm9jTmFtZSxcclxuICAgICAgICBwcm9jVmVyc2lvbjogdGhpcy5wcm9jVmVyc2lvbixcclxuICAgICAgICByZWxlYXNlVHlwZTogdGhpcy5yZWxlYXNlVHlwZSxcclxuICAgICAgICB0ZXh0RGV0YWlsOiB0aGlzLnRleHREZXRhaWwsXHJcbiAgICAgICAgcHJvY2Vzc0RlZmluaXRpb25LZXk6IHRoaXMucHJvY2Vzc0RlZmluaXRpb25LZXksXHJcbiAgICAgICAgYXBwbGljYW50SWQ6IHRoaXMuYXBwbGljYW50SWRcclxuICAgICAgfTtcclxuICAgICAgY29uc3QgSW5mbyA9IHtcclxuICAgICAgICBDaGFuZ2VUeXBlOiAnTW9kaWZ5JyxcclxuICAgICAgICBDaGFuZ2VJbmZvOiBkYXRhXHJcbiAgICAgIH07XHJcbiAgICAgIHRoaXMudWlTdGF0ZS5yZWxlYXNlU2F2ZShJbmZvKS5zdWJzY3JpYmUoKHJlKSA9PiB7XHJcbiAgICAgICAgdGhpcy5teVN1Ym1pdChkYXRhSWQsICcwM2JkY2EzNy04NDM5LTQ5MjQtOGFlZi0yMGYzZjQwOTJiNTknKTtcclxuICAgICAgICB0aGlzLnN1Ym1pdC5uZXh0KCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG4gIHNhdmVBc0NhbmNlbCgpIHtcclxuICAgIHRoaXMuY2FuY2VsLmVtaXQoKTtcclxuICB9XHJcbiAgZWRpdG9yQ3JlYXRlZChxdWlsbCkge1xyXG4gICAgY29uc3QgdG9vbGJhciA9IHF1aWxsLmdldE1vZHVsZSgndG9vbGJhcicpO1xyXG4gICAgdGhpcy5lZGl0b3IgPSBxdWlsbDtcclxuICB9XHJcblxyXG4gIGNvbnRlbnRDaGFuZ2VkKHYpIHtcclxuICAgIGNvbnNvbGUubG9nKHYpO1xyXG4gIH1cclxuICB2YWxpZGF0b3IoKSB7XHJcbiAgICByZXR1cm4gdHJ1ZTtcclxuICB9XHJcbiAgY2hhbmdlVmFsdWUoZGF0YTogYW55KSB7XHJcbiAgICB0aGlzLnJlbGVhc2VUeXBlID0gZGF0YTtcclxuICB9XHJcbiAgLyoqXHJcbiAgICog5Y+R5biD5YmN5a6h5qC477ya5o+Q5Lqk5a6h5om5XHJcbiAgICovXHJcbiAgcHJpdmF0ZSBteVN1Ym1pdChkYXRhSWQ6IHN0cmluZywgYml6RGVmS2V5OiBzdHJpbmcpIHtcclxuICAgIHRoaXMuc3VibWl0U2VydmljZS5zdWJtaXRXaXRoQml6RGVmS2V5KGRhdGFJZCwgYml6RGVmS2V5KTtcclxuICB9XHJcbn1cclxuIl19