/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, TemplateRef, ViewChild, Input, ViewContainerRef, Injector, ChangeDetectorRef, Optional, Inject, LOCALE_ID } from '@angular/core';
import { HttpService } from '@ecp-caf/caf-common';
import { Observable, of, forkJoin, Subject } from 'rxjs';
import { FormFormat } from '../entities/form-format';
import { FormFormatConfig, FormButtonConfig, FormFieldConfig } from '../entities/form-format-config';
import { DatagridComponent } from '@farris/ui-datagrid';
import { MessagerService } from '@farris/ui-messager';
import { NotifyService } from '@farris/ui-notify';
import { switchMap } from 'rxjs/operators';
import { FormOperationConfigComponent } from '../form-operation-config/form-operation-config.component';
import { TreeTableComponent } from '@farris/ui-treetable';
import { WF_LANG_RESOURCES, WfLocalePipe } from '../../../i18n/pipe/wf-process-editor-locale.pipe';
export class FormFormatConfigComponent {
    /**
     * @param {?} http
     * @param {?} message
     * @param {?} notify
     * @param {?} injector
     * @param {?} cdr
     * @param {?} localeId
     * @param {?} resources
     * @param {?} localePipe
     */
    constructor(http, message, notify, injector, cdr, localeId, resources, localePipe) {
        this.http = http;
        this.message = message;
        this.notify = notify;
        this.injector = injector;
        this.cdr = cdr;
        this.localeId = localeId;
        this.resources = resources;
        this.localePipe = localePipe;
        this.config = new FormFormatConfig();
        this.formFormat = new FormFormat();
        this.state = 'edit';
        this.showMethodTab = true;
        this.buttonCols = [];
        this.buttonConfigs = new Array();
        this.fieldCols = [];
        this.fieldConfigs = new Array();
        this.formatFieldList = new Array();
        this.showExtendTab = false;
        this.localePipe = this.localePipe || new WfLocalePipe(localeId, resources);
        /** @type {?} */
        let serchFields = {
            label: this.localePipe.transform('component.executeForms.fieldName'),
            value: 'fieldName'
        };
        if (this.searchFields) {
            if (!this.searchFields.some((/**
             * @param {?} x
             * @return {?}
             */
            x => x.value === serchFields.value))) {
                this.searchFields = this.searchFields.concat(serchFields);
            }
        }
        else {
            this.searchFields = [];
            this.searchFields = this.searchFields.concat(serchFields);
        }
    }
    /**
     * @param {?} v
     * @return {?}
     */
    set formFormatId(v) {
        this._formFormatId = v;
        this.config.formFormatId = v;
    }
    /**
     * @return {?}
     */
    get formFormatId() {
        return this._formFormatId;
    }
    /**
     * @param {?} v
     * @return {?}
     */
    set formatConfigId(v) {
        this._formatConfigId = v;
        if (!v) {
            this.state = 'new';
        }
    }
    /**
     * @return {?}
     */
    get formatConfigId() {
        return this._formatConfigId;
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        this.buttonCols = [
            { field: 'buttonName', width: 100, title: this.localePipe.transform('component.executeForms.buttonName'), filter: true },
            // { field: 'buttonId', width: 100, title: '按钮标识' },
            {
                title: this.localePipe.transform('component.executeForms.enable'),
                field: 'enable',
                width: 80,
                template: this.btnEnable,
                align: 'center',
                hAlign: 'center'
            },
            {
                title: this.localePipe.transform('component.executeForms.disabled'),
                field: 'disabled',
                width: 80,
                template: this.btnDisabled,
                align: 'center',
                hAlign: 'center'
            },
            {
                title: this.localePipe.transform('component.executeForms.hidden'),
                field: 'hidden',
                width: 80,
                template: this.btnHidden,
                align: 'center',
                hAlign: 'center'
            }
        ];
        this.fieldCols = [
            { field: 'fieldName', width: 100, title: this.localePipe.transform('component.executeForms.fieldName') },
            // { field: 'fieldId', width: 100, title: '字段标识' },
            {
                title: this.localePipe.transform('component.executeForms.editable'),
                field: 'editable',
                width: 80,
                template: this.fieldEditable,
                align: 'center',
                hAlign: 'center'
            },
            {
                title: this.localePipe.transform('component.executeForms.readonly'),
                field: 'readonly',
                width: 80,
                template: this.fieldReadonly,
                align: 'center',
                hAlign: 'center'
            },
            {
                title: this.localePipe.transform('component.executeForms.hidden'),
                field: 'hidden',
                width: 80,
                template: this.fieldHidden,
                align: 'center',
                hAlign: 'center'
            },
            {
                title: this.localePipe.transform('component.executeForms.required'),
                field: 'required',
                width: 80,
                template: this.fieldRequired,
                align: 'center',
                hAlign: 'center'
            }
        ];
        this.getConfig();
    }
    /**
     * @return {?}
     */
    submit() {
        /** @type {?} */
        const subject = new Subject();
        this.validator().subscribe((/**
         * @param {?} re
         * @return {?}
         */
        re => {
            if (re) {
                this.setBtnAndFieldConfigs();
                if (this.extendComponentRef) {
                    this.extendComponentRef.instance.submit().subscribe((/**
                     * @param {?} configId
                     * @return {?}
                     */
                    configId => {
                        if (configId) {
                            this.config.id = configId;
                            this.saveConfig(this.config).subscribe((/**
                             * @param {?} re
                             * @return {?}
                             */
                            re => {
                                subject.next({ result: true, configId: this.config.id });
                            }), (/**
                             * @param {?} err
                             * @return {?}
                             */
                            err => {
                                this.message.error(this.localePipe.transform('component.executeForms.saveFail'));
                                subject.next({ result: false, configId: this.config.id });
                            }));
                        }
                        else {
                            if (this.state === 'new' &&
                                this.config.formButtonConfigs.length === 0 &&
                                this.config.formFieldConfigs.length === 0 &&
                                this.operationConfig.operations.length === 0) {
                                setTimeout((/**
                                 * @return {?}
                                 */
                                () => {
                                    subject.next({ result: true, configId: null });
                                }), 10);
                            }
                            else {
                                this.saveConfig(this.config).subscribe((/**
                                 * @param {?} re
                                 * @return {?}
                                 */
                                re => {
                                    subject.next({ result: true, configId: this.config.id });
                                }), (/**
                                 * @param {?} err
                                 * @return {?}
                                 */
                                err => {
                                    this.message.error(this.localePipe.transform('component.executeForms.saveFail'));
                                    subject.next({ result: false, configId: this.config.id });
                                }));
                            }
                        }
                    }));
                }
                else {
                    if (this.state === 'new' &&
                        this.config.formButtonConfigs.length === 0 &&
                        this.config.formFieldConfigs.length === 0 &&
                        this.operationConfig.operations.length === 0) {
                        setTimeout((/**
                         * @return {?}
                         */
                        () => {
                            subject.next({ result: true, configId: null });
                        }), 10);
                    }
                    else {
                        this.saveConfig(this.config).subscribe((/**
                         * @param {?} re
                         * @return {?}
                         */
                        re => {
                            subject.next({ result: true, configId: this.config.id });
                        }), (/**
                         * @param {?} err
                         * @return {?}
                         */
                        err => {
                            this.message.error(this.localePipe.transform('component.executeForms.saveFail'));
                            subject.next({ result: false, configId: this.config.id });
                        }));
                    }
                }
            }
            else {
                setTimeout((/**
                 * @return {?}
                 */
                () => {
                    subject.next({ result: false });
                }), 10);
            }
        }));
        return subject.asObservable();
    }
    /**
     * @param {?} data
     * @return {?}
     */
    searchField(data) {
        data.field = 'fieldName';
        /** @type {?} */
        let searchData = {
            field: 'fieldName',
            value: data.value
        };
        this.fieldTree.searchData = searchData;
        // this.fieldTree.searchData.field = 'fieldName';
        /** @type {?} */
        let serchFields = {
            label: this.localePipe.transform('component.executeForms.fieldName'),
            value: 'fieldName'
        };
        if (this.fieldTree.searchFields) {
            if (!this.fieldTree.searchFields.some((/**
             * @param {?} x
             * @return {?}
             */
            x => x.value === serchFields.value))) {
                this.fieldTree.searchFields = this.fieldTree.searchFields.concat(serchFields);
            }
        }
        else {
            this.fieldTree.searchFields = [];
            this.fieldTree.searchFields = this.fieldTree.searchFields.concat(serchFields);
        }
        this.fieldTree.searchHandle.search(data.field, data.value, 'client');
    }
    /**
     * @param {?} bool
     * @param {?} field
     * @param {?} id
     * @return {?}
     */
    btnConfigChange(bool, field, id) {
        if (bool) {
            for (const b of this.buttonConfigs) {
                if (b.id === id) {
                    switch (field) {
                        case 'enable':
                            b.enable = bool;
                            b.disabled = false;
                            b.hidden = false;
                            break;
                        case 'disabled':
                            b.disabled = bool;
                            b.enable = false;
                            b.hidden = false;
                            break;
                        case 'hidden':
                            b.hidden = bool;
                            b.disabled = false;
                            b.enable = false;
                            break;
                    }
                    this.btnGrid.updateRow(id, b);
                }
            }
        }
        this.btnGrid.cd.detectChanges();
    }
    /**
     * @param {?} operation
     * @return {?}
     */
    btnBatchOperate(operation) {
        /** @type {?} */
        const checkeds = this.btnGrid.checkedRows;
        if (checkeds && checkeds.length > 0) {
            for (const c of checkeds) {
                this.btnConfigChange(true, operation, c.id);
            }
            this.btnGrid.cd.detectChanges();
        }
        else {
            this.message.info(this.localePipe.transform('component.executeForms.checkedRows'));
        }
    }
    /**
     * @return {?}
     */
    btnBatchReset() {
        /** @type {?} */
        const checkeds = this.btnGrid.checkedRows;
        if (checkeds && checkeds.length > 0) {
            for (const c of checkeds) {
                /** @type {?} */
                const button = this.formFormat.formButtons.find((/**
                 * @param {?} b
                 * @return {?}
                 */
                b => b.id === c.id));
                for (const b of this.buttonConfigs) {
                    if (b.id === c.id) {
                        b.enable = button.buttonState === 'Enable' ? true : false;
                        b.disabled = button.buttonState === 'Disabled' ? true : false;
                        b.hidden = button.buttonState === 'Hidden' ? true : false;
                    }
                    this.btnGrid.updateRow(b.id, b);
                }
            }
            this.btnGrid.cd.detectChanges();
        }
        else {
            this.message.info(this.localePipe.transform('component.executeForms.checkedRows'));
        }
    }
    /**
     * @param {?} bool
     * @param {?} field
     * @param {?} id
     * @param {?=} search
     * @return {?}
     */
    fieldConfigChange(bool, field, id, search = true) {
        if (bool) {
            this.fieldSwitchChange(this.fieldConfigs, field, id);
        }
        if (search) {
            this.fieldTree.searchHandle['research']();
        }
    }
    /**
     * @private
     * @param {?} fieldConfigs
     * @param {?} field
     * @param {?} id
     * @return {?}
     */
    fieldSwitchChange(fieldConfigs, field, id) {
        if (fieldConfigs.length > 0) {
            for (const f of fieldConfigs) {
                if (f.data.id === id) {
                    switch (field) {
                        case 'editable':
                            f.data.editable = true;
                            f.data.readonly = false;
                            f.data.hidden = false;
                            f.data.required = false;
                            break;
                        case 'readonly':
                            f.data.editable = false;
                            f.data.readonly = true;
                            f.data.hidden = false;
                            f.data.required = false;
                            break;
                        case 'hidden':
                            f.data.editable = false;
                            f.data.readonly = false;
                            f.data.hidden = true;
                            f.data.required = false;
                            break;
                        case 'required':
                            f.data.editable = false;
                            f.data.readonly = false;
                            f.data.hidden = false;
                            f.data.required = true;
                            break;
                    }
                    return;
                }
                else {
                    if (f.children && f.children.length > 0) {
                        this.fieldSwitchChange(f.children, field, id);
                    }
                }
            }
        }
    }
    /**
     * @param {?} operation
     * @return {?}
     */
    fieldBatchOperate(operation) {
        /** @type {?} */
        const checkeds = this.fieldTree.checkeds;
        if (checkeds && checkeds.length > 0) {
            for (const c of checkeds) {
                this.fieldConfigChange(true, operation, c.data.id, false);
            }
            this.fieldTree.searchHandle['research']();
        }
        else {
            this.message.info(this.localePipe.transform('component.executeForms.checkeds'));
        }
    }
    /**
     * @return {?}
     */
    fieldBatchReset() {
        /** @type {?} */
        const checkeds = this.fieldTree.checkeds;
        if (checkeds && checkeds.length > 0) {
            for (const c of checkeds) {
                /** @type {?} */
                const field = this.formatFieldList.find((/**
                 * @param {?} f
                 * @return {?}
                 */
                f => f.id === c.data.id));
                this.resetFieldConfig(this.fieldConfigs, c.data.id, field);
            }
            this.fieldTree.searchHandle['research']();
        }
        else {
            this.message.info(this.localePipe.transform('component.executeForms.checkeds'));
        }
    }
    /**
     * @param {?} fieldConfigs
     * @param {?} id
     * @param {?} field
     * @return {?}
     */
    resetFieldConfig(fieldConfigs, id, field) {
        if (fieldConfigs.length > 0) {
            for (const f of fieldConfigs) {
                if (f.leaf === true && f.data.id === id) {
                    f.data.editable = field.fieldState === 'Editable' ? true : false;
                    f.data.readonly = field.fieldState === 'Readonly' ? true : false;
                    f.data.hidden = field.fieldState === 'Hidden' ? true : false;
                    f.data.required = field.fieldState === 'Required' ? true : false;
                    return;
                }
                else {
                    if (f.children && f.children.length > 0) {
                        this.resetFieldConfig(f.children, id, field);
                    }
                }
            }
        }
    }
    /**
     * @private
     * @return {?}
     */
    validator() {
        if (this.extendComponentRef) {
            /** @type {?} */
            const result$ = this.extendComponentRef.instance.validator();
            if (result$ instanceof Observable) {
                return result$.pipe(switchMap((/**
                 * @param {?} b
                 * @return {?}
                 */
                (b) => {
                    if (b && this.innerValidator()) {
                        return of(true);
                    }
                    else {
                        return of(false);
                    }
                })));
            }
            else {
                if (result$) {
                    return of(this.innerValidator());
                }
                else {
                    return of(false);
                }
            }
        }
        else {
            return of(this.innerValidator());
        }
    }
    /**
     * @private
     * @return {?}
     */
    innerValidator() {
        return this.operationConfig.validator();
    }
    /**
     * @private
     * @return {?}
     */
    setBtnAndFieldConfigs() {
        this.config.formButtonConfigs = new Array();
        for (const btn of this.buttonConfigs) {
            /** @type {?} */
            const button = this.formFormat.formButtons.find((/**
             * @param {?} b
             * @return {?}
             */
            b => b.buttonId === btn.buttonId));
            /** @type {?} */
            const btnConfig = new FormButtonConfig();
            btnConfig.buttonId = btn.buttonId;
            if (btn.enable) {
                btnConfig.buttonState = 'Enable';
            }
            else if (btn.disabled) {
                btnConfig.buttonState = 'Disabled';
            }
            else if (btn.hidden) {
                btnConfig.buttonState = 'Hidden';
            }
            else {
                continue;
            }
            if (!button.buttonState && btnConfig.buttonState) {
                this.config.formButtonConfigs.push(btnConfig);
            }
            if (button.buttonState && button.buttonState !== btnConfig.buttonState) {
                this.config.formButtonConfigs.push(btnConfig);
            }
        }
        this.config.formFieldConfigs = new Array();
        this.getFieldConfigs(this.fieldConfigs);
        this.config.formMethodConfigs = this.operationConfig.operations || new Array();
    }
    /**
     * @private
     * @param {?} fieldConfigs
     * @return {?}
     */
    getFieldConfigs(fieldConfigs) {
        if (fieldConfigs && fieldConfigs.length > 0) {
            for (const f of fieldConfigs) {
                if (f.children && f.children.length > 0) {
                    this.getFieldConfigs(f.children);
                }
                if (f.leaf === false) {
                    continue;
                }
                /** @type {?} */
                const field = this.formatFieldList.find((/**
                 * @param {?} fd
                 * @return {?}
                 */
                fd => fd.fieldId === f.data.fieldId));
                /** @type {?} */
                const fieldConfig = new FormFieldConfig();
                fieldConfig.fieldId = f.data.fieldId;
                if (f.data.editable) {
                    fieldConfig.fieldState = 'Editable';
                }
                else if (f.data.readonly) {
                    fieldConfig.fieldState = 'Readonly';
                }
                else if (f.data.hidden) {
                    fieldConfig.fieldState = 'Hidden';
                }
                else if (f.data.required) {
                    fieldConfig.fieldState = 'Required';
                }
                else {
                    continue;
                }
                if (!field.fieldState && fieldConfig.fieldState) {
                    this.config.formFieldConfigs.push(fieldConfig);
                }
                if (field.fieldState && field.fieldState !== fieldConfig.fieldState) {
                    this.config.formFieldConfigs.push(fieldConfig);
                }
            }
        }
    }
    /**
     * @private
     * @return {?}
     */
    getConfig() {
        if (this.formFormatId) {
            forkJoin(this.getFormFormatType(), this.getFormFormat(), this.getFormFormatConfig()).subscribe((/**
             * @param {?} re
             * @return {?}
             */
            (re) => {
                /** @type {?} */
                const formFormatType = (/** @type {?} */ (re[0]));
                if (formFormatType) {
                    this.formFormatType = formFormatType;
                    if (this.formFormatType.extendImpl) {
                        this.showExtendTab = true;
                        this.createExtendComponent(this.formFormatType.extendImpl);
                    }
                    else {
                        this.showExtendTab = false;
                    }
                }
                /** @type {?} */
                const formFormat = (/** @type {?} */ (re[1]));
                if (formFormat) {
                    this.formFormat = this.convertFormFormat(formFormat);
                }
                /** @type {?} */
                const config = (/** @type {?} */ (re[2]));
                if (config) {
                    this.config = config;
                }
                if (this.formFormat.formButtons) {
                    this.buttonConfigs = this.formFormat.formButtons.map((/**
                     * @param {?} b
                     * @return {?}
                     */
                    b => Object.assign({}, b, {
                        enable: b.buttonState === 'Enable' ? true : false,
                        disabled: b.buttonState === 'Disabled' ? true : false,
                        hidden: b.buttonState === 'Hidden' ? true : false
                    })));
                    /** @type {?} */
                    let btnConfigs = new Array();
                    if (config && config.formButtonConfigs) {
                        btnConfigs = config.formButtonConfigs;
                    }
                    for (const b of btnConfigs) {
                        for (const btn of this.buttonConfigs) {
                            if (btn.buttonId === b.buttonId) {
                                switch (b.buttonState) {
                                    case 'Enable':
                                        btn.enable = true;
                                        btn.disabled = false;
                                        btn.hidden = false;
                                        break;
                                    case 'Disabled':
                                        btn.enable = false;
                                        btn.disabled = true;
                                        btn.hidden = false;
                                        break;
                                    case 'Hidden':
                                        btn.enable = false;
                                        btn.disabled = false;
                                        btn.hidden = true;
                                        break;
                                }
                                break;
                            }
                        }
                    }
                }
                if (this.formFormat.formFields) {
                    this.fieldConfigs = [...this.formFormat.formFields];
                    this.orgFieldConfigs(this.fieldConfigs);
                    /** @type {?} */
                    let configs = new Array();
                    if (config && config.formFieldConfigs) {
                        configs = config.formFieldConfigs;
                    }
                    for (const f of configs) {
                        this.setFieldConfig(this.fieldConfigs, f);
                    }
                }
            }));
        }
    }
    /**
     * @param {?} extendImpl
     * @return {?}
     */
    createExtendComponent(extendImpl) {
        /** @type {?} */
        const url = extendImpl.split('#')[0];
        /** @type {?} */
        const selectorCmp = extendImpl.split('#')[1];
        System.import(url)
            .then((/**
         * @param {?} moduleFactorys
         * @return {?}
         */
        (moduleFactorys) => {
            /** @type {?} */
            const moduleFactory = Object.values(moduleFactorys)[0];
            /** @type {?} */
            const moduleRef = moduleFactory.create(this.injector);
            if (selectorCmp) {
                /** @type {?} */
                let facMap = moduleRef.componentFactoryResolver['_factories'];
                facMap.forEach((/**
                 * @param {?} value
                 * @param {?} key
                 * @param {?} map
                 * @return {?}
                 */
                (value, key, map) => {
                    /** @type {?} */
                    const selector = value.selector;
                    if (selectorCmp == selector) {
                        /** @type {?} */
                        const cmpFactory = moduleRef.componentFactoryResolver.resolveComponentFactory((/** @type {?} */ (key)));
                        this.extendComponentRef = cmpFactory.create(moduleRef.injector);
                        this.extendComponentRef.instance.formFormatId = this.formFormatId;
                        this.extendComponentRef.instance.formatConfigId = this.formatConfigId;
                        this.container.clear();
                        this.container.insert(this.extendComponentRef.hostView);
                    }
                }));
            }
            else {
                /** @type {?} */
                const bootstrapComponent = moduleRef['_bootstrapComponents'][0];
                if (bootstrapComponent) //先找bootstrapComponent数组有无组件
                 {
                    /** @type {?} */
                    const cmpFactory = moduleRef.componentFactoryResolver.resolveComponentFactory(bootstrapComponent);
                    this.extendComponentRef = cmpFactory.create(moduleRef.injector);
                    this.extendComponentRef.instance.formFormatId = this.formFormatId;
                    this.extendComponentRef.instance.formatConfigId = this.formatConfigId;
                    this.container.clear();
                    this.container.insert(this.extendComponentRef.hostView);
                }
            }
        }));
    }
    /**
     * @private
     * @param {?} formFields
     * @return {?}
     */
    orgFieldConfigs(formFields) {
        if (formFields.length > 0) {
            for (const d of formFields) {
                d.data = Object.assign({}, d.data, {
                    editable: d.data.fieldState === 'Editable' ? true : false,
                    readonly: d.data.fieldState === 'Readonly' ? true : false,
                    hidden: d.data.fieldState === 'Hidden' ? true : false,
                    required: d.data.fieldState === 'Required' ? true : false
                });
                if (d.children && d.children) {
                    this.orgFieldConfigs(d.children);
                }
            }
        }
    }
    /**
     * @private
     * @param {?} fieldConfigs
     * @param {?} config
     * @return {?}
     */
    setFieldConfig(fieldConfigs, config) {
        if (fieldConfigs.length > 0) {
            for (const f of fieldConfigs) {
                if (f.data.fieldId === config.fieldId) {
                    switch (config.fieldState) {
                        case 'Editable':
                            f.data.editable = true;
                            f.data.readonly = false;
                            f.data.hidden = false;
                            f.data.required = false;
                            break;
                        case 'Readonly':
                            f.data.editable = false;
                            f.data.readonly = true;
                            f.data.hidden = false;
                            f.data.required = false;
                            break;
                        case 'Hidden':
                            f.data.editable = false;
                            f.data.readonly = false;
                            f.data.hidden = true;
                            f.data.required = false;
                            break;
                        case 'Required':
                            f.data.editable = false;
                            f.data.readonly = false;
                            f.data.hidden = false;
                            f.data.required = true;
                            break;
                    }
                    return;
                }
                else {
                    if (f.children && f.children.length > 0) {
                        this.setFieldConfig(f.children, config);
                    }
                }
            }
        }
    }
    /**
     * @private
     * @param {?} config
     * @return {?}
     */
    saveConfig(config) {
        /** @type {?} */
        const url = '/api/runtime/wf/v1.0/formFormatConfig';
        return this.http.post(url, config);
    }
    /**
     * @private
     * @return {?}
     */
    getFormFormat() {
        if (this.formFormatId) {
            /** @type {?} */
            let url = `/api/runtime/wf/v1.0/formFormat/${this.formFormatId}`;
            url = encodeURI(url);
            return this.http.get(url);
        }
        else {
            return of(null);
        }
    }
    /**
     * @private
     * @return {?}
     */
    getFormFormatType() {
        if (this.formFormatId) {
            /** @type {?} */
            const url = `/api/runtime/wf/v1.0/formFormatType/formFormat?formFormat=${this.formFormatId}`;
            return this.http.get(url);
        }
    }
    /**
     * @private
     * @return {?}
     */
    getFormFormatConfig() {
        if (this.formatConfigId) {
            /** @type {?} */
            let url = `/api/runtime/wf/v1.0/formFormatConfig/${this.formatConfigId}`;
            url = encodeURI(url);
            return this.http.get(url);
        }
        else {
            return of(null);
        }
    }
    /**
     * @private
     * @param {?} formFormat
     * @return {?}
     */
    convertFormFormat(formFormat) {
        if (!formFormat.status) {
            formFormat.status = 0;
        }
        this.convertformFields(formFormat.formFields);
        this.getFormatFieldList(formFormat.formFields, this.formatFieldList);
        return formFormat;
    }
    /**
     * @private
     * @param {?} formFields
     * @return {?}
     */
    convertformFields(formFields) {
        if (formFields && formFields.length > 0) {
            for (const d of formFields) {
                if (typeof (d.leaf) !== 'boolean' && (d.leaf == null || d.leaf === undefined)) {
                    d.leaf = true;
                }
                if (d.children && d.children) {
                    this.orgFieldConfigs(d.children);
                }
            }
        }
    }
    /**
     * @private
     * @param {?} formFields
     * @param {?} array
     * @return {?}
     */
    getFormatFieldList(formFields, array) {
        if (formFields && formFields.length > 0) {
            for (const d of formFields) {
                array.push(d.data);
                if (d.children && d.children) {
                    this.getFormatFieldList(d.children, array);
                }
            }
        }
    }
    /**
     * @private
     * @param {?} formFields
     * @param {?} fieldId
     * @return {?}
     */
    getFormatField(formFields, fieldId) {
        for (const f of formFields) {
            if (f.data.fieldId === fieldId) {
                return f;
            }
            if (f.children && f.children.length > 0) {
                return this.getFormatField(f.children, fieldId);
            }
        }
    }
}
FormFormatConfigComponent.decorators = [
    { type: Component, args: [{
                selector: 'lib-form-format-config',
                template: "\r\n<!--\u9700\u8981\u5D4C\u5957\u7684\u5C42-----------\u6807\u7B7E\u9875---------------->\r\n<farris-tabs class=\"h-100 f-component-tabs f-tabs-has-grid\" [value]=\"'buttonConfig'\" [contentFill]=\"true\">\r\n  <farris-tab title=\"{{'component.executeForms.formBtn'|wfLocale}}\" [id]=\"'buttonConfig'\">\r\n    <ng-template farrisTabsExtend>\r\n      <farris-button [type]=\"'link'\" (click)=\"btnBatchOperate('enable')\">\r\n        {{'component.executeForms.enableBtn'|wfLocale}}\r\n      </farris-button>\r\n      <farris-button [type]=\"'link'\" (click)=\"btnBatchOperate('disabled')\">\r\n        {{'component.executeForms.disabledBtn'|wfLocale}}\r\n      </farris-button>\r\n      <farris-button [type]=\"'link'\" (click)=\"btnBatchOperate('hidden')\">\r\n        {{'component.executeForms.hiddenBtn'|wfLocale}}\r\n      </farris-button>\r\n      <farris-button [type]=\"'link'\" (click)=\"btnBatchReset()\">\r\n        {{'component.executeForms.btnBatchReset'|wfLocale}}\r\n      </farris-button>\r\n    </ng-template>\r\n    <ng-template #content>\r\n      <div class=\"f-utils-fill-flex-column\" style=\"background: #FFF;\">\r\n        <farris-datagrid class=\"f-component-grid f-utils-fill\" [columns]=\"buttonCols\" [data]=\"buttonConfigs\" #btnGrid\r\n          [idField]=\"'id'\" [showLineNumber]=\"false\" [fitColumns]=\"true\" [striped]=\"true\"\r\n          [virtualized]=\"true\" [pagination]=\"false\" [useThemes]=\"false\" [fit]=\"true\" [showAllCheckbox]=\"true\"\r\n          [showCheckbox]=\"true\" [multiSelect]=\"true\" [enableFilterRow]=\"true\">\r\n        </farris-datagrid>\r\n      </div>\r\n    </ng-template>\r\n  </farris-tab>\r\n  <farris-tab title=\"{{'component.executeForms.formfield'|wfLocale}}\" [id]=\"'fieldConfig'\">\r\n    <ng-template farrisTabsExtend>\r\n      <farris-button [type]=\"'link'\" (click)=\"fieldBatchOperate('editable')\">\r\n        {{'component.executeForms.editableBtn'|wfLocale}}\r\n      </farris-button>\r\n      <farris-button [type]=\"'link'\" (click)=\"fieldBatchOperate('readonly')\">\r\n        {{'component.executeForms.readonlyBtn'|wfLocale}}\r\n      </farris-button>\r\n      <farris-button [type]=\"'link'\" (click)=\"fieldBatchOperate('hidden')\">\r\n        {{'component.executeForms.hiddenBtn'|wfLocale}}\r\n      </farris-button>\r\n      <farris-button [type]=\"'link'\" (click)=\"fieldBatchOperate('required')\">\r\n        {{'component.executeForms.requiredBtn'|wfLocale}}\r\n      </farris-button>\r\n      <farris-button [type]=\"'link'\" (click)=\"fieldBatchReset()\">\r\n        {{'component.executeForms.btnBatchReset'|wfLocale}}\r\n      </farris-button>\r\n    </ng-template>\r\n    <ng-template #content>\r\n      <div class=\"f-utils-fill-flex-column\" style=\"background: #FFF;\">\r\n        <farris-treetable #fieldTree [columns]=\"fieldCols\" [showFilterBar]=\"true\" [searchFields] = \"searchFields\"\r\n          [showBorder]=\"false\" [showHeader]=\"true\" [data]=\"fieldConfigs\" [fit]=\"true\" [fitColumns]=\"true\"\r\n          [idField]=\"'id'\" [virtualized]=\"false\" [singleSelect]=\"false\" [showCheckbox]=\"true\"\r\n          [showCheckAll]=\"true\" [striped]=\"true\" [fixedHeader]=\"true\" (search)=\"searchField($event)\">\r\n        </farris-treetable>\r\n      </div>\r\n    </ng-template>\r\n  </farris-tab>\r\n  <farris-tab title=\"{{'component.executeForms.formEvents'|wfLocale}}\" [id]=\"'operationConfig'\" [show]=\"showMethodTab\">\r\n    <ng-template farrisTabsExtend>\r\n      <farris-button [type]=\"'link'\" (click)=\"operationConfig.add()\">\r\n        {{'component.executeForms.add'|wfLocale}}\r\n      </farris-button>\r\n      <farris-button [type]=\"'link'\" (click)=\"operationConfig.delete()\">\r\n        {{'component.executeForms.delete'|wfLocale}}\r\n      </farris-button>\r\n    </ng-template>\r\n    <ng-template #content>\r\n      <lib-form-operation-config\r\n        [formFormatId]=\"formFormatId\"\r\n        [formFormatConfigId]=\"config.id\"\r\n        [operations]=\"config.formMethodConfigs\"\r\n        class=\"h-100\"></lib-form-operation-config>\r\n    </ng-template>\r\n  </farris-tab>\r\n  <farris-tab title=\"{{'component.executeForms.other'|wfLocale}}\" [id]=\"'extendConfig'\" [show]=\"showExtendTab\">\r\n    <ng-template #content>\r\n      <ng-container #container></ng-container>\r\n    </ng-template>\r\n  </farris-tab>\r\n</farris-tabs>\r\n<!--Tab\u533A\u57DF-->\r\n\r\n  <!-- </section>\r\n</div> -->\r\n\r\n<ng-template #btnEnable let-ctx>\r\n  <farris-switch [(ngModel)]=\"ctx.rowData.enable\" (valueChange)=\"btnConfigChange($event, ctx.field, ctx.rowData.id)\"></farris-switch>\r\n</ng-template>\r\n<ng-template #btnDisabled let-ctx>\r\n  <farris-switch [(ngModel)]=\"ctx.rowData.disabled\" (valueChange)=\"btnConfigChange($event, ctx.field, ctx.rowData.id)\"></farris-switch>\r\n</ng-template>\r\n<ng-template #btnHidden let-ctx>\r\n  <farris-switch [(ngModel)]=\"ctx.rowData.hidden\" (valueChange)=\"btnConfigChange($event, ctx.field, ctx.rowData.id)\"></farris-switch>\r\n</ng-template>\r\n<ng-template #fieldEditable let-ctx>\r\n  <farris-switch *ngIf=\"ctx.node.leaf\" size=\"small\" [(ngModel)]=\"ctx.node.data.editable\"\r\n  (valueChange)=\"fieldConfigChange($event, ctx.column.field, ctx.node.data.id)\">\r\n  </farris-switch>\r\n</ng-template>\r\n<ng-template #fieldReadonly let-ctx>\r\n  <farris-switch *ngIf=\"ctx.node.leaf\" size=\"small\" [(ngModel)]=\"ctx.node.data.readonly\"\r\n    (valueChange)=\"fieldConfigChange($event, ctx.column.field, ctx.node.data.id)\">\r\n  </farris-switch>\r\n</ng-template>\r\n<ng-template #fieldHidden let-ctx>\r\n  <farris-switch *ngIf=\"ctx.node.leaf\" size=\"small\" [(ngModel)]=\"ctx.node.data.hidden\"\r\n    (valueChange)=\"fieldConfigChange($event, ctx.column.field, ctx.node.data.id)\">\r\n  </farris-switch>\r\n</ng-template>\r\n<ng-template #fieldRequired let-ctx>\r\n  <farris-switch *ngIf=\"ctx.node.leaf\" size=\"small\" [(ngModel)]=\"ctx.node.data.required\"\r\n    (valueChange)=\"fieldConfigChange($event, ctx.column.field, ctx.node.data.id)\">\r\n  </farris-switch>\r\n</ng-template>\r\n\r\n\r\n",
                providers: [
                    WfLocalePipe,
                ],
                styles: [""]
            }] }
];
/** @nocollapse */
FormFormatConfigComponent.ctorParameters = () => [
    { type: HttpService },
    { type: MessagerService },
    { type: NotifyService },
    { type: Injector },
    { type: ChangeDetectorRef, decorators: [{ type: Optional }] },
    { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
    { type: undefined, decorators: [{ type: Inject, args: [WF_LANG_RESOURCES,] }] },
    { type: WfLocalePipe, decorators: [{ type: Optional }] }
];
FormFormatConfigComponent.propDecorators = {
    btnEnable: [{ type: ViewChild, args: ['btnEnable',] }],
    btnDisabled: [{ type: ViewChild, args: ['btnDisabled',] }],
    btnHidden: [{ type: ViewChild, args: ['btnHidden',] }],
    fieldEditable: [{ type: ViewChild, args: ['fieldEditable',] }],
    fieldReadonly: [{ type: ViewChild, args: ['fieldReadonly',] }],
    fieldHidden: [{ type: ViewChild, args: ['fieldHidden',] }],
    fieldRequired: [{ type: ViewChild, args: ['fieldRequired',] }],
    btnGrid: [{ type: ViewChild, args: ['btnGrid',] }],
    fieldTree: [{ type: ViewChild, args: ['fieldTree',] }],
    operationConfig: [{ type: ViewChild, args: [FormOperationConfigComponent,] }],
    container: [{ type: ViewChild, args: ['container', { read: ViewContainerRef },] }],
    showMethodTab: [{ type: Input }]
};
if (false) {
    /** @type {?} */
    FormFormatConfigComponent.prototype.btnEnable;
    /** @type {?} */
    FormFormatConfigComponent.prototype.btnDisabled;
    /** @type {?} */
    FormFormatConfigComponent.prototype.btnHidden;
    /** @type {?} */
    FormFormatConfigComponent.prototype.fieldEditable;
    /** @type {?} */
    FormFormatConfigComponent.prototype.fieldReadonly;
    /** @type {?} */
    FormFormatConfigComponent.prototype.fieldHidden;
    /** @type {?} */
    FormFormatConfigComponent.prototype.fieldRequired;
    /** @type {?} */
    FormFormatConfigComponent.prototype.btnGrid;
    /** @type {?} */
    FormFormatConfigComponent.prototype.fieldTree;
    /** @type {?} */
    FormFormatConfigComponent.prototype.operationConfig;
    /** @type {?} */
    FormFormatConfigComponent.prototype.container;
    /**
     * @type {?}
     * @private
     */
    FormFormatConfigComponent.prototype.extendComponentRef;
    /** @type {?} */
    FormFormatConfigComponent.prototype.config;
    /** @type {?} */
    FormFormatConfigComponent.prototype.formFormat;
    /** @type {?} */
    FormFormatConfigComponent.prototype.formFormatType;
    /** @type {?} */
    FormFormatConfigComponent.prototype.state;
    /** @type {?} */
    FormFormatConfigComponent.prototype.showMethodTab;
    /**
     * @type {?}
     * @private
     */
    FormFormatConfigComponent.prototype._formFormatId;
    /**
     * @type {?}
     * @private
     */
    FormFormatConfigComponent.prototype._formatConfigId;
    /** @type {?} */
    FormFormatConfigComponent.prototype.buttonCols;
    /** @type {?} */
    FormFormatConfigComponent.prototype.buttonConfigs;
    /** @type {?} */
    FormFormatConfigComponent.prototype.fieldCols;
    /** @type {?} */
    FormFormatConfigComponent.prototype.fieldConfigs;
    /** @type {?} */
    FormFormatConfigComponent.prototype.formatFieldList;
    /** @type {?} */
    FormFormatConfigComponent.prototype.showExtendTab;
    /** @type {?} */
    FormFormatConfigComponent.prototype.searchFields;
    /**
     * @type {?}
     * @private
     */
    FormFormatConfigComponent.prototype.http;
    /**
     * @type {?}
     * @private
     */
    FormFormatConfigComponent.prototype.message;
    /**
     * @type {?}
     * @private
     */
    FormFormatConfigComponent.prototype.notify;
    /**
     * @type {?}
     * @private
     */
    FormFormatConfigComponent.prototype.injector;
    /**
     * @type {?}
     * @private
     */
    FormFormatConfigComponent.prototype.cdr;
    /**
     * @type {?}
     * @private
     */
    FormFormatConfigComponent.prototype.localeId;
    /**
     * @type {?}
     * @private
     */
    FormFormatConfigComponent.prototype.resources;
    /**
     * @type {?}
     * @private
     */
    FormFormatConfigComponent.prototype.localePipe;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZm9ybS1mb3JtYXQtY29uZmlnLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0Bnc3Atd2Yvd2YtcHJvY2Vzcy1lZGl0b3IvIiwic291cmNlcyI6WyJsaWIvdmlld3MvZXhlY3V0ZS1mb3Jtcy9mb3JtLWZvcm1hdC1jb25maWcvZm9ybS1mb3JtYXQtY29uZmlnLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUFFLFNBQVMsRUFBVSxXQUFXLEVBQUUsU0FBUyxFQUFlLEtBQUssRUFBRSxnQkFBZ0IsRUFBZ0IsUUFBUSxFQUFFLGlCQUFpQixFQUFFLFFBQVEsRUFBRSxNQUFNLEVBQUUsU0FBUyxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQ3hMLE9BQU8sRUFBRSxXQUFXLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUVsRCxPQUFPLEVBQUUsVUFBVSxFQUFFLEVBQUUsRUFBRSxRQUFRLEVBQUUsT0FBTyxFQUFFLE1BQU0sTUFBTSxDQUFDO0FBQ3pELE9BQU8sRUFBRSxVQUFVLEVBQTRCLE1BQU0seUJBQXlCLENBQUM7QUFDL0UsT0FBTyxFQUFFLGdCQUFnQixFQUFFLGdCQUFnQixFQUFFLGVBQWUsRUFBRSxNQUFNLGdDQUFnQyxDQUFDO0FBQ3JHLE9BQU8sRUFBRSxpQkFBaUIsRUFBRSxNQUFNLHFCQUFxQixDQUFDO0FBRXhELE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUN0RCxPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0sbUJBQW1CLENBQUM7QUFFbEQsT0FBTyxFQUFFLFNBQVMsRUFBYyxNQUFNLGdCQUFnQixDQUFDO0FBQ3ZELE9BQU8sRUFBRSw0QkFBNEIsRUFBRSxNQUFNLDBEQUEwRCxDQUFDO0FBQ3hHLE9BQU8sRUFBRSxrQkFBa0IsRUFBRSxNQUFNLHNCQUFzQixDQUFDO0FBRzFELE9BQU8sRUFBRSxpQkFBaUIsRUFBRSxZQUFZLEVBQUUsTUFBTSxrREFBa0QsQ0FBQztBQVlu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LEtBQUs7Ozs7SUFyQk4sOENBQW9EOztJQUNwRCxnREFBd0Q7O0lBQ3hELDhDQUFvRDs7SUFDcEQsa0RBQTREOztJQUM1RCxrREFBNEQ7O0lBQzVELGdEQUF3RDs7SUFDeEQsa0RBQTREOztJQUU1RCw0Q0FBaUQ7O0lBQ2pELDhDQUFzRDs7SUFDdEQsb0RBQXVGOztJQUV2Riw4Q0FBZ0Y7Ozs7O0lBQ2hGLHVEQUE4Qzs7SUFFOUMsMkNBQWtEOztJQUNsRCwrQ0FBMEM7O0lBQzFDLG1EQUErQjs7SUFFL0IsMENBQStCOztJQUUvQixrREFBOEI7Ozs7O0lBRTlCLGtEQUE4Qjs7Ozs7SUFVOUIsb0RBQWdDOztJQVdoQywrQ0FBZ0I7O0lBQ2hCLGtEQUE0Qjs7SUFFNUIsOENBQWU7O0lBQ2YsaURBQTJCOztJQUUzQixvREFBZ0Q7O0lBRWhELGtEQUFzQjs7SUFFdEIsaURBQWlEOzs7OztJQUcvQyx5Q0FBeUI7Ozs7O0lBQ3pCLDRDQUFnQzs7Ozs7SUFDaEMsMkNBQTZCOzs7OztJQUM3Qiw2Q0FBMEI7Ozs7O0lBQzFCLHdDQUEwQzs7Ozs7SUFDMUMsNkNBQTJDOzs7OztJQUMzQyw4Q0FBaUQ7Ozs7O0lBQ2pELCtDQUE0QyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCwgT25Jbml0LCBUZW1wbGF0ZVJlZiwgVmlld0NoaWxkLCBIb3N0QmluZGluZywgSW5wdXQsIFZpZXdDb250YWluZXJSZWYsIENvbXBvbmVudFJlZiwgSW5qZWN0b3IsIENoYW5nZURldGVjdG9yUmVmLCBPcHRpb25hbCwgSW5qZWN0LCBMT0NBTEVfSUQgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgSHR0cFNlcnZpY2UgfSBmcm9tICdAZWNwLWNhZi9jYWYtY29tbW9uJztcclxuaW1wb3J0IHsgSUZvcm1Gb3JtYXRDb25maWdDb21wb25lbnQgfSBmcm9tIFwiQGdzcC13Zi9iaXotcHJvY2Vzcy1hcGlcIjtcclxuaW1wb3J0IHsgT2JzZXJ2YWJsZSwgb2YsIGZvcmtKb2luLCBTdWJqZWN0IH0gZnJvbSAncnhqcyc7XHJcbmltcG9ydCB7IEZvcm1Gb3JtYXQsIEZvcm1GaWVsZERhdGEsIEZvcm1GaWVsZCB9IGZyb20gJy4uL2VudGl0aWVzL2Zvcm0tZm9ybWF0JztcclxuaW1wb3J0IHsgRm9ybUZvcm1hdENvbmZpZywgRm9ybUJ1dHRvbkNvbmZpZywgRm9ybUZpZWxkQ29uZmlnIH0gZnJvbSAnLi4vZW50aXRpZXMvZm9ybS1mb3JtYXQtY29uZmlnJztcclxuaW1wb3J0IHsgRGF0YWdyaWRDb21wb25lbnQgfSBmcm9tICdAZmFycmlzL3VpLWRhdGFncmlkJztcclxuaW1wb3J0IHsgUHJvY2Vzc0RlVXRpbCB9IGZyb20gJy4uLy4uLy4uL2RvbWFpbi9wcm9jZXNzLWRlLXV0aWwnO1xyXG5pbXBvcnQgeyBNZXNzYWdlclNlcnZpY2UgfSBmcm9tICdAZmFycmlzL3VpLW1lc3NhZ2VyJztcclxuaW1wb3J0IHsgTm90aWZ5U2VydmljZSB9IGZyb20gJ0BmYXJyaXMvdWktbm90aWZ5JztcclxuaW1wb3J0IHsgUGlja2VkUmVzdWx0LCBTZXJ2ZXJTaWRlVG9rZW4sIExvb2t1cEdyaWRDb21wb25lbnQgfSBmcm9tICdAZmFycmlzL3VpLWxvb2t1cCc7XHJcbmltcG9ydCB7IHN3aXRjaE1hcCwgY2F0Y2hFcnJvciB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcclxuaW1wb3J0IHsgRm9ybU9wZXJhdGlvbkNvbmZpZ0NvbXBvbmVudCB9IGZyb20gJy4uL2Zvcm0tb3BlcmF0aW9uLWNvbmZpZy9mb3JtLW9wZXJhdGlvbi1jb25maWcuY29tcG9uZW50JztcclxuaW1wb3J0IHsgVHJlZVRhYmxlQ29tcG9uZW50IH0gZnJvbSAnQGZhcnJpcy91aS10cmVldGFibGUnO1xyXG5pbXBvcnQgeyBGb3JtRm9ybWF0VHlwZSB9IGZyb20gJy4uL2VudGl0aWVzL2Zvcm0tZm9ybWF0LXR5cGUnO1xyXG5pbXBvcnQgeyBXRl9QUk9DRVNTX0VESVRPUl9MQU5HX1JFU09VUkNFUyB9IGZyb20gJy4uLy4uLy4uL2kxOG4vYXNzZXRzL2xhbmcucmVzb3VyY2UnO1xyXG5pbXBvcnQgeyBXRl9MQU5HX1JFU09VUkNFUywgV2ZMb2NhbGVQaXBlIH0gZnJvbSAnLi4vLi4vLi4vaTE4bi9waXBlL3dmLXByb2Nlc3MtZWRpdG9yLWxvY2FsZS5waXBlJztcclxuXHJcbmRlY2xhcmUgdmFyIFN5c3RlbTogYW55O1xyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgc2VsZWN0b3I6ICdsaWItZm9ybS1mb3JtYXQtY29uZmlnJyxcclxuICB0ZW1wbGF0ZVVybDogJy4vZm9ybS1mb3JtYXQtY29uZmlnLmNvbXBvbmVudC5odG1sJyxcclxuICBzdHlsZVVybHM6IFsnLi9mb3JtLWZvcm1hdC1jb25maWcuY29tcG9uZW50LnNjc3MnXSxcclxuICBwcm92aWRlcnM6IFtcclxuICAgICBXZkxvY2FsZVBpcGUsXHJcbiAgXVxyXG59KVxyXG5leHBvcnQgY2xhc3MgRm9ybUZvcm1hdENvbmZpZ0NvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCwgSUZvcm1Gb3JtYXRDb25maWdDb21wb25lbnQge1xyXG5cclxuICBAVmlld0NoaWxkKCdidG5FbmFibGUnKSBidG5FbmFibGU6IFRlbXBsYXRlUmVmPGFueT47XHJcbiAgQFZpZXdDaGlsZCgnYnRuRGlzYWJsZWQnKSBidG5EaXNhYmxlZDogVGVtcGxhdGVSZWY8YW55PjtcclxuICBAVmlld0NoaWxkKCdidG5IaWRkZW4nKSBidG5IaWRkZW46IFRlbXBsYXRlUmVmPGFueT47XHJcbiAgQFZpZXdDaGlsZCgnZmllbGRFZGl0YWJsZScpIGZpZWxkRWRpdGFibGU6IFRlbXBsYXRlUmVmPGFueT47XHJcbiAgQFZpZXdDaGlsZCgnZmllbGRSZWFkb25seScpIGZpZWxkUmVhZG9ubHk6IFRlbXBsYXRlUmVmPGFueT47XHJcbiAgQFZpZXdDaGlsZCgnZmllbGRIaWRkZW4nKSBmaWVsZEhpZGRlbjogVGVtcGxhdGVSZWY8YW55PjtcclxuICBAVmlld0NoaWxkKCdmaWVsZFJlcXVpcmVkJykgZmllbGRSZXF1aXJlZDogVGVtcGxhdGVSZWY8YW55PjtcclxuXHJcbiAgQFZpZXdDaGlsZCgnYnRuR3JpZCcpIGJ0bkdyaWQ6IERhdGFncmlkQ29tcG9uZW50O1xyXG4gIEBWaWV3Q2hpbGQoJ2ZpZWxkVHJlZScpIGZpZWxkVHJlZTogVHJlZVRhYmxlQ29tcG9uZW50O1xyXG4gIEBWaWV3Q2hpbGQoRm9ybU9wZXJhdGlvbkNvbmZpZ0NvbXBvbmVudCkgb3BlcmF0aW9uQ29uZmlnOiBGb3JtT3BlcmF0aW9uQ29uZmlnQ29tcG9uZW50O1xyXG5cclxuICBAVmlld0NoaWxkKCdjb250YWluZXInLCB7IHJlYWQ6IFZpZXdDb250YWluZXJSZWYgfSkgY29udGFpbmVyOiBWaWV3Q29udGFpbmVyUmVmO1xyXG4gIHByaXZhdGUgZXh0ZW5kQ29tcG9uZW50UmVmOiBDb21wb25lbnRSZWY8YW55PjtcclxuXHJcbiAgY29uZmlnOiBGb3JtRm9ybWF0Q29uZmlnID0gbmV3IEZvcm1Gb3JtYXRDb25maWcoKTtcclxuICBmb3JtRm9ybWF0OiBGb3JtRm9ybWF0ID0gbmV3IEZvcm1Gb3JtYXQoKTtcclxuICBmb3JtRm9ybWF0VHlwZTogRm9ybUZvcm1hdFR5cGU7XHJcblxyXG4gIHN0YXRlOiAnbmV3JyB8ICdlZGl0JyA9ICdlZGl0JztcclxuXHJcbiAgQElucHV0KCkgc2hvd01ldGhvZFRhYiA9IHRydWU7XHJcblxyXG4gIHByaXZhdGUgX2Zvcm1Gb3JtYXRJZDogc3RyaW5nO1xyXG4gIHNldCBmb3JtRm9ybWF0SWQodjogc3RyaW5nKSB7XHJcbiAgICB0aGlzLl9mb3JtRm9ybWF0SWQgPSB2O1xyXG4gICAgdGhpcy5jb25maWcuZm9ybUZvcm1hdElkID0gdjtcclxuICB9XHJcblxyXG4gIGdldCBmb3JtRm9ybWF0SWQoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fZm9ybUZvcm1hdElkO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBfZm9ybWF0Q29uZmlnSWQ6IHN0cmluZztcclxuICBzZXQgZm9ybWF0Q29uZmlnSWQodjogc3RyaW5nKSB7XHJcbiAgICB0aGlzLl9mb3JtYXRDb25maWdJZCA9IHY7XHJcbiAgICBpZiAoIXYpIHtcclxuICAgICAgdGhpcy5zdGF0ZSA9ICduZXcnO1xyXG4gICAgfVxyXG4gIH1cclxuICBnZXQgZm9ybWF0Q29uZmlnSWQoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fZm9ybWF0Q29uZmlnSWQ7XHJcbiAgfVxyXG5cclxuICBidXR0b25Db2xzID0gW107XHJcbiAgYnV0dG9uQ29uZmlncyA9IG5ldyBBcnJheSgpO1xyXG5cclxuICBmaWVsZENvbHMgPSBbXTtcclxuICBmaWVsZENvbmZpZ3MgPSBuZXcgQXJyYXkoKTtcclxuXHJcbiAgZm9ybWF0RmllbGRMaXN0OiBBcnJheTxGb3JtRmllbGQ+ID0gbmV3IEFycmF5KCk7XHJcblxyXG4gIHNob3dFeHRlbmRUYWIgPSBmYWxzZTtcclxuXHJcbiAgc2VhcmNoRmllbGRzOiB7IGxhYmVsOiBzdHJpbmcsIHZhbHVlOiBzdHJpbmcgfVtdO1xyXG5cclxuICBjb25zdHJ1Y3RvcihcclxuICAgIHByaXZhdGUgaHR0cDogSHR0cFNlcnZpY2UsXHJcbiAgICBwcml2YXRlIG1lc3NhZ2U6IE1lc3NhZ2VyU2VydmljZSxcclxuICAgIHByaXZhdGUgbm90aWZ5OiBOb3RpZnlTZXJ2aWNlLFxyXG4gICAgcHJpdmF0ZSBpbmplY3RvcjogSW5qZWN0b3IsXHJcbiAgICBAT3B0aW9uYWwoKSBwcml2YXRlIGNkcjogQ2hhbmdlRGV0ZWN0b3JSZWYsXHJcbiAgICBASW5qZWN0KExPQ0FMRV9JRCkgcHJpdmF0ZSBsb2NhbGVJZDogc3RyaW5nLFxyXG4gICAgQEluamVjdChXRl9MQU5HX1JFU09VUkNFUykgcHJpdmF0ZSByZXNvdXJjZXM6IGFueSxcclxuICAgIEBPcHRpb25hbCgpIHByaXZhdGUgbG9jYWxlUGlwZTogV2ZMb2NhbGVQaXBlLFxyXG4gICkge1xyXG4gICAgdGhpcy5sb2NhbGVQaXBlID0gdGhpcy5sb2NhbGVQaXBlIHx8IG5ldyBXZkxvY2FsZVBpcGUobG9jYWxlSWQsIHJlc291cmNlcyk7XHJcbiAgICBsZXQgc2VyY2hGaWVsZHMgPSB7XHJcbiAgICAgIGxhYmVsIDogdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybSgnY29tcG9uZW50LmV4ZWN1dGVGb3Jtcy5maWVsZE5hbWUnKSxcclxuICAgICAgdmFsdWUgOiAnZmllbGROYW1lJ1xyXG4gICAgfTtcclxuICAgIGlmKHRoaXMuc2VhcmNoRmllbGRzKSB7XHJcbiAgICAgIGlmKCF0aGlzLnNlYXJjaEZpZWxkcy5zb21lKHggPT4geC52YWx1ZSA9PT0gc2VyY2hGaWVsZHMudmFsdWUpKSB7XHJcbiAgICAgICAgdGhpcy5zZWFyY2hGaWVsZHMgPSB0aGlzLnNlYXJjaEZpZWxkcy5jb25jYXQoc2VyY2hGaWVsZHMpO1xyXG4gICAgICB9XHJcbiAgICB9ZWxzZSB7XHJcbiAgICAgIHRoaXMuc2VhcmNoRmllbGRzID0gW107XHJcbiAgICAgIHRoaXMuc2VhcmNoRmllbGRzID0gdGhpcy5zZWFyY2hGaWVsZHMuY29uY2F0KHNlcmNoRmllbGRzKTtcclxuICAgIH1cclxuXHJcbiAgIH1cclxuXHJcbiAgbmdPbkluaXQoKSB7XHJcbiAgICB0aGlzLmJ1dHRvbkNvbHMgPSBbXHJcbiAgICAgIHsgZmllbGQ6ICdidXR0b25OYW1lJywgd2lkdGg6IDEwMCwgdGl0bGU6IHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oJ2NvbXBvbmVudC5leGVjdXRlRm9ybXMuYnV0dG9uTmFtZScpLCBmaWx0ZXI6IHRydWUgfSxcclxuICAgICAgLy8geyBmaWVsZDogJ2J1dHRvbklkJywgd2lkdGg6IDEwMCwgdGl0bGU6ICfmjInpkq7moIfor4YnIH0sXHJcbiAgICAgIHtcclxuICAgICAgICB0aXRsZTogdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybSgnY29tcG9uZW50LmV4ZWN1dGVGb3Jtcy5lbmFibGUnKSxcclxuICAgICAgICBmaWVsZDogJ2VuYWJsZScsXHJcbiAgICAgICAgd2lkdGg6IDgwLFxyXG4gICAgICAgIHRlbXBsYXRlOiB0aGlzLmJ0bkVuYWJsZSxcclxuICAgICAgICBhbGlnbjogJ2NlbnRlcicsXHJcbiAgICAgICAgaEFsaWduOiAnY2VudGVyJ1xyXG4gICAgICB9LFxyXG4gICAgICB7XHJcbiAgICAgICAgdGl0bGU6IHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oJ2NvbXBvbmVudC5leGVjdXRlRm9ybXMuZGlzYWJsZWQnKSxcclxuICAgICAgICBmaWVsZDogJ2Rpc2FibGVkJyxcclxuICAgICAgICB3aWR0aDogODAsXHJcbiAgICAgICAgdGVtcGxhdGU6IHRoaXMuYnRuRGlzYWJsZWQsXHJcbiAgICAgICAgYWxpZ246ICdjZW50ZXInLFxyXG4gICAgICAgIGhBbGlnbjogJ2NlbnRlcidcclxuICAgICAgfSxcclxuICAgICAge1xyXG4gICAgICAgIHRpdGxlOiB0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKCdjb21wb25lbnQuZXhlY3V0ZUZvcm1zLmhpZGRlbicpLFxyXG4gICAgICAgIGZpZWxkOiAnaGlkZGVuJyxcclxuICAgICAgICB3aWR0aDogODAsXHJcbiAgICAgICAgdGVtcGxhdGU6IHRoaXMuYnRuSGlkZGVuLFxyXG4gICAgICAgIGFsaWduOiAnY2VudGVyJyxcclxuICAgICAgICBoQWxpZ246ICdjZW50ZXInXHJcbiAgICAgIH1dO1xyXG4gICAgdGhpcy5maWVsZENvbHMgPSBbXHJcbiAgICAgIHsgZmllbGQ6ICdmaWVsZE5hbWUnLCB3aWR0aDogMTAwLCB0aXRsZTogdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybSgnY29tcG9uZW50LmV4ZWN1dGVGb3Jtcy5maWVsZE5hbWUnKX0sXHJcbiAgICAgIC8vIHsgZmllbGQ6ICdmaWVsZElkJywgd2lkdGg6IDEwMCwgdGl0bGU6ICflrZfmrrXmoIfor4YnIH0sXHJcbiAgICAgIHtcclxuICAgICAgICB0aXRsZTogdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybSgnY29tcG9uZW50LmV4ZWN1dGVGb3Jtcy5lZGl0YWJsZScpLFxyXG4gICAgICAgIGZpZWxkOiAnZWRpdGFibGUnLFxyXG4gICAgICAgIHdpZHRoOiA4MCxcclxuICAgICAgICB0ZW1wbGF0ZTogdGhpcy5maWVsZEVkaXRhYmxlLFxyXG4gICAgICAgIGFsaWduOiAnY2VudGVyJyxcclxuICAgICAgICBoQWxpZ246ICdjZW50ZXInXHJcbiAgICAgIH0sXHJcbiAgICAgIHtcclxuICAgICAgICB0aXRsZTogdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybSgnY29tcG9uZW50LmV4ZWN1dGVGb3Jtcy5yZWFkb25seScpLFxyXG4gICAgICAgIGZpZWxkOiAncmVhZG9ubHknLFxyXG4gICAgICAgIHdpZHRoOiA4MCxcclxuICAgICAgICB0ZW1wbGF0ZTogdGhpcy5maWVsZFJlYWRvbmx5LFxyXG4gICAgICAgIGFsaWduOiAnY2VudGVyJyxcclxuICAgICAgICBoQWxpZ246ICdjZW50ZXInXHJcbiAgICAgIH0sXHJcbiAgICAgIHtcclxuICAgICAgICB0aXRsZTogdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybSgnY29tcG9uZW50LmV4ZWN1dGVGb3Jtcy5oaWRkZW4nKSxcclxuICAgICAgICBmaWVsZDogJ2hpZGRlbicsXHJcbiAgICAgICAgd2lkdGg6IDgwLFxyXG4gICAgICAgIHRlbXBsYXRlOiB0aGlzLmZpZWxkSGlkZGVuLFxyXG4gICAgICAgIGFsaWduOiAnY2VudGVyJyxcclxuICAgICAgICBoQWxpZ246ICdjZW50ZXInXHJcbiAgICAgIH0sXHJcbiAgICAgIHtcclxuICAgICAgICB0aXRsZTogdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybSgnY29tcG9uZW50LmV4ZWN1dGVGb3Jtcy5yZXF1aXJlZCcpLFxyXG4gICAgICAgIGZpZWxkOiAncmVxdWlyZWQnLFxyXG4gICAgICAgIHdpZHRoOiA4MCxcclxuICAgICAgICB0ZW1wbGF0ZTogdGhpcy5maWVsZFJlcXVpcmVkLFxyXG4gICAgICAgIGFsaWduOiAnY2VudGVyJyxcclxuICAgICAgICBoQWxpZ246ICdjZW50ZXInXHJcbiAgICAgIH1dO1xyXG4gICAgdGhpcy5nZXRDb25maWcoKTtcclxuICB9XHJcblxyXG4gIHN1Ym1pdCgpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgY29uc3Qgc3ViamVjdCA9IG5ldyBTdWJqZWN0PGFueT4oKTtcclxuICAgIHRoaXMudmFsaWRhdG9yKCkuc3Vic2NyaWJlKHJlID0+IHtcclxuICAgICAgaWYgKHJlKSB7XHJcbiAgICAgICAgdGhpcy5zZXRCdG5BbmRGaWVsZENvbmZpZ3MoKTtcclxuICAgICAgICBpZiAodGhpcy5leHRlbmRDb21wb25lbnRSZWYpIHtcclxuICAgICAgICAgIHRoaXMuZXh0ZW5kQ29tcG9uZW50UmVmLmluc3RhbmNlLnN1Ym1pdCgpLnN1YnNjcmliZShjb25maWdJZCA9PiB7XHJcbiAgICAgICAgICAgIGlmIChjb25maWdJZCkge1xyXG4gICAgICAgICAgICAgIHRoaXMuY29uZmlnLmlkID0gY29uZmlnSWQ7XHJcbiAgICAgICAgICAgICAgdGhpcy5zYXZlQ29uZmlnKHRoaXMuY29uZmlnKS5zdWJzY3JpYmUocmUgPT4ge1xyXG4gICAgICAgICAgICAgICAgc3ViamVjdC5uZXh0KHsgcmVzdWx0OiB0cnVlLCBjb25maWdJZDogdGhpcy5jb25maWcuaWQgfSk7XHJcbiAgICAgICAgICAgICAgfSwgZXJyID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMubWVzc2FnZS5lcnJvcih0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKCdjb21wb25lbnQuZXhlY3V0ZUZvcm1zLnNhdmVGYWlsJykpO1xyXG4gICAgICAgICAgICAgICAgc3ViamVjdC5uZXh0KHsgcmVzdWx0OiBmYWxzZSwgY29uZmlnSWQ6IHRoaXMuY29uZmlnLmlkIH0pO1xyXG4gICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgIGlmICh0aGlzLnN0YXRlID09PSAnbmV3JyAmJlxyXG4gICAgICAgICAgICAgICAgdGhpcy5jb25maWcuZm9ybUJ1dHRvbkNvbmZpZ3MubGVuZ3RoID09PSAwICYmXHJcbiAgICAgICAgICAgICAgICB0aGlzLmNvbmZpZy5mb3JtRmllbGRDb25maWdzLmxlbmd0aCA9PT0gMCAmJlxyXG4gICAgICAgICAgICAgICAgdGhpcy5vcGVyYXRpb25Db25maWcub3BlcmF0aW9ucy5sZW5ndGggPT09IDBcclxuICAgICAgICAgICAgICApIHtcclxuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICBzdWJqZWN0Lm5leHQoeyByZXN1bHQ6IHRydWUsIGNvbmZpZ0lkOiBudWxsIH0pO1xyXG4gICAgICAgICAgICAgICAgfSwgMTApO1xyXG4gICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNhdmVDb25maWcodGhpcy5jb25maWcpLnN1YnNjcmliZShyZSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgIHN1YmplY3QubmV4dCh7IHJlc3VsdDogdHJ1ZSwgY29uZmlnSWQ6IHRoaXMuY29uZmlnLmlkIH0pO1xyXG4gICAgICAgICAgICAgICAgfSwgZXJyID0+IHtcclxuICAgICAgICAgICAgICAgICAgdGhpcy5tZXNzYWdlLmVycm9yKHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oJ2NvbXBvbmVudC5leGVjdXRlRm9ybXMuc2F2ZUZhaWwnKSk7XHJcbiAgICAgICAgICAgICAgICAgIHN1YmplY3QubmV4dCh7IHJlc3VsdDogZmFsc2UsIGNvbmZpZ0lkOiB0aGlzLmNvbmZpZy5pZCB9KTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSlcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgaWYgKHRoaXMuc3RhdGUgPT09ICduZXcnICYmXHJcbiAgICAgICAgICB0aGlzLmNvbmZpZy5mb3JtQnV0dG9uQ29uZmlncy5sZW5ndGggPT09IDAgJiZcclxuICAgICAgICAgIHRoaXMuY29uZmlnLmZvcm1GaWVsZENvbmZpZ3MubGVuZ3RoID09PSAwICYmXHJcbiAgICAgICAgICB0aGlzLm9wZXJhdGlvbkNvbmZpZy5vcGVyYXRpb25zLmxlbmd0aCA9PT0gMFxyXG4gICAgICAgICAgKSB7XHJcbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICAgIHN1YmplY3QubmV4dCh7IHJlc3VsdDogdHJ1ZSwgY29uZmlnSWQ6IG51bGwgfSk7XHJcbiAgICAgICAgICAgIH0sIDEwKTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2F2ZUNvbmZpZyh0aGlzLmNvbmZpZykuc3Vic2NyaWJlKHJlID0+IHtcclxuICAgICAgICAgICAgICBzdWJqZWN0Lm5leHQoeyByZXN1bHQ6IHRydWUsIGNvbmZpZ0lkOiB0aGlzLmNvbmZpZy5pZCB9KTtcclxuICAgICAgICAgICAgfSwgZXJyID0+IHtcclxuICAgICAgICAgICAgICB0aGlzLm1lc3NhZ2UuZXJyb3IodGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybSgnY29tcG9uZW50LmV4ZWN1dGVGb3Jtcy5zYXZlRmFpbCcpKTtcclxuICAgICAgICAgICAgICBzdWJqZWN0Lm5leHQoeyByZXN1bHQ6IGZhbHNlLCBjb25maWdJZDogdGhpcy5jb25maWcuaWQgfSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgIHN1YmplY3QubmV4dCh7IHJlc3VsdDogZmFsc2V9KVxyXG4gICAgICAgIH0sIDEwKTtcclxuICAgICAgfVxyXG4gICAgfSlcclxuICAgIHJldHVybiBzdWJqZWN0LmFzT2JzZXJ2YWJsZSgpO1xyXG4gIH1cclxuXHJcblxyXG5cclxuICBzZWFyY2hGaWVsZChkYXRhKSB7XHJcbiAgICBkYXRhLmZpZWxkID0gJ2ZpZWxkTmFtZSc7XHJcbiAgICBsZXQgc2VhcmNoRGF0YSA9IHtcclxuICAgICAgZmllbGQgOiAnZmllbGROYW1lJyxcclxuICAgICAgdmFsdWUgOiBkYXRhLnZhbHVlXHJcbiAgICB9O1xyXG4gICAgdGhpcy5maWVsZFRyZWUuc2VhcmNoRGF0YSA9IHNlYXJjaERhdGE7XHJcbiAgICAvLyB0aGlzLmZpZWxkVHJlZS5zZWFyY2hEYXRhLmZpZWxkID0gJ2ZpZWxkTmFtZSc7XHJcbiAgICBsZXQgc2VyY2hGaWVsZHMgPSB7XHJcbiAgICAgIGxhYmVsIDogdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybSgnY29tcG9uZW50LmV4ZWN1dGVGb3Jtcy5maWVsZE5hbWUnKSxcclxuICAgICAgdmFsdWUgOiAnZmllbGROYW1lJ1xyXG4gICAgfTtcclxuICAgIGlmKHRoaXMuZmllbGRUcmVlLnNlYXJjaEZpZWxkcykge1xyXG4gICAgICBpZighdGhpcy5maWVsZFRyZWUuc2VhcmNoRmllbGRzLnNvbWUoeCA9PiB4LnZhbHVlID09PSBzZXJjaEZpZWxkcy52YWx1ZSkpIHtcclxuICAgICAgICB0aGlzLmZpZWxkVHJlZS5zZWFyY2hGaWVsZHMgPSB0aGlzLmZpZWxkVHJlZS5zZWFyY2hGaWVsZHMuY29uY2F0KHNlcmNoRmllbGRzKTtcclxuICAgICAgfVxyXG4gICAgfWVsc2Uge1xyXG4gICAgICB0aGlzLmZpZWxkVHJlZS5zZWFyY2hGaWVsZHMgPSBbXTtcclxuICAgICAgdGhpcy5maWVsZFRyZWUuc2VhcmNoRmllbGRzID0gdGhpcy5maWVsZFRyZWUuc2VhcmNoRmllbGRzLmNvbmNhdChzZXJjaEZpZWxkcyk7XHJcbiAgICB9XHJcbiAgICB0aGlzLmZpZWxkVHJlZS5zZWFyY2hIYW5kbGUuc2VhcmNoKGRhdGEuZmllbGQsIGRhdGEudmFsdWUsICdjbGllbnQnKTtcclxuICB9XHJcblxyXG4gIGJ0bkNvbmZpZ0NoYW5nZShib29sOiBib29sZWFuLCBmaWVsZDogc3RyaW5nLCBpZDogc3RyaW5nKSB7XHJcbiAgICBpZiAoYm9vbCkge1xyXG4gICAgICBmb3IgKGNvbnN0IGIgb2YgdGhpcy5idXR0b25Db25maWdzKSB7XHJcbiAgICAgICAgaWYgKGIuaWQgPT09IGlkKSB7XHJcbiAgICAgICAgICBzd2l0Y2ggKGZpZWxkKSB7XHJcbiAgICAgICAgICAgIGNhc2UgJ2VuYWJsZSc6XHJcbiAgICAgICAgICAgICAgYi5lbmFibGUgPSBib29sO1xyXG4gICAgICAgICAgICAgIGIuZGlzYWJsZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICBiLmhpZGRlbiA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdkaXNhYmxlZCc6XHJcbiAgICAgICAgICAgICAgYi5kaXNhYmxlZCA9IGJvb2w7XHJcbiAgICAgICAgICAgICAgYi5lbmFibGUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICBiLmhpZGRlbiA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdoaWRkZW4nOlxyXG4gICAgICAgICAgICAgIGIuaGlkZGVuID0gYm9vbDtcclxuICAgICAgICAgICAgICBiLmRpc2FibGVkID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgYi5lbmFibGUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIHRoaXMuYnRuR3JpZC51cGRhdGVSb3coaWQsIGIpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgdGhpcy5idG5HcmlkLmNkLmRldGVjdENoYW5nZXMoKTtcclxuICB9XHJcblxyXG4gIGJ0bkJhdGNoT3BlcmF0ZShvcGVyYXRpb246IHN0cmluZykge1xyXG4gICAgY29uc3QgY2hlY2tlZHMgPSB0aGlzLmJ0bkdyaWQuY2hlY2tlZFJvd3M7XHJcbiAgICBpZiAoY2hlY2tlZHMgJiYgY2hlY2tlZHMubGVuZ3RoID4gMCkge1xyXG4gICAgICBmb3IgKGNvbnN0IGMgb2YgY2hlY2tlZHMpIHtcclxuICAgICAgICB0aGlzLmJ0bkNvbmZpZ0NoYW5nZSh0cnVlLCBvcGVyYXRpb24sIGMuaWQpO1xyXG4gICAgICB9XHJcbiAgICAgIHRoaXMuYnRuR3JpZC5jZC5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLm1lc3NhZ2UuaW5mbyh0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKCdjb21wb25lbnQuZXhlY3V0ZUZvcm1zLmNoZWNrZWRSb3dzJykpXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBidG5CYXRjaFJlc2V0KCkge1xyXG4gICAgY29uc3QgY2hlY2tlZHMgPSB0aGlzLmJ0bkdyaWQuY2hlY2tlZFJvd3M7XHJcbiAgICBpZiAoY2hlY2tlZHMgJiYgY2hlY2tlZHMubGVuZ3RoID4gMCkge1xyXG4gICAgICBmb3IgKGNvbnN0IGMgb2YgY2hlY2tlZHMpIHtcclxuICAgICAgICBjb25zdCBidXR0b24gPSB0aGlzLmZvcm1Gb3JtYXQuZm9ybUJ1dHRvbnMuZmluZChiID0+IGIuaWQgPT09IGMuaWQpO1xyXG4gICAgICAgIGZvciAoY29uc3QgYiBvZiB0aGlzLmJ1dHRvbkNvbmZpZ3MpIHtcclxuICAgICAgICAgIGlmIChiLmlkID09PSBjLmlkKSB7XHJcbiAgICAgICAgICAgIGIuZW5hYmxlID0gYnV0dG9uLmJ1dHRvblN0YXRlID09PSAnRW5hYmxlJyA/IHRydWUgOiBmYWxzZTtcclxuICAgICAgICAgICAgYi5kaXNhYmxlZCA9IGJ1dHRvbi5idXR0b25TdGF0ZSA9PT0gJ0Rpc2FibGVkJyA/IHRydWUgOiBmYWxzZTtcclxuICAgICAgICAgICAgYi5oaWRkZW4gPSBidXR0b24uYnV0dG9uU3RhdGUgPT09ICdIaWRkZW4nID8gdHJ1ZSA6IGZhbHNlO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgdGhpcy5idG5HcmlkLnVwZGF0ZVJvdyhiLmlkLCBiKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgdGhpcy5idG5HcmlkLmNkLmRldGVjdENoYW5nZXMoKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMubWVzc2FnZS5pbmZvKHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oJ2NvbXBvbmVudC5leGVjdXRlRm9ybXMuY2hlY2tlZFJvd3MnKSlcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGZpZWxkQ29uZmlnQ2hhbmdlKGJvb2w6IGJvb2xlYW4sIGZpZWxkOiBzdHJpbmcsIGlkOiBzdHJpbmcsIHNlYXJjaD10cnVlKSB7XHJcbiAgICBpZiAoYm9vbCkge1xyXG4gICAgICB0aGlzLmZpZWxkU3dpdGNoQ2hhbmdlKHRoaXMuZmllbGRDb25maWdzLCBmaWVsZCwgaWQpO1xyXG4gICAgfVxyXG4gICAgaWYgKHNlYXJjaCkge1xyXG4gICAgICB0aGlzLmZpZWxkVHJlZS5zZWFyY2hIYW5kbGVbJ3Jlc2VhcmNoJ10oKTtcclxuICAgIH1cclxuICB9XHJcbiAgcHJpdmF0ZSBmaWVsZFN3aXRjaENoYW5nZShmaWVsZENvbmZpZ3M6IEFycmF5PGFueT4sIGZpZWxkOiBzdHJpbmcsIGlkOiBzdHJpbmcpIHtcclxuICAgIGlmIChmaWVsZENvbmZpZ3MubGVuZ3RoID4gMCkge1xyXG4gICAgICBmb3IgKGNvbnN0IGYgb2YgZmllbGRDb25maWdzKSB7XHJcbiAgICAgICAgaWYgKGYuZGF0YS5pZCA9PT0gaWQpIHtcclxuICAgICAgICAgIHN3aXRjaCAoZmllbGQpIHtcclxuICAgICAgICAgICAgY2FzZSAnZWRpdGFibGUnOlxyXG4gICAgICAgICAgICAgIGYuZGF0YS5lZGl0YWJsZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgZi5kYXRhLnJlYWRvbmx5ID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgZi5kYXRhLmhpZGRlbiA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgIGYuZGF0YS5yZXF1aXJlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdyZWFkb25seSc6XHJcbiAgICAgICAgICAgICAgZi5kYXRhLmVkaXRhYmxlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgZi5kYXRhLnJlYWRvbmx5ID0gdHJ1ZTtcclxuICAgICAgICAgICAgICBmLmRhdGEuaGlkZGVuID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgZi5kYXRhLnJlcXVpcmVkID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ2hpZGRlbic6XHJcbiAgICAgICAgICAgICAgZi5kYXRhLmVkaXRhYmxlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgZi5kYXRhLnJlYWRvbmx5ID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgZi5kYXRhLmhpZGRlbiA9IHRydWU7XHJcbiAgICAgICAgICAgICAgZi5kYXRhLnJlcXVpcmVkID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ3JlcXVpcmVkJzpcclxuICAgICAgICAgICAgICBmLmRhdGEuZWRpdGFibGUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICBmLmRhdGEucmVhZG9ubHkgPSBmYWxzZTtcclxuICAgICAgICAgICAgICBmLmRhdGEuaGlkZGVuID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgZi5kYXRhLnJlcXVpcmVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgaWYgKGYuY2hpbGRyZW4gJiYgZi5jaGlsZHJlbi5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZmllbGRTd2l0Y2hDaGFuZ2UoZi5jaGlsZHJlbiwgZmllbGQsIGlkKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIGZpZWxkQmF0Y2hPcGVyYXRlKG9wZXJhdGlvbjogc3RyaW5nKSB7XHJcbiAgICBjb25zdCBjaGVja2VkcyA9IHRoaXMuZmllbGRUcmVlLmNoZWNrZWRzO1xyXG4gICAgaWYgKGNoZWNrZWRzICYmIGNoZWNrZWRzLmxlbmd0aCA+IDApIHtcclxuICAgICAgZm9yIChjb25zdCBjIG9mIGNoZWNrZWRzKSB7XHJcbiAgICAgICAgdGhpcy5maWVsZENvbmZpZ0NoYW5nZSh0cnVlLCBvcGVyYXRpb24sIGMuZGF0YS5pZCwgZmFsc2UpO1xyXG4gICAgICB9XHJcbiAgICAgIHRoaXMuZmllbGRUcmVlLnNlYXJjaEhhbmRsZVsncmVzZWFyY2gnXSgpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5tZXNzYWdlLmluZm8odGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybSgnY29tcG9uZW50LmV4ZWN1dGVGb3Jtcy5jaGVja2VkcycpKVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgZmllbGRCYXRjaFJlc2V0KCkge1xyXG4gICAgY29uc3QgY2hlY2tlZHMgPSB0aGlzLmZpZWxkVHJlZS5jaGVja2VkcztcclxuICAgIGlmIChjaGVja2VkcyAmJiBjaGVja2Vkcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgIGZvciAoY29uc3QgYyBvZiBjaGVja2Vkcykge1xyXG4gICAgICAgIGNvbnN0IGZpZWxkID0gdGhpcy5mb3JtYXRGaWVsZExpc3QuZmluZChmID0+IGYuaWQgPT09IGMuZGF0YS5pZCk7XHJcbiAgICAgICAgdGhpcy5yZXNldEZpZWxkQ29uZmlnKHRoaXMuZmllbGRDb25maWdzLCBjLmRhdGEuaWQsIGZpZWxkKTtcclxuICAgICAgfVxyXG4gICAgICB0aGlzLmZpZWxkVHJlZS5zZWFyY2hIYW5kbGVbJ3Jlc2VhcmNoJ10oKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMubWVzc2FnZS5pbmZvKHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oJ2NvbXBvbmVudC5leGVjdXRlRm9ybXMuY2hlY2tlZHMnKSlcclxuICAgIH1cclxuICB9XHJcbiAgcmVzZXRGaWVsZENvbmZpZyhmaWVsZENvbmZpZ3M6IEFycmF5PGFueT4sIGlkOiBzdHJpbmcsIGZpZWxkOiBGb3JtRmllbGQpIHtcclxuICAgIGlmIChmaWVsZENvbmZpZ3MubGVuZ3RoID4gMCkge1xyXG4gICAgICBmb3IgKGNvbnN0IGYgb2YgZmllbGRDb25maWdzKSB7XHJcbiAgICAgICAgaWYgKGYubGVhZiA9PT0gdHJ1ZSAmJiBmLmRhdGEuaWQgPT09IGlkKSB7XHJcbiAgICAgICAgICBmLmRhdGEuZWRpdGFibGUgPSBmaWVsZC5maWVsZFN0YXRlID09PSAnRWRpdGFibGUnID8gdHJ1ZSA6IGZhbHNlO1xyXG4gICAgICAgICAgZi5kYXRhLnJlYWRvbmx5ID0gZmllbGQuZmllbGRTdGF0ZSA9PT0gJ1JlYWRvbmx5JyA/IHRydWUgOiBmYWxzZTtcclxuICAgICAgICAgIGYuZGF0YS5oaWRkZW4gPSBmaWVsZC5maWVsZFN0YXRlID09PSAnSGlkZGVuJyA/IHRydWUgOiBmYWxzZTtcclxuICAgICAgICAgIGYuZGF0YS5yZXF1aXJlZCA9IGZpZWxkLmZpZWxkU3RhdGUgPT09ICdSZXF1aXJlZCcgPyB0cnVlIDogZmFsc2U7XHJcbiAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGlmIChmLmNoaWxkcmVuICYmIGYuY2hpbGRyZW4ubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICB0aGlzLnJlc2V0RmllbGRDb25maWcoZi5jaGlsZHJlbiwgaWQsIGZpZWxkKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgdmFsaWRhdG9yKCk6IE9ic2VydmFibGU8Ym9vbGVhbj4ge1xyXG4gICAgaWYgKHRoaXMuZXh0ZW5kQ29tcG9uZW50UmVmKSB7XHJcbiAgICAgIGNvbnN0IHJlc3VsdCQgPSB0aGlzLmV4dGVuZENvbXBvbmVudFJlZi5pbnN0YW5jZS52YWxpZGF0b3IoKTtcclxuICAgICAgaWYgKHJlc3VsdCQgaW5zdGFuY2VvZiBPYnNlcnZhYmxlKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdCQucGlwZShcclxuICAgICAgICAgIHN3aXRjaE1hcCgoYjogYm9vbGVhbikgPT4ge1xyXG4gICAgICAgICAgICBpZiAoYiAmJiB0aGlzLmlubmVyVmFsaWRhdG9yKCkpIHtcclxuICAgICAgICAgICAgICByZXR1cm4gb2YodHJ1ZSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgcmV0dXJuIG9mKGZhbHNlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSkpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGlmIChyZXN1bHQkKSB7XHJcbiAgICAgICAgICByZXR1cm4gb2YodGhpcy5pbm5lclZhbGlkYXRvcigpKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgcmV0dXJuIG9mKGZhbHNlKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJldHVybiBvZih0aGlzLmlubmVyVmFsaWRhdG9yKCkpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBpbm5lclZhbGlkYXRvcigpOiBib29sZWFuICB7XHJcbiAgICByZXR1cm4gdGhpcy5vcGVyYXRpb25Db25maWcudmFsaWRhdG9yKCk7XHJcbiAgfVxyXG5cclxuXHJcbiAgcHJpdmF0ZSBzZXRCdG5BbmRGaWVsZENvbmZpZ3MoKSB7XHJcbiAgICB0aGlzLmNvbmZpZy5mb3JtQnV0dG9uQ29uZmlncyA9IG5ldyBBcnJheTxGb3JtQnV0dG9uQ29uZmlnPigpO1xyXG4gICAgZm9yIChjb25zdCBidG4gb2YgdGhpcy5idXR0b25Db25maWdzKSB7XHJcbiAgICAgIGNvbnN0IGJ1dHRvbiA9IHRoaXMuZm9ybUZvcm1hdC5mb3JtQnV0dG9ucy5maW5kKGIgPT4gYi5idXR0b25JZCA9PT0gYnRuLmJ1dHRvbklkKTtcclxuICAgICAgY29uc3QgYnRuQ29uZmlnID0gbmV3IEZvcm1CdXR0b25Db25maWcoKTtcclxuICAgICAgYnRuQ29uZmlnLmJ1dHRvbklkID0gYnRuLmJ1dHRvbklkO1xyXG4gICAgICBpZiAoYnRuLmVuYWJsZSkge1xyXG4gICAgICAgIGJ0bkNvbmZpZy5idXR0b25TdGF0ZSA9ICdFbmFibGUnO1xyXG4gICAgICB9IGVsc2UgaWYgKGJ0bi5kaXNhYmxlZCkge1xyXG4gICAgICAgIGJ0bkNvbmZpZy5idXR0b25TdGF0ZSA9ICdEaXNhYmxlZCc7XHJcbiAgICAgIH0gZWxzZSBpZiAoYnRuLmhpZGRlbikge1xyXG4gICAgICAgIGJ0bkNvbmZpZy5idXR0b25TdGF0ZSA9ICdIaWRkZW4nO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICB9XHJcbiAgICAgIGlmICghYnV0dG9uLmJ1dHRvblN0YXRlICYmIGJ0bkNvbmZpZy5idXR0b25TdGF0ZSkge1xyXG4gICAgICAgIHRoaXMuY29uZmlnLmZvcm1CdXR0b25Db25maWdzLnB1c2goYnRuQ29uZmlnKTtcclxuICAgICAgfVxyXG4gICAgICBpZiAoYnV0dG9uLmJ1dHRvblN0YXRlICYmIGJ1dHRvbi5idXR0b25TdGF0ZSAhPT0gYnRuQ29uZmlnLmJ1dHRvblN0YXRlKSB7XHJcbiAgICAgICAgdGhpcy5jb25maWcuZm9ybUJ1dHRvbkNvbmZpZ3MucHVzaChidG5Db25maWcpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICB0aGlzLmNvbmZpZy5mb3JtRmllbGRDb25maWdzID0gbmV3IEFycmF5PEZvcm1GaWVsZENvbmZpZz4oKTtcclxuICAgIHRoaXMuZ2V0RmllbGRDb25maWdzKHRoaXMuZmllbGRDb25maWdzKTtcclxuXHJcbiAgICB0aGlzLmNvbmZpZy5mb3JtTWV0aG9kQ29uZmlncyA9IHRoaXMub3BlcmF0aW9uQ29uZmlnLm9wZXJhdGlvbnMgfHwgbmV3IEFycmF5KCk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGdldEZpZWxkQ29uZmlncyhmaWVsZENvbmZpZ3M6IEFycmF5PGFueT4pIHtcclxuICAgIGlmIChmaWVsZENvbmZpZ3MgJiYgZmllbGRDb25maWdzLmxlbmd0aCA+IDApIHtcclxuICAgICAgZm9yIChjb25zdCBmIG9mIGZpZWxkQ29uZmlncykge1xyXG4gICAgICAgIGlmIChmLmNoaWxkcmVuICYmIGYuY2hpbGRyZW4ubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgdGhpcy5nZXRGaWVsZENvbmZpZ3MoZi5jaGlsZHJlbik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChmLmxlYWYgPT09IGZhbHNlKSB7XHJcbiAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgZmllbGQgPSB0aGlzLmZvcm1hdEZpZWxkTGlzdC5maW5kKGZkID0+IGZkLmZpZWxkSWQgPT09IGYuZGF0YS5maWVsZElkKTtcclxuICAgICAgICBjb25zdCBmaWVsZENvbmZpZyA9IG5ldyBGb3JtRmllbGRDb25maWcoKTtcclxuICAgICAgICBmaWVsZENvbmZpZy5maWVsZElkID0gZi5kYXRhLmZpZWxkSWQ7XHJcbiAgICAgICAgaWYgKGYuZGF0YS5lZGl0YWJsZSkge1xyXG4gICAgICAgICAgZmllbGRDb25maWcuZmllbGRTdGF0ZSA9ICdFZGl0YWJsZSc7XHJcbiAgICAgICAgfSBlbHNlIGlmIChmLmRhdGEucmVhZG9ubHkpIHtcclxuICAgICAgICAgIGZpZWxkQ29uZmlnLmZpZWxkU3RhdGUgPSAnUmVhZG9ubHknO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoZi5kYXRhLmhpZGRlbikge1xyXG4gICAgICAgICAgZmllbGRDb25maWcuZmllbGRTdGF0ZSA9ICdIaWRkZW4nO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoZi5kYXRhLnJlcXVpcmVkKSB7XHJcbiAgICAgICAgICBmaWVsZENvbmZpZy5maWVsZFN0YXRlID0gJ1JlcXVpcmVkJztcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoIWZpZWxkLmZpZWxkU3RhdGUgJiYgZmllbGRDb25maWcuZmllbGRTdGF0ZSkge1xyXG4gICAgICAgICAgdGhpcy5jb25maWcuZm9ybUZpZWxkQ29uZmlncy5wdXNoKGZpZWxkQ29uZmlnKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChmaWVsZC5maWVsZFN0YXRlICYmIGZpZWxkLmZpZWxkU3RhdGUgIT09IGZpZWxkQ29uZmlnLmZpZWxkU3RhdGUpIHtcclxuICAgICAgICAgIHRoaXMuY29uZmlnLmZvcm1GaWVsZENvbmZpZ3MucHVzaChmaWVsZENvbmZpZyk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGdldENvbmZpZygpIHtcclxuICAgIGlmICh0aGlzLmZvcm1Gb3JtYXRJZCkge1xyXG4gICAgICBmb3JrSm9pbih0aGlzLmdldEZvcm1Gb3JtYXRUeXBlKCksIHRoaXMuZ2V0Rm9ybUZvcm1hdCgpLCB0aGlzLmdldEZvcm1Gb3JtYXRDb25maWcoKSkuc3Vic2NyaWJlKChyZTogYW55W10pID0+IHtcclxuICAgICAgICBjb25zdCBmb3JtRm9ybWF0VHlwZSA9IHJlWzBdIGFzIEZvcm1Gb3JtYXRUeXBlO1xyXG4gICAgICAgIGlmIChmb3JtRm9ybWF0VHlwZSkge1xyXG4gICAgICAgICAgdGhpcy5mb3JtRm9ybWF0VHlwZSA9IGZvcm1Gb3JtYXRUeXBlO1xyXG4gICAgICAgICAgaWYgKHRoaXMuZm9ybUZvcm1hdFR5cGUuZXh0ZW5kSW1wbCkge1xyXG4gICAgICAgICAgICB0aGlzLnNob3dFeHRlbmRUYWIgPSB0cnVlO1xyXG4gICAgICAgICAgICB0aGlzLmNyZWF0ZUV4dGVuZENvbXBvbmVudCh0aGlzLmZvcm1Gb3JtYXRUeXBlLmV4dGVuZEltcGwpO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5zaG93RXh0ZW5kVGFiID0gZmFsc2U7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IGZvcm1Gb3JtYXQgPSByZVsxXSBhcyBGb3JtRm9ybWF0O1xyXG4gICAgICAgIGlmIChmb3JtRm9ybWF0KSB7XHJcbiAgICAgICAgICB0aGlzLmZvcm1Gb3JtYXQgPSB0aGlzLmNvbnZlcnRGb3JtRm9ybWF0KGZvcm1Gb3JtYXQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBjb25maWcgPSByZVsyXSBhcyBGb3JtRm9ybWF0Q29uZmlnO1xyXG4gICAgICAgIGlmIChjb25maWcpIHtcclxuICAgICAgICAgIHRoaXMuY29uZmlnID0gY29uZmlnO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5mb3JtRm9ybWF0LmZvcm1CdXR0b25zKSB7XHJcbiAgICAgICAgICB0aGlzLmJ1dHRvbkNvbmZpZ3MgPSB0aGlzLmZvcm1Gb3JtYXQuZm9ybUJ1dHRvbnMubWFwKGIgPT4gT2JqZWN0LmFzc2lnbih7fSwgYiwge1xyXG4gICAgICAgICAgICBlbmFibGU6IGIuYnV0dG9uU3RhdGUgPT09ICdFbmFibGUnID8gdHJ1ZSA6IGZhbHNlLFxyXG4gICAgICAgICAgICBkaXNhYmxlZDogYi5idXR0b25TdGF0ZSA9PT0gJ0Rpc2FibGVkJyA/IHRydWUgOiBmYWxzZSxcclxuICAgICAgICAgICAgaGlkZGVuOiBiLmJ1dHRvblN0YXRlID09PSAnSGlkZGVuJyA/IHRydWUgOiBmYWxzZVxyXG4gICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgbGV0IGJ0bkNvbmZpZ3MgPSBuZXcgQXJyYXk8Rm9ybUJ1dHRvbkNvbmZpZz4oKTtcclxuICAgICAgICAgIGlmIChjb25maWcgJiYgY29uZmlnLmZvcm1CdXR0b25Db25maWdzKSB7XHJcbiAgICAgICAgICAgIGJ0bkNvbmZpZ3MgPSBjb25maWcuZm9ybUJ1dHRvbkNvbmZpZ3M7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBmb3IgKGNvbnN0IGIgb2YgYnRuQ29uZmlncykge1xyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IGJ0biBvZiB0aGlzLmJ1dHRvbkNvbmZpZ3MpIHtcclxuICAgICAgICAgICAgICBpZiAoYnRuLmJ1dHRvbklkID09PSBiLmJ1dHRvbklkKSB7XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKGIuYnV0dG9uU3RhdGUpIHtcclxuICAgICAgICAgICAgICAgICAgY2FzZSAnRW5hYmxlJzpcclxuICAgICAgICAgICAgICAgICAgICBidG4uZW5hYmxlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICBidG4uZGlzYWJsZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICBidG4uaGlkZGVuID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgIGNhc2UgJ0Rpc2FibGVkJzpcclxuICAgICAgICAgICAgICAgICAgICBidG4uZW5hYmxlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgYnRuLmRpc2FibGVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICBidG4uaGlkZGVuID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgIGNhc2UgJ0hpZGRlbic6XHJcbiAgICAgICAgICAgICAgICAgICAgYnRuLmVuYWJsZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIGJ0bi5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIGJ0bi5oaWRkZW4gPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLmZvcm1Gb3JtYXQuZm9ybUZpZWxkcykge1xyXG4gICAgICAgICAgdGhpcy5maWVsZENvbmZpZ3MgPSBbLi4udGhpcy5mb3JtRm9ybWF0LmZvcm1GaWVsZHNdO1xyXG4gICAgICAgICAgdGhpcy5vcmdGaWVsZENvbmZpZ3ModGhpcy5maWVsZENvbmZpZ3MpO1xyXG4gICAgICAgICAgbGV0IGNvbmZpZ3MgPSBuZXcgQXJyYXk8Rm9ybUZpZWxkQ29uZmlnPigpO1xyXG4gICAgICAgICAgaWYgKGNvbmZpZyAmJiBjb25maWcuZm9ybUZpZWxkQ29uZmlncykge1xyXG4gICAgICAgICAgICBjb25maWdzID0gY29uZmlnLmZvcm1GaWVsZENvbmZpZ3M7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBmb3IgKGNvbnN0IGYgb2YgY29uZmlncykge1xyXG4gICAgICAgICAgICB0aGlzLnNldEZpZWxkQ29uZmlnKHRoaXMuZmllbGRDb25maWdzLCBmKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgY3JlYXRlRXh0ZW5kQ29tcG9uZW50KGV4dGVuZEltcGw6IHN0cmluZykge1xyXG4gICAgY29uc3QgdXJsID0gZXh0ZW5kSW1wbC5zcGxpdCgnIycpWzBdO1xyXG4gICAgY29uc3Qgc2VsZWN0b3JDbXAgPSBleHRlbmRJbXBsLnNwbGl0KCcjJylbMV07XHJcbiAgICBTeXN0ZW0uaW1wb3J0KHVybClcclxuICAgICAgLnRoZW4oKG1vZHVsZUZhY3RvcnlzOiBhbnkpID0+IHtcclxuICAgICAgICBjb25zdCBtb2R1bGVGYWN0b3J5OiBhbnkgPSBPYmplY3QudmFsdWVzKG1vZHVsZUZhY3RvcnlzKVswXTtcclxuICAgICAgICBjb25zdCBtb2R1bGVSZWYgPSBtb2R1bGVGYWN0b3J5LmNyZWF0ZSh0aGlzLmluamVjdG9yKTtcclxuICAgICAgICBpZiAoc2VsZWN0b3JDbXApIHtcclxuICAgICAgICAgIGxldCBmYWNNYXA6IE1hcDxhbnksIGFueT4gPSBtb2R1bGVSZWYuY29tcG9uZW50RmFjdG9yeVJlc29sdmVyWydfZmFjdG9yaWVzJ107XHJcbiAgICAgICAgICBmYWNNYXAuZm9yRWFjaCgodmFsdWU6IGFueSwga2V5OiBGdW5jdGlvbiwgbWFwOiBNYXA8YW55LCBhbnk+KSA9PiB7XHJcbiAgICAgICAgICAgICAgY29uc3Qgc2VsZWN0b3IgPSB2YWx1ZS5zZWxlY3RvcjtcclxuICAgICAgICAgICAgICBpZiAoc2VsZWN0b3JDbXAgPT0gc2VsZWN0b3IpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGNtcEZhY3RvcnkgPSBtb2R1bGVSZWYuY29tcG9uZW50RmFjdG9yeVJlc29sdmVyLnJlc29sdmVDb21wb25lbnRGYWN0b3J5KGtleSBhcyBhbnkpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5leHRlbmRDb21wb25lbnRSZWYgPSBjbXBGYWN0b3J5LmNyZWF0ZShtb2R1bGVSZWYuaW5qZWN0b3IpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5leHRlbmRDb21wb25lbnRSZWYuaW5zdGFuY2UuZm9ybUZvcm1hdElkID0gdGhpcy5mb3JtRm9ybWF0SWQ7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmV4dGVuZENvbXBvbmVudFJlZi5pbnN0YW5jZS5mb3JtYXRDb25maWdJZCA9IHRoaXMuZm9ybWF0Q29uZmlnSWQ7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNvbnRhaW5lci5jbGVhcigpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jb250YWluZXIuaW5zZXJ0KHRoaXMuZXh0ZW5kQ29tcG9uZW50UmVmLmhvc3RWaWV3KTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgY29uc3QgYm9vdHN0cmFwQ29tcG9uZW50ID0gbW9kdWxlUmVmWydfYm9vdHN0cmFwQ29tcG9uZW50cyddWzBdO1xyXG4gICAgICAgICAgaWYgKGJvb3RzdHJhcENvbXBvbmVudCkvL+WFiOaJvmJvb3RzdHJhcENvbXBvbmVudOaVsOe7hOacieaXoOe7hOS7tlxyXG4gICAgICAgICAge1xyXG4gICAgICAgICAgICBjb25zdCBjbXBGYWN0b3J5ID0gbW9kdWxlUmVmLmNvbXBvbmVudEZhY3RvcnlSZXNvbHZlci5yZXNvbHZlQ29tcG9uZW50RmFjdG9yeShib290c3RyYXBDb21wb25lbnQpO1xyXG4gICAgICAgICAgICB0aGlzLmV4dGVuZENvbXBvbmVudFJlZiA9IGNtcEZhY3RvcnkuY3JlYXRlKG1vZHVsZVJlZi5pbmplY3Rvcik7XHJcbiAgICAgICAgICAgIHRoaXMuZXh0ZW5kQ29tcG9uZW50UmVmLmluc3RhbmNlLmZvcm1Gb3JtYXRJZCA9IHRoaXMuZm9ybUZvcm1hdElkO1xyXG4gICAgICAgICAgICB0aGlzLmV4dGVuZENvbXBvbmVudFJlZi5pbnN0YW5jZS5mb3JtYXRDb25maWdJZCA9IHRoaXMuZm9ybWF0Q29uZmlnSWQ7XHJcbiAgICAgICAgICAgIHRoaXMuY29udGFpbmVyLmNsZWFyKCk7XHJcbiAgICAgICAgICAgIHRoaXMuY29udGFpbmVyLmluc2VydCh0aGlzLmV4dGVuZENvbXBvbmVudFJlZi5ob3N0Vmlldyk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIG9yZ0ZpZWxkQ29uZmlncyhmb3JtRmllbGRzOiBBcnJheTxGb3JtRmllbGREYXRhPikge1xyXG4gICAgaWYgKGZvcm1GaWVsZHMubGVuZ3RoID4gMCkge1xyXG4gICAgICBmb3IgKGNvbnN0IGQgb2YgZm9ybUZpZWxkcykge1xyXG4gICAgICAgIGQuZGF0YSA9IE9iamVjdC5hc3NpZ24oe30sIGQuZGF0YSwge1xyXG4gICAgICAgICAgZWRpdGFibGU6IGQuZGF0YS5maWVsZFN0YXRlID09PSAnRWRpdGFibGUnID8gdHJ1ZSA6IGZhbHNlLFxyXG4gICAgICAgICAgcmVhZG9ubHk6IGQuZGF0YS5maWVsZFN0YXRlID09PSAnUmVhZG9ubHknID8gdHJ1ZSA6IGZhbHNlLFxyXG4gICAgICAgICAgaGlkZGVuOiBkLmRhdGEuZmllbGRTdGF0ZSA9PT0gJ0hpZGRlbicgPyB0cnVlIDogZmFsc2UsXHJcbiAgICAgICAgICByZXF1aXJlZDogZC5kYXRhLmZpZWxkU3RhdGUgPT09ICdSZXF1aXJlZCcgPyB0cnVlIDogZmFsc2VcclxuICAgICAgICB9KTtcclxuICAgICAgICBpZiAoZC5jaGlsZHJlbiAmJiBkLmNoaWxkcmVuKSB7XHJcbiAgICAgICAgICB0aGlzLm9yZ0ZpZWxkQ29uZmlncyhkLmNoaWxkcmVuKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgc2V0RmllbGRDb25maWcoZmllbGRDb25maWdzOiBBcnJheTxhbnk+LCBjb25maWc6IEZvcm1GaWVsZENvbmZpZykge1xyXG4gICAgaWYgKGZpZWxkQ29uZmlncy5sZW5ndGggPiAwKSB7XHJcbiAgICAgIGZvciAoY29uc3QgZiBvZiBmaWVsZENvbmZpZ3MpIHtcclxuICAgICAgICBpZiAoZi5kYXRhLmZpZWxkSWQgPT09IGNvbmZpZy5maWVsZElkKSB7XHJcbiAgICAgICAgICBzd2l0Y2ggKGNvbmZpZy5maWVsZFN0YXRlKSB7XHJcbiAgICAgICAgICAgIGNhc2UgJ0VkaXRhYmxlJzpcclxuICAgICAgICAgICAgICBmLmRhdGEuZWRpdGFibGUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgIGYuZGF0YS5yZWFkb25seSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgIGYuZGF0YS5oaWRkZW4gPSBmYWxzZTtcclxuICAgICAgICAgICAgICBmLmRhdGEucmVxdWlyZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAnUmVhZG9ubHknOlxyXG4gICAgICAgICAgICAgIGYuZGF0YS5lZGl0YWJsZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgIGYuZGF0YS5yZWFkb25seSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgZi5kYXRhLmhpZGRlbiA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgIGYuZGF0YS5yZXF1aXJlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdIaWRkZW4nOlxyXG4gICAgICAgICAgICAgIGYuZGF0YS5lZGl0YWJsZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgIGYuZGF0YS5yZWFkb25seSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgIGYuZGF0YS5oaWRkZW4gPSB0cnVlO1xyXG4gICAgICAgICAgICAgIGYuZGF0YS5yZXF1aXJlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdSZXF1aXJlZCc6XHJcbiAgICAgICAgICAgICAgZi5kYXRhLmVkaXRhYmxlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgZi5kYXRhLnJlYWRvbmx5ID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgZi5kYXRhLmhpZGRlbiA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgIGYuZGF0YS5yZXF1aXJlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGlmIChmLmNoaWxkcmVuICYmIGYuY2hpbGRyZW4ubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICB0aGlzLnNldEZpZWxkQ29uZmlnKGYuY2hpbGRyZW4sIGNvbmZpZyk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHNhdmVDb25maWcoY29uZmlnOiBGb3JtRm9ybWF0Q29uZmlnKTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgIGNvbnN0IHVybCA9ICcvYXBpL3J1bnRpbWUvd2YvdjEuMC9mb3JtRm9ybWF0Q29uZmlnJztcclxuICAgIHJldHVybiB0aGlzLmh0dHAucG9zdCh1cmwsIGNvbmZpZyk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGdldEZvcm1Gb3JtYXQoKTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgIGlmICh0aGlzLmZvcm1Gb3JtYXRJZCkge1xyXG4gICAgICBsZXQgdXJsID0gYC9hcGkvcnVudGltZS93Zi92MS4wL2Zvcm1Gb3JtYXQvJHt0aGlzLmZvcm1Gb3JtYXRJZH1gO1xyXG4gICAgICB1cmwgPSBlbmNvZGVVUkkodXJsKTtcclxuICAgICAgcmV0dXJuIHRoaXMuaHR0cC5nZXQodXJsKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJldHVybiBvZihudWxsKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgZ2V0Rm9ybUZvcm1hdFR5cGUoKTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgIGlmICh0aGlzLmZvcm1Gb3JtYXRJZCkge1xyXG4gICAgICBjb25zdCB1cmwgPSBgL2FwaS9ydW50aW1lL3dmL3YxLjAvZm9ybUZvcm1hdFR5cGUvZm9ybUZvcm1hdD9mb3JtRm9ybWF0PSR7dGhpcy5mb3JtRm9ybWF0SWR9YDtcclxuICAgICAgcmV0dXJuIHRoaXMuaHR0cC5nZXQodXJsKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgZ2V0Rm9ybUZvcm1hdENvbmZpZygpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgaWYgKHRoaXMuZm9ybWF0Q29uZmlnSWQpIHtcclxuICAgICAgbGV0IHVybCA9IGAvYXBpL3J1bnRpbWUvd2YvdjEuMC9mb3JtRm9ybWF0Q29uZmlnLyR7dGhpcy5mb3JtYXRDb25maWdJZH1gO1xyXG4gICAgICB1cmwgPSBlbmNvZGVVUkkodXJsKTtcclxuICAgICAgcmV0dXJuIHRoaXMuaHR0cC5nZXQodXJsKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJldHVybiBvZihudWxsKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgY29udmVydEZvcm1Gb3JtYXQoZm9ybUZvcm1hdDogRm9ybUZvcm1hdCk6IEZvcm1Gb3JtYXQge1xyXG4gICAgaWYgKCFmb3JtRm9ybWF0LnN0YXR1cykge1xyXG4gICAgICBmb3JtRm9ybWF0LnN0YXR1cyA9IDA7XHJcbiAgICB9XHJcbiAgICB0aGlzLmNvbnZlcnRmb3JtRmllbGRzKGZvcm1Gb3JtYXQuZm9ybUZpZWxkcyk7XHJcbiAgICB0aGlzLmdldEZvcm1hdEZpZWxkTGlzdChmb3JtRm9ybWF0LmZvcm1GaWVsZHMsIHRoaXMuZm9ybWF0RmllbGRMaXN0KTtcclxuICAgIHJldHVybiBmb3JtRm9ybWF0O1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBjb252ZXJ0Zm9ybUZpZWxkcyhmb3JtRmllbGRzOiBBcnJheTxGb3JtRmllbGREYXRhPikge1xyXG4gICAgaWYgKGZvcm1GaWVsZHMgJiYgZm9ybUZpZWxkcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgIGZvciAoY29uc3QgZCBvZiBmb3JtRmllbGRzKSB7XHJcbiAgICAgICAgaWYgKHR5cGVvZihkLmxlYWYpICE9PSAnYm9vbGVhbicgJiYgKGQubGVhZiA9PSBudWxsIHx8IGQubGVhZiA9PT0gdW5kZWZpbmVkKSkge1xyXG4gICAgICAgICAgZC5sZWFmID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGQuY2hpbGRyZW4gJiYgZC5jaGlsZHJlbikge1xyXG4gICAgICAgICAgdGhpcy5vcmdGaWVsZENvbmZpZ3MoZC5jaGlsZHJlbik7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGdldEZvcm1hdEZpZWxkTGlzdChmb3JtRmllbGRzOiBBcnJheTxGb3JtRmllbGREYXRhPiwgYXJyYXk6IEFycmF5PEZvcm1GaWVsZD4pIHtcclxuICAgIGlmIChmb3JtRmllbGRzICYmIGZvcm1GaWVsZHMubGVuZ3RoID4gMCkge1xyXG4gICAgICBmb3IgKGNvbnN0IGQgb2YgZm9ybUZpZWxkcykge1xyXG4gICAgICAgIGFycmF5LnB1c2goZC5kYXRhKTtcclxuICAgICAgICBpZiAoZC5jaGlsZHJlbiAmJiBkLmNoaWxkcmVuKSB7XHJcbiAgICAgICAgICB0aGlzLmdldEZvcm1hdEZpZWxkTGlzdChkLmNoaWxkcmVuLCBhcnJheSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGdldEZvcm1hdEZpZWxkKGZvcm1GaWVsZHM6IEFycmF5PEZvcm1GaWVsZERhdGE+LCBmaWVsZElkOiBzdHJpbmcpOiBGb3JtRmllbGREYXRhIHtcclxuICAgIGZvciAoY29uc3QgZiBvZiBmb3JtRmllbGRzKSB7XHJcbiAgICAgIGlmIChmLmRhdGEuZmllbGRJZCA9PT0gZmllbGRJZCkge1xyXG4gICAgICAgIHJldHVybiBmO1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChmLmNoaWxkcmVuICYmIGYuY2hpbGRyZW4ubGVuZ3RoID4gMCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmdldEZvcm1hdEZpZWxkKGYuY2hpbGRyZW4sIGZpZWxkSWQpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gIH1cclxuXHJcbn1cclxuIl19