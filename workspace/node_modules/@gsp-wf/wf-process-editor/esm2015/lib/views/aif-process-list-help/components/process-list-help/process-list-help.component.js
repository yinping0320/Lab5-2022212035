/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, ViewChild, TemplateRef, EventEmitter, Inject, LOCALE_ID, Output, Input } from '@angular/core';
import { ProcessListHelpService } from '../../services/process-list-help.service';
import { MessagerService } from '@farris/ui-messager';
import { NotifyService } from '@farris/ui-notify';
import { BsModalService } from '@farris/ui-modal';
import { FrameworkService } from '@gsp-sys/rtf-common';
import { Router, ActivatedRoute } from '@angular/router';
import { LoadingService } from '@farris/ui-loading';
import { of } from 'rxjs';
import { switchMap, catchError } from 'rxjs/operators';
import { BifMetadataType } from '../../entity/BifMetadataType';
import { ProcessFilterConditionArgs } from '../../entity/ProcessFilterConditionArgs';
import { TextValue } from '@edp-bif/common-api';
import { OrderByDirection } from '../../entity/OrderByDirection';
import { DatagridComponent } from '@farris/ui-datagrid';
import { AifLocalePipe, BIF_LANG_RESOURCES } from '../../../aif-ui-common/pipe/aif-ui-common-locale.pipe';
import { AIF_PROCESS_LIST_HELP_LANG_RESOURCES } from '../../i18n/lang.resource';
const ɵ0 = AIF_PROCESS_LIST_HELP_LANG_RESOURCES;
export class ProcessListHelpComponent {
    /**
     * @param {?} procHelpService
     * @param {?} messager
     * @param {?} notify
     * @param {?} modalService
     * @param {?} frameworkService
     * @param {?} router
     * @param {?} activatedRoute
     * @param {?} loading
     * @param {?} localeId
     * @param {?} localePipe
     */
    constructor(procHelpService, messager, notify, modalService, frameworkService, router, activatedRoute, loading, localeId, localePipe) {
        this.procHelpService = procHelpService;
        this.messager = messager;
        this.notify = notify;
        this.modalService = modalService;
        this.frameworkService = frameworkService;
        this.router = router;
        this.activatedRoute = activatedRoute;
        this.loading = loading;
        this.localePipe = localePipe;
        this.closeModal = new EventEmitter();
        this.submitModal = new EventEmitter();
        this.editorParams = {};
        this.modalConfig = {
            title: this.localePipe.transform("creationProcess"),
            width: 1250,
            height: 500,
            showButtons: true
        };
        this.procEmitter = new EventEmitter();
        this.ttIdField = "id";
        this.ttData = [];
        this.ttColumns = [];
        this.cascadeCheck = false;
        this.cascadeDown = false;
        this.cascadeUp = false;
        this.defaultPageSize = 30;
        this.pageList = [this.defaultPageSize, 50, 100, 200, 500];
        /**
         * 已设置流程
         */
        this.setProcess = {
            showText: ""
        };
        this.queryParam = this.createDefaultQueryParam();
    }
    /**
     * @param {?} data
     * @return {?}
     */
    set value(data) {
        if (data) {
            this.processCode = data;
            this.setProcess.code = this.processCode;
            this.setProcess.showText = this.processCode;
        }
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        this.configTtColumns();
        // if (this.editorParams && this.editorParams.bizTypeId) {
        //   this.queryParam.filterArgs.bizType = new TextValue();
        //   this.queryParam.filterArgs.bizType.value = this.editorParams.bizTypeId;
        //   this.queryParam.filterArgs.bizType.hasValue = true;
        // }
        if (this.processCode != null) {
            this.procHelpService.getProcessNameByCode(this.processCode).subscribe((/**
             * @param {?} processName
             * @return {?}
             */
            (processName) => {
                this.setProcess.name = processName;
                if (this.setProcess.name) {
                    this.setProcess.showText = `${this.setProcess.name}(${this.setProcess.code})`;
                }
                else {
                    this.setProcess.showText = this.setProcess.code;
                }
            }));
        }
        this.loadItems(this.queryParam.filterArgs).subscribe((/**
         * @return {?}
         */
        () => {
            setTimeout((/**
             * @return {?}
             */
            () => {
                if (this.ttData && this.ttData.length > 0) {
                    /** @type {?} */
                    const proc = this.processCode != null ? this.ttData.find((/**
                     * @param {?} it
                     * @return {?}
                     */
                    (it) => it.code == this.processCode)) : this.ttData[0];
                    proc && this.tt.selectRow(proc.id);
                }
            }), 300);
        }));
    }
    /**
     * @param {?=} evt
     * @return {?}
     */
    clickOk(evt) {
        if (this.tt.selectedRow == null) {
            this.notify.warning(this.localePipe.transform("pleaseSelectOneItemOnly"));
            return;
        }
        this.procEmitter.emit(this.tt.selectedRow.data);
        /** @type {?} */
        const object = { value: this.tt.selectedRow.data.code, parameters: null };
        this.submitModal.emit(object);
        this.modalRef && this.modalRef.close();
    }
    /**
     * @param {?=} evt
     * @return {?}
     */
    clickCancel(evt) {
        this.procEmitter.complete();
        this.closeModal.emit();
        this.modalRef && this.modalRef.close();
    }
    /**
     * @param {?} param
     * @return {?}
     */
    onSearch(param) {
        this.queryParam = param;
        console.log(this.queryParam);
        this.loadItems(this.queryParam.filterArgs).subscribe((/**
         * @return {?}
         */
        () => {
            this.tt.clearCheckeds();
            this.tt.clearSelections();
        }));
    }
    /**
     * @param {?} ctx
     * @return {?}
     */
    clickNameCell(ctx) {
        this.procHelpService.openBifManagerApp(ctx.rowData);
    }
    /**
     * @param {?} $event
     * @return {?}
     */
    onPageSizeChanged($event) {
        // console.log('PageSize Changed:', $event);
        /** @type {?} */
        let checkedIds = this.tt.checkeds.map((/**
         * @param {?} r
         * @return {?}
         */
        r => r.data.id));
        this.queryParam.filterArgs.pageSize = $event.pageSize;
        this.loadItems(this.queryParam.filterArgs).subscribe((/**
         * @return {?}
         */
        () => {
            setTimeout((/**
             * @return {?}
             */
            () => {
                this.tt.checkRows(checkedIds, true);
                this.tt.refresh();
            }), 0);
        }));
    }
    /**
     * @param {?} $event
     * @return {?}
     */
    onPageChanged($event) {
        // console.log('PageNumber Changed:', $event);
        /** @type {?} */
        let checkedIds = this.tt.checkeds.map((/**
         * @param {?} r
         * @return {?}
         */
        r => r.data.id));
        this.queryParam.filterArgs.pageIndex = $event.pageIndex - 1;
        this.queryParam.filterArgs.pageSize = $event.pageSize;
        this.loadItems(this.queryParam.filterArgs).subscribe((/**
         * @return {?}
         */
        () => {
            setTimeout((/**
             * @return {?}
             */
            () => {
                this.tt.checkRows(checkedIds, true);
                this.tt.refresh();
            }), 0);
        }));
    }
    /**
     * @param {?} pageInfo
     * @return {?}
     */
    pageChangeHandler(pageInfo) {
        /** @type {?} */
        let checkedIds = this.tt.checkeds.map((/**
         * @param {?} r
         * @return {?}
         */
        r => r.data.id));
        this.queryParam.filterArgs.pageIndex = pageInfo.pageIndex - 1;
        this.queryParam.filterArgs.pageSize = pageInfo.pageSize;
        this.loadItems(this.queryParam.filterArgs).subscribe((/**
         * @return {?}
         */
        () => {
            setTimeout((/**
             * @return {?}
             */
            () => {
                this.tt.checkRows(checkedIds, true);
                this.tt.refresh();
            }), 0);
        }));
    }
    /**
     * @param {?} size
     * @return {?}
     */
    pageSizeChangeHandler(size) {
        /** @type {?} */
        let checkedIds = this.tt.checkeds.map((/**
         * @param {?} r
         * @return {?}
         */
        r => r.data.id));
        this.queryParam.filterArgs.pageSize = size;
        this.loadItems(this.queryParam.filterArgs).subscribe((/**
         * @return {?}
         */
        () => {
            setTimeout((/**
             * @return {?}
             */
            () => {
                this.tt.checkRows(checkedIds, true);
                this.tt.refresh();
            }), 0);
        }));
    }
    /**
     * @return {?}
     */
    removeSetProcess() {
    }
    /**
     * @private
     * @param {?} args
     * @return {?}
     */
    loadItems(args) {
        /** @type {?} */
        const loadingComp = this.loading.show({ message: this.localePipe.transform("loading") });
        return this.procHelpService.getDatagridData(args).pipe(switchMap((/**
         * @param {?} listRes
         * @return {?}
         */
        (listRes) => {
            this.ttData = [...listRes.entities];
            //更新分页信息
            this.tt.setPageIndex(listRes.pageIndex + 1);
            this.tt.total = listRes.totalCount;
            this.tt.pageSize = listRes.pageSize;
            // this.page.setCurrentPage(this.paginationId, listRes.pageIndex + 1);
            // this.page.setItemsPerPage(this.paginationId, listRes.pageSize);
            // this.page.setTotalItems(this.paginationId, listRes.totalCount);
            loadingComp.close();
            return of(listRes);
        })), catchError((/**
         * @param {?} err
         * @return {?}
         */
        (err) => {
            loadingComp.close();
            setTimeout((/**
             * @return {?}
             */
            () => {
                //todo 确定异常结构, 目前采用兼容取值方式
                this.messager.error(err.error == null ? err.message : (err.error.Message || err.error.message || err.message));
            }), 300);
            throw err;
        })));
    }
    /**
     * @private
     * @return {?}
     */
    configTtColumns() {
        this.ttColumns = [
            // {
            //   field: "isEnabled", title: this.localePipe.transform("enabledState"), width: 100, sortable: false,
            //   formatter: (value: boolean, rowData, rowIndex) => {
            //     if (value == true) {
            //       return this.localePipe.transform("enabled");
            //     } else if (value == false) {
            //       return this.localePipe.transform("disabled");
            //     } else {
            //       return "-";
            //     }
            //   }
            // },
            { field: "code", title: this.localePipe.transform("code"), width: 120, sortable: true },
            {
                field: "name", title: this.localePipe.transform("name"), width: 250, sortable: true,
                template: this.nameCellTemp,
            },
            { field: "upBillVoName", title: this.localePipe.transform("upBill"), width: 120, sortable: true },
            { field: "downBillVoName", title: this.localePipe.transform("downBill"), width: 120, sortable: true },
            // {
            //   field: "bifMetadataType", title: this.localePipe.transform("processType"), width: 120, sortable: false,
            //   formatter: (value: BifMetadataType, rowData, rowIndex) => {
            //     if (value == BifMetadataType.BifCreationProcess) {
            //       return this.localePipe.transform("creation");
            //     } else if (value == BifMetadataType.BifWritebackProcess) {
            //       return this.localePipe.transform("writeback");
            //     } else {
            //       return "-";
            //     }
            //   }
            // },
            {
                field: "sysInit", title: this.localePipe.transform("sysInit"), width: 80, sortable: false,
                formatter: (/**
                 * @param {?} value
                 * @param {?} rowData
                 * @param {?} rowIndex
                 * @return {?}
                 */
                (value, rowData, rowIndex) => {
                    if (value == true) {
                        return this.localePipe.transform("yes");
                    }
                    else if (value == false) {
                        return this.localePipe.transform("no");
                    }
                    else {
                        return "-";
                    }
                })
            },
        ];
    }
    /**
     * @private
     * @return {?}
     */
    createDefaultQueryParam() {
        /** @type {?} */
        const queryParam = {
            filterArgs: new ProcessFilterConditionArgs(),
            filterArgsExt: {}
        };
        queryParam.filterArgs.pageSize = this.defaultPageSize;
        queryParam.filterArgs.pageIndex = 0;
        queryParam.filterArgs.OrderByLastModifiedTime = new TextValue();
        queryParam.filterArgs.OrderByLastModifiedTime.value = OrderByDirection.Desc;
        queryParam.filterArgs.OrderByLastModifiedTime.hasValue = true;
        queryParam.filterArgs.billProcessType = new TextValue();
        queryParam.filterArgs.billProcessType.value = BifMetadataType.BifCreationProcess;
        queryParam.filterArgs.billProcessType.hasValue = true;
        queryParam.filterArgs.isEnabled = new TextValue();
        queryParam.filterArgs.isEnabled.value = "true";
        queryParam.filterArgs.isEnabled.hasValue = true;
        return queryParam;
    }
}
ProcessListHelpComponent.decorators = [
    { type: Component, args: [{
                selector: 'app-process-list-help',
                template: "<div class=\"f-page f-page-is-managelist\" id=\"bif-manager-list\">\r\n  <app-proc-help-query-solution id=\"query-solution\" #querySolution [(queryParam)]=\"queryParam\"\r\n    (onSearch)=\"onSearch($event)\">\r\n  </app-proc-help-query-solution>\r\n\r\n  <div class=\"f-page-main\" id=\"page-main\">\r\n    <div *ngIf=\"setProcess&&setProcess.code\" class=\"d-flex px-2\" style=\"line-height: 32px; height: 32px;\">\r\n      <div>\r\n        {{\"setProcess\" | aifLocale}}\r\n      </div>\r\n      <div class=\"farris-tags\">\r\n        <ul class=\"farris-tags-item-container\">\r\n          <li class=\"farris-tag-item farris-tag-item-info\">\r\n            <span class=\"tag-box\">\r\n              {{setProcess&&setProcess.showText}}\r\n            </span>\r\n            <span *ngIf=\"false\" class=\"tag-delete\" (click)=\"removeSetProcess()\">\r\n              <i class=\"f-icon f-icon-close\"></i>\r\n            </span>\r\n          </li>\r\n        </ul>\r\n      </div>\r\n    </div>\r\n    <div class=\"f-utils-fill-flex-column\">\r\n      <farris-datagrid id=\"tt\" #tt [data]=\"ttData\" [columns]=\"ttColumns\" [idField]=\"ttIdField\" [multiSelect]=\"true\"\r\n        [showCheckbox]=\"false\" [showAllCheckbox]=\"false\" [onlySelectSelf]=\"true\" [keepSelect]=\"true\"\r\n        [selectOnCheck]=\"true\" [checkOnSelect]=\"false\" [showHeader]=\"true\" [fit]=\"true\" [fitColumns]=\"true\"\r\n        [pagination]=\"true\" [showPageList]=\"true\" [pageSize]=\"defaultPageSize\" [pageList]=\"pageList\"\r\n        (pageChanged)=\"onPageChanged($event)\" (pageSizeChanged)=\"onPageSizeChanged($event)\" [remoteSort]=\"false\">\r\n      </farris-datagrid>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #nameCellTemp let-ctx>\r\n  <a href=\"javascript: void(0);\" (click)=\"clickNameCell(ctx)\">{{ctx?.rowData?.name}}</a>\r\n</ng-template>\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type=\"button\" class=\"btn btn-secondary btn-sm px-3 mx-2\" (click)=\"clickCancel()\">\r\n    {{'clickCancel' | aifLocale}}\r\n  </button>\r\n  <button type=\"button\" class=\"btn btn-primary btn-sm px-3 mx-2\" (click)=\"clickOk()\">\r\n    {{'clickOk' | aifLocale}}\r\n  </button>\r\n</ng-template>\r\n",
                providers: [
                    { provide: BIF_LANG_RESOURCES, useValue: ɵ0 },
                    AifLocalePipe,
                ],
                styles: [""]
            }] }
];
/** @nocollapse */
ProcessListHelpComponent.ctorParameters = () => [
    { type: ProcessListHelpService },
    { type: MessagerService },
    { type: NotifyService },
    { type: BsModalService },
    { type: FrameworkService },
    { type: Router },
    { type: ActivatedRoute },
    { type: LoadingService },
    { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
    { type: AifLocalePipe }
];
ProcessListHelpComponent.propDecorators = {
    closeModal: [{ type: Output }],
    submitModal: [{ type: Output }],
    value: [{ type: Input }],
    editorParams: [{ type: Input }],
    tt: [{ type: ViewChild, args: ["tt",] }],
    nameCellTemp: [{ type: ViewChild, args: ['nameCellTemp',] }],
    modalFooter: [{ type: ViewChild, args: ['iconSelectFooter',] }]
};
if (false) {
    /** @type {?} */
    ProcessListHelpComponent.prototype.closeModal;
    /** @type {?} */
    ProcessListHelpComponent.prototype.submitModal;
    /** @type {?} */
    ProcessListHelpComponent.prototype.editorParams;
    /**
     * @type {?}
     * @private
     */
    ProcessListHelpComponent.prototype.processCode;
    /** @type {?} */
    ProcessListHelpComponent.prototype.modalConfig;
    /** @type {?} */
    ProcessListHelpComponent.prototype.procEmitter;
    /** @type {?} */
    ProcessListHelpComponent.prototype.queryParam;
    /** @type {?} */
    ProcessListHelpComponent.prototype.tt;
    /** @type {?} */
    ProcessListHelpComponent.prototype.ttIdField;
    /** @type {?} */
    ProcessListHelpComponent.prototype.ttData;
    /** @type {?} */
    ProcessListHelpComponent.prototype.ttColumns;
    /** @type {?} */
    ProcessListHelpComponent.prototype.cascadeCheck;
    /** @type {?} */
    ProcessListHelpComponent.prototype.cascadeDown;
    /** @type {?} */
    ProcessListHelpComponent.prototype.cascadeUp;
    /** @type {?} */
    ProcessListHelpComponent.prototype.nameCellTemp;
    /** @type {?} */
    ProcessListHelpComponent.prototype.modalFooter;
    /** @type {?} */
    ProcessListHelpComponent.prototype.modalRef;
    /** @type {?} */
    ProcessListHelpComponent.prototype.defaultPageSize;
    /** @type {?} */
    ProcessListHelpComponent.prototype.pageList;
    /**
     * 已设置流程
     * @type {?}
     */
    ProcessListHelpComponent.prototype.setProcess;
    /**
     * @type {?}
     * @private
     */
    ProcessListHelpComponent.prototype.procHelpService;
    /**
     * @type {?}
     * @private
     */
    ProcessListHelpComponent.prototype.messager;
    /**
     * @type {?}
     * @private
     */
    ProcessListHelpComponent.prototype.notify;
    /**
     * @type {?}
     * @private
     */
    ProcessListHelpComponent.prototype.modalService;
    /**
     * @type {?}
     * @private
     */
    ProcessListHelpComponent.prototype.frameworkService;
    /**
     * @type {?}
     * @private
     */
    ProcessListHelpComponent.prototype.router;
    /**
     * @type {?}
     * @private
     */
    ProcessListHelpComponent.prototype.activatedRoute;
    /**
     * @type {?}
     * @private
     */
    ProcessListHelpComponent.prototype.loading;
    /**
     * @type {?}
     * @private
     */
    ProcessListHelpComponent.prototype.localePipe;
}
export { ɵ0 };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicHJvY2Vzcy1saXN0LWhlbHAuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGdzcC13Zi93Zi1wcm9jZXNzLWVkaXRvci8iLCJzb3VyY2VzIjpbImxpYi92aWV3cy9haWYtcHJvY2Vzcy1saXN0LWhlbHAvY29tcG9uZW50cy9wcm9jZXNzLWxpc3QtaGVscC9wcm9jZXNzLWxpc3QtaGVscC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQVUsU0FBUyxFQUFFLFdBQVcsRUFBRSxZQUFZLEVBQUUsTUFBTSxFQUFFLFNBQVMsRUFBRSxNQUFNLEVBQUUsS0FBSyxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBRTFILE9BQU8sRUFBRSxzQkFBc0IsRUFBRSxNQUFNLDBDQUEwQyxDQUFDO0FBQ2xGLE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUN0RCxPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0sbUJBQW1CLENBQUM7QUFDbEQsT0FBTyxFQUFFLGNBQWMsRUFBYyxNQUFNLGtCQUFrQixDQUFDO0FBQzlELE9BQU8sRUFBRSxnQkFBZ0IsRUFBRSxNQUFNLHFCQUFxQixDQUFDO0FBQ3ZELE9BQU8sRUFBRSxNQUFNLEVBQUUsY0FBYyxFQUFFLE1BQU0saUJBQWlCLENBQUM7QUFDekQsT0FBTyxFQUFFLGNBQWMsRUFBRSxNQUFNLG9CQUFvQixDQUFDO0FBQ3BELE9BQU8sRUFBYyxFQUFFLEVBQUUsTUFBTSxNQUFNLENBQUM7QUFDdEMsT0FBTyxFQUFFLFNBQVMsRUFBRSxVQUFVLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUV2RCxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0sOEJBQThCLENBQUM7QUFDL0QsT0FBTyxFQUFFLDBCQUEwQixFQUFFLE1BQU0seUNBQXlDLENBQUM7QUFDckYsT0FBTyxFQUFFLFNBQVMsRUFBRSxNQUFNLHFCQUFxQixDQUFDO0FBQ2hELE9BQU8sRUFBRSxn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LGNBQWM7eUNBeUZsQixNQUFNLFNBQUMsU0FBUztZQS9FWixhQUFhOzs7eUJBYW5CLE1BQU07MEJBQ04sTUFBTTtvQkFFTixLQUFLOzJCQVNMLEtBQUs7aUJBZUwsU0FBUyxTQUFDLElBQUk7MkJBUWQsU0FBUyxTQUFDLGNBQWM7MEJBR3hCLFNBQVMsU0FBQyxrQkFBa0I7Ozs7SUF0QzdCLDhDQUErQzs7SUFDL0MsK0NBQWdEOztJQVdoRCxnREFFTzs7Ozs7SUFFUCwrQ0FBNEI7O0lBQzVCLCtDQUtFOztJQUVGLCtDQUFzQzs7SUFDdEMsOENBQThCOztJQUU5QixzQ0FDc0I7O0lBQ3RCLDZDQUF5Qjs7SUFDekIsMENBQW1COztJQUNuQiw2Q0FBc0I7O0lBQ3RCLGdEQUFxQjs7SUFDckIsK0NBQW9COztJQUNwQiw2Q0FBa0I7O0lBQ2xCLGdEQUMrQjs7SUFFL0IsK0NBQzhCOztJQUU5Qiw0Q0FBcUI7O0lBRXJCLG1EQUFzQzs7SUFDdEMsNENBQXFEOzs7OztJQUtyRCw4Q0FNSTs7Ozs7SUFHRixtREFBK0M7Ozs7O0lBQy9DLDRDQUFpQzs7Ozs7SUFDakMsMENBQTZCOzs7OztJQUM3QixnREFBb0M7Ozs7O0lBQ3BDLG9EQUEwQzs7Ozs7SUFDMUMsMENBQXNCOzs7OztJQUN0QixrREFBc0M7Ozs7O0lBQ3RDLDJDQUErQjs7Ozs7SUFFL0IsOENBQWlDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50LCBPbkluaXQsIFZpZXdDaGlsZCwgVGVtcGxhdGVSZWYsIEV2ZW50RW1pdHRlciwgSW5qZWN0LCBMT0NBTEVfSUQsIE91dHB1dCwgSW5wdXQgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgRmFycmlzU2VjdGlvbkNvbXBvbmVudCB9IGZyb20gJ0BmYXJyaXMvdWktc2VjdGlvbic7XHJcbmltcG9ydCB7IFByb2Nlc3NMaXN0SGVscFNlcnZpY2UgfSBmcm9tICcuLi8uLi9zZXJ2aWNlcy9wcm9jZXNzLWxpc3QtaGVscC5zZXJ2aWNlJztcclxuaW1wb3J0IHsgTWVzc2FnZXJTZXJ2aWNlIH0gZnJvbSAnQGZhcnJpcy91aS1tZXNzYWdlcic7XHJcbmltcG9ydCB7IE5vdGlmeVNlcnZpY2UgfSBmcm9tICdAZmFycmlzL3VpLW5vdGlmeSc7XHJcbmltcG9ydCB7IEJzTW9kYWxTZXJ2aWNlLCBCc01vZGFsUmVmIH0gZnJvbSAnQGZhcnJpcy91aS1tb2RhbCc7XHJcbmltcG9ydCB7IEZyYW1ld29ya1NlcnZpY2UgfSBmcm9tICdAZ3NwLXN5cy9ydGYtY29tbW9uJztcclxuaW1wb3J0IHsgUm91dGVyLCBBY3RpdmF0ZWRSb3V0ZSB9IGZyb20gJ0Bhbmd1bGFyL3JvdXRlcic7XHJcbmltcG9ydCB7IExvYWRpbmdTZXJ2aWNlIH0gZnJvbSAnQGZhcnJpcy91aS1sb2FkaW5nJztcclxuaW1wb3J0IHsgT2JzZXJ2YWJsZSwgb2YgfSBmcm9tICdyeGpzJztcclxuaW1wb3J0IHsgc3dpdGNoTWFwLCBjYXRjaEVycm9yIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xyXG5pbXBvcnQgeyBJUnRQcm9jUXVlcnlQYXJhbSB9IGZyb20gJy4uLy4uL2VudGl0eS9JUHJvY1F1ZXJ5UGFyYW0nO1xyXG5pbXBvcnQgeyBCaWZNZXRhZGF0YVR5cGUgfSBmcm9tICcuLi8uLi9lbnRpdHkvQmlmTWV0YWRhdGFUeXBlJztcclxuaW1wb3J0IHsgUHJvY2Vzc0ZpbHRlckNvbmRpdGlvbkFyZ3MgfSBmcm9tICcuLi8uLi9lbnRpdHkvUHJvY2Vzc0ZpbHRlckNvbmRpdGlvbkFyZ3MnO1xyXG5pbXBvcnQgeyBUZXh0VmFsdWUgfSBmcm9tICdAZWRwLWJpZi9jb21tb24tYXBpJztcclxuaW1wb3J0IHsgT3JkZXJCeURpcmVjdGlvbiB9IGZyb20gJy4uLy4uL2VudGl0eS9PcmRlckJ5RGlyZWN0aW9uJztcclxuaW1wb3J0IHsgRGF0YWdyaWRDb21wb25lbnQgfSBmcm9tICdAZmFycmlzL3VpLWRhdGFncmlkJztcclxuaW1wb3J0IHsgUnRCaWxsUHJvY2Vzc0xpc3RSZXN1bHQgfSBmcm9tICcuLi8uLi9lbnRpdHkvUnRCaWxsUHJvY2Vzc0xpc3RSZXN1bHQnO1xyXG5pbXBvcnQgeyBBaWZMb2NhbGVQaXBlLCBCSUZfTEFOR19SRVNPVVJDRVMgfSBmcm9tICcuLi8uLi8uLi9haWYtdWktY29tbW9uL3BpcGUvYWlmLXVpLWNvbW1vbi1sb2NhbGUucGlwZSc7XHJcbmltcG9ydCB7IEFJRl9QUk9DRVNTX0xJU1RfSEVMUF9MQU5HX1JFU09VUkNFUyB9IGZyb20gJy4uLy4uL2kxOG4vbGFuZy5yZXNvdXJjZSc7XHJcblxyXG5AQ29tcG9uZW50KHtcclxuICBzZWxlY3RvcjogJ2FwcC1wcm9jZXNzLWxpc3QtaGVscCcsXHJcbiAgdGVtcGxhdGVVcmw6ICcuL3Byb2Nlc3MtbGlzdC1oZWxwLmNvbXBvbmVudC5odG1sJyxcclxuICBzdHlsZVVybHM6IFsnLi9wcm9jZXNzLWxpc3QtaGVscC5jb21wb25lbnQuY3NzJ10sXHJcbiAgcHJvdmlkZXJzOiBbXHJcbiAgICB7IHByb3ZpZGU6IEJJRl9MQU5HX1JFU09VUkNFUywgdXNlVmFsdWU6IEFJRl9QUk9DRVNTX0xJU1RfSEVMUF9MQU5HX1JFU09VUkNFUyB9LFxyXG4gICAgQWlmTG9jYWxlUGlwZSxcclxuICBdXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBQcm9jZXNzTGlzdEhlbHBDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQge1xyXG4gIEBPdXRwdXQoKSBjbG9zZU1vZGFsID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XHJcbiAgQE91dHB1dCgpIHN1Ym1pdE1vZGFsID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XHJcblxyXG4gIEBJbnB1dCgpXHJcbiAgc2V0IHZhbHVlKGRhdGE6IGFueSkge1xyXG4gICAgaWYgKGRhdGEpIHtcclxuICAgICAgdGhpcy5wcm9jZXNzQ29kZSA9IGRhdGE7XHJcbiAgICAgIHRoaXMuc2V0UHJvY2Vzcy5jb2RlID0gdGhpcy5wcm9jZXNzQ29kZTtcclxuICAgICAgdGhpcy5zZXRQcm9jZXNzLnNob3dUZXh0ID0gdGhpcy5wcm9jZXNzQ29kZTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIEBJbnB1dCgpIGVkaXRvclBhcmFtczoge1xyXG4gICAgYml6VHlwZUlkPzogc3RyaW5nXHJcbiAgfSA9IHt9O1xyXG5cclxuICBwcml2YXRlIHByb2Nlc3NDb2RlOiBzdHJpbmc7XHJcbiAgbW9kYWxDb25maWcgPSB7XHJcbiAgICB0aXRsZTogdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybShcImNyZWF0aW9uUHJvY2Vzc1wiKSxcclxuICAgIHdpZHRoOiAxMjUwLFxyXG4gICAgaGVpZ2h0OiA1MDAsXHJcbiAgICBzaG93QnV0dG9uczogdHJ1ZVxyXG4gIH07XHJcblxyXG4gIHByb2NFbWl0dGVyID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XHJcbiAgcXVlcnlQYXJhbTogSVJ0UHJvY1F1ZXJ5UGFyYW07XHJcblxyXG4gIEBWaWV3Q2hpbGQoXCJ0dFwiKVxyXG4gIHR0OiBEYXRhZ3JpZENvbXBvbmVudDtcclxuICB0dElkRmllbGQ6IHN0cmluZyA9IFwiaWRcIjtcclxuICB0dERhdGE6IGFueVtdID0gW107XHJcbiAgdHRDb2x1bW5zOiBhbnlbXSA9IFtdO1xyXG4gIGNhc2NhZGVDaGVjayA9IGZhbHNlO1xyXG4gIGNhc2NhZGVEb3duID0gZmFsc2U7XHJcbiAgY2FzY2FkZVVwID0gZmFsc2U7XHJcbiAgQFZpZXdDaGlsZCgnbmFtZUNlbGxUZW1wJylcclxuICBuYW1lQ2VsbFRlbXA6IFRlbXBsYXRlUmVmPGFueT47XHJcblxyXG4gIEBWaWV3Q2hpbGQoJ2ljb25TZWxlY3RGb290ZXInKVxyXG4gIG1vZGFsRm9vdGVyOiBUZW1wbGF0ZVJlZjxhbnk+O1xyXG5cclxuICBtb2RhbFJlZjogQnNNb2RhbFJlZjtcclxuXHJcbiAgcmVhZG9ubHkgZGVmYXVsdFBhZ2VTaXplOiBudW1iZXIgPSAzMDtcclxuICBwYWdlTGlzdCA9IFt0aGlzLmRlZmF1bHRQYWdlU2l6ZSwgNTAsIDEwMCwgMjAwLCA1MDBdO1xyXG5cclxuICAvKipcclxuICAgKiDlt7Lorr7nva7mtYHnqItcclxuICAgKi9cclxuICBzZXRQcm9jZXNzOiB7XHJcbiAgICBjb2RlPzogc3RyaW5nO1xyXG4gICAgbmFtZT86IHN0cmluZztcclxuICAgIHNob3dUZXh0Pzogc3RyaW5nO1xyXG4gIH0gPSB7XHJcbiAgICAgIHNob3dUZXh0OiBcIlwiXHJcbiAgICB9O1xyXG5cclxuICBjb25zdHJ1Y3RvcihcclxuICAgIHByaXZhdGUgcHJvY0hlbHBTZXJ2aWNlOiBQcm9jZXNzTGlzdEhlbHBTZXJ2aWNlLFxyXG4gICAgcHJpdmF0ZSBtZXNzYWdlcjogTWVzc2FnZXJTZXJ2aWNlLFxyXG4gICAgcHJpdmF0ZSBub3RpZnk6IE5vdGlmeVNlcnZpY2UsXHJcbiAgICBwcml2YXRlIG1vZGFsU2VydmljZTogQnNNb2RhbFNlcnZpY2UsXHJcbiAgICBwcml2YXRlIGZyYW1ld29ya1NlcnZpY2U6IEZyYW1ld29ya1NlcnZpY2UsXHJcbiAgICBwcml2YXRlIHJvdXRlcjogUm91dGVyLFxyXG4gICAgcHJpdmF0ZSBhY3RpdmF0ZWRSb3V0ZTogQWN0aXZhdGVkUm91dGUsXHJcbiAgICBwcml2YXRlIGxvYWRpbmc6IExvYWRpbmdTZXJ2aWNlLFxyXG4gICAgQEluamVjdChMT0NBTEVfSUQpIGxvY2FsZUlkOiBzdHJpbmcsXHJcbiAgICBwcml2YXRlIGxvY2FsZVBpcGU6IEFpZkxvY2FsZVBpcGUsXHJcbiAgKSB7XHJcbiAgICB0aGlzLnF1ZXJ5UGFyYW0gPSB0aGlzLmNyZWF0ZURlZmF1bHRRdWVyeVBhcmFtKCk7XHJcbiAgfVxyXG5cclxuICBuZ09uSW5pdCgpIHtcclxuICAgIHRoaXMuY29uZmlnVHRDb2x1bW5zKCk7XHJcbiAgICAvLyBpZiAodGhpcy5lZGl0b3JQYXJhbXMgJiYgdGhpcy5lZGl0b3JQYXJhbXMuYml6VHlwZUlkKSB7XHJcbiAgICAvLyAgIHRoaXMucXVlcnlQYXJhbS5maWx0ZXJBcmdzLmJpelR5cGUgPSBuZXcgVGV4dFZhbHVlKCk7XHJcbiAgICAvLyAgIHRoaXMucXVlcnlQYXJhbS5maWx0ZXJBcmdzLmJpelR5cGUudmFsdWUgPSB0aGlzLmVkaXRvclBhcmFtcy5iaXpUeXBlSWQ7XHJcbiAgICAvLyAgIHRoaXMucXVlcnlQYXJhbS5maWx0ZXJBcmdzLmJpelR5cGUuaGFzVmFsdWUgPSB0cnVlO1xyXG4gICAgLy8gfVxyXG4gICAgaWYgKHRoaXMucHJvY2Vzc0NvZGUgIT0gbnVsbCkge1xyXG4gICAgICB0aGlzLnByb2NIZWxwU2VydmljZS5nZXRQcm9jZXNzTmFtZUJ5Q29kZSh0aGlzLnByb2Nlc3NDb2RlKS5zdWJzY3JpYmUoXHJcbiAgICAgICAgKHByb2Nlc3NOYW1lKSA9PiB7XHJcbiAgICAgICAgICB0aGlzLnNldFByb2Nlc3MubmFtZSA9IHByb2Nlc3NOYW1lO1xyXG4gICAgICAgICAgaWYgKHRoaXMuc2V0UHJvY2Vzcy5uYW1lKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0UHJvY2Vzcy5zaG93VGV4dCA9IGAke3RoaXMuc2V0UHJvY2Vzcy5uYW1lfSgke3RoaXMuc2V0UHJvY2Vzcy5jb2RlfSlgO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5zZXRQcm9jZXNzLnNob3dUZXh0ID0gdGhpcy5zZXRQcm9jZXNzLmNvZGU7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICApO1xyXG4gICAgfVxyXG4gICAgdGhpcy5sb2FkSXRlbXModGhpcy5xdWVyeVBhcmFtLmZpbHRlckFyZ3MpLnN1YnNjcmliZSgoKSA9PiB7XHJcbiAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgIGlmICh0aGlzLnR0RGF0YSAmJiB0aGlzLnR0RGF0YS5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICBjb25zdCBwcm9jID0gdGhpcy5wcm9jZXNzQ29kZSAhPSBudWxsID8gdGhpcy50dERhdGEuZmluZCgoaXQpID0+IGl0LmNvZGUgPT0gdGhpcy5wcm9jZXNzQ29kZSkgOiB0aGlzLnR0RGF0YVswXTtcclxuICAgICAgICAgIHByb2MgJiYgdGhpcy50dC5zZWxlY3RSb3cocHJvYy5pZCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9LCAzMDApO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBjbGlja09rKGV2dD8pIHtcclxuICAgIGlmICh0aGlzLnR0LnNlbGVjdGVkUm93ID09IG51bGwpIHtcclxuICAgICAgdGhpcy5ub3RpZnkud2FybmluZyh0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKFwicGxlYXNlU2VsZWN0T25lSXRlbU9ubHlcIikpO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICB0aGlzLnByb2NFbWl0dGVyLmVtaXQodGhpcy50dC5zZWxlY3RlZFJvdy5kYXRhKTtcclxuICAgIGNvbnN0IG9iamVjdCA9IHsgdmFsdWU6IHRoaXMudHQuc2VsZWN0ZWRSb3cuZGF0YS5jb2RlLCBwYXJhbWV0ZXJzOiBudWxsIH07XHJcbiAgICB0aGlzLnN1Ym1pdE1vZGFsLmVtaXQob2JqZWN0KTtcclxuICAgIHRoaXMubW9kYWxSZWYgJiYgdGhpcy5tb2RhbFJlZi5jbG9zZSgpO1xyXG4gIH1cclxuXHJcbiAgY2xpY2tDYW5jZWwoZXZ0Pykge1xyXG4gICAgdGhpcy5wcm9jRW1pdHRlci5jb21wbGV0ZSgpO1xyXG4gICAgdGhpcy5jbG9zZU1vZGFsLmVtaXQoKTtcclxuICAgIHRoaXMubW9kYWxSZWYgJiYgdGhpcy5tb2RhbFJlZi5jbG9zZSgpO1xyXG4gIH1cclxuXHJcbiAgb25TZWFyY2gocGFyYW06IGFueSkge1xyXG4gICAgdGhpcy5xdWVyeVBhcmFtID0gcGFyYW07XHJcbiAgICBjb25zb2xlLmxvZyh0aGlzLnF1ZXJ5UGFyYW0pO1xyXG4gICAgdGhpcy5sb2FkSXRlbXModGhpcy5xdWVyeVBhcmFtLmZpbHRlckFyZ3MpLnN1YnNjcmliZShcclxuICAgICAgKCkgPT4ge1xyXG4gICAgICAgIHRoaXMudHQuY2xlYXJDaGVja2VkcygpO1xyXG4gICAgICAgIHRoaXMudHQuY2xlYXJTZWxlY3Rpb25zKCk7XHJcbiAgICAgIH1cclxuICAgICk7XHJcbiAgfVxyXG5cclxuICBjbGlja05hbWVDZWxsKGN0eCkge1xyXG4gICAgdGhpcy5wcm9jSGVscFNlcnZpY2Uub3BlbkJpZk1hbmFnZXJBcHAoY3R4LnJvd0RhdGEpO1xyXG4gIH1cclxuXHJcbiAgb25QYWdlU2l6ZUNoYW5nZWQoJGV2ZW50OiB7IHBhZ2VJbmRleDogbnVtYmVyLCBwYWdlU2l6ZTogbnVtYmVyIH0pIHtcclxuICAgIC8vIGNvbnNvbGUubG9nKCdQYWdlU2l6ZSBDaGFuZ2VkOicsICRldmVudCk7XHJcbiAgICBsZXQgY2hlY2tlZElkcyA9IHRoaXMudHQuY2hlY2tlZHMubWFwKHIgPT4gci5kYXRhLmlkKTtcclxuXHJcbiAgICB0aGlzLnF1ZXJ5UGFyYW0uZmlsdGVyQXJncy5wYWdlU2l6ZSA9ICRldmVudC5wYWdlU2l6ZTtcclxuICAgIHRoaXMubG9hZEl0ZW1zKHRoaXMucXVlcnlQYXJhbS5maWx0ZXJBcmdzKS5zdWJzY3JpYmUoXHJcbiAgICAgICgpID0+IHtcclxuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgIHRoaXMudHQuY2hlY2tSb3dzKGNoZWNrZWRJZHMsIHRydWUpO1xyXG4gICAgICAgICAgdGhpcy50dC5yZWZyZXNoKCk7XHJcbiAgICAgICAgfSwgMCk7XHJcbiAgICAgIH1cclxuICAgICk7XHJcbiAgfVxyXG5cclxuICBvblBhZ2VDaGFuZ2VkKCRldmVudDogeyBwYWdlSW5kZXg6IG51bWJlciwgcGFnZVNpemU6IG51bWJlciB9KSB7XHJcbiAgICAvLyBjb25zb2xlLmxvZygnUGFnZU51bWJlciBDaGFuZ2VkOicsICRldmVudCk7XHJcbiAgICBsZXQgY2hlY2tlZElkcyA9IHRoaXMudHQuY2hlY2tlZHMubWFwKHIgPT4gci5kYXRhLmlkKTtcclxuXHJcbiAgICB0aGlzLnF1ZXJ5UGFyYW0uZmlsdGVyQXJncy5wYWdlSW5kZXggPSAkZXZlbnQucGFnZUluZGV4IC0gMTtcclxuICAgIHRoaXMucXVlcnlQYXJhbS5maWx0ZXJBcmdzLnBhZ2VTaXplID0gJGV2ZW50LnBhZ2VTaXplO1xyXG4gICAgdGhpcy5sb2FkSXRlbXModGhpcy5xdWVyeVBhcmFtLmZpbHRlckFyZ3MpLnN1YnNjcmliZShcclxuICAgICAgKCkgPT4ge1xyXG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgdGhpcy50dC5jaGVja1Jvd3MoY2hlY2tlZElkcywgdHJ1ZSk7XHJcbiAgICAgICAgICB0aGlzLnR0LnJlZnJlc2goKTtcclxuICAgICAgICB9LCAwKTtcclxuICAgICAgfVxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIHBhZ2VDaGFuZ2VIYW5kbGVyKHBhZ2VJbmZvOiB7IHBhZ2VJbmRleDogbnVtYmVyLCBwYWdlU2l6ZTogbnVtYmVyIH0pIHtcclxuICAgIGxldCBjaGVja2VkSWRzID0gdGhpcy50dC5jaGVja2Vkcy5tYXAociA9PiByLmRhdGEuaWQpO1xyXG5cclxuICAgIHRoaXMucXVlcnlQYXJhbS5maWx0ZXJBcmdzLnBhZ2VJbmRleCA9IHBhZ2VJbmZvLnBhZ2VJbmRleCAtIDE7XHJcbiAgICB0aGlzLnF1ZXJ5UGFyYW0uZmlsdGVyQXJncy5wYWdlU2l6ZSA9IHBhZ2VJbmZvLnBhZ2VTaXplO1xyXG4gICAgdGhpcy5sb2FkSXRlbXModGhpcy5xdWVyeVBhcmFtLmZpbHRlckFyZ3MpLnN1YnNjcmliZShcclxuICAgICAgKCkgPT4ge1xyXG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgdGhpcy50dC5jaGVja1Jvd3MoY2hlY2tlZElkcywgdHJ1ZSk7XHJcbiAgICAgICAgICB0aGlzLnR0LnJlZnJlc2goKTtcclxuICAgICAgICB9LCAwKTtcclxuICAgICAgfVxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIHBhZ2VTaXplQ2hhbmdlSGFuZGxlcihzaXplOiBudW1iZXIpIHtcclxuICAgIGxldCBjaGVja2VkSWRzID0gdGhpcy50dC5jaGVja2Vkcy5tYXAociA9PiByLmRhdGEuaWQpO1xyXG5cclxuICAgIHRoaXMucXVlcnlQYXJhbS5maWx0ZXJBcmdzLnBhZ2VTaXplID0gc2l6ZTtcclxuICAgIHRoaXMubG9hZEl0ZW1zKHRoaXMucXVlcnlQYXJhbS5maWx0ZXJBcmdzKS5zdWJzY3JpYmUoXHJcbiAgICAgICgpID0+IHtcclxuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgIHRoaXMudHQuY2hlY2tSb3dzKGNoZWNrZWRJZHMsIHRydWUpO1xyXG4gICAgICAgICAgdGhpcy50dC5yZWZyZXNoKCk7XHJcbiAgICAgICAgfSwgMCk7XHJcbiAgICAgIH1cclxuICAgICk7XHJcbiAgfVxyXG5cclxuICByZW1vdmVTZXRQcm9jZXNzKCkge1xyXG5cclxuICB9XHJcblxyXG4gIHByaXZhdGUgbG9hZEl0ZW1zKGFyZ3M6IFByb2Nlc3NGaWx0ZXJDb25kaXRpb25BcmdzKTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgIGNvbnN0IGxvYWRpbmdDb21wID0gdGhpcy5sb2FkaW5nLnNob3coeyBtZXNzYWdlOiB0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKFwibG9hZGluZ1wiKSB9KTtcclxuICAgIHJldHVybiB0aGlzLnByb2NIZWxwU2VydmljZS5nZXREYXRhZ3JpZERhdGEoYXJncykucGlwZShcclxuICAgICAgc3dpdGNoTWFwKFxyXG4gICAgICAgIChsaXN0UmVzOiBSdEJpbGxQcm9jZXNzTGlzdFJlc3VsdCkgPT4ge1xyXG4gICAgICAgICAgdGhpcy50dERhdGEgPSBbLi4ubGlzdFJlcy5lbnRpdGllc107XHJcbiAgICAgICAgICAvL+abtOaWsOWIhumhteS/oeaBr1xyXG4gICAgICAgICAgdGhpcy50dC5zZXRQYWdlSW5kZXgobGlzdFJlcy5wYWdlSW5kZXggKyAxKTtcclxuICAgICAgICAgIHRoaXMudHQudG90YWwgPSBsaXN0UmVzLnRvdGFsQ291bnQ7XHJcbiAgICAgICAgICB0aGlzLnR0LnBhZ2VTaXplID0gbGlzdFJlcy5wYWdlU2l6ZTtcclxuICAgICAgICAgIC8vIHRoaXMucGFnZS5zZXRDdXJyZW50UGFnZSh0aGlzLnBhZ2luYXRpb25JZCwgbGlzdFJlcy5wYWdlSW5kZXggKyAxKTtcclxuICAgICAgICAgIC8vIHRoaXMucGFnZS5zZXRJdGVtc1BlclBhZ2UodGhpcy5wYWdpbmF0aW9uSWQsIGxpc3RSZXMucGFnZVNpemUpO1xyXG4gICAgICAgICAgLy8gdGhpcy5wYWdlLnNldFRvdGFsSXRlbXModGhpcy5wYWdpbmF0aW9uSWQsIGxpc3RSZXMudG90YWxDb3VudCk7XHJcblxyXG4gICAgICAgICAgbG9hZGluZ0NvbXAuY2xvc2UoKTtcclxuICAgICAgICAgIHJldHVybiBvZihsaXN0UmVzKTtcclxuICAgICAgICB9XHJcbiAgICAgICksXHJcbiAgICAgIGNhdGNoRXJyb3IoXHJcbiAgICAgICAgKGVycikgPT4ge1xyXG4gICAgICAgICAgbG9hZGluZ0NvbXAuY2xvc2UoKTtcclxuICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICAvL3RvZG8g56Gu5a6a5byC5bi457uT5p6ELCDnm67liY3ph4fnlKjlhbzlrrnlj5blgLzmlrnlvI9cclxuICAgICAgICAgICAgdGhpcy5tZXNzYWdlci5lcnJvcihlcnIuZXJyb3IgPT0gbnVsbCA/IGVyci5tZXNzYWdlIDogKGVyci5lcnJvci5NZXNzYWdlIHx8IGVyci5lcnJvci5tZXNzYWdlIHx8IGVyci5tZXNzYWdlKSk7XHJcbiAgICAgICAgICB9LCAzMDApO1xyXG4gICAgICAgICAgdGhyb3cgZXJyO1xyXG4gICAgICAgIH1cclxuICAgICAgKVxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgY29uZmlnVHRDb2x1bW5zKCkge1xyXG4gICAgdGhpcy50dENvbHVtbnMgPSBbXHJcbiAgICAgIC8vIHtcclxuICAgICAgLy8gICBmaWVsZDogXCJpc0VuYWJsZWRcIiwgdGl0bGU6IHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oXCJlbmFibGVkU3RhdGVcIiksIHdpZHRoOiAxMDAsIHNvcnRhYmxlOiBmYWxzZSxcclxuICAgICAgLy8gICBmb3JtYXR0ZXI6ICh2YWx1ZTogYm9vbGVhbiwgcm93RGF0YSwgcm93SW5kZXgpID0+IHtcclxuICAgICAgLy8gICAgIGlmICh2YWx1ZSA9PSB0cnVlKSB7XHJcbiAgICAgIC8vICAgICAgIHJldHVybiB0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKFwiZW5hYmxlZFwiKTtcclxuICAgICAgLy8gICAgIH0gZWxzZSBpZiAodmFsdWUgPT0gZmFsc2UpIHtcclxuICAgICAgLy8gICAgICAgcmV0dXJuIHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oXCJkaXNhYmxlZFwiKTtcclxuICAgICAgLy8gICAgIH0gZWxzZSB7XHJcbiAgICAgIC8vICAgICAgIHJldHVybiBcIi1cIjtcclxuICAgICAgLy8gICAgIH1cclxuICAgICAgLy8gICB9XHJcbiAgICAgIC8vIH0sXHJcbiAgICAgIHsgZmllbGQ6IFwiY29kZVwiLCB0aXRsZTogdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybShcImNvZGVcIiksIHdpZHRoOiAxMjAsIHNvcnRhYmxlOiB0cnVlIH0sXHJcbiAgICAgIHtcclxuICAgICAgICBmaWVsZDogXCJuYW1lXCIsIHRpdGxlOiB0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKFwibmFtZVwiKSwgd2lkdGg6IDI1MCwgc29ydGFibGU6IHRydWUsXHJcbiAgICAgICAgdGVtcGxhdGU6IHRoaXMubmFtZUNlbGxUZW1wLFxyXG4gICAgICB9LFxyXG4gICAgICB7IGZpZWxkOiBcInVwQmlsbFZvTmFtZVwiLCB0aXRsZTogdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybShcInVwQmlsbFwiKSwgd2lkdGg6IDEyMCwgc29ydGFibGU6IHRydWUgfSxcclxuICAgICAgeyBmaWVsZDogXCJkb3duQmlsbFZvTmFtZVwiLCB0aXRsZTogdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybShcImRvd25CaWxsXCIpLCB3aWR0aDogMTIwLCBzb3J0YWJsZTogdHJ1ZSB9LFxyXG4gICAgICAvLyB7XHJcbiAgICAgIC8vICAgZmllbGQ6IFwiYmlmTWV0YWRhdGFUeXBlXCIsIHRpdGxlOiB0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKFwicHJvY2Vzc1R5cGVcIiksIHdpZHRoOiAxMjAsIHNvcnRhYmxlOiBmYWxzZSxcclxuICAgICAgLy8gICBmb3JtYXR0ZXI6ICh2YWx1ZTogQmlmTWV0YWRhdGFUeXBlLCByb3dEYXRhLCByb3dJbmRleCkgPT4ge1xyXG4gICAgICAvLyAgICAgaWYgKHZhbHVlID09IEJpZk1ldGFkYXRhVHlwZS5CaWZDcmVhdGlvblByb2Nlc3MpIHtcclxuICAgICAgLy8gICAgICAgcmV0dXJuIHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oXCJjcmVhdGlvblwiKTtcclxuICAgICAgLy8gICAgIH0gZWxzZSBpZiAodmFsdWUgPT0gQmlmTWV0YWRhdGFUeXBlLkJpZldyaXRlYmFja1Byb2Nlc3MpIHtcclxuICAgICAgLy8gICAgICAgcmV0dXJuIHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oXCJ3cml0ZWJhY2tcIik7XHJcbiAgICAgIC8vICAgICB9IGVsc2Uge1xyXG4gICAgICAvLyAgICAgICByZXR1cm4gXCItXCI7XHJcbiAgICAgIC8vICAgICB9XHJcbiAgICAgIC8vICAgfVxyXG4gICAgICAvLyB9LFxyXG4gICAgICB7XHJcbiAgICAgICAgZmllbGQ6IFwic3lzSW5pdFwiLCB0aXRsZTogdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybShcInN5c0luaXRcIiksIHdpZHRoOiA4MCwgc29ydGFibGU6IGZhbHNlLFxyXG4gICAgICAgIGZvcm1hdHRlcjogKHZhbHVlOiBib29sZWFuLCByb3dEYXRhLCByb3dJbmRleCkgPT4ge1xyXG4gICAgICAgICAgaWYgKHZhbHVlID09IHRydWUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oXCJ5ZXNcIik7XHJcbiAgICAgICAgICB9IGVsc2UgaWYgKHZhbHVlID09IGZhbHNlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKFwibm9cIik7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gXCItXCI7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9LFxyXG4gICAgICAvLyB7XHJcbiAgICAgIC8vICAgZmllbGQ6IG51bGwsIHRpdGxlOiB0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKFwiaXNFeHRlbmRQcm9jZXNzXCIpLCB3aWR0aDogODAsIHNvcnRhYmxlOiBmYWxzZSxcclxuICAgICAgLy8gICBmb3JtYXR0ZXI6ICh2YWx1ZTogYm9vbGVhbiwgcm93RGF0YSwgcm93SW5kZXgpID0+IHtcclxuICAgICAgLy8gICAgIGlmIChyb3dEYXRhLnBhcmVudElkID09IG51bGwpIHtcclxuICAgICAgLy8gICAgICAgcmV0dXJuIHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oXCJub1wiKTtcclxuICAgICAgLy8gICAgIH0gZWxzZSB7XHJcbiAgICAgIC8vICAgICAgIHJldHVybiB0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKFwieWVzXCIpO1xyXG4gICAgICAvLyAgICAgfVxyXG4gICAgICAvLyAgIH1cclxuICAgICAgLy8gfSxcclxuICAgICAgLy8geyBmaWVsZDogXCJidXNpbmVzc1R5cGVcIiwgdGl0bGU6IHRoaXMudHJhbnNsYXRlU2VydmljZS5pbnN0YW50KFwiYnVzaW5lc3NUeXBlXCIpLCB3aWR0aDogMTIwIH0sXHJcbiAgICAgIC8vIHsgZmllbGQ6IFwiY3JlYXRvclwiLCB0aXRsZTogdGhpcy50cmFuc2xhdGVTZXJ2aWNlLmluc3RhbnQoXCJjcmVhdG9yXCIpLCB3aWR0aDogMTIwIH0sXHJcbiAgICAgIC8vIHsgZmllbGQ6IFwiY3JlYXRlZFRpbWVcIiwgdGl0bGU6IHRoaXMudHJhbnNsYXRlU2VydmljZS5pbnN0YW50KFwiY3JlYXRlZFRpbWVcIiksIHdpZHRoOiAxMjAgfSxcclxuICAgICAgLy8geyBmaWVsZDogXCJsYXN0TW9kaWZpZXJcIiwgdGl0bGU6IHRoaXMudHJhbnNsYXRlU2VydmljZS5pbnN0YW50KFwibGFzdE1vZGlmaWVyXCIpLCB3aWR0aDogMTIwIH0sXHJcbiAgICAgIC8vIHtcclxuICAgICAgLy8gICBmaWVsZDogXCJsYXN0TW9kaWZpZWRUaW1lXCIsIHRpdGxlOiB0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKFwibGFzdE1vZGlmaWVkVGltZVwiKSwgd2lkdGg6IDEyMCwgc29ydGFibGU6IHRydWUsXHJcbiAgICAgIC8vICAgZm9ybWF0dGVyOiB7XHJcbiAgICAgIC8vICAgICB0eXBlOiAnZGF0ZXRpbWUnLFxyXG4gICAgICAvLyAgICAgb3B0aW9uczoge1xyXG4gICAgICAvLyAgICAgICBmb3JtYXQ6ICdZWVlZLU1NLUREIEhIOm1tOnNzJ1xyXG4gICAgICAvLyAgICAgfVxyXG4gICAgICAvLyAgIH0sXHJcbiAgICAgIC8vIH0sXHJcbiAgICBdO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBjcmVhdGVEZWZhdWx0UXVlcnlQYXJhbSgpIHtcclxuICAgIGNvbnN0IHF1ZXJ5UGFyYW0gPSB7XHJcbiAgICAgIGZpbHRlckFyZ3M6IG5ldyBQcm9jZXNzRmlsdGVyQ29uZGl0aW9uQXJncygpLFxyXG4gICAgICBmaWx0ZXJBcmdzRXh0OiB7fVxyXG4gICAgfTtcclxuXHJcbiAgICBxdWVyeVBhcmFtLmZpbHRlckFyZ3MucGFnZVNpemUgPSB0aGlzLmRlZmF1bHRQYWdlU2l6ZTtcclxuICAgIHF1ZXJ5UGFyYW0uZmlsdGVyQXJncy5wYWdlSW5kZXggPSAwO1xyXG4gICAgcXVlcnlQYXJhbS5maWx0ZXJBcmdzLk9yZGVyQnlMYXN0TW9kaWZpZWRUaW1lID0gbmV3IFRleHRWYWx1ZSgpO1xyXG4gICAgcXVlcnlQYXJhbS5maWx0ZXJBcmdzLk9yZGVyQnlMYXN0TW9kaWZpZWRUaW1lLnZhbHVlID0gT3JkZXJCeURpcmVjdGlvbi5EZXNjO1xyXG4gICAgcXVlcnlQYXJhbS5maWx0ZXJBcmdzLk9yZGVyQnlMYXN0TW9kaWZpZWRUaW1lLmhhc1ZhbHVlID0gdHJ1ZTtcclxuICAgIHF1ZXJ5UGFyYW0uZmlsdGVyQXJncy5iaWxsUHJvY2Vzc1R5cGUgPSBuZXcgVGV4dFZhbHVlKCk7XHJcbiAgICBxdWVyeVBhcmFtLmZpbHRlckFyZ3MuYmlsbFByb2Nlc3NUeXBlLnZhbHVlID0gQmlmTWV0YWRhdGFUeXBlLkJpZkNyZWF0aW9uUHJvY2VzcztcclxuICAgIHF1ZXJ5UGFyYW0uZmlsdGVyQXJncy5iaWxsUHJvY2Vzc1R5cGUuaGFzVmFsdWUgPSB0cnVlO1xyXG4gICAgcXVlcnlQYXJhbS5maWx0ZXJBcmdzLmlzRW5hYmxlZCA9IG5ldyBUZXh0VmFsdWUoKTtcclxuICAgIHF1ZXJ5UGFyYW0uZmlsdGVyQXJncy5pc0VuYWJsZWQudmFsdWUgPSBcInRydWVcIjtcclxuICAgIHF1ZXJ5UGFyYW0uZmlsdGVyQXJncy5pc0VuYWJsZWQuaGFzVmFsdWUgPSB0cnVlO1xyXG5cclxuXHJcbiAgICByZXR1cm4gcXVlcnlQYXJhbTtcclxuICB9XHJcbn1cclxuIl19