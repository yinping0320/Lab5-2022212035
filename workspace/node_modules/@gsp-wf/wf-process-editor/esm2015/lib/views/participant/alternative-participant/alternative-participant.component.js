/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { ChangeDetectorRef, Component, ComponentFactoryResolver, EventEmitter, Inject, Injector, Input, LOCALE_ID, Optional, Output, TemplateRef, ViewChild } from '@angular/core';
import { HttpService } from '@ecp-caf/caf-common';
import { DatagridComponent } from '@farris/ui-datagrid';
import { FDropdownDirective } from '@farris/ui-dropdown';
import { MessagerService } from '@farris/ui-messager';
import { BsModalService } from '@farris/ui-modal';
import { ExprEditMode, ExpressionService, InjectedType } from '@gsp-svc/expression';
import { ProcessDesignerUIState } from '../../../app/process-designer.uistate';
import { ProcessDeUtil } from '../../../domain/process-de-util';
import { PerformerEditComponent } from '../../performer/views/performer-edit/performer-edit.component';
import { ComponentParticipant, OrganizationParticipant, ParticipantInfo } from '../participant.info';
import { ParticipantUIState } from '../participant.uistate';
import { EditorTypes } from '@farris/ui-datagrid-editors';
import { WF_LANG_RESOURCES, WfLocalePipe } from '../../../i18n/pipe/wf-process-editor-locale.pipe';
export class AlternativeParticipantComponent {
    /**
     * @param {?} designerUIState
     * @param {?} uistate
     * @param {?} resolver
     * @param {?} injector
     * @param {?} modalService
     * @param {?} message
     * @param {?} expr
     * @param {?} http
     * @param {?} cdr
     * @param {?} localeId
     * @param {?} resources
     * @param {?} localePipe
     */
    constructor(designerUIState, uistate, resolver, injector, modalService, message, expr, http, cdr, localeId, resources, localePipe) {
        this.designerUIState = designerUIState;
        this.uistate = uistate;
        this.resolver = resolver;
        this.injector = injector;
        this.modalService = modalService;
        this.message = message;
        this.expr = expr;
        this.http = http;
        this.cdr = cdr;
        this.localeId = localeId;
        this.resources = resources;
        this.localePipe = localePipe;
        this.closeModal = new EventEmitter();
        this.submitModal = new EventEmitter();
        this.editorParams = {};
        this.nodeType = 'notifyActivity';
        this.isClose = true;
        this.participant = new ParticipantInfo();
        this.editState = 'new'; // 编辑状态，用于区分是新增还是编辑  new | edit
        // 编辑状态，用于区分是新增还是编辑  new | edit
        this.type = 'potentialOwner';
        this.operatorCollection = [
            { text: this.localePipe.transform('component.participant.currentUser'), value: 'currentUser' },
            { text: this.localePipe.transform('component.participant.procInstCreator'), value: 'procInstCreator' }
        ];
        this.columns = [
            {
                field: 'order', width: 25, title: this.localePipe.transform('component.participant.order'),
                editor: {
                    type: EditorTypes.NUMBERBOX, options: {}
                },
            }, {
                field: 'type', width: 50, title: this.localePipe.transform('component.participant.type'),
                formatter: {
                    type: 'enum',
                    options: { valueField: 'value', textField: 'text', data: this.uistate.typeCollection }
                }
            }, {
                field: 'performerName', width: 50, title: this.localePipe.transform('component.participant.performerName'), showTips: true, formatter: (/**
                 * @param {?} v
                 * @param {?} d
                 * @param {?} i
                 * @return {?}
                 */
                (v, d, i) => {
                    switch (d.type) {
                        case 'wf.UserParticipantExpression':
                            return d.performerName;
                        case 'wf.VariableParticipantExpression':
                            return ((/** @type {?} */ (d))).name;
                        case 'wf.PositionParticipantExpression':
                            return ((/** @type {?} */ (d))).performerName;
                        case 'wf.ComponentParticipantExpression':
                            return ((/** @type {?} */ (d))).name;
                        case 'wf.ReportingLineParticipantExpression':
                            return ((/** @type {?} */ (d))).reportingLineDefName + '-' + ((/** @type {?} */ (d))).dimension;
                        case 'wf.MatrixParticipantExpression':
                            return ((/** @type {?} */ (d))).matrixDefName + '-' + ((/** @type {?} */ (d))).dataFieldAlias;
                        case 'wf.ActivityExecutorParticipantExpression':
                            return ((/** @type {?} */ (d))).performerName;
                        case 'wf.OrganizationParticipantExpression':
                            return ((/** @type {?} */ (d))).organizationName;
                        default:
                            return '';
                    }
                })
            },
            {
                field: 'description', width: 100, title: this.localePipe.transform('component.participant.description'), showTips: true,
                formatter: (/**
                 * @param {?} v
                 * @param {?} d
                 * @param {?} i
                 * @return {?}
                 */
                (v, d, i) => {
                    switch (d.type) {
                        case 'wf.UserParticipantExpression':
                            return this.getUserPerformerDescription(d);
                        case 'wf.VariableParticipantExpression':
                            return this.getVariablePerformerDescription(d);
                        case 'wf.PositionParticipantExpression':
                            return this.getPositionPerformerDescription(d);
                        case 'wf.ComponentParticipantExpression':
                            return this.getComponentPerformerDescription(d);
                        case 'wf.ReportingLineParticipantExpression':
                            return this.getReportingLinePerformerDescription(d);
                        case 'wf.MatrixParticipantExpression':
                            return this.getMatrixPerformerDescription(d);
                        case 'wf.ActivityExecutorParticipantExpression':
                            return ((/** @type {?} */ (d))).performerName;
                        case 'wf.OrganizationParticipantExpression':
                            return ((/** @type {?} */ (d))).organizationName + '，且' + (((/** @type {?} */ (d))).includeChildren ? '包含下级' : '不包含下级');
                        default:
                            return '';
                    }
                })
            },
            {
                field: 'condition', width: 60, title: this.localePipe.transform('component.participant.condition'), showTips: true,
                editor: {
                    type: 'input-group',
                    options: {
                        groupText: '<i class="f-icon f-icon-lookup"></i>',
                        editable: false,
                        clickHandle: (/**
                         * @param {?} e
                         * @return {?}
                         */
                        (e) => {
                            e.formControl.setValue(e.instance.value ? e.instance.value : '');
                            this.editConditon(e);
                        }),
                    }
                }
            }
        ];
        this.localePipe = this.localePipe || new WfLocalePipe(localeId, resources);
        this.GetOrganizationType();
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        this.nodeType = this.editorParams.nodeType;
    }
    /**
     * @param {?} data
     * @return {?}
     */
    switchChange(data) {
        if (data) {
            this.clearPerformer('potentialOwner');
        }
    }
    /**
     * @param {?} data
     * @return {?}
     */
    assignStrategyChange(data) {
        // this.preAssignStrategy = data;
        if (data === 'ALL') {
            this.participant.isAllScope = true;
            this.clearPerformer('potentialOwner');
        }
        else {
            this.participant.isAllScope = false;
        }
    }
    /**
     * @param {?} data
     * @return {?}
     */
    isEnable(data) {
        if (data) {
            this.participant.isAllScope = true;
            this.clearPerformer('potentialOwner');
        }
        else {
            this.participant.isAllScope = false;
        }
    }
    /**
     * @param {?} performerType
     * @param {?} type
     * @return {?}
     */
    addPerformer(performerType, type) {
        this.editState = 'new';
        this.type = type;
        /** @type {?} */
        const compFactory = this.resolver.resolveComponentFactory(PerformerEditComponent);
        this.compRef = compFactory.create(this.injector);
        this.compRef.instance.performerType = performerType;
        /** @type {?} */
        const boxsize = this.attributeBoxSize(performerType);
        /** @type {?} */
        const modalConfig = {
            title: this.localePipe.transform('component.participant.participantSelection'),
            width: boxsize.width,
            height: boxsize.height,
            buttons: this.editFooter,
            showButtons: true
        };
        this.editDialog = this.modalService.show(this.compRef, modalConfig);
        // this.dropDownEl.close();
        if (this.dropDownE2) {
            this.dropDownE2.close();
        }
    }
    /**
     * @return {?}
     */
    editOK() {
        this.isClose = true;
        if (this.compRef) {
            /** @type {?} */
            const re = this.compRef.instance.getPerformers();
            if (re.userPerformers && re.userPerformers.length > 0) {
                for (const p of re.userPerformers) {
                    this.addUserPerformer(p);
                }
            }
            if (re.variable && re.variable !== null && re.variable.performerId) {
                this.addvariablePerformer(re.variable);
            }
            // 2023-7-28 组织岗支持多选
            if (re.positions && re.positions.length > 0) {
                this.addPositionPerformer(re.positions);
            }
            if (re.component && re.component.metadataId && re.component.methodCode) {
                this.addComponentPerformer(re.component);
            }
            if (re.reportingLine && re.reportingLine.reportingLineDefId && re.reportingLine.dimension) {
                this.addReportingLinePerformer(re.reportingLine);
            }
            if (re.matrix && re.matrix.matrixDefId) {
                this.addMatrixPerformer(re.matrix);
            }
            if (re.activityExecutorPerformers && re.activityExecutorPerformers.length > 0) {
                for (const a of re.activityExecutorPerformers) {
                    this.addActivityExecutorPerformer(a);
                }
            }
            if (re.organizationParticipant) {
                this.addOrganizationParticipant(re.organizationParticipant);
            }
        }
        if (this.editDialog && this.isClose) {
            this.editDialog.close();
        }
        // 编辑完成后刷新两个组件
        // this.humanPerformerGrid.refresh();
        this.potentialOwnerGrid.refresh();
    }
    /**
     * @private
     * @param {?} userPerformer
     * @return {?}
     */
    addUserPerformer(userPerformer) {
        if (this.type === 'potentialOwner') {
            /** @type {?} */
            const i = this.participant.potentialOwnerList.findIndex((/**
             * @param {?} a
             * @return {?}
             */
            a => (a.id === userPerformer.id || (((/** @type {?} */ (a))).performerId && ((/** @type {?} */ (a))).performerId === userPerformer.performerId))));
            if (i > -1) {
                // this.participant.potentialOwnerList[i] = userPerformer;
            }
            else {
                if (this.editState === 'edit') {
                    this.removePotentialOwner();
                }
                /** @type {?} */
                let index;
                if (this.participant.potentialOwnerList.length > 0) {
                    index = Math.max(...this.participant.potentialOwnerList.map((/**
                     * @param {?} p
                     * @return {?}
                     */
                    p => p.order))) + 1;
                }
                else {
                    index = 1;
                }
                userPerformer.order = index;
                this.participant.potentialOwnerList.push(userPerformer);
            }
            this.potentialOwnerGrid.loadData(this.participant.potentialOwnerList);
        }
    }
    /**
     * @private
     * @param {?} variable
     * @return {?}
     */
    addvariablePerformer(variable) {
        /** @type {?} */
        const v = variable;
        if (!v || !v.varValue) {
            this.message.info(this.localePipe.transform('component.participant.selectProcessVariables'));
            this.isClose = false;
        }
        else if (!v.varType) {
            this.message.info(this.localePipe.transform('component.participant.selectVariableValueType'));
            this.isClose = false;
        }
        else if (!v.relation) {
            this.message.info(this.localePipe.transform('component.participant.selectRelation'));
            this.isClose = false;
        }
        else {
            if (this.type === 'potentialOwner') {
                /** @type {?} */
                const i = this.participant.potentialOwnerList.findIndex((/**
                 * @param {?} a
                 * @return {?}
                 */
                a => (a.id === variable.id || (((/** @type {?} */ (a))).performerId && ((/** @type {?} */ (a))).performerId === variable.performerId))));
                if (i > -1) {
                    this.participant.potentialOwnerList[i] = variable;
                }
                else {
                    if (this.editState === 'edit') {
                        this.removePotentialOwner();
                    }
                    /** @type {?} */
                    let index;
                    if (this.participant.potentialOwnerList.length > 0) {
                        index = Math.max(...this.participant.potentialOwnerList.map((/**
                         * @param {?} p
                         * @return {?}
                         */
                        p => p.order))) + 1;
                    }
                    else {
                        index = 1;
                    }
                    variable.order = index;
                    this.participant.potentialOwnerList.push(variable);
                }
                this.potentialOwnerGrid.loadData(this.participant.potentialOwnerList);
            }
        }
    }
    /**
     * @private
     * @param {?} positions
     * @return {?}
     */
    addPositionPerformer(positions) {
        for (const position of positions) {
            if (!position.performerId) {
                this.message.info(this.localePipe.transform('component.participant.selectPosition'));
                this.isClose = false;
            }
            else {
                if ((!position.orgType || position.orgType == null) && (position.isRequired && position.positionType === '1')) {
                    this.message.info(this.localePipe.transform('component.participant.selectOrgType'));
                    this.isClose = false;
                }
                else if ((!position.orgId || position.orgId == null) && (position.isRequired && position.positionType === '1')) {
                    this.message.info(this.localePipe.transform('component.participant.orgFill'));
                    this.isClose = false;
                }
                else {
                    // (1)id一致，为编辑岗位；（2）performid一致，新增的用户，岗位已存在
                    if (this.type === 'potentialOwner') {
                        /** @type {?} */
                        const i = this.participant.potentialOwnerList.findIndex((/**
                         * @param {?} a
                         * @return {?}
                         */
                        a => {
                            if (a.type !== 'wf.PositionParticipantExpression') {
                                return false;
                            }
                            /** @type {?} */
                            const p = (/** @type {?} */ (a));
                            return (p.id === position.id);
                        }));
                        if (i > -1) {
                            this.participant.potentialOwnerList[i] = position;
                        }
                        else {
                            /** @type {?} */
                            let index;
                            if (this.participant.potentialOwnerList.length > 0) {
                                index = Math.max(...this.participant.potentialOwnerList.map((/**
                                 * @param {?} p
                                 * @return {?}
                                 */
                                p => p.order))) + 1;
                            }
                            else {
                                index = 1;
                            }
                            position.order = index;
                            this.participant.potentialOwnerList.push(position);
                        }
                        this.potentialOwnerGrid.loadData(this.participant.potentialOwnerList);
                    }
                }
            }
        }
    }
    /**
     * @private
     * @param {?} component
     * @return {?}
     */
    addComponentPerformer(component) {
        /** @type {?} */
        const cmp = new ComponentParticipant();
        cmp.id = component.id;
        cmp.metadataId = component.metadataId;
        cmp.methodCode = component.methodCode;
        cmp.methodName = component.methodName;
        cmp.name = component.name;
        cmp.actualParameters = component.actualParameters;
        cmp.type = 'wf.ComponentParticipantExpression';
        cmp.condition = component.condition;
        if (this.type === 'potentialOwner') {
            /** @type {?} */
            const i = this.participant.potentialOwnerList.findIndex((/**
             * @param {?} a
             * @return {?}
             */
            a => a.id === cmp.id));
            if (i > -1) {
                this.participant.potentialOwnerList[i] = cmp;
            }
            else {
                /** @type {?} */
                let index;
                if (this.participant.potentialOwnerList.length > 0) {
                    index = Math.max(...this.participant.potentialOwnerList.map((/**
                     * @param {?} p
                     * @return {?}
                     */
                    p => p.order))) + 1;
                }
                else {
                    index = 1;
                }
                cmp.order = index;
                this.participant.potentialOwnerList.push(cmp);
            }
            this.potentialOwnerGrid.loadData(this.participant.potentialOwnerList);
        }
    }
    /**
     * @private
     * @param {?} reportingLine
     * @return {?}
     */
    addReportingLinePerformer(reportingLine) {
        if (reportingLine.reportingReferObject === 'dept' && !reportingLine.refOrgId) {
            this.isClose = false;
            this.message.info(this.localePipe.transform('component.participant.refOrgIdNotNull'));
        }
        else if (reportingLine.reportingReferObject !== 'dept' && !reportingLine.refUserId && !reportingLine.refEmployeeId) { // 用户及其他人员汇报对象类型，参照用户和参照员工不能全部为空
            this.isClose = false;
            this.message.info(this.localePipe.transform('component.participant.refUserIdNotNull'));
        }
        else {
            this.isClose = true;
            if (this.type === 'potentialOwner') {
                /** @type {?} */
                const i = this.participant.potentialOwnerList.findIndex((/**
                 * @param {?} a
                 * @return {?}
                 */
                a => a.id === reportingLine.id));
                if (i > -1) {
                    this.participant.potentialOwnerList[i] = reportingLine;
                }
                else {
                    /** @type {?} */
                    const reportingLines = this.participant.potentialOwnerList.filter((/**
                     * @param {?} h
                     * @return {?}
                     */
                    h => h.type === 'wf.ReportingLineParticipantExpression'));
                    for (const r of reportingLines) {
                        /** @type {?} */
                        const reportingLineData = (/** @type {?} */ (r));
                        if (reportingLineData.reportingLineDefId === reportingLine.reportingLineDefId &&
                            reportingLineData.dimension === reportingLine.dimension &&
                            reportingLineData.refUserId === reportingLine.refUserId &&
                            reportingLineData.refEmployeeId === reportingLine.refEmployeeId &&
                            reportingLineData.refOrgId === reportingLine.refOrgId) {
                            this.message.error(this.localePipe.transform('component.participant.repDefConfigured'));
                            return;
                        }
                    }
                    /** @type {?} */
                    let index;
                    if (this.participant.potentialOwnerList.length > 0) {
                        index = Math.max(...this.participant.potentialOwnerList.map((/**
                         * @param {?} p
                         * @return {?}
                         */
                        p => p.order))) + 1;
                    }
                    else {
                        index = 1;
                    }
                    reportingLine.order = index;
                    this.participant.potentialOwnerList.push(reportingLine);
                }
                this.potentialOwnerGrid.loadData(this.participant.potentialOwnerList);
            }
        }
    }
    /**
     * @private
     * @param {?} matrix
     * @return {?}
     */
    addMatrixPerformer(matrix) {
        if (!matrix.conditionField1 && !matrix.conditionField2 && !matrix.conditionField3) {
            this.isClose = false;
            this.message.info(this.localePipe.transform('component.participant.atLeastOneCondition'));
        }
        else if (!matrix.dataFieldAlias) {
            this.isClose = false;
            this.message.info(this.localePipe.transform('component.participant.dataFieldAliasNotNull'));
        }
        else {
            this.isClose = true;
            if (this.type === 'potentialOwner') {
                /** @type {?} */
                const i = this.participant.potentialOwnerList.findIndex((/**
                 * @param {?} a
                 * @return {?}
                 */
                a => a.id === matrix.id));
                if (i > -1) {
                    this.participant.potentialOwnerList[i] = matrix;
                }
                else {
                    /** @type {?} */
                    const matrixParticipants = this.participant.potentialOwnerList.filter((/**
                     * @param {?} h
                     * @return {?}
                     */
                    h => h.type === 'wf.MatrixParticipantExpression'));
                    for (const m of matrixParticipants) {
                        /** @type {?} */
                        const matrixData = (/** @type {?} */ (m));
                        if (matrixData.matrixDefId === matrix.matrixDefId &&
                            matrixData.conditionField1 === matrix.conditionField1 &&
                            matrixData.conditionField2 === matrix.conditionField2 &&
                            matrixData.conditionField3 === matrix.conditionField3 &&
                            matrixData.dataFieldAlias === matrix.dataFieldAlias) {
                            this.message.error(this.localePipe.transform('component.participant.matrixConfigured'));
                            return;
                        }
                    }
                    /** @type {?} */
                    let index;
                    if (this.participant.potentialOwnerList.length > 0) {
                        index = Math.max(...this.participant.potentialOwnerList.map((/**
                         * @param {?} p
                         * @return {?}
                         */
                        p => p.order))) + 1;
                    }
                    else {
                        index = 1;
                    }
                    matrix.order = index;
                    this.participant.potentialOwnerList.push(matrix);
                }
                this.potentialOwnerGrid.loadData(this.participant.potentialOwnerList);
            }
        }
    }
    /**
     * @private
     * @param {?} activityExecutor
     * @return {?}
     */
    addActivityExecutorPerformer(activityExecutor) {
        if (this.type === 'potentialOwner') {
            /** @type {?} */
            const i = this.participant.potentialOwnerList.findIndex((/**
             * @param {?} a
             * @return {?}
             */
            a => (a.id === activityExecutor.id ||
                (((/** @type {?} */ (a))).activityDefId && ((/** @type {?} */ (a))).activityDefId === activityExecutor.activityDefId))));
            if (i < 0) {
                if (this.editState === 'edit') {
                    this.removePotentialOwner(); // 在编辑状态下配置了活动办理人参与者，先将选中的删除
                }
                /** @type {?} */
                let index;
                if (this.participant.potentialOwnerList.length > 0) {
                    index = Math.max(...this.participant.potentialOwnerList.map((/**
                     * @param {?} p
                     * @return {?}
                     */
                    p => p.order))) + 1;
                }
                else {
                    index = 1;
                }
                activityExecutor.order = index;
                this.participant.potentialOwnerList.push(activityExecutor);
            }
            this.potentialOwnerGrid.loadData(this.participant.potentialOwnerList);
        }
    }
    /**
     * @param {?} organization
     * @return {?}
     */
    addOrganizationParticipant(organization) {
        /** @type {?} */
        const organizationParticipant = new OrganizationParticipant();
        organizationParticipant.id = organization.id || ProcessDeUtil.GenerateElementId();
        organizationParticipant.type = 'wf.OrganizationParticipantExpression';
        organizationParticipant.condition = organization.condition;
        organizationParticipant.name = organization.name;
        organizationParticipant.actionScope = organization.actionScope;
        organizationParticipant.organizationLevel = organization.organizationLevel;
        organizationParticipant.organizationId = organization.organizationId;
        organizationParticipant.organizationCode = organization.organizationCode;
        organizationParticipant.organizationName = organization.organizationName;
        organizationParticipant.includeChildren = organization.includeChildren;
        organizationParticipant.parentsUntil = organization.parentsUntil;
        organizationParticipant.tag = organization.tag;
        if (this.type === 'potentialOwner') {
            this.participant.potentialOwnerList = this.participant.potentialOwnerList.filter((/**
             * @param {?} p
             * @return {?}
             */
            p => p.type !== 'wf.OrganizationParticipantExpression'));
            /** @type {?} */
            let index;
            if (this.participant.potentialOwnerList.length > 0) {
                index = Math.max(...this.participant.potentialOwnerList.map((/**
                 * @param {?} p
                 * @return {?}
                 */
                p => p.order))) + 1;
            }
            else {
                index = 1;
            }
            organizationParticipant.order = index;
            this.participant.potentialOwnerList.push(organizationParticipant);
            this.potentialOwnerGrid.loadData(this.participant.potentialOwnerList);
        }
    }
    /**
     * @return {?}
     */
    editCancel() {
        if (this.editDialog) {
            this.editDialog.close();
        }
    }
    /**
     * @param {?} type
     * @return {?}
     */
    editPerformer(type) {
        this.editState = 'edit';
        this.type = type;
        /** @type {?} */
        let selectedRow;
        if (type === 'potentialOwner') {
            selectedRow = this.potentialOwnerGrid.selectedRow;
        }
        if (!selectedRow) {
            this.message.info(this.localePipe.transform('component.participant.selectPerformer'));
            return;
        }
        /** @type {?} */
        const curPerformer = selectedRow.data;
        if (curPerformer) {
            /** @type {?} */
            const boxsize = this.attributeBoxSize(curPerformer.type);
            /** @type {?} */
            const modalConfig = {
                title: this.localePipe.transform('component.participant.participantSelection'),
                width: boxsize.width,
                height: boxsize.height,
                buttons: this.editFooter,
                showButtons: true
            };
            /** @type {?} */
            const compFactory = this.resolver.resolveComponentFactory(PerformerEditComponent);
            this.compRef = compFactory.create(this.injector);
            this.compRef.instance.performerType = curPerformer.type;
            this.compRef.instance.editState = this.editState;
            switch (curPerformer.type) {
                case 'wf.PositionParticipantExpression':
                    this.compRef.instance.performer = {
                        type: 'wf.PositionParticipantExpression',
                        value: curPerformer
                    };
                    break;
                case 'wf.UserParticipantExpression':
                    this.compRef.instance.performer = {
                        type: 'wf.UserParticipantExpression',
                        value: curPerformer
                    };
                    break;
                case 'wf.VariableParticipantExpression':
                    this.compRef.instance.performer = {
                        type: 'wf.VariableParticipantExpression',
                        value: curPerformer
                    };
                    break;
                case 'wf.ReportingLineParticipantExpression':
                    this.compRef.instance.performer = {
                        type: 'wf.ReportingLineParticipantExpression',
                        value: curPerformer
                    };
                    /** @type {?} */
                    const url = '/api/runtime/wf/v1.0/reportingLineDefinitions/' + ((/** @type {?} */ (curPerformer))).reportingLineDefId;
                    this.http.get(url).subscribe((/**
                     * @param {?} res
                     * @return {?}
                     */
                    (res) => {
                        if (!res) {
                            this.message.error(this.localePipe.transform('component.participant.definitionDeleted'));
                            if (type === 'potentialOwner') {
                                this.removePotentialOwner();
                            }
                        }
                        else {
                            this.editDialog = this.modalService.show(this.compRef, modalConfig);
                        }
                    }));
                    break;
                case 'wf.MatrixParticipantExpression':
                    this.compRef.instance.performer = {
                        type: 'wf.MatrixParticipantExpression',
                        value: curPerformer
                    };
                    /** @type {?} */
                    const urlMatrix = '/api/runtime/wf/v1.0/matrixDefinition/' + ((/** @type {?} */ (curPerformer))).matrixDefId;
                    this.http.get(urlMatrix).subscribe((/**
                     * @param {?} res
                     * @return {?}
                     */
                    (res) => {
                        if (!res) {
                            this.message.error(this.localePipe.transform('component.participant.matrixDeleted'));
                            if (type === 'potentialOwner') {
                                this.removePotentialOwner();
                            }
                        }
                        else {
                            this.editDialog = this.modalService.show(this.compRef, modalConfig);
                        }
                    }));
                    break;
                case 'wf.ComponentParticipantExpression':
                    this.compRef.instance.performer = {
                        type: 'wf.ComponentParticipantExpression',
                        value: curPerformer
                    };
                    break;
                case 'wf.ActivityExecutorParticipantExpression':
                    this.compRef.instance.performer = {
                        type: 'wf.ActivityExecutorParticipantExpression',
                        value: curPerformer
                    };
                    break;
                case 'wf.OrganizationParticipantExpression':
                    this.compRef.instance.performer = {
                        type: 'wf.OrganizationParticipantExpression',
                        value: curPerformer
                    };
                    break;
            }
            if (curPerformer.type !== 'wf.ReportingLineParticipantExpression' &&
                curPerformer.type !== 'wf.MatrixParticipantExpression') { // 汇报关系和矩阵单独处理
                this.editDialog = this.modalService.show(this.compRef, modalConfig);
            }
        }
    }
    /**
     * @param {?} type
     * @return {?}
     */
    removePerformer(type) {
        if (type === 'potentialOwner') {
            if (this.potentialOwnerGrid.selectedRow) {
                this.potentialOwnerGrid.endCellEdit();
                /** @type {?} */
                const index = this.participant.potentialOwnerList.findIndex((/**
                 * @param {?} p
                 * @return {?}
                 */
                p => p.id === this.potentialOwnerGrid.selectedRow.data.id));
                this.participant.potentialOwnerList.splice(index, 1);
                this.potentialOwnerGrid.loadData(this.participant.potentialOwnerList);
            }
            else {
                this.message.info(this.localePipe.transform('component.participant.selectParticipantInfo'));
            }
        }
    }
    /**
     * @param {?} type
     * @return {?}
     */
    clearPerformer(type) {
        if (type === 'potentialOwner') {
            this.participant.potentialOwnerList = new Array();
        }
        // this.humanPerformerGrid.loadData(this.participant.humanPerformerList);
        if (this.potentialOwnerGrid) {
            this.potentialOwnerGrid.loadData(this.participant.potentialOwnerList);
        }
    }
    /**
     * @param {?} type
     * @return {?}
     */
    moveUp(type) {
        if (type === 'potentialOwner') {
            /** @type {?} */
            const selectedRow = this.potentialOwnerGrid.selectedRow;
            if (!selectedRow) {
                this.message.info(this.localePipe.transform('component.participant.noRowSelected'));
                return;
            }
            /** @type {?} */
            const performer = selectedRow.data;
            /** @type {?} */
            const i = this.participant.potentialOwnerList.findIndex((/**
             * @param {?} c
             * @return {?}
             */
            c => c.id === performer.id));
            if (i === 0) {
                return;
            }
            /** @type {?} */
            const index = this.participant.potentialOwnerList[i].order;
            this.participant.potentialOwnerList[i].order = this.participant.potentialOwnerList[i - 1].order;
            this.participant.potentialOwnerList[i - 1].order = index;
            this.swapArray(this.participant.potentialOwnerList, i, i - 1);
            this.potentialOwnerGrid.loadData(this.participant.potentialOwnerList);
            this.potentialOwnerGrid.selectRow(performer.id, true);
        }
    }
    /**
     * @param {?} type
     * @return {?}
     */
    moveDown(type) {
        if (type === 'potentialOwner') {
            /** @type {?} */
            const selectedRow = this.potentialOwnerGrid.selectedRow;
            if (!selectedRow) {
                this.message.info(this.localePipe.transform('component.participant.noRowSelected'));
                return;
            }
            /** @type {?} */
            const performer = selectedRow.data;
            /** @type {?} */
            const i = this.participant.potentialOwnerList.findIndex((/**
             * @param {?} c
             * @return {?}
             */
            c => c.id === performer.id));
            if (i === this.participant.potentialOwnerList.length - 1) {
                return;
            }
            /** @type {?} */
            const index = this.participant.potentialOwnerList[i].order;
            this.participant.potentialOwnerList[i].order = this.participant.potentialOwnerList[i + 1].order;
            this.participant.potentialOwnerList[i + 1].order = index;
            this.swapArray(this.participant.potentialOwnerList, i, i + 1);
            this.potentialOwnerGrid.loadData(this.participant.potentialOwnerList);
            this.potentialOwnerGrid.selectRow(performer.id, true);
        }
    }
    /**
     * @private
     * @param {?} arr
     * @param {?} i1
     * @param {?} i2
     * @return {?}
     */
    swapArray(arr, i1, i2) {
        arr[i1] = arr.splice(i2, 1, arr[i1])[0];
        return arr;
    }
    /**
     * @return {?}
     */
    removePotentialOwner() {
        if (this.potentialOwnerGrid.selectedRow) {
            this.potentialOwnerGrid.endCellEdit();
            /** @type {?} */
            const i = this.participant.potentialOwnerList.findIndex((/**
             * @param {?} item
             * @return {?}
             */
            item => item.id === this.potentialOwnerGrid.selectedRow.data.id));
            this.participant.potentialOwnerList.splice(i, 1);
        }
        else {
            this.message.info(this.localePipe.transform('component.participant.selectpotentialtHandler'));
        }
    }
    /**
     * @private
     * @param {?} userPerformer
     * @return {?}
     */
    getUserPerformerDescription(userPerformer) {
        if (userPerformer.tag === 'expression') {
            return userPerformer.performerId;
        }
        else {
            if (userPerformer.orgName) {
                return this.localePipe.transform('component.participant.org') + userPerformer.orgName;
            }
            else {
                return '';
            }
        }
    }
    /**
     * @private
     * @param {?} variablePerformer
     * @return {?}
     */
    getVariablePerformerDescription(variablePerformer) {
        if (variablePerformer.tag === 'expression') {
            return variablePerformer.varValue;
        }
    }
    /**
     * @private
     * @param {?} position
     * @return {?}
     */
    getPositionPerformerDescription(position) {
        if (this.designerUIState.scene === 'inSuite') {
            return null;
        }
        if (position.positionType === '1') {
            if (position.orgId) {
                return this.localePipe.transform('component.participant.positionType1') + position.orgId;
            }
            else {
                return this.localePipe.transform('component.participant.positionType2');
            }
        }
        else if (position.positionType === '0') {
            return this.localePipe.transform('component.participant.positionType3');
        }
    }
    /**
     * @private
     * @param {?} position
     * @return {?}
     */
    getComponentPerformerDescription(position) {
        /** @type {?} */
        let des = this.localePipe.transform('component.participant.comp') + position.name
            + this.localePipe.transform('component.participant.parameters');
        if (position.actualParameters && position.actualParameters.length > 0) {
            position.actualParameters.forEach((/**
             * @param {?} p
             * @return {?}
             */
            p => {
                des += `${p.code}：${p.value}，`;
            }));
            des = des.substring(0, des.length - 1);
        }
        des += '}';
        return des;
    }
    /**
     * @private
     * @param {?} reportingLine
     * @return {?}
     */
    getReportingLinePerformerDescription(reportingLine) {
        /** @type {?} */
        let description = '';
        if (reportingLine.refUserId) {
            description += this.localePipe.transform('component.participant.referencePerson') + reportingLine.refUserId;
        }
        if (reportingLine.refEmployeeId) {
            description += this.localePipe.transform('component.participant.referencePerson') + reportingLine.refEmployeeId;
        }
        if (reportingLine.refOrgId) {
            if (reportingLine.refUserId) {
                description += `，`;
            }
            if (reportingLine.refEmployeeId) {
                description += `，`;
            }
            description += this.localePipe.transform('component.participant.referenceOrganization') + reportingLine.refOrgId;
        }
        return description;
    }
    /**
     * @private
     * @param {?} matrix
     * @return {?}
     */
    getMatrixPerformerDescription(matrix) {
        /** @type {?} */
        let description = '';
        if (matrix.conditionField1) {
            description += this.localePipe.transform('component.participant.condition1') + matrix.conditionFieldText1 + `，`;
        }
        if (matrix.conditionField2) {
            description += this.localePipe.transform('component.participant.condition2') + matrix.conditionFieldText2 + `，`;
        }
        if (matrix.conditionField3) {
            description += this.localePipe.transform('component.participant.condition3') + matrix.conditionFieldText3 + `，`;
        }
        if (matrix.dataFieldAlias) {
            description += this.localePipe.transform('component.participant.data') + matrix.dataFieldAlias + `，`;
        }
        return description.slice(0, description.length - 1);
    }
    /**
     * @private
     * @param {?} e
     * @return {?}
     */
    editConditon(e) {
        // this.expr.clearContext();
        if (this.designerUIState.schemas.length > 0) {
            for (const schema of this.designerUIState.schemas) {
                this.expr.addSchema('Schema', schema);
            }
            if (this.designerUIState.schemas[0].entityTypes && this.designerUIState.schemas[0].entityTypes.length > 0) {
                /** @type {?} */
                const entityType = this.designerUIState.schemas[0].entityTypes[0];
                this.expr.addInjectedEntity(entityType.name, 'Schema', entityType.name, InjectedType.EntityType);
            }
        }
        /** @type {?} */
        let context = new Array();
        context = this.designerUIState.addContext(context);
        if (this.designerUIState.subActivityContext.length > 0) {
            for (const variable of this.designerUIState.subActivityContext) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                c => c.key === variable.key))) {
                    context.push(variable);
                }
            }
        }
        if (this.designerUIState.activityComponentContext.length > 0) {
            for (const variable of this.designerUIState.activityComponentContext) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                c => c.key === variable.key))) {
                    context.push(variable);
                }
            }
        }
        if (context.length > 0) {
            for (const v of context) {
                this.expr.addContext(v);
            }
        }
        this.expr.addExpressionText(e.instance.value);
        this.expr.setEditPattern(ExprEditMode.Conditional); // 默认打开简易表达式编辑器
        this.expr.buildExpression().then((/**
         * @param {?} cond
         * @return {?}
         */
        (cond) => {
            if (this.potentialOwnerGrid && this.potentialOwnerGrid.selectedRow && this.potentialOwnerGrid.selectedRow.data) {
                /** @type {?} */
                let temp = this.participant.potentialOwnerList.find((/**
                 * @param {?} h
                 * @return {?}
                 */
                h => h.id === this.potentialOwnerGrid.selectedRow.data.id));
                temp.condition = cond;
            }
            e.formControl.setValue(cond);
            e.instance.cd.detectChanges();
            //点击确定后，去除表达式里面的新增的上下文变量
            if (context.length > 0) {
                this.expr.exprEntity.contextEntities = this.expr.exprEntity.contextEntities.filter((/**
                 * @param {?} x
                 * @return {?}
                 */
                x => !context.some((/**
                 * @param {?} y
                 * @return {?}
                 */
                y => y.key === x.key))));
            }
        }));
    }
    /**
     * @private
     * @return {?}
     */
    GetOrganizationType() {
        /** @type {?} */
        const url = '/api/runtime/sys/v1.0/authfields/globalauthfields';
        this.http.get(url)
            .subscribe((/**
         * @param {?} data
         * @return {?}
         */
        (data) => this.designerUIState.orgTypeCollection = data.map((/**
         * @param {?} d
         * @return {?}
         */
        d => ({ value: d.id, text: d.name })))));
    }
    // 构造不同参与者选择界面的尺寸 2023-7-5
    /**
     * @private
     * @param {?} boxType
     * @return {?}
     */
    attributeBoxSize(boxType) {
        /** @type {?} */
        const boxsize = {
            width: 760,
            height: 512
        };
        switch (boxType) {
            case 'wf.PositionParticipantExpression':
                boxsize.width = 760;
                boxsize.height = 455;
                return boxsize;
            case 'wf.UserParticipantExpression':
                boxsize.width = 760;
                boxsize.height = 320;
                return boxsize;
            case 'wf.VariableParticipantExpression':
                boxsize.width = 760;
                boxsize.height = 420;
                return boxsize;
                ;
            case 'wf.ReportingLineParticipantExpression':
                boxsize.width = 760;
                boxsize.height = 512;
                return boxsize;
                ;
            case 'wf.MatrixParticipantExpression':
                boxsize.width = 780;
                boxsize.height = 420;
                return boxsize;
                ;
            case 'wf.ComponentParticipantExpression':
                boxsize.width = 760;
                boxsize.height = 512;
                return boxsize;
                ;
            case 'wf.ActivityExecutorParticipantExpression':
                boxsize.width = 760;
                boxsize.height = 320;
                return boxsize;
                ;
            case 'wf.OrganizationParticipantExpression':
                boxsize.width = 760;
                boxsize.height = 360;
                return boxsize;
                ;
        }
    }
}
AlternativeParticipantComponent.decorators = [
    { type: Component, args: [{
                selector: 'wf-alternative-participant',
                template: "<div class=\"f-page-main d-flex flex-column farris-overflow-y-auto farris-overflow-x-auto\" style=\"height: 300px\">\r\n  <div class=\"f-page-header\">\r\n    <div class=\"farris-group-wrap\">\r\n      <div class=\"form-group farris-form-group\">\r\n        <label class=\"col-form-label\" style=\"width: 4.9rem\">\r\n          <span class=\"farris-label-text\">{{'component.orgPotentialOwner.limit'|wfLocale}}</span>\r\n        </label>\r\n        <div class=\"farris-input-wrap ml-1\">\r\n          <farris-switch [(ngModel)]=\"participant.isAllScope\" name=\"enable\" (valueChange)=\"isEnable($event)\"></farris-switch>\r\n        </div>\r\n        <div class=\"f-toolbar last-div farris-form-controls-inline\" [ngStyle]=\"{'visibility' : participant.isAllScope ? 'visible' : 'hidden'}\">\r\n          <div class=\"btn-group mr-2\"  fDropdown #dropdownE2=\"fDropdown\" [autoRectify]=\"true\">\r\n            <farris-button class=\"dropdown-toggle\" fDropdownToggle [type]=\"'link'\">\r\n              {{'component.participant.new'|wfLocale}}\r\n            </farris-button>\r\n            <div class=\"dropdown-menu\" fDropdownMenu>\r\n              <li class=\"dropdown-item\" (click)=\"addPerformer('wf.UserParticipantExpression','potentialOwner')\"><span>{{'component.participant.user'|wfLocale}}</span></li>\r\n              <li class=\"dropdown-item\" (click)=\"addPerformer('wf.VariableParticipantExpression','potentialOwner')\"><span>{{'component.participant.variable'|wfLocale}}</span></li>\r\n              <li class=\"dropdown-item\" (click)=\"addPerformer('wf.PositionParticipantExpression','potentialOwner')\"><span>{{designerUIState.scene==='inSuite'?(('component.participant.role'|wfLocale)):('component.participant.position'|wfLocale)}}</span></li>\r\n              <li class=\"dropdown-item\" (click)=\"addPerformer('wf.ReportingLineParticipantExpression','potentialOwner')\"><span>{{'component.participant.reportingLine'|wfLocale}}</span></li>\r\n              <li class=\"dropdown-item\" (click)=\"addPerformer('wf.ActivityExecutorParticipantExpression','potentialOwner')\"><span>{{'component.participant.activityExecutor'|wfLocale}}</span></li>\r\n              <li class=\"dropdown-item\" (click)=\"addPerformer('wf.MatrixParticipantExpression','potentialOwner')\"><span>{{'component.participant.matrix'|wfLocale}}</span></li>\r\n              <li class=\"dropdown-item\" (click)=\"addPerformer('wf.ComponentParticipantExpression','potentialOwner')\"><span>{{'component.participant.component'|wfLocale}}</span></li>\r\n              <li class=\"dropdown-item\" (click)=\"addPerformer('wf.OrganizationParticipantExpression','potentialOwner')\"><span>{{'component.participant.organization'|wfLocale}}\r\n              </span></li>\r\n            </div>\r\n          </div>\r\n          <farris-button  [type]=\"'link'\" (click)=\"editPerformer('potentialOwner')\">{{'component.participant.editPerformer'|wfLocale}}</farris-button>\r\n          <farris-button  [type]=\"'link'\" (click)=\"removePerformer('potentialOwner')\">{{'component.participant.removePerformer'|wfLocale}}</farris-button>\r\n          <farris-button  [type]=\"'link'\" (click)=\"clearPerformer('potentialOwner')\">{{'component.participant.clearPerformer'|wfLocale}}</farris-button>\r\n          <farris-button  [type]=\"'link'\" (click)=\"moveUp('potentialOwner')\">{{'component.participant.moveUp'|wfLocale}}</farris-button>\r\n          <farris-button  [type]=\"'link'\" (click)=\"moveDown('potentialOwner')\">{{'component.participant.moveDown'|wfLocale}}</farris-button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n  <div class=\"f-utils-fill farris-overflow-y-auto\">\r\n    <farris-datagrid #potentialOwnerGrid class=\"f-component-grid\" [columns]=\"columns\" [data]=\"participant.potentialOwnerList\" #defaultPerformerGrid [idField]=\"'id'\" [showLineNumber]=\"false\"\r\n      [striped]=\"true\" [showCheckbox]=\"false\" [pagination]=\"false\" [fit]=\"true\" [fitColumns]=\"true\" [editable]=\"true\" [editMode]=\"'cell'\"\r\n      [multiSelect]=\"false\">\r\n    </farris-datagrid>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #editFooter>\r\n  <button type=\"button\" class=\"btn btn-secondary btn-sm px-3 mx-2\" (click)=\"editCancel()\">{{'component.participant.clickCancel'|wfLocale}}</button>\r\n  <button type=\"button\" class=\"btn btn-primary btn-sm px-3 mx-2\" (click)=\"editOK()\">{{'component.participant.clickOK'|wfLocale}}</button>\r\n</ng-template>\r\n",
                providers: [
                    ParticipantUIState,
                    WfLocalePipe
                ],
                styles: [".container{display:flex;justify-content:space-between}.last-div{margin-left:auto}"]
            }] }
];
/** @nocollapse */
AlternativeParticipantComponent.ctorParameters = () => [
    { type: ProcessDesignerUIState },
    { type: ParticipantUIState },
    { type: ComponentFactoryResolver },
    { type: Injector },
    { type: BsModalService },
    { type: MessagerService },
    { type: ExpressionService },
    { type: HttpService },
    { type: ChangeDetectorRef, decorators: [{ type: Optional }] },
    { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
    { type: undefined, decorators: [{ type: Inject, args: [WF_LANG_RESOURCES,] }] },
    { type: WfLocalePipe, decorators: [{ type: Optional }] }
];
AlternativeParticipantComponent.propDecorators = {
    closeModal: [{ type: Output }],
    submitModal: [{ type: Output }],
    modalFooter: [{ type: ViewChild, args: ['iconSelectFooter',] }],
    dropDownE2: [{ type: ViewChild, args: ['dropdownE2',] }],
    editFooter: [{ type: ViewChild, args: ['editFooter',] }],
    potentialOwnerGrid: [{ type: ViewChild, args: ['potentialOwnerGrid',] }],
    editorParams: [{ type: Input }]
};
if (false) {
    /** @type {?} */
    AlternativeParticipantComponent.prototype.closeModal;
    /** @type {?} */
    AlternativeParticipantComponent.prototype.submitModal;
    /** @type {?} */
    AlternativeParticipantComponent.prototype.modalFooter;
    /** @type {?} */
    AlternativeParticipantComponent.prototype.dropDownE2;
    /** @type {?} */
    AlternativeParticipantComponent.prototype.editFooter;
    /** @type {?} */
    AlternativeParticipantComponent.prototype.potentialOwnerGrid;
    /** @type {?} */
    AlternativeParticipantComponent.prototype.editorParams;
    /** @type {?} */
    AlternativeParticipantComponent.prototype.nodeType;
    /** @type {?} */
    AlternativeParticipantComponent.prototype.editDialog;
    /** @type {?} */
    AlternativeParticipantComponent.prototype.compRef;
    /** @type {?} */
    AlternativeParticipantComponent.prototype.isClose;
    /** @type {?} */
    AlternativeParticipantComponent.prototype.participant;
    /** @type {?} */
    AlternativeParticipantComponent.prototype.editState;
    /** @type {?} */
    AlternativeParticipantComponent.prototype.type;
    /** @type {?} */
    AlternativeParticipantComponent.prototype.operatorCollection;
    /** @type {?} */
    AlternativeParticipantComponent.prototype.columns;
    /** @type {?} */
    AlternativeParticipantComponent.prototype.designerUIState;
    /**
     * @type {?}
     * @private
     */
    AlternativeParticipantComponent.prototype.uistate;
    /**
     * @type {?}
     * @private
     */
    AlternativeParticipantComponent.prototype.resolver;
    /**
     * @type {?}
     * @private
     */
    AlternativeParticipantComponent.prototype.injector;
    /**
     * @type {?}
     * @private
     */
    AlternativeParticipantComponent.prototype.modalService;
    /**
     * @type {?}
     * @private
     */
    AlternativeParticipantComponent.prototype.message;
    /**
     * @type {?}
     * @private
     */
    AlternativeParticipantComponent.prototype.expr;
    /**
     * @type {?}
     * @private
     */
    AlternativeParticipantComponent.prototype.http;
    /**
     * @type {?}
     * @private
     */
    AlternativeParticipantComponent.prototype.cdr;
    /**
     * @type {?}
     * @private
     */
    AlternativeParticipantComponent.prototype.localeId;
    /**
     * @type {?}
     * @private
     */
    AlternativeParticipantComponent.prototype.resources;
    /**
     * @type {?}
     * @private
     */
    AlternativeParticipantComponent.prototype.localePipe;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYWx0ZXJuYXRpdmUtcGFydGljaXBhbnQuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGdzcC13Zi93Zi1wcm9jZXNzLWVkaXRvci8iLCJzb3VyY2VzIjpbImxpYi92aWV3cy9wYXJ0aWNpcGFudC9hbHRlcm5hdGl2ZS1wYXJ0aWNpcGFudC9hbHRlcm5hdGl2ZS1wYXJ0aWNpcGFudC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFBRSxpQkFBaUIsRUFBRSxTQUFTLEVBQUUsd0JBQXdCLEVBQWdCLFlBQVksRUFBRSxNQUFNLEVBQUUsUUFBUSxFQUFFLEtBQUssRUFBRSxTQUFTLEVBQVUsUUFBUSxFQUFFLE1BQU0sRUFBRSxXQUFXLEVBQUUsU0FBUyxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQ3pNLE9BQU8sRUFBRSxXQUFXLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUNsRCxPQUFPLEVBQUUsaUJBQWlCLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUN4RCxPQUFPLEVBQUUsa0JBQWtCLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUN6RCxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFDdEQsT0FBTyxFQUFjLGNBQWMsRUFBRSxNQUFNLGtCQUFrQixDQUFDO0FBRTlELE9BQU8sRUFBRSxZQUFZLEVBQUUsaUJBQWlCLEVBQUUsWUFBWSxFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFDcEYsT0FBTyxFQUFFLHNCQUFzQixFQUFFLE1BQU0sdUNBQXVDLENBQUM7QUFFL0UsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLGlDQUFpQyxDQUFDO0FBRWhFLE9BQU8sRUFBRSxzQkFBc0IsRUFBRSxNQUFNLCtEQUErRCxDQUFDO0FBRXZHLE9BQU8sRUFBK0Isb0JBQW9CLEVBQXFCLHVCQUF1QixFQUFFLGVBQWUsRUFBdUYsTUFBTSxxQkFBcUIsQ0FBQztBQUMxTyxPQUFPLEVBQUUsa0JBQWtCLEVBQUUs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O0lBQ3JELG9EQUFrQjs7SUFFbEIsK0NBQXdCOztJQUV4Qiw2REFHRTs7SUFFRixrREEyRUs7O0lBR0gsMERBQThDOzs7OztJQUM5QyxrREFBbUM7Ozs7O0lBQ25DLG1EQUEwQzs7Ozs7SUFDMUMsbURBQTBCOzs7OztJQUMxQix1REFBb0M7Ozs7O0lBQ3BDLGtEQUFnQzs7Ozs7SUFDaEMsK0NBQStCOzs7OztJQUMvQiwrQ0FBeUI7Ozs7O0lBQ3pCLDhDQUEwQzs7Ozs7SUFDMUMsbURBQTJDOzs7OztJQUMzQyxvREFBaUQ7Ozs7O0lBQ2pELHFEQUE0QyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENoYW5nZURldGVjdG9yUmVmLCBDb21wb25lbnQsIENvbXBvbmVudEZhY3RvcnlSZXNvbHZlciwgQ29tcG9uZW50UmVmLCBFdmVudEVtaXR0ZXIsIEluamVjdCwgSW5qZWN0b3IsIElucHV0LCBMT0NBTEVfSUQsIE9uSW5pdCwgT3B0aW9uYWwsIE91dHB1dCwgVGVtcGxhdGVSZWYsIFZpZXdDaGlsZCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBIdHRwU2VydmljZSB9IGZyb20gJ0BlY3AtY2FmL2NhZi1jb21tb24nO1xyXG5pbXBvcnQgeyBEYXRhZ3JpZENvbXBvbmVudCB9IGZyb20gJ0BmYXJyaXMvdWktZGF0YWdyaWQnO1xyXG5pbXBvcnQgeyBGRHJvcGRvd25EaXJlY3RpdmUgfSBmcm9tICdAZmFycmlzL3VpLWRyb3Bkb3duJztcclxuaW1wb3J0IHsgTWVzc2FnZXJTZXJ2aWNlIH0gZnJvbSAnQGZhcnJpcy91aS1tZXNzYWdlcic7XHJcbmltcG9ydCB7IEJzTW9kYWxSZWYsIEJzTW9kYWxTZXJ2aWNlIH0gZnJvbSAnQGZhcnJpcy91aS1tb2RhbCc7XHJcbmltcG9ydCB7IFR5cGVDb252ZXJ0ZXIgfSBmcm9tICdAZmFycmlzL2lkZS1wcm9wZXJ0eS1wYW5lbCc7XHJcbmltcG9ydCB7IEV4cHJFZGl0TW9kZSwgRXhwcmVzc2lvblNlcnZpY2UsIEluamVjdGVkVHlwZSB9IGZyb20gJ0Bnc3Atc3ZjL2V4cHJlc3Npb24nO1xyXG5pbXBvcnQgeyBQcm9jZXNzRGVzaWduZXJVSVN0YXRlIH0gZnJvbSAnLi4vLi4vLi4vYXBwL3Byb2Nlc3MtZGVzaWduZXIudWlzdGF0ZSc7XHJcbmltcG9ydCB7IE9yZ2FuaXphdGlvblBhcnRpY2lwYW50RXhwcmVzc2lvbiB9IGZyb20gJy4uLy4uLy4uL2RvbWFpbi9lbnRpdGllcy9vcmdhbml6YXRpb24tcGFydGljaXBhbnQtZXhwcmVzc2lvbic7XHJcbmltcG9ydCB7IFByb2Nlc3NEZVV0aWwgfSBmcm9tICcuLi8uLi8uLi9kb21haW4vcHJvY2Vzcy1kZS11dGlsJztcclxuaW1wb3J0IHsgQ29tcG9uZW50UGVyZm9ybWVyIH0gZnJvbSAnLi4vLi4vcGVyZm9ybWVyL3ZpZXdzL2NvbXBvbmVudC1wZXJmb3JtZXIvY29tcG9uZW50LXBlcmZvcm1lci5lbnRpdHknO1xyXG5pbXBvcnQgeyBQZXJmb3JtZXJFZGl0Q29tcG9uZW50IH0gZnJvbSAnLi4vLi4vcGVyZm9ybWVyL3ZpZXdzL3BlcmZvcm1lci1lZGl0L3BlcmZvcm1lci1lZGl0LmNvbXBvbmVudCc7XHJcbmltcG9ydCB7IEFzc2lnbkNvbmZpZyB9IGZyb20gJy4uL2Fzc2lnbi1jb25maWcnO1xyXG5pbXBvcnQgeyBBY3Rpdml0eUV4ZWN1dG9yUGFydGljaXBhbnQsIENvbXBvbmVudFBhcnRpY2lwYW50LCBNYXRyaXhQYXJ0aWNpcGFudCwgT3JnYW5pemF0aW9uUGFydGljaXBhbnQsIFBhcnRpY2lwYW50SW5mbywgUG9zaXRpb25QYXJ0aWNpcGFudCwgUmVwb3J0aW5nTGluZVBhcnRpY2lwYW50LCBVc2VyUGFydGljaXBhbnQsIFZhcmlhYmxlUGFydGljaXBhbnQgfSBmcm9tICcuLi9wYXJ0aWNpcGFudC5pbmZvJztcclxuaW1wb3J0IHsgUGFydGljaXBhbnRVSVN0YXRlIH0gZnJvbSAnLi4vcGFydGljaXBhbnQudWlzdGF0ZSc7XHJcbmltcG9ydCB7IEVkaXRvclR5cGVzIH0gZnJvbSAnQGZhcnJpcy91aS1kYXRhZ3JpZC1lZGl0b3JzJztcclxuaW1wb3J0IHsgV0ZfTEFOR19SRVNPVVJDRVMsIFdmTG9jYWxlUGlwZSB9IGZyb20gJy4uLy4uLy4uL2kxOG4vcGlwZS93Zi1wcm9jZXNzLWVkaXRvci1sb2NhbGUucGlwZSc7XHJcbmltcG9ydCB7IFdGX1BST0NFU1NfRURJVE9SX0xBTkdfUkVTT1VSQ0VTIH0gZnJvbSAnLi4vLi4vLi4vaTE4bi9hc3NldHMvbGFuZy5yZXNvdXJjZSc7XHJcblxyXG5AQ29tcG9uZW50KHtcclxuICBzZWxlY3RvcjogJ3dmLWFsdGVybmF0aXZlLXBhcnRpY2lwYW50JyxcclxuICB0ZW1wbGF0ZVVybDogJy4vYWx0ZXJuYXRpdmUtcGFydGljaXBhbnQuY29tcG9uZW50Lmh0bWwnLFxyXG4gIHN0eWxlVXJsczogWycuL2FsdGVybmF0aXZlLXBhcnRpY2lwYW50LmNvbXBvbmVudC5jc3MnXSxcclxuICBwcm92aWRlcnM6IFtcclxuICAgIFBhcnRpY2lwYW50VUlTdGF0ZSxcclxuICAgICBXZkxvY2FsZVBpcGVcclxuICBdXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBBbHRlcm5hdGl2ZVBhcnRpY2lwYW50Q29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0IHtcclxuXHJcbiAgQE91dHB1dCgpIGNsb3NlTW9kYWwgPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcclxuICBAT3V0cHV0KCkgc3VibWl0TW9kYWwgPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcclxuXHJcbiAgQFZpZXdDaGlsZCgnaWNvblNlbGVjdEZvb3RlcicpIG1vZGFsRm9vdGVyOiBUZW1wbGF0ZVJlZjxhbnk+O1xyXG4gIC8vIEBWaWV3Q2hpbGQoJ2Ryb3Bkb3duRWwnKSBkcm9wRG93bkVsOiBGRHJvcGRvd25EaXJlY3RpdmU7XHJcbiAgQFZpZXdDaGlsZCgnZHJvcGRvd25FMicpIGRyb3BEb3duRTI6IEZEcm9wZG93bkRpcmVjdGl2ZTtcclxuICBAVmlld0NoaWxkKCdlZGl0Rm9vdGVyJykgZWRpdEZvb3RlcjogVGVtcGxhdGVSZWY8YW55PjtcclxuICAvLyBAVmlld0NoaWxkKCdodW1hblBlcmZvcm1lckdyaWQnKSBodW1hblBlcmZvcm1lckdyaWQ6IERhdGFncmlkQ29tcG9uZW50O1xyXG4gIEBWaWV3Q2hpbGQoJ3BvdGVudGlhbE93bmVyR3JpZCcpIHBvdGVudGlhbE93bmVyR3JpZDogRGF0YWdyaWRDb21wb25lbnQ7XHJcblxyXG4gIEBJbnB1dCgpIGVkaXRvclBhcmFtczogYW55ID0ge307XHJcblxyXG4gIG5vZGVUeXBlOiAndXNlckFjdGl2aXR5JyB8ICdub3RpZnlBY3Rpdml0eScgID0gJ25vdGlmeUFjdGl2aXR5JztcclxuXHJcbiAgZWRpdERpYWxvZzogQnNNb2RhbFJlZjtcclxuICBjb21wUmVmOiBDb21wb25lbnRSZWY8UGVyZm9ybWVyRWRpdENvbXBvbmVudD47XHJcbiAgaXNDbG9zZSA9IHRydWU7XHJcblxyXG4gIHBhcnRpY2lwYW50OiBQYXJ0aWNpcGFudEluZm8gPSBuZXcgUGFydGljaXBhbnRJbmZvKCk7XHJcbiAgZWRpdFN0YXRlID0gJ25ldyc7IC8vIOe8lui+keeKtuaAge+8jOeUqOS6juWMuuWIhuaYr+aWsOWinui/mOaYr+e8lui+kSAgbmV3IHwgZWRpdFxyXG5cclxuICB0eXBlID0gJ3BvdGVudGlhbE93bmVyJztcclxuXHJcbiAgb3BlcmF0b3JDb2xsZWN0aW9uID0gW1xyXG4gICAgeyB0ZXh0OiB0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKCdjb21wb25lbnQucGFydGljaXBhbnQuY3VycmVudFVzZXInKSwgdmFsdWU6ICdjdXJyZW50VXNlcicgfSxcclxuICAgIHsgdGV4dDogdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybSgnY29tcG9uZW50LnBhcnRpY2lwYW50LnByb2NJbnN0Q3JlYXRvcicpLCB2YWx1ZTogJ3Byb2NJbnN0Q3JlYXRvcicgfVxyXG4gIF07XHJcblxyXG4gIGNvbHVtbnMgPSBbXHJcbiAgICB7XHJcbiAgICAgIGZpZWxkOiAnb3JkZXInLCB3aWR0aDogMjUsIHRpdGxlOiB0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKCdjb21wb25lbnQucGFydGljaXBhbnQub3JkZXInKSxcclxuICAgICAgZWRpdG9yOiB7XHJcbiAgICAgICAgdHlwZTogRWRpdG9yVHlwZXMuTlVNQkVSQk9YLCBvcHRpb25zOiB7XHJcbiAgICAgICAgfVxyXG4gICAgICB9LFxyXG4gICAgfSwge1xyXG4gICAgZmllbGQ6ICd0eXBlJywgd2lkdGg6IDUwLCB0aXRsZTogdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybSgnY29tcG9uZW50LnBhcnRpY2lwYW50LnR5cGUnKSxcclxuICAgIGZvcm1hdHRlcjoge1xyXG4gICAgICB0eXBlOiAnZW51bScsXHJcbiAgICAgIG9wdGlvbnM6IHsgdmFsdWVGaWVsZDogJ3ZhbHVlJywgdGV4dEZpZWxkOiAndGV4dCcsIGRhdGE6IHRoaXMudWlzdGF0ZS50eXBlQ29sbGVjdGlvbiB9XHJcbiAgICB9XHJcbiAgICB9LCB7XHJcbiAgICBmaWVsZDogJ3BlcmZvcm1lck5hbWUnLCB3aWR0aDogNTAsIHRpdGxlOiB0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKCdjb21wb25lbnQucGFydGljaXBhbnQucGVyZm9ybWVyTmFtZScpLCBzaG93VGlwczogdHJ1ZSwgZm9ybWF0dGVyOiAodiwgZCwgaSkgPT4ge1xyXG4gICAgICBzd2l0Y2ggKGQudHlwZSkge1xyXG4gICAgICAgIGNhc2UgJ3dmLlVzZXJQYXJ0aWNpcGFudEV4cHJlc3Npb24nOlxyXG4gICAgICAgICAgcmV0dXJuIGQucGVyZm9ybWVyTmFtZTtcclxuICAgICAgICBjYXNlICd3Zi5WYXJpYWJsZVBhcnRpY2lwYW50RXhwcmVzc2lvbic6XHJcbiAgICAgICAgICByZXR1cm4gKGQgYXMgVmFyaWFibGVQYXJ0aWNpcGFudCkubmFtZTtcclxuICAgICAgICBjYXNlICd3Zi5Qb3NpdGlvblBhcnRpY2lwYW50RXhwcmVzc2lvbic6XHJcbiAgICAgICAgICByZXR1cm4gKGQgYXMgUG9zaXRpb25QYXJ0aWNpcGFudCkucGVyZm9ybWVyTmFtZTtcclxuICAgICAgICBjYXNlICd3Zi5Db21wb25lbnRQYXJ0aWNpcGFudEV4cHJlc3Npb24nOlxyXG4gICAgICAgICAgcmV0dXJuIChkIGFzIENvbXBvbmVudFBhcnRpY2lwYW50KS5uYW1lO1xyXG4gICAgICAgIGNhc2UgJ3dmLlJlcG9ydGluZ0xpbmVQYXJ0aWNpcGFudEV4cHJlc3Npb24nOlxyXG4gICAgICAgICAgcmV0dXJuIChkIGFzIFJlcG9ydGluZ0xpbmVQYXJ0aWNpcGFudCkucmVwb3J0aW5nTGluZURlZk5hbWUgKyAnLScgKyAoZCBhcyBSZXBvcnRpbmdMaW5lUGFydGljaXBhbnQpLmRpbWVuc2lvbjtcclxuICAgICAgICBjYXNlICd3Zi5NYXRyaXhQYXJ0aWNpcGFudEV4cHJlc3Npb24nOlxyXG4gICAgICAgICAgcmV0dXJuIChkIGFzIE1hdHJpeFBhcnRpY2lwYW50KS5tYXRyaXhEZWZOYW1lICsgJy0nICsgKGQgYXMgTWF0cml4UGFydGljaXBhbnQpLmRhdGFGaWVsZEFsaWFzO1xyXG4gICAgICAgIGNhc2UgJ3dmLkFjdGl2aXR5RXhlY3V0b3JQYXJ0aWNpcGFudEV4cHJlc3Npb24nOlxyXG4gICAgICAgICAgcmV0dXJuIChkIGFzIEFjdGl2aXR5RXhlY3V0b3JQYXJ0aWNpcGFudCkucGVyZm9ybWVyTmFtZTtcclxuICAgICAgICBjYXNlICd3Zi5Pcmdhbml6YXRpb25QYXJ0aWNpcGFudEV4cHJlc3Npb24nOlxyXG4gICAgICAgICAgcmV0dXJuIChkIGFzIE9yZ2FuaXphdGlvblBhcnRpY2lwYW50KS5vcmdhbml6YXRpb25OYW1lO1xyXG4gICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICByZXR1cm4gJyc7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9LFxyXG4gIHtcclxuICAgIGZpZWxkOiAnZGVzY3JpcHRpb24nLCB3aWR0aDogMTAwLCB0aXRsZTogdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybSgnY29tcG9uZW50LnBhcnRpY2lwYW50LmRlc2NyaXB0aW9uJyksIHNob3dUaXBzOiB0cnVlLFxyXG4gICAgZm9ybWF0dGVyOiAodiwgZCwgaSkgPT4ge1xyXG4gICAgICBzd2l0Y2ggKGQudHlwZSkge1xyXG4gICAgICAgIGNhc2UgJ3dmLlVzZXJQYXJ0aWNpcGFudEV4cHJlc3Npb24nOlxyXG4gICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0VXNlclBlcmZvcm1lckRlc2NyaXB0aW9uKGQpO1xyXG4gICAgICAgIGNhc2UgJ3dmLlZhcmlhYmxlUGFydGljaXBhbnRFeHByZXNzaW9uJzpcclxuICAgICAgICAgIHJldHVybiB0aGlzLmdldFZhcmlhYmxlUGVyZm9ybWVyRGVzY3JpcHRpb24oZCk7XHJcbiAgICAgICAgY2FzZSAnd2YuUG9zaXRpb25QYXJ0aWNpcGFudEV4cHJlc3Npb24nOlxyXG4gICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0UG9zaXRpb25QZXJmb3JtZXJEZXNjcmlwdGlvbihkKTtcclxuICAgICAgICBjYXNlICd3Zi5Db21wb25lbnRQYXJ0aWNpcGFudEV4cHJlc3Npb24nOlxyXG4gICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0Q29tcG9uZW50UGVyZm9ybWVyRGVzY3JpcHRpb24oZCk7XHJcbiAgICAgICAgY2FzZSAnd2YuUmVwb3J0aW5nTGluZVBhcnRpY2lwYW50RXhwcmVzc2lvbic6XHJcbiAgICAgICAgICByZXR1cm4gdGhpcy5nZXRSZXBvcnRpbmdMaW5lUGVyZm9ybWVyRGVzY3JpcHRpb24oZCk7XHJcbiAgICAgICAgY2FzZSAnd2YuTWF0cml4UGFydGljaXBhbnRFeHByZXNzaW9uJzpcclxuICAgICAgICAgIHJldHVybiB0aGlzLmdldE1hdHJpeFBlcmZvcm1lckRlc2NyaXB0aW9uKGQpO1xyXG4gICAgICAgIGNhc2UgJ3dmLkFjdGl2aXR5RXhlY3V0b3JQYXJ0aWNpcGFudEV4cHJlc3Npb24nOlxyXG4gICAgICAgICAgcmV0dXJuIChkIGFzIEFjdGl2aXR5RXhlY3V0b3JQYXJ0aWNpcGFudCkucGVyZm9ybWVyTmFtZTtcclxuICAgICAgICBjYXNlICd3Zi5Pcmdhbml6YXRpb25QYXJ0aWNpcGFudEV4cHJlc3Npb24nOlxyXG4gICAgICAgICAgcmV0dXJuIChkIGFzIE9yZ2FuaXphdGlvblBhcnRpY2lwYW50KS5vcmdhbml6YXRpb25OYW1lICsgJ++8jOS4lCcgKyAoKGQgYXMgT3JnYW5pemF0aW9uUGFydGljaXBhbnQpLmluY2x1ZGVDaGlsZHJlbiA/ICfljIXlkKvkuIvnuqcnIDogJ+S4jeWMheWQq+S4i+e6pycpO1xyXG4gICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICByZXR1cm4gJyc7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9LFxyXG4gIHtcclxuICAgIGZpZWxkOiAnY29uZGl0aW9uJywgd2lkdGg6IDYwLCB0aXRsZTogdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybSgnY29tcG9uZW50LnBhcnRpY2lwYW50LmNvbmRpdGlvbicpLCBzaG93VGlwczogdHJ1ZSxcclxuICAgIGVkaXRvcjoge1xyXG4gICAgICB0eXBlOiAnaW5wdXQtZ3JvdXAnLFxyXG4gICAgICBvcHRpb25zOiB7XHJcbiAgICAgICAgZ3JvdXBUZXh0OiAnPGkgY2xhc3M9XCJmLWljb24gZi1pY29uLWxvb2t1cFwiPjwvaT4nLFxyXG4gICAgICAgIGVkaXRhYmxlOiBmYWxzZSxcclxuICAgICAgICBjbGlja0hhbmRsZTogKGUpID0+IHtcclxuICAgICAgICAgIGUuZm9ybUNvbnRyb2wuc2V0VmFsdWUoZS5pbnN0YW5jZS52YWx1ZSA/IGUuaW5zdGFuY2UudmFsdWUgOiAnJyk7XHJcbiAgICAgICAgICB0aGlzLmVkaXRDb25kaXRvbihlKTtcclxuICAgICAgICB9LFxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICB9XTtcclxuXHJcbiAgY29uc3RydWN0b3IoXHJcbiAgICBwdWJsaWMgZGVzaWduZXJVSVN0YXRlOiBQcm9jZXNzRGVzaWduZXJVSVN0YXRlLFxyXG4gICAgcHJpdmF0ZSB1aXN0YXRlOiBQYXJ0aWNpcGFudFVJU3RhdGUsXHJcbiAgICBwcml2YXRlIHJlc29sdmVyOiBDb21wb25lbnRGYWN0b3J5UmVzb2x2ZXIsXHJcbiAgICBwcml2YXRlIGluamVjdG9yOiBJbmplY3RvcixcclxuICAgIHByaXZhdGUgbW9kYWxTZXJ2aWNlOiBCc01vZGFsU2VydmljZSxcclxuICAgIHByaXZhdGUgbWVzc2FnZTogTWVzc2FnZXJTZXJ2aWNlLFxyXG4gICAgcHJpdmF0ZSBleHByOiBFeHByZXNzaW9uU2VydmljZSxcclxuICAgIHByaXZhdGUgaHR0cDogSHR0cFNlcnZpY2UsXHJcbiAgICBAT3B0aW9uYWwoKSBwcml2YXRlIGNkcjogQ2hhbmdlRGV0ZWN0b3JSZWYsXHJcbiAgICBASW5qZWN0KExPQ0FMRV9JRCkgcHJpdmF0ZSBsb2NhbGVJZDogc3RyaW5nLFxyXG4gICAgQEluamVjdChXRl9MQU5HX1JFU09VUkNFUykgcHJpdmF0ZSByZXNvdXJjZXM6IGFueSxcclxuICAgIEBPcHRpb25hbCgpIHByaXZhdGUgbG9jYWxlUGlwZTogV2ZMb2NhbGVQaXBlLFxyXG4gICkge1xyXG4gICAgdGhpcy5sb2NhbGVQaXBlID0gdGhpcy5sb2NhbGVQaXBlIHx8IG5ldyBXZkxvY2FsZVBpcGUobG9jYWxlSWQsIHJlc291cmNlcyk7XHJcbiAgICB0aGlzLkdldE9yZ2FuaXphdGlvblR5cGUoKTtcclxuICB9XHJcblxyXG4gIG5nT25Jbml0KCkge1xyXG4gICAgdGhpcy5ub2RlVHlwZSA9IHRoaXMuZWRpdG9yUGFyYW1zLm5vZGVUeXBlO1xyXG4gIH1cclxuXHJcbiAgc3dpdGNoQ2hhbmdlKGRhdGE6IGJvb2xlYW4pIHtcclxuICAgIGlmIChkYXRhKSB7XHJcbiAgICAgIHRoaXMuY2xlYXJQZXJmb3JtZXIoJ3BvdGVudGlhbE93bmVyJyk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBhc3NpZ25TdHJhdGVneUNoYW5nZShkYXRhKSB7XHJcbiAgICAvLyB0aGlzLnByZUFzc2lnblN0cmF0ZWd5ID0gZGF0YTtcclxuICAgIGlmKGRhdGEgPT09ICdBTEwnKSB7XHJcbiAgICAgIHRoaXMucGFydGljaXBhbnQuaXNBbGxTY29wZSA9IHRydWU7XHJcbiAgICAgIHRoaXMuY2xlYXJQZXJmb3JtZXIoJ3BvdGVudGlhbE93bmVyJyk7XHJcbiAgICB9ZWxzZSB7XHJcbiAgICAgIHRoaXMucGFydGljaXBhbnQuaXNBbGxTY29wZSA9IGZhbHNlO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgaXNFbmFibGUoZGF0YSkge1xyXG4gICAgaWYoZGF0YSkge1xyXG4gICAgICB0aGlzLnBhcnRpY2lwYW50LmlzQWxsU2NvcGUgPSB0cnVlO1xyXG4gICAgICB0aGlzLmNsZWFyUGVyZm9ybWVyKCdwb3RlbnRpYWxPd25lcicpO1xyXG4gICAgfWVsc2Uge1xyXG4gICAgICB0aGlzLnBhcnRpY2lwYW50LmlzQWxsU2NvcGUgPSBmYWxzZTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGFkZFBlcmZvcm1lcihwZXJmb3JtZXJUeXBlOiBzdHJpbmcsIHR5cGU6IHN0cmluZykge1xyXG4gICAgdGhpcy5lZGl0U3RhdGUgPSAnbmV3JztcclxuICAgIHRoaXMudHlwZSA9IHR5cGU7XHJcbiAgICBjb25zdCBjb21wRmFjdG9yeSA9IHRoaXMucmVzb2x2ZXIucmVzb2x2ZUNvbXBvbmVudEZhY3RvcnkoUGVyZm9ybWVyRWRpdENvbXBvbmVudCk7XHJcbiAgICB0aGlzLmNvbXBSZWYgPSBjb21wRmFjdG9yeS5jcmVhdGUodGhpcy5pbmplY3Rvcik7XHJcbiAgICB0aGlzLmNvbXBSZWYuaW5zdGFuY2UucGVyZm9ybWVyVHlwZSA9IHBlcmZvcm1lclR5cGU7XHJcbiAgICBjb25zdCBib3hzaXplID0gdGhpcy5hdHRyaWJ1dGVCb3hTaXplKHBlcmZvcm1lclR5cGUpO1xyXG4gICAgY29uc3QgbW9kYWxDb25maWcgPSB7XHJcbiAgICAgIHRpdGxlOiB0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKCdjb21wb25lbnQucGFydGljaXBhbnQucGFydGljaXBhbnRTZWxlY3Rpb24nKSxcclxuICAgICAgd2lkdGg6IGJveHNpemUud2lkdGgsXHJcbiAgICAgIGhlaWdodDogYm94c2l6ZS5oZWlnaHQsXHJcbiAgICAgIGJ1dHRvbnM6IHRoaXMuZWRpdEZvb3RlcixcclxuICAgICAgc2hvd0J1dHRvbnM6IHRydWVcclxuICAgIH07XHJcbiAgICB0aGlzLmVkaXREaWFsb2cgPSB0aGlzLm1vZGFsU2VydmljZS5zaG93KHRoaXMuY29tcFJlZiwgbW9kYWxDb25maWcpO1xyXG4gICAgLy8gdGhpcy5kcm9wRG93bkVsLmNsb3NlKCk7XHJcbiAgICBpZiAodGhpcy5kcm9wRG93bkUyKSB7XHJcbiAgICAgIHRoaXMuZHJvcERvd25FMi5jbG9zZSgpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgZWRpdE9LKCkge1xyXG4gICAgdGhpcy5pc0Nsb3NlID0gdHJ1ZTtcclxuICAgIGlmICh0aGlzLmNvbXBSZWYpIHtcclxuICAgICAgY29uc3QgcmUgPSB0aGlzLmNvbXBSZWYuaW5zdGFuY2UuZ2V0UGVyZm9ybWVycygpO1xyXG4gICAgICBpZiAocmUudXNlclBlcmZvcm1lcnMgJiYgcmUudXNlclBlcmZvcm1lcnMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgIGZvciAoY29uc3QgcCBvZiByZS51c2VyUGVyZm9ybWVycykge1xyXG4gICAgICAgICAgdGhpcy5hZGRVc2VyUGVyZm9ybWVyKHApO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICBpZiAocmUudmFyaWFibGUgJiYgcmUudmFyaWFibGUgIT09IG51bGwgJiYgcmUudmFyaWFibGUucGVyZm9ybWVySWQpIHtcclxuICAgICAgICB0aGlzLmFkZHZhcmlhYmxlUGVyZm9ybWVyKHJlLnZhcmlhYmxlKTtcclxuICAgICAgfVxyXG4gICAgICAvLyAyMDIzLTctMjgg57uE57uH5bKX5pSv5oyB5aSa6YCJXHJcbiAgICAgIGlmIChyZS5wb3NpdGlvbnMgJiYgcmUucG9zaXRpb25zLmxlbmd0aCA+IDApIHtcclxuICAgICAgICB0aGlzLmFkZFBvc2l0aW9uUGVyZm9ybWVyKHJlLnBvc2l0aW9ucyk7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKHJlLmNvbXBvbmVudCAmJiByZS5jb21wb25lbnQubWV0YWRhdGFJZCAmJiByZS5jb21wb25lbnQubWV0aG9kQ29kZSkge1xyXG4gICAgICAgIHRoaXMuYWRkQ29tcG9uZW50UGVyZm9ybWVyKHJlLmNvbXBvbmVudCk7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKHJlLnJlcG9ydGluZ0xpbmUgJiYgcmUucmVwb3J0aW5nTGluZS5yZXBvcnRpbmdMaW5lRGVmSWQgJiYgcmUucmVwb3J0aW5nTGluZS5kaW1lbnNpb24pIHtcclxuICAgICAgICB0aGlzLmFkZFJlcG9ydGluZ0xpbmVQZXJmb3JtZXIocmUucmVwb3J0aW5nTGluZSk7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKHJlLm1hdHJpeCAmJiByZS5tYXRyaXgubWF0cml4RGVmSWQpIHtcclxuICAgICAgICB0aGlzLmFkZE1hdHJpeFBlcmZvcm1lcihyZS5tYXRyaXgpO1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChyZS5hY3Rpdml0eUV4ZWN1dG9yUGVyZm9ybWVycyAmJiByZS5hY3Rpdml0eUV4ZWN1dG9yUGVyZm9ybWVycy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgZm9yIChjb25zdCBhIG9mIHJlLmFjdGl2aXR5RXhlY3V0b3JQZXJmb3JtZXJzKSB7XHJcbiAgICAgICAgICB0aGlzLmFkZEFjdGl2aXR5RXhlY3V0b3JQZXJmb3JtZXIoYSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIGlmIChyZS5vcmdhbml6YXRpb25QYXJ0aWNpcGFudCkge1xyXG4gICAgICAgIHRoaXMuYWRkT3JnYW5pemF0aW9uUGFydGljaXBhbnQocmUub3JnYW5pemF0aW9uUGFydGljaXBhbnQpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBpZiAodGhpcy5lZGl0RGlhbG9nICYmIHRoaXMuaXNDbG9zZSkge1xyXG4gICAgICB0aGlzLmVkaXREaWFsb2cuY2xvc2UoKTtcclxuICAgIH0gICBcclxuICAgIC8vIOe8lui+keWujOaIkOWQjuWIt+aWsOS4pOS4que7hOS7tlxyXG4gICAgLy8gdGhpcy5odW1hblBlcmZvcm1lckdyaWQucmVmcmVzaCgpO1xyXG4gICAgdGhpcy5wb3RlbnRpYWxPd25lckdyaWQucmVmcmVzaCgpO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBhZGRVc2VyUGVyZm9ybWVyKHVzZXJQZXJmb3JtZXI6IFVzZXJQYXJ0aWNpcGFudCkge1xyXG4gICAgaWYgKHRoaXMudHlwZSA9PT0gJ3BvdGVudGlhbE93bmVyJykge1xyXG4gICAgICBjb25zdCBpID0gdGhpcy5wYXJ0aWNpcGFudC5wb3RlbnRpYWxPd25lckxpc3QuZmluZEluZGV4KGEgPT4gKGEuaWQgPT09IHVzZXJQZXJmb3JtZXIuaWQgfHwgKChhIGFzIFVzZXJQYXJ0aWNpcGFudCkucGVyZm9ybWVySWQgJiYgKGEgYXMgVXNlclBhcnRpY2lwYW50KS5wZXJmb3JtZXJJZCA9PT0gdXNlclBlcmZvcm1lci5wZXJmb3JtZXJJZCkpKTtcclxuICAgICAgaWYgKGkgPiAtMSkge1xyXG4gICAgICAgIC8vIHRoaXMucGFydGljaXBhbnQucG90ZW50aWFsT3duZXJMaXN0W2ldID0gdXNlclBlcmZvcm1lcjtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBpZiAodGhpcy5lZGl0U3RhdGUgPT09ICdlZGl0Jykge1xyXG4gICAgICAgICAgdGhpcy5yZW1vdmVQb3RlbnRpYWxPd25lcigpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBsZXQgaW5kZXg7XHJcbiAgICAgICAgaWYgKHRoaXMucGFydGljaXBhbnQucG90ZW50aWFsT3duZXJMaXN0Lmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgIGluZGV4ID0gTWF0aC5tYXgoLi4udGhpcy5wYXJ0aWNpcGFudC5wb3RlbnRpYWxPd25lckxpc3QubWFwKHAgPT4gcC5vcmRlcikpKzE7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGluZGV4ID0gMTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdXNlclBlcmZvcm1lci5vcmRlciA9IGluZGV4O1xyXG4gICAgICAgIHRoaXMucGFydGljaXBhbnQucG90ZW50aWFsT3duZXJMaXN0LnB1c2godXNlclBlcmZvcm1lcik7XHJcbiAgICAgIH1cclxuICAgICAgdGhpcy5wb3RlbnRpYWxPd25lckdyaWQubG9hZERhdGEodGhpcy5wYXJ0aWNpcGFudC5wb3RlbnRpYWxPd25lckxpc3QpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBhZGR2YXJpYWJsZVBlcmZvcm1lcih2YXJpYWJsZTogVmFyaWFibGVQYXJ0aWNpcGFudCkge1xyXG4gICAgY29uc3QgdiA9IHZhcmlhYmxlO1xyXG4gICAgaWYgKCF2IHx8ICF2LnZhclZhbHVlKSB7XHJcbiAgICAgIHRoaXMubWVzc2FnZS5pbmZvKHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oJ2NvbXBvbmVudC5wYXJ0aWNpcGFudC5zZWxlY3RQcm9jZXNzVmFyaWFibGVzJykpO1xyXG4gICAgICB0aGlzLmlzQ2xvc2UgPSBmYWxzZTtcclxuICAgIH0gZWxzZSBpZiAoIXYudmFyVHlwZSkge1xyXG4gICAgICB0aGlzLm1lc3NhZ2UuaW5mbyh0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKCdjb21wb25lbnQucGFydGljaXBhbnQuc2VsZWN0VmFyaWFibGVWYWx1ZVR5cGUnKSk7XHJcbiAgICAgIHRoaXMuaXNDbG9zZSA9IGZhbHNlO1xyXG4gICAgfSBlbHNlIGlmICghdi5yZWxhdGlvbikge1xyXG4gICAgICB0aGlzLm1lc3NhZ2UuaW5mbyh0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKCdjb21wb25lbnQucGFydGljaXBhbnQuc2VsZWN0UmVsYXRpb24nKSk7XHJcbiAgICAgIHRoaXMuaXNDbG9zZSA9IGZhbHNlO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgaWYgKHRoaXMudHlwZSA9PT0gJ3BvdGVudGlhbE93bmVyJykge1xyXG4gICAgICAgIGNvbnN0IGkgPSB0aGlzLnBhcnRpY2lwYW50LnBvdGVudGlhbE93bmVyTGlzdC5maW5kSW5kZXgoYSA9PiAoYS5pZCA9PT0gdmFyaWFibGUuaWQgfHwgKChhIGFzIFZhcmlhYmxlUGFydGljaXBhbnQpLnBlcmZvcm1lcklkICYmIChhIGFzIFZhcmlhYmxlUGFydGljaXBhbnQpLnBlcmZvcm1lcklkID09PSB2YXJpYWJsZS5wZXJmb3JtZXJJZCkpKTtcclxuICAgICAgICBpZiAoaSA+IC0xKSB7XHJcbiAgICAgICAgICB0aGlzLnBhcnRpY2lwYW50LnBvdGVudGlhbE93bmVyTGlzdFtpXSA9IHZhcmlhYmxlO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBpZiAodGhpcy5lZGl0U3RhdGUgPT09ICdlZGl0Jykge1xyXG4gICAgICAgICAgICB0aGlzLnJlbW92ZVBvdGVudGlhbE93bmVyKCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBsZXQgaW5kZXg7XHJcbiAgICAgICAgICBpZiAodGhpcy5wYXJ0aWNpcGFudC5wb3RlbnRpYWxPd25lckxpc3QubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICBpbmRleCA9IE1hdGgubWF4KC4uLnRoaXMucGFydGljaXBhbnQucG90ZW50aWFsT3duZXJMaXN0Lm1hcChwID0+IHAub3JkZXIpKSsxO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgaW5kZXggPSAxO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgdmFyaWFibGUub3JkZXIgPSBpbmRleDtcclxuICAgICAgICAgIHRoaXMucGFydGljaXBhbnQucG90ZW50aWFsT3duZXJMaXN0LnB1c2godmFyaWFibGUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnBvdGVudGlhbE93bmVyR3JpZC5sb2FkRGF0YSh0aGlzLnBhcnRpY2lwYW50LnBvdGVudGlhbE93bmVyTGlzdCk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgYWRkUG9zaXRpb25QZXJmb3JtZXIocG9zaXRpb25zOiBQb3NpdGlvblBhcnRpY2lwYW50W10pIHtcclxuICAgIGZvciAoY29uc3QgcG9zaXRpb24gb2YgcG9zaXRpb25zKSB7XHJcbiAgICAgIGlmICghcG9zaXRpb24ucGVyZm9ybWVySWQpIHtcclxuICAgICAgICB0aGlzLm1lc3NhZ2UuaW5mbyh0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKCdjb21wb25lbnQucGFydGljaXBhbnQuc2VsZWN0UG9zaXRpb24nKSk7XHJcbiAgICAgICAgdGhpcy5pc0Nsb3NlID0gZmFsc2U7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgaWYgKCghcG9zaXRpb24ub3JnVHlwZSB8fCBwb3NpdGlvbi5vcmdUeXBlID09IG51bGwpICYmIChwb3NpdGlvbi5pc1JlcXVpcmVkICYmIHBvc2l0aW9uLnBvc2l0aW9uVHlwZSA9PT0gJzEnKSkge1xyXG4gICAgICAgICAgdGhpcy5tZXNzYWdlLmluZm8odGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybSgnY29tcG9uZW50LnBhcnRpY2lwYW50LnNlbGVjdE9yZ1R5cGUnKSk7XHJcbiAgICAgICAgICB0aGlzLmlzQ2xvc2UgPSBmYWxzZTtcclxuICAgICAgICB9IGVsc2UgaWYgKCghcG9zaXRpb24ub3JnSWQgfHwgcG9zaXRpb24ub3JnSWQgPT0gbnVsbCkgJiYgKHBvc2l0aW9uLmlzUmVxdWlyZWQgJiYgcG9zaXRpb24ucG9zaXRpb25UeXBlID09PSAnMScpKSB7XHJcbiAgICAgICAgICB0aGlzLm1lc3NhZ2UuaW5mbyh0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKCdjb21wb25lbnQucGFydGljaXBhbnQub3JnRmlsbCcpKTtcclxuICAgICAgICAgIHRoaXMuaXNDbG9zZSA9IGZhbHNlO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAvLyAoMSlpZOS4gOiHtO+8jOS4uue8lui+keWyl+S9je+8m++8iDLvvIlwZXJmb3JtaWTkuIDoh7TvvIzmlrDlop7nmoTnlKjmiLfvvIzlspfkvY3lt7LlrZjlnKhcclxuICAgICAgICAgIGlmICh0aGlzLnR5cGUgPT09ICdwb3RlbnRpYWxPd25lcicpIHtcclxuICAgICAgICAgICAgY29uc3QgaSA9IHRoaXMucGFydGljaXBhbnQucG90ZW50aWFsT3duZXJMaXN0LmZpbmRJbmRleChhID0+IHtcclxuICAgICAgICAgICAgICBpZiAoYS50eXBlICE9PSAnd2YuUG9zaXRpb25QYXJ0aWNpcGFudEV4cHJlc3Npb24nKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIGNvbnN0IHAgPSBhIGFzIFBvc2l0aW9uUGFydGljaXBhbnQ7XHJcbiAgICAgICAgICAgICAgcmV0dXJuIChwLmlkID09PSBwb3NpdGlvbi5pZCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBpZiAoaSA+IC0xKSB7XHJcbiAgICAgICAgICAgICAgdGhpcy5wYXJ0aWNpcGFudC5wb3RlbnRpYWxPd25lckxpc3RbaV0gPSBwb3NpdGlvbjtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICBsZXQgaW5kZXg7XHJcbiAgICAgICAgICAgICAgaWYgKHRoaXMucGFydGljaXBhbnQucG90ZW50aWFsT3duZXJMaXN0Lmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgIGluZGV4ID0gTWF0aC5tYXgoLi4udGhpcy5wYXJ0aWNpcGFudC5wb3RlbnRpYWxPd25lckxpc3QubWFwKHAgPT4gcC5vcmRlcikpKzE7XHJcbiAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGluZGV4ID0gMTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgcG9zaXRpb24ub3JkZXIgPSBpbmRleDtcclxuICAgICAgICAgICAgICB0aGlzLnBhcnRpY2lwYW50LnBvdGVudGlhbE93bmVyTGlzdC5wdXNoKHBvc2l0aW9uKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLnBvdGVudGlhbE93bmVyR3JpZC5sb2FkRGF0YSh0aGlzLnBhcnRpY2lwYW50LnBvdGVudGlhbE93bmVyTGlzdCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGFkZENvbXBvbmVudFBlcmZvcm1lcihjb21wb25lbnQ6IENvbXBvbmVudFBlcmZvcm1lcikge1xyXG4gICAgY29uc3QgY21wID0gbmV3IENvbXBvbmVudFBhcnRpY2lwYW50KCk7XHJcbiAgICBjbXAuaWQgPSBjb21wb25lbnQuaWQ7XHJcbiAgICBjbXAubWV0YWRhdGFJZCA9IGNvbXBvbmVudC5tZXRhZGF0YUlkO1xyXG4gICAgY21wLm1ldGhvZENvZGUgPSBjb21wb25lbnQubWV0aG9kQ29kZTtcclxuICAgIGNtcC5tZXRob2ROYW1lID0gY29tcG9uZW50Lm1ldGhvZE5hbWU7XHJcbiAgICBjbXAubmFtZSA9IGNvbXBvbmVudC5uYW1lO1xyXG4gICAgY21wLmFjdHVhbFBhcmFtZXRlcnMgPSBjb21wb25lbnQuYWN0dWFsUGFyYW1ldGVycztcclxuICAgIGNtcC50eXBlID0gJ3dmLkNvbXBvbmVudFBhcnRpY2lwYW50RXhwcmVzc2lvbic7XHJcbiAgICBjbXAuY29uZGl0aW9uID0gY29tcG9uZW50LmNvbmRpdGlvbjtcclxuICAgIGlmICh0aGlzLnR5cGUgPT09ICdwb3RlbnRpYWxPd25lcicpIHtcclxuICAgICAgY29uc3QgaSA9IHRoaXMucGFydGljaXBhbnQucG90ZW50aWFsT3duZXJMaXN0LmZpbmRJbmRleChhID0+IGEuaWQgPT09IGNtcC5pZCk7XHJcbiAgICAgIGlmIChpID4gLTEpIHtcclxuICAgICAgICB0aGlzLnBhcnRpY2lwYW50LnBvdGVudGlhbE93bmVyTGlzdFtpXSA9IGNtcDtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBsZXQgaW5kZXg7XHJcbiAgICAgICAgaWYgKHRoaXMucGFydGljaXBhbnQucG90ZW50aWFsT3duZXJMaXN0Lmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgIGluZGV4ID0gTWF0aC5tYXgoLi4udGhpcy5wYXJ0aWNpcGFudC5wb3RlbnRpYWxPd25lckxpc3QubWFwKHAgPT4gcC5vcmRlcikpKzE7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGluZGV4ID0gMTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY21wLm9yZGVyID0gaW5kZXg7XHJcbiAgICAgICAgdGhpcy5wYXJ0aWNpcGFudC5wb3RlbnRpYWxPd25lckxpc3QucHVzaChjbXApO1xyXG4gICAgICB9XHJcbiAgICAgIHRoaXMucG90ZW50aWFsT3duZXJHcmlkLmxvYWREYXRhKHRoaXMucGFydGljaXBhbnQucG90ZW50aWFsT3duZXJMaXN0KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgYWRkUmVwb3J0aW5nTGluZVBlcmZvcm1lcihyZXBvcnRpbmdMaW5lOiBSZXBvcnRpbmdMaW5lUGFydGljaXBhbnQpIHtcclxuICAgIGlmIChyZXBvcnRpbmdMaW5lLnJlcG9ydGluZ1JlZmVyT2JqZWN0ID09PSAnZGVwdCcgJiYgIXJlcG9ydGluZ0xpbmUucmVmT3JnSWQpIHtcclxuICAgICAgdGhpcy5pc0Nsb3NlID0gZmFsc2U7XHJcbiAgICAgIHRoaXMubWVzc2FnZS5pbmZvKHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oJ2NvbXBvbmVudC5wYXJ0aWNpcGFudC5yZWZPcmdJZE5vdE51bGwnKSk7XHJcbiAgICB9IGVsc2UgaWYgKHJlcG9ydGluZ0xpbmUucmVwb3J0aW5nUmVmZXJPYmplY3QgIT09ICdkZXB0JyAmJiAhcmVwb3J0aW5nTGluZS5yZWZVc2VySWQgJiYgIXJlcG9ydGluZ0xpbmUucmVmRW1wbG95ZWVJZCkgeyAvLyDnlKjmiLflj4rlhbbku5bkurrlkZjmsYfmiqXlr7nosaHnsbvlnovvvIzlj4LnhafnlKjmiLflkozlj4LnhaflkZjlt6XkuI3og73lhajpg6jkuLrnqbpcclxuICAgICAgdGhpcy5pc0Nsb3NlID0gZmFsc2U7XHJcbiAgICAgIHRoaXMubWVzc2FnZS5pbmZvKHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oJ2NvbXBvbmVudC5wYXJ0aWNpcGFudC5yZWZVc2VySWROb3ROdWxsJykpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5pc0Nsb3NlID0gdHJ1ZTtcclxuICAgICAgaWYgKHRoaXMudHlwZSA9PT0gJ3BvdGVudGlhbE93bmVyJykge1xyXG4gICAgICAgIGNvbnN0IGkgPSB0aGlzLnBhcnRpY2lwYW50LnBvdGVudGlhbE93bmVyTGlzdC5maW5kSW5kZXgoYSA9PiBhLmlkID09PSByZXBvcnRpbmdMaW5lLmlkKTtcclxuICAgICAgICBpZiAoaSA+IC0xKSB7XHJcbiAgICAgICAgICB0aGlzLnBhcnRpY2lwYW50LnBvdGVudGlhbE93bmVyTGlzdFtpXSA9IHJlcG9ydGluZ0xpbmU7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGNvbnN0IHJlcG9ydGluZ0xpbmVzID0gdGhpcy5wYXJ0aWNpcGFudC5wb3RlbnRpYWxPd25lckxpc3QuZmlsdGVyKGggPT4gaC50eXBlID09PSAnd2YuUmVwb3J0aW5nTGluZVBhcnRpY2lwYW50RXhwcmVzc2lvbicpO1xyXG4gICAgICAgICAgZm9yIChjb25zdCByIG9mIHJlcG9ydGluZ0xpbmVzKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHJlcG9ydGluZ0xpbmVEYXRhID0gciBhcyBSZXBvcnRpbmdMaW5lUGFydGljaXBhbnQ7XHJcbiAgICAgICAgICAgIGlmIChyZXBvcnRpbmdMaW5lRGF0YS5yZXBvcnRpbmdMaW5lRGVmSWQgPT09IHJlcG9ydGluZ0xpbmUucmVwb3J0aW5nTGluZURlZklkICYmXHJcbiAgICAgICAgICAgICAgcmVwb3J0aW5nTGluZURhdGEuZGltZW5zaW9uID09PSByZXBvcnRpbmdMaW5lLmRpbWVuc2lvbiAmJlxyXG4gICAgICAgICAgICAgIHJlcG9ydGluZ0xpbmVEYXRhLnJlZlVzZXJJZCA9PT0gcmVwb3J0aW5nTGluZS5yZWZVc2VySWQgJiZcclxuICAgICAgICAgICAgICByZXBvcnRpbmdMaW5lRGF0YS5yZWZFbXBsb3llZUlkID09PSByZXBvcnRpbmdMaW5lLnJlZkVtcGxveWVlSWQgJiZcclxuICAgICAgICAgICAgICByZXBvcnRpbmdMaW5lRGF0YS5yZWZPcmdJZCA9PT0gcmVwb3J0aW5nTGluZS5yZWZPcmdJZFxyXG4gICAgICAgICAgICApIHtcclxuICAgICAgICAgICAgICB0aGlzLm1lc3NhZ2UuZXJyb3IodGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybSgnY29tcG9uZW50LnBhcnRpY2lwYW50LnJlcERlZkNvbmZpZ3VyZWQnKSk7XHJcbiAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBsZXQgaW5kZXg7XHJcbiAgICAgICAgICBpZiAodGhpcy5wYXJ0aWNpcGFudC5wb3RlbnRpYWxPd25lckxpc3QubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICBpbmRleCA9IE1hdGgubWF4KC4uLnRoaXMucGFydGljaXBhbnQucG90ZW50aWFsT3duZXJMaXN0Lm1hcChwID0+IHAub3JkZXIpKSsxO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgaW5kZXggPSAxO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgcmVwb3J0aW5nTGluZS5vcmRlciA9IGluZGV4O1xyXG4gICAgICAgICAgdGhpcy5wYXJ0aWNpcGFudC5wb3RlbnRpYWxPd25lckxpc3QucHVzaChyZXBvcnRpbmdMaW5lKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5wb3RlbnRpYWxPd25lckdyaWQubG9hZERhdGEodGhpcy5wYXJ0aWNpcGFudC5wb3RlbnRpYWxPd25lckxpc3QpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGFkZE1hdHJpeFBlcmZvcm1lcihtYXRyaXg6IE1hdHJpeFBhcnRpY2lwYW50KSB7XHJcbiAgICBpZiAoIW1hdHJpeC5jb25kaXRpb25GaWVsZDEgJiYgIW1hdHJpeC5jb25kaXRpb25GaWVsZDIgJiYgIW1hdHJpeC5jb25kaXRpb25GaWVsZDMpIHtcclxuICAgICAgdGhpcy5pc0Nsb3NlID0gZmFsc2U7XHJcbiAgICAgIHRoaXMubWVzc2FnZS5pbmZvKHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oJ2NvbXBvbmVudC5wYXJ0aWNpcGFudC5hdExlYXN0T25lQ29uZGl0aW9uJykpO1xyXG4gICAgfSBlbHNlIGlmICghbWF0cml4LmRhdGFGaWVsZEFsaWFzKSB7XHJcbiAgICAgIHRoaXMuaXNDbG9zZSA9IGZhbHNlO1xyXG4gICAgICB0aGlzLm1lc3NhZ2UuaW5mbyh0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKCdjb21wb25lbnQucGFydGljaXBhbnQuZGF0YUZpZWxkQWxpYXNOb3ROdWxsJykpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5pc0Nsb3NlID0gdHJ1ZTtcclxuICAgICAgaWYgKHRoaXMudHlwZSA9PT0gJ3BvdGVudGlhbE93bmVyJykge1xyXG4gICAgICAgIGNvbnN0IGkgPSB0aGlzLnBhcnRpY2lwYW50LnBvdGVudGlhbE93bmVyTGlzdC5maW5kSW5kZXgoYSA9PiBhLmlkID09PSBtYXRyaXguaWQpO1xyXG4gICAgICAgIGlmIChpID4gLTEpIHtcclxuICAgICAgICAgIHRoaXMucGFydGljaXBhbnQucG90ZW50aWFsT3duZXJMaXN0W2ldID0gbWF0cml4O1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBjb25zdCBtYXRyaXhQYXJ0aWNpcGFudHMgPSB0aGlzLnBhcnRpY2lwYW50LnBvdGVudGlhbE93bmVyTGlzdC5maWx0ZXIoaCA9PiBoLnR5cGUgPT09ICd3Zi5NYXRyaXhQYXJ0aWNpcGFudEV4cHJlc3Npb24nKTtcclxuICAgICAgICAgIGZvciAoY29uc3QgbSBvZiBtYXRyaXhQYXJ0aWNpcGFudHMpIHtcclxuICAgICAgICAgICAgY29uc3QgbWF0cml4RGF0YSA9IG0gYXMgTWF0cml4UGFydGljaXBhbnQ7XHJcbiAgICAgICAgICAgIGlmIChtYXRyaXhEYXRhLm1hdHJpeERlZklkID09PSBtYXRyaXgubWF0cml4RGVmSWQgJiZcclxuICAgICAgICAgICAgICBtYXRyaXhEYXRhLmNvbmRpdGlvbkZpZWxkMSA9PT0gbWF0cml4LmNvbmRpdGlvbkZpZWxkMSAmJlxyXG4gICAgICAgICAgICAgIG1hdHJpeERhdGEuY29uZGl0aW9uRmllbGQyID09PSBtYXRyaXguY29uZGl0aW9uRmllbGQyICYmXHJcbiAgICAgICAgICAgICAgbWF0cml4RGF0YS5jb25kaXRpb25GaWVsZDMgPT09IG1hdHJpeC5jb25kaXRpb25GaWVsZDMgJiZcclxuICAgICAgICAgICAgICBtYXRyaXhEYXRhLmRhdGFGaWVsZEFsaWFzID09PSBtYXRyaXguZGF0YUZpZWxkQWxpYXNcclxuICAgICAgICAgICAgKSB7XHJcbiAgICAgICAgICAgICAgdGhpcy5tZXNzYWdlLmVycm9yKHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oJ2NvbXBvbmVudC5wYXJ0aWNpcGFudC5tYXRyaXhDb25maWd1cmVkJykpO1xyXG4gICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgbGV0IGluZGV4O1xyXG4gICAgICAgICAgaWYgKHRoaXMucGFydGljaXBhbnQucG90ZW50aWFsT3duZXJMaXN0Lmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgaW5kZXggPSBNYXRoLm1heCguLi50aGlzLnBhcnRpY2lwYW50LnBvdGVudGlhbE93bmVyTGlzdC5tYXAocCA9PiBwLm9yZGVyKSkrMTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGluZGV4ID0gMTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIG1hdHJpeC5vcmRlciA9IGluZGV4O1xyXG4gICAgICAgICAgdGhpcy5wYXJ0aWNpcGFudC5wb3RlbnRpYWxPd25lckxpc3QucHVzaChtYXRyaXgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnBvdGVudGlhbE93bmVyR3JpZC5sb2FkRGF0YSh0aGlzLnBhcnRpY2lwYW50LnBvdGVudGlhbE93bmVyTGlzdCk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgYWRkQWN0aXZpdHlFeGVjdXRvclBlcmZvcm1lcihhY3Rpdml0eUV4ZWN1dG9yOiBBY3Rpdml0eUV4ZWN1dG9yUGFydGljaXBhbnQpIHtcclxuICAgIGlmICh0aGlzLnR5cGUgPT09ICdwb3RlbnRpYWxPd25lcicpIHtcclxuICAgICAgY29uc3QgaSA9IHRoaXMucGFydGljaXBhbnQucG90ZW50aWFsT3duZXJMaXN0LmZpbmRJbmRleChhID0+IChhLmlkID09PSBhY3Rpdml0eUV4ZWN1dG9yLmlkIHx8XHJcbiAgICAgICAgKChhIGFzIEFjdGl2aXR5RXhlY3V0b3JQYXJ0aWNpcGFudCkuYWN0aXZpdHlEZWZJZCAmJiAoYSBhcyBBY3Rpdml0eUV4ZWN1dG9yUGFydGljaXBhbnQpLmFjdGl2aXR5RGVmSWQgPT09IGFjdGl2aXR5RXhlY3V0b3IuYWN0aXZpdHlEZWZJZCkpKTtcclxuICAgICAgaWYgKGkgPCAwKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuZWRpdFN0YXRlID09PSAnZWRpdCcpIHtcclxuICAgICAgICAgIHRoaXMucmVtb3ZlUG90ZW50aWFsT3duZXIoKTsgLy8g5Zyo57yW6L6R54q25oCB5LiL6YWN572u5LqG5rS75Yqo5Yqe55CG5Lq65Y+C5LiO6ICF77yM5YWI5bCG6YCJ5Lit55qE5Yig6ZmkXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxldCBpbmRleDtcclxuICAgICAgICBpZiAodGhpcy5wYXJ0aWNpcGFudC5wb3RlbnRpYWxPd25lckxpc3QubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgaW5kZXggPSBNYXRoLm1heCguLi50aGlzLnBhcnRpY2lwYW50LnBvdGVudGlhbE93bmVyTGlzdC5tYXAocCA9PiBwLm9yZGVyKSkrMTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgaW5kZXggPSAxO1xyXG4gICAgICAgIH1cclxuICAgICAgICBhY3Rpdml0eUV4ZWN1dG9yLm9yZGVyID0gaW5kZXg7XHJcbiAgICAgICAgdGhpcy5wYXJ0aWNpcGFudC5wb3RlbnRpYWxPd25lckxpc3QucHVzaChhY3Rpdml0eUV4ZWN1dG9yKTtcclxuICAgICAgfVxyXG4gICAgICB0aGlzLnBvdGVudGlhbE93bmVyR3JpZC5sb2FkRGF0YSh0aGlzLnBhcnRpY2lwYW50LnBvdGVudGlhbE93bmVyTGlzdCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuXHJcbiAgYWRkT3JnYW5pemF0aW9uUGFydGljaXBhbnQob3JnYW5pemF0aW9uOiBPcmdhbml6YXRpb25QYXJ0aWNpcGFudEV4cHJlc3Npb24pIHtcclxuICAgIGNvbnN0IG9yZ2FuaXphdGlvblBhcnRpY2lwYW50ID0gbmV3IE9yZ2FuaXphdGlvblBhcnRpY2lwYW50KCk7XHJcbiAgICBvcmdhbml6YXRpb25QYXJ0aWNpcGFudC5pZCA9IG9yZ2FuaXphdGlvbi5pZCB8fCBQcm9jZXNzRGVVdGlsLkdlbmVyYXRlRWxlbWVudElkKCk7XHJcbiAgICBvcmdhbml6YXRpb25QYXJ0aWNpcGFudC50eXBlID0gJ3dmLk9yZ2FuaXphdGlvblBhcnRpY2lwYW50RXhwcmVzc2lvbic7XHJcbiAgICBvcmdhbml6YXRpb25QYXJ0aWNpcGFudC5jb25kaXRpb24gPSBvcmdhbml6YXRpb24uY29uZGl0aW9uO1xyXG4gICAgb3JnYW5pemF0aW9uUGFydGljaXBhbnQubmFtZSA9IG9yZ2FuaXphdGlvbi5uYW1lO1xyXG4gICAgb3JnYW5pemF0aW9uUGFydGljaXBhbnQuYWN0aW9uU2NvcGUgPSBvcmdhbml6YXRpb24uYWN0aW9uU2NvcGU7XHJcbiAgICBvcmdhbml6YXRpb25QYXJ0aWNpcGFudC5vcmdhbml6YXRpb25MZXZlbCA9IG9yZ2FuaXphdGlvbi5vcmdhbml6YXRpb25MZXZlbDtcclxuICAgIG9yZ2FuaXphdGlvblBhcnRpY2lwYW50Lm9yZ2FuaXphdGlvbklkID0gb3JnYW5pemF0aW9uLm9yZ2FuaXphdGlvbklkO1xyXG4gICAgb3JnYW5pemF0aW9uUGFydGljaXBhbnQub3JnYW5pemF0aW9uQ29kZSA9IG9yZ2FuaXphdGlvbi5vcmdhbml6YXRpb25Db2RlO1xyXG4gICAgb3JnYW5pemF0aW9uUGFydGljaXBhbnQub3JnYW5pemF0aW9uTmFtZSA9IG9yZ2FuaXphdGlvbi5vcmdhbml6YXRpb25OYW1lO1xyXG4gICAgb3JnYW5pemF0aW9uUGFydGljaXBhbnQuaW5jbHVkZUNoaWxkcmVuID0gb3JnYW5pemF0aW9uLmluY2x1ZGVDaGlsZHJlbjtcclxuICAgIG9yZ2FuaXphdGlvblBhcnRpY2lwYW50LnBhcmVudHNVbnRpbCA9IG9yZ2FuaXphdGlvbi5wYXJlbnRzVW50aWw7XHJcbiAgICBvcmdhbml6YXRpb25QYXJ0aWNpcGFudC50YWcgPSBvcmdhbml6YXRpb24udGFnO1xyXG5cclxuICAgIGlmICh0aGlzLnR5cGUgPT09ICdwb3RlbnRpYWxPd25lcicpIHtcclxuICAgICAgdGhpcy5wYXJ0aWNpcGFudC5wb3RlbnRpYWxPd25lckxpc3QgPSB0aGlzLnBhcnRpY2lwYW50LnBvdGVudGlhbE93bmVyTGlzdC5maWx0ZXIocCA9PiBwLnR5cGUgIT09ICd3Zi5Pcmdhbml6YXRpb25QYXJ0aWNpcGFudEV4cHJlc3Npb24nKTtcclxuICAgICAgbGV0IGluZGV4O1xyXG4gICAgICBpZiAodGhpcy5wYXJ0aWNpcGFudC5wb3RlbnRpYWxPd25lckxpc3QubGVuZ3RoID4gMCkge1xyXG4gICAgICAgIGluZGV4ID0gTWF0aC5tYXgoLi4udGhpcy5wYXJ0aWNpcGFudC5wb3RlbnRpYWxPd25lckxpc3QubWFwKHAgPT4gcC5vcmRlcikpKzE7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgaW5kZXggPSAxO1xyXG4gICAgICB9XHJcbiAgICAgIG9yZ2FuaXphdGlvblBhcnRpY2lwYW50Lm9yZGVyID0gaW5kZXg7XHJcbiAgICAgIHRoaXMucGFydGljaXBhbnQucG90ZW50aWFsT3duZXJMaXN0LnB1c2gob3JnYW5pemF0aW9uUGFydGljaXBhbnQpO1xyXG4gICAgICB0aGlzLnBvdGVudGlhbE93bmVyR3JpZC5sb2FkRGF0YSh0aGlzLnBhcnRpY2lwYW50LnBvdGVudGlhbE93bmVyTGlzdCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBlZGl0Q2FuY2VsKCkge1xyXG4gICAgaWYgKHRoaXMuZWRpdERpYWxvZykge1xyXG4gICAgICB0aGlzLmVkaXREaWFsb2cuY2xvc2UoKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGVkaXRQZXJmb3JtZXIodHlwZTogc3RyaW5nKSB7XHJcbiAgICB0aGlzLmVkaXRTdGF0ZSA9ICdlZGl0JztcclxuICAgIHRoaXMudHlwZSA9IHR5cGU7XHJcbiAgICBsZXQgc2VsZWN0ZWRSb3c7XHJcbiAgICBpZiAodHlwZSA9PT0gJ3BvdGVudGlhbE93bmVyJykge1xyXG4gICAgICBzZWxlY3RlZFJvdyA9IHRoaXMucG90ZW50aWFsT3duZXJHcmlkLnNlbGVjdGVkUm93O1xyXG4gICAgfVxyXG4gICAgaWYgKCFzZWxlY3RlZFJvdykge1xyXG4gICAgICB0aGlzLm1lc3NhZ2UuaW5mbyh0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKCdjb21wb25lbnQucGFydGljaXBhbnQuc2VsZWN0UGVyZm9ybWVyJykpO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBjb25zdCBjdXJQZXJmb3JtZXIgPSBzZWxlY3RlZFJvdy5kYXRhO1xyXG4gICAgaWYgKGN1clBlcmZvcm1lcikge1xyXG4gICAgICBjb25zdCBib3hzaXplID0gdGhpcy5hdHRyaWJ1dGVCb3hTaXplKGN1clBlcmZvcm1lci50eXBlKTtcclxuICAgICAgY29uc3QgbW9kYWxDb25maWcgPSB7XHJcbiAgICAgICAgdGl0bGU6IHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oJ2NvbXBvbmVudC5wYXJ0aWNpcGFudC5wYXJ0aWNpcGFudFNlbGVjdGlvbicpLFxyXG4gICAgICAgIHdpZHRoOiBib3hzaXplLndpZHRoLFxyXG4gICAgICAgIGhlaWdodDogYm94c2l6ZS5oZWlnaHQsXHJcbiAgICAgICAgYnV0dG9uczogdGhpcy5lZGl0Rm9vdGVyLFxyXG4gICAgICAgIHNob3dCdXR0b25zOiB0cnVlXHJcbiAgICAgIH07XHJcbiAgICAgIGNvbnN0IGNvbXBGYWN0b3J5ID0gdGhpcy5yZXNvbHZlci5yZXNvbHZlQ29tcG9uZW50RmFjdG9yeShQZXJmb3JtZXJFZGl0Q29tcG9uZW50KTtcclxuICAgICAgdGhpcy5jb21wUmVmID0gY29tcEZhY3RvcnkuY3JlYXRlKHRoaXMuaW5qZWN0b3IpO1xyXG4gICAgICB0aGlzLmNvbXBSZWYuaW5zdGFuY2UucGVyZm9ybWVyVHlwZSA9IGN1clBlcmZvcm1lci50eXBlO1xyXG4gICAgICB0aGlzLmNvbXBSZWYuaW5zdGFuY2UuZWRpdFN0YXRlID0gIHRoaXMuZWRpdFN0YXRlO1xyXG4gICAgICBzd2l0Y2ggKGN1clBlcmZvcm1lci50eXBlKSB7XHJcbiAgICAgICAgY2FzZSAnd2YuUG9zaXRpb25QYXJ0aWNpcGFudEV4cHJlc3Npb24nOlxyXG4gICAgICAgICAgdGhpcy5jb21wUmVmLmluc3RhbmNlLnBlcmZvcm1lciA9IHtcclxuICAgICAgICAgICAgdHlwZTogJ3dmLlBvc2l0aW9uUGFydGljaXBhbnRFeHByZXNzaW9uJyxcclxuICAgICAgICAgICAgdmFsdWU6IGN1clBlcmZvcm1lclxyXG4gICAgICAgICAgfTtcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgJ3dmLlVzZXJQYXJ0aWNpcGFudEV4cHJlc3Npb24nOlxyXG4gICAgICAgICAgdGhpcy5jb21wUmVmLmluc3RhbmNlLnBlcmZvcm1lciA9IHtcclxuICAgICAgICAgICAgdHlwZTogJ3dmLlVzZXJQYXJ0aWNpcGFudEV4cHJlc3Npb24nLFxyXG4gICAgICAgICAgICB2YWx1ZTogY3VyUGVyZm9ybWVyXHJcbiAgICAgICAgICB9O1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSAnd2YuVmFyaWFibGVQYXJ0aWNpcGFudEV4cHJlc3Npb24nOlxyXG4gICAgICAgICAgdGhpcy5jb21wUmVmLmluc3RhbmNlLnBlcmZvcm1lciA9IHtcclxuICAgICAgICAgICAgdHlwZTogJ3dmLlZhcmlhYmxlUGFydGljaXBhbnRFeHByZXNzaW9uJyxcclxuICAgICAgICAgICAgdmFsdWU6IGN1clBlcmZvcm1lclxyXG4gICAgICAgICAgfTtcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgJ3dmLlJlcG9ydGluZ0xpbmVQYXJ0aWNpcGFudEV4cHJlc3Npb24nOlxyXG4gICAgICAgICAgdGhpcy5jb21wUmVmLmluc3RhbmNlLnBlcmZvcm1lciA9IHtcclxuICAgICAgICAgICAgdHlwZTogJ3dmLlJlcG9ydGluZ0xpbmVQYXJ0aWNpcGFudEV4cHJlc3Npb24nLFxyXG4gICAgICAgICAgICB2YWx1ZTogY3VyUGVyZm9ybWVyXHJcbiAgICAgICAgICB9O1xyXG4gICAgICAgICAgY29uc3QgdXJsID0gJy9hcGkvcnVudGltZS93Zi92MS4wL3JlcG9ydGluZ0xpbmVEZWZpbml0aW9ucy8nICsgKGN1clBlcmZvcm1lciBhcyBSZXBvcnRpbmdMaW5lUGFydGljaXBhbnQpLnJlcG9ydGluZ0xpbmVEZWZJZDtcclxuICAgICAgICAgIHRoaXMuaHR0cC5nZXQodXJsKS5zdWJzY3JpYmUoKHJlczogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGlmICghcmVzKSB7XHJcbiAgICAgICAgICAgICAgdGhpcy5tZXNzYWdlLmVycm9yKHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oJ2NvbXBvbmVudC5wYXJ0aWNpcGFudC5kZWZpbml0aW9uRGVsZXRlZCcpKTtcclxuICAgICAgICAgICAgICBpZiAodHlwZSA9PT0gJ3BvdGVudGlhbE93bmVyJykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVQb3RlbnRpYWxPd25lcigpO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICB0aGlzLmVkaXREaWFsb2cgPSB0aGlzLm1vZGFsU2VydmljZS5zaG93KHRoaXMuY29tcFJlZiwgbW9kYWxDb25maWcpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgJ3dmLk1hdHJpeFBhcnRpY2lwYW50RXhwcmVzc2lvbic6XHJcbiAgICAgICAgICB0aGlzLmNvbXBSZWYuaW5zdGFuY2UucGVyZm9ybWVyID0ge1xyXG4gICAgICAgICAgICB0eXBlOiAnd2YuTWF0cml4UGFydGljaXBhbnRFeHByZXNzaW9uJyxcclxuICAgICAgICAgICAgdmFsdWU6IGN1clBlcmZvcm1lclxyXG4gICAgICAgICAgfTtcclxuICAgICAgICAgIGNvbnN0IHVybE1hdHJpeCA9ICcvYXBpL3J1bnRpbWUvd2YvdjEuMC9tYXRyaXhEZWZpbml0aW9uLycgKyAoY3VyUGVyZm9ybWVyIGFzIE1hdHJpeFBhcnRpY2lwYW50KS5tYXRyaXhEZWZJZDtcclxuICAgICAgICAgIHRoaXMuaHR0cC5nZXQodXJsTWF0cml4KS5zdWJzY3JpYmUoKHJlczogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGlmICghcmVzKSB7XHJcbiAgICAgICAgICAgICAgdGhpcy5tZXNzYWdlLmVycm9yKHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oJ2NvbXBvbmVudC5wYXJ0aWNpcGFudC5tYXRyaXhEZWxldGVkJykpO1xyXG4gICAgICAgICAgICAgIGlmICh0eXBlID09PSAncG90ZW50aWFsT3duZXInKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZVBvdGVudGlhbE93bmVyKCk7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgIHRoaXMuZWRpdERpYWxvZyA9IHRoaXMubW9kYWxTZXJ2aWNlLnNob3codGhpcy5jb21wUmVmLCBtb2RhbENvbmZpZyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSAnd2YuQ29tcG9uZW50UGFydGljaXBhbnRFeHByZXNzaW9uJzpcclxuICAgICAgICAgIHRoaXMuY29tcFJlZi5pbnN0YW5jZS5wZXJmb3JtZXIgPSB7XHJcbiAgICAgICAgICAgIHR5cGU6ICd3Zi5Db21wb25lbnRQYXJ0aWNpcGFudEV4cHJlc3Npb24nLFxyXG4gICAgICAgICAgICB2YWx1ZTogY3VyUGVyZm9ybWVyXHJcbiAgICAgICAgICB9O1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSAnd2YuQWN0aXZpdHlFeGVjdXRvclBhcnRpY2lwYW50RXhwcmVzc2lvbic6XHJcbiAgICAgICAgICB0aGlzLmNvbXBSZWYuaW5zdGFuY2UucGVyZm9ybWVyID0ge1xyXG4gICAgICAgICAgICB0eXBlOiAnd2YuQWN0aXZpdHlFeGVjdXRvclBhcnRpY2lwYW50RXhwcmVzc2lvbicsXHJcbiAgICAgICAgICAgIHZhbHVlOiBjdXJQZXJmb3JtZXJcclxuICAgICAgICAgIH07XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlICd3Zi5Pcmdhbml6YXRpb25QYXJ0aWNpcGFudEV4cHJlc3Npb24nOlxyXG4gICAgICAgICAgdGhpcy5jb21wUmVmLmluc3RhbmNlLnBlcmZvcm1lciA9IHtcclxuICAgICAgICAgICAgdHlwZTogJ3dmLk9yZ2FuaXphdGlvblBhcnRpY2lwYW50RXhwcmVzc2lvbicsXHJcbiAgICAgICAgICAgIHZhbHVlOiBjdXJQZXJmb3JtZXJcclxuICAgICAgICAgIH07XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgfVxyXG4gICAgICBpZiAoY3VyUGVyZm9ybWVyLnR5cGUgIT09ICd3Zi5SZXBvcnRpbmdMaW5lUGFydGljaXBhbnRFeHByZXNzaW9uJyAmJlxyXG4gICAgICAgIGN1clBlcmZvcm1lci50eXBlICE9PSAnd2YuTWF0cml4UGFydGljaXBhbnRFeHByZXNzaW9uJykgeyAvLyDmsYfmiqXlhbPns7vlkoznn6npmLXljZXni6zlpITnkIZcclxuICAgICAgICB0aGlzLmVkaXREaWFsb2cgPSB0aGlzLm1vZGFsU2VydmljZS5zaG93KHRoaXMuY29tcFJlZiwgbW9kYWxDb25maWcpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG4gIHJlbW92ZVBlcmZvcm1lcih0eXBlOiBzdHJpbmcpIHtcclxuICAgIGlmICh0eXBlID09PSAncG90ZW50aWFsT3duZXInKSB7XHJcbiAgICAgIGlmICh0aGlzLnBvdGVudGlhbE93bmVyR3JpZC5zZWxlY3RlZFJvdykge1xyXG4gICAgICAgIHRoaXMucG90ZW50aWFsT3duZXJHcmlkLmVuZENlbGxFZGl0KCk7XHJcbiAgICAgICAgY29uc3QgaW5kZXggPSB0aGlzLnBhcnRpY2lwYW50LnBvdGVudGlhbE93bmVyTGlzdC5maW5kSW5kZXgocCA9PiBwLmlkID09PSB0aGlzLnBvdGVudGlhbE93bmVyR3JpZC5zZWxlY3RlZFJvdy5kYXRhLmlkKTtcclxuICAgICAgICB0aGlzLnBhcnRpY2lwYW50LnBvdGVudGlhbE93bmVyTGlzdC5zcGxpY2UoaW5kZXgsIDEpO1xyXG4gICAgICAgIHRoaXMucG90ZW50aWFsT3duZXJHcmlkLmxvYWREYXRhKHRoaXMucGFydGljaXBhbnQucG90ZW50aWFsT3duZXJMaXN0KTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICB0aGlzLm1lc3NhZ2UuaW5mbyh0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKCdjb21wb25lbnQucGFydGljaXBhbnQuc2VsZWN0UGFydGljaXBhbnRJbmZvJykpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBjbGVhclBlcmZvcm1lcih0eXBlOiBzdHJpbmcpIHtcclxuICAgIGlmICh0eXBlID09PSAncG90ZW50aWFsT3duZXInKSB7XHJcbiAgICAgIHRoaXMucGFydGljaXBhbnQucG90ZW50aWFsT3duZXJMaXN0ID0gbmV3IEFycmF5KCk7XHJcbiAgICB9XHJcbiAgICAvLyB0aGlzLmh1bWFuUGVyZm9ybWVyR3JpZC5sb2FkRGF0YSh0aGlzLnBhcnRpY2lwYW50Lmh1bWFuUGVyZm9ybWVyTGlzdCk7XHJcbiAgICBpZiAodGhpcy5wb3RlbnRpYWxPd25lckdyaWQpIHtcclxuICAgICAgdGhpcy5wb3RlbnRpYWxPd25lckdyaWQubG9hZERhdGEodGhpcy5wYXJ0aWNpcGFudC5wb3RlbnRpYWxPd25lckxpc3QpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgbW92ZVVwKHR5cGU6IHN0cmluZykge1xyXG4gICAgaWYgKHR5cGUgPT09ICdwb3RlbnRpYWxPd25lcicpIHtcclxuICAgICAgY29uc3Qgc2VsZWN0ZWRSb3cgPSB0aGlzLnBvdGVudGlhbE93bmVyR3JpZC5zZWxlY3RlZFJvdztcclxuICAgICAgaWYgKCFzZWxlY3RlZFJvdykge1xyXG4gICAgICAgIHRoaXMubWVzc2FnZS5pbmZvKHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oJ2NvbXBvbmVudC5wYXJ0aWNpcGFudC5ub1Jvd1NlbGVjdGVkJykpO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG4gICAgICBjb25zdCBwZXJmb3JtZXIgPSBzZWxlY3RlZFJvdy5kYXRhO1xyXG4gICAgICBjb25zdCBpID0gdGhpcy5wYXJ0aWNpcGFudC5wb3RlbnRpYWxPd25lckxpc3QuZmluZEluZGV4KGMgPT4gYy5pZCA9PT0gcGVyZm9ybWVyLmlkKTtcclxuICAgICAgaWYgKGkgPT09IDApIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuICAgICAgY29uc3QgaW5kZXggPSB0aGlzLnBhcnRpY2lwYW50LnBvdGVudGlhbE93bmVyTGlzdFtpXS5vcmRlcjtcclxuICAgICAgdGhpcy5wYXJ0aWNpcGFudC5wb3RlbnRpYWxPd25lckxpc3RbaV0ub3JkZXIgPSB0aGlzLnBhcnRpY2lwYW50LnBvdGVudGlhbE93bmVyTGlzdFtpIC0gMV0ub3JkZXI7XHJcbiAgICAgIHRoaXMucGFydGljaXBhbnQucG90ZW50aWFsT3duZXJMaXN0W2ktMV0ub3JkZXIgPSBpbmRleDtcclxuICAgICAgdGhpcy5zd2FwQXJyYXkodGhpcy5wYXJ0aWNpcGFudC5wb3RlbnRpYWxPd25lckxpc3QsIGksIGkgLSAxKTtcclxuICAgICAgdGhpcy5wb3RlbnRpYWxPd25lckdyaWQubG9hZERhdGEodGhpcy5wYXJ0aWNpcGFudC5wb3RlbnRpYWxPd25lckxpc3QpO1xyXG4gICAgICB0aGlzLnBvdGVudGlhbE93bmVyR3JpZC5zZWxlY3RSb3cocGVyZm9ybWVyLmlkLCB0cnVlKTtcclxuICAgIH1cclxuXHJcbiAgfVxyXG5cclxuICBtb3ZlRG93bih0eXBlOiBzdHJpbmcpIHtcclxuICAgIGlmICh0eXBlID09PSAncG90ZW50aWFsT3duZXInKSB7XHJcbiAgICAgIGNvbnN0IHNlbGVjdGVkUm93ID0gdGhpcy5wb3RlbnRpYWxPd25lckdyaWQuc2VsZWN0ZWRSb3c7XHJcbiAgICAgIGlmICghc2VsZWN0ZWRSb3cpIHtcclxuICAgICAgICB0aGlzLm1lc3NhZ2UuaW5mbyh0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKCdjb21wb25lbnQucGFydGljaXBhbnQubm9Sb3dTZWxlY3RlZCcpKTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuICAgICAgY29uc3QgcGVyZm9ybWVyID0gc2VsZWN0ZWRSb3cuZGF0YTtcclxuICAgICAgY29uc3QgaSA9IHRoaXMucGFydGljaXBhbnQucG90ZW50aWFsT3duZXJMaXN0LmZpbmRJbmRleChjID0+IGMuaWQgPT09IHBlcmZvcm1lci5pZCk7XHJcbiAgICAgIGlmIChpID09PSB0aGlzLnBhcnRpY2lwYW50LnBvdGVudGlhbE93bmVyTGlzdC5sZW5ndGgtMSkge1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG4gICAgICBjb25zdCBpbmRleCA9IHRoaXMucGFydGljaXBhbnQucG90ZW50aWFsT3duZXJMaXN0W2ldLm9yZGVyO1xyXG4gICAgICB0aGlzLnBhcnRpY2lwYW50LnBvdGVudGlhbE93bmVyTGlzdFtpXS5vcmRlciA9IHRoaXMucGFydGljaXBhbnQucG90ZW50aWFsT3duZXJMaXN0W2kgKyAxXS5vcmRlcjtcclxuICAgICAgdGhpcy5wYXJ0aWNpcGFudC5wb3RlbnRpYWxPd25lckxpc3RbaSsxXS5vcmRlciA9IGluZGV4O1xyXG4gICAgICB0aGlzLnN3YXBBcnJheSh0aGlzLnBhcnRpY2lwYW50LnBvdGVudGlhbE93bmVyTGlzdCwgaSwgaSArIDEpO1xyXG4gICAgICB0aGlzLnBvdGVudGlhbE93bmVyR3JpZC5sb2FkRGF0YSh0aGlzLnBhcnRpY2lwYW50LnBvdGVudGlhbE93bmVyTGlzdCk7XHJcbiAgICAgIHRoaXMucG90ZW50aWFsT3duZXJHcmlkLnNlbGVjdFJvdyhwZXJmb3JtZXIuaWQsIHRydWUpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBzd2FwQXJyYXkoYXJyOiBBcnJheTxhbnk+LCBpMTogbnVtYmVyLCBpMjogbnVtYmVyKTogQXJyYXk8YW55PiB7XHJcbiAgICBhcnJbaTFdID0gYXJyLnNwbGljZShpMiwgMSwgYXJyW2kxXSlbMF07XHJcbiAgICByZXR1cm4gYXJyO1xyXG4gIH1cclxuXHJcbiAgcmVtb3ZlUG90ZW50aWFsT3duZXIoKSB7XHJcbiAgICBpZiAodGhpcy5wb3RlbnRpYWxPd25lckdyaWQuc2VsZWN0ZWRSb3cpIHtcclxuICAgICAgdGhpcy5wb3RlbnRpYWxPd25lckdyaWQuZW5kQ2VsbEVkaXQoKTtcclxuICAgICAgY29uc3QgaSA9IHRoaXMucGFydGljaXBhbnQucG90ZW50aWFsT3duZXJMaXN0LmZpbmRJbmRleChpdGVtID0+IGl0ZW0uaWQgPT09IHRoaXMucG90ZW50aWFsT3duZXJHcmlkLnNlbGVjdGVkUm93LmRhdGEuaWQpO1xyXG4gICAgICB0aGlzLnBhcnRpY2lwYW50LnBvdGVudGlhbE93bmVyTGlzdC5zcGxpY2UoaSwgMSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLm1lc3NhZ2UuaW5mbyh0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKCdjb21wb25lbnQucGFydGljaXBhbnQuc2VsZWN0cG90ZW50aWFsdEhhbmRsZXInKSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGdldFVzZXJQZXJmb3JtZXJEZXNjcmlwdGlvbih1c2VyUGVyZm9ybWVyOiBVc2VyUGFydGljaXBhbnQpOiBzdHJpbmcge1xyXG4gICAgaWYgKHVzZXJQZXJmb3JtZXIudGFnID09PSAnZXhwcmVzc2lvbicpIHtcclxuICAgICAgcmV0dXJuIHVzZXJQZXJmb3JtZXIucGVyZm9ybWVySWQ7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBpZiAodXNlclBlcmZvcm1lci5vcmdOYW1lKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oJ2NvbXBvbmVudC5wYXJ0aWNpcGFudC5vcmcnKSArIHVzZXJQZXJmb3JtZXIub3JnTmFtZTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICByZXR1cm4gJyc7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgZ2V0VmFyaWFibGVQZXJmb3JtZXJEZXNjcmlwdGlvbih2YXJpYWJsZVBlcmZvcm1lcjogVmFyaWFibGVQYXJ0aWNpcGFudCk6IHN0cmluZyB7XHJcbiAgICBpZiAodmFyaWFibGVQZXJmb3JtZXIudGFnID09PSAnZXhwcmVzc2lvbicpIHtcclxuICAgICAgcmV0dXJuIHZhcmlhYmxlUGVyZm9ybWVyLnZhclZhbHVlO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBnZXRQb3NpdGlvblBlcmZvcm1lckRlc2NyaXB0aW9uKHBvc2l0aW9uOiBQb3NpdGlvblBhcnRpY2lwYW50KTogc3RyaW5nIHtcclxuICAgIGlmICh0aGlzLmRlc2lnbmVyVUlTdGF0ZS5zY2VuZSA9PT0gJ2luU3VpdGUnKSB7XHJcbiAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG4gICAgaWYgKHBvc2l0aW9uLnBvc2l0aW9uVHlwZSA9PT0gJzEnKSB7XHJcbiAgICAgIGlmIChwb3NpdGlvbi5vcmdJZCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKCdjb21wb25lbnQucGFydGljaXBhbnQucG9zaXRpb25UeXBlMScpICsgcG9zaXRpb24ub3JnSWQ7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oJ2NvbXBvbmVudC5wYXJ0aWNpcGFudC5wb3NpdGlvblR5cGUyJyk7XHJcbiAgICAgIH1cclxuICAgIH0gZWxzZSBpZiAocG9zaXRpb24ucG9zaXRpb25UeXBlID09PSAnMCcpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oJ2NvbXBvbmVudC5wYXJ0aWNpcGFudC5wb3NpdGlvblR5cGUzJyk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGdldENvbXBvbmVudFBlcmZvcm1lckRlc2NyaXB0aW9uKHBvc2l0aW9uOiBDb21wb25lbnRQYXJ0aWNpcGFudCk6IHN0cmluZyB7XHJcbiAgICBsZXQgZGVzID0gdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybSgnY29tcG9uZW50LnBhcnRpY2lwYW50LmNvbXAnKSArIHBvc2l0aW9uLm5hbWVcclxuICAgICsgdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybSgnY29tcG9uZW50LnBhcnRpY2lwYW50LnBhcmFtZXRlcnMnKTtcclxuICAgIGlmIChwb3NpdGlvbi5hY3R1YWxQYXJhbWV0ZXJzICYmIHBvc2l0aW9uLmFjdHVhbFBhcmFtZXRlcnMubGVuZ3RoID4gMCkge1xyXG4gICAgICBwb3NpdGlvbi5hY3R1YWxQYXJhbWV0ZXJzLmZvckVhY2gocCA9PiB7XHJcbiAgICAgICAgZGVzICs9IGAke3AuY29kZX3vvJoke3AudmFsdWV977yMYDtcclxuICAgICAgfSk7XHJcbiAgICAgIGRlcyA9IGRlcy5zdWJzdHJpbmcoMCwgZGVzLmxlbmd0aCAtIDEpO1xyXG4gICAgfVxyXG4gICAgZGVzICs9ICd9JztcclxuICAgIHJldHVybiBkZXM7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGdldFJlcG9ydGluZ0xpbmVQZXJmb3JtZXJEZXNjcmlwdGlvbihyZXBvcnRpbmdMaW5lOiBSZXBvcnRpbmdMaW5lUGFydGljaXBhbnQpOiBzdHJpbmcge1xyXG4gICAgbGV0IGRlc2NyaXB0aW9uID0gJyc7XHJcbiAgICBpZiAocmVwb3J0aW5nTGluZS5yZWZVc2VySWQpIHtcclxuICAgICAgZGVzY3JpcHRpb24gKz0gdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybSgnY29tcG9uZW50LnBhcnRpY2lwYW50LnJlZmVyZW5jZVBlcnNvbicpICsgcmVwb3J0aW5nTGluZS5yZWZVc2VySWQ7XHJcbiAgICB9XHJcbiAgICBpZiAocmVwb3J0aW5nTGluZS5yZWZFbXBsb3llZUlkKSB7XHJcbiAgICAgIGRlc2NyaXB0aW9uICs9IHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oJ2NvbXBvbmVudC5wYXJ0aWNpcGFudC5yZWZlcmVuY2VQZXJzb24nKSArIHJlcG9ydGluZ0xpbmUucmVmRW1wbG95ZWVJZDtcclxuICAgIH1cclxuICAgIGlmIChyZXBvcnRpbmdMaW5lLnJlZk9yZ0lkKSB7XHJcbiAgICAgIGlmIChyZXBvcnRpbmdMaW5lLnJlZlVzZXJJZCkge1xyXG4gICAgICAgIGRlc2NyaXB0aW9uICs9IGDvvIxgO1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChyZXBvcnRpbmdMaW5lLnJlZkVtcGxveWVlSWQpIHtcclxuICAgICAgICBkZXNjcmlwdGlvbiArPSBg77yMYDtcclxuICAgICAgfVxyXG4gICAgICBkZXNjcmlwdGlvbiArPSB0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKCdjb21wb25lbnQucGFydGljaXBhbnQucmVmZXJlbmNlT3JnYW5pemF0aW9uJykgKyByZXBvcnRpbmdMaW5lLnJlZk9yZ0lkO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGRlc2NyaXB0aW9uO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBnZXRNYXRyaXhQZXJmb3JtZXJEZXNjcmlwdGlvbihtYXRyaXg6IE1hdHJpeFBhcnRpY2lwYW50KTogc3RyaW5nIHtcclxuICAgIGxldCBkZXNjcmlwdGlvbiA9ICcnO1xyXG4gICAgaWYgKG1hdHJpeC5jb25kaXRpb25GaWVsZDEpIHtcclxuICAgICAgZGVzY3JpcHRpb24gKz0gdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybSgnY29tcG9uZW50LnBhcnRpY2lwYW50LmNvbmRpdGlvbjEnKSArIG1hdHJpeC5jb25kaXRpb25GaWVsZFRleHQxICsgYO+8jGA7XHJcbiAgICB9XHJcbiAgICBpZiAobWF0cml4LmNvbmRpdGlvbkZpZWxkMikge1xyXG4gICAgICBkZXNjcmlwdGlvbiArPSB0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKCdjb21wb25lbnQucGFydGljaXBhbnQuY29uZGl0aW9uMicpICsgbWF0cml4LmNvbmRpdGlvbkZpZWxkVGV4dDIgKyBg77yMYDtcclxuICAgIH1cclxuICAgIGlmIChtYXRyaXguY29uZGl0aW9uRmllbGQzKSB7XHJcbiAgICAgIGRlc2NyaXB0aW9uICs9IHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oJ2NvbXBvbmVudC5wYXJ0aWNpcGFudC5jb25kaXRpb24zJykgKyBtYXRyaXguY29uZGl0aW9uRmllbGRUZXh0MyArIGDvvIxgO1xyXG4gICAgfVxyXG4gICAgaWYgKG1hdHJpeC5kYXRhRmllbGRBbGlhcykge1xyXG4gICAgICBkZXNjcmlwdGlvbiArPSB0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKCdjb21wb25lbnQucGFydGljaXBhbnQuZGF0YScpICsgbWF0cml4LmRhdGFGaWVsZEFsaWFzICsgYO+8jGA7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gZGVzY3JpcHRpb24uc2xpY2UoMCwgZGVzY3JpcHRpb24ubGVuZ3RoIC0gMSk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGVkaXRDb25kaXRvbihlOiBhbnkpIHtcclxuICAgIC8vIHRoaXMuZXhwci5jbGVhckNvbnRleHQoKTtcclxuICAgIGlmICh0aGlzLmRlc2lnbmVyVUlTdGF0ZS5zY2hlbWFzLmxlbmd0aCA+IDApIHtcclxuICAgICAgZm9yIChjb25zdCBzY2hlbWEgb2YgdGhpcy5kZXNpZ25lclVJU3RhdGUuc2NoZW1hcykge1xyXG4gICAgICAgIHRoaXMuZXhwci5hZGRTY2hlbWEoJ1NjaGVtYScsIHNjaGVtYSk7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKHRoaXMuZGVzaWduZXJVSVN0YXRlLnNjaGVtYXNbMF0uZW50aXR5VHlwZXMgJiYgdGhpcy5kZXNpZ25lclVJU3RhdGUuc2NoZW1hc1swXS5lbnRpdHlUeXBlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgY29uc3QgZW50aXR5VHlwZSA9IHRoaXMuZGVzaWduZXJVSVN0YXRlLnNjaGVtYXNbMF0uZW50aXR5VHlwZXNbMF07XHJcbiAgICAgICAgdGhpcy5leHByLmFkZEluamVjdGVkRW50aXR5KGVudGl0eVR5cGUubmFtZSwgJ1NjaGVtYScsXHJcbiAgICAgICAgICBlbnRpdHlUeXBlLm5hbWUsIEluamVjdGVkVHlwZS5FbnRpdHlUeXBlKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgbGV0IGNvbnRleHQgPSBuZXcgQXJyYXkoKTtcclxuICAgIGNvbnRleHQgPSB0aGlzLmRlc2lnbmVyVUlTdGF0ZS5hZGRDb250ZXh0KGNvbnRleHQpO1xyXG4gICAgaWYgKHRoaXMuZGVzaWduZXJVSVN0YXRlLnN1YkFjdGl2aXR5Q29udGV4dC5sZW5ndGggPiAwKSB7XHJcbiAgICAgIGZvciAoY29uc3QgdmFyaWFibGUgb2YgdGhpcy5kZXNpZ25lclVJU3RhdGUuc3ViQWN0aXZpdHlDb250ZXh0KSB7XHJcbiAgICAgICAgaWYgKCFjb250ZXh0LnNvbWUoYyA9PiBjLmtleSA9PT0gdmFyaWFibGUua2V5KSkge1xyXG4gICAgICAgICAgY29udGV4dC5wdXNoKHZhcmlhYmxlKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIGlmICh0aGlzLmRlc2lnbmVyVUlTdGF0ZS5hY3Rpdml0eUNvbXBvbmVudENvbnRleHQubGVuZ3RoID4gMCkge1xyXG4gICAgICBmb3IgKGNvbnN0IHZhcmlhYmxlIG9mIHRoaXMuZGVzaWduZXJVSVN0YXRlLmFjdGl2aXR5Q29tcG9uZW50Q29udGV4dCkge1xyXG4gICAgICAgIGlmICghY29udGV4dC5zb21lKGMgPT4gYy5rZXkgPT09IHZhcmlhYmxlLmtleSkpIHtcclxuICAgICAgICAgIGNvbnRleHQucHVzaCh2YXJpYWJsZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBpZiAoY29udGV4dC5sZW5ndGggPiAwKSB7XHJcbiAgICAgIGZvciAoY29uc3QgdiBvZiBjb250ZXh0KSB7XHJcbiAgICAgICAgdGhpcy5leHByLmFkZENvbnRleHQodik7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIHRoaXMuZXhwci5hZGRFeHByZXNzaW9uVGV4dChlLmluc3RhbmNlLnZhbHVlKTtcclxuICAgIHRoaXMuZXhwci5zZXRFZGl0UGF0dGVybihFeHByRWRpdE1vZGUuQ29uZGl0aW9uYWwpOyAvLyDpu5jorqTmiZPlvIDnroDmmJPooajovr7lvI/nvJbovpHlmahcclxuICAgIHRoaXMuZXhwci5idWlsZEV4cHJlc3Npb24oKS50aGVuKChjb25kOiBzdHJpbmcpID0+IHtcclxuICAgICAgaWYodGhpcy5wb3RlbnRpYWxPd25lckdyaWQgJiYgdGhpcy5wb3RlbnRpYWxPd25lckdyaWQuc2VsZWN0ZWRSb3cgJiYgdGhpcy5wb3RlbnRpYWxPd25lckdyaWQuc2VsZWN0ZWRSb3cuZGF0YSkge1xyXG4gICAgICAgIGxldCB0ZW1wID0gdGhpcy5wYXJ0aWNpcGFudC5wb3RlbnRpYWxPd25lckxpc3QuZmluZChoID0+IGguaWQgPT09IHRoaXMucG90ZW50aWFsT3duZXJHcmlkLnNlbGVjdGVkUm93LmRhdGEuaWQpO1xyXG4gICAgICAgIHRlbXAuY29uZGl0aW9uID0gY29uZDtcclxuICAgICAgfVxyXG4gICAgICBlLmZvcm1Db250cm9sLnNldFZhbHVlKGNvbmQpO1xyXG4gICAgICBlLmluc3RhbmNlLmNkLmRldGVjdENoYW5nZXMoKTtcclxuICAgICAgLy/ngrnlh7vnoa7lrprlkI7vvIzljrvpmaTooajovr7lvI/ph4zpnaLnmoTmlrDlop7nmoTkuIrkuIvmloflj5jph49cclxuICAgICAgaWYoY29udGV4dC5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgdGhpcy5leHByLmV4cHJFbnRpdHkuY29udGV4dEVudGl0aWVzID0gdGhpcy5leHByLmV4cHJFbnRpdHkuY29udGV4dEVudGl0aWVzLmZpbHRlcih4ID0+ICFjb250ZXh0LnNvbWUoeSA9PiB5LmtleSA9PT0geC5rZXkpKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIEdldE9yZ2FuaXphdGlvblR5cGUoKSB7XHJcbiAgICBjb25zdCB1cmwgPSAnL2FwaS9ydW50aW1lL3N5cy92MS4wL2F1dGhmaWVsZHMvZ2xvYmFsYXV0aGZpZWxkcyc7XHJcbiAgICB0aGlzLmh0dHAuZ2V0KHVybClcclxuICAgICAgLnN1YnNjcmliZSgoZGF0YTogYW55KSA9PiB0aGlzLmRlc2lnbmVyVUlTdGF0ZS5vcmdUeXBlQ29sbGVjdGlvbiA9IGRhdGEubWFwKGQgPT4gKHsgdmFsdWU6IGQuaWQsIHRleHQ6IGQubmFtZSB9KSkpO1xyXG4gIH1cclxuXHJcbiAgLy8g5p6E6YCg5LiN5ZCM5Y+C5LiO6ICF6YCJ5oup55WM6Z2i55qE5bC65a+4IDIwMjMtNy01XHJcbiAgcHJpdmF0ZSBhdHRyaWJ1dGVCb3hTaXplKGJveFR5cGU6IHN0cmluZykge1xyXG4gICAgY29uc3QgYm94c2l6ZSA9IHtcclxuICAgICAgd2lkdGg6IDc2MCxcclxuICAgICAgaGVpZ2h0OiA1MTJcclxuICAgIH1cclxuICAgIHN3aXRjaCAoYm94VHlwZSkge1xyXG4gICAgICBjYXNlICd3Zi5Qb3NpdGlvblBhcnRpY2lwYW50RXhwcmVzc2lvbic6XHJcbiAgICAgICAgYm94c2l6ZS53aWR0aCA9IDc2MDtcclxuICAgICAgICBib3hzaXplLmhlaWdodCA9IDQ1NTtcclxuICAgICAgICByZXR1cm4gYm94c2l6ZTtcclxuICAgICAgY2FzZSAnd2YuVXNlclBhcnRpY2lwYW50RXhwcmVzc2lvbic6XHJcbiAgICAgICAgYm94c2l6ZS53aWR0aCA9IDc2MDtcclxuICAgICAgICBib3hzaXplLmhlaWdodCA9IDMyMDtcclxuICAgICAgICByZXR1cm4gYm94c2l6ZTtcclxuICAgICAgY2FzZSAnd2YuVmFyaWFibGVQYXJ0aWNpcGFudEV4cHJlc3Npb24nOlxyXG4gICAgICAgIGJveHNpemUud2lkdGggPSA3NjA7XHJcbiAgICAgICAgYm94c2l6ZS5oZWlnaHQgPSA0MjA7XHJcbiAgICAgICAgcmV0dXJuIGJveHNpemU7O1xyXG4gICAgICBjYXNlICd3Zi5SZXBvcnRpbmdMaW5lUGFydGljaXBhbnRFeHByZXNzaW9uJzpcclxuICAgICAgICBib3hzaXplLndpZHRoID0gNzYwO1xyXG4gICAgICAgIGJveHNpemUuaGVpZ2h0ID0gNTEyO1xyXG4gICAgICAgIHJldHVybiBib3hzaXplOztcclxuICAgICAgY2FzZSAnd2YuTWF0cml4UGFydGljaXBhbnRFeHByZXNzaW9uJzpcclxuICAgICAgICBib3hzaXplLndpZHRoID0gNzgwO1xyXG4gICAgICAgIGJveHNpemUuaGVpZ2h0ID0gNDIwO1xyXG4gICAgICAgIHJldHVybiBib3hzaXplOztcclxuICAgICAgY2FzZSAnd2YuQ29tcG9uZW50UGFydGljaXBhbnRFeHByZXNzaW9uJzpcclxuICAgICAgICBib3hzaXplLndpZHRoID0gNzYwO1xyXG4gICAgICAgIGJveHNpemUuaGVpZ2h0ID0gNTEyO1xyXG4gICAgICAgIHJldHVybiBib3hzaXplOztcclxuICAgICAgY2FzZSAnd2YuQWN0aXZpdHlFeGVjdXRvclBhcnRpY2lwYW50RXhwcmVzc2lvbic6XHJcbiAgICAgICAgYm94c2l6ZS53aWR0aCA9IDc2MDtcclxuICAgICAgICBib3hzaXplLmhlaWdodCA9IDMyMDtcclxuICAgICAgICByZXR1cm4gYm94c2l6ZTs7XHJcbiAgICAgIGNhc2UgJ3dmLk9yZ2FuaXphdGlvblBhcnRpY2lwYW50RXhwcmVzc2lvbic6XHJcbiAgICAgICAgYm94c2l6ZS53aWR0aCA9IDc2MDtcclxuICAgICAgICBib3hzaXplLmhlaWdodCA9IDM2MDtcclxuICAgICAgICByZXR1cm4gYm94c2l6ZTs7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcbiJdfQ==