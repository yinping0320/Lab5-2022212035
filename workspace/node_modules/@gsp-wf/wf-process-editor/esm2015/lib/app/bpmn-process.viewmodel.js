/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Injectable } from '@angular/core';
import { ProcessDesignerUIState } from './process-designer.uistate';
import { EntryFormEditorComponent, FlowFormConverter } from '../views/entryForm/entry-form-editor.component';
import { ActivityComponentComponent, ActivityComponentConverter } from '../views/activity-component/activity-component.component';
import { ExecuteFormsComponent, ExecuteFormsConverter } from '../views/execute-forms/execute-forms.component';
import { TitleExpressionComponent, TitleExpressionConverter } from '../views/title-expression/title-expression.component';
import { CustomizeActionComponent, CustomizeActionConverter } from '../views/customize-action/customize-action.component';
import { ProcessVariablesComponent, ProcessVariablesConverter } from '../views/process-variables/process-variables.component';
import { TimeLimitControlComponent, TimeLimitControlConverter } from '../views/time-limit-control/time-limit-control.component';
import { MessageNoticeComponent, MessageNoticeConverter } from '../views/message-notice/message-notice.component';
import { ExtendPropertyComponent, ExtendPropertyConverter } from '../views/extend-property/extend-property.component';
import { ImageSetComponent, ImageSetConverter } from '../views/image-set/image-set.component';
import { StartConditionComponent, StartConditionConverter } from '../views/start-condition/start-condition.component';
import { ProcessPropertyKeys } from '../designer/wf-cell/property-keys/ProcessPropertyKeys';
import { WfLocalePipe } from '../i18n/pipe/wf-process-editor-locale.pipe';
export class BpmnProcessViewModel {
    /**
     * @param {?} uiState
     * @param {?} localPipe
     */
    constructor(uiState, localPipe) {
        this.uiState = uiState;
        this.localPipe = localPipe;
    }
    /**
     * @param {?} obj
     * @return {?}
     */
    setProcessProperty(obj) {
        this.uiState.propertyData = obj.propertyData;
        this.uiState.ProcessVariables = this.uiState.propertyData[ProcessPropertyKeys.processVariables];
        this.uiState.propertyConfig = this.setProcessConfig(obj.propertyConfig);
    }
    /**
     * @param {?} obj
     * @return {?}
     */
    setProcessConfig(obj) {
        /** @type {?} */
        const propertyConfig = [];
        if (obj) {
            obj.forEach((/**
             * @param {?} element
             * @return {?}
             */
            (element) => {
                this.setProcessEntity(element.properties);
                propertyConfig.push(element);
            }));
        }
        return propertyConfig;
    }
    /**
     * @private
     * @param {?} obj
     * @return {?}
     */
    setProcessEntity(obj) {
        if (obj.length > 0) {
            obj.forEach((/**
             * @param {?} item
             * @return {?}
             */
            (item) => {
                switch (item.propertyID) {
                    case ProcessPropertyKeys.Key: // 标识
                        break;
                    case ProcessPropertyKeys.EntryForm: // 流程分类
                        item.editor = EntryFormEditorComponent;
                        item.converter = new FlowFormConverter();
                        // item.editorParams = {
                        //     flowForms: [this.uiState.flowFormInfo.flowForm]
                        // };
                        break;
                    case ProcessPropertyKeys.wf_Component:
                        item.editor = ActivityComponentComponent;
                        item.converter = new ActivityComponentConverter(this.localPipe);
                        item.editorParams = {
                            location: 'process'
                        };
                        break;
                    case ProcessPropertyKeys.wf_ExecuteForms_PC:
                        item.editor = ExecuteFormsComponent;
                        /** @type {?} */
                        const params = {
                            location: 'process',
                            tab: 'web'
                        };
                        item.converter = new ExecuteFormsConverter(params, this.localPipe);
                        item.editorParams = params;
                        break;
                    case ProcessPropertyKeys.wf_ExecuteForms_Mobile:
                        item.editor = ExecuteFormsComponent;
                        /** @type {?} */
                        const editorParams = {
                            location: 'process',
                            tab: 'mobile'
                        };
                        item.converter = new ExecuteFormsConverter(editorParams, this.localPipe);
                        item.editorParams = editorParams;
                        break;
                    case ProcessPropertyKeys.wf_TitleExpression:
                        item.editor = TitleExpressionComponent;
                        item.converter = new TitleExpressionConverter(this.localPipe);
                        break;
                    case ProcessPropertyKeys.allowPreAssign:
                        item.iterator = this.uiState.boolIterator;
                        break;
                    case ProcessPropertyKeys.enablePriority:
                        item.iterator = this.uiState.boolIterator;
                        break;
                    case ProcessPropertyKeys.enableWholeOrderRetrieve:
                        item.iterator = this.uiState.boolIterator;
                        break;
                    case ProcessPropertyKeys.startMode:
                        item.iterator = this.uiState.startModeIterator;
                        break;
                    case ProcessPropertyKeys.DisplayTerminal:
                        item.iterator = this.uiState.displayTerminal;
                        break;
                    case ProcessPropertyKeys.wf_CustomizeAction:
                        item.editor = CustomizeActionComponent;
                        item.converter = new CustomizeActionConverter(this.localPipe);
                        break;
                    case ProcessPropertyKeys.processVariables:
                        item.editor = ProcessVariablesComponent;
                        item.converter = new ProcessVariablesConverter(this.localPipe);
                        break;
                    case ProcessPropertyKeys.timeLimitControl:
                        item.editor = TimeLimitControlComponent;
                        item.converter = new TimeLimitControlConverter(this.localPipe);
                        item.editorParams = {
                            location: 'process'
                        };
                        break;
                    case ProcessPropertyKeys.messageNotice:
                        item.editor = MessageNoticeComponent;
                        item.converter = new MessageNoticeConverter(this.localPipe);
                        item.editorParams = {
                            location: 'process'
                        };
                        break;
                    case ProcessPropertyKeys.imageSettings:
                        item.editor = ImageSetComponent;
                        item.converter = new ImageSetConverter(this.localPipe);
                        break;
                    case ProcessPropertyKeys.StartCondition:
                        item.editor = StartConditionComponent;
                        item.editorParams = {};
                        item.converter = new StartConditionConverter();
                        break;
                    default:
                        item.editor = ExtendPropertyComponent;
                        item.converter = new ExtendPropertyConverter(this.localPipe);
                        break;
                }
            }));
        }
    }
}
BpmnProcessViewModel.decorators = [
    { type: Injectable }
];
/** @nocollapse */
BpmnProcessViewModel.ctorParameters = () => [
    { type: ProcessDesignerUIState },
    { type: WfLocalePipe }
];
if (false) {
    /**
     * @type {?}
     * @private
     */
    BpmnProcessViewModel.prototype.uiState;
    /**
     * @type {?}
     * @private
     */
    BpmnProcessViewModel.prototype.localPipe;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYnBtbi1wcm9jZXNzLnZpZXdtb2RlbC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0Bnc3Atd2Yvd2YtcHJvY2Vzcy1lZGl0b3IvIiwic291cmNlcyI6WyJsaWIvYXBwL2JwbW4tcHJvY2Vzcy52aWV3bW9kZWwudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDM0MsT0FBTyxFQUFFLHNCQUFzQixFQUFFLE1BQU0sNEJBQTRCLENBQUM7QUFFcEUsT0FBTyxFQUFFLHdCQUF3QixFQUFFLGlCQUFpQixFQUFFLE1BQU0sZ0RBQWdELENBQUM7QUFDN0csT0FBTyxFQUNMLDBCQUEwQixFQUMxQiwwQkFBMEIsRUFDM0IsTUFBTSwwREFBMEQsQ0FBQztBQUNsRSxPQUFPLEVBQUUscUJBQXFCLEVBQUUscUJBQXFCLEVBQUUsTUFBTSxnREFBZ0QsQ0FBQztBQUM5RyxPQUFPLEVBQUUsd0JBQXdCLEVBQUUsd0JBQXdCLEVBQUUsTUFBTSxzREFBc0QsQ0FBQztBQUMxSCxPQUFPLEVBQUUsd0JBQXdCLEVBQUUsd0JBQXdCLEVBQUUsTUFBTSxzREFBc0QsQ0FBQztBQUMxSCxPQUFPLEVBQ0wseUJBQXlCLEVBQ3pCLHlCQUF5QixFQUMxQixNQUFNLHdEQUF3RCxDQUFDO0FBQ2hFLE9BQU8sRUFDTCx5QkFBeUIsRUFDekIseUJBQXlCLEVBQzFCLE1BQU0sMERBQTBELENBQUM7QUFDbEUsT0FBTyxFQUFFLHNCQUFzQixFQUFFLHNCQUFzQixFQUFFLE1BQU0sa0RBQWtELENBQUM7QUFDbEgsT0FBTyxFQUFFLHVCQUF1QixFQUFFLHVCQUF1QixFQUFFLE1BQU0sb0RBQW9ELENBQUM7QUFDdEgsT0FBTyxFQUFFLGlCQUFpQixFQUFFLGlCQUFpQixFQUFFLE1BQU0sd0NBQXdDLENBQUM7QUFDOUYsT0FBTyxFQUFFLHVCQUF1QixFQUFFLHVCQUF1QixFQUFFLE1BQU0sb0RBQW9ELENBQUM7QUFDdEgsT0FBTyxF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LHVCQUF1QixDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsQ0FBQzt3QkFDN0QsTUFBTTtpQkFDVDtZQUNILENBQUMsRUFBQyxDQUFDO1NBQ0o7SUFDSCxDQUFDOzs7WUF6SEYsVUFBVTs7OztZQXpCRixzQkFBc0I7WUF1QnRCLFlBQVk7Ozs7Ozs7SUFNakIsdUNBQXVDOzs7OztJQUN2Qyx5Q0FBK0IiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJbmplY3RhYmxlIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IFByb2Nlc3NEZXNpZ25lclVJU3RhdGUgfSBmcm9tICcuL3Byb2Nlc3MtZGVzaWduZXIudWlzdGF0ZSc7XHJcbmltcG9ydCB7IFByb3BlcnR5RW50aXR5LCBFbGVtZW50UHJvcGVydHlDb25maWcgfSBmcm9tICdAZmFycmlzL2lkZS1wcm9wZXJ0eS1wYW5lbCc7XHJcbmltcG9ydCB7IEVudHJ5Rm9ybUVkaXRvckNvbXBvbmVudCwgRmxvd0Zvcm1Db252ZXJ0ZXIgfSBmcm9tICcuLi92aWV3cy9lbnRyeUZvcm0vZW50cnktZm9ybS1lZGl0b3IuY29tcG9uZW50JztcclxuaW1wb3J0IHtcclxuICBBY3Rpdml0eUNvbXBvbmVudENvbXBvbmVudCxcclxuICBBY3Rpdml0eUNvbXBvbmVudENvbnZlcnRlclxyXG59IGZyb20gJy4uL3ZpZXdzL2FjdGl2aXR5LWNvbXBvbmVudC9hY3Rpdml0eS1jb21wb25lbnQuY29tcG9uZW50JztcclxuaW1wb3J0IHsgRXhlY3V0ZUZvcm1zQ29tcG9uZW50LCBFeGVjdXRlRm9ybXNDb252ZXJ0ZXIgfSBmcm9tICcuLi92aWV3cy9leGVjdXRlLWZvcm1zL2V4ZWN1dGUtZm9ybXMuY29tcG9uZW50JztcclxuaW1wb3J0IHsgVGl0bGVFeHByZXNzaW9uQ29tcG9uZW50LCBUaXRsZUV4cHJlc3Npb25Db252ZXJ0ZXIgfSBmcm9tICcuLi92aWV3cy90aXRsZS1leHByZXNzaW9uL3RpdGxlLWV4cHJlc3Npb24uY29tcG9uZW50JztcclxuaW1wb3J0IHsgQ3VzdG9taXplQWN0aW9uQ29tcG9uZW50LCBDdXN0b21pemVBY3Rpb25Db252ZXJ0ZXIgfSBmcm9tICcuLi92aWV3cy9jdXN0b21pemUtYWN0aW9uL2N1c3RvbWl6ZS1hY3Rpb24uY29tcG9uZW50JztcclxuaW1wb3J0IHtcclxuICBQcm9jZXNzVmFyaWFibGVzQ29tcG9uZW50LFxyXG4gIFByb2Nlc3NWYXJpYWJsZXNDb252ZXJ0ZXJcclxufSBmcm9tICcuLi92aWV3cy9wcm9jZXNzLXZhcmlhYmxlcy9wcm9jZXNzLXZhcmlhYmxlcy5jb21wb25lbnQnO1xyXG5pbXBvcnQge1xyXG4gIFRpbWVMaW1pdENvbnRyb2xDb21wb25lbnQsXHJcbiAgVGltZUxpbWl0Q29udHJvbENvbnZlcnRlclxyXG59IGZyb20gJy4uL3ZpZXdzL3RpbWUtbGltaXQtY29udHJvbC90aW1lLWxpbWl0LWNvbnRyb2wuY29tcG9uZW50JztcclxuaW1wb3J0IHsgTWVzc2FnZU5vdGljZUNvbXBvbmVudCwgTWVzc2FnZU5vdGljZUNvbnZlcnRlciB9IGZyb20gJy4uL3ZpZXdzL21lc3NhZ2Utbm90aWNlL21lc3NhZ2Utbm90aWNlLmNvbXBvbmVudCc7XHJcbmltcG9ydCB7IEV4dGVuZFByb3BlcnR5Q29tcG9uZW50LCBFeHRlbmRQcm9wZXJ0eUNvbnZlcnRlciB9IGZyb20gJy4uL3ZpZXdzL2V4dGVuZC1wcm9wZXJ0eS9leHRlbmQtcHJvcGVydHkuY29tcG9uZW50JztcclxuaW1wb3J0IHsgSW1hZ2VTZXRDb21wb25lbnQsIEltYWdlU2V0Q29udmVydGVyIH0gZnJvbSAnLi4vdmlld3MvaW1hZ2Utc2V0L2ltYWdlLXNldC5jb21wb25lbnQnO1xyXG5pbXBvcnQgeyBTdGFydENvbmRpdGlvbkNvbXBvbmVudCwgU3RhcnRDb25kaXRpb25Db252ZXJ0ZXIgfSBmcm9tICcuLi92aWV3cy9zdGFydC1jb25kaXRpb24vc3RhcnQtY29uZGl0aW9uLmNvbXBvbmVudCc7XHJcbmltcG9ydCB7IFByb2Nlc3NQcm9wZXJ0eUtleXMgfSBmcm9tICcuLi9kZXNpZ25lci93Zi1jZWxsL3Byb3BlcnR5LWtleXMvUHJvY2Vzc1Byb3BlcnR5S2V5cyc7XHJcbmltcG9ydCB7IFdmTG9jYWxlUGlwZSB9IGZyb20gJy4uL2kxOG4vcGlwZS93Zi1wcm9jZXNzLWVkaXRvci1sb2NhbGUucGlwZSc7XHJcblxyXG5ASW5qZWN0YWJsZSgpXHJcblxyXG5leHBvcnQgY2xhc3MgQnBtblByb2Nlc3NWaWV3TW9kZWwge1xyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgcHJpdmF0ZSB1aVN0YXRlOiBQcm9jZXNzRGVzaWduZXJVSVN0YXRlLFxyXG4gICAgcHJpdmF0ZSBsb2NhbFBpcGU6IFdmTG9jYWxlUGlwZVxyXG4gICkge1xyXG4gIH1cclxuXHJcbiAgc2V0UHJvY2Vzc1Byb3BlcnR5KG9iajogYW55KSB7XHJcbiAgICB0aGlzLnVpU3RhdGUucHJvcGVydHlEYXRhID0gb2JqLnByb3BlcnR5RGF0YTtcclxuICAgIHRoaXMudWlTdGF0ZS5Qcm9jZXNzVmFyaWFibGVzID0gdGhpcy51aVN0YXRlLnByb3BlcnR5RGF0YVtQcm9jZXNzUHJvcGVydHlLZXlzLnByb2Nlc3NWYXJpYWJsZXNdO1xyXG4gICAgdGhpcy51aVN0YXRlLnByb3BlcnR5Q29uZmlnID0gdGhpcy5zZXRQcm9jZXNzQ29uZmlnKG9iai5wcm9wZXJ0eUNvbmZpZyk7XHJcbiAgfVxyXG5cclxuICBzZXRQcm9jZXNzQ29uZmlnKG9iajogYW55W10pOiBFbGVtZW50UHJvcGVydHlDb25maWdbXSB7XHJcbiAgICBjb25zdCBwcm9wZXJ0eUNvbmZpZzogRWxlbWVudFByb3BlcnR5Q29uZmlnW10gPSBbXTtcclxuICAgIGlmIChvYmopIHtcclxuICAgICAgb2JqLmZvckVhY2goKGVsZW1lbnQ6IEVsZW1lbnRQcm9wZXJ0eUNvbmZpZykgPT4ge1xyXG4gICAgICAgIHRoaXMuc2V0UHJvY2Vzc0VudGl0eShlbGVtZW50LnByb3BlcnRpZXMpO1xyXG4gICAgICAgIHByb3BlcnR5Q29uZmlnLnB1c2goZWxlbWVudCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHByb3BlcnR5Q29uZmlnO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBzZXRQcm9jZXNzRW50aXR5KG9iajogUHJvcGVydHlFbnRpdHlbXSkge1xyXG4gICAgaWYgKG9iai5sZW5ndGggPiAwKSB7XHJcbiAgICAgIG9iai5mb3JFYWNoKChpdGVtOiBQcm9wZXJ0eUVudGl0eSkgPT4ge1xyXG4gICAgICAgIHN3aXRjaCAoaXRlbS5wcm9wZXJ0eUlEKSB7XHJcbiAgICAgICAgICBjYXNlIFByb2Nlc3NQcm9wZXJ0eUtleXMuS2V5OiAvLyDmoIfor4ZcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICBjYXNlIFByb2Nlc3NQcm9wZXJ0eUtleXMuRW50cnlGb3JtOiAvLyDmtYHnqIvliIbnsbtcclxuICAgICAgICAgICAgaXRlbS5lZGl0b3IgPSBFbnRyeUZvcm1FZGl0b3JDb21wb25lbnQ7XHJcbiAgICAgICAgICAgIGl0ZW0uY29udmVydGVyID0gbmV3IEZsb3dGb3JtQ29udmVydGVyKCk7XHJcbiAgICAgICAgICAgIC8vIGl0ZW0uZWRpdG9yUGFyYW1zID0ge1xyXG4gICAgICAgICAgICAvLyAgICAgZmxvd0Zvcm1zOiBbdGhpcy51aVN0YXRlLmZsb3dGb3JtSW5mby5mbG93Rm9ybV1cclxuICAgICAgICAgICAgLy8gfTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICBjYXNlIFByb2Nlc3NQcm9wZXJ0eUtleXMud2ZfQ29tcG9uZW50OlxyXG4gICAgICAgICAgICBpdGVtLmVkaXRvciA9IEFjdGl2aXR5Q29tcG9uZW50Q29tcG9uZW50O1xyXG4gICAgICAgICAgICBpdGVtLmNvbnZlcnRlciA9IG5ldyBBY3Rpdml0eUNvbXBvbmVudENvbnZlcnRlcih0aGlzLmxvY2FsUGlwZSk7XHJcbiAgICAgICAgICAgIGl0ZW0uZWRpdG9yUGFyYW1zID0ge1xyXG4gICAgICAgICAgICAgIGxvY2F0aW9uOiAncHJvY2VzcydcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICBjYXNlIFByb2Nlc3NQcm9wZXJ0eUtleXMud2ZfRXhlY3V0ZUZvcm1zX1BDOlxyXG4gICAgICAgICAgICBpdGVtLmVkaXRvciA9IEV4ZWN1dGVGb3Jtc0NvbXBvbmVudDtcclxuICAgICAgICAgICAgY29uc3QgcGFyYW1zID0ge1xyXG4gICAgICAgICAgICAgIGxvY2F0aW9uOiAncHJvY2VzcycsXHJcbiAgICAgICAgICAgICAgdGFiOiAnd2ViJ1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGl0ZW0uY29udmVydGVyID0gbmV3IEV4ZWN1dGVGb3Jtc0NvbnZlcnRlcihwYXJhbXMsIHRoaXMubG9jYWxQaXBlKTtcclxuICAgICAgICAgICAgaXRlbS5lZGl0b3JQYXJhbXMgPSBwYXJhbXM7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgY2FzZSBQcm9jZXNzUHJvcGVydHlLZXlzLndmX0V4ZWN1dGVGb3Jtc19Nb2JpbGU6XHJcbiAgICAgICAgICAgIGl0ZW0uZWRpdG9yID0gRXhlY3V0ZUZvcm1zQ29tcG9uZW50O1xyXG4gICAgICAgICAgICBjb25zdCBlZGl0b3JQYXJhbXMgPSB7XHJcbiAgICAgICAgICAgICAgbG9jYXRpb246ICdwcm9jZXNzJyxcclxuICAgICAgICAgICAgICB0YWI6ICdtb2JpbGUnXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIGl0ZW0uY29udmVydGVyID0gbmV3IEV4ZWN1dGVGb3Jtc0NvbnZlcnRlcihlZGl0b3JQYXJhbXMsIHRoaXMubG9jYWxQaXBlKTtcclxuICAgICAgICAgICAgaXRlbS5lZGl0b3JQYXJhbXMgPSBlZGl0b3JQYXJhbXM7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgY2FzZSBQcm9jZXNzUHJvcGVydHlLZXlzLndmX1RpdGxlRXhwcmVzc2lvbjpcclxuICAgICAgICAgICAgaXRlbS5lZGl0b3IgPSBUaXRsZUV4cHJlc3Npb25Db21wb25lbnQ7XHJcbiAgICAgICAgICAgIGl0ZW0uY29udmVydGVyID0gbmV3IFRpdGxlRXhwcmVzc2lvbkNvbnZlcnRlcih0aGlzLmxvY2FsUGlwZSk7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgY2FzZSBQcm9jZXNzUHJvcGVydHlLZXlzLmFsbG93UHJlQXNzaWduOlxyXG4gICAgICAgICAgICBpdGVtLml0ZXJhdG9yID0gdGhpcy51aVN0YXRlLmJvb2xJdGVyYXRvcjtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICBjYXNlIFByb2Nlc3NQcm9wZXJ0eUtleXMuZW5hYmxlUHJpb3JpdHk6XHJcbiAgICAgICAgICAgIGl0ZW0uaXRlcmF0b3IgPSB0aGlzLnVpU3RhdGUuYm9vbEl0ZXJhdG9yO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgIGNhc2UgUHJvY2Vzc1Byb3BlcnR5S2V5cy5lbmFibGVXaG9sZU9yZGVyUmV0cmlldmU6XHJcbiAgICAgICAgICAgIGl0ZW0uaXRlcmF0b3IgPSB0aGlzLnVpU3RhdGUuYm9vbEl0ZXJhdG9yO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgIGNhc2UgUHJvY2Vzc1Byb3BlcnR5S2V5cy5zdGFydE1vZGU6XHJcbiAgICAgICAgICAgIGl0ZW0uaXRlcmF0b3IgPSB0aGlzLnVpU3RhdGUuc3RhcnRNb2RlSXRlcmF0b3I7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgY2FzZSBQcm9jZXNzUHJvcGVydHlLZXlzLkRpc3BsYXlUZXJtaW5hbDpcclxuICAgICAgICAgICAgaXRlbS5pdGVyYXRvciA9IHRoaXMudWlTdGF0ZS5kaXNwbGF5VGVybWluYWw7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgY2FzZSBQcm9jZXNzUHJvcGVydHlLZXlzLndmX0N1c3RvbWl6ZUFjdGlvbjpcclxuICAgICAgICAgICAgaXRlbS5lZGl0b3IgPSBDdXN0b21pemVBY3Rpb25Db21wb25lbnQ7XHJcbiAgICAgICAgICAgIGl0ZW0uY29udmVydGVyID0gbmV3IEN1c3RvbWl6ZUFjdGlvbkNvbnZlcnRlcih0aGlzLmxvY2FsUGlwZSk7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgY2FzZSBQcm9jZXNzUHJvcGVydHlLZXlzLnByb2Nlc3NWYXJpYWJsZXM6XHJcbiAgICAgICAgICAgIGl0ZW0uZWRpdG9yID0gUHJvY2Vzc1ZhcmlhYmxlc0NvbXBvbmVudDtcclxuICAgICAgICAgICAgaXRlbS5jb252ZXJ0ZXIgPSBuZXcgUHJvY2Vzc1ZhcmlhYmxlc0NvbnZlcnRlcih0aGlzLmxvY2FsUGlwZSk7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgY2FzZSBQcm9jZXNzUHJvcGVydHlLZXlzLnRpbWVMaW1pdENvbnRyb2w6XHJcbiAgICAgICAgICAgIGl0ZW0uZWRpdG9yID0gVGltZUxpbWl0Q29udHJvbENvbXBvbmVudDtcclxuICAgICAgICAgICAgaXRlbS5jb252ZXJ0ZXIgPSBuZXcgVGltZUxpbWl0Q29udHJvbENvbnZlcnRlcih0aGlzLmxvY2FsUGlwZSk7XHJcbiAgICAgICAgICAgIGl0ZW0uZWRpdG9yUGFyYW1zID0ge1xyXG4gICAgICAgICAgICAgIGxvY2F0aW9uOiAncHJvY2VzcydcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICBjYXNlIFByb2Nlc3NQcm9wZXJ0eUtleXMubWVzc2FnZU5vdGljZTpcclxuICAgICAgICAgICAgaXRlbS5lZGl0b3IgPSBNZXNzYWdlTm90aWNlQ29tcG9uZW50O1xyXG4gICAgICAgICAgICBpdGVtLmNvbnZlcnRlciA9IG5ldyBNZXNzYWdlTm90aWNlQ29udmVydGVyKHRoaXMubG9jYWxQaXBlKTtcclxuICAgICAgICAgICAgaXRlbS5lZGl0b3JQYXJhbXMgPSB7XHJcbiAgICAgICAgICAgICAgbG9jYXRpb246ICdwcm9jZXNzJ1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgIGNhc2UgUHJvY2Vzc1Byb3BlcnR5S2V5cy5pbWFnZVNldHRpbmdzOlxyXG4gICAgICAgICAgICBpdGVtLmVkaXRvciA9IEltYWdlU2V0Q29tcG9uZW50O1xyXG4gICAgICAgICAgICBpdGVtLmNvbnZlcnRlciA9IG5ldyBJbWFnZVNldENvbnZlcnRlcih0aGlzLmxvY2FsUGlwZSk7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgY2FzZSBQcm9jZXNzUHJvcGVydHlLZXlzLlN0YXJ0Q29uZGl0aW9uOlxyXG4gICAgICAgICAgICBpdGVtLmVkaXRvciA9IFN0YXJ0Q29uZGl0aW9uQ29tcG9uZW50O1xyXG4gICAgICAgICAgICBpdGVtLmVkaXRvclBhcmFtcyA9IHt9O1xyXG4gICAgICAgICAgICBpdGVtLmNvbnZlcnRlciA9IG5ldyBTdGFydENvbmRpdGlvbkNvbnZlcnRlcigpO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgIGl0ZW0uZWRpdG9yID0gRXh0ZW5kUHJvcGVydHlDb21wb25lbnQ7XHJcbiAgICAgICAgICAgIGl0ZW0uY29udmVydGVyID0gbmV3IEV4dGVuZFByb3BlcnR5Q29udmVydGVyKHRoaXMubG9jYWxQaXBlKTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgIH1cclxuICB9XHJcbn1cclxuIl19