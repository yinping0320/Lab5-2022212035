/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Graph } from "@edp-pmf/grapheditor";
import { FlowNodeState } from "@edp-pmf/bpmn-model";
import { mxConstants, mxUtils } from "@edp-pmf/mxgraph-ts";
import { WfProcessCell } from "./wf-cell/WfProcessCell";
/**
 * 工作流画布类
 */
export class WfGraph extends Graph {
    /**
     * @param {?} editorUi
     * @param {?=} container
     * @param {?=} model
     * @param {?=} renderHint
     * @param {?=} stylesheet
     * @param {?=} themes
     */
    constructor(editorUi, container, model, renderHint, stylesheet, themes) {
        super(editorUi, container, model, renderHint, stylesheet, themes);
        this.localePipe = null;
        /**
         * 流程元素实例
         */
        this.processCell = new WfProcessCell();
    }
    /**
     * @param {?} cells
     * @param {?} sender
     * @param {?} eventObject
     * @return {?}
     */
    bpmnCellsSelectionChanged(cells, sender, eventObject) {
        super.bpmnCellsSelectionChanged(cells, sender, eventObject);
        // 修改选中节点样式
        /** @type {?} */
        const selected = (/** @type {?} */ (this.getSelectionCells()));
        /** @type {?} */
        const all = (/** @type {?} */ (this.getChildVertices(this.getDefaultParent())));
        all.forEach((/**
         * @param {?} c
         * @return {?}
         */
        c => {
            if (selected.includes(c) && c.imgUrls && c.imgUrls[FlowNodeState.Selected]) {
                c.setStyle(mxUtils.setStyle(c.getStyle(), mxConstants.STYLE_IMAGE, c.imgUrls[FlowNodeState.Selected]));
            }
            else {
                c.setStyle(mxUtils.setStyle(c.getStyle(), mxConstants.STYLE_IMAGE, c.imgUrls[FlowNodeState.Default]));
            }
            this.refresh(c);
        }));
    }
    /**
     * 重写创建流程元素实例方法
     * @param {?} bpmnModel
     * @return {?}
     */
    createProcessCell(bpmnModel) {
        /** @type {?} */
        const processCell = new WfProcessCell();
        processCell.process = bpmnModel.DefaultProcess;
        processCell.plane = bpmnModel.DefaultDiagram.BpmnPlane;
        processCell.editorUi = this.editorUi;
        return processCell;
    }
    /**
     * 给定新流程信息创建BpmnModel
     * @param {?} newProcInfo
     * @param {?} bizCmps
     * @return {?}
     */
    createBpmnModelWithProcInfo(newProcInfo, bizCmps) {
        /** @type {?} */
        const bpmnModel = this.createBpmnModel();
        this.bpmnModel = bpmnModel;
        this.processCell = this.createProcessCell(this.bpmnModel);
        if (this.editorUi.langCode === 'zh-CHS') {
            this.bpmnModel.DefaultProcess.Name = newProcInfo.name || bpmnModel.DefaultProcess.Name;
        }
        this.bpmnModel.DefaultProcess.NameLanguage = {
            [this.editorUi.langCode]: newProcInfo.name || bpmnModel.DefaultProcess.Name,
        };
        //设置流程Header(业务对象ID、流程分类ID)
        this.processCell.setProcessHeader(newProcInfo.ffId, newProcInfo.bizObjId, newProcInfo.ffName, (/** @type {?} */ (newProcInfo.startMode)));
        // 基于流程分类绑定参数，流程构件，流程表单
        this.processCell.updateFlowFormInfo(newProcInfo.formalParameters, newProcInfo.processBizComponnets, newProcInfo.executeForms, newProcInfo.customizeActions, bizCmps);
        this.processCell.modifyProcessTitleExpression(newProcInfo.processDescription);
    }
    /**
     * @return {?}
     */
    setDefaultStyles() {
        super.setDefaultStyles();
        /** @type {?} */
        const styleSheet = this.getStylesheet();
        // 连线样式默认为正交
        /** @type {?} */
        const edgeStyle = styleSheet.getDefaultEdgeStyle();
        edgeStyle[mxConstants.STYLE_ROUNDED] = 1;
    }
}
if (false) {
    /** @type {?} */
    WfGraph.prototype.localePipe;
    /** @type {?} */
    WfGraph.prototype.editorUi;
    /**
     * 流程元素实例
     * @type {?}
     */
    WfGraph.prototype.processCell;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiV2ZHcmFwaC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0Bnc3Atd2Yvd2YtcHJvY2Vzcy1lZGl0b3IvIiwic291cmNlcyI6WyJsaWIvZGVzaWduZXIvV2ZHcmFwaC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUFFLEtBQUssRUFBa0IsTUFBTSxzQkFBc0IsQ0FBQztBQUM3RCxPQUFPLEVBQUUsYUFBYSxFQUFhLE1BQU0scUJBQXFCLENBQUM7QUFHL0QsT0FBTyxFQUFhLFdBQVcsRUFBRSxPQUFPLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUN0RSxPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0seUJBQXlCLENBQUM7Ozs7QUFNeEQsTUFBTSxPQUFPLE9BQVEsU0FBUSxLQUFLOzs7Ozs7Ozs7SUFPOUIsWUFBWSxRQUFvQixFQUFFLFNBQTBCLEVBQUUsS0FBOEIsRUFBRSxVQUFvQyxFQUFFLFVBQW1DLEVBQUUsTUFBZ0I7UUFDckwsS0FBSyxDQUFDLFFBQVEsRUFBRSxTQUFTLEVBQUUsS0FBSyxFQUFFLFVBQVUsRUFBRSxVQUFVLEVBQUUsTUFBTSxDQUFDLENBQUM7UUFQdEUsZUFBVSxHQUFpQixJQUFJLENBQUM7Ozs7UUFLaEMsZ0JBQVcsR0FBa0IsSUFBSSxhQUFhLEVBQUUsQ0FBQztJQUdqRCxDQUFDOzs7Ozs7O0lBRUQseUJBQXlCLENBQUMsS0FBYSxFQUFFLE1BQStCLEVBQUUsV0FBb0M7UUFDNUcsS0FBSyxDQUFDLHlCQUF5QixDQUFDLEtBQUssRUFBRSxNQUFNLEVBQUUsV0FBVyxDQUFDLENBQUM7OztjQUV0RCxRQUFRLEdBQUcsbUJBQUEsSUFBSSxDQUFDLGlCQUFpQixFQUFFLEVBQWM7O2NBQ2pELEdBQUcsR0FBRyxtQkFBQSxJQUFJLENBQUMsZ0JBQWdCLENBQUMsSUFBSSxDQUFDLGdCQUFnQixFQUFFLENBQUMsRUFBYztRQUN4RSxHQUFHLENBQUMsT0FBTzs7OztRQUFDLENBQUMsQ0FBQyxFQUFFO1lBQ1osSUFBSSxRQUFR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O0lBSXJCLDhCQUFpRCIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEdyYXBoLCBDZWxsLCBOb2RlQ2VsbCB9IGZyb20gXCJAZWRwLXBtZi9ncmFwaGVkaXRvclwiO1xyXG5pbXBvcnQgeyBGbG93Tm9kZVN0YXRlLCBCcG1uTW9kZWwgfSBmcm9tIFwiQGVkcC1wbWYvYnBtbi1tb2RlbFwiO1xyXG5pbXBvcnQgeyBTdGFydE1vZGUgfSBmcm9tIFwiQGdzcC13Zi93Zi1wcm9jZXNzLW1vZGVsXCI7XHJcbmltcG9ydCB7IFdmRWRpdG9yVWkgfSBmcm9tIFwiLi9XZkVkaXRvclVpXCI7XHJcbmltcG9ydCB7IE14R3JhcGhOUywgbXhDb25zdGFudHMsIG14VXRpbHMgfSBmcm9tIFwiQGVkcC1wbWYvbXhncmFwaC10c1wiO1xyXG5pbXBvcnQgeyBXZlByb2Nlc3NDZWxsIH0gZnJvbSBcIi4vd2YtY2VsbC9XZlByb2Nlc3NDZWxsXCI7XHJcbmltcG9ydCB7IFdmTG9jYWxlUGlwZSB9IGZyb20gXCIuLi9pMThuL3BpcGUvd2YtcHJvY2Vzcy1lZGl0b3ItbG9jYWxlLnBpcGVcIjtcclxuXHJcbi8qKlxyXG4gKiDlt6XkvZzmtYHnlLvluIPnsbtcclxuICovXHJcbmV4cG9ydCBjbGFzcyBXZkdyYXBoIGV4dGVuZHMgR3JhcGgge1xyXG4gICAgbG9jYWxlUGlwZTogV2ZMb2NhbGVQaXBlID0gbnVsbDtcclxuICAgIGVkaXRvclVpOiBXZkVkaXRvclVpO1xyXG4gICAgLyoqXHJcbiAgICAgKiDmtYHnqIvlhYPntKDlrp7kvotcclxuICAgICAqL1xyXG4gICAgcHJvY2Vzc0NlbGw6IFdmUHJvY2Vzc0NlbGwgPSBuZXcgV2ZQcm9jZXNzQ2VsbCgpO1xyXG4gICAgY29uc3RydWN0b3IoZWRpdG9yVWk6IFdmRWRpdG9yVWksIGNvbnRhaW5lcj86IEhUTUxEaXZFbGVtZW50LCBtb2RlbD86IE14R3JhcGhOUy5teEdyYXBoTW9kZWwsIHJlbmRlckhpbnQ/OiBNeEdyYXBoTlMucmVuZGVyaW5nSGludCwgc3R5bGVzaGVldD86IE14R3JhcGhOUy5teFN0eWxlc2hlZXQsIHRoZW1lcz86IEVsZW1lbnQpIHtcclxuICAgICAgICBzdXBlcihlZGl0b3JVaSwgY29udGFpbmVyLCBtb2RlbCwgcmVuZGVySGludCwgc3R5bGVzaGVldCwgdGhlbWVzKTtcclxuICAgIH1cclxuXHJcbiAgICBicG1uQ2VsbHNTZWxlY3Rpb25DaGFuZ2VkKGNlbGxzOiBDZWxsW10sIHNlbmRlcjogTXhHcmFwaE5TLm14RXZlbnRTb3VyY2UsIGV2ZW50T2JqZWN0OiBNeEdyYXBoTlMubXhFdmVudE9iamVjdCk6IHZvaWQge1xyXG4gICAgICBzdXBlci5icG1uQ2VsbHNTZWxlY3Rpb25DaGFuZ2VkKGNlbGxzLCBzZW5kZXIsIGV2ZW50T2JqZWN0KTtcclxuICAgICAgLy8g5L+u5pS56YCJ5Lit6IqC54K55qC35byPXHJcbiAgICAgIGNvbnN0IHNlbGVjdGVkID0gdGhpcy5nZXRTZWxlY3Rpb25DZWxscygpIGFzIE5vZGVDZWxsW107XHJcbiAgICAgIGNvbnN0IGFsbCA9IHRoaXMuZ2V0Q2hpbGRWZXJ0aWNlcyh0aGlzLmdldERlZmF1bHRQYXJlbnQoKSkgYXMgTm9kZUNlbGxbXTtcclxuICAgICAgYWxsLmZvckVhY2goYyA9PiB7XHJcbiAgICAgICAgICBpZiAoc2VsZWN0ZWQuaW5jbHVkZXMoYykgJiYgYy5pbWdVcmxzICYmIGMuaW1nVXJsc1tGbG93Tm9kZVN0YXRlLlNlbGVjdGVkXSkge1xyXG4gICAgICAgICAgICAgIGMuc2V0U3R5bGUobXhVdGlscy5zZXRTdHlsZShjLmdldFN0eWxlKCksIG14Q29uc3RhbnRzLlNUWUxFX0lNQUdFLCBjLmltZ1VybHNbRmxvd05vZGVTdGF0ZS5TZWxlY3RlZF0pKTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgYy5zZXRTdHlsZShteFV0aWxzLnNldFN0eWxlKGMuZ2V0U3R5bGUoKSwgbXhDb25zdGFudHMuU1RZTEVfSU1BR0UsIGMuaW1nVXJsc1tGbG93Tm9kZVN0YXRlLkRlZmF1bHRdKSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICB0aGlzLnJlZnJlc2goYyk7XHJcbiAgICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOmHjeWGmeWIm+W7uua1geeoi+WFg+e0oOWunuS+i+aWueazlVxyXG4gICAgICogQHBhcmFtIGJwbW5Nb2RlbFxyXG4gICAgICogQHJldHVybnNcclxuICAgICAqL1xyXG4gICAgY3JlYXRlUHJvY2Vzc0NlbGwoYnBtbk1vZGVsOiBCcG1uTW9kZWwpIHtcclxuICAgICAgICBjb25zdCBwcm9jZXNzQ2VsbCA9IG5ldyBXZlByb2Nlc3NDZWxsKCk7XHJcbiAgICAgICAgcHJvY2Vzc0NlbGwucHJvY2VzcyA9IGJwbW5Nb2RlbC5EZWZhdWx0UHJvY2VzcztcclxuICAgICAgICBwcm9jZXNzQ2VsbC5wbGFuZSA9IGJwbW5Nb2RlbC5EZWZhdWx0RGlhZ3JhbS5CcG1uUGxhbmU7XHJcbiAgICAgICAgcHJvY2Vzc0NlbGwuZWRpdG9yVWkgPSB0aGlzLmVkaXRvclVpO1xyXG4gICAgICAgIHJldHVybiBwcm9jZXNzQ2VsbDtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOe7meWumuaWsOa1geeoi+S/oeaBr+WIm+W7ukJwbW5Nb2RlbFxyXG4gICAgICogQHBhcmFtIG5ld1Byb2NJbmZvXHJcbiAgICAgKiBAcGFyYW0gYml6Q21wc1xyXG4gICAgICovXHJcbiAgICBjcmVhdGVCcG1uTW9kZWxXaXRoUHJvY0luZm8obmV3UHJvY0luZm86IGFueSwgYml6Q21wczogYW55KSB7XHJcbiAgICAgICAgY29uc3QgYnBtbk1vZGVsID0gdGhpcy5jcmVhdGVCcG1uTW9kZWwoKTtcclxuICAgICAgICB0aGlzLmJwbW5Nb2RlbCA9IGJwbW5Nb2RlbDtcclxuICAgICAgICB0aGlzLnByb2Nlc3NDZWxsID0gdGhpcy5jcmVhdGVQcm9jZXNzQ2VsbCh0aGlzLmJwbW5Nb2RlbCk7XHJcbiAgICAgICAgaWYgKHRoaXMuZWRpdG9yVWkubGFuZ0NvZGUgPT09ICd6aC1DSFMnKSB7XHJcbiAgICAgICAgICB0aGlzLmJwbW5Nb2RlbC5EZWZhdWx0UHJvY2Vzcy5OYW1lID0gbmV3UHJvY0luZm8ubmFtZSB8fCBicG1uTW9kZWwuRGVmYXVsdFByb2Nlc3MuTmFtZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5icG1uTW9kZWwuRGVmYXVsdFByb2Nlc3MuTmFtZUxhbmd1YWdlID0ge1xyXG4gICAgICAgICAgW3RoaXMuZWRpdG9yVWkubGFuZ0NvZGVdOiBuZXdQcm9jSW5mby5uYW1lIHx8IGJwbW5Nb2RlbC5EZWZhdWx0UHJvY2Vzcy5OYW1lLFxyXG4gICAgICAgIH1cclxuICAgICAgICAvL+iuvue9rua1geeoi0hlYWRlcijkuJrliqHlr7nosaFJROOAgea1geeoi+WIhuexu0lEKVxyXG4gICAgICAgIHRoaXMucHJvY2Vzc0NlbGwuc2V0UHJvY2Vzc0hlYWRlcihuZXdQcm9jSW5mby5mZklkLCBuZXdQcm9jSW5mby5iaXpPYmpJZCwgbmV3UHJvY0luZm8uZmZOYW1lLCBuZXdQcm9jSW5mby5zdGFydE1vZGUgYXMgU3RhcnRNb2RlKTtcclxuXHJcbiAgICAgICAgLy8g5Z+65LqO5rWB56iL5YiG57G757uR5a6a5Y+C5pWw77yM5rWB56iL5p6E5Lu277yM5rWB56iL6KGo5Y2VXHJcbiAgICAgICAgdGhpcy5wcm9jZXNzQ2VsbC51cGRhdGVGbG93Rm9ybUluZm8obmV3UHJvY0luZm8uZm9ybWFsUGFyYW1ldGVycywgbmV3UHJvY0luZm8ucHJvY2Vzc0JpekNvbXBvbm5ldHMsIG5ld1Byb2NJbmZvLmV4ZWN1dGVGb3JtcywgbmV3UHJvY0luZm8uY3VzdG9taXplQWN0aW9ucywgYml6Q21wcyk7XHJcbiAgICAgICAgdGhpcy5wcm9jZXNzQ2VsbC5tb2RpZnlQcm9jZXNzVGl0bGVFeHByZXNzaW9uKG5ld1Byb2NJbmZvLnByb2Nlc3NEZXNjcmlwdGlvbik7XHJcbiAgICB9XHJcbiAgICBzZXREZWZhdWx0U3R5bGVzKCk6IHZvaWQge1xyXG4gICAgICBzdXBlci5zZXREZWZhdWx0U3R5bGVzKCk7XHJcblxyXG4gICAgICBjb25zdCBzdHlsZVNoZWV0ID0gdGhpcy5nZXRTdHlsZXNoZWV0KCk7XHJcbiAgICAgIC8vIOi/nue6v+agt+W8j+m7mOiupOS4uuato+S6pFxyXG4gICAgICBjb25zdCBlZGdlU3R5bGUgPSBzdHlsZVNoZWV0LmdldERlZmF1bHRFZGdlU3R5bGUoKTtcclxuICAgICAgZWRnZVN0eWxlW214Q29uc3RhbnRzLlNUWUxFX1JPVU5ERURdID0gMTtcclxuICB9XHJcbn1cclxuIl19