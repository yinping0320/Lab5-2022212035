/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { NodeCell, ElementPropertyConfig } from "@edp-pmf/grapheditor";
import { mxResources } from "@edp-pmf/mxgraph-ts";
import { AifCreationBillActivity } from "@gsp-wf/wf-process-model";
import { BpmnModelHelper, FlowNodeState } from "@edp-pmf/bpmn-model";
import { WfConstants } from "../WfConstants";
import { AifCreationBillActivityPropertyKeys } from "./property-keys/AifCreationBillActivityPropertyKeys";
/**
 * 自动生单活动节点
 */
export class AifCreationBillActivityCell extends NodeCell {
    /**
     * @param {?=} value
     * @param {?=} geometry
     * @param {?=} style
     */
    constructor(value, geometry, style) {
        super(value, geometry, style);
        this.clrTypeId = AifCreationBillActivityCell.CLR_TYPE_ID;
        this.name = "自动生单";
        this.nameLanguage = {
            "zh-CHS": "自动生单",
            "zh-CHT": "自動生單",
            "en": "Creation Bill ",
        };
        this.imgUrls = {
            [FlowNodeState.Default]: WfConstants.IMAGE_PATH + "/aifCreationActivity.png",
            [FlowNodeState.Selected]: WfConstants.IMAGE_PATH + "/aifCreationActivity_select.svg",
        };
    }
    /**
     * @param {?=} flowElt
     * @return {?}
     */
    createFlowElement(flowElt) {
        /** @type {?} */
        const flowNode = (/** @type {?} */ (super.createFlowElement(flowElt)));
        flowNode.Id = "AifCreationBillActivity" + BpmnModelHelper.GenerateElementId();
        return flowNode;
    }
    /**
     * @return {?}
     */
    getFarrisPropConfig() {
        /** @type {?} */
        let act = this.flowElement;
        /** @type {?} */
        let PropertyConfig = new ElementPropertyConfig();
        /** @type {?} */
        let propertyData = new Object();
        PropertyConfig.categoryId = 'general';
        PropertyConfig.categoryName = mxResources.get('basicInformation');
        PropertyConfig.tabId = 'basic';
        PropertyConfig.tabName = mxResources.get('basicAttributes');
        PropertyConfig.properties = [
            { propertyID: AifCreationBillActivityPropertyKeys.Name, propertyName: mxResources.get('name'), propertyType: 'string', visible: !this.editorUi.multiLangEnabled },
            { propertyID: AifCreationBillActivityPropertyKeys.NameLanguage, propertyName: mxResources.get('nameLanguage'), propertyType: 'multiLanguage', visible: this.editorUi.multiLangEnabled },
            { propertyID: AifCreationBillActivityPropertyKeys.Id, propertyName: mxResources.get('id'), propertyType: 'string', readonly: true }
        ];
        /** @type {?} */
        let bifDef = new ElementPropertyConfig();
        bifDef.categoryId = 'bifDef';
        bifDef.categoryName = mxResources.get('bifDef');
        bifDef.tabId = 'basic';
        bifDef.tabName = mxResources.get('basicAttributes');
        bifDef.properties = [
            { propertyID: AifCreationBillActivityPropertyKeys.aifProcessCode, propertyName: mxResources.get('aifProcess'), propertyType: 'modal' },
        ];
        propertyData[AifCreationBillActivityPropertyKeys.Id] = act.Id;
        propertyData[AifCreationBillActivityPropertyKeys.ClrTypeID] = act.ClrTypeID;
        propertyData[AifCreationBillActivityPropertyKeys.Name] = act.Name || mxResources.get('autoAif');
        propertyData[AifCreationBillActivityPropertyKeys.NameLanguage] = act.NameLanguage || {
            "zh-CHS": act.Name,
        };
        propertyData[AifCreationBillActivityPropertyKeys.aifProcessCode] = act.aifProcessCode;
        propertyData[AifCreationBillActivityPropertyKeys.isRelied] = act.isRelied;
        return {
            propertyConfig: [PropertyConfig, bifDef],
            propertyData: propertyData
        };
    }
    /**
     * @param {?} obj
     * @return {?}
     */
    updateProps(obj) {
        /** @type {?} */
        const propertyId = obj.propertyID;
        switch (propertyId) {
            case AifCreationBillActivityPropertyKeys.aifProcessCode:
                this.resetProcessCode(this.flowElement, obj);
                break;
            default:
                super.updateProps(obj);
                break;
        }
    }
    /**
     * @param {?} startActivity
     * @param {?} obj
     * @return {?}
     */
    resetProcessCode(startActivity, obj) {
        /** @type {?} */
        const data = obj.propertyValue;
        if (data) {
            startActivity.aifProcessCode = data;
        }
        else {
            startActivity.aifProcessCode = null;
        }
    }
}
AifCreationBillActivityCell.CLR_TYPE_ID = AifCreationBillActivity.Clr_Type_ID;
if (false) {
    /** @type {?} */
    AifCreationBillActivityCell.CLR_TYPE_ID;
    /** @type {?} */
    AifCreationBillActivityCell.prototype.clrTypeId;
    /** @type {?} */
    AifCreationBillActivityCell.prototype.name;
    /** @type {?} */
    AifCreationBillActivityCell.prototype.nameLanguage;
    /** @type {?} */
    AifCreationBillActivityCell.prototype.flowElement;
    /** @type {?} */
    AifCreationBillActivityCell.prototype.imgUrls;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQWlmQ3JlYXRpb25CaWxsQWN0aXZpdHlDZWxsLmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGdzcC13Zi93Zi1wcm9jZXNzLWVkaXRvci8iLCJzb3VyY2VzIjpbImxpYi9kZXNpZ25lci93Zi1jZWxsL0FpZkNyZWF0aW9uQmlsbEFjdGl2aXR5Q2VsbC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUFFLFFBQVEsRUFBRSxxQkFBcUIsRUFBNEIsTUFBTSxzQkFBc0IsQ0FBQztBQUNqRyxPQUFPLEVBQWEsV0FBVyxFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFDN0QsT0FBTyxFQUFFLHVCQUF1QixFQUFFLE1BQU0sMEJBQTBCLENBQUM7QUFDbkUsT0FBTyxFQUFFLGVBQWUsRUFBRSxhQUFhLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUNyRSxPQUFPLEVBQUUsV0FBVyxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFDN0MsT0FBTyxFQUFFLG1DQUFtQyxFQUFFLE1BQU0scURBQXFELENBQUM7Ozs7QUFLMUcsTUFBTSxPQUFPLDJCQUE0QixTQUFRLFFBQVE7Ozs7OztJQWdCckQsWUFBWSxLQUFXLEVBQUUsUUFBK0IsRUFBRSxLQUFjO1FBQ3BFLEtBQUssQ0FBQyxLQUFLLEVBQUUsUUFBUSxFQUFFLEtBQUssQ0FBQyxDQUFDO1FBaEJsQyxjQUFTLEdBQVcsMkJBQTJCLENBQUMsV0FBVyxDQUFDO1FBQzVELFNBQUksR0FBVyxNQUFNLENBQUM7UUFDdEIsaUJBQVksR0FBZ0M7WUFDMUMsUUFBUSxFQUFFLE1BQU07WUFDaEIsUUFBUSxFQUFFLE1BQU07WUFDaEIsSUFBSSxFQUFFLGdCQUFnQjtTQUN6QixDQUFDO1FBSUEsWUFBTyxHQUFHO1lBQ04sQ0FBQyxhQUFhLENBQUMsT0FBTyxDQUFDLEVBQUUsV0FBVyxDQUFDLFVBQVUsR0FBRywwQkFBMEI7WUFDNUUsQ0FBQyxhQUFhLENBQUMsUUFBUSxDQUFDLEVBQUUsV0FBVyxDQUFDLFVBQVUsR0FBRyxp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R0FBRyxDQUFDLFFBQVEsQ0FBQTtRQUV6RSxPQUFPO1lBQ0gsY0FBYyxFQUFFLENBQUMsY0FBYyxFQUFFLE1BQU0sQ0FBQztZQUN4QyxZQUFZLEVBQUUsWUFBWTtTQUM3QixDQUFBO0lBQ0wsQ0FBQzs7Ozs7SUFFRCxXQUFXLENBQUMsR0FBUTs7Y0FDVixVQUFVLEdBQVcsR0FBRyxDQUFDLFVBQVU7UUFDekMsUUFBUSxVQUFVLEVBQUU7WUFDaEIsS0FBSyxtQ0FBbUMsQ0FBQyxjQUFjO2dCQUNuRCxJQUFJLENBQUMsZ0JBQWdCLENBQUMsSUFBSSxDQUFDLFdBQVcsRUFBRSxHQUFHLENBQUMsQ0FBQztnQkFDN0MsTUFBTTtZQUNWO2dCQUNJLEtBQUssQ0FBQyxXQUFXLENBQUMsR0FBRyxDQUFDLENBQUM7Z0JBQ3ZCLE1BQU07U0FDYjtJQUNMLENBQUM7Ozs7OztJQUVELGdCQUFnQixDQUFDLGFBQXNDLEVBQUUsR0FBUTs7Y0FDdkQsSUFBSSxHQUFHLEdBQUcsQ0FBQyxhQUFhO1FBQzlCLElBQUksSUFBSSxFQUFFO1lBQ04sYUFBYSxDQUFDLGNBQWMsR0FBRyxJQUFJLENBQUM7U0FDdkM7YUFBTTtZQUNILGFBQWEsQ0FBQyxjQUFjLEdBQUcsSUFBSSxDQUFDO1NBQ3ZDO0lBQ0wsQ0FBQzs7QUE5RU0sdUNBQVcsR0FBVyx1QkFBdUIsQ0FBQyxXQUFXLENBQUM7OztJQUFqRSx3Q0FBaUU7O0lBUGpFLGdEQUE0RDs7SUFDNUQsMkNBQXNCOztJQUN0QixtREFJQTs7SUFFQSxrREFBcUM7O0lBRXJDLDhDQUdFIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTm9kZUNlbGwsIEVsZW1lbnRQcm9wZXJ0eUNvbmZpZywgRmFycmlzUHJvcENvbmZpZ1dpdGhEYXRhIH0gZnJvbSBcIkBlZHAtcG1mL2dyYXBoZWRpdG9yXCI7XHJcbmltcG9ydCB7IE14R3JhcGhOUywgbXhSZXNvdXJjZXMgfSBmcm9tIFwiQGVkcC1wbWYvbXhncmFwaC10c1wiO1xyXG5pbXBvcnQgeyBBaWZDcmVhdGlvbkJpbGxBY3Rpdml0eSB9IGZyb20gXCJAZ3NwLXdmL3dmLXByb2Nlc3MtbW9kZWxcIjtcclxuaW1wb3J0IHsgQnBtbk1vZGVsSGVscGVyLCBGbG93Tm9kZVN0YXRlIH0gZnJvbSBcIkBlZHAtcG1mL2JwbW4tbW9kZWxcIjtcclxuaW1wb3J0IHsgV2ZDb25zdGFudHMgfSBmcm9tIFwiLi4vV2ZDb25zdGFudHNcIjtcclxuaW1wb3J0IHsgQWlmQ3JlYXRpb25CaWxsQWN0aXZpdHlQcm9wZXJ0eUtleXMgfSBmcm9tIFwiLi9wcm9wZXJ0eS1rZXlzL0FpZkNyZWF0aW9uQmlsbEFjdGl2aXR5UHJvcGVydHlLZXlzXCI7XHJcblxyXG4vKipcclxuICog6Ieq5Yqo55Sf5Y2V5rS75Yqo6IqC54K5XHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgQWlmQ3JlYXRpb25CaWxsQWN0aXZpdHlDZWxsIGV4dGVuZHMgTm9kZUNlbGwge1xyXG4gICAgY2xyVHlwZUlkOiBzdHJpbmcgPSBBaWZDcmVhdGlvbkJpbGxBY3Rpdml0eUNlbGwuQ0xSX1RZUEVfSUQ7XHJcbiAgICBuYW1lOiBzdHJpbmcgPSBcIuiHquWKqOeUn+WNlVwiO1xyXG4gICAgbmFtZUxhbmd1YWdlOiB7IFtsYW5nOiBzdHJpbmddOiBzdHJpbmc7IH0gPSB7XHJcbiAgICAgIFwiemgtQ0hTXCI6IFwi6Ieq5Yqo55Sf5Y2VXCIsXHJcbiAgICAgIFwiemgtQ0hUXCI6IFwi6Ieq5YuV55Sf5ZauXCIsXHJcbiAgICAgIFwiZW5cIjogXCJDcmVhdGlvbiBCaWxsIFwiLFxyXG4gIH07XHJcbiAgICBzdGF0aWMgQ0xSX1RZUEVfSUQ6IHN0cmluZyA9IEFpZkNyZWF0aW9uQmlsbEFjdGl2aXR5LkNscl9UeXBlX0lEO1xyXG4gICAgZmxvd0VsZW1lbnQ6IEFpZkNyZWF0aW9uQmlsbEFjdGl2aXR5O1xyXG5cclxuICAgIGltZ1VybHMgPSB7XHJcbiAgICAgICAgW0Zsb3dOb2RlU3RhdGUuRGVmYXVsdF06IFdmQ29uc3RhbnRzLklNQUdFX1BBVEggKyBcIi9haWZDcmVhdGlvbkFjdGl2aXR5LnBuZ1wiLFxyXG4gICAgICAgIFtGbG93Tm9kZVN0YXRlLlNlbGVjdGVkXTogV2ZDb25zdGFudHMuSU1BR0VfUEFUSCArIFwiL2FpZkNyZWF0aW9uQWN0aXZpdHlfc2VsZWN0LnN2Z1wiLFxyXG4gICAgfTtcclxuXHJcbiAgICBjb25zdHJ1Y3Rvcih2YWx1ZT86IGFueSwgZ2VvbWV0cnk/OiBNeEdyYXBoTlMubXhHZW9tZXRyeSwgc3R5bGU/OiBzdHJpbmcpIHtcclxuICAgICAgICBzdXBlcih2YWx1ZSwgZ2VvbWV0cnksIHN0eWxlKTtcclxuICAgIH1cclxuXHJcbiAgICBjcmVhdGVGbG93RWxlbWVudChmbG93RWx0PzogQWlmQ3JlYXRpb25CaWxsQWN0aXZpdHkpOiBBaWZDcmVhdGlvbkJpbGxBY3Rpdml0eSB7XHJcbiAgICAgICAgY29uc3QgZmxvd05vZGUgPSBzdXBlci5jcmVhdGVGbG93RWxlbWVudChmbG93RWx0KSBhcyBBaWZDcmVhdGlvbkJpbGxBY3Rpdml0eTtcclxuICAgICAgICBmbG93Tm9kZS5JZCA9IFwiQWlmQ3JlYXRpb25CaWxsQWN0aXZpdHlcIiArIEJwbW5Nb2RlbEhlbHBlci5HZW5lcmF0ZUVsZW1lbnRJZCgpO1xyXG4gICAgICAgIHJldHVybiBmbG93Tm9kZTtcclxuICAgIH1cclxuXHJcbiAgICBnZXRGYXJyaXNQcm9wQ29uZmlnKCk6IEZhcnJpc1Byb3BDb25maWdXaXRoRGF0YSB7XHJcbiAgICAgICAgbGV0IGFjdCA9IHRoaXMuZmxvd0VsZW1lbnQ7XHJcblxyXG4gICAgICAgIGxldCBQcm9wZXJ0eUNvbmZpZzogRWxlbWVudFByb3BlcnR5Q29uZmlnID0gbmV3IEVsZW1lbnRQcm9wZXJ0eUNvbmZpZygpO1xyXG4gICAgICAgIGxldCBwcm9wZXJ0eURhdGE6IGFueSA9IG5ldyBPYmplY3QoKTtcclxuICAgICAgICBQcm9wZXJ0eUNvbmZpZy5jYXRlZ29yeUlkID0gJ2dlbmVyYWwnO1xyXG4gICAgICAgIFByb3BlcnR5Q29uZmlnLmNhdGVnb3J5TmFtZSA9IG14UmVzb3VyY2VzLmdldCgnYmFzaWNJbmZvcm1hdGlvbicpO1xyXG4gICAgICAgIFByb3BlcnR5Q29uZmlnLnRhYklkID0gJ2Jhc2ljJztcclxuICAgICAgICBQcm9wZXJ0eUNvbmZpZy50YWJOYW1lID0gbXhSZXNvdXJjZXMuZ2V0KCdiYXNpY0F0dHJpYnV0ZXMnKTtcclxuICAgICAgICBQcm9wZXJ0eUNvbmZpZy5wcm9wZXJ0aWVzID0gW1xyXG4gICAgICAgICAgICB7IHByb3BlcnR5SUQ6IEFpZkNyZWF0aW9uQmlsbEFjdGl2aXR5UHJvcGVydHlLZXlzLk5hbWUsIHByb3BlcnR5TmFtZTogbXhSZXNvdXJjZXMuZ2V0KCduYW1lJyksIHByb3BlcnR5VHlwZTogJ3N0cmluZycsIHZpc2libGU6ICF0aGlzLmVkaXRvclVpLm11bHRpTGFuZ0VuYWJsZWQgfSxcclxuICAgICAgICAgICAgeyBwcm9wZXJ0eUlEOiBBaWZDcmVhdGlvbkJpbGxBY3Rpdml0eVByb3BlcnR5S2V5cy5OYW1lTGFuZ3VhZ2UsIHByb3BlcnR5TmFtZTogbXhSZXNvdXJjZXMuZ2V0KCduYW1lTGFuZ3VhZ2UnKSwgcHJvcGVydHlUeXBlOiAnbXVsdGlMYW5ndWFnZScsIHZpc2libGU6IHRoaXMuZWRpdG9yVWkubXVsdGlMYW5nRW5hYmxlZCB9LFxyXG4gICAgICAgICAgICB7IHByb3BlcnR5SUQ6IEFpZkNyZWF0aW9uQmlsbEFjdGl2aXR5UHJvcGVydHlLZXlzLklkLCBwcm9wZXJ0eU5hbWU6IG14UmVzb3VyY2VzLmdldCgnaWQnKSwgcHJvcGVydHlUeXBlOiAnc3RyaW5nJywgcmVhZG9ubHk6IHRydWUgfVxyXG4gICAgICAgIF07XHJcblxyXG4gICAgICAgIGxldCBiaWZEZWYgPSBuZXcgRWxlbWVudFByb3BlcnR5Q29uZmlnKCk7XHJcbiAgICAgICAgYmlmRGVmLmNhdGVnb3J5SWQgPSAnYmlmRGVmJztcclxuICAgICAgICBiaWZEZWYuY2F0ZWdvcnlOYW1lID0gbXhSZXNvdXJjZXMuZ2V0KCdiaWZEZWYnKTtcclxuICAgICAgICBiaWZEZWYudGFiSWQgPSAnYmFzaWMnO1xyXG4gICAgICAgIGJpZkRlZi50YWJOYW1lID0gbXhSZXNvdXJjZXMuZ2V0KCdiYXNpY0F0dHJpYnV0ZXMnKVxyXG4gICAgICAgIGJpZkRlZi5wcm9wZXJ0aWVzID0gW1xyXG4gICAgICAgICAgICB7IHByb3BlcnR5SUQ6IEFpZkNyZWF0aW9uQmlsbEFjdGl2aXR5UHJvcGVydHlLZXlzLmFpZlByb2Nlc3NDb2RlLCBwcm9wZXJ0eU5hbWU6IG14UmVzb3VyY2VzLmdldCgnYWlmUHJvY2VzcycpLCBwcm9wZXJ0eVR5cGU6ICdtb2RhbCcgfSxcclxuICAgICAgICAgICAgLy8geyBwcm9wZXJ0eUlEOiBBaWZDcmVhdGlvbkJpbGxBY3Rpdml0eVJlc291cmNlS2V5cy5pc1JlbGllZCwgcHJvcGVydHlOYW1lOiAn5ZCO57ut5L6d6LWWJywgcHJvcGVydHlUeXBlOiAnYm9vbGVhbicgfSxcclxuICAgICAgICBdO1xyXG5cclxuICAgICAgICBwcm9wZXJ0eURhdGFbQWlmQ3JlYXRpb25CaWxsQWN0aXZpdHlQcm9wZXJ0eUtleXMuSWRdID0gYWN0LklkO1xyXG4gICAgICAgIHByb3BlcnR5RGF0YVtBaWZDcmVhdGlvbkJpbGxBY3Rpdml0eVByb3BlcnR5S2V5cy5DbHJUeXBlSURdID0gYWN0LkNsclR5cGVJRDtcclxuXHJcbiAgICAgICAgcHJvcGVydHlEYXRhW0FpZkNyZWF0aW9uQmlsbEFjdGl2aXR5UHJvcGVydHlLZXlzLk5hbWVdID0gYWN0Lk5hbWUgfHwgbXhSZXNvdXJjZXMuZ2V0KCdhdXRvQWlmJyk7XHJcbiAgICAgICAgcHJvcGVydHlEYXRhW0FpZkNyZWF0aW9uQmlsbEFjdGl2aXR5UHJvcGVydHlLZXlzLk5hbWVMYW5ndWFnZV0gPSBhY3QuTmFtZUxhbmd1YWdlIHx8IHtcclxuICAgICAgICAgICAgXCJ6aC1DSFNcIjogYWN0Lk5hbWUsXHJcbiAgICAgICAgfTtcclxuICAgICAgICBwcm9wZXJ0eURhdGFbQWlmQ3JlYXRpb25CaWxsQWN0aXZpdHlQcm9wZXJ0eUtleXMuYWlmUHJvY2Vzc0NvZGVdID0gYWN0LmFpZlByb2Nlc3NDb2RlXHJcbiAgICAgICAgcHJvcGVydHlEYXRhW0FpZkNyZWF0aW9uQmlsbEFjdGl2aXR5UHJvcGVydHlLZXlzLmlzUmVsaWVkXSA9IGFjdC5pc1JlbGllZFxyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBwcm9wZXJ0eUNvbmZpZzogW1Byb3BlcnR5Q29uZmlnLCBiaWZEZWZdLFxyXG4gICAgICAgICAgICBwcm9wZXJ0eURhdGE6IHByb3BlcnR5RGF0YVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICB1cGRhdGVQcm9wcyhvYmo6IGFueSkge1xyXG4gICAgICAgIGNvbnN0IHByb3BlcnR5SWQ6IHN0cmluZyA9IG9iai5wcm9wZXJ0eUlEO1xyXG4gICAgICAgIHN3aXRjaCAocHJvcGVydHlJZCkge1xyXG4gICAgICAgICAgICBjYXNlIEFpZkNyZWF0aW9uQmlsbEFjdGl2aXR5UHJvcGVydHlLZXlzLmFpZlByb2Nlc3NDb2RlOlxyXG4gICAgICAgICAgICAgICAgdGhpcy5yZXNldFByb2Nlc3NDb2RlKHRoaXMuZmxvd0VsZW1lbnQsIG9iaik7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgIHN1cGVyLnVwZGF0ZVByb3BzKG9iaik7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmVzZXRQcm9jZXNzQ29kZShzdGFydEFjdGl2aXR5OiBBaWZDcmVhdGlvbkJpbGxBY3Rpdml0eSwgb2JqOiBhbnkpIHtcclxuICAgICAgICBjb25zdCBkYXRhID0gb2JqLnByb3BlcnR5VmFsdWU7XHJcbiAgICAgICAgaWYgKGRhdGEpIHtcclxuICAgICAgICAgICAgc3RhcnRBY3Rpdml0eS5haWZQcm9jZXNzQ29kZSA9IGRhdGE7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgc3RhcnRBY3Rpdml0eS5haWZQcm9jZXNzQ29kZSA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbiJdfQ==