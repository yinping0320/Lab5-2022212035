/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { EditorUi, ActionKeys, ToolboxGroup, ToolboxItem } from "@edp-pmf/grapheditor";
import { WfGraph } from "./WfGraph";
import { ProcessHeader, UserActivity, OperationActivity } from "@gsp-wf/wf-process-model";
import { WfSidebar } from "./WfSidebar";
import { WfConstants } from "./WfConstants";
import { mxEvent, mxResources } from "@edp-pmf/mxgraph-ts";
import { UserActivityPropertyKeys } from "./wf-cell/property-keys/UserActivityPropertyKeys";
import { WfExclusiveGatewayCell } from "./wf-cell/WfExclusiveGatewayCell";
import { AifCreationBillActivityCell } from "./wf-cell/AifCreationBillActivityCell";
import { AutoActivityCell } from "./wf-cell/AutoActivityCell";
import { CallActivitySubProcessCell } from "./wf-cell/CallActivitySubProcessCell";
import { IntermediateCatchEventImplCell } from "./wf-cell/IntermediateCatchEventImplCell";
import { MessageActivityCell } from "./wf-cell/MessageActivityCell";
import { NotifyActivityCell } from "./wf-cell/NotifyActivityCell";
import { OperationActivityCell } from "./wf-cell/OperationActivityCell";
import { StartActivityCell } from "./wf-cell/StartActivityCell";
import { UserActivityCell } from "./wf-cell/UserActivityCell";
import { WfParallelGatewayCell } from "./wf-cell/WfParallelGatewayCell";
import { WfEndEventCell } from "./wf-cell/WfEndEventCell";
import { WfInclusiveGatewayCell } from "./wf-cell/WfInclusiveGatewayCell";
import { BatchSetPropertiesComponent } from "../views/batch-set-properties/batch-set-properties.component";
export class WfEditorUi extends EditorUi {
    /**
     * @param {?} time
     * @param {?} action
     * @param {?=} container
     * @param {?=} injector
     * @param {?=} modalService
     * @param {?=} resolver
     * @param {?=} eventSource
     * @param {?=} importLinks
     */
    constructor(time, action, container, injector, modalService, resolver, eventSource, importLinks = true) {
        super(container, eventSource, importLinks);
        this.injector = injector;
        this.modalService = modalService;
        this.resolver = resolver;
        this.generalConfig = {
            enableTransfer: true,
            enableNotify: false,
            enableAddSignBehind: false,
            enableAddSignFront: false,
        };
        /** @type {?} */
        let rootPath = '';
        try {
            rootPath = ((/** @type {?} */ (window))).gspframeworkService.common.getBasePath.get();
        }
        catch (error) {
        }
        mxResources.add(rootPath + "/platform/runtime/common/web/@gsp-wf/wf-process-editor/resources/wf-process-editor");
        this.showToolbar = false;
        this.time = time;
        this.action = action;
    }
    /**
     * @return {?}
     */
    createActions() {
        /** @type {?} */
        const actions = super.createActions();
        // 只有设计时编辑状态下才启用删除动作
        if (!(this.action === 'edit' && this.time !== 'rt')) {
            /** @type {?} */
            const deleteAction = actions.getAction(ActionKeys.pmf_delete);
            deleteAction.isEnabled = (/**
             * @return {?}
             */
            () => false);
        }
        return actions;
    }
    /**
     * @return {?}
     */
    createToolbox() {
        /** @type {?} */
        const toolbox = super.createToolbox();
        /** @type {?} */
        const g1 = new ToolboxGroup();
        g1.name = mxResources.get('basicElements');
        g1.items.push(new ToolboxItem(StartActivityCell.CLR_TYPE_ID), new ToolboxItem(WfExclusiveGatewayCell.CLR_TYPE_ID), new ToolboxItem(WfParallelGatewayCell.CLR_TYPE_ID), 
        // 暂时隐藏包容网关
        new ToolboxItem(WfInclusiveGatewayCell.CLR_TYPE_ID), new ToolboxItem(UserActivityCell.CLR_TYPE_ID), new ToolboxItem(OperationActivityCell.CLR_TYPE_ID), new ToolboxItem(NotifyActivityCell.CLR_TYPE_ID), new ToolboxItem(CallActivitySubProcessCell.CLR_TYPE_ID), new ToolboxItem(AutoActivityCell.CLR_TYPE_ID), new ToolboxItem(IntermediateCatchEventImplCell.CLR_TYPE_ID), new ToolboxItem(MessageActivityCell.CLR_TYPE_ID), new ToolboxItem(AifCreationBillActivityCell.CLR_TYPE_ID), new ToolboxItem(WfEndEventCell.CLR_TYPE_ID));
        toolbox.groups = [g1];
        return toolbox;
    }
    /**
     * @return {?}
     */
    createGraphInstance() {
        /** @type {?} */
        const graph = new WfGraph(this, this.diagramContainer);
        if (this.action === 'view' || this.time === 'rt' || this.action === 'assignView') {
            graph.setCellsLocked(true);
        }
        else {
            graph.setDropEnabled(true);
            graph.setConnectable(true);
        }
        //TODO：右键查看只显示在审批节点上
        graph.popupMenuHandler.autoExpand = true;
        graph.popupMenuHandler.factoryMethod = (/**
         * @param {?} menu
         * @param {?} cell
         * @param {?} evt
         * @return {?}
         */
        (menu, cell, evt) => {
            /** @type {?} */
            const actList = graph.getChildCells(graph.getDefaultParent());
            if (cell != null
                && cell.clrTypeId.indexOf('wf.UserActivity') > -1
                && actList.findIndex((/**
                 * @param {?} a
                 * @return {?}
                 */
                a => a.id === cell.getId())) > -1) {
                menu.addItem('批量复制属性', null, (/**
                 * @return {?}
                 */
                () => {
                    /** @type {?} */
                    const compFactory = this.resolver.resolveComponentFactory(BatchSetPropertiesComponent);
                    /** @type {?} */
                    const compRef = compFactory.create(this.injector);
                    compRef.instance.activityModel = cell.flowElement;
                    /** @type {?} */
                    const modalConfig = {
                        title: '批量复制属性',
                        width: 512,
                        height: 465,
                        showButtons: true,
                        buttons: compRef.instance.footer
                    };
                    /** @type {?} */
                    const dialog = this.modalService.show(compRef, modalConfig);
                    compRef.instance.cancel.subscribe((/**
                     * @param {?} $event
                     * @return {?}
                     */
                    $event => dialog.close()));
                    compRef.instance.submit.subscribe((/**
                     * @param {?} data
                     * @return {?}
                     */
                    (data) => {
                        dialog.close();
                    }));
                }));
            }
        });
        return graph;
    }
    /**
     * @return {?}
     */
    createSidebar() {
        return new WfSidebar(this, this.sidebarContainer);
    }
    /**
     * @return {?}
     */
    show() {
        super.show();
        if (this.action === 'view' || this.action === 'assignView') {
            /** @type {?} */
            const span = this.createSpan('');
            span.style.fontSize = '14px';
            span.style.color = 'white';
            span.style.borderRadius = '20px';
            span.style.padding = '4px 20px';
            span.style.background = 'rgb(199, 194, 187)';
            /** @type {?} */
            const v = document.createTextNode(mxResources.get('readOnly'));
            span.appendChild(v);
            /** @type {?} */
            const d = this.createDiv('');
            d.style.position = 'absolute';
            d.style.top = '10px';
            d.style.right = '10px';
            d.style.zIndex = "2";
            d.appendChild(span);
            this.container.appendChild(d);
        }
        /** @type {?} */
        const buttonIn = document.createElement('a');
        buttonIn.setAttribute('href', 'javascript:void(0);');
        /** @type {?} */
        let buttonInImg = document.createElement('img');
        buttonIn.style.marginRight = '10px';
        buttonInImg.src = WfConstants.IMAGE_PATH + '/zoomIn.svg';
        buttonInImg.style.display = "inline-block";
        buttonInImg.style.verticalAlign = "middle";
        buttonIn.appendChild(buttonInImg);
        mxEvent.addListener(buttonIn, 'click', (/**
         * @param {?} evt
         * @return {?}
         */
        (evt) => {
            this.actions.getAction(ActionKeys.pmf_zoomIn).execute(evt);
        }));
        /** @type {?} */
        const buttonOut = document.createElement('a');
        buttonOut.setAttribute('href', 'javascript:void(0);');
        /** @type {?} */
        let buttonOutImg = document.createElement('img');
        buttonOutImg.src = WfConstants.IMAGE_PATH + '/zoomOut.svg';
        buttonOutImg.style.display = "inline-block";
        buttonOutImg.style.verticalAlign = "middle";
        buttonOut.appendChild(buttonOutImg);
        mxEvent.addListener(buttonOut, 'click', (/**
         * @param {?} evt
         * @return {?}
         */
        (evt) => {
            this.actions.getAction(ActionKeys.pmf_zoomOut).execute(evt);
        }));
        /** @type {?} */
        const zoomBar = this.createDiv('zoomBar');
        zoomBar.style.position = 'absolute';
        zoomBar.style.zIndex = "2";
        /** @type {?} */
        let t = 10;
        if (this.showMenubar) {
            t += this.menubarHeight;
        }
        if (this.showToolbar) {
            t += this.toolbarHeight;
        }
        zoomBar.style.top = t + 'px';
        zoomBar.style.left = (this.showSidebar ? this.sidebarSplitPosition + this.sidebarSplitSize : 0) + 10 + "px";
        zoomBar.appendChild(buttonIn);
        zoomBar.appendChild(buttonOut);
        this.container.appendChild(zoomBar);
        this.zoomBar = zoomBar;
    }
    /**
     * @param {?} value
     * @return {?}
     */
    sidebarSplitOnChange(value) {
        super.sidebarSplitOnChange(value);
        // 分割条移动后更新缩放条位置
        if (this.zoomBar) {
            this.zoomBar.style.left = (this.showSidebar ? this.sidebarSplitPosition + this.sidebarSplitSize : 0) + 10 + "px";
        }
    }
    /**
     * 创建带指定样式类的span
     * @param {?} classname
     * @return {?}
     */
    createSpan(classname) {
        /** @type {?} */
        let elt = document.createElement('span');
        elt.className = classname;
        return elt;
    }
    /**
     * 加载业务活动
     * @param {?} bizActivities
     * @return {?}
     */
    loadBizActivities(bizActivities) {
        this.sidebar && this.sidebar.addBizActPalette(bizActivities);
    }
    /**
     * 批量复制属性
     * @param {?} obj
     * @return {?}
     */
    batchCopyProperty(obj) {
        // 放弃不需要的参数
        /** @type {?} */
        const ids = obj.value.targetNodeID;
        obj.propertyValue = obj.value.messageNotice;
        // todo：多个活动具有同名属性时，如何更合理定义PropertyKey？
        obj.propertyID = UserActivityPropertyKeys.messageNotice;
        for (const id of ids) {
            /** @type {?} */
            const cell = this.graph.getCellByFlowElementId(id);
            if (cell) {
                cell.updateProps(obj);
                this.graph.refresh();
            }
        }
    }
    /**
     * 批量设置属性
     * @param {?} obj
     * @return {?}
     */
    batchSetProperty(obj) {
        for (const v of obj) {
            switch (v.type) {
                case 'addSignfront':
                    /** @type {?} */
                    const afId = v.actis;
                    obj.propertyValue = v.config;
                    obj.propertyID = UserActivityPropertyKeys.AddSignFrontAble;
                    for (const id of afId) {
                        /** @type {?} */
                        const cell = this.graph.getCellByFlowElementId(id.Id);
                        if (cell) {
                            cell.updateProps(obj);
                            this.graph.refresh();
                        }
                    }
                    break;
                case 'addSignBehind':
                    /** @type {?} */
                    const abId = v.actis;
                    obj.propertyValue = v.config;
                    obj.propertyID = UserActivityPropertyKeys.AddSignBehindAble;
                    for (const id of abId) {
                        /** @type {?} */
                        const cell = this.graph.getCellByFlowElementId(id.Id);
                        if (cell) {
                            cell.updateProps(obj);
                            this.graph.refresh();
                        }
                    }
                    break;
                case 'transfer':
                    /** @type {?} */
                    const trId = v.actis;
                    obj.propertyValue = v.config;
                    obj.propertyID = UserActivityPropertyKeys.transferScope;
                    for (const id of trId) {
                        /** @type {?} */
                        const cell = this.graph.getCellByFlowElementId(id.Id);
                        if (cell) {
                            cell.updateProps(obj);
                            this.graph.refresh();
                        }
                    }
                    break;
                case 'notify':
                    /** @type {?} */
                    const ntId = v.actis;
                    obj.propertyValue = v.config;
                    obj.propertyID = UserActivityPropertyKeys.NotifyAble;
                    for (const id of ntId) {
                        /** @type {?} */
                        const cell = this.graph.getCellByFlowElementId(id.Id);
                        if (cell) {
                            cell.updateProps(obj);
                            this.graph.refresh();
                        }
                    }
                    break;
                // 驳回规则需要特殊处理：子流程和信号的赋简版
                case 'backWardRule':
                    /** @type {?} */
                    const bwId = v.actis;
                    obj.propertyValue = v.config;
                    obj.propertyID = UserActivityPropertyKeys.BackWardRule;
                    for (const id of bwId) {
                        /** @type {?} */
                        const cell = this.graph.getCellByFlowElementId(id.Id);
                        if (cell) {
                            cell.updateProps(obj);
                            this.graph.refresh();
                        }
                    }
                    break;
            }
        }
    }
    /**
     * 创建新流程
     * @param {?} newProcInfo
     * @param {?=} bizCmps
     * @return {?}
     */
    createBpmnModel(newProcInfo, bizCmps) {
        this.graph.createBpmnModelWithProcInfo(newProcInfo, bizCmps);
    }
    /**
     * 打开流程
     * @param {?} content
     * @return {?}
     */
    openBpmnModel(content) {
        this.graph.loadBpmnModel(content);
    }
    /**
     * 获取属性配置，刷新属性框
     * @param {?} obj
     * @return {?}
     */
    refreshProperty(obj) {
        /** @type {?} */
        const cell = this.graph.getCellByFlowElementId(obj.Id);
        return this.getFarrisPropConfig([cell]);
    }
    /**
     * 获取用户活动
     * @return {?}
     */
    getActivities() {
        /** @type {?} */
        const list = [];
        /** @type {?} */
        const bpmnModel = this.graph.bpmnModel;
        /** @type {?} */
        const flowDict = bpmnModel.DefaultProcess.GetFlowElements();
        Object.keys(flowDict).forEach((/**
         * @param {?} key
         * @return {?}
         */
        (key) => {
            /** @type {?} */
            const flowElt = flowDict[key];
            if (flowElt.ClrTypeID === UserActivity.Clr_Type_ID
                || flowElt.ClrTypeID === OperationActivity.Clr_Type_ID) {
                list.push(flowElt);
            }
        }));
        return list;
    }
    /**
     * 获取结束事件
     * @return {?}
     */
    getEndEvents() {
        /** @type {?} */
        const userActArray = [];
        /** @type {?} */
        const bpmnModel = this.graph.bpmnModel;
        /** @type {?} */
        const flowDict = bpmnModel.DefaultProcess.GetFlowElements();
        Object.keys(flowDict).forEach((/**
         * @param {?} key
         * @return {?}
         */
        (key) => {
            /** @type {?} */
            const flowElt = flowDict[key];
            if (flowElt.ClrTypeID === 'bpmn.EndEvent' || flowElt.ClrTypeID === UserActivity.Clr_Type_ID
                || flowElt.ClrTypeID === OperationActivity.Clr_Type_ID) {
                userActArray.push(flowElt);
            }
        }));
        return userActArray;
    }
    /**
     * 获取知会事件
     * @return {?}
     */
    getNotifyEvents() {
        /** @type {?} */
        const list = [];
        /** @type {?} */
        const bpmnModel = this.graph.bpmnModel;
        /** @type {?} */
        const flowDict = bpmnModel.DefaultProcess.GetFlowElements();
        Object.keys(flowDict).forEach((/**
         * @param {?} key
         * @return {?}
         */
        (key) => {
            /** @type {?} */
            const flowElt = flowDict[key];
            if (flowElt.ClrTypeID === 'wf.NotifyActivity') {
                list.push(flowElt);
            }
        }));
        return list;
    }
    /**
     * 获取消息事件
     * @return {?}
     */
    getMessageEvents() {
        /** @type {?} */
        const list = [];
        /** @type {?} */
        const bpmnModel = this.graph.bpmnModel;
        /** @type {?} */
        const flowDict = bpmnModel.DefaultProcess.GetFlowElements();
        Object.keys(flowDict).forEach((/**
         * @param {?} key
         * @return {?}
         */
        (key) => {
            /** @type {?} */
            const flowElt = flowDict[key];
            if (flowElt.ClrTypeID === 'bpmn.MessageEvent') {
                list.push(flowElt);
            }
        }));
        return list;
    }
    /**
     * 获取子流程和信号捕获节点
     * @return {?}
     */
    getSubAndCatchEvents() {
        /** @type {?} */
        const list = [];
        /** @type {?} */
        const bpmnModel = this.graph.bpmnModel;
        /** @type {?} */
        const flowDict = bpmnModel.DefaultProcess.GetFlowElements();
        Object.keys(flowDict).forEach((/**
         * @param {?} key
         * @return {?}
         */
        (key) => {
            /** @type {?} */
            const flowElt = flowDict[key];
            if (flowElt.ClrTypeID === 'wf.CallActivitySubProcess' ||
                flowElt.ClrTypeID === 'wf.IntermediateCatchEventImpl') {
                list.push(flowElt);
            }
        }));
        return list;
    }
    /**
     * 获取启动方式
     * @return {?}
     */
    getStartMode() {
        /** @type {?} */
        let startMode = null;
        /** @type {?} */
        const bpmnModel = this.graph.bpmnModel;
        /** @type {?} */
        const extendElements = bpmnModel.DefaultProcess.GetExtensionElements();
        if (extendElements.length > 0) {
            for (const e of extendElements) {
                if (e instanceof ProcessHeader) {
                    startMode = e.startMode;
                }
            }
        }
        return startMode;
    }
}
if (false) {
    /** @type {?} */
    WfEditorUi.prototype.editor;
    /** @type {?} */
    WfEditorUi.prototype.graph;
    /** @type {?} */
    WfEditorUi.prototype.sidebar;
    /** @type {?} */
    WfEditorUi.prototype.time;
    /** @type {?} */
    WfEditorUi.prototype.bizCategoryId;
    /** @type {?} */
    WfEditorUi.prototype.action;
    /** @type {?} */
    WfEditorUi.prototype.mode;
    /** @type {?} */
    WfEditorUi.prototype.scene;
    /** @type {?} */
    WfEditorUi.prototype.procType;
    /** @type {?} */
    WfEditorUi.prototype.procExtProps;
    /** @type {?} */
    WfEditorUi.prototype.formFormats;
    /** @type {?} */
    WfEditorUi.prototype.generalConfig;
    /** @type {?} */
    WfEditorUi.prototype.zoomBar;
    /**
     * @type {?}
     * @private
     */
    WfEditorUi.prototype.injector;
    /**
     * @type {?}
     * @private
     */
    WfEditorUi.prototype.modalService;
    /**
     * @type {?}
     * @private
     */
    WfEditorUi.prototype.resolver;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiV2ZFZGl0b3JVaS5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0Bnc3Atd2Yvd2YtcHJvY2Vzcy1lZGl0b3IvIiwic291cmNlcyI6WyJsaWIvZGVzaWduZXIvV2ZFZGl0b3JVaS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUFRLFFBQVEsRUFBUyxVQUFVLEVBQUUsWUFBWSxFQUFFLFdBQVcsRUFBRSxNQUFNLHNCQUFzQixDQUFDO0FBQ3BHLE9BQU8sRUFBRSxPQUFPLEVBQUUsTUFBTSxXQUFXLENBQUM7QUFDcEMsT0FBTyxFQUFFLGFBQWEsRUFBZSxZQUFZLEVBQUUsaUJBQWlCLEVBQUUsTUFBTSwwQkFBMEIsQ0FBQztBQUN2RyxPQUFPLEVBQUUsU0FBUyxFQUFFLE1BQU0sYUFBYSxDQUFDO0FBQ3hDLE9BQU8sRUFBRSxXQUFXLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDNUMsT0FBTyxFQUFFLE9BQU8sRUFBRSxXQUFXLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUMzRCxPQUFPLEVBQUUsd0JBQXdCLEVBQUUsTUFBTSxrREFBa0QsQ0FBQztBQUM1RixPQUFPLEVBQUUsc0JBQXNCLEVBQUUsTUFBTSxrQ0FBa0MsQ0FBQztBQUMxRSxPQUFPLEVBQUUsMkJBQTJCLEVBQUUsTUFBTSx1Q0FBdUMsQ0FBQztBQUNwRixPQUFPLEVBQUUsZ0JBQWdCLEVBQUUsTUFBTSw0QkFBNEIsQ0FBQztBQUM5RCxPQUFPLEVBQUUsMEJBQTBCLEVBQUUsTUFBTSxzQ0FBc0MsQ0FBQztBQUNsRixPQUFPLEVBQUUsOEJBQThCLEVBQUUsTUFBTSwwQ0FBMEMsQ0FBQztBQUMxRixPQUFPLEVBQUUsbUJBQW1CLEVBQUUsTUFBTSwrQkFBK0IsQ0FBQztBQUNwRSxPQUFPLEVBQUUsa0JBQWtCLEVBQUUsTUFBTSw4QkFBOEIsQ0FBQztBQUNsRSxPQUFPLEVBQUUscUJBQXFCLEVBQUUsTUFBTSxpQ0FBaUMsQ0FBQztBQUN4RSxPQUFPLEVBQUUsaUJBQWlCLEVBQUUsTUFB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QUNkLFNBQVMsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLFNBQVM7O2NBQ2hDLGNBQWMsR0FBRyxTQUFTLENBQUMsY0FBYyxDQUFDLG9CQUFvQixFQUFFO1FBQ3RFLElBQUksY0FBYyxDQUFDLE1BQU0sR0FBRyxDQUFDLEVBQUU7WUFDN0IsS0FBSyxNQUFNLENBQUMsSUFBSSxjQUFjLEVBQUU7Z0JBQzlCLElBQUksQ0FBQyxZQUFZLGFBQWEsRUFBRTtvQkFDOUIsU0FBUyxHQUFHLENBQUMsQ0FBQyxTQUFTLENBQUM7aUJBQ3pCO2FBQ0Y7U0FDRjtRQUNELE9BQU8sU0FBUyxDQUFDO0lBQ25CLENBQUM7Q0FDRjs7O0lBL2FDLDRCQUFpQzs7SUFDakMsMkJBQWU7O0lBQ2YsNkJBQW1COztJQUNuQiwwQkFBYTs7SUFDYixtQ0FBc0I7O0lBQ3RCLDRCQUFlOztJQUNmLDBCQUFhOztJQUNiLDJCQUFjOztJQUNkLDhCQUFpQjs7SUFDakIsa0NBQWtCOztJQUNsQixpQ0FBaUI7O0lBQ2pCLG1DQUtFOztJQUVGLDZCQUF3Qjs7Ozs7SUFFMkMsOEJBQTJCOzs7OztJQUM1RixrQ0FBcUM7Ozs7O0lBQ3JDLDhCQUEyQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENlbGwsIEVkaXRvclVpLCBHcmFwaCwgQWN0aW9uS2V5cywgVG9vbGJveEdyb3VwLCBUb29sYm94SXRlbSB9IGZyb20gXCJAZWRwLXBtZi9ncmFwaGVkaXRvclwiO1xyXG5pbXBvcnQgeyBXZkdyYXBoIH0gZnJvbSBcIi4vV2ZHcmFwaFwiO1xyXG5pbXBvcnQgeyBQcm9jZXNzSGVhZGVyLCBCaXpBY3Rpdml0eSwgVXNlckFjdGl2aXR5LCBPcGVyYXRpb25BY3Rpdml0eSB9IGZyb20gXCJAZ3NwLXdmL3dmLXByb2Nlc3MtbW9kZWxcIjtcclxuaW1wb3J0IHsgV2ZTaWRlYmFyIH0gZnJvbSBcIi4vV2ZTaWRlYmFyXCI7XHJcbmltcG9ydCB7IFdmQ29uc3RhbnRzIH0gZnJvbSBcIi4vV2ZDb25zdGFudHNcIjtcclxuaW1wb3J0IHsgbXhFdmVudCwgbXhSZXNvdXJjZXMgfSBmcm9tIFwiQGVkcC1wbWYvbXhncmFwaC10c1wiO1xyXG5pbXBvcnQgeyBVc2VyQWN0aXZpdHlQcm9wZXJ0eUtleXMgfSBmcm9tIFwiLi93Zi1jZWxsL3Byb3BlcnR5LWtleXMvVXNlckFjdGl2aXR5UHJvcGVydHlLZXlzXCI7XHJcbmltcG9ydCB7IFdmRXhjbHVzaXZlR2F0ZXdheUNlbGwgfSBmcm9tIFwiLi93Zi1jZWxsL1dmRXhjbHVzaXZlR2F0ZXdheUNlbGxcIjtcclxuaW1wb3J0IHsgQWlmQ3JlYXRpb25CaWxsQWN0aXZpdHlDZWxsIH0gZnJvbSBcIi4vd2YtY2VsbC9BaWZDcmVhdGlvbkJpbGxBY3Rpdml0eUNlbGxcIjtcclxuaW1wb3J0IHsgQXV0b0FjdGl2aXR5Q2VsbCB9IGZyb20gXCIuL3dmLWNlbGwvQXV0b0FjdGl2aXR5Q2VsbFwiO1xyXG5pbXBvcnQgeyBDYWxsQWN0aXZpdHlTdWJQcm9jZXNzQ2VsbCB9IGZyb20gXCIuL3dmLWNlbGwvQ2FsbEFjdGl2aXR5U3ViUHJvY2Vzc0NlbGxcIjtcclxuaW1wb3J0IHsgSW50ZXJtZWRpYXRlQ2F0Y2hFdmVudEltcGxDZWxsIH0gZnJvbSBcIi4vd2YtY2VsbC9JbnRlcm1lZGlhdGVDYXRjaEV2ZW50SW1wbENlbGxcIjtcclxuaW1wb3J0IHsgTWVzc2FnZUFjdGl2aXR5Q2VsbCB9IGZyb20gXCIuL3dmLWNlbGwvTWVzc2FnZUFjdGl2aXR5Q2VsbFwiO1xyXG5pbXBvcnQgeyBOb3RpZnlBY3Rpdml0eUNlbGwgfSBmcm9tIFwiLi93Zi1jZWxsL05vdGlmeUFjdGl2aXR5Q2VsbFwiO1xyXG5pbXBvcnQgeyBPcGVyYXRpb25BY3Rpdml0eUNlbGwgfSBmcm9tIFwiLi93Zi1jZWxsL09wZXJhdGlvbkFjdGl2aXR5Q2VsbFwiO1xyXG5pbXBvcnQgeyBTdGFydEFjdGl2aXR5Q2VsbCB9IGZyb20gXCIuL3dmLWNlbGwvU3RhcnRBY3Rpdml0eUNlbGxcIjtcclxuaW1wb3J0IHsgVXNlckFjdGl2aXR5Q2VsbCB9IGZyb20gXCIuL3dmLWNlbGwvVXNlckFjdGl2aXR5Q2VsbFwiO1xyXG5pbXBvcnQgeyBXZlBhcmFsbGVsR2F0ZXdheUNlbGwgfSBmcm9tIFwiLi93Zi1jZWxsL1dmUGFyYWxsZWxHYXRld2F5Q2VsbFwiO1xyXG5pbXBvcnQgeyBXZkVuZEV2ZW50Q2VsbCB9IGZyb20gXCIuL3dmLWNlbGwvV2ZFbmRFdmVudENlbGxcIjtcclxuaW1wb3J0IHsgV2ZJbmNsdXNpdmVHYXRld2F5Q2VsbCB9IGZyb20gXCIuL3dmLWNlbGwvV2ZJbmNsdXNpdmVHYXRld2F5Q2VsbFwiO1xyXG5pbXBvcnQgeyBXZlByb2Nlc3NFZGl0b3JDb21wb25lbnQgfSBmcm9tIFwiLi4vd2YtcHJvY2Vzcy1lZGl0b3IuY29tcG9uZW50XCI7XHJcbmltcG9ydCB7IEJhdGNoU2V0UHJvcGVydGllc0NvbXBvbmVudCB9IGZyb20gXCIuLi92aWV3cy9iYXRjaC1zZXQtcHJvcGVydGllcy9iYXRjaC1zZXQtcHJvcGVydGllcy5jb21wb25lbnRcIjtcclxuaW1wb3J0IHsgQnNNb2RhbFNlcnZpY2UsIE1vZGFsT3B0aW9ucyB9IGZyb20gXCJAZmFycmlzL3VpLW1vZGFsXCI7XHJcbmltcG9ydCB7IENvbXBvbmVudEZhY3RvcnlSZXNvbHZlciwgSW5qZWN0b3IgfSBmcm9tIFwiQGFuZ3VsYXIvY29yZVwiO1xyXG5cclxuZXhwb3J0IGNsYXNzIFdmRWRpdG9yVWkgZXh0ZW5kcyBFZGl0b3JVaSB7XHJcbiAgZWRpdG9yOiBXZlByb2Nlc3NFZGl0b3JDb21wb25lbnQ7XHJcbiAgZ3JhcGg6IFdmR3JhcGg7XHJcbiAgc2lkZWJhcjogV2ZTaWRlYmFyO1xyXG4gIHRpbWU6IHN0cmluZztcclxuICBiaXpDYXRlZ29yeUlkOiBzdHJpbmc7XHJcbiAgYWN0aW9uOiBzdHJpbmc7XHJcbiAgbW9kZTogc3RyaW5nO1xyXG4gIHNjZW5lOiBzdHJpbmc7XHJcbiAgcHJvY1R5cGU6IHN0cmluZztcclxuICBwcm9jRXh0UHJvcHM6IGFueTtcclxuICBmb3JtRm9ybWF0czogYW55O1xyXG4gIGdlbmVyYWxDb25maWc6IHsgZW5hYmxlVHJhbnNmZXI6IGJvb2xlYW47IGVuYWJsZU5vdGlmeTogYm9vbGVhbjsgZW5hYmxlQWRkU2lnbkJlaGluZDogYm9vbGVhbjsgZW5hYmxlQWRkU2lnbkZyb250OiBib29sZWFuOyB9ID0ge1xyXG4gICAgZW5hYmxlVHJhbnNmZXI6IHRydWUsXHJcbiAgICBlbmFibGVOb3RpZnk6IGZhbHNlLFxyXG4gICAgZW5hYmxlQWRkU2lnbkJlaGluZDogZmFsc2UsXHJcbiAgICBlbmFibGVBZGRTaWduRnJvbnQ6IGZhbHNlLFxyXG4gIH07XHJcblxyXG4gIHpvb21CYXI6IEhUTUxEaXZFbGVtZW50O1xyXG5cclxuICBjb25zdHJ1Y3Rvcih0aW1lOiBzdHJpbmcsIGFjdGlvbjogc3RyaW5nLCBjb250YWluZXI/OiBIVE1MRWxlbWVudCwgcHJpdmF0ZSBpbmplY3Rvcj86IEluamVjdG9yLFxyXG4gICAgcHJpdmF0ZSBtb2RhbFNlcnZpY2U/OiBCc01vZGFsU2VydmljZSxcclxuICAgIHByaXZhdGUgcmVzb2x2ZXI/OiBDb21wb25lbnRGYWN0b3J5UmVzb2x2ZXIsIGV2ZW50U291cmNlPzogYW55LCBpbXBvcnRMaW5rczogYm9vbGVhbiA9IHRydWUsKSB7XHJcbiAgICBzdXBlcihjb250YWluZXIsIGV2ZW50U291cmNlLCBpbXBvcnRMaW5rcyk7XHJcbiAgICBsZXQgcm9vdFBhdGggPSAnJztcclxuICAgIHRyeSB7XHJcbiAgICAgIHJvb3RQYXRoID0gKHdpbmRvdyBhcyBhbnkpLmdzcGZyYW1ld29ya1NlcnZpY2UuY29tbW9uLmdldEJhc2VQYXRoLmdldCgpO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIH1cclxuICAgIG14UmVzb3VyY2VzLmFkZChyb290UGF0aCArIFwiL3BsYXRmb3JtL3J1bnRpbWUvY29tbW9uL3dlYi9AZ3NwLXdmL3dmLXByb2Nlc3MtZWRpdG9yL3Jlc291cmNlcy93Zi1wcm9jZXNzLWVkaXRvclwiKTtcclxuICAgIHRoaXMuc2hvd1Rvb2xiYXIgPSBmYWxzZTtcclxuICAgIHRoaXMudGltZSA9IHRpbWU7XHJcbiAgICB0aGlzLmFjdGlvbiA9IGFjdGlvbjtcclxuICB9XHJcblxyXG4gIGNyZWF0ZUFjdGlvbnMoKSB7XHJcbiAgICBjb25zdCBhY3Rpb25zID0gc3VwZXIuY3JlYXRlQWN0aW9ucygpO1xyXG5cclxuICAgIC8vIOWPquacieiuvuiuoeaXtue8lui+keeKtuaAgeS4i+aJjeWQr+eUqOWIoOmZpOWKqOS9nFxyXG4gICAgaWYgKCEodGhpcy5hY3Rpb24gPT09ICdlZGl0JyAmJiB0aGlzLnRpbWUgIT09ICdydCcpKSB7XHJcbiAgICAgIGNvbnN0IGRlbGV0ZUFjdGlvbiA9IGFjdGlvbnMuZ2V0QWN0aW9uKEFjdGlvbktleXMucG1mX2RlbGV0ZSk7XHJcblxyXG4gICAgICBkZWxldGVBY3Rpb24uaXNFbmFibGVkID0gKCkgPT4gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIGFjdGlvbnM7XHJcbiAgfVxyXG5cclxuICBjcmVhdGVUb29sYm94KCkge1xyXG4gICAgY29uc3QgdG9vbGJveCA9IHN1cGVyLmNyZWF0ZVRvb2xib3goKTtcclxuXHJcbiAgICBjb25zdCBnMSA9IG5ldyBUb29sYm94R3JvdXAoKTtcclxuICAgIGcxLm5hbWUgPSBteFJlc291cmNlcy5nZXQoJ2Jhc2ljRWxlbWVudHMnKTtcclxuICAgIGcxLml0ZW1zLnB1c2goXHJcbiAgICAgIG5ldyBUb29sYm94SXRlbShTdGFydEFjdGl2aXR5Q2VsbC5DTFJfVFlQRV9JRCksXHJcbiAgICAgIG5ldyBUb29sYm94SXRlbShXZkV4Y2x1c2l2ZUdhdGV3YXlDZWxsLkNMUl9UWVBFX0lEKSxcclxuICAgICAgbmV3IFRvb2xib3hJdGVtKFdmUGFyYWxsZWxHYXRld2F5Q2VsbC5DTFJfVFlQRV9JRCksXHJcbiAgICAgIC8vIOaaguaXtumakOiXj+WMheWuuee9keWFs1xyXG4gICAgICBuZXcgVG9vbGJveEl0ZW0oV2ZJbmNsdXNpdmVHYXRld2F5Q2VsbC5DTFJfVFlQRV9JRCksXHJcbiAgICAgIG5ldyBUb29sYm94SXRlbShVc2VyQWN0aXZpdHlDZWxsLkNMUl9UWVBFX0lEKSxcclxuICAgICAgbmV3IFRvb2xib3hJdGVtKE9wZXJhdGlvbkFjdGl2aXR5Q2VsbC5DTFJfVFlQRV9JRCksXHJcbiAgICAgIG5ldyBUb29sYm94SXRlbShOb3RpZnlBY3Rpdml0eUNlbGwuQ0xSX1RZUEVfSUQpLFxyXG4gICAgICBuZXcgVG9vbGJveEl0ZW0oQ2FsbEFjdGl2aXR5U3ViUHJvY2Vzc0NlbGwuQ0xSX1RZUEVfSUQpLFxyXG4gICAgICBuZXcgVG9vbGJveEl0ZW0oQXV0b0FjdGl2aXR5Q2VsbC5DTFJfVFlQRV9JRCksXHJcbiAgICAgIG5ldyBUb29sYm94SXRlbShJbnRlcm1lZGlhdGVDYXRjaEV2ZW50SW1wbENlbGwuQ0xSX1RZUEVfSUQpLFxyXG4gICAgICBuZXcgVG9vbGJveEl0ZW0oTWVzc2FnZUFjdGl2aXR5Q2VsbC5DTFJfVFlQRV9JRCksXHJcbiAgICAgIG5ldyBUb29sYm94SXRlbShBaWZDcmVhdGlvbkJpbGxBY3Rpdml0eUNlbGwuQ0xSX1RZUEVfSUQpLFxyXG4gICAgICBuZXcgVG9vbGJveEl0ZW0oV2ZFbmRFdmVudENlbGwuQ0xSX1RZUEVfSUQpLFxyXG4gICAgKTtcclxuXHJcbiAgICB0b29sYm94Lmdyb3VwcyA9IFtnMV07XHJcblxyXG4gICAgcmV0dXJuIHRvb2xib3g7XHJcbiAgfVxyXG5cclxuICBjcmVhdGVHcmFwaEluc3RhbmNlKCk6IEdyYXBoIHtcclxuICAgIGNvbnN0IGdyYXBoID0gbmV3IFdmR3JhcGgodGhpcywgdGhpcy5kaWFncmFtQ29udGFpbmVyKTtcclxuXHJcbiAgICBpZiAodGhpcy5hY3Rpb24gPT09ICd2aWV3JyB8fCB0aGlzLnRpbWUgPT09ICdydCcgfHwgdGhpcy5hY3Rpb24gPT09ICdhc3NpZ25WaWV3Jykge1xyXG4gICAgICBncmFwaC5zZXRDZWxsc0xvY2tlZCh0cnVlKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGdyYXBoLnNldERyb3BFbmFibGVkKHRydWUpO1xyXG4gICAgICBncmFwaC5zZXRDb25uZWN0YWJsZSh0cnVlKTtcclxuICAgIH1cclxuICAgIC8vVE9ET++8muWPs+mUruafpeeci+WPquaYvuekuuWcqOWuoeaJueiKgueCueS4ilxyXG4gICAgZ3JhcGgucG9wdXBNZW51SGFuZGxlci5hdXRvRXhwYW5kID0gdHJ1ZTtcclxuICAgIGdyYXBoLnBvcHVwTWVudUhhbmRsZXIuZmFjdG9yeU1ldGhvZCA9IChtZW51LCBjZWxsLCBldnQpID0+IHtcclxuICAgICAgY29uc3QgYWN0TGlzdCA9IGdyYXBoLmdldENoaWxkQ2VsbHMoZ3JhcGguZ2V0RGVmYXVsdFBhcmVudCgpKVxyXG4gICAgICBpZiAoY2VsbCAhPSBudWxsXHJcbiAgICAgICAgJiYgY2VsbC5jbHJUeXBlSWQuaW5kZXhPZignd2YuVXNlckFjdGl2aXR5JykgPiAtMVxyXG4gICAgICAgICYmIGFjdExpc3QuZmluZEluZGV4KGEgPT4gYS5pZCA9PT0gY2VsbC5nZXRJZCgpKSA+IC0xKSB7XHJcbiAgICAgICAgbWVudS5hZGRJdGVtKCfmibnph4/lpI3liLblsZ7mgKcnLCBudWxsLCAoKSA9PiB7XHJcbiAgICAgICAgICBjb25zdCBjb21wRmFjdG9yeSA9IHRoaXMucmVzb2x2ZXIucmVzb2x2ZUNvbXBvbmVudEZhY3RvcnkoQmF0Y2hTZXRQcm9wZXJ0aWVzQ29tcG9uZW50KTtcclxuICAgICAgICAgIGNvbnN0IGNvbXBSZWYgPSBjb21wRmFjdG9yeS5jcmVhdGUodGhpcy5pbmplY3Rvcik7XHJcbiAgICAgICAgICBjb21wUmVmLmluc3RhbmNlLmFjdGl2aXR5TW9kZWwgPSBjZWxsLmZsb3dFbGVtZW50O1xyXG4gICAgICAgICAgY29uc3QgbW9kYWxDb25maWc6IE1vZGFsT3B0aW9ucyA9IHtcclxuICAgICAgICAgICAgdGl0bGU6ICfmibnph4/lpI3liLblsZ7mgKcnLFxyXG4gICAgICAgICAgICB3aWR0aDogNTEyLFxyXG4gICAgICAgICAgICBoZWlnaHQ6IDQ2NSxcclxuICAgICAgICAgICAgc2hvd0J1dHRvbnM6IHRydWUsXHJcbiAgICAgICAgICAgIGJ1dHRvbnM6IGNvbXBSZWYuaW5zdGFuY2UuZm9vdGVyXHJcbiAgICAgICAgICB9O1xyXG4gICAgICAgICAgY29uc3QgZGlhbG9nID0gdGhpcy5tb2RhbFNlcnZpY2Uuc2hvdyhjb21wUmVmLCBtb2RhbENvbmZpZyk7XHJcbiAgICAgICAgICBjb21wUmVmLmluc3RhbmNlLmNhbmNlbC5zdWJzY3JpYmUoJGV2ZW50ID0+IGRpYWxvZy5jbG9zZSgpKTtcclxuICAgICAgICAgIGNvbXBSZWYuaW5zdGFuY2Uuc3VibWl0LnN1YnNjcmliZSgoZGF0YTogc3RyaW5nKSA9PiB7XHJcbiAgICAgICAgICAgIGRpYWxvZy5jbG9zZSgpO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgIH07XHJcbiAgICByZXR1cm4gZ3JhcGg7XHJcbiAgfVxyXG5cclxuICBjcmVhdGVTaWRlYmFyKCk6IFdmU2lkZWJhciB7XHJcbiAgICByZXR1cm4gbmV3IFdmU2lkZWJhcih0aGlzLCB0aGlzLnNpZGViYXJDb250YWluZXIpO1xyXG4gIH1cclxuXHJcbiAgc2hvdygpOiB2b2lkIHtcclxuICAgIHN1cGVyLnNob3coKTtcclxuXHJcbiAgICBpZiAodGhpcy5hY3Rpb24gPT09ICd2aWV3JyB8fCB0aGlzLmFjdGlvbiA9PT0gJ2Fzc2lnblZpZXcnKSB7XHJcbiAgICAgIGNvbnN0IHNwYW4gPSB0aGlzLmNyZWF0ZVNwYW4oJycpO1xyXG4gICAgICBzcGFuLnN0eWxlLmZvbnRTaXplID0gJzE0cHgnO1xyXG4gICAgICBzcGFuLnN0eWxlLmNvbG9yID0gJ3doaXRlJztcclxuICAgICAgc3Bhbi5zdHlsZS5ib3JkZXJSYWRpdXMgPSAnMjBweCc7XHJcbiAgICAgIHNwYW4uc3R5bGUucGFkZGluZyA9ICc0cHggMjBweCc7XHJcbiAgICAgIHNwYW4uc3R5bGUuYmFja2dyb3VuZCA9ICdyZ2IoMTk5LCAxOTQsIDE4NyknO1xyXG4gICAgICBjb25zdCB2ID0gZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUobXhSZXNvdXJjZXMuZ2V0KCdyZWFkT25seScpKTtcclxuICAgICAgc3Bhbi5hcHBlbmRDaGlsZCh2KTtcclxuICAgICAgY29uc3QgZCA9IHRoaXMuY3JlYXRlRGl2KCcnKTtcclxuICAgICAgZC5zdHlsZS5wb3NpdGlvbiA9ICdhYnNvbHV0ZSc7XHJcbiAgICAgIGQuc3R5bGUudG9wID0gJzEwcHgnO1xyXG4gICAgICBkLnN0eWxlLnJpZ2h0ID0gJzEwcHgnO1xyXG4gICAgICBkLnN0eWxlLnpJbmRleCA9IFwiMlwiO1xyXG4gICAgICBkLmFwcGVuZENoaWxkKHNwYW4pO1xyXG4gICAgICB0aGlzLmNvbnRhaW5lci5hcHBlbmRDaGlsZChkKTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBidXR0b25JbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTtcclxuICAgIGJ1dHRvbkluLnNldEF0dHJpYnV0ZSgnaHJlZicsICdqYXZhc2NyaXB0OnZvaWQoMCk7Jyk7XHJcbiAgICBsZXQgYnV0dG9uSW5JbWcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbWcnKTtcclxuICAgIGJ1dHRvbkluLnN0eWxlLm1hcmdpblJpZ2h0ID0gJzEwcHgnO1xyXG4gICAgYnV0dG9uSW5JbWcuc3JjID0gV2ZDb25zdGFudHMuSU1BR0VfUEFUSCArICcvem9vbUluLnN2Zyc7XHJcbiAgICBidXR0b25JbkltZy5zdHlsZS5kaXNwbGF5ID0gXCJpbmxpbmUtYmxvY2tcIjtcclxuICAgIGJ1dHRvbkluSW1nLnN0eWxlLnZlcnRpY2FsQWxpZ24gPSBcIm1pZGRsZVwiO1xyXG4gICAgYnV0dG9uSW4uYXBwZW5kQ2hpbGQoYnV0dG9uSW5JbWcpO1xyXG4gICAgbXhFdmVudC5hZGRMaXN0ZW5lcihidXR0b25JbiwgJ2NsaWNrJywgKGV2dDogUG9pbnRlckV2ZW50KSA9PiB7XHJcbiAgICAgIHRoaXMuYWN0aW9ucy5nZXRBY3Rpb24oQWN0aW9uS2V5cy5wbWZfem9vbUluKS5leGVjdXRlKGV2dCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBjb25zdCBidXR0b25PdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XHJcbiAgICBidXR0b25PdXQuc2V0QXR0cmlidXRlKCdocmVmJywgJ2phdmFzY3JpcHQ6dm9pZCgwKTsnKTtcclxuICAgIGxldCBidXR0b25PdXRJbWcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbWcnKTtcclxuICAgIGJ1dHRvbk91dEltZy5zcmMgPSBXZkNvbnN0YW50cy5JTUFHRV9QQVRIICsgJy96b29tT3V0LnN2Zyc7XHJcbiAgICBidXR0b25PdXRJbWcuc3R5bGUuZGlzcGxheSA9IFwiaW5saW5lLWJsb2NrXCI7XHJcbiAgICBidXR0b25PdXRJbWcuc3R5bGUudmVydGljYWxBbGlnbiA9IFwibWlkZGxlXCI7XHJcbiAgICBidXR0b25PdXQuYXBwZW5kQ2hpbGQoYnV0dG9uT3V0SW1nKTtcclxuICAgIG14RXZlbnQuYWRkTGlzdGVuZXIoYnV0dG9uT3V0LCAnY2xpY2snLCAoZXZ0OiBQb2ludGVyRXZlbnQpID0+IHtcclxuICAgICAgdGhpcy5hY3Rpb25zLmdldEFjdGlvbihBY3Rpb25LZXlzLnBtZl96b29tT3V0KS5leGVjdXRlKGV2dCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBjb25zdCB6b29tQmFyID0gdGhpcy5jcmVhdGVEaXYoJ3pvb21CYXInKTtcclxuICAgIHpvb21CYXIuc3R5bGUucG9zaXRpb24gPSAnYWJzb2x1dGUnO1xyXG4gICAgem9vbUJhci5zdHlsZS56SW5kZXggPSBcIjJcIjtcclxuICAgIGxldCB0ID0gMTA7XHJcbiAgICBpZiAodGhpcy5zaG93TWVudWJhcikge1xyXG4gICAgICB0ICs9IHRoaXMubWVudWJhckhlaWdodDtcclxuICAgIH1cclxuICAgIGlmICh0aGlzLnNob3dUb29sYmFyKSB7XHJcbiAgICAgIHQgKz0gdGhpcy50b29sYmFySGVpZ2h0O1xyXG4gICAgfVxyXG4gICAgem9vbUJhci5zdHlsZS50b3AgPSB0ICsgJ3B4JztcclxuICAgIHpvb21CYXIuc3R5bGUubGVmdCA9ICh0aGlzLnNob3dTaWRlYmFyID8gdGhpcy5zaWRlYmFyU3BsaXRQb3NpdGlvbiArIHRoaXMuc2lkZWJhclNwbGl0U2l6ZSA6IDApICsgMTAgKyBcInB4XCI7XHJcblxyXG4gICAgem9vbUJhci5hcHBlbmRDaGlsZChidXR0b25Jbik7XHJcbiAgICB6b29tQmFyLmFwcGVuZENoaWxkKGJ1dHRvbk91dCk7XHJcbiAgICB0aGlzLmNvbnRhaW5lci5hcHBlbmRDaGlsZCh6b29tQmFyKTtcclxuICAgIHRoaXMuem9vbUJhciA9IHpvb21CYXI7XHJcbiAgfVxyXG5cclxuICBzaWRlYmFyU3BsaXRPbkNoYW5nZSh2YWx1ZTogbnVtYmVyKTogdm9pZCB7XHJcbiAgICBzdXBlci5zaWRlYmFyU3BsaXRPbkNoYW5nZSh2YWx1ZSk7XHJcblxyXG4gICAgLy8g5YiG5Ymy5p2h56e75Yqo5ZCO5pu05paw57yp5pS+5p2h5L2N572uXHJcbiAgICBpZiAodGhpcy56b29tQmFyKSB7XHJcbiAgICAgIHRoaXMuem9vbUJhci5zdHlsZS5sZWZ0ID0gKHRoaXMuc2hvd1NpZGViYXIgPyB0aGlzLnNpZGViYXJTcGxpdFBvc2l0aW9uICsgdGhpcy5zaWRlYmFyU3BsaXRTaXplIDogMCkgKyAxMCArIFwicHhcIjtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOWIm+W7uuW4puaMh+Wumuagt+W8j+exu+eahHNwYW5cclxuICAgKiBAcGFyYW0gY2xhc3NuYW1lXHJcbiAgICogQHJldHVybnNcclxuICAgKi9cclxuICBjcmVhdGVTcGFuKGNsYXNzbmFtZTogc3RyaW5nKTogSFRNTFNwYW5FbGVtZW50IHtcclxuICAgIGxldCBlbHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XHJcbiAgICBlbHQuY2xhc3NOYW1lID0gY2xhc3NuYW1lO1xyXG5cclxuICAgIHJldHVybiBlbHQ7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDliqDovb3kuJrliqHmtLvliqhcclxuICAgKiBAcGFyYW0gYml6QWN0aXZpdGllc1xyXG4gICAqL1xyXG4gIGxvYWRCaXpBY3Rpdml0aWVzKGJpekFjdGl2aXRpZXM6IEJpekFjdGl2aXR5W10pIHtcclxuICAgIHRoaXMuc2lkZWJhciAmJiB0aGlzLnNpZGViYXIuYWRkQml6QWN0UGFsZXR0ZShiaXpBY3Rpdml0aWVzKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOaJuemHj+WkjeWItuWxnuaAp1xyXG4gICAqIEBwYXJhbSBvYmpcclxuICAgKi9cclxuICBiYXRjaENvcHlQcm9wZXJ0eShvYmo6IGFueSkge1xyXG4gICAgLy8g5pS+5byD5LiN6ZyA6KaB55qE5Y+C5pWwXHJcbiAgICBjb25zdCBpZHMgPSBvYmoudmFsdWUudGFyZ2V0Tm9kZUlEO1xyXG4gICAgb2JqLnByb3BlcnR5VmFsdWUgPSBvYmoudmFsdWUubWVzc2FnZU5vdGljZTtcclxuICAgIC8vIHRvZG/vvJrlpJrkuKrmtLvliqjlhbfmnInlkIzlkI3lsZ7mgKfml7bvvIzlpoLkvZXmm7TlkIjnkIblrprkuYlQcm9wZXJ0eUtlee+8n1xyXG4gICAgb2JqLnByb3BlcnR5SUQgPSBVc2VyQWN0aXZpdHlQcm9wZXJ0eUtleXMubWVzc2FnZU5vdGljZTtcclxuICAgIGZvciAoY29uc3QgaWQgb2YgaWRzKSB7XHJcbiAgICAgIGNvbnN0IGNlbGwgPSB0aGlzLmdyYXBoLmdldENlbGxCeUZsb3dFbGVtZW50SWQoaWQpO1xyXG4gICAgICBpZiAoY2VsbCkge1xyXG4gICAgICAgIGNlbGwudXBkYXRlUHJvcHMob2JqKTtcclxuICAgICAgICB0aGlzLmdyYXBoLnJlZnJlc2goKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAqIOaJuemHj+iuvue9ruWxnuaAp1xyXG4gKiBAcGFyYW0gb2JqXHJcbiAqL1xyXG4gIGJhdGNoU2V0UHJvcGVydHkob2JqOiBhbnkpIHtcclxuICAgIGZvciAoY29uc3QgdiBvZiBvYmopIHtcclxuICAgICAgc3dpdGNoICh2LnR5cGUpIHtcclxuICAgICAgICBjYXNlICdhZGRTaWduZnJvbnQnOlxyXG4gICAgICAgICAgY29uc3QgYWZJZCA9IHYuYWN0aXM7XHJcbiAgICAgICAgICBvYmoucHJvcGVydHlWYWx1ZSA9IHYuY29uZmlnO1xyXG4gICAgICAgICAgb2JqLnByb3BlcnR5SUQgPSBVc2VyQWN0aXZpdHlQcm9wZXJ0eUtleXMuQWRkU2lnbkZyb250QWJsZTtcclxuICAgICAgICAgIGZvciAoY29uc3QgaWQgb2YgYWZJZCkge1xyXG4gICAgICAgICAgICBjb25zdCBjZWxsID0gdGhpcy5ncmFwaC5nZXRDZWxsQnlGbG93RWxlbWVudElkKGlkLklkKTtcclxuICAgICAgICAgICAgaWYgKGNlbGwpIHtcclxuICAgICAgICAgICAgICBjZWxsLnVwZGF0ZVByb3BzKG9iaik7XHJcbiAgICAgICAgICAgICAgdGhpcy5ncmFwaC5yZWZyZXNoKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgJ2FkZFNpZ25CZWhpbmQnOlxyXG4gICAgICAgICAgY29uc3QgYWJJZCA9IHYuYWN0aXM7XHJcbiAgICAgICAgICBvYmoucHJvcGVydHlWYWx1ZSA9IHYuY29uZmlnO1xyXG4gICAgICAgICAgb2JqLnByb3BlcnR5SUQgPSBVc2VyQWN0aXZpdHlQcm9wZXJ0eUtleXMuQWRkU2lnbkJlaGluZEFibGU7XHJcbiAgICAgICAgICBmb3IgKGNvbnN0IGlkIG9mIGFiSWQpIHtcclxuICAgICAgICAgICAgY29uc3QgY2VsbCA9IHRoaXMuZ3JhcGguZ2V0Q2VsbEJ5Rmxvd0VsZW1lbnRJZChpZC5JZCk7XHJcbiAgICAgICAgICAgIGlmIChjZWxsKSB7XHJcbiAgICAgICAgICAgICAgY2VsbC51cGRhdGVQcm9wcyhvYmopO1xyXG4gICAgICAgICAgICAgIHRoaXMuZ3JhcGgucmVmcmVzaCgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlICd0cmFuc2Zlcic6XHJcbiAgICAgICAgICBjb25zdCB0cklkID0gdi5hY3RpcztcclxuICAgICAgICAgIG9iai5wcm9wZXJ0eVZhbHVlID0gdi5jb25maWc7XHJcbiAgICAgICAgICBvYmoucHJvcGVydHlJRCA9IFVzZXJBY3Rpdml0eVByb3BlcnR5S2V5cy50cmFuc2ZlclNjb3BlO1xyXG4gICAgICAgICAgZm9yIChjb25zdCBpZCBvZiB0cklkKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNlbGwgPSB0aGlzLmdyYXBoLmdldENlbGxCeUZsb3dFbGVtZW50SWQoaWQuSWQpO1xyXG4gICAgICAgICAgICBpZiAoY2VsbCkge1xyXG4gICAgICAgICAgICAgIGNlbGwudXBkYXRlUHJvcHMob2JqKTtcclxuICAgICAgICAgICAgICB0aGlzLmdyYXBoLnJlZnJlc2goKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSAnbm90aWZ5JzpcclxuICAgICAgICAgIGNvbnN0IG50SWQgPSB2LmFjdGlzO1xyXG4gICAgICAgICAgb2JqLnByb3BlcnR5VmFsdWUgPSB2LmNvbmZpZztcclxuICAgICAgICAgIG9iai5wcm9wZXJ0eUlEID0gVXNlckFjdGl2aXR5UHJvcGVydHlLZXlzLk5vdGlmeUFibGU7XHJcbiAgICAgICAgICBmb3IgKGNvbnN0IGlkIG9mIG50SWQpIHtcclxuICAgICAgICAgICAgY29uc3QgY2VsbCA9IHRoaXMuZ3JhcGguZ2V0Q2VsbEJ5Rmxvd0VsZW1lbnRJZChpZC5JZCk7XHJcbiAgICAgICAgICAgIGlmIChjZWxsKSB7XHJcbiAgICAgICAgICAgICAgY2VsbC51cGRhdGVQcm9wcyhvYmopO1xyXG4gICAgICAgICAgICAgIHRoaXMuZ3JhcGgucmVmcmVzaCgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICAvLyDpqbPlm57op4TliJnpnIDopoHnibnmrorlpITnkIbvvJrlrZDmtYHnqIvlkozkv6Hlj7fnmoTotYvnroDniYhcclxuICAgICAgICBjYXNlICdiYWNrV2FyZFJ1bGUnOlxyXG4gICAgICAgICAgY29uc3QgYndJZCA9IHYuYWN0aXM7XHJcbiAgICAgICAgICBvYmoucHJvcGVydHlWYWx1ZSA9IHYuY29uZmlnO1xyXG4gICAgICAgICAgb2JqLnByb3BlcnR5SUQgPSBVc2VyQWN0aXZpdHlQcm9wZXJ0eUtleXMuQmFja1dhcmRSdWxlO1xyXG4gICAgICAgICAgZm9yIChjb25zdCBpZCBvZiBid0lkKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNlbGwgPSB0aGlzLmdyYXBoLmdldENlbGxCeUZsb3dFbGVtZW50SWQoaWQuSWQpO1xyXG4gICAgICAgICAgICBpZiAoY2VsbCkge1xyXG4gICAgICAgICAgICAgIGNlbGwudXBkYXRlUHJvcHMob2JqKTtcclxuICAgICAgICAgICAgICB0aGlzLmdyYXBoLnJlZnJlc2goKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOWIm+W7uuaWsOa1geeoi1xyXG4gICAqIEBwYXJhbSBuZXdQcm9jSW5mb1xyXG4gICAqIEBwYXJhbSBiaXpDbXBzXHJcbiAgICovXHJcbiAgY3JlYXRlQnBtbk1vZGVsKG5ld1Byb2NJbmZvOiBhbnksIGJpekNtcHM/OiBhbnkpIHtcclxuICAgIHRoaXMuZ3JhcGguY3JlYXRlQnBtbk1vZGVsV2l0aFByb2NJbmZvKG5ld1Byb2NJbmZvLCBiaXpDbXBzKTtcclxuXHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDmiZPlvIDmtYHnqItcclxuICAgKiBAcGFyYW0gY29udGVudFxyXG4gICAqL1xyXG4gIG9wZW5CcG1uTW9kZWwoY29udGVudDogc3RyaW5nKSB7XHJcbiAgICB0aGlzLmdyYXBoLmxvYWRCcG1uTW9kZWwoY29udGVudCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDojrflj5blsZ7mgKfphY3nva7vvIzliLfmlrDlsZ7mgKfmoYZcclxuICAgKiBAcGFyYW0gb2JqXHJcbiAgICogQHJldHVybnNcclxuICAgKi9cclxuICByZWZyZXNoUHJvcGVydHkob2JqOiBhbnkpIHtcclxuICAgIGNvbnN0IGNlbGwgPSB0aGlzLmdyYXBoLmdldENlbGxCeUZsb3dFbGVtZW50SWQob2JqLklkKTtcclxuICAgIHJldHVybiB0aGlzLmdldEZhcnJpc1Byb3BDb25maWcoW2NlbGxdKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOiOt+WPlueUqOaIt+a0u+WKqFxyXG4gICAqIEByZXR1cm5zXHJcbiAgICovXHJcbiAgZ2V0QWN0aXZpdGllcygpIHtcclxuICAgIGNvbnN0IGxpc3QgPSBbXTtcclxuICAgIGNvbnN0IGJwbW5Nb2RlbCA9IHRoaXMuZ3JhcGguYnBtbk1vZGVsO1xyXG4gICAgY29uc3QgZmxvd0RpY3QgPSBicG1uTW9kZWwuRGVmYXVsdFByb2Nlc3MuR2V0Rmxvd0VsZW1lbnRzKCk7XHJcbiAgICBPYmplY3Qua2V5cyhmbG93RGljdCkuZm9yRWFjaCgoa2V5KSA9PiB7XHJcbiAgICAgIGNvbnN0IGZsb3dFbHQgPSBmbG93RGljdFtrZXldO1xyXG4gICAgICBpZiAoZmxvd0VsdC5DbHJUeXBlSUQgPT09IFVzZXJBY3Rpdml0eS5DbHJfVHlwZV9JRFxyXG4gICAgICAgIHx8IGZsb3dFbHQuQ2xyVHlwZUlEID09PSBPcGVyYXRpb25BY3Rpdml0eS5DbHJfVHlwZV9JRCkge1xyXG4gICAgICAgIGxpc3QucHVzaChmbG93RWx0KTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gbGlzdDtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOiOt+WPlue7k+adn+S6i+S7tlxyXG4gICAqIEByZXR1cm5zXHJcbiAgICovXHJcbiAgZ2V0RW5kRXZlbnRzKCkge1xyXG4gICAgY29uc3QgdXNlckFjdEFycmF5ID0gW107XHJcbiAgICBjb25zdCBicG1uTW9kZWwgPSB0aGlzLmdyYXBoLmJwbW5Nb2RlbDtcclxuICAgIGNvbnN0IGZsb3dEaWN0ID0gYnBtbk1vZGVsLkRlZmF1bHRQcm9jZXNzLkdldEZsb3dFbGVtZW50cygpO1xyXG4gICAgT2JqZWN0LmtleXMoZmxvd0RpY3QpLmZvckVhY2goKGtleSkgPT4ge1xyXG4gICAgICBjb25zdCBmbG93RWx0ID0gZmxvd0RpY3Rba2V5XTtcclxuICAgICAgaWYgKGZsb3dFbHQuQ2xyVHlwZUlEID09PSAnYnBtbi5FbmRFdmVudCcgfHwgZmxvd0VsdC5DbHJUeXBlSUQgPT09IFVzZXJBY3Rpdml0eS5DbHJfVHlwZV9JRFxyXG4gICAgICAgIHx8IGZsb3dFbHQuQ2xyVHlwZUlEID09PSBPcGVyYXRpb25BY3Rpdml0eS5DbHJfVHlwZV9JRCkge1xyXG4gICAgICAgIHVzZXJBY3RBcnJheS5wdXNoKGZsb3dFbHQpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICAgIHJldHVybiB1c2VyQWN0QXJyYXk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDojrflj5bnn6XkvJrkuovku7ZcclxuICAgKiBAcmV0dXJuc1xyXG4gICAqL1xyXG4gIGdldE5vdGlmeUV2ZW50cygpIHtcclxuICAgIGNvbnN0IGxpc3QgPSBbXTtcclxuICAgIGNvbnN0IGJwbW5Nb2RlbCA9IHRoaXMuZ3JhcGguYnBtbk1vZGVsO1xyXG4gICAgY29uc3QgZmxvd0RpY3QgPSBicG1uTW9kZWwuRGVmYXVsdFByb2Nlc3MuR2V0Rmxvd0VsZW1lbnRzKCk7XHJcbiAgICBPYmplY3Qua2V5cyhmbG93RGljdCkuZm9yRWFjaCgoa2V5KSA9PiB7XHJcbiAgICAgIGNvbnN0IGZsb3dFbHQgPSBmbG93RGljdFtrZXldO1xyXG4gICAgICBpZiAoZmxvd0VsdC5DbHJUeXBlSUQgPT09ICd3Zi5Ob3RpZnlBY3Rpdml0eScpIHtcclxuICAgICAgICBsaXN0LnB1c2goZmxvd0VsdCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIGxpc3Q7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDojrflj5bmtojmga/kuovku7ZcclxuICAgKiBAcmV0dXJuc1xyXG4gICAqL1xyXG4gIGdldE1lc3NhZ2VFdmVudHMoKSB7XHJcbiAgICBjb25zdCBsaXN0ID0gW107XHJcbiAgICBjb25zdCBicG1uTW9kZWwgPSB0aGlzLmdyYXBoLmJwbW5Nb2RlbDtcclxuICAgIGNvbnN0IGZsb3dEaWN0ID0gYnBtbk1vZGVsLkRlZmF1bHRQcm9jZXNzLkdldEZsb3dFbGVtZW50cygpO1xyXG4gICAgT2JqZWN0LmtleXMoZmxvd0RpY3QpLmZvckVhY2goKGtleSkgPT4ge1xyXG4gICAgICBjb25zdCBmbG93RWx0ID0gZmxvd0RpY3Rba2V5XTtcclxuICAgICAgaWYgKGZsb3dFbHQuQ2xyVHlwZUlEID09PSAnYnBtbi5NZXNzYWdlRXZlbnQnKSB7XHJcbiAgICAgICAgbGlzdC5wdXNoKGZsb3dFbHQpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICAgIHJldHVybiBsaXN0O1xyXG4gIH1cclxuICAvKipcclxuICAgKiDojrflj5blrZDmtYHnqIvlkozkv6Hlj7fmjZXojrfoioLngrlcclxuICAgKiBAcmV0dXJuc1xyXG4gICAqL1xyXG4gIGdldFN1YkFuZENhdGNoRXZlbnRzKCkge1xyXG4gICAgY29uc3QgbGlzdCA9IFtdO1xyXG4gICAgY29uc3QgYnBtbk1vZGVsID0gdGhpcy5ncmFwaC5icG1uTW9kZWw7XHJcbiAgICBjb25zdCBmbG93RGljdCA9IGJwbW5Nb2RlbC5EZWZhdWx0UHJvY2Vzcy5HZXRGbG93RWxlbWVudHMoKTtcclxuICAgIE9iamVjdC5rZXlzKGZsb3dEaWN0KS5mb3JFYWNoKChrZXkpID0+IHtcclxuICAgICAgY29uc3QgZmxvd0VsdCA9IGZsb3dEaWN0W2tleV07XHJcbiAgICAgIGlmIChmbG93RWx0LkNsclR5cGVJRCA9PT0gJ3dmLkNhbGxBY3Rpdml0eVN1YlByb2Nlc3MnIHx8XHJcbiAgICAgIGZsb3dFbHQuQ2xyVHlwZUlEID09PSAnd2YuSW50ZXJtZWRpYXRlQ2F0Y2hFdmVudEltcGwnKSB7XHJcbiAgICAgICAgbGlzdC5wdXNoKGZsb3dFbHQpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICAgIHJldHVybiBsaXN0O1xyXG4gIH1cclxuICAvKipcclxuICAgKiDojrflj5blkK/liqjmlrnlvI9cclxuICAgKiBAcmV0dXJuc1xyXG4gICAqL1xyXG4gIGdldFN0YXJ0TW9kZSgpIHtcclxuICAgIGxldCBzdGFydE1vZGUgPSBudWxsO1xyXG4gICAgY29uc3QgYnBtbk1vZGVsID0gdGhpcy5ncmFwaC5icG1uTW9kZWw7XHJcbiAgICBjb25zdCBleHRlbmRFbGVtZW50cyA9IGJwbW5Nb2RlbC5EZWZhdWx0UHJvY2Vzcy5HZXRFeHRlbnNpb25FbGVtZW50cygpO1xyXG4gICAgaWYgKGV4dGVuZEVsZW1lbnRzLmxlbmd0aCA+IDApIHtcclxuICAgICAgZm9yIChjb25zdCBlIG9mIGV4dGVuZEVsZW1lbnRzKSB7XHJcbiAgICAgICAgaWYgKGUgaW5zdGFuY2VvZiBQcm9jZXNzSGVhZGVyKSB7XHJcbiAgICAgICAgICBzdGFydE1vZGUgPSBlLnN0YXJ0TW9kZTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBzdGFydE1vZGU7XHJcbiAgfVxyXG59XHJcbiJdfQ==