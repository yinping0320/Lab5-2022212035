/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input, ViewChild, ElementRef, Injector, ComponentFactoryResolver, HostBinding, Output, EventEmitter, TemplateRef, ViewContainerRef, ChangeDetectorRef, Optional, LOCALE_ID, Inject } from '@angular/core';
import { ProcessTime } from './model/process-time';
import { ProcessDesignerUIState } from './app/process-designer.uistate';
import { ProcessDesignerViewModel } from './app/process-designer.viewmodel';
import { ExecuteFormModel, TerminalType } from './views/execute-forms/entities/execute-form.entity';
import { BsModalService } from '@farris/ui-modal';
import { ProcessDesignerDataService } from './domain/process-designer.dataservice';
import { LoadingService } from '@farris/ui-loading';
import { NotifyService } from '@farris/ui-notify';
import { MessagerService } from '@farris/ui-messager';
import { WFFlowElementsViewModel } from './app/wf-flowElements.viewModel';
import { PropertyPanelComponent, ShowMode } from '@farris/ide-property-panel';
import { SignRuleComponent } from './views/sign-rule/sign-rule.component';
import { ProcessInfo } from './model/process-info';
import { RTProcessInfo } from './model/rt-process-info';
import { forkJoin, of } from 'rxjs';
import { AuditEvent } from './domain/entities/audit-processDef-info';
import { NoteComponent } from './views/note/note.component';
import { ProcessDeUtil } from './domain/process-de-util';
import { EventBusService } from './views/shared/event-bus.service';
import { VerifyDetailService } from '@farris/ui-verify-detail';
import { AssignScopeComponent } from './views/assign-scope/assign-scope.component';
import { WfEditorUi } from './designer/WfEditorUi';
import { PmfEvents } from "@edp-pmf/grapheditor";
import { BpmnModel } from "@edp-pmf/bpmn-model";
import { mxEvent } from "@edp-pmf/mxgraph-ts";
import { WfValidatorAdapter } from "./designer/WfValidatorAdapter";
import { ProcessHeader, StartMode } from "@gsp-wf/wf-process-model";
import { EventBusKeys } from './model/event-bus-keys';
import { ProcessPropertyKeys } from './designer/wf-cell/property-keys/ProcessPropertyKeys';
import { UserActivityPropertyKeys } from './designer/wf-cell/property-keys/UserActivityPropertyKeys';
import { MessageActivityPropertyKeys } from './designer/wf-cell/property-keys/MessageActivityPropertyKeys';
import { NotifyActivityPropertyKeys } from './designer/wf-cell/property-keys/NotifyActivityPropertyKeys';
import { delay, switchMap } from 'rxjs/operators';
import { WF_LANG_RESOURCES, WfLocalePipe } from './i18n/pipe/wf-process-editor-locale.pipe';
import { WF_PROCESS_EDITOR_LANG_RESOURCES } from './i18n/assets/lang.resource';
import { BatchSetPropertiesComponent } from './views/batch-set-properties/batch-set-properties.component';
const ɵ0 = WF_PROCESS_EDITOR_LANG_RESOURCES;
export class WfProcessEditorComponent {
    /**
     * @param {?} uiState
     * @param {?} viewModel
     * @param {?} service
     * @param {?} loadService
     * @param {?} notify
     * @param {?} message
     * @param {?} activity
     * @param {?} injector
     * @param {?} modalService
     * @param {?} resolver
     * @param {?} eventBus
     * @param {?} cdr
     * @param {?} localeId
     * @param {?} resources
     * @param {?} localePipe
     */
    constructor(uiState, viewModel, service, loadService, notify, message, activity, injector, modalService, resolver, eventBus, cdr, localeId, resources, localePipe) {
        this.uiState = uiState;
        this.viewModel = viewModel;
        this.service = service;
        this.loadService = loadService;
        this.notify = notify;
        this.message = message;
        this.activity = activity;
        this.injector = injector;
        this.modalService = modalService;
        this.resolver = resolver;
        this.eventBus = eventBus;
        this.cdr = cdr;
        this.localeId = localeId;
        this.resources = resources;
        this.localePipe = localePipe;
        this.flag = true;
        this.cls = 'farris-main-area flex-column';
        this.action = 'edit';
        this.mode = 'general';
        this.procType = "wf";
        this.close = new EventEmitter();
        this.errorList = [];
        this.tabTypeList = [
            {
                id: 'processWarning',
                type: 'processWarning',
                title: this.localePipe.instant("processEditor.tip"),
                iconCls: 'f-icon-default',
                iconStyle: 'color:#f49730;'
            }
        ];
        this.panelWidth = 330;
        this.propertyPanelResizable = true;
        this.rightPanelWidth = 330; // 右侧面板宽度
        // localeId: string = "zh-CHS";
        /**
         * 界面是否发生变化标志，修改属性、移动节点等均会将此值设为true
         */
        this.changedFlag = false;
        this.showModelButton = false;
        this.localePipe = this.localePipe || new WfLocalePipe(localeId, resources);
        this.cdr = this.cdr || this.injector.get(ChangeDetectorRef, null);
        this.verifySer = this.injector.get(VerifyDetailService);
        this.localeId = this.injector.get(LOCALE_ID, null) || this.localeId;
        WfValidatorAdapter.localePipe = this.localePipe;
        forkJoin(this.uiState.getEnableAdminOrgAut(), this.uiState.getEnableFlowFormAut()).subscribe((/**
         * @param {?} re
         * @return {?}
         */
        re => {
            this.uiState.enableAdminOrgAut = re[0];
            this.uiState.enableFlowFormAut = re[1];
            if (!this.uiState.enableAdminOrgAut) {
                this.uiState.getAdministratorInfo();
            }
        }));
    }
    /**
     * @param {?} t
     * @return {?}
     */
    set time(t) {
        this._time = t;
        this.uiState.time = t;
    }
    /**
     * @return {?}
     */
    get time() {
        return this._time;
    }
    /**
     * @param {?} v
     * @return {?}
     */
    set scene(v) {
        this.uiState.scene = v;
    }
    /**
     * @return {?}
     */
    get scene() {
        return this.uiState.scene;
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        this.procNameTitle = this.processInfo ? this.processInfo.processName : this.rtProcessInfo.procName;
        if (this.rtProcessInfo && this.rtProcessInfo.rtProcDefId) {
            this.uiState.procDefId = this.rtProcessInfo.rtProcDefId;
        }
        this.addEventBusListener();
        this.uiState.initUIState();
        this.showLoading();
        this.addPropertyChangedHandler();
        // 获取消息列表
        this.uiState.getMessageChannels();
        focus();
        document.body.addEventListener('keydown', (/**
         * @param {?} n
         * @return {?}
         */
        (n) => {
            if (!this.showModelButton && n.shiftKey && 'Slash' === n.code) {
                this.showModelButton = true;
                this.notify.success(this.localePipe.transform("processEditor.showButton"));
                this.viewProcModel();
            }
        }));
        this.cdr && this.cdr.detectChanges();
        this.createEditorUi();
    }
    /**
     * @return {?}
     */
    createEditorUi() {
        this.service.getGeneralConfig().subscribe((/**
         * @param {?} generalConfig
         * @return {?}
         */
        (generalConfig) => {
            /** @type {?} */
            const processCategoryId = this._time === ProcessTime.rt ? this.rtProcessInfo.flowFormId : this.processInfo.flowFormId;
            this.viewModel.getProcessCategory(processCategoryId).subscribe((/**
             * @param {?} procCategory
             * @return {?}
             */
            (procCategory) => {
                /** @type {?} */
                const bizCategoryId = this._time === ProcessTime.dt ? procCategory.businessObjectId : undefined;
                this.service.getFormFormat(bizCategoryId).pipe(switchMap((/**
                 * @param {?} formFormats
                 * @return {?}
                 */
                (formFormats) => {
                    this.cdr && this.cdr.detectChanges();
                    this.editorUi = new WfEditorUi(this._time, this.action, this.editorUiContainerER.nativeElement, this.injector, this.modalService, this.resolver);
                    this.editorUi.multiLangEnabled = true;
                    this.editorUi.langCode = this.localeId;
                    this.editorUi.bizCategoryId = bizCategoryId;
                    this.editorUi.mode = this.mode;
                    this.editorUi.scene = this.uiState.scene;
                    this.editorUi.procType = this.procType;
                    this.editorUi.generalConfig = generalConfig;
                    this.editorUi.formFormats = formFormats;
                    return of({});
                })))
                    // 2023-5-30 为了解决网络较差场景下的加载问题修改了加载顺序
                    .pipe(delay(200))
                    .subscribe((/**
                 * @return {?}
                 */
                () => {
                    this.openProcContent();
                }));
            }));
        }));
    }
    /**
     * @param {?} editorUi
     * @return {?}
     */
    addEditorUiListeners(editorUi) {
        editorUi.addListener(PmfEvents.ShowProperty, (/**
         * @param {?} sender
         * @param {?} evt
         * @return {?}
         */
        (sender, evt) => {
            /** @type {?} */
            const cells = evt.getProperty("cells");
            this.viewModel.setProperty(this.editorUi.getFarrisPropConfig(cells));
        }));
        // 工具箱节点拖动至画布后更新
        editorUi.graph.addListener(PmfEvents.CellsInserted, (/**
         * @param {?} sender
         * @param {?} evt
         * @return {?}
         */
        (sender, evt) => {
            this.uiState.getUserActList(this.editorUi.getActivities());
            this.uiState.getNotifyEventList(this.editorUi.getNotifyEvents());
            this.uiState.getEndEventList(this.editorUi.getEndEvents());
        }));
        // 删除节点时触发更新
        editorUi.graph.addListener(mxEvent.CELLS_REMOVED, (/**
         * @return {?}
         */
        () => {
            this.uiState.getUserActList(this.editorUi.getActivities());
            this.uiState.getNotifyEventList(this.editorUi.getNotifyEvents());
            this.uiState.getEndEventList(this.editorUi.getEndEvents());
        }));
    }
    /**
     * 添加事件总线监听
     * @private
     * @return {?}
     */
    addEventBusListener() {
        this.eventBus.on(EventBusKeys.batchCopyProperty, (/**
         * @param {?} data
         * @return {?}
         */
        data => {
            if (data) {
                this.editorUi.batchCopyProperty(data);
            }
        }));
        this.eventBus.on(EventBusKeys.batchSetProperty, (/**
         * @param {?} data
         * @return {?}
         */
        data => {
            if (data) {
                this.editorUi.batchSetProperty(data);
            }
        }));
    }
    /**
     * @private
     * @return {?}
     */
    addPropertyChangedHandler() {
        this.propertyPanel.propertyChanged.subscribe((/**
         * @param {?} data
         * @return {?}
         */
        (data) => {
            this.updateChangeProperty(data);
        }));
        this.propertyPanel.submitModal.subscribe((/**
         * @param {?} data
         * @return {?}
         */
        (data) => {
            this.updateChangeProperty(data.changeObject, data.parameters);
        }));
        return false; // 防止冒泡
    }
    /**
     * 更新属性
     * @private
     * @param {?} data
     * @param {?=} parameters
     * @return {?}
     */
    updateChangeProperty(data, parameters = null) {
        // 更新界面变更状态
        this.changedFlag = false;
        data.Id = this.uiState.propertyData.Id;
        if (parameters) {
            data.parameters = parameters;
        }
        switch (data.propertyID) {
            case ProcessPropertyKeys.EntryForm:
                this.bindEntryFormInfo(data);
                break;
            case UserActivityPropertyKeys.ApprovalItems:
                this.editorUi.updateProperty(data);
                this.activity.buildCounterSignVariables(data.propertyValue);
                break;
            case UserActivityPropertyKeys.CompleteStrategy:
                this.beforeCompleteStrategyChange(data).subscribe((/**
                 * @param {?} b
                 * @return {?}
                 */
                b => {
                    if (b) {
                        this.editorUi.updateProperty(data);
                        this.completeStrategyChanged(data.propertyValue);
                    }
                    this.viewModel.setProperty(this.editorUi.refreshProperty(data));
                }));
                break;
            // todo：多个活动具有同名属性时，如何更合理定义PropertyKey？
            // case UserActivityPropertyKeys.otherAssignNodes:
            // case StartActivityPropertyKeys.otherAssignNodes:
            //   if (data.propertyValue) {
            //     this.editorUi.updateProperty(data);
            //     this.OtherAssignNodesChanged(data);
            //   } else {
            //     this.editorUi.updateProperty(data);
            //   }
            //   break;
            case UserActivityPropertyKeys.SignRule:
                this.editorUi.updateProperty(data);
                break;
            // todo：多个活动具有同名属性时，如何更合理定义PropertyKey？
            case ProcessPropertyKeys.messageNotice: // 消息通知
            case UserActivityPropertyKeys.messageNotice: // 消息通知
            case MessageActivityPropertyKeys.messageNotice: // 消息通知
            case NotifyActivityPropertyKeys.messageNotice: // 消息通知
                if (data.propertyValue.isBatchCopy) { // 是否是消息通知属性批量复制
                    this.editorUi.batchCopyProperty(data);
                    break;
                }
                this.editorUi.updateProperty(data);
                break;
            case ProcessPropertyKeys.startMode:
                this.updateStartMode(data);
                break;
            default:
                this.editorUi.updateProperty(data);
                break;
        }
        this.uiState.getUserActList(this.editorUi.getActivities());
        this.uiState.getEndEventList(this.editorUi.getEndEvents());
        this.uiState.getNotifyEventList(this.editorUi.getNotifyEvents());
        this.uiState.getStartMode(this.editorUi.getStartMode());
        if (this.editorUi.getStartMode() == StartMode.SUB_PROCESS) {
            this.uiState.subActivityContext = this.uiState.subActivityContext.concat(this.uiState.subProcessElementContext);
        }
        else {
            this.uiState.subActivityContext = this.uiState.subActivityContext.filter((/**
             * @param {?} x
             * @return {?}
             */
            x => this.uiState.subProcessElementContext.some((/**
             * @param {?} y
             * @return {?}
             */
            y => y.key != x.key))));
        }
        this.viewModel.setProperty(this.editorUi.refreshProperty(data));
    }
    /**
     * 绑定流程分类的参数列表，流程构件，表单赋值
     * @private
     * @param {?} data
     * @return {?}
     */
    bindEntryFormInfo(data) {
        /** @type {?} */
        const flowformId = data.propertyValue.id;
        if (flowformId) {
            this.viewModel.getFlowFormInfoById(flowformId).subscribe((/**
             * @param {?} info
             * @return {?}
             */
            (info) => {
                data.flowForm = info.flowForm;
                data.formalParameters = info.formalParameters;
                data.processBizComponnets = info.bizComponents;
                data.executeForms = [];
                info.excuteForms.forEach((/**
                 * @param {?} form
                 * @return {?}
                 */
                form => {
                    if (form.isDefault) {
                        // 流程绑定默认单据
                        /** @type {?} */
                        const executeForms = this.ConvertExecuteForm(form);
                        data.executeForms = data.executeForms.concat(executeForms);
                    }
                }));
                data.customizeActions = info.customizeActions.filter((/**
                 * @param {?} a
                 * @return {?}
                 */
                a => a.isAll === true)).map((/**
                 * @param {?} a
                 * @return {?}
                 */
                a => ({
                    id: a.id, code: a.code, name: a.name, terminalType: a.terminal,
                    actualParameters: a.actualParameters.map((/**
                     * @param {?} p
                     * @return {?}
                     */
                    p => ({
                        Name: p.code, Value: p.value, ValueText: p.name, Tag: 'expression'
                    })))
                })));
                // 加载业务活动面板
                this.editorUi.loadBizActivities(info.bizActivities || []);
                this.service.getBizCmp().subscribe((/**
                 * @param {?} cmps
                 * @return {?}
                 */
                (cmps) => {
                    data.bizCmps = cmps;
                    this.editorUi.updateProperty(data);
                    this.uiState.getUserActList(this.editorUi.getActivities());
                    this.uiState.getEndEventList(this.editorUi.getEndEvents());
                    this.uiState.getNotifyEventList(this.editorUi.getNotifyEvents());
                    this.uiState.getStartMode(this.editorUi.getStartMode());
                    if (this.editorUi.getStartMode() == StartMode.SUB_PROCESS) {
                        this.uiState.subActivityContext = this.uiState.subActivityContext.concat(this.uiState.subProcessElementContext);
                    }
                    else {
                        this.uiState.subActivityContext = this.uiState.subActivityContext.filter((/**
                         * @param {?} x
                         * @return {?}
                         */
                        x => this.uiState.subProcessElementContext.some((/**
                         * @param {?} y
                         * @return {?}
                         */
                        y => y.key != x.key))));
                    }
                    this.viewModel.setProperty(this.editorUi.refreshProperty(data));
                }));
            }));
        }
    }
    /**
     * @param {?} data
     * @return {?}
     */
    updateStartMode(data) {
        /** @type {?} */
        const bpmnModel = this.editorUi.graph.bpmnModel;
        /** @type {?} */
        const extendElements = bpmnModel.DefaultProcess.GetExtensionElements();
        if (extendElements !== null && extendElements.length > 0) {
            /** @type {?} */
            const procHeader = (/** @type {?} */ (extendElements.filter((/**
             * @param {?} e
             * @return {?}
             */
            e => e instanceof ProcessHeader))));
            /** @type {?} */
            let flowFormKey = procHeader[0].BizDefKey;
            this.service.getAllBizCmp(flowFormKey).subscribe((/**
             * @param {?} allBizCmps
             * @return {?}
             */
            (allBizCmps) => {
                this.service.getBizCmp().subscribe((/**
                 * @param {?} bizCmps
                 * @return {?}
                 */
                (bizCmps) => {
                    data.allBizCmps = allBizCmps;
                    data.bizCmps = bizCmps;
                    this.editorUi.updateProperty(data);
                    this.uiState.getUserActList(this.editorUi.getActivities());
                    this.uiState.getEndEventList(this.editorUi.getEndEvents());
                    this.uiState.getStartMode(this.editorUi.getStartMode());
                    if (this.editorUi.getStartMode() == StartMode.SUB_PROCESS) {
                        this.uiState.subActivityContext = this.uiState.subActivityContext.concat(this.uiState.subProcessElementContext);
                    }
                    else {
                        this.uiState.subActivityContext = this.uiState.subActivityContext.filter((/**
                         * @param {?} x
                         * @return {?}
                         */
                        x => this.uiState.subProcessElementContext.some((/**
                         * @param {?} y
                         * @return {?}
                         */
                        y => y.key != x.key))));
                    }
                    this.viewModel.setProperty(this.editorUi.refreshProperty(data));
                }));
            }));
        }
    }
    /**
     * @private
     * @param {?} record
     * @return {?}
     */
    note(record) {
        /** @type {?} */
        const compFactory = this.resolver.resolveComponentFactory(NoteComponent);
        /** @type {?} */
        const compRef = compFactory.create(this.injector);
        compRef.instance.record = record;
        /** @type {?} */
        const modalConfig = {
            title: this.localePipe.transform("processEditor.changeRecord"),
            width: 800,
            height: 520,
            showButtons: true,
            buttons: compRef.instance.footer
        };
        /** @type {?} */
        const dialog = this.modalService.show(compRef, modalConfig);
        compRef.instance.cancel.subscribe((/**
         * @param {?} $event
         * @return {?}
         */
        $event => dialog.close()));
        compRef.instance.submit.subscribe((/**
         * @param {?} data
         * @return {?}
         */
        (data) => {
            // 更新流程记录
            this.editorUi.graph.bpmnModel.DefaultProcess.Documentation = data;
            dialog.close();
        }));
    }
    /**
     * @private
     * @return {?}
     */
    openProcContent() {
        if (this.time === ProcessTime.dt) {
            if (this.processInfo) {
                if (this.processInfo.processKey === EventBusKeys.new && this.processInfo.flowFormId) {
                    this.openNewProcess(this.processInfo.flowFormId);
                }
                else {
                    // TODO：首先获取流程分类信息，确保流程分类和流程构件获取到（会稍微影响设计器打开速度）
                    this.viewModel.getFlowFormInfoById(this.processInfo.flowFormId).subscribe((/**
                     * @param {?} info
                     * @return {?}
                     */
                    (info) => {
                        this.editorUi.loadBizActivities(info.bizActivities || []);
                        this.getProcContent(this.processInfo.processKey).subscribe((/**
                         * @param {?} re
                         * @return {?}
                         */
                        re => {
                            this.uiState.content = this.checkModelContent(JSON.stringify(re));
                            this.openProcess(this.uiState.content);
                        }));
                    }));
                }
            }
            else {
                throw new Error(this.localePipe.transform("processEditor.noDtInfo"));
            }
        }
        else if (this.time === ProcessTime.rt) {
            if (this.rtProcessInfo) {
                this.viewModel.getFlowFormInfoById(this.rtProcessInfo.flowFormId).subscribe((/**
                 * @param {?} info
                 * @return {?}
                 */
                (info) => {
                    this.editorUi.loadBizActivities(info.bizActivities || []);
                    this.getProcContent(this.rtProcessInfo.rtProcDefId).subscribe((/**
                     * @param {?} re
                     * @return {?}
                     */
                    re => {
                        this.uiState.content = this.checkModelContent(JSON.stringify(re));
                        this.openProcess(this.uiState.content);
                    }));
                }));
            }
            else {
                throw new Error(this.localePipe.transform("processEditor.noRtInfo"));
            }
        }
    }
    /**
     * 新增流程，基于流程分类获取参数列表，构件和表单
     * @param {?} ffId 流程分类ID
     * @return {?}
     */
    openNewProcess(ffId) {
        this.viewModel.getFlowFormInfoById(ffId).subscribe((/**
         * @param {?} info
         * @return {?}
         */
        (info) => {
            /** @type {?} */
            const processBizComponnets = info.bizComponents;
            /** @type {?} */
            const customizeActions = info.customizeActions.filter((/**
             * @param {?} a
             * @return {?}
             */
            a => a.isAll === true)).map((/**
             * @param {?} a
             * @return {?}
             */
            a => ({
                id: a.id, code: a.code, name: a.name, terminalType: a.terminal,
                actualParameters: a.actualParameters.map((/**
                 * @param {?} p
                 * @return {?}
                 */
                p => ({
                    Name: p.code, Value: p.value, ValueText: p.name, Tag: 'expression'
                })))
            })));
            /** @type {?} */
            let executeForms = [];
            info.excuteForms.forEach((/**
             * @param {?} form
             * @return {?}
             */
            form => {
                if (form.isDefault) {
                    // 流程绑定默认单据
                    /** @type {?} */
                    const forms = this.ConvertExecuteForm(form);
                    executeForms = executeForms.concat(forms);
                }
            }));
            // 如果不存在表单定义，需要去表单格式列表取一下
            if (executeForms.length === 0
                || executeForms.findIndex((/**
                 * @param {?} e
                 * @return {?}
                 */
                e => e.TerminalType === TerminalType.PC)) === -1
                || executeForms.findIndex((/**
                 * @param {?} e
                 * @return {?}
                 */
                e => e.TerminalType === TerminalType.MOBILE)) === -1) {
                this.viewModel.getFormFormatsByBizCategory().subscribe((/**
                 * @param {?} formFormats
                 * @return {?}
                 */
                (formFormats) => {
                    if (formFormats && formFormats.length > 0) {
                        if (executeForms.findIndex((/**
                         * @param {?} e
                         * @return {?}
                         */
                        e => e.TerminalType === TerminalType.PC)) === -1) {
                            /** @type {?} */
                            const formFormat = formFormats.filter((/**
                             * @param {?} f
                             * @return {?}
                             */
                            f => f.terminal === 'PC' && f.status === 0))[0];
                            if (formFormat) {
                                executeForms.push(this.formFormat2ExecuteForm(formFormat));
                            }
                        }
                        if (executeForms.findIndex((/**
                         * @param {?} e
                         * @return {?}
                         */
                        e => e.TerminalType === TerminalType.MOBILE)) === -1) {
                            /** @type {?} */
                            const formFormat = formFormats.filter((/**
                             * @param {?} f
                             * @return {?}
                             */
                            f => f.terminal === 'Mobile' && f.status === 0))[0];
                            if (formFormat) {
                                executeForms.push(this.formFormat2ExecuteForm(formFormat));
                            }
                        }
                    }
                    /** @type {?} */
                    const newProcInfo = {
                        name: this.processInfo.processName,
                        bizObjId: this.processInfo.bizObjId,
                        ffId: ffId,
                        ffName: this.processInfo.flowFormName,
                        startMode: this.processInfo.startMode,
                        formalParameters: info.formalParameters,
                        processBizComponnets: processBizComponnets,
                        executeForms: executeForms,
                        customizeActions: customizeActions,
                        processDescription: info.flowForm.processDescription,
                    };
                    this.createBpmnModel(info.bizActivities || [], newProcInfo);
                }));
            }
            else {
                /** @type {?} */
                const newProcInfo = {
                    name: this.processInfo.processName,
                    bizObjId: this.processInfo.bizObjId,
                    ffId: ffId,
                    ffName: this.processInfo.flowFormName,
                    startMode: this.processInfo.startMode,
                    formalParameters: info.formalParameters,
                    processBizComponnets: processBizComponnets,
                    executeForms: executeForms,
                    customizeActions: customizeActions,
                    processDescription: info.flowForm.processDescription,
                };
                this.createBpmnModel(info.bizActivities || [], newProcInfo);
            }
        }));
    }
    /**
     * @param {?} bizActivities
     * @param {?} newProcInfo
     * @return {?}
     */
    createBpmnModel(bizActivities, newProcInfo) {
        this.service.getBizCmp().subscribe((/**
         * @param {?} cmps
         * @return {?}
         */
        (cmps) => {
            // 2023-5-30 为了解决网络较差场景下的加载问题修改了加载顺序 先加载数据再showeditorUi
            this.editorUi.show();
            this.addEditorUiListeners(this.editorUi);
            this.editorUi.loadBizActivities(bizActivities || []);
            this.editorUi.createBpmnModel(newProcInfo, cmps);
            this.service.getProcExtendProperty(newProcInfo.BizDefKey, newProcInfo.startMode, this.editorUi.bizCategoryId).subscribe((/**
             * @param {?} property
             * @return {?}
             */
            (property) => {
                /** @type {?} */
                const props = [];
                property.forEach((/**
                 * @param {?} p
                 * @return {?}
                 */
                p => {
                    if ((p.bizCategoryId || p.bizDefKey) && ((p.bizCategoryId.indexOf(this.editorUi.bizCategoryId) != -1 || p.bizCategoryId === '*') ||
                        (p.bizDefKey.indexOf(newProcInfo.BizDefKey) != -1 || p.bizDefKey === '*')) &&
                        (p.startMode.indexOf(newProcInfo.startMode) != -1 || p.startMode === '*')) {
                        props.push(p);
                    }
                }));
                this.editorUi.procExtProps = props;
                if (this.flag) {
                    this.flag = false;
                    this.closeLoading();
                }
                // 显示流程属性
                this.viewModel.initProcessProperty(this.editorUi.getFarrisPropConfig());
                // 获取启动方式
                this.uiState.getStartMode(this.editorUi.getStartMode());
                if (this.editorUi.getStartMode() == StartMode.SUB_PROCESS) {
                    this.uiState.subActivityContext = this.uiState.subActivityContext.concat(this.uiState.subProcessElementContext);
                }
                else {
                    this.uiState.subActivityContext = this.uiState.subActivityContext.filter((/**
                     * @param {?} x
                     * @return {?}
                     */
                    x => this.uiState.subProcessElementContext.some((/**
                     * @param {?} y
                     * @return {?}
                     */
                    y => y.key != x.key))));
                }
                this.uiState.bpmnModel = this.editorUi.graph.bpmnModel;
                this.addGraphModelChangedListener();
            }));
        }));
    }
    /**
     * @param {?} content
     * @return {?}
     */
    openProcess(content) {
        // 取ProcessHeader
        /** @type {?} */
        const model = new BpmnModel();
        model.LoadFromJson(content);
        /** @type {?} */
        const processHeader = ((/** @type {?} */ (model.DefaultProcess.GetExtensionElements().filter((/**
         * @param {?} e
         * @return {?}
         */
        e => e instanceof ProcessHeader))[0])));
        this.service.getProcExtendProperty(processHeader.BizDefKey, processHeader.startMode, this.editorUi.bizCategoryId).subscribe((/**
         * @param {?} property
         * @return {?}
         */
        (property) => {
            /** @type {?} */
            const props = [];
            property.forEach((/**
             * @param {?} p
             * @return {?}
             */
            p => {
                if ((p.bizCategoryId || p.bizDefKey) && ((p.bizCategoryId.indexOf(this.editorUi.bizCategoryId) != -1 || p.bizCategoryId === '*') ||
                    (p.bizDefKey.indexOf(processHeader.BizDefKey) != -1 || p.bizDefKey === '*')) &&
                    (p.startMode.indexOf(processHeader.startMode) != -1 || p.startMode === '*')) {
                    props.push(p);
                }
            }));
            this.editorUi.procExtProps = props;
            // 2023-5-30 为了解决网络较差场景下的加载问题修改了加载顺序 先加载数据再showeditorUi
            this.editorUi.show();
            this.addEditorUiListeners(this.editorUi);
            this.editorUi.openBpmnModel(content);
            if (this.flag) {
                this.flag = false;
                this.closeLoading();
            }
            // 显示流程属性
            this.viewModel.initProcessProperty(this.editorUi.getFarrisPropConfig());
            // 打开时获取所有活动节点信息
            this.uiState.getUserActList(this.editorUi.getActivities());
            // 打开时获取所有结束节点信息
            this.uiState.getEndEventList(this.editorUi.getEndEvents());
            // 打开时获取所有知会节点信息
            this.uiState.getNotifyEventList(this.editorUi.getNotifyEvents());
            // 打开时获取所有消息节点信息
            this.uiState.getMessageEventList(this.editorUi.getMessageEvents());
            // 打开时获取所有子流程和信号捕获节点信息
            this.uiState.getSubAndCatchEventsList(this.editorUi.getSubAndCatchEvents());
            this.uiState.bpmnModel = this.editorUi.graph.bpmnModel;
            // 获取启动方式
            this.uiState.getStartMode(this.editorUi.getStartMode());
            if (this.editorUi.getStartMode() == StartMode.SUB_PROCESS) {
                this.uiState.subActivityContext = this.uiState.subActivityContext.concat(this.uiState.subProcessElementContext);
            }
            else {
                this.uiState.subActivityContext = this.uiState.subActivityContext.filter((/**
                 * @param {?} x
                 * @return {?}
                 */
                x => this.uiState.subProcessElementContext.some((/**
                 * @param {?} y
                 * @return {?}
                 */
                y => y.key != x.key))));
            }
            this.addGraphModelChangedListener();
        }));
    }
    /**
     * 添加graph model监听器，有变化则将changedFlag
     * @return {?}
     */
    addGraphModelChangedListener() {
        // 监听画布变化，更新界面变更状态
        /** @type {?} */
        const changedListener = (/**
         * @return {?}
         */
        () => {
            this.changedFlag = false;
        });
        this.editorUi.graph.model.addListener(mxEvent.CHANGE, changedListener);
    }
    /**
     * @private
     * @param {?} data
     * @return {?}
     */
    showTip(data) {
        if (data.type === 'message') {
            switch (data.level) {
                case 'warning':
                    this.message.warning(data.message);
                    break;
                case 'error':
                    this.message.error(data.message);
                    break;
                case 'question':
                    this.message.question(data.message, (/**
                     * @return {?}
                     */
                    () => {
                        this.questionOKHandle(data);
                    }));
                    break;
                default:
                    this.message.info(data.message);
                    break;
            }
        }
        else if (data.type === 'notify') {
            switch (data.level) {
                case 'warning':
                    this.notify.warning(data.message);
                    break;
                case 'error':
                    this.notify.error(data.message);
                    break;
                default:
                    this.notify.info(data.message);
                    break;
            }
        }
    }
    /**
     * @private
     * @param {?} data
     * @return {?}
     */
    showVerify(data) {
        this.errorList = data;
        this.createValidationTips();
    }
    /**
     * @private
     * @param {?} data
     * @return {?}
     */
    questionOKHandle(data) {
        switch (data.action) {
        }
    }
    /**
     * 获取流程上下文
     * @param {?} id 流程定义ID（设计时使用流程定义Key，运行时使用流程定义ID）
     * @return {?}
     */
    getProcContent(id) {
        if (id) {
            if (this.time === ProcessTime.dt) {
                return this.service.getProcContentbyKey(id);
            }
            else if (this.time === ProcessTime.rt) {
                return this.service.getRTProcContentbyId(id);
            }
            else {
                throw new Error(this.localePipe.transform("processEditor.wrongMoment"));
            }
        }
    }
    /**
     * @private
     * @param {?} content
     * @return {?}
     */
    save(content) {
        this.uiState.content = content;
        this.showLoading();
        /** @type {?} */
        const process = JSON.parse(this.uiState.content);
        this.saveHttp().subscribe((/**
         * @param {?} data
         * @return {?}
         */
        (data) => {
            this.closeLoading();
            // 2023-6-13 保存后同步流程名称到标题栏
            this.procNameTitle = process.DefaultProcess.Name;
            this.notify.success((/** @type {?} */ ({
                title: this.localePipe.transform("processEditor.prompted"),
                msg: this.localePipe.transform("processEditor.saveSuccess"),
                timeout: 3000
            })));
            if (this.time === ProcessTime.dt) {
                this.viewModel.auditProcessDef(AuditEvent.WF_ProcessDef_SaveDT, true, process.DefaultProcess.Key);
            }
            else if (this.time === ProcessTime.rt) {
                this.viewModel.auditProcessDef(AuditEvent.WF_ProcessDef_SaveRT, true, process.DefaultProcess.Key);
            }
            // 重置界面变更状态
            this.changedFlag = false;
        }), (/**
         * @param {?} error
         * @return {?}
         */
        (error) => {
            this.closeLoading();
            this.notify.error((/** @type {?} */ ({
                title: this.localePipe.transform("processEditor.prompted"),
                msg: error.error.Message,
                timeout: 3000
            })));
            if (this.time === ProcessTime.dt) {
                this.viewModel.auditProcessDef(AuditEvent.WF_ProcessDef_SaveDT, false, process.DefaultProcess.Key);
            }
            else if (this.time === ProcessTime.rt) {
                this.viewModel.auditProcessDef(AuditEvent.WF_ProcessDef_SaveRT, false, process.DefaultProcess.Key);
            }
        }));
    }
    /**
     * @private
     * @param {?} content
     * @return {?}
     */
    release(content) {
        this.uiState.content = content;
        this.showLoading();
        this.uiState.getReleaseConfig().subscribe((/**
         * @param {?} config
         * @return {?}
         */
        (config) => {
            if (config.currentValue === 'true') {
                // 展示发布前审批页面，同时保存，记审计
                this.viewModel.saveProcess(this.uiState.content, this.processInfo, 1).subscribe((/**
                 * @param {?} re
                 * @return {?}
                 */
                (re) => {
                    this.viewModel.getProcDefsByKey(JSON.parse(content).DefaultProcess.Key).subscribe((/**
                     * @param {?} ProcDefs
                     * @return {?}
                     */
                    (ProcDefs) => {
                        /** @type {?} */
                        const maxVersion = Math.max.apply(Math, ProcDefs.map((/**
                         * @param {?} item
                         * @return {?}
                         */
                        function (item) {
                            return item.version << 0;
                        })));
                        // 展示发布前审批页面，同时保存，记审计
                        this.viewModel.releaseProcess(content, maxVersion === -Infinity ? 1 : maxVersion);
                        this.closeLoading();
                    }));
                }));
                this.notify.success((/** @type {?} */ ({
                    title: this.localePipe.transform("processEditor.prompted"),
                    msg: this.localePipe.transform("processEditor.waitReview"),
                    timeout: 3000
                })));
                /** @type {?} */
                const process = JSON.parse(this.uiState.content);
                this.viewModel.auditProcessDef(AuditEvent.WF_ProcessDef_Deploy, true, process.DefaultProcess.Key);
            }
            else {
                this.viewModel.deployProcess(this.uiState.content).subscribe((/**
                 * @param {?} data
                 * @return {?}
                 */
                (data) => {
                    this.closeLoading();
                    this.viewModel.saveProcess(this.uiState.content, this.processInfo, 0).subscribe((/**
                     * @param {?} r
                     * @return {?}
                     */
                    (r) => { }));
                    this.notify.success((/** @type {?} */ ({
                        title: this.localePipe.transform("processEditor.prompted"),
                        msg: this.localePipe.transform("processEditor.successPublish"),
                        timeout: 3000
                    })));
                    /** @type {?} */
                    const process = JSON.parse(this.uiState.content);
                    this.viewModel.auditProcessDef(AuditEvent.WF_ProcessDef_Deploy, true, process.DefaultProcess.Key);
                }), (/**
                 * @param {?} e
                 * @return {?}
                 */
                (e) => {
                    this.closeLoading();
                    this.notify.error((/** @type {?} */ ({
                        title: this.localePipe.transform("processEditor.prompted"),
                        msg: this.localePipe.transform("processEditor.publishFail") + `${e.error.Message}`,
                        timeout: 3000
                    })));
                    /** @type {?} */
                    const process = JSON.parse(this.uiState.content);
                    this.viewModel.auditProcessDef(AuditEvent.WF_ProcessDef_Deploy, false, process.DefaultProcess.Key);
                }));
            }
        }));
    }
    /**
     * 保存流程定义（设计时+运行时）
     * @private
     * @return {?}
     */
    saveHttp() {
        if (this.uiState.content) {
            if (this.time === ProcessTime.dt) {
                return this.viewModel.saveProcess(this.uiState.content, this.processInfo, 1);
            }
            else if (this.time === ProcessTime.rt) {
                return this.viewModel.saveRTProcess(this.uiState.content, this.rtProcessInfo.rtProcDefId);
            }
            else {
                throw new Error(this.localePipe.transform("processEditor.wrongMoment"));
            }
        }
    }
    /**
     * @return {?}
     */
    showLoading() {
        this.loadService.show({ container: 'body', message: '', type: 1 });
    }
    /**
     * @return {?}
     */
    closeLoading() {
        this.loadService.close();
    }
    /**
     * @private
     * @param {?} form
     * @return {?}
     */
    ConvertExecuteForm(form) {
        /** @type {?} */
        const executeForms = new Array();
        if (form.terminal === 'web,app') {
            /** @type {?} */
            const webForm = new ExecuteFormModel();
            webForm.ComponentId = form.appId;
            webForm.formFormatId = form.formFormatId;
            webForm.FormType = form.formType;
            webForm.Name = form.name;
            webForm.TerminalType = TerminalType.PC;
            if (form.actualParameters && form.actualParameters.length > 0) {
                webForm.ActualParameters = form.actualParameters.map((/**
                 * @param {?} p
                 * @return {?}
                 */
                p => ({
                    Name: p.code,
                    Value: p.value
                })));
            }
            executeForms.push(webForm);
            /** @type {?} */
            const appForm = new ExecuteFormModel();
            appForm.ComponentId = form.appId;
            appForm.formFormatId = form.formFormatId;
            appForm.FormType = form.formType;
            appForm.Name = form.name;
            appForm.TerminalType = TerminalType.MOBILE;
            if (form.actualParameters && form.actualParameters.length > 0) {
                appForm.ActualParameters = form.actualParameters.map((/**
                 * @param {?} p
                 * @return {?}
                 */
                (p) => ({
                    Name: p.code,
                    Tag: p.valueType ? p.valueType : ProcessDeUtil.initVariableType(p.value),
                    Value: p.value
                })));
            }
            executeForms.push(appForm);
        }
        else {
            /** @type {?} */
            const executeForm = new ExecuteFormModel();
            executeForm.ComponentId = form.appId;
            executeForm.formFormatId = form.formFormatId;
            executeForm.FormType = form.formType;
            executeForm.Name = form.name;
            switch (form.terminal) {
                case 'web':
                    executeForm.TerminalType = TerminalType.PC;
                    break;
                case 'app':
                    executeForm.TerminalType = TerminalType.MOBILE;
                    break;
            }
            if (form.actualParameters && form.actualParameters.length > 0) {
                executeForm.ActualParameters = form.actualParameters.map((/**
                 * @param {?} p
                 * @return {?}
                 */
                (p) => ({
                    Name: p.code,
                    Tag: p.valueType ? p.valueType : ProcessDeUtil.initVariableType(p.value),
                    Value: p.value
                })));
            }
            executeForms.push(executeForm);
        }
        return executeForms;
    }
    /**
     * @private
     * @param {?} formformat
     * @return {?}
     */
    formFormat2ExecuteForm(formformat) {
        /** @type {?} */
        const form = new ExecuteFormModel();
        form.Id = ProcessDeUtil.GenerateElementId();
        form.ComponentId = null;
        form.formFormatId = formformat.id;
        form.FormType = '0';
        form.Name = formformat.name;
        switch (formformat.terminal) {
            case 'PC':
                form.TerminalType = TerminalType.PC;
                break;
            case 'Mobile':
                form.TerminalType = TerminalType.MOBILE;
                break;
        }
        if (formformat.urlParameters && formformat.urlParameters.length > 0) {
            form.ActualParameters = formformat.urlParameters.map((/**
             * @param {?} p
             * @return {?}
             */
            p => ({
                Name: p.code,
                Tag: p.valueType ? p.valueType : ProcessDeUtil.initVariableType(p.value),
                Value: p.value
            })));
        }
        return form;
    }
    /**
     * @private
     * @param {?} strategy
     * @return {?}
     */
    completeStrategyChanged(strategy) {
        if (strategy !== this.uiState.completeIterator[0].key) {
            // 参与者存在自动审批的情况下，不允许修改完成策略为会签规则
            // if (this.uiState.propertyData.ParticipantSchemes
            //   && this.uiState.propertyData.ParticipantSchemes.options
            //   && this.uiState.propertyData.ParticipantSchemes.options.automaticPerformers
            //   && this.uiState.propertyData.ParticipantSchemes.options.automaticPerformers.length > 0) {
            //   return;
            // } else {
            // 会签规则不存在，即由抢占模式，变为会签时
            if (!this.uiState.propertyData.SignRule) {
                // 会签是自动弹出会签规则编辑
                /** @type {?} */
                const compFactory = this.resolver.resolveComponentFactory(SignRuleComponent);
                /** @type {?} */
                const compRef = compFactory.create(this.injector);
                compRef.instance.value = [];
                // compRef.instance.counterSignVariables = this.uiState.counterSignVariables || [];
                // compRef.instance.approvalItems = this.uiState.approvalItems || [];
                /** @type {?} */
                const modalConfig = Object.assign(compRef.instance.modalConfig, { buttons: compRef.instance.modalFooter });
                /** @type {?} */
                const dialog = this.modalService.show(compRef, modalConfig);
                compRef.instance.closeModal.subscribe((/**
                 * @param {?} $event
                 * @return {?}
                 */
                $event => dialog.close()));
                compRef.instance.submitModal.subscribe((/**
                 * @param {?} data
                 * @return {?}
                 */
                (data) => {
                    this.updateChangeProperty({
                        categoryId: 'performerProperty',
                        propertyID: UserActivityPropertyKeys.SignRule,
                        propertyValue: data.value
                    });
                    dialog.close();
                }));
            }
            // 会签规则下，驳回规则约束
            if (((/** @type {?} */ (this.uiState.propertyData.BackWardRule))).SelectTargetAble === true) {
                setTimeout((/**
                 * @return {?}
                 */
                () => {
                    this.message.warning(this.localePipe.transform("processEditor.policyConflict"));
                }), 500);
            }
            // }
        }
    }
    /**
     * @private
     * @param {?} data
     * @return {?}
     */
    OtherAssignNodesChanged(data) {
        /** @type {?} */
        const compFactory = this.resolver.resolveComponentFactory(AssignScopeComponent);
        /** @type {?} */
        const compRef = compFactory.create(this.injector);
        /** @type {?} */
        let location;
        if (data.Id.indexOf('startActivity') > -1) {
            location = 'startActivity';
        }
        else {
            location = 'userActivity';
        }
        if (location === 'startActivity') {
            compRef.instance.value = [];
            /** @type {?} */
            const activities = this.uiState.userActList.filter((/**
             * @param {?} a
             * @return {?}
             */
            a => a.Id !== this.uiState.propertyData.Id
                && a.AssignmentStrategy === 'ASSIGN'
                && a.AssignPerformerConfig
                && a.AssignPerformerConfig.Operator === 'procInstCreator'));
            if (activities && activities.length > 0) {
                compRef.instance.value = activities.map((/**
                 * @param {?} a
                 * @return {?}
                 */
                a => a.Id));
            }
            else {
                compRef.instance.value = new Array();
            }
        }
        else {
            compRef.instance.value = [];
        }
        compRef.instance.location = location;
        /** @type {?} */
        const modalConfig = Object.assign(compRef.instance.modalConfig, { buttons: compRef.instance.modalFooter });
        /** @type {?} */
        const dialog = this.modalService.show(compRef, modalConfig);
        compRef.instance.closeModal.subscribe((/**
         * @param {?} $event
         * @return {?}
         */
        $event => dialog.close()));
        compRef.instance.submitModal.subscribe((/**
         * @param {?} data
         * @return {?}
         */
        (data) => {
            this.updateChangeProperty({
                categoryId: location = 'startActivity' ? 'activityConfig' : 'approvalProperty',
                // todo：多个活动具有同名属性时，如何更合理定义PropertyKey？
                propertyID: UserActivityPropertyKeys.otherAssignActivities,
                propertyValue: data.value
            });
            dialog.close();
        }));
    }
    /**
     * 完成策略调整校验
     * @private
     * @param {?} data
     * @return {?}
     */
    beforeCompleteStrategyChange(data) {
        if (this.time === ProcessTime.rt) {
            return this.viewModel.beforeCompleteStrategyChange(data, this.rtProcessInfo);
        }
        else {
            return of(true);
        }
    }
    /**
     * 保存，发布，另存，同步操作时
     * 校验模型的流程分类ID与列表存储是否一致，不一致时，以列表为准
     * @private
     * @param {?} content
     * @return {?}
     */
    checkModelContent(content) {
        /** @type {?} */
        const process = JSON.parse(content);
        /** @type {?} */
        const modelBizDefKey = process.DefaultProcess.extensionElements.find((/**
         * @param {?} e
         * @return {?}
         */
        e => e.ClrTypeID === 'wf.ProcessHeader')).BizDefKey;
        if (this.time === ProcessTime.dt) {
            if (modelBizDefKey === this.processInfo.flowFormId) {
                return content;
            }
            else {
                process.DefaultProcess.extensionElements.find((/**
                 * @param {?} e
                 * @return {?}
                 */
                e => e.ClrTypeID === 'wf.ProcessHeader')).BizDefKey = this.processInfo.flowFormId;
                process.DefaultProcess.extensionElements.find((/**
                 * @param {?} e
                 * @return {?}
                 */
                e => e.ClrTypeID === 'wf.ProcessHeader')).BizDefName = this.uiState.flowFormInfo.flowForm.name;
                return JSON.stringify(process);
            }
        }
        else if (this.time === ProcessTime.rt) {
            if (modelBizDefKey === this.rtProcessInfo.flowFormId) {
                return content;
            }
            else {
                process.DefaultProcess.extensionElements.find((/**
                 * @param {?} e
                 * @return {?}
                 */
                e => e.ClrTypeID === 'wf.ProcessHeader')).BizDefKey = this.rtProcessInfo.flowFormId;
                process.DefaultProcess.extensionElements.find((/**
                 * @param {?} e
                 * @return {?}
                 */
                e => e.ClrTypeID === 'wf.ProcessHeader')).BizDefName = this.uiState.flowFormInfo.flowForm.name;
                return JSON.stringify(process);
            }
        }
    }
    /**
     * @param {?} event
     * @return {?}
     */
    showModeChange(event) {
        const { mode = ShowMode.panel, wideWidth = 330, smallWidth = 41 } = event || {};
        if (mode === ShowMode.panel) {
            this.panelWidth = wideWidth;
            this.rightPanelWidth = wideWidth;
        }
        else if (mode === ShowMode.sidebar) {
            this.panelWidth = smallWidth;
            this.rightPanelWidth = smallWidth;
        }
    }
    /**
     * @return {?}
     */
    saveProc() {
        /** @type {?} */
        const model = this.editorUi.graph.bpmnModel;
        /** @type {?} */
        const res = WfValidatorAdapter.validator(model, this.scene);
        if (res.valid == false) {
            this.showTip(res);
            return;
        }
        if (res.warningList && res.warningList.length > 0) {
            this.showVerify(res.warningList);
        }
        else {
            this.clearValidationTips();
        }
        this.save(model.ConvertToJson());
    }
    /**
     * @return {?}
     */
    saveAs() {
        if (!(this.uiState.enableAdminOrgAut || ((this.uiState.isAdministratorConfig &&
            this.uiState.administrator !== null) || (!this.uiState.isAdministratorConfig)))) {
            this.message.info(this.localePipe.transform("processEditor.noPermissionToSave"));
            return;
        }
        /** @type {?} */
        const model = this.editorUi.graph.bpmnModel;
        /** @type {?} */
        const res = WfValidatorAdapter.validator(model, this.scene);
        if (res.valid == false) {
            this.showTip(res);
            return;
        }
        if (res.warningList && res.warningList.length > 0) {
            this.showVerify(res.warningList);
        }
        else {
            this.clearValidationTips();
        }
        /** @type {?} */
        const process = new BpmnModel();
        process.LoadFromJson(model.ConvertToJson());
        process.DefaultProcess.Key = ProcessDeUtil.GenerateElementId();
        process.DefaultProcess.Id = ProcessDeUtil.GenerateElementId();
        process.DefaultDiagram.BpmnPlane.BpmnElementId = process.DefaultProcess.Id;
        this.viewModel.saveAsProcess(process, this.processInfo);
    }
    /**
     * @return {?}
     */
    releaseProc() {
        /** @type {?} */
        const model = this.editorUi.graph.bpmnModel;
        /** @type {?} */
        const res = WfValidatorAdapter.validator(model, this.scene);
        if (res.valid == false) {
            this.showTip(res);
            return;
        }
        if (res.warningList && res.warningList.length > 0) {
            this.showVerify(res.warningList);
        }
        else {
            this.clearValidationTips();
        }
        this.release(model.ConvertToJson());
    }
    /**
     * @return {?}
     */
    sync() {
        /** @type {?} */
        const model = this.editorUi.graph.bpmnModel;
        /** @type {?} */
        const res = WfValidatorAdapter.validator(model, this.scene);
        if (res.valid == false) {
            this.showTip(res);
            return;
        }
        if (res.warningList && res.warningList.length > 0) {
            this.showVerify(res.warningList);
        }
        else {
            this.clearValidationTips();
        }
        this.viewModel.syncDtProcess(model.ConvertToJson(), this.rtProcessInfo);
    }
    /**
     * @return {?}
     */
    procRecord() {
        /** @type {?} */
        const record = this.editorUi.graph.bpmnModel.DefaultProcess.Documentation;
        this.note(record);
    }
    /**
     * @return {?}
     */
    batchSet() {
        /** @type {?} */
        const compFactory = this.resolver.resolveComponentFactory(BatchSetPropertiesComponent);
        /** @type {?} */
        const compRef = compFactory.create(this.injector);
        /** @type {?} */
        const modalConfig = {
            title: '批量设置',
            width: 512,
            height: 565,
            showButtons: true,
            buttons: compRef.instance.footer
        };
        /** @type {?} */
        const dialog = this.modalService.show(compRef, modalConfig);
        compRef.instance.cancel.subscribe((/**
         * @param {?} $event
         * @return {?}
         */
        $event => dialog.close()));
        compRef.instance.submit.subscribe((/**
         * @param {?} data
         * @return {?}
         */
        (data) => {
            dialog.close();
        }));
    }
    /**
     * @return {?}
     */
    closeProc() {
        // 如果界面发生变化，增加确认框提示，无变化则直接关闭
        if (this.changedFlag) {
            this.message.confirm(this.localePipe.transform("processEditor.closeProc1"), this.localePipe.transform("processEditor.closeProc2")).subscribe((/**
             * @param {?} f
             * @return {?}
             */
            (f) => {
                if (f) {
                    this.close.emit();
                }
            }));
        }
        else {
            this.close.emit();
        }
    }
    /**
     * @return {?}
     */
    viewProcModel() {
        /** @type {?} */
        const modalConfig = {
            title: this.localePipe.transform("processEditor.viewModel"),
            width: 800,
            height: 520,
            showButtons: false
        };
        // 模型自动复制到剪贴板
        this.notify.success(this.localePipe.transform("processEditor.copied"));
        this.copy(this.editorUi.graph.bpmnModel.ConvertToJson());
        this.modalService.show(this.editorUi.graph.bpmnModel.ConvertToJson(), modalConfig);
    }
    /**
     * 左右拖动后事件，event.size.width是左侧面板的宽度
     * @param {?} event
     * @return {?}
     */
    rzStop(event) {
        this.panelWidth = event.size.width;
        this.editorUi && this.editorUi.graph.refresh();
    }
    // 展示表单验证组件，用于构件校验
    /**
     * @return {?}
     */
    createValidationTips() {
        this.verifySer.clear();
        this.verifyContainer = this.verifySer.createVerify({
            parent: this.contentEl,
            verifyList: this.errorList,
            verifyType: this.tabTypeList,
            showList: true,
            showType: 'processWarning',
            verifyResultTipsTmpl: this.tipsTmpl // 提示模板
        });
        this.listclick = this.verifyContainer.validatorClick.subscribe((/**
         * @param {?} e
         * @return {?}
         */
        e => {
            console.log(e);
        }));
        this.showchange = this.verifyContainer.listshowChange.subscribe((/**
         * @param {?} e
         * @return {?}
         */
        e => {
            console.log(e);
        }));
    }
    /**
     * @return {?}
     */
    clearValidationTips() {
        this.errorList = [];
        if (this.verifySer) {
            this.verifySer.clear();
        }
    }
    /**
     * @param {?} text
     * @return {?}
     */
    copy(text) {
        /** @type {?} */
        const el = document.createElement('input');
        el.setAttribute('value', text);
        document.body.appendChild(el);
        el.select();
        document.execCommand('copy');
        document.body.removeChild(el);
    }
}
WfProcessEditorComponent.decorators = [
    { type: Component, args: [{
                selector: 'wf-process-editor',
                template: "<div class=\"f-page\">\r\n  <div class=\"f-page-header mt-1\">\r\n    <nav class=\"f-page-header-base py-0\">\r\n      <div class=\"f-title\">\r\n        <span class=\"f-title-icon f-text-orna-manage\">\r\n          <i class=\"f-icon f-icon-page-title-administer\"></i>\r\n        </span>\r\n        <h4 class=\"f-title-text\">{{procNameTitle}}</h4>\r\n      </div>\r\n      <div class=\"btn-toolbar btn-group-lg\">\r\n        <ng-container *ngIf=\"action==='edit'&&time==='dt'\">\r\n          <button class=\"btn btn-primary btn-lg mr-2\" (click)=\"saveProc()\">{{ 'processEditor.button.saveProc' | wfLocale }}</button>\r\n          <button class=\"btn btn-secondary mr-2\" (click)=\"releaseProc()\">{{ 'processEditor.button.releaseProc' | wfLocale }}</button>\r\n        </ng-container>\r\n        <ng-container *ngIf=\"action==='edit'&&time==='rt'\">\r\n          <button class=\"btn btn-primary btn-lg mr-2\" (click)=\"saveProc()\">{{ 'processEditor.button.saveProc' | wfLocale }}</button>\r\n          <button class=\"btn btn-secondary mr-2\" (click)=\"sync()\">{{ 'processEditor.button.sync' | wfLocale }}</button>\r\n        </ng-container>\r\n        <ng-container *ngIf=\"time==='dt'&&action!='assignView'\">\r\n          <button class=\"btn btn-secondary btn-lg mr-2\" (click)=\"saveAs()\">{{ 'processEditor.button.saveAs' | wfLocale }}</button>\r\n        </ng-container>\r\n        <button class=\"btn btn-secondary mr-2\" (click)=\"procRecord()\">{{ 'processEditor.button.procRecord' | wfLocale }}</button>\r\n        <ng-container *ngIf=\"showModelButton\">\r\n          <button class=\"btn btn-secondary mr-2\" (click)=\"viewProcModel()\">{{ 'processEditor.button.viewProcModel' | wfLocale }}</button>\r\n          </ng-container>\r\n        <button class=\"btn btn-secondary mr-2\" (click)=\"closeProc()\">{{ 'processEditor.button.closeProc' | wfLocale }}</button>\r\n      </div>\r\n    </nav>\r\n  </div>\r\n  <div class=\"f-page-main\">\r\n    <div class=\"f-utils-flex-column h-100\">\r\n      <div class=\"flex-auto d-flex flex-fill flex-row\" style=\"position:relative; overflow: hidden\">\r\n        <farris-splitter style=\"display: flex; flex-grow: 1\">\r\n          <farris-splitter-pane style=\"display: flex; flex-grow: 1\" id=\"gspWfDesignerPane\">\r\n            <div class=\"flex-grow-1 h-100\">\r\n              <div style=\"position: relative; height: 100%; width: 100%;\">\r\n                <div id=\"editorUiContainer\" class=\"editorUiContainer geEditor\" #editorUiContainer>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </farris-splitter-pane>\r\n          <farris-splitter-pane class=\"f-page-content-main f-component-splitter-pane\" style=\"margin: 0 0 0 10px\"\r\n            ngResizable [rzHandles]=\"'w'\" [ngStyle]=\"{ width: rightPanelWidth + 'px' }\" (rzStop)=\"rzStop($event)\"\r\n            [relatedIframeParent]=\"'#gspWfDesignerPane'\">\r\n            <div class=\"h-100 d-flex flex-column\">\r\n              <div class=\"f-utils-fill-flex-column\">\r\n                <app-property-panel #propertyPanel [(propertyConfig)]=\"uiState.propertyConfig\"\r\n                  [(propertyData)]=\"uiState.propertyData\" [enableChangeMode]=\"true\" [showCloseBtn]=\"false\"\r\n                  isWhiteTheme=\"true\" (showModeChange)=\"showModeChange($event)\" style=\"height:100%;width:100%;\">\r\n                </app-property-panel>\r\n              </div>\r\n            </div>\r\n          </farris-splitter-pane>\r\n        </farris-splitter>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n<ng-template #tipsTmpl let-datas>\r\n  <span class=\"f-icon f-icon-question\" style=\"font-size:14px;\"></span>{{datas[0]['list'].length}}\r\n</ng-template>\r\n",
                providers: [
                    { provide: WF_LANG_RESOURCES, useValue: ɵ0 },
                    WfLocalePipe,
                ],
                styles: [`
    .bpmn-designer {
      height: 100%;
      min-height: 400px;
      width: 100%;
    }`]
            }] }
];
/** @nocollapse */
WfProcessEditorComponent.ctorParameters = () => [
    { type: ProcessDesignerUIState },
    { type: ProcessDesignerViewModel },
    { type: ProcessDesignerDataService },
    { type: LoadingService },
    { type: NotifyService },
    { type: MessagerService },
    { type: WFFlowElementsViewModel },
    { type: Injector },
    { type: BsModalService },
    { type: ComponentFactoryResolver },
    { type: EventBusService },
    { type: ChangeDetectorRef, decorators: [{ type: Optional }] },
    { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
    { type: undefined, decorators: [{ type: Inject, args: [WF_LANG_RESOURCES,] }] },
    { type: WfLocalePipe, decorators: [{ type: Optional }] }
];
WfProcessEditorComponent.propDecorators = {
    cls: [{ type: HostBinding, args: ['class',] }],
    time: [{ type: Input }],
    processInfo: [{ type: Input }],
    rtProcessInfo: [{ type: Input }],
    action: [{ type: Input }],
    mode: [{ type: Input }],
    scene: [{ type: Input }],
    procType: [{ type: Input }],
    close: [{ type: Output }],
    propertyPanel: [{ type: ViewChild, args: ['propertyPanel',] }],
    tipsTmpl: [{ type: ViewChild, args: ['tipsTmpl',] }],
    iframe: [{ type: ViewChild, args: ['iframe',] }],
    contentEl: [{ type: ViewChild, args: ['content',] }],
    editorUiContainerER: [{ type: ViewChild, args: ["editorUiContainer",] }],
    editorUiContainerVCR: [{ type: ViewChild, args: ["editorUiContainer", { read: ViewContainerRef },] }]
};
if (false) {
    /**
     * @type {?}
     * @private
     */
    WfProcessEditorComponent.prototype.flag;
    /** @type {?} */
    WfProcessEditorComponent.prototype.cls;
    /**
     * @type {?}
     * @private
     */
    WfProcessEditorComponent.prototype._time;
    /** @type {?} */
    WfProcessEditorComponent.prototype.processInfo;
    /** @type {?} */
    WfProcessEditorComponent.prototype.rtProcessInfo;
    /** @type {?} */
    WfProcessEditorComponent.prototype.action;
    /** @type {?} */
    WfProcessEditorComponent.prototype.mode;
    /** @type {?} */
    WfProcessEditorComponent.prototype.procType;
    /** @type {?} */
    WfProcessEditorComponent.prototype.close;
    /** @type {?} */
    WfProcessEditorComponent.prototype.propertyPanel;
    /** @type {?} */
    WfProcessEditorComponent.prototype.tipsTmpl;
    /** @type {?} */
    WfProcessEditorComponent.prototype.iframe;
    /** @type {?} */
    WfProcessEditorComponent.prototype.errorList;
    /** @type {?} */
    WfProcessEditorComponent.prototype.tabTypeList;
    /** @type {?} */
    WfProcessEditorComponent.prototype.contentEl;
    /** @type {?} */
    WfProcessEditorComponent.prototype.verifyContainer;
    /** @type {?} */
    WfProcessEditorComponent.prototype.listclick;
    /** @type {?} */
    WfProcessEditorComponent.prototype.showchange;
    /** @type {?} */
    WfProcessEditorComponent.prototype.panelWidth;
    /** @type {?} */
    WfProcessEditorComponent.prototype.propertyPanelResizable;
    /** @type {?} */
    WfProcessEditorComponent.prototype.rightPanelWidth;
    /** @type {?} */
    WfProcessEditorComponent.prototype.clientWidth;
    /** @type {?} */
    WfProcessEditorComponent.prototype.widthAfterResized;
    /**
     * @type {?}
     * @private
     */
    WfProcessEditorComponent.prototype.verifySer;
    /** @type {?} */
    WfProcessEditorComponent.prototype.procNameTitle;
    /** @type {?} */
    WfProcessEditorComponent.prototype.editorUiContainerER;
    /** @type {?} */
    WfProcessEditorComponent.prototype.editorUiContainerVCR;
    /** @type {?} */
    WfProcessEditorComponent.prototype.editorUi;
    /**
     * 界面是否发生变化标志，修改属性、移动节点等均会将此值设为true
     * @type {?}
     */
    WfProcessEditorComponent.prototype.changedFlag;
    /** @type {?} */
    WfProcessEditorComponent.prototype.showModelButton;
    /** @type {?} */
    WfProcessEditorComponent.prototype.uiState;
    /**
     * @type {?}
     * @private
     */
    WfProcessEditorComponent.prototype.viewModel;
    /** @type {?} */
    WfProcessEditorComponent.prototype.service;
    /**
     * @type {?}
     * @private
     */
    WfProcessEditorComponent.prototype.loadService;
    /**
     * @type {?}
     * @private
     */
    WfProcessEditorComponent.prototype.notify;
    /**
     * @type {?}
     * @private
     */
    WfProcessEditorComponent.prototype.message;
    /**
     * @type {?}
     * @private
     */
    WfProcessEditorComponent.prototype.activity;
    /**
     * @type {?}
     * @private
     */
    WfProcessEditorComponent.prototype.injector;
    /**
     * @type {?}
     * @private
     */
    WfProcessEditorComponent.prototype.modalService;
    /**
     * @type {?}
     * @private
     */
    WfProcessEditorComponent.prototype.resolver;
    /**
     * @type {?}
     * @private
     */
    WfProcessEditorComponent.prototype.eventBus;
    /**
     * @type {?}
     * @private
     */
    WfProcessEditorComponent.prototype.cdr;
    /**
     * @type {?}
     * @private
     */
    WfProcessEditorComponent.prototype.localeId;
    /**
     * @type {?}
     * @private
     */
    WfProcessEditorComponent.prototype.resources;
    /**
     * @type {?}
     * @private
     */
    WfProcessEditorComponent.prototype.localePipe;
}
export { ɵ0 };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid2YtcHJvY2Vzcy1lZGl0b3IuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGdzcC13Zi93Zi1wcm9jZXNzLWVkaXRvci8iLCJzb3VyY2VzIjpbImxpYi93Zi1wcm9jZXNzLWVkaXRvci5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQVUsS0FBSyxFQUFFLFNBQVMsRUFBRSxVQUFVLEVBQUUsUUFBUSxFQUFFLHdCQUF3QixFQUFFLFdBQVcsRUFBRSxNQUFNLEVBQUUsWUFBWSxFQUFFLFdBQVcsRUFBRSxnQkFBZ0IsRUFBRSxpQkFBaUIsRUFBRSxRQUFRLEVBQUUsU0FBUyxFQUFFLE1BQU0sRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUN0TyxPQUFPLEVBQUUsV0FBVyxFQUFFLE1BQU0sc0JBQXNCLENBQUM7QUFDbkQsT0FBTyxFQUFFLHNCQUFzQixFQUFFLE1BQU0sZ0NBQWdDLENBQUM7QUFFeEUsT0FBTyxFQUFFLHdCQUF3QixFQUFFLE1BQU0sa0NBQWtDLENBQUM7QUFFNUUsT0FBTyxFQUFFLGdCQUFnQixFQUFFLFlBQVksRUFBRSxNQUFNLG9EQUFvRCxDQUFDO0FBRXBHLE9BQU8sRUFBZ0IsY0FBYyxFQUFFLE1BQU0sa0JBQWtCLENBQUM7QUFFaEUsT0FBTyxFQUFFLDBCQUEwQixFQUFFLE1BQU0sdUNBQXVDLENBQUM7QUFDbkYsT0FBTyxFQUFFLGNBQWMsRUFBRSxNQUFNLG9CQUFvQixDQUFDO0FBQ3BELE9BQU8sRUFBRSxhQUFhLEVBQWlCLE1BQU0sbUJBQW1CLENBQUM7QUFDakUsT0FBTyxFQUFFLGVBQWUsRUFBRSxNQUFNLHFCQUFxQixDQUFDO0FBQ3RELE9BQU8sRUFBRSx1QkFBdUIsRUFBRSxNQUFNLGlDQUFpQyxDQUFDO0FBRTFFLE9BQU8sRUFBRSxzQkFBc0IsRUFBRSxRQUFRLEVBQUUsTUFBTSw0QkFBNEIsQ0FBQztBQUM5RSxPQUFPLEVBQUUsaUJBQWlCLEVBQUUsTUFB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QUNzQzs7SUFDdEMsNENBQzJCOztJQUMzQiwwQ0FDbUI7O0lBQ25CLDZDQUFlOztJQUNmLCtDQVFFOztJQUNGLDZDQUFnQzs7SUFDaEMsbURBQWdCOztJQUNoQiw2Q0FBVTs7SUFDViw4Q0FBVzs7SUFDWCw4Q0FBaUI7O0lBQ2pCLDBEQUE4Qjs7SUFDOUIsbURBQXNCOztJQUN0QiwrQ0FBb0I7O0lBQ3BCLHFEQUEwQjs7Ozs7SUFDMUIsNkNBQXVDOztJQUN2QyxpREFBc0I7O0lBQ3RCLHVEQUNnRDs7SUFDaEQsd0RBQ2lEOztJQUNqRCw0Q0FBcUI7Ozs7O0lBTXJCLCtDQUFvQjs7SUFnQ3BCLG1EQUF3Qjs7SUE3QnRCLDJDQUFzQzs7Ozs7SUFDdEMsNkNBQTJDOztJQUMzQywyQ0FBMEM7Ozs7O0lBQzFDLCtDQUFtQzs7Ozs7SUFDbkMsMENBQTZCOzs7OztJQUM3QiwyQ0FBZ0M7Ozs7O0lBQ2hDLDRDQUF5Qzs7Ozs7SUFDekMsNENBQTBCOzs7OztJQUMxQixnREFBb0M7Ozs7O0lBQ3BDLDRDQUEwQzs7Ozs7SUFDMUMsNENBQWlDOzs7OztJQUNqQyx1Q0FBMEM7Ozs7O0lBQzFDLDRDQUEyQzs7Ozs7SUFDM0MsNkNBQWlEOzs7OztJQUNqRCw4Q0FBNEMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIE9uSW5pdCwgSW5wdXQsIFZpZXdDaGlsZCwgRWxlbWVudFJlZiwgSW5qZWN0b3IsIENvbXBvbmVudEZhY3RvcnlSZXNvbHZlciwgSG9zdEJpbmRpbmcsIE91dHB1dCwgRXZlbnRFbWl0dGVyLCBUZW1wbGF0ZVJlZiwgVmlld0NvbnRhaW5lclJlZiwgQ2hhbmdlRGV0ZWN0b3JSZWYsIE9wdGlvbmFsLCBMT0NBTEVfSUQsIEluamVjdCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBQcm9jZXNzVGltZSB9IGZyb20gJy4vbW9kZWwvcHJvY2Vzcy10aW1lJztcclxuaW1wb3J0IHsgUHJvY2Vzc0Rlc2lnbmVyVUlTdGF0ZSB9IGZyb20gJy4vYXBwL3Byb2Nlc3MtZGVzaWduZXIudWlzdGF0ZSc7XHJcbmltcG9ydCB7IEZsb3dGb3JtSW5mbyB9IGZyb20gJy4vZG9tYWluL2VudGl0aWVzL2Zsb3dmb3JtLWluZm8nO1xyXG5pbXBvcnQgeyBQcm9jZXNzRGVzaWduZXJWaWV3TW9kZWwgfSBmcm9tICcuL2FwcC9wcm9jZXNzLWRlc2lnbmVyLnZpZXdtb2RlbCc7XHJcbmltcG9ydCB7IEJpekNvbXBvbmVudEVudGl0eSB9IGZyb20gJy4vZG9tYWluL2VudGl0aWVzL2Jpei1jb21wb25lbnQuZW50aXR5JztcclxuaW1wb3J0IHsgRXhlY3V0ZUZvcm1Nb2RlbCwgVGVybWluYWxUeXBlIH0gZnJvbSAnLi92aWV3cy9leGVjdXRlLWZvcm1zL2VudGl0aWVzL2V4ZWN1dGUtZm9ybS5lbnRpdHknO1xyXG5pbXBvcnQgeyBFeGN1dGVGb3JtRW50aXR5IH0gZnJvbSAnLi9kb21haW4vZW50aXRpZXMvZXhjdXRlLWZvcm0uZW50aXR5JztcclxuaW1wb3J0IHsgTW9kYWxPcHRpb25zLCBCc01vZGFsU2VydmljZSB9IGZyb20gJ0BmYXJyaXMvdWktbW9kYWwnO1xyXG5pbXBvcnQgeyBCYWNrV2FyZFJ1bGUgfSBmcm9tICcuL3ZpZXdzL2JhY2t3YXJkLXJ1bGUvYmFja3dhcmQtcnVsZS5lbnRpdHknO1xyXG5pbXBvcnQgeyBQcm9jZXNzRGVzaWduZXJEYXRhU2VydmljZSB9IGZyb20gJy4vZG9tYWluL3Byb2Nlc3MtZGVzaWduZXIuZGF0YXNlcnZpY2UnO1xyXG5pbXBvcnQgeyBMb2FkaW5nU2VydmljZSB9IGZyb20gJ0BmYXJyaXMvdWktbG9hZGluZyc7XHJcbmltcG9ydCB7IE5vdGlmeVNlcnZpY2UsIE5vdGlmeU9wdGlvbnMgfSBmcm9tICdAZmFycmlzL3VpLW5vdGlmeSc7XHJcbmltcG9ydCB7IE1lc3NhZ2VyU2VydmljZSB9IGZyb20gJ0BmYXJyaXMvdWktbWVzc2FnZXInO1xyXG5pbXBvcnQgeyBXRkZsb3dFbGVtZW50c1ZpZXdNb2RlbCB9IGZyb20gJy4vYXBwL3dmLWZsb3dFbGVtZW50cy52aWV3TW9kZWwnO1xyXG5pbXBvcnQgeyBIdHRwRXJyb3JSZXNwb25zZSB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbi9odHRwJztcclxuaW1wb3J0IHsgUHJvcGVydHlQYW5lbENvbXBvbmVudCwgU2hvd01vZGUgfSBmcm9tICdAZmFycmlzL2lkZS1wcm9wZXJ0eS1wYW5lbCc7XHJcbmltcG9ydCB7IFNpZ25SdWxlQ29tcG9uZW50IH0gZnJvbSAnLi92aWV3cy9zaWduLXJ1bGUvc2lnbi1ydWxlLmNvbXBvbmVudCc7XHJcbmltcG9ydCB7IFByb2Nlc3NJbmZvIH0gZnJvbSAnLi9tb2RlbC9wcm9jZXNzLWluZm8nO1xyXG5pbXBvcnQgeyBSVFByb2Nlc3NJbmZvIH0gZnJvbSAnLi9tb2RlbC9ydC1wcm9jZXNzLWluZm8nO1xyXG5pbXBvcnQgeyBmb3JrSm9pbiwgT2JzZXJ2YWJsZSwgb2YgfSBmcm9tICdyeGpzJztcclxuaW1wb3J0IHsgQXVkaXRFdmVudCB9IGZyb20gJy4vZG9tYWluL2VudGl0aWVzL2F1ZGl0LXByb2Nlc3NEZWYtaW5mbyc7XHJcbmltcG9ydCB7IE5vdGVDb21wb25lbnQgfSBmcm9tICcuL3ZpZXdzL25vdGUvbm90ZS5jb21wb25lbnQnO1xyXG5pbXBvcnQgeyBQcm9jZXNzRGVVdGlsIH0gZnJvbSAnLi9kb21haW4vcHJvY2Vzcy1kZS11dGlsJztcclxuaW1wb3J0IHsgRmxvd0Zvcm1FbnRpdHkgfSBmcm9tICcuL2RvbWFpbi9lbnRpdGllcy9mbG93Zm9ybS5lbnRpdHknO1xyXG5pbXBvcnQgeyBFdmVudEJ1c1NlcnZpY2UgfSBmcm9tICcuL3ZpZXdzL3NoYXJlZC9ldmVudC1idXMuc2VydmljZSc7XHJcbmltcG9ydCB7IFZlcmlmeURldGFpbFNlcnZpY2UgfSBmcm9tICdAZmFycmlzL3VpLXZlcmlmeS1kZXRhaWwnO1xyXG5pbXBvcnQgeyBBc3NpZ25TY29wZUNvbXBvbmVudCB9IGZyb20gJy4vdmlld3MvYXNzaWduLXNjb3BlL2Fzc2lnbi1zY29wZS5jb21wb25lbnQnO1xyXG5pbXBvcnQgeyBXZkVkaXRvclVpIH0gZnJvbSAnLi9kZXNpZ25lci9XZkVkaXRvclVpJztcclxuaW1wb3J0IHsgUG1mRXZlbnRzLCBDZWxsIH0gZnJvbSBcIkBlZHAtcG1mL2dyYXBoZWRpdG9yXCI7XHJcbmltcG9ydCB7IEJwbW5Nb2RlbCB9IGZyb20gXCJAZWRwLXBtZi9icG1uLW1vZGVsXCI7XHJcbmltcG9ydCB7IE14R3JhcGhOUywgbXhFdmVudCB9IGZyb20gXCJAZWRwLXBtZi9teGdyYXBoLXRzXCI7XHJcbmltcG9ydCB7IFdmVmFsaWRhdG9yQWRhcHRlciB9IGZyb20gXCIuL2Rlc2lnbmVyL1dmVmFsaWRhdG9yQWRhcHRlclwiO1xyXG5pbXBvcnQgeyBQcm9jZXNzSGVhZGVyLCBTdGFydE1vZGUgfSBmcm9tIFwiQGdzcC13Zi93Zi1wcm9jZXNzLW1vZGVsXCI7XHJcbmltcG9ydCB7IEV2ZW50QnVzS2V5cyB9IGZyb20gJy4vbW9kZWwvZXZlbnQtYnVzLWtleXMnO1xyXG5pbXBvcnQgeyBQcm9jZXNzUHJvcGVydHlLZXlzIH0gZnJvbSAnLi9kZXNpZ25lci93Zi1jZWxsL3Byb3BlcnR5LWtleXMvUHJvY2Vzc1Byb3BlcnR5S2V5cyc7XHJcbmltcG9ydCB7IFVzZXJBY3Rpdml0eVByb3BlcnR5S2V5cyB9IGZyb20gJy4vZGVzaWduZXIvd2YtY2VsbC9wcm9wZXJ0eS1rZXlzL1VzZXJBY3Rpdml0eVByb3BlcnR5S2V5cyc7XHJcbmltcG9ydCB7IE1lc3NhZ2VBY3Rpdml0eVByb3BlcnR5S2V5cyB9IGZyb20gJy4vZGVzaWduZXIvd2YtY2VsbC9wcm9wZXJ0eS1rZXlzL01lc3NhZ2VBY3Rpdml0eVByb3BlcnR5S2V5cyc7XHJcbmltcG9ydCB7IFN0YXJ0QWN0aXZpdHlQcm9wZXJ0eUtleXMgfSBmcm9tICcuL2Rlc2lnbmVyL3dmLWNlbGwvcHJvcGVydHkta2V5cy9TdGFydEFjdGl2aXR5UHJvcGVydHlLZXlzJztcclxuaW1wb3J0IHsgTm90aWZ5QWN0aXZpdHlQcm9wZXJ0eUtleXMgfSBmcm9tICcuL2Rlc2lnbmVyL3dmLWNlbGwvcHJvcGVydHkta2V5cy9Ob3RpZnlBY3Rpdml0eVByb3BlcnR5S2V5cyc7XHJcbmltcG9ydCB7IGRlbGF5LCBzd2l0Y2hNYXAgfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XHJcbmltcG9ydCB7IFdGX0xBTkdfUkVTT1VSQ0VTLCBXZkxvY2FsZVBpcGUgfSBmcm9tICcuL2kxOG4vcGlwZS93Zi1wcm9jZXNzLWVkaXRvci1sb2NhbGUucGlwZSc7XHJcbmltcG9ydCB7IFdGX1BST0NFU1NfRURJVE9SX0xBTkdfUkVTT1VSQ0VTIH0gZnJvbSAnLi9pMThuL2Fzc2V0cy9sYW5nLnJlc291cmNlJztcclxuaW1wb3J0IHsgQmF0Y2hTZXRQcm9wZXJ0aWVzQ29tcG9uZW50IH0gZnJvbSAnLi92aWV3cy9iYXRjaC1zZXQtcHJvcGVydGllcy9iYXRjaC1zZXQtcHJvcGVydGllcy5jb21wb25lbnQnO1xyXG5AQ29tcG9uZW50KHtcclxuICBzZWxlY3RvcjogJ3dmLXByb2Nlc3MtZWRpdG9yJyxcclxuICB0ZW1wbGF0ZVVybDogJy4vd2YtcHJvY2Vzcy1lZGl0b3IuY29tcG9uZW50Lmh0bWwnLFxyXG4gIHN0eWxlczogW2BcclxuICAgIC5icG1uLWRlc2lnbmVyIHtcclxuICAgICAgaGVpZ2h0OiAxMDAlO1xyXG4gICAgICBtaW4taGVpZ2h0OiA0MDBweDtcclxuICAgICAgd2lkdGg6IDEwMCU7XHJcbiAgICB9YFxyXG4gIF0sXHJcbiAgcHJvdmlkZXJzOiBbXHJcbiAgICB7IHByb3ZpZGU6IFdGX0xBTkdfUkVTT1VSQ0VTLCB1c2VWYWx1ZTogV0ZfUFJPQ0VTU19FRElUT1JfTEFOR19SRVNPVVJDRVMgfSxcclxuICAgIFdmTG9jYWxlUGlwZSxcclxuICBdXHJcbn0pXHJcblxyXG5leHBvcnQgY2xhc3MgV2ZQcm9jZXNzRWRpdG9yQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0IHtcclxuICBwcml2YXRlIGZsYWcgPSB0cnVlO1xyXG5cclxuICBASG9zdEJpbmRpbmcoJ2NsYXNzJylcclxuICBjbHMgPSAnZmFycmlzLW1haW4tYXJlYSBmbGV4LWNvbHVtbic7XHJcblxyXG4gIHByaXZhdGUgX3RpbWU6IFByb2Nlc3NUaW1lO1xyXG4gIEBJbnB1dCgpXHJcbiAgc2V0IHRpbWUodDogUHJvY2Vzc1RpbWUpIHtcclxuICAgIHRoaXMuX3RpbWUgPSB0O1xyXG4gICAgdGhpcy51aVN0YXRlLnRpbWUgPSB0O1xyXG4gIH1cclxuICBnZXQgdGltZSgpOiBQcm9jZXNzVGltZSB7XHJcbiAgICByZXR1cm4gdGhpcy5fdGltZTtcclxuICB9XHJcblxyXG4gIEBJbnB1dCgpXHJcbiAgcHJvY2Vzc0luZm86IFByb2Nlc3NJbmZvO1xyXG5cclxuICBASW5wdXQoKVxyXG4gIHJ0UHJvY2Vzc0luZm86IFJUUHJvY2Vzc0luZm87XHJcblxyXG4gIEBJbnB1dCgpXHJcbiAgYWN0aW9uOiAndmlldycgfCAnZWRpdCcgfCAnYXNzaWduVmlldycgPSAnZWRpdCc7XHJcblxyXG4gIEBJbnB1dCgpXHJcbiAgbW9kZTogJ2dlbmVyYWwnIHwgJ3NpbXBsaWZ5JyA9ICdnZW5lcmFsJztcclxuXHJcbiAgQElucHV0KClcclxuICBzZXQgc2NlbmUodjogc3RyaW5nKSB7XHJcbiAgICB0aGlzLnVpU3RhdGUuc2NlbmUgPSB2O1xyXG4gIH1cclxuICBnZXQgc2NlbmUoKSB7XHJcbiAgICByZXR1cm4gdGhpcy51aVN0YXRlLnNjZW5lO1xyXG4gIH1cclxuXHJcbiAgQElucHV0KClcclxuICBwcm9jVHlwZTogXCJ3ZlwiIHwgXCJ3aG9sZVwiID0gXCJ3ZlwiO1xyXG5cclxuICBAT3V0cHV0KCkgY2xvc2UgPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcclxuXHJcbiAgQFZpZXdDaGlsZCgncHJvcGVydHlQYW5lbCcpXHJcbiAgcHJvcGVydHlQYW5lbDogUHJvcGVydHlQYW5lbENvbXBvbmVudDtcclxuICBAVmlld0NoaWxkKCd0aXBzVG1wbCcpXHJcbiAgdGlwc1RtcGw6IFRlbXBsYXRlUmVmPGFueT47XHJcbiAgQFZpZXdDaGlsZCgnaWZyYW1lJylcclxuICBpZnJhbWU6IEVsZW1lbnRSZWY7XHJcbiAgZXJyb3JMaXN0ID0gW107XHJcbiAgdGFiVHlwZUxpc3QgPSBbXHJcbiAgICB7XHJcbiAgICAgIGlkOiAncHJvY2Vzc1dhcm5pbmcnLFxyXG4gICAgICB0eXBlOiAncHJvY2Vzc1dhcm5pbmcnLFxyXG4gICAgICB0aXRsZTogdGhpcy5sb2NhbGVQaXBlLmluc3RhbnQoXCJwcm9jZXNzRWRpdG9yLnRpcFwiKSxcclxuICAgICAgaWNvbkNsczogJ2YtaWNvbi1kZWZhdWx0JyxcclxuICAgICAgaWNvblN0eWxlOiAnY29sb3I6I2Y0OTczMDsnXHJcbiAgICB9XHJcbiAgXTtcclxuICBAVmlld0NoaWxkKCdjb250ZW50JykgY29udGVudEVsO1xyXG4gIHZlcmlmeUNvbnRhaW5lcjtcclxuICBsaXN0Y2xpY2s7XHJcbiAgc2hvd2NoYW5nZTtcclxuICBwYW5lbFdpZHRoID0gMzMwO1xyXG4gIHByb3BlcnR5UGFuZWxSZXNpemFibGUgPSB0cnVlO1xyXG4gIHJpZ2h0UGFuZWxXaWR0aCA9IDMzMDsgLy8g5Y+z5L6n6Z2i5p2/5a695bqmXHJcbiAgY2xpZW50V2lkdGg6IG51bWJlcjsgLy8g55WM6Z2i5oC75a695bqmXHJcbiAgd2lkdGhBZnRlclJlc2l6ZWQ6IG51bWJlcjsgLy8g55So5oi36LCD5pW05ZCO55qE5a695bqm77yI5q+U5L6L77yM5aaCMC4z77yJXHJcbiAgcHJpdmF0ZSB2ZXJpZnlTZXI6IFZlcmlmeURldGFpbFNlcnZpY2U7XHJcbiAgcHJvY05hbWVUaXRsZTogc3RyaW5nO1xyXG4gIEBWaWV3Q2hpbGQoXCJlZGl0b3JVaUNvbnRhaW5lclwiKVxyXG4gIGVkaXRvclVpQ29udGFpbmVyRVI6IEVsZW1lbnRSZWY8SFRNTERpdkVsZW1lbnQ+O1xyXG4gIEBWaWV3Q2hpbGQoXCJlZGl0b3JVaUNvbnRhaW5lclwiLCB7IHJlYWQ6IFZpZXdDb250YWluZXJSZWYgfSlcclxuICBlZGl0b3JVaUNvbnRhaW5lclZDUjogRWxlbWVudFJlZjxIVE1MRGl2RWxlbWVudD47XHJcbiAgZWRpdG9yVWk6IFdmRWRpdG9yVWk7XHJcbiAgLy8gbG9jYWxlSWQ6IHN0cmluZyA9IFwiemgtQ0hTXCI7XHJcblxyXG4gIC8qKlxyXG4gICAqIOeVjOmdouaYr+WQpuWPkeeUn+WPmOWMluagh+W/l++8jOS/ruaUueWxnuaAp+OAgeenu+WKqOiKgueCueetieWdh+S8muWwhuatpOWAvOiuvuS4unRydWVcclxuICAgKi9cclxuICBjaGFuZ2VkRmxhZyA9IGZhbHNlO1xyXG5cclxuICBjb25zdHJ1Y3RvcihcclxuICAgIHB1YmxpYyB1aVN0YXRlOiBQcm9jZXNzRGVzaWduZXJVSVN0YXRlLFxyXG4gICAgcHJpdmF0ZSB2aWV3TW9kZWw6IFByb2Nlc3NEZXNpZ25lclZpZXdNb2RlbCxcclxuICAgIHB1YmxpYyBzZXJ2aWNlOiBQcm9jZXNzRGVzaWduZXJEYXRhU2VydmljZSxcclxuICAgIHByaXZhdGUgbG9hZFNlcnZpY2U6IExvYWRpbmdTZXJ2aWNlLFxyXG4gICAgcHJpdmF0ZSBub3RpZnk6IE5vdGlmeVNlcnZpY2UsXHJcbiAgICBwcml2YXRlIG1lc3NhZ2U6IE1lc3NhZ2VyU2VydmljZSxcclxuICAgIHByaXZhdGUgYWN0aXZpdHk6IFdGRmxvd0VsZW1lbnRzVmlld01vZGVsLFxyXG4gICAgcHJpdmF0ZSBpbmplY3RvcjogSW5qZWN0b3IsXHJcbiAgICBwcml2YXRlIG1vZGFsU2VydmljZTogQnNNb2RhbFNlcnZpY2UsXHJcbiAgICBwcml2YXRlIHJlc29sdmVyOiBDb21wb25lbnRGYWN0b3J5UmVzb2x2ZXIsXHJcbiAgICBwcml2YXRlIGV2ZW50QnVzOiBFdmVudEJ1c1NlcnZpY2UsXHJcbiAgICBAT3B0aW9uYWwoKSBwcml2YXRlIGNkcjogQ2hhbmdlRGV0ZWN0b3JSZWYsXHJcbiAgICBASW5qZWN0KExPQ0FMRV9JRCkgcHJpdmF0ZSBsb2NhbGVJZDogc3RyaW5nLFxyXG4gICAgQEluamVjdChXRl9MQU5HX1JFU09VUkNFUykgcHJpdmF0ZSByZXNvdXJjZXM6IGFueSxcclxuICAgIEBPcHRpb25hbCgpIHByaXZhdGUgbG9jYWxlUGlwZTogV2ZMb2NhbGVQaXBlLFxyXG4gICkge1xyXG4gICAgdGhpcy5sb2NhbGVQaXBlID0gdGhpcy5sb2NhbGVQaXBlIHx8IG5ldyBXZkxvY2FsZVBpcGUobG9jYWxlSWQsIHJlc291cmNlcyk7XHJcbiAgICB0aGlzLmNkciA9IHRoaXMuY2RyIHx8IHRoaXMuaW5qZWN0b3IuZ2V0KENoYW5nZURldGVjdG9yUmVmLCBudWxsKTtcclxuICAgIHRoaXMudmVyaWZ5U2VyID0gdGhpcy5pbmplY3Rvci5nZXQoVmVyaWZ5RGV0YWlsU2VydmljZSk7XHJcbiAgICB0aGlzLmxvY2FsZUlkID0gdGhpcy5pbmplY3Rvci5nZXQoTE9DQUxFX0lELCBudWxsKSB8fCB0aGlzLmxvY2FsZUlkO1xyXG4gICAgV2ZWYWxpZGF0b3JBZGFwdGVyLmxvY2FsZVBpcGUgPSB0aGlzLmxvY2FsZVBpcGU7XHJcbiAgICBmb3JrSm9pbih0aGlzLnVpU3RhdGUuZ2V0RW5hYmxlQWRtaW5PcmdBdXQoKSwgdGhpcy51aVN0YXRlLmdldEVuYWJsZUZsb3dGb3JtQXV0KCkpLnN1YnNjcmliZShyZSA9PiB7XHJcbiAgICAgIHRoaXMudWlTdGF0ZS5lbmFibGVBZG1pbk9yZ0F1dCA9IHJlWzBdO1xyXG4gICAgICB0aGlzLnVpU3RhdGUuZW5hYmxlRmxvd0Zvcm1BdXQgPSByZVsxXTtcclxuICAgICAgaWYgKCF0aGlzLnVpU3RhdGUuZW5hYmxlQWRtaW5PcmdBdXQpIHtcclxuICAgICAgICB0aGlzLnVpU3RhdGUuZ2V0QWRtaW5pc3RyYXRvckluZm8oKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG4gIHNob3dNb2RlbEJ1dHRvbiA9IGZhbHNlO1xyXG4gIG5nT25Jbml0KCkge1xyXG4gICAgdGhpcy5wcm9jTmFtZVRpdGxlID0gdGhpcy5wcm9jZXNzSW5mbz90aGlzLnByb2Nlc3NJbmZvLnByb2Nlc3NOYW1lOnRoaXMucnRQcm9jZXNzSW5mby5wcm9jTmFtZTtcclxuICAgIGlmKHRoaXMucnRQcm9jZXNzSW5mbyAmJiB0aGlzLnJ0UHJvY2Vzc0luZm8ucnRQcm9jRGVmSWQpIHtcclxuICAgICAgdGhpcy51aVN0YXRlLnByb2NEZWZJZCA9IHRoaXMucnRQcm9jZXNzSW5mby5ydFByb2NEZWZJZDtcclxuICAgIH1cclxuICAgIHRoaXMuYWRkRXZlbnRCdXNMaXN0ZW5lcigpO1xyXG4gICAgdGhpcy51aVN0YXRlLmluaXRVSVN0YXRlKCk7XHJcbiAgICB0aGlzLnNob3dMb2FkaW5nKCk7XHJcbiAgICB0aGlzLmFkZFByb3BlcnR5Q2hhbmdlZEhhbmRsZXIoKTtcclxuICAgIC8vIOiOt+WPlua2iOaBr+WIl+ihqFxyXG4gICAgdGhpcy51aVN0YXRlLmdldE1lc3NhZ2VDaGFubmVscygpO1xyXG4gICAgZm9jdXMoKTtcclxuICAgIGRvY3VtZW50LmJvZHkuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIChuKSA9PiB7XHJcbiAgICAgIGlmICghdGhpcy5zaG93TW9kZWxCdXR0b24gJiYgbi5zaGlmdEtleSAmJiAnU2xhc2gnID09PSBuLmNvZGUpIHtcclxuICAgICAgICB0aGlzLnNob3dNb2RlbEJ1dHRvbiA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5ub3RpZnkuc3VjY2Vzcyh0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKFwicHJvY2Vzc0VkaXRvci5zaG93QnV0dG9uXCIpKTtcclxuICAgICAgICB0aGlzLnZpZXdQcm9jTW9kZWwoKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICB0aGlzLmNkciAmJiB0aGlzLmNkci5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICB0aGlzLmNyZWF0ZUVkaXRvclVpKCk7XHJcbiAgfVxyXG5cclxuICBjcmVhdGVFZGl0b3JVaSgpIHtcclxuICAgIHRoaXMuc2VydmljZS5nZXRHZW5lcmFsQ29uZmlnKCkuc3Vic2NyaWJlKFxyXG4gICAgICAoZ2VuZXJhbENvbmZpZykgPT4ge1xyXG4gICAgICAgIGNvbnN0IHByb2Nlc3NDYXRlZ29yeUlkOiBzdHJpbmcgPSB0aGlzLl90aW1lID09PSBQcm9jZXNzVGltZS5ydCA/IHRoaXMucnRQcm9jZXNzSW5mby5mbG93Rm9ybUlkIDogdGhpcy5wcm9jZXNzSW5mby5mbG93Rm9ybUlkO1xyXG4gICAgICAgIHRoaXMudmlld01vZGVsLmdldFByb2Nlc3NDYXRlZ29yeShwcm9jZXNzQ2F0ZWdvcnlJZCkuc3Vic2NyaWJlKFxyXG4gICAgICAgICAgKHByb2NDYXRlZ29yeTogRmxvd0Zvcm1FbnRpdHkpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgYml6Q2F0ZWdvcnlJZCA9IHRoaXMuX3RpbWUgPT09IFByb2Nlc3NUaW1lLmR0ID8gcHJvY0NhdGVnb3J5LmJ1c2luZXNzT2JqZWN0SWQgOiB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgIHRoaXMuc2VydmljZS5nZXRGb3JtRm9ybWF0KGJpekNhdGVnb3J5SWQpLnBpcGUoXHJcbiAgICAgICAgICAgICAgc3dpdGNoTWFwKFxyXG4gICAgICAgICAgICAgICAgKGZvcm1Gb3JtYXRzKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgIHRoaXMuY2RyICYmIHRoaXMuY2RyLmRldGVjdENoYW5nZXMoKTtcclxuICAgICAgICAgICAgICAgICAgdGhpcy5lZGl0b3JVaSA9IG5ldyBXZkVkaXRvclVpKHRoaXMuX3RpbWUsIHRoaXMuYWN0aW9uLCB0aGlzLmVkaXRvclVpQ29udGFpbmVyRVIubmF0aXZlRWxlbWVudCxcclxuICAgICAgICAgICAgICAgICAgdGhpcy5pbmplY3RvciwgdGhpcy5tb2RhbFNlcnZpY2UsIHRoaXMucmVzb2x2ZXIpO1xyXG4gICAgICAgICAgICAgICAgICB0aGlzLmVkaXRvclVpLm11bHRpTGFuZ0VuYWJsZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICB0aGlzLmVkaXRvclVpLmxhbmdDb2RlID0gdGhpcy5sb2NhbGVJZDtcclxuICAgICAgICAgICAgICAgICAgdGhpcy5lZGl0b3JVaS5iaXpDYXRlZ29yeUlkID0gYml6Q2F0ZWdvcnlJZDtcclxuICAgICAgICAgICAgICAgICAgdGhpcy5lZGl0b3JVaS5tb2RlID0gdGhpcy5tb2RlO1xyXG4gICAgICAgICAgICAgICAgICB0aGlzLmVkaXRvclVpLnNjZW5lID0gdGhpcy51aVN0YXRlLnNjZW5lO1xyXG4gICAgICAgICAgICAgICAgICB0aGlzLmVkaXRvclVpLnByb2NUeXBlID0gdGhpcy5wcm9jVHlwZTtcclxuICAgICAgICAgICAgICAgICAgdGhpcy5lZGl0b3JVaS5nZW5lcmFsQ29uZmlnID0gZ2VuZXJhbENvbmZpZztcclxuICAgICAgICAgICAgICAgICAgdGhpcy5lZGl0b3JVaS5mb3JtRm9ybWF0cyA9IGZvcm1Gb3JtYXRzO1xyXG4gICAgICAgICAgICAgICAgICByZXR1cm4gb2Yoe30pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICAgIC8vIDIwMjMtNS0zMCDkuLrkuobop6PlhrPnvZHnu5zovoPlt67lnLrmma/kuIvnmoTliqDovb3pl67popjkv67mlLnkuobliqDovb3pobrluo9cclxuICAgICAgICAgICAgICAucGlwZShkZWxheSgyMDApKVxyXG4gICAgICAgICAgICAgIC5zdWJzY3JpYmUoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5vcGVuUHJvY0NvbnRlbnQoKTtcclxuICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgIH1cclxuICAgICAgICApO1xyXG4gICAgICB9XHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgYWRkRWRpdG9yVWlMaXN0ZW5lcnMoZWRpdG9yVWk6IFdmRWRpdG9yVWkpIHtcclxuICAgIGVkaXRvclVpLmFkZExpc3RlbmVyKFBtZkV2ZW50cy5TaG93UHJvcGVydHksIChzZW5kZXIsIGV2dDogTXhHcmFwaE5TLm14RXZlbnRPYmplY3QpID0+IHtcclxuICAgICAgY29uc3QgY2VsbHM6IENlbGxbXSA9IGV2dC5nZXRQcm9wZXJ0eShcImNlbGxzXCIpO1xyXG4gICAgICB0aGlzLnZpZXdNb2RlbC5zZXRQcm9wZXJ0eSh0aGlzLmVkaXRvclVpLmdldEZhcnJpc1Byb3BDb25maWcoY2VsbHMpKTtcclxuICAgIH0pO1xyXG4gICAgLy8g5bel5YW3566x6IqC54K55ouW5Yqo6Iez55S75biD5ZCO5pu05pawXHJcbiAgICBlZGl0b3JVaS5ncmFwaC5hZGRMaXN0ZW5lcihQbWZFdmVudHMuQ2VsbHNJbnNlcnRlZCwgKHNlbmRlciwgZXZ0OiBNeEdyYXBoTlMubXhFdmVudE9iamVjdCkgPT4ge1xyXG4gICAgICB0aGlzLnVpU3RhdGUuZ2V0VXNlckFjdExpc3QodGhpcy5lZGl0b3JVaS5nZXRBY3Rpdml0aWVzKCkpO1xyXG4gICAgICB0aGlzLnVpU3RhdGUuZ2V0Tm90aWZ5RXZlbnRMaXN0KHRoaXMuZWRpdG9yVWkuZ2V0Tm90aWZ5RXZlbnRzKCkpO1xyXG4gICAgICB0aGlzLnVpU3RhdGUuZ2V0RW5kRXZlbnRMaXN0KHRoaXMuZWRpdG9yVWkuZ2V0RW5kRXZlbnRzKCkpO1xyXG4gICAgfSk7XHJcbiAgICAvLyDliKDpmaToioLngrnml7bop6blj5Hmm7TmlrBcclxuICAgIGVkaXRvclVpLmdyYXBoLmFkZExpc3RlbmVyKG14RXZlbnQuQ0VMTFNfUkVNT1ZFRCwgKCkgPT4ge1xyXG4gICAgICB0aGlzLnVpU3RhdGUuZ2V0VXNlckFjdExpc3QodGhpcy5lZGl0b3JVaS5nZXRBY3Rpdml0aWVzKCkpO1xyXG4gICAgICB0aGlzLnVpU3RhdGUuZ2V0Tm90aWZ5RXZlbnRMaXN0KHRoaXMuZWRpdG9yVWkuZ2V0Tm90aWZ5RXZlbnRzKCkpO1xyXG4gICAgICB0aGlzLnVpU3RhdGUuZ2V0RW5kRXZlbnRMaXN0KHRoaXMuZWRpdG9yVWkuZ2V0RW5kRXZlbnRzKCkpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDmt7vliqDkuovku7bmgLvnur/nm5HlkKxcclxuICAgKi9cclxuICBwcml2YXRlIGFkZEV2ZW50QnVzTGlzdGVuZXIoKSB7XHJcbiAgICB0aGlzLmV2ZW50QnVzLm9uKEV2ZW50QnVzS2V5cy5iYXRjaENvcHlQcm9wZXJ0eSwgZGF0YSA9PiB7XHJcbiAgICAgIGlmIChkYXRhKSB7XHJcbiAgICAgICAgdGhpcy5lZGl0b3JVaS5iYXRjaENvcHlQcm9wZXJ0eShkYXRhKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICB0aGlzLmV2ZW50QnVzLm9uKEV2ZW50QnVzS2V5cy5iYXRjaFNldFByb3BlcnR5LCBkYXRhID0+IHtcclxuICAgICAgaWYgKGRhdGEpIHtcclxuICAgICAgICB0aGlzLmVkaXRvclVpLmJhdGNoU2V0UHJvcGVydHkoZGF0YSk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBhZGRQcm9wZXJ0eUNoYW5nZWRIYW5kbGVyKCk6IGJvb2xlYW4ge1xyXG4gICAgdGhpcy5wcm9wZXJ0eVBhbmVsLnByb3BlcnR5Q2hhbmdlZC5zdWJzY3JpYmUoKGRhdGE6IGFueSkgPT4ge1xyXG4gICAgICB0aGlzLnVwZGF0ZUNoYW5nZVByb3BlcnR5KGRhdGEpO1xyXG4gICAgfSk7XHJcbiAgICB0aGlzLnByb3BlcnR5UGFuZWwuc3VibWl0TW9kYWwuc3Vic2NyaWJlKChkYXRhOiBhbnkpID0+IHtcclxuICAgICAgdGhpcy51cGRhdGVDaGFuZ2VQcm9wZXJ0eShkYXRhLmNoYW5nZU9iamVjdCwgZGF0YS5wYXJhbWV0ZXJzKTtcclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiBmYWxzZTsgLy8g6Ziy5q2i5YaS5rOhXHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDmm7TmlrDlsZ7mgKdcclxuICAgKi9cclxuICBwcml2YXRlIHVwZGF0ZUNoYW5nZVByb3BlcnR5KGRhdGEsIHBhcmFtZXRlcnMgPSBudWxsKTogYW55IHtcclxuICAgIC8vIOabtOaWsOeVjOmdouWPmOabtOeKtuaAgVxyXG4gICAgdGhpcy5jaGFuZ2VkRmxhZyA9IGZhbHNlO1xyXG5cclxuICAgIGRhdGEuSWQgPSB0aGlzLnVpU3RhdGUucHJvcGVydHlEYXRhLklkO1xyXG4gICAgaWYgKHBhcmFtZXRlcnMpIHtcclxuICAgICAgZGF0YS5wYXJhbWV0ZXJzID0gcGFyYW1ldGVycztcclxuICAgIH1cclxuICAgIHN3aXRjaCAoZGF0YS5wcm9wZXJ0eUlEKSB7XHJcbiAgICAgIGNhc2UgUHJvY2Vzc1Byb3BlcnR5S2V5cy5FbnRyeUZvcm06XHJcbiAgICAgICAgdGhpcy5iaW5kRW50cnlGb3JtSW5mbyhkYXRhKTtcclxuICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSBVc2VyQWN0aXZpdHlQcm9wZXJ0eUtleXMuQXBwcm92YWxJdGVtczpcclxuICAgICAgICB0aGlzLmVkaXRvclVpLnVwZGF0ZVByb3BlcnR5KGRhdGEpO1xyXG4gICAgICAgIHRoaXMuYWN0aXZpdHkuYnVpbGRDb3VudGVyU2lnblZhcmlhYmxlcyhkYXRhLnByb3BlcnR5VmFsdWUpO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlIFVzZXJBY3Rpdml0eVByb3BlcnR5S2V5cy5Db21wbGV0ZVN0cmF0ZWd5OlxyXG4gICAgICAgIHRoaXMuYmVmb3JlQ29tcGxldGVTdHJhdGVneUNoYW5nZShkYXRhKS5zdWJzY3JpYmUoYiA9PiB7XHJcbiAgICAgICAgICBpZiAoYikge1xyXG4gICAgICAgICAgICB0aGlzLmVkaXRvclVpLnVwZGF0ZVByb3BlcnR5KGRhdGEpO1xyXG4gICAgICAgICAgICB0aGlzLmNvbXBsZXRlU3RyYXRlZ3lDaGFuZ2VkKGRhdGEucHJvcGVydHlWYWx1ZSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICB0aGlzLnZpZXdNb2RlbC5zZXRQcm9wZXJ0eSh0aGlzLmVkaXRvclVpLnJlZnJlc2hQcm9wZXJ0eShkYXRhKSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIC8vIHRvZG/vvJrlpJrkuKrmtLvliqjlhbfmnInlkIzlkI3lsZ7mgKfml7bvvIzlpoLkvZXmm7TlkIjnkIblrprkuYlQcm9wZXJ0eUtlee+8n1xyXG4gICAgICAvLyBjYXNlIFVzZXJBY3Rpdml0eVByb3BlcnR5S2V5cy5vdGhlckFzc2lnbk5vZGVzOlxyXG4gICAgICAvLyBjYXNlIFN0YXJ0QWN0aXZpdHlQcm9wZXJ0eUtleXMub3RoZXJBc3NpZ25Ob2RlczpcclxuICAgICAgLy8gICBpZiAoZGF0YS5wcm9wZXJ0eVZhbHVlKSB7XHJcbiAgICAgIC8vICAgICB0aGlzLmVkaXRvclVpLnVwZGF0ZVByb3BlcnR5KGRhdGEpO1xyXG4gICAgICAvLyAgICAgdGhpcy5PdGhlckFzc2lnbk5vZGVzQ2hhbmdlZChkYXRhKTtcclxuICAgICAgLy8gICB9IGVsc2Uge1xyXG4gICAgICAvLyAgICAgdGhpcy5lZGl0b3JVaS51cGRhdGVQcm9wZXJ0eShkYXRhKTtcclxuICAgICAgLy8gICB9XHJcbiAgICAgIC8vICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgVXNlckFjdGl2aXR5UHJvcGVydHlLZXlzLlNpZ25SdWxlOlxyXG4gICAgICAgIHRoaXMuZWRpdG9yVWkudXBkYXRlUHJvcGVydHkoZGF0YSk7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIC8vIHRvZG/vvJrlpJrkuKrmtLvliqjlhbfmnInlkIzlkI3lsZ7mgKfml7bvvIzlpoLkvZXmm7TlkIjnkIblrprkuYlQcm9wZXJ0eUtlee+8n1xyXG4gICAgICBjYXNlIFByb2Nlc3NQcm9wZXJ0eUtleXMubWVzc2FnZU5vdGljZTogLy8g5raI5oGv6YCa55+lXHJcbiAgICAgIGNhc2UgVXNlckFjdGl2aXR5UHJvcGVydHlLZXlzLm1lc3NhZ2VOb3RpY2U6IC8vIOa2iOaBr+mAmuefpVxyXG4gICAgICBjYXNlIE1lc3NhZ2VBY3Rpdml0eVByb3BlcnR5S2V5cy5tZXNzYWdlTm90aWNlOiAvLyDmtojmga/pgJrnn6VcclxuICAgICAgY2FzZSBOb3RpZnlBY3Rpdml0eVByb3BlcnR5S2V5cy5tZXNzYWdlTm90aWNlOiAvLyDmtojmga/pgJrnn6VcclxuICAgICAgICBpZiAoZGF0YS5wcm9wZXJ0eVZhbHVlLmlzQmF0Y2hDb3B5KSB7IC8vIOaYr+WQpuaYr+a2iOaBr+mAmuefpeWxnuaAp+aJuemHj+WkjeWItlxyXG4gICAgICAgICAgdGhpcy5lZGl0b3JVaS5iYXRjaENvcHlQcm9wZXJ0eShkYXRhKTtcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmVkaXRvclVpLnVwZGF0ZVByb3BlcnR5KGRhdGEpO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlIFByb2Nlc3NQcm9wZXJ0eUtleXMuc3RhcnRNb2RlOlxyXG4gICAgICAgIHRoaXMudXBkYXRlU3RhcnRNb2RlKGRhdGEpO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICBkZWZhdWx0OlxyXG4gICAgICAgIHRoaXMuZWRpdG9yVWkudXBkYXRlUHJvcGVydHkoZGF0YSk7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICB9XHJcbiAgICB0aGlzLnVpU3RhdGUuZ2V0VXNlckFjdExpc3QodGhpcy5lZGl0b3JVaS5nZXRBY3Rpdml0aWVzKCkpO1xyXG4gICAgdGhpcy51aVN0YXRlLmdldEVuZEV2ZW50TGlzdCh0aGlzLmVkaXRvclVpLmdldEVuZEV2ZW50cygpKTtcclxuICAgIHRoaXMudWlTdGF0ZS5nZXROb3RpZnlFdmVudExpc3QodGhpcy5lZGl0b3JVaS5nZXROb3RpZnlFdmVudHMoKSk7XHJcbiAgICB0aGlzLnVpU3RhdGUuZ2V0U3RhcnRNb2RlKHRoaXMuZWRpdG9yVWkuZ2V0U3RhcnRNb2RlKCkpO1xyXG4gICAgaWYodGhpcy5lZGl0b3JVaS5nZXRTdGFydE1vZGUoKSA9PSBTdGFydE1vZGUuU1VCX1BST0NFU1MpIHtcclxuICAgICAgdGhpcy51aVN0YXRlLnN1YkFjdGl2aXR5Q29udGV4dCA9IHRoaXMudWlTdGF0ZS5zdWJBY3Rpdml0eUNvbnRleHQuY29uY2F0KHRoaXMudWlTdGF0ZS5zdWJQcm9jZXNzRWxlbWVudENvbnRleHQpO1xyXG4gICAgfWVsc2Uge1xyXG4gICAgICB0aGlzLnVpU3RhdGUuc3ViQWN0aXZpdHlDb250ZXh0ID0gdGhpcy51aVN0YXRlLnN1YkFjdGl2aXR5Q29udGV4dC5maWx0ZXIoeCA9PiB0aGlzLnVpU3RhdGUuc3ViUHJvY2Vzc0VsZW1lbnRDb250ZXh0LnNvbWUoeSA9PiB5LmtleSAhPSB4LmtleSkpXHJcbiAgICB9XHJcbiAgICB0aGlzLnZpZXdNb2RlbC5zZXRQcm9wZXJ0eSh0aGlzLmVkaXRvclVpLnJlZnJlc2hQcm9wZXJ0eShkYXRhKSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDnu5HlrprmtYHnqIvliIbnsbvnmoTlj4LmlbDliJfooajvvIzmtYHnqIvmnoTku7bvvIzooajljZXotYvlgLxcclxuICAgKiBAcGFyYW0gZGF0YVxyXG4gICAqL1xyXG4gIHByaXZhdGUgYmluZEVudHJ5Rm9ybUluZm8oZGF0YSkge1xyXG4gICAgY29uc3QgZmxvd2Zvcm1JZDogc3RyaW5nID0gZGF0YS5wcm9wZXJ0eVZhbHVlLmlkO1xyXG4gICAgaWYgKGZsb3dmb3JtSWQpIHtcclxuICAgICAgdGhpcy52aWV3TW9kZWwuZ2V0Rmxvd0Zvcm1JbmZvQnlJZChmbG93Zm9ybUlkKS5zdWJzY3JpYmUoKGluZm86IEZsb3dGb3JtSW5mbykgPT4ge1xyXG4gICAgICAgIGRhdGEuZmxvd0Zvcm0gPSBpbmZvLmZsb3dGb3JtO1xyXG4gICAgICAgIGRhdGEuZm9ybWFsUGFyYW1ldGVycyA9IGluZm8uZm9ybWFsUGFyYW1ldGVycztcclxuICAgICAgICBkYXRhLnByb2Nlc3NCaXpDb21wb25uZXRzID0gaW5mby5iaXpDb21wb25lbnRzO1xyXG4gICAgICAgIGRhdGEuZXhlY3V0ZUZvcm1zID0gW107XHJcbiAgICAgICAgaW5mby5leGN1dGVGb3Jtcy5mb3JFYWNoKGZvcm0gPT4ge1xyXG4gICAgICAgICAgaWYgKGZvcm0uaXNEZWZhdWx0KSB7XHJcbiAgICAgICAgICAgIC8vIOa1geeoi+e7keWumum7mOiupOWNleaNrlxyXG4gICAgICAgICAgICBjb25zdCBleGVjdXRlRm9ybXMgPSB0aGlzLkNvbnZlcnRFeGVjdXRlRm9ybShmb3JtKTtcclxuICAgICAgICAgICAgZGF0YS5leGVjdXRlRm9ybXMgPSBkYXRhLmV4ZWN1dGVGb3Jtcy5jb25jYXQoZXhlY3V0ZUZvcm1zKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICBkYXRhLmN1c3RvbWl6ZUFjdGlvbnMgPSBpbmZvLmN1c3RvbWl6ZUFjdGlvbnMuZmlsdGVyKGEgPT4gYS5pc0FsbCA9PT0gdHJ1ZSkubWFwKGEgPT4gKHtcclxuICAgICAgICAgIGlkOiBhLmlkLCBjb2RlOiBhLmNvZGUsIG5hbWU6IGEubmFtZSwgdGVybWluYWxUeXBlOiBhLnRlcm1pbmFsLFxyXG4gICAgICAgICAgYWN0dWFsUGFyYW1ldGVyczogYS5hY3R1YWxQYXJhbWV0ZXJzLm1hcChwID0+ICh7XHJcbiAgICAgICAgICAgIE5hbWU6IHAuY29kZSwgVmFsdWU6IHAudmFsdWUsIFZhbHVlVGV4dDogcC5uYW1lLCBUYWc6ICdleHByZXNzaW9uJ1xyXG4gICAgICAgICAgfSkpXHJcbiAgICAgICAgfSkpO1xyXG4gICAgICAgIC8vIOWKoOi9veS4muWKoea0u+WKqOmdouadv1xyXG4gICAgICAgIHRoaXMuZWRpdG9yVWkubG9hZEJpekFjdGl2aXRpZXMoaW5mby5iaXpBY3Rpdml0aWVzIHx8IFtdKTtcclxuICAgICAgICB0aGlzLnNlcnZpY2UuZ2V0Qml6Q21wKCkuc3Vic2NyaWJlKChjbXBzKSA9PiB7XHJcbiAgICAgICAgICBkYXRhLmJpekNtcHMgPSBjbXBzO1xyXG4gICAgICAgICAgdGhpcy5lZGl0b3JVaS51cGRhdGVQcm9wZXJ0eShkYXRhKTtcclxuXHJcbiAgICAgICAgICB0aGlzLnVpU3RhdGUuZ2V0VXNlckFjdExpc3QodGhpcy5lZGl0b3JVaS5nZXRBY3Rpdml0aWVzKCkpO1xyXG4gICAgICAgICAgdGhpcy51aVN0YXRlLmdldEVuZEV2ZW50TGlzdCh0aGlzLmVkaXRvclVpLmdldEVuZEV2ZW50cygpKTtcclxuICAgICAgICAgIHRoaXMudWlTdGF0ZS5nZXROb3RpZnlFdmVudExpc3QodGhpcy5lZGl0b3JVaS5nZXROb3RpZnlFdmVudHMoKSk7XHJcbiAgICAgICAgICB0aGlzLnVpU3RhdGUuZ2V0U3RhcnRNb2RlKHRoaXMuZWRpdG9yVWkuZ2V0U3RhcnRNb2RlKCkpO1xyXG4gICAgICAgICAgaWYodGhpcy5lZGl0b3JVaS5nZXRTdGFydE1vZGUoKSA9PSBTdGFydE1vZGUuU1VCX1BST0NFU1MpIHtcclxuICAgICAgICAgICAgdGhpcy51aVN0YXRlLnN1YkFjdGl2aXR5Q29udGV4dCA9IHRoaXMudWlTdGF0ZS5zdWJBY3Rpdml0eUNvbnRleHQuY29uY2F0KHRoaXMudWlTdGF0ZS5zdWJQcm9jZXNzRWxlbWVudENvbnRleHQpO1xyXG4gICAgICAgICAgfWVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLnVpU3RhdGUuc3ViQWN0aXZpdHlDb250ZXh0ID0gdGhpcy51aVN0YXRlLnN1YkFjdGl2aXR5Q29udGV4dC5maWx0ZXIoeCA9PiB0aGlzLnVpU3RhdGUuc3ViUHJvY2Vzc0VsZW1lbnRDb250ZXh0LnNvbWUoeSA9PiB5LmtleSAhPSB4LmtleSkpXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICB0aGlzLnZpZXdNb2RlbC5zZXRQcm9wZXJ0eSh0aGlzLmVkaXRvclVpLnJlZnJlc2hQcm9wZXJ0eShkYXRhKSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgdXBkYXRlU3RhcnRNb2RlKGRhdGE6IGFueSkge1xyXG4gICAgY29uc3QgYnBtbk1vZGVsID0gdGhpcy5lZGl0b3JVaS5ncmFwaC5icG1uTW9kZWw7XHJcbiAgICBjb25zdCBleHRlbmRFbGVtZW50cyA9IGJwbW5Nb2RlbC5EZWZhdWx0UHJvY2Vzcy5HZXRFeHRlbnNpb25FbGVtZW50cygpO1xyXG4gICAgaWYgKGV4dGVuZEVsZW1lbnRzICE9PSBudWxsICYmIGV4dGVuZEVsZW1lbnRzLmxlbmd0aCA+IDApIHtcclxuICAgICAgY29uc3QgcHJvY0hlYWRlciA9IGV4dGVuZEVsZW1lbnRzLmZpbHRlcihlID0+IGUgaW5zdGFuY2VvZiBQcm9jZXNzSGVhZGVyKSBhcyBQcm9jZXNzSGVhZGVyW107XHJcbiAgICAgIGxldCBmbG93Rm9ybUtleSA9IHByb2NIZWFkZXJbMF0uQml6RGVmS2V5O1xyXG4gICAgICB0aGlzLnNlcnZpY2UuZ2V0QWxsQml6Q21wKGZsb3dGb3JtS2V5KS5zdWJzY3JpYmUoKGFsbEJpekNtcHMpID0+IHtcclxuICAgICAgICB0aGlzLnNlcnZpY2UuZ2V0Qml6Q21wKCkuc3Vic2NyaWJlKChiaXpDbXBzKSA9PiB7XHJcbiAgICAgICAgICBkYXRhLmFsbEJpekNtcHMgPSBhbGxCaXpDbXBzO1xyXG4gICAgICAgICAgZGF0YS5iaXpDbXBzID0gYml6Q21wcztcclxuXHJcbiAgICAgICAgICB0aGlzLmVkaXRvclVpLnVwZGF0ZVByb3BlcnR5KGRhdGEpO1xyXG5cclxuICAgICAgICAgIHRoaXMudWlTdGF0ZS5nZXRVc2VyQWN0TGlzdCh0aGlzLmVkaXRvclVpLmdldEFjdGl2aXRpZXMoKSk7XHJcbiAgICAgICAgICB0aGlzLnVpU3RhdGUuZ2V0RW5kRXZlbnRMaXN0KHRoaXMuZWRpdG9yVWkuZ2V0RW5kRXZlbnRzKCkpO1xyXG4gICAgICAgICAgdGhpcy51aVN0YXRlLmdldFN0YXJ0TW9kZSh0aGlzLmVkaXRvclVpLmdldFN0YXJ0TW9kZSgpKTtcclxuICAgICAgICAgIGlmKHRoaXMuZWRpdG9yVWkuZ2V0U3RhcnRNb2RlKCkgPT0gU3RhcnRNb2RlLlNVQl9QUk9DRVNTKSB7XHJcbiAgICAgICAgICAgIHRoaXMudWlTdGF0ZS5zdWJBY3Rpdml0eUNvbnRleHQgPSB0aGlzLnVpU3RhdGUuc3ViQWN0aXZpdHlDb250ZXh0LmNvbmNhdCh0aGlzLnVpU3RhdGUuc3ViUHJvY2Vzc0VsZW1lbnRDb250ZXh0KTtcclxuICAgICAgICAgIH1lbHNlIHtcclxuICAgICAgICAgICAgdGhpcy51aVN0YXRlLnN1YkFjdGl2aXR5Q29udGV4dCA9IHRoaXMudWlTdGF0ZS5zdWJBY3Rpdml0eUNvbnRleHQuZmlsdGVyKHggPT4gdGhpcy51aVN0YXRlLnN1YlByb2Nlc3NFbGVtZW50Q29udGV4dC5zb21lKHkgPT4geS5rZXkgIT0geC5rZXkpKVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgdGhpcy52aWV3TW9kZWwuc2V0UHJvcGVydHkodGhpcy5lZGl0b3JVaS5yZWZyZXNoUHJvcGVydHkoZGF0YSkpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgbm90ZShyZWNvcmQ6IHN0cmluZykge1xyXG4gICAgY29uc3QgY29tcEZhY3RvcnkgPSB0aGlzLnJlc29sdmVyLnJlc29sdmVDb21wb25lbnRGYWN0b3J5KE5vdGVDb21wb25lbnQpO1xyXG4gICAgY29uc3QgY29tcFJlZiA9IGNvbXBGYWN0b3J5LmNyZWF0ZSh0aGlzLmluamVjdG9yKTtcclxuXHJcbiAgICBjb21wUmVmLmluc3RhbmNlLnJlY29yZCA9IHJlY29yZDtcclxuXHJcbiAgICBjb25zdCBtb2RhbENvbmZpZzogTW9kYWxPcHRpb25zID0ge1xyXG4gICAgICB0aXRsZTogdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybShcInByb2Nlc3NFZGl0b3IuY2hhbmdlUmVjb3JkXCIpLFxyXG4gICAgICB3aWR0aDogODAwLFxyXG4gICAgICBoZWlnaHQ6IDUyMCxcclxuICAgICAgc2hvd0J1dHRvbnM6IHRydWUsXHJcbiAgICAgIGJ1dHRvbnM6IGNvbXBSZWYuaW5zdGFuY2UuZm9vdGVyXHJcbiAgICB9O1xyXG4gICAgY29uc3QgZGlhbG9nID0gdGhpcy5tb2RhbFNlcnZpY2Uuc2hvdyhjb21wUmVmLCBtb2RhbENvbmZpZyk7XHJcbiAgICBjb21wUmVmLmluc3RhbmNlLmNhbmNlbC5zdWJzY3JpYmUoJGV2ZW50ID0+IGRpYWxvZy5jbG9zZSgpKTtcclxuICAgIGNvbXBSZWYuaW5zdGFuY2Uuc3VibWl0LnN1YnNjcmliZSgoZGF0YTogc3RyaW5nKSA9PiB7XHJcbiAgICAgIC8vIOabtOaWsOa1geeoi+iusOW9lVxyXG4gICAgICB0aGlzLmVkaXRvclVpLmdyYXBoLmJwbW5Nb2RlbC5EZWZhdWx0UHJvY2Vzcy5Eb2N1bWVudGF0aW9uID0gZGF0YTtcclxuICAgICAgZGlhbG9nLmNsb3NlKCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgb3BlblByb2NDb250ZW50KCkge1xyXG4gICAgaWYgKHRoaXMudGltZSA9PT0gUHJvY2Vzc1RpbWUuZHQpIHtcclxuICAgICAgaWYgKHRoaXMucHJvY2Vzc0luZm8pIHtcclxuICAgICAgICBpZiAodGhpcy5wcm9jZXNzSW5mby5wcm9jZXNzS2V5ID09PSBFdmVudEJ1c0tleXMubmV3ICYmIHRoaXMucHJvY2Vzc0luZm8uZmxvd0Zvcm1JZCkge1xyXG4gICAgICAgICAgdGhpcy5vcGVuTmV3UHJvY2Vzcyh0aGlzLnByb2Nlc3NJbmZvLmZsb3dGb3JtSWQpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAvLyBUT0RP77ya6aaW5YWI6I635Y+W5rWB56iL5YiG57G75L+h5oGv77yM56Gu5L+d5rWB56iL5YiG57G75ZKM5rWB56iL5p6E5Lu26I635Y+W5Yiw77yI5Lya56iN5b6u5b2x5ZON6K6+6K6h5Zmo5omT5byA6YCf5bqm77yJXHJcbiAgICAgICAgICB0aGlzLnZpZXdNb2RlbC5nZXRGbG93Rm9ybUluZm9CeUlkKHRoaXMucHJvY2Vzc0luZm8uZmxvd0Zvcm1JZCkuc3Vic2NyaWJlKChpbmZvOiBGbG93Rm9ybUluZm8pID0+IHtcclxuICAgICAgICAgICAgdGhpcy5lZGl0b3JVaS5sb2FkQml6QWN0aXZpdGllcyhpbmZvLmJpekFjdGl2aXRpZXMgfHwgW10pO1xyXG4gICAgICAgICAgICB0aGlzLmdldFByb2NDb250ZW50KHRoaXMucHJvY2Vzc0luZm8ucHJvY2Vzc0tleSkuc3Vic2NyaWJlKHJlID0+IHtcclxuICAgICAgICAgICAgICB0aGlzLnVpU3RhdGUuY29udGVudCA9IHRoaXMuY2hlY2tNb2RlbENvbnRlbnQoSlNPTi5zdHJpbmdpZnkocmUpKTtcclxuICAgICAgICAgICAgICB0aGlzLm9wZW5Qcm9jZXNzKHRoaXMudWlTdGF0ZS5jb250ZW50KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oXCJwcm9jZXNzRWRpdG9yLm5vRHRJbmZvXCIpKTtcclxuICAgICAgfVxyXG4gICAgfSBlbHNlIGlmICh0aGlzLnRpbWUgPT09IFByb2Nlc3NUaW1lLnJ0KSB7XHJcbiAgICAgIGlmICh0aGlzLnJ0UHJvY2Vzc0luZm8pIHtcclxuICAgICAgICB0aGlzLnZpZXdNb2RlbC5nZXRGbG93Rm9ybUluZm9CeUlkKHRoaXMucnRQcm9jZXNzSW5mby5mbG93Rm9ybUlkKS5zdWJzY3JpYmUoKGluZm86IEZsb3dGb3JtSW5mbykgPT4ge1xyXG4gICAgICAgICAgdGhpcy5lZGl0b3JVaS5sb2FkQml6QWN0aXZpdGllcyhpbmZvLmJpekFjdGl2aXRpZXMgfHwgW10pO1xyXG4gICAgICAgICAgdGhpcy5nZXRQcm9jQ29udGVudCh0aGlzLnJ0UHJvY2Vzc0luZm8ucnRQcm9jRGVmSWQpLnN1YnNjcmliZShyZSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMudWlTdGF0ZS5jb250ZW50ID0gdGhpcy5jaGVja01vZGVsQ29udGVudChKU09OLnN0cmluZ2lmeShyZSkpO1xyXG4gICAgICAgICAgICB0aGlzLm9wZW5Qcm9jZXNzKHRoaXMudWlTdGF0ZS5jb250ZW50KTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcih0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKFwicHJvY2Vzc0VkaXRvci5ub1J0SW5mb1wiKSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOaWsOWinua1geeoi++8jOWfuuS6jua1geeoi+WIhuexu+iOt+WPluWPguaVsOWIl+ihqO+8jOaehOS7tuWSjOihqOWNlVxyXG4gICAqIEBwYXJhbSBmZklkIOa1geeoi+WIhuexu0lEXHJcbiAgICovXHJcbiAgb3Blbk5ld1Byb2Nlc3MoZmZJZDogc3RyaW5nKSB7XHJcbiAgICB0aGlzLnZpZXdNb2RlbC5nZXRGbG93Rm9ybUluZm9CeUlkKGZmSWQpLnN1YnNjcmliZShcclxuICAgICAgKGluZm86IEZsb3dGb3JtSW5mbykgPT4ge1xyXG4gICAgICAgIGNvbnN0IHByb2Nlc3NCaXpDb21wb25uZXRzOiBCaXpDb21wb25lbnRFbnRpdHlbXSA9IGluZm8uYml6Q29tcG9uZW50cztcclxuICAgICAgICBjb25zdCBjdXN0b21pemVBY3Rpb25zID0gaW5mby5jdXN0b21pemVBY3Rpb25zLmZpbHRlcihhID0+IGEuaXNBbGwgPT09IHRydWUpLm1hcChhID0+ICh7XHJcbiAgICAgICAgICBpZDogYS5pZCwgY29kZTogYS5jb2RlLCBuYW1lOiBhLm5hbWUsIHRlcm1pbmFsVHlwZTogYS50ZXJtaW5hbCxcclxuICAgICAgICAgIGFjdHVhbFBhcmFtZXRlcnM6IGEuYWN0dWFsUGFyYW1ldGVycy5tYXAocCA9PiAoe1xyXG4gICAgICAgICAgICBOYW1lOiBwLmNvZGUsIFZhbHVlOiBwLnZhbHVlLCBWYWx1ZVRleHQ6IHAubmFtZSwgVGFnOiAnZXhwcmVzc2lvbidcclxuICAgICAgICAgIH0pKVxyXG4gICAgICAgIH0pKTtcclxuICAgICAgICBsZXQgZXhlY3V0ZUZvcm1zOiBFeGVjdXRlRm9ybU1vZGVsW10gPSBbXTtcclxuICAgICAgICBpbmZvLmV4Y3V0ZUZvcm1zLmZvckVhY2goZm9ybSA9PiB7XHJcbiAgICAgICAgICBpZiAoZm9ybS5pc0RlZmF1bHQpIHtcclxuICAgICAgICAgICAgLy8g5rWB56iL57uR5a6a6buY6K6k5Y2V5o2uXHJcbiAgICAgICAgICAgIGNvbnN0IGZvcm1zID0gdGhpcy5Db252ZXJ0RXhlY3V0ZUZvcm0oZm9ybSk7XHJcbiAgICAgICAgICAgIGV4ZWN1dGVGb3JtcyA9IGV4ZWN1dGVGb3Jtcy5jb25jYXQoZm9ybXMpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIC8vIOWmguaenOS4jeWtmOWcqOihqOWNleWumuS5ie+8jOmcgOimgeWOu+ihqOWNleagvOW8j+WIl+ihqOWPluS4gOS4i1xyXG4gICAgICAgIGlmIChleGVjdXRlRm9ybXMubGVuZ3RoID09PSAwXHJcbiAgICAgICAgICB8fCBleGVjdXRlRm9ybXMuZmluZEluZGV4KGUgPT4gZS5UZXJtaW5hbFR5cGUgPT09IFRlcm1pbmFsVHlwZS5QQykgPT09IC0xXHJcbiAgICAgICAgICB8fCBleGVjdXRlRm9ybXMuZmluZEluZGV4KGUgPT4gZS5UZXJtaW5hbFR5cGUgPT09IFRlcm1pbmFsVHlwZS5NT0JJTEUpID09PSAtMSkge1xyXG4gICAgICAgICAgdGhpcy52aWV3TW9kZWwuZ2V0Rm9ybUZvcm1hdHNCeUJpekNhdGVnb3J5KCkuc3Vic2NyaWJlKFxyXG4gICAgICAgICAgICAoZm9ybUZvcm1hdHM6IGFueVtdKSA9PiB7XHJcbiAgICAgICAgICAgICAgaWYgKGZvcm1Gb3JtYXRzICYmIGZvcm1Gb3JtYXRzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgIGlmIChleGVjdXRlRm9ybXMuZmluZEluZGV4KGUgPT4gZS5UZXJtaW5hbFR5cGUgPT09IFRlcm1pbmFsVHlwZS5QQykgPT09IC0xKSB7XHJcbiAgICAgICAgICAgICAgICAgIGNvbnN0IGZvcm1Gb3JtYXQgPSBmb3JtRm9ybWF0cy5maWx0ZXIoZiA9PiBmLnRlcm1pbmFsID09PSAnUEMnICYmIGYuc3RhdHVzID09PSAwKVswXTtcclxuICAgICAgICAgICAgICAgICAgaWYgKGZvcm1Gb3JtYXQpIHtcclxuICAgICAgICAgICAgICAgICAgICBleGVjdXRlRm9ybXMucHVzaCh0aGlzLmZvcm1Gb3JtYXQyRXhlY3V0ZUZvcm0oZm9ybUZvcm1hdCkpO1xyXG4gICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoZXhlY3V0ZUZvcm1zLmZpbmRJbmRleChlID0+IGUuVGVybWluYWxUeXBlID09PSBUZXJtaW5hbFR5cGUuTU9CSUxFKSA9PT0gLTEpIHtcclxuICAgICAgICAgICAgICAgICAgY29uc3QgZm9ybUZvcm1hdCA9IGZvcm1Gb3JtYXRzLmZpbHRlcihmID0+IGYudGVybWluYWwgPT09ICdNb2JpbGUnICYmIGYuc3RhdHVzID09PSAwKVswXTtcclxuICAgICAgICAgICAgICAgICAgaWYgKGZvcm1Gb3JtYXQpIHtcclxuICAgICAgICAgICAgICAgICAgICBleGVjdXRlRm9ybXMucHVzaCh0aGlzLmZvcm1Gb3JtYXQyRXhlY3V0ZUZvcm0oZm9ybUZvcm1hdCkpO1xyXG4gICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIGNvbnN0IG5ld1Byb2NJbmZvID0ge1xyXG4gICAgICAgICAgICAgICAgbmFtZTogdGhpcy5wcm9jZXNzSW5mby5wcm9jZXNzTmFtZSxcclxuICAgICAgICAgICAgICAgIGJpek9iaklkOiB0aGlzLnByb2Nlc3NJbmZvLmJpek9iaklkLFxyXG4gICAgICAgICAgICAgICAgZmZJZDogZmZJZCxcclxuICAgICAgICAgICAgICAgIGZmTmFtZTogdGhpcy5wcm9jZXNzSW5mby5mbG93Rm9ybU5hbWUsXHJcbiAgICAgICAgICAgICAgICBzdGFydE1vZGU6IHRoaXMucHJvY2Vzc0luZm8uc3RhcnRNb2RlLFxyXG4gICAgICAgICAgICAgICAgZm9ybWFsUGFyYW1ldGVyczogaW5mby5mb3JtYWxQYXJhbWV0ZXJzLFxyXG4gICAgICAgICAgICAgICAgcHJvY2Vzc0JpekNvbXBvbm5ldHM6IHByb2Nlc3NCaXpDb21wb25uZXRzLFxyXG4gICAgICAgICAgICAgICAgZXhlY3V0ZUZvcm1zOiBleGVjdXRlRm9ybXMsXHJcbiAgICAgICAgICAgICAgICBjdXN0b21pemVBY3Rpb25zOiBjdXN0b21pemVBY3Rpb25zLFxyXG4gICAgICAgICAgICAgICAgcHJvY2Vzc0Rlc2NyaXB0aW9uOiBpbmZvLmZsb3dGb3JtLnByb2Nlc3NEZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgIHRoaXMuY3JlYXRlQnBtbk1vZGVsKGluZm8uYml6QWN0aXZpdGllcyB8fCBbXSwgbmV3UHJvY0luZm8pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICApO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBjb25zdCBuZXdQcm9jSW5mbyA9IHtcclxuICAgICAgICAgICAgbmFtZTogdGhpcy5wcm9jZXNzSW5mby5wcm9jZXNzTmFtZSxcclxuICAgICAgICAgICAgYml6T2JqSWQ6IHRoaXMucHJvY2Vzc0luZm8uYml6T2JqSWQsXHJcbiAgICAgICAgICAgIGZmSWQ6IGZmSWQsXHJcbiAgICAgICAgICAgIGZmTmFtZTogdGhpcy5wcm9jZXNzSW5mby5mbG93Rm9ybU5hbWUsXHJcbiAgICAgICAgICAgIHN0YXJ0TW9kZTogdGhpcy5wcm9jZXNzSW5mby5zdGFydE1vZGUsXHJcbiAgICAgICAgICAgIGZvcm1hbFBhcmFtZXRlcnM6IGluZm8uZm9ybWFsUGFyYW1ldGVycyxcclxuICAgICAgICAgICAgcHJvY2Vzc0JpekNvbXBvbm5ldHM6IHByb2Nlc3NCaXpDb21wb25uZXRzLFxyXG4gICAgICAgICAgICBleGVjdXRlRm9ybXM6IGV4ZWN1dGVGb3JtcyxcclxuICAgICAgICAgICAgY3VzdG9taXplQWN0aW9uczogY3VzdG9taXplQWN0aW9ucyxcclxuICAgICAgICAgICAgcHJvY2Vzc0Rlc2NyaXB0aW9uOiBpbmZvLmZsb3dGb3JtLnByb2Nlc3NEZXNjcmlwdGlvbixcclxuICAgICAgICAgIH07XHJcbiAgICAgICAgICB0aGlzLmNyZWF0ZUJwbW5Nb2RlbChpbmZvLmJpekFjdGl2aXRpZXMgfHwgW10sIG5ld1Byb2NJbmZvKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICk7XHJcbiAgfVxyXG5cclxuICBjcmVhdGVCcG1uTW9kZWwoYml6QWN0aXZpdGllcywgbmV3UHJvY0luZm8pIHtcclxuICAgIHRoaXMuc2VydmljZS5nZXRCaXpDbXAoKS5zdWJzY3JpYmUoXHJcbiAgICAgIChjbXBzOiBhbnkpID0+IHtcclxuICAgICAgICAvLyAyMDIzLTUtMzAg5Li65LqG6Kej5Yaz572R57uc6L6D5beu5Zy65pmv5LiL55qE5Yqg6L296Zeu6aKY5L+u5pS55LqG5Yqg6L296aG65bqPIOWFiOWKoOi9veaVsOaNruWGjXNob3dlZGl0b3JVaVxyXG4gICAgICAgIHRoaXMuZWRpdG9yVWkuc2hvdygpO1xyXG4gICAgICAgIHRoaXMuYWRkRWRpdG9yVWlMaXN0ZW5lcnModGhpcy5lZGl0b3JVaSk7XHJcbiAgICAgICAgdGhpcy5lZGl0b3JVaS5sb2FkQml6QWN0aXZpdGllcyhiaXpBY3Rpdml0aWVzIHx8IFtdKTtcclxuICAgICAgICB0aGlzLmVkaXRvclVpLmNyZWF0ZUJwbW5Nb2RlbChuZXdQcm9jSW5mbywgY21wcyk7XHJcblxyXG4gICAgICAgIHRoaXMuc2VydmljZS5nZXRQcm9jRXh0ZW5kUHJvcGVydHkobmV3UHJvY0luZm8uQml6RGVmS2V5LCBuZXdQcm9jSW5mby5zdGFydE1vZGUsIHRoaXMuZWRpdG9yVWkuYml6Q2F0ZWdvcnlJZCkuc3Vic2NyaWJlKFxyXG4gICAgICAgICAgKHByb3BlcnR5OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgcHJvcHMgPSBbXTtcclxuICAgICAgICAgICAgcHJvcGVydHkuZm9yRWFjaChwID0+IHtcclxuICAgICAgICAgICAgICBpZiAoKHAuYml6Q2F0ZWdvcnlJZCB8fCBwLmJpekRlZktleSkgJiYgKChwLmJpekNhdGVnb3J5SWQuaW5kZXhPZih0aGlzLmVkaXRvclVpLmJpekNhdGVnb3J5SWQpICE9IC0xIHx8IHAuYml6Q2F0ZWdvcnlJZCA9PT0gJyonKSB8fFxyXG4gICAgICAgICAgICAgICAgKHAuYml6RGVmS2V5LmluZGV4T2YobmV3UHJvY0luZm8uQml6RGVmS2V5KSAhPSAtMSB8fCBwLmJpekRlZktleSA9PT0gJyonKSkgJiZcclxuICAgICAgICAgICAgICAgIChwLnN0YXJ0TW9kZS5pbmRleE9mKG5ld1Byb2NJbmZvLnN0YXJ0TW9kZSkgIT0gLTEgfHwgcC5zdGFydE1vZGUgPT09ICcqJykpIHtcclxuICAgICAgICAgICAgICAgIHByb3BzLnB1c2gocCk7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgdGhpcy5lZGl0b3JVaS5wcm9jRXh0UHJvcHMgPSBwcm9wcztcclxuXHJcblxyXG4gICAgICAgICAgICBpZiAodGhpcy5mbGFnKSB7XHJcbiAgICAgICAgICAgICAgdGhpcy5mbGFnID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgdGhpcy5jbG9zZUxvYWRpbmcoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyDmmL7npLrmtYHnqIvlsZ7mgKdcclxuICAgICAgICAgICAgdGhpcy52aWV3TW9kZWwuaW5pdFByb2Nlc3NQcm9wZXJ0eSh0aGlzLmVkaXRvclVpLmdldEZhcnJpc1Byb3BDb25maWcoKSk7XHJcbiAgICAgICAgICAgIC8vIOiOt+WPluWQr+WKqOaWueW8j1xyXG4gICAgICAgICAgICB0aGlzLnVpU3RhdGUuZ2V0U3RhcnRNb2RlKHRoaXMuZWRpdG9yVWkuZ2V0U3RhcnRNb2RlKCkpO1xyXG4gICAgICAgICAgICBpZih0aGlzLmVkaXRvclVpLmdldFN0YXJ0TW9kZSgpID09IFN0YXJ0TW9kZS5TVUJfUFJPQ0VTUykge1xyXG4gICAgICAgICAgICAgIHRoaXMudWlTdGF0ZS5zdWJBY3Rpdml0eUNvbnRleHQgPSB0aGlzLnVpU3RhdGUuc3ViQWN0aXZpdHlDb250ZXh0LmNvbmNhdCh0aGlzLnVpU3RhdGUuc3ViUHJvY2Vzc0VsZW1lbnRDb250ZXh0KTtcclxuICAgICAgICAgICAgfWVsc2Uge1xyXG4gICAgICAgICAgICAgIHRoaXMudWlTdGF0ZS5zdWJBY3Rpdml0eUNvbnRleHQgPSB0aGlzLnVpU3RhdGUuc3ViQWN0aXZpdHlDb250ZXh0LmZpbHRlcih4ID0+IHRoaXMudWlTdGF0ZS5zdWJQcm9jZXNzRWxlbWVudENvbnRleHQuc29tZSh5ID0+IHkua2V5ICE9IHgua2V5KSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLnVpU3RhdGUuYnBtbk1vZGVsID0gdGhpcy5lZGl0b3JVaS5ncmFwaC5icG1uTW9kZWw7XHJcblxyXG4gICAgICAgICAgICB0aGlzLmFkZEdyYXBoTW9kZWxDaGFuZ2VkTGlzdGVuZXIoKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICApO1xyXG4gICAgICB9XHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgb3BlblByb2Nlc3MoY29udGVudDogc3RyaW5nKSB7XHJcbiAgICAvLyDlj5ZQcm9jZXNzSGVhZGVyXHJcbiAgICBjb25zdCBtb2RlbCA9IG5ldyBCcG1uTW9kZWwoKTtcclxuICAgIG1vZGVsLkxvYWRGcm9tSnNvbihjb250ZW50KTtcclxuICAgIGNvbnN0IHByb2Nlc3NIZWFkZXIgPSAobW9kZWwuRGVmYXVsdFByb2Nlc3MuR2V0RXh0ZW5zaW9uRWxlbWVudHMoKS5maWx0ZXIoZSA9PiBlIGluc3RhbmNlb2YgUHJvY2Vzc0hlYWRlcilbMF0gYXMgUHJvY2Vzc0hlYWRlcik7XHJcbiAgICB0aGlzLnNlcnZpY2UuZ2V0UHJvY0V4dGVuZFByb3BlcnR5KHByb2Nlc3NIZWFkZXIuQml6RGVmS2V5LCBwcm9jZXNzSGVhZGVyLnN0YXJ0TW9kZSwgdGhpcy5lZGl0b3JVaS5iaXpDYXRlZ29yeUlkKS5zdWJzY3JpYmUoXHJcbiAgICAgIChwcm9wZXJ0eTogYW55KSA9PiB7XHJcbiAgICAgICAgY29uc3QgcHJvcHMgPSBbXTtcclxuICAgICAgICBwcm9wZXJ0eS5mb3JFYWNoKHAgPT4ge1xyXG4gICAgICAgICAgaWYgKChwLmJpekNhdGVnb3J5SWQgfHwgcC5iaXpEZWZLZXkpICYmICgocC5iaXpDYXRlZ29yeUlkLmluZGV4T2YodGhpcy5lZGl0b3JVaS5iaXpDYXRlZ29yeUlkKSAhPSAtMSB8fCBwLmJpekNhdGVnb3J5SWQgPT09ICcqJykgfHxcclxuICAgICAgICAgICAgKHAuYml6RGVmS2V5LmluZGV4T2YocHJvY2Vzc0hlYWRlci5CaXpEZWZLZXkpICE9IC0xIHx8IHAuYml6RGVmS2V5ID09PSAnKicpKSAmJlxyXG4gICAgICAgICAgICAocC5zdGFydE1vZGUuaW5kZXhPZihwcm9jZXNzSGVhZGVyLnN0YXJ0TW9kZSkgIT0gLTEgfHwgcC5zdGFydE1vZGUgPT09ICcqJykpIHtcclxuICAgICAgICAgICAgcHJvcHMucHVzaChwKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLmVkaXRvclVpLnByb2NFeHRQcm9wcyA9IHByb3BzO1xyXG4gICAgICAgIC8vIDIwMjMtNS0zMCDkuLrkuobop6PlhrPnvZHnu5zovoPlt67lnLrmma/kuIvnmoTliqDovb3pl67popjkv67mlLnkuobliqDovb3pobrluo8g5YWI5Yqg6L295pWw5o2u5YaNc2hvd2VkaXRvclVpXHJcbiAgICAgICAgdGhpcy5lZGl0b3JVaS5zaG93KCk7XHJcbiAgICAgICAgdGhpcy5hZGRFZGl0b3JVaUxpc3RlbmVycyh0aGlzLmVkaXRvclVpKTtcclxuICAgICAgICB0aGlzLmVkaXRvclVpLm9wZW5CcG1uTW9kZWwoY29udGVudCk7XHJcblxyXG5cclxuICAgICAgICBpZiAodGhpcy5mbGFnKSB7XHJcbiAgICAgICAgICB0aGlzLmZsYWcgPSBmYWxzZTtcclxuICAgICAgICAgIHRoaXMuY2xvc2VMb2FkaW5nKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIOaYvuekuua1geeoi+WxnuaAp1xyXG4gICAgICAgIHRoaXMudmlld01vZGVsLmluaXRQcm9jZXNzUHJvcGVydHkodGhpcy5lZGl0b3JVaS5nZXRGYXJyaXNQcm9wQ29uZmlnKCkpO1xyXG4gICAgICAgIC8vIOaJk+W8gOaXtuiOt+WPluaJgOaciea0u+WKqOiKgueCueS/oeaBr1xyXG4gICAgICAgIHRoaXMudWlTdGF0ZS5nZXRVc2VyQWN0TGlzdCh0aGlzLmVkaXRvclVpLmdldEFjdGl2aXRpZXMoKSk7XHJcbiAgICAgICAgLy8g5omT5byA5pe26I635Y+W5omA5pyJ57uT5p2f6IqC54K55L+h5oGvXHJcbiAgICAgICAgdGhpcy51aVN0YXRlLmdldEVuZEV2ZW50TGlzdCh0aGlzLmVkaXRvclVpLmdldEVuZEV2ZW50cygpKTtcclxuICAgICAgICAvLyDmiZPlvIDml7bojrflj5bmiYDmnInnn6XkvJroioLngrnkv6Hmga9cclxuICAgICAgICB0aGlzLnVpU3RhdGUuZ2V0Tm90aWZ5RXZlbnRMaXN0KHRoaXMuZWRpdG9yVWkuZ2V0Tm90aWZ5RXZlbnRzKCkpO1xyXG4gICAgICAgIC8vIOaJk+W8gOaXtuiOt+WPluaJgOaciea2iOaBr+iKgueCueS/oeaBr1xyXG4gICAgICAgIHRoaXMudWlTdGF0ZS5nZXRNZXNzYWdlRXZlbnRMaXN0KHRoaXMuZWRpdG9yVWkuZ2V0TWVzc2FnZUV2ZW50cygpKTtcclxuICAgICAgICAvLyDmiZPlvIDml7bojrflj5bmiYDmnInlrZDmtYHnqIvlkozkv6Hlj7fmjZXojrfoioLngrnkv6Hmga9cclxuICAgICAgICB0aGlzLnVpU3RhdGUuZ2V0U3ViQW5kQ2F0Y2hFdmVudHNMaXN0KHRoaXMuZWRpdG9yVWkuZ2V0U3ViQW5kQ2F0Y2hFdmVudHMoKSk7XHJcblxyXG4gICAgICAgIHRoaXMudWlTdGF0ZS5icG1uTW9kZWwgPSB0aGlzLmVkaXRvclVpLmdyYXBoLmJwbW5Nb2RlbDtcclxuXHJcbiAgICAgICAgLy8g6I635Y+W5ZCv5Yqo5pa55byPXHJcbiAgICAgICAgdGhpcy51aVN0YXRlLmdldFN0YXJ0TW9kZSh0aGlzLmVkaXRvclVpLmdldFN0YXJ0TW9kZSgpKTtcclxuICAgICAgICBpZih0aGlzLmVkaXRvclVpLmdldFN0YXJ0TW9kZSgpID09IFN0YXJ0TW9kZS5TVUJfUFJPQ0VTUykge1xyXG4gICAgICAgICAgdGhpcy51aVN0YXRlLnN1YkFjdGl2aXR5Q29udGV4dCA9IHRoaXMudWlTdGF0ZS5zdWJBY3Rpdml0eUNvbnRleHQuY29uY2F0KHRoaXMudWlTdGF0ZS5zdWJQcm9jZXNzRWxlbWVudENvbnRleHQpO1xyXG4gICAgICAgIH1lbHNlIHtcclxuICAgICAgICAgIHRoaXMudWlTdGF0ZS5zdWJBY3Rpdml0eUNvbnRleHQgPSB0aGlzLnVpU3RhdGUuc3ViQWN0aXZpdHlDb250ZXh0LmZpbHRlcih4ID0+IHRoaXMudWlTdGF0ZS5zdWJQcm9jZXNzRWxlbWVudENvbnRleHQuc29tZSh5ID0+IHkua2V5ICE9IHgua2V5KSlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuYWRkR3JhcGhNb2RlbENoYW5nZWRMaXN0ZW5lcigpO1xyXG4gICAgICB9XHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog5re75YqgZ3JhcGggbW9kZWznm5HlkKzlmajvvIzmnInlj5jljJbliJnlsIZjaGFuZ2VkRmxhZ1xyXG4gICAqL1xyXG4gIGFkZEdyYXBoTW9kZWxDaGFuZ2VkTGlzdGVuZXIoKSB7XHJcbiAgICAvLyDnm5HlkKznlLvluIPlj5jljJbvvIzmm7TmlrDnlYzpnaLlj5jmm7TnirbmgIFcclxuICAgIGNvbnN0IGNoYW5nZWRMaXN0ZW5lciA9ICgpID0+IHtcclxuICAgICAgdGhpcy5jaGFuZ2VkRmxhZyA9IGZhbHNlO1xyXG4gICAgfVxyXG4gICAgdGhpcy5lZGl0b3JVaS5ncmFwaC5tb2RlbC5hZGRMaXN0ZW5lcihteEV2ZW50LkNIQU5HRSwgY2hhbmdlZExpc3RlbmVyKTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgc2hvd1RpcChkYXRhOiBhbnkpIHtcclxuICAgIGlmIChkYXRhLnR5cGUgPT09ICdtZXNzYWdlJykge1xyXG4gICAgICBzd2l0Y2ggKGRhdGEubGV2ZWwpIHtcclxuICAgICAgICBjYXNlICd3YXJuaW5nJzpcclxuICAgICAgICAgIHRoaXMubWVzc2FnZS53YXJuaW5nKGRhdGEubWVzc2FnZSk7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlICdlcnJvcic6XHJcbiAgICAgICAgICB0aGlzLm1lc3NhZ2UuZXJyb3IoZGF0YS5tZXNzYWdlKTtcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgJ3F1ZXN0aW9uJzpcclxuICAgICAgICAgIHRoaXMubWVzc2FnZS5xdWVzdGlvbihkYXRhLm1lc3NhZ2UsICgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5xdWVzdGlvbk9LSGFuZGxlKGRhdGEpO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgdGhpcy5tZXNzYWdlLmluZm8oZGF0YS5tZXNzYWdlKTtcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcbiAgICB9IGVsc2UgaWYgKGRhdGEudHlwZSA9PT0gJ25vdGlmeScpIHtcclxuICAgICAgc3dpdGNoIChkYXRhLmxldmVsKSB7XHJcbiAgICAgICAgY2FzZSAnd2FybmluZyc6XHJcbiAgICAgICAgICB0aGlzLm5vdGlmeS53YXJuaW5nKGRhdGEubWVzc2FnZSk7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlICdlcnJvcic6XHJcbiAgICAgICAgICB0aGlzLm5vdGlmeS5lcnJvcihkYXRhLm1lc3NhZ2UpO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgIHRoaXMubm90aWZ5LmluZm8oZGF0YS5tZXNzYWdlKTtcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHNob3dWZXJpZnkoZGF0YTogYW55KSB7XHJcbiAgICB0aGlzLmVycm9yTGlzdCA9IGRhdGE7XHJcbiAgICB0aGlzLmNyZWF0ZVZhbGlkYXRpb25UaXBzKCk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHF1ZXN0aW9uT0tIYW5kbGUoZGF0YTogYW55KSB7XHJcbiAgICBzd2l0Y2ggKGRhdGEuYWN0aW9uKSB7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDojrflj5bmtYHnqIvkuIrkuIvmlodcclxuICAgKiBAcGFyYW0gaWQg5rWB56iL5a6a5LmJSUTvvIjorr7orqHml7bkvb/nlKjmtYHnqIvlrprkuYlLZXnvvIzov5DooYzml7bkvb/nlKjmtYHnqIvlrprkuYlJRO+8iVxyXG4gICAqL1xyXG4gIGdldFByb2NDb250ZW50KGlkOiBzdHJpbmcpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgaWYgKGlkKSB7XHJcbiAgICAgIGlmICh0aGlzLnRpbWUgPT09IFByb2Nlc3NUaW1lLmR0KSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuc2VydmljZS5nZXRQcm9jQ29udGVudGJ5S2V5KGlkKTtcclxuICAgICAgfSBlbHNlIGlmICh0aGlzLnRpbWUgPT09IFByb2Nlc3NUaW1lLnJ0KSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuc2VydmljZS5nZXRSVFByb2NDb250ZW50YnlJZChpZCk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oXCJwcm9jZXNzRWRpdG9yLndyb25nTW9tZW50XCIpKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBzYXZlKGNvbnRlbnQ6IHN0cmluZykge1xyXG4gICAgdGhpcy51aVN0YXRlLmNvbnRlbnQgPSBjb250ZW50O1xyXG4gICAgdGhpcy5zaG93TG9hZGluZygpO1xyXG4gICAgY29uc3QgcHJvY2VzcyA9IEpTT04ucGFyc2UodGhpcy51aVN0YXRlLmNvbnRlbnQpO1xyXG4gICAgdGhpcy5zYXZlSHR0cCgpLnN1YnNjcmliZSgoZGF0YSkgPT4ge1xyXG4gICAgICB0aGlzLmNsb3NlTG9hZGluZygpO1xyXG4gICAgICAvLyAyMDIzLTYtMTMg5L+d5a2Y5ZCO5ZCM5q2l5rWB56iL5ZCN56ew5Yiw5qCH6aKY5qCPXHJcbiAgICAgIHRoaXMucHJvY05hbWVUaXRsZSA9IHByb2Nlc3MuRGVmYXVsdFByb2Nlc3MuTmFtZTtcclxuICAgICAgdGhpcy5ub3RpZnkuc3VjY2Vzcyh7XHJcbiAgICAgICAgdGl0bGU6IHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oXCJwcm9jZXNzRWRpdG9yLnByb21wdGVkXCIpLFxyXG4gICAgICAgIG1zZzogdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybShcInByb2Nlc3NFZGl0b3Iuc2F2ZVN1Y2Nlc3NcIiksXHJcbiAgICAgICAgdGltZW91dDogMzAwMFxyXG4gICAgICB9IGFzIE5vdGlmeU9wdGlvbnMpO1xyXG4gICAgICBpZiAodGhpcy50aW1lID09PSBQcm9jZXNzVGltZS5kdCkge1xyXG4gICAgICAgIHRoaXMudmlld01vZGVsLmF1ZGl0UHJvY2Vzc0RlZihBdWRpdEV2ZW50LldGX1Byb2Nlc3NEZWZfU2F2ZURULCB0cnVlLCBwcm9jZXNzLkRlZmF1bHRQcm9jZXNzLktleSk7XHJcbiAgICAgIH0gZWxzZSBpZiAodGhpcy50aW1lID09PSBQcm9jZXNzVGltZS5ydCkge1xyXG4gICAgICAgIHRoaXMudmlld01vZGVsLmF1ZGl0UHJvY2Vzc0RlZihBdWRpdEV2ZW50LldGX1Byb2Nlc3NEZWZfU2F2ZVJULCB0cnVlLCBwcm9jZXNzLkRlZmF1bHRQcm9jZXNzLktleSk7XHJcbiAgICAgIH1cclxuICAgICAgLy8g6YeN572u55WM6Z2i5Y+Y5pu054q25oCBXHJcbiAgICAgIHRoaXMuY2hhbmdlZEZsYWcgPSBmYWxzZTtcclxuICAgIH0sXHJcbiAgICAgIChlcnJvcjogSHR0cEVycm9yUmVzcG9uc2UpID0+IHtcclxuICAgICAgICB0aGlzLmNsb3NlTG9hZGluZygpO1xyXG4gICAgICAgIHRoaXMubm90aWZ5LmVycm9yKHtcclxuICAgICAgICAgIHRpdGxlOiB0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKFwicHJvY2Vzc0VkaXRvci5wcm9tcHRlZFwiKSxcclxuICAgICAgICAgIG1zZzogZXJyb3IuZXJyb3IuTWVzc2FnZSxcclxuICAgICAgICAgIHRpbWVvdXQ6IDMwMDBcclxuICAgICAgICB9IGFzIE5vdGlmeU9wdGlvbnMpO1xyXG4gICAgICAgIGlmICh0aGlzLnRpbWUgPT09IFByb2Nlc3NUaW1lLmR0KSB7XHJcbiAgICAgICAgICB0aGlzLnZpZXdNb2RlbC5hdWRpdFByb2Nlc3NEZWYoQXVkaXRFdmVudC5XRl9Qcm9jZXNzRGVmX1NhdmVEVCwgZmFsc2UsIHByb2Nlc3MuRGVmYXVsdFByb2Nlc3MuS2V5KTtcclxuICAgICAgICB9IGVsc2UgaWYgKHRoaXMudGltZSA9PT0gUHJvY2Vzc1RpbWUucnQpIHtcclxuICAgICAgICAgIHRoaXMudmlld01vZGVsLmF1ZGl0UHJvY2Vzc0RlZihBdWRpdEV2ZW50LldGX1Byb2Nlc3NEZWZfU2F2ZVJULCBmYWxzZSwgcHJvY2Vzcy5EZWZhdWx0UHJvY2Vzcy5LZXkpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHJlbGVhc2UoY29udGVudDogc3RyaW5nKSB7XHJcbiAgICB0aGlzLnVpU3RhdGUuY29udGVudCA9IGNvbnRlbnQ7XHJcbiAgICB0aGlzLnNob3dMb2FkaW5nKCk7XHJcbiAgICB0aGlzLnVpU3RhdGUuZ2V0UmVsZWFzZUNvbmZpZygpLnN1YnNjcmliZSgoY29uZmlnKSA9PiB7XHJcbiAgICAgIGlmIChjb25maWcuY3VycmVudFZhbHVlID09PSAndHJ1ZScpIHtcclxuICAgICAgICAvLyDlsZXnpLrlj5HluIPliY3lrqHmibnpobXpnaLvvIzlkIzml7bkv53lrZjvvIzorrDlrqHorqFcclxuICAgICAgICB0aGlzLnZpZXdNb2RlbC5zYXZlUHJvY2Vzcyh0aGlzLnVpU3RhdGUuY29udGVudCwgdGhpcy5wcm9jZXNzSW5mbywgMSkuc3Vic2NyaWJlKChyZSkgPT4ge1xyXG4gICAgICAgICAgdGhpcy52aWV3TW9kZWwuZ2V0UHJvY0RlZnNCeUtleShKU09OLnBhcnNlKGNvbnRlbnQpLkRlZmF1bHRQcm9jZXNzLktleSkuc3Vic2NyaWJlKChQcm9jRGVmcykgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBtYXhWZXJzaW9uID0gTWF0aC5tYXguYXBwbHkoTWF0aCwgUHJvY0RlZnMubWFwKGZ1bmN0aW9uIChpdGVtKSB7XHJcbiAgICAgICAgICAgICAgcmV0dXJuIGl0ZW0udmVyc2lvbiA8PCAwXHJcbiAgICAgICAgICAgIH0pKTtcclxuICAgICAgICAgICAgLy8g5bGV56S65Y+R5biD5YmN5a6h5om56aG16Z2i77yM5ZCM5pe25L+d5a2Y77yM6K6w5a6h6K6hXHJcbiAgICAgICAgICAgIHRoaXMudmlld01vZGVsLnJlbGVhc2VQcm9jZXNzKGNvbnRlbnQsIG1heFZlcnNpb24gPT09IC1JbmZpbml0eSA/IDEgOiBtYXhWZXJzaW9uKTtcclxuICAgICAgICAgICAgdGhpcy5jbG9zZUxvYWRpbmcoKTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMubm90aWZ5LnN1Y2Nlc3Moe1xyXG4gICAgICAgICAgdGl0bGU6IHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oXCJwcm9jZXNzRWRpdG9yLnByb21wdGVkXCIpLFxyXG4gICAgICAgICAgbXNnOiB0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKFwicHJvY2Vzc0VkaXRvci53YWl0UmV2aWV3XCIpLFxyXG4gICAgICAgICAgdGltZW91dDogMzAwMFxyXG4gICAgICAgIH0gYXMgTm90aWZ5T3B0aW9ucyk7XHJcbiAgICAgICAgY29uc3QgcHJvY2VzcyA9IEpTT04ucGFyc2UodGhpcy51aVN0YXRlLmNvbnRlbnQpO1xyXG4gICAgICAgIHRoaXMudmlld01vZGVsLmF1ZGl0UHJvY2Vzc0RlZihBdWRpdEV2ZW50LldGX1Byb2Nlc3NEZWZfRGVwbG95LCB0cnVlLCBwcm9jZXNzLkRlZmF1bHRQcm9jZXNzLktleSk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgdGhpcy52aWV3TW9kZWwuZGVwbG95UHJvY2Vzcyh0aGlzLnVpU3RhdGUuY29udGVudCkuc3Vic2NyaWJlKChkYXRhKSA9PiB7XHJcbiAgICAgICAgICB0aGlzLmNsb3NlTG9hZGluZygpO1xyXG4gICAgICAgICAgdGhpcy52aWV3TW9kZWwuc2F2ZVByb2Nlc3ModGhpcy51aVN0YXRlLmNvbnRlbnQsIHRoaXMucHJvY2Vzc0luZm8sIDApLnN1YnNjcmliZSgocikgPT4geyB9KTtcclxuICAgICAgICAgIHRoaXMubm90aWZ5LnN1Y2Nlc3Moe1xyXG4gICAgICAgICAgICB0aXRsZTogdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybShcInByb2Nlc3NFZGl0b3IucHJvbXB0ZWRcIiksXHJcbiAgICAgICAgICAgIG1zZzogdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybShcInByb2Nlc3NFZGl0b3Iuc3VjY2Vzc1B1Ymxpc2hcIiksXHJcbiAgICAgICAgICAgIHRpbWVvdXQ6IDMwMDBcclxuICAgICAgICAgIH0gYXMgTm90aWZ5T3B0aW9ucyk7XHJcbiAgICAgICAgICBjb25zdCBwcm9jZXNzID0gSlNPTi5wYXJzZSh0aGlzLnVpU3RhdGUuY29udGVudCk7XHJcbiAgICAgICAgICB0aGlzLnZpZXdNb2RlbC5hdWRpdFByb2Nlc3NEZWYoQXVkaXRFdmVudC5XRl9Qcm9jZXNzRGVmX0RlcGxveSwgdHJ1ZSwgcHJvY2Vzcy5EZWZhdWx0UHJvY2Vzcy5LZXkpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgICAoZTogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuY2xvc2VMb2FkaW5nKCk7XHJcbiAgICAgICAgICAgIHRoaXMubm90aWZ5LmVycm9yKHtcclxuICAgICAgICAgICAgICB0aXRsZTogdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybShcInByb2Nlc3NFZGl0b3IucHJvbXB0ZWRcIiksXHJcbiAgICAgICAgICAgICAgbXNnOiB0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKFwicHJvY2Vzc0VkaXRvci5wdWJsaXNoRmFpbFwiKSArIGAke2UuZXJyb3IuTWVzc2FnZX1gLFxyXG4gICAgICAgICAgICAgIHRpbWVvdXQ6IDMwMDBcclxuICAgICAgICAgICAgfSBhcyBOb3RpZnlPcHRpb25zKTtcclxuICAgICAgICAgICAgY29uc3QgcHJvY2VzcyA9IEpTT04ucGFyc2UodGhpcy51aVN0YXRlLmNvbnRlbnQpO1xyXG4gICAgICAgICAgICB0aGlzLnZpZXdNb2RlbC5hdWRpdFByb2Nlc3NEZWYoQXVkaXRFdmVudC5XRl9Qcm9jZXNzRGVmX0RlcGxveSwgZmFsc2UsIHByb2Nlc3MuRGVmYXVsdFByb2Nlc3MuS2V5KTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOS/neWtmOa1geeoi+WumuS5ie+8iOiuvuiuoeaXtivov5DooYzml7bvvIlcclxuICAgKi9cclxuICBwcml2YXRlIHNhdmVIdHRwKCk6IE9ic2VydmFibGU8YW55PiB7XHJcbiAgICBpZiAodGhpcy51aVN0YXRlLmNvbnRlbnQpIHtcclxuICAgICAgaWYgKHRoaXMudGltZSA9PT0gUHJvY2Vzc1RpbWUuZHQpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy52aWV3TW9kZWwuc2F2ZVByb2Nlc3ModGhpcy51aVN0YXRlLmNvbnRlbnQsIHRoaXMucHJvY2Vzc0luZm8sIDEpO1xyXG4gICAgICB9IGVsc2UgaWYgKHRoaXMudGltZSA9PT0gUHJvY2Vzc1RpbWUucnQpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy52aWV3TW9kZWwuc2F2ZVJUUHJvY2Vzcyh0aGlzLnVpU3RhdGUuY29udGVudCwgdGhpcy5ydFByb2Nlc3NJbmZvLnJ0UHJvY0RlZklkKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IodGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybShcInByb2Nlc3NFZGl0b3Iud3JvbmdNb21lbnRcIikpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBzaG93TG9hZGluZygpIHtcclxuICAgIHRoaXMubG9hZFNlcnZpY2Uuc2hvdyh7IGNvbnRhaW5lcjogJ2JvZHknLCBtZXNzYWdlOiAnJywgdHlwZTogMSB9KTtcclxuICB9XHJcbiAgY2xvc2VMb2FkaW5nKCkge1xyXG4gICAgdGhpcy5sb2FkU2VydmljZS5jbG9zZSgpO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBDb252ZXJ0RXhlY3V0ZUZvcm0oZm9ybTogRXhjdXRlRm9ybUVudGl0eSk6IEV4ZWN1dGVGb3JtTW9kZWxbXSB7XHJcbiAgICBjb25zdCBleGVjdXRlRm9ybXMgPSBuZXcgQXJyYXkoKTtcclxuICAgIGlmIChmb3JtLnRlcm1pbmFsID09PSAnd2ViLGFwcCcpIHtcclxuICAgICAgY29uc3Qgd2ViRm9ybSA9IG5ldyBFeGVjdXRlRm9ybU1vZGVsKCk7XHJcbiAgICAgIHdlYkZvcm0uQ29tcG9uZW50SWQgPSBmb3JtLmFwcElkO1xyXG4gICAgICB3ZWJGb3JtLmZvcm1Gb3JtYXRJZCA9IGZvcm0uZm9ybUZvcm1hdElkO1xyXG4gICAgICB3ZWJGb3JtLkZvcm1UeXBlID0gZm9ybS5mb3JtVHlwZTtcclxuICAgICAgd2ViRm9ybS5OYW1lID0gZm9ybS5uYW1lO1xyXG4gICAgICB3ZWJGb3JtLlRlcm1pbmFsVHlwZSA9IFRlcm1pbmFsVHlwZS5QQztcclxuICAgICAgaWYgKGZvcm0uYWN0dWFsUGFyYW1ldGVycyAmJiBmb3JtLmFjdHVhbFBhcmFtZXRlcnMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgIHdlYkZvcm0uQWN0dWFsUGFyYW1ldGVycyA9IGZvcm0uYWN0dWFsUGFyYW1ldGVycy5tYXAocCA9PiAoe1xyXG4gICAgICAgICAgTmFtZTogcC5jb2RlLFxyXG4gICAgICAgICAgVmFsdWU6IHAudmFsdWVcclxuICAgICAgICB9KSk7XHJcbiAgICAgIH1cclxuICAgICAgZXhlY3V0ZUZvcm1zLnB1c2god2ViRm9ybSk7XHJcbiAgICAgIGNvbnN0IGFwcEZvcm0gPSBuZXcgRXhlY3V0ZUZvcm1Nb2RlbCgpO1xyXG4gICAgICBhcHBGb3JtLkNvbXBvbmVudElkID0gZm9ybS5hcHBJZDtcclxuICAgICAgYXBwRm9ybS5mb3JtRm9ybWF0SWQgPSBmb3JtLmZvcm1Gb3JtYXRJZDtcclxuICAgICAgYXBwRm9ybS5Gb3JtVHlwZSA9IGZvcm0uZm9ybVR5cGU7XHJcbiAgICAgIGFwcEZvcm0uTmFtZSA9IGZvcm0ubmFtZTtcclxuICAgICAgYXBwRm9ybS5UZXJtaW5hbFR5cGUgPSBUZXJtaW5hbFR5cGUuTU9CSUxFO1xyXG4gICAgICBpZiAoZm9ybS5hY3R1YWxQYXJhbWV0ZXJzICYmIGZvcm0uYWN0dWFsUGFyYW1ldGVycy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgYXBwRm9ybS5BY3R1YWxQYXJhbWV0ZXJzID0gZm9ybS5hY3R1YWxQYXJhbWV0ZXJzLm1hcCgocDogYW55KSA9PiAoe1xyXG4gICAgICAgICAgTmFtZTogcC5jb2RlLFxyXG4gICAgICAgICAgVGFnOiBwLnZhbHVlVHlwZSA/IHAudmFsdWVUeXBlIDogUHJvY2Vzc0RlVXRpbC5pbml0VmFyaWFibGVUeXBlKHAudmFsdWUpLFxyXG4gICAgICAgICAgVmFsdWU6IHAudmFsdWVcclxuICAgICAgICB9KSk7XHJcbiAgICAgIH1cclxuICAgICAgZXhlY3V0ZUZvcm1zLnB1c2goYXBwRm9ybSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBjb25zdCBleGVjdXRlRm9ybSA9IG5ldyBFeGVjdXRlRm9ybU1vZGVsKCk7XHJcbiAgICAgIGV4ZWN1dGVGb3JtLkNvbXBvbmVudElkID0gZm9ybS5hcHBJZDtcclxuICAgICAgZXhlY3V0ZUZvcm0uZm9ybUZvcm1hdElkID0gZm9ybS5mb3JtRm9ybWF0SWQ7XHJcbiAgICAgIGV4ZWN1dGVGb3JtLkZvcm1UeXBlID0gZm9ybS5mb3JtVHlwZTtcclxuICAgICAgZXhlY3V0ZUZvcm0uTmFtZSA9IGZvcm0ubmFtZTtcclxuICAgICAgc3dpdGNoIChmb3JtLnRlcm1pbmFsKSB7XHJcbiAgICAgICAgY2FzZSAnd2ViJzpcclxuICAgICAgICAgIGV4ZWN1dGVGb3JtLlRlcm1pbmFsVHlwZSA9IFRlcm1pbmFsVHlwZS5QQztcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgJ2FwcCc6XHJcbiAgICAgICAgICBleGVjdXRlRm9ybS5UZXJtaW5hbFR5cGUgPSBUZXJtaW5hbFR5cGUuTU9CSUxFO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKGZvcm0uYWN0dWFsUGFyYW1ldGVycyAmJiBmb3JtLmFjdHVhbFBhcmFtZXRlcnMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgIGV4ZWN1dGVGb3JtLkFjdHVhbFBhcmFtZXRlcnMgPSBmb3JtLmFjdHVhbFBhcmFtZXRlcnMubWFwKChwOiBhbnkpID0+ICh7XHJcbiAgICAgICAgICBOYW1lOiBwLmNvZGUsXHJcbiAgICAgICAgICBUYWc6IHAudmFsdWVUeXBlID8gcC52YWx1ZVR5cGUgOiBQcm9jZXNzRGVVdGlsLmluaXRWYXJpYWJsZVR5cGUocC52YWx1ZSksXHJcbiAgICAgICAgICBWYWx1ZTogcC52YWx1ZVxyXG4gICAgICAgIH0pKTtcclxuICAgICAgfVxyXG4gICAgICBleGVjdXRlRm9ybXMucHVzaChleGVjdXRlRm9ybSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gZXhlY3V0ZUZvcm1zO1xyXG4gIH1cclxuICBwcml2YXRlIGZvcm1Gb3JtYXQyRXhlY3V0ZUZvcm0oZm9ybWZvcm1hdCk6IEV4ZWN1dGVGb3JtTW9kZWwge1xyXG4gICAgY29uc3QgZm9ybSA9IG5ldyBFeGVjdXRlRm9ybU1vZGVsKCk7XHJcbiAgICBmb3JtLklkID0gUHJvY2Vzc0RlVXRpbC5HZW5lcmF0ZUVsZW1lbnRJZCgpO1xyXG4gICAgZm9ybS5Db21wb25lbnRJZCA9IG51bGw7XHJcbiAgICBmb3JtLmZvcm1Gb3JtYXRJZCA9IGZvcm1mb3JtYXQuaWQ7XHJcbiAgICBmb3JtLkZvcm1UeXBlID0gJzAnO1xyXG4gICAgZm9ybS5OYW1lID0gZm9ybWZvcm1hdC5uYW1lO1xyXG4gICAgc3dpdGNoIChmb3JtZm9ybWF0LnRlcm1pbmFsKSB7XHJcbiAgICAgIGNhc2UgJ1BDJzpcclxuICAgICAgICBmb3JtLlRlcm1pbmFsVHlwZSA9IFRlcm1pbmFsVHlwZS5QQztcclxuICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSAnTW9iaWxlJzpcclxuICAgICAgICBmb3JtLlRlcm1pbmFsVHlwZSA9IFRlcm1pbmFsVHlwZS5NT0JJTEU7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICB9XHJcbiAgICBpZiAoZm9ybWZvcm1hdC51cmxQYXJhbWV0ZXJzICYmIGZvcm1mb3JtYXQudXJsUGFyYW1ldGVycy5sZW5ndGggPiAwKSB7XHJcbiAgICAgIGZvcm0uQWN0dWFsUGFyYW1ldGVycyA9IGZvcm1mb3JtYXQudXJsUGFyYW1ldGVycy5tYXAocCA9PiAoe1xyXG4gICAgICAgIE5hbWU6IHAuY29kZSxcclxuICAgICAgICBUYWc6IHAudmFsdWVUeXBlID8gcC52YWx1ZVR5cGUgOiBQcm9jZXNzRGVVdGlsLmluaXRWYXJpYWJsZVR5cGUocC52YWx1ZSksXHJcbiAgICAgICAgVmFsdWU6IHAudmFsdWVcclxuICAgICAgfSkpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGZvcm07XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGNvbXBsZXRlU3RyYXRlZ3lDaGFuZ2VkKHN0cmF0ZWd5OiBzdHJpbmcpIHtcclxuXHJcbiAgICBpZiAoc3RyYXRlZ3kgIT09IHRoaXMudWlTdGF0ZS5jb21wbGV0ZUl0ZXJhdG9yWzBdLmtleSkge1xyXG5cclxuICAgICAgLy8g5Y+C5LiO6ICF5a2Y5Zyo6Ieq5Yqo5a6h5om555qE5oOF5Ya15LiL77yM5LiN5YWB6K645L+u5pS55a6M5oiQ562W55Wl5Li65Lya562+6KeE5YiZXHJcbiAgICAgIC8vIGlmICh0aGlzLnVpU3RhdGUucHJvcGVydHlEYXRhLlBhcnRpY2lwYW50U2NoZW1lc1xyXG4gICAgICAvLyAgICYmIHRoaXMudWlTdGF0ZS5wcm9wZXJ0eURhdGEuUGFydGljaXBhbnRTY2hlbWVzLm9wdGlvbnNcclxuICAgICAgLy8gICAmJiB0aGlzLnVpU3RhdGUucHJvcGVydHlEYXRhLlBhcnRpY2lwYW50U2NoZW1lcy5vcHRpb25zLmF1dG9tYXRpY1BlcmZvcm1lcnNcclxuICAgICAgLy8gICAmJiB0aGlzLnVpU3RhdGUucHJvcGVydHlEYXRhLlBhcnRpY2lwYW50U2NoZW1lcy5vcHRpb25zLmF1dG9tYXRpY1BlcmZvcm1lcnMubGVuZ3RoID4gMCkge1xyXG4gICAgICAvLyAgIHJldHVybjtcclxuICAgICAgLy8gfSBlbHNlIHtcclxuICAgICAgLy8g5Lya562+6KeE5YiZ5LiN5a2Y5Zyo77yM5Y2z55Sx5oqi5Y2g5qih5byP77yM5Y+Y5Li65Lya562+5pe2XHJcbiAgICAgIGlmICghdGhpcy51aVN0YXRlLnByb3BlcnR5RGF0YS5TaWduUnVsZSkge1xyXG4gICAgICAgIC8vIOS8muetvuaYr+iHquWKqOW8ueWHuuS8muetvuinhOWImee8lui+kVxyXG4gICAgICAgIGNvbnN0IGNvbXBGYWN0b3J5ID0gdGhpcy5yZXNvbHZlci5yZXNvbHZlQ29tcG9uZW50RmFjdG9yeShTaWduUnVsZUNvbXBvbmVudCk7XHJcbiAgICAgICAgY29uc3QgY29tcFJlZiA9IGNvbXBGYWN0b3J5LmNyZWF0ZSh0aGlzLmluamVjdG9yKTtcclxuXHJcbiAgICAgICAgY29tcFJlZi5pbnN0YW5jZS52YWx1ZSA9IFtdO1xyXG4gICAgICAgIC8vIGNvbXBSZWYuaW5zdGFuY2UuY291bnRlclNpZ25WYXJpYWJsZXMgPSB0aGlzLnVpU3RhdGUuY291bnRlclNpZ25WYXJpYWJsZXMgfHwgW107XHJcbiAgICAgICAgLy8gY29tcFJlZi5pbnN0YW5jZS5hcHByb3ZhbEl0ZW1zID0gdGhpcy51aVN0YXRlLmFwcHJvdmFsSXRlbXMgfHwgW107XHJcblxyXG4gICAgICAgIGNvbnN0IG1vZGFsQ29uZmlnOiBNb2RhbE9wdGlvbnMgPSBPYmplY3QuYXNzaWduKGNvbXBSZWYuaW5zdGFuY2UubW9kYWxDb25maWcsXHJcbiAgICAgICAgICB7IGJ1dHRvbnM6IGNvbXBSZWYuaW5zdGFuY2UubW9kYWxGb290ZXIgfSk7XHJcbiAgICAgICAgY29uc3QgZGlhbG9nID0gdGhpcy5tb2RhbFNlcnZpY2Uuc2hvdyhjb21wUmVmLCBtb2RhbENvbmZpZyk7XHJcbiAgICAgICAgY29tcFJlZi5pbnN0YW5jZS5jbG9zZU1vZGFsLnN1YnNjcmliZSgkZXZlbnQgPT4gZGlhbG9nLmNsb3NlKCkpO1xyXG4gICAgICAgIGNvbXBSZWYuaW5zdGFuY2Uuc3VibWl0TW9kYWwuc3Vic2NyaWJlKChkYXRhOiBhbnkpID0+IHtcclxuICAgICAgICAgIHRoaXMudXBkYXRlQ2hhbmdlUHJvcGVydHkoe1xyXG4gICAgICAgICAgICBjYXRlZ29yeUlkOiAncGVyZm9ybWVyUHJvcGVydHknLFxyXG4gICAgICAgICAgICBwcm9wZXJ0eUlEOiBVc2VyQWN0aXZpdHlQcm9wZXJ0eUtleXMuU2lnblJ1bGUsXHJcbiAgICAgICAgICAgIHByb3BlcnR5VmFsdWU6IGRhdGEudmFsdWVcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgZGlhbG9nLmNsb3NlKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgICAgLy8g5Lya562+6KeE5YiZ5LiL77yM6amz5Zue6KeE5YiZ57qm5p2fXHJcbiAgICAgIGlmICgodGhpcy51aVN0YXRlLnByb3BlcnR5RGF0YS5CYWNrV2FyZFJ1bGUgYXMgQmFja1dhcmRSdWxlKS5TZWxlY3RUYXJnZXRBYmxlID09PSB0cnVlKSB7XHJcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICB0aGlzLm1lc3NhZ2Uud2FybmluZyh0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKFwicHJvY2Vzc0VkaXRvci5wb2xpY3lDb25mbGljdFwiKSk7XHJcbiAgICAgICAgfSwgNTAwKTtcclxuICAgICAgfVxyXG4gICAgICAvLyB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIE90aGVyQXNzaWduTm9kZXNDaGFuZ2VkKGRhdGE6IGFueSkge1xyXG4gICAgY29uc3QgY29tcEZhY3RvcnkgPSB0aGlzLnJlc29sdmVyLnJlc29sdmVDb21wb25lbnRGYWN0b3J5KEFzc2lnblNjb3BlQ29tcG9uZW50KTtcclxuICAgIGNvbnN0IGNvbXBSZWYgPSBjb21wRmFjdG9yeS5jcmVhdGUodGhpcy5pbmplY3Rvcik7XHJcbiAgICBsZXQgbG9jYXRpb247XHJcbiAgICBpZiAoZGF0YS5JZC5pbmRleE9mKCdzdGFydEFjdGl2aXR5JykgPiAtMSkge1xyXG4gICAgICBsb2NhdGlvbiA9ICdzdGFydEFjdGl2aXR5JztcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGxvY2F0aW9uID0gJ3VzZXJBY3Rpdml0eSc7XHJcbiAgICB9XHJcbiAgICBpZiAobG9jYXRpb24gPT09ICdzdGFydEFjdGl2aXR5Jykge1xyXG4gICAgICBjb21wUmVmLmluc3RhbmNlLnZhbHVlID0gW107XHJcbiAgICAgIGNvbnN0IGFjdGl2aXRpZXMgPSB0aGlzLnVpU3RhdGUudXNlckFjdExpc3QuZmlsdGVyKGEgPT4gYS5JZCAhPT0gdGhpcy51aVN0YXRlLnByb3BlcnR5RGF0YS5JZFxyXG4gICAgICAgICYmIGEuQXNzaWdubWVudFN0cmF0ZWd5ID09PSAnQVNTSUdOJ1xyXG4gICAgICAgICYmIGEuQXNzaWduUGVyZm9ybWVyQ29uZmlnXHJcbiAgICAgICAgJiYgYS5Bc3NpZ25QZXJmb3JtZXJDb25maWcuT3BlcmF0b3IgPT09ICdwcm9jSW5zdENyZWF0b3InKTtcclxuICAgICAgaWYgKGFjdGl2aXRpZXMgJiYgYWN0aXZpdGllcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgY29tcFJlZi5pbnN0YW5jZS52YWx1ZSA9IGFjdGl2aXRpZXMubWFwKGEgPT4gYS5JZCk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgY29tcFJlZi5pbnN0YW5jZS52YWx1ZSA9IG5ldyBBcnJheSgpO1xyXG4gICAgICB9XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBjb21wUmVmLmluc3RhbmNlLnZhbHVlID0gW107XHJcbiAgICB9XHJcbiAgICBjb21wUmVmLmluc3RhbmNlLmxvY2F0aW9uID0gbG9jYXRpb247XHJcbiAgICBjb25zdCBtb2RhbENvbmZpZzogTW9kYWxPcHRpb25zID0gT2JqZWN0LmFzc2lnbihjb21wUmVmLmluc3RhbmNlLm1vZGFsQ29uZmlnLFxyXG4gICAgICB7IGJ1dHRvbnM6IGNvbXBSZWYuaW5zdGFuY2UubW9kYWxGb290ZXIgfSk7XHJcbiAgICBjb25zdCBkaWFsb2cgPSB0aGlzLm1vZGFsU2VydmljZS5zaG93KGNvbXBSZWYsIG1vZGFsQ29uZmlnKTtcclxuICAgIGNvbXBSZWYuaW5zdGFuY2UuY2xvc2VNb2RhbC5zdWJzY3JpYmUoJGV2ZW50ID0+IGRpYWxvZy5jbG9zZSgpKTtcclxuICAgIGNvbXBSZWYuaW5zdGFuY2Uuc3VibWl0TW9kYWwuc3Vic2NyaWJlKChkYXRhOiBhbnkpID0+IHtcclxuICAgICAgdGhpcy51cGRhdGVDaGFuZ2VQcm9wZXJ0eSh7XHJcbiAgICAgICAgY2F0ZWdvcnlJZDogbG9jYXRpb24gPSAnc3RhcnRBY3Rpdml0eScgPyAnYWN0aXZpdHlDb25maWcnIDogJ2FwcHJvdmFsUHJvcGVydHknLFxyXG4gICAgICAgIC8vIHRvZG/vvJrlpJrkuKrmtLvliqjlhbfmnInlkIzlkI3lsZ7mgKfml7bvvIzlpoLkvZXmm7TlkIjnkIblrprkuYlQcm9wZXJ0eUtlee+8n1xyXG4gICAgICAgIHByb3BlcnR5SUQ6IFVzZXJBY3Rpdml0eVByb3BlcnR5S2V5cy5vdGhlckFzc2lnbkFjdGl2aXRpZXMsXHJcbiAgICAgICAgcHJvcGVydHlWYWx1ZTogZGF0YS52YWx1ZVxyXG4gICAgICB9KTtcclxuICAgICAgZGlhbG9nLmNsb3NlKCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOWujOaIkOetlueVpeiwg+aVtOagoemqjFxyXG4gICAqL1xyXG4gIHByaXZhdGUgYmVmb3JlQ29tcGxldGVTdHJhdGVneUNoYW5nZShkYXRhOiBhbnkpOiBPYnNlcnZhYmxlPGJvb2xlYW4+IHtcclxuICAgIGlmICh0aGlzLnRpbWUgPT09IFByb2Nlc3NUaW1lLnJ0KSB7XHJcbiAgICAgIHJldHVybiB0aGlzLnZpZXdNb2RlbC5iZWZvcmVDb21wbGV0ZVN0cmF0ZWd5Q2hhbmdlKGRhdGEsIHRoaXMucnRQcm9jZXNzSW5mbyk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICByZXR1cm4gb2YodHJ1ZSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuXHJcbiAgLyoqXHJcbiAgICog5L+d5a2Y77yM5Y+R5biD77yM5Y+m5a2Y77yM5ZCM5q2l5pON5L2c5pe2XHJcbiAgICog5qCh6aqM5qih5Z6L55qE5rWB56iL5YiG57G7SUTkuI7liJfooajlrZjlgqjmmK/lkKbkuIDoh7TvvIzkuI3kuIDoh7Tml7bvvIzku6XliJfooajkuLrlh4ZcclxuICAgKi9cclxuICBwcml2YXRlIGNoZWNrTW9kZWxDb250ZW50KGNvbnRlbnQ6IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgICBjb25zdCBwcm9jZXNzID0gSlNPTi5wYXJzZShjb250ZW50KTtcclxuICAgIGNvbnN0IG1vZGVsQml6RGVmS2V5ID0gcHJvY2Vzcy5EZWZhdWx0UHJvY2Vzcy5leHRlbnNpb25FbGVtZW50cy5maW5kKGUgPT4gZS5DbHJUeXBlSUQgPT09ICd3Zi5Qcm9jZXNzSGVhZGVyJykuQml6RGVmS2V5O1xyXG4gICAgaWYgKHRoaXMudGltZSA9PT0gUHJvY2Vzc1RpbWUuZHQpIHtcclxuICAgICAgaWYgKG1vZGVsQml6RGVmS2V5ID09PSB0aGlzLnByb2Nlc3NJbmZvLmZsb3dGb3JtSWQpIHtcclxuICAgICAgICByZXR1cm4gY29udGVudDtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBwcm9jZXNzLkRlZmF1bHRQcm9jZXNzLmV4dGVuc2lvbkVsZW1lbnRzLmZpbmQoZSA9PiBlLkNsclR5cGVJRCA9PT0gJ3dmLlByb2Nlc3NIZWFkZXInKS5CaXpEZWZLZXkgPSB0aGlzLnByb2Nlc3NJbmZvLmZsb3dGb3JtSWQ7XHJcbiAgICAgICAgcHJvY2Vzcy5EZWZhdWx0UHJvY2Vzcy5leHRlbnNpb25FbGVtZW50cy5maW5kKGUgPT4gZS5DbHJUeXBlSUQgPT09ICd3Zi5Qcm9jZXNzSGVhZGVyJykuQml6RGVmTmFtZSA9IHRoaXMudWlTdGF0ZS5mbG93Rm9ybUluZm8uZmxvd0Zvcm0ubmFtZTtcclxuICAgICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkocHJvY2Vzcyk7XHJcbiAgICAgIH1cclxuICAgIH0gZWxzZSBpZiAodGhpcy50aW1lID09PSBQcm9jZXNzVGltZS5ydCkge1xyXG4gICAgICBpZiAobW9kZWxCaXpEZWZLZXkgPT09IHRoaXMucnRQcm9jZXNzSW5mby5mbG93Rm9ybUlkKSB7XHJcbiAgICAgICAgcmV0dXJuIGNvbnRlbnQ7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcHJvY2Vzcy5EZWZhdWx0UHJvY2Vzcy5leHRlbnNpb25FbGVtZW50cy5maW5kKGUgPT4gZS5DbHJUeXBlSUQgPT09ICd3Zi5Qcm9jZXNzSGVhZGVyJykuQml6RGVmS2V5ID0gdGhpcy5ydFByb2Nlc3NJbmZvLmZsb3dGb3JtSWQ7XHJcbiAgICAgICAgcHJvY2Vzcy5EZWZhdWx0UHJvY2Vzcy5leHRlbnNpb25FbGVtZW50cy5maW5kKGUgPT4gZS5DbHJUeXBlSUQgPT09ICd3Zi5Qcm9jZXNzSGVhZGVyJykuQml6RGVmTmFtZSA9IHRoaXMudWlTdGF0ZS5mbG93Rm9ybUluZm8uZmxvd0Zvcm0ubmFtZTtcclxuICAgICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkocHJvY2Vzcyk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIHB1YmxpYyBzaG93TW9kZUNoYW5nZShldmVudDogYW55KSB7XHJcbiAgICBjb25zdCB7IG1vZGUgPSBTaG93TW9kZS5wYW5lbCwgd2lkZVdpZHRoID0gMzMwLCBzbWFsbFdpZHRoID0gNDEgfSA9IGV2ZW50IHx8IHt9O1xyXG4gICAgaWYgKG1vZGUgPT09IFNob3dNb2RlLnBhbmVsKSB7XHJcbiAgICAgIHRoaXMucGFuZWxXaWR0aCA9IHdpZGVXaWR0aDtcclxuICAgICAgdGhpcy5yaWdodFBhbmVsV2lkdGggPSB3aWRlV2lkdGg7XHJcbiAgICB9IGVsc2UgaWYgKG1vZGUgPT09IFNob3dNb2RlLnNpZGViYXIpIHtcclxuICAgICAgdGhpcy5wYW5lbFdpZHRoID0gc21hbGxXaWR0aDtcclxuICAgICAgdGhpcy5yaWdodFBhbmVsV2lkdGggPSBzbWFsbFdpZHRoO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgc2F2ZVByb2MoKSB7XHJcbiAgICBjb25zdCBtb2RlbCA9IHRoaXMuZWRpdG9yVWkuZ3JhcGguYnBtbk1vZGVsO1xyXG4gICAgY29uc3QgcmVzID0gV2ZWYWxpZGF0b3JBZGFwdGVyLnZhbGlkYXRvcihtb2RlbCwgdGhpcy5zY2VuZSk7XHJcbiAgICBpZiAocmVzLnZhbGlkID09IGZhbHNlKSB7XHJcbiAgICAgIHRoaXMuc2hvd1RpcChyZXMpO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBpZiAocmVzLndhcm5pbmdMaXN0ICYmIHJlcy53YXJuaW5nTGlzdC5sZW5ndGggPiAwKSB7XHJcbiAgICAgIHRoaXMuc2hvd1ZlcmlmeShyZXMud2FybmluZ0xpc3QpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5jbGVhclZhbGlkYXRpb25UaXBzKCk7XHJcbiAgICB9XHJcbiAgICB0aGlzLnNhdmUobW9kZWwuQ29udmVydFRvSnNvbigpKTtcclxuICB9XHJcbiAgc2F2ZUFzKCkge1xyXG4gICAgaWYgKCEodGhpcy51aVN0YXRlLmVuYWJsZUFkbWluT3JnQXV0IHx8ICgodGhpcy51aVN0YXRlLmlzQWRtaW5pc3RyYXRvckNvbmZpZyAmJlxyXG4gICAgICB0aGlzLnVpU3RhdGUuYWRtaW5pc3RyYXRvciAhPT0gbnVsbCkgfHwgKCF0aGlzLnVpU3RhdGUuaXNBZG1pbmlzdHJhdG9yQ29uZmlnKSkpKSB7XHJcbiAgICAgIHRoaXMubWVzc2FnZS5pbmZvKHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oXCJwcm9jZXNzRWRpdG9yLm5vUGVybWlzc2lvblRvU2F2ZVwiKSk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGNvbnN0IG1vZGVsID0gdGhpcy5lZGl0b3JVaS5ncmFwaC5icG1uTW9kZWw7XHJcbiAgICBjb25zdCByZXMgPSBXZlZhbGlkYXRvckFkYXB0ZXIudmFsaWRhdG9yKG1vZGVsLCB0aGlzLnNjZW5lKTtcclxuICAgIGlmIChyZXMudmFsaWQgPT0gZmFsc2UpIHtcclxuICAgICAgdGhpcy5zaG93VGlwKHJlcyk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGlmIChyZXMud2FybmluZ0xpc3QgJiYgcmVzLndhcm5pbmdMaXN0Lmxlbmd0aCA+IDApIHtcclxuICAgICAgdGhpcy5zaG93VmVyaWZ5KHJlcy53YXJuaW5nTGlzdCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLmNsZWFyVmFsaWRhdGlvblRpcHMoKTtcclxuICAgIH1cclxuICAgIGNvbnN0IHByb2Nlc3MgPSBuZXcgQnBtbk1vZGVsKCk7XHJcbiAgICBwcm9jZXNzLkxvYWRGcm9tSnNvbihtb2RlbC5Db252ZXJ0VG9Kc29uKCkpO1xyXG4gICAgcHJvY2Vzcy5EZWZhdWx0UHJvY2Vzcy5LZXkgPSBQcm9jZXNzRGVVdGlsLkdlbmVyYXRlRWxlbWVudElkKCk7XHJcbiAgICBwcm9jZXNzLkRlZmF1bHRQcm9jZXNzLklkID0gUHJvY2Vzc0RlVXRpbC5HZW5lcmF0ZUVsZW1lbnRJZCgpO1xyXG4gICAgcHJvY2Vzcy5EZWZhdWx0RGlhZ3JhbS5CcG1uUGxhbmUuQnBtbkVsZW1lbnRJZCA9IHByb2Nlc3MuRGVmYXVsdFByb2Nlc3MuSWQ7XHJcbiAgICB0aGlzLnZpZXdNb2RlbC5zYXZlQXNQcm9jZXNzKHByb2Nlc3MsIHRoaXMucHJvY2Vzc0luZm8pO1xyXG4gIH1cclxuICByZWxlYXNlUHJvYygpIHtcclxuICAgIGNvbnN0IG1vZGVsID0gdGhpcy5lZGl0b3JVaS5ncmFwaC5icG1uTW9kZWw7XHJcbiAgICBjb25zdCByZXMgPSBXZlZhbGlkYXRvckFkYXB0ZXIudmFsaWRhdG9yKG1vZGVsLCB0aGlzLnNjZW5lKTtcclxuICAgIGlmIChyZXMudmFsaWQgPT0gZmFsc2UpIHtcclxuICAgICAgdGhpcy5zaG93VGlwKHJlcyk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGlmIChyZXMud2FybmluZ0xpc3QgJiYgcmVzLndhcm5pbmdMaXN0Lmxlbmd0aCA+IDApIHtcclxuICAgICAgdGhpcy5zaG93VmVyaWZ5KHJlcy53YXJuaW5nTGlzdCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLmNsZWFyVmFsaWRhdGlvblRpcHMoKTtcclxuICAgIH1cclxuICAgIHRoaXMucmVsZWFzZShtb2RlbC5Db252ZXJ0VG9Kc29uKCkpO1xyXG4gIH1cclxuICBzeW5jKCkge1xyXG4gICAgY29uc3QgbW9kZWwgPSB0aGlzLmVkaXRvclVpLmdyYXBoLmJwbW5Nb2RlbDtcclxuICAgIGNvbnN0IHJlcyA9IFdmVmFsaWRhdG9yQWRhcHRlci52YWxpZGF0b3IobW9kZWwsIHRoaXMuc2NlbmUpO1xyXG4gICAgaWYgKHJlcy52YWxpZCA9PSBmYWxzZSkge1xyXG4gICAgICB0aGlzLnNob3dUaXAocmVzKTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgaWYgKHJlcy53YXJuaW5nTGlzdCAmJiByZXMud2FybmluZ0xpc3QubGVuZ3RoID4gMCkge1xyXG4gICAgICB0aGlzLnNob3dWZXJpZnkocmVzLndhcm5pbmdMaXN0KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuY2xlYXJWYWxpZGF0aW9uVGlwcygpO1xyXG4gICAgfVxyXG4gICAgdGhpcy52aWV3TW9kZWwuc3luY0R0UHJvY2Vzcyhtb2RlbC5Db252ZXJ0VG9Kc29uKCksIHRoaXMucnRQcm9jZXNzSW5mbyk7XHJcbiAgfVxyXG4gIHByb2NSZWNvcmQoKSB7XHJcbiAgICBjb25zdCByZWNvcmQgPSB0aGlzLmVkaXRvclVpLmdyYXBoLmJwbW5Nb2RlbC5EZWZhdWx0UHJvY2Vzcy5Eb2N1bWVudGF0aW9uO1xyXG4gICAgdGhpcy5ub3RlKHJlY29yZCk7XHJcbiAgfVxyXG4gIGJhdGNoU2V0KCkge1xyXG4gICAgY29uc3QgY29tcEZhY3RvcnkgPSB0aGlzLnJlc29sdmVyLnJlc29sdmVDb21wb25lbnRGYWN0b3J5KEJhdGNoU2V0UHJvcGVydGllc0NvbXBvbmVudCk7XHJcbiAgICBjb25zdCBjb21wUmVmID0gY29tcEZhY3RvcnkuY3JlYXRlKHRoaXMuaW5qZWN0b3IpO1xyXG4gICAgY29uc3QgbW9kYWxDb25maWc6IE1vZGFsT3B0aW9ucyA9IHtcclxuICAgICAgdGl0bGU6ICfmibnph4/orr7nva4nLFxyXG4gICAgICB3aWR0aDogNTEyLFxyXG4gICAgICBoZWlnaHQ6IDU2NSxcclxuICAgICAgc2hvd0J1dHRvbnM6IHRydWUsXHJcbiAgICAgIGJ1dHRvbnM6IGNvbXBSZWYuaW5zdGFuY2UuZm9vdGVyXHJcbiAgICB9O1xyXG4gICAgY29uc3QgZGlhbG9nID0gdGhpcy5tb2RhbFNlcnZpY2Uuc2hvdyhjb21wUmVmLCBtb2RhbENvbmZpZyk7XHJcbiAgICBjb21wUmVmLmluc3RhbmNlLmNhbmNlbC5zdWJzY3JpYmUoJGV2ZW50ID0+IGRpYWxvZy5jbG9zZSgpKTtcclxuICAgIGNvbXBSZWYuaW5zdGFuY2Uuc3VibWl0LnN1YnNjcmliZSgoZGF0YTogc3RyaW5nKSA9PiB7XHJcbiAgICAgIGRpYWxvZy5jbG9zZSgpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG4gIGNsb3NlUHJvYygpIHtcclxuICAgIC8vIOWmguaenOeVjOmdouWPkeeUn+WPmOWMlu+8jOWinuWKoOehruiupOahhuaPkOekuu+8jOaXoOWPmOWMluWImeebtOaOpeWFs+mXrVxyXG4gICAgaWYgKHRoaXMuY2hhbmdlZEZsYWcpIHtcclxuICAgICAgdGhpcy5tZXNzYWdlLmNvbmZpcm0odGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybShcInByb2Nlc3NFZGl0b3IuY2xvc2VQcm9jMVwiKSxcclxuICAgICAgdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybShcInByb2Nlc3NFZGl0b3IuY2xvc2VQcm9jMlwiKSkuc3Vic2NyaWJlKFxyXG4gICAgICAgIChmKSA9PiB7XHJcbiAgICAgICAgICBpZiAoZikge1xyXG4gICAgICAgICAgICB0aGlzLmNsb3NlLmVtaXQoKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLmNsb3NlLmVtaXQoKTtcclxuICAgIH1cclxuICB9XHJcbiAgdmlld1Byb2NNb2RlbCgpIHtcclxuICAgIGNvbnN0IG1vZGFsQ29uZmlnOiBNb2RhbE9wdGlvbnMgPSB7XHJcbiAgICAgIHRpdGxlOiB0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKFwicHJvY2Vzc0VkaXRvci52aWV3TW9kZWxcIiksXHJcbiAgICAgIHdpZHRoOiA4MDAsXHJcbiAgICAgIGhlaWdodDogNTIwLFxyXG4gICAgICBzaG93QnV0dG9uczogZmFsc2VcclxuICAgIH07XHJcbiAgICAvLyDmqKHlnovoh6rliqjlpI3liLbliLDliarotLTmnb9cclxuICAgIHRoaXMubm90aWZ5LnN1Y2Nlc3ModGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybShcInByb2Nlc3NFZGl0b3IuY29waWVkXCIpKTtcclxuICAgIHRoaXMuY29weSh0aGlzLmVkaXRvclVpLmdyYXBoLmJwbW5Nb2RlbC5Db252ZXJ0VG9Kc29uKCkpO1xyXG4gICAgdGhpcy5tb2RhbFNlcnZpY2Uuc2hvdyh0aGlzLmVkaXRvclVpLmdyYXBoLmJwbW5Nb2RlbC5Db252ZXJ0VG9Kc29uKCksIG1vZGFsQ29uZmlnKTtcclxuICB9XHJcbiAgLyoqXHJcbiAgICog5bem5Y+z5ouW5Yqo5ZCO5LqL5Lu277yMZXZlbnQuc2l6ZS53aWR0aOaYr+W3puS+p+mdouadv+eahOWuveW6plxyXG4gICAqL1xyXG4gIHJ6U3RvcChldmVudCkge1xyXG4gICAgdGhpcy5wYW5lbFdpZHRoID0gZXZlbnQuc2l6ZS53aWR0aDtcclxuXHJcbiAgICB0aGlzLmVkaXRvclVpICYmIHRoaXMuZWRpdG9yVWkuZ3JhcGgucmVmcmVzaCgpO1xyXG4gIH1cclxuXHJcbiAgLy8g5bGV56S66KGo5Y2V6aqM6K+B57uE5Lu277yM55So5LqO5p6E5Lu25qCh6aqMXHJcbiAgY3JlYXRlVmFsaWRhdGlvblRpcHMoKSB7XHJcbiAgICB0aGlzLnZlcmlmeVNlci5jbGVhcigpO1xyXG4gICAgdGhpcy52ZXJpZnlDb250YWluZXIgPSB0aGlzLnZlcmlmeVNlci5jcmVhdGVWZXJpZnkoe1xyXG4gICAgICBwYXJlbnQ6IHRoaXMuY29udGVudEVsLFxyXG4gICAgICB2ZXJpZnlMaXN0OiB0aGlzLmVycm9yTGlzdCxcclxuICAgICAgdmVyaWZ5VHlwZTogdGhpcy50YWJUeXBlTGlzdCxcclxuICAgICAgc2hvd0xpc3Q6IHRydWUsXHJcbiAgICAgIHNob3dUeXBlOiAncHJvY2Vzc1dhcm5pbmcnLFxyXG4gICAgICB2ZXJpZnlSZXN1bHRUaXBzVG1wbDogdGhpcy50aXBzVG1wbCAvLyDmj5DnpLrmqKHmnb9cclxuICAgIH0pO1xyXG4gICAgdGhpcy5saXN0Y2xpY2sgPSB0aGlzLnZlcmlmeUNvbnRhaW5lci52YWxpZGF0b3JDbGljay5zdWJzY3JpYmUoZSA9PiB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGUpO1xyXG4gICAgfSk7XHJcbiAgICB0aGlzLnNob3djaGFuZ2UgPSB0aGlzLnZlcmlmeUNvbnRhaW5lci5saXN0c2hvd0NoYW5nZS5zdWJzY3JpYmUoZSA9PiB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGUpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgY2xlYXJWYWxpZGF0aW9uVGlwcygpIHtcclxuICAgIHRoaXMuZXJyb3JMaXN0ID0gW107XHJcbiAgICBpZiAodGhpcy52ZXJpZnlTZXIpIHtcclxuICAgICAgdGhpcy52ZXJpZnlTZXIuY2xlYXIoKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGNvcHkodGV4dCkge1xyXG4gICAgY29uc3QgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpXHJcbiAgICBlbC5zZXRBdHRyaWJ1dGUoJ3ZhbHVlJywgdGV4dClcclxuICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoZWwpXHJcbiAgICBlbC5zZWxlY3QoKVxyXG4gICAgZG9jdW1lbnQuZXhlY0NvbW1hbmQoJ2NvcHknKVxyXG4gICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChlbClcclxuICB9XHJcbn1cclxuIl19