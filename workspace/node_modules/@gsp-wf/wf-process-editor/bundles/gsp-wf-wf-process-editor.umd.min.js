!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("rxjs/observable/forkJoin"),require("rxjs/observable/of"),require("rxjs/ReplaySubject"),require("@gsp-cmp/wscmp-models"),require("@farris/lookup-config"),require("rxjs/Observable"),require("rxjs/Subject"),require("@edp-aif/common-api"),require("@edp-pmf/grapheditor"),require("@edp-pmf/mxgraph-ts"),require("@edp-pmf/bpmn-model"),require("@gsp-wf/wf-process-model"),require("@gsp-cmp/ccmp-ui"),require("@gsp-sys/sysmgr-ui"),require("@gsp-sys/rtf-ui"),require("@farris/ide-property-panel"),require("@farris/ui-datatable"),require("@farris/ui-layout"),require("@farris/ui-flex-layout"),require("@farris/ui-panel"),require("@farris/ui-responsive"),require("@farris/ui-popover"),require("@farris/ui-datagrid-filter"),require("@farris/ui-dropdown"),require("@farris/ui-wizard"),require("@farris/ui-perfect-scrollbar"),require("@gsp-svc/expression"),require("@gsp-wf/wf-bizprocess-lookup"),require("@farris/ui-number-spinner"),require("rxjs"),require("rxjs/operators"),require("@farris/ui-button"),require("@edp-bif/common-api"),require("@gsp-bef/gsp-cm-metadata"),require("@farris/ui-combo-lookup"),require("@gsp-sys/sysmgr-lookup"),require("@farris/ui-verify-detail"),require("@farris/ui-html-editor"),require("@gsp-wf/wf-task-handler"),require("@angular/common/http"),require("@angular/forms"),require("@ecp-caf/caf-common"),require("@farris/ui-combo-list"),require("@farris/ui-common"),require("@farris/ui-datagrid"),require("@farris/ui-datagrid-editors"),require("@farris/ui-dialog"),require("@farris/ui-draggable"),require("@farris/ui-forms"),require("@farris/ui-input-group"),require("@farris/ui-language-textbox"),require("@farris/ui-list-filter"),require("@farris/ui-loading"),require("@farris/ui-lookup"),require("@farris/ui-messager"),require("@farris/ui-modal"),require("@farris/ui-notify"),require("@farris/ui-pagination"),require("@farris/ui-section"),require("@farris/ui-splitter"),require("@farris/ui-switch"),require("@farris/ui-tabs"),require("@farris/ui-treetable"),require("@gsp-lcm/bo-rt-service"),require("@gsp-lcm/metadatart-selector"),require("@gsp-sys/rtf-common"),require("@farris/ui-response-toolbar"),require("@gsp-svc/data-entity-adapter"),require("@gsp-wf/biz-process-api"),require("@farris/ui-personnel-selector"),require("@ngx-translate/http-loader"),require("@ngx-translate/core"),require("@angular/common"),require("@angular/router"),require("@angular/core")):"function"==typeof define&&define.amd?define("@gsp-wf/wf-process-editor",["exports","rxjs/observable/forkJoin","rxjs/observable/of","rxjs/ReplaySubject","@gsp-cmp/wscmp-models","@farris/lookup-config","rxjs/Observable","rxjs/Subject","@edp-aif/common-api","@edp-pmf/grapheditor","@edp-pmf/mxgraph-ts","@edp-pmf/bpmn-model","@gsp-wf/wf-process-model","@gsp-cmp/ccmp-ui","@gsp-sys/sysmgr-ui","@gsp-sys/rtf-ui","@farris/ide-property-panel","@farris/ui-datatable","@farris/ui-layout","@farris/ui-flex-layout","@farris/ui-panel","@farris/ui-responsive","@farris/ui-popover","@farris/ui-datagrid-filter","@farris/ui-dropdown","@farris/ui-wizard","@farris/ui-perfect-scrollbar","@gsp-svc/expression","@gsp-wf/wf-bizprocess-lookup","@farris/ui-number-spinner","rxjs","rxjs/operators","@farris/ui-button","@edp-bif/common-api","@gsp-bef/gsp-cm-metadata","@farris/ui-combo-lookup","@gsp-sys/sysmgr-lookup","@farris/ui-verify-detail","@farris/ui-html-editor","@gsp-wf/wf-task-handler","@angular/common/http","@angular/forms","@ecp-caf/caf-common","@farris/ui-combo-list","@farris/ui-common","@farris/ui-datagrid","@farris/ui-datagrid-editors","@farris/ui-dialog","@farris/ui-draggable","@farris/ui-forms","@farris/ui-input-group","@farris/ui-language-textbox","@farris/ui-list-filter","@farris/ui-loading","@farris/ui-lookup","@farris/ui-messager","@farris/ui-modal","@farris/ui-notify","@farris/ui-pagination","@farris/ui-section","@farris/ui-splitter","@farris/ui-switch","@farris/ui-tabs","@farris/ui-treetable","@gsp-lcm/bo-rt-service","@gsp-lcm/metadatart-selector","@gsp-sys/rtf-common","@farris/ui-response-toolbar","@gsp-svc/data-entity-adapter","@gsp-wf/biz-process-api","@farris/ui-personnel-selector","@ngx-translate/http-loader","@ngx-translate/core","@angular/common","@angular/router","@angular/core"],t):t((e["gsp-wf"]=e["gsp-wf"]||{},e["gsp-wf"]["wf-process-editor"]={}),e.rxjs["observable/forkJoin"],e.rxjs["observable/of"],e.rxjs.ReplaySubject,e.wscmpModels,e.lookupConfig,e.rxjs.Observable,e.rxjs.Subject,e.commonApi,e.grapheditor,e.mxgraphTs,e.bpmnModel,e.wfProcessModel,e.ccmpUi,e.sysmgrUi,e.rtfUi,e.idePropertyPanel,e.uiDatatable,e.uiLayout,e.uiFlexLayout,e.uiPanel,e.uiResponsive,e.uiPopover,e.uiDatagridFilter,e.uiDropdown,e.uiWizard,e.uiPerfectScrollbar,e.expression,e.wfBizprocessLookup,e.uiNumberSpinner,e.rxjs,e.rxjs.operators,e.uiButton,e.commonApi$1,e.gspCmMetadata,e.uiComboLookup,e.sysmgrLookup,e.uiVerifyDetail,e.uiHtmlEditor,e.wfTaskHandler,e.ng.common.http,e.ng.forms,e.cafCommon,e.uiComboList,e.uiCommon,e.uiDatagrid,e.uiDatagridEditors,e.uiDialog,e.uiDraggable,e.uiForms,e.uiInputGroup,e.uiLanguageTextbox,e.uiListFilter,e.uiLoading,e.uiLookup,e.uiMessager,e.uiModal,e.uiNotify,e.uiPagination,e.uiSection,e.uiSplitter,e.uiSwitch,e.uiTabs,e.uiTreetable,e.boRtService,e.metadatartSelector,e.rtfCommon,e.uiResponseToolbar,e.dataEntityAdapter,e.bizProcessApi,e.uiPersonnelSelector,e.httpLoader,e.core,e.ng.common,e.ng.router,e.ng.core)}(this,function(e,O,M,N,L,F,R,V,z,ce,pe,B,de,U,j,H,_,G,K,q,W,J,$,Y,X,Z,Q,D,ee,te,v,re,ie,f,ne,oe,ae,se,le,me,fe,he,t,ye,ge,ve,g,be,xe,we,Pe,Ce,Ie,Se,Ee,r,i,Te,Ae,ke,Oe,Me,De,Ne,Le,Fe,Re,Ve,ze,Be,Ue,je,He,_e,Ge,b){"use strict";qe.decorators=[{type:b.Injectable,args:[{providedIn:"root"}]}],qe.ctorParameters=function(){return[]},qe.ngInjectableDef=b.defineInjectable({factory:function(){return new qe},token:qe,providedIn:"root"});var Ke=qe;function qe(){}var We={dt:"dt",rt:"rt"},Je=function(e,t){return(Je=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}Je(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var $e=function(){return($e=Object.assign||function $e(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};function ue(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],i=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return{value:(e=e&&i>=e.length?void 0:e)&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ye(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var i,n,o=r.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(i=o.next()).done;)a.push(i.value)}catch(s){n={error:s}}finally{try{i&&!i.done&&(r=o["return"])&&r.call(o)}finally{if(n)throw n.error}}return a}function w(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(Ye(arguments[t]));return e}var Xe=function(){},o=new b.InjectionToken("WF_LANG_RESOURCES"),x=(Ze.prototype.transform=function(e){var t,r,i=e.split("."),n=this.lang;try{for(var o=ue(i),a=o.next();!a.done;a=o.next())if(null==(n=n[a.value]))break}catch(s){t={error:s}}finally{try{a&&!a.done&&(r=o["return"])&&r.call(o)}finally{if(t)throw t.error}}return n||e},Ze.prototype.instant=function(e){return this.transform(e)},Ze.decorators=[{type:b.Pipe,args:[{name:"wfLocale"}]}],Ze.ctorParameters=function(){return[{type:String,decorators:[{type:b.Optional},{type:b.Inject,args:[b.LOCALE_ID]}]},{type:undefined,decorators:[{type:b.Optional},{type:b.Inject,args:[o]}]}]},Ze);function Ze(e,t){this.defaultLang="zh-CHS",this.langCode=e||this.defaultLang,this.resources=t||{},this.lang=t[this.langCode]||t[this.defaultLang]||{}}Object.defineProperty(s.prototype,"ProcessVariables",{get:function(){return this.processVariables},set:function(e){this.processVariables=e,this.setProcessVariableContext()},enumerable:!0,configurable:!0}),s.prototype.variableContextName=function(t){return this.participantContext.find(function(e){return e.key===t}).name},s.prototype.ranksName=function(t){return this.dimensions.find(function(e){return e.value===t}).text},s.prototype.getMessageChannels=function(){var t=this;this.http.get("/api/runtime/msg/v1.0/messageplatform/channel/getenabledchannels").subscribe(function(e){t.messageChannels=e})},s.prototype.getAdministratorInfo=function(){var t=this;this.getCurrentUser().subscribe(function(e){e=e.userId;v.forkJoin(t.getAdministratorConfig(),t.getAdministrator(e)).subscribe(function(e){t.isAdministratorConfig="true"===e[0].currentValue,t.administrator=e[1]})})},s.prototype.getEnableAdminOrgAut=function(){return this.getEnableProcessDesignerDataAut("WF_AdminOrg")},s.prototype.getEnableFlowFormAut=function(){return this.getEnableProcessDesignerDataAut("WF_FlowForm")},s.prototype.getEnableProcessDesignerDataAut=function(e){return this.http.get("/api/runtime/wf/v1.0/dtProcDefs/enableProcessDesignerDataAut/"+e)},s.prototype.getCurrentUser=function(){return this.http.get("/api/runtime/sys/v1.0/userinfos?infoType=user")},s.prototype.getAdministrator=function(e){return this.http.get("/api/runtime/wf/v1.0/processAdministrator/"+e)},s.prototype.getReleaseConfig=function(){return this.http.get("/api/runtime/wf/v1.0/generalConfig/Is_Enable_Examine")},s.prototype.getAdministratorConfig=function(){return this.http.get("/api/runtime/wf/v1.0/generalConfig/Is_EnableAdministrator")},s.prototype.getSysOrgById=function(e){return this.http.get("/api/runtime/sys/v1.0/sysOrgs/"+e)},s.prototype.getSysOrgWithAllSubsById=function(e){e="/api/runtime/sys/v1.0/sysOrgs?param="+encodeURIComponent('{"parentId":"'+e+'","withAllSub":true}');return this.http.get(e)},s.prototype.getCurUserInfo=function(e){return this.http.get("/api/runtime/sys/v1.0/users/"+e)},s.prototype.getOrgConfig=function(){return this.http.get("/api/runtime/wf/v1.0/generalConfig/Is_Required_Organization")},s.prototype.getUserInfo=function(){return this.http.get("/api/runtime/sys/v1.0/userinfos?infoType=user")},s.prototype.createData=function(){return this.http.post("/api/bpms/wf/v1.0/processrelease_frm",{dataChange:[],variableChange:null})},s.prototype.releaseSave=function(e){return this.http.put("/api/bpms/wf/v1.0/processrelease_frm",{dataChange:[e],variableChange:null})},s.prototype.setProcessVariableContext=function(){var e,t;if(this.processVariableContext=new Array,this.ProcessVariables&&0<this.ProcessVariables.length)try{for(var r=ue(this.ProcessVariables),i=r.next();!i.done;i=r.next()){var n=i.value,o={key:n.name,name:n.documentation,description:n.description};this.processVariableContext.push(o)}}catch(a){e={error:a}}finally{try{i&&!i.done&&(t=r["return"])&&t.call(r)}finally{if(e)throw e.error}}},s.prototype.getHelpMetaData=function(e,t){return this.http.get("/api/runtime/lcm/v1.0/rt-metadatas/"+e)},s.prototype.getTopWindow=function(){var e=window.self;try{for(;e.location.origin===e.parent.location.origin&&e!==e.parent&&!e.isRTFTopWin;)e=e.parent}catch(t){}return e},s.prototype.initUIState=function(){this.propertyConfig=[],this.propertyData=null,this.content="",this.schemas=[]},s.prototype.getUserActList=function(e){var t,r;if(this.userActList=[],e&&0<e.length)try{for(var i=ue(e),n=i.next();!n.done;n=i.next()){var o=n.value,a={Id:o.Id,Name:o.NameLanguage&&o.NameLanguage[this.localePipe.langCode]||o.Name,ClrTypeID:o.ClrTypeID,AssignmentStrategy:o.AssignmentStrategy};"ASSIGN"===o.AssignmentStrategy&&(a.AssignPerformerConfig=o.AssignPerformerConfig),this.userActList.push(a)}}catch(s){t={error:s}}finally{try{n&&!n.done&&(r=i["return"])&&r.call(i)}finally{if(t)throw t.error}}},s.prototype.getEndEventList=function(e){var t,r;if(this.allActList=[],e&&0<e.length)try{for(var i=ue(e),n=i.next();!n.done;n=i.next()){var o=n.value,a={Id:o.Id,Name:o.Name};this.allActList.push(a)}}catch(s){t={error:s}}finally{try{n&&!n.done&&(r=i["return"])&&r.call(i)}finally{if(t)throw t.error}}},s.prototype.getNotifyEventList=function(e){var t,r;if(this.NotifyActKist=[],e&&0<e.length)try{for(var i=ue(e),n=i.next();!n.done;n=i.next()){var o=n.value,a={Id:o.Id,Name:o.Name};this.NotifyActKist.push(a)}}catch(s){t={error:s}}finally{try{n&&!n.done&&(r=i["return"])&&r.call(i)}finally{if(t)throw t.error}}},s.prototype.getMessageEventList=function(e){var t,r;if(this.MessageActList=[],e&&0<e.length)try{for(var i=ue(e),n=i.next();!n.done;n=i.next()){var o=n.value,a={Id:o.Id,Name:o.Name};this.MessageActList.push(a)}}catch(s){t={error:s}}finally{try{n&&!n.done&&(r=i["return"])&&r.call(i)}finally{if(t)throw t.error}}this.MessageActList=this.MessageActList.concat(this.NotifyActKist),this.MessageActList=this.MessageActList.concat(this.userActList)},s.prototype.getSubAndCatchEventsList=function(e){var t,r;if(this.SubAndCatchActList=[],e&&0<e.length)try{for(var i=ue(e),n=i.next();!n.done;n=i.next()){var o=n.value,a={Id:o.Id,Name:o.Name};this.SubAndCatchActList.push(a)}}catch(s){t={error:s}}finally{try{n&&!n.done&&(r=i["return"])&&r.call(i)}finally{if(t)throw t.error}}},s.prototype.getStartMode=function(e){this.startMode=e},s.prototype.addContext=function(e){var t,r,i,n,o,a,s,l;if(0<this.procInstContext.length)try{for(var c=ue(this.procInstContext),p=c.next();!p.done;p=c.next()){var d=p.value;e.push(d)}}catch(v){t={error:v}}finally{try{p&&!p.done&&(r=c["return"])&&r.call(c)}finally{if(t)throw t.error}}if(0<this.formalParameterContext.length)try{for(var u=ue(this.formalParameterContext),m=u.next();!m.done;m=u.next())!function(t){e.some(function(e){return e.key===t.key})||e.push(t)}(d=m.value)}catch(b){i={error:b}}finally{try{m&&!m.done&&(n=u["return"])&&n.call(u)}finally{if(i)throw i.error}}if(0<this.participantContext.length)try{for(var f=ue(this.participantContext),h=f.next();!h.done;h=f.next())!function(t){e.some(function(e){return e.key===t.key})||e.push(t)}(d=h.value)}catch(x){o={error:x}}finally{try{h&&!h.done&&(a=f["return"])&&a.call(f)}finally{if(o)throw o.error}}if(0<this.processVariableContext.length)try{for(var y=ue(this.processVariableContext),g=y.next();!g.done;g=y.next())!function(t){e.some(function(e){return e.key===t.key})||e.push(t)}(d=g.value)}catch(w){s={error:w}}finally{try{g&&!g.done&&(l=y["return"])&&l.call(y)}finally{if(s)throw s.error}}return e},s.decorators=[{type:b.Injectable}],s.ctorParameters=function(){return[{type:t.HttpService},{type:x}]};var a=s;function s(e,t){this.http=e,this.localePipe=t,this.rootPath="",this.flowFormInfo=new Xe,this.content="",this.propertyConfig=[],this.propertyData={},this.POST_MESSAGE_TARGET=window.document.location.origin+this.rootPath+"/platform/runtime/wf/web/designer/index.html",this.schemas=[],this.counterSignVariables=[],this.approvalItems=[],this.userActList=[],this.allActList=[],this.MessageActList=[],this.NotifyActKist=[],this.SubAndCatchActList=[],this.enableAdminOrgAut=!1,this.enableFlowFormAut=!1,this.isAdministratorConfig=!1,this.assignIterator=[{key:"ALL",value:this.localePipe.transform("app.processDesigner.all")},{key:"ASSIGN",value:this.localePipe.transform("app.processDesigner.assign")},{key:"CLAIM",value:this.localePipe.transform("app.processDesigner.claim")}],this.completeIterator=[{key:"Preempt",value:this.localePipe.transform("app.processDesigner.preempt")},{key:"Parallel",value:this.localePipe.transform("app.processDesigner.parallel")},{key:"Sequential",value:this.localePipe.transform("app.processDesigner.sequential")}],this.completeIterator4Claim=[{key:"Preempt",value:this.localePipe.transform("app.processDesigner.preempt")}],this.boolIterator=[{key:!0,value:this.localePipe.transform("app.processDesigner.true")},{key:!1,value:this.localePipe.transform("app.processDesigner.false")}],this.noJump4Sign=[{key:!1,value:this.localePipe.transform("app.processDesigner.false")}],this.procInstContext=[{key:"dataId",name:this.localePipe.transform("app.processDesigner.dataId"),description:'this.localePipe.transform("app.processDesigner.dataId")'},{key:"procInstId",name:this.localePipe.transform("app.processDesigner.procInstId"),description:this.localePipe.transform("app.processDesigner.procInstId")},{key:"bizDefKey",name:this.localePipe.transform("app.processDesigner.bizDefKey"),description:this.localePipe.transform("app.processDesigner.bizDefKey")},{key:"processDefinitionKey",name:this.localePipe.transform("app.processDesigner.processDefinitionKey"),description:this.localePipe.transform("app.processDesigner.processDefinitionKey")},{key:"procInstCreator",name:this.localePipe.transform("app.processDesigner.procInstCreator"),description:this.localePipe.transform("app.processDesigner.procInstCreator")},{key:"businessCreator",name:this.localePipe.transform("app.processDesigner.businessCreator"),description:this.localePipe.transform("app.processDesigner.businessCreator")},{key:"procInstDescription",name:this.localePipe.transform("app.processDesigner.procInstDescription"),description:this.localePipe.transform("app.processDesigner.procInstDescription")},{key:"comment",name:this.localePipe.transform("app.processDesigner.comment"),description:this.localePipe.transform("app.processDesigner.comment")},{key:"bizDefName",name:this.localePipe.transform("app.processDesigner.bizDefName"),description:this.localePipe.transform("app.processDesigner.bizDefName")},{key:"curLoginUsername",name:this.localePipe.transform("app.processDesigner.curLoginUsername"),description:this.localePipe.transform("app.processDesigner.curLoginUsername")},{key:"procInstCreatorName",name:this.localePipe.transform("app.processDesigner.procInstCreatorName"),description:this.localePipe.transform("app.processDesigner.procInstCreatorName")},{key:"currentParticipantId",name:this.localePipe.transform("app.processDesigner.currentParticipantId"),description:this.localePipe.transform("app.processDesigner.currentParticipantId")},{key:"currentParticipantName",name:this.localePipe.transform("app.processDesigner.currentParticipantName"),description:this.localePipe.transform("app.processDesigner.currentParticipantName")}],this.urgeContext=[{key:"dataId",name:this.localePipe.transform("app.processDesigner.dataId"),description:this.localePipe.transform("app.processDesigner.dataId")},{key:"procInstId",name:this.localePipe.transform("app.processDesigner.procInstId"),description:this.localePipe.transform("app.processDesigner.procInstId")},{key:"bizDefKey",name:this.localePipe.transform("app.processDesigner.bizDefKey"),description:this.localePipe.transform("app.processDesigner.bizDefKey")},{key:"processDefinitionKey",name:this.localePipe.transform("app.processDesigner.processDefinitionKey"),description:this.localePipe.transform("app.processDesigner.processDefinitionKey")},{key:"procInstCreator",name:this.localePipe.transform("app.processDesigner.procInstCreator"),description:this.localePipe.transform("app.processDesigner.procInstCreator")},{key:"businessCreator",name:this.localePipe.transform("app.processDesigner.businessCreator"),description:this.localePipe.transform("app.processDesigner.businessCreator")},{key:"procInstDescription",name:this.localePipe.transform("app.processDesigner.procInstDescription"),description:this.localePipe.transform("app.processDesigner.procInstDescription")},{key:"comment",name:this.localePipe.transform("app.processDesigner.comment"),description:this.localePipe.transform("app.processDesigner.comment")},{key:"bizDefName",name:this.localePipe.transform("app.processDesigner.bizDefName"),description:this.localePipe.transform("app.processDesigner.bizDefName")},{key:"curLoginUsername",name:this.localePipe.transform("app.processDesigner.curLoginUsername"),description:this.localePipe.transform("app.processDesigner.curLoginUsername")},{key:"procInstCreatorName",name:this.localePipe.transform("app.processDesigner.procInstCreatorName"),description:this.localePipe.transform("app.processDesigner.procInstCreatorName")}],this.formalParameterContext=[],this.participantContext=[{key:"procInstCreator",name:this.localePipe.transform("app.processDesigner.procInstCreator"),description:this.localePipe.transform("app.processDesigner.procInstCreator")},{key:"businessCreator",name:this.localePipe.transform("app.processDesigner.businessCreator"),description:this.localePipe.transform("app.processDesigner.businessCreator")},{key:"currentUser",name:this.localePipe.transform("app.processDesigner.currentUser"),description:this.localePipe.transform("app.processDesigner.currentUser")},{key:"preActExecutors",name:this.localePipe.transform("app.processDesigner.preActExecutors"),description:this.localePipe.transform("app.processDesigner.preActExecutors")}],this.subActivityContext=[{key:"collectionElementVariable",name:this.localePipe.transform("app.processDesigner.collectionElementVariable"),description:this.localePipe.transform("app.processDesigner.collectionElementVariable")}],this.subProcessElementContext=[{key:"subCollectionElementVariable",name:this.localePipe.transform("app.processDesigner.subCollectionElementVariable"),description:this.localePipe.transform("app.processDesigner.subCollectionElementVariable")}],this.multiCounterSignVariables=[{key:"nrOfInstances",name:this.localePipe.transform("app.processDesigner.nrOfInstances"),description:this.localePipe.transform("app.processDesigner.nrOfInstances")},{key:"nrOfCompletedInstances",name:this.localePipe.transform("app.processDesigner.nrOfCompletedInstances"),description:this.localePipe.transform("app.processDesigner.nrOfCompletedInstances")},{key:"nrOfActiveInstances",name:this.localePipe.transform("app.processDesigner.nrOfActiveInstances"),description:this.localePipe.transform("app.processDesigner.nrOfActiveInstances")},{key:"nrOfForward",name:this.localePipe.transform("app.processDesigner.nrOfForward"),description:this.localePipe.transform("app.processDesigner.nrOfForward")},{key:"nrOfBackward",name:this.localePipe.transform("app.processDesigner.nrOfBackward"),description:this.localePipe.transform("app.processDesigner.nrOfBackward")},{key:"nrOfAbort",name:this.localePipe.transform("app.processDesigner.nrOfAbort"),description:this.localePipe.transform("app.processDesigner.nrOfAbort")}],this.activityComponentContext=[{key:"conclusionType",name:this.localePipe.transform("app.processDesigner.conclusionType"),description:this.localePipe.transform("app.processDesigner.conclusionTypeTips")},{key:"conclusionValue",name:this.localePipe.transform("app.processDesigner.conclusionValue"),description:this.localePipe.transform("app.processDesigner.conclusionValueTips")}],this.processVariableContext=new Array,this.processVariables=new Array,this.dimensions=[{value:"directSuperior",text:this.localePipe.transform("app.processDesigner.directSuperior")},{value:"higherSuperior",text:this.localePipe.transform("app.processDesigner.higherSuperior")}],this.startModeIterator=[{key:"DIRECT",value:this.localePipe.transform("app.processDesigner.DIRECT")},{key:"EXTERNAL_PROCESS",value:this.localePipe.transform("app.processDesigner.EXTERNAL_PROCESS")},{key:"SUB_PROCESS",value:this.localePipe.transform("app.processDesigner.SUB_PROCESS")}],this.displayTerminal=[{key:"ALL",value:this.localePipe.transform("app.processDesigner.ALL")},{key:"WEB",value:this.localePipe.transform("app.processDesigner.WEB")},{key:"APP",value:this.localePipe.transform("app.processDesigner.APP")}],this.messageChannels=new Array,this.orgTypeCollection=[];try{this.rootPath=window.gspframeworkService.common.getBasePath.get()}catch(r){}}Qe.GenerateElementId=function(){return B.BpmnModelHelper.GenerateElementId()},Qe.createNM=function(){function e(){return(65536*(1+Math.random())|0).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()},Qe.initVariableType=function(e){return e?8<=e.length&&'{"expr":'===e.slice(0,8)?"expression":"constant":"variable"},Qe.prototype.getProcessDesignerRouter=function(){return"processList"},Qe.prototype.getFlowFormWebApi=function(){return"/api/runtime/wf/v1.0/flowForm"},Qe.prototype.getFormalParametersWebApi=function(){return"/api/runtime/wf/v1.0/formalParameter"},Qe.prototype.getMetaDataRUWebApi=function(){return"/api/runtime/lcm/v1.0/rt-metadatas/"},Qe.prototype.getBizComponentsWebApi=function(){return"/api/runtime/wf/v1.0/bizComponent"},Qe.prototype.getExcuteFormsWebApi=function(){return"/api/runtime/wf/v1.0/excuteForm"},Qe.prototype.getProcessDefinitionWebApi=function(){return"/api/runtime/wf/v1.0/dtProcDefs"},Qe.prototype.getCheckExistActiveProcDefApi=function(){return"/api/runtime/wf/v1.0/procDefs/checkExistActiveProcDef"},Qe.prototype.getBizActivityWebApi=function(e){return"/api/runtime/wf/v1.0/bizActivity?flowFormKey="+e},Qe.prototype.getProcDefKeyWebApi=function(){return"/api/runtime/wf/v1.0/procDefs/processDefinitionKeys"},Qe.prototype.deployWebApi=function(){return"/api/runtime/wf/v1.0/procDefs/deploy"},Qe.prototype.saveWebApi=function(){return"/api/runtime/wf/v1.0/DTProcessDefinitions/SaveBpmnModel"},Qe.prototype.getApprovalActionWebApi=function(){return"/api/runtime/wf/v1.0/approvalAction"},Qe.prototype.getRTProcessDefinitionWebApi=function(){return"/api/runtime/wf/v1.0/procDefs"},Qe.prototype.getValue=function(e,t){return t?-1===t.indexOf(".")?e[t]:t.split(".").reduce(function(e,t){return e?e[t]:null},e):""},Qe.prototype.toUpperCase=function(e){var t,r;if("object"==typeof e)try{for(var i=ue(Object.keys(e)),n=i.next();!n.done;n=i.next()){var o=n.value;e[o.substring(0,1).toUpperCase()+o.substring(1)]=e[o],delete e[o]}}catch(a){t={error:a}}finally{try{n&&!n.done&&(r=i["return"])&&r.call(i)}finally{if(t)throw t.error}}return e},Qe.prototype.toLowCase=function(e){var t,r;if("object"==typeof e)try{for(var i=ue(Object.keys(e)),n=i.next();!n.done;n=i.next()){var o=n.value;o.substring(0,1).toLowerCase()+o.substring(1)!==o&&(e[o.substring(0,1).toLowerCase()+o.substring(1)]=e[o],delete e[o])}}catch(a){t={error:a}}finally{try{n&&!n.done&&(r=i["return"])&&r.call(i)}finally{if(t)throw t.error}}return e},Qe.decorators=[{type:b.Injectable}],Qe.ctorParameters=function(){return[]};var l=Qe;function Qe(){}c.prototype.GetFlowFormbyId=function(e){var t;if(e)return t=this.util.getFlowFormWebApi()+"/getFlowForm",this.http.get(t+="/"+e)},c.prototype.getParametersbyFlowFormKey=function(e){var t;if(e)return t=this.util.getFormalParametersWebApi(),this.http.get(t+="?flowFormKey="+e)},c.prototype.getComponentsbyFlowformkey=function(e){var t;if(e)return t=this.util.getBizComponentsWebApi(),t+="/query?param="+encodeURIComponent('{"flowFormKey":"'+e+'"}'),this.http.get(t)},c.prototype.getExecuteFormbyFlowFormKey=function(e){var t;if(e)return t=this.util.getExcuteFormsWebApi(),this.http.get(t+="?flowFormKey="+e)},c.prototype.getBizActivities=function(e){if(e)return e=this.util.getBizActivityWebApi(e),this.http.get(e)},c.prototype.getCustomizeActions=function(e){if(e)return this.http.get("/api/runtime/wf/v1.0/customizeAction?flowFormKey="+e)},c.prototype.getBizActivityComponents=function(e,t){var r;if(t)return r=this.util.getBizComponentsWebApi(),r+="/query?param="+encodeURIComponent('{"flowFormKey":"'+e+'","owner":"'+t+'","ownerType":"Activity"}'),this.http.get(r)},c.prototype.getBizActivityActions=function(e){var t;if(e)return t=this.util.getApprovalActionWebApi(),this.http.get(t+="?bizActivityId="+e)},c.prototype.getBusinessEntitybyId=function(e){if(e)return this.http.get("/api/runtime/lcm/v1.0/bef/expression?beId="+e)},c.prototype.getProcContentbyKey=function(e){var t;if(e)return t=this.util.getProcessDefinitionWebApi(),this.http.get(t+="/bpmnModel?procDefKey="+e)},c.prototype.getRTProcContentbyId=function(e){var t;if(e)return t=this.util.getRTProcessDefinitionWebApi(),this.http.get(t+="/"+e+"/bpmnModel")},c.prototype.saveProcess=function(e,t,r){if(e)return t={organization:t.procOrg?t.procOrg.orgId:"",organizationName:t.procOrg?t.procOrg.orgName:"",accessLevel:t.accessLevel,procContent:e,state:r},e=this.util.getProcessDefinitionWebApi(),this.http.post(e,JSON.stringify(t))},c.prototype.auditProcessDef=function(e){this.http.post("/api/runtime/wf/v1.0/dtProcDefs/auditProcessDef",e).subscribe(function(e){})},c.prototype.deployProcess=function(e){var t;if(e)return e={procDefContent:e},t=this.util.deployWebApi(),this.http.post(t,JSON.stringify(e))},c.prototype.saveRTProcess=function(e,t){var r;if(e)return e={procDefContent:e},r=this.util.getRTProcessDefinitionWebApi(),this.http.post(r+="/"+t+"/adjust",JSON.stringify(e))},c.prototype.syncDtProcess=function(e,t){if(e)return t={organization:t.procOrg?t.procOrg.orgId:"",organizationName:t.procOrg?t.procOrg.orgName:"",accessLevel:t.accessLevel||"public",procContent:e,state:0},this.http.post("/api/runtime/wf/v1.0/dtProcDefs",JSON.stringify(t))},c.prototype.getProcExtendProperty=function(e,t,r){var i="{",e=(i=(i=i+('"bizDefKey":"'+e+'",')+('"bizCategoryId":"'+r+'",'))+('"startMode":"'+t+'"')+"}","/api/runtime/wf/v1.0/procExtendProperty?param="+(i=encodeURIComponent(i)));return this.http.get(e)},c.prototype.getBizCmp=function(){return this.http.get("/api/runtime/wf/v1.0/bizComponent?flowFormKey=*&owner=*&ownerType=Process")},c.prototype.getAllBizCmp=function(e){return this.http.get("/api/runtime/wf/v1.0/bizComponent?flowFormKey="+e+"&owner="+e+"&ownerType=Process")},c.prototype.getFormFormat=function(e){return null==e?M.of(null):this.http.get("/api/runtime/wf/v1.0/formFormat/query?param=%7B%22bizCategory%22%3A%22"+e+"%22%7D")},c.prototype.getGeneralConfig=function(){var e=this;return this.http.get("/api/runtime/wf/v1.0/generalConfig/Is_EnableTransfer").pipe(re.switchMap(function(i){return e.http.get("/api/runtime/wf/v1.0/generalConfig/Is_EnableNotify").pipe(re.switchMap(function(r){return e.http.get("/api/runtime/wf/v1.0/generalConfig/Is_EnableAddSignBehind").pipe(re.switchMap(function(t){return e.http.get("/api/runtime/wf/v1.0/generalConfig/Is_EnableAddSignFront").pipe(re.switchMap(function(e){e={enableTransfer:JSON.parse(i.currentValue),enableNotify:JSON.parse(r.currentValue),enableAddSignBehind:JSON.parse(t.currentValue),enableAddSignFront:JSON.parse(e.currentValue)};return M.of(e)}))}))}))}))},c.decorators=[{type:b.Injectable}],c.ctorParameters=function(){return[{type:t.HttpService},{type:l}]};var et=c;function c(e,t){this.http=e,this.util=t}var tt="bpmn.Process",rt="wf.UserActivity",it="wf.OperationActivity",nt="wf.CallActivitySubProcess",ot="wf.AutoActivity",at="wf.IntermediateCatchEventImpl",st="wf.MessageActivity",lt="wf.NotifyActivity",ct="wf.AifCreationBillActivity",pt="wf.AifBillNodeActivity",dt="wf.AifSequenceActivity",ut=(Object.defineProperty(mt.prototype,"value",{set:function(e){e&&(this.flowFormId=e.id)},enumerable:!0,configurable:!0}),mt.prototype.ngOnInit=function(){this.getBaseAndExtendFlowForm()},mt.prototype.ngAfterViewInit=function(){},mt.prototype.clickOK=function(){var e;this.grid.selectedRow?(e={value:this.grid.selectedRow.data,parameters:null},this.submitModal.emit(e)):this.message.info(this.localePipe.transform("component.entryFormEditor.selectedRow"))},mt.prototype.clickCancel=function(){this.closeModal.emit()},mt.prototype.getBaseAndExtendFlowForm=function(){var e,t=this;this.flowFormId&&(e="/api/runtime/wf/v1.0/flowForm/"+this.flowFormId+"/baseAndExtend",this.http.get(e).subscribe(function(e){e&&0<e.length?(t.data=e,setTimeout(function(){t.grid.selectRow(t.flowFormId,!0)},0)):t.message.info(t.localePipe.transform("component.entryFormEditor.absent"))}))},mt.decorators=[{type:b.Component,args:[{selector:"app-entry-form-editor",template:'<div class="f-page">\r\n  <div class="f-page-main f-utils-fill-flex-column h-100">\r\n    <div class="f-utils-fill-flex-column farris-overflow-y-auto h-100" style="border-radius:16px;border: 1.5px solid #F1F3F7;margin-left: 6px;margin-right: 6px;">\r\n      <farris-datagrid #grid [data]="data" [columns]="columns" [idField]="\'id\'" [fit]="true" [fitColumns]="true"\r\n         [pagination]="false" [showCheckbox]="false" [multiSelect]="false" [showLineNumber]="true" lineNumberTitle="{{\'component.entryFormEditor.lineNumber\' | wfLocale}}"\r\n         [lineNumberWidth]="50">\r\n      </farris-datagrid>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n\r\n<ng-template #iconSelectFooter>\r\n    <button type="button" class="btn btn-secondary btn-sm px-3" (click)="clickCancel()">{{\'component.entryFormEditor.clickCancel\' | wfLocale}}</button>\r\n    <button type="button" class="btn btn-primary btn-sm px-3 mx-2" (click)="clickOK()">{{\'component.entryFormEditor.clickOK\' | wfLocale}}</button>\r\n</ng-template>\r\n',providers:[x],styles:[""]}]}],mt.ctorParameters=function(){return[{type:t.HttpService},{type:r.MessagerService},{type:b.ChangeDetectorRef,decorators:[{type:b.Optional}]},{type:String,decorators:[{type:b.Inject,args:[b.LOCALE_ID]}]},{type:undefined,decorators:[{type:b.Inject,args:[o]}]},{type:x,decorators:[{type:b.Optional}]}]},mt.propDecorators={closeModal:[{type:b.Output}],submitModal:[{type:b.Output}],value:[{type:b.Input}],modalFooter:[{type:b.ViewChild,args:["iconSelectFooter"]}],grid:[{type:b.ViewChild,args:["grid"]}],editorParams:[{type:b.Input}]},mt);function mt(e,t,r,i,n,o){this.http=e,this.message=t,this.cdr=r,this.localeId=i,this.resources=n,this.localePipe=o,this.closeModal=new b.EventEmitter,this.submitModal=new b.EventEmitter,this.editorParams={},this.modalConfig={title:this.localePipe.transform("component.entryFormEditor.flowForm"),width:760,height:506,showButtons:!0},this.columns=[{title:this.localePipe.transform("component.entryFormEditor.code"),field:"code",width:100,sortable:!0},{title:this.localePipe.transform("component.entryFormEditor.name"),field:"name",width:100,sortable:!0},{title:this.localePipe.transform("component.entryFormEditor.base"),field:"base",width:60,formatter:{type:"boolean",options:{trueText:this.localePipe.transform("component.entryFormEditor.extend"),falseText:this.localePipe.transform("component.entryFormEditor.foundation")}}}],this.data=[],this.localePipe=this.localePipe||new x(i,n)}ht.prototype.convertTo=function(e){if(e)return e.name};var ft=ht;function ht(){}gt.decorators=[{type:b.Injectable}],gt.ctorParameters=function(){return[{type:x}]};var yt=gt;function gt(e){this.localePipe=e,this.components=[],this.allComponents=[],this.executionCollection=[{text:this.localePipe.transform("component.activityComponent.PROCESSINSTANCE_STARTED"),value:"PROCESSINSTANCE_STARTED"},{text:this.localePipe.transform("component.activityComponent.PROCESSINSTANCE_SUSPENDED"),value:"PROCESSINSTANCE_SUSPENDED"},{text:this.localePipe.transform("component.activityComponent.PROCESSINSTANCE_RESUMED"),value:"PROCESSINSTANCE_RESUMED"},{text:this.localePipe.transform("component.activityComponent.PROCESSINSTANCE_COMPLETED"),value:"PROCESSINSTANCE_COMPLETED"},{text:this.localePipe.transform("component.activityComponent.PROCESSINSTANCE_ABORTED"),value:"PROCESSINSTANCE_ABORTED"},{text:this.localePipe.transform("component.activityComponent.PROCESSINSTANCE_CANCELED"),value:"PROCESSINSTANCE_CANCELED"},{text:this.localePipe.transform("component.activityComponent.PROCESSINSTANCE_REACTIVATED"),value:"PROCESSINSTANCE_REACTIVATED"},{text:this.localePipe.transform("component.activityComponent.PROCESSINSTANCE_ROLLBACK"),value:"PROCESSINSTANCE_ROLLBACK"},{text:this.localePipe.transform("component.activityComponent.PROCESSINSTANCE_RESUBMIT"),value:"PROCESSINSTANCE_RESUBMIT"},{text:this.localePipe.transform("component.activityComponent.ACTIVITY_AND_PARTICIPANT_UPDATED"),value:"ACTIVITY_AND_PARTICIPANT_UPDATED"},{text:this.localePipe.transform("component.activityComponent.PROCESSINSTANCE_ABORTED_BY_ADMIN"),value:"PROCESSINSTANCE_ABORTED_BY_ADMIN"},{text:this.localePipe.transform("component.activityComponent.PROCESSINSTANCE_BEFORE_START"),value:"PROCESSINSTANCE_BEFORE_START"},{text:this.localePipe.transform("component.activityComponent.WORKITEM_BEFORE_COMPLETE"),value:"WORKITEM_BEFORE_COMPLETE"},{text:this.localePipe.transform("component.activityComponent.WORKITEM_AFTER_COMPLETE"),value:"WORKITEM_AFTER_COMPLETE"},{text:this.localePipe.transform("component.activityComponent.LOADDATA"),value:"LOADDATA"}],this.activityCollection=[{text:this.localePipe.transform("component.activityComponent.ACTIVITY_STARTED"),value:"ACTIVITY_STARTED"},{text:this.localePipe.transform("component.activityComponent.ACTIVITY_COMPLETED"),value:"ACTIVITY_COMPLETED"},{text:this.localePipe.transform("component.activityComponent.ACTIVITY_ABORTED"),value:"ACTIVITY_ABORTED"},{text:this.localePipe.transform("component.activityComponent.WORKITEM_CREATED"),value:"WORKITEM_CREATED"},{text:this.localePipe.transform("component.activityComponent.WORKITEM_COMPLETED"),value:"WORKITEM_COMPLETED"},{text:this.localePipe.transform("component.activityComponent.WORKITEM_SUSPENDED"),value:"WORKITEM_SUSPENDED"},{text:this.localePipe.transform("component.activityComponent.WORKITEM_RESUMED"),value:"WORKITEM_RESUMED"},{text:this.localePipe.transform("component.activityComponent.WORKITEM_ABORTED"),value:"WORKITEM_ABORTED"},{text:this.localePipe.transform("component.activityComponent.WORKITEM_RETRIEVED"),value:"WORKITEM_RETRIEVED"},{text:this.localePipe.transform("component.activityComponent.WORKITEM_CLAIMED"),value:"WORKITEM_CLAIMED"},{text:this.localePipe.transform("component.activityComponent.WORKITEM_UNCLAIMED"),value:"WORKITEM_UNCLAIMED"},{text:this.localePipe.transform("component.activityComponent.ACTIVITY_ASSIGNMENT"),value:"ACTIVITY_ASSIGNMENT"}]}var vt=function(e,t,r){this.id=l.GenerateElementId(),this.name=e,this.metadataId=t,this.methodCode=r,this.isForCompensation=!1},bt="Activity",xt=(wt.prototype.loadComponents=function(e,t){var r=this,i=this.util.getBizComponentsWebApi();t?(i+="/query?param="+encodeURIComponent('{"flowFormKey":"'+e+'","owner":"'+t+'","ownerType":"Activity"}'),this.http.get(i).subscribe(function(e){r.uistate.allComponents=e.filter(function(e){return e.ownerType===bt})})):this.uistate.allComponents=[]},wt.prototype.removeComponent=function(t){t&&(this.uistate.components=this.uistate.components.filter(function(e){return e.id!==t}))},wt.prototype.addComponent=function(e){var t;e&&((t=new vt(e.name,e.id,e.operations[0].code)).id=l.GenerateElementId(),t.actualParameters=this.bindParas(e),console.log(e),console.log(t.actualParameters),"7433df25-9260-4c24-86f0-9da3e89450fb"===t.metadataId||"d0783800-ed60-488c-b053-8806a15947fe"===t.metadataId||"b89e9b9a-2e2d-4bd0-b354-187219544d34"===t.metadataId||"a8b8f7a4-49ae-4b7d-88d2-b3772b9d0ae5"===t.metadataId?t.scopeType="ExternalProcess":t.scopeType="DirectStart",this.uistate.components.push(t),this.subject.next(t))},wt.prototype.bindParas=function(e){var t=[];return t=e.operations[0].parameters&&0<e.operations[0].parameters.length?-1<this.defaultProcessComponentIds.indexOf(e.id)?this.assignParameterValue(e.operations[0].parameters):e.operations[0].parameters.map(function(e){return{code:e.code,name:e.name,value:""}}):t},wt.prototype.assignParameterValue=function(e){var r=this;return e.map(function(e){var t;return-1<e.code.indexOf("beId")?(t=r.designerState.formalParameterContext.filter(function(e){return-1<e.key.indexOf("metadataId")})[0].key,{code:e.code,name:e.name,value:'{"expr":"DefaultFunction.GetContextParameter(\\"'+t+'\\")"}'}):-1<e.code.indexOf("nodeId")?(t=r.designerState.formalParameterContext.filter(function(e){return-1<e.key.indexOf("schemaId")})[0].key,{code:e.code,name:e.name,value:'{"expr":"DefaultFunction.GetContextParameter(\\"'+t+'\\")"}'}):-1<e.code.indexOf("dataId")?{code:e.code,name:e.name,value:'{"expr":"DefaultFunction.GetContextParameter(\\"dataId\\")"}'}:-1<e.code.indexOf("procInstId")?{code:e.code,name:e.name,value:'{"expr":"DefaultFunction.GetContextParameter(\\"procInstId\\")"}'}:{code:e.code,name:e.name,value:""}})},wt.prototype.swapArray=function(e,t,r){return e[t]=e.splice(r,1,e[t])[0],e},wt.prototype.getBizCmp=function(t){this.http.get("/api/runtime/wf/v1.0/bizComponent?flowFormKey=*&owner=*&ownerType=Process").subscribe(function(e){t(e)})},wt.decorators=[{type:b.Injectable}],wt.ctorParameters=function(){return[{type:yt},{type:l},{type:t.HttpService},{type:a}]},wt);function wt(e,t,r,i){this.uistate=e,this.util=t,this.http=r,this.designerState=i,this.defaultProcessComponentIds=["5863c8a8-e0a7-4137-a8b2-4c05e42b3b73","be781ba1-a88b-4bb8-9c88-2e2a27a9226e"],this.subject=new v.Subject}Ct.prototype.deleteRow=function(){this.uistate.curComponent&&("LOADDATA"===this.uistate.curComponent.executionTime?this.messager.info(this.localePipe.transform("component.activityList.name")):this.repository.removeComponent(this.uistate.curComponent.id))},Ct.prototype.componentSelect=function(e){e&&this.repository.addComponent(e)},Ct.prototype.loadComponents=function(e,t){this.repository.loadComponents(e,t)},Ct.decorators=[{type:b.Injectable}],Ct.ctorParameters=function(){return[{type:yt},{type:xt},{type:r.MessagerService},{type:x}]};var Pt=Ct;function Ct(e,t,r,i){this.uistate=e,this.repository=t,this.messager=r,this.localePipe=i}St.prototype.ngAfterViewInit=function(){},St.prototype.ngOnInit=function(){var i=this;this.paramColumns=[{field:"code",width:50,title:this.localePipe.transform("component.editComponentParameter.code")},{field:"name",width:50,title:this.localePipe.transform("component.editComponentParameter.name")},{field:"required",width:50,title:this.localePipe.transform("component.editComponentParameter.required"),formatter:function(e,t,r){return e?i.localePipe.transform("component.editComponentParameter.yes"):i.localePipe.transform("component.editComponentParameter.no")}},{field:"value",width:100,title:this.localePipe.transform("component.editComponentParameter.value"),editor:{type:"input-group",options:{groupText:'<i class="f-icon f-icon-lookup"></i>',editable:!1,clickHandle:function(e){e.formControl.setValue(e.instance.value||""),i.showExprHelp(e)},clear:function(e){console.log("clear",e)}}}}]},St.prototype.showExprHelp=function(t){var e,r,i,n,o,a,s,l,c=this,p=new Array;if(0<this.designerState.schemas.length){try{for(var d=ue(this.designerState.schemas),u=d.next();!u.done;u=d.next()){var m=u.value;this.expr.addSchema("Schema",m)}}catch(w){e={error:w}}finally{try{u&&!u.done&&(l=d["return"])&&l.call(d)}finally{if(e)throw e.error}}this.designerState.schemas[0].entityTypes&&0<this.designerState.schemas[0].entityTypes.length&&(l=this.designerState.schemas[0].entityTypes[0],this.expr.addInjectedEntity(l.name,"Schema",l.name,D.InjectedType.EntityType))}if(p=this.designerState.addContext(p),0<this.designerState.subActivityContext.length)try{for(var f=ue(this.designerState.subActivityContext),h=f.next();!h.done;h=f.next())!function(t){p.some(function(e){return e.key===t.key})||p.push(t)}(h.value)}catch(P){r={error:P}}finally{try{h&&!h.done&&(i=f["return"])&&i.call(f)}finally{if(r)throw r.error}}if("activity"===this.location)try{for(var y=ue(this.designerState.activityComponentContext),g=y.next();!g.done;g=y.next())!function(t){p.some(function(e){return e.key===t.key})||p.push(t)}(g.value)}catch(C){n={error:C}}finally{try{g&&!g.done&&(o=y["return"])&&o.call(y)}finally{if(n)throw n.error}}if(0<p.length)try{for(var v=ue(p),b=v.next();!b.done;b=v.next()){var x=b.value;this.expr.addContext(x)}}catch(I){a={error:I}}finally{try{b&&!b.done&&(s=v["return"])&&s.call(v)}finally{if(a)throw a.error}}this.expr.setEditPattern(D.ExprEditMode.Advanced),this.expr.addExpressionText(t.instance.value),this.expr.buildExpression().then(function(e){t.formControl.setValue(e),t.instance.cd.detectChanges(),0<p.length&&(c.expr.exprEntity.contextEntities=c.expr.exprEntity.contextEntities.filter(function(t){return!p.some(function(e){return e.key===t.key})}))})},St.prototype.openComponentSelectorNew=function(e,t){var r=this;this.componentService.openSelector(e,t).subscribe(function(e){e.confirmEvent.subscribe(function(e){var t;e&&((t=new vt(e.name,e.id,e.operations[0].code)).id=l.GenerateElementId(),t.actualParameters=r.bindParas(e),"7433df25-9260-4c24-86f0-9da3e89450fb"===t.metadataId||"d0783800-ed60-488c-b053-8806a15947fe"===t.metadataId||"b89e9b9a-2e2d-4bd0-b354-187219544d34"===t.metadataId||"a8b8f7a4-49ae-4b7d-88d2-b3772b9d0ae5"===t.metadataId?t.scopeType="ExternalProcess":t.scopeType="DirectStart",r.curComponent=t,r.cd.detectChanges())})})},St.prototype.bindParas=function(e){var t=[];return t=e.operations[0].parameters&&0<e.operations[0].parameters.length?-1<this.defaultProcessComponentIds.indexOf(e.id)?this.assignParameterValue(e.operations[0].parameters):e.operations[0].parameters.map(function(e){return{code:e.code,name:e.name,value:"",required:"wfcontext"!==e.code.toLowerCase()&&e.required}}):t},St.prototype.assignParameterValue=function(e){var r=this;return e.map(function(e){var t;return-1<e.code.indexOf("beId")?(t=r.designerState.formalParameterContext.filter(function(e){return-1<e.key.indexOf("metadataId")})[0].key,{code:e.code,name:e.name,value:'{"expr":"DefaultFunction.GetContextParameter(\\"'+t+'\\")"}',required:!0}):-1<e.code.indexOf("nodeId")?(t=r.designerState.formalParameterContext.filter(function(e){return-1<e.key.indexOf("schemaId")})[0].key,{code:e.code,name:e.name,value:'{"expr":"DefaultFunction.GetContextParameter(\\"'+t+'\\")"}',required:!0}):-1<e.code.indexOf("dataId")?{code:e.code,name:e.name,value:'{"expr":"DefaultFunction.GetContextParameter(\\"dataId\\")"}',required:!0}:-1<e.code.indexOf("procInstId")?{code:e.code,name:e.name,value:'{"expr":"DefaultFunction.GetContextParameter(\\"procInstId\\")"}',required:!0}:{code:e.code,name:e.name,value:"",required:!0}})},St.prototype.componentSelect=function(){var i=this,e=this.resolver.resolveComponentFactory(Fe.SelectMetadataRTComponent).create(this.injector),t=(e.instance.typeList="WebServiceComponent",e.instance.selectedMetadata.subscribe(function(e){try{var t=e.metadata;i.openComponentSelectorNew(t.id,i.sessionSrc.getUserSessionId())}catch(r){throw console.log("$event",e),new Error(i.localePipe.transform("component.editComponentParameter.openComponentFail")+e)}}),{title:this.localePipe.transform("component.editComponentParameter.componentSelection"),width:980,height:548,showButtons:!1}),r=this.modalService.show(e,t);e.instance.closeModalEmitter.subscribe(function(e){return r.close()})},St.prototype.endCellEdit=function(){this.paramlist.endCellEdit()},St.prototype.editOK=function(){this.endCellEdit(),this.validator()&&this.submitEmitter.emit(this.curComponent)},St.prototype.editCancel=function(){this.closeEmitter.emit()},St.prototype.validator=function(){var e,t;if(!(this.curComponent&&this.curComponent.metadataId&&this.curComponent.methodCode))return this.message.info(this.localePipe.transform("component.editComponentParameter.curComponent")),!1;if("autoActivity"!==this.location&&!this.curComponent.executionTime)return this.message.info(this.localePipe.transform("component.editComponentParameter.executionTime")),!1;var r="";try{for(var i=ue(this.curComponent.actualParameters),n=i.next();!n.done;n=i.next()){var o=n.value;o.required&&!o.value&&(r+="，"+o.code)}}catch(a){e={error:a}}finally{try{n&&!n.done&&(t=i["return"])&&t.call(i)}finally{if(e)throw e.error}}return!(0<r.length&&(r=r.slice(1,r.length),this.message.info(this.localePipe.transform("component.editComponentParameter.para")+"【"+r+this.localePipe.transform("component.editComponentParameter.paraRequired")),1))},St.decorators=[{type:b.Component,args:[{selector:"lib-edit-component-parameter",template:'<div *ngIf="curComponent" class="f-page">\r\n  <div class="f-utils-fill-flex-column farris-overflow-y-auto h-100">\r\n    <form class="farris-form farris-card-content-bg farris-card-section mx-2">\r\n      <div class="d-flex flex-wrap flex-column mb-2 pr-4">\r\n        <div class="farris-form-controls-inline farris-form-auto mb-2">\r\n          <div class="farris-group-wrap mx-3">\r\n            <div class="form-group">\r\n              <label class="col-form-label">\r\n                <span class="farris-label-info text-danger">*</span>\r\n                <span class="farris-label-text">{{\'component.editComponentParameter.componentSelection\' | wfLocale}}</span>\r\n              </label>\r\n              <div class="farris-input-wrap ml-2">\r\n                <input-group class="form-control" style="width: 100%;padding:0;border:0;" name="method" [showButtonWhenDisabled]="false"\r\n                [enableClear]="false" [editable]="false" (clickHandle)="componentSelect()" [groupText]="groupIcon" [(ngModel)]="curComponent.name" [disabled]="editState===\'edit\'"></input-group>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <ng-container *ngIf="location!==\'autoActivity\'">\r\n          <div class="farris-form-controls-inline farris-form-auto">\r\n            <div class="farris-group-wrap mx-3">\r\n              <div class="form-group">\r\n                <label class="col-form-label">\r\n                  <span class="farris-label-info text-danger">*</span>\r\n                  <span class="farris-label-text">{{\'component.editComponentParameter.execuTime\' | wfLocale}}</span>\r\n                </label>\r\n                <div class="farris-input-wrap ml-2">\r\n                  <farris-combo-list name="executionTime" [idField]="\'value\'" [(ngModel)]="curComponent.executionTime"\r\n                    [textField]="\'text\'" [valueField]="\'value\'" [data]="executionTimingList" [panelHeight]="\'auto\'">\r\n                  </farris-combo-list>\r\n                  <div class="farris-feedback valid-feedback"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </ng-container>\r\n      </div>\r\n    </form>\r\n    <ng-container>\r\n      <farris-tabs class="f-utils-fill pr-2 pl-2" [value]="\'parameters\'" [contentFill]="true" [autoTitleWidth]="true">\r\n        <farris-tab title="{{\'component.editComponentParameter.parameterList\'|wfLocale}}" [id]="\'parameters\'">\r\n          <ng-template #content>\r\n            <div class="f-utils-fill-flex-column h-100">\r\n              <farris-datagrid #paramlist [data]="curComponent.actualParameters" [columns]="paramColumns"\r\n                [idField]="\'code\'" [fit]="true" [fitColumns]="true" [editable]="true" [editMode]="\'cell\'"\r\n                [pagination]="false" [showCheckbox]="false" [multiSelect]="false" [afterEdit]="paramAfterEdit"\r\n                [closeOtherGridEditor]="true">\r\n              </farris-datagrid>\r\n            </div>\r\n          </ng-template>\r\n        </farris-tab>\r\n      </farris-tabs>\r\n    </ng-container>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #editFooter>\r\n  <button type="button" class="btn btn-secondary btn-sm px-3 mx-2" (click)="editCancel()">{{\'component.editComponentParameter.clickCancel\' | wfLocale}}</button>\r\n  <button type="button" class="btn btn-primary btn-sm px-3 mx-2" (click)="editOK()">{{\'component.editComponentParameter.clickOK\' | wfLocale}}</button>\r\n</ng-template>\r\n\r\n',providers:[x],styles:[""]}]}],St.ctorParameters=function(){return[{type:a},{type:D.ExpressionService},{type:b.ComponentFactoryResolver},{type:b.Injector},{type:t.SessionService},{type:U.CommonComponentUiRTService},{type:i.BsModalService},{type:r.MessagerService},{type:b.ChangeDetectorRef},{type:b.ChangeDetectorRef,decorators:[{type:b.Optional}]},{type:String,decorators:[{type:b.Inject,args:[b.LOCALE_ID]}]},{type:undefined,decorators:[{type:b.Inject,args:[o]}]},{type:x,decorators:[{type:b.Optional}]}]},St.propDecorators={editState:[{type:b.Input}],closeEmitter:[{type:b.Output}],submitEmitter:[{type:b.Output}],paramlist:[{type:b.ViewChild,args:["paramlist"]}],editFooter:[{type:b.ViewChild,args:["editFooter"]}],curComponent:[{type:b.Input}]};var It=St;function St(e,t,r,i,n,o,a,s,l,c,p,d,u){this.designerState=e,this.expr=t,this.resolver=r,this.injector=i,this.sessionSrc=n,this.componentService=o,this.modalService=a,this.message=s,this.cd=l,this.cdr=c,this.localeId=p,this.resources=d,this.localePipe=u,this.defaultProcessComponentIds=["5863c8a8-e0a7-4137-a8b2-4c05e42b3b73","be781ba1-a88b-4bb8-9c88-2e2a27a9226e"],this.closeEmitter=new b.EventEmitter,this.submitEmitter=new b.EventEmitter,this.paramColumns=[],this.groupIcon='<i class="f-icon f-icon-lookup"></i>',this.executionTimingList=new Array,this.paramAfterEdit=function(e,t,r){return v.of(!0)},this.localePipe=this.localePipe||new x(p,d)}Object.defineProperty(Tt.prototype,"value",{set:function(a){var e,t,s=this;if(a&&0<a.length){var r=new Array;try{for(var i=ue(a),n=i.next();!n.done;n=i.next()){var o=n.value;-1==r.indexOf(o.metadataId)&&r.push(o.metadataId)}}catch(l){e={error:l}}finally{try{n&&!n.done&&(t=i["return"])&&t.call(i)}finally{if(e)throw e.error}}0<r.length&&v.forkJoin(r.map(function(e){return s.designerState.getHelpMetaData(e,"")})).subscribe(function(n){var e,t;try{for(var r=ue(a),i=r.next();!i.done;i=r.next())!function(r){var e=new vt(r.name,r.metadataId,r.methodCode),t=(e.executionTime=r.executionTime,e.id=r.id,e.isForCompensation=r.isForCompensation,e.actualParameters=new Array,e.scopeType=r.scopeType||null,n.find(function(e){return e.id===r.metadataId})),i=JSON.parse(t.content).operations.find(function(e){return e.code===r.methodCode});i?e.actualParameters=r.actualParameters.map(function(t){var e=i.parameters.find(function(e){return e.code===t.code});return e?{code:t.code,name:t.name,value:t.value,required:"wfcontext"!==t.code.toLowerCase()&&e.required}:(console.error(s.localePipe.transform("component.activityComponent.method")+r.methodCode+s.localePipe.transform("component.activityComponent.inconsistentParameters")),{code:t.code,name:t.name,value:t.value,required:!1})}):console.error(s.localePipe.transform("component.activityComponent.longerExists")+r.methodCode+s.localePipe.transform("component.activityComponent.pleaseCheck")),s.uistate.components.push(e)}(i.value)}catch(o){e={error:o}}finally{try{i&&!i.done&&(t=r["return"])&&t.call(r)}finally{if(e)throw e.error}}})}},enumerable:!0,configurable:!0}),Tt.prototype.ngOnInit=function(){var e=this;setTimeout(function(){e.restart()},300)},Tt.prototype.restart=function(){var a=this;"EXTERNAL_PROCESS"===this.designerState.startMode&&this.repository.getBizCmp(function(e){var t,r;if(e&&0<e.length)try{for(var i=ue(e),n=i.next();!n.done;n=i.next())if("ExternalProcess"===n.value.scopeType){a.exBizTips=!0;break}}catch(o){t={error:o}}finally{try{n&&!n.done&&(r=i["return"])&&r.call(i)}finally{if(t)throw t.error}}}),this.location=this.editorParams.location,"activity"===this.location?(this.uistate.executionCollection=this.uistate.activityCollection,this.columns=[{field:"executionTime",width:100,title:this.localePipe.transform("component.activityComponent.executionTime"),editor:{type:g.EditorTypes.COMBOLIST,options:{data:this.uistate.executionCollection,groupField:"text",valueField:"value",textField:"text",idField:"value",panelHeight:"auto"}},formatter:function(t,e,r){return t?a.uistate.executionCollection.find(function(e){return e.value===t}).text:""},validators:[{type:"required",messager:"必填"}]},{field:"name",width:100,title:this.localePipe.transform("component.activityComponent.cmpName")},{field:"metadataId",width:100,title:this.localePipe.transform("component.activityComponent.metadataId")},{field:"methodCode",width:100,title:this.localePipe.transform("component.activityComponent.methodCode")},{field:"isForCompensation",width:50,title:this.localePipe.transform("component.activityComponent.isForCompensation"),editor:{type:g.EditorTypes.SWITCH,options:{}},formatter:{type:"boolean",options:{trueText:this.localePipe.transform("component.activityComponent.yes"),falseText:this.localePipe.transform("component.activityComponent.no")}}},{title:this.localePipe.transform("component.activityComponent.operate"),width:70,template:this.btnTemplate}]):"autoActivity"===this.location?this.columns=[{field:"name",width:100,title:this.localePipe.transform("component.activityComponent.cmpName")},{field:"metadataId",width:100,title:this.localePipe.transform("component.activityComponent.metadataId")},{field:"methodCode",width:100,title:this.localePipe.transform("component.activityComponent.methodCode")},{field:"isForCompensation",width:50,title:this.localePipe.transform("component.activityComponent.isForCompensation"),editor:{type:g.EditorTypes.SWITCH,options:{}},formatter:{type:"boolean",options:{trueText:this.localePipe.transform("component.activityComponent.yes"),falseText:this.localePipe.transform("component.activityComponent.no")}}},{title:this.localePipe.transform("component.activityComponent.operate"),width:70,template:this.btnTemplate}]:this.columns=[{field:"executionTime",width:100,title:this.localePipe.transform("component.activityComponent.executionTime"),editor:{type:g.EditorTypes.COMBOLIST,options:{data:this.uistate.executionCollection,groupField:"text",valueField:"value",textField:"text",idField:"value",panelHeight:"auto"}},formatter:function(t,e,r){return t?a.uistate.executionCollection.find(function(e){return e.value===t}).text:""},validators:[{type:"required",messager:"必填"}]},{field:"name",width:100,title:this.localePipe.transform("component.activityComponent.cmpName")},{field:"metadataId",width:100,title:this.localePipe.transform("component.activityComponent.metadataId")},{field:"methodCode",width:100,title:this.localePipe.transform("component.activityComponent.methodCode")},{title:this.localePipe.transform("component.activityComponent.operate"),width:70,template:this.btnTemplate}],this.uistate.components&&0<this.uistate.components.length&&this.cmplist.selectRow(this.uistate.components[0].id,!0),this.paramColumns=[{field:"code",width:50,title:this.localePipe.transform("component.activityComponent.code")},{field:"name",width:50,title:this.localePipe.transform("component.activityComponent.name")},{field:"value",width:100,title:this.localePipe.transform("component.activityComponent.value"),editor:{type:"input-group",options:{groupText:'<i class="f-icon f-icon-lookup"></i>',editable:!1,clickHandle:function(e){e.formControl.setValue(e.instance.value||""),a.showExprHelp(e)},clear:function(e){console.log("clear",e)}}}}],this.repository.subject.subscribe(function(e){a.cmplist.loadData(a.uistate.components),e?a.cmplist.selectRow(e.id,!0):a.uistate.curComponent=null})},Tt.prototype.ngAfterViewInit=function(){this.uistate.components&&0<this.uistate.components.length&&this.cmplist.selectRow(this.uistate.components[0].id,!0)},Tt.prototype.edit=function(){var r=this;this.editState="edit";var e=this.resolver.resolveComponentFactory(It).create(this.injector),t={title:this.localePipe.transform("component.activityComponent.editComponent"),width:700,height:400,buttons:e.instance.editFooter,showButtons:!0,initialState:{curComponent:JSON.parse(JSON.stringify(this.uistate.curComponent))}},i=this.modalService.show(e,t);e.instance.canEdit=!1,e.instance.editState=this.editState,e.instance.location=this.location,e.instance.executionTimingList=this.uistate.executionCollection,e.instance.submitEmitter.subscribe(function(t){var e=r.uistate.components.findIndex(function(e){return e.id===t.id});r.uistate.components[e]=t,r.cmplist.loadData(r.uistate.components),i.close()}),e.instance.closeEmitter.subscribe(function(e){i.close()}),setTimeout(function(){e.instance.cd.detectChanges()})},Tt.prototype.deleteRow=function(){var t=this;this.message.confirm(this.localePipe.transform("component.activityComponent.confirmDelete")).subscribe(function(e){e&&(t.closeCellEdit(),t.viewModel.deleteRow(),t.cmplist.loadData(t.uistate.components))})},Tt.prototype.moveUp=function(){var t,e;this.uistate.curComponent?(t=this.uistate.curComponent.id,0!==(e=this.uistate.components.findIndex(function(e){return e.id===t}))&&(this.repository.swapArray(this.uistate.components,e,e-1),this.cmplist.loadData(this.uistate.components),this.cmplist.selectRow(t,!0))):this.message.info(this.localePipe.transform("component.activityComponent.curComponent"))},Tt.prototype.moveDown=function(){var t,e;this.uistate.curComponent?(t=this.uistate.curComponent.id,(e=this.uistate.components.findIndex(function(e){return e.id===t}))!==this.uistate.components.length-1&&(this.repository.swapArray(this.uistate.components,e,e+1),this.cmplist.loadData(this.uistate.components),this.cmplist.selectRow(t,!0))):this.message.info(this.localePipe.transform("component.activityComponent.curComponent"))},Tt.prototype.clickAction=function(e,t){switch(this.uistate.curComponent=t.rowData,e){case"edit":this.edit();break;case"deleteRow":this.deleteRow()}},Tt.prototype.clickOK=function(){var e;this.closeCellEdit(),this.validator()&&(e={value:this.uistate.components,parameters:null},this.submitModal.emit(e))},Tt.prototype.clickCancel=function(){this.closeModal.emit()},Tt.prototype.componentSelect=function(){var t=this;this.editState="new";var e=this.resolver.resolveComponentFactory(It).create(this.injector),r={title:this.localePipe.transform("component.activityComponent.newComponent"),width:700,height:400,buttons:e.instance.editFooter,showButtons:!0},i=this.modalService.show(e,r);e.instance.canEdit=!0,e.instance.editState=this.editState,e.instance.location=this.location,e.instance.executionTimingList=this.uistate.executionCollection,e.instance.curComponent=new vt,e.instance.submitEmitter.subscribe(function(e){t.uistate.components.push(e),t.cmplist.loadData(t.uistate.components),i.close()}),e.instance.closeEmitter.subscribe(function(e){i.close()}),setTimeout(function(){e.instance.cd.detectChanges()})},Tt.prototype.openComponentSelectorNew=function(e,t){var r=this;this.componentService.openSelector(e,t).subscribe(function(e){e.confirmEvent.subscribe(function(e){r.viewModel.componentSelect(e)})})},Tt.prototype.showExprHelp=function(t){var e,r,i,n,o,a,s,l,c=this,p=new Array;if(0<this.designerState.schemas.length){try{for(var d=ue(this.designerState.schemas),u=d.next();!u.done;u=d.next()){var m=u.value;this.expr.addSchema("Schema",m)}}catch(w){e={error:w}}finally{try{u&&!u.done&&(l=d["return"])&&l.call(d)}finally{if(e)throw e.error}}this.designerState.schemas[0].entityTypes&&0<this.designerState.schemas[0].entityTypes.length&&(l=this.designerState.schemas[0].entityTypes[0],this.expr.addInjectedEntity(l.name,"Schema",l.name,D.InjectedType.EntityType))}if(p=this.designerState.addContext(p),"activity"===this.location)try{for(var f=ue(this.designerState.activityComponentContext),h=f.next();!h.done;h=f.next())!function(t){p.some(function(e){return e.key===t.key})||p.push(t)}(h.value)}catch(P){r={error:P}}finally{try{h&&!h.done&&(i=f["return"])&&i.call(f)}finally{if(r)throw r.error}}if("activity"===this.location)try{for(var y=ue(this.designerState.subActivityContext),g=y.next();!g.done;g=y.next())!function(t){p.some(function(e){return e.key===t.key})||p.push(t)}(g.value)}catch(C){n={error:C}}finally{try{g&&!g.done&&(o=y["return"])&&o.call(y)}finally{if(n)throw n.error}}if(0<p.length)try{for(var v=ue(p),b=v.next();!b.done;b=v.next()){var x=b.value;this.expr.addContext(x)}}catch(I){a={error:I}}finally{try{b&&!b.done&&(s=v["return"])&&s.call(v)}finally{if(a)throw a.error}}this.expr.setEditPattern(D.ExprEditMode.Advanced),this.expr.addExpressionText(t.instance.value),this.expr.buildExpression().then(function(e){t.formControl.setValue(e),t.instance.cd.detectChanges(),0<p.length&&(c.expr.exprEntity.contextEntities=c.expr.exprEntity.contextEntities.filter(function(t){return!p.some(function(e){return e.key===t.key})}))})},Tt.prototype.selectionChange=function(e){this.uistate.curComponent=e.data},Tt.prototype.closeCellEdit=function(){this.cmplist.endCellEdit(),this.paramlist&&this.paramlist.endCellEdit()},Tt.prototype.validator=function(){var e,t,s=[],r=function(t){var e,r;if(s.find(function(e){return e.methodCode===t.methodCode&&JSON.stringify(e.actualParameters)===JSON.stringify(t.actualParameters)&&e.executionTime===t.executionTime}))return console.log(t.actualParameters),l.message.warning(l.localePipe.transform("component.activityComponent.sameCmp")+(""+t.name)+l.localePipe.transform("component.activityComponent.cmpMethod")+t.methodCode+l.localePipe.transform("component.activityComponent.pleaseCheck")),{value:!1};if(s.push(t),!t.executionTime&&"autoActivity"!==l.location)return l.message.warning(l.localePipe.transform("component.activityComponent.executionTimeNotNull")),{value:!1};try{for(var i=ue(t.actualParameters),n=i.next();!n.done;n=i.next()){var o=n.value;if(o.required&&!o.value)return l.message.warning(l.localePipe.transform("component.activityComponent.component")+("【"+t.name)+"】"+l.localePipe.transform("component.activityComponent.param")+"【"+o.code+"】"+l.localePipe.transform("component.activityComponent.required")),{value:!1}}}catch(a){e={error:a}}finally{try{n&&!n.done&&(r=i["return"])&&r.call(i)}finally{if(e)throw e.error}}},l=this;try{for(var i=ue(this.uistate.components),n=i.next();!n.done;n=i.next()){var o=r(n.value);if("object"==typeof o)return o.value}}catch(a){e={error:a}}finally{try{n&&!n.done&&(t=i["return"])&&t.call(i)}finally{if(e)throw e.error}}return!0},Tt.decorators=[{type:b.Component,args:[{selector:"app-activity-component",template:'<div class="f-page">\r\n  <div class="f-page-header">\r\n    <nav class="f-page-header-base">\r\n      <div class="f-title">\r\n              <ng-container *ngIf="exBizTips">\r\n                <div  class="f-component-wizard-page-detail-header">\r\n                  <div class="page-friendly-reminder" style="background:#E6F7FF;padding: 0.5rem!important">\r\n                    <div class="reminder-message">\r\n                      <span class="reminder-title">\r\n                        <span class="f-icon f-icon-info">\r\n                        </span>\r\n                        <span class="reminder-name" style="padding-left: 0.25rem">{{\'component.activityComponent.tips\' | wfLocale}}\r\n                        </span>\r\n                      </span>\r\n                      <span class="message">{{\'component.activityComponent.prefabricated\' | wfLocale}}\r\n                      </span>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </ng-container>\r\n      </div>\r\n      <div class="btn-toolbar btn-group-lg">\r\n        <button class="btn btn-primary mr-2" (click)="componentSelect()">{{\'component.activityComponent.add\' | wfLocale}}</button>\r\n        <button class="btn btn-secondary mr-2" (click)="moveUp()">{{\'component.activityComponent.moveUp\' | wfLocale}}</button>\r\n        <button class="btn btn-secondary" (click)="moveDown()">{{\'component.activityComponent.moveDown\' | wfLocale}}</button>\r\n      </div>\r\n    </nav>\r\n  </div>\r\n  <div class="f-page-main f-utils-fill-flex-column h-100">\r\n    <div class="f-utils-fill-flex-column farris-overflow-y-auto h-100" style="border-radius:16px;border: 1.5px solid #F1F3F7;margin-left: 6px;margin-right: 6px;">\r\n      <div [style.height.%]="uistate.curComponent?100:100">\r\n        <farris-datagrid #cmplist [data]="uistate.components" [idField]="\'id\'" [columns]="columns" [fit]="true"\r\n          [showGroupColumn]="true" [fitColumns]="true" [editable]="true" [editMode]="\'cell\'" [pagination]="false"\r\n          [showCheckbox]="false" [groupRows]="true" [multiSelect]="false" (selectChanged)="selectionChange($event)"\r\n          [closeOtherGridEditor]="true" [mergeCell]="true" [mergeFields]="[\'executionTime\']">\r\n        </farris-datagrid>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #buttonsTemplate let-ctx>\r\n  <farris-button-group [count]="2" [data]="buttonGroupData" (change)="clickAction($event, ctx)">\r\n  </farris-button-group>\r\n</ng-template>\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type="button" class="btn btn-secondary btn-sm px-3" (click)="clickCancel()">{{\'component.activityComponent.clickCancel\' | wfLocale}}</button>\r\n  <button type="button" class="btn btn-primary btn-sm px-3 mx-2" (click)="clickOK()">{{\'component.activityComponent.clickOK\' | wfLocale}}</button>\r\n</ng-template>\r\n',providers:[xt,yt,Pt,x],styles:[""]}]}],Tt.ctorParameters=function(){return[{type:yt},{type:Pt},{type:a},{type:D.ExpressionService},{type:b.ComponentFactoryResolver},{type:b.Injector},{type:i.BsModalService},{type:U.CommonComponentUiRTService},{type:xt},{type:r.MessagerService},{type:b.ChangeDetectorRef,decorators:[{type:b.Optional}]},{type:String,decorators:[{type:b.Inject,args:[b.LOCALE_ID]}]},{type:undefined,decorators:[{type:b.Inject,args:[o]}]},{type:x,decorators:[{type:b.Optional}]}]},Tt.propDecorators={cls:[{type:b.HostBinding,args:["class"]}],closeModal:[{type:b.Output}],submitModal:[{type:b.Output}],editorParams:[{type:b.Input}],modalFooter:[{type:b.ViewChild,args:["iconSelectFooter"]}],btnTemplate:[{type:b.ViewChild,args:["buttonsTemplate"]}],cmplist:[{type:b.ViewChild,args:["cmplist"]}],paramlist:[{type:b.ViewChild,args:["paramlist"]}],value:[{type:b.Input}]};var Et=Tt;function Tt(e,t,r,i,n,o,a,s,l,c,p,d,u,m){this.uistate=e,this.viewModel=t,this.designerState=r,this.expr=i,this.resolver=n,this.injector=o,this.modalService=a,this.componentService=s,this.repository=l,this.message=c,this.cdr=p,this.localeId=d,this.resources=u,this.localePipe=m,this.cls="farris-main-area flex-column",this.closeModal=new b.EventEmitter,this.submitModal=new b.EventEmitter,this.editorParams={},this.exBizTips=!1,this.modalConfig={title:this.localePipe.transform("component.activityComponent.component"),width:960,height:506,showButtons:!0},this.buttonGroupData=[{id:"edit",text:this.localePipe.transform("component.activityComponent.edit")},{id:"deleteRow",text:this.localePipe.transform("component.activityComponent.deleteRow")}],this.editState="new",this.isPreExternalProcessCmps=!1,this.columns=[],this.paramColumns=[],this.paramAfterEdit=function(e,t,r){return v.of(!0)},this.localePipe=this.localePipe||new x(d,u)}kt.prototype.convertTo=function(e){return e&&0<e.length?this.localePipe.transform("component.activityComponent.set"):this.localePipe.transform("component.activityComponent.notSet")};var At=kt;function kt(e){this.localePipe=e}Mt.decorators=[{type:b.Injectable}],Mt.ctorParameters=function(){return[{type:x}]};var Ot=Mt;function Mt(e){this.localePipe=e,this.formTypeCollection=[{text:this.localePipe.transform("component.executeForms.processEmbeddedForm"),value:"0"},{text:this.localePipe.transform("component.executeForms.formEmbedProcess"),value:"1"}]}Nt.decorators=[{type:b.Injectable}];var Dt=Nt;function Nt(){}Ft.decorators=[{type:b.Injectable}];var Lt=Ft;function Ft(){}var Rt=function(){},Vt=function(){},zt="PC",Bt="MOBILE",Ut=(jt.prototype.getData=function(e,t){var r=t.customData,i=t.pageIndex||1,n=t.pageSize||20,t=JSON.parse(t.searchValue),o="?param=",r='{"terminal":"'+("web"===r.tab?"PC":"Mobile")+'"';return t.searchValue&&("*"===t.searchField?r+=',"allColumns":"'+t.searchValue+'"':r+=',"'+t.searchField+'":"'+t.searchValue+'"'),r+="}",r=encodeURIComponent(r),this.http.get(e+=o+=r+"&pageNum="+i+"&pageSize="+n).pipe(re.map(function(e){return{items:e.content,total:e.totalElements,pageInfo:{pageIndex:e.pageable.pageNumber+1,pageSize:e.pageable.pageSize,pageList:[20,40,60,80,100],enablePager:!0}}}))},jt.decorators=[{type:b.Injectable}],jt.ctorParameters=function(){return[{type:t.HttpService}]},jt);function jt(e){this.http=e}var Ht=function(){},_t=(Gt.prototype.ngOnInit=function(){this.getAllExecuteForms()},Gt.prototype.clickOK=function(){var e,t,r=this;this.grid.selectedRow?(e=this.grid.selectedRow.data,(t=new Rt).Id=l.GenerateElementId(),t.Name=e.name,t.ComponentId=e.appId,t.FormType=e.formType,t.formFormatId=e.formFormatId,t.TerminalType="web"===this.tab?zt:Bt,t.ActualParameters=e.actualParameters.map(function(e){var t=new Vt;return t.Name=e.code,t.Tag=e.valueType||r.initVariableType(e.value),t.Value=e.value,t}),this.submit.next(t)):this.message.info(this.localePipe.transform("component.executeForms.selectedRow"))},Gt.prototype.clickCancel=function(){this.cancel.next()},Gt.prototype.getAllExecuteForms=function(){var a=this;v.forkJoin(this.getExecuteForms(),this.getFormFormats()).subscribe(function(e){var t,r;if(e[0]&&(a.forms=e[0]),e[1]&&0<e[1].length){e=e[1];try{for(var i=ue(e),n=i.next();!n.done;n=i.next())!function(t){var e,r;-1===a.forms.findIndex(function(e){return e.formFormatId&&e.formFormatId===t.id})&&((e=new Ht).id=l.createNM(),e.flowFormKey=a.state.flowFormInfo.flowForm.id,e.appId=null,e.code=t.code,e.name=t.name,e.actualParameters=[],e.isDefault=!1,e.formType="0",e.terminal="web",e.formFormatId=t.id,e.sysInit=0,e.remarks="",t.urlParameters&&0<t.urlParameters.length&&(r=t.urlParameters.map(function(e){return{code:e.code,name:e.name,valueType:e.valueType||a.initVariableType(e.value),value:e.value}}),e.actualParameters=r),a.forms.push(e))}(n.value)}catch(o){t={error:o}}finally{try{n&&!n.done&&(r=i["return"])&&r.call(i)}finally{if(t)throw t.error}}}})},Gt.prototype.initVariableType=function(e){return e?8<=e.length&&'{"expr":'===e.slice(0,8)?"expression":"constant":"variable"},Gt.prototype.getExecuteForms=function(){var e,t=this;return this.state.flowFormInfo.flowForm.id&&this.tab?(e="/api/runtime/wf/v1.0/excuteForm?flowFormKey="+this.state.flowFormInfo.flowForm.id,this.http.get(e).pipe(re.map(function(e){return"web"===t.tab?e.filter(function(e){return-1<e.terminal.indexOf("web")}):"mobile"===t.tab?e.filter(function(e){return-1<e.terminal.indexOf("app")}):void 0}))):v.from(new Array)},Gt.prototype.getFormFormats=function(){var e,t;return this.state.flowFormInfo.flowForm.businessObjectId&&this.tab?(t="web"===this.tab?"PC":"Mobile",e="/api/runtime/wf/v1.0/formFormat/query?param=",t='{"bizCategory":"'+this.state.flowFormInfo.flowForm.businessObjectId+'","terminal":"'+t+'"}',t=encodeURIComponent(t),this.http.get(e+=t)):v.from(new Array)},Gt.decorators=[{type:b.Component,args:[{selector:"lib-add-execute-form",template:'<div class="f-page f-page-is-managelist">\r\n  <div class="f-page-main my-0">\r\n    <div class="f-struct-wrapper f-utils-fill-flex-column">\r\n      <farris-section class="f-section-grid f-section-in-managelist p-2" [showHeader]="false">\r\n        <farris-datagrid class="f-component-grid" [columns]="columns" [data]="forms" #grid\r\n          [idField]="\'id\'" [showLineNumber]="true" [striped]="true"\r\n          [showCheckbox]="false" [virtualized]="true" [pagination]="false" [fit]="true" [fitColumns]="true">\r\n        </farris-datagrid>\r\n      </farris-section>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type="button" class="btn btn-secondary btn-sm" (click)="clickCancel()">{{\'component.executeForms.clickCancel\' | wfLocale}}</button>\r\n  <button type="button" class="btn btn-primary btn-sm mx-2" (click)="clickOK()">{{\'component.executeForms.clickOK\' | wfLocale}}</button>\r\n</ng-template>\r\n\x3c!--\r\n<app-rtf-app-help #appHelper (afterHelpConfirm)="funcSelected($event)" [isLayeredLoad]="true">\r\n</app-rtf-app-help>\r\n\r\n<farris-lookup-grid #lookup style="display: none;" [editable]="false" [columns]="cols" [singleSelect]="true"\r\n  title="\'单据格式\'" [displayType]="\'List\'" [uri]="dataUri" [idField]="\'id\'" [pageIndex]="1" [pageSize]="20"\r\n  [pagination]="true" [valueField]="\'id\'" [textField]="\'name\'" [dialogWidth]="550" [dictPicked]="dictPicked"\r\n  [dictPicking]="dictPicking">\r\n</farris-lookup-grid> --\x3e\r\n',providers:[{provide:Ee.ServerSideToken,useClass:Ut},x],styles:[""]}]}],Gt.ctorParameters=function(){return[{type:a},{type:t.HttpService},{type:t.SessionService},{type:r.MessagerService},{type:b.ChangeDetectorRef,decorators:[{type:b.Optional}]},{type:String,decorators:[{type:b.Inject,args:[b.LOCALE_ID]}]},{type:undefined,decorators:[{type:b.Inject,args:[o]}]},{type:x,decorators:[{type:b.Optional}]}]},Gt.propDecorators={modalFooter:[{type:b.ViewChild,args:["iconSelectFooter"]}],grid:[{type:b.ViewChild,args:["grid"]}]},Gt);function Gt(e,t,r,i,n,o,a,s){var l=this;this.state=e,this.http=t,this.session=r,this.message=i,this.cdr=n,this.localeId=o,this.resources=a,this.localePipe=s,this.submit=new v.Subject,this.cancel=new v.Subject,this.forms=new Array,this.columns=[{field:"code",width:100,title:this.localePipe.transform("component.executeForms.code")},{field:"name",width:100,title:this.localePipe.transform("component.executeForms.name")},{field:"tag",width:80,title:this.localePipe.transform("component.executeForms.apptag"),formatter:function(e,t,r){return t.appId?l.localePipe.transform("component.executeForms.functionMenu"):t.formFormatId?l.localePipe.transform("component.executeForms.formFormat"):void 0}}],this.cols=[{field:"code",width:100,title:this.localePipe.transform("component.executeForms.docFormatNumber"),searchField:"code"},{field:"name",width:100,title:this.localePipe.transform("component.executeForms.docFormatName"),searchField:"name"}],this.dataUri="/api/runtime/wf/v1.0/formFormat/page",this.localePipe=this.localePipe||new x(o,a)}qt.prototype.ngOnInit=function(){},qt.prototype.clickOK=function(){var e=this.grid.selectedRow;console.log(e),e?this.submit.next(e.data):this.submit.next(null)},qt.prototype.clickCancel=function(){this.cancel.next()},qt.decorators=[{type:b.Component,args:[{selector:"lib-variable-grid",template:'<div class="f-page">\r\n  <div class="f-page-main f-utils-fill-flex-column h-100">\r\n    <div class="f-utils-fill-flex-column farris-overflow-y-auto h-100">\r\n      <farris-datagrid #grid [data]="data" [columns]="columns" [idField]="\'key\'" [fit]="true" [fitColumns]="true"\r\n         [pagination]="false" [showCheckbox]="false" [multiSelect]="false" [showLineNumber]="true" lineNumberTitle="{{\'component.executeForms.lineNumber\' | wfLocale}}"\r\n         [lineNumberWidth]="50">\r\n      </farris-datagrid>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #buttonRef>\r\n    <button type="button" class="btn btn-secondary btn-sm px-3" (click)="clickCancel()">{{\'component.executeForms.clickCancel\' | wfLocale}}</button>\r\n    <button type="button" class="btn btn-primary btn-sm px-3 mx-2" (click)="clickOK()">{{\'component.executeForms.clickOK\' | wfLocale}}</button>\r\n</ng-template>\r\n',providers:[x],styles:[""]}]}],qt.ctorParameters=function(){return[{type:b.ChangeDetectorRef,decorators:[{type:b.Optional}]},{type:String,decorators:[{type:b.Inject,args:[b.LOCALE_ID]}]},{type:undefined,decorators:[{type:b.Inject,args:[o]}]},{type:x,decorators:[{type:b.Optional}]}]},qt.propDecorators={grid:[{type:b.ViewChild,args:[ve.DatagridComponent]}],buttonRef:[{type:b.ViewChild,args:["buttonRef"]}],cancel:[{type:b.Output}],submit:[{type:b.Output}]};var Kt=qt;function qt(e,t,r,i){this.cdr=e,this.localeId=t,this.resources=r,this.localePipe=i,this.cancel=new b.EventEmitter,this.submit=new b.EventEmitter,this.data=[],this.columns=[{field:"key",width:50,title:this.localePipe.transform("component.executeForms.key")},{field:"name",width:50,title:this.localePipe.transform("component.executeForms.name")}],this.localePipe=this.localePipe||new x(t,r)}Object.defineProperty(Jt.prototype,"mode",{get:function(){return this._mode},set:function(e){var t=this;"bpmn"===(this._mode=e)?(this.idField="Name",this.cols=[{field:"Name",width:50,title:this.localePipe.transform("component.executeForms.code")},{field:"Tag",width:50,title:this.localePipe.transform("component.executeForms.tag"),formatter:{type:"enum",options:{valueField:"value",textField:"text",data:this.valueTypeCollection}},editor:{type:g.EditorTypes.COMBOLIST,options:{valueField:"value",textField:"text",data:this.valueTypeCollection,idField:"value",panelHeight:"auto",enableClear:!1,selectChange:function(e){t.valueTypeChange(e)}}}},{field:"Value",width:100,title:this.localePipe.transform("component.executeForms.value"),editor:{type:"input-group",options:{groupText:'<i class="f-icon f-icon-lookup"></i>',editable:!1,clickHandle:function(e){e.formControl.setValue(e.instance.value||""),t.showExprHelp(e)},clear:function(e){console.log("clear",e)}}}}]):(this.idField="code",this.cols=[{field:"code",width:50,title:this.localePipe.transform("component.executeForms.code")},{field:"name",width:50,title:this.localePipe.transform("component.executeForms.name")},{field:"value",width:100,title:this.localePipe.transform("component.executeForms.value"),editor:{type:"input-group",options:{groupText:'<i class="f-icon f-icon-lookup"></i>',editable:!1,clickHandle:function(e){e.formControl.setValue(e.instance.value||""),t.showExprHelp(e)},clear:function(e){console.log("clear",e)}}}}])},enumerable:!0,configurable:!0}),Jt.prototype.ngOnInit=function(){},Jt.prototype.showExprHelp=function(t){var e,r,i,n,o,a,s=this,l=new Array;if(0<this.designerState.schemas.length){try{for(var c=ue(this.designerState.schemas),p=c.next();!p.done;p=c.next()){var d=p.value;this.expr.addSchema("Schema",d)}}catch(g){e={error:g}}finally{try{p&&!p.done&&(a=c["return"])&&a.call(c)}finally{if(e)throw e.error}}this.designerState.schemas[0].entityTypes&&0<this.designerState.schemas[0].entityTypes.length&&(a=this.designerState.schemas[0].entityTypes[0],this.expr.addInjectedEntity(a.name,"Schema",a.name,D.InjectedType.EntityType))}if(l=this.designerState.addContext(l),0<this.designerState.subActivityContext.length)try{for(var u=ue(this.designerState.subActivityContext),m=u.next();!m.done;m=u.next())!function(t){l.some(function(e){return e.key===t.key})||l.push(t)}(m.value)}catch(v){r={error:v}}finally{try{m&&!m.done&&(i=u["return"])&&i.call(u)}finally{if(r)throw r.error}}if(0<l.length)try{for(var f=ue(l),h=f.next();!h.done;h=f.next()){var y=h.value;this.expr.addContext(y)}}catch(b){n={error:b}}finally{try{h&&!h.done&&(o=f["return"])&&o.call(f)}finally{if(n)throw n.error}}this.expr.addExpressionText(t.instance.value),this.expr.buildExpression().then(function(e){e&&(t.formControl.setValue(e),t.instance.cd.detectChanges()),0<l.length&&(s.expr.exprEntity.contextEntities=s.expr.exprEntity.contextEntities.filter(function(t){return!l.some(function(e){return e.key===t.key})}))})},Jt.prototype.clickOK=function(){this.grid.endCellEdit(),this.submit.next({parameters:this.parameters,formType:this.formType})},Jt.prototype.clickCancel=function(){this.cancel.next()},Jt.prototype.valueTypeChange=function(t){this.parameters.find(function(e){return e.Name===t.rowData.Name}).Value=""},Jt.prototype.selectVariable=function(t){var e=this.resolver.resolveComponentFactory(Kt).create(this.injector),r=(e.instance.data=this.allParameters,{title:this.localePipe.transform("component.executeForms.variable"),width:460,height:450,showButtons:!0,buttons:e.instance.buttonRef}),i=this.modalService.show(e,r);e.instance.submit.subscribe(function(e){e&&(t.formControl.setValue(e.key),t.instance.cd.detectChanges()),i.close()}),e.instance.cancel.subscribe(function(e){return i.close()})},Jt.decorators=[{type:b.Component,args:[{selector:"lib-parameter-setting",template:'\r\n<div class="f-page f-page-is-managelist">\r\n  <div class="f-page-main my-0">\r\n    <div class="f-struct-wrapper f-utils-fill-flex-column">\r\n      <farris-section class="f-section-grid f-section-in-managelist px-0" [showHeader]="showFormType" mainTitle="{{\'component.executeForms.parametersSet\' | wfLocale}}" [enableMaximize]="false">\r\n        <ng-template farrisSectionToolbar>\r\n          <farris-combo-list [(ngModel)]="formType" name="formType" [idField]="\'value\'" [textField]="\'text\'"\r\n            [enableClear]="false" [valueField]="\'value\'" [data]="formTypeCollection" [panelHeight]="\'auto\'" [editable]="false"\r\n            style="width: 130px;">\r\n          </farris-combo-list>\r\n        </ng-template>\r\n        <farris-datagrid class="f-component-grid" [columns]="cols" [data]="parameters" #grid\r\n          [idField]="idField" [fit]="true" [fitColumns]="true" [editable]="true" [editMode]="\'cell\'" [pagination]="false"\r\n          [showCheckbox]="false" [multiSelect]="false" [showLineNumber]="true" [striped]="true" [beforeEdit]="beforeEdit"\r\n          [virtualized]="true">\r\n        </farris-datagrid>\r\n      </farris-section>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type="button" class="btn btn-secondary btn-sm" (click)="clickCancel()">{{\'component.executeForms.clickCancel\' | wfLocale}}</button>\r\n  <button type="button" class="btn btn-primary btn-sm mx-2" (click)="clickOK()">{{\'component.executeForms.clickOK\' | wfLocale}}</button>\r\n</ng-template>\r\n',providers:[x],styles:[""]}]}],Jt.ctorParameters=function(){return[{type:D.ExpressionService},{type:a},{type:b.ComponentFactoryResolver},{type:i.BsModalService},{type:b.Injector},{type:b.ChangeDetectorRef,decorators:[{type:b.Optional}]},{type:String,decorators:[{type:b.Inject,args:[b.LOCALE_ID]}]},{type:undefined,decorators:[{type:b.Inject,args:[o]}]},{type:x,decorators:[{type:b.Optional}]}]},Jt.propDecorators={modalFooter:[{type:b.ViewChild,args:["iconSelectFooter"]}],grid:[{type:b.ViewChild,args:["grid"]}]};var Wt=Jt;function Jt(e,t,r,i,n,o,a,s,l){var c=this;this.expr=e,this.designerState=t,this.resolver=r,this.modalService=i,this.injector=n,this.cdr=o,this.localeId=a,this.resources=s,this.localePipe=l,this.idField="Name",this._mode="bpmn",this.submit=new v.Subject,this.cancel=new v.Subject,this.formTypeCollection=[{text:this.localePipe.transform("component.executeForms.processEmbeddedForm"),value:"0"},{text:this.localePipe.transform("component.executeForms.formEmbedProcess"),value:"1"}],this.valueTypeCollection=[{text:this.localePipe.transform("component.executeForms.variable"),value:"variable"},{text:this.localePipe.transform("component.executeForms.constant"),value:"constant"},{text:this.localePipe.transform("component.executeForms.expression"),value:"expression"}],this.cols=new Array,this.parameters=new Array,this.formType=this.formTypeCollection[0].value,this.showFormType=!1,this.allParameters=new Array,this.beforeEdit=function(e){if("usual"!==c.mode&&"Value"===e.column.field)switch(e.rowData.Tag){case"expression":e.column.editor={type:"input-group",options:{groupText:'<i class="f-icon f-icon-lookup"></i>',editable:!1,clickHandle:function(e){e.formControl.setValue(e.instance.value||""),c.showExprHelp(e)},clear:function(e){console.log("clear",e)}}};break;case"variable":e.column.editor={type:"input-group",options:{groupText:'<i class="f-icon f-icon-lookup"></i>',editable:!0,clickHandle:function(e){c.selectVariable(e)},clear:function(e){console.log("clear",e)}}};break;case"constant":e.column.editor={type:g.EditorTypes.TEXTBOX,options:{}}}return v.of(!0)},this.localePipe=this.localePipe||new x(a,s)}Object.defineProperty(Yt.prototype,"value",{set:function(e){var r,i=this;e&&(r=new Array,e.ActualParameters.forEach(function(e){var t=new Vt;t.Name=e.Name,t.Tag=e.Tag||i.initVariableType(e.Value),t.Value=e.Value,r.push(t)}),this.form.ActualParameters=r,this.form.Id=e.Id,this.form.Name=e.Name,this.form.ComponentId=e.ComponentId,this.form.formFormatId=e.formFormatId,this.form.formatConfigId=e.formatConfigId,this.form.FormType=e.FormType,this.form.TerminalType=e.TerminalType)},enumerable:!0,configurable:!0}),Yt.prototype.ngAfterViewInit=function(){},Yt.prototype.ngOnInit=function(){this.location=this.editorParams.location,this.tab=this.editorParams.tab,"userActivity"===this.location?this.showMethodTab=!0:this.showMethodTab=!1},Yt.prototype.clickOK=function(){var l,c=this;new Rt;this.getForm().subscribe(function(e){var t,r;if(e.result&&(l=e.form,c.validator(l))){var i=null;if(l&&l.ActualParameters&&0<l.ActualParameters.length){var n=c.designerState.flowFormInfo.formalParameters.filter(function(e){return"CDTSchema"!==e.dataType});try{for(var o=ue(l.ActualParameters),a=o.next();!a.done;a=o.next())if("break"===function(t){if("variable"===t.Tag&&t.Value&&!c.allParameters.some(function(e){return e.key===t.Value})&&n.some(function(e){return e.code===t.Value}))return i=n,"break"}(a.value))break}catch(s){t={error:s}}finally{try{a&&!a.done&&(r=o["return"])&&r.call(o)}finally{if(t)throw t.error}}}e={value:l,parameters:i};c.submitModal.emit(e)}})},Yt.prototype.clickCancel=function(){this.closeModal.emit()},Yt.prototype.validator=function(e){var t,r;if(e&&e.ActualParameters&&0<e.ActualParameters.length){var i=this.designerState.flowFormInfo.formalParameters.filter(function(e){return"CDTSchema"!==e.dataType}),n=this;try{for(var o=ue(e.ActualParameters),a=o.next();!a.done;a=o.next()){var s=function(t){if("variable"===t.Tag&&t.Value&&!n.allParameters.some(function(e){return e.key===t.Value})&&!i.some(function(e){return e.code===t.Value}))return n.message.error(n.localePipe.transform("component.executeForms.parameters")+t.Name+n.localePipe.transform("component.executeForms.typeAsvariable")),{value:!1}}(a.value);if("object"==typeof s)return s.value}}catch(l){t={error:l}}finally{try{a&&!a.done&&(r=o["return"])&&r.call(o)}finally{if(t)throw t.error}}}return!0},Yt.prototype.getForm=function(){var t=this;return this.form.ComponentId?M.of({result:!0,form:this.form}):this.form.formFormatId?this.configContainer.submit().pipe(re.switchMap(function(e){return e.result?(t.form.formatConfigId=e.configId,M.of({result:!0,form:t.form})):M.of({result:!1,form:t.form})})):M.of({result:!0,form:null})},Yt.prototype.parametersSet=function(){var t=this,e=this.resolver.resolveComponentFactory(Wt).create(this.injector),r=(e.instance.mode="bpmn",e.instance.allParameters=this.allParameters,"web"===this.tab?(this.form.ComponentId&&(e.instance.showFormType=!0,e.instance.formType=this.form.FormType),e.instance.parameters=w(this.form.ActualParameters.map(function(e){return Object.assign({},e)}))):e.instance.parameters=w(this.form.ActualParameters.map(function(e){return Object.assign({},e)})),{title:this.localePipe.transform("component.executeForms.parameterSettings"),width:620,height:400,showButtons:!0,buttons:e.instance.modalFooter}),i=this.modalService.show(e,r);e.instance.submit.subscribe(function(e){"web"===t.tab?(t.form.ActualParameters=e.parameters,t.form.FormType=e.formType):t.form.ActualParameters=e.parameters,i.close()}),e.instance.cancel.subscribe(function(e){i.close()})},Yt.prototype.selectExecuteForm=function(){var t=this,e=this.resolver.resolveComponentFactory(_t).create(this.injector),r=(e.instance.tab=this.tab,{title:this.localePipe.transform("component.executeForms.formDefinitionList"),width:650,height:400,showButtons:!0,buttons:e.instance.modalFooter}),i=this.modalService.show(e,r);e.instance.submit.subscribe(function(e){t.form=e,i.close()}),e.instance.cancel.subscribe(function(e){i.close()})},Yt.prototype.clear=function(){this.form=new Rt},Yt.prototype.initVariableType=function(e){return e?8<=e.length&&'{"expr":'===e.slice(0,8)?"expression":"constant":"variable"},Yt.prototype.getVariableList=function(){var e,t,r,i,n,o,a,s,l,c,p=new Array;if(0<this.designerState.procInstContext.length)try{for(var d=ue(this.designerState.procInstContext),u=d.next();!u.done;u=d.next()){var m=u.value;p.push(m)}}catch(P){e={error:P}}finally{try{u&&!u.done&&(t=d["return"])&&t.call(d)}finally{if(e)throw e.error}}if(0<this.designerState.subActivityContext.length)try{for(var f=ue(this.designerState.subActivityContext),h=f.next();!h.done;h=f.next())!function(t){p.some(function(e){return e.key===t.key})||p.push(t)}(m=h.value)}catch(C){r={error:C}}finally{try{h&&!h.done&&(i=f["return"])&&i.call(f)}finally{if(r)throw r.error}}if(0<this.designerState.formalParameterContext.length)try{for(var y=ue(this.designerState.formalParameterContext),g=y.next();!g.done;g=y.next())!function(t){p.some(function(e){return e.key===t.key})||p.push(t)}(m=g.value)}catch(I){n={error:I}}finally{try{g&&!g.done&&(o=y["return"])&&o.call(y)}finally{if(n)throw n.error}}if(0<this.designerState.participantContext.length)try{for(var v=ue(this.designerState.participantContext),b=v.next();!b.done;b=v.next())!function(t){p.some(function(e){return e.key===t.key})||p.push(t)}(m=b.value)}catch(S){a={error:S}}finally{try{b&&!b.done&&(s=v["return"])&&s.call(v)}finally{if(a)throw a.error}}if(0<this.designerState.processVariableContext.length)try{for(var x=ue(this.designerState.processVariableContext),w=x.next();!w.done;w=x.next())!function(t){p.some(function(e){return e.key===t.key})||p.push(t)}(m=w.value)}catch(E){l={error:E}}finally{try{w&&!w.done&&(c=x["return"])&&c.call(x)}finally{if(l)throw l.error}}return p},Yt.decorators=[{type:b.Component,args:[{selector:"app-execute-forms",template:'\r\n<ng-template #iconSelectFooter>\r\n  <button type="button" class="btn btn-secondary btn-sm" (click)="clickCancel()">{{\'component.executeForms.clickCancel\'|wfLocale}}</button>\r\n  <button type="button" class="btn btn-primary btn-sm mx-2" (click)="clickOK()">{{\'component.executeForms.clickOK\'|wfLocale}}</button>\r\n</ng-template>\r\n\r\n<ng-template #empty>\r\n  <div class="f-utils-fill-flex-column h-100">\r\n    <div class="f-datagrid-norecords" style="height: 100%;">\r\n      <div class="f-datagrid-norecords-content w-100">{{\'component.executeForms.noForm\'|wfLocale}}</div>\r\n    </div>\r\n  </div>\r\n</ng-template>\r\n\r\n<div class="f-page f-page-is-managelist">\r\n  <div class="f-page-main mx-3" style="border-radius:16px;border: 1.5px solid #F1F3F7;">\r\n    <div class="farris-form farris-form-controls-inline farris-form-auto f-form-lable-auto">\r\n      <div class="f-section-formgroup-inputs">\r\n        <div class="col-12 col-md-5 px-0 my-2" style="margin-left: 50px;">\r\n          <div class="farris-group-wrap">\r\n            <div class="form-group farris-form-group mb-0">\r\n              <label class="col-form-label">\r\n                <span class="farris-label-text">{{\'component.executeForms.form\'|wfLocale}}</span>\r\n              </label>\r\n              <input-group class="form-control" style="width: 100%;padding:0;border:0;" [enableClear]="true"\r\n                [showButtonWhenDisabled]="false" [(ngModel)]="form.Name" name="form" placeholder="{{\'component.executeForms.placeholder\'|wfLocale}}"\r\n                [editable]="false" (clickHandle)="selectExecuteForm()" (clear)="clear()" [groupText]="groupIcon">\r\n              </input-group>\r\n              <div class="farris-feedback valid-feedback"></div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div class="col-12 col-md-2 my-2 px-0">\r\n          <div class="farris-group-wrap" style="padding-top: 2px;">\r\n            <div class="form-group farris-form-group mb-0">\r\n              <div class="farris-input-wrap">\r\n                <farris-button [disabled]="!form.ComponentId && !form.formFormatId" [type]="\'link\'" (click)="parametersSet()">\r\n                  {{\'component.executeForms.parametersSet\'|wfLocale}}\r\n                </farris-button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class="h-100 mx-3">\r\n    <lib-form-config-container #configContainer\r\n      [formFormatId]="form.formFormatId" [formatConfigId]="form.formatConfigId" [showMethodTab]="showMethodTab"\r\n      class="h-100"></lib-form-config-container>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n\r\n\r\n\r\n',providers:[Ot,Dt,Lt,x],styles:[""]}]}],Yt.ctorParameters=function(){return[{type:he.FormBuilder},{type:Ot},{type:Dt},{type:b.ComponentFactoryResolver},{type:b.Injector},{type:i.BsModalService},{type:a},{type:r.MessagerService},{type:b.ChangeDetectorRef,decorators:[{type:b.Optional}]},{type:String,decorators:[{type:b.Inject,args:[b.LOCALE_ID]}]},{type:undefined,decorators:[{type:b.Inject,args:[o]}]},{type:x,decorators:[{type:b.Optional}]}]},Yt.propDecorators={cls:[{type:b.HostBinding,args:["class"]}],style:[{type:b.HostBinding,args:["style.background"]}],closeModal:[{type:b.Output}],submitModal:[{type:b.Output}],value:[{type:b.Input}],editorParams:[{type:b.Input}],modalFooter:[{type:b.ViewChild,args:["iconSelectFooter"]}],configContainer:[{type:b.ViewChild,args:["configContainer"]}],configSection:[{type:b.ViewChild,args:["configSection",{read:b.ElementRef}]}]};var $t=Yt;function Yt(e,t,r,i,n,o,a,s,l,c,p,d){this.formBuilder=e,this.uistate=t,this.viewmodel=r,this.resolver=i,this.injector=n,this.modalService=o,this.designerState=a,this.message=s,this.cdr=l,this.localeId=c,this.resources=p,this.localePipe=d,this.modalConfig={title:this.localePipe.transform("component.executeForms.executeForms"),width:760,height:532,showButtons:!0},this.cls="farris-main-area flex-column",this.style="#FFF",this.closeModal=new b.EventEmitter,this.submitModal=new b.EventEmitter,this.editorParams={},this.tab="web",this.groupIcon='<i class="f-icon f-icon-lookup"></i>',this.cols=[],this.showMethodTab=!0,this.allParameters=new Array,this.localePipe=this.localePipe||new x(c,p),this.form=new Rt,this.allParameters=this.getVariableList()}Zt.prototype.convertTo=function(e){return e?e.Name:"process"===this.params.location?this.localePipe.transform("component.executeForms.notSet"):this.localePipe.transform("component.executeForms.default")};var Xt=Zt;function Zt(e,t){this.localePipe=t,this.params=e}er.prototype.ngOnInit=function(){var e,t,r,i,n,o,a,s,l,c;if(null!=this.value&&("string"==typeof this.value?this.textWithMultiLanguage.set("zh-CHS",this.value):this.textWithMultiLanguage=new Map(Object.entries(this.value))),this.contextEntities=new Array,0<this.designerState.procInstContext.length)try{for(var p=ue(this.designerState.procInstContext),d=p.next();!d.done;d=p.next()){var u=d.value;this.contextEntities=this.contextEntities.concat([u])}}catch(S){e={error:S}}finally{try{d&&!d.done&&(t=p["return"])&&t.call(p)}finally{if(e)throw e.error}}if(0<this.designerState.formalParameterContext.length){var m=this;try{for(var f=ue(this.designerState.formalParameterContext),h=f.next();!h.done;h=f.next())!function(t){m.contextEntities.some(function(e){return e.key===t.key})||(m.contextEntities=m.contextEntities.concat([t]))}(u=h.value)}catch(E){r={error:E}}finally{try{h&&!h.done&&(i=f["return"])&&i.call(f)}finally{if(r)throw r.error}}}if(0<this.designerState.subActivityContext.length){var y=this;try{for(var g=ue(this.designerState.subActivityContext),v=g.next();!v.done;v=g.next())!function(t){y.contextEntities.some(function(e){return e.key===t.key})||(y.contextEntities=y.contextEntities.concat([t]))}(u=v.value)}catch(T){n={error:T}}finally{try{v&&!v.done&&(o=g["return"])&&o.call(g)}finally{if(n)throw n.error}}}if(0<this.designerState.participantContext.length){var b=this;try{for(var x=ue(this.designerState.participantContext),w=x.next();!w.done;w=x.next())!function(t){b.contextEntities.some(function(e){return e.key===t.key})||(b.contextEntities=b.contextEntities.concat([t]))}(u=w.value)}catch(A){a={error:A}}finally{try{w&&!w.done&&(s=x["return"])&&s.call(x)}finally{if(a)throw a.error}}}if(0<this.designerState.processVariableContext.length){var P=this;try{for(var C=ue(this.designerState.processVariableContext),I=C.next();!I.done;I=C.next())!function(t){P.contextEntities.some(function(e){return e.key===t.key})||(P.contextEntities=P.contextEntities.concat([t]))}(u=I.value)}catch(k){l={error:k}}finally{try{I&&!I.done&&(c=C["return"])&&c.call(C)}finally{if(l)throw l.error}}}},er.prototype.clickOK=function(){this.value=this.editor.getExprWithMultiLanguage();var e=w(this.value.entries()).reduce(function(e,t){var t=Ye(t,2),r=t[0],t=t[1];return e[r]=null==t?"":t,e},{});this.submitModal.emit({value:e,parameters:null})},er.prototype.clickCancel=function(){this.closeModal.emit()},er.prototype.convertToValue=function(e){return e&&e.substring(9,e.length-2)?e:""},er.decorators=[{type:b.Component,args:[{selector:"app-title-expression",template:'<div class="f-page">\r\n  <div class="f-page-header">\r\n    <nav class="f-page-header-base">\r\n      <div class="f-title">\r\n        <div class="col-12 farris-group-auto pr-5">\r\n          <div class="farris-group-wrap">\r\n            <div class="form-group farris-form-group" style="display:flex">\r\n              <label class="col-form-label">\r\n                <span class="farris-label-text">{{\'component.titleExpression.currentLanguage\' | wfLocale}}</span>\r\n              </label>\r\n              <div class="farris-input-wrap">\r\n                <farris-combo-list [data]="languageOptions" [textField]="\'text\'" [valueField]="\'value\'"\r\n                  [idField]="\'value\'" [(ngModel)]="language" style="flex: 1;" [enableClear]="false">\r\n                </farris-combo-list>\r\n                <div class="farris-feedback valid-feedback"></div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </nav>\r\n  </div>\r\n  <div class="f-page-main f-utils-fill-flex-column h-100">\r\n    <div class="f-utils-fill-flex-column farris-overflow-y-auto h-100">\r\n      <app-expressioneditor class="h-100" [isPanel]="true" [contextEntities]="contextEntities" [text]="value"\r\n        [customSchemaName]="\'Schema\'" [customSchema]="schema" [injectName]="injectName" [injectSchemaName]="\'Schema\'"\r\n        [injectNameInSchema]="injectName" [language]="language" [textWithMultiLanguage]="textWithMultiLanguage">\r\n      </app-expressioneditor>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #iconSelectFooter>\r\n  <div class="btns">\r\n    <button type="button" class="btn btn-secondary btn-sm" (click)="clickCancel()">{{\'component.titleExpression.clickCancel\' | wfLocale}}</button>\r\n    <button type="button" class="btn btn-primary btn-sm mr-2" (click)="clickOK()">{{\'component.titleExpression.clickOK\' | wfLocale}}</button>\r\n  </div>\r\n</ng-template>\r\n',providers:[x],styles:[""]}]}],er.ctorParameters=function(){return[{type:D.ExpressionService},{type:b.Injector},{type:a},{type:b.ChangeDetectorRef,decorators:[{type:b.Optional}]},{type:String,decorators:[{type:b.Inject,args:[b.LOCALE_ID]}]},{type:undefined,decorators:[{type:b.Inject,args:[o]}]},{type:x,decorators:[{type:b.Optional}]}]},er.propDecorators={closeModal:[{type:b.Output}],submitModal:[{type:b.Output}],value:[{type:b.Input}],modalFooter:[{type:b.ViewChild,args:["iconSelectFooter"]}],editorParams:[{type:b.Input}],editor:[{type:b.ViewChild,args:[D.ExpressioneditorComponent]}]};var Qt=er;function er(e,t,r,i,n,o,a){this.expr=e,this.injector=t,this.designerState=r,this.cdr=i,this.localeId=n,this.resources=o,this.localePipe=a,this.closeModal=new b.EventEmitter,this.submitModal=new b.EventEmitter,this.textWithMultiLanguage=new Map,this.editorParams={},this.language="zh-CHS",this.languageOptions=[{value:"zh-CHS",text:this.localePipe.transform("component.titleExpression.zh-CHS")},{value:"zh-CHT",text:this.localePipe.transform("component.titleExpression.zh-CHT")},{value:"en",text:this.localePipe.transform("component.titleExpression.en")}],this.contextEntities=[],this.schema={},this.injectName="",this.modalConfig={title:this.localePipe.transform("component.titleExpression.taskDescription"),width:1140,height:720,showButtons:!0},this.localePipe=this.localePipe||new x(n,o),this.designerState.schemas[0]&&(this.schema=this.designerState.schemas[0],this.designerState.schemas[0].entityTypes)&&0<this.designerState.schemas[0].entityTypes.length&&(this.injectName=this.designerState.schemas[0].entityTypes[0].name),this.language=this.injector.get(b.LOCALE_ID,null)||this.language}rr.prototype.convertTo=function(e){return e&&"string"==typeof e?e:!(e&&0<Object.keys(e).length)||this.areAllPropertiesEmpty(e)?this.localePipe.transform("component.titleExpression.notSet"):this.localePipe.transform("component.titleExpression.set")},rr.prototype.areAllPropertiesEmpty=function(e){for(var t in e)if(e.hasOwnProperty(t)&&""!==e[t])return!1;return!0};var tr=rr;function rr(e){this.localePipe=e}var ir=function(e,t,r){this.id=e,this.code=t,this.name=r},nr=(or.prototype.ngOnInit=function(){},or.prototype.clickOK=function(){var c=[],e=this.grid.checkeds;e&&0<e.length&&e.forEach(function(e){var t,r,i=new ir(e.data.id,e.data.code,e.data.name);if(i.terminalType=e.data.terminal,i.actualParameters=[],e.data.actualParameters&&0<e.data.actualParameters.length)try{for(var n=ue(e.data.actualParameters),o=n.next();!o.done;o=n.next()){var a=o.value,s={Name:a.code,Value:a.value,ValueText:a.name,Tag:"expression"};i.actualParameters.push(s)}}catch(l){t={error:l}}finally{try{o&&!o.done&&(r=n["return"])&&r.call(n)}finally{if(t)throw t.error}}c.push(i)}),this.submit.emit(c)},or.prototype.clickCancel=function(){this.cancel.emit(!0)},or.decorators=[{type:b.Component,args:[{selector:"app-customize-action-list",template:'<div class="f-utils-fill-flex-column farris-overflow-y-auto h-100 m-2">\r\n  <farris-datagrid #grid [columns]="cols" [data]="customActionList" [idField]="\'id\'" [fit]="true"\r\n    [fitColumns]="true" [pagination]=\'false\' [multiSelect]="true" [showCheckbox]="true" [multiSelect]="true"\r\n    [checkOnSelect]="true" [selectOnCheck]="true">\r\n  </farris-datagrid>\r\n</div>\r\n\r\n<ng-template #footer>\r\n  <button type="button" class="btn btn-secondary btn-sm px-3" (click)="clickCancel()">{{\'component.customizeAction.clickCancel\' | wfLocale}}</button>\r\n  <button type="button" class="btn btn-primary btn-sm px-3 mx-2" (click)="clickOK()">{{\'component.customizeAction.clickOK\' | wfLocale}}</button>\r\n</ng-template>\r\n',providers:[x],styles:[""]}]}],or.ctorParameters=function(){return[{type:a},{type:b.ChangeDetectorRef,decorators:[{type:b.Optional}]},{type:String,decorators:[{type:b.Inject,args:[b.LOCALE_ID]}]},{type:undefined,decorators:[{type:b.Inject,args:[o]}]},{type:x,decorators:[{type:b.Optional}]}]},or.propDecorators={grid:[{type:b.ViewChild,args:["grid"]}],footer:[{type:b.ViewChild,args:["footer"]}],submit:[{type:b.Output}],cancel:[{type:b.Output}]},or);function or(e,t,r,i,n){this.designerUIState=e,this.cdr=t,this.localeId=r,this.resources=i,this.localePipe=n,this.submit=new b.EventEmitter,this.cancel=new b.EventEmitter,this.terminalList=[{value:"app",text:this.localePipe.transform("component.customizeAction.app")},{value:"web",text:"web"},{value:"web,app",text:this.localePipe.transform("component.customizeAction.all")}],this.cols=[{field:"code",width:100,title:this.localePipe.transform("component.customizeAction.code")},{field:"name",width:100,title:this.localePipe.transform("component.customizeAction.name")},{field:"terminal",width:100,title:this.localePipe.transform("component.customizeAction.terminalType"),formatter:{type:"enum",options:{valueField:"value",textField:"text",data:this.terminalList}}},{field:"isAll",width:100,title:this.localePipe.transform("component.customizeAction.isAll"),formatter:{type:"boolean",options:{trueText:this.localePipe.transform("component.customizeAction.yes"),falseText:this.localePipe.transform("component.customizeAction.no")}}}],this.localePipe=this.localePipe||new x(r,i),this.customActionList=this.designerUIState.flowFormInfo.customizeActions||[]}Object.defineProperty(sr.prototype,"value",{set:function(e){var t,r,i,n;if(e&&0<e.length)try{for(var o=ue(e),a=o.next();!a.done;a=o.next()){var s=a.value,l=new ir(s.id,s.code,s.name);if(l.terminalType=s.terminalType,l.actualParameters=[],s.actualParameters&&0<s.actualParameters.length)try{for(var c=ue(s.actualParameters),p=c.next();!p.done;p=c.next()){var d=p.value,u=new Vt;u.Name=d.Name,u.Value=d.Value,u.ValueText=d.ValueText,u.Tag=d.Tag,l.actualParameters.push(u)}}catch(m){i={error:m}}finally{try{p&&!p.done&&(n=c["return"])&&n.call(c)}finally{if(i)throw i.error}}this.actions.push(l)}}catch(f){t={error:f}}finally{try{a&&!a.done&&(r=o["return"])&&r.call(o)}finally{if(t)throw t.error}}},enumerable:!0,configurable:!0}),sr.prototype.ngOnInit=function(){},sr.prototype.ngAfterViewInit=function(){this.loadData()},sr.prototype.addActions=function(){var a=this,e=this.resolver.resolveComponentFactory(nr).create(this.injector),t={title:this.localePipe.transform("component.customizeAction.addActions"),width:800,height:520,showButtons:!0,buttons:e.instance.footer},s=this.modalService.show(e,t);e.instance.submit.subscribe(function(e){var t,r;if(e&&0<e.length){try{for(var i=ue(e),n=i.next();!n.done;n=i.next())!function(t){var e=a.actions.findIndex(function(e){return e.code===t.code});-1<e&&(a.message.info(a.localePipe.transform("component.customizeAction.actionExisted")),a.actions.splice(e,1)),a.actions.push(t)}(n.value)}catch(o){t={error:o}}finally{try{n&&!n.done&&(r=i["return"])&&r.call(i)}finally{if(t)throw t.error}}a.loadData()}s.close()}),e.instance.cancel.subscribe(function(e){return s.close()})},sr.prototype["delete"]=function(){var e,t=this;this.actionlist.endCellEdit(),this.actionlist.selectedRow&&this.actionlist.selectedRow.data?(e=this.actions.findIndex(function(e){return e.code===t.actionlist.selectedRow.data.code}),this.actions.splice(e,1),this.loadData()):this.message.info(this.localePipe.transform("component.customizeAction.selectedRow"))},sr.prototype.clickOK=function(){this.actionlist.endCellEdit(),this.paramlist&&this.paramlist.endCellEdit();var e={value:this.actions,parameters:null};this.submitModal.emit(e)},sr.prototype.clickCancel=function(){this.closeModal.emit()},sr.prototype.loadData=function(){this.actionlist.loadData(this.actions),!(0<this.actions.length)||this.actionlist.selectedRow&&this.actionlist.selectedRow.data?this.curAction=null:this.actionlist.selectRow(this.actions[0].id,!0)},sr.prototype.selectChanged=function(e){this.curAction=e.data},sr.prototype.showExprHelp=function(t){var e,r,i,n,o,a,s=this,l=new Array;if(0<this.designerState.schemas.length){try{for(var c=ue(this.designerState.schemas),p=c.next();!p.done;p=c.next()){var d=p.value;this.expr.addSchema("Schema",d)}}catch(g){e={error:g}}finally{try{p&&!p.done&&(a=c["return"])&&a.call(c)}finally{if(e)throw e.error}}this.designerState.schemas[0].entityTypes&&0<this.designerState.schemas[0].entityTypes.length&&(a=this.designerState.schemas[0].entityTypes[0],this.expr.addInjectedEntity(a.name,"Schema",a.name,D.InjectedType.EntityType))}if(l=this.designerState.addContext(l),0<this.designerState.subActivityContext.length)try{for(var u=ue(this.designerState.subActivityContext),m=u.next();!m.done;m=u.next())!function(t){l.some(function(e){return e.key===t.key})||l.push(t)}(m.value)}catch(v){r={error:v}}finally{try{m&&!m.done&&(i=u["return"])&&i.call(u)}finally{if(r)throw r.error}}if(0<l.length)try{for(var f=ue(l),h=f.next();!h.done;h=f.next()){var y=h.value;this.expr.addContext(y)}}catch(b){n={error:b}}finally{try{h&&!h.done&&(o=f["return"])&&o.call(f)}finally{if(n)throw n.error}}this.expr.addExpressionText(t.instance.value),this.expr.buildExpression().then(function(e){t.formControl.setValue(e),t.instance.cd.detectChanges(),0<l.length&&(s.expr.exprEntity.contextEntities=s.expr.exprEntity.contextEntities.filter(function(t){return!l.some(function(e){return e.key===t.key})}))})},sr.decorators=[{type:b.Component,args:[{selector:"app-customize-action",template:'<div class="f-page">\r\n  <div class="f-page-header">\r\n    <nav class="f-page-header-base">\r\n      <div class="f-title">\r\n        \x3c!-- <span class="f-title-icon f-text-orna-bill">\r\n          <i class="f-icon f-icon-page-title-administer"></i>\r\n        </span> --\x3e\r\n        \x3c!-- <h4 class="f-title-text">列表</h4> --\x3e\r\n      </div>\r\n      <div class="btn-toolbar btn-group-lg">\r\n        <button class="btn btn-primary mr-2" (click)="addActions()">{{\'component.customizeAction.add\' | wfLocale}}</button>\r\n        <button class="btn btn-secondary" (click)="delete()">{{\'component.customizeAction.delete\' | wfLocale}}</button>\r\n      </div>\r\n    </nav>\r\n  </div>\r\n  <div class="f-page-main f-utils-fill-flex-column h-100">\r\n    <div class="f-utils-fill-flex-column farris-overflow-y-auto h-100">\r\n      <div [style.height.%]="curAction?45:100">\r\n        <farris-datagrid #actionlist [data]="actions" [idField]="\'id\'"\r\n          [columns]="columns" [fit]="true" [fitColumns]="true" [editable]="true"\r\n          [editMode]="\'cell\'" [pagination]="false" [showCheckbox]="false" [multiSelect]="false"\r\n          (selectChanged)="selectChanged($event)" [closeOtherGridEditor]="true">\r\n        </farris-datagrid>\r\n      </div>\r\n      <ng-container *ngIf="curAction">\r\n        <farris-tabs class="f-utils-fill" [value]="\'parameters\'" [contentFill]="true" [autoTitleWidth]="true">\r\n          <farris-tab title="{{\'component.customizeAction.parameterList\'|wfLocale}}" [id]="\'parameters\'">\r\n            <ng-template #content>\r\n              <div class="f-utils-fill-flex-column h-100">\r\n                <farris-datagrid #paramlist [data]="curAction.actualParameters" [columns]="paramColumns"\r\n                  [idField]="\'Name\'" [fit]="true" [fitColumns]="true" [editable]="true" [editMode]="\'cell\'"\r\n                  [pagination]="false" [showCheckbox]="false" [multiSelect]="false" [closeOtherGridEditor]="true">\r\n                </farris-datagrid>\r\n              </div>\r\n            </ng-template>\r\n          </farris-tab>\r\n        </farris-tabs>\r\n      </ng-container>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type="button" class="btn btn-secondary btn-sm px-3" (click)="clickCancel()">{{\'component.customizeAction.clickCancel\' | wfLocale}}</button>\r\n  <button type="button" class="btn btn-primary btn-sm px-3 mx-2" (click)="clickOK()">{{\'component.customizeAction.clickOK\' | wfLocale}}</button>\r\n</ng-template>\r\n',providers:[x],styles:[""]}]}],sr.ctorParameters=function(){return[{type:a},{type:D.ExpressionService},{type:b.ComponentFactoryResolver},{type:b.Injector},{type:i.BsModalService},{type:r.MessagerService},{type:b.ChangeDetectorRef,decorators:[{type:b.Optional}]},{type:String,decorators:[{type:b.Inject,args:[b.LOCALE_ID]}]},{type:undefined,decorators:[{type:b.Inject,args:[o]}]},{type:x,decorators:[{type:b.Optional}]}]},sr.propDecorators={cls:[{type:b.HostBinding,args:["class"]}],closeModal:[{type:b.Output}],submitModal:[{type:b.Output}],editorParams:[{type:b.Input}],modalFooter:[{type:b.ViewChild,args:["iconSelectFooter"]}],value:[{type:b.Input}],actionlist:[{type:b.ViewChild,args:["actionlist"]}],paramlist:[{type:b.ViewChild,args:["paramlist"]}]};var ar=sr;function sr(e,t,r,i,n,o,a,s,l,c){var p=this;this.designerState=e,this.expr=t,this.resolver=r,this.injector=i,this.modalService=n,this.message=o,this.cdr=a,this.localeId=s,this.resources=l,this.localePipe=c,this.cls="farris-main-area flex-column",this.closeModal=new b.EventEmitter,this.submitModal=new b.EventEmitter,this.editorParams={},this.modalConfig={title:this.localePipe.transform("component.customizeAction.customizeAction"),width:800,height:520,showButtons:!0},this.terminalList=[{value:"app",text:this.localePipe.transform("component.customizeAction.app")},{value:"web",text:"web"},{value:"web,app",text:this.localePipe.transform("component.customizeAction.")}],this.actions=[],this.columns=[{field:"code",width:100,title:this.localePipe.transform("component.customizeAction.code")},{field:"name",width:100,title:this.localePipe.transform("component.customizeAction.name")},{field:"terminalType",width:100,title:this.localePipe.transform("component.customizeAction.terminalType"),formatter:{type:"enum",options:{valueField:"value",textField:"text",data:this.terminalList}}}],this.paramColumns=[{field:"Name",width:50,title:this.localePipe.transform("component.customizeAction.paramName")},{field:"ValueText",width:50,title:this.localePipe.transform("component.customizeAction.valueText")},{field:"Value",width:100,title:this.localePipe.transform("component.customizeAction.value"),editor:{type:"input-group",options:{groupText:'<i class="f-icon f-icon-lookup"></i>',editable:!1,clickHandle:function(e){e.formControl.setValue(e.instance.value||""),p.showExprHelp(e)},clear:function(e){console.log("clear",e)}}}}],this.localePipe=this.localePipe||new x(s,l)}cr.prototype.convertTo=function(e){return e&&0<e.length?this.localePipe.transform("component.customizeAction.set"):this.localePipe.transform("component.customizeAction.notSet")};var lr=cr;function cr(e){this.localePipe=e}var pr=function(){this.id=l.GenerateElementId(),this.basicType="String"},dr=(ur.prototype.ngOnInit=function(){},ur.prototype.clickOK=function(){this.submitEmitter.emit(this.value)},ur.prototype.clickCancel=function(){this.closeEmitter.emit()},ur.decorators=[{type:b.Component,args:[{selector:"lib-constant-edit",template:'<div class="f-page">\r\n  <div class="f-utils-fill-flex-column farris-split-section m-2 h-100">\r\n    <section class="f-utils-fill-flex-column h-100">\r\n      <textarea class="form-control" type="text" value="message" [(ngModel)]="value"\r\n        name="message" style="height: 100%;"></textarea>\r\n      <div class="farris-feedback valid-feedback"></div>\r\n    </section>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #footer>\r\n  <button type="button" class="btn btn-secondary btn-sm" (click)="clickCancel()">{{\'component.optins.clickCancel\' | wfLocale}}</button>\r\n  <button type="button" class="btn btn-primary btn-sm mx-2" (click)="clickOK()">{{\'component.optins.clickOk\' | wfLocale}}</button>\r\n</ng-template>\r\n',providers:[x],styles:[""]}]}],ur.ctorParameters=function(){return[{type:b.ChangeDetectorRef,decorators:[{type:b.Optional}]},{type:String,decorators:[{type:b.Inject,args:[b.LOCALE_ID]}]},{type:undefined,decorators:[{type:b.Inject,args:[o]}]},{type:x,decorators:[{type:b.Optional}]}]},ur.propDecorators={footer:[{type:b.ViewChild,args:["footer"]}],closeEmitter:[{type:b.Output}],submitEmitter:[{type:b.Output}],value:[{type:b.Input}]},ur);function ur(e,t,r,i){this.cdr=e,this.localeId=t,this.resources=r,this.localePipe=i,this.closeEmitter=new b.EventEmitter,this.submitEmitter=new b.EventEmitter}fr.prototype.getData=function(e,t){var r=t.customData,i=t.pageIndex||1,n=t.pageSize||20,t=t.searchValue;if(r.helpId)return r="?helpId="+r.helpId+"&pageIndex="+i+"&pageSize="+n,t&&(r+="&searchValue="+t),this.http.get(e+=r)},fr.decorators=[{type:b.Injectable}],fr.ctorParameters=function(){return[{type:t.HttpService}]};var mr=fr;function fr(e){this.http=e}yr.prototype.getHelpMetaData=function(e,t){return this.http.get("/api/runtime/lcm/v1.0/rt-metadatas/"+e)},yr.decorators=[{type:b.Injectable}],yr.ctorParameters=function(){return[{type:t.HttpService}]};var hr=yr;function yr(e){this.http=e}var gr=function(){this.Id=l.GenerateElementId(),this.ActualParameters=new Array},vr=(Object.defineProperty(br.prototype,"component",{get:function(){return this._component},set:function(t){var i=this;t&&t.MethodCode?this.service.getHelpMetaData(t.MetadataId,"").subscribe(function(e){var r=JSON.parse(e.content).operations.find(function(e){return e.code===t.MethodCode});if(!r)throw new Error(i.localePipe.transform("component.variableSetting.methodNotExist"));t.ActualParameters=t.ActualParameters.map(function(t){var e=r.parameters.find(function(e){return e.code===t.Name});if(e)return $e({},t,{fetchValueMode:e.fetchValueMode,fetchValueSetting:e.fetchValueSetting});throw new Error(i.localePipe.transform("component.variableSetting.inconsistentParameters"))}),i._component=t}):this._component=new gr},enumerable:!0,configurable:!0}),br.prototype.ngOnInit=function(){},br.prototype.ngAfterViewInit=function(){var e=this;this.ngZone.runOutsideAngular(function(){e.inputGroup.nativeElement.addEventListener("mouseenter",e.onMouseEnter.bind(e)),e.inputGroup.nativeElement.addEventListener("mouseleave",e.onMouseLeave.bind(e))})},br.prototype.onMouseEnter=function(e){this.showClearButton=!0,this.showClearButton&&this.toggleClearIcon(e,!0)},br.prototype.onMouseLeave=function(e){this.showClearButton=!1,this.toggleClearIcon(e,!1)},br.prototype.toggleClearIcon=function(e,t){t=(t=void 0===t?!1:t)?"":"none",e=e.target.querySelector(".input-group-clear");e&&(e.style.display=t)},br.prototype.clickOK=function(){this.grid.endCellEdit(),this.validator()?this.submitEmitter.emit(this.component):this.message.info(this.localePipe.transform("component.variableSetting.methodnotSelected"))},br.prototype.clickCancel=function(){this.closeEmitter.emit()},br.prototype.validator=function(){return!(!this.component.MethodCode||!this.component.MetadataId)},br.prototype.clear=function(){this.component=new gr},br.prototype.selectComponent=function(){var i=this,e=this.resolver.resolveComponentFactory(Fe.SelectMetadataRTComponent).create(this.injector),t=(e.instance.typeList="WebServiceComponent",e.instance.selectedMetadata.subscribe(function(e){try{var t=e.metadata;i.openComponentSelectorNew(t.id,i.sessionSrc.getUserSessionId())}catch(r){throw console.log("$event",e),new Error(i.localePipe.transform("component.variableSetting.errorObtainComponent")+e)}}),{title:this.localePipe.transform("component.variableSetting.componentSelection"),width:980,height:548,showButtons:!1}),r=this.modalService.show(e,t);e.instance.closeModalEmitter.subscribe(function(e){return r.close()})},br.prototype.openComponentSelectorNew=function(e,t){var r=this;this.componentService.openSelector(e,t).subscribe(function(e){e.confirmEvent.subscribe(function(e){e&&(r.component.Name=e.name,r.component.MetadataId=e.id,r.component.MethodCode=e.operations[0].code,r.component.ActualParameters=[],e.operations[0].parameters)&&0<e.operations[0].parameters.length&&(r.component.ActualParameters=e.operations[0].parameters.map(function(e){return{Name:e.code,Value:"",Tag:-1<e.fetchValueMode.indexOf("express,none")?"expression":"constant",fetchValueMode:e.fetchValueMode,fetchValueSetting:e.fetchValueSetting}}))})})},br.prototype.showExprHelp=function(t){var e,r,i,n,o,a,s=this;if(0<this.designerState.schemas.length){try{for(var l=ue(this.designerState.schemas),c=l.next();!c.done;c=l.next()){var p=c.value;this.expr.addSchema("Schema",p)}}catch(g){e={error:g}}finally{try{c&&!c.done&&(a=l["return"])&&a.call(l)}finally{if(e)throw e.error}}this.designerState.schemas[0].entityTypes&&0<this.designerState.schemas[0].entityTypes.length&&(a=this.designerState.schemas[0].entityTypes[0],this.expr.addInjectedEntity(a.name,"Schema",a.name,D.InjectedType.EntityType))}var d=new Array,d=this.designerState.addContext(d);if(0<this.designerState.subActivityContext.length)try{for(var u=ue(this.designerState.subActivityContext),m=u.next();!m.done;m=u.next())!function(t){d.some(function(e){return e.key===t.key})||d.push(t)}(m.value)}catch(v){r={error:v}}finally{try{m&&!m.done&&(i=u["return"])&&i.call(u)}finally{if(r)throw r.error}}if(0<d.length)try{for(var f=ue(d),h=f.next();!h.done;h=f.next()){var y=h.value;this.expr.addContext(y)}}catch(b){n={error:b}}finally{try{h&&!h.done&&(o=f["return"])&&o.call(f)}finally{if(n)throw n.error}}this.expr.addExpressionText(t.instance.value),this.expr.buildExpression().then(function(e){t.formControl.setValue(e),t.instance.cd.detectChanges(),0<d.length&&(s.expr.exprEntity.contextEntities=s.expr.exprEntity.contextEntities.filter(function(t){return!d.some(function(e){return e.key===t.key})}))})},br.prototype.getHelpInfo=function(){return this.service.getHelpMetaData(this.helpId,this.su)},br.decorators=[{type:b.Component,args:[{selector:"lib-component-edit",template:'<div class="f-utils-fill-flex-column farris-overflow-y-auto h-100 m-2" style="background:#FFF;">\r\n  <form class="farris-form farris-card-content-bg farris-card-section mx-2">\r\n    <div class="d-flex flex-wrap flex-column mb-2 pr-4">\r\n      <div class="farris-form-controls-inline farris-form-auto mb-2">\r\n        <div class="farris-group-wrap mx-3">\r\n          <div class="form-group">\r\n            <label class="col-form-label">\r\n              <span class="farris-label-info text-danger">*</span>\r\n              <span class="farris-label-text">{{ \'component.variableSetting.parameterName\' | wfLocale }}</span>\r\n            </label>\r\n            <div class="farris-input-wrap ml-2">\r\n              <input type="text" class="k-textbox form-control" name="name" [(ngModel)]="component.Name" />\r\n              <div class="farris-feedback valid-feedback"></div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div class="farris-form-controls-inline farris-form-auto">\r\n        <div class="farris-group-wrap mx-3">\r\n          <div class="form-group">\r\n            <label class="col-form-label">\r\n              <span class="farris-label-info text-danger">*</span>\r\n              <span class="farris-label-text">{{ \'component.variableSetting.componentSelection\' | wfLocale }}</span>\r\n            </label>\r\n            <div class="farris-input-wrap ml-2">\r\n              <div #inputGroup class="input-group">\r\n                <input type="text" class="form-control" [(ngModel)]="component.MethodCode" name="methodCode"\r\n                  [readOnly]="true" />\r\n                <div class="input-group-append">\r\n                  <span [style.display]="showClearButton ? \'\' : \'none\'" class="input-group-text input-group-clear"\r\n                    (click)="clear()">\r\n                    <i class="f-icon modal_close"></i>\r\n                  </span>\r\n                  <span class="input-group-text" (click)="selectComponent()" style="background: #FFF;">\r\n                    <i class="f-icon f-icon-lookup"></i>\r\n                  </span>\r\n                </div>\r\n              </div>\r\n              <div class="farris-feedback valid-feedback"></div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </form>\r\n  <farris-tabs class="f-utils-fill" #params [value]="\'params\'" [contentFill]="true">\r\n    <farris-tab title="{{\'component.variableSetting.parameterList\' | wfLocale}}" [id]="\'params\'">\r\n      <ng-template #content>\r\n        <div class="f-utils-fill-flex-column h-100">\r\n          <farris-datagrid #grid [data]="component.ActualParameters" [columns]="columns" [idField]="\'Name\'" [fit]="true"\r\n            [fitColumns]="true" [editable]="true" [editMode]="\'cell\'" [pagination]="false" [showCheckbox]="false" [striped]="true"\r\n            [multiSelect]="false" [afterEdit]="afterEdit" [beforeEdit]="beforeEdit"></farris-datagrid>\r\n        </div>\r\n      </ng-template>\r\n    </farris-tab>\r\n  </farris-tabs>\r\n</div>\r\n\r\n<farris-lookup-grid style="display: none;" #lookup [(ngModel)]="value" [editable]="false" [columns]="helpCols"\r\n  [singleSelect]="true" title="title" [displayType]="displayType" [uri]="dataUri"\r\n  [idField]="helpFields.idField" [pagination]="true" [valueField]="helpFields.valueField"\r\n  [textField]="helpFields.textField" [dictPicking]="dictPicking" [dictPicked]="dictPicked">\r\n</farris-lookup-grid>\r\n\r\n<ng-template #footer>\r\n  <button type="button" class="btn btn-secondary btn-sm" (click)="clickCancel()">{{\'component.variableSetting.clickCancel\' | wfLocale}}</button>\r\n  <button type="button" class="btn btn-primary btn-sm mx-2" (click)="clickOK()">{{\'component.variableSetting.clickOK\' | wfLocale}}</button>\r\n</ng-template>\r\n',providers:[hr,{provide:Ee.ServerSideToken,useClass:mr},x],styles:[""]}]}],br.ctorParameters=function(){return[{type:he.FormBuilder},{type:a},{type:D.ExpressionService},{type:b.ComponentFactoryResolver},{type:b.Injector},{type:t.SessionService},{type:i.BsModalService},{type:U.CommonComponentUiRTService},{type:b.NgZone},{type:hr},{type:l},{type:r.MessagerService},{type:b.ChangeDetectorRef,decorators:[{type:b.Optional}]},{type:String,decorators:[{type:b.Inject,args:[b.LOCALE_ID]}]},{type:undefined,decorators:[{type:b.Inject,args:[o]}]},{type:x,decorators:[{type:b.Optional}]}]},br.propDecorators={cls:[{type:b.HostBinding,args:["class"]}],grid:[{type:b.ViewChild,args:[ve.DatagridComponent]}],lookup:[{type:b.ViewChild,args:[Ee.LookupGridComponent]}],footer:[{type:b.ViewChild,args:["footer"]}],closeEmitter:[{type:b.Output}],submitEmitter:[{type:b.Output}],inputGroup:[{type:b.ViewChild,args:["inputGroup"]}],component:[{type:b.Input}]},br);function br(e,t,r,i,n,o,a,s,l,c,p,d,u,m,f,h){var y=this;this.formBuilder=e,this.designerState=t,this.expr=r,this.resolver=i,this.injector=n,this.sessionSrc=o,this.modalService=a,this.componentService=s,this.ngZone=l,this.service=c,this.util=p,this.message=d,this.cdr=u,this.localeId=m,this.resources=f,this.localePipe=h,this.cls="farris-main-area flex-column",this.closeEmitter=new b.EventEmitter,this.submitEmitter=new b.EventEmitter,this.showClearButton=!1,this._component=new gr,this.columns=[{field:"Name",width:100,title:this.localePipe.transform("component.variableSetting.parameterName")},{field:"Value",width:100,title:this.localePipe.transform("component.variableSetting.parameterValue"),editor:{type:"input-group",options:{groupText:'<i class="f-icon f-icon-lookup"></i>',editable:!1,clickHandle:function(e){e.formControl.setValue(e.instance.value||""),y.showExprHelp(e)},clear:function(e){console.log("clear",e)}}}}],this.helpFields={idField:"",valueField:"",textField:""},this.dataUri="/api/runtime/wf/v1.0/dtProcDefs/getHelpData",this.helpCols=[],this.displayType="List",this.title="",this.beforeEdit=function(e){var t=e.rowData;switch(t.fetchValueMode){case L.ParameterFetchValueMode.express:e.column.editor={type:"input-group",options:{groupText:'<i class="f-icon f-icon-lookup"></i>',editable:!1,clickHandle:function(e){e.formControl.setValue(e.instance.value||""),y.showExprHelp(e)},clear:function(e){console.log("clear",e)}}};break;case L.ParameterFetchValueMode.none:e.column.editor={type:"input-group",options:{groupText:'<i class="f-icon f-icon-lookup"></i>',editable:!1,clickHandle:function(e){e.formControl.setValue(e.instance.value||""),y.showExprHelp(e)},clear:function(e){console.log("clear",e)}}};break;case L.ParameterFetchValueMode["const"]:case L.ParameterFetchValueMode["enum"]:e.column.editor={type:g.EditorTypes.TEXTBOX,options:{}};break;case L.ParameterFetchValueMode.help:e.column.editor={type:"input-group",options:{groupText:'<i class="f-icon f-icon-lookup"></i>',editable:!1,clickHandle:function(e){y.cell=e,y.helpId=t.fetchValueSetting.helpId,y.su=t.fetchValueSetting.serviceUnit,y.getHelpInfo().subscribe(function(e){console.log(e);e=JSON.parse(e.content);y.helpCols=e.dataSource.columns,y.displayType=e.displayType,y.helpFields={idField:e.idField,valueField:e.valueField,textField:e.textField},y.lookup.onClear(),y.lookup.showDialog()},function(e){y.message.error(y.localePipe.transform("component.variableSetting.metadataNotExist"))})},clear:function(e){console.log("clear",e)}}}}return v.of(!0)},this.afterEdit=function(e,t,r){return v.of(!0)},this.dictPicking=function(){return v.of({showDialog:!0,data:{helpId:y.helpId}})},this.dictPicked=function(e){if(y.cell)return console.log(e),y.cell.formControl.setValue(y.util.getValue(e,y.helpFields.valueField)),y.cell.instance.cd.detectChanges(),v.of(!0)},this.localePipe=this.localePipe||new x(m,f)}wr.prototype.ngOnInit=function(){this.variableSetting&&(this.columns=this.columns.filter(function(e){return"tag"!==e.field&&"valueText"!==e.field&&"description"!==e.field}))},wr.prototype.add=function(){var e=new pr;this.value=this.value.concat([e])},wr.prototype["delete"]=function(){this.grid.endCellEdit();var t=this.grid.selectedRow;t?this.value=this.value.filter(function(e){return e.id!==t.data.id}):this.message.info(this.localePipe.transform("component.processVariables.notSelected"))},wr.prototype.clickOK=function(){var e;this.variableSetting?0<(e=this.grid.checkeds).length?this.varValidator()&&this.variableSetEmitter.emit(e):this.message.info(this.localePipe.transform("component.processVariables.notSelected")):(this.grid.endCellEdit(),this.validator()&&(e={value:this.value,parameters:null},this.submitModal.emit(e)))},wr.prototype.clickCancel=function(){this.closeModal.emit()},wr.prototype.endEdit=function(e){"valueText"===e.column.field&&e.rowData.tag===this.tags[0].value&&(e.rowData.value=e.rowData.valueText)},wr.prototype.valueEdit=function(e){switch(e.rowData.tag){case this.tags[0].value:this.editConstant(e);break;case this.tags[1].value:this.editExpression(e);break;case this.tags[2].value:this.editComponent(e)}},wr.prototype.editConstant=function(t){var r=t.rowData,e=this.resolver.resolveComponentFactory(dr).create(this.injector),i=(e.instance.value=r.value,e.instance.submitEmitter.subscribe(function(e){t.formControl.setValue(e),t.instance.cd.detectChanges(),r.value=e,n.close()}),e.instance.closeEmitter.subscribe(function(e){n.close()}),{title:this.localePipe.transform("component.processVariables.constant"),width:340,height:280,showButtons:!0,buttons:e.instance.footer}),n=this.modalService.show(e,i)},wr.prototype.editExpression=function(t){var e,r,i,n,o,a,s=this,l=t.rowData;if(0<this.uistate.schemas.length){try{for(var c=ue(this.uistate.schemas),p=c.next();!p.done;p=c.next()){var d=p.value;this.expr.addSchema("Schema",d)}}catch(v){e={error:v}}finally{try{p&&!p.done&&(a=c["return"])&&a.call(c)}finally{if(e)throw e.error}}this.uistate.schemas[0].entityTypes&&0<this.uistate.schemas[0].entityTypes.length&&(a=this.uistate.schemas[0].entityTypes[0],this.expr.addInjectedEntity(a.name,"Schema",a.name,D.InjectedType.EntityType))}var u=new Array,u=this.uistate.addContext(u);if(0<this.uistate.subActivityContext.length)try{for(var m=ue(this.uistate.subActivityContext),f=m.next();!f.done;f=m.next())!function(t){u.some(function(e){return e.key===t.key})||u.push(t)}(f.value)}catch(b){r={error:b}}finally{try{f&&!f.done&&(i=m["return"])&&i.call(m)}finally{if(r)throw r.error}}if(0<u.length)try{for(var h=ue(u),y=h.next();!y.done;y=h.next()){var g=y.value;this.expr.addContext(g)}}catch(x){n={error:x}}finally{try{y&&!y.done&&(o=h["return"])&&o.call(h)}finally{if(n)throw n.error}}this.expr.setEditPattern(D.ExprEditMode.Advanced),this.expr.addExpressionText(l.value),this.expr.buildExpression().then(function(e){t.formControl.setValue(e),t.instance.cd.detectChanges(),l.value=e,t.form.bindingData.value=e,t.form.value.value=e,0<u.length&&(s.expr.exprEntity.contextEntities=s.expr.exprEntity.contextEntities.filter(function(t){return!u.some(function(e){return e.key===t.key})}))})},wr.prototype.editComponent=function(t){var r=t.rowData,e=this.resolver.resolveComponentFactory(vr).create(this.injector),i=(e.instance.component=r.component,e.instance.submitEmitter.subscribe(function(e){t.formControl.setValue(e.Name+"-"+e.MethodCode),t.instance.cd.detectChanges(),r.value=e.Id,r.component=e,t.form.bindingData.value=e.Id,t.form.value.value=e.Id,t.form.value.component=e,t.form.bindingData.component=e,n.close()}),e.instance.closeEmitter.subscribe(function(e){n.close()}),{title:this.localePipe.transform("component.processVariables.component"),width:800,height:515,showButtons:!0,buttons:e.instance.footer}),n=this.modalService.show(e,i)},wr.prototype.validator=function(){var e,t;try{for(var r=ue(this.value),i=r.next();!i.done;i=r.next()){var n=i.value;if(!n.name)return this.message.warning(this.localePipe.transform("component.processVariables.variableNumberEmpty")),!1;if(!n.documentation)return this.message.warning(this.localePipe.transform("component.processVariables.variableNameEmpty")),!1;if(!this.IsMatchVariableNameRules(n.name))return this.message.warning(this.localePipe.transform("component.processVariables.variableNumberNotStandard")),!1;if(n.value&&!n.tag)return this.message.warning(this.localePipe.transform("component.processVariables.tagNotEmpty")),!1}}catch(l){e={error:l}}finally{try{i&&!i.done&&(t=r["return"])&&t.call(r)}finally{if(e)throw e.error}}if(1<this.value.length)for(var o=0;o<this.value.length;o++)for(var a=this.value[o].name,s=o+1;s<this.value.length;s++)if(a===this.value[s].name)return this.message.warning(this.localePipe.transform("component.processVariables.codeDuplicates")),!1;return!0},wr.prototype.IsMatchVariableNameRules=function(e){return!!/^[a-zA-Z_][a-zA-Z_0-9]{0,}/.test(e)},wr.prototype.varValidator=function(){var e,t,r=this;try{for(var i=ue(this.grid.checkeds),n=i.next();!n.done;n=i.next()){var o=function(t){if(r.selectedValue.length&&0<r.selectedValue.length&&0<r.selectedValue.filter(function(e){return e.variableCode===t.data.name}).length)return r.message.warning(r.localePipe.transform("component.processVariables.alreadyExists")),{value:!1}}(n.value);if("object"==typeof o)return o.value}}catch(a){e={error:a}}finally{try{n&&!n.done&&(t=i["return"])&&t.call(i)}finally{if(e)throw e.error}}return!0},wr.decorators=[{type:b.Component,args:[{selector:"lib-process-variables",template:'<div class="f-page">\r\n  <div *ngIf="!variableSetting" class="f-page-header">\r\n    <nav class="f-page-header-base">\r\n      <div class="f-title">\r\n      </div>\r\n      <div class="btn-toolbar btn-group-lg">\r\n        <button class="btn btn-secondary mr-2" (click)="delete()">{{\'component.processVariables.delete\' | wfLocale}}</button>\r\n        <button class="btn btn-primary" (click)="add()">{{\'component.processVariables.add\' | wfLocale}}</button>\r\n      </div>\r\n    </nav>\r\n  </div>\r\n  <div class="f-page-main f-utils-fill-flex-column h-100">\r\n    <div class="f-utils-fill-flex-column farris-overflow-y-auto h-100">\r\n      <farris-datagrid #grid [data]="value" [columns]="columns" [idField]="\'id\'" [fit]="true" [fitColumns]="true"\r\n        [editable]="!variableSetting" [editMode]="\'cell\'" [pagination]="false" (endEdit)="endEdit($event)" [beforeEdit]="beforeEdit"\r\n        [showCheckbox]="variableSetting" [multiSelect]="variableSetting" [checkOnSelect]="true" [selectOnCheck]="true" [showAllCheckbox]="variableSetting"\r\n        [showLineNumber]="true" lineNumberTitle="{{\'component.processVariables.number\' | wfLocale}}" [lineNumberWidth]="50" [striped]="true">\r\n      </farris-datagrid>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type="button" class="btn btn-secondary btn-sm px-3 mx-2" (click)="clickCancel()">{{\'component.processVariables.clickCancel\' | wfLocale}}</button>\r\n  <button type="button" class="btn btn-primary btn-sm px-3 mx-2" (click)="clickOK()">{{\'component.processVariables.clickOK\' | wfLocale}}</button>\r\n</ng-template>\r\n',providers:[x],styles:[""]}]}],wr.ctorParameters=function(){return[{type:r.MessagerService},{type:b.ComponentFactoryResolver},{type:b.Injector},{type:i.BsModalService},{type:a},{type:D.ExpressionService},{type:b.ChangeDetectorRef,decorators:[{type:b.Optional}]},{type:String,decorators:[{type:b.Inject,args:[b.LOCALE_ID]}]},{type:undefined,decorators:[{type:b.Inject,args:[o]}]},{type:x,decorators:[{type:b.Optional}]}]},wr.propDecorators={cls:[{type:b.HostBinding,args:["class"]}],variableSetting:[{type:b.Input}],closeModal:[{type:b.Output}],submitModal:[{type:b.Output}],variableSetEmitter:[{type:b.Output}],value:[{type:b.Input}],selectedValue:[{type:b.Input}],editorParams:[{type:b.Input}],modalFooter:[{type:b.ViewChild,args:["iconSelectFooter"]}],grid:[{type:b.ViewChild,args:["grid"]}]};var xr=wr;function wr(e,t,r,i,n,o,a,s,l,c){var p=this;this.message=e,this.resolver=t,this.injector=r,this.modalService=i,this.uistate=n,this.expr=o,this.cdr=a,this.localeId=s,this.resources=l,this.localePipe=c,this.cls="farris-main-area flex-column",this.variableSetting=!1,this.closeModal=new b.EventEmitter,this.submitModal=new b.EventEmitter,this.variableSetEmitter=new b.EventEmitter,this.value=new Array,this.selectedValue=new Array,this.editorParams={},this.basicTypes=[{value:"String",text:this.localePipe.transform("component.processVariables.string")},{value:"Integer",text:this.localePipe.transform("component.processVariables.integer")},{value:"Decimal",text:this.localePipe.transform("component.processVariables.decimal")},{value:"Boolean",text:this.localePipe.transform("component.processVariables.boolean")}],this.tags=[{value:"constant",text:this.localePipe.transform("component.processVariables.constant")},{value:"expression",text:this.localePipe.transform("component.processVariables.expression")},{value:"component",text:this.localePipe.transform("component.processVariables.component")}],this.columns=[{field:"name",width:80,title:this.localePipe.transform("component.processVariables.name"),sortable:!0,editor:{type:g.EditorTypes.TEXTBOX,options:{}},validators:[{type:"required",messager:"必填"}]},{field:"documentation",width:80,title:this.localePipe.transform("component.processVariables.documentation"),sortable:!0,editor:{type:g.EditorTypes.TEXTBOX,options:{}},validators:[{type:"required",messager:"必填"}]},{field:"basicType",width:60,title:this.localePipe.transform("component.processVariables.basicType"),sortable:!0,formatter:{type:"enum",options:{valueField:"value",textField:"text",data:this.basicTypes}},editor:{type:g.EditorTypes.COMBOLIST,options:{valueField:"value",textField:"text",data:this.basicTypes,idField:"value",panelHeight:"auto",showClear:!1}},validators:[{type:"required",messager:"必填"}]},{field:"description",width:100,title:this.localePipe.transform("component.processVariables.description"),showTips:!0,editor:{type:g.EditorTypes.TEXTBOX,options:{}}},{field:"tag",width:60,title:this.localePipe.transform("component.processVariables.tag"),sortable:!0,formatter:{type:"enum",options:{valueField:"value",textField:"text",data:this.tags}},editor:{type:g.EditorTypes.COMBOLIST,options:{valueField:"value",textField:"text",data:this.tags,idField:"value",panelHeight:"auto",selectChange:function(t){p.value=p.value.map(function(e){return e.id===t.rowId&&(e.value=null,e.valueText=null,e.component)&&(e.component=null),e})},clear:function(t){p.value=p.value.map(function(e){return e.id===t.rowId&&(e.value=null,e.valueText=null,e.component)&&(e.component=null),e})}}}},{field:"valueText",width:120,title:this.localePipe.transform("component.processVariables.valueText"),showTips:!0,editor:{type:g.EditorTypes.TEXTBOX,options:{}}}],this.modalConfig={title:this.localePipe.transform("component.processVariables.processVariables"),width:1070,height:510,showButtons:!0},this.beforeEdit=function(e){var t=e.rowData;if("valueText"===e.column.field){if(!t.tag)return v.of(!1);t.tag===p.tags[0].value?e.column.editor={type:g.EditorTypes.TEXTBOX,options:{}}:e.column.editor={type:"input-group",options:{groupText:'<i class="f-icon f-icon-lookup"></i>',editable:!1,showClear:!1,clickHandle:function(e){e.formControl.setValue(e.instance.value||""),p.valueEdit(e)},clear:function(e){console.log("clear",e)}}}}return v.of(!0)},this.localePipe=this.localePipe||new x(s,l)}Cr.prototype.convertTo=function(e){return e&&0<e.length?this.localePipe.transform("component.processVariables.set"):this.localePipe.transform("component.processVariables.notSet")};var Pr=Cr;function Cr(e){this.localePipe=e}var Ir,Sr=function(){this.tag="constant",this.enable=!1,this.timeUnit="day",this.expireOperations=new Array},Er=function(){this.id=l.GenerateElementId(),this.durationType="BeforeDuration",this.timeDuration=0,this.timeUnit="day",this.operationTypeName="SendMessageExpireOperation"},Tr=(n(Ar,Ir=Er),Ar);function Ar(e,t){var r=Ir.call(this)||this;return r.localePipe=t,r.cycleEnable=!1,r.cycleTimeUnit="day",r.receiver="activity"===e?"workItemParticipant":"procInstCreator",r.receiverText="activity"===e?r.localePipe.transform("component.timeLimitControl.workItemParticipant"):r.localePipe.transform("component.timeLimitControl.procInstCreator"),r.subject='{"expr":"\''+r.localePipe.transform("component.timeLimitControl.SendMessageExpireOperation")+'\'","sexpr":""}',r.message='{"expr":"\''+("activity"===e?r.localePipe.transform("component.timeLimitControl.to-doMessageTimeOut"):r.localePipe.transform("component.timeLimitControl.messageTimeOut"))+'\'","sexpr":""}',r}n(Mr,kr=Er);var kr,Or=Mr;function Mr(e,t){var r=kr.call(this)||this;return r.localePipe=t,r.autoHandleType=e,r.message=r.localePipe.transform("component.timeLimitControl.agree"),r}var Dr=function(){this.smsMessageVariables=new Array},Nr=function(){this.tag="expression",this.id=l.createNM()},Lr=(Fr.prototype.ngOnInit=function(){var t=this;this.smsVariableCols=[{field:"code",width:80,title:this.localePipe.transform("component.smsMessageTemplate.code"),editor:{type:g.EditorTypes.TEXTBOX,options:{}}},{field:"value",width:100,title:this.localePipe.transform("component.smsMessageTemplate.value"),showTips:!0,editor:{type:"input-group",options:{groupText:'<i class="f-icon f-icon-lookup"></i>',editable:!1,clickHandle:function(e){e.formControl.setValue(e.instance.value||""),t.showExprHelp(e)},clear:function(e){console.log("clear",e)}}}}],console.log(this.smsMessageTemplate)},Fr.prototype.addSmsVariable=function(){var e=new Nr;this.smsMessageTemplate.smsMessageVariables.push(e),this.grid.loadData(this.smsMessageTemplate.smsMessageVariables)},Fr.prototype.deleteSmsVariable=function(){this.endGridEdit();var e,t=this.grid.selectedRow;t?-1<(e=this.smsMessageTemplate.smsMessageVariables.findIndex(function(e){return e.id===t.id}))&&(this.smsMessageTemplate.smsMessageVariables.splice(e,1),this.grid.loadData(this.smsMessageTemplate.smsMessageVariables)):this.message.info(this.localePipe.transform("component.smsMessageTemplate.noRowsSelected"))},Fr.prototype.endGridEdit=function(){this.grid.endCellEdit()},Fr.prototype.showExprHelp=function(t){var e,r,i,n,o,a,s=this;if(0<this.designerState.schemas.length){try{for(var l=ue(this.designerState.schemas),c=l.next();!c.done;c=l.next()){var p=c.value;this.expr.addSchema("Schema",p)}}catch(g){e={error:g}}finally{try{c&&!c.done&&(a=l["return"])&&a.call(l)}finally{if(e)throw e.error}}this.designerState.schemas[0].entityTypes&&0<this.designerState.schemas[0].entityTypes.length&&(a=this.designerState.schemas[0].entityTypes[0],this.expr.addInjectedEntity(a.name,"Schema",a.name,D.InjectedType.EntityType))}var d=new Array,d=this.designerState.addContext(d);if(0<this.designerState.subActivityContext.length)try{for(var u=ue(this.designerState.subActivityContext),m=u.next();!m.done;m=u.next())!function(t){d.some(function(e){return e.key===t.key})||d.push(t)}(m.value)}catch(v){r={error:v}}finally{try{m&&!m.done&&(i=u["return"])&&i.call(u)}finally{if(r)throw r.error}}if(0<d.length)try{for(var f=ue(d),h=f.next();!h.done;h=f.next()){var y=h.value;this.expr.addContext(y)}}catch(b){n={error:b}}finally{try{h&&!h.done&&(o=f["return"])&&o.call(f)}finally{if(n)throw n.error}}this.expr.setEditPattern(D.ExprEditMode.Advanced),this.expr.addExpressionText(t.instance.value),this.expr.buildExpression().then(function(e){t.formControl.setValue(e),t.instance.cd.detectChanges(),0<d.length&&(s.expr.exprEntity.contextEntities=s.expr.exprEntity.contextEntities.filter(function(t){return!d.some(function(e){return e.key===t.key})}))})},Fr.decorators=[{type:b.Component,args:[{selector:"lib-sms-message-template",template:'<div class="w-100">\r\n  <farris-section class="py-0 " [enableAccordion]="\'\'" [enableMaximize]="false">\r\n    <ng-template farrisSectionHeader>\r\n      <div class="f-title">\r\n        <h4 class="f-title-text">{{\'component.smsMessageTemplate.smsMessageTemplate\'|wfLocale}}</h4>\r\n        <span farrisPopover class="f-icon f-icon-message_help" style="color:#FBB902" [container]="\'body\'"\r\n          [triggers]="\'hover\'" [placement]="\'right\'" [popover]="poptmpl">\r\n        </span>\r\n        <ng-template #poptmpl let-infos>\r\n          <div style="padding:10px 10px 10px 10px;font-size: 12px;color: black;width: 260px;">\r\n            <h4 style="font-weight: 600;font-size: 16px;color: saddlebrown;">{{\'component.smsMessageTemplate.smsMessageTemplate\'|wfLocale}}</h4>\r\n            <p style="margin: 0 0 10px;">{{\'component.smsMessageTemplate.tips1\'|wfLocale}}</p>\r\n            <h4 style="font-weight: 600;font-size: 16px;color: saddlebrown;">{{\'component.smsMessageTemplate.smsTemplateNumber\'|wfLocale}}</h4>\r\n            <p style="margin: 0 0 10px;">{{\'component.smsMessageTemplate.tips2\'|wfLocale}}</p>\r\n            \x3c!-- <h4 style="font-weight: 600;font-size: 16px;color: saddlebrown;">短信模板内容</h4>\r\n            <p style="margin: 0 0 10px;">{{smsTemplateContent}}</p> --\x3e\r\n            <h4 style="font-weight: 600;font-size: 16px;color: saddlebrown;">{{\'component.smsMessageTemplate.smsVariableBinding\'|wfLocale}}</h4>\r\n            <p style="margin: 0 0 10px;">{{\'component.smsMessageTemplate.tips3\'|wfLocale}}</p>\r\n          </div>\r\n        </ng-template>\r\n      </div>\r\n    </ng-template>\r\n    <div class="f-form-layout farris-form  farris-form-controls-inline f-form-lable-auto farris-form-auto">\r\n      <div class="col-12">\r\n        <div class="farris-group-wrap">\r\n          <div class="form-group farris-form-group">\r\n            <label class="col-form-label">\r\n              <span class="farris-label-info text-danger">*</span>\r\n              <span class="farris-label-text">{{\'component.smsMessageTemplate.smsTemplateNumber\'|wfLocale}}</span>\r\n            </label>\r\n            <div class="farris-input-wrap ml-1">\r\n              <input [(ngModel)]="smsMessageTemplate.code" class="form-control" name="tempCode" type="text">\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      \x3c!-- <div class="col-12">\r\n        <div class="farris-group-wrap">\r\n          <div class="form-group farris-form-group">\r\n            <label class="col-form-label">\r\n              <span class="farris-label-info text-danger" style="visibility: hidden;">*</span>\r\n              <span class="farris-label-text">短信模板内容</span>\r\n            </label>\r\n            <div class="farris-input-wrap ml-1">\r\n              <textarea [(ngModel)]="smsMessageTemplate.content"  class="form-control " cols="10" id="textobj" name="tempText" rows="3"> </textarea>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div> --\x3e\r\n    </div>\r\n  </farris-section>\r\n</div>\r\n<div class="w-100">\r\n  <farris-section class="pt-0 f-section-grid f-section-in-managelist"\r\n    enableAccordion="{{\'component.smsMessageTemplate.smsTemplateNumber\'|wfLocale}}" [enableMaximize]="false" [mainTitle]="\'\'">\r\n    \x3c!-- <ng-template farrisSectionTitle>\r\n      <div class="farris-label-text">短信变量绑定</div>\r\n    </ng-template> --\x3e\r\n    <ng-template farrisSectionToolbar>\r\n      <farris-button [type]="\'link\'" (click)="addSmsVariable()">\r\n        <span class="f-icon f-icon-add"></span>\r\n        {{\'component.smsMessageTemplate.addSmsVariable\'|wfLocale}}</farris-button>\r\n      <farris-button [type]="\'link\'" (click)="deleteSmsVariable()">\r\n        <span class="f-icon f-icon-delete"></span>\r\n        {{\'component.smsMessageTemplate.deleteSmsVariable\'|wfLocale}}</farris-button>\r\n    </ng-template>\r\n    <div style="height: 180px">\r\n      <farris-datagrid #grid [data]="smsMessageTemplate.smsMessageVariables" [idField]="\'id\'" [columns]="smsVariableCols"\r\n        [fit]="true" [fitColumns]="true" [editable]="true" [editMode]="\'cell\'" [pagination]="false"\r\n        [showLineNumber]="true" [showCheckbox]="false" [multiSelect]="false">\r\n      </farris-datagrid>\r\n    </div>\r\n  </farris-section>\r\n</div>\r\n',providers:[x],styles:[""]}]}],Fr.ctorParameters=function(){return[{type:a},{type:D.ExpressionService},{type:r.MessagerService},{type:b.ChangeDetectorRef,decorators:[{type:b.Optional}]},{type:String,decorators:[{type:b.Inject,args:[b.LOCALE_ID]}]},{type:undefined,decorators:[{type:b.Inject,args:[o]}]},{type:x,decorators:[{type:b.Optional}]}]},Fr.propDecorators={grid:[{type:b.ViewChild,args:["grid"]}],smsMessageTemplate:[{type:b.Input}]},Fr);function Fr(e,t,r,i,n,o,a){this.designerState=e,this.expr=t,this.message=r,this.cdr=i,this.localeId=n,this.resources=o,this.localePipe=a,this.smsVariableList=new Array,this.smsVariableCols=new Array,this.smsTemplateContent=this.localePipe.transform("component.smsMessageTemplate.smsTemplateContent"),this.localePipe=this.localePipe||new x(n,o),this.smsMessageTemplate=new Dr}Object.defineProperty(Vr.prototype,"value",{get:function(){return this.operation},set:function(e){var t,r,i,n,o;if((this.operation=JSON.parse(JSON.stringify(e)),this.operation.sendType===undefined&&(e=new Tr(this.location,this.localePipe),this.operation.cycleEnable=e.cycleEnable,this.operation.cycleTimeUnit=e.cycleTimeUnit,this.operation.receiver=e.receiver,this.operation.subject=e.subject,this.operation.message=e.message),this.operation.receiver&&0<this.operation.receiver.length)&&(-1<(o=this.operation.receiver.split(",")).indexOf("workItemParticipant")&&(this.receiverVari="workItemParticipant",this.activityReceiverVar+="workItemParticipant,"),-1<o.indexOf("procInstCreator")&&(this.receiverVari="procInstCreator",this.activityReceiverVar+="procInstCreator,"),-1<o.indexOf("preActExecutors")&&(this.activityReceiverVar+="preActExecutors,"),0<this.activityReceiverVar.length&&(this.activityReceiverVar=this.activityReceiverVar.substring(0,this.activityReceiverVar.length-1)),0<o.length)){o=o.filter(function(e){return"procInstCreator"!==e}),this.bindingData.id="";try{for(var a=ue(o),s=a.next();!s.done;s=a.next()){var l=s.value;this.bindingData.id+=l+","}}catch(d){t={error:d}}finally{try{s&&!s.done&&(r=a["return"])&&r.call(a)}finally{if(t)throw t.error}}this.bindingData.id&&(this.bindingData.id=this.bindingData.id.substring(0,this.bindingData.id.length-1))}if(this.operation.receiverText&&0<this.operation.receiverText.length&&0<(o=this.operation.receiverText.split(",")).length){o=o.filter(function(e){return"流程发起人"!==e}),this.bindingData.name="";try{for(var c=ue(o),p=c.next();!p.done;p=c.next()){l=p.value;this.bindingData.name+=l+","}}catch(u){i={error:u}}finally{try{p&&!p.done&&(n=c["return"])&&n.call(c)}finally{if(i)throw i.error}}this.bindingData.name&&(this.bindingData.name=this.bindingData.name.substring(0,this.bindingData.name.length-1))}this.hasSmsMessage(this.operation.sendType)&&(this.hasSmsTemplate=!0,this.operation.smsMessageTemplate||(this.operation.smsMessageTemplate=new Dr))},enumerable:!0,configurable:!0}),Vr.prototype.ngOnInit=function(){},Vr.prototype.contentExpr=function(e){this.showContentHelp(e)},Vr.prototype.titleExpr=function(e){this.showTitleHelp(e)},Vr.prototype.showContentHelp=function(e){var t=this,r=this.showExpr();this.operation.message&&0<this.operation.message.length?this.operation.message.startsWith('{"expr":"')?this.expr.addExpressionText(this.operation.message):this.expr.addExpressionText("'"+this.operation.message+"'"):this.expr.addExpressionText(""),this.expr.buildExpression().then(function(e){t.operation.message=e,0<r.length&&(t.expr.exprEntity.contextEntities=t.expr.exprEntity.contextEntities.filter(function(t){return!r.some(function(e){return e.key===t.key})}))})},Vr.prototype.showTitleHelp=function(e){var t=this,r=this.showExpr();this.operation.subject&&0<this.operation.subject.length?this.operation.subject.startsWith('{"expr":"')?this.expr.addExpressionText(this.operation.subject):this.expr.addExpressionText("'"+this.operation.subject+"'"):this.expr.addExpressionText(""),this.expr.buildExpression().then(function(e){t.operation.subject=e,0<r.length&&(t.expr.exprEntity.contextEntities=t.expr.exprEntity.contextEntities.filter(function(t){return!r.some(function(e){return e.key===t.key})}))})},Vr.prototype.clickOK=function(){this.SmsTemplate&&this.SmsTemplate.endGridEdit(),this.operation.cycleTime+="","process"===this.location&&this.setReceiver(),"activity"===this.location&&this.setActivityReceiver(),this.hasSmsTemplate?(this.operation.smsMessageTemplate=this.SmsTemplate.smsMessageTemplate,this.operation.smsMessageTemplate.smsMessageVariables&&0<this.operation.smsMessageTemplate.smsMessageVariables.length&&(this.operation.smsMessageTemplate.smsMessageVariables=this.operation.smsMessageTemplate.smsMessageVariables.filter(function(e){return e.code}))):this.operation.smsMessageTemplate=null,this.validator()&&this.submitEmitter.emit(this.operation)},Vr.prototype.clickCancel=function(){this.closeEmitter.emit()},Vr.prototype.clear=function(){this.bindingData={}},Vr.prototype.sendTypeChange=function(e){this.hasSmsMessage(e)?(this.hasSmsTemplate=!0,this.operation.smsMessageTemplate||(this.operation.smsMessageTemplate=new Dr)):(this.hasSmsTemplate=!1,this.operation.smsMessageTemplate=null)},Vr.prototype.setReceiver=function(){var e,t,r="",i="";if(this.receiverVari){r+=this.receiverVari+",";var n=this.receiverVari.split(",");if(0<n.length){var o=this;try{for(var a=ue(n),s=a.next();!s.done;s=a.next())!function(t){var e=o.receiverVariables.find(function(e){return e.value===t}).name;i+=e+","}(s.value)}catch(l){e={error:l}}finally{try{s&&!s.done&&(t=a["return"])&&t.call(a)}finally{if(e)throw e.error}}}}this.bindingData.id&&(r+=this.bindingData.id+",",i+=this.bindingData.name+","),r=r&&r.substring(0,r.length-1),i=i&&i.substring(0,i.length-1),this.operation.receiver=r,this.operation.receiverText=i},Vr.prototype.setActivityReceiver=function(){var e="";this.activityReceiverVar&&(e+=this.activityReceiverVar+","),e=e&&e.substring(0,e.length-1),this.operation.receiver=e},Vr.prototype.validator=function(){return this.operation.cycleEnable&&"undefined"===this.operation.cycleTime?(this.message.info(this.localePipe.transform("component.sendMessageOperation.cycleTimeNotEmpty")),!1):this.operation.sendType?this.operation.subject?this.operation.message?!!this.operation.receiver||(this.message.info(this.localePipe.transform("component.sendMessageOperation.recipientNotEmpty")),!1):(this.message.info(this.localePipe.transform("component.sendMessageOperation.contentNotEmpty")),!1):(this.message.info(this.localePipe.transform("component.sendMessageOperation.subjectNotEmpty")),!1):(this.message.info(this.localePipe.transform("component.sendMessageOperation.sendMethodNotEmpty")),!1)},Vr.prototype.hasSmsMessage=function(e){var r=this;return!!e&&!!e.split(",").find(function(t){return r.uistate.messageChannels.find(function(e){return e.code==t&&"Sms"==e.channelType})})},Vr.prototype.showExpr=function(){var e,t,r,i,n,o,a,s,l,c;if(0<this.uistate.schemas.length){try{for(var p=ue(this.uistate.schemas),d=p.next();!d.done;d=p.next()){var u=d.value;this.expr.addSchema("Schema",u)}}catch(I){e={error:I}}finally{try{d&&!d.done&&(c=p["return"])&&c.call(p)}finally{if(e)throw e.error}}this.uistate.schemas[0].entityTypes&&0<this.uistate.schemas[0].entityTypes.length&&(c=this.uistate.schemas[0].entityTypes[0],this.expr.addInjectedEntity(c.name,"Schema",c.name,D.InjectedType.EntityType))}var m=new Array;if(0<this.uistate.procInstContext.length)try{for(var f=ue(this.uistate.procInstContext),h=f.next();!h.done;h=f.next()){var y=h.value;m.push(y)}}catch(S){t={error:S}}finally{try{h&&!h.done&&(r=f["return"])&&r.call(f)}finally{if(t)throw t.error}}if(0<this.uistate.processVariableContext.length)try{for(var g=ue(this.uistate.processVariableContext),v=g.next();!v.done;v=g.next())!function(t){m.some(function(e){return e.key===t.key})||m.push(t)}(y=v.value)}catch(E){i={error:E}}finally{try{v&&!v.done&&(n=g["return"])&&n.call(g)}finally{if(i)throw i.error}}if(0<this.uistate.subActivityContext.length)try{for(var b=ue(this.uistate.subActivityContext),x=b.next();!x.done;x=b.next())!function(t){m.some(function(e){return e.key===t.key})||m.push(t)}(y=x.value)}catch(T){o={error:T}}finally{try{x&&!x.done&&(a=b["return"])&&a.call(b)}finally{if(o)throw o.error}}if(0<m.length)try{for(var w=ue(m),P=w.next();!P.done;P=w.next()){var C=P.value;this.expr.addContext(C)}}catch(A){s={error:A}}finally{try{P&&!P.done&&(l=w["return"])&&l.call(w)}finally{if(s)throw s.error}}return m},Vr.decorators=[{type:b.Component,args:[{selector:"lib-send-message-operation",template:'<div class="f-page">\r\n  <div class="f-utils-fill-flex-column h-100">\r\n    <perfect-scrollbar [config]="{}">\r\n      <form class="h-100">\r\n        <div class="f-form-layout farris-form farris-form-controls-inline farris-form-auto" style="padding-right: 0.875rem; padding-left: 0.875rem;">\r\n          <div class="col-12 mt-2">\r\n            <div class="farris-group-wrap">\r\n              <div class="form-group">\r\n                <label class="col-form-label pl-1 mr-3">\r\n                  <span class="farris-label-text">{{\'component.sendMessageOperation.cycleEnable\' | wfLocale}}</span>\r\n                </label>\r\n                <div class="farris-input-wrap mr-5">\r\n                  <farris-switch [(ngModel)]="operation.cycleEnable" name="cycleEnable"></farris-switch>\r\n                  <div class="farris-feedback valid-feedback"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class="col-7 mt-2 pr-1">\r\n            <div class="farris-group-wrap">\r\n              <div class="form-group" style="width: 100%;">\r\n                <label class="col-form-label pl-1 mr-3">\r\n                  <span class="farris-label-info text-danger">*</span>\r\n                  <span class="farris-label-text">{{\'component.sendMessageOperation.cycleTime\' | wfLocale}}</span>\r\n                </label>\r\n                <div class="farris-input-wrap mr-1" style="width: 35%;">\r\n                  <farris-number-spinner [(ngModel)]="operation.cycleTime" name="cycleTime"\r\n                                          [editable]="true" [precision]="0" [parser]="parser"\r\n                                          [min]="0"></farris-number-spinner>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class="col-3 mt-2 pl-1">\r\n            <div class="farris-group-wrap">\r\n              <div class="form-group" style="width: 100%;">\r\n                <div class="farris-input-wrap mr-5" style="width: 30%;">\r\n                  <farris-combo-list [(ngModel)]="operation.cycleTimeUnit" name="cycleTimeUnit" [idField]="\'value\'" [textField]="\'text\'"\r\n                                      [valueField]="\'value\'" [data]="timeUnitCollection" [panelHeight]="\'auto\'"\r\n                                      [editable]="false" [enableClear]="false">\r\n                  </farris-combo-list>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class="col-12 mt-2">\r\n            <div class="farris-group-wrap">\r\n              <div class="form-group farris-form-group">\r\n                <label class="col-form-label">\r\n                  <span class="farris-label-info text-danger">*</span>\r\n                  <span class="farris-label-text">{{\'component.sendMessageOperation.sendType\' | wfLocale}}</span>\r\n                </label>\r\n                <div class="farris-input-wrap ml-1">\r\n                  <farris-checkboxgroup #checkboxGroup [(ngModel)]="operation.sendType" name="sendType" [horizontal]="true"\r\n                    [data]="typeGroup" (changeValue)="sendTypeChange($event)">\r\n                  </farris-checkboxgroup>\r\n                  <div class="farris-feedback valid-feedback"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class="col-12 mt-2">\r\n            <div class="farris-group-wrap">\r\n              <div class="form-group farris-form-group">\r\n                <label class="col-form-label">\r\n                  <span class="farris-label-info text-danger">*</span>\r\n                  <span class="farris-label-text">{{\'component.sendMessageOperation.subject\' | wfLocale}}</span>\r\n                </label>\r\n                <div class="farris-input-wrap ml-1">\r\n                    <input-group [editable]="false" [enableClear]="false" [customCls]="\'custom-cls\'" [groupText]="groupIcon2"\r\n                    [(value)]="operation.subject" (clickHandle)="titleExpr($event)">\r\n                    </input-group>\r\n                  <div class="farris-feedback valid-feedback"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class="col-12 mt-2">\r\n            <div class="farris-group-wrap">\r\n              <div class="form-group farris-form-group">\r\n                <label class="col-form-label">\r\n                  <span class="farris-label-info text-danger">*</span>\r\n                  <span class="farris-label-text">{{\'component.sendMessageOperation.message\' | wfLocale}}</span>\r\n                </label>\r\n                <div class="farris-input-wrap ml-1">\r\n                    <input-group [editable]="false" [enableClear]="false" [customCls]="\'custom-cls\'" [groupText]="groupIcon2"\r\n                    [(value)]="operation.message" (clickHandle)="contentExpr($event)">\r\n                    </input-group>\r\n                  <div class="farris-feedback valid-feedback"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class="col-12 mt-2">\r\n            <div *ngIf="location===\'process\'" class="farris-group-wrap">\r\n              <div class="form-group farris-form-group">\r\n                <label class="col-form-label">\r\n                  <span class="farris-label-info text-danger">*</span>\r\n                  <span class="farris-label-text">{{\'component.sendMessageOperation.receiverVari\' | wfLocale}}</span>\r\n                </label>\r\n                <div class="farris-input-wrap ml-1">\r\n                  <div class="pb-2">\r\n                    <farris-checkboxgroup #receiverVariable [(ngModel)]="receiverVari" name="receiverVariable"\r\n                      [horizontal]="true" [data]="receiverVariables">\r\n                    </farris-checkboxgroup>\r\n                  </div>\r\n                  <div>\r\n                    <sys-farris-grid-lookup #userHelp [singleSelect]="false" [displayTxt]="bindingData.name" [pagination]="true"\r\n                      [pageSize]="20" title="{{\'component.sendMessageOperation.sysUsers\' | wfLocale}}" [sourceType]="\'user\'" [bindingData]="bindingData"\r\n                      [filter]="{notGetCurrentUser:false, notGetStopUser:true}" [typeMode]="1" (clear)="clear()">\r\n                    </sys-farris-grid-lookup>\r\n                  </div>\r\n                  <div class="farris-feedback valid-feedback"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div *ngIf="location===\'activity\'" class="farris-group-wrap">\r\n              <div class="form-group farris-form-group">\r\n                <label class="col-form-label">\r\n                  <span class="farris-label-info text-danger">*</span>\r\n                  <span class="farris-label-text">{{\'component.sendMessageOperation.receiverVari\' | wfLocale}}</span>\r\n                </label>\r\n                <div class="farris-input-wrap ml-1">\r\n                  <div class="pb-2">\r\n                    <farris-checkboxgroup #receiverVariable1 [(ngModel)]="activityReceiverVar" name="ActivityReceiverVariable"\r\n                                          [horizontal]="true" [data]="activityReceiverVariables">\r\n                    </farris-checkboxgroup>\r\n                  </div>\r\n                  <div class="farris-feedback valid-feedback"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <lib-sms-message-template *ngIf="hasSmsTemplate" [smsMessageTemplate]="operation.smsMessageTemplate"></lib-sms-message-template>\r\n      </form>\r\n    </perfect-scrollbar>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #footer>\r\n  <button type="button" class="btn btn-secondary btn-sm mx-2" (click)="clickCancel()">{{\'component.sendMessageOperation.clickCancel\' | wfLocale}}</button>\r\n  <button type="button" class="btn btn-primary btn-sm mx-2" (click)="clickOK()">{{\'component.sendMessageOperation.clickOK\' | wfLocale}}</button>\r\n</ng-template>\r\n',providers:[x],styles:[""]}]}],Vr.ctorParameters=function(){return[{type:b.Injector},{type:r.MessagerService},{type:a},{type:b.ChangeDetectorRef,decorators:[{type:b.Optional}]},{type:String,decorators:[{type:b.Inject,args:[b.LOCALE_ID]}]},{type:undefined,decorators:[{type:b.Inject,args:[o]}]},{type:x,decorators:[{type:b.Optional}]},{type:D.ExpressionService}]},Vr.propDecorators={footer:[{type:b.ViewChild,args:["footer"]}],SmsTemplate:[{type:b.ViewChild,args:[Lr]}],value:[{type:b.Input}],closeEmitter:[{type:b.Output}],submitEmitter:[{type:b.Output}]};var Rr=Vr;function Vr(e,t,r,i,n,o,a,s){this.injector=e,this.message=t,this.uistate=r,this.cdr=i,this.localeId=n,this.resources=o,this.localePipe=a,this.expr=s,this.groupIcon2='<i class="f-icon f-icon-lookup"></i>',this.operation=new Tr("activity",this.localePipe),this.closeEmitter=new b.EventEmitter,this.submitEmitter=new b.EventEmitter,this.typeGroup=this.uistate.messageChannels.map(function(e){return{value:e.code,name:e.name}}),this.receiverVariables=[{value:"procInstCreator",name:this.localePipe.transform("component.sendMessageOperation.procInstCreator")}],this.activityReceiverVariables=[{value:"workItemParticipant",name:this.localePipe.transform("component.sendMessageOperation.workItemParticipant")},{value:"procInstCreator",name:this.localePipe.transform("component.sendMessageOperation.procInstCreator")},{value:"preActExecutors",name:this.localePipe.transform("component.sendMessageOperation.preActExecutors")}],this.placeholder="",this.placeholder2="",this.hasSmsTemplate=!1,this.parser=function(e){return Number(e)},this.timeUnitCollection=[{value:"day",text:this.localePipe.transform("component.sendMessageOperation.day")},{value:"hour",text:this.localePipe.transform("component.sendMessageOperation.hour")},{value:"minute",text:this.localePipe.transform("component.sendMessageOperation.minute")}],this.location="activity",this.activityReceiverVar="",this.bindingData={}}Object.defineProperty(Br.prototype,"value",{get:function(){return this.operation},set:function(e){this.operation=Object.assign({},e),this.operation.autoHandleType===undefined&&(e=new Or(this.autoHandleType[0].value,this.localePipe),this.operation.autoHandleType=e.autoHandleType,this.operation.message=e.message)},enumerable:!0,configurable:!0}),Br.prototype.ngOnInit=function(){},Br.prototype.clickOK=function(){this.validator()&&this.submitEmitter.emit(this.operation)},Br.prototype.clickCancel=function(){this.closeEmitter.emit()},Br.prototype.validator=function(){return this.operation.message?!!this.operation.autoHandleType||(this.message.info(this.localePipe.transform("component.sendMessageOperation.processingNotEmpty")),!1):(this.message.info(this.localePipe.transform("component.sendMessageOperation.opinionsNotEmpty")),!1)},Br.decorators=[{type:b.Component,args:[{selector:"lib-auto-handle-operation",template:'<div class="f-page">\r\n  <div class="f-utils-fill-flex-column farris-split-section m-2 h-100">\r\n    <section class="f-utils-fill-flex-column h-100">\r\n      <div class="f-section-header pt-2 mx-2">\r\n        <div class="f-title">\r\n          <h4 class="f-title-text">{{\'component.sendMessageOperation.automaticProcessSet\' | wfLocale}}</h4>\r\n        </div>\r\n      </div>\r\n      <div class="f-utils-fill-flex-column h-100">\r\n        <perfect-scrollbar [config]="{}">\r\n          <form class="h-100">\r\n            <div class="farris-form form-inline farris-form-inline">\r\n              <div class="farris-group-wrap">\r\n                <div class="form-group farris-form-group">\r\n                  <label class="col-form-label">\r\n                    <span class="farris-label-info text-danger">*</span>\r\n                    <span class="farris-label-text">{{\'component.sendMessageOperation.automaticProcessMethod\' | wfLocale}}</span>\r\n                  </label>\r\n                  <div class="farris-input-wrap ml-1">\r\n                    <farris-combo-list [(ngModel)]="operation.autoHandleType" name="cycleTimeUnit" [idField]="\'value\'" [textField]="\'text\'"\r\n                                       [valueField]="\'value\'" [data]="autoHandleType" [panelHeight]="\'auto\'"\r\n                                       [editable]="false" [enableClear]="false">\r\n                    </farris-combo-list>\r\n                    <div class="farris-feedback valid-feedback"></div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <div class="farris-group-wrap my-3">\r\n                <div class="form-group farris-form-group">\r\n                  <label class="col-form-label">\r\n                    <span class="farris-label-info text-danger">*</span>\r\n                    <span class="farris-label-text">{{\'component.sendMessageOperation.automaticOpinionHandle\' | wfLocale}}</span>\r\n                  </label>\r\n                  <div class="farris-input-wrap ml-1">\r\n                    <textarea class="form-control" type="text" value="message" [(ngModel)]="operation.message" name="message"\r\n                              [placeholder]="placeholder" style="height: 100px;"></textarea>\r\n                    <div class="farris-feedback valid-feedback"></div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </form>\r\n        </perfect-scrollbar>\r\n      </div>\r\n    </section>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #footer>\r\n  <button type="button" class="btn btn-secondary btn-sm mx-2" (click)="clickCancel()">{{\'component.sendMessageOperation.clickCancel\' | wfLocale}}</button>\r\n  <button type="button" class="btn btn-primary btn-sm mx-2" (click)="clickOK()">{{\'component.sendMessageOperation.clickOK\' | wfLocale}}</button>\r\n</ng-template>\r\n',providers:[x],styles:[""]}]}],Br.ctorParameters=function(){return[{type:r.MessagerService},{type:a},{type:b.ChangeDetectorRef,decorators:[{type:b.Optional}]},{type:String,decorators:[{type:b.Inject,args:[b.LOCALE_ID]}]},{type:undefined,decorators:[{type:b.Inject,args:[o]}]},{type:x,decorators:[{type:b.Optional}]}]},Br.propDecorators={footer:[{type:b.ViewChild,args:["footer"]}],value:[{type:b.Input}],submitEmitter:[{type:b.Output}],closeEmitter:[{type:b.Output}]};var zr=Br;function Br(e,t,r,i,n,o){var a,s;this.message=e,this.uiState=t,this.cdr=r,this.localeId=i,this.resources=n,this.localePipe=o,this.placeholder="",this.operation=new Or("Pass",this.localePipe),this.submitEmitter=new b.EventEmitter,this.closeEmitter=new b.EventEmitter,this.autoHandleType=[],this.localePipe=this.localePipe||new x(i,n);try{for(var l=ue(this.uiState.propertyData.ApprovalItems),c=l.next();!c.done;c=l.next()){var p=c.value;this.autoHandleType.push({value:p.Value,text:p.Text})}}catch(d){a={error:d}}finally{try{c&&!c.done&&(s=l["return"])&&s.call(l)}finally{if(a)throw a.error}}}Object.defineProperty(jr.prototype,"value",{set:function(e){var t,r;this.timeLimitInfo=e||new Sr;try{for(var i=ue(this.timeLimitInfo.expireOperations),n=i.next();!n.done;n=i.next()){var o=n.value;o.operationTypeName===undefined&&(o.operationTypeName="SendMessageExpireOperation")}}catch(a){t={error:a}}finally{try{n&&!n.done&&(r=i["return"])&&r.call(i)}finally{if(t)throw t.error}}},enumerable:!0,configurable:!0}),jr.prototype.ngOnInit=function(){this.location=this.editorParams.location,"activity"===this.location?this.operationTypeName=this.activityOperationTypeName:this.operationTypeName=this.processOperationTypeName,this.cols=[{field:"durationType",width:80,title:this.localePipe.transform("component.timeLimitControl.durationType"),formatter:{type:"enum",options:{valueField:"value",textField:"text",data:this.durationTypeCollection}},editor:{type:g.EditorTypes.COMBOLIST,options:{valueField:"value",textField:"text",data:this.durationTypeCollection,idField:"value",panelHeight:"auto",valueChange:this.durationTypeChange,showClear:!1}},validators:[{type:"required",messager:"必填"}]},{field:"timeDuration",width:60,title:this.localePipe.transform("component.timeLimitControl.timeDuration"),editor:{type:g.EditorTypes.NUMBERBOX,options:{min:0}},validators:[{type:"required",messager:"必填"}]},{field:"timeUnit",width:60,title:this.localePipe.transform("component.timeLimitControl.timeUnit"),formatter:{type:"enum",options:{valueField:"value",textField:"text",data:this.timeUnitCollection}},editor:{type:g.EditorTypes.COMBOLIST,options:{valueField:"value",textField:"text",data:this.timeUnitCollection,idField:"value",panelHeight:"auto"}},validators:[{type:"required",messager:"必填"}]},{field:"operationTypeName",width:100,title:this.localePipe.transform("component.timeLimitControl.operationTypeName"),formatter:{type:"enum",options:{valueField:"value",textField:"text",data:this.operationTypeName}},editor:{type:g.EditorTypes.COMBOLIST,options:{valueField:"value",textField:"text",data:this.operationTypeName,idField:"value",panelHeight:"auto"}},validators:[{type:"required",messager:"必填"}]},{field:"sendType",width:80,title:this.localePipe.transform("component.timeLimitControl.sendType"),template:this.cell,validators:[{type:"required",messager:"必填"}]}]},jr.prototype.clickOK=function(){var e;this.grid.endCellEdit(),this.timeLimitInfo.dueTime+="",this.validator()&&(e={value:this.timeLimitInfo,parameters:null},this.submitModal.emit(e))},jr.prototype.clickCancel=function(){this.closeModal.emit()},jr.prototype.validator=function(){var e,t;if(-1<this.timeLimitInfo.dueTime.indexOf("."))return console.log(this.timeLimitInfo.dueTime),this.message.info(this.localePipe.transform("component.timeLimitControl.onlyBeInteger")),!1;if(this.timeLimitInfo.expireOperations&&0<this.timeLimitInfo.expireOperations.length)try{for(var r=ue(this.timeLimitInfo.expireOperations),i=r.next();!i.done;i=r.next()){var n,o=i.value;if("SendMessageExpireOperation"===o.operationTypeName)if(!(n=o).sendType)return this.message.info(this.localePipe.transform("component.timeLimitControl.setOperation")),!1;if("AutoHandleExpireOperation"===o.operationTypeName){if(!(n=o).autoHandleType)return this.message.info(this.localePipe.transform("component.timeLimitControl.setType")),!1;if(!n.message)return this.message.info(this.localePipe.transform("component.timeLimitControl.setComments")),!1}"OnDuration"===o.durationType&&0!==o.timeDuration&&(o.timeDuration=0)}}catch(a){e={error:a}}finally{try{i&&!i.done&&(t=r["return"])&&t.call(r)}finally{if(e)throw e.error}}return!0},jr.prototype.add=function(){var e=new Er;this.timeLimitInfo.expireOperations.push(e),this.grid.loadData(this.timeLimitInfo.expireOperations),this.grid.selectRow(e.id)},jr.prototype.remove=function(){this.grid.endCellEdit();var e,t=this.grid.selectedRow;t?-1<(e=this.timeLimitInfo.expireOperations.findIndex(function(e){return e.id===t.data.id}))&&(this.timeLimitInfo.expireOperations.splice(e,1),this.grid.loadData(this.timeLimitInfo.expireOperations)):this.message.info(this.localePipe.transform("component.timeLimitControl.selectedOperation"))},jr.prototype.editOperation=function(t){var r=this;this.grid.endCellEdit(),"SendMessageExpireOperation"===t.rowData.operationTypeName&&this.sendMassageOperation(t),"AutoHandleExpireOperation"===t.rowData.operationTypeName&&this.message.confirm(this.localePipe.transform("component.timeLimitControl.notSupportAutomatic")).subscribe(function(e){return!0===e?r.autoHandleOperation(t):null})},jr.prototype.sendMassageOperation=function(e){var r=this,t=this.resolver.resolveComponentFactory(Rr).create(this.injector),e=(t.instance.location=this.location,t.instance.value=Object.assign({},e.rowData),t.instance.submitEmitter.subscribe(function(t){var e=r.timeLimitInfo.expireOperations.find(function(e){return e.id===t.id});Object.assign(e,t);i.close()}),t.instance.closeEmitter.subscribe(function(e){i.close()}),{title:this.localePipe.transform("component.timeLimitControl.warningMessage"),width:800,height:515,buttons:t.instance.footer,showButtons:!0}),i=this.modalService.show(t,e)},jr.prototype.autoHandleOperation=function(e){var r=this,t=this.resolver.resolveComponentFactory(zr).create(this.injector),e=(t.instance.value=Object.assign({},e.rowData),t.instance.submitEmitter.subscribe(function(t){var e=r.timeLimitInfo.expireOperations.find(function(e){return e.id===t.id});Object.assign(e,t);i.close()}),t.instance.closeEmitter.subscribe(function(e){i.close()}),{title:this.localePipe.transform("component.timeLimitControl.automaticProcessing"),width:500,height:"activity"===this.location?390:460,buttons:t.instance.footer,showButtons:!0}),i=this.modalService.show(t,e)},jr.prototype.tagSelectChange=function(e){"constant"===e.data.value?this.timeLimitInfo.timeUnit="day":"scope"===e.data.value&&(this.timeLimitInfo.timeUnit="",this.timeLimitInfo.dueTime=this.timeScopeValue)},jr.prototype.changeTimeScope=function(e){this.timeScopeValue=e,this.timeLimitInfo.dueTime=this.timeScopeValue},jr.decorators=[{type:b.Component,args:[{selector:"lib-time-limit-control",template:'<div class="f-page">\r\n  <div class="f-utils-fill-flex-column farris-split-section m-2 h-100">\r\n    <section class="f-utils-fill-flex-column h-100" style="border-radius:16px;border: 1.5px solid #F1F3F7">\r\n      <div class="f-section-header pt-2 mx-2">\r\n        <div class="f-title">\r\n          <h4 class="f-title-text">{{ \'component.timeLimitControl.timelinessControl\' | wfLocale }}</h4><span class="title-line"></span>\r\n        </div>\r\n      </div>\r\n      <div class="f-utils-fill-flex-column h-100">\r\n        <form class="h-100">\r\n          <div class="f-utils-fill-flex-column h-100">\r\n            <div class="farris-form-controls-inline">\r\n              <div class="farris-group-wrap">\r\n                <div class="form-group">\r\n                  <label class="col-form-label pl-1 mr-3">\r\n                    <span class="farris-label-text">{{ \'component.timeLimitControl.isEnable\' | wfLocale }}</span>\r\n                  </label>\r\n                  <div class="farris-input-wrap mr-5">\r\n                    <farris-switch [(ngModel)]="timeLimitInfo.enable" name="enable"></farris-switch>\r\n                    <div class="farris-feedback valid-feedback"></div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div class="farris-form-controls-inline">\r\n              <div class="farris-group-wrap">\r\n                <div class="form-group" style="width: 100%;">\r\n                  <label class="col-form-label pl-1 mr-3">\r\n                    <span class="farris-label-text">{{ \'component.timeLimitControl.taskDeadline\' | wfLocale }}</span>\r\n                  </label>\r\n                  <div class="farris-input-wrap mr-1" style="width: 35%;">\x3c!--name="tag"--\x3e\r\n                    <farris-combo-list [(ngModel)]="timeLimitInfo.tag" [idField]="\'value\'" [textField]="\'text\'" name="tag"\r\n                                       [valueField]="\'value\'" [data]="tagCollection" [panelHeight]="\'auto\'"\r\n                                       [editable]="false" [enableClear]="false" (selectChange)="tagSelectChange($event)">\r\n                    </farris-combo-list>\r\n                    <div class="farris-feedback valid-feedback"></div>\r\n                  </div>\r\n                  <div *ngIf="timeLimitInfo.tag === \'constant\'" class="farris-input-wrap mr-1" style="width: 35%;">\r\n                    <farris-number-spinner [(ngModel)]="timeLimitInfo.dueTime" name="dueTime"\r\n                      [editable]="true" [precision]="0" [parser]="parser"\r\n                      [min]="0"></farris-number-spinner>\r\n                    <div class="farris-feedback valid-feedback"></div>\r\n                  </div>\r\n                  <div *ngIf="timeLimitInfo.tag === \'constant\'" class="farris-input-wrap mr-5" style="width: 30%;">\r\n                    <farris-combo-list [(ngModel)]="timeLimitInfo.timeUnit" name="timeUnit" [idField]="\'value\'" [textField]="\'text\'"\r\n                    [valueField]="\'value\'" [data]="timeUnitCollection" [panelHeight]="\'auto\'"\r\n                    [editable]="false" [enableClear]="false">\r\n                    </farris-combo-list>\r\n                    <div class="farris-feedback valid-feedback"></div>\r\n                  </div>\r\n                  <div *ngIf="timeLimitInfo.tag === \'scope\'" class="farris-input-wrap mr-1" style="width: 65%;">\r\n                    <farris-radiogroup [(ngModel)]="timeLimitInfo.dueTime" name="scope"\r\n                                       [data]="timeScopeCollection"\r\n                                       (changeValue)="changeTimeScope($event)">\r\n                    </farris-radiogroup>\r\n                    <div class="farris-feedback valid-feedback"></div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div class="mx-2 mt-3">\r\n              <div class="title-content">\r\n                <h4 class="title-text">{{ \'component.timeLimitControl.timelyOperation\' | wfLocale }}</h4><span class="title-line"></span>\r\n              </div>\r\n            </div>\r\n            <div class="mx-2 h-100">\r\n              <farris-tabs class="f-utils-fill h-100" [value]="\'operation\'" [contentFill]="true" [autoTitleWidth]="true">\r\n                <farris-tab title="{{\'component.timeLimitControl.timelyOperation\' | wfLocale}}" [id]="\'operation\'">\r\n                  <ng-template farrisTabsExtend>\r\n                    <div class="mx-2">\r\n                      <button type="button" (click)="add()"\r\n                        class="btn btn-primary mr-2">{{ \'component.timeLimitControl.add\' | wfLocale }}</button>\r\n                      <button type="button" (click)="remove()"\r\n                        class="btn btn-secondary">{{ \'component.timeLimitControl.remove\' | wfLocale }}</button>\r\n                    </div>\r\n                  </ng-template>\r\n                  <ng-template #content>\r\n                    <div class="f-utils-fill-flex-column h-100" style="background: #FFF;">\r\n                      <farris-datagrid #grid [data]="timeLimitInfo.expireOperations" [idField]="\'id\'" [columns]="cols"\r\n                        [fit]="true" [editMode]="\'cell\'" [editable]="true"\r\n                        [fitColumns]="true" [pagination]="false" [showCheckbox]="false" [multiSelect]="false">\x3c!--[beforeEdit]="beforeEdit" [afterEdit]="afterEdit"--\x3e\r\n                      </farris-datagrid>\r\n                    </div>\r\n                  </ng-template>\r\n                </farris-tab>\r\n              </farris-tabs>\r\n            </div>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </section>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #cell let-ctx>\r\n  <span (click)="editOperation(ctx)" *ngIf="ctx.rowData.operationTypeName === \'SendMessageExpireOperation\'" class="link">\r\n    {{ ctx.rowData.sendType?(\'component.timeLimitControl.set\' | wfLocale): (\'component.timeLimitControl.notSet\' | wfLocale) }}\r\n  </span>\r\n  <span (click)="editOperation(ctx)" *ngIf="ctx.rowData.operationTypeName === \'AutoHandleExpireOperation\'" class="link">\r\n    {{ (ctx.rowData.autoHandleType && ctx.rowData.message)?(\'component.timeLimitControl.set\' | wfLocale): (\'component.timeLimitControl.notSet\' | wfLocale) }}\r\n  </span>\r\n</ng-template>\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type="button" class="btn btn-secondary btn-sm" (click)="clickCancel()">{{\'component.timeLimitControl.clickCancel\' | wfLocale }}</button>\r\n  <button type="button" class="btn btn-primary btn-sm mx-2" (click)="clickOK()">{{\'component.timeLimitControl.clickOK\' | wfLocale }}</button>\r\n</ng-template>',providers:[x],styles:[".title-content{color:#000;display:inline-flex;align-items:center;line-height:1.375rem;position:relative;overflow:hidden;padding:0 0 0 1rem;min-width:760px}.title-content ::before{content:'';width:.25rem;height:1.125rem;background:#59a1ff;border-radius:1px;position:absolute;top:50%;left:0;margin-top:-.5625rem}.title-text{font-size:1rem;line-height:1.375rem;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;margin-bottom:0;margin-right:10px}.title-line{flex-grow:1;border-bottom:1px dashed rgba(0,0,0,.1)}.link{color:#1206bb;font-size:14px}.link:hover{color:#5d478b;font-size:14px}"]}]}],jr.ctorParameters=function(){return[{type:b.ComponentFactoryResolver},{type:b.Injector},{type:i.BsModalService},{type:r.MessagerService},{type:b.ChangeDetectorRef,decorators:[{type:b.Optional}]},{type:String,decorators:[{type:b.Inject,args:[b.LOCALE_ID]}]},{type:undefined,decorators:[{type:b.Inject,args:[o]}]},{type:x,decorators:[{type:b.Optional}]}]},jr.propDecorators={cls:[{type:b.HostBinding,args:["class"]}],closeModal:[{type:b.Output}],submitModal:[{type:b.Output}],value:[{type:b.Input}],editorParams:[{type:b.Input}],modalFooter:[{type:b.ViewChild,args:["iconSelectFooter"]}],cell:[{type:b.ViewChild,args:["cell"]}],grid:[{type:b.ViewChild,args:["grid"]}]};var Ur=jr;function jr(e,t,r,i,n,o,a,s){var l=this;this.resolver=e,this.injector=t,this.modalService=r,this.message=i,this.cdr=n,this.localeId=o,this.resources=a,this.localePipe=s,this.cls="farris-main-area flex-column",this.closeModal=new b.EventEmitter,this.submitModal=new b.EventEmitter,this.editorParams={},this.modalConfig={title:this.localePipe.transform("component.timeLimitControl.timedOutOperation"),width:760,height:532,showButtons:!0},this.timeLimitInfo=new Sr,this.tagCollection=[{value:"constant",text:this.localePipe.transform("component.timeLimitControl.constant")},{value:"scope",text:this.localePipe.transform("component.timeLimitControl.scope")}],this.timeUnitCollection=[{value:"day",text:this.localePipe.transform("component.timeLimitControl.day")},{value:"hour",text:this.localePipe.transform("component.timeLimitControl.hour")},{value:"minute",text:this.localePipe.transform("component.timeLimitControl.minute")}],this.durationTypeCollection=[{value:"BeforeDuration",text:this.localePipe.transform("component.timeLimitControl.BeforeDuration")},{value:"OnDuration",text:this.localePipe.transform("component.timeLimitControl.OnDuration")},{value:"AfterDuration",text:this.localePipe.transform("component.timeLimitControl.AfterDuration")}],this.activityOperationTypeName=[{value:"SendMessageExpireOperation",text:this.localePipe.transform("component.timeLimitControl.SendMessageExpireOperation")},{value:"AutoHandleExpireOperation",text:this.localePipe.transform("component.timeLimitControl.AutoHandleExpireOperation")}],this.processOperationTypeName=[{value:"SendMessageExpireOperation",text:this.localePipe.transform("component.timeLimitControl.SendMessageExpireOperation")}],this.operationTypeName=[],this.timeScopeCollection=[{value:"curDay",name:this.localePipe.transform("component.timeLimitControl.curDay")}],this.timeScopeValue=this.timeScopeCollection[0].value,this.cols=[],this.location="activity",this.parser=function(e){return Number(e)},this.durationTypeChange=function(t){t&&t.value&&t.value.value===l.durationTypeCollection[1].value&&(l.timeLimitInfo.expireOperations.find(function(e){return e.id===t.rowData.id}).timeDuration=0)},this.localePipe=this.localePipe||new x(o,a)}_r.prototype.convertTo=function(e){return e&&e.enable?this.localePipe.transform("component.timeLimitControl.set"):this.localePipe.transform("component.timeLimitControl.notSet")};var Hr=_r;function _r(e){this.localePipe=e}var Gr=function(){this.receivers=new Array,this.id=l.GenerateElementId(),this.subject="消息通知",this.content='{"expr":"\'您有一条消息通知。\'","sexpr":""}'},Kr=function(){},qr=(Wr.prototype.ngOnInit=function(){this.data=this.designerUIState.userActList},Wr.prototype.clickOK=function(){var e=this.grid.checkeds;e&&0!==e.length?this.submitEmitter.emit(e):this.message.info(this.localePipe.transform("component.activityList.checkeds"))},Wr.prototype.clickCancel=function(){this.closeEmitter.emit()},Wr.decorators=[{type:b.Component,args:[{selector:"lib-activity-list",template:'<div class="f-page">\r\n  <div class="f-page-main f-utils-fill-flex-column h-100">\r\n    <div class="f-utils-fill-flex-column farris-overflow-y-auto h-100">\r\n      <farris-datagrid #grid [data]="data" [columns]="columns" [idField]="\'Id\'" [fit]="true" [fitColumns]="true"\r\n         [pagination]="false" [showCheckbox]="showCheckbox" [multiSelect]="multiSelect" [showLineNumber]="true" lineNumberTitle="{{\'component.activityList.checkeds\' | wfLocale}}"\r\n         [lineNumberWidth]="50" [checkOnSelect]="true" [selectOnCheck]="true">\r\n      </farris-datagrid>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #buttonRef>\r\n    <button type="button" class="btn btn-secondary btn-sm px-3" (click)="clickCancel()">{{\'component.activityList.clickCancel\' | wfLocale}}</button>\r\n    <button type="button" class="btn btn-primary btn-sm px-3 mx-2" (click)="clickOK()">{{\'component.activityList.clickOK\' | wfLocale}}</button>\r\n</ng-template>\r\n',providers:[x],styles:[""]}]}],Wr.ctorParameters=function(){return[{type:a},{type:r.MessagerService},{type:b.ChangeDetectorRef,decorators:[{type:b.Optional}]},{type:String,decorators:[{type:b.Inject,args:[b.LOCALE_ID]}]},{type:undefined,decorators:[{type:b.Inject,args:[o]}]},{type:x,decorators:[{type:b.Optional}]}]},Wr.propDecorators={closeEmitter:[{type:b.Output}],submitEmitter:[{type:b.Output}],buttonRef:[{type:b.ViewChild,args:["buttonRef"]}],grid:[{type:b.ViewChild,args:["grid"]}]},Wr);function Wr(e,t,r,i,n,o){this.designerUIState=e,this.message=t,this.cdr=r,this.localeId=i,this.resources=n,this.localePipe=o,this.closeEmitter=new b.EventEmitter,this.submitEmitter=new b.EventEmitter,this.multiSelect=!0,this.showCheckbox=!0,this.data=new Array,this.columns=[{title:this.localePipe.transform("component.activityList.name"),field:"Name",width:60},{title:"ID",field:"Id",width:90}],this.localePipe=this.localePipe||new x(i,n)}var Jr,$r=function(e,t,r){this.id="_"+l.GenerateElementId(),this.performerId=e,this.performerName=t,this.type=r},Yr=(n(Xr,Jr=$r),Xr);function Xr(){return Jr.call(this)||this}Qr.prototype.transform=function(e,t){void 0===t&&(t="");var r="";return console.log(e),e.forEach(function(e){r+=e.performerName+"，"}),r=r&&r.substring(0,r.length-1),console.log(r),r||t},Qr.decorators=[{type:b.Pipe,args:[{name:"positionsName"}]}],Qr.ctorParameters=function(){return[]};var Zr=Qr;function Qr(){}ti.prototype.ngOnInit=function(){var t=this;this.designerUIState.getOrgConfig().subscribe(function(e){e&&"true"===e.currentValue&&(t.isRequired=!0)})},ti.prototype.ngAfterViewInit=function(){var e=this;this.ngZone.runOutsideAngular(function(){e.inputGroup.nativeElement.addEventListener("mouseenter",e.onMouseEnter.bind(e)),e.inputGroup.nativeElement.addEventListener("mouseleave",e.onMouseLeave.bind(e))})},ti.prototype.onMouseEnter=function(e){this.showClearButton=!0,this.showClearButton&&this.toggleClearIcon(e,!0)},ti.prototype.onMouseLeave=function(e){this.showClearButton=!1,this.toggleClearIcon(e,!1)},ti.prototype.toggleClearIcon=function(e,t){t=(t=void 0===t?!1:t)?"":"none",e=e.target.querySelector(".input-group-clear");e&&(e.style.display=t)},ti.prototype.clickOK=function(){this.submitEmitter.emit(this.position)},ti.prototype.clickCancel=function(){this.closeEmitter.emit()},ti.prototype.clear=function(){this.position.performerId=null,this.position.performerName=null,this.performerName=""},ti.prototype.positionTypeChange=function(e){"0"===e.value?(this.newFilter={positionType:"0"},this.positionType="0"):(this.newFilter={positionType:"1"},this.positionType="1"),this.clear(),this.position.orgType=null,this.position.orgId=null},ti.prototype.selectOrganition=function(){var e,t,r,i,n,o,a=this;if("1"===this.position.positionType){if(0<this.designerUIState.schemas.length){try{for(var s=ue(this.designerUIState.schemas),l=s.next();!l.done;l=s.next()){var c=l.value;this.expr.addSchema("Schema",c)}}catch(y){e={error:y}}finally{try{l&&!l.done&&(o=s["return"])&&o.call(s)}finally{if(e)throw e.error}}this.designerUIState.schemas[0].entityTypes&&0<this.designerUIState.schemas[0].entityTypes.length&&(o=this.designerUIState.schemas[0].entityTypes[0],this.expr.addInjectedEntity(o.name,"Schema",o.name,D.InjectedType.EntityType))}var p=new Array;if(0<this.designerUIState.subActivityContext.length)try{for(var d=ue(this.designerUIState.subActivityContext),u=d.next();!u.done;u=d.next())!function(t){p.some(function(e){return e.key===t.key})||p.push(t)}(u.value)}catch(g){t={error:g}}finally{try{u&&!u.done&&(r=d["return"])&&r.call(d)}finally{if(t)throw t.error}}if(0<p.length)try{for(var m=ue(p),f=m.next();!f.done;f=m.next()){var h=f.value;this.expr.addContext(h)}}catch(v){i={error:v}}finally{try{f&&!f.done&&(n=m["return"])&&n.call(m)}finally{if(i)throw i.error}}this.expr.setEditPattern(D.ExprEditMode.Advanced),this.expr.addExpressionText(this.position.orgId),this.expr.buildExpression().then(function(e){a.position.orgId=e,0<p.length&&(a.expr.exprEntity.contextEntities=a.expr.exprEntity.contextEntities.filter(function(t){return!p.some(function(e){return e.key===t.key})}))})}},ti.prototype.selectPosition=function(){this.setPosition()},ti.prototype.editCondition=function(){var e,t,r,i,n,o,a,s,l=this;if(0<this.designerUIState.schemas.length){try{for(var c=ue(this.designerUIState.schemas),p=c.next();!p.done;p=c.next()){var d=p.value;this.expr.addSchema("Schema",d)}}catch(x){e={error:x}}finally{try{p&&!p.done&&(s=c["return"])&&s.call(c)}finally{if(e)throw e.error}}this.designerUIState.schemas[0].entityTypes&&0<this.designerUIState.schemas[0].entityTypes.length&&(s=this.designerUIState.schemas[0].entityTypes[0],this.expr.addInjectedEntity(s.name,"Schema",s.name,D.InjectedType.EntityType))}var u=new Array,u=this.designerUIState.addContext(u);if(0<this.designerUIState.subActivityContext.length)try{for(var m=ue(this.designerUIState.subActivityContext),f=m.next();!f.done;f=m.next())!function(t){u.some(function(e){return e.key===t.key})||u.push(t)}(f.value)}catch(w){t={error:w}}finally{try{f&&!f.done&&(r=m["return"])&&r.call(m)}finally{if(t)throw t.error}}if(0<this.designerUIState.activityComponentContext.length)try{for(var h=ue(this.designerUIState.activityComponentContext),y=h.next();!y.done;y=h.next())!function(t){u.some(function(e){return e.key===t.key})||u.push(t)}(y.value)}catch(P){i={error:P}}finally{try{y&&!y.done&&(n=h["return"])&&n.call(h)}finally{if(i)throw i.error}}if(0<u.length)try{for(var g=ue(u),v=g.next();!v.done;v=g.next()){var b=v.value;this.expr.addContext(b)}}catch(C){o={error:C}}finally{try{v&&!v.done&&(a=g["return"])&&a.call(g)}finally{if(o)throw o.error}}this.expr.setEditPattern(D.ExprEditMode.Conditional),this.expr.addExpressionText(this.position.condition),this.expr.buildExpression().then(function(e){var t,r;l.position.condition=e;try{for(var i=ue(l.positions),n=i.next();!n.done;n=i.next())n.value.condition=e}catch(o){t={error:o}}finally{try{n&&!n.done&&(r=i["return"])&&r.call(i)}finally{if(t)throw t.error}}0<u.length&&(l.expr.exprEntity.contextEntities=l.expr.exprEntity.contextEntities.filter(function(t){return!u.some(function(e){return e.key===t.key})}))})},ti.prototype.orgTypeChange=function(e){this.position.orgType=e.data.value},ti.prototype.clearOrgType=function(){this.position.orgType=null},ti.prototype.positionsSelected=function(e){var t,r;if(this.positions=[],e||0<e.data.length){var i=[];try{for(var n=ue(e.data),o=n.next();!o.done;o=n.next()){var a=o.value;this.editState&&(this.position=new Yr),this.position.performerId=a.id,this.position.performerName=a.name,this.position.type="wf.PositionParticipantExpression",this.position.positionType||(this.position.positionType=a.posType+"",this.newFilter={positionType:a.posType}),this.position.isRequired=this.isRequired,this.position.condition=this.condition||"",i.push(this.position)}}catch(s){t={error:s}}finally{try{o&&!o.done&&(r=n["return"])&&r.call(n)}finally{if(t)throw t.error}}this.positions=w(i),this.performerName=this.positions&&this.positions.length?this.positionsNamePipe.transform(this.positions):this.position.performerName||""}},ti.prototype.setPosition=function(){var t=this;this.positions=[];var e=this.resolver.resolveComponentFactory(ae.SysLookupDetailComponent).create(this.injector),r=(e.instance.initGridIdList=this.curPosIdList,e.instance.treeFilter=this.treeFilter,e.instance.listFilter=this.newFilter,e.instance.sourceType="position",e.instance.multiSelect=!1,"0"===this.positionType&&this.editState&&(e.instance.multiSelect=!0),{title:this.localePipe.transform("component.positionPerformer.sysPositions"),width:1e3,height:550,showButtons:!0,buttons:e.instance.btnTemplateRef,showMaxButton:!0,resizable:!1}),i=this.modalService.show(e,r);e.instance.afterCancle.subscribe(function(e){i.close()}),e.instance.afterConfirm.subscribe(function(e){t.positionsSelected(e)})},ti.prototype.getPerformers=function(){return this.editState||this.positions.push(this.position),this.positions},ti.decorators=[{type:b.Component,args:[{selector:"app-position-performer",template:'<div class="d-flex flex-fill farris-overflow-y-auto p-md-2" style="background: #FFF;">\r\n  <div class="d-flex flex-fill farris-overflow-y-auto mx-3 my-2" style="border-radius:16px;border: 1.5px solid #F1F3F7;">\r\n  <form style="width: 100%;">\r\n    <div class="d-flex m-2 flex-column w-100" style="margin-top: 20px!important;">\r\n      <div class="d-flex flex-column" [ngStyle]="style">\r\n        <div class="farris-form form-inline  farris-form-inline mr-5">\r\n          <div *ngIf="designerUIState.scene!==\'inSuite\'" class="col-12 farris-group-auto my-3">\r\n            <div class="farris-group-wrap">\r\n              <div class="form-group farris-form-group">\r\n                <label class="col-form-label">\r\n                  <span class="farris-label-text">{{\'component.positionPerformer.positionType\'|wfLocale}}</span>\r\n                </label>\r\n                <div class="farris-input-wrap">\r\n                  <farris-combo-list [(ngModel)]="position.positionType" name="positionType" [panelHeight]="\'auto\'" [idField]="\'value\'"\r\n                    [textField]="\'text\'" [data]="positionTypes" (valueChange)="positionTypeChange($event)"\r\n                    [panelHeight]="\'auto\'" [enableClear]="false">\r\n                  </farris-combo-list>\r\n                  <div class="farris-feedback valid-feedback"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class="col-12 farris-group-auto my-4">\r\n            <div class="farris-group-wrap">\r\n              <div class="form-group farris-form-group">\r\n                <label class="col-form-label">\r\n                  <span class="farris-label-info text-danger">*</span>\r\n                  <span class="farris-label-text">{{designerUIState.scene===\'inSuite\'?(\'component.positionPerformer.role\'|wfLocale):(\'component.positionPerformer.position\'|wfLocale)}}</span>\r\n                </label>\r\n                <div class="farris-input-wrap">\r\n                  <div #inputGroup class="input-group">\r\n                    <input type="text" class="form-control" [(ngModel)]="performerName" name="positionName" [readOnly]="true" />\r\n                    <div class="input-group-append">\r\n                      <span [style.display]="showClearButton ? \'\' : \'none\'" class="input-group-text input-group-clear" (click)="clear()">\r\n                        <i class="f-icon modal_close"></i>\r\n                      </span>\r\n                      <span class="input-group-text" (click)="selectPosition()" style="background: #FFF;">\r\n                        <i class="f-icon f-icon-lookup"></i>\r\n                      </span>\r\n                    </div>\r\n                  </div>\r\n                  <div class="farris-feedback valid-feedback"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div *ngIf="designerUIState.scene!==\'inSuite\' && position.positionType === \'1\'" class="col-12 farris-group-auto my-4">\r\n            <div class="farris-group-wrap">\r\n              <div class="form-group farris-form-group">\r\n                <label class="col-form-label">\r\n                  <ng-container *ngIf="isRequired&&position.positionType===\'1\'">\r\n                    <span class="farris-label-info text-danger">*</span>\r\n                  </ng-container>\r\n                  <span class="farris-label-text">{{\'component.positionPerformer.sysType\'|wfLocale}}</span>\r\n                </label>\r\n                <div class="farris-input-wrap">\r\n                  <farris-combo-list [(ngModel)]="position.orgType" name="orgType" [idField]="\'value\'" [textField]="\'text\'" [valueField]="\'value\'"\r\n                    [data]="designerUIState.orgTypeCollection" [panelHeight]="\'auto\'" (clear)="clearOrgType()"\r\n                    (selectChange)=\'orgTypeChange($event)\' [readonly]="!(position.positionType===\'1\')" placeholder="{{position.positionType===\'1\'?(\'component.positionPerformer.placeholder\'|wfLocale):\'\'}}">\r\n                  </farris-combo-list>\r\n                  <div class="farris-feedback valid-feedback"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div *ngIf="designerUIState.scene!==\'inSuite\' && position.positionType === \'1\'" class="col-12 farris-group-auto my-4">\r\n            <div class="farris-group-wrap">\r\n              <div class="form-group farris-form-group">\r\n                <label class="col-form-label">\r\n                  <ng-container *ngIf="isRequired&&position.positionType===\'1\'">\r\n                    <span class="farris-label-info text-danger">*</span>\r\n                  </ng-container>\r\n                  <span class="farris-label-text">{{\'component.positionPerformer.orgId\'|wfLocale}}</span>\r\n                </label>\r\n                <div class="farris-input-wrap">\r\n                  <input-group class="form-control" style="width: 100%;padding:0;border:0;" [enableClear]="false"\r\n                    [showButtonWhenDisabled]="false" [readonly]="!(position.positionType===\'1\')"\r\n                    [(ngModel)]="position.orgId" name="organization" placeholder="{{position.positionType===\'1\'?(\'component.positionPerformer.placeholder\'|wfLocale):\'\'}}"\r\n                    [editable]="false" (clickHandle)="selectOrganition()" [groupText]="groupIcon"></input-group>\r\n                  <div class="farris-feedback valid-feedback"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div *ngIf="showCondition" class="d-flex flex-column" style="background: #FFF;">\r\n        <div class="farris-form form-inline farris-form-inline mr-5">\r\n          <div class="col-12 farris-group-auto my-3">\r\n            <div class="farris-group-wrap">\r\n              <div class="form-group farris-form-group">\r\n                <label class="col-form-label">\r\n                  <span class="farris-label-text">{{\'component.positionPerformer.condition\'|wfLocale}}</span>\r\n                </label>\r\n                <div class="farris-input-wrap">\r\n                  <div class="input-group">\r\n                    <input type="text" class="form-control" [(ngModel)]="this.position.condition" name="conditon" [readOnly]="true" />\r\n                    <div class="input-group-append">\r\n                      <span class="input-group-text" (click)="editCondition()" style="background: #FFF;">\r\n                        <i class="f-icon f-icon-lookup"></i>\r\n                      </span>\r\n                    </div>\r\n                  </div>\r\n                  <div class="farris-feedback valid-feedback"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </form>\r\n</div>\r\n</div>\r\n\r\n<ng-template #buttonRef>\r\n  <button type="button" class="btn btn-secondary btn-sm px-3" (click)="clickCancel()">{{\'component.positionPerformer.clickCancel\'|wfLocale}}</button>\r\n  <button type="button" class="btn btn-primary btn-sm px-3 mx-2" (click)="clickOK()">{{\'component.positionPerformer.clickOK\'|wfLocale}}</button>\r\n</ng-template>\r\n',providers:[x],styles:[""]}]}],ti.ctorParameters=function(){return[{type:a},{type:D.ExpressionService},{type:b.NgZone},{type:b.ComponentFactoryResolver},{type:b.Injector},{type:i.BsModalService},{type:b.ChangeDetectorRef,decorators:[{type:b.Optional}]},{type:String,decorators:[{type:b.Inject,args:[b.LOCALE_ID]}]},{type:undefined,decorators:[{type:b.Inject,args:[o]}]},{type:x,decorators:[{type:b.Optional}]},{type:Zr}]},ti.propDecorators={cls:[{type:b.HostBinding,args:["class"]}],closeEmitter:[{type:b.Output}],submitEmitter:[{type:b.Output}],posiHelp:[{type:b.ViewChild,args:[j.SysFarrisLookupComponent]}],buttonRef:[{type:b.ViewChild,args:["buttonRef"]}],inputGroup:[{type:b.ViewChild,args:["inputGroup"]}]};var ei=ti;function ti(e,t,r,i,n,o,a,s,l,c,p){this.designerUIState=e,this.expr=t,this.ngZone=r,this.resolver=i,this.injector=n,this.modalService=o,this.cdr=a,this.localeId=s,this.resources=l,this.localePipe=c,this.positionsNamePipe=p,this.cls="d-flex flex-fill h-100",this.closeEmitter=new b.EventEmitter,this.submitEmitter=new b.EventEmitter,this.showClearButton=!1,this.isRequired=!1,this.groupIcon='<i class="f-icon f-icon-lookup"></i>',this.positionTypes=[{value:"0",text:this.localePipe.transform("component.positionPerformer.orgPosition")},{value:"1",text:this.localePipe.transform("component.positionPerformer.generalPosition")}],this.performerName="",this.style={background:"#FFF"},this.newFilter={},this.treeFilter={},this.curPosIdList=[],this.editState=!0,this.showCondition=!0,this.positions=[],this.localePipe=this.localePipe||new x(s,l),this.position=this.position||new Yr,this.performerName=this.performerName||(this.positions&&this.positions.length?this.positionsNamePipe.transform(this.positions):this.position.performerName||""),"inSuite"===this.designerUIState.scene&&(this.position.positionType="1",this.newFilter={positionType:"1"},this.style={background:"#FFF",height:"150px"})}Object.defineProperty(p.prototype,"location",{get:function(){return this._location},set:function(e){this._location=e,"activity"!==this.location&&(this.processParticipantTypes=[{value:"procInstCreator",text:this.localePipe.transform("component.messageNoticeEdit.procInstCreator")},{value:"activityExecutorParticipant",text:this.localePipe.transform("component.messageNoticeEdit.activityExecutorParticipant")}])},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"value",{get:function(){return this.messageNotice},set:function(e){e=JSON.stringify(Object.assign({},e));this.messageNotice=JSON.parse(e),this.exprAble="{"===this.messageNotice.subject.charAt(0),this.hasSmsMessage(this.messageNotice.sendType)&&(this.hasSmsTemplate=!0,this.messageNotice.smsMessageTemplate||(this.messageNotice.smsMessageTemplate=new Dr))},enumerable:!0,configurable:!0}),p.prototype.ngOnInit=function(){var t=this;"activity"===this.location?(this.sendTimes=this.activitySendTime,this.messageNotice.sendTime===this.activitySendTime[0].value?(this.receiverTypes=[{value:"processParticipant",text:this.localePipe.transform("component.messageNoticeEdit.processParticipant")}],this.processParticipantTypes=[{value:"workItemParticipant",text:this.localePipe.transform("component.messageNoticeEdit.workItemReceiveParticipant")}]):(this.receiverTypes=[{value:"processParticipant",text:this.localePipe.transform("component.messageNoticeEdit.processParticipant")},{value:"variableParticipant",text:this.localePipe.transform("component.messageNoticeEdit.variableParticipant")},{value:"userParticipant",text:this.localePipe.transform("component.messageNoticeEdit.userParticipant")},{value:"positionParticipant",text:this.localePipe.transform("component.messageNoticeEdit.positionParticipant")}],this.processParticipantTypes=[{value:"procInstCreator",text:this.localePipe.transform("component.messageNoticeEdit.procInstCreator")},{value:"activityExecutorParticipant",text:this.localePipe.transform("component.messageNoticeEdit.activityExecutorParticipant")}])):this.sendTimes=this.processSendTime;this.http.get("/api/runtime/wf/v1.0/reportingOrgType/hasAdminOrg").subscribe(function(e){t.hasAdminOrg=e,"inSuite"===t.designerUIState.scene?t.userTypeButtonNeedShow=!0:t.userTypeButtonNeedShow=e,t.userTypeButtonNeedShow||(t.variableOrgTypes=[{name:t.localePipe.transform("component.messageNoticeEdit.sys"),value:"Sys"}])})},p.prototype.clickOK=function(){this.SmsTemplate&&this.SmsTemplate.endGridEdit(),this.setReceiver(),this.hasSmsTemplate?(this.messageNotice.smsMessageTemplate=this.SmsTemplate.smsMessageTemplate,this.messageNotice.smsMessageTemplate.smsMessageVariables&&0<this.messageNotice.smsMessageTemplate.smsMessageVariables.length&&(this.messageNotice.smsMessageTemplate.smsMessageVariables=this.messageNotice.smsMessageTemplate.smsMessageVariables.filter(function(e){return e.code}))):this.messageNotice.smsMessageTemplate=null,this.validator()&&this.submitEmitter.emit(this.messageNotice)},p.prototype.clickCancel=function(){this.closeEmitter.emit()},p.prototype.sendTimeChange=function(e){var t,r;if(e.data.value===this.activitySendTime[0].value){e=new Kr;e.type="processParticipant",e.processParticipant="workItemParticipant",this.messageNotice.receivers=[e],this.receiverTypes=[{value:"processParticipant",text:this.localePipe.transform("component.messageNoticeEdit.processParticipant")}],this.processParticipantTypes=[{value:"workItemParticipant",text:this.localePipe.transform("component.messageNoticeEdit.workItemParticipant")}]}else{try{for(var i=ue(this.messageNotice.receivers),n=i.next();!n.done;n=i.next()){var o=n.value;"processParticipant"===o.type&&"workItemParticipant"===o.processParticipant&&(o.processParticipant="procInstCreator")}}catch(a){t={error:a}}finally{try{n&&!n.done&&(r=i["return"])&&r.call(i)}finally{if(t)throw t.error}}this.receiverTypes=[{value:"processParticipant",text:this.localePipe.transform("component.messageNoticeEdit.processParticipant")},{value:"variableParticipant",text:this.localePipe.transform("component.messageNoticeEdit.variableParticipant")},{value:"userParticipant",text:this.localePipe.transform("component.messageNoticeEdit.userParticipant")},{value:"positionParticipant",text:this.localePipe.transform("component.messageNoticeEdit.positionParticipant")}],this.processParticipantTypes=[{value:"procInstCreator",text:this.localePipe.transform("component.messageNoticeEdit.procInstCreator")},{value:"activityExecutorParticipant",text:this.localePipe.transform("component.messageNoticeEdit.activityExecutorParticipant")}]}},p.prototype.sendTypeChange=function(e){this.hasSmsMessage(e)?(this.hasSmsTemplate=!0,this.messageNotice.smsMessageTemplate||(this.messageNotice.smsMessageTemplate=new Dr)):(this.hasSmsTemplate=!1,this.messageNotice.smsMessageTemplate=null)},p.prototype.hasSmsMessage=function(e){var r=this;return!!e&&!!e.split(",").find(function(t){return r.uistate.messageChannels.find(function(e){return e.code==t&&"Sms"==e.channelType})})},p.prototype.usersSelect=function(e){var t,r,i,n;if(this.messageNotice.receivers[this.index].userIds="",this.messageNotice.receivers[this.index].userNames="",e&&0<e.length){var o="";try{for(var a=ue(e),s=a.next();!s.done;s=a.next())o+=s.value.id+","}catch(d){t={error:d}}finally{try{s&&!s.done&&(r=a["return"])&&r.call(a)}finally{if(t)throw t.error}}o&&(this.messageNotice.receivers[this.index].userIds=o.substring(0,o.length-1));var l="";try{for(var c=ue(e),p=c.next();!p.done;p=c.next())l+=p.value.name+","}catch(u){i={error:u}}finally{try{p&&!p.done&&(n=c["return"])&&n.call(c)}finally{if(i)throw i.error}}l&&(this.messageNotice.receivers[this.index].userNames=l.substring(0,l.length-1))}},p.prototype.clearUsers=function(e){this.messageNotice.receivers[e].userIds="",this.messageNotice.receivers[e].userNames=""},p.prototype.clearPosition=function(e){this.messageNotice.receivers[e].positionId="",this.messageNotice.receivers[e].positionName="",this.messageNotice.receivers[e].positionType="",this.messageNotice.receivers[e].orgId="",this.messageNotice.receivers[e].orgType=""},p.prototype.clearActivityExecutor=function(e){this.messageNotice.receivers[e].activityDefId="",this.messageNotice.receivers[e].activityDefName=""},p.prototype.clearVariableParticipant=function(e){this.messageNotice.receivers[e].variableParticipant="",this.messageNotice.receivers[e].variableName=""},p.prototype.changeValue=function(e){},p.prototype.clear=function(){this.bindingData={}},p.prototype.setReceiver=function(){},p.prototype.validator=function(){var e,t;if(!this.messageNotice.sendType)return this.message.info(this.localePipe.transform("component.messageNoticeEdit.sendType")),!1;if("messageActivity"!==this.location&&!this.messageNotice.sendTime)return this.message.info(this.localePipe.transform("component.messageNoticeEdit.sendTime")),!1;if(!this.messageNotice.subject)return this.message.info(this.localePipe.transform("component.messageNoticeEdit.subject")),!1;if(!this.messageNotice.content)return this.message.info(this.localePipe.transform("component.messageNoticeEdit.content")),!1;if(this.messageNotice.receivers=this.messageNotice.receivers.filter(function(e){return e.type}),!this.messageNotice.receivers||0===this.messageNotice.receivers.length)return this.message.info(this.localePipe.transform("component.messageNoticeEdit.receivers")),!1;try{for(var r=ue(this.messageNotice.receivers),i=r.next();!i.done;i=r.next()){var n=i.value;switch(n.type){case"processParticipant":if(n.processParticipant){if("activityExecutorParticipant"!==n.processParticipant||n.activityDefId)break;this.message.info(this.localePipe.transform("component.messageNoticeEdit.activityDefIdNotNull"))}else this.message.info(this.localePipe.transform("component.messageNoticeEdit.processParticipantNotNull"));return!1;case"variableParticipant":if(n.variableParticipant){if(n.orgType)break;this.message.info(this.localePipe.transform("component.messageNoticeEdit.orgType"))}else this.message.info(this.localePipe.transform("component.messageNoticeEdit.variableParticipantNotNull"));return!1;case"userParticipant":if(n.userIds)break;return this.message.info(this.localePipe.transform("component.messageNoticeEdit.userIds")),!1;case"positionParticipant":if(n.positionId)break;return this.message.info(this.localePipe.transform("component.messageNoticeEdit.positionId")),!1}}}catch(o){e={error:o}}finally{try{i&&!i.done&&(t=r["return"])&&t.call(r)}finally{if(e)throw e.error}}return!0},p.prototype.addReceiver=function(){var e;this.disableAdd()||((e=this.messageNotice.receivers.filter(function(e){return e.type}))&&0<e.length?((e=new Kr).type="userParticipant",this.messageNotice.receivers=this.messageNotice.receivers.concat([e])):"activity"!==this.location?((e=new Kr).type="processParticipant",e.processParticipant="procInstCreator",this.messageNotice.receivers=this.messageNotice.receivers.concat([e])):((e=new Kr).type="processParticipant",e.processParticipant="workItemParticipant",this.messageNotice.receivers=this.messageNotice.receivers.concat([e])))},p.prototype.selectActivityExecutorParticipant=function(e,c){var p=this,t=this.resolver.resolveComponentFactory(qr).create(this.injector),r=(t.instance.submitEmitter.subscribe(function(e){var t,r,i=e.shift();if(p.messageNotice.receivers[c].activityDefId=i.id,p.messageNotice.receivers[c].activityDefName=i.data.Name,e&&0<e.length)try{for(var n=ue(e),o=n.next();!o.done;o=n.next()){var a=o.value,s=new Kr;s.type="processParticipant",s.processParticipant="activityExecutorParticipant",s.activityDefId=a.id,s.activityDefName=a.data.Name,p.messageNotice.receivers=p.messageNotice.receivers.concat([s])}}catch(l){t={error:l}}finally{try{o&&!o.done&&(r=n["return"])&&r.call(n)}finally{if(t)throw t.error}}d.close()}),t.instance.closeEmitter.subscribe(function(e){d.close()}),{title:this.localePipe.transform("component.messageNoticeEdit.activityList"),width:490,height:490,showButtons:!0,buttons:t.instance.buttonRef}),d=this.modalService.show(t,r)},p.prototype.selectVariableParticipant=function(e,t){var r,i,n,o,a,s,l,c,p,d,u=this,m=new Array;if(this.expr.setEditPattern(D.ExprEditMode.Advanced),0<this.designerUIState.schemas.length){try{for(var f=ue(this.designerUIState.schemas),h=f.next();!h.done;h=f.next()){var y=h.value;this.expr.addSchema("Schema",y)}}catch(T){r={error:T}}finally{try{h&&!h.done&&(d=f["return"])&&d.call(f)}finally{if(r)throw r.error}}this.designerUIState.schemas[0].entityTypes&&0<this.designerUIState.schemas[0].entityTypes.length&&(d=this.designerUIState.schemas[0].entityTypes[0],this.expr.addInjectedEntity(d.name,"Schema",d.name,D.InjectedType.EntityType))}if(0<this.designerUIState.participantContext.length)try{for(var g=ue(this.designerUIState.participantContext),v=g.next();!v.done;v=g.next()){var b=v.value;m.push(b)}}catch(A){i={error:A}}finally{try{v&&!v.done&&(n=g["return"])&&n.call(g)}finally{if(i)throw i.error}}if(0<this.designerUIState.processVariableContext.length)try{for(var x=ue(this.designerUIState.processVariableContext),w=x.next();!w.done;w=x.next())!function(t){m.some(function(e){return e.key===t.key})||m.push(t)}(b=w.value)}catch(k){o={error:k}}finally{try{w&&!w.done&&(a=x["return"])&&a.call(x)}finally{if(o)throw o.error}}if(0<this.designerUIState.subActivityContext.length)try{for(var P=ue(this.designerUIState.subActivityContext),C=P.next();!C.done;C=P.next())!function(t){m.some(function(e){return e.key===t.key})||m.push(t)}(b=C.value)}catch(O){s={error:O}}finally{try{C&&!C.done&&(l=P["return"])&&l.call(P)}finally{if(s)throw s.error}}if(0<m.length)try{for(var I=ue(m),S=I.next();!S.done;S=I.next()){var E=S.value;this.expr.addContext(E)}}catch(M){c={error:M}}finally{try{S&&!S.done&&(p=I["return"])&&p.call(I)}finally{if(c)throw c.error}}e?this.expr.addExpressionText(e):this.expr.addExpressionText(""),this.expr.buildExpression().then(function(e){u.messageNotice.receivers[t].variableParticipant=e,u.messageNotice.receivers[t].variableName=u.variableParticipantName(e),0<m.length&&(u.expr.exprEntity.contextEntities=u.expr.exprEntity.contextEntities.filter(function(t){return!m.some(function(e){return e.key===t.key})}))})},p.prototype.selectUserParticipant=function(e,t){var r=this;this.index=t,this.bindingData={},e.userIds&&0<e.userIds.length&&(this.bindingData.id=e.userIds,this.bindingData.name=e.userNames),setTimeout(function(){r.userHelp.showHelp()},0)},p.prototype.selectPositionParticipant=function(e,t){var r=this,i=this.resolver.resolveComponentFactory(ei).create(this.injector),n=(i.instance.showCondition=!1,i.instance.position.performerId=this.messageNotice.receivers[t].positionId,i.instance.position.performerName=this.messageNotice.receivers[t].positionName,i.instance.position.positionType=this.messageNotice.receivers[t].positionType,i.instance.position.orgId=this.messageNotice.receivers[t].orgId,i.instance.position.orgType=this.messageNotice.receivers[t].orgType,"0"===i.instance.position.positionType?i.instance.newFilter={positionType:"0"}:i.instance.newFilter={positionType:"1"},i.instance.submitEmitter.subscribe(function(e){e.performerId&&(r.messageNotice.receivers[t].positionId=e.performerId,r.messageNotice.receivers[t].positionName=e.performerName,r.messageNotice.receivers[t].positionType=e.positionType,r.messageNotice.receivers[t].orgId=e.orgId,r.messageNotice.receivers[t].orgType=e.orgType),o.close()}),i.instance.closeEmitter.subscribe(function(e){o.close()}),{title:this.localePipe.transform("component.messageNoticeEdit.position"),width:700,height:400,showButtons:!0,buttons:i.instance.buttonRef}),o=this.modalService.show(i,n)},p.prototype.titleExpr=function(e){this.showTitleHelp(e)},p.prototype.contentExpr=function(e){this.showContentHelp(e)},p.prototype.showContentHelp=function(e){var t=this,r=this.showExpr();this.messageNotice.content&&0<this.messageNotice.content.length?this.expr.addExpressionText(this.messageNotice.content):this.expr.addExpressionText(""),this.expr.buildExpression().then(function(e){t.messageNotice.content=e,0<r.length&&(t.expr.exprEntity.contextEntities=t.expr.exprEntity.contextEntities.filter(function(t){return!r.some(function(e){return e.key===t.key})}))})},p.prototype.showTitleHelp=function(e){var t=this,r=(this.messageNotice.subject&&"{"!==this.messageNotice.subject.charAt(0)&&(this.messageNotice.subject=""),this.showExpr());this.messageNotice.subject&&0<this.messageNotice.subject.length?this.expr.addExpressionText(this.messageNotice.subject):this.expr.addExpressionText(""),this.expr.buildExpression().then(function(e){t.messageNotice.subject=e,0<r.length&&(t.expr.exprEntity.contextEntities=t.expr.exprEntity.contextEntities.filter(function(t){return!r.some(function(e){return e.key===t.key})}))})},p.prototype.showExpr=function(){var e,t,r,i,n,o,a,s,l,c,p=new Array;if(0<this.uistate.schemas.length){try{for(var d=ue(this.uistate.schemas),u=d.next();!u.done;u=d.next()){var m=u.value;this.expr.addSchema("Schema",m)}}catch(I){e={error:I}}finally{try{u&&!u.done&&(c=d["return"])&&c.call(d)}finally{if(e)throw e.error}}this.uistate.schemas[0].entityTypes&&0<this.uistate.schemas[0].entityTypes.length&&(c=this.uistate.schemas[0].entityTypes[0],this.expr.addInjectedEntity(c.name,"Schema",c.name,D.InjectedType.EntityType))}if(0<this.uistate.procInstContext.length)try{for(var f=ue(this.uistate.procInstContext),h=f.next();!h.done;h=f.next()){var y=h.value;p.push(y)}}catch(S){t={error:S}}finally{try{h&&!h.done&&(r=f["return"])&&r.call(f)}finally{if(t)throw t.error}}if(0<this.uistate.subActivityContext.length)try{for(var g=ue(this.uistate.subActivityContext),v=g.next();!v.done;v=g.next())!function(t){p.some(function(e){return e.key===t.key})||p.push(t)}(y=v.value)}catch(E){i={error:E}}finally{try{v&&!v.done&&(n=g["return"])&&n.call(g)}finally{if(i)throw i.error}}if(0<this.uistate.processVariableContext.length)try{for(var b=ue(this.uistate.processVariableContext),x=b.next();!x.done;x=b.next())!function(t){p.some(function(e){return e.key===t.key})||p.push(t)}(y=x.value)}catch(T){o={error:T}}finally{try{x&&!x.done&&(a=b["return"])&&a.call(b)}finally{if(o)throw o.error}}if(0<p.length)try{for(var w=ue(p),P=w.next();!P.done;P=w.next()){var C=P.value;this.expr.addContext(C)}}catch(A){s={error:A}}finally{try{P&&!P.done&&(l=w["return"])&&l.call(w)}finally{if(s)throw s.error}}return p},p.prototype.tranExpr=function(){this.messageNotice.subject=""},p.prototype.variableParticipantName=function(e){var t,r,i,n;try{for(var o=ue(this.designerUIState.participantContext),a=o.next();!a.done;a=o.next()){var s=a.value;if(-1<e.indexOf(s.key))return s.name}}catch(p){t={error:p}}finally{try{a&&!a.done&&(r=o["return"])&&r.call(o)}finally{if(t)throw t.error}}try{for(var l=ue(this.designerUIState.processVariableContext),c=l.next();!c.done;c=l.next()){s=c.value;if(-1<e.indexOf(s.key))return s.name}}catch(d){i={error:d}}finally{try{c&&!c.done&&(n=l["return"])&&n.call(l)}finally{if(i)throw i.error}}return JSON.parse(e).expr},p.decorators=[{type:b.Component,args:[{selector:"lib-message-notice-edit",template:'<div class="f-page">\r\n  <div class="f-utils-fill-flex-column farris-split-section m-2 h-100" style="border-radius:16px;border: 1.5px solid #F1F3F7;">\r\n    <section class="f-utils-fill-flex-column h-100">\r\n      <div class="f-utils-fill-flex-column h-100">\r\n        <perfect-scrollbar [config]="{}">\r\n          <form class="h-100">\r\n            <div class="f-form-layout farris-form  farris-form-controls-inline f-form-label-sm">\r\n              <div *ngIf="location!==\'messageActivity\'" class="col-12 col-md-6 mt-3">\r\n                <div class="farris-group-wrap">\r\n                  <div class="form-group farris-form-group">\r\n                    <label class="col-form-label">\r\n                      <span class="farris-label-info text-danger">*</span>\r\n                      <span class="farris-label-text">{{\'component.MessageNotice.sendTime\'|wfLocale}}</span>\r\n                    </label>\r\n                    <div class="farris-input-wrap ml-1">\r\n                      <farris-combo-list [(ngModel)]="messageNotice.sendTime" [idField]="\'value\'" [textField]="\'text\'"\r\n                        [enableClear]="false" [data]="sendTimes" name="sendTime" [editable]="false"\r\n                        (selectChange)="sendTimeChange($event)">\r\n                      </farris-combo-list>\r\n                      <div class="farris-feedback valid-feedback"></div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <div class="col-12 farris-group-auto mt-2">\r\n                <div class="farris-group-wrap">\r\n                  <div class="form-group farris-form-group">\r\n                    <label class="col-form-label">\r\n                      <span class="farris-label-info text-danger">*</span>\r\n                      <span class="farris-label-text">{{\'component.messageNoticeEdit.messSendType\'|wfLocale}}</span>\r\n                    </label>\r\n                    <div class="farris-input-wrap ml-1">\r\n                      <farris-checkboxgroup #checkboxGroup [(ngModel)]="messageNotice.sendType" name="sendType"\r\n                        [horizontal]="true" [data]="typeGroup" (changeValue)="sendTypeChange($event)">\r\n                      </farris-checkboxgroup>\r\n                      <div class="farris-feedback valid-feedback"></div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <div class="col-8 farris-group-auto mt-2">\r\n                <div class="farris-group-wrap">\r\n                  <div class="form-group farris-form-group">\r\n                    <label class="col-form-label">\r\n                      <span class="farris-label-info text-danger">*</span>\r\n                      <span class="farris-label-text">{{\'component.messageNoticeEdit.messSubject\'|wfLocale}}</span>\r\n                    </label>\r\n                    <div class="farris-input-wrap ml-1" *ngIf="!exprAble; else disabled">\r\n                      <input class="form-control" type="text" value="subject" [(ngModel)]="messageNotice.subject"\r\n                        name="subject" />\r\n                      <div class="farris-feedback valid-feedback"></div>\r\n                    </div>\r\n                    <ng-template #disabled>\r\n                      <div class="farris-input-wrap ml-1">\r\n                        <input-group [editable]="false" [enableClear]="false" [customCls]="\'custom-cls\'" [groupText]="groupIcon2"\r\n                          [(value)]="messageNotice.subject" (clickHandle)="titleExpr($event)">\r\n                        </input-group>\r\n                      </div>\r\n                    </ng-template>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <div class="col-4 farris-group-auto mt-2">\r\n                <div class="farris-group-wrap">\r\n                  <div class="form-group farris-form-group">\r\n                    <label class="col-form-label">\r\n                      <span class="farris-label-text">{{\'component.messageNoticeEdit.enable\'|wfLocale}}</span>\r\n                    </label>\r\n                    <div class="farris-input-wrap">\r\n                      <farris-switch [(ngModel)]="exprAble" name="enable" (click)="tranExpr()"></farris-switch>\r\n                      <div class="farris-feedback valid-feedback"></div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <div class="col-12 farris-group-auto mt-2">\r\n                <div class="farris-group-wrap">\r\n                  <div class="form-group farris-form-group">\r\n                    <label class="col-form-label">\r\n                      <span class="farris-label-info text-danger">*</span>\r\n                      <span class="farris-label-text">{{\'component.messageNoticeEdit.messContent\'|wfLocale}}</span>\r\n                    </label>\r\n                    <div class="farris-input-wrap ml-1">\r\n                      <input-group [editable]="false" [enableClear]="false" [customCls]="\'custom-cls\'" [groupText]="groupIcon2"\r\n                        [(value)]="messageNotice.content" (clickHandle)="contentExpr($event)">\r\n                      </input-group>\r\n                      <div class="farris-feedback valid-feedback"></div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <div class="col-12 farris-group-auto mt-2">\r\n                <div class="farris-group-wrap">\r\n                  <div class="form-group farris-form-group">\r\n                    <label class="col-form-label">\r\n                      <span class="farris-label-info text-danger">*</span>\r\n                      <span class="farris-label-text">{{\'component.messageNoticeEdit.recipient\'|wfLocale}}</span>\r\n                    </label>\r\n                    <div class="farris-input-wrap">\r\n                      <div class="text-right mb-2">\r\n                        <farris-button [type]="\'link\'" (click)="addReceiver()" [disabled]="disableAdd()">\r\n                          <span class="f-icon f-icon-add"></span>\r\n                          {{\'component.messageNoticeEdit.addReceiver\'|wfLocale}}</farris-button>\r\n                      </div>\r\n                      <div *ngFor="let receiver of messageNotice.receivers; let i=index" class="col-12 d-flex px-0">\r\n                        <div class="farris-group-wrap col-4 pl-0">\r\n                          <div class="form-group farris-form-group">\r\n                            <div class="farris-input-wrap">\r\n                              <farris-combo-list [(ngModel)]="receiver.type" [idField]="\'value\'" [textField]="\'text\'"\r\n                                [enableClear]="true" [data]="receiverTypes" [name]="\'receiverType\'+i"\r\n                                [editable]="false">\r\n                              </farris-combo-list>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                        <div *ngIf="receiver.type===\'processParticipant\'" class="farris-group-wrap col-4 pl-0">\r\n                          <div class="form-group farris-form-group">\r\n                            <div class="farris-input-wrap">\r\n                              <farris-combo-list [(ngModel)]="receiver.processParticipant" [idField]="\'value\'"\r\n                                [textField]="\'text\'" [enableClear]="false" [data]="processParticipantTypes"\r\n                                [name]="\'processParticipantType\'+i" [editable]="false">\r\n                              </farris-combo-list>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                        <div\r\n                          *ngIf="receiver.type===\'processParticipant\' && receiver.processParticipant===\'activityExecutorParticipant\'"\r\n                          class="farris-group-wrap col-4 px-0">\r\n                          <div class="form-group farris-form-group">\r\n                            <div class="farris-input-wrap">\r\n                              <input-group [editable]="false" [customCls]="\'custom-cls\'" [groupText]="groupIcon2"\r\n                                [enableClear]="true" (clear)="clearActivityExecutor(i)"\r\n                                [(value)]="receiver.activityDefName"\r\n                                (clickHandle)="selectActivityExecutorParticipant(receiver.activityDefId, i)">\r\n                              </input-group>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                        <div *ngIf="receiver.type===\'variableParticipant\'" class="farris-group-wrap col-5 px-0">\r\n                          <div class="form-group farris-form-group">\r\n                            <div class="farris-input-wrap">\r\n                              <input-group [editable]="false" [customCls]="\'custom-cls\'" [groupText]="groupIcon2"\r\n                                [enableClear]="true" (clear)="clearVariableParticipant(i)"\r\n                                [(value)]="receiver.variableName"\r\n                                (clickHandle)="selectVariableParticipant(receiver.variableParticipant, i)">\r\n                              </input-group>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                        <div *ngIf="receiver.type===\'variableParticipant\'" class="farris-group-wrap col-3 px-0 pl-3">\r\n                          <div class="form-group farris-form-group">\r\n                            <div class="farris-input-wrap">\r\n                              <farris-combo-list [(ngModel)]="receiver.orgType" [idField]="\'value\'" [textField]="\'name\'"\r\n                                [enableClear]="false" [data]="variableOrgTypes" [name]="\'variableParticipantOrgType\'+i"\r\n                                [editable]="false">\r\n                              </farris-combo-list>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                        <div *ngIf="receiver.type===\'userParticipant\'" class="farris-group-wrap col-8 px-0">\r\n                          <div class="form-group farris-form-group">\r\n                            <div class="farris-input-wrap">\r\n                              <input-group [editable]="false" [customCls]="\'custom-cls\'" [groupText]="groupIcon2"\r\n                                [(value)]="receiver.userNames" (clickHandle)="selectUserParticipant(receiver, i)"\r\n                                (clear)="clearUsers(i)">\r\n                              </input-group>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                        <div *ngIf="receiver.type===\'positionParticipant\'" class="farris-group-wrap col-8 px-0">\r\n                          <div class="form-group farris-form-group">\r\n                            <div class="farris-input-wrap">\r\n                              <input-group [editable]="false" [customCls]="\'custom-cls\'" [groupText]="groupIcon2"\r\n                                [enableClear]="true" (clear)="clearPosition(i)"\r\n                                [value]="receiver.positionId?(\'component.messageNoticeEdit.posi\'|wfLocale)+receiver.positionName+\'；\'+(receiver.orgId?((\'component.messageNoticeEdit.organization\'|wfLocale))+receiver.orgId:\'\'):\'\'"\r\n                                (clickHandle)="selectPositionParticipant(receiver, i)">\r\n                              </input-group>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <lib-sms-message-template *ngIf="hasSmsTemplate" [smsMessageTemplate]="this.messageNotice.smsMessageTemplate"></lib-sms-message-template>\r\n          </form>\r\n        </perfect-scrollbar>\r\n      </div>\r\n    </section>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #footer>\r\n  <button type="button" class="btn btn-secondary btn-sm mx-2" (click)="clickCancel()">{{\'component.messageNoticeEdit.clickCancel\'|wfLocale}}</button>\r\n  <button type="button" class="btn btn-primary btn-sm mx-2" (click)="clickOK()">{{\'component.messageNoticeEdit.clickOK\'|wfLocale}}</button>\r\n</ng-template>\r\n\r\n\r\n<sys-farris-grid-lookup #userHelp style="display: none;" [singleSelect]="false" [displayTxt]="bindingData.name"\r\n  [pagination]="true" [pageSize]="20" title="{{\'component.messageNoticeEdit.sys\'|wfLocale}}" [sourceType]="\'user\'" (afterConfirm)="usersSelect($event)"\r\n  [bindingData]="bindingData" [filter]="{notGetCurrentUser:false, notGetStopUser: true}" [typeMode]="1"\r\n  [required]="false">\r\n</sys-farris-grid-lookup>\r\n',providers:[x],styles:[".help-tip{text-align:center;background-color:#bcdbea;border-radius:50%;width:20px;height:20px;font-size:6px;cursor:default}"]}]}],p.ctorParameters=function(){return[{type:r.MessagerService},{type:a},{type:D.ExpressionService},{type:b.ComponentFactoryResolver},{type:b.Injector},{type:i.BsModalService},{type:a},{type:t.HttpService},{type:b.ChangeDetectorRef,decorators:[{type:b.Optional}]},{type:String,decorators:[{type:b.Inject,args:[b.LOCALE_ID]}]},{type:undefined,decorators:[{type:b.Inject,args:[o]}]},{type:x,decorators:[{type:b.Optional}]}]},p.propDecorators={footer:[{type:b.ViewChild,args:["footer"]}],SmsTemplate:[{type:b.ViewChild,args:[Lr]}],closeEmitter:[{type:b.Output}],submitEmitter:[{type:b.Output}],userHelp:[{type:b.ViewChild,args:[j.SysFarrisLookupComponent]}],location:[{type:b.Input}],value:[{type:b.Input}]};var ri=p;function p(e,t,r,i,n,o,a,s,l,c,p,d){var u=this;this.message=e,this.uistate=t,this.expr=r,this.resolver=i,this.injector=n,this.modalService=o,this.designerUIState=a,this.http=s,this.cdr=l,this.localeId=c,this.resources=p,this.localePipe=d,this.groupIcon2='<i class="f-icon f-icon-lookup"></i>',this.exprAble=!1,this.closeEmitter=new b.EventEmitter,this.submitEmitter=new b.EventEmitter,this._location="activity",this.messageNotice=new Gr,this.typeGroup=this.uistate.messageChannels.map(function(e){return{value:e.code,name:e.name}}),this.receiverVariables=[{value:"workItemParticipant",name:this.localePipe.transform("component.messageNoticeEdit.workItemParticipant")}],this.variableOrgTypes=[{name:this.localePipe.transform("component.messageNoticeEdit.sys"),value:"Sys"},{name:this.localePipe.transform("component.messageNoticeEdit.administrative_organization"),value:"Administrative_organization"}],this.sendTimes=[],this.bindingData={},this.receiverTypes=[{value:"processParticipant",text:this.localePipe.transform("component.MessageNotice.processParticipant")},{value:"variableParticipant",text:this.localePipe.transform("component.MessageNotice.variableParticipant")},{value:"userParticipant",text:this.localePipe.transform("component.MessageNotice.userParticipant")},{value:"positionParticipant",text:this.localePipe.transform("component.MessageNotice.positionParticipant")}],this.processParticipantTypes=[{value:"procInstCreator",text:this.localePipe.transform("component.MessageNotice.procInstCreator")},{value:"workItemParticipant",text:this.localePipe.transform("component.MessageNotice.workItemParticipant")},{value:"activityExecutorParticipant",text:this.localePipe.transform("component.MessageNotice.activityExecutorParticipant")}],this.userTypeButtonNeedShow=!1,this.hasSmsTemplate=!1,this.disableAdd=function(){return"WORKITEM_CREATED"===u.messageNotice.sendTime&&0<u.messageNotice.receivers.filter(function(e){return e.type}).length},this.processSendTime=[{value:"PROCESSINSTANCE_COMPLETED",text:this.localePipe.transform("component.MessageNotice.procComplete")},{value:"PROCESSINSTANCE_ABORTED",text:this.localePipe.transform("component.MessageNotice.procAborted")},{value:"PROCESSINSTANCE_ROLLBACK",text:this.localePipe.transform("component.MessageNotice.procRollBack")}],this.ReceiverType=[{value:"processParticipant",text:this.localePipe.transform("component.MessageNotice.processParticipant")},{value:"variableParticipant",text:this.localePipe.transform("component.MessageNotice.variableParticipant")},{value:"userParticipant",text:this.localePipe.transform("component.MessageNotice.userParticipant")},{value:"positionParticipant",text:this.localePipe.transform("component.MessageNotice.positionParticipant")}],this.activitySendTime=[{value:"WORKITEM_CREATED",text:this.localePipe.transform("component.MessageNotice.workCreated")},{value:"ACTIVITY_COMPLETED",text:this.localePipe.transform("component.MessageNotice.actComplete")},{value:"ACTIVITY_ABORTED",text:this.localePipe.transform("component.MessageNotice.actAborted")}],this.localePipe=this.localePipe||new x(c,p)}var ii=function(){},ni=(oi.prototype.ngOnInit=function(){},oi.prototype.endEdit=function(e){console.log(e)},Object.defineProperty(oi.prototype,"messageNotices",{get:function(){return this.messageNotice},set:function(e){this.messageNotice=e},enumerable:!0,configurable:!0}),oi.prototype.clickOK=function(){var e;this.targetNodeID||0!==this.targetNodeID.length?this.messageNotice||0!==this.messageNotice.length?((e=new ii).messageNotice=this.messageNotice,e.targetNodeID=this.targetNodeID,e.isBatchCopy=!0,this.submitEmitter.emit({value:e,parameters:null})):this.message.info(this.localePipe.transform("component.MessageNotice.noMessageNotifyAttribute")):this.message.info(this.localePipe.transform("component.MessageNotice.noTargetNode"))},oi.prototype.clickCancel=function(){this.closeEmitter.emit()},oi.decorators=[{type:b.Component,args:[{selector:"lib-message-notice-copy",template:'<div class="f-page">\r\n  <div class="f-utils-fill-flex-column farris-split-section m-2 h-100">\r\n    <section class="f-utils-fill-flex-column h-100">\r\n      <div class="f-utils-fill-flex-column h-100">\r\n        <form class="h-100">\r\n          <div class="f-utils-fill-flex-column h-100">\r\n            \x3c!-- 可选节点目标小标题 --\x3e\r\n            <div class="mx-2 mt-1">\r\n              <div class="title-content">\r\n                <h4 class="title-text">{{\'component.messageNoticeEdit.optionalNodes\'|wfLocale}}</h4><span class="title-line"></span>\r\n              </div>\r\n            </div>\r\n            <div class="mt-2 mx-4 farris-form-controls-inline">\r\n              <div class="farris-group-wrap">\r\n                \x3c!-- 附加节点帮助 --\x3e\r\n                <farris-lookup-grid #userActisDialog [items]="uistate.userActList" [columns]="cols" [resizable]="true"\r\n                  [singleSelect]="false" [idField]="\'Id\'" [textField]="\'Name\'" [(ngModel)]="actis" [valueField]="\'Id\'"\r\n                  [pagination]="false" [pageIndex]="pageInfo.pageIndex" name="defaultActivities"\r\n                  [pageSize]="pageInfo.pageSize" [pageList]="pageInfo.pageList" [total]="total" [enableClear]="false"\r\n                  title="{{\'component.messageNoticeEdit.targetNodeList\'|wfLocale}}" [displayType]="\'List\'" [remoteSearch]=\'false\' [enableToSelect]="false"\r\n                  placeholder="{{\'component.messageNoticeEdit.placeholder\'|wfLocale}}" [dictPicked]="actisSelect" [nosearch]="true" [showFilterBar]="false">\r\n                </farris-lookup-grid>\r\n              </div>\r\n            </div>\r\n            \x3c!-- 可选属性目标小标题 --\x3e\r\n            <div class="mx-2 mt-1">\r\n              <div class="title-content">\r\n                <h4 class="title-text">{{\'component.messageNoticeEdit.optionalAttribute\'|wfLocale}}</h4><span class="title-line"></span>\r\n              </div>\r\n            </div>\r\n            \x3c!-- 消息通知属性 --\x3e\r\n            <div class="f-page-main f-utils-fill-flex-column h-100">\r\n              <div class="f-utils-fill-flex-column farris-overflow-y-auto h-100">\r\n                <farris-datagrid #grid [data]="messageNotices" [columns]="columns" [idField]="\'id\'" [fit]="true"\r\n                  [fitColumns]="true" [editable]="false" [pagination]="false" [showCheckbox]="false"\r\n                  [multiSelect]="false" [showLineNumber]="true" lineNumberTitle="{{\'component.messageNoticeEdit.lineNumber\'|wfLocale}}" [lineNumberWidth]="50"\r\n                  [striped]="true" [showAllCheckbox]="false" [afterEdit]="paramAfterEdit" (endEdit)="endEdit($event)">\r\n                </farris-datagrid>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </section>\r\n  </div>\r\n</div>\r\n\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type="button" class="btn btn-secondary btn-sm" (click)="clickCancel()">{{\'component.messageNoticeEdit.clickCancel\'|wfLocale}}</button>\r\n  <button type="button" class="btn btn-primary btn-sm mx-2" (click)="clickOK()">{{\'component.messageNoticeEdit.clickOK\'|wfLocale}}</button>\r\n</ng-template>\r\n',providers:[x],styles:[".title-content{color:#000;display:inline-flex;align-items:center;line-height:1.375rem;position:relative;overflow:hidden;padding:0 0 0 1rem;min-width:760px}.title-content ::before{content:'';width:.25rem;height:1.125rem;background:#59a1ff;border-radius:1px;position:absolute;top:50%;left:0;margin-top:-.5625rem}.title-text{font-size:1rem;line-height:1.375rem;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;margin-bottom:0;margin-right:10px}.title-line{flex-grow:1;border-bottom:1px dashed rgba(0,0,0,.1)}"]}]}],oi.ctorParameters=function(){return[{type:a},{type:r.MessagerService},{type:b.ChangeDetectorRef,decorators:[{type:b.Optional}]},{type:String,decorators:[{type:b.Inject,args:[b.LOCALE_ID]}]},{type:undefined,decorators:[{type:b.Inject,args:[o]}]},{type:x,decorators:[{type:b.Optional}]}]},oi.propDecorators={modalFooter:[{type:b.ViewChild,args:["iconSelectFooter"]}],closeEmitter:[{type:b.Output}],submitEmitter:[{type:b.Output}],allActisTable:[{type:b.ViewChild,args:["allActisTable"]}],allActisDialog:[{type:b.ViewChild,args:["allActisDialog"]}],actTable:[{type:b.ViewChild,args:["actTable"]}],lookup:[{type:b.ViewChild,args:["lookup"]}]},oi);function oi(e,t,r,i,n,o){var s=this;this.uistate=e,this.message=t,this.cdr=r,this.localeId=i,this.resources=n,this.localePipe=o,this.closeEmitter=new b.EventEmitter,this.submitEmitter=new b.EventEmitter,this.cols=[{title:this.localePipe.transform("component.MessageNotice.name"),field:"Name",width:60,searchField:"Name"},{title:"ID",field:"Id",width:90,searchField:"Id"}],this.actis=[],this.fullActis=[],this.pageInfo={pageIndex:1,pageList:[10,20,30,50],pageSize:20},this.messageNotice=[],this.messageNoticeValue=[],this.targetNodeID=[],this.activitySendTime=[{value:"WORKITEM_CREATED",text:this.localePipe.transform("component.MessageNotice.workCreated")},{value:"ACTIVITY_COMPLETED",text:this.localePipe.transform("component.MessageNotice.actComplete")},{value:"ACTIVITY_ABORTED",text:this.localePipe.transform("component.MessageNotice.actAborted")}],this.columns=[{field:"subject",width:100,title:this.localePipe.transform("component.MessageNotice.subject")},{field:"content",width:150,title:this.localePipe.transform("component.MessageNotice.content"),showTips:!0},{field:"sendTime",width:100,title:this.localePipe.transform("component.MessageNotice.sendTime"),formatter:{type:"enum",options:{valueField:"value",textField:"text",data:this.activitySendTime}}},{field:"sendType",width:100,title:this.localePipe.transform("component.MessageNotice.sendType"),formatter:{type:"enum",options:{valueField:"value",textField:"name",data:this.uistate.messageChannels.map(function(e){return{value:e.code,name:e.name}})}}},{field:"receiverText",width:120,title:this.localePipe.transform("component.MessageNotice.receiverText"),showTips:!0}],this.actisSelect=function(e){var t,r;try{for(var i=ue(e),n=i.next();!n.done;n=i.next()){var o=n.value;s.targetNodeID.push(o.Id)}}catch(a){t={error:a}}finally{try{n&&!n.done&&(r=i["return"])&&r.call(i)}finally{if(t)throw t.error}}return v.of({closeDialog:!0})},this.paramAfterEdit=function(e,t,r){return console.log(t),console.log(e),v.of(!0)},this.localePipe=this.localePipe||new x(i,n)}Object.defineProperty(si.prototype,"value",{set:function(e){e&&0<e.length&&(this.messageNotices=e.map(function(e){return{id:l.GenerateElementId(),content:e.content,sendTime:e.sendTime,sendType:e.sendType,subject:e.subject,receiver:e.receiver,receiverText:e.receiverText,receivers:e.receivers||new Array,smsMessageTemplate:e.smsMessageTemplate}}))},enumerable:!0,configurable:!0}),si.prototype.ngOnInit=function(){var p=this;this.location=this.editorParams.location,this.columns=[{field:"subject",width:100,title:this.localePipe.transform("component.MessageNotice.subject")},{field:"content",width:150,title:this.localePipe.transform("component.MessageNotice.content"),showTips:!0},{field:"sendTime",width:100,title:this.localePipe.transform("component.MessageNotice.sendTime"),formatter:{type:"enum",options:{valueField:"value",textField:"text",data:"process"===this.location?this.processSendTime:this.activitySendTime}}},{field:"sendType",width:100,title:this.localePipe.transform("component.MessageNotice.sendType"),formatter:{type:"enum",options:{valueField:"value",textField:"name",data:this.uistate.messageChannels.map(function(e){return{value:e.code,name:e.name}})}}},{field:"receiverText",width:120,title:this.localePipe.transform("component.MessageNotice.receiverText"),showTips:!0,formatter:function(e,t,r){var i,n,o="";if(t.receivers&&0<t.receivers.length)try{for(var a=ue(t.receivers),s=a.next();!s.done;s=a.next()){var l=s.value;"processParticipant"===l.type?"procInstCreator"===l.processParticipant?o+=p.localePipe.transform("component.MessageNotice.procInstCreator"):"workItemParticipant"===l.processParticipant?o+=p.localePipe.transform("component.MessageNotice.workItemParticipant"):"activityExecutorParticipant"===l.processParticipant&&(o+=l.activityDefName+"，"):"userParticipant"===l.type?o+=l.userNames+"，":"variableParticipant"===l.type?o+=l.variableName+"，":"positionParticipant"===l.type&&(o+=l.positionName+"，")}}catch(c){i={error:c}}finally{try{s&&!s.done&&(n=a["return"])&&n.call(a)}finally{if(i)throw i.error}}return o=o&&o.substring(0,o.length-1)}}],"messageActivity"===this.location&&(this.columns=this.columns.filter(function(e){return"sendTime"!==e.field}))},si.prototype.add=function(){var t=this,e=this.resolver.resolveComponentFactory(ri).create(this.injector),r=(e.instance.location=this.location,new Gr),i=("activity"===this.location?(r.sendTime="WORKITEM_CREATED",(i=new Kr).type="processParticipant",i.processParticipant="workItemParticipant",r.receivers=[i]):"process"===this.location?(r.sendTime="PROCESSINSTANCE_COMPLETED",(i=new Kr).type="processParticipant",i.processParticipant="procInstCreator",r.receivers=[i]):"messageActivity"===this.location&&((i=new Kr).type="processParticipant",i.processParticipant="procInstCreator",r.receivers=[i]),e.instance.value=r,e.instance.submitEmitter.subscribe(function(e){t.messageNotices=t.messageNotices.concat([e]),n.close()}),e.instance.closeEmitter.subscribe(function(e){n.close()}),{title:this.localePipe.transform("component.MessageNotice.messageSet"),width:760,height:480,showButtons:!0,buttons:e.instance.footer}),n=this.modalService.show(e,i)},si.prototype.edit=function(){var e,t,r,i=this;this.grid.selectedRow?((e=this.resolver.resolveComponentFactory(ri).create(this.injector)).instance.location=this.location,e.instance.value=this.grid.selectedRow.data,e.instance.submitEmitter.subscribe(function(t){i.messageNotices=i.messageNotices.map(function(e){return e.id===t.id?t:e}),i.grid.unSelectRow(i.grid.selectedRow.data.id,!0),r.close()}),e.instance.closeEmitter.subscribe(function(e){r.close()}),t={title:this.localePipe.transform("component.MessageNotice.messageSet"),width:760,height:480,showButtons:!0,buttons:e.instance.footer},r=this.modalService.show(e,t)):this.message.info(this.localePipe.transform("component.MessageNotice.selectedRow"))},si.prototype.batchCopy=function(){var e,t,r,i=this;this.messageNotices?((e=this.resolver.resolveComponentFactory(ni).create(this.injector)).instance.messageNotices=this.messageNotices,e.instance.submitEmitter.subscribe(function(e){i.viewModel.copy(li.batchCopyProperty,e),r.close()}),e.instance.closeEmitter.subscribe(function(e){r.close()}),t={title:this.localePipe.transform("component.MessageNotice.batchCopy"),width:800,height:515,showButtons:!0,buttons:e.instance.modalFooter},r=this.modalService.show(e,t)):this.message.info(this.localePipe.transform("component.MessageNotice.noCopy"))},si.prototype["delete"]=function(){var t=this.grid.selectedRow;t?this.messageNotices=this.messageNotices.filter(function(e){return e.id!==t.id}):this.message.info(this.localePipe.transform("component.MessageNotice.selectedRow"))},si.prototype.clickOK=function(){var e={value:this.messageNotices,parameters:null};this.submitModal.emit(e)},si.prototype.clickCancel=function(){this.closeModal.emit()},si.prototype.GetOrganizationType=function(){var t=this;this.http.get("/api/runtime/sys/v1.0/authfields/globalauthfields").subscribe(function(e){return t.uistate.orgTypeCollection=e.map(function(e){return{value:e.id,text:e.name}})})},si.decorators=[{type:b.Component,args:[{selector:"lib-message-notice",template:'<div class="f-page">\r\n  <div class="f-page-header">\r\n    <nav class="f-page-header-base">\r\n      <div class="f-title">\r\n      </div>\r\n      <div class="btn-toolbar btn-group-lg">\r\n        <button class="btn btn-primary mr-2" (click)="add()">{{\'component.MessageNotice.add\' | wfLocale}}</button>\r\n        <button class="btn btn-secondary mr-2" (click)="edit()">{{\'component.MessageNotice.edit\' | wfLocale}}</button>\r\n        <button class="btn btn-secondary mr-2" [disabled]="location!==\'activity\'" (click)="batchCopy()">{{\'component.MessageNotice.batchCopy\' | wfLocale}}</button>\r\n        <button class="btn btn-secondary" (click)="delete()">{{\'component.MessageNotice.delete\' | wfLocale}}</button>\r\n      </div>\r\n    </nav>\r\n  </div>\r\n  <div class="f-page-main f-utils-fill-flex-column h-100">\r\n    <div class="f-utils-fill-flex-column farris-overflow-y-auto h-100" style="border-radius:16px;border: 1.5px solid #F1F3F7;">\r\n      <farris-datagrid #grid [data]="messageNotices" [columns]="columns" [idField]="\'id\'" [fit]="true"\r\n        [fitColumns]="true" [editable]="false" [pagination]="false" [showCheckbox]="false"\r\n        [multiSelect]="false" [showLineNumber]="true" lineNumberTitle="{{\'component.MessageNotice.lineNumber\'|wfLocale}}" [lineNumberWidth]="50"\r\n        [striped]="true">\r\n      </farris-datagrid>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type="button" class="btn btn-secondary btn-sm px-3 mx-2" (click)="clickCancel()">{{\'component.MessageNotice.clickCancel\' | wfLocale}}</button>\r\n  <button type="button" class="btn btn-primary btn-sm px-3 mx-2" (click)="clickOK()">{{\'component.MessageNotice.clickOK\' | wfLocale}}</button>\r\n</ng-template>\r\n',providers:[x],styles:[""]}]}],si.ctorParameters=function(){return[{type:b.ComponentFactoryResolver},{type:b.Injector},{type:i.BsModalService},{type:r.MessagerService},{type:a},{type:Ip},{type:t.HttpService},{type:b.ChangeDetectorRef,decorators:[{type:b.Optional}]},{type:String,decorators:[{type:b.Inject,args:[b.LOCALE_ID]}]},{type:undefined,decorators:[{type:b.Inject,args:[o]}]},{type:x,decorators:[{type:b.Optional}]}]},si.propDecorators={cls:[{type:b.HostBinding,args:["class"]}],closeModal:[{type:b.Output}],submitModal:[{type:b.Output}],value:[{type:b.Input}],editorParams:[{type:b.Input}],modalFooter:[{type:b.ViewChild,args:["iconSelectFooter"]}],grid:[{type:b.ViewChild,args:["grid"]}]};var ai=si;function si(e,t,r,i,n,o,a,s,l,c,p){this.resolver=e,this.injector=t,this.modalService=r,this.message=i,this.uistate=n,this.viewModel=o,this.http=a,this.cdr=s,this.localeId=l,this.resources=c,this.localePipe=p,this.cls="farris-main-area flex-column",this.closeModal=new b.EventEmitter,this.submitModal=new b.EventEmitter,this.editorParams={},this.modalConfig={title:this.localePipe.transform("component.MessageNotice.notify"),width:760,height:480,showButtons:!0},this.messageNotices=new Array,this.columns=[],this.location="activity",this.processSendTime=[{value:"PROCESSINSTANCE_COMPLETED",text:this.localePipe.transform("component.MessageNotice.procComplete")},{value:"PROCESSINSTANCE_ABORTED",text:this.localePipe.transform("component.MessageNotice.procAborted")},{value:"PROCESSINSTANCE_ROLLBACK",text:this.localePipe.transform("component.MessageNotice.procRollBack")}],this.activitySendTime=[{value:"WORKITEM_CREATED",text:this.localePipe.transform("component.MessageNotice.workCreated")},{value:"ACTIVITY_COMPLETED",text:this.localePipe.transform("component.MessageNotice.actComplete")},{value:"ACTIVITY_ABORTED",text:this.localePipe.transform("component.MessageNotice.actAborted")}],this.localePipe=this.localePipe||new x(l,c),this.GetOrganizationType()}var li={batchCopyProperty:"batchCopyProperty"},ci=(pi.prototype.convertTo=function(e){return e&&0<e.length?this.localePipe.transform("component.MessageNotice.set"):this.localePipe.transform("component.MessageNotice.notSet")},pi);function pi(e){this.localePipe=e}Object.defineProperty(ui.prototype,"value",{set:function(e){e&&0<e.length&&(this.procExtendProperty=e.map(function(e){return{id:e.id,code:e.code,parentId:e.parentId,sortOrder:e.sortOrder,propertyNote:e.propertyNote,propertyTitle:e.propertyTitle,propertyLocation:e.propertyLocation,propertyType:e.propertyType,enumValue:e.enumValue,bizDefKey:e.bizDefKey,bizCategoryId:e.bizCategoryId,startMode:e.startMode,value:e.value}}))},enumerable:!0,configurable:!0}),ui.prototype.setProperty=function(e){this.uiState.propertyData=e.propertyData,this.uiState.propertyConfig=e.propertyConfig},ui.prototype.ngOnInit=function(){},ui.prototype.clickOK=function(){var e=this.procExtendProperty;this.submitModal.emit({value:e,parameters:null})},ui.prototype.cancel=function(){this.closeModal.emit()},ui.decorators=[{type:b.Component,args:[{selector:"lib-extend-property",template:'<div class="f-page">\r\n  <div class="f-page-main">\r\n    <section class="">\r\n      <div class="f-section-header pt-2 mx-2">\r\n      </div>\r\n      <div class="f-section-content">\r\n        <div class="f-form-layout farris-form farris-form-controls-inline">\r\n          <fieldset class="f-section-formgroup"\r\n            style="flex-grow: 1; overflow-y: auto; height: 210px;">\r\n            <div class="f-section-formgroup-inputs">\r\n              <ng-container *ngFor="let data of procExtendProperty">\r\n                \x3c!-- 文本型属性框 --\x3e\r\n                <div *ngIf="data.propertyType === \'text\'" class="col-12 farris-group-auto pr-5">\r\n                  <div class="farris-group-wrap">\r\n                    <div class="form-group farris-form-group">\r\n                      <label class="col-form-label">\r\n                        <span class="farris-label-text">{{data.propertyTitle}}</span>\r\n                      </label>\r\n                      <div class="farris-input-wrap ml-1" style="padding-right: 30px">\r\n                        <input-group [(ngModel)]="data.value"></input-group>\r\n                        <div class="farris-feedback valid-feedback"></div>\r\n                      </div>\r\n                      <span class="f-icon f-icon-info" farrisPopover popoverTitle="{{\'component.extendProperty.extendProperty\'|wfLocale}}"\r\n                        [popover]="data.propertyNote" [container]="\'body\'" [triggers]="\'hover\'"\r\n                        [placement]="\'left\'"></span>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n                \x3c!-- 枚举型属性框 --\x3e\r\n                  <div *ngIf="data.propertyType === \'enum\'" class="col-12 farris-group-auto pr-5">\r\n                    <div class="farris-group-wrap">\r\n                      <div class="form-group farris-form-group">\r\n                        <label class="col-form-label">\r\n                          <span class="farris-label-text">{{data.propertyTitle}}</span>\r\n                        </label>\r\n                        <div class="farris-input-wrap ml-1" style="padding-right: 30px">\r\n                          <farris-combo-list autoHeight="true" [(ngModel)]="data.value" name="booleanProperty"\r\n                            [idField]="\'value\'" [textField]="\'key\'" [valueField]="\'value\'" [data]="data.enumValue"\r\n                            placeholder="{{\'component.extendProperty.placeholder\'|wfLocale}}">\r\n                          </farris-combo-list>\r\n                          <div class="farris-feedback valid-feedback"></div>\r\n                        </div>\r\n                        <span class="f-icon f-icon-info" farrisPopover popoverTitle="{{\'component.extendProperty.illustrate\'|wfLocale}}"\r\n                          [popover]="data.propertyNote" [container]="\'body\'" [triggers]="\'hover\'"\r\n                          [placement]="\'left\'"></span>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                \x3c!-- 布尔型属性框 mt-4 --\x3e\r\n                  <div *ngIf="data.propertyType === \'boolean\'" class="col-12 farris-group-auto pr-5">\r\n                    <div class="farris-group-wrap">\r\n                      <div class="form-group farris-form-group">\r\n                        <label class="col-form-label">\r\n                          <span class="farris-label-text">{{data.propertyTitle}}</span>\r\n                        </label>\r\n                        <div class="farris-input-wrap ml-1" style="padding-right: 30px">\r\n                          <farris-combo-list autoHeight="true" [(ngModel)]="data.value" name="booleanProperty"\r\n                            [idField]="\'value\'" [textField]="\'key\'" [valueField]="\'value\'" [data]="booleanlist"\r\n                            placeholder="{{\'component.extendProperty.placeholder\'|wfLocale}}">\r\n                          </farris-combo-list>\r\n                          <div class="farris-feedback valid-feedback"></div>\r\n                        </div>\r\n                        <span class="f-icon f-icon-info" farrisPopover popoverTitle="{{\'component.extendProperty.illustrate\'|wfLocale}}"\r\n                          [popover]="data.propertyNote" [container]="\'body\'" [triggers]="\'hover\'"\r\n                          [placement]="\'left\'"></span>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n              </ng-container>\r\n            </div>\r\n          </fieldset>\r\n        </div>\r\n      </div>\r\n    </section>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type="button" class="btn btn-secondary btn-sm mx-2" (click)="cancel()">{{\'component.extendProperty.cancel\' | wfLocale}}</button>\r\n  <button type="button" class="btn btn-primary btn-sm mx-2" (click)="clickOK()">{{\'component.extendProperty.clickOK\' | wfLocale}}</button>\r\n</ng-template>\r\n',providers:[x],styles:[""]}]}],ui.ctorParameters=function(){return[{type:a},{type:b.ChangeDetectorRef,decorators:[{type:b.Optional}]},{type:String,decorators:[{type:b.Inject,args:[b.LOCALE_ID]}]},{type:undefined,decorators:[{type:b.Inject,args:[o]}]},{type:x,decorators:[{type:b.Optional}]}]},ui.propDecorators={closeModal:[{type:b.Output}],submitModal:[{type:b.Output}],modalFooter:[{type:b.ViewChild,args:["iconSelectFooter"]}],value:[{type:b.Input}]};var di=ui;function ui(e,t,r,i,n){this.uiState=e,this.cdr=t,this.localeId=r,this.resources=i,this.localePipe=n,this.closeModal=new b.EventEmitter,this.submitModal=new b.EventEmitter,this.modalConfig={title:this.localePipe.transform("component.extendProperty.extendProperty"),width:430,height:370,showButtons:!0},this.procExtendProperty=new Array,this.booleanlist=[{key:this.localePipe.transform("component.extendProperty.true"),value:"true"},{key:this.localePipe.transform("component.extendProperty.false"),value:"false"}],this.extendPropertyList={key:"",value:""},this.localePipe=this.localePipe||new x(r,i)}fi.prototype.convertTo=function(e){return e&&e instanceof Array&&e.some(function(e){return e.value})?this.localePipe.transform("component.extendProperty.set"):this.localePipe.transform("component.extendProperty.notSet")};var mi=fi;function fi(e){this.localePipe=e}var hi=function(){},yi=(Object.defineProperty(gi.prototype,"value",{set:function(e){e&&(this.imageSetting.imageOperation=e.imageOperation)},enumerable:!0,configurable:!0}),gi.prototype.ngOnInit=function(){},gi.prototype.changeValue=function(e){var t=this;-1<e.indexOf("onlyView")&&setTimeout(function(){t.message.info(t.localePipe.transform("component.imageSet.mutualExclusion")),t.imageSetting.imageOperation="onlyView"},100)},gi.prototype.clickOK=function(){var e=this.imageSetting;this.submitModal.emit({value:e,parameters:null})},gi.prototype.clickCancel=function(){this.closeModal.emit()},gi.decorators=[{type:b.Component,args:[{selector:"lib-image-set",template:'<div class="f-page">\r\n  <div class="f-utils-fill-flex-column farris-split-section m-2 h-100">\r\n    <section class="f-utils-fill-flex-column h-100">\r\n      \x3c!-- <div class="f-section-header pt-2 mx-2">\r\n        <div class="f-title">\r\n          <h4 class="f-title-text">影像设置</h4>\r\n        </div>\r\n      </div> --\x3e\r\n      <div class="f-utils-fill-flex-column h-100">\r\n        <div class="farris-form form-inline farris-form-inline">\r\n          <div class="col-12 farris-group-auto my-3 pr-5">\r\n            <div class="farris-group-wrap">\r\n              <div class="form-group farris-form-group">\r\n                <label class="col-form-label">\r\n                  <span class="farris-label-text">{{\'component.imageSet.imageOperation\'|wfLocale}}</span>\r\n                </label>\r\n                <div class="farris-input-wrap ml-1">\r\n                  <farris-checkboxgroup [data]="operationList" [(ngModel)]="imageSetting.imageOperation" [horizontal]="true"\r\n                  [isStringValue]=true (changeValue)="changeValue($event)">\r\n                  </farris-checkboxgroup>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </section>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type="button" class="btn btn-secondary btn-sm mx-2" (click)="clickCancel()">{{\'component.imageSet.clickCancel\'|wfLocale}}</button>\r\n  <button type="button" class="btn btn-primary btn-sm mx-2" (click)="clickOK()">{{\'component.imageSet.clickOK\'|wfLocale}}</button>\r\n</ng-template>\r\n\r\n',providers:[x],styles:[""]}]}],gi.ctorParameters=function(){return[{type:r.MessagerService},{type:b.ChangeDetectorRef,decorators:[{type:b.Optional}]},{type:String,decorators:[{type:b.Inject,args:[b.LOCALE_ID]}]},{type:undefined,decorators:[{type:b.Inject,args:[o]}]},{type:x,decorators:[{type:b.Optional}]}]},gi.propDecorators={closeModal:[{type:b.Output}],submitModal:[{type:b.Output}],value:[{type:b.Input}],modalFooter:[{type:b.ViewChild,args:["iconSelectFooter"]}]},gi);function gi(e,t,r,i,n){this.message=e,this.cdr=t,this.localeId=r,this.resources=i,this.localePipe=n,this.closeModal=new b.EventEmitter,this.submitModal=new b.EventEmitter,this.modalConfig={title:this.localePipe.transform("component.imageSet.imageSet"),width:520,height:360,showButtons:!0},this.operationList=[{value:"onlyView",name:this.localePipe.transform("component.imageSet.onlyView")},{value:"edit",name:this.localePipe.transform("component.imageSet.edit")},{value:"reScanStart",name:this.localePipe.transform("component.imageSet.reScanStart")},{value:"reScanComplete",name:this.localePipe.transform("component.imageSet.reScanComplete")}],this.imageSetting=new hi,this.localePipe=this.localePipe||new x(r,i)}bi.prototype.convertTo=function(e){return e&&e.imageOperation?this.localePipe.transform("component.imageSet.set"):this.localePipe.transform("component.imageSet.notSet")};var vi=bi;function bi(e){this.localePipe=e}var xi=new b.InjectionToken("BIF_LANG_RESOURCES"),wi=(Pi.prototype.transform=function(e){return this.lang[e]||e},Pi.prototype.instant=function(e){return this.transform(e)},Pi.decorators=[{type:b.Pipe,args:[{name:"aifLocale"}]}],Pi.ctorParameters=function(){return[{type:String,decorators:[{type:b.Inject,args:[b.LOCALE_ID]}]},{type:undefined,decorators:[{type:b.Inject,args:[xi]}]}]},Pi);function Pi(e,t){this.defaultLang="zh-CHS",this.langCode=e||this.defaultLang,this.resources=t||{},this.lang=t[this.langCode]||t[this.defaultLang]||{}}Ii.prototype.createConditionEntity=function(){var e=new f.ConditionEntity;return e.id=this.generateGUID(),e.isEnabled=!0,e.type=f.ConditionType.COMPONENT,e},Ii.prototype.generateGUID=function(){var r=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=(r+16*Math.random())%16|0;return r=Math.floor(r/16),("x"==e?t:3&t|8).toString(16)})},Ii.decorators=[{type:b.Injectable}];var Ci=Ii;function Ii(){}Object.defineProperty(Ei.prototype,"dgTotal",{get:function(){return this.dgData.length||0},enumerable:!0,configurable:!0}),Ei.prototype.toolbarClickHandler=function(e){switch(e.id){case"btn-add":this.add();break;case"btn-remove":this.remove(null)}},Ei.prototype.startRowEdit=function(e){return this.dg.editRow(e.rowData.id),this.editingRowId=e.rowData.id,this.cdf.detectChanges(),!1},Ei.prototype.cancelRowEdit=function(e){return this.dg.cancelEdit(e.rowData.id),this.editingRowId=null,this.cdf.detectChanges(),!1},Ei.prototype.endRowEdit=function(e){return this.dg.endRowEdit(),this.editingRowId=null,this.cdf.detectChanges(),!1},Ei.prototype.remove=function(e,t){var r,i,n=[];if(null==t?this.dg.checkeds.forEach(function(e){n.push(e.id)}):n.push(t.rowData.id),0==n.length)this.notify.warning(this.localePipe.instant("pleaseSelectOneItemAtLeast"));else{try{for(var o=ue(n),a=o.next();!a.done;a=o.next()){var s=a.value;this.dg.deleteRow(s)}}catch(l){r={error:l}}finally{try{a&&!a.done&&(i=o["return"])&&i.call(o)}finally{if(r)throw r.error}}this.dgData=this.dg.data,null!=this.editingRowId&&(n.includes(this.editingRowId)?this.editingRowId=null:this.dg.editRow(this.editingRowId)),this.cdf.detectChanges()}return null!=e&&e.stopPropagation(),!1},Ei.prototype.rowMove=function(e,t,r){var i=this.dgData,t=this.findIndex(i,t.rowData.id);if(!(-1==t||1==r&&t==i.length-1||-1==r&&0==t))return i[t]=[i[t+r],i[t+r]=i[t]][0],this.dgData=w(this.dgData),this.cdf.detectChanges(),null!=e&&e.stopPropagation(),!1},Ei.prototype.findIndex=function(e,t){for(var r=-1,i=0;i<e.length;i++)if(e[i].id==t){r=i;break}return r};var Si=Ei;function Ei(e,t,r,i,n,o,a,s){this.messager=e,this.notify=t,this.metadataService=r,this.modalService=i,this.localePipe=n,this.injector=o,this.resolver=a,this.cdf=s,this.groupIcon='<i class="f-icon f-icon-lookup"></i>',this.toolbarData=[{id:"btn-add",text:this.localePipe.instant("add"),"class":"btn btn-secondary",disabled:!1},{id:"btn-remove",text:this.localePipe.instant("remove"),"class":"btn btn-secondary",disabled:!1}],this.dgIdField="id",this.editingRowId=null}var Ti,Ai={"zh-CHS":{startCondition:"启动条件",yes:"是",no:"否",confirm:"确定",edit:"编辑",moveUp:"上移",moveDown:"下移",add:"新增",remove:"删除",isEnabled:"是否启用",type:"类型",commonComponent:"通用构件",expression:"表达式",billAction:"业务动作",content:"内容",description:"描述",operation:"操作",typeMustNotBeNull:"类型不可为空",contentMustNotBeNull:"内容不可为空",commonComponentMetadataSelector:"通用构件选择",pleaseSelectOneItemAtLeast:"请至少选择一条数据",pleaseEndCurrentRowEditing:"请先结束当前行编辑"},en:{startCondition:"Start Condition",yes:"Yes",no:"No",confirm:"Confirm",edit:"Edit",moveUp:"Move Up",moveDown:"Move Down",add:"Add",remove:"Remove",isEnabled:"Is Enabled",type:"Type",commonComponent:"Common Component",expression:"Expression",billAction:"Bill Action",content:"Content",description:"Description",operation:"Operation",typeMustNotBeNull:"Type must not be null",contentMustNotBeNull:"Content must not be null",commonComponentMetadataSelector:"Common Component Selector",pleaseSelectOneItemAtLeast:"Please select one item at least",pleaseEndCurrentRowEditing:"Please end current row editing"},"zh-CHT":{startCondition:"啓動條件",yes:"是",no:"否",confirm:"確定",edit:"編輯",moveUp:"上移",moveDown:"下移",add:"新增",remove:"刪除",isEnabled:"是否啓用",type:"類型",commonComponent:"通用構件",expression:"表達式",billAction:"業務動作",content:"內容",description:"描述",operation:"操作",typeMustNotBeNull:"類型不可爲空",contentMustNotBeNull:"內容不可爲空",commonComponentMetadataSelector:"通用構件選擇",pleaseSelectOneItemAtLeast:"請至少選擇壹條數據",pleaseEndCurrentRowEditing:"請先結束當前行編輯"}},ki=Ai,Oi=(n(d,Ti=Si),Object.defineProperty(d.prototype,"value",{set:function(e){e=(e=e||"[]")?[]:f.BpmnModelJsonHelper.FromJson(e,f.ConditionEntity);this.designedConditionEntities=e.map(function(e){var t,r={id:e.id,isEnabled:e.isEnabled,name:e.name,type:e.type,remarks:e.remarks,component:{},expression:{}};return r.type==f.ConditionType.COMPONENT?((t=new f.ComponentConditionContent).LoadFromJson(e.content),r.component.compId=t.componentId,r.component.compMetadataId=t.componentMetadataId,r.component.compName=t.name,r.displayedContent=r.component.compName):r.type==f.ConditionType.EXPRESSION&&((t=new f.ExpressionConditionContent).LoadFromJson(e.content),r.expression.exprContent=t.expressionContent,r.displayedContent=r.expression.exprContent),r})},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"dgData",{get:function(){return this.designedConditionEntities},set:function(e){this.designedConditionEntities=e},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"dgTotal",{get:function(){return this.dgData.length||0},enumerable:!0,configurable:!0}),d.prototype.ngOnInit=function(){this.configDgColumns()},d.prototype.clickOk=function(){var e;this.dg.isEditing()||null!=this.editingRowId||(e=this.designedConditionEntities.map(function(e){var t,r=new f.ConditionEntity;return r.id=e.id,r.isEnabled=e.isEnabled,r.name=e.name,r.type=e.type,r.remarks=e.remarks,e.type==f.ConditionType.COMPONENT?((t=new f.ComponentConditionContent).name=e.component.compName,t.componentId=e.component.compId,t.componentMetadataId=e.component.compMetadataId,r.content=t.ConvertToJson()):e.type==f.ConditionType.EXPRESSION&&((t=new f.ExpressionConditionContent).expressionContent=e.expression.exprContent,r.content=t.ConvertToJson()),r}),e=f.BpmnModelJsonHelper.ToJson(e),this.submitModal.emit({value:e,parameters:null}))},d.prototype.clickCancel=function(){this.closeModal.emit()},d.prototype.load=function(){throw new Error("Method not implemented.")},d.prototype.toolbarClickHandler=function(e){switch(e.id){case"btn-add":this.add();break;case"btn-remove":this.remove(null)}},d.prototype.add=function(){var e,t,r=this;0==this.dg.isEditing()||null==this.dg.isEditing()?(t={id:(e=this.startConditionService.createConditionEntity()).id,name:e.name,type:e.type,isEnabled:e.isEnabled,remarks:e.remarks,component:{},expression:{}},this.dgData=w(this.dgData,[t]),this.cdf.detectChanges(),setTimeout(function(){r.dg.editRow(e.id),r.editingRowId=e.id},0)):this.notify.warning(this.localePipe.instant("pleaseEndCurrentRowEditing"))},d.prototype.remove=function(e,t){var r,i,n=[];if(null==t?this.dg.checkeds.forEach(function(e){n.push(e.id)}):n.push(t.rowData.id),0==n.length)this.notify.warning(this.localePipe.instant("pleaseSelectOneItemAtLeast"));else{try{for(var o=ue(n),a=o.next();!a.done;a=o.next()){var s=a.value;this.dg.deleteRow(s)}}catch(l){r={error:l}}finally{try{a&&!a.done&&(i=o["return"])&&i.call(o)}finally{if(r)throw r.error}}this.dgData=this.dg.data,null!=this.editingRowId&&(n.includes(this.editingRowId)?this.editingRowId=null:this.dg.editRow(this.editingRowId)),this.cdf.detectChanges()}return null!=e&&e.stopPropagation(),!1},d.prototype.selectContent=function(e){switch(e.form.value.type){case f.ConditionType.COMPONENT:this.selectCommonComp(e);break;case f.ConditionType.EXPRESSION:this.showExpression(e);break;case f.ConditionType.VOACTION:this.selectVOAction(e)}},d.prototype.selectCommonComp=function(i){var e=this.cfr.resolveComponentFactory(Fe.SelectMetadataRTComponent).create(this.inj),t=(e.instance.typeList="CommonComponent",e.instance.selectedMetadata.subscribe(function(e){new f.ComponentConditionContent;var e=e.metadata,t=i.form.bindingData,r=(t.component.compName=e.name,t.component.compMetadataId=e.id,JSON.parse(e.content));t.component.compId=r.id||r.Id||r.ID||e.id,t.displayedContent=t.component.compName,i.formControl.setValue(t.displayedContent),i.instance.cd.detectChanges()}),{title:this.localePipe.instant("commonComponentMetadataSelector"),width:930,height:573,showButtons:!1}),r=this.modal.show(e,t);e.instance.closeModalEmitter.subscribe(function(e){return r.close()})},d.prototype.selectVOAction=function(e){},d.prototype.showExpression=function(r){var e,t,i,n,o=this,a=new Array;if(0<this.designerState.subActivityContext.length)try{for(var s=ue(this.designerState.subActivityContext),l=s.next();!l.done;l=s.next())!function(t){a.some(function(e){return e.key===t.key})||a.push(t)}(l.value)}catch(u){e={error:u}}finally{try{l&&!l.done&&(t=s["return"])&&t.call(s)}finally{if(e)throw e.error}}if(0<a.length)try{for(var c=ue(a),p=c.next();!p.done;p=c.next()){var d=p.value;this.expr.addContext(d)}}catch(m){i={error:m}}finally{try{p&&!p.done&&(n=c["return"])&&n.call(c)}finally{if(i)throw i.error}}this.expr.addExpressionText(r.formControl.value),this.configExpressionExpendFuncs(),this.des.getSchemaById(this.editorParams.voId).subscribe(function(e){o.expr.addNewSchema(e.name,e),o.expr.addInjectedEntity(e.entityTypes[0].code,e.name,e.entityTypes[0].code,D.InjectedType.EntityType),o.expr.buildExpression(!o.canEdit).then(function(e){new f.ExpressionConditionContent;var t=r.form.bindingData;t.expression.exprContent=e,t.displayedContent=t.expression.exprContent,r.formControl.setValue(t.displayedContent),r.instance.cd.detectChanges(),0<a.length&&(o.expr.exprEntity.contextEntities=o.expr.exprEntity.contextEntities.filter(function(t){return!a.some(function(e){return e.key===t.key})}))})})},d.prototype.clearContent=function(e){var t=e.form.bindingData;t.displayedContent=null,t.component.compName=null,t.component.compMetadataId=null,t.component.compId=null,t.expression.exprContent=null,e.formControl.setValue(null),e.instance.cd.detectChanges()},d.prototype.configDgColumns=function(){var i=this;this.dgColumns=[{field:"isEnabled",title:this.localePipe.instant("isEnabled"),width:100,template:this.dgIsEnabledStateCell},{field:"type",title:this.localePipe.instant("type"),width:120,editor:{type:g.EditorTypes.SELECT,options:{idField:"value",valueField:"value",textField:"text",data:[{value:f.ConditionType.COMPONENT,text:this.localePipe.instant("commonComponent")}]},validators:[{type:"required",messager:this.localePipe.instant("typeMustNotBeNull")}]},validators:[{type:"required"}],formatter:function(e,t,r){switch(e){case f.ConditionType.COMPONENT:return i.localePipe.instant("commonComponent");case f.ConditionType.EXPRESSION:return i.localePipe.instant("expression");case f.ConditionType.VOACTION:return i.localePipe.instant("billAction");default:return"Unknown"}}},{field:"displayedContent",title:this.localePipe.instant("content"),width:200,editor:{type:g.EditorTypes.INPUTGROUP,options:{groupText:this.groupIcon,editable:!1,clickHandle:function(e){i.selectContent(e)},clear:function(e){i.clearContent(e)}},validators:[{type:"required",messager:this.localePipe.instant("contentMustNotBeNull")}]},validators:[{type:"required"}]},{field:"remarks",title:this.localePipe.instant("description"),width:200,editor:{type:g.EditorTypes.TEXTAREA,options:{}}},{field:null,title:this.localePipe.instant("operation"),width:250,template:this.dgOpCell,halign:"center",align:"center"}]},d.prototype.beginEdit=function(e){this.editingRowId=e.rowData.id;var t=e.gridInstance.getEditors()[0];t.instance.formControl.valueChanges.subscribe(function(e){t.instance.dr.form.bindingData.type!=e&&(t.instance.group.bindingData.displayedContent=null,t.instance.group.controls.displayedContent.setValue(null),t.instance.group.bindingData.remarks=null,t.instance.group.controls.remarks.setValue(null),t.instance.dr.cd.detectChanges())})},d.prototype.endEdit=function(){for(var e=0;e<arguments.length;e++)e,0;this.editingRowId=null},d.prototype.cancelEdited=function(){for(var e=0;e<arguments.length;e++)e,0;this.editingRowId=null},d.prototype.configExpressionExpendFuncs=function(){},d.decorators=[{type:b.Component,args:[{selector:"lib-start-condition",template:'<div class="f-page f-page-is-managelist p-2">\r\n  <div class="f-page-header-base" style="min-height: unset;">\r\n    <div class="f-title">\r\n      <span class="f-title-icon f-text-orna-param">\r\n        <i class="f-icon f-icon-clock"></i>\r\n      </span>\r\n      <h4 class="f-title-text" style="font-size: 1rem;">\r\n        {{ \'startCondition\' | aifLocale }}\r\n      </h4>\r\n    </div>\r\n    <f-response-toolbar class="f-toolbar" #toolbar [datas]="toolbarData" (rtClickEvent)="toolbarClickHandler($event)"\r\n      [style.display]="canEdit==false?\'none\':null">\r\n    </f-response-toolbar>\r\n  </div>\r\n  <div class="f-utils-fill-flex-column">\r\n    <farris-datagrid #dg="datagrid" [columns]="dgColumns" [data]="dgData" [editable]="canEdit" [editMode]="\'row\'"\r\n      [idField]="dgIdField" [showLineNumber]="true" [striped]="false" [showBorder]="true" [pagination]="false"\r\n      [showAllCheckbox]="true" [selectOnCheck]="false" [checkOnSelect]="false" [onlySelectSelf]="true"\r\n      [showCheckbox]="true" [multiSelect]="true" [keepSelect]="true" [fitColumns]="true" [fit]="true"\r\n      [virtualized]="false" [clickToEdit]="false" [beforeEdit]="beforeEdit" (beginEdit)="beginEdit($event)"\r\n      [afterEdit]="afterEdit" (endEdit)="endEdit($event)" (cancelEdited)="cancelEdited($event)">\r\n    </farris-datagrid>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #dgIsEnabledStateCell let-ctx>\r\n  <div class="f-datagrid-cell-formgroup farris-group-auto" style="line-height: 100%;">\r\n    <farris-switch checked id="isEnabled" [disabled]="!canEdit" checkedLabel="{{\'yes\'|aifLocale}}"\r\n      uncheckedLabel="{{\'no\'|aifLocale}}" [(ngModel)]="ctx.rowData.isEnabled"></farris-switch>\r\n  </div>\r\n</ng-template>\r\n\r\n<ng-template #dgOpCell let-ctx>\r\n  <ng-container\r\n    *ngIf="dg.isEditing()!=false&&dg.isEditing()!=null&&dg.selectedRow.id==ctx.rowData.id; else elseTemplate">\r\n    <button class="btn btn-link mr-2" [disabled]="!canEdit" (click)="endRowEdit(ctx)" title="{{\'confirm\'|aifLocale}}">\r\n      <span class="f-icon f-icon-check" [ngClass]="{\'f-pretend-link\': canEdit}"\r\n        style="width: 20px; height: 20px; font-size: 20px;"></span>\r\n    </button>\r\n  </ng-container>\r\n  <ng-template #elseTemplate>\r\n    <button class="btn btn-link mr-2" [disabled]="!canEdit" (click)="startRowEdit(ctx)" title="{{\'edit\'|aifLocale}}">\r\n      <span class="f-icon f-icon-edit-button" [ngClass]="{\'f-pretend-link\': canEdit}"\r\n        style="width: 20px; height: 20px; font-size: 20px;"></span>\r\n    </button>\r\n  </ng-template>\r\n  <button class="btn btn-link mr-2" [disabled]="!canEdit" (click)="rowMove($event, ctx, -1)"\r\n    title="{{\'moveUp\'|aifLocale}}">\r\n    <span class="f-icon f-icon-arrow-seek-up" [ngClass]="{\'f-pretend-link\': canEdit}"\r\n      style="width: 20px; height: 20px; font-size: 20px;"></span>\r\n  </button>\r\n  <button class="btn btn-link mr-2" [disabled]="!canEdit" (click)="rowMove($event, ctx, 1)"\r\n    title="{{\'moveDown\'|aifLocale}}">\r\n    <span class="f-icon f-icon-arrow-seek-down" [ngClass]="{\'f-pretend-link\': canEdit}"\r\n      style="width: 20px; height: 20px; font-size: 20px;"></span>\r\n  </button>\r\n  <button class="btn btn-link mr-2" [disabled]="!canEdit" (click)="remove($event, ctx)" title="{{\'remove\'|aifLocale}}">\r\n    <span class="f-icon f-icon-delete" [ngClass]="{\'f-pretend-link\': canEdit}"\r\n      style="width: 20px; height: 20px; font-size: 20px;"></span>\r\n  </button>\r\n</ng-template>\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type="button" class="btn btn-secondary btn-sm px-3 mx-2" (click)="clickCancel()">取消</button>\r\n  <button type="button" class="btn btn-primary btn-sm px-3 mx-2" (click)="clickOk()">确定</button>\r\n</ng-template>\r\n',providers:[{provide:xi,useValue:ki},wi,Ci],styles:[""]}]}],d.ctorParameters=function(){return[{type:Ci},{type:a},{type:Fe.GSPMetadataRTService},{type:D.ExpressionService},{type:ze.DataEntityService},{type:r.MessagerService},{type:Te.NotifyService},{type:i.BsModalService},{type:Re.FrameworkService},{type:Ge.Router},{type:Ge.ActivatedRoute},{type:Se.LoadingService},{type:String,decorators:[{type:b.Inject,args:[b.LOCALE_ID]}]},{type:wi},{type:b.ComponentFactoryResolver},{type:b.ChangeDetectorRef},{type:b.Injector}]},d.propDecorators={closeModal:[{type:b.Output}],submitModal:[{type:b.Output}],value:[{type:b.Input}],editorParams:[{type:b.Input}],modalFooter:[{type:b.ViewChild,args:["iconSelectFooter"]}],dg:[{type:b.ViewChild,args:["dg"]}],dgIsEnabledStateCell:[{type:b.ViewChild,args:["dgIsEnabledStateCell"]}],dgOpCell:[{type:b.ViewChild,args:["dgOpCell"]}]},d);function d(e,t,r,i,n,o,a,s,l,c,p,d,u,m,f,h,y){var g=Ti.call(this,o,a,r,s,m,y,f,h)||this;return g.startConditionService=e,g.designerState=t,g.metadata=r,g.expr=i,g.des=n,g.messager=o,g.notify=a,g.modal=s,g.framework=l,g.router=c,g.activatedRoute=p,g.loading=d,g.localePipe=m,g.cfr=f,g.cdf=h,g.inj=y,g.groupIcon='<i class="f-icon f-icon-lookup"></i>',g.closeModal=new b.EventEmitter,g.submitModal=new b.EventEmitter,g.editorParams={},g.modalConfig={title:"启动条件",width:900,height:400,showButtons:!0,showHeader:!1},g.dgIdField="id",g.designedConditionEntities=new Array,g.editingRowId=null,g.canEdit=!0,g.beforeEdit=function(){for(var e=0;e<arguments.length;e++)e,0;return v.of(!0)},g.afterEdit=function(e,t){for(var r=2;r<arguments.length;r++)r-2,0;return t.component&&t.component.compMetadataId||t.expression&&t.expression.exprContent?v.of(!0):(g.notify.warning(g.localePipe.instant("eventRouterConditionsContentCantBeEmpty")),v.of(!1))},g}Di.prototype.convertTo=function(e){return e&&e.StartCondition?"（已设置）":"（未设置）"};var Mi=Di;function Di(){}var Ni="Id",Li="Name",Fi="NameLanguage",Ri="ClrTypeID",Vi="Key",zi="wf_TitleExpression",Bi="startMode",Ui="wf_ExecuteForms_PC",ji="wf_ExecuteForms_Mobile",Hi="wf_Component",_i="processVariables",Gi="wf_CustomizeAction",Ki="enablePriority",qi="imageSettings",Wi="timeLimitControl",Ji="messageNotice",$i="allowPreAssign",Yi="EntryForm",Xi="DisplayTerminal",Zi="StartCondition",Qi="enableWholeOrderRetrieve",en=(tn.prototype.setProcessProperty=function(e){this.uiState.propertyData=e.propertyData,this.uiState.ProcessVariables=this.uiState.propertyData[_i],this.uiState.propertyConfig=this.setProcessConfig(e.propertyConfig)},tn.prototype.setProcessConfig=function(e){var t=this,r=[];return e&&e.forEach(function(e){t.setProcessEntity(e.properties),r.push(e)}),r},tn.prototype.setProcessEntity=function(e){var r=this;0<e.length&&e.forEach(function(e){switch(e.propertyID){case Vi:break;case Yi:e.editor=ut,e.converter=new ft;break;case Hi:e.editor=Et,e.converter=new At(r.localPipe),e.editorParams={location:"process"};break;case Ui:e.editor=$t;var t={location:"process",tab:"web"};e.converter=new Xt(t,r.localPipe),e.editorParams=t;break;case ji:e.editor=$t;t={location:"process",tab:"mobile"};e.converter=new Xt(t,r.localPipe),e.editorParams=t;break;case zi:e.editor=Qt,e.converter=new tr(r.localPipe);break;case $i:case Ki:case Qi:e.iterator=r.uiState.boolIterator;break;case Bi:e.iterator=r.uiState.startModeIterator;break;case Xi:e.iterator=r.uiState.displayTerminal;break;case Gi:e.editor=ar,e.converter=new lr(r.localPipe);break;case _i:e.editor=xr,e.converter=new Pr(r.localPipe);break;case Wi:e.editor=Ur,e.converter=new Hr(r.localPipe),e.editorParams={location:"process"};break;case Ji:e.editor=ai,e.converter=new ci(r.localPipe),e.editorParams={location:"process"};break;case qi:e.editor=yi,e.converter=new vi(r.localPipe);break;case Zi:e.editor=Oi,e.editorParams={},e.converter=new Mi;break;default:e.editor=di,e.converter=new mi(r.localPipe)}})},tn.decorators=[{type:b.Injectable}],tn.ctorParameters=function(){return[{type:a},{type:x}]},tn);function tn(e,t){this.uiState=e,this.localPipe=t}var rn=function(e,t,r){this.isDefault=!1,this.commentNecessary=!1,this.certification=!1,this.attachmentNecessary=!1,this.signatureNecessary=!1,this.value=e,this.text=t,this.workFlowAction=r},nn=function(){},on=(Object.defineProperty(an.prototype,"value",{set:function(e){var t,r;if(e&&0<e.length)try{for(var i=ue(e),n=i.next();!n.done;n=i.next()){var o=n.value,a=new nn;a.id=l.GenerateElementId(),a.conclusionValue=o.ConclusionValue,a.conclusionName=o.ConclusionName,a.calculateType=o.CalculateType||"null",a.conditionValue=o.ConditionValue||0,a.waitAllVotes=o.WaitAllVotes||!1,a.completionCondition=o.CompletionCondition?o.CompletionCondition._value:null,this.data.push(a)}}catch(s){t={error:s}}finally{try{n&&!n.done&&(r=i["return"])&&r.call(i)}finally{if(t)throw t.error}}else this.deleteRow()},enumerable:!0,configurable:!0}),Object.defineProperty(an.prototype,"value1",{set:function(e){var t,r;if(this.editCondition=!0,e&&0<e.length){try{for(var i=ue(e),n=i.next();!n.done;n=i.next()){var o=n.value,a=new nn;a.id=B.BpmnModelHelper.GenerateElementId(),a.conclusionValue=o.ConclusionValue,a.calculateType=o.CalculateType||"null",a.conditionValue=o.ConditionValue||0,a.waitAllVotes=o.WaitAllVotes||!1,a.completionCondition=o.CompletionCondition?o.CompletionCondition.Value:null,this.data.push(a)}}catch(s){t={error:s}}finally{try{n&&!n.done&&(r=i["return"])&&r.call(i)}finally{if(t)throw t.error}}this.data=this.setName1(this.data)}else this.deleteRow1()},enumerable:!0,configurable:!0}),an.prototype.ngOnInit=function(){this.counterSignVariables=this.designerUIState.counterSignVariables||[],this.approvalItems=this.designerUIState.approvalItems||[]},an.prototype.deleteRow=function(){this.data=[];var e,t,r=this.designerUIState.approvalItems||[];if(r&&0<r.length)try{for(var i=ue(r),n=i.next();!n.done;n=i.next()){var o=n.value,a=new nn;"Pass"===o.value?(a.id=l.GenerateElementId(),a.conclusionValue=o.value,a.conclusionName=o.text,a.calculateType="byProportion",a.conditionValue="100"):"Back"===o.value?(a.id=l.GenerateElementId(),a.conclusionValue=o.value,a.conclusionName=o.text,a.calculateType="byNumber",a.conditionValue="1"):(a.id=l.GenerateElementId(),a.conclusionValue=o.value,a.conclusionName=o.text,a.calculateType="null",a.conditionValue="0"),a.waitAllVotes=!0,this.data.push(a)}}catch(s){e={error:s}}finally{try{n&&!n.done&&(t=i["return"])&&t.call(i)}finally{if(e)throw e.error}}},an.prototype.deleteRow1=function(){var e,t;if(this.data=[],this.approvalItems1&&0<this.approvalItems1.length)try{for(var r=ue(this.approvalItems1),i=r.next();!i.done;i=r.next()){var n=i.value,o=new nn;"Forward"===n.value?(o.id=l.GenerateElementId(),o.conclusionValue=n.value,o.conclusionName=n.text,o.calculateType="byProportion",o.conditionValue="100"):"Backward"===n.value||"Abort"===n.value?(o.id=l.GenerateElementId(),o.conclusionValue=n.value,o.conclusionName=n.text,o.calculateType="byNumber",o.conditionValue="1"):(o.id=l.GenerateElementId(),o.conclusionValue=n.value,o.conclusionName=n.text,o.calculateType="null",o.conditionValue="0"),o.waitAllVotes=!0,this.data.push(o)}}catch(a){e={error:a}}finally{try{i&&!i.done&&(t=r["return"])&&t.call(r)}finally{if(e)throw e.error}}},an.prototype.setName1=function(e){if(e&&0<e.length)for(var t=0;t<e.length;t++)"Forward"===e[t].conclusionValue?e[t].conclusionName=this.localePipe.transform("multiInstanceLoopCharacteristics.completionConditionRulesList.forward"):"Backward"===e[t].conclusionValue?e[t].conclusionName=this.localePipe.transform("multiInstanceLoopCharacteristics.completionConditionRulesList.backward"):"Abort"===e[t].conclusionValue&&(e[t].conclusionName=this.localePipe.transform("multiInstanceLoopCharacteristics.completionConditionRulesList.abort"));return e},an.prototype.clickOK=function(){var e;this.grid.endCellEdit(),0===this.data.length?this.message.warning(this.localePipe.transform("component.signRule.notEmpty")):(e={value:this.data,parameters:null},this.submitModal.emit(e))},an.prototype.clickOK1=function(){var r,i=this;this.grid.endCellEdit(),0===this.data.length?this.message.warning(this.localePipe.transform("component.signRule.notEmpty")):(r=new Array,this.data.forEach(function(e){var t=new de.CounterSignRule(i.bpmnModel);t.CalculateType=e.calculateType,t.ConclusionValue=e.conclusionValue,t.ConditionValue=e.conditionValue,t.WaitAllVotes=e.waitAllVotes,t.CompletionCondition=new de.Condition(i.bpmnModel),t.CompletionCondition.Value=e.completionCondition,r.push(t)}),this.submitModal.emit(r))},an.prototype.clickCancel=function(){this.closeModal.emit()},an.prototype.editConditon=function(t){var e,r,i,n,o,a,s,l,c,p,d=this,u=new Array;if(this.editCondition){if(0<this.designerUIState.multiCounterSignVariables.length)try{for(var m=ue(this.designerUIState.multiCounterSignVariables),f=m.next();!f.done;f=m.next())!function(t){u.some(function(e){return e.key===t.key})||u.push(t)}(f.value)}catch(I){e={error:I}}finally{try{f&&!f.done&&(r=m["return"])&&r.call(m)}finally{if(e)throw e.error}}if(0<u.length)try{for(var h=ue(u),y=h.next();!y.done;y=h.next()){var g=y.value;this.exprService.addContext(g)}}catch(S){i={error:S}}finally{try{y&&!y.done&&(n=h["return"])&&n.call(h)}finally{if(i)throw i.error}}}else{if(this.counterSignVariables&&0<this.counterSignVariables.length)try{for(var v=ue(this.counterSignVariables),b=v.next();!b.done;b=v.next())!function(t){u.some(function(e){return e.key===t.key})||u.push(t)}(b.value)}catch(E){o={error:E}}finally{try{b&&!b.done&&(a=v["return"])&&a.call(v)}finally{if(o)throw o.error}}if(0<this.designerUIState.subActivityContext.length)try{for(var x=ue(this.designerUIState.subActivityContext),w=x.next();!w.done;w=x.next())!function(t){u.some(function(e){return e.key===t.key})||u.push(t)}(w.value)}catch(T){s={error:T}}finally{try{w&&!w.done&&(l=x["return"])&&l.call(x)}finally{if(s)throw s.error}}if(0<u.length)try{for(var P=ue(u),C=P.next();!C.done;C=P.next()){g=C.value;this.exprService.addContext(g)}}catch(A){c={error:A}}finally{try{C&&!C.done&&(p=P["return"])&&p.call(P)}finally{if(c)throw c.error}}}this.exprService.setEditPattern(D.ExprEditMode.Advanced),this.exprService.addExpressionText(t.instance.value),this.exprService.buildExpression().then(function(e){t.formControl.setValue(e),t.instance.cd.detectChanges(),0<u.length&&(d.exprService.exprEntity.contextEntities=d.exprService.exprEntity.contextEntities.filter(function(t){return!u.some(function(e){return e.key===t.key})}))})},an.prototype.approvalSelect=function(){var e,t,r=this.apvlItemsGrid.checkeds;if(r&&0<r.length){try{for(var i=ue(r),n=i.next();!n.done;n=i.next()){var o=n.value,a=new nn;a.id=l.GenerateElementId(),a.conclusionValue=o.data.value,a.conclusionName=o.data.text,this.data.push(a)}}catch(s){e={error:s}}finally{try{n&&!n.done&&(t=i["return"])&&t.call(i)}finally{if(e)throw e.error}}this.grid.loadData(this.data),this.apvlItemDialog.close()}else this.message.info(this.localePipe.transform("component.signRule.pleaseSelect"))},an.prototype.endEdit=function(e){this.curValue=e.rowData,this.preValue.completionCondition===this.curValue.completionCondition||this.isEmpty(this.preValue.completionCondition)&&this.isEmpty(this.curValue.completionCondition)?this.preValue.calculateType===this.curValue.calculateType&&this.preValue.conditionValue===this.curValue.conditionValue&&this.preValue.waitAllVotes===this.curValue.waitAllVotes||(this.data[e.rowIndex].completionCondition=null):(this.data[e.rowIndex].calculateType="null",this.data[e.rowIndex].conditionValue="0",this.data[e.rowIndex].waitAllVotes=!1),"conditionValue"===e.column.field&&"byProportion"===this.data[e.rowIndex].calculateType&&100<Number.parseInt(e.value)?(this.message.info(this.localePipe.transform("component.signRule.maxConditionValue")),this.data[e.rowIndex].conditionValue="100"):"conditionValue"===e.column.field&&Number.parseInt(e.value)<0?(this.message.info(this.localePipe.transform("component.signRule.minConditionValue")),this.data[e.rowIndex].conditionValue="0"):"calculateType"!==e.column.field&&"conditionValue"!==e.column.field||"oneVote"!==this.data[e.rowIndex].calculateType&&"fullVote"!==this.data[e.rowIndex].calculateType||0===Number.parseInt(this.data[e.rowIndex].conditionValue)?"calculateType"===e.column.field&&"byProportion"===this.data[e.rowIndex].calculateType&&100<Number.parseInt(this.data[e.rowIndex].conditionValue)&&(this.message.info(this.localePipe.transform("component.signRule.maxConditionValue")),this.data[e.rowIndex].conditionValue="100"):(this.message.info(this.localePipe.transform("component.signRule.noConditional")),this.data[e.rowIndex].conditionValue="0")},an.prototype.isEmpty=function(e){return!e||0==e.length},an.decorators=[{type:b.Component,args:[{selector:"app-sign-rule",template:'  <div class="f-page">\r\n    <div class="f-page-main f-utils-fill-flex-column h-100">\r\n      <div class="f-utils-fill-flex-column farris-overflow-y-auto h-100">\r\n        <farris-datagrid #grid [data]="data" [columns]="columns" [idField]="\'id\'" [fit]="true"\r\n          [fitColumns]="true" [editable]="true" [editMode]="\'cell\'" [pagination]="false" [showCheckbox]="false"\r\n          [multiSelect]="false" [afterEdit]=\'afterEdit\' (endEdit)="endEdit($event)">\r\n        </farris-datagrid>\r\n      </div>\r\n    </div>\r\n  </div>\r\n<ng-template #iconSelectFooter>\r\n  <button type="button" class="btn btn-secondary btn-sm px-3 mx-2" (click)="clickCancel()">{{\'component.signRule.clickCancel\' | wfLocale}}</button>\r\n  <button type="button" class="btn btn-secondary btn-sm px-3 mx-2" (click)="deleteRow()">{{\'component.signRule.deleteRow\' | wfLocale}}</button>\r\n  <button type="button" class="btn btn-primary btn-sm px-3 mx-2" (click)="clickOK()">{{\'component.signRule.clickOK\' | wfLocale}}</button>\r\n</ng-template>\r\n\r\n\r\n<ng-template #iconSelectFooter1>\r\n  <button type="button" class="btn btn-secondary btn-sm px-3 mx-2" (click)="clickCancel()">{{\'component.signRule.clickCancel\' | wfLocale}}</button>\r\n  <button type="button" class="btn btn-secondary btn-sm px-3 mx-2" (click)="deleteRow1()">{{\'component.signRule.deleteRow\' | wfLocale}}</button>\r\n  <button type="button" class="btn btn-primary btn-sm px-3 mx-2" (click)="clickOK1()">{{\'component.signRule.clickOK\' | wfLocale}}</button>\r\n</ng-template>\r\n\r\n<farris-dialog #approvalItemDialog [buttons]="buttonRef" [width]="700" [height]="520" title="{{\'component.signRule.approvalOptions\'| wfLocale}}">\r\n  <div class="f-utils-fill-flex-column farris-overflow-y-auto h-100 m-2">\r\n      <farris-datagrid #approvalTable [columns]="approvalCols" [data]="approvalItems" [idField]="\'value\'"\r\n        [fit]="true" [fitColumns]="true" [pagination]=\'false\' [multiSelect]="true"\r\n        [showCheckbox]="true" [multiSelect]="true" [checkOnSelect]="true" [selectOnCheck]="true">\r\n      </farris-datagrid>\r\n  </div>\r\n</farris-dialog>\r\n<ng-template #buttonRef>\r\n  <button class="btn btn-secondary btn-sm px-3 mx-2" (click)="approvalItemDialog.close()">{{\'component.signRule.clickCancel\' | wfLocale}}</button>\r\n  <button class="btn btn-sm btn-primary px-3 mx-2" (click)="approvalSelect()">{{\'component.signRule.clickOK\' | wfLocale}}</button>\r\n</ng-template>\r\n',providers:[x],styles:[""]}]}],an.ctorParameters=function(){return[{type:he.FormBuilder},{type:r.MessagerService},{type:D.ExpressionService},{type:a},{type:b.ChangeDetectorRef,decorators:[{type:b.Optional}]},{type:String,decorators:[{type:b.Inject,args:[b.LOCALE_ID]}]},{type:undefined,decorators:[{type:b.Inject,args:[o]}]},{type:x,decorators:[{type:b.Optional}]}]},an.propDecorators={cls:[{type:b.HostBinding,args:["class"]}],closeModal:[{type:b.Output}],submitModal:[{type:b.Output}],value:[{type:b.Input}],value1:[{type:b.Input}],editorParams:[{type:b.Input}],modalFooter:[{type:b.ViewChild,args:["iconSelectFooter"]}],modalFooter1:[{type:b.ViewChild,args:["iconSelectFooter1"]}],apvlItemsGrid:[{type:b.ViewChild,args:["approvalTable"]}],apvlItemDialog:[{type:b.ViewChild,args:["approvalItemDialog"]}],grid:[{type:b.ViewChild,args:["grid"]}]},an);function an(e,t,r,i,n,o,a,s){var l=this;this.formBuilder=e,this.message=t,this.exprService=r,this.designerUIState=i,this.cdr=n,this.localeId=o,this.resources=a,this.localePipe=s,this.cls="farris-main-area flex-column",this.closeModal=new b.EventEmitter,this.submitModal=new b.EventEmitter,this.editorParams={},this.modalConfig={title:this.localePipe.transform("component.signRule.countersignRules"),width:800,height:520,showButtons:!0},this.editCondition=!1,this.data=[],this.calculationMethods=[{text:this.localePipe.transform("component.signRule.byNumber"),value:"byNumber"},{text:this.localePipe.transform("component.signRule.byProportion"),value:"byProportion"},{text:this.localePipe.transform("component.signRule.customConditions"),value:"null"}],this.counterSignVariables=[],this.bpmnModel=this.designerUIState.bpmnModel,this.approvalCols=[{title:this.localePipe.transform("component.signRule.value"),field:"value",width:80},{title:this.localePipe.transform("component.signRule.text"),field:"text",width:90}],this.approvalItems=[],this.approvalItems1=[{value:"Forward",text:this.localePipe.transform("multiInstanceLoopCharacteristics.completionConditionRulesList.forward")},{value:"Backward",text:this.localePipe.transform("multiInstanceLoopCharacteristics.completionConditionRulesList.backward")},{value:"Abort",text:this.localePipe.transform("multiInstanceLoopCharacteristics.completionConditionRulesList.abort")}],this.columns=[{field:"conclusionName",width:25,title:this.localePipe.transform("component.signRule.conclusionName")},{field:"conclusionValue",width:25,title:this.localePipe.transform("component.signRule.conclusionValue")},{field:"calculateType",width:40,title:this.localePipe.transform("component.signRule.calculateType"),formatter:{type:"enum",options:{valueField:"value",textField:"text",data:this.calculationMethods}},editor:{type:g.EditorTypes.COMBOLIST,options:{valueField:"value",textField:"text",data:this.calculationMethods,idField:"value",panelHeight:"auto"}}},{field:"conditionValue",width:25,title:this.localePipe.transform("component.signRule.conditionValue"),editor:{type:g.EditorTypes.NUMBERBOX,options:{}},formatter:{type:"number",options:{precision:0,min:0}}},{field:"waitAllVotes",width:35,title:this.localePipe.transform("component.signRule.waitAllVotes"),editor:{type:g.EditorTypes.SWITCH,options:{}},formatter:{type:"boolean",options:{trueText:this.localePipe.transform("component.signRule.yes"),falseText:this.localePipe.transform("component.signRule.no")}}},{field:"completionCondition",width:50,title:this.localePipe.transform("component.signRule.customConditions"),editor:{type:"input-group",options:{groupText:'<i class="f-icon f-icon-lookup"></i>',editable:!1,clickHandle:function(e){e.formControl.setValue(e.instance.value||""),l.editConditon(e)},clear:function(e){console.log("clear",e)}}}}],this.afterEdit=function(e,t,r){return l.preValue=JSON.parse(JSON.stringify(t)),v.of(!0)},this.localePipe=this.localePipe||new x(o,a)}ln.prototype.convertTo=function(e){return this.localePipe.transform("component.signRule.set")};var sn=ln;function ln(e){this.localePipe=e}Object.defineProperty(pn.prototype,"value",{set:function(e){var t,r;if(e&&0<e.length)try{for(var i=ue(e),n=i.next();!n.done;n=i.next()){var o=n.value,a=new rn;a.value=o.Value,a.text=o.Text,a.workFlowAction=o.WorkFlowAction,a.isDefault=o.IsDefault,null===o.commentNecessary||o.commentNecessary===undefined?a.commentNecessary="Back"===o.Value:a.commentNecessary=o.commentNecessary,a.certification=o.certification||!1,a.attachmentNecessary=o.attachmentNecessary||!1,a.signatureNecessary=o.signatureNecessary||!1,a.defaultComment=o.defaultComment?JSON.parse(o.defaultComment):null,this.data.push(a)}}catch(s){t={error:s}}finally{try{n&&!n.done&&(r=i["return"])&&r.call(i)}finally{if(t)throw t.error}}},enumerable:!0,configurable:!0}),pn.prototype.ngOnInit=function(){this.getActionsList()},pn.prototype.clickOK=function(){var e,t;if(this.grid.endCellEdit(),this.validator()){var r=[];try{for(var i=ue(this.data),n=i.next();!n.done;n=i.next()){var o=n.value;null!=o.defaultComment&&(o.defaultComment=JSON.stringify(o.defaultComment)),r.push(o)}}catch(a){e={error:a}}finally{try{n&&!n.done&&(t=i["return"])&&t.call(i)}finally{if(e)throw e.error}}console.log(r),this.submitModal.emit({value:r,parameters:null})}},pn.prototype.clickCancel=function(){this.closeModal.emit()},pn.prototype.validator=function(){return!(-1<this.data.findIndex(function(e){return!e.workFlowAction})&&(this.message.warning(this.localePipe.transform("component.approvelItems.workFlowActionNotNull")),1))},pn.prototype.selectChanged=function(e){},pn.prototype.deleteRow=function(){var e,t=this;this.grid.endCellEdit(),this.grid.selectedRow&&this.grid.selectedRow.data?(e=this.data.findIndex(function(e){return e.value===t.grid.selectedRow.data.value}),this.data.splice(e,1),this.grid.loadData(this.data)):this.message.info(this.localePipe.transform("component.approvelItems.deleteRow"))},pn.prototype.getActionsList=function(){var t=this,e=this.util.getApprovalActionWebApi()+"?";this.uiState.bizActivityId?e+="bizActivityId="+this.uiState.bizActivityId:e+="bizActivityId=",this.http.get(e).subscribe(function(e){e=e.filter(function(e){return t.actionValidate(e)}),t.actions=e})},pn.prototype.actionsSelect=function(){var i=this,e=this.actionsTable.checkeds;e&&0<e.length&&(e.forEach(function(t){var e=new rn(t.data.code,t.data.name,t.data.workFlowAction),r=i.data.findIndex(function(e){return e.value===t.data.code});-1<r&&i.data.splice(r,1),i.data.push(e)}),this.grid.loadData(this.data)),this.actionsTable.clearCheckeds(!0),this.actionsDialog.close()},pn.prototype.SelectCancel=function(){this.actionsTable.clearCheckeds(!0),this.actionsDialog.close()},pn.prototype.actionValidate=function(e){return-1===["ViewBizLog","ViewFlowChart","AssignUser","Claim","Unclaim","Retrieve","Resubmit","Obsolete","Transfer","AddSignFront","ViewExecuteForm"].indexOf(e.code.trim())},pn.decorators=[{type:b.Component,args:[{selector:"app-approvel-items",template:'<div class="f-page">\r\n  <div class="f-page-header">\r\n    <nav class="f-page-header-base">\r\n      <div class="f-title">\r\n      </div>\r\n      <div class="btn-toolbar btn-group-lg">\r\n      <button class="btn btn-primary mr-2" (click)="actionsDialog.show()">{{\'component.approvelItems.add\' | wfLocale}}</button>\r\n      <button class="btn btn-secondary" (click)="deleteRow()">{{\'component.approvelItems.delete\' | wfLocale}}</button>\r\n      </div>\r\n    </nav>\r\n  </div>\r\n  <div class="f-page-main f-utils-fill-flex-column h-100">\r\n    <div class="f-utils-fill-flex-column farris-overflow-y-auto h-100">\r\n      <farris-datagrid #grid [data]="data" [columns]="columns" [idField]="\'value\'" [fit]="true"\r\n        [fitColumns]="true" [editable]="true" [editMode]="\'cell\'" [pagination]="false" [showCheckbox]="false"\r\n        [multiSelect]="false" (selectChanged)="selectChanged($event)">\r\n      </farris-datagrid>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type="button" class="btn btn-secondary btn-sm px-3 mx-2" (click)="clickCancel()">{{\'component.approvelItems.clickCancel\' | wfLocale}}</button>\r\n  <button type="button" class="btn btn-primary btn-sm px-3 mx-2" (click)="clickOK()">{{\'component.approvelItems.clickOK\' | wfLocale}}</button>\r\n</ng-template>\r\n\r\n<ng-template #buttonRef>\r\n  <button class="btn btn-sm btn-default px-3" (click)="SelectCancel()">{{\'component.approvelItems.clickCancel\' | wfLocale}}</button>\r\n  <button class="btn btn-sm btn-primary px-3" (click)="actionsSelect()">{{\'component.approvelItems.clickOK\' | wfLocale}}</button>\r\n</ng-template>\r\n<farris-dialog #actionsDialog [buttons]="buttonRef" [width]="700" [height]="520" title="{{\'component.approvelItems.approvalAction\' | wfLocale}}">\r\n  \x3c!-- 2023-6-1 解决审批动作弹窗双滚动条的问题 --\x3e\r\n  <div class="f-utils-fill-flex-column farris-overflow-y-hidden h-100" style="margin-left: 8px;margin-right: 8px;">\r\n    <farris-datagrid #actionsTable [columns]="actionsCols" [data]="actions"\r\n      [idField]="\'id\'" [fit]="true" [fitColumns]="true" [pagination]=\'false\'\r\n      [showCheckbox]="true" [multiSelect]="true" [checkOnSelect]="true" [selectOnCheck]="true" [showAllCheckbox]="true"\r\n      [showLineNumber]="true" lineNumberTitle="{{\'component.approvelItems.lineNumber\' | wfLocale}}" [lineNumberWidth]="50" [striped]="true">\r\n    </farris-datagrid>\r\n  </div>\r\n</farris-dialog>\r\n',providers:[x],styles:[""]}]}],pn.ctorParameters=function(){return[{type:r.MessagerService},{type:l},{type:t.HttpService},{type:a},{type:b.ComponentFactoryResolver},{type:b.ChangeDetectorRef,decorators:[{type:b.Optional}]},{type:String,decorators:[{type:b.Inject,args:[b.LOCALE_ID]}]},{type:undefined,decorators:[{type:b.Inject,args:[o]}]},{type:x,decorators:[{type:b.Optional}]}]},pn.propDecorators={cls:[{type:b.HostBinding,args:["class"]}],closeModal:[{type:b.Output}],submitModal:[{type:b.Output}],value:[{type:b.Input}],modalFooter:[{type:b.ViewChild,args:["iconSelectFooter"]}],actionsTable:[{type:b.ViewChild,args:["actionsTable"]}],actionsDialog:[{type:b.ViewChild,args:["actionsDialog"]}],grid:[{type:b.ViewChild,args:["grid"]}]};var cn=pn;function pn(e,t,r,i,n,o,a,s,l){this.message=e,this.util=t,this.http=r,this.uiState=i,this.resolver=n,this.cdr=o,this.localeId=a,this.resources=s,this.localePipe=l,this.cls="farris-main-area flex-column",this.closeModal=new b.EventEmitter,this.submitModal=new b.EventEmitter,this.modalConfig={title:this.localePipe.transform("component.approvelItems.approvalOptions"),width:1100,height:515,showButtons:!0},this.workFlowActions=[{text:this.localePipe.transform("component.approvelItems.forward"),value:"Forward"},{text:this.localePipe.transform("component.approvelItems.backward"),value:"Backward"},{text:this.localePipe.transform("component.approvelItems.abort"),value:"Abort"}],this.columns=[{field:"value",width:80,title:this.localePipe.transform("component.approvelItems.value")},{field:"text",width:80,title:this.localePipe.transform("component.approvelItems.text")},{field:"workFlowAction",width:80,title:this.localePipe.transform("component.approvelItems.workFlowAction"),formatter:{type:"enum",options:{valueField:"value",textField:"text",data:this.workFlowActions}},editor:{type:g.EditorTypes.COMBOLIST,options:{valueField:"value",textField:"text",data:this.workFlowActions,idField:"value",panelHeight:"auto"}},validators:[{type:"required",messager:"必填"}]},{field:"isDefault",width:60,title:this.localePipe.transform("component.approvelItems.isDefault"),editor:{type:g.EditorTypes.SWITCH,options:{}},formatter:{type:"boolean",options:{trueText:this.localePipe.transform("component.approvelItems.yes"),falseText:this.localePipe.transform("component.approvelItems.no")}},validators:[{type:"required",messager:"必填"}]},{field:"commentNecessary",width:60,title:this.localePipe.transform("component.approvelItems.commentNecessary"),editor:{type:g.EditorTypes.SWITCH,options:{}},formatter:{type:"boolean",options:{trueText:this.localePipe.transform("component.approvelItems.yes"),falseText:this.localePipe.transform("component.approvelItems.no")}},validators:[{type:"required",messager:"必填"}]},{field:"attachmentNecessary",width:60,title:this.localePipe.transform("component.approvelItems.attachmentNecessary"),editor:{type:g.EditorTypes.SWITCH,options:{}},formatter:{type:"boolean",options:{trueText:this.localePipe.transform("component.approvelItems.yes"),falseText:this.localePipe.transform("component.approvelItems.no")}},validators:[{type:"required",messager:"必填"}]},{field:"certification",width:60,title:this.localePipe.transform("component.approvelItems.certification"),editor:{type:g.EditorTypes.SWITCH,options:{}},formatter:{type:"boolean",options:{trueText:this.localePipe.transform("component.approvelItems.yes"),falseText:this.localePipe.transform("component.approvelItems.no")}},validators:[{type:"required",messager:"必填"}]},{field:"signatureNecessary",width:60,title:this.localePipe.transform("component.approvelItems.signatureNecessary"),editor:{type:g.EditorTypes.SWITCH,options:{}},formatter:{type:"boolean",options:{trueText:this.localePipe.transform("component.approvelItems.yes"),falseText:this.localePipe.transform("component.approvelItems.no")}},validators:[]},{field:"defaultComment",isMultilingualField:!0,width:70,title:this.localePipe.transform("component.approvelItems.defaultComment"),editor:{type:g.EditorTypes.LANGUAGETEXTBOX,options:{languages:[{code:"zh-CHS",name:this.localePipe.transform("component.approvelItems.zh-CHS")},{code:"zh-CHT",name:this.localePipe.transform("component.approvelItems.zh-CHT")},{code:"en",name:this.localePipe.transform("component.approvelItems.en")}]}}}],this.data=[],this.actionsCols=[{title:this.localePipe.transform("component.approvelItems.value"),field:"code",width:80},{title:this.localePipe.transform("component.approvelItems.text"),field:"name",width:90}],this.localePipe=this.localePipe||new x(a,s)}un.prototype.convertTo=function(e){return e&&0<e.length?this.localePipe.transform("component.approvelItems.set"):this.localePipe.transform("component.approvelItems.notSet")};var dn=un;function un(e){this.localePipe=e}fn.prototype.ngOnInit=function(){var e,t,r,i,n,o,a,s,l,c,p,d;if(this.contextEntities=new Array,0<this.designerState.procInstContext.length)try{for(var u=ue(this.designerState.procInstContext),m=u.next();!m.done;m=u.next()){var f=m.value;this.contextEntities=this.contextEntities.concat([f])}}catch(O){e={error:O}}finally{try{m&&!m.done&&(t=u["return"])&&t.call(u)}finally{if(e)throw e.error}}if(0<this.designerState.subActivityContext.length){var h=this;try{for(var y=ue(this.designerState.subActivityContext),g=y.next();!g.done;g=y.next())!function(t){h.contextEntities.some(function(e){return e.key===t.key})||(h.contextEntities=h.contextEntities.concat([t]))}(f=g.value)}catch(M){r={error:M}}finally{try{g&&!g.done&&(i=y["return"])&&i.call(y)}finally{if(r)throw r.error}}}if(0<this.designerState.formalParameterContext.length){var v=this;try{for(var b=ue(this.designerState.formalParameterContext),x=b.next();!x.done;x=b.next())!function(t){v.contextEntities.some(function(e){return e.key===t.key})||(v.contextEntities=v.contextEntities.concat([t]))}(f=x.value)}catch(D){n={error:D}}finally{try{x&&!x.done&&(o=b["return"])&&o.call(b)}finally{if(n)throw n.error}}}if(0<this.designerState.participantContext.length){var w=this;try{for(var P=ue(this.designerState.participantContext),C=P.next();!C.done;C=P.next())!function(t){w.contextEntities.some(function(e){return e.key===t.key})||(w.contextEntities=w.contextEntities.concat([t]))}(f=C.value)}catch(N){a={error:N}}finally{try{C&&!C.done&&(s=P["return"])&&s.call(P)}finally{if(a)throw a.error}}}if(0<this.designerState.activityComponentContext.length){var I=this;try{for(var S=ue(this.designerState.activityComponentContext),E=S.next();!E.done;E=S.next())!function(t){I.contextEntities.some(function(e){return e.key===t.key})||(I.contextEntities=I.contextEntities.concat([t]))}(f=E.value)}catch(L){l={error:L}}finally{try{E&&!E.done&&(c=S["return"])&&c.call(S)}finally{if(l)throw l.error}}}if(0<this.designerState.processVariableContext.length){var T=this;try{for(var A=ue(this.designerState.processVariableContext),k=A.next();!k.done;k=A.next())!function(t){T.contextEntities.some(function(e){return e.key===t.key})||(T.contextEntities=T.contextEntities.concat([t]))}(f=k.value)}catch(F){p={error:F}}finally{try{k&&!k.done&&(d=A["return"])&&d.call(A)}finally{if(p)throw p.error}}}},fn.prototype.clickOK=function(){var e=this.compute.getExpr(),e=(this.value=this.convertToValue(e.text),{value:this.value,parameters:null});this.submitModal.emit(e)},fn.prototype.changeType=function(){this.compute.changeType()},fn.prototype.clickCancel=function(){this.closeModal.emit()},fn.prototype.convertToValue=function(e){return e&&e.substring(9,e.length-2)?e:""},fn.decorators=[{type:b.Component,args:[{selector:"app-expression-editor",template:'<div class="mx-3 h-100" style="border-radius:16px;border: 1.5px solid #F1F3F7;">\r\n  <app-compute-rule-editor #compute\r\n  [text]="value"\r\n  [advancedContexts]="contextEntities"\r\n  [injectName]="injectName"\r\n  [injectSchemaName]="\'Schema\'"\r\n  [injectNameInSchema]="injectName"\r\n  [schema]="schema"\r\n  [schemaName]="\'Schema\'">\r\n</app-compute-rule-editor>\r\n</div>\r\n\r\n<ng-template #iconSelectFooter>\r\n  <div class="btns">\r\n    <button type="button" class="btn btn-secondary btn-sm mr-2" (click)="clickCancel()">{{\'component.expressionEditor.clickCancel\' | wfLocale}}</button>\r\n    <button type="button" class="btn btn-secondary btn-sm mr-2" (click)="changeType()">{{\'component.expressionEditor.changeType\' | wfLocale}}</button>\r\n    <button type="button" class="btn btn-primary btn-sm" (click)="clickOK()">{{\'component.expressionEditor.clickOK\' | wfLocale}}</button>\r\n  </div>\r\n</ng-template>\r\n',providers:[x],styles:[""]}]}],fn.ctorParameters=function(){return[{type:D.ExpressionService},{type:a},{type:b.ChangeDetectorRef,decorators:[{type:b.Optional}]},{type:String,decorators:[{type:b.Inject,args:[b.LOCALE_ID]}]},{type:undefined,decorators:[{type:b.Inject,args:[o]}]},{type:x,decorators:[{type:b.Optional}]}]},fn.propDecorators={closeModal:[{type:b.Output}],submitModal:[{type:b.Output}],value:[{type:b.Input}],modalFooter:[{type:b.ViewChild,args:["iconSelectFooter"]}],editorParams:[{type:b.Input}],editor:[{type:b.ViewChild,args:[D.ExpressioneditorComponent]}],compute:[{type:b.ViewChild,args:["compute"]}]};var mn=fn;function fn(e,t,r,i,n,o){this.expr=e,this.designerState=t,this.cdr=r,this.localeId=i,this.resources=n,this.localePipe=o,this.closeModal=new b.EventEmitter,this.submitModal=new b.EventEmitter,this.editorParams={},this.contextEntities=[],this.schema={},this.injectName="",this.modalConfig={title:this.localePipe.transform("component.expressionEditor.expressionEditor"),width:1036,height:530,showButtons:!0},this.localePipe=this.localePipe||new x(i,n),this.designerState.schemas[0]&&(this.schema=this.designerState.schemas[0],this.designerState.schemas[0].entityTypes)&&0<this.designerState.schemas[0].entityTypes.length&&(this.injectName=this.designerState.schemas[0].entityTypes[0].name)}yn.prototype.convertTo=function(e){return e||this.localePipe.transform("component.expressionEditor.notSet")};var hn=yn;function yn(e){this.localePipe=e}Object.defineProperty(vn.prototype,"value",{set:function(e){var t,r,i;if(e){this.category=e.Category,this.defaultType=e.DefaultType;var n=e.DefaultActivity;if(null!=n)try{for(var o=ue(this.uistate.allActList),a=o.next();!a.done;a=o.next()){var s=a.value;s.Id===n&&(this.defaultacty=s.Name)}}catch(u){t={error:u}}finally{try{a&&!a.done&&(l=o["return"])&&l.call(o)}finally{if(t)throw t.error}}var l=e.DestinationActivities;if(l&&0<l.length){var c=this;try{for(var p=ue(l),d=p.next();!d.done;d=p.next())!function(t){var e=c.uistate.allActList.filter(function(e){return e.Id===t})[0].Name;c.actis.push(e)}(d.value)}catch(m){r={error:m}}finally{try{d&&!d.done&&(i=p["return"])&&i.call(p)}finally{if(r)throw r.error}}}}else this.category="OutConnectNode",this.defaultType="FirstNode"},enumerable:!0,configurable:!0}),vn.prototype.ngOnInit=function(){},vn.prototype.clickOK=function(){var e,t,r,i,n;if(this.validator()){var o=[];if(""===this.defaultActivity&&""!==this.defaultacty)try{for(var a=ue(this.uistate.allActList),s=a.next();!s.done;s=a.next()){var l=s.value;l.Name===this.defaultacty&&(this.defaultActivity=l.Id)}}catch(y){e={error:y}}finally{try{s&&!s.done&&(h=a["return"])&&h.call(a)}finally{if(e)throw e.error}}if(0===this.fullActis.length&&0<this.actis.length)try{for(var c=ue(this.actis),p=c.next();!p.done;p=c.next()){var d=p.value;try{for(var u=ue(this.uistate.allActList),m=u.next();!m.done;m=u.next()){var f=m.value;d===f.Name&&o.push(f.Id)}}catch(g){i={error:g}}finally{try{m&&!m.done&&(n=u["return"])&&n.call(u)}finally{if(i)throw i.error}}}}catch(v){t={error:v}}finally{try{p&&!p.done&&(r=c["return"])&&r.call(c)}finally{if(t)throw t.error}}else"SpecifiedSet"===this.category&&this.fullActis&&0<this.fullActis.length&&this.fullActis.forEach(function(e){return o.push(e.Id)});var h={Category:this.category,DefaultType:this.defaultType,DefaultActivity:this.defaultActivity,DestinationActivities:o};this.submitModal.emit({value:h,parameters:null})}},vn.prototype.clickCancel=function(){this.closeModal.emit()},vn.prototype.validator=function(){return this.category?"SpecifyNode"!==this.defaultType||""!==this.defaultacty||(this.message.warning(this.localePipe.transform("component.jumpScope.noSetSpecifyNode")),!1):(this.message.warning(this.localePipe.transform("component.jumpScope.noSetTargetNode")),!1)},vn.prototype.searchDefault=function(e){this.pageInfo.pageIndex=e.pageInfo.pageIndex,this.pageInfo.pageSize=e.pageInfo.pageSize;e=e.search;this.loadDefault(e)},vn.prototype.loadDefault=function(t){this.pageInfo.pageIndex,this.pageInfo.pageSize,this.pageInfo.pageSize;var e=[],e=t&&t.value?"*"===t.field?this.uistate.allActList.filter(function(e){return-1<e.Name.indexOf(t.value)||-1<e.Id.indexOf(t.value)}):this.uistate.allActList.filter(function(e){return-1<e[t.field].indexOf(t.value)}):this.uistate.allActList;this.total=e.length,e&&this.allActisTable.componentRef.instance.loadData({data:e})},vn.prototype.searchSelect=function(e){this.pageInfo.pageIndex=e.pageInfo.pageIndex,this.pageInfo.pageSize=e.pageInfo.pageSize;e=e.search;this.loadSelect(e)},vn.prototype.loadSelect=function(t){this.pageInfo.pageIndex,this.pageInfo.pageSize,this.pageInfo.pageSize;var e=[],e=t&&t.value?"*"===t.field?this.uistate.allActList.filter(function(e){return-1<e.Name.indexOf(t.value)||-1<e.Id.indexOf(t.value)}):this.uistate.allActList.filter(function(e){return-1<e[t.field].indexOf(t.value)}):this.uistate.allActList;this.total=e.length,e&&this.userActis.componentRef.instance.loadData({data:e})},vn.prototype.deleteRow=function(){var e,t=this;this.actTable.selectedRow&&this.actTable.selectedRow.data?(e=this.actis.findIndex(function(e){return e.id===t.actTable.selectedRow.data.id}),this.actis.splice(e,1),this.actTable.loadData(this.actis)):this.message.info(this.localePipe.transform("component.jumpScope.selectedRow"))},vn.decorators=[{type:b.Component,args:[{selector:"app-jump-scope",template:'<div class="f-page">\r\n  <div class="f-utils-fill-flex-column farris-split-section m-2 h-100">\r\n    <section class="f-utils-fill-flex-column h-100">\r\n      <div class="f-utils-fill-flex-column h-100">\r\n        <form class="h-100">\r\n          <div class="f-utils-fill-flex-column h-100">\r\n            \x3c!-- 允许选择目标节点单选项 --\x3e\r\n            \x3c!-- <div class="mx-4 mt-3 farris-form-controls-inline">\r\n              <div class="farris-group-wrap">\r\n                <div class="form-group farris-form-group">\r\n                  <div class="farris-input-wrap">\r\n                    <div class="custom-control custom-checkbox">\r\n                      <input class="custom-control-input" name="submitterAutoPass" type="checkbox"\r\n                        id="submitterAutoPass" [(ngModel)]="outConnectNode" />\r\n                      <label class="custom-control-label" for="submitterAutoPass">允许选择目标节点</label>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div> --\x3e\r\n            \x3c!-- 可选节点小标题 --\x3e\r\n            <div class="mx-2 mt-1">\r\n              <div class="title-content">\r\n                <h4 class="title-text">{{\'component.jumpScope.optionalNodes\'|wfLocale}}</h4><span class="title-line"></span>\r\n              </div>\r\n            </div>\r\n            <div class="mt-2 mx-4 farris-form-controls-inline">\r\n              <div class="farris-group-wrap">\r\n                <div class="form-group">\r\n                  \x3c!-- 竖列枚举的category选项 --\x3e\r\n                  <farris-radiogroup [(ngModel)]="category" [data]="categoryListItems" name="category"\r\n                    [horizontal]=false>\r\n                  </farris-radiogroup>\r\n                </div>\r\n                \x3c!-- 附加节点帮助 --\x3e\r\n                <farris-lookup-grid #userActisDialog\r\n                  [items]="uistate.allActList | jumpScopePipe:uistate.propertyData.Id " [columns]="cols"\r\n                  [disabled]="!(category === \'SpecifiedSet\')" [resizable]="true" [singleSelect]="false" [idField]="\'Id\'"\r\n                  [textField]="\'Name\'" [(ngModel)]="actis" [valueField]="\'Id\'" [pagination]="true"\r\n                  [pageIndex]="pageInfo.pageIndex" name="defaultActivities" [pageSize]="pageInfo.pageSize" (search)="searchSelect($event)"\r\n                  [pageList]="pageInfo.pageList" [total]="total" [enableClear]="false" title="{{\'component.jumpScope.listOfAdditional\'|wfLocale}}"\r\n                  [displayType]="\'List\'" [remoteSearch]=\'false\' [enableToSelect]="false" placeholder="{{\'component.jumpScope.pleaseSelect1\'|wfLocale}}" [dictPicked]="actisSelect">\r\n                </farris-lookup-grid>\r\n              </div>\r\n            </div>\r\n            \x3c!-- 默认节点小标题 --\x3e\r\n            <div class="mx-2 mt-1">\r\n              <div class="title-content">\r\n                <h4 class="title-text">{{\'component.jumpScope.defaultNode\'|wfLocale}}</h4><span class="title-line"></span>\r\n              </div>\r\n            </div>\r\n            <div class="mt-2 mx-4 farris-form-controls-inline">\r\n              <div class="farris-group-wrap">\r\n                <div class="form-group">\r\n                  \x3c!-- 竖列枚举的DefaultType选项 --\x3e\r\n                  <farris-radiogroup [(ngModel)]="defaultType" [data]="defaultTypeListItems" name="defaultType"\r\n                    [horizontal]=false>\r\n                  </farris-radiogroup>\r\n                </div>\r\n                \x3c!-- 默认节点帮助 --\x3e\r\n                <farris-lookup-grid #allActisTable [items]="uistate.allActList | jumpScopePipe:uistate.propertyData.Id "\r\n                  [columns]="cols" [disabled]="!(defaultType === \'SpecifyNode\')" [resizable]="true"\r\n                  [singleSelect]="true" [idField]="\'Id\'" [textField]="\'Name\'" [(ngModel)]="defaultacty"\r\n                  [valueField]="\'Id\'" [pagination]="true" placeholder="{{\'component.jumpScope.pleaseSelect2\'|wfLocale}}" [pageIndex]="pageInfo.pageIndex"\r\n                  name="defaultActivity" [pageSize]="pageInfo.pageSize" [pageList]="pageInfo.pageList" [total]="total"\r\n                  [enableClear]="false" title="{{\'component.jumpScope.defaultNodeList\'|wfLocale}}" (search)="searchDefault($event)" [displayType]="\'List\'" [remoteSearch]=\'false\' [dictPicked]="defaultActivitySelect">\r\n                </farris-lookup-grid>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </section>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type="button" class="btn btn-secondary btn-sm" (click)="clickCancel()">{{\'component.jumpScope.clickCancel\'|wfLocale}}</button>\r\n  <button type="button" class="btn btn-primary btn-sm mx-2" (click)="clickOK()">{{\'component.jumpScope.clickOK\'|wfLocale}}</button>\r\n</ng-template>\r\n\r\n\x3c!-- <ng-template #buttonRef>\r\n  <button class="btn btn-sm btn-primary mx-2" (click)="actisSelect()">确定</button>\r\n  <button class="btn btn-sm btn-default" (click)="allActisDialog.close()">取消</button>\r\n</ng-template> --\x3e\r\n\x3c!-- <farris-dialog #allActisDialog [buttons]="buttonRef" [width]="700" [height]="520" title="\'活动列表\'">\r\n  <div class="f-utils-fill-flex-column farris-overflow-y-auto h-100 m-2">\r\n    <farris-datagrid #allActisTable [columns]="cols"\r\n      [data]="uistate.userActList | jumpScopePipe:uistate.propertyData.Id" [idField]="\'Id\'" [fit]="true"\r\n      [fitColumns]="true" [pagination]=\'false\' [multiSelect]="true" [showCheckbox]="true" [multiSelect]="true"\r\n      [checkOnSelect]="true" [selectOnCheck]="true">\r\n    </farris-datagrid>\r\n  </div>\r\n</farris-dialog> --\x3e\r\n',providers:[x],styles:[".title-content{color:#000;display:inline-flex;align-items:center;line-height:1.375rem;position:relative;overflow:hidden;padding:0 0 0 1rem;min-width:760px}.title-content ::before{content:'';width:.25rem;height:1.125rem;background:#59a1ff;border-radius:1px;position:absolute;top:50%;left:0;margin-top:-.5625rem}.title-text{font-size:1rem;line-height:1.375rem;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;margin-bottom:0;margin-right:10px}.title-line{flex-grow:1;border-bottom:1px dashed rgba(0,0,0,.1)}"]}]}],vn.ctorParameters=function(){return[{type:a},{type:r.MessagerService},{type:b.ChangeDetectorRef,decorators:[{type:b.Optional}]},{type:String,decorators:[{type:b.Inject,args:[b.LOCALE_ID]}]},{type:undefined,decorators:[{type:b.Inject,args:[o]}]},{type:x,decorators:[{type:b.Optional}]}]},vn.propDecorators={cls:[{type:b.HostBinding,args:["class"]}],closeModal:[{type:b.Output}],submitModal:[{type:b.Output}],value:[{type:b.Input}],modalFooter:[{type:b.ViewChild,args:["iconSelectFooter"]}],allActisTable:[{type:b.ViewChild,args:["allActisTable"]}],allActisDialog:[{type:b.ViewChild,args:["allActisDialog"]}],actTable:[{type:b.ViewChild,args:["actTable"]}],lookup:[{type:b.ViewChild,args:["lookup"]}],userActis:[{type:b.ViewChild,args:["userActisDialog"]}]};var gn=vn;function vn(e,t,r,i,n,o){var a=this;this.uistate=e,this.message=t,this.cdr=r,this.localeId=i,this.resources=n,this.localePipe=o,this.cls="farris-main-area flex-column",this.closeModal=new b.EventEmitter,this.submitModal=new b.EventEmitter,this.modalConfig={title:this.localePipe.transform("component.jumpScope.targetNodeOptions"),width:520,height:460,showButtons:!0},this.cols=[{title:this.localePipe.transform("component.jumpScope.name"),field:"Name",width:60,searchField:"Name"},{title:"ID",field:"Id",width:90,searchField:"Id"}],this.actis=[],this.fullActis=[],this.defaultacty="",this.categoryListItems=[{value:"OutConnectNode",name:this.localePipe.transform("component.jumpScope.outConnectNode")},{value:"Global",name:this.localePipe.transform("component.jumpScope.global")},{value:"AfterNodes",name:this.localePipe.transform("component.jumpScope.afterNodes")},{value:"SpecifiedSet",name:this.localePipe.transform("component.jumpScope.specifiedSet")}],this.category="",this.defaultType="",this.defaultTypeListItems=[{value:"FirstNode",name:this.localePipe.transform("component.jumpScope.firstNode")},{value:"NullNode",name:this.localePipe.transform("component.jumpScope.nullNode")},{value:"SpecifyNode",name:this.localePipe.transform("component.jumpScope.specifyNode")}],this.defaultActivity="",this.pageInfo={pageIndex:1,pageList:[10,20,30,50],pageSize:20},this.actisSelect=function(e){return a.fullActis=e,v.of({closeDialog:!0})},this.defaultActivitySelect=function(e){return a.defaultActivity=e.Id,v.of({closeDialog:!0})},this.localePipe=this.localePipe||new x(i,n)}xn.prototype.convertTo=function(){return this.localePipe.transform("component.jumpScope.set")};var bn=xn;function xn(e){this.localePipe=e}var wn="sequence",Pn="backToMe",Cn="backToCurrentNode",In=(Object.defineProperty(Sn.prototype,"value",{set:function(e){var t,r,i=this;if(e){this.selectAbleChecked=e.SelectTargetAble,e.SelectTargetAble?this.selectTargetList=e.SelectTargetList:this.selectTargetList=new Array,this.waitReturnChecked=e.WaitReturn,this.dynamicBackWardRuleAbleChecked=e.DynamicBackWardRuleAble,this.resubmitEffect=e.ResubmitEffect,e.TargetRef?this.targetRef=e.TargetRef:this.targetRef="Empty",null===this.resubmitEffect&&(this.resubmitEffect=wn);e=e.SelectTargetList;if(e&&0<e.length){var n=this;try{for(var o=ue(e),a=o.next();!a.done;a=o.next())!function(t){var e;n.listItems.filter(function(e){return e.Id===t})[0]&&(e=n.listItems.filter(function(e){return e.Id===t})[0].Name,n.displayTestText.push(e))}(a.value)}catch(s){t={error:s}}finally{try{a&&!a.done&&(r=o["return"])&&r.call(o)}finally{if(t)throw t.error}}}e=this.listItems.find(function(e){return e.Id===i.targetRef});e?this.displayText=e.Name:(this.displayText="",setTimeout(function(){i.message.warning(i.localePipe.transform("component.backwardRule.reEdit"))},500))}},enumerable:!0,configurable:!0}),Sn.prototype.ngOnInit=function(){this.nodeType=this.editorParams.nodeType,"UserActivity"!==this.nodeType&&(this.listItems=this.listItems.filter(function(e){return"Empty"!==e.Id}),this.items=this.listItems,this.total=this.listItems.length),this.itemsBackScope=this.listItems.filter(function(e){return"Empty"!==e.Id&&"PrecursorActivityId"!==e.Id}),this.totalBackScope=this.itemsBackScope.length,this.itemsTemp=this.deepCloneDefine(this.items),this.itemsBackScopeTemp=this.deepCloneDefine(this.itemsBackScope)},Sn.prototype.ngAfterViewInit=function(){},Sn.prototype.selectAbleClick=function(){var e=this;"wf.UserActivity"===this.uiState.propertyData.ClrTypeID&&this.uiState.propertyData.CompleteStrategy!==this.uiState.completeIterator[0].key&&!0===this.selectAbleChecked&&this.message.info(this.localePipe.transform("component.backwardRule.selectAbleClick"),function(){e.selectAbleChecked=!1}),0==this.selectAbleChecked&&(this.displayTestText=[])},Sn.prototype.waitReturnClick=function(){this.waitReturnChecked=!this.waitReturnChecked},Sn.prototype.dynamicBackWardRuleAbleClick=function(){this.dynamicBackWardRuleAbleChecked=!this.dynamicBackWardRuleAbleChecked},Sn.prototype.clickOK=function(){var e,t,r,i=this,n=[];if(0===this.fullActs.length&&0<this.displayTestText.length)try{for(var o=ue(this.displayTestText),a=o.next();!a.done;a=o.next()){var s=a.value;try{for(var l=ue(this.listItems),c=l.next();!c.done;c=l.next()){var p=c.value;s===p.Name&&n.push(p.Id)}}catch(u){t={error:u}}finally{try{c&&!c.done&&(r=l["return"])&&r.call(l)}finally{if(t)throw t.error}}}}catch(m){e={error:m}}finally{try{a&&!a.done&&(d=o["return"])&&d.call(o)}finally{if(e)throw e.error}}else this.fullActs&&0<this.fullActs.length&&this.fullActs.forEach(function(t){i.uiState.userActList.some(function(e){return e.Id==t.Id})&&n.push(t.Id)});var d={TargetRef:this.getTargetRef(),SelectTargetAble:this.selectAbleChecked,WaitReturn:this.waitReturnChecked,DynamicBackWardRuleAble:this.dynamicBackWardRuleAbleChecked,SelectTargetList:n,ResubmitEffect:this.resubmitEffect};this.submitModal.emit({value:d,parameters:null})},Sn.prototype.clickCancel=function(){this.closeModal.emit()},Sn.prototype.pagerChanged=function(e){this.pageInfo.pageIndex=e.pageIndex,this.pageInfo.pageSize=e.pageSize;e={field:e.searchValue.searchField,value:e.searchValue.searchValue};this.load(e)},Sn.prototype.pagerChangedBackScope=function(e){this.pageInfo.pageIndex=e.pageIndex,this.pageInfo.pageSize=e.pageSize;e={field:e.searchValue.searchField,value:e.searchValue.searchValue};this.loadBackScope(e)},Sn.prototype.pageSizeChange=function(e){console.log(e),this.pageInfo.pageIndex=e.pageIndex,this.pageInfo.pageSize=e.pageSize;e={field:e.searchValue.searchField,value:e.searchValue.searchValue};this.load(e)},Sn.prototype.pageSizeChangeBackScope=function(e){console.log(e),this.pageInfo.pageIndex=e.pageIndex,this.pageInfo.pageSize=e.pageSize;e={field:e.searchValue.searchField,value:e.searchValue.searchValue};this.loadBackScope(e)},Sn.prototype.search=function(e){this.pageInfo.pageIndex=e.pageInfo.pageIndex,this.pageInfo.pageSize=e.pageInfo.pageSize;e=e.search;this.load(e)},Sn.prototype.searchBackScope=function(e){this.pageInfo.pageIndex=e.pageInfo.pageIndex,this.pageInfo.pageSize=e.pageInfo.pageSize;e=e.search;this.loadBackScope(e)},Sn.prototype.load=function(t){this.pageInfo.pageIndex,this.pageInfo.pageSize,this.pageInfo.pageSize;var e=[],e=t?"*"===t.field?this.listItems.filter(function(e){return-1<e.Name.indexOf(t.value)||-1<e.Id.indexOf(t.value)}):this.listItems.filter(function(e){return-1<e[t.field].indexOf(t.value)}):this.listItems;this.total=e.length,this.items=e,this.hlp.componentRef.instance.loadData({data:this.items})},Sn.prototype.loadBackScope=function(t){this.pageInfo.pageIndex,this.pageInfo.pageSize,this.pageInfo.pageSize;var e=[],e=t?"*"===t.field?this.listItems.filter(function(e){return-1<e.Name.indexOf(t.value)||-1<e.Id.indexOf(t.value)}):this.listItems.filter(function(e){return-1<e[t.field].indexOf(t.value)}):this.listItems;this.totalBackScope=e.length,this.itemsBackScope=e,this.hlpScope.componentRef.instance.loadData({data:this.itemsBackScope})},Sn.prototype.getTargetRef=function(){return"Empty"===this.targetRef?"":this.targetRef},Sn.prototype.deepCloneDefine=function(e){var t=[];return e.forEach(function(e){return t.push(JSON.stringify(e))}),t},Sn.prototype.deepCloneBackDefine=function(e){var t=[];return e.forEach(function(e){return t.push(JSON.parse(e))}),t},Sn.decorators=[{type:b.Component,args:[{selector:"procDesigner-backward-rule",template:'<div class="f-page">\r\n  <div class="f-utils-fill-flex-column farris-split-section m-2 h-100">\r\n    <section class="f-utils-fill-flex-column h-100">\r\n      <div class="f-utils-fill-flex-column farris-overflow-y-auto h-100" style="border-radius:16px;border: 1.5px solid #F1F3F7;">\r\n        <div class="farris-form form-inline farris-form-inline">\r\n          <div class="col-12 farris-group-auto my-3 pr-5">\r\n            <div class="farris-group-wrap">\r\n              <div class="form-group farris-form-group">\r\n                <label class="col-form-label">\r\n                  <span class="farris-label-info text-danger">*</span>\r\n                  <span class="farris-label-text">{{\'component.backwardRule.rejectedTo:\' | wfLocale}}</span>\r\n                </label>\r\n                <div class="farris-input-wrap" style="padding-right: 30px">\r\n                  <farris-lookup-grid #hlp [items]="items" [columns]="columns" [resizable]="true" [singleSelect]="true"\r\n                    [idField]="\'Id\'" [textField]="\'Name\'" [(ngModel)]="displayText" [valueField]="\'Id\'"  [beforeOpen] = "beforeOpen"\r\n                    [pagination]="false" [pageIndex]="pageInfo.pageIndex" [pageSize]="pageInfo.pageSize"\r\n                    [pageList]="pageInfo.pageList" [total]="total" title="{{\'component.backwardRule.title\' | wfLocale}}" [displayType]="\'List\'"\r\n                    [dictPicked]="dictPicked" [remoteSearch]=\'false\' (pagerChanged)="pagerChanged($event)"\r\n                    (search)="search($event)" [enableClear]="false" (pageSizeChange)="pageSizeChange($event)">\r\n                  </farris-lookup-grid>\r\n                  <div class="farris-feedback valid-feedback"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div *ngIf="nodeType===\'UserActivity\'">\r\n            <div class="col-12 farris-group-auto my-3">\r\n              <div class="farris-group-wrap" style="padding-left: 2.75rem!important">\r\n                <div class="form-group farris-form-group">\r\n                  <div class="farris-input-wrap">\r\n                    <div class="custom-control custom-checkbox">\r\n                      <input class="custom-control-input" name="selectAble" type="checkbox" id="selectAble"\r\n                        [(ngModel)]="selectAbleChecked" (change)="selectAbleClick()" />\r\n                      <label class="custom-control-label" for="selectAble">{{\'component.backwardRule.dynamicSelection\' | wfLocale}}</label>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div class="col-12 farris-group-auto my-3 pr-5" *ngIf="selectAbleChecked">\r\n              <div class="farris-group-wrap">\r\n                <div class="form-group farris-form-group">\r\n                  <label class="col-form-label">\r\n                    <span class="farris-label-text">{{\'component.backwardRule.backScope\' | wfLocale}}</span>\r\n                  </label>\r\n                  <div class="farris-input-wrap" style="padding-right: 30px;">\r\n                    <farris-lookup-grid #hlpScope [items]="itemsBackScope" [columns]="columns" [disabled]="!(selectAbleChecked)"  [beforeOpen] = "beforeOpenTest"\r\n                      [resizable]="true" [singleSelect]="false" [idField]="\'Id\'" [textField]="\'Name\'" [(ngModel)]="displayTestText" [valueField]="\'Id\'"\r\n                      [pagination]="false" [pageIndex]="pageInfo.pageIndex" [pageSize]="pageInfo.pageSize"\r\n                      [pageList]="pageInfo.pageList" [total]="totalBackScope" title="{{\'component.backwardRule.title\' | wfLocale}}" [displayType]="\'List\'"\r\n                      [dictPicked]="dictPickedTest" [remoteSearch]=\'false\' (pagerChanged)="pagerChangedBackScope($event)"\r\n                      placeholder="{{\'component.backwardRule.defaultPrompt\' | wfLocale}}" [enableToSelect]="false"\r\n                      (search)="searchBackScope($event)" [enableClear]="false" (pageSizeChange)="pageSizeChangeBackScope($event)">\r\n                    </farris-lookup-grid>\r\n                    <div class="farris-feedback valid-feedback"></div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div class="col-12 farris-group-auto my-3 pr-5">\r\n              <div class="farris-group-wrap">\r\n                <div class="form-group farris-form-group">\r\n                  <label class="col-form-label">\r\n                    <span class="farris-label-text">{{\'component.backwardRule.resubmitEffectOptions\' | wfLocale}}</span>\r\n                  </label>\r\n                  <div class="farris-input-wrap" style="padding-right: 30px">\r\n                    <farris-combo-list [data]="resubmitEffectOptions" [textField]="\'text\'" [valueField]="\'value\'"\r\n                      [idField]="\'value\'" [(ngModel)]="resubmitEffect" style="flex: 1;" [enableClear]="false">\r\n                    </farris-combo-list>\r\n                    <div class="farris-feedback valid-feedback"></div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div class="col-12 farris-group-auto my-3 pr-5">\r\n              <div class="farris-group-wrap">\r\n                <div class="form-group farris-form-group">\r\n                  <label class="col-form-label">\r\n                    <span class="farris-label-text"></span>\r\n                  </label>\r\n                  <div class="farris-input-wrap" style="padding-right: 30px;border-radius:15px">\r\n                    <div class="page-friendly-reminder" style="background:#ECF4FF;padding: 0.5rem!important;border-radius:6px">\r\n                      <div class="reminder-message">\r\n                        <span class="reminder-title">\r\n                          <span class="f-icon f-icon-info">\r\n                          </span>\r\n                          <span class="reminder-name" style="padding-left: 0.25rem">\r\n                          </span>\r\n                        </span>\r\n                        <span class="message"><br/>{{\'component.backwardRule.popover1\' | wfLocale}}<br/>\r\n                          {{\'component.backwardRule.popover2\' | wfLocale}}<br/>\r\n                          {{\'component.backwardRule.popover3\' | wfLocale}}<br/>\r\n                        </span>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div class="col-12 farris-group-auto my-3">\r\n              <div class="farris-group-wrap" style="padding-left: 2.75rem!important">\r\n                <div class="form-group farris-form-group">\r\n                  <div class="farris-input-wrap">\r\n                    <div class="custom-control custom-checkbox">\r\n                      <input class="custom-control-input" name="dynamicBackWardRuleAble" type="checkbox"\r\n                        id="dynamicBackWardRuleAble" [checked]="dynamicBackWardRuleAbleChecked"\r\n                        (change)="dynamicBackWardRuleAbleClick()" />\r\n                      <label class="custom-control-label" for="dynamicBackWardRuleAble">{{\'component.backwardRule.allowModification\' | wfLocale}}</label>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </section>\r\n  </div>\r\n</div>\r\n<ng-template #iconSelectFooter>\r\n  <button type="button" class="btn btn-secondary btn-sm mx-2" (click)="clickCancel()">{{\'component.backwardRule.clickCancel\' | wfLocale}}</button>\r\n  <button type="button" class="btn btn-primary btn-sm mx-2" (click)="clickOK()">{{\'component.backwardRule.clickOk\' | wfLocale}}</button>\r\n</ng-template>\r\n',providers:[x],styles:[".item-header{padding:1rem}.item{padding:.5rem 5rem}"]}]}],Sn.ctorParameters=function(){return[{type:a},{type:r.MessagerService},{type:Te.NotifyService},{type:b.ChangeDetectorRef,decorators:[{type:b.Optional}]},{type:String,decorators:[{type:b.Inject,args:[b.LOCALE_ID]}]},{type:undefined,decorators:[{type:b.Inject,args:[o]}]},{type:x,decorators:[{type:b.Optional}]}]},Sn.propDecorators={cls:[{type:b.HostBinding,args:["class"]}],editorParams:[{type:b.Input}],value:[{type:b.Input}],nodeType:[{type:b.Input}],closeModal:[{type:b.Output}],submitModal:[{type:b.Output}],modalFooter:[{type:b.ViewChild,args:["iconSelectFooter"]}],hlp:[{type:b.ViewChild,args:["hlp"]}],hlpScope:[{type:b.ViewChild,args:["hlpScope"]}]},Sn);function Sn(e,t,r,i,n,o,a){var s=this;this.uiState=e,this.message=t,this.notify=r,this.cdr=i,this.localeId=n,this.resources=o,this.localePipe=a,this.cls="farris-main-area flex-column",this.editorParams={},this.nodeType="UserActivity",this.closeModal=new b.EventEmitter,this.submitModal=new b.EventEmitter,this.modalConfig={title:this.localePipe.transform("component.backwardRule.backwardRule"),width:760,height:505,showButtons:!0},this.displayTestText=[],this.fullActs=[],this.listItems=[{Id:"InitialActityId",Name:this.localePipe.transform("component.backwardRule.initialActityId")},{Id:"PrecursorActivityId",Name:this.localePipe.transform("component.backwardRule.precursorActivityId")},{Id:"Empty",Name:this.localePipe.transform("component.backwardRule.empty")}],this.items=[],this.itemsTemp=[],this.itemsBackScope=[],this.itemsBackScopeTemp=[],this.columns=[{title:this.localePipe.transform("component.backwardRule.name"),field:"Name",width:100,searchField:"Name"},{title:this.localePipe.transform("component.backwardRule.id"),field:"Id",width:100,searchField:"Id"}],this.selectAbleChecked=!1,this.waitReturnChecked=!1,this.resubmitEffectOptions=[{value:wn,text:this.localePipe.transform("component.backwardRule.sequence")},{value:Pn,text:this.localePipe.transform("component.backwardRule.backToMe")},{value:Cn,text:this.localePipe.transform("component.backwardRule.backToCurrentNode")}],this.dynamicBackWardRuleAbleChecked=!1,this.targetRef=this.listItems[0].Id,this.selectTargetList=new Array,this.popover="1.顺序流转:按照流转线顺序进行流转; 2.返回我:完成策略为抢占：只给驳回人创建任务,完成策略为会签：驳回人与未审批人收到新任务，已审批人员自动审批通过; 3.返回本节点:实际效果受“再次进入节点时，办理人是否是节点已办人员影响”选项的影响",this.pageInfo={pageIndex:1,pageList:[10,20,30,50],pageSize:20},this.dictPicked=function(e){return s.targetRef=e.Id,s.displayText=e.Name,"Empty"!==e.Id||s.selectAbleChecked||(s.selectAbleChecked=!0,s.notify.info(s.localePipe.transform("component.backwardRule.dictPicked"))),v.of({closeDialog:!0})},this.dictPickedTest=function(e){return s.fullActs=e,v.of({closeDialog:!0})},this.beforeOpen=function(){return s.items=s.deepCloneBackDefine(s.itemsTemp),v.of(!0)},this.beforeOpenTest=function(){return s.itemsBackScope=s.deepCloneBackDefine(s.itemsBackScopeTemp),v.of(!0)},this.localePipe=this.localePipe||new x(n,o),this.listItems=this.listItems.concat(this.uiState.userActList),this.items=this.listItems,this.itemsBackScope=this.listItems,this.total=this.listItems.length,this.totalBackScope=this.listItems.length}Tn.prototype.convertTo=function(e){return e?this.localePipe.transform("component.backwardRule.set"):this.localePipe.transform("component.backwardRule.notSet")};var En=Tn;function Tn(e){this.localePipe=e}kn.prototype.clearPerformer=function(){this.performerInfo.performers=new Array,this.performerInfo.components=new Array,this.performerInfo.reportingLines=new Array,this.performerInfo.matrixParticipants=new Array,this.performerInfo.activityExecutors=new Array,this.performerInfo.organizationParticipants=new Array,this.performersList=new Array},kn.decorators=[{type:b.Injectable}],kn.ctorParameters=function(){return[{type:a}]};var An=kn;function kn(e){this.uiState=e,this.performersList=[],this.typeCollection=[{text:"用户",value:"wf.UserParticipantExpression"},{text:"变量参与者",value:"wf.VariableParticipantExpression"},{text:"岗位",value:"wf.PositionParticipantExpression"},{text:"构件参与者",value:"wf.ComponentParticipantExpression"},{text:"汇报关系",value:"wf.ReportingLineParticipantExpression"},{text:"矩阵",value:"wf.MatrixParticipantExpression"},{text:"历史活动办理人",value:"wf.ActivityExecutorParticipantExpression"},{text:"单位/部门",value:"wf.OrganizationParticipantExpression"}],this.performerInfo={performers:[],variablePerformers:[],components:[],reportingLines:[],matrixParticipants:[],activityExecutors:[],organizationParticipants:[],options:null,isAllScope:!1},"inSuite"===this.uiState.scene?this.typeCollection=[{text:"用户",value:"wf.UserParticipantExpression"},{text:"变量参与者",value:"wf.VariableParticipantExpression"},{text:"角色",value:"wf.PositionParticipantExpression"},{text:"构件参与者",value:"wf.ComponentParticipantExpression"},{text:"汇报关系",value:"wf.ReportingLineParticipantExpression"},{text:"矩阵",value:"wf.MatrixParticipantExpression"},{text:"历史活动办理人",value:"wf.ActivityExecutorParticipantExpression"},{text:"单位/部门",value:"wf.OrganizationParticipantExpression"}]:this.typeCollection=[{text:"用户",value:"wf.UserParticipantExpression"},{text:"变量参与者",value:"wf.VariableParticipantExpression"},{text:"岗位",value:"wf.PositionParticipantExpression"},{text:"构件参与者",value:"wf.ComponentParticipantExpression"},{text:"汇报关系",value:"wf.ReportingLineParticipantExpression"},{text:"矩阵",value:"wf.MatrixParticipantExpression"},{text:"历史活动办理人",value:"wf.ActivityExecutorParticipantExpression"},{text:"单位/部门",value:"wf.OrganizationParticipantExpression"}]}On.decorators=[{type:b.Injectable}];ki=On;function On(){}Dn.decorators=[{type:b.Injectable}],Dn.ctorParameters=function(){return[{type:b.ComponentFactoryResolver},{type:b.Injector},{type:i.BsModalService}]};var Mn=Dn;function Dn(e,t,r){this.resolver=e,this.injector=t,this.modalService=r}n(Fn,Nn=$r);var Nn,Ln=Fn;function Fn(e,t,r){return Nn.call(this,e,t,r)||this}Vn.prototype.getLookupConfig=function(){return this.lookupConfig.asObservable()},Vn.decorators=[{type:b.Injectable}],Vn.ctorParameters=function(){return[{type:t.HttpService}]};var Rn=Vn;function Vn(e){var t=this;this.http=e,this.lookupConfig=new N.ReplaySubject,this.http.get("/platform/runtime/wf/web/wf-proc-designer/assets/config/performerlookupconfig.json").subscribe(function(e){t.lookupConfig.next(e)})}Bn.prototype.ngOnInit=function(){var t=this;this.http.get("/api/runtime/wf/v1.0/reportingOrgType/hasAdminOrg").subscribe(function(e){t.hasAdminOrg=e,"inSuite"===t.designerUIState.scene&&"variable"===t.userType?t.userTypeButtonNeedShow=!0:t.userTypeButtonNeedShow=e&&("variable"===t.userType||null===t.userType)})},Bn.prototype.ngAfterViewInit=function(){var e=this;this.ngZone.runOutsideAngular(function(){e.inputGroup.nativeElement.addEventListener("mouseenter",e.onMouseEnter.bind(e)),e.inputGroup.nativeElement.addEventListener("mouseleave",e.onMouseLeave.bind(e))})},Bn.prototype.onMouseEnter=function(e){this.showClearButton=!0,this.showClearButton&&this.toggleClearIcon(e,!0)},Bn.prototype.onMouseLeave=function(e){this.showClearButton=!1,this.toggleClearIcon(e,!1)},Bn.prototype.toggleClearIcon=function(e,t){t=(t=void 0===t?!1:t)?"":"none",e=e.target.querySelector(".input-group-clear");e&&(e.style.display=t)},Bn.prototype.clear=function(e){this.bindingData={},this.users=[],this.selectedUserIds="",this.variableOrgTypes=[{name:this.localePipe.transform("component.userPerformer.sys"),value:"Sys"},{name:this.localePipe.transform("component.userPerformer.administrative_organization"),value:"Administrative_organization"}]},Bn.prototype.selectUsers=function(e){var r=this;this.userType===this.userTypeCollection[0].value?this.lookupConfig.getLookupConfig().subscribe(function(e){e.user&&e.user.impl?System["import"](e.user.impl).then(function(e){Object.values(e)[0].create(r.injector).instance.showHelp().subscribe(function(e){e&&0<e.length&&(r.users=e.map(function(e){var t=new Ln(e.id,e.name,"wf.UserParticipantExpression");return t.orgId=e.orgId,t.orgName=e.orgName,t.userType=r.userTypeCollection[0].value,t}))})}):r.userHelp.farrisDialogshow()}):this.showExprHelp()},Bn.prototype.editConditon=function(){var e,t,r,i,n,o,a,s,l=this;if(0<this.designerUIState.schemas.length){try{for(var c=ue(this.designerUIState.schemas),p=c.next();!p.done;p=c.next()){var d=p.value;this.expr.addSchema("Schema",d)}}catch(x){e={error:x}}finally{try{p&&!p.done&&(s=c["return"])&&s.call(c)}finally{if(e)throw e.error}}this.designerUIState.schemas[0].entityTypes&&0<this.designerUIState.schemas[0].entityTypes.length&&(s=this.designerUIState.schemas[0].entityTypes[0],this.expr.addInjectedEntity(s.name,"Schema",s.name,D.InjectedType.EntityType))}var u=new Array,u=this.designerUIState.addContext(u);if(0<this.designerUIState.subActivityContext.length)try{for(var m=ue(this.designerUIState.subActivityContext),f=m.next();!f.done;f=m.next())!function(t){u.some(function(e){return e.key===t.key})||u.push(t)}(f.value)}catch(w){t={error:w}}finally{try{f&&!f.done&&(r=m["return"])&&r.call(m)}finally{if(t)throw t.error}}if(0<this.designerUIState.activityComponentContext.length)try{for(var h=ue(this.designerUIState.activityComponentContext),y=h.next();!y.done;y=h.next())!function(t){u.some(function(e){return e.key===t.key})||u.push(t)}(y.value)}catch(P){i={error:P}}finally{try{y&&!y.done&&(n=h["return"])&&n.call(h)}finally{if(i)throw i.error}}if(0<u.length)try{for(var g=ue(u),v=g.next();!v.done;v=g.next()){var b=v.value;this.expr.addContext(b)}}catch(C){o={error:C}}finally{try{v&&!v.done&&(a=g["return"])&&a.call(g)}finally{if(o)throw o.error}}this.expr.setEditPattern(D.ExprEditMode.Conditional),this.expr.addExpressionText(this.condition),this.expr.buildExpression().then(function(e){l.condition=e,0<u.length&&(l.expr.exprEntity.contextEntities=l.expr.exprEntity.contextEntities.filter(function(t){return!u.some(function(e){return e.key===t.key})}))})},Bn.prototype.usersSelect=function(e){var r=this;this.users=e.data.map(function(e){var t=new Ln(e.userId,e.name,"wf.UserParticipantExpression");return t.orgId=e.defaultOrgId,t.orgName=e.orgAllPath,t.userType=r.userTypeCollection[0].value,t})},Bn.prototype.showExprHelp=function(){var e,t,r,i,n,o,a,s,l,c,p=this;if(this.expr.setEditPattern(D.ExprEditMode.Advanced),0<this.designerUIState.schemas.length){try{for(var d=ue(this.designerUIState.schemas),u=d.next();!u.done;u=d.next()){var m=u.value;this.expr.addSchema("Schema",m)}}catch(S){e={error:S}}finally{try{u&&!u.done&&(c=d["return"])&&c.call(d)}finally{if(e)throw e.error}}this.designerUIState.schemas[0].entityTypes&&0<this.designerUIState.schemas[0].entityTypes.length&&(c=this.designerUIState.schemas[0].entityTypes[0],this.expr.addInjectedEntity(c.name,"Schema",c.name,D.InjectedType.EntityType))}var f=new Array;if(0<this.designerUIState.participantContext.length)try{for(var h=ue(this.designerUIState.participantContext),y=h.next();!y.done;y=h.next()){var g=y.value;f.push(g)}}catch(E){t={error:E}}finally{try{y&&!y.done&&(r=h["return"])&&r.call(h)}finally{if(t)throw t.error}}if(0<this.designerUIState.subActivityContext.length)try{for(var v=ue(this.designerUIState.subActivityContext),b=v.next();!b.done;b=v.next())!function(t){f.some(function(e){return e.key===t.key})||f.push(t)}(g=b.value)}catch(T){i={error:T}}finally{try{b&&!b.done&&(n=v["return"])&&n.call(v)}finally{if(i)throw i.error}}if(0<this.designerUIState.processVariableContext.length)try{for(var x=ue(this.designerUIState.processVariableContext),w=x.next();!w.done;w=x.next())!function(t){f.some(function(e){return e.key===t.key})||f.push(t)}(g=w.value)}catch(A){o={error:A}}finally{try{w&&!w.done&&(a=x["return"])&&a.call(x)}finally{if(o)throw o.error}}if(0<f.length)try{for(var P=ue(f),C=P.next();!C.done;C=P.next()){var I=C.value;this.expr.addContext(I)}}catch(k){s={error:k}}finally{try{C&&!C.done&&(l=P["return"])&&l.call(P)}finally{if(s)throw s.error}}0<this.users.length?this.expr.addExpressionText(this.users[0].performerId):this.expr.addExpressionText(""),this.expr.buildExpression().then(function(e){var t,r,i=new Ln(e,"","wf.UserParticipantExpression");i.tag="expression",i.performerName=p.variableParticipantName(e),i.userType=p.userTypeCollection[1].value,""===p.variableParticipantName(e)?(p.message.error(p.localePipe.transform("component.userPerformer.cantUseContext")),p.users=[]):p.users=[i];try{for(var n=ue(p.designerUIState.participantContext),o=n.next();!o.done;o=n.next()){var a=o.value;if(0<=i.performerId.indexOf(a.key)){p.variableOrgTypes=[{name:p.localePipe.transform("component.userPerformer.sys"),value:"Sys"}];break}p.variableOrgTypes=[{name:p.localePipe.transform("component.userPerformer.sys"),value:"Sys"},{name:p.localePipe.transform("component.userPerformer.administrative_organization"),value:"Administrative_organization"}]}}catch(s){t={error:s}}finally{try{o&&!o.done&&(r=n["return"])&&r.call(n)}finally{if(t)throw t.error}}0<f.length&&(p.expr.exprEntity.contextEntities=p.expr.exprEntity.contextEntities.filter(function(t){return!f.some(function(e){return e.key===t.key})}))})},Bn.prototype.getPerformers=function(){var t=this;return this.users.map(function(e){if(e.orgId===undefined)return e.orgType=t.curOrgType,e}),this.condition||(this.condition=""),!this.condition&&""!==this.condition||(this.users=this.users.map(function(e){return e.condition=t.condition,e})),this.users},Bn.prototype.variableParticipantName=function(e){var t,r,i,n;try{for(var o=ue(this.designerUIState.participantContext),a=o.next();!a.done;a=o.next()){var s=a.value;if(-1<e.indexOf(s.key))return"Sys"!==this.curOrgType?"":s.name}}catch(p){t={error:p}}finally{try{a&&!a.done&&(r=o["return"])&&r.call(o)}finally{if(t)throw t.error}}try{for(var l=ue(this.designerUIState.processVariableContext),c=l.next();!c.done;c=l.next()){s=c.value;if(-1<e.indexOf(s.key))return s.name}}catch(d){i={error:d}}finally{try{c&&!c.done&&(n=l["return"])&&n.call(l)}finally{if(i)throw i.error}}return JSON.parse(e).expr},Bn.prototype.orgTypeChange=function(e){this.curOrgType=("Sys"===e?this.variableOrgTypes[0]:this.variableOrgTypes[1]).value},Bn.decorators=[{type:b.Component,args:[{selector:"app-user-performer",template:'<div class="d-flex flex-fill farris-overflow-y-auto p-md-2" style="background: #FFF;">\r\n  <div class="d-flex flex-fill farris-overflow-y-auto mx-3 my-2" style="border-radius:16px;border: 1.5px solid #F1F3F7;">\r\n  <form style="width: 100%;" >\r\n    <div class="d-flex m-2 flex-column w-100">\r\n      <div class="d-flex flex-column">\r\n        <div class="farris-form form-inline  farris-form-inline mr-5">\r\n          <div class="col-12 farris-group-auto my-4">\r\n            <div class="farris-group-wrap">\r\n              <div class="form-group farris-form-group">\r\n                <label class="col-form-label">\r\n                  <span class="farris-label-info text-danger">*</span>\r\n                  <span class="farris-label-text" *ngIf="userType === \'user\'">{{\'component.userPerformer.user\'|wfLocale}}</span>\r\n                  <span class="farris-label-text" *ngIf="userType === \'variable\'">{{\'component.userPerformer.variable\'|wfLocale}}</span>\r\n                </label>\r\n                <div class="farris-input-wrap">\r\n                  <div #inputGroup class="input-group">\r\n                    <input type="text" class="form-control" [value]="users | usersName " name="users" [readOnly]="true" />\r\n                    <div *ngIf="multiSelect" class="input-group-append">\r\n                      <span [style.display]="showClearButton ? \'\' : \'none\'" class="input-group-text input-group-clear"\r\n                        (click)="clear($event)">\r\n                        <i class="f-icon modal_close"></i>\r\n                      </span>\r\n                      <span class="input-group-text" (click)="selectUsers($event)" style="background: #FFF;">\r\n                        <i class="f-icon f-icon-lookup"></i>\r\n                      </span>\r\n                    </div>\r\n                  </div>\r\n                  <div class="farris-feedback valid-feedback"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div class="d-flex flex-column">\r\n        <div class="farris-form form-inline farris-form-inline mr-5">\r\n          <div class="col-12 farris-group-auto my-4">\r\n            <div class="farris-group-wrap">\r\n              <div class="form-group farris-form-group">\r\n                <label class="col-form-label">\r\n                  <span class="farris-label-text">{{\'component.userPerformer.condition\'|wfLocale}}</span>\r\n                </label>\r\n                <div class="farris-input-wrap">\r\n                  <div class="input-group">\r\n                    <input type="text" class="form-control" [(ngModel)]="condition" name="conditon" [readOnly]="true" />\r\n                    <div class="input-group-append">\r\n                      <span class="input-group-text" (click)="editConditon()" style="background: #FFF;">\r\n                        <i class="f-icon f-icon-lookup"></i>\r\n                      </span>\r\n                    </div>\r\n                  </div>\r\n                  <div class="farris-feedback valid-feedback"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </form>\r\n</div>\r\n</div>\r\n\r\n<farris-personnel-selector #userHelp style="display: none" [readonly]="false" [width]="\'100%\'"\r\n  [multiSelect]="multiSelect" [includeJobLeavers]="false" [includeCurrentUser]="true" [unSelectedUserIds]="users | usersId "\r\n  [enableChildHierarchy]="true" [showTabIds]="farrisUserHelpShowTabIds" [activeTabId]="activeTabId"\r\n  [userIds]="selectedUserIds" [personnelOrderField]="\'orderby_ordernum\'" [userTypeMode]="\'WfMode\'"\r\n  [includeStopUser]="false" (selectionsChange)="usersSelect($event)">\r\n</farris-personnel-selector>\r\n',providers:[x],styles:[""]}]}],Bn.ctorParameters=function(){return[{type:a},{type:D.ExpressionService},{type:b.Injector},{type:Rn},{type:b.NgZone},{type:b.ChangeDetectorRef,decorators:[{type:b.Optional}]},{type:String,decorators:[{type:b.Inject,args:[b.LOCALE_ID]}]},{type:undefined,decorators:[{type:b.Inject,args:[o]}]},{type:x,decorators:[{type:b.Optional}]},{type:t.HttpService},{type:r.MessagerService}]},Bn.propDecorators={cls:[{type:b.HostBinding,args:["class"]}],userHelp:[{type:b.ViewChild,args:[Ue.PersonnelSelectorComponent]}],inputGroup:[{type:b.ViewChild,args:["inputGroup"]}]};var zn=Bn;function Bn(e,t,r,i,n,o,a,s,l,c,p){this.designerUIState=e,this.expr=t,this.injector=r,this.lookupConfig=i,this.ngZone=n,this.cdr=o,this.localeId=a,this.resources=s,this.localePipe=l,this.http=c,this.message=p,this.cls="d-flex flex-fill h-100",this.showClearButton=!1,this.bindingData={},this.farrisUserHelpShowTabIds="recent,organization",this.activeTabId="organization",this.selectedUserIds="",this.userTypeCollection=[{text:this.localePipe.transform("component.userPerformer.regularUser"),value:"user"},{text:this.localePipe.transform("component.userPerformer.variablePart"),value:"variable"}],this.userType=this.userTypeCollection[0].value,this.variableOrgTypes=[{name:this.localePipe.transform("component.userPerformer.sys"),value:"Sys"},{name:this.localePipe.transform("component.userPerformer.administrative_organization"),value:"Administrative_organization"}],this.curOrgType=this.variableOrgTypes[0].value,this.hasAdminOrg=!1,this.userTypeButtonNeedShow=!1,this.multiSelect=!0,this.users=[],this.localePipe=this.localePipe||new x(a,s)}jn.prototype.getLookUpData=function(e,t,r,i,n){e="/api/runtime/wf/v1.0/dtProcDefs/getHelpData?helpId="+e+"&pageIndex="+r+"&pageSize="+i;return n&&(e+="&searchValue="+JSON.stringify(n)),this.http.get(e)},jn.prototype.getHelpMetaData=function(e,t){return this.http.get("/api/runtime/lcm/v1.0/rt-metadatas/"+e)},jn.decorators=[{type:b.Injectable}],jn.ctorParameters=function(){return[{type:t.HttpService}]};var Un=jn;function jn(e){this.http=e}var Hn=function(){this.id=l.GenerateElementId()},_n=(Object.defineProperty(Gn.prototype,"component",{get:function(){return this.componentPerformer},set:function(t){var i=this;t&&t.methodCode?this.service.getHelpMetaData(t.metadataId,"").subscribe(function(e){var r=JSON.parse(e.content).operations.find(function(e){return e.code===t.methodCode});if(!r)throw new Error(i.localePipe.transform("component.componentPerformer.methodNotExist"));t.actualParameters=t.actualParameters.map(function(t){var e=r.parameters.find(function(e){return e.code===t.code});if(e)return{code:t.code,name:e.name,value:t.value,valueText:t.valueText||t.value,description:e.description,tag:t.tag,fetchValueMode:e.fetchValueMode,fetchValueSetting:e.fetchValueSetting};throw new Error(i.localePipe.transform("component.componentPerformer.componentMethod"))}),i.componentPerformer=t}):this.componentPerformer=new Hn},enumerable:!0,configurable:!0}),Gn.prototype.ngOnInit=function(){},Gn.prototype.ngAfterViewInit=function(){var e=this;this.ngZone.runOutsideAngular(function(){e.inputGroup.nativeElement.addEventListener("mouseenter",e.onMouseEnter.bind(e)),e.inputGroup.nativeElement.addEventListener("mouseleave",e.onMouseLeave.bind(e))})},Gn.prototype.onMouseEnter=function(e){this.showClearButton=!0,this.showClearButton&&this.toggleClearIcon(e,!0)},Gn.prototype.onMouseLeave=function(e){this.showClearButton=!1,this.toggleClearIcon(e,!1)},Gn.prototype.toggleClearIcon=function(e,t){t=(t=void 0===t?!1:t)?"":"none",e=e.target.querySelector(".input-group-clear");e&&(e.style.display=t)},Gn.prototype.selectChanged=function(e){this.curParameter=e.data},Gn.prototype.endEdit=function(e){e.rowData.fetchValueMode!==L.ParameterFetchValueMode["const"]&&e.rowData.fetchValueMode!==L.ParameterFetchValueMode["enum"]||(this.component.actualParameters[e.rowIndex].value=this.component.actualParameters[e.rowIndex].valueText)},Gn.prototype.clear=function(){this.componentPerformer.name="",this.componentPerformer.metadataId="",this.componentPerformer.methodCode="",this.componentPerformer.methodName="",this.componentPerformer.condition="",this.componentPerformer.actualParameters=new Array},Gn.prototype.selectComponent=function(){var i=this,e=this.resolver.resolveComponentFactory(Fe.SelectMetadataRTComponent).create(this.injector),t=(e.instance.typeList="WebServiceComponent",e.instance.selectedMetadata.subscribe(function(e){try{var t=e.metadata;i.openComponentSelectorNew(t.id,i.sessionSrc.getUserSessionId())}catch(r){throw console.log("$event",e),new Error(i.localePipe.transform("component.componentPerformer.errorObtaining")+e)}}),{title:this.localePipe.transform("component.componentPerformer.componentSelection"),width:980,height:548,showButtons:!1}),r=this.modalService.show(e,t);e.instance.closeModalEmitter.subscribe(function(e){return r.close()})},Gn.prototype.openComponentSelectorNew=function(e,t){var r=this;this.componentService.openSelector(e,t).subscribe(function(e){e.confirmEvent.subscribe(function(e){e&&(r.component.name=e.name,r.component.metadataId=e.id,r.component.methodCode=e.operations[0].code,r.component.methodName=e.operations[0].name,r.component.actualParameters=[],e.operations[0].parameters)&&0<e.operations[0].parameters.length&&(r.component.actualParameters=e.operations[0].parameters.map(function(e){return{code:e.code,name:e.name,value:"",valueText:"",description:e.description,fetchValueMode:e.fetchValueMode,fetchValueSetting:e.fetchValueSetting}}))})})},Gn.prototype.showExprHelp=function(s){var e,t,r,i,n,o,l=this;if(0<this.designerState.schemas.length){try{for(var a=ue(this.designerState.schemas),c=a.next();!c.done;c=a.next()){var p=c.value;this.expr.addSchema("Schema",p)}}catch(g){e={error:g}}finally{try{c&&!c.done&&(o=a["return"])&&o.call(a)}finally{if(e)throw e.error}}this.designerState.schemas[0].entityTypes&&0<this.designerState.schemas[0].entityTypes.length&&(o=this.designerState.schemas[0].entityTypes[0],this.expr.addInjectedEntity(o.name,"Schema",o.name,D.InjectedType.EntityType))}var d=new Array,d=this.designerState.addContext(d);if(0<this.designerState.subActivityContext.length)try{for(var u=ue(this.designerState.subActivityContext),m=u.next();!m.done;m=u.next())!function(t){d.some(function(e){return e.key===t.key})||d.push(t)}(m.value)}catch(v){t={error:v}}finally{try{m&&!m.done&&(r=u["return"])&&r.call(u)}finally{if(t)throw t.error}}if(0<d.length)try{for(var f=ue(d),h=f.next();!h.done;h=f.next()){var y=h.value;this.expr.addContext(y)}}catch(b){i={error:b}}finally{try{h&&!h.done&&(n=f["return"])&&n.call(f)}finally{if(i)throw i.error}}this.expr.setEditPattern(D.ExprEditMode.Advanced),this.expr.addExpressionText(s.instance.value),this.expr.buildExpression().then(function(e){var t,r;if(e){s.formControl.setValue(e),s.instance.cd.detectChanges(),s.rowData.value=e;try{for(var i=ue(l.component.actualParameters),n=i.next();!n.done;n=i.next()){var o=n.value;o.code===s.rowId&&(o.value=e)}}catch(a){t={error:a}}finally{try{n&&!n.done&&(r=i["return"])&&r.call(i)}finally{if(t)throw t.error}}}0<d.length&&(l.expr.exprEntity.contextEntities=l.expr.exprEntity.contextEntities.filter(function(t){return!d.some(function(e){return e.key===t.key})}))})},Gn.prototype.getPerformers=function(){return this.grid.endCellEdit(),console.log(this.component),this.component},Gn.prototype.getHelpInfo=function(){var t=this;this.service.getHelpMetaData(this.helpInfo.helpId,this.helpInfo.su).subscribe(function(e){if(!e)throw new Error(t.localePipe.transform("component.componentPerformer.metadataNotExist"));e=JSON.parse(e.content);t.helpInfo.columns=e.dataSource.columns,t.helpInfo.displayType=e.displayType,t.helpInfo.fieldInfo={idField:e.idField,valueField:e.valueField,textField:e.textField}}),this.lookup.showDialog()},Gn.prototype.pagerChanged=function(e){var t=this;e&&(this.helpInfo.pageInfo.pageIndex=e.pageIndex,this.helpInfo.pageInfo.pageSize=e.pageSize,this.service.getLookUpData(this.helpInfo.helpId,this.helpInfo.su,this.helpInfo.pageInfo.pageIndex,this.helpInfo.pageInfo.pageSize,this.helpInfo.search).subscribe(function(e){t.helpInfo.items=e.items,t.helpInfo.title=e.title,t.helpInfo.total=e.total,t.lookup.loadData(e)}))},Gn.prototype.search=function(e){var t=this;console.log(e),this.helpInfo.search={category:"search"},e&&(e={searchField:e.field||e.search.field,searchValue:e.value||e.search.value},this.helpInfo.search=Object.assign(this.helpInfo.search,e),this.service.getLookUpData(this.helpInfo.helpId,this.helpInfo.su,this.helpInfo.pageInfo.pageIndex,this.helpInfo.pageInfo.pageSize,this.helpInfo.search).subscribe(function(e){t.helpInfo.items=e.items,t.helpInfo.title=e.title,t.helpInfo.total=e.total,t.lookup.loadData(e)}))},Gn.decorators=[{type:b.Component,args:[{selector:"app-component-performer",template:'\r\n    <div class="f-utils-fill-flex-column farris-overflow-y-auto h-100">\r\n      <div class="f-utils-fill-flex-column h-100 mx-3" style="border-radius:16px;border: 1.5px solid #F1F3F7;">\r\n      <form class="farris-form farris-card-content-bg farris-card-section mx-2">\r\n        <div class="d-flex flex-wrap flex-column mb-2 pr-4">\r\n          <div class="farris-form-controls-inline farris-form-auto mb-2">\r\n            <div class="farris-group-wrap mx-3">\r\n              <div class="form-group">\r\n                <label class="col-form-label">\r\n                  <span class="farris-label-info text-danger">*</span>\r\n                  <span class="farris-label-text">{{\'component.componentPerformer.componentName\'|wfLocale}}</span>\r\n                </label>\r\n                <div class="farris-input-wrap ml-2">\r\n                  <input type="text" class="k-textbox form-control" name="name"\r\n                    [(ngModel)]="component.name" />\r\n                  <div class="farris-feedback valid-feedback"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class="farris-form-controls-inline farris-form-auto">\r\n            <div class="farris-group-wrap mx-3">\r\n              <div class="form-group">\r\n                <label class="col-form-label">\r\n                  <span class="farris-label-info text-danger">*</span>\r\n                  <span class="farris-label-text">{{\'component.componentPerformer.componentSelect\'|wfLocale}}</span>\r\n                </label>\r\n                <div class="farris-input-wrap ml-2">\r\n                  <div #inputGroup class="input-group">\r\n                    <input type="text" class="form-control" [(ngModel)]="component.methodCode" name="methodCode" [readOnly]="true" />\r\n                    <div class="input-group-append">\r\n                      <span [style.display]="showClearButton ? \'\' : \'none\'" class="input-group-text input-group-clear" (click)="clear()">\r\n                        <i class="f-icon modal_close"></i>\r\n                      </span>\r\n                      <span class="input-group-text" (click)="selectComponent()" style="background: #FFF;">\r\n                        <i class="f-icon f-icon-lookup"></i>\r\n                      </span>\r\n                    </div>\r\n                  </div>\r\n                  <div class="farris-feedback valid-feedback"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </form>\r\n      <farris-tabs class="f-utils-fill mx-3" #params [value]="\'params\'" [contentFill]="true">\r\n        <farris-tab title="{{\'component.componentPerformer.parameterList\' | wfLocale}}" [id]="\'params\'">\r\n          <ng-template #content>\r\n            <div class="f-utils-fill-flex-column h-100">\r\n              <farris-datagrid #grid [data]="component.actualParameters" [columns]="columns" [idField]="\'code\'" [fit]="true"\r\n                [fitColumns]="true" [editable]="true" [editMode]="\'cell\'" [pagination]="false" [showCheckbox]="false"\r\n                [multiSelect]="false" [afterEdit]="afterEdit" [beforeEdit]="beforeEdit"\r\n                (selectChanged)="selectChanged($event)" (endEdit)="endEdit($event)"></farris-datagrid>\r\n            </div>\r\n          </ng-template>\r\n        </farris-tab>\r\n      </farris-tabs>\r\n    </div>\r\n    </div>\r\n\r\n\x3c!-- <farris-lookup-grid style="display: none;" [items]="helpInfo.items" [columns]="helpInfo.columns" [resizable]="true"\r\n  [singleSelect]="true" [idField]="helpInfo.fieldInfo.idField" [textField]="helpInfo.fieldInfo.textField"\r\n  [valueField]="helpInfo.fieldInfo.valueField" [pagination]="true" [pageIndex]="helpInfo.pageInfo.pageIndex"\r\n  [pageSize]="helpInfo.pageInfo.pageSize" [pageList]="helpInfo.pageInfo.pageList" [total]="helpInfo.total"\r\n  title="helpInfo.title" [displayType]="helpInfo.displayType" [dictPicked]="dictPicked" [remoteSearch]=\'false\'\r\n  (pagerChanged)="pagerChanged($event)" (search)="search($event)">\r\n</farris-lookup-grid> --\x3e\r\n\x3c!-- 2023-6-28 DD需求，直接用帮助id打开而不是自己组织数据源，以实现分层加载 --\x3e\r\n<farris-lookup-grid\r\nstyle="display: none;"\r\n[uri]="\'testLookupUri\'"\r\n[displayType]="\'List\'"\r\n[idField]="\'id\'"\r\n[pagination]="true"\r\n[editable]="false"\r\n[singleSelect]="true"\r\n[textField]="\'name\'"\r\n[helpId]="helpId"\r\n[dictPicking]="onDictPicking"\r\n[dictPicked]="dictPicked"\r\n>\r\n</farris-lookup-grid>\r\n',providers:[Un,x],styles:[""]}]}],Gn.ctorParameters=function(){return[{type:a},{type:D.ExpressionService},{type:b.ComponentFactoryResolver},{type:b.Injector},{type:t.SessionService},{type:i.BsModalService},{type:U.CommonComponentUiRTService},{type:b.NgZone},{type:Un},{type:l},{type:t.HttpService},{type:b.ChangeDetectorRef,decorators:[{type:b.Optional}]},{type:String,decorators:[{type:b.Inject,args:[b.LOCALE_ID]}]},{type:undefined,decorators:[{type:b.Inject,args:[o]}]},{type:x,decorators:[{type:b.Optional}]}]},Gn.propDecorators={cls:[{type:b.HostBinding,args:["class"]}],grid:[{type:b.ViewChild,args:[ve.DatagridComponent]}],lookup:[{type:b.ViewChild,args:[Ee.LookupGridComponent]}],inputGroup:[{type:b.ViewChild,args:["inputGroup"]}],component:[{type:b.Input}]},Gn);function Gn(e,t,r,i,n,o,a,s,l,c,p,d,u,m,f){var h=this;this.designerState=e,this.expr=t,this.resolver=r,this.injector=i,this.sessionSrc=n,this.modalService=o,this.componentService=a,this.ngZone=s,this.service=l,this.util=c,this.http=p,this.cdr=d,this.localeId=u,this.resources=m,this.localePipe=f,this.cls="farris-main-area flex-column",this.showClearButton=!1,this.helpId="",this.lookupDisplayText="",this.columns=[{field:"code",width:60,title:this.localePipe.transform("component.componentPerformer.code")},{field:"name",width:60,title:this.localePipe.transform("component.componentPerformer.name")},{field:"description",width:60,title:this.localePipe.transform("component.componentPerformer.description"),showTips:!0},{field:"valueText",width:100,title:this.localePipe.transform("component.componentPerformer.valueText"),editor:{type:"input-group",options:{groupText:'<i class="f-icon f-icon-lookup"></i>',editable:!1,clickHandle:function(e){e.formControl.setValue(e.instance.value||""),h.showExprHelp(e)},clear:function(e){var t,r;e.rowData.value="";try{for(var i=ue(h.component.actualParameters),n=i.next();!n.done;n=i.next()){var o=n.value;o.code===e.rowId&&(o.value="")}}catch(a){t={error:a}}finally{try{n&&!n.done&&(r=i["return"])&&r.call(i)}finally{if(t)throw t.error}}}}}}],this.helpInfo={helpId:"",su:"",columns:[],displayType:"List",items:[],pageInfo:{pageIndex:1,pageList:[10,20,30,50],pageSize:20},search:{category:"all"},title:this.localePipe.transform("component.componentPerformer.help"),total:100,fieldInfo:{idField:"id",textField:"name",valueField:"id"}},this.beforeEdit=function(e){var t=e.rowData;switch((h.curParameter=t).fetchValueMode){case L.ParameterFetchValueMode.express:e.column.editor={type:"input-group",options:{groupText:'<i class="f-icon f-icon-lookup"></i>',editable:!1,clickHandle:function(e){e.formControl.setValue(e.instance.value||""),h.showExprHelp(e)},clear:function(e){var t,r;e.rowData.value="";try{for(var i=ue(h.component.actualParameters),n=i.next();!n.done;n=i.next()){var o=n.value;o.code===e.rowId&&(o.value="")}}catch(a){t={error:a}}finally{try{n&&!n.done&&(r=i["return"])&&r.call(i)}finally{if(t)throw t.error}}}}};break;case L.ParameterFetchValueMode.none:e.column.editor={type:"input-group",options:{groupText:'<i class="f-icon f-icon-lookup"></i>',editable:!1,clickHandle:function(e){e.formControl.setValue(e.instance.value||""),h.showExprHelp(e)},clear:function(e){var t,r;e.rowData.value="";try{for(var i=ue(h.component.actualParameters),n=i.next();!n.done;n=i.next()){var o=n.value;o.code===e.rowId&&(o.value="")}}catch(a){t={error:a}}finally{try{n&&!n.done&&(r=i["return"])&&r.call(i)}finally{if(t)throw t.error}}}}};break;case L.ParameterFetchValueMode["const"]:case L.ParameterFetchValueMode["enum"]:e.column.editor={type:g.EditorTypes.TEXTBOX,options:{}};break;case L.ParameterFetchValueMode.help:e.column.editor={type:"input-group",options:{groupText:'<i class="f-icon f-icon-lookup"></i>',editable:!1,clickHandle:function(e){h.cell=e,h.helpInfo.helpId=t.fetchValueSetting.helpId,h.helpInfo.su=t.fetchValueSetting.serviceUnit,h.helpInfo.pageInfo={pageIndex:1,pageList:[10,20,30,50],pageSize:20},h.helpInfo.search={category:"all"},h.getHelpInfo()},clear:function(e){var t,r;e.rowData.value="";try{for(var i=ue(h.component.actualParameters),n=i.next();!n.done;n=i.next()){var o=n.value;o.code===e.rowId&&(o.value="")}}catch(a){t={error:a}}finally{try{n&&!n.done&&(r=i["return"])&&r.call(i)}finally{if(t)throw t.error}}}}}}return v.of(!0)},this.afterEdit=function(e,t,r){return v.of(!0)},this.onDictPicking=function(e){return e.instance.http={getData:function(e,t){var r="/api/runtime/bcc/v1.0/help/data/"+h.helpInfo.helpId;return t=Object.assign(t||{},{withSpecificField:!0}),h.http.put(r,t).pipe(re.catchError(function(e){return e.error&&e.error.innerMessage&&-1<e.error.innerMessage.indexOf("Could not find metadata")&&(e.error.Message=h.localePipe.transform("component.componentPerformer.serverSideNotFound")),v.throwError(e)}))}},v.of(!0)},this.dictPicked=function(e){var t,r;if(h.cell){h.cell.formControl.setValue(h.util.getValue(e,h.helpInfo.fieldInfo.textField)),h.cell.instance.cd.detectChanges(),h.cell.rowData.value=h.util.getValue(e,h.helpInfo.fieldInfo.valueField);try{for(var i=ue(h.component.actualParameters),n=i.next();!n.done;n=i.next()){var o=n.value;o.code===h.cell.rowId&&(o.value=h.util.getValue(e,h.helpInfo.fieldInfo.valueField))}}catch(a){t={error:a}}finally{try{n&&!n.done&&(r=i["return"])&&r.call(i)}finally{if(t)throw t.error}}return v.of(!0)}},this.localePipe=this.localePipe||new x(u,m)}n(Wn,Kn=$r);var Kn,qn=Wn;function Wn(e,t,r){return Kn.call(this,e,t,r)||this}$n.prototype.getData=function(e,t){var r,i,n=t.customData,o=t.pageIndex||1,a=t.pageSize||20,t=JSON.parse(t.searchValue);if(t.searchValue||n.filter){var s="{";if(t.searchValue&&("*"===t.searchField?s+='"codeOrNameLike":"'+t.searchValue+'",':s+='"'+t.searchField+'":"'+t.searchValue+'",'),n.filter){t=Object.keys(n.filter);if(t&&0<t.length)try{for(var l=ue(t),c=l.next();!c.done;c=l.next()){var p=c.value;n.filter[p]&&(s+='"'+p+'":"'+n.filter[p]+'",')}}catch(d){r={error:d}}finally{try{c&&!c.done&&(i=l["return"])&&i.call(l)}finally{if(r)throw r.error}}}","===s.substr(s.length-1,1)&&(s=s.substring(0,s.length-1)),s+="}",s=encodeURIComponent(s),e+="?pageFilter="+(s+="&pageIndex="+o+"&pageSize="+a)}else e+="?pageIndex="+o+"&pageSize="+a;return this.http.get(e).pipe(re.map(function(e){return{items:e.content,total:e.totalElements,pageInfo:{pageIndex:e.pageable.pageNumber+1,pageSize:e.pageable.pageSize,pageList:[20,40,60,80,100],enablePager:!0}}}))},$n.decorators=[{type:b.Injectable}],$n.ctorParameters=function(){return[{type:t.HttpService}]};var Jn=$n;function $n(e){this.http=e}Xn.prototype.ngOnInit=function(){this.columns=[{title:this.localePipe.transform("component.reportingLine.code"),field:"code",width:"80",searchField:"code"},{title:this.localePipe.transform("component.reportingLine.name"),field:"name",width:"100",searchField:"name"}],this.dataUri="/api/runtime/wf/v1.0/reportingLineDefinitions/query",this.lookUp.mapFields={id:"id",name:"name"}},Xn.prototype.afterClear=function(e){this.clear.next(e)},Xn.prototype.showHelp=function(){this.lookUp.showDialog()},Xn.decorators=[{type:b.Component,args:[{selector:"app-wf-report-def-help",template:'\n    <farris-lookup-grid #lookup\n      [disabled]="disabled"\n      [editable]="false"\n      [bindingData]="bindingData"\n      [(ngModel)]="displayTxt"\n      [columns]="columns"\n      [singleSelect]="singleSelect"\n      title="title"\n      [displayType]="\'List\'"\n      [uri]="dataUri"\n      [idField]="\'id\'"\n      [pageIndex]="pageIndex"\n      [pageSize]="pageSize"\n      [pagination]="pagination"\n      [valueField]="\'id\'"\n      [textField]="\'name\'"\n      (clear)="afterClear($event)"\n      [dialogWidth]="width"\n      [dictPicking]="beforeOpen"\n      [dictPicked]="dictPicked">\n    </farris-lookup-grid>\n  ',providers:[{provide:Ee.ServerSideToken,useClass:Jn}]}]}],Xn.ctorParameters=function(){return[{type:x}]},Xn.propDecorators={title:[{type:b.Input}],width:[{type:b.Input}],sourceType:[{type:b.Input}],disabled:[{type:b.Input}],singleSelect:[{type:b.Input}],pagination:[{type:b.Input}],pageIndex:[{type:b.Input}],pageSize:[{type:b.Input}],displayTxt:[{type:b.Input}],bindingData:[{type:b.Input}],filter:[{type:b.Input}],afterConfirm:[{type:b.Output}],dialogClosed:[{type:b.Output}],clear:[{type:b.Output}],lookUp:[{type:b.ViewChild,args:["lookup"]}]};var Yn=Xn;function Xn(e){var t=this;this.localePipe=e,this.width=550,this.disabled=!1,this.singleSelect=!0,this.pagination=!0,this.pageIndex=1,this.pageSize=20,this.filter={},this.afterConfirm=new b.EventEmitter,this.dialogClosed=new b.EventEmitter,this.clear=new b.EventEmitter,this.columns=[],this.beforeOpen=function(e){return v.of({showDialog:!0,data:{filter:t.filter}})},this.dictPicked=function(e){return t.afterConfirm.next(e),v.of({closeDialog:!0})}}Object.defineProperty(u.prototype,"setReportingLineDataEntity",{set:function(e){var l=this,t=(this.defName=e.reportingLineDefName,"/api/runtime/wf/v1.0/reportingLineDefinitions/"+(this.reportingLineDataEntity=e).reportingLineDefId);this.http.get(t).subscribe(function(e){var t,r;l.reportingLineDefinition=e,l.designerUIState.dimensions=[{value:"higherSuperior",text:l.localePipe.transform("component.reportingLine.higherSuperior")}],"directSuperior"!==JSON.parse(l.reportingLineDefinition.dimensions)[0].code&&(a={value:"directSuperior",text:l.localePipe.transform("component.reportingLine.directSuperior")},l.designerUIState.dimensions.push(a));try{for(var i=ue(JSON.parse(l.reportingLineDefinition.dimensions)),n=i.next();!n.done;n=i.next()){var o=n.value,a={value:o.code,text:o.name};l.designerUIState.dimensions.push(a)}}catch(s){t={error:s}}finally{try{n&&!n.done&&(r=i["return"])&&r.call(i)}finally{if(t)throw t.error}}}),this.users=[e],e.refUserId?(this.users[0].performerName=this.variableParticipantName(e.refUserId),this.curReportingRefer=this.reportingReferObjects[1].value,this.display="block"):e.refEmployeeId?(this.users[0].performerName=e.refEmployeeId,this.curReportingRefer=this.reportingReferObjects[2].value,this.display="block"):this.curReportingRefer=this.reportingReferObjects[0].value,e.reportingLineDefId&&(this.typeReadOnly=!0)},enumerable:!0,configurable:!0}),u.prototype.ngOnInit=function(){},u.prototype.getReportingLineType=function(){var t=this;this.http.get("/api/runtime/wf/v1.0/reportingLineDefinitions").subscribe(function(e){t.reportingLineDefinitionList=e,t.items=t.reportingLineDefinitionList.slice(0,t.pageSize),t.total=t.reportingLineDefinitionList.length})},u.prototype.onclear=function(){this.reportingLineDataEntity=new qn},u.prototype.referObjectChange=function(e){"dept"===e?(this.display="none",this.curReportingRefer=this.reportingReferObjects[0].value,this.reportingLineDataEntity.refUserId=null,this.reportingLineDataEntity.refEmployeeId=null):"sysUser"===e?(this.display="block",this.curReportingRefer=this.reportingReferObjects[1].value,this.reportingLineDataEntity.refOrgId=null,this.reportingLineDataEntity.refOrgName=null,this.reportingLineDataEntity.refEmployeeId=null):(this.display="block",this.curReportingRefer=this.reportingReferObjects[2].value,this.reportingLineDataEntity.refOrgId=null,this.reportingLineDataEntity.refOrgName=null,this.reportingLineDataEntity.refUserId=null),this.users=[],this.departments=[]},u.prototype.referUserChange=function(e){console.log(e)},u.prototype.reportingDimensionChange=function(e){},u.prototype.orgSelected=function(e){this.reportingLineDataEntity.refOrgId=e.id,this.reportingLineDataEntity.refOrgName=e.name},u.prototype.editCondition=function(){var e,t,r,i,n,o,a,s,l=this;if(0<this.designerUIState.schemas.length){try{for(var c=ue(this.designerUIState.schemas),p=c.next();!p.done;p=c.next()){var d=p.value;this.expr.addSchema("Schema",d)}}catch(x){e={error:x}}finally{try{p&&!p.done&&(s=c["return"])&&s.call(c)}finally{if(e)throw e.error}}this.designerUIState.schemas[0].entityTypes&&0<this.designerUIState.schemas[0].entityTypes.length&&(s=this.designerUIState.schemas[0].entityTypes[0],this.expr.addInjectedEntity(s.name,"Schema",s.name,D.InjectedType.EntityType))}var u=new Array,u=this.designerUIState.addContext(u);if(0<this.designerUIState.subActivityContext.length)try{for(var m=ue(this.designerUIState.subActivityContext),f=m.next();!f.done;f=m.next())!function(t){u.some(function(e){return e.key===t.key})||u.push(t)}(f.value)}catch(w){t={error:w}}finally{try{f&&!f.done&&(r=m["return"])&&r.call(m)}finally{if(t)throw t.error}}if(0<this.designerUIState.activityComponentContext.length)try{for(var h=ue(this.designerUIState.activityComponentContext),y=h.next();!y.done;y=h.next())!function(t){u.some(function(e){return e.key===t.key})||u.push(t)}(y.value)}catch(P){i={error:P}}finally{try{y&&!y.done&&(n=h["return"])&&n.call(h)}finally{if(i)throw i.error}}if(0<u.length)try{for(var g=ue(u),v=g.next();!v.done;v=g.next()){var b=v.value;this.expr.addContext(b)}}catch(C){o={error:C}}finally{try{v&&!v.done&&(a=g["return"])&&a.call(g)}finally{if(o)throw o.error}}this.expr.setEditPattern(D.ExprEditMode.Conditional),this.expr.addExpressionText(this.reportingLineDataEntity.condition),this.expr.buildExpression().then(function(e){l.reportingLineDataEntity.condition=e,0<u.length&&(l.expr.exprEntity.contextEntities=l.expr.exprEntity.contextEntities.filter(function(t){return!u.some(function(e){return e.key===t.key})}))})},u.prototype.getReportingTypes=function(t){var e=(this.pageIndex-1)*this.pageSize,r=e+this.pageSize,i=[],i=t?this.reportingLineDefinitionList.filter(function(e){return-1<e.name.indexOf(t)||-1<e.code.indexOf(t)}):this.reportingLineDefinitionList;this.total=i.length,this.items=i.slice(e,r),this.lookup.componentRef.instance.loadData({total:this.total,pageSize:this.pageSize,pageIndex:this.pageIndex,data:this.items})},u.prototype.ngAfterViewInit=function(){var e=this;this.ngZone.runOutsideAngular(function(){e.inputGroup.nativeElement.addEventListener("mouseenter",e.onMouseEnter.bind(e)),e.inputGroup.nativeElement.addEventListener("mouseleave",e.onMouseLeave.bind(e)),e.inputGroup1.nativeElement.addEventListener("mouseenter",e.onMouseEnter.bind(e)),e.inputGroup1.nativeElement.addEventListener("mouseleave",e.onMouseLeave.bind(e))})},u.prototype.onMouseEnter=function(e){this.showClearButton=!0,this.showClearButton&&this.toggleClearIcon(e,!0)},u.prototype.onMouseLeave=function(e){this.showClearButton=!1,this.toggleClearIcon(e,!1)},u.prototype.toggleClearIcon=function(e,t){t=(t=void 0===t?!1:t)?"":"none",e=e.target.querySelector(".input-group-clear");e&&(e.style.display=t)},u.prototype.clear=function(e){this.reportingLineDataEntity.refOrgId="",this.reportingLineDataEntity.refOrgName=""},u.prototype.clearUser=function(){this.users=[],this.reportingLineDataEntity.refUserId="",this.reportingLineDataEntity.refEmployeeId=""},u.prototype.clearOrg=function(){this.departments=[],this.reportingLineDataEntity.refOrgId=""},u.prototype.selectOrg=function(e){this.showExprHelp(e)},u.prototype.selectUsers=function(e){this.showExprHelp(e)},u.prototype.showExprHelp=function(r){var e,t,i,n,o,a,s,l,c,p,d=this;if(this.expr.setEditPattern(D.ExprEditMode.Advanced),0<this.designerUIState.schemas.length){try{for(var u=ue(this.designerUIState.schemas),m=u.next();!m.done;m=u.next()){var f=m.value;this.expr.addSchema("Schema",f)}}catch(E){e={error:E}}finally{try{m&&!m.done&&(p=u["return"])&&p.call(u)}finally{if(e)throw e.error}}this.designerUIState.schemas[0].entityTypes&&0<this.designerUIState.schemas[0].entityTypes.length&&(p=this.designerUIState.schemas[0].entityTypes[0],this.expr.addInjectedEntity(p.name,"Schema",p.name,D.InjectedType.EntityType))}var h=new Array;if(0<this.designerUIState.participantContext.length)try{for(var y=ue(this.designerUIState.participantContext),g=y.next();!g.done;g=y.next()){var v=g.value;h.push(v)}}catch(T){t={error:T}}finally{try{g&&!g.done&&(i=y["return"])&&i.call(y)}finally{if(t)throw t.error}}if(0<this.designerUIState.subActivityContext.length)try{for(var b=ue(this.designerUIState.subActivityContext),x=b.next();!x.done;x=b.next())!function(t){h.some(function(e){return e.key===t.key})||h.push(t)}(v=x.value)}catch(A){n={error:A}}finally{try{x&&!x.done&&(o=b["return"])&&o.call(b)}finally{if(n)throw n.error}}if(0<this.designerUIState.processVariableContext.length)try{for(var w=ue(this.designerUIState.processVariableContext),P=w.next();!P.done;P=w.next())!function(t){h.some(function(e){return e.key===t.key})||h.push(t)}(v=P.value)}catch(k){a={error:k}}finally{try{P&&!P.done&&(s=w["return"])&&s.call(w)}finally{if(a)throw a.error}}if(0<h.length)try{for(var C=ue(h),I=C.next();!I.done;I=C.next()){var S=I.value;this.expr.addContext(S)}}catch(O){l={error:O}}finally{try{I&&!I.done&&(c=C["return"])&&c.call(C)}finally{if(l)throw l.error}}"sysUser"===r?this.reportingLineDataEntity.refUserId&&0<this.reportingLineDataEntity.refUserId.length?this.expr.addExpressionText(this.reportingLineDataEntity.refUserId):this.expr.addExpressionText(""):"org"===r?this.reportingLineDataEntity.refOrgId&&0<this.reportingLineDataEntity.refOrgId.length?this.expr.addExpressionText(this.reportingLineDataEntity.refOrgId):this.expr.addExpressionText(""):this.reportingLineDataEntity.refEmployeeId&&0<this.reportingLineDataEntity.refEmployeeId.length?this.expr.addExpressionText(this.reportingLineDataEntity.refEmployeeId):this.expr.addExpressionText(""),this.expr.buildExpression().then(function(e){var t;"sysUser"===r?((t=new $r(e,"","wf.ReportingLineParticipantExpression")).tag="expression",t.performerName=d.variableParticipantName(e),d.reportingLineDataEntity.refUserId=t.performerId,d.reportingLineDataEntity.tag=t.tag,d.reportingLineDataEntity.performerName=t.performerName,d.users=[d.reportingLineDataEntity]):"org"===r?(new $r(e,"","wf.ReportingLineParticipantExpression").tag="expression",d.reportingLineDataEntity.refOrgName=e,d.reportingLineDataEntity.refOrgId=e,d.departments=[d.reportingLineDataEntity]):((t=new $r(e,"","wf.ReportingLineParticipantExpression")).performerName=e,t.tag="expression",d.reportingLineDataEntity.refEmployeeId=e,d.reportingLineDataEntity.performerName=t.performerName,d.users=[d.reportingLineDataEntity]),0<h.length&&(d.expr.exprEntity.contextEntities=d.expr.exprEntity.contextEntities.filter(function(t){return!h.some(function(e){return e.key===t.key})}))})},u.prototype.variableParticipantName=function(e){var t,r,i,n;try{for(var o=ue(this.designerUIState.participantContext),a=o.next();!a.done;a=o.next()){var s=a.value;if(-1<e.indexOf(s.key))return s.name}}catch(p){t={error:p}}finally{try{a&&!a.done&&(r=o["return"])&&r.call(o)}finally{if(t)throw t.error}}try{for(var l=ue(this.designerUIState.processVariableContext),c=l.next();!c.done;c=l.next()){s=c.value;if(-1<e.indexOf(s.key))return s.name}}catch(d){i={error:d}}finally{try{c&&!c.done&&(n=l["return"])&&n.call(l)}finally{if(i)throw i.error}}return this.localePipe.transform("component.reportingLine.businessFields")},u.prototype.defChanged=function(){var t=this;System["import"]("/platform/runtime/wf/web/wf-reporting-data/reportingLineDefHelp.js?v=20231123").then(function(){window.gspWfReportingLineDef.ReportingLineDefHelpUtil.getReportingLineHelp().then(function(e){t.defSelected(e)})})},u.prototype.defSelected=function(e){var t,r;this.defName=e.name,this.reportingLineDataEntity.reportingLineDefId=e.id,this.reportingLineDataEntity.reportingLineDefName=e.name,this.reportingLineDimension=JSON.parse(e.dimensions),this.designerUIState.dimensions=[{value:"higherSuperior",text:this.localePipe.transform("component.reportingLine.higherSuperior")}],"directSuperior"!==this.reportingLineDimension[0].code&&(a={value:"directSuperior",text:this.localePipe.transform("component.reportingLine.directSuperior")},this.designerUIState.dimensions.push(a));try{for(var i=ue(this.reportingLineDimension),n=i.next();!n.done;n=i.next()){var o=n.value,a={value:o.code,text:o.name};this.designerUIState.dimensions.push(a)}}catch(s){t={error:s}}finally{try{n&&!n.done&&(r=i["return"])&&r.call(i)}finally{if(t)throw t.error}}return this.curReportingRefer=this.reportingReferObjects[0].value,this.display="none",this.reportingLineDataEntity.refUserId=null,this.reportingLineDataEntity.refEmployeeId=null,v.of(!0)},u.prototype.getPerformers=function(){return this.reportingLineDataEntity.type="wf.ReportingLineParticipantExpression",this.reportingLineDataEntity.reportingReferObject=this.curReportingRefer,this.reportingLineDataEntity},u.decorators=[{type:b.Component,args:[{selector:"app-reporting-line",template:'<sys-farris-tree-help class="flex-fill" #orgHelp style="display: none;"\r\n                      [singleSelect]="true" [sourceType]="\'org\'" [disabled]="false" [filter]="treeFilter"\r\n                      [useBeforeCloseEvent]="false" [async]="true"\r\n                      (afterConfirm)="orgSelected($event)">\r\n</sys-farris-tree-help>\r\n\r\n<div class="d-flex flex-fill farris-overflow-y-auto p-md-2" style="background: #FFF;">\r\n  <div class="d-flex flex-fill farris-overflow-y-auto mx-3 my-2" style="border-radius:16px;border: 1.5px solid #F1F3F7;">\r\n  <form style="width: 100%">\r\n    <div class="d-flex m-2 flex-column w-100">\r\n      <div class="d-flex flex-column">\r\n        <div class="farris-form form-inline  farris-form-inline mr-5">\r\n          <div class="col-12 farris-group-auto my-4">\r\n            <div class="farris-group-wrap">\r\n              <div class="form-group farris-form-group">\r\n                <label class="col-form-label">\r\n                  <span class="farris-label-info text-danger">*</span>\r\n                  <span class="farris-label-text">{{\'component.reportingLine.defName\'|wfLocale}}</span>\r\n                </label>\r\n                <div class="farris-input-wrap">\r\n                  <input-group [editable]="false" [customCls]="\'custom-cls\'" [groupText]="groupIcon2"\r\n                               [(value)]="defName"\r\n                               (clickHandle)="defChanged()" [enableClear]="false"\r\n                  ></input-group>\r\n                  <div class="farris-feedback valid-feedback"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class="col-12 farris-group-auto my-4">\r\n            <div class="farris-group-wrap">\r\n              <div class="form-group farris-form-group">\r\n                <label class="col-form-label">\r\n                  <span class="farris-label-info text-danger">*</span>\r\n                  <span class="farris-label-text">{{\'component.reportingLine.dimension\'|wfLocale}}</span>\r\n                </label>\r\n                <div class="farris-input-wrap">\r\n                  <farris-combo-list [(ngModel)]="reportingLineDataEntity.dimension" name="dimension" [panelHeight]="200"\r\n                                     [idField]="\'value\'" [textField]="\'text\'" [data]="this.designerUIState.dimensions" (valueChange)="reportingDimensionChange($event)"\r\n                                     ></farris-combo-list>\r\n                  <div class="farris-feedback valid-feedback"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class="col-12 farris-group-auto my-4">\r\n            <div class="farris-group-wrap">\r\n              <div class="form-group farris-form-group">\r\n                <label class="col-form-label">\r\n                  <span class="farris-label-info text-danger">*</span>\r\n                  <span class="farris-label-text">{{\'component.reportingLine.curReportingRefer\'|wfLocale}}</span>\r\n                </label>\r\n                <div class="farris-input-wrap">\r\n                  <farris-radiogroup [data]="reportingReferObjects" [horizontal]="true"\r\n                                     [(ngModel)]="curReportingRefer" name="referObject"\r\n                                     (changeValue)="referObjectChange($event)"\r\n                  ></farris-radiogroup>\r\n                  <div class="farris-feedback valid-feedback"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class="col-12 farris-group-auto my-4" [ngStyle]="{\'display\':display}">\r\n            <div class="farris-group-wrap">\r\n              <div class="form-group farris-form-group">\r\n                <label class="col-form-label">\r\n                  <span class="farris-label-info text-danger">*</span>\r\n                  <span class="farris-label-text">{{\'component.reportingLine.usersName\'|wfLocale}}</span>\r\n                </label>\r\n                <div class="farris-input-wrap">\r\n                  <div #inputGroup1 class="input-group">\r\n                    <input type="text" class="form-control" [value]="users | usersName " [(ngModel)]="reportingLineDataEntity.performerName" name="users" [readOnly]="true" />\r\n                    <div class="input-group-append">\r\n                      <span [style.display]="showClearButton ? \'\' : \'none\'" class="input-group-text input-group-clear"\r\n                            (click)="clearUser()">\r\n                        <i class="f-icon modal_close"></i>\r\n                      </span>\r\n                      <span *ngIf="curReportingRefer === \'sysUser\'" class="input-group-text" (click)="selectUsers(\'sysUser\')" style="background: #FFF;">\r\n                        <i class="f-icon f-icon-lookup"></i>\r\n                      </span>\r\n                      <span *ngIf="curReportingRefer === \'employee\'" class="input-group-text" (click)="selectUsers(\'employee\')" style="background: #FFF;">\r\n                        <i class="f-icon f-icon-lookup"></i>\r\n                      </span>\r\n                    </div>\r\n                  </div>\r\n                  <div class="farris-feedback valid-feedback"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class="col-12 farris-group-auto my-4">\r\n            <div class="farris-group-wrap">\r\n              <div class="form-group farris-form-group">\r\n                <label class="col-form-label">\r\n                  <span class="farris-label-info text-danger" [ngStyle]="{\'display\':display === \'none\' ? \'block\':\'none\'}">*</span>\r\n                  <span class="farris-label-text">{{\'component.reportingLine.refOrgId\'|wfLocale}}</span>\r\n                </label>\r\n                <div class="farris-input-wrap">\r\n                  <div #inputGroup class="input-group">\r\n                    <input type="text" class="form-control" [(ngModel)]="reportingLineDataEntity.refOrgId" name="dept" [readOnly]="true" />\r\n                    <div class="input-group-append">\r\n                      <span [style.display]="showClearButton ? \'\' : \'none\'" class="input-group-text input-group-clear"\r\n                            (click)="clearOrg()">\r\n                        <i class="f-icon modal_close"></i>\r\n                      </span>\r\n                      <span class="input-group-text" (click)="selectOrg(\'org\')" style="background: #FFF;">\r\n                        <i class="f-icon f-icon-lookup"></i>\r\n                      </span>\r\n                    </div>\r\n                  </div>\r\n                  <div class="farris-feedback valid-feedback"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div class="d-flex flex-column">\r\n        <div class="farris-form form-inline farris-form-inline mr-5">\r\n          <div class="col-12 farris-group-auto my-4">\r\n            <div class="farris-group-wrap">\r\n              <div class="form-group farris-form-group">\r\n                <label class="col-form-label">\r\n                  <span class="farris-label-text">{{\'component.reportingLine.condition\'|wfLocale}}</span>\r\n                </label>\r\n                <div class="farris-input-wrap">\r\n                  <div class="input-group">\r\n                    <input type="text" class="form-control" [(ngModel)]="reportingLineDataEntity.condition" name="conditon" [readOnly]="true" />\r\n                    <div class="input-group-append">\r\n                      <span class="input-group-text" (click)="editCondition()" style="background: #FFF;">\r\n                        <i class="f-icon f-icon-lookup"></i>\r\n                      </span>\r\n                    </div>\r\n                  </div>\r\n                  <div class="farris-feedback valid-feedback"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </form>\r\n</div>\r\n</div>\r\n\r\n<app-wf-report-def-help style="display: none;" [singleSelect]="true" title="{{\'component.reportingLine.definitionOfReport\'|wfLocale}}" (afterConfirm)="defSelected($event)">\r\n\r\n</app-wf-report-def-help>\r\n',providers:[x],styles:[""]}]}],u.ctorParameters=function(){return[{type:t.HttpService},{type:a},{type:D.ExpressionService},{type:b.NgZone},{type:b.ChangeDetectorRef,decorators:[{type:b.Optional}]},{type:String,decorators:[{type:b.Inject,args:[b.LOCALE_ID]}]},{type:undefined,decorators:[{type:b.Inject,args:[o]}]},{type:x,decorators:[{type:b.Optional}]}]},u.propDecorators={cls:[{type:b.HostBinding,args:["class"]}],reportingLineDefHelp:[{type:b.ViewChild,args:[Yn]}],setReportingLineDataEntity:[{type:b.Input}],lookup:[{type:b.ViewChild,args:[Ee.LookupGridComponent]}],orgHelp:[{type:b.ViewChild,args:[j.SysFarrisTreeHelpComponent]}],inputGroup:[{type:b.ViewChild,args:["inputGroup"]}],inputGroup1:[{type:b.ViewChild,args:["inputGroup1"]}]};var Zn=u;function u(e,t,r,i,n,o,a,s){this.http=e,this.designerUIState=t,this.expr=r,this.ngZone=i,this.cdr=n,this.localeId=o,this.resources=a,this.localePipe=s,this.cls="d-flex flex-fill h-100",this.treeFilter="",this.display="none",this.typeReadOnly=!1,this.groupIcon2='<i class="f-icon f-icon-lookup"></i>',this.defName="",this.reportingLineDataEntity=new qn,this.reportingLineDefinitionList=[],this.reportingLineDimension=[],this.showClearButton=!1,this.items=[],this.users=[],this.departments=[],this.pageIndex=1,this.pageSize=20,this.pageList=[10,20,30,50,100],this.total=0,this.columns=[{title:this.localePipe.transform("component.reportingLine.code"),field:"code",width:100},{title:this.localePipe.transform("component.reportingLine.name"),field:"name",width:100}],this.reportingReferObjects=[{name:this.localePipe.transform("component.reportingLine.dept"),value:"dept"},{name:this.localePipe.transform("component.reportingLine.sysUser"),value:"sysUser"},{name:this.localePipe.transform("component.reportingLine.employee"),value:"employee"}],this.curReportingRefer=this.reportingReferObjects[0].value,this.localePipe=this.localePipe||new x(o,a),this.getReportingLineType()}var Qn,eo=function(){},to=(n(ro,Qn=$r),ro);function ro(e,t,r){return Qn.call(this,e,t,r)||this}no.prototype.ngOnInit=function(){},no.prototype.load=function(e){this.data=w(e)},no.prototype.onConfirm=function(){var e=this,t=(0===this.selectedIds.length&&this.messageService.warning(this.localePipe.transform("component.matrixPerformer.notSelectEnum")),this.data.filter(function(t){return-1<e.selectedIds.findIndex(function(e){return e===t.key})}));this.confirm.next(t),this.closeModalEmitter.next()},no.prototype.cancel=function(){this.closeModalEmitter.next()},no.decorators=[{type:b.Component,args:[{selector:"app-enum-list",template:'<ng-template #buttons>\r\n  <button class="btn btn-secondary" (click)="cancel()">{{\'component.matrixPerformer.cancel\'|wfLocale}}</button>\r\n  <button class="btn btn-primary" (click)="onConfirm()">{{\'component.matrixPerformer.onConfirm\'|wfLocale}}</button>\r\n</ng-template>\r\n\r\n<div class="f-page">\r\n  <div class="f-page-main f-utils-fill-flex-column h-100">\r\n    <div class="f-utils-fill-flex-column farris-overflow-y-auto h-100">\r\n      <farris-datagrid [data]="data" [columns]="columns" #dg="datagrid" [fit]="true"\r\n                       [idField]="\'key\'" [fitColumns]="true" [showLineNumber]="true" [(checkValues)]="selectedIds"\r\n                       [showAllCheckbox]="true" [showCheckbox]="true" [multiSelect]="false" [checkOnSelect]="true" [selectOnCheck]="true"\r\n                       lineNumberTitle="{{\'component.matrixPerformer.lineNumber\'|wfLocale}}" [lineNumberWidth]="50" [striped]="true" [virtualized]="true" [pagination]="false">\r\n      </farris-datagrid>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n',providers:[x],styles:[""]}]}],no.ctorParameters=function(){return[{type:r.MessagerService},{type:b.Injector},{type:b.ChangeDetectorRef,decorators:[{type:b.Optional}]},{type:String,decorators:[{type:b.Inject,args:[b.LOCALE_ID]}]},{type:undefined,decorators:[{type:b.Inject,args:[o]}]},{type:x,decorators:[{type:b.Optional}]}]},no.propDecorators={cls:[{type:b.HostBinding,args:["class"]}],dg:[{type:b.ViewChild,args:["dg"]}],btnRef:[{type:b.ViewChild,args:["buttons"]}]};var io=no;function no(e,t,r,i,n,o){this.messageService=e,this.injector=t,this.cdr=r,this.localeId=i,this.resources=n,this.localePipe=o,this.cls="farris-main-area flex-column",this.columns=[{field:"key",width:100,title:this.localePipe.transform("component.matrixPerformer.key")},{field:"value",width:100,title:this.localePipe.transform("component.matrixPerformer.value")}],this.confirm=new V.Subject,this.closeModalEmitter=new V.Subject,this.data=new Array,this.selectedIds=new Array,this.localePipe=this.localePipe||new x(i,n)}ao.prototype.getData=function(e,t){var r,i,n;if(-1<e.indexOf("getMatrixDef"))return r=t.pageIndex||1,i=t.pageSize||20,(t=JSON.parse(t.searchValue)).searchValue?(n="{",t.searchValue&&("*"===t.searchField?n+='"codeOrNameLike":"'+t.searchValue+'",':n+='"'+t.searchField+'":"'+t.searchValue+'",'),","===n.substr(n.length-1,1)&&(n=n.substring(0,n.length-1)),n+="}",n=encodeURIComponent(n),e+="?searchValue="+(n+="&pageIndex="+r+"&pageSize="+i)):e+="?pageIndex="+r+"&pageSize="+i,this.http.get(e).pipe(re.map(function(e){return{items:e.content,total:e.totalElements,pageInfo:{pageIndex:e.pageable.pageNumber+1,pageSize:e.pageable.pageSize,pageList:[20,40,60,80,100],enablePager:!0}}}))},ao.decorators=[{type:b.Injectable}],ao.ctorParameters=function(){return[{type:t.HttpService}]};var oo=ao;function ao(e){this.http=e}Object.defineProperty(m.prototype,"setMatrixDataEntity",{set:function(t){var r=this,e="/api/runtime/wf/v1.0/matrixDefinition/"+(this.curMatrixDataEntity=t).matrixDefId;this.http.get(e).subscribe(function(e){r.curMatrixDefEntity=e,r.setFields(),r.curDataFieldValue=t.dataFieldAlias}),t.matrixDefId&&(this.typeReadOnly=!0),!this.curMatrixDataEntity.conditionField1||"{"===this.curMatrixDataEntity.conditionField1.charAt(0)?(this.condition1="expr",this.condition1ExprAble=!0):(this.condition1="help",this.condition1ExprAble=!1),!this.curMatrixDataEntity.conditionField2||"{"===this.curMatrixDataEntity.conditionField2.charAt(0)?(this.condition2="expr",this.condition2ExprAble=!0):(this.condition2="help",this.condition2ExprAble=!1),!this.curMatrixDataEntity.conditionField3||"{"===this.curMatrixDataEntity.conditionField3.charAt(0)?(this.condition3="expr",this.condition3ExprAble=!0):(this.condition3="help",this.condition3ExprAble=!1),"condition1"===this.curMatrixDataEntity.multivaluedCondition?(this.MultivalueOption1="Multivalue",this.condition1Multivalue=!0):"condition2"===this.curMatrixDataEntity.multivaluedCondition?(this.MultivalueOption2="Multivalue",this.condition2Multivalue=!0):"condition3"===this.curMatrixDataEntity.multivaluedCondition&&(this.MultivalueOption3="Multivalue",this.condition3Multivalue=!0),this.condition1Text=this.curMatrixDataEntity.conditionFieldText1||"",this.condition1Value=this.curMatrixDataEntity.conditionField1||"",this.condition2Text=this.curMatrixDataEntity.conditionFieldText2||"",this.condition2Value=this.curMatrixDataEntity.conditionField2||"",this.condition3Text=this.curMatrixDataEntity.conditionFieldText3||"",this.condition3Value=this.curMatrixDataEntity.conditionField3||""},enumerable:!0,configurable:!0}),m.prototype.ngOnInit=function(){var e="";try{e=window.gspframeworkService.common.getBasePath.get()}catch(t){}this.dataUri=e+"/api/runtime/wf/v1.0/matrixDefinition/getMatrixDef"},m.prototype.getMatrixLineType=function(){var t=this;this.http.get("/api/runtime/wf/v1.0/matrixDefinition").subscribe(function(e){t.matrixDefEntityList=e,t.items=t.matrixDefEntityList.slice(0,t.pageSize),t.total=t.matrixDefEntityList.length})},m.prototype.setFields=function(){var e,t,r,i;this.conditionFields=[],this.dataFieldAndValues=[],this.curMatrixDefEntity.conditionField.sort(function(e,t){return e.sortOrder-t.sortOrder});try{for(var n=ue(this.curMatrixDefEntity.conditionField),o=n.next();!o.done;o=n.next()){var a=o.value;this.conditionFields.push(a)}}catch(d){e={error:d}}finally{try{o&&!o.done&&(t=n["return"])&&t.call(n)}finally{if(e)throw e.error}}this.curMatrixDefEntity.dataField.sort(function(e,t){return e.sortOrder-t.sortOrder});try{for(var s=ue(this.curMatrixDefEntity.dataField),l=s.next();!l.done;l=s.next()){var c=l.value,p={text:c.alias,value:c.alias};this.dataFieldAndValues.push(p)}}catch(u){r={error:u}}finally{try{l&&!l.done&&(i=s["return"])&&i.call(s)}finally{if(r)throw r.error}}},m.prototype.onClear=function(){this.curMatrixDataEntity=new to},m.prototype.editCondition=function(){var e,t,r,i,n,o,a=this;if(0<this.designerUIState.schemas.length){try{for(var s=ue(this.designerUIState.schemas),l=s.next();!l.done;l=s.next()){var c=l.value;this.expr.addSchema("Schema",c)}}catch(y){e={error:y}}finally{try{l&&!l.done&&(o=s["return"])&&o.call(s)}finally{if(e)throw e.error}}this.designerUIState.schemas[0].entityTypes&&0<this.designerUIState.schemas[0].entityTypes.length&&(o=this.designerUIState.schemas[0].entityTypes[0],this.expr.addInjectedEntity(o.name,"Schema",o.name,D.InjectedType.EntityType))}var p=new Array,p=this.designerUIState.addContext(p);if(0<this.designerUIState.subActivityContext.length)try{for(var d=ue(this.designerUIState.subActivityContext),u=d.next();!u.done;u=d.next())!function(t){p.some(function(e){return e.key===t.key})||p.push(t)}(u.value)}catch(g){t={error:g}}finally{try{u&&!u.done&&(r=d["return"])&&r.call(d)}finally{if(t)throw t.error}}if(0<p.length)try{for(var m=ue(p),f=m.next();!f.done;f=m.next()){var h=f.value;this.expr.addContext(h)}}catch(v){i={error:v}}finally{try{f&&!f.done&&(n=m["return"])&&n.call(m)}finally{if(i)throw i.error}}this.expr.setEditPattern(D.ExprEditMode.Conditional),this.expr.addExpressionText(this.curMatrixDataEntity.condition),this.expr.buildExpression().then(function(e){a.curMatrixDataEntity.condition=e,0<p.length&&(a.expr.exprEntity.contextEntities=a.expr.exprEntity.contextEntities.filter(function(t){return!p.some(function(e){return e.key===t.key})}))})},m.prototype.onHelpSearch=function(e,t,r){this.index=t,this.fieldId=r,this.helpId=this.curMatrixDefEntity.conditionField[this.index].smartHelp,this.lookUp.onClear(),this.lookUp.showDialog()},m.prototype.openEnumValue=function(e,t){this.index=e,this.fieldId=t,this.showEnumList(JSON.parse(this.curMatrixDefEntity.conditionField[this.index].enumList))},m.prototype.showEnumList=function(e){var t=this,r=this.resolver.resolveComponentFactory(io).create(this.injector),i={title:this.localePipe.transform("component.matrixPerformer.enumSelection"),width:650,height:450,showButtons:!0,buttons:r.instance.btnRef},n=(e&&0<e.length&&r.instance.load(e),r.instance.confirm.subscribe(function(e){0===t.index?(t.condition1Text=e[0].value,t.condition1Value=e[0].value):1===t.index?(t.condition2Text=e[0].value,t.condition2Value=e[0].value):2===t.index&&(t.condition3Text=e[0].value,t.condition3Value=e[0].value)}),this.modalService.show(r,i));r.instance.closeModalEmitter.subscribe(function(){n.close()})},m.prototype.dataFieldChange=function(e){this.curMatrixDataEntity.dataFieldAlias=e.data.value},m.prototype.selectedDataHandler=function(e){0===this.index?(this.condition1Text=e.name,this.condition1Value=e.id):1===this.index?(this.condition2Text=e.name,this.condition2Value=e.id):2===this.index&&(this.condition3Text=e.name,this.condition3Value=e.id)},m.prototype.getPerformers=function(){return this.curMatrixDataEntity.type="wf.MatrixParticipantExpression",this.curMatrixDataEntity.conditionFieldText1=this.condition1Text,this.curMatrixDataEntity.conditionField1=""===this.condition1Text?"":this.condition1Value,this.curMatrixDataEntity.conditionFieldText2=this.condition2Text,this.curMatrixDataEntity.conditionField2=""===this.condition2Text?"":this.condition2Value,this.curMatrixDataEntity.conditionFieldText3=this.condition3Text,this.curMatrixDataEntity.conditionField3=""===this.condition3Text?"":this.condition3Value,this.condition1Multivalue?this.curMatrixDataEntity.multivaluedCondition="condition1":this.condition2Multivalue?this.curMatrixDataEntity.multivaluedCondition="condition2":this.condition3Multivalue&&(this.curMatrixDataEntity.multivaluedCondition="condition3"),this.curMatrixDataEntity},m.prototype.showExprHelp=function(t){var e,r,i,n,o,a,s,l,c,p,d=this;if(0<this.designerUIState.schemas.length){try{for(var u=ue(this.designerUIState.schemas),m=u.next();!m.done;m=u.next()){var f=m.value;this.expr.addSchema("Schema",f)}}catch(E){e={error:E}}finally{try{m&&!m.done&&(p=u["return"])&&p.call(u)}finally{if(e)throw e.error}}this.designerUIState.schemas[0].entityTypes&&0<this.designerUIState.schemas[0].entityTypes.length&&(p=this.designerUIState.schemas[0].entityTypes[0],this.expr.addInjectedEntity(p.name,"Schema",p.name,D.InjectedType.EntityType))}var h=new Array;if(0<this.designerUIState.participantContext.length)try{for(var y=ue(this.designerUIState.participantContext),g=y.next();!g.done;g=y.next()){var v=g.value;h.push(v)}}catch(T){r={error:T}}finally{try{g&&!g.done&&(i=y["return"])&&i.call(y)}finally{if(r)throw r.error}}if(0<this.designerUIState.processVariableContext.length)try{for(var b=ue(this.designerUIState.processVariableContext),x=b.next();!x.done;x=b.next())!function(t){h.some(function(e){return e.key===t.key})||h.push(t)}(v=x.value)}catch(A){n={error:A}}finally{try{x&&!x.done&&(o=b["return"])&&o.call(b)}finally{if(n)throw n.error}}if(0<this.designerUIState.subActivityContext.length)try{for(var w=ue(this.designerUIState.subActivityContext),P=w.next();!P.done;P=w.next())!function(t){h.some(function(e){return e.key===t.key})||h.push(t)}(v=P.value)}catch(k){a={error:k}}finally{try{P&&!P.done&&(s=w["return"])&&s.call(w)}finally{if(a)throw a.error}}if(0<h.length)try{for(var C=ue(h),I=C.next();!I.done;I=C.next()){var S=I.value;this.expr.addContext(S)}}catch(O){l={error:O}}finally{try{I&&!I.done&&(c=C["return"])&&c.call(C)}finally{if(l)throw l.error}}"condition1"===t?this.curMatrixDataEntity.conditionField1?this.expr.addExpressionText(this.curMatrixDataEntity.conditionField1):this.expr.addExpressionText(""):"condition2"===t?this.curMatrixDataEntity.conditionField2?this.expr.addExpressionText(this.curMatrixDataEntity.conditionField2):this.expr.addExpressionText(""):"condition3"===t&&(this.curMatrixDataEntity.conditionField3?this.expr.addExpressionText(this.curMatrixDataEntity.conditionField3):this.expr.addExpressionText("")),this.expr.buildExpression().then(function(e){"condition1"===t?(d.condition1Text=e,d.condition1Value=e):"condition2"===t?(d.condition2Text=e,d.condition2Value=e):(d.condition3Text=e,d.condition3Value=e),0<h.length&&(d.expr.exprEntity.contextEntities=d.expr.exprEntity.contextEntities.filter(function(t){return!h.some(function(e){return e.key===t.key})}))})},m.prototype.condition1Expr=function(e){this.showExprHelp(e)},m.prototype.condition1ExprClick=function(){this.condition1ExprAble=!this.condition1ExprAble,this.condition1Multivalue=!1,this.MultivalueOption1="",this.condition1Text="",this.condition1Value=""},m.prototype.condition1MulClick=function(){this.MultivalueOption2="",this.MultivalueOption3="",this.condition2Multivalue=!1,this.condition3Multivalue=!1,this.condition1Multivalue=!this.condition1Multivalue},m.prototype.condition2Expr=function(e){this.showExprHelp(e)},m.prototype.condition2ExprClick=function(){this.condition2ExprAble=!this.condition2ExprAble,this.condition2Multivalue=!1,this.MultivalueOption2="",this.condition2Text="",this.condition2Value=""},m.prototype.condition2MulClick=function(){this.MultivalueOption1="",this.MultivalueOption3="",this.condition1Multivalue=!1,this.condition3Multivalue=!1,this.condition2Multivalue=!this.condition2Multivalue},m.prototype.condition3Expr=function(e){this.showExprHelp(e)},m.prototype.condition3ExprClick=function(){this.condition3ExprAble=!this.condition3ExprAble,this.condition3Multivalue=!1,this.MultivalueOption3="",this.condition3Text="",this.condition3Value=""},m.prototype.condition3MulClick=function(){this.MultivalueOption1="",this.MultivalueOption2="",this.condition1Multivalue=!1,this.condition2Multivalue=!1,this.condition3Multivalue=!this.condition3Multivalue},m.decorators=[{type:b.Component,args:[{selector:"app-matrix-performer",template:'<div class="d-flex flex-fill farris-overflow-y-auto p-md-2" style="background: #FFF;">\r\n  <div class="d-flex flex-fill farris-overflow-y-auto mx-3 my-2" style="border-radius:16px;border: 1.5px solid #F1F3F7;">\r\n  <form style="width: 100%;">\r\n    <div class="d-flex m-2 flex-column w-100">\r\n      <div class="d-flex flex-column">\r\n        <div class="farris-form form-inline  farris-form-inline">\x3c!--mr-5--\x3e\r\n          <div class="col-12 farris-group-auto my-4">\r\n            <div class="farris-group-wrap">\r\n              <div class="form-group farris-form-group">\r\n                <label class="col-form-label" style="width: 14%">\r\n                  <span class="farris-label-info text-danger">*</span>\r\n                  <span class="farris-label-text">{{\'component.matrixPerformer.refMatrixTable\'|wfLocale}}</span>\r\n                </label>\r\n                <div class="farris-input-wrap" style="width: 77.5%">\r\n                  <farris-lookup-grid [items]="items" [columns]="columns" [(ngModel)]="curMatrixDataEntity.matrixDefName"\r\n                                      name="definitionId" [resizable]="true" [singleSelect]="true" [idField]="\'id\'" [pagination]="true"\r\n                                      [pageIndex]="pageIndex" [pageSize]="pageSize" [pageList]="pageList" [total]="total" [textField]="\'name\'"\r\n                                      [valueField]="\'id\'" title="{{\'component.matrixPerformer.matrixTable\'|wfLocale}}" [dictPicked]="dictPicked" (clear)="onClear()" [readonly]="typeReadOnly"\r\n                                      [customDisplayType] = "true" [displayType]="\'LIST\'" [uri]="dataUri" [dictPicking]="onBeforeHelp">\r\n                  </farris-lookup-grid>\r\n                  <div class="farris-feedback valid-feedback"></div>\r\n                </div>\r\n                <div style="width: 7.5%"></div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class="col-12 farris-group-auto my-4">\r\n            <div class="farris-group-wrap">\r\n              <div class="form-group farris-form-group">\r\n                <label class="col-form-label" style="width: 14%">\r\n                  <span class="farris-label-info text-danger">*</span>\r\n                  <span class="farris-label-text">{{\'component.matrixPerformer.curDataFieldValue\'|wfLocale}}</span>\r\n                </label>\r\n                <div class="farris-input-wrap" style="width: 77.5%">\r\n                  \x3c!--下拉列表--\x3e\r\n                  <farris-combo-list [(ngModel)]="curDataFieldValue" name="referObject" [panelHeight]="200" [idField]="\'value\'"\r\n                                     [textField]="\'text\'" [data]="dataFieldAndValues" (selectChange)=\'dataFieldChange($event)\'>\r\n                  </farris-combo-list>\r\n                  <div class="farris-feedback valid-feedback"></div>\r\n                </div>\r\n                <div style="width: 7.5%"></div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class="col-12 farris-group-auto my-4" *ngIf="conditionFields && conditionFields.length > 0">\r\n            <div class="farris-group-wrap">\r\n              <div class="form-group farris-form-group" style="margin-top: -17px; margin-bottom: -22px">\r\n                <label class="col-form-label" style="width: 14%">\r\n                  <span class="farris-label-text" style="color: rgb(180,180,180)">{{\'component.matrixPerformer.conditionFields\'|wfLocale}}</span>\r\n                </label>\r\n                <div class="farris-input-wrap" style="width: 77.5%">\r\n                  <hr size="3px">\r\n                </div>\r\n                <div style="width: 7.5%"></div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class="col-12 farris-group-auto my-4" *ngIf="conditionFields && conditionFields.length > 0">\r\n            <div class="farris-group-wrap">\r\n              <div class="form-group farris-form-group">\r\n                <label class="col-form-label" style="width: 14%">\r\n                  <span class="farris-label-text">{{conditionFields[0].alias}}</span>\r\n                </label>\r\n                <div class="farris-input-wrap" style="width: 60%" *ngIf="conditionFields[0].inputType === \'help\' && !condition1ExprAble">\r\n                  <input-group name="condition1" [editable]="false" [customCls]="\'custom-cls\'" [groupText]="groupIcon2" [(ngModel)]="condition1Text" (clickHandle)="onHelpSearch($event,0,conditionFields[0].id)"></input-group>\r\n                </div>\r\n                <div class="farris-input-wrap" style="width: 60%" *ngIf="conditionFields[0].inputType === \'enum\' && !condition1ExprAble">\r\n                  <input-group name="condition1" [editable]="false" [customCls]="\'custom-cls\'" [groupText]="groupIcon2" [(ngModel)]="condition1Text" (clickHandle)="openEnumValue(0,conditionFields[0].id)"></input-group>\r\n                </div>\r\n                <div class="farris-input-wrap" style="width: 60%" *ngIf="condition1ExprAble">\r\n                  <input-group name="condition1" [editable]="false" [customCls]="\'custom-cls\'" [groupText]="groupIcon2"\r\n                               [(ngModel)]="condition1Text" (clickHandle)="condition1Expr(\'condition1\')">\r\n                  </input-group>\r\n                </div>\r\n                <farris-checkboxgroup style="width: 10%; padding-left: 5px" [(ngModel)]="condition1" name="Expr1Able" [horizontal]="true"\r\n                                      [data]="exprGroup" (changeValue)="condition1ExprClick()">\r\n                </farris-checkboxgroup>\r\n                <farris-checkboxgroup style="width: 10%" [(ngModel)]="MultivalueOption1" name="Expr1Mul" [horizontal]="true" [disable]="!condition1ExprAble"\r\n                [data]="mulGroup" (changeValue)="condition1MulClick()">\r\n                </farris-checkboxgroup>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class="col-12 farris-group-auto my-4" *ngIf="conditionFields && conditionFields.length > 1">\r\n            <div class="farris-group-wrap">\r\n              <div class="form-group farris-form-group">\r\n                <label class="col-form-label" style="width: 14%">\r\n                  <span class="farris-label-text">{{conditionFields[1].alias}}</span>\r\n                </label>\r\n                <div class="farris-input-wrap" style="width: 60%" *ngIf="conditionFields[1].inputType === \'help\' && !condition2ExprAble">\r\n                  <input-group name="condition2" [editable]="false" [customCls]="\'custom-cls\'" [groupText]="groupIcon2" [(ngModel)]="condition2Text" (clickHandle)="onHelpSearch($event,1,conditionFields[1].id)"></input-group>\r\n                </div>\r\n                <div class="farris-input-wrap" style="width: 60%" *ngIf="conditionFields[1].inputType === \'enum\' && !condition2ExprAble">\r\n                  <input-group name="condition2" [editable]="false" [customCls]="\'custom-cls\'" [groupText]="groupIcon2" [(ngModel)]="condition2Text" (clickHandle)="openEnumValue(1,conditionFields[1].id)"></input-group>\r\n                </div>\r\n                <div class="farris-input-wrap" style="width: 60%" *ngIf="condition2ExprAble">\r\n                  <input-group name="condition2" [editable]="false" [customCls]="\'custom-cls\'" [groupText]="groupIcon2"\r\n                               [(ngModel)]="condition2Text" (clickHandle)="condition2Expr(\'condition2\')">\r\n                  </input-group>\r\n                </div>\r\n                <farris-checkboxgroup style="width: 10%; padding-left: 5px" [(ngModel)]="condition2" name="Expr2Able" [horizontal]="true"\r\n                                      [data]="exprGroup" (changeValue)="condition2ExprClick()">\r\n                </farris-checkboxgroup>\r\n                <farris-checkboxgroup style="width: 10%" [(ngModel)]="MultivalueOption2" name="Expr2Mul" [horizontal]="true" [disable]="!condition2ExprAble"\r\n                [data]="mulGroup" (changeValue)="condition2MulClick()">\r\n                </farris-checkboxgroup>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class="col-12 farris-group-auto my-4" *ngIf="conditionFields && conditionFields.length > 2">\r\n            <div class="farris-group-wrap">\r\n              <div class="form-group farris-form-group">\r\n                <label class="col-form-label" style="width: 14%">\r\n                  <span class="farris-label-text">{{conditionFields[2].alias}}</span>\r\n                </label>\r\n                <div class="farris-input-wrap" style="width: 60%" *ngIf="conditionFields[2].inputType === \'help\' && !condition3ExprAble">\r\n                  <input-group name="condition3" [editable]="false" [customCls]="\'custom-cls\'" [groupText]="groupIcon2" [(ngModel)]="condition3Text" (clickHandle)="onHelpSearch($event,2,conditionFields[2].id)"></input-group>\r\n                </div>\r\n                <div class="farris-input-wrap" style="width: 60%" *ngIf="conditionFields[2].inputType === \'enum\' && !condition3ExprAble">\r\n                  <input-group name="condition3" [editable]="false" [customCls]="\'custom-cls\'" [groupText]="groupIcon2" [(ngModel)]="condition3Text" (clickHandle)="openEnumValue(2,conditionFields[2].id)"></input-group>\r\n                </div>\r\n                <div class="farris-input-wrap" style="width: 60%" *ngIf="condition3ExprAble">\r\n                  <input-group name="condition3" [editable]="false" [customCls]="\'custom-cls\'" [groupText]="groupIcon2"\r\n                               [(ngModel)]="condition3Text" (clickHandle)="condition3Expr(\'condition3\')">\r\n                  </input-group>\r\n                </div>\r\n                <farris-checkboxgroup style="width: 10%; padding-left: 5px" [(ngModel)]="condition3" name="Expr3Able" [horizontal]="true"\r\n                                      [data]="exprGroup" (changeValue)="condition3ExprClick()">\r\n                </farris-checkboxgroup>\r\n                <farris-checkboxgroup style="width: 10%" [(ngModel)]="MultivalueOption3" name="Expr3Mul" [horizontal]="true" [disable]="!condition3ExprAble"\r\n                [data]="mulGroup" (changeValue)="condition3MulClick()">\r\n                </farris-checkboxgroup>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div class="d-flex flex-column">\r\n        <div class="farris-form form-inline farris-form-inline mr-5">\r\n          <div class="col-12 farris-group-auto my-4">\r\n            <div class="farris-group-wrap">\r\n              <div class="form-group farris-form-group">\r\n                <label class="col-form-label">\r\n                  <span class="farris-label-text">{{\'component.matrixPerformer.condition\'|wfLocale}}</span>\r\n                </label>\r\n                <div class="farris-input-wrap">\r\n                  <div class="input-group">\r\n                    <input type="text" class="form-control" [(ngModel)]="curMatrixDataEntity.condition" name="conditon" [readOnly]="true" />\r\n                    <div class="input-group-append">\r\n                      <span class="input-group-text" (click)="editCondition()" style="background: #FFF;">\r\n                        <i class="f-icon f-icon-lookup"></i>\r\n                      </span>\r\n                    </div>\r\n                  </div>\r\n                  <div class="farris-feedback valid-feedback"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </form>\r\n</div>\r\n</div>\r\n\r\n<farris-lookup-grid style="display: none;" #lookup [(ngModel)]="value" name="value" [helpId]="helpId"\r\n  [singleSelect]="true" [uri]="\'assets/data/tree-list-help.json\'" (selectedData)="selectedDataHandler($event)"\r\n  [dictPicked]="dictHelpPicked" [enableCascade]="false">\r\n</farris-lookup-grid>\r\n',providers:[{provide:Ee.ServerSideToken,useClass:F.LookupDataService},x],styles:[""]}]}],m.ctorParameters=function(){return[{type:t.HttpService},{type:a},{type:D.ExpressionService},{type:i.BsModalService},{type:b.ComponentFactoryResolver},{type:b.Injector},{type:oo},{type:b.ChangeDetectorRef,decorators:[{type:b.Optional}]},{type:String,decorators:[{type:b.Inject,args:[b.LOCALE_ID]}]},{type:undefined,decorators:[{type:b.Inject,args:[o]}]},{type:x,decorators:[{type:b.Optional}]}]},m.propDecorators={cls:[{type:b.HostBinding,args:["class"]}],setMatrixDataEntity:[{type:b.Input}],lookUp:[{type:b.ViewChild,args:["lookup"]}]};var so=m;function m(e,t,r,i,n,o,a,s,l,c,p){var d=this;this.http=e,this.designerUIState=t,this.expr=r,this.modalService=i,this.resolver=n,this.injector=o,this.matDefService=a,this.cdr=s,this.localeId=l,this.resources=c,this.localePipe=p,this.cls="d-flex flex-fill h-100",this.display="none",this.typeReadOnly=!1,this.items=[],this.pageIndex=1,this.pageSize=20,this.pageList=[10,20,30,50,100],this.total=0,this.groupIcon2='<i class="f-icon f-icon-lookup"></i>',this.fieldId="",this.columns=[{title:this.localePipe.transform("component.matrixPerformer.code"),field:"code",width:100},{title:this.localePipe.transform("component.matrixPerformer.name"),field:"name",width:100}],this.users=[],this.dataFieldAndValues=[],this.curDataFieldValue="",this.matrixDefEntityList=[],this.curMatrixDefEntity=new eo,this.curMatrixDataEntity=new to,this.conditionFields=[],this.exprGroup=[{name:this.localePipe.transform("component.matrixPerformer.help"),value:"help"}],this.mulGroup=[{name:this.localePipe.transform("component.matrixPerformer.multivalue"),value:"Multivalue"}],this.condition1ExprAble=!0,this.condition2ExprAble=!0,this.condition3ExprAble=!0,this.condition1Multivalue=!1,this.condition2Multivalue=!1,this.condition3Multivalue=!1,this.condition1Text="",this.condition1Value="",this.condition2Text="",this.condition2Value="",this.condition3Text="",this.condition3Value="",this.dictPicked=function(e){return d.curMatrixDataEntity=new to,d.curDataFieldValue="",d.curMatrixDefEntity=e,d.curMatrixDataEntity.matrixDefId=e.id,d.curMatrixDataEntity.matrixDefName=e.name,d.setFields(),v.of(!0)},this.dictHelpPicked=function(e){return d.value=null,v.of({closeDialog:!0})},this.onBeforeHelp=function(e){var t,r=e.instance;return r&&(t=r.http.getData,r.http.getData=d.matDefService.getData,r.dialogClosed.subscribe(function(){r.http.getData=t})),v.of(!0)},this.localePipe=this.localePipe||new x(l,c)}n(po,lo=$r);var lo,co=po;function po(e,t,r){return lo.call(this,e,t,r)||this}mo.prototype.ngOnInit=function(){},mo.prototype.ngAfterViewInit=function(){var e=this;this.ngZone.runOutsideAngular(function(){e.inputGroup.nativeElement.addEventListener("mouseenter",e.onMouseEnter.bind(e)),e.inputGroup.nativeElement.addEventListener("mouseleave",e.onMouseLeave.bind(e))})},mo.prototype.onMouseEnter=function(e){this.showClearButton=!0,this.showClearButton&&this.toggleClearIcon(e,!0)},mo.prototype.onMouseLeave=function(e){this.showClearButton=!1,this.toggleClearIcon(e,!1)},mo.prototype.toggleClearIcon=function(e,t){t=(t=void 0===t?!1:t)?"":"none",e=e.target.querySelector(".input-group-clear");e&&(e.style.display=t)},mo.prototype.clear=function(e){this.activityExecutors=[]},mo.prototype.selectUsers=function(e){var t,r,i=[];if(this.activityExecutors&&0<this.activityExecutors.length)try{for(var n=ue(this.activityExecutors),o=n.next();!o.done;o=n.next()){var a=o.value,s={data:{Id:a.activityDefId,Name:a.activityDefName},id:a.activityDefId};i.push(s)}}catch(l){t={error:l}}finally{try{o&&!o.done&&(r=n["return"])&&r.call(n)}finally{if(t)throw t.error}}this.allActivityTable.setCurrentPagerData(i),this.allActivityDialog.show()},mo.prototype.editConditon=function(){var e,t,r,i,n,o,a,s,l=this;if(0<this.designerUIState.schemas.length){try{for(var c=ue(this.designerUIState.schemas),p=c.next();!p.done;p=c.next()){var d=p.value;this.expr.addSchema("Schema",d)}}catch(x){e={error:x}}finally{try{p&&!p.done&&(s=c["return"])&&s.call(c)}finally{if(e)throw e.error}}this.designerUIState.schemas[0].entityTypes&&0<this.designerUIState.schemas[0].entityTypes.length&&(s=this.designerUIState.schemas[0].entityTypes[0],this.expr.addInjectedEntity(s.name,"Schema",s.name,D.InjectedType.EntityType))}var u=new Array,u=this.designerUIState.addContext(u);if(0<this.designerUIState.subActivityContext.length)try{for(var m=ue(this.designerUIState.subActivityContext),f=m.next();!f.done;f=m.next())!function(t){u.some(function(e){return e.key===t.key})||u.push(t)}(f.value)}catch(w){t={error:w}}finally{try{f&&!f.done&&(r=m["return"])&&r.call(m)}finally{if(t)throw t.error}}if(0<this.designerUIState.activityComponentContext.length)try{for(var h=ue(this.designerUIState.activityComponentContext),y=h.next();!y.done;y=h.next())!function(t){u.some(function(e){return e.key===t.key})||u.push(t)}(y.value)}catch(P){i={error:P}}finally{try{y&&!y.done&&(n=h["return"])&&n.call(h)}finally{if(i)throw i.error}}if(0<u.length)try{for(var g=ue(u),v=g.next();!v.done;v=g.next()){var b=v.value;this.expr.addContext(b)}}catch(C){o={error:C}}finally{try{v&&!v.done&&(a=g["return"])&&a.call(g)}finally{if(o)throw o.error}}this.expr.setEditPattern(D.ExprEditMode.Conditional),this.expr.addExpressionText(this.condition),this.expr.buildExpression().then(function(e){l.condition=e,0<u.length&&(l.expr.exprEntity.contextEntities=l.expr.exprEntity.contextEntities.filter(function(t){return!u.some(function(e){return e.key===t.key})}))})},mo.prototype.activitiesSelect=function(){var r=this,e=this.allActivityTable.checkeds;this.activityExecutors=e.map(function(e){var t=new co(e.data.Id,e.data.Name,"wf.ActivityExecutorParticipantExpression");return t.performerName="<"+e.data.Name+r.localePipe.transform("component.activityExecutor.eventHandler"),t.activityDefId=e.data.Id,t.activityDefName=e.data.Name,t.condition=r.condition,t}),this.allActivityDialog.close()},mo.prototype.getPerformers=function(){var t=this;return this.activityExecutors.map(function(e){return e.condition=t.condition}),this.activityExecutors},mo.decorators=[{type:b.Component,args:[{selector:"app-activity-handler-performer",template:'<div class="d-flex flex-fill farris-overflow-y-auto p-md-2" style="background: #FFF;">\r\n  <div class="d-flex flex-fill farris-overflow-y-auto mx-3 my-2" style="border-radius:16px;border: 1.5px solid #F1F3F7;">\r\n  <form style="width: 100%;" >\r\n    <div class="d-flex m-2 flex-column w-100">\r\n      <div class="d-flex flex-column">\r\n        <div class="farris-form form-inline  farris-form-inline mr-5 my-2">\r\n          <div class="col-12 farris-group-auto my-4">\r\n            <div class="farris-group-wrap">\r\n              <div class="form-group farris-form-group">\r\n                <label class="col-form-label">\r\n                  <span class="farris-label-info text-danger">*</span>\r\n                  <span class="farris-label-text">{{\'component.activityExecutor.nodeName\'|wfLocale}}</span>\r\n                </label>\r\n                <div class="farris-input-wrap">\r\n                  <div #inputGroup class="input-group">\r\n                    <input type="text" class="form-control" [value]="activityExecutors | activityExecutor " name="users" [readOnly]="true" />\r\n                    <div class="input-group-append">\r\n                      <span [style.display]="showClearButton ? \'\' : \'none\'" class="input-group-text input-group-clear"\r\n                            (click)="clear($event)">\r\n                        <i class="f-icon modal_close"></i>\r\n                      </span>\r\n                      <span class="input-group-text" (click)="selectUsers($event)" style="background: #FFF;">\r\n                        <i class="f-icon f-icon-lookup"></i>\r\n                      </span>\r\n                    </div>\r\n                  </div>\r\n                  <div class="farris-feedback valid-feedback"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div class="d-flex flex-column">\r\n        <div class="farris-form form-inline farris-form-inline mr-5">\r\n          <div class="col-12 farris-group-auto my-4">\r\n            <div class="farris-group-wrap">\r\n              <div class="form-group farris-form-group">\r\n                <label class="col-form-label">\r\n                  <span class="farris-label-text">{{\'component.activityExecutor.enablingConditions\'|wfLocale}}</span>\r\n                </label>\r\n                <div class="farris-input-wrap">\r\n                  <div class="input-group">\r\n                    <input type="text" class="form-control" [(ngModel)]="condition" name="conditon" [readOnly]="true" />\r\n                    <div class="input-group-append">\r\n                      <span class="input-group-text" (click)="editConditon()" style="background: #FFF;">\r\n                        <i class="f-icon f-icon-lookup"></i>\r\n                      </span>\r\n                    </div>\r\n                  </div>\r\n                  <div class="farris-feedback valid-feedback"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </form>\r\n</div>\r\n</div>\r\n\r\n<farris-dialog #allActivityDialog [buttons]="buttonRef" [width]="700" [height]="520" title="{{\'component.activityExecutor.activityList\'|wfLocale}}">\r\n  <div class="f-utils-fill-flex-column farris-overflow-y-auto h-100 m-2">\r\n    <farris-datagrid #allActivityTable [columns]="cols" [data]="designerUIState.userActList"  [idField]="\'Id\'" [fit]="true"\r\n                     [fitColumns]="true" [pagination]=\'false\' [multiSelect]="true" [showCheckbox]="true"\r\n                     [checkOnSelect]="true" [selectOnCheck]="true">\r\n    </farris-datagrid>\r\n  </div>\r\n</farris-dialog>\r\n<ng-template #buttonRef>\r\n  <button class="btn btn-sm btn-default" (click)="allActivityDialog.close()">{{\'component.activityExecutor.clickCancel\'|wfLocale}}</button>\r\n  <button class="btn btn-sm btn-primary mx-2" (click)="activitiesSelect()">{{\'component.activityExecutor.clickOK\'|wfLocale}}</button>\r\n</ng-template>\r\n',providers:[x],styles:[""]}]}],mo.ctorParameters=function(){return[{type:b.NgZone},{type:a},{type:D.ExpressionService},{type:b.ChangeDetectorRef,decorators:[{type:b.Optional}]},{type:String,decorators:[{type:b.Inject,args:[b.LOCALE_ID]}]},{type:undefined,decorators:[{type:b.Inject,args:[o]}]},{type:x,decorators:[{type:b.Optional}]}]},mo.propDecorators={cls:[{type:b.HostBinding,args:["class"]}],inputGroup:[{type:b.ViewChild,args:["inputGroup"]}],allActivityDialog:[{type:b.ViewChild,args:["allActivityDialog"]}],allActivityTable:[{type:b.ViewChild,args:["allActivityTable"]}]};var uo=mo;function mo(e,t,r,i,n,o,a){this.ngZone=e,this.designerUIState=t,this.expr=r,this.cdr=i,this.localeId=n,this.resources=o,this.localePipe=a,this.cls="d-flex flex-fill h-100",this.showClearButton=!1,this.activityExecutors=[],this.cols=[{title:this.localePipe.transform("component.activityExecutor.name"),field:"Name",width:60},{title:"ID",field:"Id",width:90}],this.localePipe=this.localePipe||new x(n,o)}var fo,ho=function(){},yo="AssignUser",go="DEPARTMENT",vo="DEFAULT",bo="VARORGANIZATION",xo=(n(wo,fo=$r),wo);function wo(e,t,r){return fo.call(this,e,t,r)||this}Co.prototype.ngOnInit=function(){var t=this;this.http.get("/api/runtime/wf/v1.0/reportingOrgType/hasAdminOrg").subscribe(function(e){t.userTypeButtonNeedShow=e,"inSuite"===t.designerUIState.scene&&(t.userTypeButtonNeedShow=!0,t.variableOrgTypes=[{name:t.localePipe.transform("component.variablePerformer.sys"),value:"Sys"},{name:t.localePipe.transform("component.variablePerformer.administrative_staff"),value:"Administrative_staff"},{name:t.localePipe.transform("component.variablePerformer.administrative_organization"),value:"Administrative_organization"}],t.getInSuiteField(t.user.varType||"Sys"))})},Co.prototype.ngAfterViewInit=function(){var e=this;this.ngZone.runOutsideAngular(function(){e.inputGroup.nativeElement.addEventListener("mouseenter",e.onMouseEnter.bind(e)),e.inputGroup.nativeElement.addEventListener("mouseleave",e.onMouseLeave.bind(e))})},Co.prototype.onMouseEnter=function(e){this.showClearButton=!0,this.showClearButton&&this.toggleClearIcon(e,!0)},Co.prototype.onMouseLeave=function(e){this.showClearButton=!1,this.toggleClearIcon(e,!1)},Co.prototype.toggleClearIcon=function(e,t){t=(t=void 0===t?!1:t)?"":"none",e=e.target.querySelector(".input-group-clear");e&&(e.style.display=t)},Co.prototype.clear=function(e){this.bindingData={},this.users=[],this.user=null,this.variableOrgTypes=[{name:this.localePipe.transform("component.variablePerformer.sys"),value:"Sys"},{name:this.localePipe.transform("component.variablePerformer.administrative_staff"),value:"Administrative_staff"}],"inSuite"===this.designerUIState.scene&&(this.variableOrgTypes=[{name:this.localePipe.transform("component.variablePerformer.sys"),value:"Sys"},{name:this.localePipe.transform("component.variablePerformer.administrative_staff"),value:"Administrative_staff"},{name:this.localePipe.transform("component.variablePerformer.administrative_organization"),value:"Administrative_organization"}])},Co.prototype.selectUsers=function(e){this.showExprHelp()},Co.prototype.editConditon=function(){var e,t,r,i,n,o,a,s,l=this;if(0<this.designerUIState.schemas.length){try{for(var c=ue(this.designerUIState.schemas),p=c.next();!p.done;p=c.next()){var d=p.value;this.expr.addSchema("Schema",d)}}catch(x){e={error:x}}finally{try{p&&!p.done&&(s=c["return"])&&s.call(c)}finally{if(e)throw e.error}}this.designerUIState.schemas[0].entityTypes&&0<this.designerUIState.schemas[0].entityTypes.length&&(s=this.designerUIState.schemas[0].entityTypes[0],this.expr.addInjectedEntity(s.name,"Schema",s.name,D.InjectedType.EntityType))}var u=new Array,u=this.designerUIState.addContext(u);if(0<this.designerUIState.subActivityContext.length)try{for(var m=ue(this.designerUIState.subActivityContext),f=m.next();!f.done;f=m.next())!function(t){u.some(function(e){return e.key===t.key})||u.push(t)}(f.value)}catch(w){t={error:w}}finally{try{f&&!f.done&&(r=m["return"])&&r.call(m)}finally{if(t)throw t.error}}if(0<this.designerUIState.activityComponentContext.length)try{for(var h=ue(this.designerUIState.activityComponentContext),y=h.next();!y.done;y=h.next())!function(t){u.some(function(e){return e.key===t.key})||u.push(t)}(y.value)}catch(P){i={error:P}}finally{try{y&&!y.done&&(n=h["return"])&&n.call(h)}finally{if(i)throw i.error}}if(0<u.length)try{for(var g=ue(u),v=g.next();!v.done;v=g.next()){var b=v.value;this.expr.addContext(b)}}catch(C){o={error:C}}finally{try{v&&!v.done&&(a=g["return"])&&a.call(g)}finally{if(o)throw o.error}}this.expr.setEditPattern(D.ExprEditMode.Conditional),this.expr.addExpressionText(this.condition),this.expr.buildExpression().then(function(e){l.condition=e,0<u.length&&(l.expr.exprEntity.contextEntities=l.expr.exprEntity.contextEntities.filter(function(t){return!u.some(function(e){return e.key===t.key})}))})},Co.prototype.showExprHelp=function(){var e,t,r,i,n,o,a,s,l,c,p=this;if(this.expr.setEditPattern(D.ExprEditMode.Advanced),0<this.designerUIState.schemas.length){try{for(var d=ue(this.designerUIState.schemas),u=d.next();!u.done;u=d.next()){var m=u.value;this.expr.addSchema("Schema",m)}}catch(S){e={error:S}}finally{try{u&&!u.done&&(c=d["return"])&&c.call(d)}finally{if(e)throw e.error}}this.designerUIState.schemas[0].entityTypes&&0<this.designerUIState.schemas[0].entityTypes.length&&(c=this.designerUIState.schemas[0].entityTypes[0],this.expr.addInjectedEntity(c.name,"Schema",c.name,D.InjectedType.EntityType))}var f=new Array;if(0<this.designerUIState.participantContext.length)try{for(var h=ue(this.designerUIState.participantContext),y=h.next();!y.done;y=h.next()){var g=y.value;f.push(g)}}catch(E){t={error:E}}finally{try{y&&!y.done&&(r=h["return"])&&r.call(h)}finally{if(t)throw t.error}}if(0<this.designerUIState.subActivityContext.length)try{for(var v=ue(this.designerUIState.subActivityContext),b=v.next();!b.done;b=v.next())!function(t){f.some(function(e){return e.key===t.key})||f.push(t)}(g=b.value)}catch(T){i={error:T}}finally{try{b&&!b.done&&(n=v["return"])&&n.call(v)}finally{if(i)throw i.error}}if(0<this.designerUIState.processVariableContext.length)try{for(var x=ue(this.designerUIState.processVariableContext),w=x.next();!w.done;w=x.next())!function(t){f.some(function(e){return e.key===t.key})||f.push(t)}(g=w.value)}catch(A){o={error:A}}finally{try{w&&!w.done&&(a=x["return"])&&a.call(x)}finally{if(o)throw o.error}}if(0<f.length)try{for(var P=ue(f),C=P.next();!C.done;C=P.next()){var I=C.value;this.expr.addContext(I)}}catch(k){s={error:k}}finally{try{C&&!C.done&&(l=P["return"])&&l.call(P)}finally{if(s)throw s.error}}0<this.users.length?this.expr.addExpressionText(this.users[0].varValue||this.users[0].performerId):this.expr.addExpressionText(""),this.expr.buildExpression().then(function(e){var t,r;if(e){var i=new xo(e,"","wf.VariableParticipantExpression");i.tag="expression",i.performerName=p.variableParticipantName(e),i.name=p.variableParticipantName(e),i.varType=p.curOrgType,"inSuite"===p.designerUIState.scene?i.relation=p.relationShipType:i.relation=p.personnelRelationShipTypes[0].value,""===p.variableParticipantName(e)?(p.message.info(p.localePipe.transform("component.variablePerformer.cantUseContext")),p.curOrgType=p.variableOrgTypes[0].value):(p.users=[i],p.user=i);try{for(var n=ue(p.designerUIState.participantContext),o=n.next();!o.done;o=n.next()){var a=o.value;if(0<=i.performerId.indexOf(a.key)){p.variableOrgTypes=[{name:p.localePipe.transform("component.variablePerformer.sys"),value:"Sys"}];break}p.variableOrgTypes=[{name:p.localePipe.transform("component.variablePerformer.sys"),value:"Sys"},{name:p.localePipe.transform("component.variablePerformer.administrative_staff"),value:"Administrative_staff"}],"inSuite"===p.designerUIState.scene&&(p.variableOrgTypes=[{name:p.localePipe.transform("component.variablePerformer.sys"),value:"Sys"},{name:p.localePipe.transform("component.variablePerformer.administrative_staff"),value:"Administrative_staff"},{name:p.localePipe.transform("component.variablePerformer.administrative_organization"),value:"Administrative_organization"}])}}catch(s){t={error:s}}finally{try{o&&!o.done&&(r=n["return"])&&r.call(n)}finally{if(t)throw t.error}}}else p.users=[],p.user=null,p.variableOrgTypes=[{name:p.localePipe.transform("component.variablePerformer.sys"),value:"Sys"},{name:p.localePipe.transform("component.variablePerformer.administrative_staff"),value:"Administrative_staff"}],"inSuite"===p.designerUIState.scene&&(p.variableOrgTypes=[{name:p.localePipe.transform("component.variablePerformer.sys"),value:"Sys"},{name:p.localePipe.transform("component.variablePerformer.administrative_staff"),value:"Administrative_staff"},{name:p.localePipe.transform("component.variablePerformer.administrative_organization"),value:"Administrative_organization"}]);0<f.length&&(p.expr.exprEntity.contextEntities=p.expr.exprEntity.contextEntities.filter(function(t){return!f.some(function(e){return e.key===t.key})}))})},Co.prototype.getPerformers=function(){return this.user&&(this.user.varValue=this.user.performerId||this.user.varValue,this.user.name=this.user.performerName||this.user.name,this.user.varType=this.curOrgType,this.user.relation=this.relationShipType,this.user.condition=this.condition||""),this.user},Co.prototype.variableParticipantName=function(e){var t,r,i,n;try{for(var o=ue(this.designerUIState.participantContext),a=o.next();!a.done;a=o.next()){var s=a.value;if(-1<e.indexOf(s.key))return"Sys"!==this.curOrgType?"":s.name}}catch(p){t={error:p}}finally{try{a&&!a.done&&(r=o["return"])&&r.call(o)}finally{if(t)throw t.error}}try{for(var l=ue(this.designerUIState.processVariableContext),c=l.next();!c.done;c=l.next()){s=c.value;if(-1<e.indexOf(s.key))return s.name}}catch(d){i={error:d}}finally{try{c&&!c.done&&(n=l["return"])&&n.call(l)}finally{if(i)throw i.error}}return JSON.parse(e).expr},Co.prototype.orgTypeChange=function(e){this.curOrgType=("Sys"===e?this.variableOrgTypes[0]:"Administrative_staff"===e?this.variableOrgTypes[1]:this.variableOrgTypes[2]).value,"inSuite"===this.designerUIState.scene?(this.getInSuiteField(e),this.relationShipType=null):this.relationShipType=this.personnelRelationShipTypes[0].value},Co.prototype.enabledStateChange=function(e){this.relationShipType=e.value},Co.prototype.getInSuiteField=function(e){var l=this;this.http.get("/api/runtime/wf/v1.0/dtProcDefs/getInSuiteFields/"+e).subscribe(function(e){var t,r;l.inSuiteField=[];try{for(var i=ue(e),n=i.next();!n.done;n=i.next()){var o=n.value,a={name:o.field_description,value:o.field};l.inSuiteField.push(a)}}catch(s){t={error:s}}finally{try{n&&!n.done&&(r=i["return"])&&r.call(i)}finally{if(t)throw t.error}}})},Co.decorators=[{type:b.Component,args:[{selector:"app-variable-performer",template:'<div class="d-flex flex-fill farris-overflow-y-auto p-md-2" style="background: #FFF;">\r\n  <div class="d-flex flex-fill farris-overflow-y-auto mx-3 my-2" style="border-radius:16px;border: 1.5px solid #F1F3F7;">\r\n  <form style="width: 100%;" >\r\n    <div class="d-flex m-2 flex-column w-100">\r\n      <div class="d-flex flex-column">\r\n        <div class="farris-form form-inline  farris-form-inline mr-5 my-2">\r\n          <div class="col-12 farris-group-auto my-4">\r\n            <div class="farris-group-wrap">\r\n              <div class="form-group farris-form-group">\r\n                <label class="col-form-label">\r\n                  <span class="farris-label-info text-danger">*</span>\r\n                  <span class="farris-label-text">{{\'component.variablePerformer.processVariables\'|wfLocale}}</span>\r\n                </label>\r\n                <div class="farris-input-wrap">\r\n                  <div #inputGroup class="input-group">\r\n                    <input type="text" class="form-control" [value]="users | variableName " name="users" [readOnly]="true" />\r\n                    <div class="input-group-append">\r\n                      <span [style.display]="showClearButton ? \'\' : \'none\'" class="input-group-text input-group-clear"\r\n                        (click)="clear($event)">\r\n                        <i class="f-icon modal_close"></i>\r\n                      </span>\r\n                      <span class="input-group-text" (click)="selectUsers($event)" style="background: #FFF;">\r\n                        <i class="f-icon f-icon-lookup"></i>\r\n                      </span>\r\n                    </div>\r\n                  </div>\r\n                  <div class="farris-feedback valid-feedback"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <ng-container *ngIf="userTypeButtonNeedShow">\r\n            <div class="col-12 farris-group-auto my-4">\r\n              <div class="farris-group-wrap">\r\n                <div class="form-group farris-form-group">\r\n                  <label class="col-form-label">\r\n                    <span class="farris-label-info text-danger">*</span>\r\n                    <span class="farris-label-text">{{\'component.variablePerformer.variableOrgTypes\'|wfLocale}}</span>\r\n                  </label>\r\n                  <div class="farris-input-wrap">\r\n                    <farris-radiogroup [data]="variableOrgTypes" [horizontal]="true"\r\n                                       [(ngModel)]="curOrgType" name="referObject"\r\n                                       (changeValue)="orgTypeChange($event)"\r\n                    ></farris-radiogroup>\r\n                    <div class="farris-feedback valid-feedback"></div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </ng-container>\r\n            <div class="col-12 farris-group-auto my-4">\r\n            <div class="farris-group-wrap">\r\n              <div class="form-group farris-form-group">\r\n                <label class="col-form-label">\r\n                  <span class="farris-label-info text-danger">*</span>\r\n                  <span class="farris-label-text">{{\'component.variablePerformer.relationShipType\'|wfLocale}}</span>\r\n                </label>\r\n                <div class="farris-input-wrap">\r\n                  <farris-combo-list [data]="scene !== \'inSuite\'?personnelRelationShipTypes:inSuiteField"\r\n                                     [idField]="\'value\'" [textField]="\'name\'" [valueField]="\'value\'" [readonly]="scene !== \'inSuite\'"\r\n                                     [(ngModel)]="relationShipType" name="relationShipObject" (valueChange)="enabledStateChange($event)"\r\n                  ></farris-combo-list>\r\n                  <div class="farris-feedback valid-feedback"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div class="d-flex flex-column" style="background: #FFF;">\r\n        <div class="farris-form form-inline farris-form-inline mr-5">\r\n          <div class="col-12 farris-group-auto my-4">\r\n            <div class="farris-group-wrap">\r\n              <div class="form-group farris-form-group">\r\n                <label class="col-form-label">\r\n                  <span class="farris-label-text">{{\'component.variablePerformer.condition\'|wfLocale}}</span>\r\n                </label>\r\n                <div class="farris-input-wrap">\r\n                  <div class="input-group">\r\n                    <input type="text" class="form-control" [(ngModel)]="condition" name="conditon" [readOnly]="true" />\r\n                    <div class="input-group-append">\r\n                      <span class="input-group-text" (click)="editConditon()" style="background: #FFF;">\r\n                        <i class="f-icon f-icon-lookup"></i>\r\n                      </span>\r\n                    </div>\r\n                  </div>\r\n                  <div class="farris-feedback valid-feedback"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </form>\r\n</div>\r\n</div>\r\n',providers:[x],styles:[""]}]}],Co.ctorParameters=function(){return[{type:a},{type:D.ExpressionService},{type:b.NgZone},{type:b.ChangeDetectorRef,decorators:[{type:b.Optional}]},{type:String,decorators:[{type:b.Inject,args:[b.LOCALE_ID]}]},{type:undefined,decorators:[{type:b.Inject,args:[o]}]},{type:x,decorators:[{type:b.Optional}]},{type:t.HttpService},{type:r.MessagerService}]},Co.propDecorators={cls:[{type:b.HostBinding,args:["class"]}],inputGroup:[{type:b.ViewChild,args:["inputGroup"]}]};var Po=Co;function Co(e,t,r,i,n,o,a,s,l){this.designerUIState=e,this.expr=t,this.ngZone=r,this.cdr=i,this.localeId=n,this.resources=o,this.localePipe=a,this.http=s,this.message=l,this.cls="d-flex flex-fill h-100",this.showClearButton=!1,this.editState=!0,this.bindingData={},this.inSuiteField=[],this.variableOrgTypes=[{name:this.localePipe.transform("component.variablePerformer.sys"),value:"Sys"},{name:this.localePipe.transform("component.variablePerformer.administrative_staff"),value:"Administrative_staff"}],this.userTypeButtonNeedShow=!1,this.personnelRelationShipTypes=[{name:this.localePipe.transform("component.variablePerformer.oneself"),value:"oneself"}],this.curOrgType=this.variableOrgTypes[0].value,this.relationShipType="inSuite"!==this.designerUIState.scene?this.personnelRelationShipTypes[0].value:null,this.scene=this.designerUIState.scene,this.users=[],this.user=new xo,this.localePipe=this.localePipe||new x(n,o)}So.prototype.ngOnInit=function(){},So.prototype.ngAfterViewInit=function(){var e,t=this;if(this.performer)switch(this.performer.type){case"wf.UserParticipantExpression":this.usersCmp.users=[],this.usersCmp.users.push(this.performer.value),this.usersCmp.multiSelect="edit"!==this.editState,this.performer.value.performerId&&"{"===this.performer.value.performerId.charAt(0)?this.http.get("/api/runtime/wf/v1.0/reportingOrgType/hasAdminOrg").subscribe(function(e){t.usersCmp.userTypeButtonNeedShow=e,t.usersCmp.userType="variable",t.usersCmp.curOrgType="Sys"===t.performer.value.orgType?"Sys":"Administrative_organization",t.usersCmp.condition=t.performer.value.condition;e=0<=t.performer.value.performerId.indexOf("GetContextParameter");t.usersCmp.variableOrgTypes=e?[{name:"系统用户",value:"Sys"}]:[{name:"系统用户",value:"Sys"},{name:"员工",value:"Administrative_organization"}]}):(this.usersCmp.userType="user",this.usersCmp.condition=this.performer.value.condition);break;case"wf.VariableParticipantExpression":this.varCmp.users=[],this.varCmp.users.push(this.performer.value),this.varCmp.user=this.performer.value,this.varCmp.editState="edit"!==this.editState,this.performer.value.varValue&&"{"===this.performer.value.varValue.charAt(0)&&(e=0<=this.performer.value.varValue.indexOf("GetContextParameter"),this.varCmp.variableOrgTypes=e?[{name:"用户ID",value:"Sys"}]:[{name:"用户ID",value:"Sys"},{name:"员工ID",value:"Administrative_staff"}],this.varCmp.curOrgType=this.performer.value.varType,this.varCmp.relationShipType=this.performer.value.relation,this.varCmp.condition=this.performer.value.condition);break;case"wf.PositionParticipantExpression":this.posiCmp.editState="edit"!==this.editState,this.posiCmp.position=Object.assign({},this.performer.value),this.posiCmp.performerName=this.posiCmp.position.performerName,"0"===this.posiCmp.position.positionType?this.posiCmp.newFilter={positionType:"0"}:this.posiCmp.newFilter={positionType:"1"};break;case"wf.ReportingLineParticipantExpression":this.reportingLineCmp.setReportingLineDataEntity=this.performer.value;break;case"wf.ComponentParticipantExpression":this.cmpCmp.component=this.performer.value;break;case"wf.MatrixParticipantExpression":this.matrixCmp.setMatrixDataEntity=this.performer.value;break;case"wf.ActivityExecutorParticipantExpression":this.activityExecutorCmp.activityExecutors=[],this.activityExecutorCmp.activityExecutors.push(this.performer.value),this.activityExecutorCmp.condition=this.performer.value.condition;break;case"wf.OrganizationParticipantExpression":this.performer.value.organizationLevel===vo&&"expression"===this.performer.value.tag&&(this.performer.value.organizationLevel=bo),this.organizationParticipant=this.performer.value,this.performer.value.OrganizationLevel===go&&"expression"===this.performer.value.tag&&this.performer.value.OrganizationLevel}this.performerType&&"wf.UserParticipantExpression"===this.performerType&&(this.usersCmp.userType="user")},So.prototype.valueChange=function(e){switch(e.value){case this.organizationLevelCollection[0].value:this.organizationParticipant.organizationId=this.organizationLevelCollection[0].orgId,this.organizationParticipant.organizationName=this.organizationLevelCollection[0].text,this.organizationParticipant.includeChildren=!0;break;case this.organizationLevelCollection[1].value:this.organizationParticipant.organizationId=this.organizationLevelCollection[1].orgId,this.organizationParticipant.organizationName=this.organizationLevelCollection[1].text;break;case this.organizationLevelCollection[2].value:this.organizationParticipant.organizationId=this.organizationLevelCollection[2].orgId,this.organizationParticipant.organizationName=this.organizationLevelCollection[2].text,this.organizationParticipant.includeChildren=!0,this.organizationParticipant.tag="expression"}},So.prototype.getPerformers=function(){var e,t=this.usersCmp?this.usersCmp.getPerformers():[],r=this.varCmp?this.varCmp.getPerformers():null,i=this.posiCmp?this.posiCmp.getPerformers():[],n=this.cmpCmp?this.cmpCmp.getPerformers():null,o=this.reportingLineCmp?this.reportingLineCmp.getPerformers():null,a=this.matrixCmp?this.matrixCmp.getPerformers():null,s=this.activityExecutorCmp?this.activityExecutorCmp.getPerformers():[],l=[],c=[];return t&&0<t.length&&(l=l.concat(t)),s&&0<s.length&&(c=c.concat(s)),"wf.OrganizationParticipantExpression"===this.performerType&&(this.organizationParticipant.organizationLevel===bo&&"expression"===this.organizationParticipant.tag&&(this.organizationParticipant.organizationLevel=vo),e=this.organizationParticipant),{userPerformers:l,variable:r,positions:i,component:n,reportingLine:o,matrix:a,activityExecutorPerformers:c,organizationParticipant:e}},So.prototype.editConditon=function(){var e,t,r,i,n,o,a,s,l=this;if(0<this.designerUIState.schemas.length){try{for(var c=ue(this.designerUIState.schemas),p=c.next();!p.done;p=c.next()){var d=p.value;this.expr.addSchema("Schema",d)}}catch(x){e={error:x}}finally{try{p&&!p.done&&(s=c["return"])&&s.call(c)}finally{if(e)throw e.error}}this.designerUIState.schemas[0].entityTypes&&0<this.designerUIState.schemas[0].entityTypes.length&&(s=this.designerUIState.schemas[0].entityTypes[0],this.expr.addInjectedEntity(s.name,"Schema",s.name,D.InjectedType.EntityType))}var u=new Array,u=this.designerUIState.addContext(u);if(0<this.designerUIState.subActivityContext.length)try{for(var m=ue(this.designerUIState.subActivityContext),f=m.next();!f.done;f=m.next())!function(t){u.some(function(e){return e.key===t.key})||u.push(t)}(f.value)}catch(w){t={error:w}}finally{try{f&&!f.done&&(r=m["return"])&&r.call(m)}finally{if(t)throw t.error}}if(0<this.designerUIState.activityComponentContext.length)try{for(var h=ue(this.designerUIState.activityComponentContext),y=h.next();!y.done;y=h.next())!function(t){u.some(function(e){return e.key===t.key})||u.push(t)}(y.value)}catch(P){i={error:P}}finally{try{y&&!y.done&&(n=h["return"])&&n.call(h)}finally{if(i)throw i.error}}if(0<u.length)try{for(var g=ue(u),v=g.next();!v.done;v=g.next()){var b=v.value;this.expr.addContext(b)}}catch(C){o={error:C}}finally{try{v&&!v.done&&(a=g["return"])&&a.call(g)}finally{if(o)throw o.error}}this.expr.setEditPattern(D.ExprEditMode.Conditional),this.expr.addExpressionText(this.organizationParticipant.condition),this.expr.buildExpression().then(function(e){l.organizationParticipant.condition=e,0<u.length&&(l.expr.exprEntity.contextEntities=l.expr.exprEntity.contextEntities.filter(function(t){return!u.some(function(e){return e.key===t.key})}))})},So.prototype.editOrganizationId=function(){var e,t,r,i,n,o,a,s,l=this;if(0<this.designerUIState.schemas.length){try{for(var c=ue(this.designerUIState.schemas),p=c.next();!p.done;p=c.next()){var d=p.value;this.expr.addSchema("Schema",d)}}catch(x){e={error:x}}finally{try{p&&!p.done&&(s=c["return"])&&s.call(c)}finally{if(e)throw e.error}}this.designerUIState.schemas[0].entityTypes&&0<this.designerUIState.schemas[0].entityTypes.length&&(s=this.designerUIState.schemas[0].entityTypes[0],this.expr.addInjectedEntity(s.name,"Schema",s.name,D.InjectedType.EntityType))}var u=new Array,u=this.designerUIState.addContext(u);if(0<this.designerUIState.subActivityContext.length)try{for(var m=ue(this.designerUIState.subActivityContext),f=m.next();!f.done;f=m.next())!function(t){u.some(function(e){return e.key===t.key})||u.push(t)}(f.value)}catch(w){t={error:w}}finally{try{f&&!f.done&&(r=m["return"])&&r.call(m)}finally{if(t)throw t.error}}if(0<this.designerUIState.activityComponentContext.length)try{for(var h=ue(this.designerUIState.activityComponentContext),y=h.next();!y.done;y=h.next())!function(t){u.some(function(e){return e.key===t.key})||u.push(t)}(y.value)}catch(P){i={error:P}}finally{try{y&&!y.done&&(n=h["return"])&&n.call(h)}finally{if(i)throw i.error}}if(0<u.length)try{for(var g=ue(u),v=g.next();!v.done;v=g.next()){var b=v.value;this.expr.addContext(b)}}catch(C){o={error:C}}finally{try{v&&!v.done&&(a=g["return"])&&a.call(g)}finally{if(o)throw o.error}}this.expr.setEditPattern(D.ExprEditMode.Advanced),this.expr.addExpressionText(this.organizationParticipant.organizationId),this.expr.buildExpression().then(function(e){l.organizationParticipant.organizationId=e,0<u.length&&(l.expr.exprEntity.contextEntities=l.expr.exprEntity.contextEntities.filter(function(t){return!u.some(function(e){return e.key===t.key})}))})},So.decorators=[{type:b.Component,args:[{selector:"app-performer-edit",template:'<app-user-performer *ngIf="performerType === \'wf.UserParticipantExpression\'"></app-user-performer>\r\n<app-variable-performer *ngIf="performerType === \'wf.VariableParticipantExpression\'"></app-variable-performer>\r\n<app-position-performer *ngIf="performerType === \'wf.PositionParticipantExpression\'"></app-position-performer>\r\n<app-reporting-line *ngIf="performerType === \'wf.ReportingLineParticipantExpression\'"></app-reporting-line>\r\n<app-matrix-performer *ngIf="performerType === \'wf.MatrixParticipantExpression\'"></app-matrix-performer>\r\n<app-activity-handler-performer\r\n  *ngIf="performerType === \'wf.ActivityExecutorParticipantExpression\'"></app-activity-handler-performer>\r\n<app-component-performer [component]="component" style="background: #FFF;"\r\n  *ngIf="performerType === \'wf.ComponentParticipantExpression\'"></app-component-performer>\r\n\r\n<div *ngIf="performerType === \'wf.OrganizationParticipantExpression\'" class="f-page">\r\n  <div class="f-utils-fill-flex-column farris-split-section m-2 h-100" style="background: #FFF;">\r\n    <div class="f-utils-fill-flex-column farris-split-section mx-1 h-100"\r\n      style="border-radius:16px;border: 1.5px solid #F1F3F7;">\r\n      <form style="width: 100%; height: 100%;">\r\n        <div class="d-flex m-2 flex-column w-100">\r\n          <div class="d-flex flex-column" style="height: 120px;">\r\n            <div class="farris-form form-inline  farris-form-inline mr-5 my-2 pt-3">\r\n              <div class="col-12 farris-group-auto">\r\n                <div class="farris-group-wrap">\r\n                  <div class="form-group farris-form-group">\r\n                    <label class="col-form-label">\r\n                      <span class="farris-label-text">{{\'component.participant.alternativeScope\'|wfLocale}}</span>\r\n                    </label>\r\n                    <div class="farris-input-wrap ml-1">\r\n                      <farris-combo-list [panelHeight]="100" [(ngModel)]="organizationParticipant.organizationLevel"\r\n                        name="actionScope" [idField]="\'value\'" [enableClear]="false" [textField]="\'text\'"\r\n                        [valueField]="\'value\'" [data]="organizationLevelCollection" [readonly]="false"\r\n                        (valueChange)="valueChange($event)">\r\n                      </farris-combo-list>\r\n                      <div class="farris-feedback valid-feedback"></div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              \x3c!-- 单位/部门参与者支持单位ID --\x3e\r\n              <div *ngIf="organizationParticipant.organizationLevel===organizationLevelCollection[2].value"\r\n                class="col-12 farris-group-auto my-3 pr-3">\r\n                <div class="farris-group-wrap">\r\n                  <div class="form-group farris-form-group">\r\n                    <label class="col-form-label">\r\n                      <span class="farris-label-text">{{\'component.participant.orgId\'|wfLocale}}</span>\r\n                    </label>\r\n                    <div class="farris-input-wrap ml-1">\r\n                      <div class="input-group">\r\n                        <input type="text" class="form-control" [(ngModel)]="organizationParticipant.organizationId"\r\n                          name="organizationId" [readOnly]="true" />\r\n                        <div class="input-group-append">\r\n                          <span class="input-group-text" (click)="editOrganizationId()" style="background: #FFF;">\r\n                            <i class="f-icon f-icon-lookup"></i>\r\n                          </span>\r\n                        </div>\r\n                      </div>\r\n                      <div class="farris-feedback valid-feedback"></div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <div *ngIf="organizationParticipant.organizationLevel!=organizationLevelCollection[0].value"\r\n                class="col-12 farris-group-auto my-3 pr-5">\r\n                <div class="farris-group-wrap">\r\n                  <div class="form-group farris-form-group">\r\n                    <label class="col-form-label">\r\n                      <span class="farris-label-text">{{\'component.participant.includeChildren\'|wfLocale}}</span>\r\n                    </label>\r\n                    <div class="farris-input-wrap ml-1">\r\n                      <farris-switch [(ngModel)]="organizationParticipant.includeChildren"\r\n                        name="includeChildren"></farris-switch>\r\n                      <div class="farris-feedback valid-feedback"></div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class="d-flex flex-column m-2 w-100">\r\n            <div class="farris-form form-inline farris-form-inline mr-5">\r\n              <div class="col-12 farris-group-auto my-4" style="padding-left: 6px;padding-right: 21px;">\r\n                <div class="farris-group-wrap">\r\n                  <div class="form-group farris-form-group">\r\n                    <label class="col-form-label">\r\n                      <span class="farris-label-text">{{\'component.participant.conditon\'|wfLocale}}</span>\r\n                    </label>\r\n                    <div class="farris-input-wrap">\r\n                      <div class="input-group">\r\n                        <input type="text" class="form-control" [(ngModel)]="organizationParticipant.condition"\r\n                          name="conditon" [readOnly]="true" />\r\n                        <div class="input-group-append">\r\n                          <span class="input-group-text" (click)="editConditon()" style="background: #FFF;">\r\n                            <i class="f-icon f-icon-lookup"></i>\r\n                          </span>\r\n                        </div>\r\n                      </div>\r\n                      <div class="farris-feedback valid-feedback"></div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </form>\r\n    </div>\r\n  </div>\r\n</div>',providers:[x],styles:[""]}]}],So.ctorParameters=function(){return[{type:a},{type:D.ExpressionService},{type:t.HttpService},{type:String,decorators:[{type:b.Inject,args:[b.LOCALE_ID]}]},{type:undefined,decorators:[{type:b.Inject,args:[o]}]},{type:x,decorators:[{type:b.Optional}]}]},So.propDecorators={cls:[{type:b.HostBinding,args:["class"]}],display:[{type:b.Input}],usersCmp:[{type:b.ViewChild,args:[zn]}],varCmp:[{type:b.ViewChild,args:[Po]}],posiCmp:[{type:b.ViewChild,args:[ei]}],cmpCmp:[{type:b.ViewChild,args:[_n]}],reportingLineCmp:[{type:b.ViewChild,args:[Zn]}],matrixCmp:[{type:b.ViewChild,args:[so]}],activityExecutorCmp:[{type:b.ViewChild,args:[uo]}]};var Io=So;function So(e,t,r,i,n,o){this.designerUIState=e,this.expr=t,this.http=r,this.localeId=i,this.resources=n,this.localePipe=o,this.cls="farris-main-area flex-column",this.tab="user",this.display=!0,this.organizationLevelCollection=[{value:"UNIT",text:this.localePipe.transform("component.participant.currentUnit"),orgId:"currentUnit"},{value:"DEPARTMENT",text:this.localePipe.transform("component.participant.currentDepartment"),orgId:"currentDepartment"},{value:"VARORGANIZATION",text:this.localePipe.transform("component.participant.variableOrganization"),orgId:""}],this.localePipe=this.localePipe||new x(i,n),this.organizationParticipant=new ho,this.organizationParticipant.actionScope=yo,this.organizationParticipant.organizationLevel=go,this.organizationParticipant.organizationId="currentDepartment",this.organizationParticipant.organizationName=this.localePipe.transform("component.participant.currentDepartment"),this.organizationParticipant.includeChildren=!1,this.organizationParticipant.tag="variable"}Object.defineProperty(h.prototype,"value",{set:function(e){e&&(this.exclusionPerformers=e.ExclusionPerformers,this.noPerformerStrategy=e.NoPerformerStrategy,this.historicFirst=e.HistoricFirst,this.automaticPerformers=e.automaticPerformers)},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"exclusionPerformers",{set:function(e){e&&("string"==typeof e?(this.excludeProcInstCreator=-1<e.indexOf("procInstCreator"),this.excludePreActExecutors=-1<e.indexOf("preActExecutors")):(this.excludeProcInstCreator=-1<e.findIndex(function(e){return"procInstCreator"===e}),this.excludePreActExecutors=-1<e.findIndex(function(e){return"preActExecutors"===e}),this.excludeAllPassExecutors=-1<e.findIndex(function(e){return"allPassExecutors"===e}),this.excludeExprPerformer=e.find(function(e){return-1<e.indexOf("expr")}),null!=this.excludeExprPerformer&&(this.excludeExprPerformer.startsWith("Sys#")||this.excludeExprPerformer.startsWith("Administrative_staff#"))&&(e=this.excludeExprPerformer.split("#"),this.exprPerformerType=e[0],this.excludeExprPerformer=e[1])))},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"automaticPerformers",{set:function(e){e&&0<e.length&&(this.autoProcInstCreator=-1<e.findIndex(function(e){return"procInstCreator"===e}),this.autoPreActExecutors=-1<e.findIndex(function(e){return"preActExecutors"===e}),this.autoAllPassExecutors=-1<e.findIndex(function(e){return"allPassExecutors"===e}))},enumerable:!0,configurable:!0}),h.prototype.ngOnInit=function(){this.performerOptionsLocation=this.editorParams.location},h.prototype.ngAfterViewInit=function(){var e=this;this.ngZone.runOutsideAngular(function(){e.inputGroup.nativeElement.addEventListener("mouseenter",e.onMouseEnter.bind(e)),e.inputGroup.nativeElement.addEventListener("mouseleave",e.onMouseLeave.bind(e))})},h.prototype.onMouseEnter=function(e){this.showClearButton=!0,this.showClearButton&&this.toggleClearIcon(e,!0)},h.prototype.onMouseLeave=function(e){this.showClearButton=!1,this.toggleClearIcon(e,!1)},h.prototype.toggleClearIcon=function(e,t){t=(t=void 0===t?!1:t)?"":"none",e=e.target.querySelector(".input-group-clear");e&&(e.style.display=t)},h.prototype.clickOK=function(){var e={ExclusionPerformers:this.getExclusionPerformers(),NoPerformerStrategy:this.noPerformerStrategy,HistoricFirst:this.historicFirst,automaticPerformers:this.getAutoPerformers()};this.submitModal.emit({value:e,parameters:null})},h.prototype.cancel=function(){this.closeModal.emit()},h.prototype.excludeProcInstCreatorClick=function(e){this.excludeProcInstCreator&&this.autoProcInstCreator&&(this.autoProcInstCreator=!1)},h.prototype.excludePreActExecutorsClick=function(e){var t=this;!0===this.autoAllPassExecutors&&!0===this.excludePreActExecutors?this.message.info(this.localePipe.transform("component.performerOptions.exclusionNotAllowed"),function(){t.excludePreActExecutors=!1}):this.excludePreActExecutors&&this.autoPreActExecutors&&(this.autoPreActExecutors=!1)},h.prototype.excludeAllPassExecutorsClick=function(e){this.excludeAllPassExecutors&&(this.autoPreActExecutors&&(this.autoPreActExecutors=!1),this.autoAllPassExecutors)&&(this.autoAllPassExecutors=!1)},h.prototype.autoProcInstCreatorClick=function(e){var t=this;this.designerState.propertyData.AssignStrategy===this.designerState.assignIterator[2].key&&!0===this.autoProcInstCreator?this.message.info(this.localePipe.transform("component.performerOptions.approvalNotAllowedAsSet"),function(){t.autoProcInstCreator=!1}):this.autoProcInstCreator&&this.excludeProcInstCreator&&(this.excludeProcInstCreator=!1)},h.prototype.autoPreActExecutorsClick=function(e){var t=this;this.designerState.propertyData.AssignStrategy===this.designerState.assignIterator[2].key&&!0===this.autoPreActExecutors?this.message.info(this.localePipe.transform("component.performerOptions.approvalNotAllowed"),function(){t.autoPreActExecutors=!1}):!0===this.excludeAllPassExecutors&&!0===this.autoPreActExecutors?this.message.info(this.localePipe.transform("component.performerOptions.approvalNotAllowedAsSet"),function(){t.autoPreActExecutors=!1}):this.autoPreActExecutors&&this.excludePreActExecutors&&(this.excludePreActExecutors=!1)},h.prototype.autoAllPassExecutorsClick=function(e){var t=this;this.designerState.propertyData.AssignStrategy===this.designerState.assignIterator[2].key&&!0===this.autoAllPassExecutors?this.message.info(this.localePipe.transform("component.performerOptions.allocationStrategyIsCollect"),function(){t.autoAllPassExecutors=!1}):this.autoAllPassExecutors&&(this.excludeAllPassExecutors&&(this.excludeAllPassExecutors=!1),this.excludePreActExecutors)&&(this.excludePreActExecutors=!1)},h.prototype.getPerformerOptions=function(){return{ExclusionPerformers:this.getExclusionPerformers(),NoPerformerStrategy:this.noPerformerStrategy,HistoricFirst:this.historicFirst,automaticPerformers:this.getAutoPerformers()}},h.prototype.getExclusionPerformers=function(){var e=[];return this.excludeProcInstCreator&&e.push("procInstCreator"),this.excludePreActExecutors&&e.push("preActExecutors"),this.excludeAllPassExecutors&&e.push("allPassExecutors"),this.excludeExprPerformer&&e.push(this.exprPerformerType+"#"+this.excludeExprPerformer),e},h.prototype.getAutoPerformers=function(){var e=new Array;return this.autoProcInstCreator&&e.push("procInstCreator"),this.autoPreActExecutors&&e.push("preActExecutors"),this.autoAllPassExecutors&&e.push("allPassExecutors"),e},h.prototype.openExprEditor=function(){var e,t,r,i,n,o,a=this;if(this.expr.setEditPattern(D.ExprEditMode.Advanced),0<this.designerState.schemas.length){try{for(var s=ue(this.designerState.schemas),l=s.next();!l.done;l=s.next()){var c=l.value;this.expr.addSchema("Schema",c)}}catch(y){e={error:y}}finally{try{l&&!l.done&&(o=s["return"])&&o.call(s)}finally{if(e)throw e.error}}this.designerState.schemas[0].entityTypes&&0<this.designerState.schemas[0].entityTypes.length&&(o=this.designerState.schemas[0].entityTypes[0],this.expr.addInjectedEntity(o.name,"Schema",o.name,D.InjectedType.EntityType))}var p=new Array,p=this.designerState.addContext(p);if(0<this.designerState.subActivityContext.length)try{for(var d=ue(this.designerState.subActivityContext),u=d.next();!u.done;u=d.next())!function(t){p.some(function(e){return e.key===t.key})||p.push(t)}(u.value)}catch(g){t={error:g}}finally{try{u&&!u.done&&(r=d["return"])&&r.call(d)}finally{if(t)throw t.error}}if(0<p.length)try{for(var m=ue(p),f=m.next();!f.done;f=m.next()){var h=f.value;this.expr.addContext(h)}}catch(v){i={error:v}}finally{try{f&&!f.done&&(n=m["return"])&&n.call(m)}finally{if(i)throw i.error}}this.expr.addExpressionText(this.excludeExprPerformer),this.expr.buildExpression().then(function(e){a.excludeExprPerformer=e,0<p.length&&(a.expr.exprEntity.contextEntities=a.expr.exprEntity.contextEntities.filter(function(t){return!p.some(function(e){return e.key===t.key})}))})},h.prototype.orgTypeChange=function(e){"Sys"===e?this.exprPerformerType=this.variableOrgTypes[0].value:"Administrative_staff"===e&&(this.exprPerformerType=this.variableOrgTypes[1].value)},h.prototype.clear=function(){this.excludeExprPerformer=""},h.decorators=[{type:b.Component,args:[{selector:"app-performer-options",template:'<div class="f-page">\r\n  <div class="f-utils-fill-flex-column h-100">\r\n    <section class="f-utils-fill-flex-column h-100 mx-3" style="border-radius:16px;border: 1.5px solid #F1F3F7;">\r\n      <div class="f-utils-fill-flex-column h-100 pl-3">\r\n        <perfect-scrollbar [config]="{}">\r\n          <form class="h-100" style="overflow-x: hidden;">\r\n            <div class="f-form-layout farris-form pb-4">\r\n              <div class="farris-form form-inline farris-form-inline">\r\n                <div class="mx-2 mt-3">\r\n                  <div class="title-content">\r\n                    <h5 class="title-text">{{\'component.performerOptions.advancedOptions\'|wfLocale}}</h5><span class="title-line"></span>\r\n                  </div>\r\n                </div>\r\n                <div class="col-12 farris-group-auto my-2" style="margin-left: 100px;">\r\n                  <div class="farris-group-wrap pl-3">\r\n                    <div class="form-group farris-form-group">\r\n                      <div class="farris-input-wrap">\r\n                        <div class="custom-control custom-checkbox">\r\n                          <input class="custom-control-input" name="historicFirst" type="checkbox" id="historicFirst"\r\n                            [(ngModel)]="historicFirst" />\r\n                          <label class="custom-control-label" for="historicFirst">{{\'component.performerOptions.historicFirst\'|wfLocale}}</label>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n                <div class="col-12 farris-group-auto mt-3 pr-4">\r\n                  <div class="farris-group-wrap f-form-lable-auto pl-3">\r\n                    <div class="form-group farris-form-group">\r\n                      <label class="col-form-label">\r\n                        <span class="farris-label-text">{{\'component.performerOptions.noPerformerStrategy\'|wfLocale}}</span>\r\n                      </label>\r\n                      <div class="farris-input-wrap">\r\n                        <farris-combo-list [(ngModel)]="noPerformerStrategy" name="noPerformerStrategy" [idField]="\'value\'"\r\n                          [textField]="\'text\'" [valueField]="\'value\'" [data]="noPerformerStrategyList" [panelHeight]="60">\r\n                        </farris-combo-list>\r\n                        <div class="farris-feedback valid-feedback"></div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n                <div class="mx-2 mt-3">\r\n                  <div class="title-content">\r\n                    <h5 class="title-text">{{\'component.performerOptions.excludeProcInstCreator\'|wfLocale}}</h5><span class="title-line"></span>\r\n                  </div>\r\n                </div>\r\n                <div class="col-12 farris-group-auto my-2" style="margin-left: 100px;">\r\n                  <div class="farris-group-wrap pl-3">\r\n                    <div class="form-group farris-form-group">\r\n                      <div class="farris-input-wrap">\r\n                        <div class="custom-control custom-checkbox">\r\n                          <input class="custom-control-input" name="excludeProcInstCreator" type="checkbox" id="excludeProcInstCreator"\r\n                            [(ngModel)]="excludeProcInstCreator" (change)="excludeProcInstCreatorClick($event)" />\r\n                          <label class="custom-control-label" for="excludeProcInstCreator">{{\'component.performerOptions.defaultNotParticipate\'|wfLocale}}</label>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n                <div class="col-12 farris-group-auto my-2" style="margin-left: 100px;">\r\n                  <div class="farris-group-wrap pl-3">\r\n                    <div class="form-group farris-form-group">\r\n                      <div class="farris-input-wrap">\r\n                        <div class="custom-control custom-checkbox">\r\n                          <input class="custom-control-input" name="excludePreActExecutors" type="checkbox" id="excludePreActExecutors"\r\n                            [(ngModel)]="excludePreActExecutors" (change)="excludePreActExecutorsClick($event)"/>\r\n                          <label class="custom-control-label" for="excludePreActExecutors">{{\'component.performerOptions.excludePreActExecutors\'|wfLocale}}</label>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n                <div class="col-12 farris-group-auto my-2" style="margin-left: 100px;">\r\n                  <div class="farris-group-wrap pl-3">\r\n                    <div class="form-group farris-form-group">\r\n                      <div class="farris-input-wrap">\r\n                        <div class="custom-control custom-checkbox">\r\n                          <input class="custom-control-input" name="excludeAllPassExecutors" type="checkbox" id="excludeAllPassExecutors"\r\n                            [(ngModel)]="excludeAllPassExecutors" (change)="excludeAllPassExecutorsClick($event)"/>\r\n                          <label class="custom-control-label" for="excludeAllPassExecutors">{{\'component.performerOptions.excludeAllPassExecutors\'|wfLocale}}</label>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n                <div class="col-12 farris-group-auto pr-4 my-2">\r\n                  <div class="farris-group-wrap f-form-lable-auto pl-3">\r\n                    <div class="form-group farris-form-group">\r\n                      <label class="col-form-label">\r\n                        <span class="farris-label-text">{{\'component.performerOptions.excludeExprPerformer\'|wfLocale}}</span>\r\n                      </label>\r\n                      <div class="farris-input-wrap">\r\n                        <div #inputGroup class="input-group">\r\n                          <input type="text" class="form-control" [(ngModel)]="excludeExprPerformer" name="excludeExprPerformer"\r\n                            [readOnly]="true" />\r\n                          <div class="input-group-append">\r\n                            <span [style.display]="showClearButton ? \'\' : \'none\'" class="input-group-text input-group-clear"\r\n                              (click)="clear()">\r\n                              <i class="f-icon modal_close"></i>\r\n                            </span>\r\n                            <span class="input-group-text" (click)="openExprEditor()" style="background: #FFF;">\r\n                              <i class="f-icon f-icon-lookup"></i>\r\n                            </span>\r\n                          </div>\r\n                        </div>\r\n                        <div class="farris-feedback valid-feedback"></div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n                <div *ngIf="excludeExprPerformer != null || excludeExprPerformer != \'\'">\r\n                  <div class="col-9 farris-group-auto my-2 pr-4">\r\n                    <div class="farris-group-wrap f-form-lable-auto pl-3">\r\n                      <div class="form-group farris-form-group">\r\n                        <label class="col-form-label">\r\n                          <span class="farris-label-text">{{\'component.performerOptions.variableOrgTypes\'|wfLocale}}</span>\r\n                        </label>\r\n                        <div class="farris-input-wrap" style="margin-bottom: 5px;">\r\n                          <div class="custom-control custom-checkbox">\r\n                            <farris-radiogroup [data]="variableOrgTypes" [horizontal]="true" [(ngModel)]="exprPerformerType" name="referObject"\r\n                              (changeValue)="orgTypeChange($event)"></farris-radiogroup>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n                <div *ngIf="performerOptionsLocation!=\'autoActivity\'">\r\n                <div class="mx-2 mt-3">\r\n                  <div class="title-content">\r\n                    <h5 class="title-text">{{\'component.performerOptions.automaticApprovalOptions\'|wfLocale}}</h5><span class="title-line"></span>\r\n                  </div>\r\n                </div>\r\n                <div class="col-12 farris-group-auto my-2" style="margin-left: 100px;">\r\n                  <div class="farris-group-wrap pl-3">\r\n                    <div class="form-group farris-form-group">\r\n                      <div class="farris-input-wrap">\r\n                        <div class="custom-control custom-checkbox">\r\n                          <input class="custom-control-input" name="autoProcInstCreator" type="checkbox" id="autoProcInstCreator"\r\n                            [(ngModel)]="autoProcInstCreator" (change)="autoProcInstCreatorClick($event)" />\r\n                          <label class="custom-control-label" for="autoProcInstCreator">{{\'component.performerOptions.autoProcInstCreator\'|wfLocale}}</label>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n                <div class="col-12 farris-group-auto my-2" style="margin-left: 100px;">\r\n                  <div class="farris-group-wrap pl-3">\r\n                    <div class="form-group farris-form-group">\r\n                      <div class="farris-input-wrap">\r\n                        <div class="custom-control custom-checkbox">\r\n                          <input class="custom-control-input" name="autoPreActExecutors" type="checkbox" id="autoPreActExecutors"\r\n                            [(ngModel)]="autoPreActExecutors" (change)="autoPreActExecutorsClick($event)" />\r\n                          <label class="custom-control-label" for="autoPreActExecutors">{{\'component.performerOptions.autoPreActExecutors\'|wfLocale}}</label>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n                <div class="col-12 farris-group-auto my-2" style="margin-left: 100px;">\r\n                  <div class="farris-group-wrap pl-3">\r\n                    <div class="form-group farris-form-group">\r\n                      <div class="farris-input-wrap">\r\n                        <div class="custom-control custom-checkbox">\r\n                          <input class="custom-control-input" name="autoAllPassExecutors" type="checkbox" id="autoAllPassExecutors"\r\n                            [(ngModel)]="autoAllPassExecutors" (change)="autoAllPassExecutorsClick($event)" />\r\n                          <label class="custom-control-label" for="autoAllPassExecutors">{{\'component.performerOptions.autoAllPassExecutors\'|wfLocale}}</label>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              </div>\r\n            </div>\r\n          </form>\r\n        </perfect-scrollbar>\r\n\r\n      </div>\r\n    </section>\r\n  </div>\r\n</div>\r\n\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type="button" class="btn btn-secondary btn-sm mx-2" (click)="cancel()">{{\'component.performerOptions.cancel\'|wfLocale}}</button>\r\n  <button type="button" class="btn btn-primary btn-sm mx-2" (click)="clickOK()">{{\'component.performerOptions.clickOK\'|wfLocale}}</button>\r\n</ng-template>\r\n',providers:[x],styles:[".item-header{padding:1rem}.item{padding:.5rem 5rem}.title-content{color:#000;display:inline-flex;align-items:center;line-height:1.375rem;position:relative;overflow:hidden;padding:0 0 0 1rem;min-width:450px}.title-content ::before{content:'';width:.25rem;height:1.125rem;background:#59a1ff;border-radius:1px;position:absolute;top:50%;left:0;margin-top:-.5625rem}.title-text{font-size:1rem;line-height:1.375rem;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;margin-bottom:0;margin-right:10px}.title-line{flex-grow:1;border-bottom:1px dashed rgba(0,0,0,.1)}"]}]}],h.ctorParameters=function(){return[{type:b.NgZone},{type:a},{type:D.ExpressionService},{type:r.MessagerService},{type:b.ChangeDetectorRef,decorators:[{type:b.Optional}]},{type:String,decorators:[{type:b.Inject,args:[b.LOCALE_ID]}]},{type:undefined,decorators:[{type:b.Inject,args:[o]}]},{type:x,decorators:[{type:b.Optional}]}]},h.propDecorators={cls:[{type:b.HostBinding,args:["class"]}],editorParams:[{type:b.Input}],closeModal:[{type:b.Output}],submitModal:[{type:b.Output}],modalFooter:[{type:b.ViewChild,args:["iconSelectFooter"]}],value:[{type:b.Input}],exclusionPerformers:[{type:b.Input}],inputGroup:[{type:b.ViewChild,args:["inputGroup"]}]};var Eo=h;function h(e,t,r,i,n,o,a,s){this.ngZone=e,this.designerState=t,this.expr=r,this.message=i,this.cdr=n,this.localeId=o,this.resources=a,this.localePipe=s,this.cls="farris-main-area flex-column",this.editorParams={},this.closeModal=new b.EventEmitter,this.submitModal=new b.EventEmitter,this.performerOptionsLocation="",this.showClearButton=!1,this.historicFirst=!1,this.excludeProcInstCreator=!1,this.excludePreActExecutors=!1,this.excludeAllPassExecutors=!1,this.autoProcInstCreator=!1,this.autoPreActExecutors=!1,this.autoAllPassExecutors=!1,this.noPerformerStrategyList=[{text:this.localePipe.transform("component.performerOptions.leave"),value:"leave"},{text:this.localePipe.transform("component.performerOptions.throwException"),value:"throwException"}],this.variableOrgTypes=[{name:this.localePipe.transform("component.performerOptions.sys"),value:"Sys"},{name:this.localePipe.transform("component.performerOptions.administrative_staff"),value:"Administrative_staff"}],this.exclusionPerformersOptions=[{value:"procInstCreator",name:this.localePipe.transform("component.performerOptions.procInstCreator")},{value:"preActExecutors",name:this.localePipe.transform("component.performerOptions.preActExecutors")},{value:"allPassExecutors",name:this.localePipe.transform("component.performerOptions.allPassExecutors")}],this.exprPerformerType=this.variableOrgTypes[0].value,this.noPerformerStrategy=this.noPerformerStrategyList[0].value,this.modalConfig={title:this.localePipe.transform("component.performerOptions.performerOptions"),width:760,height:606,showButtons:!0},this.localePipe=this.localePipe||new x(o,a)}Ao.prototype.convertTo=function(e){return this.localePipe.transform("component.performerOptions.set")};var To=Ao;function Ao(e){this.localePipe=e}Object.defineProperty(y.prototype,"value",{set:function(e){var t=this;e.performers&&0<e.performers.length&&(this.uistate.performerInfo.performers=e.performers,this.uistate.performersList=this.uistate.performersList.concat(e.performers),this.uistate.performersList.map(function(e){return e.description=t.performerDescription(e)})),e.variablePerformers&&0<e.variablePerformers.length&&(this.uistate.performerInfo.variablePerformers=e.variablePerformers,this.uistate.performersList=this.uistate.performersList.concat(e.variablePerformers),this.uistate.performersList.map(function(e){return e.description=t.performerDescription(e)})),e.components&&0<e.components.length&&(this.uistate.performerInfo.components=e.components,e.components.forEach(function(e){t.uistate.performersList.push({id:e.id,type:"wf.ComponentParticipantExpression",performerName:e.name,description:t.componentDescription(e),condition:e.condition})})),e.reportingLines&&0<e.reportingLines.length&&(this.uistate.performerInfo.reportingLines=e.reportingLines,e.reportingLines.forEach(function(e){t.uistate.performersList.push({id:e.id,type:"wf.ReportingLineParticipantExpression",performerName:e.reportingLineDefName+"-"+e.dimension,description:t.reportingLineDescription(e),condition:e.condition})})),e.activityExecutors&&0<e.activityExecutors.length&&(this.uistate.performerInfo.activityExecutors=e.activityExecutors,e.activityExecutors.forEach(function(e){t.uistate.performersList.push({id:e.id,type:"wf.ActivityExecutorParticipantExpression",performerName:"<"+e.activityDefName+">活动办理人",description:"<"+e.activityDefName+">活动办理人",condition:e.condition})})),e.matrixParticipants&&0<e.matrixParticipants.length&&(this.uistate.performerInfo.matrixParticipants=e.matrixParticipants,e.matrixParticipants.forEach(function(e){t.uistate.performersList.push({id:e.id,type:"wf.MatrixParticipantExpression",performerName:e.matrixDefName+"-"+e.dataFieldAlias,description:t.matrixDescription(e),condition:e.condition})})),e.organizationParticipants&&0<e.organizationParticipants.length&&(this.uistate.performerInfo.organizationParticipants=e.organizationParticipants,e.organizationParticipants.forEach(function(e){t.uistate.performersList.push({id:e.id,type:"wf.OrganizationParticipantExpression",performerName:e.organizationName,description:e.organizationName+"，"+(e.includeChildren?"包含下级":"不包含下级"),condition:e.condition})})),e.options&&(this.uistate.performerInfo.options=e.options),this.uistate.performerInfo.isAllScope=e.isAllScope},enumerable:!0,configurable:!0}),y.prototype.ngOnInit=function(){var t=this;this.type=this.editorParams.type,this.nodeType=this.editorParams.nodeType,this.getMatrixConfig().subscribe(function(e){e&&"false"===e.currentValue&&(t.display=!1)})},y.prototype.switchChange=function(e){e&&this.uistate.clearPerformer()},y.prototype.addPerformer=function(e){this.editState="new";var t=this.resolver.resolveComponentFactory(Io),t=(this.compRef=t.create(this.injector),this.compRef.instance.display=this.display,this.compRef.instance.performerType=e,{title:"参与者选择",width:700,height:400,buttons:this.editFooter,showButtons:!0});this.editDialog=this.modalService.show(this.compRef,t),this.dropDownEl.close()},y.prototype.edit=function(){var t=this;if(this.editState="edit",this.uistate.curPerformer){var r={title:"参与者选择",width:700,height:400,buttons:this.editFooter,showButtons:!0},e=this.resolver.resolveComponentFactory(Io);switch(this.compRef=e.create(this.injector),this.compRef.instance.performerType=this.uistate.curPerformer.type,this.uistate.curPerformer.type){case"wf.PositionParticipantExpression":this.compRef.instance.performer={type:"wf.PositionParticipantExpression",value:this.uistate.performerInfo.performers.find(function(e){return e.id===t.uistate.curPerformer.id})};break;case"wf.UserParticipantExpression":this.compRef.instance.performer={type:"wf.UserParticipantExpression",value:this.uistate.performerInfo.performers.find(function(e){return e.id===t.uistate.curPerformer.id})};break;case"wf.VariableParticipantExpression":this.compRef.instance.performer={type:"wf.VariableParticipantExpression",value:this.uistate.performerInfo.variablePerformers.find(function(e){return e.id===t.uistate.curPerformer.id})};break;case"wf.ReportingLineParticipantExpression":var i=this.uistate.performerInfo.reportingLines.find(function(e){return e.id===t.uistate.curPerformer.id}),i=(this.compRef.instance.performer={type:"wf.ReportingLineParticipantExpression",value:i},"/api/runtime/wf/v1.0/reportingLineDefinitions/"+i.reportingLineDefId);this.http.get(i).subscribe(function(e){e?t.editDialog=t.modalService.show(t.compRef,r):(t.message.error("该条汇报关系数据的定义已删除，该条数据将删除"),t.remove())});break;case"wf.MatrixParticipantExpression":i=this.uistate.performerInfo.matrixParticipants.find(function(e){return e.id===t.uistate.curPerformer.id}),i=(this.compRef.instance.performer={type:"wf.MatrixParticipantExpression",value:i},"/api/runtime/wf/v1.0/matrixDefinition/"+i.matrixDefId);this.http.get(i).subscribe(function(e){e?t.editDialog=t.modalService.show(t.compRef,r):(t.message.error("该条矩阵数据的定义已删除，该条数据将删除"),t.remove())});break;case"wf.ComponentParticipantExpression":this.compRef.instance.performer={type:"wf.ComponentParticipantExpression",value:this.uistate.performerInfo.components.find(function(e){return e.id===t.uistate.curPerformer.id})};break;case"wf.ActivityExecutorParticipantExpression":this.compRef.instance.performer={type:"wf.ActivityExecutorParticipantExpression",value:this.uistate.performerInfo.activityExecutors.find(function(e){return e.id===t.uistate.curPerformer.id})};break;case"wf.OrganizationParticipantExpression":this.compRef.instance.performer={type:"wf.OrganizationParticipantExpression",value:this.uistate.performerInfo.organizationParticipants[0]}}"wf.ReportingLineParticipantExpression"!==this.uistate.curPerformer.type&&"wf.MatrixParticipantExpression"!==this.uistate.curPerformer.type&&(this.editDialog=this.modalService.show(this.compRef,r))}},y.prototype.remove=function(){var e,t=this;this.grid.selectedRow?(this.grid.endCellEdit(),"wf.ComponentParticipantExpression"===this.grid.selectedRow.data.type?(e=this.uistate.performerInfo.components.findIndex(function(e){return e.id===t.grid.selectedRow.data.id}),this.uistate.performerInfo.components.splice(e,1)):"wf.ReportingLineParticipantExpression"===this.grid.selectedRow.data.type?(e=this.uistate.performerInfo.reportingLines.findIndex(function(e){return e.id===t.grid.selectedRow.data.id}),this.uistate.performerInfo.reportingLines.splice(e,1)):"wf.MatrixParticipantExpression"===this.grid.selectedRow.data.type?(e=this.uistate.performerInfo.matrixParticipants.findIndex(function(e){return e.id===t.grid.selectedRow.data.id}),this.uistate.performerInfo.matrixParticipants.splice(e,1)):"wf.ActivityExecutorParticipantExpression"===this.grid.selectedRow.data.type?(e=this.uistate.performerInfo.activityExecutors.findIndex(function(e){return e.id===t.grid.selectedRow.data.id}),this.uistate.performerInfo.activityExecutors.splice(e,1)):"wf.OrganizationParticipantExpression"===this.grid.selectedRow.data.type?e=this.uistate.performerInfo.organizationParticipants=new Array:("wf.VariableParticipantExpression"===this.grid.selectedRow.data.type?(e=this.uistate.performerInfo.variablePerformers.findIndex(function(e){return e.id===t.grid.selectedRow.data.id}),this.uistate.performerInfo.variablePerformers):(e=this.uistate.performerInfo.performers.findIndex(function(e){return e.id===t.grid.selectedRow.data.id}),this.uistate.performerInfo.performers)).splice(e,1),e=this.uistate.performersList.findIndex(function(e){return e.id===t.grid.selectedRow.data.id}),this.uistate.performersList.splice(e,1),this.grid.loadData(this.uistate.performersList)):this.message.info("请先选中一条参与者信息！")},y.prototype.clear=function(){this.uistate.performerInfo.performers=[],this.uistate.performerInfo.variablePerformers=[],this.uistate.performerInfo.components=[],this.uistate.performerInfo.reportingLines=[],this.uistate.performerInfo.matrixParticipants=[],this.uistate.performerInfo.activityExecutors=[],this.uistate.performerInfo.organizationParticipants=new Array,this.uistate.performersList=[],this.grid.loadData(this.uistate.performersList)},y.prototype.clickOK=function(){this.grid.endCellEdit();var e={value:this.uistate.performerInfo,parameters:null};this.submitModal.emit(e)},y.prototype.clickCancel=function(){this.closeModal.emit()},y.prototype.editOK=function(){var i=this;if(this.isClose=!0,this.compRef){var e,t,r=this.compRef.instance.getPerformers();if(r.userPerformers&&0<r.userPerformers.length&&(r.userPerformers.forEach(function(t){var r,e=i.uistate.performerInfo.performers.findIndex(function(e){return e.id===t.id||e.performerId===t.performerId});-1<e?(r=i.uistate.performerInfo.performers[e].id,i.uistate.performerInfo.performers[e]=t,e=i.uistate.performersList.findIndex(function(e){return e.id===r}),i.uistate.performersList[e]=t):("edit"===i.editState&&i.remove(),i.uistate.performerInfo.performers.push(t),i.uistate.performersList=i.uistate.performersList.concat([t]))}),this.uistate.performersList.filter(function(e){return e.type===i.uistate.typeCollection[0].value||e.type===i.uistate.typeCollection[1].value}).map(function(e){return e.description=i.performerDescription(e)})),r.positions&&0<r.positions.length){var n=this;try{for(var o=ue(r.positions),a=o.next();!a.done;a=o.next())!function(e){var t,r;e&&null!==e&&e.id&&((t=e).performerId?t.orgType&&null!=t.orgType||!t.isRequired||"1"!==t.positionType?t.orgId&&null!=t.orgId||!t.isRequired||"1"!==t.positionType?(-1<(e=n.uistate.performerInfo.performers.findIndex(function(e){return e.id===t.id||e.performerId===t.performerId&&e.orgId===t.orgId}))?(r=n.uistate.performerInfo.performers[e].id,n.uistate.performerInfo.performers[e]=t,e=n.uistate.performersList.findIndex(function(e){return e.id===r}),n.uistate.performersList[e]=t):(n.uistate.performerInfo.performers.push(t),n.uistate.performersList=n.uistate.performersList.concat([t])),n.uistate.performersList.filter(function(e){return e.type===i.uistate.typeCollection[0].value||e.type===i.uistate.typeCollection[1].value}).map(function(e){return e.description=i.performerDescription(e)})):(n.message.info("尚未填写组织！"),n.isClose=!1):(n.message.info("尚未选择组织类型！"),n.isClose=!1):(n.message.info("尚未选择岗位！"),n.isClose=!1))}(a.value)}catch(s){t={error:s}}finally{try{a&&!a.done&&(e=o["return"])&&e.call(o)}finally{if(t)throw t.error}}}r.component&&r.component.metadataId&&r.component.methodCode&&(-1<(e=this.uistate.performerInfo.components.findIndex(function(e){return e.id===r.component.id}))?(this.uistate.performerInfo.components[e]=r.component,t=this.uistate.performersList.findIndex(function(e){return e.id===r.component.id}),this.uistate.performersList[t]={id:r.component.id,type:"wf.ComponentParticipantExpression",performerName:r.component.name,description:this.componentDescription(r.component),condition:r.component.condition}):(this.uistate.performerInfo.components.push(r.component),this.uistate.performersList.push({id:r.component.id,type:"wf.ComponentParticipantExpression",performerName:r.component.name,description:this.componentDescription(r.component),condition:""}))),r.reportingLine&&r.reportingLine.reportingLineDefId&&r.reportingLine.dimension&&("dept"!==r.reportingLine.reportingReferObject||r.reportingLine.refOrgId?"dept"===r.reportingLine.reportingReferObject||r.reportingLine.refUserId||r.reportingLine.refEmployeeId?(this.isClose=!0,this.addReportingLineData(r)):(this.isClose=!1,this.message.info("“用户”汇报关系类型下，参照人不能为空")):(this.isClose=!1,this.message.info("“部门”汇报关系类型下，参照人所在部门不能为空"))),r.matrix&&r.matrix.matrixDefId&&(r.matrix.conditionField1||r.matrix.conditionField2||r.matrix.conditionField3?r.matrix.dataFieldAlias?(this.isClose=!0,this.addMatrixData(r)):(this.isClose=!1,this.message.info("数据字段不能为空")):(this.isClose=!1,this.message.info("条件字段至少要存在一个"))),r.activityExecutorPerformers&&0<r.activityExecutorPerformers.length&&(r.activityExecutorPerformers.forEach(function(t){i.uistate.performerInfo.activityExecutors.findIndex(function(e){return e.id===t.id||e.activityDefId===t.activityDefId})<0&&("edit"===i.editState&&i.remove(),i.uistate.performerInfo.activityExecutors.push(t),i.uistate.performersList=i.uistate.performersList.concat([t]))}),this.uistate.performersList.filter(function(e){return e.type===i.uistate.typeCollection[5].value}).map(function(e){return e.description=i.performerDescription(e)})),r.organizationParticipant&&(console.log(r.organizationParticipant),this.uistate.performerInfo.organizationParticipants=[r.organizationParticipant],this.uistate.performersList=this.uistate.performersList.filter(function(e){return"wf.OrganizationParticipantExpression"!==e.type}),this.uistate.performersList=this.uistate.performersList.concat({id:r.organizationParticipant.id||l.GenerateElementId(),type:"wf.OrganizationParticipantExpression",performerName:r.organizationParticipant.organizationName,description:r.organizationParticipant.organizationName+"，且"+(r.organizationParticipant.includeChildren?"包含下级":"不包含下级"),condition:r.organizationParticipant.condition})),this.grid.loadData(this.uistate.performersList)}this.editDialog&&this.isClose&&this.editDialog.close()},y.prototype.addReportingLineData=function(t){var e,r,i=this.uistate.performerInfo.reportingLines.findIndex(function(e){return e.id===t.reportingLine.id});if(-1<i){this.uistate.performerInfo.reportingLines[i]=t.reportingLine;i=this.uistate.performersList.findIndex(function(e){return e.id===t.reportingLine.id});this.uistate.performersList[i]={id:t.reportingLine.id,type:"wf.ReportingLineParticipantExpression",performerName:t.reportingLine.reportingLineDefName+"-"+t.reportingLine.dimension,description:this.reportingLineDescription(t.reportingLine),condition:t.reportingLine.condition}}else{try{for(var n=ue(this.uistate.performerInfo.reportingLines),o=n.next();!o.done;o=n.next()){var a=o.value;if(a.reportingLineDefId===t.reportingLine.definitionId&&a.dimension===t.reportingLine.dimension&&a.refUserId===t.reportingLine.referUserId&&a.refEmployeeId===t.reportingLine.refEmployeeId&&a.refOrgId===t.reportingLine.referDeptId)return void this.message.error("该汇报关系已经进行过配置")}}catch(s){e={error:s}}finally{try{o&&!o.done&&(r=n["return"])&&r.call(n)}finally{if(e)throw e.error}}this.uistate.performerInfo.reportingLines.push(t.reportingLine),this.uistate.performersList.push({id:t.reportingLine.id,type:"wf.ReportingLineParticipantExpression",performerName:t.reportingLine.reportingLineDefName+"-"+t.reportingLine.dimension,description:this.reportingLineDescription(t.reportingLine),condition:t.reportingLine.condition})}},y.prototype.addMatrixData=function(t){var e,r,i=this.uistate.performerInfo.matrixParticipants.findIndex(function(e){return e.id===t.matrix.id});if(-1<i){this.uistate.performerInfo.matrixParticipants[i]=t.matrix;i=this.uistate.performersList.findIndex(function(e){return e.id===t.matrix.id});this.uistate.performersList[i]={id:t.matrix.id,type:"wf.MatrixParticipantExpression",performerName:t.matrix.matrixDefName+"-"+t.matrix.dataFieldAlias,description:this.matrixDescription(t.matrix),condition:t.matrix.condition}}else{try{for(var n=ue(this.uistate.performerInfo.matrixParticipants),o=n.next();!o.done;o=n.next()){var a=o.value;if(a.matrixDefId===t.matrix.matrixDefId&&a.conditionField1===t.matrix.conditionField1&&a.conditionField2===t.matrix.conditionField2&&a.conditionField3===t.matrix.conditionField3&&a.dataFieldAlias===t.matrix.dataFieldAlias)return void this.message.error("该矩阵已经进行过配置")}}catch(s){e={error:s}}finally{try{o&&!o.done&&(r=n["return"])&&r.call(n)}finally{if(e)throw e.error}}this.uistate.performerInfo.matrixParticipants.push(t.matrix),this.uistate.performersList.push({id:t.matrix.id,type:"wf.MatrixParticipantExpression",performerName:t.matrix.matrixDefName+"-"+t.matrix.dataFieldAlias,description:this.matrixDescription(t.matrix),condition:t.matrix.condition})}},y.prototype.editCancel=function(){this.editDialog&&this.editDialog.close()},y.prototype.participantOptionsSet=function(){this.uistate.performerInfo.options=this.options.getPerformerOptions(),this.optionsDialog.close()},y.prototype.performerDescription=function(e){return"wf.UserParticipantExpression"===e.type||"wf.VariableParticipantExpression"===e.type?"expression"===e.tag?e.performerId:e.orgName?"组织："+e.orgName:"":"wf.PositionParticipantExpression"===e.type?"inSuite"===this.designerUIState.scene?null:"1"===e.positionType?e.orgId?"岗位类型：通用岗位，组织："+e.orgId:"岗位类型：通用岗位":"0"===e.positionType?"岗位类型：组织岗位":void 0:"wf.ActivityExecutorParticipantExpression"===e.type?e.performerName:void 0},y.prototype.componentDescription=function(e){var t="构件："+e.name+",参数：{";return e.actualParameters&&0<e.actualParameters.length&&(e.actualParameters.forEach(function(e){t+=e.code+"："+e.value+"，"}),t=t.substring(0,t.length-1)),t+="}"},y.prototype.reportingLineDescription=function(e){var t="";return e.refUserId&&(t+="参照人："+e.refUserId),e.refEmployeeId&&(t+="参照人："+e.refEmployeeId),e.refOrgId&&(e.refUserId&&(t+="，"),e.refEmployeeId&&(t+="，"),t+="参照组织："+e.refOrgId),t},y.prototype.matrixDescription=function(e){var t="";return e.conditionField1&&(t+="条件1："+e.conditionFieldText1+"，"),e.conditionField2&&(t+="条件2："+e.conditionFieldText2+"，"),e.conditionField3&&(t+="条件3："+e.conditionFieldText3+"，"),e.dataFieldAlias&&(t+="数据："+e.dataFieldAlias+"，"),t.slice(0,t.length-1)},y.prototype.editConditon=function(t){var e,r,i,n,o,a,s,l,c=this;if(0<this.designerUIState.schemas.length){try{for(var p=ue(this.designerUIState.schemas),d=p.next();!d.done;d=p.next()){var u=d.value;this.expr.addSchema("Schema",u)}}catch(w){e={error:w}}finally{try{d&&!d.done&&(l=p["return"])&&l.call(p)}finally{if(e)throw e.error}}this.designerUIState.schemas[0].entityTypes&&0<this.designerUIState.schemas[0].entityTypes.length&&(l=this.designerUIState.schemas[0].entityTypes[0],this.expr.addInjectedEntity(l.name,"Schema",l.name,D.InjectedType.EntityType))}var m=new Array,m=this.designerUIState.addContext(m);if(0<this.designerUIState.subActivityContext.length)try{for(var f=ue(this.designerUIState.subActivityContext),h=f.next();!h.done;h=f.next())!function(t){m.some(function(e){return e.key===t.key})||m.push(t)}(h.value)}catch(P){r={error:P}}finally{try{h&&!h.done&&(i=f["return"])&&i.call(f)}finally{if(r)throw r.error}}if(0<this.designerUIState.activityComponentContext.length)try{for(var y=ue(this.designerUIState.activityComponentContext),g=y.next();!g.done;g=y.next())!function(t){m.some(function(e){return e.key===t.key})||m.push(t)}(g.value)}catch(C){n={error:C}}finally{try{g&&!g.done&&(o=y["return"])&&o.call(y)}finally{if(n)throw n.error}}if(0<m.length)try{for(var v=ue(m),b=v.next();!b.done;b=v.next()){var x=b.value;this.expr.addContext(x)}}catch(I){a={error:I}}finally{try{b&&!b.done&&(s=v["return"])&&s.call(v)}finally{if(a)throw a.error}}this.expr.addExpressionText(t.instance.value),this.expr.setEditPattern(D.ExprEditMode.Conditional),this.expr.buildExpression().then(function(e){"wf.ComponentParticipantExpression"===c.grid.selectedRow.data.type?c.uistate.performerInfo.components.find(function(e){return e.id===c.grid.selectedRow.data.id}).condition=e:"wf.ReportingLineParticipantExpression"===c.grid.selectedRow.data.type?c.uistate.performerInfo.reportingLines.find(function(e){return e.id===c.grid.selectedRow.data.id}).condition=e:"wf.MatrixParticipantExpression"===c.grid.selectedRow.data.type?c.uistate.performerInfo.matrixParticipants.find(function(e){return e.id===c.grid.selectedRow.data.id}).condition=e:"wf.ActivityExecutorParticipantExpression"===c.grid.selectedRow.data.type?c.uistate.performerInfo.activityExecutors.find(function(e){return e.id===c.grid.selectedRow.data.id}).condition=e:c.uistate.performerInfo.performers.find(function(e){return e.id===c.grid.selectedRow.data.id}).condition=e,t.formControl.setValue(e),t.instance.cd.detectChanges(),0<m.length&&(c.expr.exprEntity.contextEntities=c.expr.exprEntity.contextEntities.filter(function(t){return!m.some(function(e){return e.key===t.key})}))})},y.prototype.selectChanged=function(e){this.uistate.curPerformer=e.data},y.prototype.GetOrganizationType=function(){var t=this;this.http.get("/api/runtime/sys/v1.0/authfields/globalauthfields").subscribe(function(e){return t.designerUIState.orgTypeCollection=e.map(function(e){return{value:e.id,text:e.name}})})},y.prototype.getMatrixConfig=function(){return this.http.get("/api/runtime/wf/v1.0/generalConfig/Is_EnableMatrix")},y.decorators=[{type:b.Component,args:[{selector:"app-performer",template:'<div class="f-page">\r\n  <div class="f-page-header">\r\n    <nav class="f-page-header-base">\r\n      <div class="f-title">\r\n        <span class="f-title-icon f-text-orna-bill">\r\n          <i class="f-icon f-icon-page-title-administer"></i>\r\n        </span>\r\n        <h4 *ngIf="nodeType===\'notifyActivity\' || type===\'defaultPerformer\'"  class="f-title-text">办理人列表</h4>\r\n        <h5 *ngIf="type===\'assignPerformer\'" class="f-title-subtitle">全员范围</h5>\r\n        <farris-switch *ngIf="type===\'assignPerformer\'" style="height: 22px;"\r\n          [(ngModel)]="uistate.performerInfo.isAllScope" name="isAllScope"\r\n          [readonly]="false" (valueChange)="switchChange($event)"></farris-switch>\r\n      </div>\r\n      <div class="btn-toolbar btn-group-lg">\r\n      \x3c!--<button class="btn btn-primary mr-2" (click)="add()">新增</button>--\x3e\r\n        <div *ngIf="type!==\'assignPerformer\' || !uistate.performerInfo.isAllScope" class="btn-group mr-2"  fDropdown #dropdownEl="fDropdown">\r\n          <button class="btn btn-primary dropdown-toggle" fDropdownToggle type="button">\r\n            新增\r\n          </button>\r\n          <div class="dropdown-menu" fDropdownMenu>\r\n            <li class="dropdown-item" (click)="addPerformer(\'wf.UserParticipantExpression\')"><span>用户</span></li>\r\n            <li class="dropdown-item" (click)="addPerformer(\'wf.VariableParticipantExpression\')"><span>变量参与者</span></li>\r\n            <li class="dropdown-item" (click)="addPerformer(\'wf.PositionParticipantExpression\')"><span>{{designerUIState.scene===\'inSuite\'?\'角色\':\'岗位\'}}</span></li>\r\n            <li class="dropdown-item" (click)="addPerformer(\'wf.ReportingLineParticipantExpression\')"><span>汇报关系</span></li>\r\n            <li class="dropdown-item" (click)="addPerformer(\'wf.ActivityExecutorParticipantExpression\')"><span>历史活动办理人</span></li>\r\n            <li class="dropdown-item" (click)="addPerformer(\'wf.MatrixParticipantExpression\')"><span>矩阵关系</span></li>\r\n            <li class="dropdown-item" (click)="addPerformer(\'wf.ComponentParticipantExpression\')"><span>参与者构件</span></li>\r\n            <li *ngIf="type===\'assignPerformer\'" class="dropdown-item" (click)="addPerformer(\'wf.OrganizationParticipantExpression\')"><span>单位/部门\r\n            </span></li>\r\n          </div>\r\n        </div>\r\n        <button *ngIf="type!==\'assignPerformer\' || !uistate.performerInfo.isAllScope" class="btn btn-secondary mr-2" [disabled]="(!uistate.curPerformer)"\r\n        (click)="edit()">编辑</button>\r\n        <button *ngIf="type!==\'assignPerformer\' || !uistate.performerInfo.isAllScope" class="btn btn-secondary mr-2" (click)="remove()">移除</button>\r\n        <button *ngIf="type!==\'assignPerformer\' || !uistate.performerInfo.isAllScope" class="btn btn-secondary mr-2" (click)="clear()">清空</button>\r\n        <button *ngIf="nodeType===\'userActivity\' && type===\'defaultPerformer\'" class="btn btn-secondary" (click)="participantOptions.show()">办理人选项</button>\r\n      </div>\r\n    </nav>\r\n  </div>\r\n  <div class="f-page-main f-utils-fill-flex-column h-100">\r\n    <div class="f-utils-fill-flex-column farris-overflow-y-auto h-100">\r\n      <farris-datagrid #grid [data]="uistate.performersList" [columns]="columns" [idField]="\'id\'" [fit]="true"\r\n        [fitColumns]="true" [editable]="true" [editMode]="\'cell\'" [pagination]="false" [showCheckbox]="false"\r\n        [multiSelect]="false" [afterEdit]="afterEdit" (selectChanged)="selectChanged($event)">\r\n      </farris-datagrid>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type="button" class="btn btn-secondary btn-sm px-3 mx-2" (click)="clickCancel()">取消</button>\r\n  <button type="button" class="btn btn-primary btn-sm px-3 mx-2" (click)="clickOK()">确定</button>\r\n</ng-template>\r\n\r\n<ng-template #editFooter>\r\n  <button type="button" class="btn btn-secondary btn-sm px-3 mx-2" (click)="editCancel()">取消</button>\r\n  <button type="button" class="btn btn-primary btn-sm px-3 mx-2" (click)="editOK()">确定</button>\r\n</ng-template>\r\n\r\n<farris-dialog #participantOptions [buttons]="buttonRef" [width]="500" [height]="530" title="\'参与者选项\'">\r\n  <app-performer-options [value]="uistate.performerInfo.options"></app-performer-options>\r\n</farris-dialog>\r\n<ng-template #buttonRef>\r\n  <button class="btn btn-sm btn-default px-3" (click)="participantOptions.close()">取消</button>\r\n  <button class="btn btn-sm btn-primary px-3" (click)="participantOptionsSet()">确定</button>\r\n</ng-template>\r\n',providers:[Mn,ki,An],styles:[""]}]}],y.ctorParameters=function(){return[{type:Mn},{type:An},{type:he.FormBuilder},{type:b.ComponentFactoryResolver},{type:b.Injector},{type:i.BsModalService},{type:r.MessagerService},{type:a},{type:D.ExpressionService},{type:t.HttpService}]},y.propDecorators={modalFooter:[{type:b.ViewChild,args:["iconSelectFooter"]}],editFooter:[{type:b.ViewChild,args:["editFooter"]}],options:[{type:b.ViewChild,args:[Eo]}],optionsDialog:[{type:b.ViewChild,args:["participantOptions"]}],grid:[{type:b.ViewChild,args:[ve.DatagridComponent]}],dropDownEl:[{type:b.ViewChild,args:["dropdownEl"]}],closeModal:[{type:b.Output}],submitModal:[{type:b.Output}],value:[{type:b.Input}],editorParams:[{type:b.Input}]};var ko=y;function y(e,t,r,i,n,o,a,s,l,c){var p=this;this.viewModel=e,this.uistate=t,this.formBuilder=r,this.resolver=i,this.injector=n,this.modalService=o,this.message=a,this.designerUIState=s,this.expr=l,this.http=c,this.display=!0,this.type="defaultPerformer",this.nodeType="userActivity",this.closeModal=new b.EventEmitter,this.submitModal=new b.EventEmitter,this.editorParams={},this.isClose=!0,this.modalConfig={title:"参与者",width:700,height:400,showButtons:!0},this.columns=[{field:"type",width:50,title:"类型",formatter:{type:"enum",options:{valueField:"value",textField:"text",data:this.uistate.typeCollection}}},{field:"performerName",width:50,title:"名称"},{field:"description",width:100,title:"描述",showTips:!0},{field:"condition",width:60,title:"启用条件",showTips:!0,editor:{type:"input-group",options:{groupText:'<i class="f-icon f-icon-lookup"></i>',editable:!1,clickHandle:function(e){e.formControl.setValue(e.instance.value||""),p.editConditon(e)},clear:function(t){var e;"wf.ComponentParticipantExpression"===t.rowData.type?(e=p.uistate.performerInfo.components.findIndex(function(e){return e.id===t.rowData.id}),p.uistate.performerInfo.components[e].condition=""):"wf.ReportingLineParticipantExpression"===t.rowData.type?(e=p.uistate.performerInfo.reportingLines.findIndex(function(e){return e.id===t.rowData.id}),p.uistate.performerInfo.reportingLines[e].condition=""):"wf.MatrixParticipantExpression"===t.rowData.type?(e=p.uistate.performerInfo.matrixParticipants.findIndex(function(e){return e.id===t.rowData.id}),p.uistate.performerInfo.matrixParticipants[e].condition=""):"wf.ActivityExecutorParticipantExpression"===t.rowData.type?(e=p.uistate.performerInfo.activityExecutors.findIndex(function(e){return e.id===t.rowData.id}),p.uistate.performerInfo.activityExecutors[e].condition=""):"wf.OrganizationParticipantExpression"===t.rowData.type&&(p.uistate.performerInfo.organizationParticipants[0].condition="")}}}}],this.editState="new",this.afterEdit=function(e,t,r){return v.of(!0)},this.GetOrganizationType()}Mo.prototype.convertTo=function(e){return e.performers&&0<e.performers.length||e.variablePerformers&&0<e.variablePerformers.length||e.components&&0<e.components.length||e.reportingLines&&0<e.reportingLines.length||e.matrixParticipants&&0<e.matrixParticipants.length||e.activityExecutors&&0<e.activityExecutors.length||e.organizationParticipants&&0<e.organizationParticipants.length||e.isAllScope?"（已设置）":"（未设置）"};var Oo=Mo;function Mo(){}var Do,No=function(){},Lo=function(){},Fo=function(){},Ro="AssignUser",Vo="Transfer",zo="AddSignFront",Bo="AddSignBehind",Uo="Notify",jo="DEFAULT",Ho="VARORGANIZATION",_o=function(){this.operator="currentUser",this.multiSelect=!0,this.necessary=!1},Go=function(){this.assignStrategy="ALL",this.assignConfig=new _o},Ko=function(){this.assignStrategy=new Go,this.humanPerformerList=new Array,this.potentialOwnerList=new Array,this.isAllScope=!1},qo=function(){},Wo=(n(Jo,Do=qo),Jo);function Jo(){return null!==Do&&Do.apply(this,arguments)||this}var $o;n(Yo,$o=Wo);function Yo(){return null!==$o&&$o.apply(this,arguments)||this}var Xo;n(Zo,Xo=Wo);function Zo(){return null!==Xo&&Xo.apply(this,arguments)||this}n(ta,Qo=qo);var Qo,ea=ta;function ta(){return null!==Qo&&Qo.apply(this,arguments)||this}var ra;n(ia,ra=Wo);function ia(){return null!==ra&&ra.apply(this,arguments)||this}var na;n(oa,na=Wo);function oa(){return null!==na&&na.apply(this,arguments)||this}var aa;n(sa,aa=Wo);function sa(){return null!==aa&&aa.apply(this,arguments)||this}n(pa,la=qo);var la,ca=pa;function pa(){return null!==la&&la.apply(this,arguments)||this}ua.decorators=[{type:b.Injectable}],ua.ctorParameters=function(){return[{type:x}]};var da=ua;function ua(e){this.localePipe=e,this.typeCollection=[{text:this.localePipe.transform("component.participant.user"),value:"wf.UserParticipantExpression"},{text:this.localePipe.transform("component.participant.variable"),value:"wf.VariableParticipantExpression"},{text:this.localePipe.transform("component.participant.position"),value:"wf.PositionParticipantExpression"},{text:this.localePipe.transform("component.participant.component"),value:"wf.ComponentParticipantExpression"},{text:this.localePipe.transform("component.participant.reportingLine"),value:"wf.ReportingLineParticipantExpression"},{text:this.localePipe.transform("component.participant.matrix"),value:"wf.MatrixParticipantExpression"},{text:this.localePipe.transform("component.participant.activityExecutor"),value:"wf.ActivityExecutorParticipantExpression"},{text:this.localePipe.transform("component.participant.organization"),value:"wf.OrganizationParticipantExpression"}]}P.prototype.ngOnInit=function(){this.nodeType=this.editorParams.nodeType},P.prototype.switchChange=function(e){e&&this.clearPerformer("potentialOwner")},P.prototype.assignStrategyChange=function(e){"ALL"===e?(this.participant.isAllScope=!0,this.clearPerformer("potentialOwner")):this.participant.isAllScope=!1},P.prototype.isEnable=function(e){e?(this.participant.isAllScope=!0,this.clearPerformer("potentialOwner")):this.participant.isAllScope=!1},P.prototype.addPerformer=function(e,t){this.editState="new",this.type=t;t=this.resolver.resolveComponentFactory(Io),this.compRef=t.create(this.injector),this.compRef.instance.performerType=e,t=this.attributeBoxSize(e),e={title:this.localePipe.transform("component.participant.participantSelection"),width:t.width,height:t.height,buttons:this.editFooter,showButtons:!0};this.editDialog=this.modalService.show(this.compRef,e),this.dropDownE2&&this.dropDownE2.close()},P.prototype.editOK=function(){var e,t,r,i;if(this.isClose=!0,this.compRef){var n=this.compRef.instance.getPerformers();if(n.userPerformers&&0<n.userPerformers.length)try{for(var o=ue(n.userPerformers),a=o.next();!a.done;a=o.next()){var s=a.value;this.addUserPerformer(s)}}catch(d){e={error:d}}finally{try{a&&!a.done&&(t=o["return"])&&t.call(o)}finally{if(e)throw e.error}}if(n.variable&&null!==n.variable&&n.variable.performerId&&this.addvariablePerformer(n.variable),n.positions&&0<n.positions.length&&this.addPositionPerformer(n.positions),n.component&&n.component.metadataId&&n.component.methodCode&&this.addComponentPerformer(n.component),n.reportingLine&&n.reportingLine.reportingLineDefId&&n.reportingLine.dimension&&this.addReportingLinePerformer(n.reportingLine),n.matrix&&n.matrix.matrixDefId&&this.addMatrixPerformer(n.matrix),n.activityExecutorPerformers&&0<n.activityExecutorPerformers.length)try{for(var l=ue(n.activityExecutorPerformers),c=l.next();!c.done;c=l.next()){var p=c.value;this.addActivityExecutorPerformer(p)}}catch(u){r={error:u}}finally{try{c&&!c.done&&(i=l["return"])&&i.call(l)}finally{if(r)throw r.error}}n.organizationParticipant&&this.addOrganizationParticipant(n.organizationParticipant)}this.editDialog&&this.isClose&&this.editDialog.close(),this.potentialOwnerGrid.refresh()},P.prototype.addUserPerformer=function(t){var e;"potentialOwner"===this.type&&(-1<this.participant.potentialOwnerList.findIndex(function(e){return e.id===t.id||e.performerId&&e.performerId===t.performerId})||("edit"===this.editState&&this.removePotentialOwner(),e=void 0,e=0<this.participant.potentialOwnerList.length?Math.max.apply(Math,w(this.participant.potentialOwnerList.map(function(e){return e.order})))+1:1,t.order=e,this.participant.potentialOwnerList.push(t)),this.potentialOwnerGrid.loadData(this.participant.potentialOwnerList))},P.prototype.addvariablePerformer=function(t){var e;t&&t.varValue?t.varType?t.relation?"potentialOwner"===this.type&&(-1<(e=this.participant.potentialOwnerList.findIndex(function(e){return e.id===t.id||e.performerId&&e.performerId===t.performerId}))?this.participant.potentialOwnerList[e]=t:("edit"===this.editState&&this.removePotentialOwner(),e=void 0,e=0<this.participant.potentialOwnerList.length?Math.max.apply(Math,w(this.participant.potentialOwnerList.map(function(e){return e.order})))+1:1,t.order=e,this.participant.potentialOwnerList.push(t)),this.potentialOwnerGrid.loadData(this.participant.potentialOwnerList)):(this.message.info(this.localePipe.transform("component.participant.selectRelation")),this.isClose=!1):(this.message.info(this.localePipe.transform("component.participant.selectVariableValueType")),this.isClose=!1):(this.message.info(this.localePipe.transform("component.participant.selectProcessVariables")),this.isClose=!1)},P.prototype.addPositionPerformer=function(e){var t,r,i=this;try{for(var n=ue(e),o=n.next();!o.done;o=n.next())!function(t){var e;t.performerId?t.orgType&&null!=t.orgType||!t.isRequired||"1"!==t.positionType?t.orgId&&null!=t.orgId||!t.isRequired||"1"!==t.positionType?"potentialOwner"===i.type&&(-1<(e=i.participant.potentialOwnerList.findIndex(function(e){return"wf.PositionParticipantExpression"===e.type&&e.id===t.id}))?i.participant.potentialOwnerList[e]=t:(e=void 0,e=0<i.participant.potentialOwnerList.length?Math.max.apply(Math,w(i.participant.potentialOwnerList.map(function(e){return e.order})))+1:1,t.order=e,i.participant.potentialOwnerList.push(t)),i.potentialOwnerGrid.loadData(i.participant.potentialOwnerList)):(i.message.info(i.localePipe.transform("component.participant.orgFill")),i.isClose=!1):(i.message.info(i.localePipe.transform("component.participant.selectOrgType")),i.isClose=!1):(i.message.info(i.localePipe.transform("component.participant.selectPosition")),i.isClose=!1)}(o.value)}catch(a){t={error:a}}finally{try{o&&!o.done&&(r=n["return"])&&r.call(n)}finally{if(t)throw t.error}}},P.prototype.addComponentPerformer=function(e){var t=new ea;t.id=e.id,t.metadataId=e.metadataId,t.methodCode=e.methodCode,t.methodName=e.methodName,t.name=e.name,t.actualParameters=e.actualParameters,t.type="wf.ComponentParticipantExpression",t.condition=e.condition,"potentialOwner"===this.type&&(-1<(e=this.participant.potentialOwnerList.findIndex(function(e){return e.id===t.id}))?this.participant.potentialOwnerList[e]=t:(e=void 0,e=0<this.participant.potentialOwnerList.length?Math.max.apply(Math,w(this.participant.potentialOwnerList.map(function(e){return e.order})))+1:1,t.order=e,this.participant.potentialOwnerList.push(t)),this.potentialOwnerGrid.loadData(this.participant.potentialOwnerList))},P.prototype.addReportingLinePerformer=function(t){var e,r;if("dept"!==t.reportingReferObject||t.refOrgId)if("dept"===t.reportingReferObject||t.refUserId||t.refEmployeeId){if(this.isClose=!0,"potentialOwner"===this.type){var i=this.participant.potentialOwnerList.findIndex(function(e){return e.id===t.id});if(-1<i)this.participant.potentialOwnerList[i]=t;else{i=this.participant.potentialOwnerList.filter(function(e){return"wf.ReportingLineParticipantExpression"===e.type});try{for(var n=ue(i),o=n.next();!o.done;o=n.next()){var a=o.value;if(a.reportingLineDefId===t.reportingLineDefId&&a.dimension===t.dimension&&a.refUserId===t.refUserId&&a.refEmployeeId===t.refEmployeeId&&a.refOrgId===t.refOrgId)return void this.message.error(this.localePipe.transform("component.participant.repDefConfigured"))}}catch(s){e={error:s}}finally{try{o&&!o.done&&(r=n["return"])&&r.call(n)}finally{if(e)throw e.error}}i=void 0,i=0<this.participant.potentialOwnerList.length?Math.max.apply(Math,w(this.participant.potentialOwnerList.map(function(e){return e.order})))+1:1;t.order=i,this.participant.potentialOwnerList.push(t)}this.potentialOwnerGrid.loadData(this.participant.potentialOwnerList)}}else this.isClose=!1,this.message.info(this.localePipe.transform("component.participant.refUserIdNotNull"));else this.isClose=!1,this.message.info(this.localePipe.transform("component.participant.refOrgIdNotNull"))},P.prototype.addMatrixPerformer=function(t){var e,r;if(t.conditionField1||t.conditionField2||t.conditionField3)if(t.dataFieldAlias){if(this.isClose=!0,"potentialOwner"===this.type){var i=this.participant.potentialOwnerList.findIndex(function(e){return e.id===t.id});if(-1<i)this.participant.potentialOwnerList[i]=t;else{i=this.participant.potentialOwnerList.filter(function(e){return"wf.MatrixParticipantExpression"===e.type});try{for(var n=ue(i),o=n.next();!o.done;o=n.next()){var a=o.value;if(a.matrixDefId===t.matrixDefId&&a.conditionField1===t.conditionField1&&a.conditionField2===t.conditionField2&&a.conditionField3===t.conditionField3&&a.dataFieldAlias===t.dataFieldAlias)return void this.message.error(this.localePipe.transform("component.participant.matrixConfigured"))}}catch(s){e={error:s}}finally{try{o&&!o.done&&(r=n["return"])&&r.call(n)}finally{if(e)throw e.error}}i=void 0,i=0<this.participant.potentialOwnerList.length?Math.max.apply(Math,w(this.participant.potentialOwnerList.map(function(e){return e.order})))+1:1;t.order=i,this.participant.potentialOwnerList.push(t)}this.potentialOwnerGrid.loadData(this.participant.potentialOwnerList)}}else this.isClose=!1,this.message.info(this.localePipe.transform("component.participant.dataFieldAliasNotNull"));else this.isClose=!1,this.message.info(this.localePipe.transform("component.participant.atLeastOneCondition"))},P.prototype.addActivityExecutorPerformer=function(t){var e;"potentialOwner"===this.type&&(this.participant.potentialOwnerList.findIndex(function(e){return e.id===t.id||e.activityDefId&&e.activityDefId===t.activityDefId})<0&&("edit"===this.editState&&this.removePotentialOwner(),e=void 0,e=0<this.participant.potentialOwnerList.length?Math.max.apply(Math,w(this.participant.potentialOwnerList.map(function(e){return e.order})))+1:1,t.order=e,this.participant.potentialOwnerList.push(t)),this.potentialOwnerGrid.loadData(this.participant.potentialOwnerList))},P.prototype.addOrganizationParticipant=function(e){var t=new ca;t.id=e.id||l.GenerateElementId(),t.type="wf.OrganizationParticipantExpression",t.condition=e.condition,t.name=e.name,t.actionScope=e.actionScope,t.organizationLevel=e.organizationLevel,t.organizationId=e.organizationId,t.organizationCode=e.organizationCode,t.organizationName=e.organizationName,t.includeChildren=e.includeChildren,t.parentsUntil=e.parentsUntil,t.tag=e.tag,"potentialOwner"===this.type&&(this.participant.potentialOwnerList=this.participant.potentialOwnerList.filter(function(e){return"wf.OrganizationParticipantExpression"!==e.type}),e=void 0,e=0<this.participant.potentialOwnerList.length?Math.max.apply(Math,w(this.participant.potentialOwnerList.map(function(e){return e.order})))+1:1,t.order=e,this.participant.potentialOwnerList.push(t),this.potentialOwnerGrid.loadData(this.participant.potentialOwnerList))},P.prototype.editCancel=function(){this.editDialog&&this.editDialog.close()},P.prototype.editPerformer=function(t){var r=this;if(this.editState="edit",i="potentialOwner"===(this.type=t)?this.potentialOwnerGrid.selectedRow:i){var e=i.data;if(e){var i=this.attributeBoxSize(e.type),n={title:this.localePipe.transform("component.participant.participantSelection"),width:i.width,height:i.height,buttons:this.editFooter,showButtons:!0},i=this.resolver.resolveComponentFactory(Io);switch(this.compRef=i.create(this.injector),this.compRef.instance.performerType=e.type,this.compRef.instance.editState=this.editState,e.type){case"wf.PositionParticipantExpression":this.compRef.instance.performer={type:"wf.PositionParticipantExpression",value:e};break;case"wf.UserParticipantExpression":this.compRef.instance.performer={type:"wf.UserParticipantExpression",value:e};break;case"wf.VariableParticipantExpression":this.compRef.instance.performer={type:"wf.VariableParticipantExpression",value:e};break;case"wf.ReportingLineParticipantExpression":this.compRef.instance.performer={type:"wf.ReportingLineParticipantExpression",value:e};var o="/api/runtime/wf/v1.0/reportingLineDefinitions/"+e.reportingLineDefId;this.http.get(o).subscribe(function(e){e?r.editDialog=r.modalService.show(r.compRef,n):(r.message.error(r.localePipe.transform("component.participant.definitionDeleted")),"potentialOwner"===t&&r.removePotentialOwner())});break;case"wf.MatrixParticipantExpression":this.compRef.instance.performer={type:"wf.MatrixParticipantExpression",value:e};o="/api/runtime/wf/v1.0/matrixDefinition/"+e.matrixDefId;this.http.get(o).subscribe(function(e){e?r.editDialog=r.modalService.show(r.compRef,n):(r.message.error(r.localePipe.transform("component.participant.matrixDeleted")),"potentialOwner"===t&&r.removePotentialOwner())});break;case"wf.ComponentParticipantExpression":this.compRef.instance.performer={type:"wf.ComponentParticipantExpression",value:e};break;case"wf.ActivityExecutorParticipantExpression":this.compRef.instance.performer={type:"wf.ActivityExecutorParticipantExpression",value:e};break;case"wf.OrganizationParticipantExpression":this.compRef.instance.performer={type:"wf.OrganizationParticipantExpression",value:e}}"wf.ReportingLineParticipantExpression"!==e.type&&"wf.MatrixParticipantExpression"!==e.type&&(this.editDialog=this.modalService.show(this.compRef,n))}}else this.message.info(this.localePipe.transform("component.participant.selectPerformer"))},P.prototype.removePerformer=function(e){var t=this;"potentialOwner"===e&&(this.potentialOwnerGrid.selectedRow?(this.potentialOwnerGrid.endCellEdit(),e=this.participant.potentialOwnerList.findIndex(function(e){return e.id===t.potentialOwnerGrid.selectedRow.data.id}),this.participant.potentialOwnerList.splice(e,1),this.potentialOwnerGrid.loadData(this.participant.potentialOwnerList)):this.message.info(this.localePipe.transform("component.participant.selectParticipantInfo")))},P.prototype.clearPerformer=function(e){"potentialOwner"===e&&(this.participant.potentialOwnerList=new Array),this.potentialOwnerGrid&&this.potentialOwnerGrid.loadData(this.participant.potentialOwnerList)},P.prototype.moveUp=function(e){var t,r;"potentialOwner"===e&&((e=this.potentialOwnerGrid.selectedRow)?(t=e.data,0!==(e=this.participant.potentialOwnerList.findIndex(function(e){return e.id===t.id}))&&(r=this.participant.potentialOwnerList[e].order,this.participant.potentialOwnerList[e].order=this.participant.potentialOwnerList[e-1].order,this.participant.potentialOwnerList[e-1].order=r,this.swapArray(this.participant.potentialOwnerList,e,e-1),this.potentialOwnerGrid.loadData(this.participant.potentialOwnerList),this.potentialOwnerGrid.selectRow(t.id,!0))):this.message.info(this.localePipe.transform("component.participant.noRowSelected")))},P.prototype.moveDown=function(e){var t,r;"potentialOwner"===e&&((e=this.potentialOwnerGrid.selectedRow)?(t=e.data,(e=this.participant.potentialOwnerList.findIndex(function(e){return e.id===t.id}))!==this.participant.potentialOwnerList.length-1&&(r=this.participant.potentialOwnerList[e].order,this.participant.potentialOwnerList[e].order=this.participant.potentialOwnerList[e+1].order,this.participant.potentialOwnerList[e+1].order=r,this.swapArray(this.participant.potentialOwnerList,e,e+1),this.potentialOwnerGrid.loadData(this.participant.potentialOwnerList),this.potentialOwnerGrid.selectRow(t.id,!0))):this.message.info(this.localePipe.transform("component.participant.noRowSelected")))},P.prototype.swapArray=function(e,t,r){return e[t]=e.splice(r,1,e[t])[0],e},P.prototype.removePotentialOwner=function(){var e,t=this;this.potentialOwnerGrid.selectedRow?(this.potentialOwnerGrid.endCellEdit(),e=this.participant.potentialOwnerList.findIndex(function(e){return e.id===t.potentialOwnerGrid.selectedRow.data.id}),this.participant.potentialOwnerList.splice(e,1)):this.message.info(this.localePipe.transform("component.participant.selectpotentialtHandler"))},P.prototype.getUserPerformerDescription=function(e){return"expression"===e.tag?e.performerId:e.orgName?this.localePipe.transform("component.participant.org")+e.orgName:""},P.prototype.getVariablePerformerDescription=function(e){if("expression"===e.tag)return e.varValue},P.prototype.getPositionPerformerDescription=function(e){return"inSuite"===this.designerUIState.scene?null:"1"===e.positionType?e.orgId?this.localePipe.transform("component.participant.positionType1")+e.orgId:this.localePipe.transform("component.participant.positionType2"):"0"===e.positionType?this.localePipe.transform("component.participant.positionType3"):void 0},P.prototype.getComponentPerformerDescription=function(e){var t=this.localePipe.transform("component.participant.comp")+e.name+this.localePipe.transform("component.participant.parameters");return e.actualParameters&&0<e.actualParameters.length&&(e.actualParameters.forEach(function(e){t+=e.code+"："+e.value+"，"}),t=t.substring(0,t.length-1)),t+="}"},P.prototype.getReportingLinePerformerDescription=function(e){var t="";return e.refUserId&&(t+=this.localePipe.transform("component.participant.referencePerson")+e.refUserId),e.refEmployeeId&&(t+=this.localePipe.transform("component.participant.referencePerson")+e.refEmployeeId),e.refOrgId&&(e.refUserId&&(t+="，"),e.refEmployeeId&&(t+="，"),t+=this.localePipe.transform("component.participant.referenceOrganization")+e.refOrgId),t},P.prototype.getMatrixPerformerDescription=function(e){var t="";return e.conditionField1&&(t+=this.localePipe.transform("component.participant.condition1")+e.conditionFieldText1+"，"),e.conditionField2&&(t+=this.localePipe.transform("component.participant.condition2")+e.conditionFieldText2+"，"),e.conditionField3&&(t+=this.localePipe.transform("component.participant.condition3")+e.conditionFieldText3+"，"),e.dataFieldAlias&&(t+=this.localePipe.transform("component.participant.data")+e.dataFieldAlias+"，"),t.slice(0,t.length-1)},P.prototype.editConditon=function(t){var e,r,i,n,o,a,s,l,c=this;if(0<this.designerUIState.schemas.length){try{for(var p=ue(this.designerUIState.schemas),d=p.next();!d.done;d=p.next()){var u=d.value;this.expr.addSchema("Schema",u)}}catch(w){e={error:w}}finally{try{d&&!d.done&&(l=p["return"])&&l.call(p)}finally{if(e)throw e.error}}this.designerUIState.schemas[0].entityTypes&&0<this.designerUIState.schemas[0].entityTypes.length&&(l=this.designerUIState.schemas[0].entityTypes[0],this.expr.addInjectedEntity(l.name,"Schema",l.name,D.InjectedType.EntityType))}var m=new Array,m=this.designerUIState.addContext(m);if(0<this.designerUIState.subActivityContext.length)try{for(var f=ue(this.designerUIState.subActivityContext),h=f.next();!h.done;h=f.next())!function(t){m.some(function(e){return e.key===t.key})||m.push(t)}(h.value)}catch(P){r={error:P}}finally{try{h&&!h.done&&(i=f["return"])&&i.call(f)}finally{if(r)throw r.error}}if(0<this.designerUIState.activityComponentContext.length)try{for(var y=ue(this.designerUIState.activityComponentContext),g=y.next();!g.done;g=y.next())!function(t){m.some(function(e){return e.key===t.key})||m.push(t)}(g.value)}catch(C){n={error:C}}finally{try{g&&!g.done&&(o=y["return"])&&o.call(y)}finally{if(n)throw n.error}}if(0<m.length)try{for(var v=ue(m),b=v.next();!b.done;b=v.next()){var x=b.value;this.expr.addContext(x)}}catch(I){a={error:I}}finally{try{b&&!b.done&&(s=v["return"])&&s.call(v)}finally{if(a)throw a.error}}this.expr.addExpressionText(t.instance.value),this.expr.setEditPattern(D.ExprEditMode.Conditional),this.expr.buildExpression().then(function(e){c.potentialOwnerGrid&&c.potentialOwnerGrid.selectedRow&&c.potentialOwnerGrid.selectedRow.data&&(c.participant.potentialOwnerList.find(function(e){return e.id===c.potentialOwnerGrid.selectedRow.data.id}).condition=e),t.formControl.setValue(e),t.instance.cd.detectChanges(),0<m.length&&(c.expr.exprEntity.contextEntities=c.expr.exprEntity.contextEntities.filter(function(t){return!m.some(function(e){return e.key===t.key})}))})},P.prototype.GetOrganizationType=function(){var t=this;this.http.get("/api/runtime/sys/v1.0/authfields/globalauthfields").subscribe(function(e){return t.designerUIState.orgTypeCollection=e.map(function(e){return{value:e.id,text:e.name}})})},P.prototype.attributeBoxSize=function(e){var t={width:760,height:512};switch(e){case"wf.PositionParticipantExpression":return t.width=760,t.height=455,t;case"wf.UserParticipantExpression":return t.width=760,t.height=320,t;case"wf.VariableParticipantExpression":return t.width=760,t.height=420,t;case"wf.ReportingLineParticipantExpression":return t.width=760,t.height=512,t;case"wf.MatrixParticipantExpression":return t.width=780,t.height=420,t;case"wf.ComponentParticipantExpression":return t.width=760,t.height=512,t;case"wf.ActivityExecutorParticipantExpression":return t.width=760,t.height=320,t;case"wf.OrganizationParticipantExpression":return t.width=760,t.height=360,t}},P.decorators=[{type:b.Component,args:[{selector:"wf-alternative-participant",template:'<div class="f-page-main d-flex flex-column farris-overflow-y-auto farris-overflow-x-auto" style="height: 300px">\r\n  <div class="f-page-header">\r\n    <div class="farris-group-wrap">\r\n      <div class="form-group farris-form-group">\r\n        <label class="col-form-label" style="width: 4.9rem">\r\n          <span class="farris-label-text">{{\'component.orgPotentialOwner.limit\'|wfLocale}}</span>\r\n        </label>\r\n        <div class="farris-input-wrap ml-1">\r\n          <farris-switch [(ngModel)]="participant.isAllScope" name="enable" (valueChange)="isEnable($event)"></farris-switch>\r\n        </div>\r\n        <div class="f-toolbar last-div farris-form-controls-inline" [ngStyle]="{\'visibility\' : participant.isAllScope ? \'visible\' : \'hidden\'}">\r\n          <div class="btn-group mr-2"  fDropdown #dropdownE2="fDropdown" [autoRectify]="true">\r\n            <farris-button class="dropdown-toggle" fDropdownToggle [type]="\'link\'">\r\n              {{\'component.participant.new\'|wfLocale}}\r\n            </farris-button>\r\n            <div class="dropdown-menu" fDropdownMenu>\r\n              <li class="dropdown-item" (click)="addPerformer(\'wf.UserParticipantExpression\',\'potentialOwner\')"><span>{{\'component.participant.user\'|wfLocale}}</span></li>\r\n              <li class="dropdown-item" (click)="addPerformer(\'wf.VariableParticipantExpression\',\'potentialOwner\')"><span>{{\'component.participant.variable\'|wfLocale}}</span></li>\r\n              <li class="dropdown-item" (click)="addPerformer(\'wf.PositionParticipantExpression\',\'potentialOwner\')"><span>{{designerUIState.scene===\'inSuite\'?((\'component.participant.role\'|wfLocale)):(\'component.participant.position\'|wfLocale)}}</span></li>\r\n              <li class="dropdown-item" (click)="addPerformer(\'wf.ReportingLineParticipantExpression\',\'potentialOwner\')"><span>{{\'component.participant.reportingLine\'|wfLocale}}</span></li>\r\n              <li class="dropdown-item" (click)="addPerformer(\'wf.ActivityExecutorParticipantExpression\',\'potentialOwner\')"><span>{{\'component.participant.activityExecutor\'|wfLocale}}</span></li>\r\n              <li class="dropdown-item" (click)="addPerformer(\'wf.MatrixParticipantExpression\',\'potentialOwner\')"><span>{{\'component.participant.matrix\'|wfLocale}}</span></li>\r\n              <li class="dropdown-item" (click)="addPerformer(\'wf.ComponentParticipantExpression\',\'potentialOwner\')"><span>{{\'component.participant.component\'|wfLocale}}</span></li>\r\n              <li class="dropdown-item" (click)="addPerformer(\'wf.OrganizationParticipantExpression\',\'potentialOwner\')"><span>{{\'component.participant.organization\'|wfLocale}}\r\n              </span></li>\r\n            </div>\r\n          </div>\r\n          <farris-button  [type]="\'link\'" (click)="editPerformer(\'potentialOwner\')">{{\'component.participant.editPerformer\'|wfLocale}}</farris-button>\r\n          <farris-button  [type]="\'link\'" (click)="removePerformer(\'potentialOwner\')">{{\'component.participant.removePerformer\'|wfLocale}}</farris-button>\r\n          <farris-button  [type]="\'link\'" (click)="clearPerformer(\'potentialOwner\')">{{\'component.participant.clearPerformer\'|wfLocale}}</farris-button>\r\n          <farris-button  [type]="\'link\'" (click)="moveUp(\'potentialOwner\')">{{\'component.participant.moveUp\'|wfLocale}}</farris-button>\r\n          <farris-button  [type]="\'link\'" (click)="moveDown(\'potentialOwner\')">{{\'component.participant.moveDown\'|wfLocale}}</farris-button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n  <div class="f-utils-fill farris-overflow-y-auto">\r\n    <farris-datagrid #potentialOwnerGrid class="f-component-grid" [columns]="columns" [data]="participant.potentialOwnerList" #defaultPerformerGrid [idField]="\'id\'" [showLineNumber]="false"\r\n      [striped]="true" [showCheckbox]="false" [pagination]="false" [fit]="true" [fitColumns]="true" [editable]="true" [editMode]="\'cell\'"\r\n      [multiSelect]="false">\r\n    </farris-datagrid>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #editFooter>\r\n  <button type="button" class="btn btn-secondary btn-sm px-3 mx-2" (click)="editCancel()">{{\'component.participant.clickCancel\'|wfLocale}}</button>\r\n  <button type="button" class="btn btn-primary btn-sm px-3 mx-2" (click)="editOK()">{{\'component.participant.clickOK\'|wfLocale}}</button>\r\n</ng-template>\r\n',providers:[da,x],styles:[".container{display:flex;justify-content:space-between}.last-div{margin-left:auto}"]}]}],P.ctorParameters=function(){return[{type:a},{type:da},{type:b.ComponentFactoryResolver},{type:b.Injector},{type:i.BsModalService},{type:r.MessagerService},{type:D.ExpressionService},{type:t.HttpService},{type:b.ChangeDetectorRef,decorators:[{type:b.Optional}]},{type:String,decorators:[{type:b.Inject,args:[b.LOCALE_ID]}]},{type:undefined,decorators:[{type:b.Inject,args:[o]}]},{type:x,decorators:[{type:b.Optional}]}]},P.propDecorators={closeModal:[{type:b.Output}],submitModal:[{type:b.Output}],modalFooter:[{type:b.ViewChild,args:["iconSelectFooter"]}],dropDownE2:[{type:b.ViewChild,args:["dropdownE2"]}],editFooter:[{type:b.ViewChild,args:["editFooter"]}],potentialOwnerGrid:[{type:b.ViewChild,args:["potentialOwnerGrid"]}],editorParams:[{type:b.Input}]};Wo=P;function P(e,t,r,i,n,o,a,s,l,c,p,d){var u=this;this.designerUIState=e,this.uistate=t,this.resolver=r,this.injector=i,this.modalService=n,this.message=o,this.expr=a,this.http=s,this.cdr=l,this.localeId=c,this.resources=p,this.localePipe=d,this.closeModal=new b.EventEmitter,this.submitModal=new b.EventEmitter,this.editorParams={},this.nodeType="notifyActivity",this.isClose=!0,this.participant=new Ko,this.editState="new",this.type="potentialOwner",this.operatorCollection=[{text:this.localePipe.transform("component.participant.currentUser"),value:"currentUser"},{text:this.localePipe.transform("component.participant.procInstCreator"),value:"procInstCreator"}],this.columns=[{field:"order",width:25,title:this.localePipe.transform("component.participant.order"),editor:{type:g.EditorTypes.NUMBERBOX,options:{}}},{field:"type",width:50,title:this.localePipe.transform("component.participant.type"),formatter:{type:"enum",options:{valueField:"value",textField:"text",data:this.uistate.typeCollection}}},{field:"performerName",width:50,title:this.localePipe.transform("component.participant.performerName"),showTips:!0,formatter:function(e,t,r){switch(t.type){case"wf.UserParticipantExpression":return t.performerName;case"wf.VariableParticipantExpression":return t.name;case"wf.PositionParticipantExpression":return t.performerName;case"wf.ComponentParticipantExpression":return t.name;case"wf.ReportingLineParticipantExpression":return t.reportingLineDefName+"-"+t.dimension;case"wf.MatrixParticipantExpression":return t.matrixDefName+"-"+t.dataFieldAlias;case"wf.ActivityExecutorParticipantExpression":return t.performerName;case"wf.OrganizationParticipantExpression":return t.organizationName;default:return""}}},{field:"description",width:100,title:this.localePipe.transform("component.participant.description"),showTips:!0,formatter:function(e,t,r){switch(t.type){case"wf.UserParticipantExpression":return u.getUserPerformerDescription(t);case"wf.VariableParticipantExpression":return u.getVariablePerformerDescription(t);case"wf.PositionParticipantExpression":return u.getPositionPerformerDescription(t);case"wf.ComponentParticipantExpression":return u.getComponentPerformerDescription(t);case"wf.ReportingLineParticipantExpression":return u.getReportingLinePerformerDescription(t);case"wf.MatrixParticipantExpression":return u.getMatrixPerformerDescription(t);case"wf.ActivityExecutorParticipantExpression":return t.performerName;case"wf.OrganizationParticipantExpression":return t.organizationName+"，且"+(t.includeChildren?"包含下级":"不包含下级");default:return""}}},{field:"condition",width:60,title:this.localePipe.transform("component.participant.condition"),showTips:!0,editor:{type:"input-group",options:{groupText:'<i class="f-icon f-icon-lookup"></i>',editable:!1,clickHandle:function(e){e.formControl.setValue(e.instance.value||""),u.editConditon(e)}}}}],this.localePipe=this.localePipe||new x(c,p),this.GetOrganizationType()}Object.defineProperty(fa.prototype,"value",{set:function(e){var t,r=this;this.action=e.action,this.action===this.actionCollection[2].value&&(null===e.enable||e.enable===undefined)?this.enable=!0:this.enable=e.enable,e.scope?(this.alternativeParticipant.participant.isAllScope=!0,(t=new ho).actionScope=e.action,e.scope.organizationLevel===jo&&"expression"===e.scope.tag?(t.organizationLevel=Ho,t.tag=e.scope.tag,this.organizationLevel=Ho):e.scope.organizationLevel&&(this.organizationLevel=e.scope.organizationLevel),this.includeChildren=e.scope.includeChildren,t.includeChildren=e.scope.includeChildren,this.organizationId=e.scope.organizationId,t.organizationId=e.scope.organizationId,t.organizationName=this.organizationLevelCollection.find(function(e){return e.value===r.organizationLevel}).text,this.alternativeParticipant.addOrganizationParticipant(t),e.scope.participantInfo?this.alternativeParticipant.participant=e.scope.participantInfo:this.alternativeParticipant.participant=new Ko):this.alternativeParticipant.participant.isAllScope=!1},enumerable:!0,configurable:!0}),fa.prototype.ngOnInit=function(){},fa.prototype.clickOK=function(){var e,t;this.validate()&&((e=new Lo).enable=this.enable,e.action=this.action,this.alternativeParticipant.participant.isAllScope&&((t=new Fo).actionScope=this.action,e.scope=t,e.scope.participantInfo=this.alternativeParticipant.participant),this.submitModal.emit({value:e,parameters:null}))},fa.prototype.clickCancel=function(){this.closeModal.emit()},fa.prototype.validate=function(){return!(this.alternativeParticipant.participant.isAllScope&&(!this.alternativeParticipant.participant.potentialOwnerList||this.alternativeParticipant.participant.potentialOwnerList.length<=0)&&(this.message.info(this.localePipe.transform("component.orgPotentialOwner.turnOffPrompt")),1))},fa.prototype.valueChange=function(e){switch(e.value){case this.organizationLevelCollection[0].value:this.includeChildren=!1;break;case this.organizationLevelCollection[1].value:this.includeChildren=!0;break;case this.organizationLevelCollection[2].value:this.includeChildren=!1;break;case this.organizationLevelCollection[3].value:this.includeChildren=!0,this.organizationId=""}},fa.prototype.clear=function(e){this.organizationId=""},fa.prototype.selectValue=function(e){this.showExprHelp()},fa.prototype.showExprHelp=function(){var e,t,r,i,n,o,a,s,l,c,p=this,d=new Array;if(this.expr.setEditPattern(D.ExprEditMode.Advanced),0<this.designerUIState.schemas.length){try{for(var u=ue(this.designerUIState.schemas),m=u.next();!m.done;m=u.next()){var f=m.value;this.expr.addSchema("Schema",f)}}catch(S){e={error:S}}finally{try{m&&!m.done&&(c=u["return"])&&c.call(u)}finally{if(e)throw e.error}}this.designerUIState.schemas[0].entityTypes&&0<this.designerUIState.schemas[0].entityTypes.length&&(c=this.designerUIState.schemas[0].entityTypes[0],this.expr.addInjectedEntity(c.name,"Schema",c.name,D.InjectedType.EntityType))}if(0<this.designerUIState.participantContext.length)try{for(var h=ue(this.designerUIState.participantContext),y=h.next();!y.done;y=h.next()){var g=y.value;d.push(g)}}catch(E){t={error:E}}finally{try{y&&!y.done&&(r=h["return"])&&r.call(h)}finally{if(t)throw t.error}}if(0<this.designerUIState.processVariableContext.length)try{for(var v=ue(this.designerUIState.processVariableContext),b=v.next();!b.done;b=v.next())!function(t){d.some(function(e){return e.key===t.key})||d.push(t)}(g=b.value)}catch(T){i={error:T}}finally{try{b&&!b.done&&(n=v["return"])&&n.call(v)}finally{if(i)throw i.error}}if(0<this.designerUIState.subActivityContext.length)try{for(var x=ue(this.designerUIState.subActivityContext),w=x.next();!w.done;w=x.next())!function(t){d.some(function(e){return e.key===t.key})||d.push(t)}(g=w.value)}catch(A){o={error:A}}finally{try{w&&!w.done&&(a=x["return"])&&a.call(x)}finally{if(o)throw o.error}}if(0<d.length)try{for(var P=ue(d),C=P.next();!C.done;C=P.next()){var I=C.value;this.expr.addContext(I)}}catch(k){s={error:k}}finally{try{C&&!C.done&&(l=P["return"])&&l.call(P)}finally{if(s)throw s.error}}this.organizationId?this.expr.addExpressionText(this.organizationId):this.expr.addExpressionText(""),this.expr.buildExpression().then(function(e){e&&(p.organizationId=e,p.organizationLevelCollection[3].orgId=e),0<d.length&&(p.expr.exprEntity.contextEntities=p.expr.exprEntity.contextEntities.filter(function(t){return!d.some(function(e){return e.key===t.key})}))})},fa.decorators=[{type:b.Component,args:[{selector:"app-organization-potential-owner",template:'<div class="f-page">\r\n  <div class="f-utils-fill-flex-column farris-split-section m-2 h-100 farris-overflow-y-auto farris-overflow-y-auto">\r\n    <section class="f-utils-fill-flex-column h-100">\r\n      <div class="f-utils-fill-flex-column h-100 farris-overflow-y-auto" style="border-radius:16px;border: 1.5px solid #F1F3F7;">\r\n        <div class="farris-form form-inline farris-form-inline">\r\n          <div class="col-12 farris-group-auto my-3 pr-5">\r\n            <div class="farris-group-wrap">\r\n              <div class="form-group farris-form-group">\r\n                <label class="col-form-label" style="width: 5.3rem">\r\n                  <span class="farris-label-text">{{(\'component.orgPotentialOwner.enable\'|wfLocale) + actionName()}}</span>\r\n                </label>\r\n                <div class="farris-input-wrap ml-1">\r\n                  <farris-switch [(ngModel)]="enable" name="enable"></farris-switch>\r\n                  <div class="farris-feedback valid-feedback"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class="col-12 farris-group-auto my-3 pr-5">\r\n            <wf-alternative-participant [editorParams] = "editorParams.nodeType">\r\n            </wf-alternative-participant>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </section>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type="button" class="btn btn-secondary btn-sm mx-2" (click)="clickCancel()">{{\'component.orgPotentialOwner.clickCancel\'|wfLocale}}</button>\r\n  <button type="button" class="btn btn-primary btn-sm mx-2" (click)="clickOK()">{{\'component.orgPotentialOwner.clickOK\'|wfLocale}}</button>\r\n</ng-template>\r\n',providers:[x],styles:[".title-content{color:#000;display:inline-flex;align-items:center;line-height:1.375rem;position:relative;overflow:hidden;padding:0 0 0 1rem;min-width:390px}.title-content ::before{content:'';width:.25rem;height:1.125rem;background:#59a1ff;border-radius:1px;position:absolute;top:50%;left:0;margin-top:-.5625rem}.title-text{font-size:1rem;line-height:1.375rem;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;margin-bottom:0;margin-right:10px}.title-line{flex-grow:1;border-bottom:1px dashed rgba(0,0,0,.1)}"]}]}],fa.ctorParameters=function(){return[{type:b.ChangeDetectorRef,decorators:[{type:b.Optional}]},{type:String,decorators:[{type:b.Inject,args:[b.LOCALE_ID]}]},{type:undefined,decorators:[{type:b.Inject,args:[o]}]},{type:x,decorators:[{type:b.Optional}]},{type:D.ExpressionService},{type:r.MessagerService},{type:a}]},fa.propDecorators={cls:[{type:b.HostBinding,args:["class"]}],closeModal:[{type:b.Output}],submitModal:[{type:b.Output}],editorParams:[{type:b.Input}],alternativeParticipant:[{type:b.ViewChild,args:[Wo]}],value:[{type:b.Input}],modalFooter:[{type:b.ViewChild,args:["iconSelectFooter"]}]};var ma=fa;function fa(e,t,r,i,n,o,a){var s=this;this.cdr=e,this.localeId=t,this.resources=r,this.localePipe=i,this.expr=n,this.message=o,this.designerUIState=a,this.cls="farris-main-area flex-column",this.closeModal=new b.EventEmitter,this.submitModal=new b.EventEmitter,this.editorParams={},this.organizationLevelCollection=[{value:"GLOBAL",text:this.localePipe.transform("component.orgPotentialOwner.global"),orgId:"global"},{value:"UNIT",text:this.localePipe.transform("component.orgPotentialOwner.currentUnit"),orgId:"currentUnit"},{value:"DEPARTMENT",text:this.localePipe.transform("component.orgPotentialOwner.currentDepartment"),orgId:"currentDepartment"},{value:"VARORGANIZATION",text:this.localePipe.transform("component.orgPotentialOwner.variableOrganization"),orgId:""}],this.actionCollection=[{value:Bo,name:this.localePipe.transform("component.orgPotentialOwner.addSignBehind")},{value:zo,name:this.localePipe.transform("component.orgPotentialOwner.addSignFront")},{value:Vo,name:this.localePipe.transform("component.orgPotentialOwner.transfer")},{value:Uo,name:this.localePipe.transform("component.orgPotentialOwner.notify")}],this.enable=!1,this.organizationLevel=this.organizationLevelCollection[0].value,this.action=this.actionCollection[0].value,this.includeChildren=!1,this.organizationId="",this.showClearButton=!1,this.actionName=function(){return s.actionCollection.find(function(e){return e.value===s.action}).name},this.modalConfig={title:this.localePipe.transform("component.orgPotentialOwner.optionSettings"),width:760,height:506,showButtons:!0},this.localePipe=this.localePipe||new x(t,r)}ya.prototype.convertTo=function(e){return e&&e.action===Vo&&(null===e.enable||e.enable===undefined)||e&&e.enable?this.localePipe.transform("component.orgPotentialOwner.set"):this.localePipe.transform("component.orgPotentialOwner.notSet")};var ha=ya;function ya(e){this.localePipe=e}var ga=function(){this.isAnonymity=!1,this.anonymous="审批人"},va=(Object.defineProperty(ba.prototype,"value",{set:function(e){this.anonymousSet.isAnonymity=e.isAnonymity||!1,this.anonymousSet.anonymous=e.anonymous||this.localePipe.transform("component.anonymousSet.approver")},enumerable:!0,configurable:!0}),ba.prototype.ngOnInit=function(){},ba.prototype.clickOK=function(){var e={value:this.anonymousSet,parameters:null};this.submitModal.emit(e)},ba.prototype.clickCancel=function(){this.closeModal.emit()},ba.decorators=[{type:b.Component,args:[{selector:"lib-anonymous-set",template:'<div class="f-page">\r\n  <div class="f-utils-fill-flex-column farris-split-section m-2 h-100">\r\n    <section class="f-utils-fill-flex-column h-100">\r\n      <div class="f-section-header pt-2 mx-2">\r\n        <div class="f-title">\r\n          <h4 class="f-title-text">{{\'component.anonymousSet.anonymousSet\'|wfLocale}}</h4>\r\n        </div>\r\n      </div>\r\n      <div class="f-utils-fill-flex-column h-100">\r\n        <div class="farris-form form-inline farris-form-inline">\r\n          <div class="col-12 farris-group-auto my-3 pr-5">\r\n            <div class="farris-group-wrap">\r\n              <div class="form-group farris-form-group">\r\n                <label class="col-form-label">\r\n                  <span class="farris-label-text">{{\'component.anonymousSet.isAnonymity\'|wfLocale}}</span>\r\n                </label>\r\n                <div class="farris-input-wrap ml-1">\r\n                  <farris-switch [(ngModel)]="anonymousSet.isAnonymity" name="isAnonymity"></farris-switch>\r\n                  <div class="farris-feedback valid-feedback"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class="col-12 farris-group-auto mt-4 pr-5">\r\n            <div class="farris-group-wrap">\r\n              <div class="form-group farris-form-group">\r\n                <label class="col-form-label">\r\n                  <span class="farris-label-text">{{\'component.anonymousSet.anonymous\'|wfLocale}}</span>\r\n                </label>\r\n                <div class="farris-input-wrap ml-1">\r\n                  <textarea class="form-control" type="text" value="anonymous" [(ngModel)]="anonymousSet.anonymous" name="anonymous"\r\n                  style="height: 50px;" [readOnly]="!anonymousSet.isAnonymity"></textarea>\r\n                  <div class="farris-feedback valid-feedback"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </section>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type="button" class="btn btn-secondary btn-sm mx-2" (click)="clickCancel()">{{\'component.anonymousSet.clickCancel\'|wfLocale}}</button>\r\n  <button type="button" class="btn btn-primary btn-sm mx-2" (click)="clickOK()">{{\'component.anonymousSet.clickOK\'|wfLocale}}</button>\r\n</ng-template>\r\n',providers:[x],styles:[""]}]}],ba.ctorParameters=function(){return[{type:b.Injector},{type:b.ChangeDetectorRef,decorators:[{type:b.Optional}]},{type:String,decorators:[{type:b.Inject,args:[b.LOCALE_ID]}]},{type:undefined,decorators:[{type:b.Inject,args:[o]}]},{type:x,decorators:[{type:b.Optional}]}]},ba.propDecorators={cls:[{type:b.HostBinding,args:["class"]}],closeModal:[{type:b.Output}],submitModal:[{type:b.Output}],value:[{type:b.Input}],modalFooter:[{type:b.ViewChild,args:["iconSelectFooter"]}]},ba);function ba(e,t,r,i,n){this.injector=e,this.cdr=t,this.localeId=r,this.resources=i,this.localePipe=n,this.cls="farris-main-area flex-column",this.closeModal=new b.EventEmitter,this.submitModal=new b.EventEmitter,this.anonymousSet=new ga,this.modalConfig={title:this.localePipe.transform("component.anonymousSet.anonymousOpt"),width:450,height:360,showButtons:!0},this.localePipe=this.localePipe||new x(r,i)}wa.prototype.convertTo=function(e){return e&&e.isAnonymity?this.localePipe.transform("component.anonymousSet.set"):this.localePipe.transform("component.anonymousSet.notSet")};var xa=wa;function wa(e){this.localePipe=e}var Pa=function(){},Ca=(Ia.prototype.ngOnInit=function(){var e=this;this.columns=[{field:"variableCode",width:90,title:this.localePipe.transform("component.variableSetting.varNumber"),sortable:!0,validators:[{type:"required",messager:"必填"}]},{field:"variableName",width:90,title:this.localePipe.transform("component.variableSetting.varName"),sortable:!0,validators:[{type:"required",messager:"必填"}]},{field:"tag",width:60,title:this.localePipe.transform("component.variableSetting.valueType"),sortable:!0,formatter:{type:"enum",options:{valueField:"value",textField:"text",data:this.tags}},editor:{type:g.EditorTypes.COMBOLIST,options:{valueField:"value",textField:"text",data:this.tags,idField:"value",panelHeight:"auto",showClear:!1,selectChange:function(t){e.value=e.value.map(function(e){return e.variableCode===t.rowId&&(e.value=null,e.valueText=null,e.component)&&(e.component=null),e})}}},validators:[{type:"required",messager:"必填"}]},{field:"executionTime",width:80,title:this.localePipe.transform("component.variableSetting.executionTime"),sortable:!0,formatter:{type:"enum",options:{valueField:"value",textField:"text",data:this.opportunities}},editor:{type:g.EditorTypes.COMBOLIST,options:{valueField:"value",textField:"text",data:this.opportunities,idField:"value",panelHeight:"auto",showClear:!1}},validators:[{type:"required",messager:"必填"}]},{field:"valueText",width:150,title:this.localePipe.transform("component.variableSetting.valueText"),showTips:!0,editor:{type:g.EditorTypes.TEXTBOX,options:{}},validators:[{type:"required",messager:"必填"}]}]},Ia.prototype.add=function(){var a=this,e=this.resolver.resolveComponentFactory(xr).create(this.injector),t=(e.instance.variableSetting=!0,e.instance.value=this.uistate.ProcessVariables,e.instance.selectedValue=this.value,e.instance.variableSetEmitter.subscribe(function(e){var t,r;try{for(var i=ue(e),n=i.next();!n.done;n=i.next())!function(e){var t=new Pa;t.variableCode=e.data.name,t.variableName=e.data.documentation,t.tag=e.data.tag||a.tags[0].value,t.executionTime=e.data.executionTime||a.opportunities[0].value,-1===a.value.findIndex(function(e){return e.variableCode===t.variableCode})&&(a.value=a.value.concat([t]))}(n.value)}catch(o){t={error:o}}finally{try{n&&!n.done&&(r=i["return"])&&r.call(i)}finally{if(t)throw t.error}}s.close()}),e.instance.closeModal.subscribe(function(e){s.close()}),{title:this.localePipe.transform("component.variableSetting.processVariables"),width:660,height:460,showButtons:!0,buttons:e.instance.modalFooter}),s=this.modalService.show(e,t)},Ia.prototype["delete"]=function(){this.grid.endCellEdit();var t=this.grid.selectedRow;t?this.value=this.value.filter(function(e){return e.variableCode!==t.data.variableCode}):this.message.info(this.localePipe.transform("component.variableSetting.notSelectedVar"))},Ia.prototype.clickOK=function(){var t=this;this.grid.endCellEdit(),setTimeout(function(){var e;t.validator()&&(e={value:t.value,parameters:null},t.submitModal.emit(e))},300)},Ia.prototype.clickCancel=function(){this.closeModal.emit()},Ia.prototype.validator=function(){var e,t;try{for(var r=ue(this.value),i=r.next();!i.done;i=r.next())if(!i.value.value)return this.message.warning(this.localePipe.transform("component.variableSetting.valueCannotEmpty")),!1}catch(n){e={error:n}}finally{try{i&&!i.done&&(t=r["return"])&&t.call(r)}finally{if(e)throw e.error}}return!0},Ia.prototype.endEdit=function(e){"valueText"===e.column.field&&e.rowData.tag===this.tags[0].value&&(e.rowData.value=e.rowData.valueText)},Ia.prototype.valueEdit=function(e){switch(e.rowData.tag){case this.tags[1].value:this.editExpression(e);break;case this.tags[2].value:this.editComponent(e)}},Ia.prototype.editExpression=function(t){var e,r,i,n,o,a,s=this,l=t.rowData;if(0<this.uistate.schemas.length){try{for(var c=ue(this.uistate.schemas),p=c.next();!p.done;p=c.next()){var d=p.value;this.expr.addSchema("Schema",d)}}catch(v){e={error:v}}finally{try{p&&!p.done&&(a=c["return"])&&a.call(c)}finally{if(e)throw e.error}}this.uistate.schemas[0].entityTypes&&0<this.uistate.schemas[0].entityTypes.length&&(a=this.uistate.schemas[0].entityTypes[0],this.expr.addInjectedEntity(a.name,"Schema",a.name,D.InjectedType.EntityType))}var u=new Array,u=this.uistate.addContext(u);if(0<this.uistate.subActivityContext.length)try{for(var m=ue(this.uistate.subActivityContext),f=m.next();!f.done;f=m.next())!function(t){u.some(function(e){return e.key===t.key})||u.push(t)}(f.value)}catch(b){r={error:b}}finally{try{f&&!f.done&&(i=m["return"])&&i.call(m)}finally{if(r)throw r.error}}if(0<u.length)try{for(var h=ue(u),y=h.next();!y.done;y=h.next()){var g=y.value;this.expr.addContext(g)}}catch(x){n={error:x}}finally{try{y&&!y.done&&(o=h["return"])&&o.call(h)}finally{if(n)throw n.error}}this.expr.setEditPattern(D.ExprEditMode.Advanced),this.expr.addExpressionText(l.value),this.expr.buildExpression().then(function(e){t.formControl.setValue(e),t.instance.cd.detectChanges(),l.value=e,t.form.bindingData.value=e,t.form.value.value=e,0<u.length&&(s.expr.exprEntity.contextEntities=s.expr.exprEntity.contextEntities.filter(function(t){return!u.some(function(e){return e.key===t.key})}))})},Ia.prototype.editComponent=function(t){var r=t.rowData,e=this.resolver.resolveComponentFactory(vr).create(this.injector),i=(e.instance.component=r.component,e.instance.submitEmitter.subscribe(function(e){t.formControl.setValue(e.Name+"-"+e.MethodCode),t.instance.cd.detectChanges(),r.value=e.Id,r.component=e,t.form.bindingData.value=e.Id,t.form.value.value=e.Id,t.form.value.component=e,t.form.bindingData.component=e,n.close()}),e.instance.closeEmitter.subscribe(function(e){n.close()}),{title:this.localePipe.transform("component.variableSetting.component"),width:800,height:515,showButtons:!0,buttons:e.instance.footer}),n=this.modalService.show(e,i)},Ia.decorators=[{type:b.Component,args:[{selector:"lib-variable-setting",template:'<div class="f-page">\r\n  <div class="f-page-header">\r\n    <nav class="f-page-header-base">\r\n      <div class="f-title">\r\n      </div>\r\n      <div class="btn-toolbar btn-group-lg">\r\n        <button class="btn btn-primary mr-2" (click)="add()">{{\'component.variableSetting.add\' | wfLocale}}</button>\r\n        <button class="btn btn-secondary" (click)="delete()">{{\'component.variableSetting.delete\' | wfLocale}}</button>\r\n      </div>\r\n    </nav>\r\n  </div>\r\n  <div class="f-page-main f-utils-fill-flex-column h-100">\r\n    <div class="f-utils-fill-flex-column farris-overflow-y-auto h-100">\r\n      <farris-datagrid #grid [data]="value" [columns]="columns" [idField]="\'variableCode\'" [fit]="true" [fitColumns]="true"\r\n        [editable]="true" [editMode]="\'cell\'" [pagination]="false" [showCheckbox]="false" [multiSelect]="false"\r\n        [showLineNumber]="true" lineNumberTitle="{{\'component.variableSetting.lineNumber\' | wfLocale}}" [lineNumberWidth]="50" [striped]="true"\r\n        (endEdit)="endEdit($event)" [beforeEdit]="beforeEdit">\r\n      </farris-datagrid>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type="button" class="btn btn-secondary btn-sm px-3 mx-2" (click)="clickCancel()">{{\'component.variableSetting.clickCancel\' | wfLocale}}</button>\r\n  <button type="button" class="btn btn-primary btn-sm px-3 mx-2" (click)="clickOK()">{{\'component.variableSetting.clickOK\' | wfLocale}}</button>\r\n</ng-template>\r\n\r\n<ng-template #cell let-ctx>\r\n  <span (click)="valueEdit(ctx)" class="link">\r\n    {{ ctx.rowData.value ? (\'component.variableSetting.set\' | wfLocale) : (\'component.variableSetting.notSet\' | wfLocale) }}\r\n  </span>\r\n</ng-template>\r\n',providers:[x],styles:[".link{color:#1206bb;font-size:14px}.link:hover{color:#5d478b;font-size:14px}"]}]}],Ia.ctorParameters=function(){return[{type:b.ComponentFactoryResolver},{type:b.Injector},{type:i.BsModalService},{type:r.MessagerService},{type:a},{type:D.ExpressionService},{type:b.ChangeDetectorRef,decorators:[{type:b.Optional}]},{type:String,decorators:[{type:b.Inject,args:[b.LOCALE_ID]}]},{type:undefined,decorators:[{type:b.Inject,args:[o]}]},{type:x,decorators:[{type:b.Optional}]}]},Ia.propDecorators={cls:[{type:b.HostBinding,args:["class"]}],closeModal:[{type:b.Output}],submitModal:[{type:b.Output}],value:[{type:b.Input}],editorParams:[{type:b.Input}],modalFooter:[{type:b.ViewChild,args:["iconSelectFooter"]}],grid:[{type:b.ViewChild,args:["grid"]}],cell:[{type:b.ViewChild,args:["cell"]}]},Ia);function Ia(e,t,r,i,n,o,a,s,l,c){var p=this;this.resolver=e,this.injector=t,this.modalService=r,this.message=i,this.uistate=n,this.expr=o,this.cdr=a,this.localeId=s,this.resources=l,this.localePipe=c,this.cls="farris-main-area flex-column",this.closeModal=new b.EventEmitter,this.submitModal=new b.EventEmitter,this.value=new Array,this.editorParams={},this.columns=[],this.tags=[{value:"constant",text:this.localePipe.transform("component.variableSetting.constant")},{value:"expression",text:this.localePipe.transform("component.variableSetting.expression")},{value:"component",text:this.localePipe.transform("component.variableSetting.component")}],this.opportunities=[{value:"ACTIVITY_STARTED",text:this.localePipe.transform("component.variableSetting.ACTIVITY_STARTED")},{value:"ACTIVITY_COMPLETED",text:this.localePipe.transform("component.variableSetting.ACTIVITY_COMPLETED")}],this.modalConfig={title:this.localePipe.transform("component.variableSetting.varAssign"),width:780,height:460,showButtons:!0},this.beforeEdit=function(e){var t=e.rowData;return"valueText"===e.column.field&&(t.tag===p.tags[0].value?e.column.editor={type:g.EditorTypes.TEXTBOX,options:{}}:e.column.editor={type:"input-group",options:{groupText:'<i class="f-icon f-icon-lookup"></i>',editable:!1,showClear:!1,clickHandle:function(e){e.formControl.setValue(e.instance.value||""),p.valueEdit(e)},clear:function(e){console.log("clear",e)}}}),v.of(!0)},this.localePipe=this.localePipe||new x(s,l)}Ea.prototype.convertTo=function(e){return e&&0<e.length?this.localePipe.transform("component.variableSetting.set"):this.localePipe.transform("component.variableSetting.notSet")};var Sa=Ea;function Ea(e){this.localePipe=e}var Ta=function(){this.localePipe=null,this.enable=!1,this.title="审批要点",this.approvalPivots=new Array},Aa=function(){this.id=l.GenerateElementId(),this.type="REMIND"},ka=(Object.defineProperty(Oa.prototype,"value",{set:function(e){var t,r;if(this.config.localePipe=this.localePipe,e&&(this.config.enable=e.enable,this.config.title=e.title,this.config.expand=e.expand,e.approvalPivots)&&0<e.approvalPivots.length)try{for(var i=ue(e.approvalPivots),n=i.next();!n.done;n=i.next()){var o=n.value,a=new Aa;a.type=o.type,a.title=o.title,a.description=o.description,o.condition&&("string"==typeof o.condition?a.condition=o.condition:a.condition=o.condition._value),this.config.approvalPivots=this.config.approvalPivots.concat([a])}}catch(s){t={error:s}}finally{try{n&&!n.done&&(r=i["return"])&&r.call(i)}finally{if(t)throw t.error}}},enumerable:!0,configurable:!0}),Oa.prototype.ngOnInit=function(){},Oa.prototype.add=function(){var e=new Aa;this.config.approvalPivots=this.config.approvalPivots.concat([e])},Oa.prototype["delete"]=function(){var t=this.grid.selectedRow;t?this.config.approvalPivots=this.config.approvalPivots.filter(function(e){return e.id!==t.id}):this.message.info(this.localePipe.transform("component.approvalPivot.selectedRow"))},Oa.prototype.clickOK=function(){var e;!this.config.title&&this.config.enable?this.message.info(this.localePipe.transform("component.approvalPivot.configTitle")):(this.grid.endCellEdit(),this.validator()&&(e={value:this.config,parameters:null},this.submitModal.emit(e)))},Oa.prototype.clickCancel=function(){this.closeModal.emit()},Oa.prototype.validator=function(){return!0},Oa.prototype.editConditon=function(t){var e,r,i,n,o,a,s,l,c=this,p=new Array;if(0<this.designerUIState.schemas.length){try{for(var d=ue(this.designerUIState.schemas),u=d.next();!u.done;u=d.next()){var m=u.value;this.expr.addSchema("Schema",m)}}catch(w){e={error:w}}finally{try{u&&!u.done&&(l=d["return"])&&l.call(d)}finally{if(e)throw e.error}}this.designerUIState.schemas[0].entityTypes&&0<this.designerUIState.schemas[0].entityTypes.length&&(l=this.designerUIState.schemas[0].entityTypes[0],this.expr.addInjectedEntity(l.name,"Schema",l.name,D.InjectedType.EntityType))}if(p=this.designerUIState.addContext(p),0<this.designerUIState.subActivityContext.length)try{for(var f=ue(this.designerUIState.subActivityContext),h=f.next();!h.done;h=f.next())!function(t){p.some(function(e){return e.key===t.key})||p.push(t)}(h.value)}catch(P){r={error:P}}finally{try{h&&!h.done&&(i=f["return"])&&i.call(f)}finally{if(r)throw r.error}}if(0<this.designerUIState.activityComponentContext.length)try{for(var y=ue(this.designerUIState.activityComponentContext),g=y.next();!g.done;g=y.next())!function(t){p.some(function(e){return e.key===t.key})||p.push(t)}(g.value)}catch(C){n={error:C}}finally{try{g&&!g.done&&(o=y["return"])&&o.call(y)}finally{if(n)throw n.error}}if(0<p.length)try{for(var v=ue(p),b=v.next();!b.done;b=v.next()){var x=b.value;this.expr.addContext(x)}}catch(I){a={error:I}}finally{try{b&&!b.done&&(s=v["return"])&&s.call(v)}finally{if(a)throw a.error}}this.expr.addExpressionText(t.instance.value),this.expr.setEditPattern(D.ExprEditMode.Conditional),this.expr.buildExpression().then(function(e){t.formControl.setValue(e),t.instance.cd.detectChanges(),0<p.length&&(c.expr.exprEntity.contextEntities=c.expr.exprEntity.contextEntities.filter(function(t){return!p.some(function(e){return e.key===t.key})}))})},Oa.decorators=[{type:b.Component,args:[{selector:"lib-approval-pivot",template:'<div class="f-page">\r\n  <section class="f-page-main d-flex flex-column">\r\n    <farris-section class="pt-0 f-section-form f-section-in-mainsubcard" mainTitle="{{\'component.approvalPivot.approvalPivot\'|wfLocale}}" [enableAccordion]="\'default\'"\r\n      [enableMaximize]="false">\r\n      <div class="wf-process-pivot">\r\n        <div class="wf-process-pivot-actions">\r\n          <span class="wf-process-pivot-actions-text">{{\'component.approvalPivot.enable\'|wfLocale}}</span>\r\n          <farris-switch [(ngModel)]="config.enable" name="enable"></farris-switch>\r\n        </div>\r\n        <div class="wf-process-pivot-actions">\r\n          <span class="wf-process-pivot-actions-text">{{\'component.approvalPivot.expand\'|wfLocale}}</span>\r\n          <farris-switch [(ngModel)]="config.expand" name="expand" [disabled]="!config.enable"></farris-switch>\r\n        </div>\r\n        <div class="wf-process-pivot-actions">\r\n          <span class="farris-label-info text-danger">*</span>\r\n          <span class="wf-process-pivot-actions-text">{{\'component.approvalPivot.showTitle\'|wfLocale}}</span>\r\n          <div class="farris-input-wrap">\r\n            <input type="text" class="form-control" [(ngModel)]="config.title" name="title" [readonly]="!config.enable"/>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </farris-section>\r\n    <farris-section class="pt-0 f-section-grid f-section-in-managelist" mainTitle="{{\'component.approvalPivot.list\'|wfLocale}}" [enableAccordion]="\'\'"\r\n      [enableMaximize]="false" [fill]="true">\r\n      <ng-template farrisSectionToolbar>\r\n        <button class="btn btn-link pr-2 mr-2" (click)="add()" [disabled]="!config.enable">{{\'component.approvalPivot.add\'|wfLocale}}</button>\r\n        <button class="btn btn-link mr-0" (click)="delete()" [disabled]="!config.enable">{{\'component.approvalPivot.delete\'|wfLocale}}</button>\r\n      </ng-template>\r\n      <farris-datagrid class="f-component-grid" [columns]="columns" [data]="config.approvalPivots" #grid [idField]="\'id\'" [showLineNumber]="true"\r\n        [striped]="true" [showCheckbox]="false" [pagination]="false" [fit]="true" [fitColumns]="true" [editable]="true" [editMode]="\'cell\'"\r\n        [multiSelect]="false" [disabled]="!config.enable">\r\n      </farris-datagrid>\r\n    </farris-section>\r\n  </section>\r\n</div>\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type="button" class="btn btn-secondary btn-sm px-3" (click)="clickCancel()">{{\'component.approvalPivot.clickCancel\'|wfLocale}}</button>\r\n  <button type="button" class="btn btn-primary btn-sm px-3 mx-2" (click)="clickOK()">{{\'component.approvalPivot.clickOK\'|wfLocale}}</button>\r\n</ng-template>\r\n',providers:[x],styles:[".wf-process-pivot{display:flex;align-items:center;margin-bottom:20px}.wf-process-pivot-actions{display:flex;padding-left:30px;align-items:center}.wf-process-pivot-actions-text{padding-right:10px}"]}]}],Oa.ctorParameters=function(){return[{type:a},{type:D.ExpressionService},{type:r.MessagerService},{type:b.ChangeDetectorRef,decorators:[{type:b.Optional}]},{type:String,decorators:[{type:b.Inject,args:[b.LOCALE_ID]}]},{type:undefined,decorators:[{type:b.Inject,args:[o]}]},{type:x,decorators:[{type:b.Optional}]}]},Oa.propDecorators={cls:[{type:b.HostBinding,args:["class"]}],closeModal:[{type:b.Output}],submitModal:[{type:b.Output}],modalFooter:[{type:b.ViewChild,args:["iconSelectFooter"]}],grid:[{type:b.ViewChild,args:["grid"]}],value:[{type:b.Input}]},Oa);function Oa(e,t,r,i,n,o,a){var s=this;this.designerUIState=e,this.expr=t,this.message=r,this.cdr=i,this.localeId=n,this.resources=o,this.localePipe=a,this.cls="farris-main-area flex-column",this.closeModal=new b.EventEmitter,this.submitModal=new b.EventEmitter,this.config=new Ta,this.typeList=[{value:"REMIND",text:this.localePipe.transform("component.approvalPivot.remind")}],this.columns=[{field:"type",width:80,title:this.localePipe.transform("component.approvalPivot.type"),formatter:{type:"enum",options:{valueField:"value",textField:"text",data:this.typeList}},editor:{type:g.EditorTypes.COMBOLIST,options:{valueField:"value",textField:"text",data:this.typeList,idField:"value",panelHeight:"auto",enableClear:!1}},validators:[{type:"required",messager:"必填"}]},{field:"condition",width:120,title:this.localePipe.transform("component.approvalPivot.condition"),showTips:!0,editor:{type:"input-group",options:{groupText:'<i class="f-icon f-icon-lookup"></i>',editable:!1,clickHandle:function(e){e.formControl.setValue(e.instance.value||""),s.editConditon(e)},clear:function(e){console.log("clear",e)}}}},{field:"title",width:80,title:this.localePipe.transform("component.approvalPivot.title"),editor:{type:g.EditorTypes.TEXTBOX,options:{}}},{field:"description",width:100,title:this.localePipe.transform("component.approvalPivot.description"),showTips:!0,editor:{type:g.EditorTypes.TEXTBOX,options:{}}}],this.modalConfig={title:this.localePipe.transform("component.approvalPivot.approvalPivot"),width:800,height:480,showButtons:!0},this.localePipe=this.localePipe||new x(n,o)}Da.prototype.convertTo=function(e){return e&&e.enable?this.localePipe.transform("component.approvalPivot.set"):this.localePipe.transform("component.approvalPivot.notSet")};var Ma=Da;function Da(e){this.localePipe=e}La.prototype.cconstructor=function(){this.urgeHandleAble=!1,this.earlyTime=0,this.intervalTime=0,this.urgeMessageSubject='{"expr":"\'催办审批：\' + DefaultFunction.GetContextParameter(\\"bizDefName\\")","sexpr":""}',this.urgeMessageContent='{"expr":"\'请您尽快审批\' + DefaultFunction.GetContextParameter(\\"procInstCreatorName\\") + \'的\' + DefaultFunction.GetContextParameter(\\"bizDefName\\") + \'。\'","sexpr":""}',this.addReminder=!1,this.subjectEditable=!0,this.contentEditable=!0};var Na=La;function La(){}Object.defineProperty(Ra.prototype,"value",{set:function(e){e?(this.urgeHandleRule=e,this.hasSmsMessage(this.urgeHandleRule.sendType)&&(this.hasSmsTemplate=!0,this.urgeHandleRule.smsMessageTemplate||(this.urgeHandleRule.smsMessageTemplate=new Dr))):(this.urgeHandleRule.urgeHandleAble=!0,this.urgeHandleRule.earlyTime=0,this.urgeHandleRule.intervalTime=0,this.urgeHandleRule.sendType="cloudplus,inmail",this.urgeHandleRule.urgeMessageSubject='{"expr":"\''+this.localePipe.transform("component.urgeHandleRule.urgentApproval")+'\' + DefaultFunction.GetContextParameter(\\"bizDefName\\")","sexpr":""}',this.urgeHandleRule.urgeMessageContent='{"expr":"\''+this.localePipe.transform("component.urgeHandleRule.pleaseApprove")+"' + DefaultFunction.GetContextParameter(\\\"procInstCreatorName\\\") + '"+this.localePipe.transform("component.urgeHandleRule.soOn")+'\' + DefaultFunction.GetContextParameter(\\"bizDefName\\") + \'。\'","sexpr":""}')},enumerable:!0,configurable:!0}),Ra.prototype.ngOnInit=function(){},Ra.prototype.clickOK=function(){var e;this.SmsTemplate&&this.SmsTemplate.endGridEdit(),this.hasSmsTemplate?(this.urgeHandleRule.smsMessageTemplate=this.SmsTemplate.smsMessageTemplate,this.urgeHandleRule.smsMessageTemplate.smsMessageVariables&&0<this.urgeHandleRule.smsMessageTemplate.smsMessageVariables.length&&(this.urgeHandleRule.smsMessageTemplate.smsMessageVariables=this.urgeHandleRule.smsMessageTemplate.smsMessageVariables.filter(function(e){return e.code}))):this.urgeHandleRule.smsMessageTemplate=null,this.validator()&&(e={value:this.urgeHandleRule,parameters:null},this.submitModal.emit(e))},Ra.prototype.clickCancel=function(){this.closeModal.emit()},Ra.prototype.validator=function(){return this.urgeHandleRule.sendType?this.urgeHandleRule.urgeMessageSubject?this.urgeHandleRule.urgeMessageContent?this.urgeHandleRule.earlyTime||0===this.urgeHandleRule.earlyTime?!(!this.urgeHandleRule.intervalTime&&0!==this.urgeHandleRule.intervalTime&&(this.message.info(this.localePipe.transform("component.urgeHandleRule.minimumTimeNotEmpty")),1)):(this.message.info(this.localePipe.transform("component.urgeHandleRule.earliestTimeNotEmpty")),!1):(this.message.info(this.localePipe.transform("component.urgeHandleRule.noMessageContent")),!1):(this.message.info(this.localePipe.transform("component.urgeHandleRule.noMessageSubject")),!1):(this.message.info(this.localePipe.transform("component.urgeHandleRule.noSendingMethod")),!1)},Ra.prototype.sendTypeChange=function(e){this.hasSmsMessage(e)?(this.hasSmsTemplate=!0,this.urgeHandleRule.smsMessageTemplate||(this.urgeHandleRule.smsMessageTemplate=new Dr)):(this.hasSmsTemplate=!1,this.urgeHandleRule.smsMessageTemplate=null)},Ra.prototype.titleExpr=function(e){this.showTitleHelp(e)},Ra.prototype.contentExpr=function(e){this.showContentHelp(e)},Ra.prototype.showTitleHelp=function(e){var t=this,r=this.showExpr();this.urgeHandleRule.urgeMessageSubject&&0<this.urgeHandleRule.urgeMessageSubject.length?this.expr.addExpressionText(this.urgeHandleRule.urgeMessageSubject):this.expr.addExpressionText(""),this.expr.buildExpression().then(function(e){t.urgeHandleRule.urgeMessageSubject=e,0<r.length&&(t.expr.exprEntity.contextEntities=t.expr.exprEntity.contextEntities.filter(function(t){return!r.some(function(e){return e.key===t.key})}))})},Ra.prototype.showContentHelp=function(e){var t=this,r=this.showExpr();this.urgeHandleRule.urgeMessageContent&&0<this.urgeHandleRule.urgeMessageContent.length?this.expr.addExpressionText(this.urgeHandleRule.urgeMessageContent):this.expr.addExpressionText(""),this.expr.buildExpression().then(function(e){t.urgeHandleRule.urgeMessageContent=e,0<r.length&&(t.expr.exprEntity.contextEntities=t.expr.exprEntity.contextEntities.filter(function(t){return!r.some(function(e){return e.key===t.key})}))})},Ra.prototype.showExpr=function(){var e,t,r,i,n,o,a,s,l,c;if(0<this.designerUIState.schemas.length){try{for(var p=ue(this.designerUIState.schemas),d=p.next();!d.done;d=p.next()){var u=d.value;this.expr.addSchema("Schema",u)}}catch(I){e={error:I}}finally{try{d&&!d.done&&(c=p["return"])&&c.call(p)}finally{if(e)throw e.error}}this.designerUIState.schemas[0].entityTypes&&0<this.designerUIState.schemas[0].entityTypes.length&&(c=this.designerUIState.schemas[0].entityTypes[0],this.expr.addInjectedEntity(c.name,"Schema",c.name,D.InjectedType.EntityType))}var m=new Array;if(0<this.designerUIState.urgeContext.length)try{for(var f=ue(this.designerUIState.urgeContext),h=f.next();!h.done;h=f.next()){var y=h.value;m.push(y)}}catch(S){t={error:S}}finally{try{h&&!h.done&&(r=f["return"])&&r.call(f)}finally{if(t)throw t.error}}if(0<this.designerUIState.processVariableContext.length)try{for(var g=ue(this.designerUIState.processVariableContext),v=g.next();!v.done;v=g.next())!function(t){m.some(function(e){return e.key===t.key})||m.push(t)}(y=v.value)}catch(E){i={error:E}}finally{try{v&&!v.done&&(n=g["return"])&&n.call(g)}finally{if(i)throw i.error}}if(0<this.designerUIState.subActivityContext.length)try{for(var b=ue(this.designerUIState.subActivityContext),x=b.next();!x.done;x=b.next())!function(t){m.some(function(e){return e.key===t.key})||m.push(t)}(y=x.value)}catch(T){o={error:T}}finally{try{x&&!x.done&&(a=b["return"])&&a.call(b)}finally{if(o)throw o.error}}if(0<m.length)try{for(var w=ue(m),P=w.next();!P.done;P=w.next()){var C=P.value;this.expr.addContext(C)}}catch(A){s={error:A}}finally{try{P&&!P.done&&(l=w["return"])&&l.call(w)}finally{if(s)throw s.error}}return m},Ra.prototype.hasSmsMessage=function(e){var r=this;return!!e&&!!e.split(",").find(function(t){return r.designerUIState.messageChannels.find(function(e){return e.code==t&&"Sms"==e.channelType})})},Ra.decorators=[{type:b.Component,args:[{selector:"lib-urge-handle-rule",template:'<div class="f-page">\r\n  <div class="f-utils-fill-flex-column farris-split-section m-2 h-100">\r\n    <perfect-scrollbar [config]="{}">\r\n      <form class="h-100">\r\n        <div class="f-form-layout farris-form farris-form-controls-inline farris-form-auto">\r\n          <fieldset class="f-section-formgroup">\r\n            <div class="f-section-formgroup-inputs">\r\n              <div class="col-12 mt-2">\r\n                <div class="farris-group-wrap">\r\n                  <div class="form-group farris-form-group">\r\n                    <label class="col-form-label">\r\n                      <span class="farris-label-info text-danger">*</span>\r\n                      <span class="farris-label-text">{{\'component.urgeHandleRule.enableUrgeHandle\' | wfLocale}}</span>\r\n                    </label>\r\n                    <div class="farris-input-wrap ml-1">\r\n                      <farris-switch [(ngModel)]="urgeHandleRule.urgeHandleAble" name="urgeHandleEnable"></farris-switch>\r\n                      <div class="farris-feedback valid-feedback"></div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <div class="col-10 mt-2">\r\n                <div class="farris-group-wrap">\r\n                  <div class="form-group farris-form-group">\r\n                    <label class="col-form-label">\r\n                      <span class="farris-label-info text-danger">*</span>\r\n                      <span class="farris-label-text">{{\'component.urgeHandleRule.timeSetting\' | wfLocale}}</span>\r\n                    </label>\r\n                    <label class="mb-0">\r\n                      <span class="farris-label-text">{{\'component.urgeHandleRule.earliestTime\' | wfLocale}}</span>\r\n                    </label>\r\n                    <div class="farris-input-wrap" style="width: 300px;">\r\n                      <farris-number-spinner [(ngModel)]="urgeHandleRule.earlyTime" name="earlyTime" [editable]="true" [precision]="0"\r\n                        [parser]="parser" [min]="0"></farris-number-spinner>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <div class="col-10">\r\n                <div class="farris-group-wrap">\r\n                  <div class="form-group farris-form-group">\r\n                    <label class="col-form-label">\r\n                      <span class="farris-label-text"></span>\r\n                    </label>\r\n                    <label class="mb-0">\r\n                      <span class="farris-label-text">{{\'component.urgeHandleRule.minimumInterval\' | wfLocale}}</span>\r\n                    </label>\r\n                    <div class="farris-input-wrap" style="width: 300px;">\r\n                      <farris-number-spinner [(ngModel)]="urgeHandleRule.intervalTime" name="intervalTime" [editable]="true" [precision]="0"\r\n                        [parser]="parser" [min]="0"></farris-number-spinner>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <div class="col-12 mt-2">\r\n                <div class="farris-group-wrap">\r\n                  <div class="form-group farris-form-group">\r\n                    <label class="col-form-label">\r\n                      <span class="farris-label-info text-danger">*</span>\r\n                      <span class="farris-label-text">{{\'component.urgeHandleRule.sendingMethod\' | wfLocale}}</span>\r\n                    </label>\r\n                    <div class="farris-input-wrap">\r\n                      <farris-checkboxgroup #checkboxGroup [(ngModel)]="urgeHandleRule.sendType" name="sendType" [horizontal]="true"\r\n                        [data]="typeGroup" (changeValue)="sendTypeChange($event)">\r\n                      </farris-checkboxgroup>\r\n                      <div class="farris-feedback valid-feedback"></div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <div class="col-12 mt-2">\r\n                <div class="farris-group-wrap">\r\n                  <div class="form-group farris-form-group">\r\n                    <label class="col-form-label">\r\n                      <span class="farris-label-info text-danger">*</span>\r\n                      <span class="farris-label-text">{{\'component.urgeHandleRule.messageSubject\' | wfLocale}}</span>\r\n                    </label>\r\n                    <div class="farris-input-wrap" style="width: 300px;">\r\n                      <input-group [editable]="false" [customCls]="\'custom-cls\'" [groupText]="groupIcon2"\r\n                                    [(value)]="urgeHandleRule.urgeMessageSubject" (clickHandle)="titleExpr($event)">\r\n                      </input-group>\r\n                      <div class="farris-feedback valid-feedback"></div>\r\n                    </div>\r\n                    <label class="col-form-label">\r\n                      <span class="farris-label-text">{{\'component.urgeHandleRule.supportEditing\' | wfLocale}}</span>\r\n                    </label>\r\n                    \x3c!-- 2023-6-14 在测试环境中出现按钮靠最右的情况，删除style="text-align: right"后正常 --\x3e\r\n                    <div class="farris-input-wrap">\r\n                      <farris-switch [(ngModel)]="urgeHandleRule.subjectEditable" name="enable1" size="small"></farris-switch>\r\n                      <div class="farris-feedback valid-feedback"></div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <div class="col-12 mt-2">\r\n                <div class="farris-group-wrap">\r\n                  <div class="form-group farris-form-group">\r\n                    <label class="col-form-label">\r\n                      <span class="farris-label-info text-danger">*</span>\r\n                      <span class="farris-label-text">{{\'component.urgeHandleRule.messageContent\' | wfLocale}}</span>\r\n                    </label>\r\n                    <div class="farris-input-wrap" style="width: 300px;">\r\n                      <input-group [editable]="false" [customCls]="\'custom-cls\'" [groupText]="groupIcon2"\r\n                                    [(value)]="urgeHandleRule.urgeMessageContent" (clickHandle)="contentExpr($event)">\r\n                      </input-group>\r\n                      <div class="farris-feedback valid-feedback"></div>\r\n                    </div>\r\n                    <label class="col-form-label">\r\n                      <span class="farris-label-text">{{\'component.urgeHandleRule.supportEditing\' | wfLocale}}</span>\r\n                    </label>\r\n                    <div class="farris-input-wrap">\r\n                      <farris-switch [(ngModel)]="urgeHandleRule.contentEditable" name="enable2" size="small"></farris-switch>\r\n                      <div class="farris-feedback valid-feedback"></div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <div class="col-12 mt-2">\r\n                <div class="farris-group-wrap">\r\n                  <div class="form-group farris-form-group">\r\n                    <label class="col-form-label">\r\n                      <span class="farris-label-text">{{\'component.urgeHandleRule.displayReminder\' | wfLocale}}</span>\r\n                    </label>\r\n                    <div class="farris-input-wrap">\r\n                      <farris-switch [(ngModel)]="urgeHandleRule.addReminder" name="enable" size="small"></farris-switch>\r\n                      <div class="farris-feedback valid-feedback"></div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </fieldset>\r\n        </div>\r\n        <lib-sms-message-template *ngIf="hasSmsTemplate" [smsMessageTemplate]="urgeHandleRule.smsMessageTemplate"></lib-sms-message-template>\r\n      </form>\r\n    </perfect-scrollbar>\r\n</div>\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type="button" class="btn btn-secondary btn-sm px-3" (click)="clickCancel()">{{\'component.urgeHandleRule.clickCancel\' | wfLocale}}</button>\r\n  <button type="button" class="btn btn-primary btn-sm px-3 mx-2" (click)="clickOK()">{{\'component.urgeHandleRule.clickOK\' | wfLocale}}</button>\r\n</ng-template>\r\n',providers:[x],styles:[""]}]}],Ra.ctorParameters=function(){return[{type:a},{type:D.ExpressionService},{type:r.MessagerService},{type:b.ChangeDetectorRef,decorators:[{type:b.Optional}]},{type:String,decorators:[{type:b.Inject,args:[b.LOCALE_ID]}]},{type:undefined,decorators:[{type:b.Inject,args:[o]}]},{type:x,decorators:[{type:b.Optional}]}]},Ra.propDecorators={closeModal:[{type:b.Output}],submitModal:[{type:b.Output}],modalFooter:[{type:b.ViewChild,args:["iconSelectFooter"]}],SmsTemplate:[{type:b.ViewChild,args:[Lr]}],value:[{type:b.Input}]};var Fa=Ra;function Ra(e,t,r,i,n,o,a){this.designerUIState=e,this.expr=t,this.message=r,this.cdr=i,this.localeId=n,this.resources=o,this.localePipe=a,this.groupIcon2='<i class="f-icon f-icon-lookup"></i>',this.closeModal=new b.EventEmitter,this.submitModal=new b.EventEmitter,this.urgeHandleRule=new Na,this.typeGroup=this.designerUIState.messageChannels.map(function(e){return{value:e.code,name:e.name}}),this.modalConfig={title:this.localePipe.transform("component.urgeHandleRule.urgeHandle"),width:800,height:515,showButtons:!0},this.hasSmsTemplate=!1,this.parser=function(e){return Number(e)},this.localePipe=this.localePipe||new x(n,o)}za.prototype.convertTo=function(e){return!e||e.urgeHandleAble?this.localePipe.transform("component.urgeHandleRule.set"):this.localePipe.transform("component.urgeHandleRule.notSet")};var Va=za;function za(e){this.localePipe=e}var Ba=function(e){this.checkTime=e},Ua=(Object.defineProperty(ja.prototype,"value",{set:function(e){e&&0<e.length&&(console.log(e),this.activityBeforeStarted=e.find(function(e){return"ACTIVITY_BEFORE_STARTED"===e.checkTime})||new Ba("ACTIVITY_BEFORE_STARTED"),this.activityBeforeCompleted=e.find(function(e){return"ACTIVITY_BEFORE_COMPLETED"===e.checkTime})||new Ba("ACTIVITY_BEFORE_COMPLETED"))},enumerable:!0,configurable:!0}),ja.prototype.ngOnInit=function(){},ja.prototype.editCondition=function(t){var e,r,i,n,o,a,s,l=this,c=new Array;if(0<this.designerUIState.schemas.length){try{for(var p=ue(this.designerUIState.schemas),d=p.next();!d.done;d=p.next()){var u=d.value;this.expr.addSchema("Schema",u)}}catch(w){x={error:w}}finally{try{d&&!d.done&&(s=p["return"])&&s.call(p)}finally{if(x)throw x.error}}this.designerUIState.schemas[0].entityTypes&&0<this.designerUIState.schemas[0].entityTypes.length&&(s=this.designerUIState.schemas[0].entityTypes[0],this.expr.addInjectedEntity(s.name,"Schema",s.name,D.InjectedType.EntityType))}if(c=this.designerUIState.addContext(c),0<this.designerUIState.subActivityContext.length)try{for(var m=ue(this.designerUIState.subActivityContext),f=m.next();!f.done;f=m.next())!function(t){c.some(function(e){return e.key===t.key})||c.push(t)}(f.value)}catch(P){e={error:P}}finally{try{f&&!f.done&&(r=m["return"])&&r.call(m)}finally{if(e)throw e.error}}if(0<this.designerUIState.activityComponentContext.length)try{for(var h=ue(this.designerUIState.activityComponentContext),y=h.next();!y.done;y=h.next())!function(t){c.some(function(e){return e.key===t.key})||c.push(t)}(y.value)}catch(C){i={error:C}}finally{try{y&&!y.done&&(n=h["return"])&&n.call(h)}finally{if(i)throw i.error}}if(0<c.length)try{for(var g=ue(c),v=g.next();!v.done;v=g.next()){var b=v.value;this.expr.addContext(b)}}catch(I){o={error:I}}finally{try{v&&!v.done&&(a=g["return"])&&a.call(g)}finally{if(o)throw o.error}}var x=("ACTIVITY_BEFORE_STARTED"===t?this.activityBeforeStarted:this.activityBeforeCompleted).value;this.expr.addExpressionText(x),this.expr.setEditPattern(D.ExprEditMode.Conditional),this.expr.buildExpression().then(function(e){"ACTIVITY_BEFORE_STARTED"===t?l.activityBeforeStarted.value=e:l.activityBeforeCompleted.value=e,0<c.length&&(l.expr.exprEntity.contextEntities=l.expr.exprEntity.contextEntities.filter(function(t){return!c.some(function(e){return e.key===t.key})}))})},ja.prototype.clearCondition=function(e){"ACTIVITY_BEFORE_STARTED"===e?this.activityBeforeStarted.value=null:this.activityBeforeCompleted.value=null},ja.prototype.clickOK=function(){var e=new Array;(this.activityBeforeStarted.value||this.activityBeforeStarted.errorTips)&&e.push(this.activityBeforeStarted),(this.activityBeforeCompleted.value||this.activityBeforeCompleted.errorTips)&&e.push(this.activityBeforeCompleted),this.submitModal.emit({value:e,parameters:null})},ja.prototype.clickCancel=function(){this.closeModal.emit()},ja.prototype.validator=function(){},ja.decorators=[{type:b.Component,args:[{selector:"lib-check-condition",template:'<div class="f-page">\r\n  <section class="f-page-main d-flex flex-column">\r\n    <farris-section class="pt-0 f-section-form f-section-in-mainsubcard" mainTitle="{{\'component.checkCondition.nodeEntry\'|wfLocale}}" [enableAccordion]="\'default\'"\r\n      [enableMaximize]="false">\r\n      <div class="f-form-layout farris-form mx-3">\r\n        <fieldset class="f-section-formgroup">\r\n          <div class="f-section-formgroup-inputs">\r\n            <div class="col-12">\r\n              <div class="farris-group-wrap">\r\n                <div class="form-group farris-form-group">\r\n                  <label class="col-form-label">\r\n                    <span class="farris-label-text">{{\'component.checkCondition.activityBeforeStarted\' | wfLocale}}</span>\r\n                  </label>\r\n                  <div class="farris-input-wrap">\r\n                    <input-group [editable]="false" [(ngModel)]="activityBeforeStarted.value" name= "activityBeforeStarted" (clickHandle)="editCondition(\'ACTIVITY_BEFORE_STARTED\')" [groupText]="groupIcon" (clear)="clearCondition(\'ACTIVITY_BEFORE_STARTED\')"></input-group>\r\n                    <div class="farris-feedback valid-feedback"></div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div class="col-12">\r\n              <div class="farris-group-wrap">\r\n                <div class="form-group farris-form-group">\r\n                  <label class="col-form-label">\r\n                    <span class="farris-label-info text-danger"></span>\r\n                    <span class="farris-label-text">{{\'component.checkCondition.enterErrorTips\' | wfLocale}}</span>\r\n                  </label>\r\n                  <div class="farris-input-wrap">\r\n                    <language-textbox [languages]="languages" [(ngModel)]="activityBeforeStarted.errorTips" name="activityBeforeStartedErrorTips"></language-textbox>\r\n                    <div class="farris-feedback valid-feedback"></div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </fieldset>\r\n      </div>\r\n    </farris-section>\r\n    <farris-section class="pt-0 f-section-form f-section-in-mainsubcard" mainTitle="{{\'component.checkCondition.activityBeforeCompleted\'|wfLocale}}" [enableAccordion]="\'default\'"\r\n      [enableMaximize]="false" [fill]="true">\r\n      <div class="f-form-layout farris-form mx-3">\r\n        <fieldset class="f-section-formgroup">\r\n          <div class="f-section-formgroup-inputs">\r\n            <div class="col-12">\r\n              <div class="farris-group-wrap">\r\n                <div class="form-group farris-form-group">\r\n                  <label class="col-form-label">\r\n                    <span class="farris-label-text">{{\'component.checkCondition.activityBeforeCompletedValue\' | wfLocale}}</span>\r\n                  </label>\r\n                  <div class="farris-input-wrap">\r\n                    <input-group [editable]="false" [(ngModel)]="activityBeforeCompleted.value" name= "activityBeforeCompleted" (clickHandle)="editCondition(\'ACTIVITY_BEFORE_COMPLETED\')" [groupText]="groupIcon" (clear)="clearCondition(\'ACTIVITY_BEFORE_COMPLETED\')"></input-group>\r\n                    <div class="farris-feedback valid-feedback"></div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div class="col-12">\r\n              <div class="farris-group-wrap">\r\n                <div class="form-group farris-form-group">\r\n                  <label class="col-form-label">\r\n                    <span class="farris-label-info text-danger"></span>\r\n                    <span class="farris-label-text">{{\'component.checkCondition.leaveErrorTips\' | wfLocale}}</span>\r\n                  </label>\r\n                  <div class="farris-input-wrap">\r\n                    <language-textbox [languages]="languages" [(ngModel)]="activityBeforeCompleted.errorTips" name="activityBeforeCompletedErrorTips"></language-textbox>\r\n                    <div class="farris-feedback valid-feedback"></div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </fieldset>\r\n      </div>\r\n    </farris-section>\r\n  </section>\r\n</div>\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type="button" class="btn btn-secondary btn-sm mx-2" (click)="clickCancel()">{{\'component.checkCondition.clickCancel\' | wfLocale}}</button>\r\n  <button type="button" class="btn btn-primary btn-sm mx-2" (click)="clickOK()">{{\'component.checkCondition.clickOK\' | wfLocale}}</button>\r\n</ng-template>\r\n',providers:[x],styles:[""]}]}],ja.ctorParameters=function(){return[{type:b.Injector},{type:r.MessagerService},{type:a},{type:D.ExpressionService},{type:t.HttpService},{type:b.ChangeDetectorRef,decorators:[{type:b.Optional}]},{type:String,decorators:[{type:b.Inject,args:[b.LOCALE_ID]}]},{type:undefined,decorators:[{type:b.Inject,args:[o]}]},{type:x,decorators:[{type:b.Optional}]}]},ja.propDecorators={closeModal:[{type:b.Output}],submitModal:[{type:b.Output}],value:[{type:b.Input}],modalFooter:[{type:b.ViewChild,args:["iconSelectFooter"]}]},ja);function ja(e,t,r,i,n,o,a,s,l){this.injector=e,this.message=t,this.designerUIState=r,this.expr=i,this.http=n,this.cdr=o,this.localeId=a,this.resources=s,this.localePipe=l,this.groupIcon='<i class="f-icon f-icon-lookup"></i>',this.closeModal=new b.EventEmitter,this.submitModal=new b.EventEmitter,this.languages=[{code:"zh-CHS",name:this.localePipe.transform("component.checkCondition.zhChs")},{code:"zh-CHT",name:this.localePipe.transform("component.checkCondition.zhCht")},{code:"en",name:this.localePipe.transform("component.checkCondition.en")}],this.activityBeforeStarted=new Ba("ACTIVITY_BEFORE_STARTED"),this.activityBeforeCompleted=new Ba("ACTIVITY_BEFORE_COMPLETED"),this.modalConfig={title:this.localePipe.transform("component.checkCondition.checkCondition"),width:440,height:460,showButtons:!0},this.localePipe=this.localePipe||new x(a,s)}_a.prototype.convertTo=function(e){return e&&0<e.length?this.localePipe.transform("component.checkCondition.set"):this.localePipe.transform("component.checkCondition.notSet")};var Ha=_a;function _a(e){this.localePipe=e}Object.defineProperty(Ka.prototype,"value",{set:function(e){this.assignStrategy=e||new Go,this.assignStrategy.assignConfig||(this.assignStrategy.assignConfig=new _o),this.assingPerformerConfigForm.setValue({multiSelect:this.assignStrategy.assignConfig.multiSelect,necessary:this.assignStrategy.assignConfig.necessary})},enumerable:!0,configurable:!0}),Ka.prototype.ngOnInit=function(){},Ka.prototype.changeValue=function(e){"ASSIGN"===e&&(this.assignStrategy.assignConfig||(this.assignStrategy.assignConfig=new _o),this.assingPerformerConfigForm.setValue({multiSelect:this.assignStrategy.assignConfig.multiSelect,necessary:this.assignStrategy.assignConfig.necessary}))},Ka.prototype.clickOK=function(){this.assignStrategy.assignConfig.multiSelect=this.assingPerformerConfigForm.get("multiSelect").value,this.assignStrategy.assignConfig.necessary=this.assingPerformerConfigForm.get("necessary").value,console.log(this.assignStrategy);var e={value:this.assignStrategy,parameters:null};this.submitModal.emit(e)},Ka.prototype.clickCancel=function(){this.closeModal.emit()},Ka.decorators=[{type:b.Component,args:[{selector:"lib-assign-strategy",template:'<div class="f-page">\r\n  <section class="f-page-main d-flex flex-column">\r\n    <farris-section class="pt-0 f-section-form f-section-in-mainsubcard" mainTitle="{{\'component.assignStrategy.option\' | wfLocale}}" [enableAccordion]="\'\'"\r\n      [enableMaximize]="false">\r\n      <div class="f-form-layout farris-form farris-form-controls-inline">\r\n        <fieldset class="f-section-formgroup">\r\n          <div class="f-section-formgroup-inputs">\r\n            <div class="col-12">\r\n              <div class="farris-group-wrap ml-2 pl-4">\r\n                <div class="form-group">\r\n                  <div class="farris-input-wrap">\r\n                    <farris-radiogroup [(ngModel)]="assignStrategy.assignStrategy" [data]="assignStrategyList" name="assignStrategy"\r\n                      [horizontal]="true">\r\n                    </farris-radiogroup>\r\n                    <div class="farris-feedback valid-feedback"></div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </fieldset>\r\n      </div>\r\n    </farris-section>\r\n    <farris-section *ngIf="assignStrategy.assignStrategy===\'ASSIGN\'" class="pt-0 f-section-form f-section-in-mainsubcard" mainTitle="{{\'component.assignStrategy.assignmentRules\' | wfLocale}}" [enableAccordion]="\'\'"\r\n      [enableMaximize]="false">\r\n      <form class="h-100" [formGroup]="assingPerformerConfigForm">\r\n        <div class="f-form-layout farris-form farris-form-controls-inline">\r\n          <fieldset class="f-section-formgroup">\r\n            <div class="f-section-formgroup-inputs">\r\n              <div class="col-12">\r\n                <div class="farris-group-wrap">\r\n                  <div class="form-group">\r\n                    <label class="col-form-label">\r\n                      <span class="farris-label-text">{{\'component.assignStrategy.operator\' | wfLocale}}</span>\r\n                    </label>\r\n                    <div class="farris-input-wrap" style="width: 300px;">\r\n                      <farris-combo-list [(ngModel)]="assignStrategy.assignConfig.operator" name="operator" [ngModelOptions]="{standalone: true}"\r\n                        [idField]="\'value\'" [textField]="\'text\'" [valueField]="\'value\'" [data]="operatorCollection"\r\n                        [panelHeight]="60">\r\n                      </farris-combo-list>\r\n                      <div class="farris-feedback valid-feedback"></div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <div class="col-12 mt-2">\r\n                <div class="farris-group-wrap ml-2 pl-4">\r\n                  <div class="form-group farris-form-group">\r\n                    <div class="farris-input-wrap">\r\n                      <div class="custom-control custom-checkbox">\r\n                        <input class="custom-control-input" type="checkbox" id="multiSelect" formControlName="multiSelect"\r\n                          [readOnly]="false" />\r\n                        <label class="custom-control-label" for="multiSelect">{{\'component.assignStrategy.multiSelect\' | wfLocale}}</label>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <div class="col-12 mt-2">\r\n                <div class="farris-group-wrap ml-2 pl-4">\r\n                  <div class="form-group farris-form-group">\r\n                    <div class="farris-input-wrap">\r\n                      <div class="custom-control custom-checkbox">\r\n                        <input class="custom-control-input" type="checkbox" id="necessary" formControlName="necessary" [readOnly]="false" />\r\n                        <label class="custom-control-label" for="necessary">{{\'component.assignStrategy.necessary\' | wfLocale}}</label>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </fieldset>\r\n        </div>\r\n      </form>\r\n    </farris-section>\r\n  </section>\r\n</div>\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type="button" class="btn btn-secondary btn-sm px-3 mx-2" (click)="clickCancel()">{{\'component.assignStrategy.clickCancel\' | wfLocale}}</button>\r\n  <button type="button" class="btn btn-primary btn-sm px-3 mx-2" (click)="clickOK()">{{\'component.assignStrategy.clickOK\' | wfLocale}}</button>\r\n</ng-template>\r\n\r\n',providers:[x],styles:[""]}]}],Ka.ctorParameters=function(){return[{type:b.Injector},{type:r.MessagerService},{type:a},{type:t.HttpService},{type:b.ChangeDetectorRef,decorators:[{type:b.Optional}]},{type:String,decorators:[{type:b.Inject,args:[b.LOCALE_ID]}]},{type:undefined,decorators:[{type:b.Inject,args:[o]}]},{type:x,decorators:[{type:b.Optional}]}]},Ka.propDecorators={closeModal:[{type:b.Output}],submitModal:[{type:b.Output}],value:[{type:b.Input}],modalFooter:[{type:b.ViewChild,args:["iconSelectFooter"]}]};var Ga=Ka;function Ka(e,t,r,i,n,o,a,s){this.injector=e,this.message=t,this.designerUIState=r,this.http=i,this.cdr=n,this.localeId=o,this.resources=a,this.localePipe=s,this.closeModal=new b.EventEmitter,this.submitModal=new b.EventEmitter,this.assingPerformerConfigForm=new he.FormGroup({multiSelect:new he.FormControl(!0),necessary:new he.FormControl(!1)}),this.assignStrategy=new Go,this.assignStrategyList=[{value:"ALL",name:this.localePipe.transform("component.assignStrategy.all")},{value:"ASSIGN",name:this.localePipe.transform("component.assignStrategy.assign")},{value:"CLAIM",name:this.localePipe.transform("component.assignStrategy.claim")}],this.operatorCollection=[{text:this.localePipe.transform("component.assignStrategy.currentUser"),value:"currentUser"},{text:this.localePipe.transform("component.assignStrategy.procInstCreator"),value:"procInstCreator"}],this.modalConfig={title:this.localePipe.transform("component.assignStrategy.assignStrategy"),width:405,height:350,showButtons:!0},this.localePipe=this.localePipe||new x(o,a)}Wa.prototype.convertTo=function(e){switch(e.assignStrategy){case"ALL":return this.localePipe.transform("component.assignStrategy.all");case"ASSIGN":return this.localePipe.transform("component.assignStrategy.assign");case"CLAIM":return this.localePipe.transform("component.assignStrategy.claim");default:return""}};var qa=Wa;function Wa(e){this.localePipe=e}var Ja=function(){this.operator="currentUser",this.multiSelect=!0,this.necessary=!1},$a=(Object.defineProperty(C.prototype,"value",{set:function(e){var t,r,i,n;if(this.participant=JSON.parse(JSON.stringify(e)),this.participant.assignStrategy.assignConfig||(this.participant.assignStrategy.assignConfig=new Ja),this.preAssignStrategy=e.assignStrategy.assignStrategy,this.participant.humanPerformerList&&0<this.participant.humanPerformerList.length){if(0===Math.max.apply(Math,w(this.participant.humanPerformerList.map(function(e){return e.order})))){var o=1;try{for(var a=ue(this.participant.humanPerformerList),s=a.next();!s.done;s=a.next())s.value.order=o,o++}catch(p){t={error:p}}finally{try{s&&!s.done&&(r=a["return"])&&r.call(a)}finally{if(t)throw t.error}}}this.participant.humanPerformerList=this.participant.humanPerformerList.sort(function(e,t){return e.order-t.order})}if(this.participant.potentialOwnerList&&0<this.participant.potentialOwnerList.length){if(0===Math.max.apply(Math,w(this.participant.potentialOwnerList.map(function(e){return e.order})))){o=1;try{for(var l=ue(this.participant.potentialOwnerList),c=l.next();!c.done;c=l.next())c.value.order=o,o++}catch(d){i={error:d}}finally{try{c&&!c.done&&(n=l["return"])&&n.call(l)}finally{if(i)throw i.error}}}this.participant.potentialOwnerList=this.participant.potentialOwnerList.sort(function(e,t){return e.order-t.order})}},enumerable:!0,configurable:!0}),C.prototype.ngOnInit=function(){this.nodeType=this.editorParams.nodeType},C.prototype.clickOK=function(){this.humanPerformerGrid.endCellEdit(),this.potentialOwnerGrid&&this.potentialOwnerGrid.endCellEdit();var e={value:this.participant,parameters:null};this.submitModal.emit(e)},C.prototype.clickCancel=function(){this.closeModal.emit()},C.prototype.assignStrategyChange=function(e){var t=this;"ASSIGN"!==this.preAssignStrategy&&"ASSIGN"===e&&0<this.participant.humanPerformerList.length?(this.participant.assignStrategy.assignConfig||(this.participant.assignStrategy.assignConfig=new Ja),this.message.question(this.localePipe.transform("component.participant.dataMovement1"),function(){t.humanPerformerCopyToPotentialOwner()})):"ASSIGN"===this.preAssignStrategy&&"ASSIGN"!==e&&0<this.participant.potentialOwnerList.length&&this.message.question(this.localePipe.transform("component.participant.dataMovement2"),function(){t.potentialOwnerCopyToHumanPerformer()}),this.preAssignStrategy=e},C.prototype.switchChange=function(e){e&&this.clearPerformer("potentialOwner")},C.prototype.addPerformer=function(e,t){this.editState="new",this.type=t;t=this.resolver.resolveComponentFactory(Io),this.compRef=t.create(this.injector),this.compRef.instance.performerType=e,t=this.attributeBoxSize(e),e={title:this.localePipe.transform("component.participant.participantSelection"),width:t.width,height:t.height,buttons:this.editFooter,showButtons:!0};this.editDialog=this.modalService.show(this.compRef,e),this.dropDownEl.close(),this.dropDownE2&&this.dropDownE2.close()},C.prototype.editOK=function(){var e,t,r,i;if(this.isClose=!0,this.compRef){var n=this.compRef.instance.getPerformers();if(n.userPerformers&&0<n.userPerformers.length)try{for(var o=ue(n.userPerformers),a=o.next();!a.done;a=o.next()){var s=a.value;this.addUserPerformer(s)}}catch(d){e={error:d}}finally{try{a&&!a.done&&(t=o["return"])&&t.call(o)}finally{if(e)throw e.error}}if(n.variable&&null!==n.variable&&n.variable.performerId&&this.addvariablePerformer(n.variable),n.positions&&0<n.positions.length&&this.addPositionPerformer(n.positions),n.component&&n.component.metadataId&&n.component.methodCode&&this.addComponentPerformer(n.component),n.reportingLine&&n.reportingLine.reportingLineDefId&&n.reportingLine.dimension&&this.addReportingLinePerformer(n.reportingLine),n.matrix&&n.matrix.matrixDefId&&this.addMatrixPerformer(n.matrix),n.activityExecutorPerformers&&0<n.activityExecutorPerformers.length)try{for(var l=ue(n.activityExecutorPerformers),c=l.next();!c.done;c=l.next()){var p=c.value;this.addActivityExecutorPerformer(p)}}catch(u){r={error:u}}finally{try{c&&!c.done&&(i=l["return"])&&i.call(l)}finally{if(r)throw r.error}}n.organizationParticipant&&this.addOrganizationParticipant(n.organizationParticipant)}this.editDialog&&this.isClose&&this.editDialog.close(),this.humanPerformerGrid.refresh(),this.potentialOwnerGrid.refresh()},C.prototype.addUserPerformer=function(t){var e;"humanPerformer"===this.type?(-1<this.participant.humanPerformerList.findIndex(function(e){return e.id===t.id||e.performerId&&e.performerId===t.performerId})||("edit"===this.editState&&this.removeHumanPerformer(),e=void 0,e=0<this.participant.humanPerformerList.length?Math.max.apply(Math,w(this.participant.humanPerformerList.map(function(e){return e.order})))+1:1,t.order=e,this.participant.humanPerformerList.push(t)),this.humanPerformerGrid.loadData(this.participant.humanPerformerList)):"potentialOwner"===this.type&&(-1<this.participant.potentialOwnerList.findIndex(function(e){return e.id===t.id||e.performerId&&e.performerId===t.performerId})||("edit"===this.editState&&this.removePotentialOwner(),e=void 0,e=0<this.participant.potentialOwnerList.length?Math.max.apply(Math,w(this.participant.potentialOwnerList.map(function(e){return e.order})))+1:1,t.order=e,this.participant.potentialOwnerList.push(t)),this.potentialOwnerGrid.loadData(this.participant.potentialOwnerList))},C.prototype.addvariablePerformer=function(t){var e,r;t&&t.varValue?t.varType?t.relation?"humanPerformer"===this.type?(-1<(e=this.participant.humanPerformerList.findIndex(function(e){return e.id===t.id||e.performerId&&e.performerId===t.performerId}))?this.participant.humanPerformerList[e]=t:("edit"===this.editState&&this.removeHumanPerformer(),r=void 0,r=0<this.participant.humanPerformerList.length?Math.max.apply(Math,w(this.participant.humanPerformerList.map(function(e){return e.order})))+1:1,t.order=r,this.participant.humanPerformerList.push(t)),this.humanPerformerGrid.loadData(this.participant.humanPerformerList)):"potentialOwner"===this.type&&(-1<(e=this.participant.potentialOwnerList.findIndex(function(e){return e.id===t.id||e.performerId&&e.performerId===t.performerId}))?this.participant.potentialOwnerList[e]=t:("edit"===this.editState&&this.removePotentialOwner(),r=void 0,r=0<this.participant.potentialOwnerList.length?Math.max.apply(Math,w(this.participant.potentialOwnerList.map(function(e){return e.order})))+1:1,t.order=r,this.participant.potentialOwnerList.push(t)),this.potentialOwnerGrid.loadData(this.participant.potentialOwnerList)):(this.message.info(this.localePipe.transform("component.participant.selectRelation")),this.isClose=!1):(this.message.info(this.localePipe.transform("component.participant.selectVariableValueType")),this.isClose=!1):(this.message.info(this.localePipe.transform("component.participant.selectProcessVariables")),this.isClose=!1)},C.prototype.addPositionPerformer=function(e){var t,r,i=this;try{for(var n=ue(e),o=n.next();!o.done;o=n.next())!function(t){var e,r;t.performerId?t.orgType&&null!=t.orgType||!t.isRequired||"1"!==t.positionType?t.orgId&&null!=t.orgId||!t.isRequired||"1"!==t.positionType?"humanPerformer"===i.type?(-1<(e=i.participant.humanPerformerList.findIndex(function(e){return"wf.PositionParticipantExpression"===e.type&&e.id===t.id}))?i.participant.humanPerformerList[e]=t:(r=void 0,r=0<i.participant.humanPerformerList.length?Math.max.apply(Math,w(i.participant.humanPerformerList.map(function(e){return e.order})))+1:1,t.order=r,i.participant.humanPerformerList.push(t)),i.humanPerformerGrid.loadData(i.participant.humanPerformerList)):"potentialOwner"===i.type&&(-1<(e=i.participant.potentialOwnerList.findIndex(function(e){return"wf.PositionParticipantExpression"===e.type&&e.id===t.id}))?i.participant.potentialOwnerList[e]=t:(r=void 0,r=0<i.participant.potentialOwnerList.length?Math.max.apply(Math,w(i.participant.potentialOwnerList.map(function(e){return e.order})))+1:1,t.order=r,i.participant.potentialOwnerList.push(t)),i.potentialOwnerGrid.loadData(i.participant.potentialOwnerList)):(i.message.info(i.localePipe.transform("component.participant.orgFill")),i.isClose=!1):(i.message.info(i.localePipe.transform("component.participant.selectOrgType")),i.isClose=!1):(i.message.info(i.localePipe.transform("component.participant.selectPosition")),i.isClose=!1)}(o.value)}catch(a){t={error:a}}finally{try{o&&!o.done&&(r=n["return"])&&r.call(n)}finally{if(t)throw t.error}}},C.prototype.addComponentPerformer=function(e){var t,r,i=new ea;i.id=e.id,i.metadataId=e.metadataId,i.methodCode=e.methodCode,i.methodName=e.methodName,i.name=e.name,i.actualParameters=e.actualParameters,i.type="wf.ComponentParticipantExpression",i.condition=e.condition,"humanPerformer"===this.type?(-1<(t=this.participant.humanPerformerList.findIndex(function(e){return e.id===i.id}))?this.participant.humanPerformerList[t]=i:(r=void 0,r=0<this.participant.humanPerformerList.length?Math.max.apply(Math,w(this.participant.humanPerformerList.map(function(e){return e.order})))+1:1,i.order=r,this.participant.humanPerformerList.push(i)),this.humanPerformerGrid.loadData(this.participant.humanPerformerList)):"potentialOwner"===this.type&&(-1<(t=this.participant.potentialOwnerList.findIndex(function(e){return e.id===i.id}))?this.participant.potentialOwnerList[t]=i:(r=void 0,r=0<this.participant.potentialOwnerList.length?Math.max.apply(Math,w(this.participant.potentialOwnerList.map(function(e){return e.order})))+1:1,i.order=r,this.participant.potentialOwnerList.push(i)),this.potentialOwnerGrid.loadData(this.participant.potentialOwnerList))},C.prototype.addReportingLinePerformer=function(t){var e,r,i,n;if("dept"!==t.reportingReferObject||t.refOrgId)if("dept"===t.reportingReferObject||t.refUserId||t.refEmployeeId){if(this.isClose=!0,"humanPerformer"===this.type){if(-1<(n=this.participant.humanPerformerList.findIndex(function(e){return e.id===t.id})))this.participant.humanPerformerList[n]=t;else{var o=this.participant.humanPerformerList.filter(function(e){return"wf.ReportingLineParticipantExpression"===e.type});try{for(var a=ue(o),s=a.next();!s.done;s=a.next())if((c=s.value).reportingLineDefId===t.reportingLineDefId&&c.dimension===t.dimension&&c.refUserId===t.refUserId&&c.refEmployeeId===t.refEmployeeId&&c.refOrgId===t.refOrgId)return void this.message.error(this.localePipe.transform("component.participant.repDefConfigured"))}catch(u){e={error:u}}finally{try{s&&!s.done&&(l=a["return"])&&l.call(a)}finally{if(e)throw e.error}}var l=void 0;l=0<this.participant.humanPerformerList.length?Math.max.apply(Math,w(this.participant.humanPerformerList.map(function(e){return e.order})))+1:1,t.order=l,this.participant.humanPerformerList.push(t)}this.humanPerformerGrid.loadData(this.participant.humanPerformerList)}else if("potentialOwner"===this.type){if(-1<(n=this.participant.potentialOwnerList.findIndex(function(e){return e.id===t.id})))this.participant.potentialOwnerList[n]=t;else{o=this.participant.potentialOwnerList.filter(function(e){return"wf.ReportingLineParticipantExpression"===e.type});try{for(var c,p=ue(o),d=p.next();!d.done;d=p.next())if((c=d.value).reportingLineDefId===t.reportingLineDefId&&c.dimension===t.dimension&&c.refUserId===t.refUserId&&c.refEmployeeId===t.refEmployeeId&&c.refOrgId===t.refOrgId)return void this.message.error(this.localePipe.transform("component.participant.repDefConfigured"))}catch(m){r={error:m}}finally{try{d&&!d.done&&(i=p["return"])&&i.call(p)}finally{if(r)throw r.error}}l=void 0;l=0<this.participant.potentialOwnerList.length?Math.max.apply(Math,w(this.participant.potentialOwnerList.map(function(e){return e.order})))+1:1,t.order=l,this.participant.potentialOwnerList.push(t)}this.potentialOwnerGrid.loadData(this.participant.potentialOwnerList)}}else this.isClose=!1,this.message.info(this.localePipe.transform("component.participant.refUserIdNotNull"));else this.isClose=!1,this.message.info(this.localePipe.transform("component.participant.refOrgIdNotNull"))},C.prototype.addMatrixPerformer=function(t){var e,r,i,n;if(t.conditionField1||t.conditionField2||t.conditionField3)if(t.dataFieldAlias){if(this.isClose=!0,"humanPerformer"===this.type){if(-1<(n=this.participant.humanPerformerList.findIndex(function(e){return e.id===t.id})))this.participant.humanPerformerList[n]=t;else{var o=this.participant.humanPerformerList.filter(function(e){return"wf.MatrixParticipantExpression"===e.type});try{for(var a=ue(o),s=a.next();!s.done;s=a.next())if((c=s.value).matrixDefId===t.matrixDefId&&c.conditionField1===t.conditionField1&&c.conditionField2===t.conditionField2&&c.conditionField3===t.conditionField3&&c.dataFieldAlias===t.dataFieldAlias)return void this.message.error(this.localePipe.transform("component.participant.matrixConfigured"))}catch(u){e={error:u}}finally{try{s&&!s.done&&(l=a["return"])&&l.call(a)}finally{if(e)throw e.error}}var l=void 0;l=0<this.participant.humanPerformerList.length?Math.max.apply(Math,w(this.participant.humanPerformerList.map(function(e){return e.order})))+1:1,t.order=l,this.participant.humanPerformerList.push(t)}this.humanPerformerGrid.loadData(this.participant.humanPerformerList)}else if("potentialOwner"===this.type){if(-1<(n=this.participant.potentialOwnerList.findIndex(function(e){return e.id===t.id})))this.participant.potentialOwnerList[n]=t;else{o=this.participant.potentialOwnerList.filter(function(e){return"wf.MatrixParticipantExpression"===e.type});try{for(var c,p=ue(o),d=p.next();!d.done;d=p.next())if((c=d.value).matrixDefId===t.matrixDefId&&c.conditionField1===t.conditionField1&&c.conditionField2===t.conditionField2&&c.conditionField3===t.conditionField3&&c.dataFieldAlias===t.dataFieldAlias)return void this.message.error(this.localePipe.transform("component.participant.matrixConfigured"))}catch(m){r={error:m}}finally{try{d&&!d.done&&(i=p["return"])&&i.call(p)}finally{if(r)throw r.error}}l=void 0;l=0<this.participant.potentialOwnerList.length?Math.max.apply(Math,w(this.participant.potentialOwnerList.map(function(e){return e.order})))+1:1,t.order=l,this.participant.potentialOwnerList.push(t)}this.potentialOwnerGrid.loadData(this.participant.potentialOwnerList)}}else this.isClose=!1,this.message.info(this.localePipe.transform("component.participant.dataFieldAliasNotNull"));else this.isClose=!1,this.message.info(this.localePipe.transform("component.participant.atLeastOneCondition"))},C.prototype.addActivityExecutorPerformer=function(t){var e;"humanPerformer"===this.type?(this.participant.humanPerformerList.findIndex(function(e){return e.id===t.id||e.activityDefId&&e.activityDefId===t.activityDefId})<0&&("edit"===this.editState&&this.removeHumanPerformer(),e=void 0,e=0<this.participant.humanPerformerList.length?Math.max.apply(Math,w(this.participant.humanPerformerList.map(function(e){return e.order})))+1:1,t.order=e,this.participant.humanPerformerList.push(t)),this.humanPerformerGrid.loadData(this.participant.humanPerformerList)):"potentialOwner"===this.type&&(this.participant.potentialOwnerList.findIndex(function(e){return e.id===t.id||e.activityDefId&&e.activityDefId===t.activityDefId})<0&&("edit"===this.editState&&this.removePotentialOwner(),e=void 0,e=0<this.participant.potentialOwnerList.length?Math.max.apply(Math,w(this.participant.potentialOwnerList.map(function(e){return e.order})))+1:1,t.order=e,this.participant.potentialOwnerList.push(t)),this.potentialOwnerGrid.loadData(this.participant.potentialOwnerList))},C.prototype.addOrganizationParticipant=function(e){var t,r=new ca;r.id=e.id||l.GenerateElementId(),r.type="wf.OrganizationParticipantExpression",r.condition=e.condition,r.name=e.name,r.actionScope=e.actionScope,r.organizationLevel=e.organizationLevel,r.organizationId=e.organizationId,r.organizationCode=e.organizationCode,r.organizationName=e.organizationName,r.includeChildren=e.includeChildren,r.parentsUntil=e.parentsUntil,r.tag=e.tag,"humanPerformer"===this.type?(this.participant.humanPerformerList=this.participant.humanPerformerList.filter(function(e){return"wf.OrganizationParticipantExpression"!==e.type}),t=void 0,t=0<this.participant.humanPerformerList.length?Math.max.apply(Math,w(this.participant.humanPerformerList.map(function(e){return e.order})))+1:1,r.order=t,this.participant.humanPerformerList.push(r),this.humanPerformerGrid.loadData(this.participant.humanPerformerList)):"potentialOwner"===this.type&&(this.participant.potentialOwnerList=this.participant.potentialOwnerList.filter(function(e){return"wf.OrganizationParticipantExpression"!==e.type}),t=void 0,t=0<this.participant.potentialOwnerList.length?Math.max.apply(Math,w(this.participant.potentialOwnerList.map(function(e){return e.order})))+1:1,r.order=t,this.participant.potentialOwnerList.push(r),this.potentialOwnerGrid.loadData(this.participant.potentialOwnerList))},C.prototype.editCancel=function(){this.editDialog&&this.editDialog.close()},C.prototype.editPerformer=function(t){var r=this;if(this.editState="edit","humanPerformer"===(this.type=t)?i=this.humanPerformerGrid.selectedRow:"potentialOwner"===t&&(i=this.potentialOwnerGrid.selectedRow),i){var e=i.data;if(e){var i=this.attributeBoxSize(e.type),n={title:this.localePipe.transform("component.participant.participantSelection"),width:i.width,height:i.height,buttons:this.editFooter,showButtons:!0},i=this.resolver.resolveComponentFactory(Io);switch(this.compRef=i.create(this.injector),this.compRef.instance.performerType=e.type,this.compRef.instance.editState=this.editState,e.type){case"wf.PositionParticipantExpression":this.compRef.instance.performer={type:"wf.PositionParticipantExpression",value:e};break;case"wf.UserParticipantExpression":this.compRef.instance.performer={type:"wf.UserParticipantExpression",value:e};break;case"wf.VariableParticipantExpression":this.compRef.instance.performer={type:"wf.VariableParticipantExpression",value:e};break;case"wf.ReportingLineParticipantExpression":this.compRef.instance.performer={type:"wf.ReportingLineParticipantExpression",value:e};var o="/api/runtime/wf/v1.0/reportingLineDefinitions/"+e.reportingLineDefId;this.http.get(o).subscribe(function(e){e?r.editDialog=r.modalService.show(r.compRef,n):(r.message.error(r.localePipe.transform("component.participant.definitionDeleted")),"humanPerformer"===t?r.removeHumanPerformer():"potentialOwner"===t&&r.removePotentialOwner())});break;case"wf.MatrixParticipantExpression":this.compRef.instance.performer={type:"wf.MatrixParticipantExpression",value:e};o="/api/runtime/wf/v1.0/matrixDefinition/"+e.matrixDefId;this.http.get(o).subscribe(function(e){e?r.editDialog=r.modalService.show(r.compRef,n):(r.message.error(r.localePipe.transform("component.participant.matrixDeleted")),"humanPerformer"===t?r.removeHumanPerformer():"potentialOwner"===t&&r.removePotentialOwner())});break;case"wf.ComponentParticipantExpression":this.compRef.instance.performer={type:"wf.ComponentParticipantExpression",value:e};break;case"wf.ActivityExecutorParticipantExpression":this.compRef.instance.performer={type:"wf.ActivityExecutorParticipantExpression",value:e};break;case"wf.OrganizationParticipantExpression":this.compRef.instance.performer={type:"wf.OrganizationParticipantExpression",value:e}}"wf.ReportingLineParticipantExpression"!==e.type&&"wf.MatrixParticipantExpression"!==e.type&&(this.editDialog=this.modalService.show(this.compRef,n))}}else this.message.info(this.localePipe.transform("component.participant.selectPerformer"))},C.prototype.removePerformer=function(e){var t,r=this;"humanPerformer"===e?this.humanPerformerGrid.selectedRow?(this.humanPerformerGrid.endCellEdit(),t=this.participant.humanPerformerList.findIndex(function(e){return e.id===r.humanPerformerGrid.selectedRow.data.id}),this.participant.humanPerformerList.splice(t,1),this.humanPerformerGrid.loadData(this.participant.humanPerformerList)):this.message.info(this.localePipe.transform("component.participant.selectParticipantInfo")):"potentialOwner"===e&&(this.potentialOwnerGrid.selectedRow?(this.potentialOwnerGrid.endCellEdit(),t=this.participant.potentialOwnerList.findIndex(function(e){return e.id===r.potentialOwnerGrid.selectedRow.data.id}),this.participant.potentialOwnerList.splice(t,1),this.potentialOwnerGrid.loadData(this.participant.potentialOwnerList)):this.message.info(this.localePipe.transform("component.participant.selectParticipantInfo")))},C.prototype.clearPerformer=function(e){"humanPerformer"===e?this.participant.humanPerformerList=new Array:"potentialOwner"===e&&(this.participant.potentialOwnerList=new Array),this.humanPerformerGrid.loadData(this.participant.humanPerformerList),this.potentialOwnerGrid&&this.potentialOwnerGrid.loadData(this.participant.potentialOwnerList)},C.prototype.moveUp=function(e){var t,r,i,n,o;"humanPerformer"===e?(r=this.humanPerformerGrid.selectedRow)?(t=r.data,0!==(n=this.participant.humanPerformerList.findIndex(function(e){return e.id===t.id}))&&(o=this.participant.humanPerformerList[n].order,this.participant.humanPerformerList[n].order=this.participant.humanPerformerList[n-1].order,this.participant.humanPerformerList[n-1].order=o,this.swapArray(this.participant.humanPerformerList,n,n-1),this.humanPerformerGrid.loadData(this.participant.humanPerformerList),this.humanPerformerGrid.selectRow(t.id,!0))):this.message.info(this.localePipe.transform("component.participant.noRowSelected")):"potentialOwner"===e&&((r=this.potentialOwnerGrid.selectedRow)?(i=r.data,0!==(n=this.participant.potentialOwnerList.findIndex(function(e){return e.id===i.id}))&&(o=this.participant.potentialOwnerList[n].order,this.participant.potentialOwnerList[n].order=this.participant.potentialOwnerList[n-1].order,this.participant.potentialOwnerList[n-1].order=o,this.swapArray(this.participant.potentialOwnerList,n,n-1),this.potentialOwnerGrid.loadData(this.participant.potentialOwnerList),this.potentialOwnerGrid.selectRow(i.id,!0))):this.message.info(this.localePipe.transform("component.participant.noRowSelected")))},C.prototype.moveDown=function(e){var t,r,i,n,o;"humanPerformer"===e?(r=this.humanPerformerGrid.selectedRow)?(t=r.data,(n=this.participant.humanPerformerList.findIndex(function(e){return e.id===t.id}))!==this.participant.humanPerformerList.length-1&&(o=this.participant.humanPerformerList[n].order,this.participant.humanPerformerList[n].order=this.participant.humanPerformerList[n+1].order,this.participant.humanPerformerList[n+1].order=o,this.swapArray(this.participant.humanPerformerList,n,n+1),this.humanPerformerGrid.loadData(this.participant.humanPerformerList),this.humanPerformerGrid.selectRow(t.id,!0))):this.message.info(this.localePipe.transform("component.participant.noRowSelected")):"potentialOwner"===e&&((r=this.potentialOwnerGrid.selectedRow)?(i=r.data,(n=this.participant.potentialOwnerList.findIndex(function(e){return e.id===i.id}))!==this.participant.potentialOwnerList.length-1&&(o=this.participant.potentialOwnerList[n].order,this.participant.potentialOwnerList[n].order=this.participant.potentialOwnerList[n+1].order,this.participant.potentialOwnerList[n+1].order=o,this.swapArray(this.participant.potentialOwnerList,n,n+1),this.potentialOwnerGrid.loadData(this.participant.potentialOwnerList),this.potentialOwnerGrid.selectRow(i.id,!0))):this.message.info(this.localePipe.transform("component.participant.noRowSelected")))},C.prototype.swapArray=function(e,t,r){return e[t]=e.splice(r,1,e[t])[0],e},C.prototype.removeHumanPerformer=function(){var e,t=this;this.humanPerformerGrid.selectedRow?(this.humanPerformerGrid.endCellEdit(),e=this.participant.humanPerformerList.findIndex(function(e){return e.id===t.humanPerformerGrid.selectedRow.data.id}),this.participant.humanPerformerList.splice(e,1)):this.message.info(this.localePipe.transform("component.participant.selectDefaultHandler"))},C.prototype.removePotentialOwner=function(){var e,t=this;this.potentialOwnerGrid.selectedRow?(this.potentialOwnerGrid.endCellEdit(),e=this.participant.potentialOwnerList.findIndex(function(e){return e.id===t.potentialOwnerGrid.selectedRow.data.id}),this.participant.potentialOwnerList.splice(e,1)):this.message.info(this.localePipe.transform("component.participant.selectpotentialtHandler"))},C.prototype.getUserPerformerDescription=function(e){return"expression"===e.tag?e.performerId:e.orgName?this.localePipe.transform("component.participant.org")+e.orgName:""},C.prototype.getVariablePerformerDescription=function(e){if("expression"===e.tag)return e.varValue},C.prototype.getPositionPerformerDescription=function(e){return"inSuite"===this.designerUIState.scene?null:"1"===e.positionType?e.orgId?this.localePipe.transform("component.participant.positionType1")+e.orgId:this.localePipe.transform("component.participant.positionType2"):"0"===e.positionType?this.localePipe.transform("component.participant.positionType3"):void 0},C.prototype.getComponentPerformerDescription=function(e){var t=this.localePipe.transform("component.participant.comp")+e.name+this.localePipe.transform("component.participant.parameters");return e.actualParameters&&0<e.actualParameters.length&&(e.actualParameters.forEach(function(e){t+=e.code+"："+e.value+"，"}),t=t.substring(0,t.length-1)),t+="}"},C.prototype.getReportingLinePerformerDescription=function(e){var t="";return e.refUserId&&(t+=this.localePipe.transform("component.participant.referencePerson")+e.refUserId),e.refEmployeeId&&(t+=this.localePipe.transform("component.participant.referencePerson")+e.refEmployeeId),e.refOrgId&&(e.refUserId&&(t+="，"),e.refEmployeeId&&(t+="，"),t+=this.localePipe.transform("component.participant.referenceOrganization")+e.refOrgId),t},C.prototype.getMatrixPerformerDescription=function(e){var t="";return e.conditionField1&&(t+=this.localePipe.transform("component.participant.condition1")+e.conditionFieldText1+"，"),e.conditionField2&&(t+=this.localePipe.transform("component.participant.condition2")+e.conditionFieldText2+"，"),e.conditionField3&&(t+=this.localePipe.transform("component.participant.condition3")+e.conditionFieldText3+"，"),e.dataFieldAlias&&(t+=this.localePipe.transform("component.participant.data")+e.dataFieldAlias+"，"),t.slice(0,t.length-1)},C.prototype.editConditon=function(t){var e,r,i,n,o,a,s,l,c=this;if(0<this.designerUIState.schemas.length){try{for(var p=ue(this.designerUIState.schemas),d=p.next();!d.done;d=p.next()){var u=d.value;this.expr.addSchema("Schema",u)}}catch(w){e={error:w}}finally{try{d&&!d.done&&(l=p["return"])&&l.call(p)}finally{if(e)throw e.error}}this.designerUIState.schemas[0].entityTypes&&0<this.designerUIState.schemas[0].entityTypes.length&&(l=this.designerUIState.schemas[0].entityTypes[0],this.expr.addInjectedEntity(l.name,"Schema",l.name,D.InjectedType.EntityType))}var m=new Array,m=this.designerUIState.addContext(m);if(0<this.designerUIState.subActivityContext.length)try{for(var f=ue(this.designerUIState.subActivityContext),h=f.next();!h.done;h=f.next())!function(t){m.some(function(e){return e.key===t.key})||m.push(t)}(h.value)}catch(P){r={error:P}}finally{try{h&&!h.done&&(i=f["return"])&&i.call(f)}finally{if(r)throw r.error}}if(0<this.designerUIState.activityComponentContext.length)try{for(var y=ue(this.designerUIState.activityComponentContext),g=y.next();!g.done;g=y.next())!function(t){m.some(function(e){return e.key===t.key})||m.push(t)}(g.value)}catch(C){n={error:C}}finally{try{g&&!g.done&&(o=y["return"])&&o.call(y)}finally{if(n)throw n.error}}if(0<m.length)try{for(var v=ue(m),b=v.next();!b.done;b=v.next()){var x=b.value;this.expr.addContext(x)}}catch(I){a={error:I}}finally{try{b&&!b.done&&(s=v["return"])&&s.call(v)}finally{if(a)throw a.error}}this.expr.addExpressionText(t.instance.value),this.expr.setEditPattern(D.ExprEditMode.Conditional),this.expr.buildExpression().then(function(e){c.humanPerformerGrid&&c.humanPerformerGrid.selectedRow&&c.humanPerformerGrid.selectedRow.data&&(c.participant.humanPerformerList.find(function(e){return e.id===c.humanPerformerGrid.selectedRow.data.id}).condition=e),c.potentialOwnerGrid&&c.potentialOwnerGrid.selectedRow&&c.potentialOwnerGrid.selectedRow.data&&(c.participant.potentialOwnerList.find(function(e){return e.id===c.potentialOwnerGrid.selectedRow.data.id}).condition=e),t.formControl.setValue(e),t.instance.cd.detectChanges(),0<m.length&&(c.expr.exprEntity.contextEntities=c.expr.exprEntity.contextEntities.filter(function(t){return!m.some(function(e){return e.key===t.key})}))})},C.prototype.humanPerformerCopyToPotentialOwner=function(){var e;this.participant.humanPerformerList&&0<this.participant.humanPerformerList.length&&(this.participant.potentialOwnerList||(this.participant.potentialOwnerList=new Array),(e=this.participant.potentialOwnerList).push.apply(e,w(this.participant.humanPerformerList)),this.participant.humanPerformerList=new Array,this.humanPerformerGrid.loadData(this.participant.humanPerformerList),this.potentialOwnerGrid)&&this.potentialOwnerGrid.loadData(this.participant.potentialOwnerList)},C.prototype.potentialOwnerCopyToHumanPerformer=function(){var e,t;this.participant.potentialOwnerList&&0<this.participant.potentialOwnerList.length&&(this.participant.humanPerformerList||(this.participant.humanPerformerList=new Array),t=this.participant.potentialOwnerList.filter(function(e){return"wf.OrganizationParticipantExpression"!==e.type}))&&0<t.length&&((e=this.participant.humanPerformerList).push.apply(e,w(t)),this.participant.humanPerformerList.forEach(function(e,t){e.order=t+1}),this.participant.potentialOwnerList=this.participant.potentialOwnerList.filter(function(e){return"wf.OrganizationParticipantExpression"===e.type}),this.humanPerformerGrid.loadData(this.participant.humanPerformerList),this.potentialOwnerGrid)&&this.potentialOwnerGrid.loadData(this.participant.potentialOwnerList)},C.prototype.GetOrganizationType=function(){var t=this;this.http.get("/api/runtime/sys/v1.0/authfields/globalauthfields").subscribe(function(e){return t.designerUIState.orgTypeCollection=e.map(function(e){return{value:e.id,text:e.name}})})},C.prototype.attributeBoxSize=function(e){var t={width:760,height:512};switch(e){case"wf.PositionParticipantExpression":return t.width=760,t.height=455,t;case"wf.UserParticipantExpression":return t.width=760,t.height=320,t;case"wf.VariableParticipantExpression":return t.width=760,t.height=420,t;case"wf.ReportingLineParticipantExpression":return t.width=760,t.height=512,t;case"wf.MatrixParticipantExpression":return t.width=780,t.height=420,t;case"wf.ComponentParticipantExpression":return t.width=760,t.height=512,t;case"wf.ActivityExecutorParticipantExpression":return t.width=760,t.height=320,t;case"wf.OrganizationParticipantExpression":return t.width=760,t.height=360,t}},C.decorators=[{type:b.Component,args:[{selector:"lib-participant",template:'<div class="f-page f-utils-overflow-xhya">\r\n  <div class="f-page-main d-flex flex-column farris-overflow-y-auto" style="border-radius:16px;border: 1.5px solid #F1F3F7;">\r\n  <section class="f-page-main d-flex flex-column">\r\n    <farris-section *ngIf="nodeType === \'userActivity\'" class="pt-0 f-section-form f-section-in-mainsubcard mb-1" [showHeader]="false" >\r\n      <div class="f-form-layout farris-form f-form-lable-auto farris-form-controls-inline">\r\n        <div class="col-12 farris-group-wrap">\r\n          <div class="form-group">\r\n            <label class="col-form-label">\r\n              <span class="farris-label-text">{{\'component.participant.allocationPolicy\'|wfLocale}}</span>\r\n            </label>\r\n            <div class="farris-input-wrap">\r\n              <farris-radiogroup [(ngModel)]="participant.assignStrategy.assignStrategy" [data]="assignStrategyList" name="assignStrategy"\r\n                [horizontal]="true" (changeValue)="assignStrategyChange($event)">\r\n              </farris-radiogroup>\r\n              <div class="farris-feedback valid-feedback"></div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </farris-section>\r\n    <farris-section *ngIf="nodeType === \'userActivity\' && participant.assignStrategy.assignStrategy===\'ASSIGN\'" class="pt-0 f-section-form f-section-in-mainsubcard" [showHeader]="false">\r\n      <div class="f-form-layout farris-form f-form-lable-auto farris-form-controls-inline">\r\n        <div class="col-12 px-0 d-flex">\r\n          <div class="col-4 farris-group-wrap">\r\n            <div class="form-group">\r\n              <label class="col-form-label">\r\n                <span class="farris-label-text">{{\'component.participant.operator\'|wfLocale}}</span>\r\n              </label>\r\n              <div class="farris-input-wrap">\r\n                <farris-combo-list [(ngModel)]="participant.assignStrategy.assignConfig.operator" name="operator" [ngModelOptions]="{standalone: true}"\r\n                  [idField]="\'value\'" [textField]="\'text\'" [valueField]="\'value\'" [data]="operatorCollection"\r\n                  [panelHeight]="60">\r\n                </farris-combo-list>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class="col-auto farris-group-wrap f-form-label-xl">\r\n            <div class="form-group">\r\n              <label class="col-form-label">\r\n                <span class="farris-label-text">{{\'component.participant.multiSelect\'|wfLocale}}</span>\r\n              </label>\r\n              <div class="farris-input-wrap">\r\n                <farris-switch size="small" [(ngModel)]="participant.assignStrategy.assignConfig.multiSelect" name="multiSelect">\r\n                </farris-switch>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class="col-auto farris-group-wrap f-form-label-el">\r\n            <div class="form-group">\r\n              <label class="col-form-label">\r\n                <span class="farris-label-text">{{\'component.participant.necessary\'|wfLocale}}</span>\r\n              </label>\r\n              <div class="farris-input-wrap">\r\n                <farris-switch size="small" [(ngModel)]="participant.assignStrategy.assignConfig.necessary" name="necessary">\r\n                </farris-switch>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </farris-section>\r\n    <div class="d-flex flex-column" [ngStyle]="{\'height\':nodeType === \'notifyActivity\'? \'470px\': participant.assignStrategy.assignStrategy===\'ASSIGN\' ? \'220px\':\'470px\'}">\r\n      <farris-section class="pt-0 f-section-grid" [mainTitle]="nodeType === \'notifyActivity\' ? (\'component.participant.notifyRecipient\' | wfLocale) : (\'component.participant.defaultHandler\' | wfLocale)" [enableAccordion]="\'\'"\r\n      [enableMaximize]="false" [fill]="true" style="overflow: initial;">\r\n      <ng-template farrisSectionToolbar>\r\n        <div class="btn-group mr-2"  fDropdown #dropdownEl="fDropdown" [autoRectify]="true">\r\n          <farris-button class="dropdown-toggle" fDropdownToggle [type]="\'link\'">\r\n            {{\'component.participant.new\'|wfLocale}}\r\n          </farris-button>\r\n          <div class="dropdown-menu" fDropdownMenu>\r\n            <li class="dropdown-item" (click)="addPerformer(\'wf.UserParticipantExpression\' ,\'humanPerformer\')"><span>{{\'component.participant.user\'|wfLocale}}</span></li>\r\n            <li class="dropdown-item" (click)="addPerformer(\'wf.VariableParticipantExpression\',\'humanPerformer\')"><span>{{\'component.participant.variable\'|wfLocale}}</span></li>\r\n            <li class="dropdown-item" (click)="addPerformer(\'wf.PositionParticipantExpression\',\'humanPerformer\')"><span>{{designerUIState.scene===\'inSuite\'?((\'component.participant.role\'|wfLocale)):(\'component.participant.position\'|wfLocale)}}</span></li>\r\n            <li class="dropdown-item" (click)="addPerformer(\'wf.ReportingLineParticipantExpression\',\'humanPerformer\')"><span>{{\'component.participant.reportingLine\'|wfLocale}}</span></li>\r\n            <li class="dropdown-item" (click)="addPerformer(\'wf.ActivityExecutorParticipantExpression\',\'humanPerformer\')"><span>{{\'component.participant.activityExecutor\'|wfLocale}}</span></li>\r\n            <li class="dropdown-item" (click)="addPerformer(\'wf.MatrixParticipantExpression\',\'humanPerformer\')"><span>{{\'component.participant.matrix\'|wfLocale}}</span></li>\r\n            <li class="dropdown-item" (click)="addPerformer(\'wf.ComponentParticipantExpression\',\'humanPerformer\')"><span>{{\'component.participant.component\'|wfLocale}}</span></li>\r\n          </div>\r\n        </div>\r\n        <farris-button  [type]="\'link\'" (click)="editPerformer(\'humanPerformer\')">{{\'component.participant.editPerformer\'|wfLocale}}</farris-button>\r\n        <farris-button  [type]="\'link\'" (click)="removePerformer(\'humanPerformer\')">{{\'component.participant.removePerformer\'|wfLocale}}</farris-button>\r\n        <farris-button  [type]="\'link\'" (click)="clearPerformer(\'humanPerformer\')">{{\'component.participant.clearPerformer\'|wfLocale}}</farris-button>\r\n        <farris-button  [type]="\'link\'" (click)="moveUp(\'humanPerformer\')">{{\'component.participant.moveUp\'|wfLocale}}</farris-button>\r\n        <farris-button  [type]="\'link\'" (click)="moveDown(\'humanPerformer\')">{{\'component.participant.moveDown\'|wfLocale}}</farris-button>\r\n      </ng-template>\r\n      <div class="f-utils-fill">\r\n        <farris-datagrid #humanPerformerGrid class="f-component-grid" [columns]="columns" [data]="participant.humanPerformerList" #defaultPerformerGrid [idField]="\'id\'" [showLineNumber]="false"\r\n          [striped]="true" [showCheckbox]="false" [pagination]="false" [fit]="true" [fitColumns]="true" [editable]="true" [editMode]="\'cell\'"\r\n          [multiSelect]="false">\r\n        </farris-datagrid>\r\n      </div>\r\n    </farris-section>\r\n    </div>\r\n    <div *ngIf="nodeType === \'userActivity\' && participant.assignStrategy.assignStrategy===\'ASSIGN\'" class="d-flex flex-column" style="height: 220px;">\r\n      <farris-section class="pt-0 f-section-grid" mainTitle="{{\'component.participant.alternativeHandler\'|wfLocale}}" [enableAccordion]="\'\'"\r\n        [enableMaximize]="false" [fill]="true" style="overflow: initial;">\r\n      <ng-template farrisSectionHeader>\r\n        <div class="f-title">\r\n          <h4 class="f-title-text">{{\'component.participant.alternativeHandler\'|wfLocale}}</h4>\r\n        </div>\r\n        <label class="col-form-label mr-2 mb-0">\r\n          <span class="farris-label-text">{{\'component.participant.isAllScope\'|wfLocale}}</span>\r\n        </label>\r\n        <farris-switch size="small" [(ngModel)]="participant.isAllScope" name="isAllScope" (valueChange)="switchChange($event)">\r\n        </farris-switch>\r\n        <div class="f-toolbar" [ngStyle]="{\'visibility\' : participant.isAllScope ? \'hidden\' : \'visible\'}">\r\n          <div class="btn-group mr-2"  fDropdown #dropdownE2="fDropdown" [autoRectify]="true">\r\n            <farris-button class="dropdown-toggle" fDropdownToggle [type]="\'link\'">\r\n              {{\'component.participant.new\'|wfLocale}}\r\n            </farris-button>\r\n            <div class="dropdown-menu" fDropdownMenu>\r\n              <li class="dropdown-item" (click)="addPerformer(\'wf.UserParticipantExpression\',\'potentialOwner\')"><span>{{\'component.participant.user\'|wfLocale}}</span></li>\r\n              <li class="dropdown-item" (click)="addPerformer(\'wf.VariableParticipantExpression\',\'potentialOwner\')"><span>{{\'component.participant.variable\'|wfLocale}}</span></li>\r\n              <li class="dropdown-item" (click)="addPerformer(\'wf.PositionParticipantExpression\',\'potentialOwner\')"><span>{{designerUIState.scene===\'inSuite\'?((\'component.participant.role\'|wfLocale)):(\'component.participant.position\'|wfLocale)}}</span></li>\r\n              <li class="dropdown-item" (click)="addPerformer(\'wf.ReportingLineParticipantExpression\',\'potentialOwner\')"><span>{{\'component.participant.reportingLine\'|wfLocale}}</span></li>\r\n              <li class="dropdown-item" (click)="addPerformer(\'wf.ActivityExecutorParticipantExpression\',\'potentialOwner\')"><span>{{\'component.participant.activityExecutor\'|wfLocale}}</span></li>\r\n              <li class="dropdown-item" (click)="addPerformer(\'wf.MatrixParticipantExpression\',\'potentialOwner\')"><span>{{\'component.participant.matrix\'|wfLocale}}</span></li>\r\n              <li class="dropdown-item" (click)="addPerformer(\'wf.ComponentParticipantExpression\',\'potentialOwner\')"><span>{{\'component.participant.component\'|wfLocale}}</span></li>\r\n              <li class="dropdown-item" (click)="addPerformer(\'wf.OrganizationParticipantExpression\',\'potentialOwner\')"><span>{{\'component.participant.organization\'|wfLocale}}\r\n              </span></li>\r\n            </div>\r\n          </div>\r\n          <farris-button  [type]="\'link\'" (click)="editPerformer(\'potentialOwner\')">{{\'component.participant.editPerformer\'|wfLocale}}</farris-button>\r\n          <farris-button  [type]="\'link\'" (click)="removePerformer(\'potentialOwner\')">{{\'component.participant.removePerformer\'|wfLocale}}</farris-button>\r\n          <farris-button  [type]="\'link\'" (click)="clearPerformer(\'potentialOwner\')">{{\'component.participant.clearPerformer\'|wfLocale}}</farris-button>\r\n          <farris-button  [type]="\'link\'" (click)="moveUp(\'potentialOwner\')">{{\'component.participant.moveUp\'|wfLocale}}</farris-button>\r\n          <farris-button  [type]="\'link\'" (click)="moveDown(\'potentialOwner\')">{{\'component.participant.moveDown\'|wfLocale}}</farris-button>\r\n        </div>\r\n      </ng-template>\r\n      <div class="f-utils-fill">\r\n        <farris-datagrid #potentialOwnerGrid class="f-component-grid" [columns]="columns" [data]="participant.potentialOwnerList" #defaultPerformerGrid [idField]="\'id\'" [showLineNumber]="false"\r\n          [striped]="true" [showCheckbox]="false" [pagination]="false" [fit]="true" [fitColumns]="true" [editable]="true" [editMode]="\'cell\'"\r\n          [multiSelect]="false">\r\n        </farris-datagrid>\r\n      </div>\r\n    </farris-section>\r\n    </div>\r\n  </section>\r\n</div>\r\n</div>\r\n\r\n\r\n\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type="button" class="btn btn-secondary btn-sm px-3 mx-2" (click)="clickCancel()">{{\'component.participant.clickCancel\'|wfLocale}}</button>\r\n  <button type="button" class="btn btn-primary btn-sm px-3 mx-2" (click)="clickOK()">{{\'component.participant.clickOK\'|wfLocale}}</button>\r\n</ng-template>\r\n\r\n\r\n<ng-template #editFooter>\r\n  <button type="button" class="btn btn-secondary btn-sm px-3 mx-2" (click)="editCancel()">{{\'component.participant.clickCancel\'|wfLocale}}</button>\r\n  <button type="button" class="btn btn-primary btn-sm px-3 mx-2" (click)="editOK()">{{\'component.participant.clickOK\'|wfLocale}}</button>\r\n</ng-template>\r\n',providers:[da,x],styles:[""]}]}],C.ctorParameters=function(){return[{type:a},{type:da},{type:b.ComponentFactoryResolver},{type:b.Injector},{type:i.BsModalService},{type:r.MessagerService},{type:D.ExpressionService},{type:t.HttpService},{type:b.ChangeDetectorRef,decorators:[{type:b.Optional}]},{type:String,decorators:[{type:b.Inject,args:[b.LOCALE_ID]}]},{type:undefined,decorators:[{type:b.Inject,args:[o]}]},{type:x,decorators:[{type:b.Optional}]}]},C.propDecorators={closeModal:[{type:b.Output}],submitModal:[{type:b.Output}],modalFooter:[{type:b.ViewChild,args:["iconSelectFooter"]}],dropDownEl:[{type:b.ViewChild,args:["dropdownEl"]}],dropDownE2:[{type:b.ViewChild,args:["dropdownE2"]}],editFooter:[{type:b.ViewChild,args:["editFooter"]}],humanPerformerGrid:[{type:b.ViewChild,args:["humanPerformerGrid"]}],potentialOwnerGrid:[{type:b.ViewChild,args:["potentialOwnerGrid"]}],editorParams:[{type:b.Input}],value:[{type:b.Input}]},C);function C(e,t,r,i,n,o,a,s,l,c,p,d){var u=this;this.designerUIState=e,this.uistate=t,this.resolver=r,this.injector=i,this.modalService=n,this.message=o,this.expr=a,this.http=s,this.cdr=l,this.localeId=c,this.resources=p,this.localePipe=d,this.closeModal=new b.EventEmitter,this.submitModal=new b.EventEmitter,this.editorParams={},this.nodeType="notifyActivity",this.isClose=!0,this.participant=new Ko,this.editState="new",this.type="humanPerformer",this.assignStrategyList=[{value:"ALL",name:this.localePipe.transform("component.participant.all")},{value:"ASSIGN",name:this.localePipe.transform("component.participant.assign")},{value:"CLAIM",name:this.localePipe.transform("component.participant.claim")}],this.operatorCollection=[{text:this.localePipe.transform("component.participant.currentUser"),value:"currentUser"},{text:this.localePipe.transform("component.participant.procInstCreator"),value:"procInstCreator"}],this.modalConfig={title:this.localePipe.transform("component.participant.participantSet"),width:900,height:662,showButtons:!0},this.columns=[{field:"order",width:25,title:this.localePipe.transform("component.participant.order"),editor:{type:g.EditorTypes.NUMBERBOX,options:{}}},{field:"type",width:50,title:this.localePipe.transform("component.participant.type"),formatter:{type:"enum",options:{valueField:"value",textField:"text",data:this.uistate.typeCollection}}},{field:"performerName",width:50,title:this.localePipe.transform("component.participant.performerName"),showTips:!0,formatter:function(e,t,r){switch(t.type){case"wf.UserParticipantExpression":return t.performerName;case"wf.VariableParticipantExpression":return t.name;case"wf.PositionParticipantExpression":return t.performerName;case"wf.ComponentParticipantExpression":return t.name;case"wf.ReportingLineParticipantExpression":return t.reportingLineDefName+"-"+t.dimension;case"wf.MatrixParticipantExpression":return t.matrixDefName+"-"+t.dataFieldAlias;case"wf.ActivityExecutorParticipantExpression":return t.performerName;case"wf.OrganizationParticipantExpression":return t.organizationName;default:return""}}},{field:"description",width:100,title:this.localePipe.transform("component.participant.description"),showTips:!0,formatter:function(e,t,r){switch(t.type){case"wf.UserParticipantExpression":return u.getUserPerformerDescription(t);case"wf.VariableParticipantExpression":return u.getVariablePerformerDescription(t);case"wf.PositionParticipantExpression":return u.getPositionPerformerDescription(t);case"wf.ComponentParticipantExpression":return u.getComponentPerformerDescription(t);case"wf.ReportingLineParticipantExpression":return u.getReportingLinePerformerDescription(t);case"wf.MatrixParticipantExpression":return u.getMatrixPerformerDescription(t);case"wf.ActivityExecutorParticipantExpression":return t.performerName;case"wf.OrganizationParticipantExpression":return t.organizationName+"，且"+(t.includeChildren?"包含下级":"不包含下级");default:return""}}},{field:"condition",width:60,title:this.localePipe.transform("component.participant.condition"),showTips:!0,editor:{type:"input-group",options:{groupText:'<i class="f-icon f-icon-lookup"></i>',editable:!1,clickHandle:function(e){e.formControl.setValue(e.instance.value||""),u.editConditon(e)}}}}],this.localePipe=this.localePipe||new x(c,p),this.GetOrganizationType()}Xa.prototype.convertTo=function(e){return e&&e.humanPerformerList&&0<e.humanPerformerList.length||e&&e.potentialOwnerList&&0<e.potentialOwnerList.length||e&&e.isAllScope?this.localePipe.transform("component.participant.set"):this.localePipe.transform("component.participant.notSet")};var Ya=Xa;function Xa(e){this.localePipe=e}var Za=function(){},Qa=function(e,t){this.name=e,this.activityDefinitionId=t,this.required=!1},es=function(e,t,r){this.activityDefinitionId=e,this.condition=new Za,this.condition.Value=t,this.required=r},ts=(Object.defineProperty(rs.prototype,"value",{set:function(e){var r=this;e&&0<e.length&&(e.forEach(function(e){e=new es(e.activityDefinitionId,e.condition&&e.condition.Value,e.required);r.otherAssignActivityNodeInfos.push(e)}),this.otherAssignActivityNodeInfos.forEach(function(e){var t=new Qa(null,e.activityDefinitionId);t.required=e.required,e.condition&&(t.condition=e.condition.Value),r.listItems.push(t)}))},enumerable:!0,configurable:!0}),rs.prototype.ngOnInit=function(){var e,t,r,i,n=this,o=(this.location||(this.location=this.editorParams.location),new Array),o="startActivity"===this.location?w(this.uistate.userActList.filter(function(e){return e.Id!==n.uistate.propertyData.Id&&"ASSIGN"===e.AssignmentStrategy&&e.AssignPerformerConfig&&"procInstCreator"===e.AssignPerformerConfig.Operator})):w(this.uistate.userActList.filter(function(e){return e.Id!==n.uistate.propertyData.Id&&"ASSIGN"===e.AssignmentStrategy}));if(this.otherAssignActivityNodeInfos&&0<this.otherAssignActivityNodeInfos.length){var a=this;try{for(var s=ue(this.otherAssignActivityNodeInfos),l=s.next();!l.done;l=s.next())!function(t){var e=o.find(function(e){return e.Id===t.activityDefinitionId});e&&(a.items=a.items.concat([e]))}(l.value)}catch(u){e={error:u}}finally{try{l&&!l.done&&(t=s["return"])&&t.call(s)}finally{if(e)throw e.error}}var c=this;try{for(var p=ue(o),d=p.next();!d.done;d=p.next())!function(t){-1===c.items.findIndex(function(e){return e.Id===t.Id})&&(c.items=c.items.concat([t]))}(d.value)}catch(m){r={error:m}}finally{try{d&&!d.done&&(i=p["return"])&&i.call(p)}finally{if(r)throw r.error}}}else this.items=o;this.listItems.forEach(function(t){t.name=n.items.find(function(e){return e.Id===t.activityDefinitionId}).Name})},rs.prototype.ngAfterViewInit=function(){var e,t;if(this.otherAssignActivityNodeInfos&&0<this.otherAssignActivityNodeInfos.length)try{for(var r=ue(this.otherAssignActivityNodeInfos),i=r.next();!i.done;i=r.next()){var n=i.value;this.grid.checkRow(n.activityDefinitionId)}}catch(o){e={error:o}}finally{try{i&&!i.done&&(t=r["return"])&&t.call(r)}finally{if(e)throw e.error}}},rs.prototype["delete"]=function(){var e,t=this;this.grid.endCellEdit(),this.grid.selectedRow&&this.grid.selectedRow.data?(e=this.listItems.findIndex(function(e){return e.activityDefinitionId===t.grid.selectedRow.data.activityDefinitionId}),this.listItems.splice(e,1),this.grid.loadData(this.listItems)):this.message.info(this.localePipe.transform("component.assignScope.deleteRow"))},rs.prototype.moveUp=function(){var t,e;this.curActivity?(t=this.curActivity.activityDefinitionId,0!==(e=this.listItems.findIndex(function(e){return e.activityDefinitionId===t}))&&(this.swapArray(this.listItems,e,e-1),this.grid.loadData(this.listItems),this.grid.selectRow(t,!0))):this.message.info(this.localePipe.transform("component.assignScope.curActivity"))},rs.prototype.moveDown=function(){var t,e;this.curActivity?(t=this.curActivity.activityDefinitionId,(e=this.listItems.findIndex(function(e){return e.activityDefinitionId===t}))!==this.listItems.length-1&&(this.swapArray(this.listItems,e,e+1),this.grid.loadData(this.listItems),this.grid.selectRow(t,!0))):this.message.info(this.localePipe.transform("component.assignScope.curActivity"))},rs.prototype.selectionChange=function(e){this.curActivity=e.data},rs.prototype.swapArray=function(e,t,r){return e[t]=e.splice(r,1,e[t])[0],e},rs.prototype.clickOK=function(){var e;this.otherAssignActivityNodeInfos=new Array;try{for(var t=ue(this.listItems),r=t.next();!r.done;r=t.next()){var i=r.value;this.otherAssignActivityNodeInfos.push(new es(i.activityDefinitionId,i.condition,i.required))}}catch(o){e={error:o}}finally{try{r&&!r.done&&(n=t["return"])&&n.call(t)}finally{if(e)throw e.error}}var n={value:this.otherAssignActivityNodeInfos,parameters:null};this.submitModal.emit(n)},rs.prototype.clickCancel=function(){this.closeModal.emit()},rs.prototype.actionsSelect=function(){var i=this,e=this.actionsTable1.checkeds;e&&0<e.length&&(e.forEach(function(t){var e=new Qa(t.data.Name,t.data.Id),r=i.listItems.findIndex(function(e){return e.activityDefinitionId===t.data.Id});-1<r&&i.listItems.splice(r,1),i.listItems.push(e)}),this.grid.loadData(this.listItems)),this.actionsTable1.clearCheckeds(!0),this.actionsDialog1.close()},rs.prototype.SelectCancel=function(){this.actionsTable1.clearCheckeds(!0),this.actionsDialog1.close()},rs.prototype.editConditon=function(t){var e,r,i,n,o,a,s,l,c=this,p=new Array;if(0<this.uistate.schemas.length){try{for(var d=ue(this.uistate.schemas),u=d.next();!u.done;u=d.next()){var m=u.value;this.exprService.addSchema("Schema",m)}}catch(w){e={error:w}}finally{try{u&&!u.done&&(l=d["return"])&&l.call(d)}finally{if(e)throw e.error}}this.uistate.schemas[0].entityTypes&&0<this.uistate.schemas[0].entityTypes.length&&(l=this.uistate.schemas[0].entityTypes[0],this.exprService.addInjectedEntity(l.name,"Schema",l.name,D.InjectedType.EntityType))}if(p=this.uistate.addContext(p),0<this.uistate.subActivityContext.length)try{for(var f=ue(this.uistate.subActivityContext),h=f.next();!h.done;h=f.next())!function(t){p.some(function(e){return e.key===t.key})||p.push(t)}(h.value)}catch(P){r={error:P}}finally{try{h&&!h.done&&(i=f["return"])&&i.call(f)}finally{if(r)throw r.error}}if(0<this.uistate.activityComponentContext.length)try{for(var y=ue(this.uistate.activityComponentContext),g=y.next();!g.done;g=y.next())!function(t){p.some(function(e){return e.key===t.key})||p.push(t)}(g.value)}catch(C){n={error:C}}finally{try{g&&!g.done&&(o=y["return"])&&o.call(y)}finally{if(n)throw n.error}}if(0<p.length)try{for(var v=ue(p),b=v.next();!b.done;b=v.next()){var x=b.value;this.exprService.addContext(x)}}catch(I){a={error:I}}finally{try{b&&!b.done&&(s=v["return"])&&s.call(v)}finally{if(a)throw a.error}}this.exprService.setEditPattern(D.ExprEditMode.Conditional),this.exprService.addExpressionText(t.instance.value),this.exprService.buildExpression().then(function(e){t.formControl.setValue(e),t.instance.cd.detectChanges(),0<p.length&&(c.exprService.exprEntity.contextEntities=c.exprService.exprEntity.contextEntities.filter(function(t){return!p.some(function(e){return e.key===t.key})}))})},rs.decorators=[{type:b.Component,args:[{selector:"lib-assign-scope",template:'<div class="f-page">\r\n  <section class="f-page-main d-flex flex-column">\r\n    <farris-section class="pt-0 f-section-grid f-section-in-managelist" mainTitle="{{\'component.assignScope.set\'|wfLocale}}" [enableAccordion]="\'\'"\r\n      [enableMaximize]="false" [fill]="true">\r\n      <ng-template farrisSectionToolbar>\r\n        <button class="btn btn-secondary mr-2" (click)="actionsDialog1.show()">{{\'component.assignScope.add\'|wfLocale}}</button>\r\n        <button class="btn btn-secondary mr-2" (click)="delete()">{{\'component.assignScope.delete\'|wfLocale}}</button>\r\n        <button class="btn btn-secondary mr-2" (click)="moveUp()">{{\'component.assignScope.moveUp\'|wfLocale}}</button>\r\n        <button class="btn btn-secondary" (click)="moveDown()">{{\'component.assignScope.moveDown\'|wfLocale}}</button>\r\n      </ng-template>\r\n      <div class="f-utils-fill-flex-column farris-overflow-y-auto h-100" style="border-radius:16px;border: 1.5px solid #F1F3F7;">\r\n        <farris-datagrid class="f-component-grid" [columns]="cols" [data]="listItems" #grid [idField]="\'activityDefinitionId\'" [showLineNumber]="true"\r\n          [striped]="true" [multiSelect]="true" [editMode]="\'cell\'"\r\n          [checkOnSelect]="true" [selectOnCheck]="true"  [pagination]="false" [fit]="true" [fitColumns]="true" [editable]="true"\r\n          (selectChanged)="selectionChange($event)">\r\n        </farris-datagrid>\r\n      </div>\r\n    </farris-section>\r\n  </section>\r\n</div>\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type="button" class="btn btn-secondary btn-sm px-3" (click)="clickCancel()">{{\'component.assignScope.clickCancel\' | wfLocale}}</button>\r\n  <button type="button" class="btn btn-primary btn-sm px-3 mx-2" (click)="clickOK()">{{\'component.assignScope.clickOK\' | wfLocale}}</button>\r\n</ng-template>\r\n\r\n<ng-template #buttonRef>\r\n  <button class="btn btn-sm btn-default px-3" (click)="SelectCancel()">{{\'component.approvelItems.clickCancel\' | wfLocale}}</button>\r\n  <button class="btn btn-sm btn-primary px-3" (click)="actionsSelect()">{{\'component.approvelItems.clickOK\' | wfLocale}}</button>\r\n</ng-template>\r\n<farris-dialog #actionsDialog1 [buttons]="buttonRef" [width]="700" [height]="520" title=\'节点列表\'>\r\n  \x3c!-- 2023-6-1 解决审批动作弹窗双滚动条的问题 --\x3e\r\n  <div class="f-utils-fill-flex-column farris-overflow-y-hidden h-100" style="margin-left: 8px;margin-right: 8px;">\r\n    <farris-datagrid #actionsTable1 [columns]="nodeCols" [data]="items"\r\n      [idField]="\'Id\'" [fit]="true" [fitColumns]="true" [pagination]=\'false\' \r\n      [showCheckbox]="true" [multiSelect]="true" [checkOnSelect]="true" [selectOnCheck]="true" [showAllCheckbox]="true" [striped]="true">\r\n    </farris-datagrid>\r\n  </div>\r\n</farris-dialog>\r\n',providers:[x],styles:[""]}]}],rs.ctorParameters=function(){return[{type:a},{type:r.MessagerService},{type:D.ExpressionService},{type:b.ChangeDetectorRef,decorators:[{type:b.Optional}]},{type:String,decorators:[{type:b.Inject,args:[b.LOCALE_ID]}]},{type:undefined,decorators:[{type:b.Inject,args:[o]}]},{type:x,decorators:[{type:b.Optional}]}]},rs.propDecorators={closeModal:[{type:b.Output}],submitModal:[{type:b.Output}],modalFooter:[{type:b.ViewChild,args:["iconSelectFooter"]}],grid:[{type:b.ViewChild,args:["grid"]}],actionsTable1:[{type:b.ViewChild,args:["actionsTable1"]}],actionsDialog1:[{type:b.ViewChild,args:["actionsDialog1"]}],editorParams:[{type:b.Input}],value:[{type:b.Input}]},rs);function rs(e,t,r,i,n,o,a){var s=this;this.uistate=e,this.message=t,this.exprService=r,this.cdr=i,this.localeId=n,this.resources=o,this.localePipe=a,this.closeModal=new b.EventEmitter,this.submitModal=new b.EventEmitter,this.editorParams={},this.items=new Array,this.listItems=new Array,this.modalConfig={title:this.localePipe.transform("component.assignScope.assignScopeList"),width:600,height:520,showButtons:!0},this.cols=[{title:this.localePipe.transform("component.assignScope.name"),field:"name",width:80},{title:"ID",field:"activityDefinitionId",width:100},{title:this.localePipe.transform("component.assignScope.required"),field:"required",width:50,editor:{type:g.EditorTypes.SWITCH,options:{}},formatter:{type:"boolean",options:{trueText:this.localePipe.transform("component.assignScope.yes"),falseText:this.localePipe.transform("component.assignScope.no")}},validators:[{type:"required",messager:"必填"}]},{title:this.localePipe.transform("component.assignScope.condition"),field:"condition",width:70,editor:{type:"input-group",options:{groupText:'<i class="f-icon f-icon-lookup"></i>',editable:!1,clickHandle:function(e){e.formControl.setValue(e.instance.value||""),s.editConditon(e)},clear:function(e){console.log("clear",e)}}}}],this.nodeCols=[{title:this.localePipe.transform("component.assignScope.name"),field:"Name",width:100,filter:!0},{title:"ID",field:"Id",width:100,filter:!0}],this.otherAssignActivityNodeInfos=new Array,this.localePipe=this.localePipe||new x(n,o)}ns.prototype.convertTo=function(e){return e&&0<e.length?this.localePipe.transform("component.assignScope.set"):this.localePipe.transform("component.assignScope.notSet")};var is=ns;function ns(e,t){this.uistate=e,this.localePipe=t,this.actList=new Array,this.actList=w(this.uistate.userActList.filter(function(e){return"ASSIGN"===e.AssignmentStrategy}))}var os="Id",as="Name",ss="NameLanguage",ls="ClrTypeID",cs="ParticipantSchemes",ps="ParticipantOptions",ds="ApprovalItems",us="AssignStrategy",ms="CompleteStrategy",fs="SignRule",hs="MultiInstanceLoopCharacteristics",ys="Retrievable",gs="AddSignFrontAble",vs="AddSignBehindAble",bs="NotifyAble",xs="SelectTargetAble",ws="JumpScope",Ps="BackWardRule",Cs="Tools",Is="SelectBranch",Ss="wf_TitleExpression",Es="Default",Ts="transferScope",As="DisplayTerminal",ks="timeLimitControl",Os="anonymousSet",Ms="variableSettings",Ds="messageNotice",Ns="wf_ExecuteForms_PC",Ls="wf_ExecuteForms_Mobile",Fs="approvalPivotConfig",Rs="urgeHandleRule",Vs="imageSettings",zs="checkConditions",Bs="AssignPerformer",Us="wf_CustomizeAction",js="otherAssignNodes",Hs="otherAssignActivities",_s="OtherAssignActivityNodeInfos",Gs="ConditionExpression",Ks="sendBackedTask",qs="BizActivityID",Ws=(Js.Clr_Type_ID="wf.MultiInstanceLoopCharacteristics",Js);function Js(){this.ClrTypeID=Js.Clr_Type_ID,this.enable=!1,this.sequential=!1,this.loopCardinality=null,this.completionCondition=null,this.completionConditionRules=new Array}Object.defineProperty(Ys.prototype,"value",{set:function(e){var t,r;if(this.loopCharacteristics=new Ws,e&&(this.loopCharacteristics.enable=e.enable,this.loopCharacteristics.sequential=e.sequential,this.preEnable=e.enable,this.preSequential=e.sequential,e.loopCardinality&&e.loopCardinality instanceof B.Expression&&e.loopCardinality.MexExpression&&(this.loopCharacteristics.loopCardinality=e.loopCardinality.MexExpression.Value),e.completionConditionRules)&&0<e.completionConditionRules.length){var i=new Array;try{for(var n=ue(e.completionConditionRules),o=n.next();!o.done;o=n.next()){var a=o.value,s=new de.CounterSignRule(this.bpmnModel);s.ConclusionValue=a.ConclusionValue,s.CalculateType=a.CalculateType,s.ConditionValue=a.ConditionValue,s.WaitAllVotes=a.WaitAllVotes,s.CompletionCondition||(s.CompletionCondition=new de.Condition(this.bpmnModel)),s.CompletionCondition.Value=a.CompletionCondition?a.CompletionCondition.Value:null,i.push(s)}}catch(l){t={error:l}}finally{try{o&&!o.done&&(r=n["return"])&&r.call(n)}finally{if(t)throw t.error}}this.loopCharacteristics.completionConditionRules=i}},enumerable:!0,configurable:!0}),Ys.prototype.ngOnInit=function(){this.editorParams.location&&"activity"==this.editorParams.location?this.promptAct=!0:this.promptAct=!1},Ys.prototype.loopCardinalityExpr=function(e){this.showloopCardinalityHelp(e)},Ys.prototype.showloopCardinalityHelp=function(e){var t=this;this.showExpr(),this.loopCharacteristics.loopCardinality?this.expr.addExpressionText(this.loopCharacteristics.loopCardinality):this.expr.addExpressionText(""),this.expr.buildExpression().then(function(e){t.loopCharacteristics.loopCardinality=e})},Ys.prototype.showExpr=function(){var e,t,r,i,n,o,a,s;if(0<this.uistate.schemas.length){try{for(var l=ue(this.uistate.schemas),c=l.next();!c.done;c=l.next()){var p=c.value;this.expr.addSchema("Schema",p)}}catch(x){e={error:x}}finally{try{c&&!c.done&&(s=l["return"])&&s.call(l)}finally{if(e)throw e.error}}this.uistate.schemas[0].entityTypes&&0<this.uistate.schemas[0].entityTypes.length&&(s=this.uistate.schemas[0].entityTypes[0],this.expr.addInjectedEntity(s.name,"Schema",s.name,D.InjectedType.EntityType))}var d=new Array;if(0<this.uistate.procInstContext.length)try{for(var u=ue(this.uistate.procInstContext),m=u.next();!m.done;m=u.next()){var f=m.value;d.push(f)}}catch(w){t={error:w}}finally{try{m&&!m.done&&(r=u["return"])&&r.call(u)}finally{if(t)throw t.error}}if(0<this.uistate.processVariableContext.length)try{for(var h=ue(this.uistate.processVariableContext),y=h.next();!y.done;y=h.next())!function(t){d.some(function(e){return e.key===t.key})||d.push(t)}(f=y.value)}catch(P){i={error:P}}finally{try{y&&!y.done&&(n=h["return"])&&n.call(h)}finally{if(i)throw i.error}}if(0<d.length)try{for(var g=ue(d),v=g.next();!v.done;v=g.next()){var b=v.value;this.expr.addContext(b)}}catch(C){o={error:C}}finally{try{v&&!v.done&&(a=g["return"])&&a.call(g)}finally{if(o)throw o.error}}},Ys.prototype.isEnable=function(e){var t=this;e?this.loopCharacteristicsTemp&&(this.loopCharacteristics.enable=!0,this.loopCharacteristics.sequential=this.loopCharacteristicsTemp.sequential,this.loopCharacteristics.loopCardinality=this.loopCharacteristicsTemp.loopCardinality,this.loopCharacteristics.completionConditionRules=new Array,this.loopCharacteristicsTemp.completionConditionRules&&this.loopCharacteristicsTemp.completionConditionRules.forEach(function(e){return t.loopCharacteristics.completionConditionRules.push(e.clone())}),this.loopCharacteristicsTemp=null):(this.loopCharacteristicsTemp=new Ws,this.loopCharacteristicsTemp.enable=!0,this.loopCharacteristicsTemp.sequential=this.loopCharacteristics.sequential,this.loopCharacteristicsTemp.loopCardinality=this.loopCharacteristics.loopCardinality,this.loopCharacteristicsTemp.completionConditionRules=new Array,this.loopCharacteristics&&this.loopCharacteristics.completionConditionRules&&this.loopCharacteristics.completionConditionRules.forEach(function(e){return t.loopCharacteristicsTemp.completionConditionRules.push(e.clone())}),this.loopCharacteristics=new Ws),this.validate(e)},Ys.prototype.validate=function(e){1==e&&(!this.loopCharacteristics.completionConditionRules||this.loopCharacteristics.completionConditionRules.length<1)&&this.setCompletionConditionRules(this.loopCharacteristics.completionConditionRules)},Ys.prototype.setCompletionConditionRules=function(e){var t=this,r=this.resolver.resolveComponentFactory(on).create(this.injector),e=(r.instance.value1=e,r.instance.submitModal.subscribe(function(e){t.loopCharacteristics.completionConditionRules=e,i.close()}),r.instance.closeModal.subscribe(function(e){i.close()}),{title:this.localePipe.transform("multiInstanceLoopCharacteristics.completionConditionRules"),width:800,height:515,buttons:r.instance.modalFooter1,showButtons:!0}),i=this.modalService.show(r,e)},Ys.prototype.clickOK=function(){var e,t=this,r={value:this.loopCharacteristics,parameters:null};this.preEnable!=this.loopCharacteristics.enable||this.preSequential!=this.loopCharacteristics.sequential?(e="/api/runtime/wf/v1.0/processInstances/runtimeActivityInstances?procDefId="+this.uistate.procDefId+"&activityDefinitionId="+this.uistate.propertyData.Id,this.http.get(e).subscribe(function(e){t.uistate.time===We.rt&&e&&0<e.length?t.message.info(t.localePipe.transform("multiInstanceLoopCharacteristics.checkPrompt")):t.submitModal.emit(r)})):this.submitModal.emit(r)},Ys.prototype.clickCancel=function(){this.closeModal.emit()},Ys.decorators=[{type:b.Component,args:[{selector:"lib-multi-instance-loop-characteristics",template:'<div class="f-page">\r\n  <div class="f-utils-fill-flex-column farris-split-section m-2 h-100">\r\n    <section class="f-utils-fill-flex-column h-100">\r\n      <div class="f-utils-fill-flex-column farris-overflow-y-auto h-100" style="border-radius:16px;border: 1.5px solid #F1F3F7;">\r\n        <div class="farris-form form-inline farris-form-inline">\r\n          <div class="col-12 farris-group-auto my-3 pr-5">\r\n            <div class="farris-group-wrap">\r\n              <div class="form-group">\r\n                <label class="col-form-label">\r\n                  <span class="farris-label-text">{{\'multiInstanceLoopCharacteristics.isEnable\' | wfLocale}}</span>\r\n                </label>\r\n                <div class="farris-input-wrap mr-5">\r\n                  <farris-switch [(ngModel)]="loopCharacteristics.enable" name="enable" (valueChange)="isEnable($event)"></farris-switch>\r\n                  <div class="farris-feedback valid-feedback"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class="col-12 farris-group-auto my-3 pr-5">\r\n            <div class="farris-group-wrap">\r\n              <div class="form-group">\r\n                <label class="col-form-label">\r\n                  <span class="farris-label-text">{{\'multiInstanceLoopCharacteristics.isSequential\' | wfLocale}}</span>\r\n                </label>\r\n                <div class="farris-input-wrap mr-5">\r\n                  <farris-switch [(ngModel)]="loopCharacteristics.sequential" name="sequential"></farris-switch>\r\n                  <div class="farris-feedback valid-feedback"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class="col-12 farris-group-auto my-3 pr-5">\r\n            <div class="farris-group-wrap">\r\n              <div class="form-group farris-form-group">\r\n                <label class="col-form-label">\r\n                  <span class="farris-label-text">{{\'multiInstanceLoopCharacteristics.loopCardinality\' | wfLocale}}</span>\r\n                </label>\r\n                <div class="farris-input-wrap ml-1">\r\n                  <input-group [editable]="false" [enableClear]="false" [customCls]="\'custom-cls\'" [groupText]="groupIcon2"\r\n                    [(value)]="loopCharacteristics.loopCardinality" (clickHandle)="loopCardinalityExpr($event)">\r\n                  </input-group>\r\n                  <div class="farris-feedback valid-feedback"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class="col-12 farris-group-auto my-3 pr-5">\r\n            <div class="farris-group-wrap">\r\n              <div class="form-group farris-form-group">\r\n                <label class="col-form-label">\r\n                  <span class="farris-label-text"></span>\r\n                </label>\r\n                <div class="farris-input-wrap" style="padding-right: 30px;border-radius:15px">\r\n                  <div class="page-friendly-reminder" style="background:#ECF4FF;padding: 0.5rem!important;border-radius:6px">\r\n                    <div class="reminder-message">\r\n                      <span class="reminder-title">\r\n                        <span class="f-icon f-icon-info">\r\n                        </span>\r\n                        <span class="reminder-name" style="padding-left: 0.25rem">\r\n                        </span>\r\n                      </span>\r\n                      <span class="message" *ngIf="promptAct"><br/>{{\'multiInstanceLoopCharacteristics.promptAct1\' | wfLocale}}<br/>\r\n                        {{\'multiInstanceLoopCharacteristics.promptAct2\' | wfLocale}}<br/>\r\n                      </span>\r\n                      <span class="message" *ngIf="!promptAct"><br/>{{\'multiInstanceLoopCharacteristics.promptProc1\' | wfLocale}}<br/>\r\n                        {{\'multiInstanceLoopCharacteristics.promptProc2\' | wfLocale}}<br/>\r\n                      </span>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class="col-12 farris-group-auto my-3 pr-5" *ngIf="loopCharacteristics.enable">\r\n            <div class="farris-group-wrap">\r\n              <div class="form-group farris-form-group">\r\n                <label class="col-form-label">\r\n                  <span class="farris-label-text">{{\'multiInstanceLoopCharacteristics.completionConditionRules\' | wfLocale}}</span>\r\n                </label>\r\n                <div class="farris-input-wrap ml-1">\r\n                  <input-group [editable]="false" [enableClear]="false" [customCls]="\'custom-cls\'" [groupText]="groupIcon2" \r\n                    [(value)]="conditionRulesIsSet" (clickHandle)="setCompletionConditionRules(loopCharacteristics.completionConditionRules)">\r\n                  </input-group>\r\n                  <div class="farris-feedback valid-feedback"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </section>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type="button" class="btn btn-secondary btn-sm" (click)="clickCancel()">{{\'component.timeLimitControl.clickCancel\' | wfLocale }}</button>\r\n  <button type="button" class="btn btn-primary btn-sm mx-2" (click)="clickOK()">{{\'component.timeLimitControl.clickOK\' | wfLocale }}</button>\r\n</ng-template>',providers:[x],styles:[""]}]}],Ys.ctorParameters=function(){return[{type:b.ComponentFactoryResolver},{type:b.Injector},{type:a},{type:D.ExpressionService},{type:i.BsModalService},{type:r.MessagerService},{type:t.HttpService},{type:b.ChangeDetectorRef,decorators:[{type:b.Optional}]},{type:String,decorators:[{type:b.Inject,args:[b.LOCALE_ID]}]},{type:undefined,decorators:[{type:b.Inject,args:[o]}]},{type:x,decorators:[{type:b.Optional}]}]},Ys.propDecorators={cls:[{type:b.HostBinding,args:["class"]}],closeModal:[{type:b.Output}],submitModal:[{type:b.Output}],value:[{type:b.Input}],editorParams:[{type:b.Input}],modalFooter:[{type:b.ViewChild,args:["iconSelectFooter"]}],cell:[{type:b.ViewChild,args:["cell"]}],grid:[{type:b.ViewChild,args:["grid"]}]};var $s=Ys;function Ys(e,t,r,i,n,o,a,s,l,c,p){this.resolver=e,this.injector=t,this.uistate=r,this.expr=i,this.modalService=n,this.message=o,this.http=a,this.cdr=s,this.localeId=l,this.resources=c,this.localePipe=p,this.cls="farris-main-area flex-column",this.groupIcon2='<i class="f-icon f-icon-lookup"></i>',this.closeModal=new b.EventEmitter,this.submitModal=new b.EventEmitter,this.editorParams={},this.preEnable=!1,this.preSequential=!1,this.loopCharacteristics=new Ws,this.loopCharacteristicsTemp=null,this.conditionRulesIsSet=this.localePipe.transform("multiInstanceLoopCharacteristics.conditionRulesSet"),this.bpmnModel=this.uistate.bpmnModel,this.modalConfig={title:this.localePipe.transform("multiInstanceLoopCharacteristics.loopCharacteristics"),width:550,height:450,showButtons:!0},this.localePipe=this.localePipe||new x(l,c)}Zs.prototype.convertTo=function(e){return e&&e.enable?this.localePipe.transform("multiInstanceLoopCharacteristics.set"):this.localePipe.transform("multiInstanceLoopCharacteristics.notSet")};var Xs=Zs;function Zs(e){this.localePipe=e}el.prototype.setFlowElementProperty=function(e){this.uiState.propertyData=e.propertyData,this.uiState.propertyConfig=this.setFlowEleConfig(e.propertyConfig)},el.prototype.setFlowEleConfig=function(e){var t=this,r=[];return e&&e.forEach(function(e){t.setFlowEleEntity(e.properties),r.push(e)}),r},el.prototype.setFlowEleEntity=function(e){var r=this;e&&0<e.length&&e.forEach(function(e){switch(e.propertyID){case os:break;case Gs:e.editor=mn,e.converter=new hn(r.localPipe),e.editorParams={};break;case Ns:e.editor=$t;var t={location:"startActivity",tab:"web"};e.converter=new Xt(t,r.localPipe),e.editorParams=t;break;case Ls:e.editor=$t;t={location:"startActivity",tab:"mobile"};e.converter=new Xt(t,r.localPipe),e.editorParams=t;break;case Ks:case xs:e.iterator=r.uiState.boolIterator;break;case ws:e.editor=gn,e.converter=new bn(r.localPipe);break;case Es:case js:e.iterator=r.uiState.boolIterator;break;case _s:e.editor=ts,e.converter=new is(r.uiState,r.localPipe),e.editorParams={location:"startActivity"};break;default:e.editor=di,e.converter=new mi(r.localPipe)}})},el.prototype.setUserActivityProperty=function(e,t){e.propertyData.ApprovalItems&&(this.buildApprovalItems(e.propertyData.ApprovalItems),this.buildCounterSignVariables(e.propertyData.ApprovalItems),this.buildSignRules(e.propertyData.SignRule)),this.uiState.propertyData=e.propertyData,this.uiState.bizActivityId=e.propertyData.BizActivityID,this.uiState.propertyConfig=this.setUserActConfig(e.propertyConfig,t)},el.prototype.setUserActConfig=function(e,t){var r=this,i=[];return e&&e.forEach(function(e){r.setUserActEntity(e.properties,t),i.push(e)}),i},el.prototype.setUserActEntity=function(e,r){var i=this;e&&0<e.length&&e.forEach(function(e){switch(e.propertyID){case os:break;case cs:e.editor=$a,e.converter=new Ya(i.localPipe),e.editorParams={nodeType:"userActivity"};break;case ps:e.editor=Eo,e.converter=new To(i.localPipe),e.editorParams={location:r};break;case Bs:e.editor=ko,e.converter=new Oo,e.editorParams={nodeType:"userActivity",type:"assignPerformer"};break;case Ns:e.editor=$t;var t={location:"userActivity",tab:"web"};e.converter=new Xt(t,i.localPipe),e.editorParams=t;break;case Ls:e.editor=$t;t={location:"userActivity",tab:"mobile"};e.converter=new Xt(t,i.localPipe),e.editorParams=t;break;case us:e.editor=Ga,e.converter=new qa(i.localPipe);break;case ms:i.uiState.propertyData.AssignStrategy===i.uiState.assignIterator[2].key?e.iterator=i.uiState.completeIterator4Claim:e.iterator=i.uiState.completeIterator;break;case fs:e.editor=on,e.converter=new sn(i.localPipe),e.editorParams={variables:i.uiState.counterSignVariables,approvalItems:i.uiState.approvalItems};break;case ds:e.editor=cn,e.converter=new dn(i.localPipe);break;case ys:e.iterator=i.uiState.boolIterator;break;case gs:case vs:case bs:case Ts:e.editor=ma,e.converter=new ha(i.localPipe),e.editorParams={nodeType:"userActivity",tabId:"approvalProperty"};break;case Is:e.iterator=i.uiState.boolIterator;break;case xs:i.uiState.propertyData.CompleteStrategy&&i.uiState.propertyData.CompleteStrategy!==i.uiState.completeIterator[0].key?e.iterator=i.uiState.noJump4Sign:e.iterator=i.uiState.boolIterator;break;case ws:e.editor=gn,e.converter=new bn(i.localPipe);break;case Ps:e.editor=In,e.converter=new En(i.localPipe),e.editorParams={nodeType:"UserActivity"};break;case Ss:e.editor=Qt,e.converter=new tr(i.localPipe);break;case Cs:e.editor=Et,e.converter=new At(i.localPipe),e.editorParams={location:"activity"};break;case Us:e.editor=ar,e.converter=new lr(i.localPipe);break;case ks:e.editor=Ur,e.converter=new Hr(i.localPipe),e.editorParams={location:"activity"};break;case hs:e.editor=$s,e.converter=new Xs(i.localPipe),e.editorParams={location:"activity"};break;case Os:e.editor=va,e.converter=new xa(i.localPipe);break;case Ms:e.editor=Ca,e.converter=new Sa(i.localPipe);break;case Ds:e.editor=ai,e.converter=new ci(i.localPipe),e.editorParams={location:"activity"};break;case Fs:e.editor=ka,e.converter=new Ma(i.localPipe);break;case As:e.iterator=i.uiState.displayTerminal;break;case Rs:e.editor=Fa,e.converter=new Va(i.localPipe);break;case Vs:e.editor=yi,e.converter=new vi(i.localPipe);break;case zs:e.editor=Ua,e.converter=new Ha(i.localPipe);break;case js:e.iterator=i.uiState.boolIterator;break;case Hs:case _s:e.editor=ts;e.editorParams={location:"userActivity"},e.converter=new is(i.uiState,i.localPipe);break;default:e.editor=di,e.converter=new mi(i.localPipe)}})},el.prototype.buildCounterSignVariables=function(e){var t,r;if(this.uiState.counterSignVariables=[],this.uiState.counterSignVariables=this.uiState.counterSignVariables.concat([{key:"nrOfInstances",name:"总任务数",description:"总任务数"},{key:"nrOfCompletedInstances",name:"已完成任务数",description:"已完成任务数"}]),e&&0<e.length)try{for(var i=ue(e),n=i.next();!n.done;n=i.next()){var o=n.value,a=new D.VarEntity;a.key="nrOf"+o.Value,a.name=o.Text+"_任务数",a.description=o.Text+"_任务数",this.uiState.counterSignVariables.push(a)}}catch(s){t={error:s}}finally{try{n&&!n.done&&(r=i["return"])&&r.call(i)}finally{if(t)throw t.error}}},el.prototype.buildApprovalItems=function(e){var t,r;if(this.uiState.approvalItems=[],e&&0<e.length)try{for(var i=ue(e),n=i.next();!n.done;n=i.next()){var o=n.value,a=new rn;a.value=o.Value,a.text=o.Text,a.workFlowAction=o.WorkFlowAction,a.isDefault=o.IsDefault,this.uiState.approvalItems.push(a)}}catch(s){t={error:s}}finally{try{n&&!n.done&&(r=i["return"])&&r.call(i)}finally{if(t)throw t.error}}},el.prototype.buildSignRules=function(e){var t,r;if(e&&0<e.length){var i=this;try{for(var n=ue(e),o=n.next();!o.done;o=n.next())!function(t){var e=i.uiState.approvalItems.find(function(e){return e.value===t.ConclusionValue});t.ConclusionName=e?e.text:"已删除"}(o.value)}catch(a){t={error:a}}finally{try{o&&!o.done&&(r=n["return"])&&r.call(n)}finally{if(t)throw t.error}}}},el.decorators=[{type:b.Injectable}],el.ctorParameters=function(){return[{type:a},{type:r.MessagerService},{type:b.Injector},{type:i.BsModalService},{type:b.ComponentFactoryResolver},{type:x}]};var Qs=el;function el(e,t,r,i,n,o){this.uiState=e,this.message=t,this.injector=r,this.modalService=i,this.resolver=n,this.localPipe=o}rl.prototype.ngOnInit=function(){},rl.prototype.saveAsOK=function(){this.disabled=!0,this.validator()&&this.submit.next({procName:this.procName,accessLevel:this.accessLevel,organization:this.organization,organizationName:this.organizationName})},rl.prototype.saveAsCancel=function(){this.cancel.emit()},rl.prototype.validator=function(){return this.procName?!!this.organization||(this.message.warning(this.localePipe.transform("component.saveAsEdit.organizationNotEmpty")),this.disabled=!1):(this.message.warning(this.localePipe.transform("component.saveAsEdit.nameNotEmpty")),this.disabled=!1)},rl.prototype.search=function(e){this.lookUp.componentRef.instance.searchHandle.search(e.field,e.value,"client")},rl.prototype.selectedDataHandler=function(e){this.organization=e.id,this.organizationName=e.name},rl.prototype.orgTreeData=function(e,t){var r,i,n=new Array,o=new Array;try{for(var a=ue(e),s=a.next();!s.done;s=a.next()){var l=s.value,c={};c.data=l,c.children=[],c.id=l.id,c.leaf=l.isDetail,c.selectable=l.farris_selectable,o.push(c)}}catch(y){r={error:y}}finally{try{s&&!s.done&&(i=a["return"])&&i.call(a)}finally{if(r)throw r.error}}for(var p={},d=o.length,u=0;u<d;u++)p[o[u].id]=o[u];for(var m=0;m<d;m++){var f=o[m],h=p[f.data.parentId];(h?(h.children||(h.children=new Array),h.children):n).push(f)}return t&&this.treeIterator(n),n},rl.prototype.treeIterator=function(e){var t,r;if(e&&0<e.length)try{for(var i=ue(e),n=i.next();!n.done;n=i.next()){var o=n.value;o.children&&0<o.children.length?this.treeIterator(o.children):o.leaf=!0}}catch(a){t={error:a}}finally{try{n&&!n.done&&(r=i["return"])&&r.call(i)}finally{if(t)throw t.error}}},rl.prototype.findChild=function(r,i){var n=this,e=i.filter(function(e){if(e.parentId===r.id)return!0});e&&0<e.length&&e.forEach(function(e){var t={};t.data=e,t.children=[],t.id=e.id,t.leaf=e.isDetail,t.selectable=e.farris_selectable,r.children.push(t),n.findChild(t,i)})},rl.prototype.makeTreeByParent=function(r,i,n){var t=this,e=r.filter(function(t){return!t[i]||!r.find(function(e){return e[n]===t[i]})||void 0}),o=[];return e.forEach(function(e){var t={};t.data=e,t.children=[],o.push(t)}),o.forEach(function(e){t.findChildrenByParent(e,r,i,n)}),o},rl.prototype.findChildrenByParent=function(r,i,n,o){var a=this,e=i.filter(function(e){if(e[n]===r.data[o])return!0});e&&0<e.length&&e.forEach(function(e){var t={};t.data=e,t.children=[],r.children.push(t),a.findChildrenByParent(t,i,n,o)})},rl.prototype.getSysOrgs=function(e,t,r){var i="/api/runtime/sys/v1.0/sysOrgs",t=t?Object.assign(t,{IsSearchTree:!0,withPermission:!0,ruleFilter:r}):e?Object.assign({},{parentId:e,withPermission:!0,ruleFilter:r}):Object.assign({},{parentId:"",layer:1,withPermission:!0,ruleFilter:r});return i+="?param="+JSON.stringify(t),this.http.get(i)},rl.decorators=[{type:b.Component,args:[{selector:"app-save-as-edit",template:'\x3c!-- <div class="f-page">\r\n  <div class="f-page-main">\r\n    <div class="d-flex m-2 py-2 farris-row">\r\n      <div class="w-100 px-4">\r\n        <label class="col-form-label">\r\n          <span class="farris-label-text">流程名称</span>\r\n        </label>\r\n        <div class="farris-input-wrap">\r\n          <input type="text" class="form-control" [(ngModel)]="procName" name="procName" />\r\n          <div class="farris-feedback valid-feedback"></div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class="d-flex m-2 py-2 farris-row">\r\n      <div class="px-4 w-100">\r\n        <label class="col-form-label">\r\n          <span class="farris-label-text">流程Key值</span>\r\n        </label>\r\n        <div class="farris-input-wrap">\r\n          <input type="text" class="form-control" [(ngModel)]="procKey" name="procKey" [readonly]="true" />\r\n          <div class="farris-feedback valid-feedback"></div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div> --\x3e\r\n\r\n<div class="f-page f-page-card f-page-is-mainsubcard">\r\n  <section class="f-page-main">\r\n    \x3c!--不确认---------------------------卡片组件不同的Section是在不同的组件里，还是在同一个卡片组件里--\x3e\r\n    \x3c!--表单区域--\x3e\r\n    \x3c!--需要嵌套的层---------------------------IDE转化成组件-----------\x3e\r\n    <div class="f-struct-wrapper">\r\n      <farris-section class="f-section-form f-section-in-mainsubcard" [enableAccordion]="\'\'" mainTitle="{{\'component.saveAsEdit.basicAttributes\'|wfLocale}}"\r\n        [subTitle]="\'\'" [enableMaximize]="false">\r\n\r\n        \x3c!--输入控件 没有分组--\x3e\r\n        <div class="f-form-layout farris-form farris-form-controls-inline pr-4 m-2">\r\n          <div class="col-12 px-0 my-2">\r\n            <div class="farris-group-wrap">\r\n              <div class="form-group farris-form-group">\r\n                <label class="col-form-label">\r\n                  <span class="farris-label-info text-danger">*</span>\r\n                  <span class="farris-label-text">{{\'component.saveAsEdit.processName\' | wfLocale}}</span>\r\n                </label>\r\n                <div class="farris-input-wrap">\r\n                  <input type="text" class="form-control" [(ngModel)]="procName" name="procName" />\r\n                  <div class="farris-feedback valid-feedback"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class="col-12 px-0 my-2">\r\n            <div class="farris-group-wrap">\r\n              <div class="form-group farris-form-group">\r\n                <label class="col-form-label">\r\n                  <span class="farris-label-text">{{\'component.saveAsEdit.processKeyValue\' | wfLocale}}</span>\r\n                </label>\r\n                <div class="farris-input-wrap">\r\n                  <input type="text" class="form-control" [(ngModel)]="procKey" name="procKey" [readonly]="true" />\r\n                  <div class="farris-feedback valid-feedback"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class="col-12 px-0 my-2">\r\n            <div class="farris-group-wrap">\r\n              <div class="form-group farris-form-group">\r\n                <label class="col-form-label">\r\n                  <span class="farris-label-info text-danger">*</span>\r\n                  <span class="farris-label-text">{{\'component.saveAsEdit.maintenanceOrg\' | wfLocale}}</span>\r\n                </label>\r\n                <div class="farris-input-wrap">\r\n                  <farris-lookup-grid *ngIf="!enableAdminOrgAut; else adminOrg" #lookup [(ngModel)]="organizationName" name="orgName"\r\n                    [singleSelect]="true" [dictPicked]="dictPicked"\r\n                    [enableClear]="false"\r\n                    [editable]="false"\r\n                    [dictPicking]="dictPicking"\r\n                    [uri]="dataUri"\r\n                    [loadTreeDataType]="loadType">\r\n                  </farris-lookup-grid>\r\n                  <div class="farris-feedback valid-feedback"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class="col-12 px-0 my-2">\r\n            <div class="farris-group-wrap">\r\n              <div class="form-group farris-form-group">\r\n                <label class="col-form-label">\r\n                  <span class="farris-label-info text-danger">*</span>\r\n                  <span class="farris-label-text">{{\'component.saveAsEdit.accessLevel\' | wfLocale}}</span>\r\n                </label>\r\n                <div class="farris-input-wrap">\r\n                  <farris-combo-list [(ngModel)]="accessLevel" name="accessLevel"\r\n                    [ngModelOptions]="{standalone: true}" [idField]="\'value\'" [textField]="\'text\'"\r\n                    [valueField]="\'value\'" [data]="accessLevelCollection" [panelHeight]="\'auto\'" [enableClear]="false">\r\n                  </farris-combo-list>\r\n                  <div class="farris-feedback valid-feedback"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </farris-section>\r\n    </div>\r\n  </section>\r\n</div>\r\n\r\n<ng-template #buttonRef>\r\n  <button type="button" class="btn btn-secondary btn-sm mx-2" (click)="saveAsCancel()">{{\'component.saveAsEdit.saveAsCancel\' | wfLocale}}</button>\r\n  <button type="button" class="btn btn-sm btn-primary mx-2" [disabled]="disabled" (click)="saveAsOK()">{{\'component.saveAsEdit.saveAsOK\' | wfLocale}}</button>\r\n</ng-template>\r\n\r\n\r\n<ng-template #adminOrg>\r\n  <farris-lookup-grid #adminOrgLookup [(ngModel)]="organizationName" name="adminOrgName"\r\n    [helpId]="\'processdesigneradminorgdataaut\'" [enableClear]="false" [editable]="false"\r\n    [singleSelect]="true" [uri]="\'assets/data/tree-list-help.json\'" (selectedData)="selectedDataHandler($event)">\r\n  </farris-lookup-grid>\r\n</ng-template>\r\n',providers:[{provide:Ee.ServerSideToken,useClass:F.LookupDataService},x],styles:[""]}]}],rl.ctorParameters=function(){return[{type:b.Injector},{type:t.HttpService},{type:r.MessagerService},{type:b.ChangeDetectorRef,decorators:[{type:b.Optional}]},{type:String,decorators:[{type:b.Inject,args:[b.LOCALE_ID]}]},{type:undefined,decorators:[{type:b.Inject,args:[o]}]},{type:x,decorators:[{type:b.Optional}]}]},rl.propDecorators={btnRef:[{type:b.ViewChild,args:["buttonRef"]}],procName:[{type:b.Input}],procKey:[{type:b.Input}],lookUp:[{type:b.ViewChild,args:["lookup"]}],submit:[{type:b.Output}],cancel:[{type:b.Output}]};var tl=rl;function rl(e,t,r,i,n,o,a){var s=this;this.injector=e,this.http=t,this.message=r,this.cdr=i,this.localeId=n,this.resources=o,this.localePipe=a,this.submit=new b.EventEmitter,this.cancel=new b.EventEmitter,this.accessLevel="public",this.isAdministratorConfig=!1,this.enableAdminOrgAut=!1,this.dataUri="/api/runtime/sys/v1.0/sysOrgs",this.loadType="layerload",this.disabled=!1,this.items=new Array,this.accessLevelCollection=[{value:"public",text:this.localePipe.transform("component.saveAsEdit.public")},{value:"private",text:this.localePipe.transform("component.saveAsEdit.private")}],this.columns=[{title:this.localePipe.transform("component.saveAsEdit.code"),field:"code",width:"100",searchField:"code"},{title:this.localePipe.transform("component.saveAsEdit.name"),field:"name",width:"100",searchField:"name"}],this.dictPicking=function(e){return s.lookUp.http={getData:function(e,t){console.log(t);var r,i,t=JSON.parse(t.searchValue).parentId;return s.lookUp._searchState&&s.lookUp._searchState.field&&s.lookUp._searchState.value&&(r="*"===s.lookUp._searchState.field?{codeOrName:s.lookUp._searchState.value}:"name"===s.lookUp._searchState.field?{name:s.lookUp._searchState.value}:{code:s.lookUp._searchState.value}),s.isAdministratorConfig&&(i=s.administrator.administratorAuthorities.map(function(e){return{id:e.organization,rule:e.includeSubordinate?"SelectedAndChild":"Selected"}})),s.getSysOrgs(t,r,i).pipe(re.switchMap(function(e){return console.log(e),v.of({columns:s.columns,displayInfo:{idField:"id",valueField:"id",textField:"name"},displayType:"TreeList",idField:"id",valueField:"id",textField:"name",searchFields:[{label:"code",value:"code"},{label:"name",value:"name"}],title:s.localePipe.transform("component.saveAsEdit.organization"),total:0,treeInfo:{dataField:"treeinfo",isDetailField:"isDetail",layerField:"layer",layerType:"parentId",loadDataType:"async",onlySelectLeaf:!1,parentField:"parentElement",pathField:"path",treeDataIsInit:!0},items:s.orgTreeData(e,r)})}))}},v.of(!0)},this.dictPicked=function(e){return s.organizationName=e.name,s.organization=e.id,v.of(!0)},this.localePipe=this.localePipe||new x(n,o)}var il={InheritParent:"SameWithParent",VariablesExpression:"VariablesExpression",AutoCreation:"AutoGenerateDownBill"},nl={Dynamic:"Dynamic",Specified:"Specified"},ol=function(){this.subProcessType=nl.Specified,this.billSourceType=il.InheritParent},al=(sl.bifMonitorAppId="BillIntegrationFrameworkRT",sl.bifManagerAppEntrance="bif-manager",sl.bifDiagnostorFuncId="BifDiagnostor",sl.bifManagerFuncId="BifManager",sl);function sl(){}var ll,cl={BifCreationProcess:"BifCreationProcess",BifWritebackProcess:"BifWritebackProcess"},qo=(n(pl,ll=f.JsonConvertableImpl),pl.prototype.ResetBeforeLoadFrom=function(){ll.prototype.ResetBeforeLoadFrom.call(this),this.id=null,this.code=null,this.name=null,this.upBillVoName=null,this.downBillVoName=null,this.parentId=null,this.bifMetadataType=null,this.lastModifiedTime=null,this.sysInit=!1,this.originId=null,this.rootId=null},pl.prototype.ConvertToJsonObject=function(){var e=ll.prototype.ConvertToJsonObject.call(this);return f.BpmnModelJsonHelper.SetAttributeValue(e,"id",this.id),f.BpmnModelJsonHelper.SetAttributeValue(e,"code",this.code),f.BpmnModelJsonHelper.SetAttributeValue(e,"name",this.name),f.BpmnModelJsonHelper.SetAttributeValue(e,"upBillVoName",this.upBillVoName),f.BpmnModelJsonHelper.SetAttributeValue(e,"downBillVoName",this.downBillVoName),f.BpmnModelJsonHelper.SetAttributeValue(e,"parentId",this.parentId),f.BpmnModelJsonHelper.SetAttributeValue(e,"bifMetadataType",this.bifMetadataType),f.BpmnModelJsonHelper.SetAttributeValue(e,"lastModifiedTime",this.lastModifiedTime),f.BpmnModelJsonHelper.SetAttributeValue(e,"sysInit",this.sysInit),f.BpmnModelJsonHelper.SetAttributeValue(e,"originId",this.originId),f.BpmnModelJsonHelper.SetAttributeValue(e,"rootId",this.rootId),e},pl.prototype.LoadFromJsonObject=function(e){ll.prototype.LoadFromJsonObject.call(this,e),this.id=f.BpmnModelJsonHelper.GetAttributeValueAsString(e,"id"),this.code=f.BpmnModelJsonHelper.GetAttributeValueAsString(e,"code"),this.name=f.BpmnModelJsonHelper.GetAttributeValueAsString(e,"name"),this.upBillVoName=f.BpmnModelJsonHelper.GetAttributeValueAsString(e,"upBillVoName"),this.downBillVoName=f.BpmnModelJsonHelper.GetAttributeValueAsString(e,"downBillVoName"),this.parentId=f.BpmnModelJsonHelper.GetAttributeValueAsString(e,"parentId"),this.bifMetadataType=cl[f.BpmnModelJsonHelper.GetAttributeValueAsString(e,"bifMetadataType")],this.lastModifiedTime=f.BpmnModelJsonHelper.GetAttributeValueAsDateTime(e,"lastModifiedTime"),this.sysInit=f.BpmnModelJsonHelper.GetAttributeValueAsBoolean(e,"sysInit"),this.originId=f.BpmnModelJsonHelper.GetAttributeValueAsString(e,"originId"),this.rootId=f.BpmnModelJsonHelper.GetAttributeValueAsString(e,"rootId")},pl);function pl(){var e=null!==ll&&ll.apply(this,arguments)||this;return e.sysInit=!1,e}n(ml,dl=qo),ml.prototype.ResetBeforeLoadFrom=function(){dl.prototype.ResetBeforeLoadFrom.call(this),this.isEnabled=!1},ml.prototype.ConvertToJsonObject=function(){var e=dl.prototype.ConvertToJsonObject.call(this);return f.BpmnModelJsonHelper.SetAttributeValue(e,"isEnabled",this.isEnabled),e},ml.prototype.LoadFromJsonObject=function(e){dl.prototype.LoadFromJsonObject.call(this,e),this.isEnabled=f.BpmnModelJsonHelper.GetAttributeValueAsBoolean(e,"isEnabled")};var dl,ul=ml;function ml(){return null!==dl&&dl.apply(this,arguments)||this}n(yl,fl=ul),yl.prototype.ResetBeforeLoadFrom=function(){fl.prototype.ResetBeforeLoadFrom.call(this),this.isEnabled=!1,this.customizationEntities.length=0},yl.prototype.ConvertToJsonObject=function(){var e=fl.prototype.ConvertToJsonObject.call(this);return f.BpmnModelJsonHelper.SetAttributeValue(e,"isEnabled",this.isEnabled),f.BpmnModelJsonHelper.SetAttributeValue(e,"customizationEntities",this.customizationEntities),e},yl.prototype.LoadFromJsonObject=function(e){fl.prototype.LoadFromJsonObject.call(this,e),this.isEnabled=f.BpmnModelJsonHelper.GetAttributeValueAsBoolean(e,"isEnabled"),this.customizationEntities=f.BpmnModelJsonHelper.GetAttributeValueAsList(e,"customizationEntities",yl)},yl.prototype.getTClass=function(){return yl};var fl,hl=yl;function yl(){var e=null!==fl&&fl.apply(this,arguments)||this;return e.customizationEntities=new Array,e}n(bl,gl=f.JsonConvertableImpl),bl.prototype.ResetBeforeLoadFrom=function(){gl.prototype.ResetBeforeLoadFrom.call(this),this.totalCount=0,this.pageCount=0,this.pageIndex=0,this.pageSize=0,this.entities.length=0},bl.prototype.ConvertToJsonObject=function(){var e=gl.prototype.ConvertToJsonObject.call(this);return f.BpmnModelJsonHelper.SetAttributeValue(e,"totalCount",this.totalCount),f.BpmnModelJsonHelper.SetAttributeValue(e,"pageCount",this.pageCount),f.BpmnModelJsonHelper.SetAttributeValue(e,"pageIndex",this.pageIndex),f.BpmnModelJsonHelper.SetAttributeValue(e,"pageSize",this.pageSize),f.BpmnModelJsonHelper.SetAttributeValue(e,"entities",this.entities),e},bl.prototype.LoadFromJsonObject=function(e){gl.prototype.LoadFromJsonObject.call(this,e),this.totalCount=f.BpmnModelJsonHelper.GetAttributeValueAsNumber(e,"totalCount"),this.pageCount=f.BpmnModelJsonHelper.GetAttributeValueAsNumber(e,"pageCount"),this.pageIndex=f.BpmnModelJsonHelper.GetAttributeValueAsNumber(e,"pageIndex"),this.pageSize=f.BpmnModelJsonHelper.GetAttributeValueAsNumber(e,"pageSize"),this.entities=f.BpmnModelJsonHelper.GetAttributeValueAsList(e,"entities",hl)};var gl,vl=bl;function bl(){var e=null!==gl&&gl.apply(this,arguments)||this;return e.entities=new Array,e}wl.prototype.openBifManagerApp=function(e){var t=new Map,t=(t.set("id",e.id),t.set("type",e.bifMetadataType),t.set("srcFuncId",al.bifDiagnostorFuncId),{funcId:al.bifManagerFuncId,appId:al.bifMonitorAppId,appEntrance:al.bifManagerAppEntrance,appType:"menu",entityParams:{},queryStringParams:t,tabId:e.id,tabName:e.name});this.frameworkService.openMenu(t)},wl.prototype.getDatagridData=function(e){var t=e.ConvertToJson();return null!=e.bizType?this.httpService.post(this.baseUrl+"/getpatch",t).pipe(re.map(function(e){var t=new vl;return t.entities=e.map(function(e){var t=new ul;return t.LoadFromJsonObject(e),t}),t})):this.httpService.post(this.baseUrl+"/getpagedpatch",t).pipe(re.map(function(e){var t=new vl;return t.LoadFromJsonObject(e),t}))},wl.prototype.getProcessNameByCode=function(e){return this.httpService.request("GET","/api/runtime/aif/v1.0/rtbillcreationprocess/getname/"+e,{responseType:"text"})},wl.decorators=[{type:b.Injectable}],wl.ctorParameters=function(){return[{type:Re.AppService},{type:Re.FrameworkService},{type:t.HttpService}]};var xl=wl;function wl(e,t,r){this.appService=e,this.frameworkService=t,this.httpService=r,this.baseUrl="/api/runtime/aif/v1.0/rtbillprocess"}n(Il,Pl=f.JsonConvertableImpl),Il.prototype.ResetBeforeLoadFrom=function(){Pl.prototype.ResetBeforeLoadFrom.call(this),this.name=null,this.upBillVoId=null,this.downBillVoId=null,this.isEnabled=null,this.billProcessType=null,this.sysInit=null,this.bizType=null,this.orderByCode=null,this.orderByName=null,this.OrderByLastModifiedTime=null,this.pageSize=0,this.pageIndex=0},Il.prototype.ConvertToJsonObject=function(){var e=Pl.prototype.ConvertToJsonObject.call(this);return f.BpmnModelJsonHelper.SetAttributeValue(e,"name",this.name),f.BpmnModelJsonHelper.SetAttributeValue(e,"upBillVoId",this.upBillVoId),f.BpmnModelJsonHelper.SetAttributeValue(e,"downBillVoId",this.downBillVoId),f.BpmnModelJsonHelper.SetAttributeValue(e,"isEnabled",this.isEnabled),f.BpmnModelJsonHelper.SetAttributeValue(e,"billProcessType",this.billProcessType),f.BpmnModelJsonHelper.SetAttributeValue(e,"sysInit",this.sysInit),f.BpmnModelJsonHelper.SetAttributeValue(e,"bizType",this.bizType),f.BpmnModelJsonHelper.SetAttributeValue(e,"orderByCode",this.orderByCode),f.BpmnModelJsonHelper.SetAttributeValue(e,"orderByName",this.orderByName),f.BpmnModelJsonHelper.SetAttributeValue(e,"OrderByLastModifiedTime",this.OrderByLastModifiedTime),f.BpmnModelJsonHelper.SetAttributeValue(e,"pageSize",this.pageSize),f.BpmnModelJsonHelper.SetAttributeValue(e,"pageIndex",this.pageIndex),e},Il.prototype.LoadFromJsonObject=function(e){Pl.prototype.LoadFromJsonObject.call(this,e),this.name=f.BpmnModelJsonHelper.GetAttributeValueAsJsonSerializable(e,"name",f.TextValue),this.upBillVoId=f.BpmnModelJsonHelper.GetAttributeValueAsJsonSerializable(e,"upBillVoId",f.TextValue),this.downBillVoId=f.BpmnModelJsonHelper.GetAttributeValueAsJsonSerializable(e,"downBillVoId",f.TextValue),this.isEnabled=f.BpmnModelJsonHelper.GetAttributeValueAsJsonSerializable(e,"isEnabled",f.TextValue),this.billProcessType=f.BpmnModelJsonHelper.GetAttributeValueAsJsonSerializable(e,"billProcessType",f.TextValue),this.sysInit=f.BpmnModelJsonHelper.GetAttributeValueAsJsonSerializable(e,"sysInit",f.TextValue),this.bizType=f.BpmnModelJsonHelper.GetAttributeValueAsJsonSerializable(e,"bizType",f.TextValue),this.orderByCode=f.BpmnModelJsonHelper.GetAttributeValueAsJsonSerializable(e,"orderByCode",f.TextValue),this.orderByName=f.BpmnModelJsonHelper.GetAttributeValueAsJsonSerializable(e,"orderByName",f.TextValue),this.OrderByLastModifiedTime=f.BpmnModelJsonHelper.GetAttributeValueAsJsonSerializable(e,"OrderByLastModifiedTime",f.TextValue),this.pageSize=f.BpmnModelJsonHelper.GetAttributeValueAsNumber(e,"pageSize"),this.pageIndex=f.BpmnModelJsonHelper.GetAttributeValueAsNumber(e,"pageIndex")};var Pl,Cl=Il;function Il(){return null!==Pl&&Pl.apply(this,arguments)||this}var Sl="Desc",F={"zh-CHS":{code:"编号",name:"名称",lastModifiedTime:"最后修改时间",upBill:"上游单据",downBill:"下游单据",processName:"流程名称",processType:"流程类型",creation:"生单",writeback:"回写",enabledState:"启用状态",sysInit:"系统预置",filter:"筛选",all:"全部",enabled:"已启用",disabled:"已禁用",yes:"是",no:"否",billSelector:"单据选择",querySolution:"筛选方案",collapse:"收起",expand:"展开",loading:"加载中",pleaseSelectNonVirtualVO:"请选择非虚拟VO",pleaseSelectOneItemOnly:"请选中一条数据",isExtendProcess:"扩展流程",creationProcess:"生单流程",clickCancel:"取消",clickOk:"确定",set:"（已设置）",notSet:"（未设置）",setProcess:"已设置："},en:{code:"Code",name:"Name",lastModifiedTime:"Last Modified Time",upBill:"Upstream Bill",downBill:"Downstream Bill",processName:"Process Name",processType:"Process Type",creation:"Creation",writeback:"Writeback",enabledState:"Enabled State",sysInit:"System Init",filter:"Filter",all:"All",enabled:"Enabled",disabled:"Disabled",yes:"Yes",no:"No",billSelector:"Bill Selector",querySolution:"Query Solution",collapse:"Collapse",expand:"Expand",loading:"Loading...",pleaseSelectNonVirtualVO:"Please select non-virtual VO",pleaseSelectOneItemOnly:"Please select only one item",isExtendProcess:"Extend Process",creationProcess:"Rreation Process",clickCancel:"Cancel",clickOk:"Ok",set:"(Set)",notSet:"(Not set)",setProcess:"Set: "},"zh-CHT":{code:"編號",name:"名稱",lastModifiedTime:"最後修改時間",upBill:"上遊單據",downBill:"下遊單據",processName:"流程名稱",processType:"流程類型",creation:"生單",writeback:"回寫",enabledState:"啟用狀態",sysInit:"系統預置",filter:"篩選",all:"全部",enabled:"已啟用",disabled:"已禁用",yes:"是",no:"否",billSelector:"單據選擇",querySolution:"篩選方案",collapse:"收起",expand:"展開",loading:"加載中",pleaseSelectNonVirtualVO:"請選擇非虛擬VO",pleaseSelectOneItemOnly:"請選中壹條數據",isExtendProcess:"擴展流程",creationProcess:"生單流程",clickCancel:"取消",clickOk:"確定",set:"（已設置）",notSet:"（未設置）",setProcess:"已設置："}},qo=F,El=(Object.defineProperty(Tl.prototype,"value",{set:function(e){e&&(this.processCode=e,this.setProcess.code=this.processCode,this.setProcess.showText=this.processCode)},enumerable:!0,configurable:!0}),Tl.prototype.ngOnInit=function(){var t=this;this.configTtColumns(),null!=this.processCode&&this.procHelpService.getProcessNameByCode(this.processCode).subscribe(function(e){t.setProcess.name=e,t.setProcess.name?t.setProcess.showText=t.setProcess.name+"("+t.setProcess.code+")":t.setProcess.showText=t.setProcess.code}),this.loadItems(this.queryParam.filterArgs).subscribe(function(){setTimeout(function(){var e;t.ttData&&0<t.ttData.length&&(e=null!=t.processCode?t.ttData.find(function(e){return e.code==t.processCode}):t.ttData[0])&&t.tt.selectRow(e.id)},300)})},Tl.prototype.clickOk=function(e){var t;null==this.tt.selectedRow?this.notify.warning(this.localePipe.transform("pleaseSelectOneItemOnly")):(this.procEmitter.emit(this.tt.selectedRow.data),t={value:this.tt.selectedRow.data.code,parameters:null},this.submitModal.emit(t),this.modalRef&&this.modalRef.close())},Tl.prototype.clickCancel=function(e){this.procEmitter.complete(),this.closeModal.emit(),this.modalRef&&this.modalRef.close()},Tl.prototype.onSearch=function(e){var t=this;this.queryParam=e,console.log(this.queryParam),this.loadItems(this.queryParam.filterArgs).subscribe(function(){t.tt.clearCheckeds(),t.tt.clearSelections()})},Tl.prototype.clickNameCell=function(e){this.procHelpService.openBifManagerApp(e.rowData)},Tl.prototype.onPageSizeChanged=function(e){var t=this,r=this.tt.checkeds.map(function(e){return e.data.id});this.queryParam.filterArgs.pageSize=e.pageSize,this.loadItems(this.queryParam.filterArgs).subscribe(function(){setTimeout(function(){t.tt.checkRows(r,!0),t.tt.refresh()},0)})},Tl.prototype.onPageChanged=function(e){var t=this,r=this.tt.checkeds.map(function(e){return e.data.id});this.queryParam.filterArgs.pageIndex=e.pageIndex-1,this.queryParam.filterArgs.pageSize=e.pageSize,this.loadItems(this.queryParam.filterArgs).subscribe(function(){setTimeout(function(){t.tt.checkRows(r,!0),t.tt.refresh()},0)})},Tl.prototype.pageChangeHandler=function(e){var t=this,r=this.tt.checkeds.map(function(e){return e.data.id});this.queryParam.filterArgs.pageIndex=e.pageIndex-1,this.queryParam.filterArgs.pageSize=e.pageSize,this.loadItems(this.queryParam.filterArgs).subscribe(function(){setTimeout(function(){t.tt.checkRows(r,!0),t.tt.refresh()},0)})},Tl.prototype.pageSizeChangeHandler=function(e){var t=this,r=this.tt.checkeds.map(function(e){return e.data.id});this.queryParam.filterArgs.pageSize=e,this.loadItems(this.queryParam.filterArgs).subscribe(function(){setTimeout(function(){t.tt.checkRows(r,!0),t.tt.refresh()},0)})},Tl.prototype.removeSetProcess=function(){},Tl.prototype.loadItems=function(e){var t=this,r=this.loading.show({message:this.localePipe.transform("loading")});return this.procHelpService.getDatagridData(e).pipe(re.switchMap(function(e){return t.ttData=w(e.entities),t.tt.setPageIndex(e.pageIndex+1),t.tt.total=e.totalCount,t.tt.pageSize=e.pageSize,r.close(),v.of(e)}),re.catchError(function(e){throw r.close(),setTimeout(function(){t.messager.error(null!=e.error&&(e.error.Message||e.error.message)||e.message)},300),e}))},Tl.prototype.configTtColumns=function(){var i=this;this.ttColumns=[{field:"code",title:this.localePipe.transform("code"),width:120,sortable:!0},{field:"name",title:this.localePipe.transform("name"),width:250,sortable:!0,template:this.nameCellTemp},{field:"upBillVoName",title:this.localePipe.transform("upBill"),width:120,sortable:!0},{field:"downBillVoName",title:this.localePipe.transform("downBill"),width:120,sortable:!0},{field:"sysInit",title:this.localePipe.transform("sysInit"),width:80,sortable:!1,formatter:function(e,t,r){return 1==e?i.localePipe.transform("yes"):0==e?i.localePipe.transform("no"):"-"}}]},Tl.prototype.createDefaultQueryParam=function(){var e={filterArgs:new Cl,filterArgsExt:{}};return e.filterArgs.pageSize=this.defaultPageSize,e.filterArgs.pageIndex=0,e.filterArgs.OrderByLastModifiedTime=new f.TextValue,e.filterArgs.OrderByLastModifiedTime.value=Sl,e.filterArgs.OrderByLastModifiedTime.hasValue=!0,e.filterArgs.billProcessType=new f.TextValue,e.filterArgs.billProcessType.value=cl.BifCreationProcess,e.filterArgs.billProcessType.hasValue=!0,e.filterArgs.isEnabled=new f.TextValue,e.filterArgs.isEnabled.value="true",e.filterArgs.isEnabled.hasValue=!0,e},Tl.decorators=[{type:b.Component,args:[{selector:"app-process-list-help",template:'<div class="f-page f-page-is-managelist" id="bif-manager-list">\r\n  <app-proc-help-query-solution id="query-solution" #querySolution [(queryParam)]="queryParam"\r\n    (onSearch)="onSearch($event)">\r\n  </app-proc-help-query-solution>\r\n\r\n  <div class="f-page-main" id="page-main">\r\n    <div *ngIf="setProcess&&setProcess.code" class="d-flex px-2" style="line-height: 32px; height: 32px;">\r\n      <div>\r\n        {{"setProcess" | aifLocale}}\r\n      </div>\r\n      <div class="farris-tags">\r\n        <ul class="farris-tags-item-container">\r\n          <li class="farris-tag-item farris-tag-item-info">\r\n            <span class="tag-box">\r\n              {{setProcess&&setProcess.showText}}\r\n            </span>\r\n            <span *ngIf="false" class="tag-delete" (click)="removeSetProcess()">\r\n              <i class="f-icon f-icon-close"></i>\r\n            </span>\r\n          </li>\r\n        </ul>\r\n      </div>\r\n    </div>\r\n    <div class="f-utils-fill-flex-column">\r\n      <farris-datagrid id="tt" #tt [data]="ttData" [columns]="ttColumns" [idField]="ttIdField" [multiSelect]="true"\r\n        [showCheckbox]="false" [showAllCheckbox]="false" [onlySelectSelf]="true" [keepSelect]="true"\r\n        [selectOnCheck]="true" [checkOnSelect]="false" [showHeader]="true" [fit]="true" [fitColumns]="true"\r\n        [pagination]="true" [showPageList]="true" [pageSize]="defaultPageSize" [pageList]="pageList"\r\n        (pageChanged)="onPageChanged($event)" (pageSizeChanged)="onPageSizeChanged($event)" [remoteSort]="false">\r\n      </farris-datagrid>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #nameCellTemp let-ctx>\r\n  <a href="javascript: void(0);" (click)="clickNameCell(ctx)">{{ctx?.rowData?.name}}</a>\r\n</ng-template>\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type="button" class="btn btn-secondary btn-sm px-3 mx-2" (click)="clickCancel()">\r\n    {{\'clickCancel\' | aifLocale}}\r\n  </button>\r\n  <button type="button" class="btn btn-primary btn-sm px-3 mx-2" (click)="clickOk()">\r\n    {{\'clickOk\' | aifLocale}}\r\n  </button>\r\n</ng-template>\r\n',providers:[{provide:xi,useValue:qo},wi],styles:[""]}]}],Tl.ctorParameters=function(){return[{type:xl},{type:r.MessagerService},{type:Te.NotifyService},{type:i.BsModalService},{type:Re.FrameworkService},{type:Ge.Router},{type:Ge.ActivatedRoute},{type:Se.LoadingService},{type:String,decorators:[{type:b.Inject,args:[b.LOCALE_ID]}]},{type:wi}]},Tl.propDecorators={closeModal:[{type:b.Output}],submitModal:[{type:b.Output}],value:[{type:b.Input}],editorParams:[{type:b.Input}],tt:[{type:b.ViewChild,args:["tt"]}],nameCellTemp:[{type:b.ViewChild,args:["nameCellTemp"]}],modalFooter:[{type:b.ViewChild,args:["iconSelectFooter"]}]},Tl);function Tl(e,t,r,i,n,o,a,s,l,c){this.procHelpService=e,this.messager=t,this.notify=r,this.modalService=i,this.frameworkService=n,this.router=o,this.activatedRoute=a,this.loading=s,this.localePipe=c,this.closeModal=new b.EventEmitter,this.submitModal=new b.EventEmitter,this.editorParams={},this.modalConfig={title:this.localePipe.transform("creationProcess"),width:1250,height:500,showButtons:!0},this.procEmitter=new b.EventEmitter,this.ttIdField="id",this.ttData=[],this.ttColumns=[],this.cascadeCheck=!1,this.cascadeDown=!1,this.cascadeUp=!1,this.defaultPageSize=30,this.pageList=[this.defaultPageSize,50,100,200,500],this.setProcess={showText:""},this.queryParam=this.createDefaultQueryParam()}Object.defineProperty(kl.prototype,"value",{set:function(e){e&&(this.callActivitySubProcess=e,null!=this.callActivitySubProcess.calledElement&&""!=this.callActivitySubProcess.calledElement||null==this.callActivitySubProcess.calledBizDefKey||""==this.callActivitySubProcess.calledBizDefKey?this.callActivitySubProcess.subProcessType=nl.Specified:this.callActivitySubProcess.subProcessType=nl.Dynamic,!0===this.callActivitySubProcess.inheritBizDataId?this.callActivitySubProcess.billSourceType=il.InheritParent:!1===this.callActivitySubProcess.inheritBizDataId&&!1===this.callActivitySubProcess.useAutoCreationData?this.callActivitySubProcess.billSourceType=il.VariablesExpression:!1===this.callActivitySubProcess.inheritBizDataId&&!0===this.callActivitySubProcess.useAutoCreationData&&(this.callActivitySubProcess.billSourceType=il.AutoCreation),this.getProcessDefKey(this.callActivitySubProcess.calledElement),this.getFlowForm(this.callActivitySubProcess.calledBizDefKey),this.getAifProcessName(this.callActivitySubProcess.aifProcessCode))},enumerable:!0,configurable:!0}),kl.prototype.ngOnInit=function(){},kl.prototype.clickOK=function(){var e;this.validator()&&(e={value:this.callActivitySubProcess,parameters:null},this.submitModal.emit(e))},kl.prototype.clickCancel=function(){this.closeModal.emit()},kl.prototype.processConfirm=function(e){e&&(this.callActivitySubProcess.calledElement=e.procDefKey,this.callActivitySubProcess.calledElementName=e.name)},kl.prototype.processTypeChange=function(e){console.log(e),e==nl.Specified?(this.callActivitySubProcess.calledBizDefKey=null,this.callActivitySubProcess.calledBizDefName=null):e==nl.Dynamic&&(this.callActivitySubProcess.calledElement=null,this.callActivitySubProcess.calledElementName=null)},kl.prototype.billSourceChange=function(e){console.log(e),e==il.InheritParent?(this.callActivitySubProcess.inheritBizDataId=!0,this.callActivitySubProcess.useAutoCreationData=!1):e==il.AutoCreation?(this.callActivitySubProcess.inheritBizDataId=!1,this.callActivitySubProcess.useAutoCreationData=!0):e==il.VariablesExpression&&(this.callActivitySubProcess.inheritBizDataId=!1,this.callActivitySubProcess.useAutoCreationData=!1)},kl.prototype.selectProcess=function(){var t=this;this.openProcHelp().subscribe(function(e){null==e?t.notify.warning(t.localePipe.transform("component.subProcess.rteNull")):(t.callActivitySubProcess.aifProcessCode=e.code,t.callActivitySubProcess.aifProcessName=e.name)})},kl.prototype.clearProcess=function(){this.callActivitySubProcess.aifProcessCode=null,this.callActivitySubProcess.aifProcessName=null},kl.prototype.openProcHelp=function(){var t=this.cfr.resolveComponentFactory(El).create(this.inj,[]),r=(t.instance.editorParams=this.editorParams,this.modalService.show(t,{title:this.localePipe.transform("component.subProcess.orderProcess"),width:1250,height:500,resizable:!0,buttons:[{text:this.localePipe.transform("component.subProcess.clickOk"),cls:"btn btn-primary",handle:function(e){t.instance.clickOk(e),r.close()}},{text:this.localePipe.transform("component.subProcess.clickCancel"),cls:"btn btn-secondary",handle:function(e){t.instance.clickCancel(e),r.close()}}],closed:function(){r.dialog.destroy()}}));return t.instance.modalRef=r,t.instance.procEmitter.asObservable()},kl.prototype.clearProcessDef=function(e){this.callActivitySubProcess.calledElement="",this.callActivitySubProcess.calledElementName=""},kl.prototype.flowFormConfirm=function(e){e&&(this.callActivitySubProcess.calledBizDefKey=e.id,this.callActivitySubProcess.calledBizDefName=e.name)},kl.prototype.clearFlowForm=function(e){this.callActivitySubProcess.calledBizDefKey="",this.callActivitySubProcess.calledBizDefName=""},kl.prototype.setBizDataId=function(){this.showExprHelp()},kl.prototype.showExprHelp=function(){var e,t,r,i,n,o,a=this,s=new Array;if(0<this.designerState.schemas.length){try{for(var l=ue(this.designerState.schemas),c=l.next();!c.done;c=l.next()){var p=c.value;this.expr.addSchema("Schema",p)}}catch(g){e={error:g}}finally{try{c&&!c.done&&(o=l["return"])&&o.call(l)}finally{if(e)throw e.error}}this.designerState.schemas[0].entityTypes&&0<this.designerState.schemas[0].entityTypes.length&&(o=this.designerState.schemas[0].entityTypes[0],this.expr.addInjectedEntity(o.name,"Schema",o.name,D.InjectedType.EntityType))}if(s=this.designerState.addContext(s),0<this.designerState.subActivityContext.length)try{for(var d=ue(this.designerState.subActivityContext),u=d.next();!u.done;u=d.next()){var m=u.value;s.push(m)}}catch(v){t={error:v}}finally{try{u&&!u.done&&(r=d["return"])&&r.call(d)}finally{if(t)throw t.error}}if(0<s.length)try{for(var f=ue(s),h=f.next();!h.done;h=f.next()){var y=h.value;this.expr.addContext(y)}}catch(b){i={error:b}}finally{try{h&&!h.done&&(n=f["return"])&&n.call(f)}finally{if(i)throw i.error}}this.expr.addExpressionText(this.callActivitySubProcess.bizDataId),this.expr.buildExpression().then(function(e){a.callActivitySubProcess.bizDataId=e,0<s.length&&(a.expr.exprEntity.contextEntities=a.expr.exprEntity.contextEntities.filter(function(t){return!s.some(function(e){return e.key===t.key})}))})},kl.prototype.valueChange=function(e){e&&(this.callActivitySubProcess.bizDataId=null)},kl.prototype.validator=function(){return!!(this.callActivitySubProcess.inheritBizDataId||this.callActivitySubProcess.useAutoCreationData||this.callActivitySubProcess.bizDataId)||(this.message.warning(this.localePipe.transform("component.subProcess.inheritBizDataId")),!1)},kl.prototype.getProcessDefKey=function(e){var t=this,r=this.util.getProcessDefinitionWebApi();e&&this.http.get(r+="/procDefKey/"+e).subscribe(function(e){t.callActivitySubProcess.calledElementName=e.name})},kl.prototype.getFlowForm=function(e){var t=this,r=this.util.getFlowFormWebApi();e&&this.http.get(r+="/"+e).subscribe(function(e){t.callActivitySubProcess.calledBizDefName=e.name})},kl.prototype.getAifProcessName=function(e){var t=this;null!=e&&""!=e&&this.http.request("GET","/api/runtime/aif/v1.0/rtbillcreationprocess/getname/"+e,{responseType:"text"}).subscribe(function(e){t.callActivitySubProcess.aifProcessName=e},function(e){throw e.error&&"string"==typeof e.error&&(e.error=JSON.parse(e.error)),setTimeout(function(){t.message.error(null!=e.error&&(e.error.Message||e.error.message)||e.message)},300),e})},kl.decorators=[{type:b.Component,args:[{selector:"lib-call-activity-sub-process2",template:'<div class="f-page">\r\n  <div class="f-utils-fill-flex-column farris-split-section my-2 mx-3 h-100" style="border-radius:16px;border: 1.5px solid #F1F3F7;">\r\n    <section>\r\n      <div class="f-utils-fill-flex-column h-100" style="margin-top: 15px;">\r\n        <div class="h-100">\r\n          <div class="farris-form form-inline farris-form-inline">\r\n            <div class="farris-group-wrap mt-1">\r\n              <div class="form-group farris-form-group">\r\n                <label class="col-form-label">\r\n                  <span class="farris-label-text">{{\'component.subProcess.radioGroupProcessType\' | wfLocale}}</span>\r\n                </label>\r\n                <div class="farris-input-wrap ml-1">\r\n                  <farris-radiogroup #radioGroupProcessType\r\n                    [(ngModel)]="callActivitySubProcess&&callActivitySubProcess.subProcessType" [horizontal]="false"\r\n                    [data]="radioGroupProcessTypeData" (changeValue)="processTypeChange($event)">\r\n                  </farris-radiogroup>\r\n                  <div class="farris-feedback valid-feedback"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <div class="farris-group-wrap mt-1" *ngIf="callActivitySubProcess.subProcessType==subProcessType.Dynamic">\r\n              <div class="form-group farris-form-group">\r\n                <label class="col-form-label">\r\n                  <span class="farris-label-text">{{\'component.subProcess.flowForm\' | wfLocale}}</span>\r\n                </label>\r\n                <div class="farris-input-wrap ml-1">\r\n                  <wf-bizprocess-lookup title="{{\'component.subProcess.flowForm\' | wfLocale}}" [sourceType]="\'flowform\'"\r\n                    [displayTxt]="callActivitySubProcess.calledBizDefName" (afterConfirm)="flowFormConfirm($event)"\r\n                    (clear)="clearFlowForm($event)">\r\n                  </wf-bizprocess-lookup>\r\n                  <div class="farris-feedback valid-feedback"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <div class="farris-group-wrap mt-1" *ngIf="callActivitySubProcess.subProcessType==subProcessType.Specified">\r\n              <div class="form-group farris-form-group">\r\n                <label class="col-form-label">\r\n                  <span class="farris-label-text">{{\'component.subProcess.processDef\' | wfLocale}}</span>\r\n                </label>\r\n                <div class="farris-input-wrap ml-1">\r\n                  <wf-bizprocess-lookup title="{{\'component.subProcess.processDef\' | wfLocale}}" [displayTxt]="callActivitySubProcess.calledElementName"\r\n                    (afterConfirm)="processConfirm($event)" (clear)="clearProcessDef($event)">\r\n                  </wf-bizprocess-lookup>\r\n                  <div class="farris-feedback valid-feedback"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </section>\r\n    <section class="">\r\n      <div class="f-utils-fill-flex-column h-100">\r\n        <div class="h-100">\r\n          <div class="farris-form form-inline farris-form-inline">\r\n\r\n            <div class="farris-group-wrap mt-1">\r\n              <div class="form-group farris-form-group">\r\n                <label class="col-form-label">\r\n                  <span class="farris-label-text">{{\'component.subProcess.radioGroupBillSource\' | wfLocale}}</span>\r\n                </label>\r\n                <div class="farris-input-wrap ml-1">\r\n                  <farris-radiogroup #radioGroupBillSource\r\n                    [(ngModel)]="callActivitySubProcess&&callActivitySubProcess.billSourceType" [horizontal]="false"\r\n                    [data]="radioGroupBillSourceData" (changeValue)="billSourceChange($event)">\r\n                  </farris-radiogroup>\r\n                </div>\r\n                <div class="farris-feedback valid-feedback"></div>\r\n              </div>\r\n            </div>\r\n\r\n            <div class="farris-group-wrap mt-1"\r\n              *ngIf="callActivitySubProcess.billSourceType==billSourceType.AutoCreation">\r\n              <div class="form-group farris-form-group">\r\n                <label class="col-form-label">\r\n                  <span class="farris-label-text">{{\'component.subProcess.autoCreationProcess\' | wfLocale}}</span>\r\n                </label>\r\n                <div class="farris-input-wrap ml-1">\r\n                  <input-group [ngModel]="callActivitySubProcess&&callActivitySubProcess.aifProcessName"\r\n                    [editable]="false" (clickHandle)="selectProcess()" [groupText]="groupIcon" (clear)="clearProcess()">\r\n                  </input-group>\r\n                  <div class="farris-feedback valid-feedback"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <div class="farris-group-wrap mt-1"\r\n              *ngIf="callActivitySubProcess.billSourceType==billSourceType.VariablesExpression">\r\n              <div class="form-group farris-form-group">\r\n                <label class="col-form-label">\r\n                  <span class="farris-label-text">{{\'component.subProcess.bizDataId\' | wfLocale}}</span>\r\n                </label>\r\n                <div class="farris-input-wrap ml-1">\r\n                  <input-group [ngModel]="callActivitySubProcess.bizDataId" [enableClear]="false"\r\n                    [ngModel]="callActivitySubProcess.bizDataId" name="bizDataId" [editable]="false"\r\n                    (clickHandle)="setBizDataId()" [groupText]="groupIcon">\r\n                  </input-group>\r\n                  <div class="farris-feedback valid-feedback"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </section>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type="button" class="btn btn-secondary btn-sm mx-2" (click)="clickCancel()">{{\'component.subProcess.clickCancel\' | wfLocale}}</button>\r\n  <button type="button" class="btn btn-primary btn-sm mx-2" (click)="clickOK()">{{\'component.subProcess.clickOk\' | wfLocale}}</button>\r\n</ng-template>\r\n',providers:[x]}]}],kl.ctorParameters=function(){return[{type:Te.NotifyService},{type:i.BsModalService},{type:r.MessagerService},{type:l},{type:t.HttpService},{type:a},{type:D.ExpressionService},{type:b.ComponentFactoryResolver},{type:b.Injector},{type:b.ChangeDetectorRef,decorators:[{type:b.Optional}]},{type:String,decorators:[{type:b.Inject,args:[b.LOCALE_ID]}]},{type:undefined,decorators:[{type:b.Inject,args:[o]}]},{type:x,decorators:[{type:b.Optional}]}]},kl.propDecorators={cls:[{type:b.HostBinding,args:["class"]}],editorParams:[{type:b.Input}],value:[{type:b.Input}],closeModal:[{type:b.Output}],submitModal:[{type:b.Output}],modalFooter:[{type:b.ViewChild,args:["iconSelectFooter"]}],radioGroupProcessType:[{type:b.ViewChild,args:["radioGroupProcessType"]}],radioGroupBillSource:[{type:b.ViewChild,args:["radioGroupBillSource"]}]};var Al=kl;function kl(e,t,r,i,n,o,a,s,l,c,p,d,u){this.notify=e,this.modalService=t,this.message=r,this.util=i,this.http=n,this.designerState=o,this.expr=a,this.cfr=s,this.inj=l,this.cdr=c,this.localeId=p,this.resources=d,this.localePipe=u,this.cls="farris-main-area flex-column",this.editorParams={},this.closeModal=new b.EventEmitter,this.submitModal=new b.EventEmitter,this.modalConfig={title:this.localePipe.transform("component.subProcess.subProcessSet"),width:600,height:342,showButtons:!0},this.callActivitySubProcess=new ol,this.groupIcon='<i class="f-icon f-icon-lookup"></i>',this.subProcessType=nl,this.billSourceType=il,this.radioGroupProcessTypeData=[{value:"Specified",name:this.localePipe.transform("component.subProcess.specified")},{value:"Dynamic",name:this.localePipe.transform("component.subProcess.dynamic")}],this.radioGroupBillSourceData=[{value:il.InheritParent,name:this.localePipe.transform("component.subProcess.inheritParent")},{value:il.AutoCreation,name:this.localePipe.transform("component.subProcess.autoCreation")},{value:il.VariablesExpression,name:this.localePipe.transform("component.subProcess.variablesExpression")}],this.localePipe=this.localePipe||new x(p,d)}Ml.prototype.convertTo=function(e){return e&&(e.calledBizDefKey||e.calledElement)?this.localePipe.transform("component.subProcess.set"):this.localePipe.transform("component.subProcess.notSet")};var Ol=Ml;function Ml(e){this.localePipe=e}var Dl="Id",Nl="Name",Ll="NameLanguage",Fl="ClrTypeID",Rl="callActivitySubProcess",Vl="BackWardRule",zl="variableSettings",Bl="MultiInstanceLoopCharacteristics",Ul=(jl.prototype.setProperty=function(e){this.uiState.propertyData=e.propertyData,this.uiState.propertyConfig=this.setConfig(e.propertyConfig)},jl.prototype.setConfig=function(e){var t=this,r=[];return e&&e.forEach(function(e){t.setEntity(e.properties),r.push(e)}),r},jl.prototype.setEntity=function(e){var t=this;e&&0<e.length&&e.forEach(function(e){switch(e.propertyID){case Rl:e.editor=Al,e.converter=new Ol(t.localPipe),e.editorParams={bizTypeId:t.uiState.flowFormInfo.flowForm.businessObjectId};break;case Vl:e.editor=In,e.converter=new En(t.localPipe),e.editorParams={nodeType:"CallActivitySubProcess"};break;case Bl:e.editor=$s,e.converter=new Xs(t.localPipe),e.editorParams={location:"CallActivitySubProcess"};break;case zl:e.editor=Ca,e.converter=new Sa(t.localPipe)}})},jl.decorators=[{type:b.Injectable}],jl.ctorParameters=function(){return[{type:a},{type:x}]},jl);function jl(e,t){this.uiState=e,this.localPipe=t}var Hl="Id",_l="Name",Gl="NameLanguage",Kl="ClrTypeID",ql="Tools",Wl="variableSettings",Jl="ParticipantOptions",$l=(Yl.prototype.setProperty=function(e){this.uiState.propertyData=e.propertyData,this.uiState.propertyConfig=this.setConfig(e.propertyConfig)},Yl.prototype.setConfig=function(e){var t=this,r=[];return e&&e.forEach(function(e){t.setEntity(e.properties),r.push(e)}),r},Yl.prototype.setEntity=function(e){var t=this;e&&0<e.length&&e.forEach(function(e){switch(e.propertyID){case ql:e.editor=Et,e.converter=new At(t.localPipe),e.editorParams={location:"autoActivity"};break;case Wl:e.editor=Ca,e.converter=new Sa(t.localPipe);break;case Jl:e.editor=Eo,e.converter=new To(t.localPipe),e.editorParams={location:"autoActivity"}}})},Yl.decorators=[{type:b.Injectable}],Yl.ctorParameters=function(){return[{type:a},{type:x}]},Yl);function Yl(e,t){this.uiState=e,this.localPipe=t}var Xl=function(){this.triggerAction="Pass",this.Async=!1},Zl=(Object.defineProperty(Ql.prototype,"value",{set:function(e){var t,r;if(e&&0<e.length)try{for(var i=ue(e),n=i.next();!n.done;n=i.next()){var o=n.value,a=new Xl;a.Id=o.Id,a.name=o.name,a.triggerAction=o.triggerAction,a.Async=o.Async,a.SignalRef=o.SignalRef,this.data.push(a)}}catch(s){t={error:s}}finally{try{n&&!n.done&&(r=i["return"])&&r.call(i)}finally{if(t)throw t.error}}},enumerable:!0,configurable:!0}),Ql.prototype.ngOnInit=function(){this.columns=[{field:"SignalRef",width:100,title:this.localePipe.transform("component.eventDefinition.signalRef"),editor:{type:g.EditorTypes.TEXTBOX,options:{}},validators:[{type:"required",messager:"必填"}]},{field:"name",width:100,title:this.localePipe.transform("component.eventDefinition.name"),editor:{type:g.EditorTypes.TEXTBOX,options:{}},validators:[{type:"required",messager:"必填"}]},{field:"triggerAction",width:100,title:this.localePipe.transform("component.eventDefinition.triggerAction"),formatter:{type:"enum",options:{valueField:"value",textField:"text",data:this.triggerActionCollection}},editor:{type:g.EditorTypes.COMBOLIST,options:{valueField:"value",textField:"text",data:this.triggerActionCollection,idField:"value",panelHeight:"auto",showClear:!1}},validators:[{type:"required",messager:"必填"}]}]},Ql.prototype.add=function(){var e=new Xl;e.Id=l.GenerateElementId(),this.data.push(e),this.grid.loadData(this.data)},Ql.prototype["delete"]=function(){var e,t=this;this.grid.endCellEdit(),this.grid.selectedRow&&this.grid.selectedRow.data?(e=this.data.findIndex(function(e){return e.Id===t.grid.selectedRow.data.Id}),this.data.splice(e,1),this.grid.loadData(this.data)):this.message.info(this.localePipe.transform("component.eventDefinition.selectedRow"))},Ql.prototype.clickOK=function(){var e;this.grid.endCellEdit(),this.validator()&&(e={value:this.data,parameters:null},this.submitModal.emit(e))},Ql.prototype.clickCancel=function(){this.closeModal.emit()},Ql.prototype.validator=function(){var e,t;if(0===this.data.length)return this.message.info(this.localePipe.transform("component.eventDefinition.dataLength")),!1;try{for(var r=ue(this.data),i=r.next();!i.done;i=r.next()){var n=i.value;if(!n.SignalRef)return this.message.info(this.localePipe.transform("component.eventDefinition.codeNotNull")),!1;if(!n.name)return this.message.info(this.localePipe.transform("component.eventDefinition.nameNotNull")),!1;if(!isNaN(Number(n.SignalRef)))return this.message.info(this.localePipe.transform("component.eventDefinition.codeNotNumber")),!1}}catch(l){e={error:l}}finally{try{i&&!i.done&&(t=r["return"])&&t.call(r)}finally{if(e)throw e.error}}if(1<this.data.length)for(var o=0;o<this.data.length;o++)for(var a=this.data[o].SignalRef,s=o+1;s<this.data.length;s++)if(a===this.data[s].SignalRef)return this.message.warning(this.localePipe.transform("component.eventDefinition.codeRepeat")),!1;return!0},Ql.decorators=[{type:b.Component,args:[{selector:"lib-event-definition",template:'<div class="f-page">\r\n  <div class="f-page-header">\r\n    <nav class="f-page-header-base">\r\n      <div class="f-title">\r\n        \x3c!-- <span class="f-title-icon f-text-orna-bill">\r\n          <i class="f-icon f-icon-page-title-administer"></i>\r\n        </span> --\x3e\r\n        \x3c!-- <h4 class="f-title-text">列表</h4> --\x3e\r\n      </div>\r\n      <div class="btn-toolbar btn-group-lg">\r\n        <button class="btn btn-primary mr-2" (click)="add()">{{\'component.eventDefinition.add\' | wfLocale}}</button>\r\n        <button class="btn btn-secondary" (click)="delete()">{{\'component.eventDefinition.delete\' | wfLocale}}</button>\r\n      </div>\r\n    </nav>\r\n  </div>\r\n  <div class="f-page-main f-utils-fill-flex-column h-100">\r\n    <div class="f-utils-fill-flex-column farris-overflow-y-auto h-100">\r\n      <farris-datagrid #grid [data]="data" [columns]="columns" [idField]="\'Id\'" [fit]="true" [fitColumns]="true"\r\n        [editable]="true" [editMode]="\'cell\'" [pagination]="false" [showCheckbox]="false" [multiSelect]="false">\r\n      </farris-datagrid>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type="button" class="btn btn-secondary btn-sm px-3 mx-2" (click)="clickCancel()">{{\'component.eventDefinition.clickCancel\' | wfLocale}}</button>\r\n  <button type="button" class="btn btn-primary btn-sm px-3 mx-2" (click)="clickOK()">{{\'component.eventDefinition.clickOK\' | wfLocale}}</button>\r\n</ng-template>\r\n',providers:[x],styles:[""]}]}],Ql.ctorParameters=function(){return[{type:r.MessagerService},{type:l},{type:b.Injector},{type:b.ChangeDetectorRef,decorators:[{type:b.Optional}]},{type:String,decorators:[{type:b.Inject,args:[b.LOCALE_ID]}]},{type:undefined,decorators:[{type:b.Inject,args:[o]}]},{type:x,decorators:[{type:b.Optional}]}]},Ql.propDecorators={cls:[{type:b.HostBinding,args:["class"]}],closeModal:[{type:b.Output}],submitModal:[{type:b.Output}],value:[{type:b.Input}],modalFooter:[{type:b.ViewChild,args:["iconSelectFooter"]}],grid:[{type:b.ViewChild,args:["grid"]}]},Ql);function Ql(e,t,r,i,n,o,a){this.message=e,this.util=t,this.injector=r,this.cdr=i,this.localeId=n,this.resources=o,this.localePipe=a,this.cls="farris-main-area flex-column",this.closeModal=new b.EventEmitter,this.submitModal=new b.EventEmitter,this.modalConfig={title:this.localePipe.transform("component.eventDefinition.eventDefinition"),width:560,height:420,showButtons:!0},this.triggerActionCollection=[{text:this.localePipe.transform("component.eventDefinition.pass"),value:"Pass"},{text:this.localePipe.transform("component.eventDefinition.back"),value:"Back"},{text:this.localePipe.transform("component.eventDefinition.abort"),value:"Abort"}],this.columns=new Array,this.data=new Array,this.localePipe=this.localePipe||new x(n,o)}tc.prototype.convertTo=function(e){return e&&0<e.length?this.localePipe.transform("component.eventDefinition.set"):this.localePipe.transform("component.eventDefinition.notSet")};var ec=tc;function tc(e){this.localePipe=e}var rc="Id",ic="Name",nc="NameLanguage",oc="ClrTypeID",ac="BackWardRule",sc="EventDefinitions",lc="variableSettings",cc=(pc.prototype.setProperty=function(e){this.uiState.propertyData=e.propertyData,this.uiState.propertyConfig=this.setConfig(e.propertyConfig)},pc.prototype.setConfig=function(e){var t=this,r=[];return e&&e.forEach(function(e){t.setEntity(e.properties),r.push(e)}),r},pc.prototype.setEntity=function(e){var t=this;e&&0<e.length&&e.forEach(function(e){switch(e.propertyID){case ac:e.editor=In,e.converter=new En(t.localPipe),e.editorParams={nodeType:"CallActivitySubProcess"};break;case sc:e.editor=Zl,e.converter=new ec(t.localPipe);break;case lc:e.editor=Ca,e.converter=new Sa(t.localPipe)}})},pc.decorators=[{type:b.Injectable}],pc.ctorParameters=function(){return[{type:a},{type:b.Injector},{type:x}]},pc);function pc(e,t,r){this.uiState=e,this.injector=t,this.localPipe=r}var dc="Id",uc="Name",mc="NameLanguage",fc="ClrTypeID",hc="messageNotice",yc="variableSettings",gc=(vc.prototype.setProperty=function(e){this.uiState.propertyData=e.propertyData,this.uiState.propertyConfig=this.setConfig(e.propertyConfig)},vc.prototype.setConfig=function(e){var t=this,r=[];return e&&e.forEach(function(e){t.setEntity(e.properties),r.push(e)}),r},vc.prototype.setEntity=function(e){var t=this;e&&0<e.length&&e.forEach(function(e){switch(e.propertyID){case hc:e.editor=ai,e.converter=new ci(t.localPipe),e.editorParams={location:"messageActivity"};break;case yc:e.editor=Ca,e.converter=new Sa(t.localPipe)}})},vc.decorators=[{type:b.Injectable}],vc.ctorParameters=function(){return[{type:a},{type:x}]},vc);function vc(e,t){this.uiState=e,this.localPipe=t}var bc=function(){},xc="WF_ProcessDef_SaveDT",wc="WF_ProcessDef_SaveRT",Pc="WF_ProcessDef_Deploy",Cc="WF_ProcessDef_SyncDT",Ic=function(){},qo=function(){},Sc="Id",Ec="Name",Tc="NameLanguage",Ac="ClrTypeID",kc="ParticipantSchemes",Oc="wf_ExecuteForms_PC",Mc="wf_ExecuteForms_Mobile",Dc="messageNotice",Nc="NotifyAble",Lc=(Fc.prototype.setProperty=function(e){this.uiState.propertyData=e.propertyData,this.uiState.propertyConfig=this.setConfig(e.propertyConfig)},Fc.prototype.setConfig=function(e){var t=this,r=[];return e&&e.forEach(function(e){t.setEntity(e.properties),r.push(e)}),r},Fc.prototype.setEntity=function(e){var r=this;e&&0<e.length&&e.forEach(function(e){switch(e.propertyID){case Sc:break;case kc:e.editor=$a,e.converter=new Ya(r.localPipe),e.editorParams={nodeType:"notifyActivity"};break;case Oc:e.editor=$t;var t={location:"notifyActivity",tab:"web"};e.converter=new Xt(t,r.localPipe),e.editorParams=t;break;case Mc:e.editor=$t;t={location:"notifyActivity",tab:"mobile"};e.converter=new Xt(t,r.localPipe),e.editorParams=t;break;case Dc:e.editor=ai,e.converter=new ci(r.localPipe),e.editorParams={location:"activity"};break;case Nc:e.editor=ma,e.converter=new ha(r.localPipe),e.editorParams={nodeType:"notifyActivity"};break;default:e.editor=di,e.converter=new mi(r.localPipe)}})},Fc.decorators=[{type:b.Injectable}],Fc.ctorParameters=function(){return[{type:a},{type:x}]},Fc);function Fc(e,t){this.uiState=e,this.localPipe=t}Vc.prototype.convertTo=function(e){return e?e.name||e.code||this.localePipe.transform("set"):this.localePipe.transform("notSet")};var Rc=Vc;function Vc(e){this.localePipe=e}var zc="Id",Bc="Name",Uc="NameLanguage",jc="ClrTypeID",Hc="aifProcessCode",_c="isRelied",Gc=(Kc.prototype.setProperty=function(e){this.uiState.propertyData=e.propertyData,this.uiState.propertyConfig=this.setConfig(e.propertyConfig)},Kc.prototype.setConfig=function(e){var t=this,r=[];return e&&e.forEach(function(e){t.setEntity(e.properties),r.push(e)}),r},Kc.prototype.setEntity=function(e){var t=this;e&&0<e.length&&e.forEach(function(e){e.propertyID===Hc&&(e.editor=El,e.converter=new Rc(t.localPipe),e.editorParams={bizTypeId:t.uiState.flowFormInfo.flowForm.businessObjectId})})},Kc.decorators=[{type:b.Injectable}],Kc.ctorParameters=function(){return[{type:a},{type:wi}]},Kc);function Kc(e,t){this.uiState=e,this.localPipe=t}Wc.prototype.on=function(e,t){var r=this,i=(this._subjects.has(e)||this._subjects.set(e,new V.Subject),this._subjects.get(e)),n=i.subscribe(t);return{unsubscribe:function(){n.unsubscribe(),0<i.observers.length&&r._subjects["delete"](e)}}},Wc.prototype.emit=function(e,t){this._subjects.has(e)&&this._subjects.get(e).next(t)},Wc.prototype.destroy=function(){this._subjects.forEach(function(e,t){e.unsubscribe()}),this._subjects.clear()},Wc.decorators=[{type:b.Injectable}];var qc=Wc;function Wc(){this._subjects=new Map}$c.prototype.ngOnInit=function(){var t=this;this.releaseType=1===this.procVersion?"release":"update",this.uiState.getUserInfo().subscribe(function(e){t.applicantName=e.name,t.applicantDepartment=e.orgName,t.applicantId=e.id})},$c.prototype.saveAsOK=function(){var r=this;this.uiState.createData().subscribe(function(e){var t=e.returnValue.id,e={DataId:t,applicantName:r.applicantName,applicantDepartment:r.applicantDepartment,procName:r.procName,procVersion:r.procVersion,releaseType:r.releaseType,textDetail:r.textDetail,processDefinitionKey:r.processDefinitionKey,applicantId:r.applicantId};r.uiState.releaseSave({ChangeType:"Modify",ChangeInfo:e}).subscribe(function(e){r.mySubmit(t,"03bdca37-8439-4924-8aef-20f3f4092b59"),r.submit.next()})})},$c.prototype.saveAsCancel=function(){this.cancel.emit()},$c.prototype.editorCreated=function(e){e.getModule("toolbar");this.editor=e},$c.prototype.contentChanged=function(e){console.log(e)},$c.prototype.validator=function(){return!0},$c.prototype.changeValue=function(e){this.releaseType=e},$c.prototype.mySubmit=function(e,t){this.submitService.submitWithBizDefKey(e,t)},$c.decorators=[{type:b.Component,args:[{selector:"lib-release-component",template:'<div class="f-page f-page-card f-page-is-mainsubcard">\r\n  <section class="f-page-main">\r\n    <div class="f-struct-wrapper">\r\n      \x3c!-- <farris-section class="f-section-form f-section-in-mainsubcard" [enableAccordion]="\'\'"\r\n        [subTitle]="\'\'" [enableMaximize]="false"> --\x3e\r\n        <div class="f-form-layout farris-form farris-form-controls-inline pr-4 m-2">\r\n          <div class="col-12 px-0 my-2">\r\n            <div class="farris-group-wrap">\r\n              <div class="form-group farris-form-group">\r\n                <label class="col-form-label">\r\n                  <span class="farris-label-text">{{\'component.release.applicantName\' | wfLocale}}</span>\r\n                </label>\r\n                <div class="farris-input-wrap">\r\n                  <input type="text" class="form-control" [(ngModel)]="applicantName" name="procName" [readOnly]="true"/>\r\n                  <div class="farris-feedback valid-feedback"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class="col-12 px-0 my-2">\r\n            <div class="farris-group-wrap">\r\n              <div class="form-group farris-form-group">\r\n                <label class="col-form-label">\r\n                  <span class="farris-label-text">{{\'component.release.applicantDepartment\' | wfLocale}}</span>\r\n                </label>\r\n                <div class="farris-input-wrap">\r\n                  <input type="text" class="form-control" [(ngModel)]="applicantDepartment" name="procKey" [readOnly]="true"/>\r\n                  <div class="farris-feedback valid-feedback"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class="col-12 px-0 my-2">\r\n            <div class="farris-group-wrap">\r\n              <div class="form-group farris-form-group">\r\n                <label class="col-form-label">\r\n                  <span class="farris-label-text">{{\'component.release.procName\' | wfLocale}}</span>\r\n                </label>\r\n                <div class="farris-input-wrap">\r\n                  <input type="text" class="form-control" [(ngModel)]="procName" name="procName" [readOnly]="true"/>\r\n                  <div class="farris-feedback valid-feedback"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class="col-12 px-0 my-2">\r\n            <div class="farris-group-wrap">\r\n              <div class="form-group farris-form-group">\r\n                <label class="col-form-label">\r\n                  <span class="farris-label-text">{{\'component.release.procVersion\' | wfLocale}}</span>\r\n                </label>\r\n                <div class="farris-input-wrap">\r\n                  <input type="text" class="form-control" [(ngModel)]="procVersion" name="procVersion" [readOnly]="true"/>\r\n                  <div class="farris-feedback valid-feedback"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class="col-12 px-0 my-2">\r\n            <div class="farris-group-wrap">\r\n              <div class="form-group farris-form-group">\r\n                <label class="col-form-label">\r\n                  <span class="farris-label-text">{{\'component.release.releaseType\' | wfLocale}}</span>\r\n                </label>\r\n                <div class="farris-input-wrap">\r\n                  <farris-radiogroup [(ngModel)]="releaseType" name="releaseType" [data]="releaseTypeList"\r\n                  [horizontal]="true" (changeValue)="changeValue($event)" [disabled]="true">\r\n                  </farris-radiogroup>\r\n                  <div class="farris-feedback valid-feedback"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class="col-12 px-0 my-2">\r\n            <div class="farris-group-wrap">\r\n              <div class="form-group farris-form-group">\r\n                <label class="col-form-label">\r\n                  <span class="farris-label-text">{{\'component.release.textDetail\' | wfLocale}}</span>\r\n                </label>\r\n                <div class="farris-input-wrap">\r\n                  <textarea [(ngModel)]="textDetail" name="textarea" id="textarea" style="height: 250px; width: 100%"\r\n                  [auto-size]="true" [maxHeight]="500" [textarea-zoom]="true"></textarea>\r\n                  <div class="farris-feedback valid-feedback"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      \x3c!-- </farris-section> --\x3e\r\n    </div>\r\n  </section>\r\n</div>\r\n\r\n<ng-template #buttonRef>\r\n  <button type="button" class="btn btn-secondary btn-sm mx-2" (click)="saveAsCancel()">{{\'component.release.saveAsCancel\' | wfLocale}}</button>\r\n  <button type="button" class="btn btn-sm btn-primary mx-2" (click)="saveAsOK()">{{\'component.release.saveAsOK\' | wfLocale}}</button>\r\n</ng-template>\r\n',providers:[x],styles:[""]}]}],$c.ctorParameters=function(){return[{type:a},{type:me.WfTaskHandlerService},{type:b.ChangeDetectorRef,decorators:[{type:b.Optional}]},{type:String,decorators:[{type:b.Inject,args:[b.LOCALE_ID]}]},{type:undefined,decorators:[{type:b.Inject,args:[o]}]},{type:x,decorators:[{type:b.Optional}]}]},$c.propDecorators={btnRef:[{type:b.ViewChild,args:["buttonRef"]}],procName:[{type:b.Input}],procVersion:[{type:b.Input}],processDefinitionKey:[{type:b.Input}],lookUp:[{type:b.ViewChild,args:["lookup"]}],submit:[{type:b.Output}],cancel:[{type:b.Output}]};var Jc=$c;function $c(e,t,r,i,n,o){this.uiState=e,this.submitService=t,this.cdr=r,this.localeId=i,this.resources=n,this.localePipe=o,this.submit=new b.EventEmitter,this.cancel=new b.EventEmitter,this.accessLevel="public",this.isAdministratorConfig=!1,this.dataUri="/api/runtime/sys/v1.0/sysOrgs",this.loadType="layerload",this.releaseType="release",this.items=new Array,this.releaseTypeList=[{value:"release",name:this.localePipe.transform("component.release.release")},{value:"update",name:this.localePipe.transform("component.release.update")}],this.localePipe=this.localePipe||new x(i,n)}n(Zc,Yc=z.JsonConvertableImpl),Zc.prototype.ResetBeforeLoadFrom=function(){Yc.prototype.ResetBeforeLoadFrom.call(this),this.id=null,this.moduleName=null,this.bizKindName=null,this.bizTypeName=null,this.code=null,this.name=null},Zc.prototype.ConvertToJsonObject=function(){var e=Yc.prototype.ConvertToJsonObject.call(this);return z.BpmnModelJsonHelper.SetAttributeValue(e,"id",this.id),z.BpmnModelJsonHelper.SetAttributeValue(e,"moduleName",this.moduleName),z.BpmnModelJsonHelper.SetAttributeValue(e,"bizKindName",this.bizKindName),z.BpmnModelJsonHelper.SetAttributeValue(e,"bizTypeName",this.bizTypeName),z.BpmnModelJsonHelper.SetAttributeValue(e,"code",this.code),z.BpmnModelJsonHelper.SetAttributeValue(e,"name",this.name),e},Zc.prototype.LoadFromJsonObject=function(e){Yc.prototype.LoadFromJsonObject.call(this,e),this.id=z.BpmnModelJsonHelper.GetAttributeValueAsString(e,"id"),this.moduleName=z.BpmnModelJsonHelper.GetAttributeValueAsString(e,"moduleName"),this.bizKindName=z.BpmnModelJsonHelper.GetAttributeValueAsString(e,"bizKindName"),this.bizTypeName=z.BpmnModelJsonHelper.GetAttributeValueAsString(e,"bizTypeName"),this.code=z.BpmnModelJsonHelper.GetAttributeValueAsString(e,"code"),this.name=z.BpmnModelJsonHelper.GetAttributeValueAsString(e,"name")};var Yc,Xc=Zc;function Zc(){return Yc.call(this)||this}ep.prototype.findDocumentTypeEntites=function(){return this.httpService.post(this.documentTypeUrl+"/docutypehelper",{}).pipe(re.map(function(e){return e.map(function(e){var t=new Xc;return t.LoadFromJsonObject(e),t})}))},ep.decorators=[{type:b.Injectable}],ep.ctorParameters=function(){return[{type:Le.BusinessObjectRtService},{type:t.HttpService},{type:t.HttpService},{type:t.SessionService},{type:Te.NotifyService},{type:He.TranslateService}]};var Qc=ep;function ep(e,t,r,i,n,o){this.boRtService=e,this.httpClient=t,this.httpService=r,this.sessionService=i,this.notify=n,this.translate=o,this.documentTypeUrl="/api/runtime/aif/v1.0/documenttype"}var tp={"zh-CHS":{code:"编号",name:"名称",busineseCategory:"业务种类",module:"模块",busineseType:"业务类型",collapse:"收起",expand:"展开",loading:"加载中",allColumns:"所有列"},en:{code:"Code",name:"Name",busineseCategory:"Businese Category",module:"Module",busineseType:"Businese Type",collapse:"Collapse",expand:"Expand",loading:"Loading",allColumns:"All Columns"},"zh-CHT":{code:"編號",name:"名稱",busineseCategory:"業務種類",module:"模塊",busineseType:"業務類型",collapse:"收起",expand:"展開",loading:"加載中",allColumns:"所有列"}},rp=tp,ip=(np.prototype.ngOnInit=function(){this.configLookupColumns(),this.loadItems()},np.prototype.getSelectedDocuType=function(){return this.tt.selectedRow&&this.tt.selectedRow.data},np.prototype.ttSearch=function(e){this.ttSearchObj=e,this.ttSearchObj&&this.tt.searchHandle.search(this.ttSearchObj.field,this.ttSearchObj.value)},np.prototype.loadItems=function(){var t=this,e=null,e=this.entityService.findDocumentTypeEntites(),r=this.loading.show({message:this.localePipe.instant("loading")});e.subscribe(function(e){r.close(),t.ttData=w(t.buildTreeData(e)),t.docuTypeList=e,setTimeout(function(){t.tt.expandAll(),t.docuTypeId?t.tt.selectNode(t.docuTypeId):t.docuTypeList&&0<t.docuTypeList.length&&t.tt.selectNode(t.docuTypeList[0].id)},100)},function(e){throw r.close(),t.messager.error(null!=e.error&&(e.error.Message||e.error.message)||e.message),e})},np.prototype.ttNodeSelected=function(e){var t=[];Array.isArray(e.node)?e.node.forEach(function(e){t.push(e)}):t.push(e.node),0!=t.length&&(this.docuTypeId=t[0].id)},np.prototype.buildTreeData=function(e){var i=[],n={};return e&&e.forEach(function(e){null==n[e.bizKindName]?n[e.bizKindName]=[e]:n[e.bizKindName].push(e)}),Object.keys(n).forEach(function(t){var e={id:t,data:{id:t,bizKindName:t,treeInfo:{layer:1}},selectable:!1,leaf:!1},r=n[t].map(function(e){return{id:e.id,data:$e({},e,{treeInfo:{layer:2,parentId:t}}),selectable:!0,leaf:!0}});e.children=r,i.push(e)}),i},np.prototype.configLookupColumns=function(){this.ttCols=[{field:"bizKindName",title:this.localePipe.instant("busineseCategory"),width:100},{field:"name",title:this.localePipe.instant("name"),width:80},{field:"code",title:this.localePipe.instant("code"),width:80},{field:"moduleName",title:this.localePipe.instant("module"),width:100},{field:"bizTypeName",title:this.localePipe.instant("busineseType"),width:100}]},np.decorators=[{type:b.Component,args:[{selector:"app-bill-type-help",template:'<div class="g-main" style="padding-left: 24px; padding-right: 24px;">\r\n  <div class="h-100 d-flex flex-column">\r\n    <farris-treetable #tt class="f-utils-fill-flex-column" [data]="ttData" [columns]="ttCols" [idField]="ttIdField"\r\n      [fit]="true" [showFilterBar]="true" [searchFields]="ttSearchFields" [showIcon]="false" [resizableColumns]="true"\r\n      [showBorder]="true" [striped]="true" [allColumnsTitle]="ttAllColumnsTitle" [expandLevel]="0" [showHeader]="true"\r\n      [fixedHeader]="true" [singleSelect]="true" [showCheckbox]="false" [showCheckAll]="false" [checkOnSelect]="true"\r\n      [selectOnCheck]="true" (search)="ttSearch($event)" (nodeSelected)="ttNodeSelected($event)">\r\n    </farris-treetable>\r\n  </div>\r\n</div>',providers:[{provide:xi,useValue:rp},wi],styles:[""]}]}],np.ctorParameters=function(){return[{type:Qc},{type:r.MessagerService},{type:Te.NotifyService},{type:i.BsModalService},{type:Se.LoadingService},{type:wi},{type:Ge.Router},{type:Ge.ActivatedRoute}]},np.propDecorators={onselected:[{type:b.Output,args:["onselected"]}],tt:[{type:b.ViewChild,args:["tt"]}]},np);function np(e,t,r,i,n,o,a,s){this.entityService=e,this.messager=t,this.notify=r,this.modal=i,this.loading=n,this.localePipe=o,this.router=a,this.activatedRoute=s,this.onselected=new b.EventEmitter,this.ttIdField="id",this.ttSearchFields=[],this.ttAllColumnsTitle=this.localePipe.instant("allColumns"),this.docuTypeList=[]}Object.defineProperty(ap.prototype,"value",{set:function(e){e&&(this.entity=e||{})},enumerable:!0,configurable:!0}),ap.prototype.ngOnInit=function(){},ap.prototype.clickOk=function(){var e={value:this.entity,parameters:null};this.submitModal.emit(e)},ap.prototype.clickCancel=function(){this.closeModal.emit()},ap.prototype.selectVo=function(){var t=this,e=this.cfr.resolveComponentFactory(Fe.SelectMetadataRTComponent).create(this.inj),r=(e.instance.typeList="GSPViewModel",e.instance.bizTypeId=this.editorParams&&this.editorParams.bizTypeId,e.instance.selectedMetadata.subscribe(function(e){t.clearVo();e=e.metadata,e=JSON.parse(e.content);t.entity.currentVoId=e.ID,t.entity.currentVoName=e.Name},function(e){console.error(e),t.messager.error(null!=e.error&&(e.error.Message||e.error.message)||e.message),t.clearVo()}),{title:this.localePipe.transform("component.voConfig.viewModelSelection"),width:930,height:573,showButtons:!1}),i=this.modal.show(e,r);e.instance.closeModalEmitter.subscribe(function(e){return i.close()})},ap.prototype.clearVo=function(){this.entity.currentVoId=undefined,this.entity.currentVoName=undefined},ap.prototype.selectDocuType=function(){var t=this,r=this.cfr.resolveComponentFactory(ip).create(this.inj,[]),e=(r.instance.docuTypeId=this.entity.currentDocumentTypeId,[]),i=(e.push({text:this.localePipe.transform("component.voConfig.cancel"),cls:"btn btn-secondary",handle:function(){i&&i.close()}}),e.push({text:this.localePipe.transform("component.voConfig.clickOk"),cls:"btn btn-primary",handle:function(){var e=r.instance.getSelectedDocuType();null==e?t.notify.warning(t.localePipe.transform("component.voConfig.selectOne")):(t.entity.currentDocumentTypeId=e.id,t.entity.currentDocumentTypeName=e.name,i&&i.close())}}),this.modal.show(r,{title:this.localePipe.transform("component.voConfig.documentTypeSelect"),height:573,width:930,buttons:e,showMaxButton:!1}))},ap.prototype.clearDocuType=function(){this.entity.currentDocumentTypeId=undefined,this.entity.currentDocumentTypeName=undefined},ap.decorators=[{type:b.Component,args:[{selector:"lib-vo-config",template:'<div class="f-page f-page-card f-page-is-mainsubcard" id="bif-manager-list">\r\n  <div class="f-page-main" id="page-main" style="overflow-y: auto;">\r\n    <div class="f-form-layout farris-form farris-form-controls-inline">\r\n      <div class="col-12">\r\n        <div class="farris-group-wrap">\r\n          <div class="form-group farris-form-group">\r\n            <label class="col-form-label" title="{{\'component.voConfig.viewModel\' | wfLocale}}" for="vo">\r\n              <span class="farris-label-text">{{\'component.voConfig.viewModel\' | wfLocale}}</span>\r\n            </label>\r\n            <div class="farris-input-wrap">\r\n              <input-group id="vo" [ngModel]="entity&&entity.currentVoName" [editable]="false" [enableClear]="false"\r\n                (clickHandle)="selectVo()" (clear)="clearVo()" [groupText]="groupIcon" placeholder="{{\'component.voConfig.placeholder\' | wfLocale}}">\r\n              </input-group>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div class="col-12">\r\n        <div class="farris-group-wrap">\r\n          <div class="form-group farris-form-group">\r\n            <label class="col-form-label" title="{{\'component.voConfig.documenttype\' | wfLocale}}" for="vo">\r\n              <span class="farris-label-text">{{\'component.voConfig.documenttype\' | wfLocale}}</span>\r\n            </label>\r\n            <div class="farris-input-wrap">\r\n              <input-group id="vo" [ngModel]="entity&&entity.currentDocumentTypeName" [editable]="false"\r\n                [enableClear]="false" (clickHandle)="selectDocuType()" (clear)="clearDocuType()" [groupText]="groupIcon"\r\n                placeholder="{{\'component.voConfig.placeholder\' | wfLocale}}">\r\n              </input-group>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type="button" class="btn btn-secondary btn-sm px-3 mx-2" (click)="clickCancel()">{{\'component.voConfig.cancel\' | wfLocale}}</button>\r\n  <button type="button" class="btn btn-primary btn-sm px-3 mx-2" (click)="clickOk()">{{\'component.voConfig.clickOk\' | wfLocale}}</button>\r\n</ng-template>\r\n',providers:[x]}]}],ap.ctorParameters=function(){return[{type:r.MessagerService},{type:Te.NotifyService},{type:i.BsModalService},{type:Re.FrameworkService},{type:Ge.Router},{type:Ge.ActivatedRoute},{type:Se.LoadingService},{type:b.ComponentFactoryResolver},{type:b.Injector},{type:b.ChangeDetectorRef,decorators:[{type:b.Optional}]},{type:String,decorators:[{type:b.Inject,args:[b.LOCALE_ID]}]},{type:undefined,decorators:[{type:b.Inject,args:[o]}]},{type:x,decorators:[{type:b.Optional}]}]},ap.propDecorators={closeModal:[{type:b.Output}],submitModal:[{type:b.Output}],value:[{type:b.Input}],editorParams:[{type:b.Input}],modalFooter:[{type:b.ViewChild,args:["iconSelectFooter"]}]};var op=ap;function ap(e,t,r,i,n,o,a,s,l,c,p,d,u){this.messager=e,this.notify=t,this.modal=r,this.framework=i,this.router=n,this.activatedRoute=o,this.loading=a,this.cfr=s,this.inj=l,this.cdr=c,this.localeId=p,this.resources=d,this.localePipe=u,this.groupIcon='<i class="f-icon f-icon-lookup"></i>',this.closeModal=new b.EventEmitter,this.submitModal=new b.EventEmitter,this.editorParams={},this.modalConfig={title:this.localePipe.transform("component.voConfig.documentInfo"),width:500,height:240,showButtons:!0},this.entity={},this.localePipe=this.localePipe||new x(p,d)}lp.prototype.convertTo=function(e){return e&&e.currentVoId?e.currentVoName||e.currentVoId||this.localePipe.transform("component.voConfig.set"):this.localePipe.transform("component.voConfig.notSet")};var sp=lp;function lp(e){this.localePipe=e}Object.defineProperty(pp.prototype,"value",{set:function(e){e&&(this.entity=e,null!=this.entity.calledElement&&""!=this.entity.calledElement||null==this.entity.calledBizDefKey||""==this.entity.calledBizDefKey?this.entity.subProcessType=nl.Specified:this.entity.subProcessType=nl.Dynamic,this.getProcessDefKey(this.entity.calledElement),this.getFlowForm(this.entity.calledBizDefKey))},enumerable:!0,configurable:!0}),pp.prototype.ngOnInit=function(){},pp.prototype.clickOk=function(){var e={value:this.entity,parameters:null};this.submitModal.emit(e)},pp.prototype.clickCancel=function(){this.closeModal.emit()},pp.prototype.processTypeChange=function(e){console.log(e),e==nl.Specified?(this.entity.calledBizDefKey=null,this.entity.calledBizDefName=null):e==nl.Dynamic&&(this.entity.calledElement=null,this.entity.calledElementName=null)},pp.prototype.processConfirm=function(e){e&&(this.entity.calledElement=e.procDefKey,this.entity.calledElementName=e.name)},pp.prototype.clearProcessDef=function(e){this.entity.calledElement="",this.entity.calledElementName=""},pp.prototype.flowFormConfirm=function(e){e&&(this.entity.calledBizDefKey=e.id,this.entity.calledBizDefName=e.name)},pp.prototype.clearFlowForm=function(e){this.entity.calledBizDefKey="",this.entity.calledBizDefName=""},pp.prototype.getProcessDefKey=function(e){var t=this,r=this.util.getProcessDefinitionWebApi();e&&this.http.get(r+="/procDefKey/"+e).subscribe(function(e){t.entity.calledElementName=e.name})},pp.prototype.getFlowForm=function(e){var t=this,r=this.util.getFlowFormWebApi();e&&this.http.get(r+="/"+e).subscribe(function(e){t.entity.calledBizDefName=e.name})},pp.decorators=[{type:b.Component,args:[{selector:"lib-wf-options",template:'<div class="f-page f-page-card f-page-is-mainsubcard" id="bif-manager-list">\r\n  <div class="f-page-main" id="page-main" style="overflow-y: auto;">\r\n    <div class="f-form-layout farris-form farris-form-controls-inline">\r\n      <div class="col-12">\r\n        <div class="farris-group-wrap">\r\n          <div class="form-group farris-form-group">\r\n            <label class="col-form-label" title="{{\'component.optins.subProcessType\' | wfLocale}}" for="processType">\r\n              <span class="farris-label-text">{{\'component.optins.processType\' | wfLocale}}</span>\r\n            </label>\r\n            <div class="farris-input-wrap">\r\n              <farris-radiogroup #radioGroupProcessType [(ngModel)]="entity&&entity.subProcessType" [horizontal]="false"\r\n                [data]="radioGroupProcessTypeData" (changeValue)="processTypeChange($event)">\r\n              </farris-radiogroup>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div class="col-12" *ngIf="entity&&entity.subProcessType&&entity.subProcessType==subProcessType.Dynamic">\r\n        <div class="farris-group-wrap">\r\n          <div class="form-group farris-form-group">\r\n            <label class="col-form-label" title="{{\'component.optins.bizDef\' | wfLocale}}" for="calledBizDefKey">\r\n              <span class="farris-label-text">{{\'component.optins.bizDef\' | wfLocale}}</span>\r\n            </label>\r\n            <div class="farris-input-wrap">\r\n              <wf-bizprocess-lookup title="{{\'component.optins.bizDef\' | wfLocale}}" [sourceType]="\'flowform\'" [displayTxt]="entity.calledBizDefName"\r\n                (afterConfirm)="flowFormConfirm($event)" (clear)="clearFlowForm($event)">\r\n              </wf-bizprocess-lookup>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div class="col-12" *ngIf="entity&&entity.subProcessType&&entity.subProcessType==subProcessType.Specified">\r\n        <div class="farris-group-wrap">\r\n          <div class="form-group farris-form-group">\r\n            <label class="col-form-label" title="{{\'component.optins.procDef\' | wfLocale}}" for="calledElement">\r\n              <span class="farris-label-text">{{\'component.optins.procDef\' | wfLocale}}</span>\r\n            </label>\r\n            <div class="farris-input-wrap">\r\n              <wf-bizprocess-lookup title="{{\'component.optins.procDef\' | wfLocale}}" [displayTxt]="entity.calledElementName"\r\n                (afterConfirm)="processConfirm($event)" (clear)="clearProcessDef($event)">\r\n              </wf-bizprocess-lookup>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type="button" class="btn btn-secondary btn-sm px-3 mx-2" (click)="clickCancel()">{{\'component.optins.clickCancel\' | wfLocale}}</button>\r\n  <button type="button" class="btn btn-primary btn-sm px-3 mx-2" (click)="clickOk()">{{\'component.optins.clickOk\' | wfLocale}}</button>\r\n</ng-template>\r\n',providers:[x]}]}],pp.ctorParameters=function(){return[{type:Te.NotifyService},{type:i.BsModalService},{type:r.MessagerService},{type:l},{type:t.HttpService},{type:a},{type:D.ExpressionService},{type:b.ComponentFactoryResolver},{type:b.Injector},{type:b.ChangeDetectorRef,decorators:[{type:b.Optional}]},{type:String,decorators:[{type:b.Inject,args:[b.LOCALE_ID]}]},{type:undefined,decorators:[{type:b.Inject,args:[o]}]},{type:x,decorators:[{type:b.Optional}]}]},pp.propDecorators={editorParams:[{type:b.Input}],value:[{type:b.Input}],closeModal:[{type:b.Output}],submitModal:[{type:b.Output}],modalFooter:[{type:b.ViewChild,args:["iconSelectFooter"]}],radioGroupProcessType:[{type:b.ViewChild,args:["radioGroupProcessType"]}]};var cp=pp;function pp(e,t,r,i,n,o,a,s,l,c,p,d,u){this.notify=e,this.modalService=t,this.message=r,this.util=i,this.http=n,this.designerState=o,this.expr=a,this.cfr=s,this.inj=l,this.cdr=c,this.localeId=p,this.resources=d,this.localePipe=u,this.editorParams={},this.closeModal=new b.EventEmitter,this.submitModal=new b.EventEmitter,this.modalConfig={title:this.localePipe.transform("component.optins.wfOptions"),width:500,height:240,showButtons:!0},this.subProcessType=nl,this.radioGroupProcessTypeData=[{value:"Specified",name:this.localePipe.transform("component.optins.specified")},{value:"Dynamic",name:this.localePipe.transform("component.optins.dynamic")}],this.localePipe=this.localePipe||new x(p,d)}up.prototype.convertTo=function(e){return e&&(e.calledBizDefKey||e.calledElement)?this.localePipe.transform("component.optins.set"):this.localePipe.transform("component.optins.notSet")};var dp=up;function up(e){this.localePipe=e}fp.prototype.setProperty=function(e){this.uiState.propertyData=e.propertyData,this.uiState.propertyConfig=this.setConfig(e.propertyConfig)},fp.prototype.setConfig=function(e){var t=this,r=[];return e&&e.forEach(function(e){t.setEntity(e.properties),r.push(e)}),r},fp.prototype.setEntity=function(e){var t=this;e&&0<e.length&&e.forEach(function(e){switch(e.propertyID){case"VoConfig":e.converter=new sp(t.localPipe),e.editor=op,e.editorParams={bizTypeId:t.uiState.flowFormInfo.flowForm.businessObjectId};break;case"WfOpts":e.converter=new dp(t.localPipe),e.editor=cp,e.editorParams={bizTypeId:t.uiState.flowFormInfo.flowForm.businessObjectId};break;case"wfConfig":e.iterator=t.uiState.boolIterator}})},fp.decorators=[{type:b.Injectable}],fp.ctorParameters=function(){return[{type:a},{type:x}]};var mp=fp;function fp(e,t){this.uiState=e,this.localPipe=t}var hp="billCreationType",yp="billRelationType",gp="aifAutoProcessCode",vp="aifPushProcessCode",bp="aifPullProcessCode",xp=(wp.prototype.setProperty=function(e){this.uiState.propertyData=e.propertyData,this.uiState.propertyConfig=this.setConfig(e.propertyConfig)},wp.prototype.setConfig=function(e){var t=this,r=[];return e&&e.forEach(function(e){t.setEntity(e.properties),r.push(e)}),r},wp.prototype.setEntity=function(e){var t=this;e&&0<e.length&&e.forEach(function(e){switch(e.propertyID){case hp:e.iterator=Pp;break;case yp:e.iterator=Cp;break;case gp:case vp:case bp:e.editor=El,e.converter=new Rc(t.localePipe),e.editorParams={bizTypeId:t.uiState.flowFormInfo.flowForm.businessObjectId}}})},wp.decorators=[{type:b.Injectable}],wp.ctorParameters=function(){return[{type:a},{type:wi}]},wp);function wp(e,t){this.uiState=e,this.localePipe=t}var Pp=[{key:"AUTO",value:"自动生单"},{key:"PUSH",value:"推式生单"},{key:"PULL",value:"拉式生单"}],Cp=[{key:"CREATION",value:"通过生单流程生成目标单"}],Ip=(Sp.prototype.initProcessProperty=function(e){var t=e.propertyData;t.EntryForm&&(t.EntryForm=this.uiState.flowFormInfo.flowForm),this.uiState.propertyConfig=this.process.setProcessConfig(e.propertyConfig),this.uiState.propertyData=t},Sp.prototype.setProperty=function(e){switch(e.propertyData.ClrTypeID){case tt:this.process.setProcessProperty(e);break;case rt:this.activity.setUserActivityProperty(e,"userActivity");break;case nt:this.subProcess.setProperty(e);break;case ot:this.autoActAdapter.setProperty(e);break;case at:this.catchEventAdapter.setProperty(e);break;case it:this.activity.setUserActivityProperty(e,"autoActivity");break;case st:this.messageActAdapter.setProperty(e);break;case lt:this.notifyActAdapter.setProperty(e);break;case ct:this.creationActAdapter.setProperty(e);break;case pt:this.billNodeActivityAdapter.setProperty(e);break;case dt:this.sequenceActivityAdapter.setProperty(e);break;default:this.activity.setFlowElementProperty(e)}},Sp.prototype.updateSchemas=function(){var t,e,r=this,i=new v.Subject;return this.uiState.schemas=[],this.uiState.flowFormInfo.formalParameters&&0<this.uiState.flowFormInfo.formalParameters.length?(t=this.uiState.flowFormInfo.formalParameters.filter(function(e){return"CDTSchema"===e.dataType&&e.schemaMetadataId}),e=this.uiState.flowFormInfo.flowForm.id,this.getBeMappingByBizDefKey(e).subscribe(function(e){if(e&&e.enable)return r.service.getBusinessEntitybyId(e.newSchemaMetaDataId).subscribe(function(e){e=[e];e&&0<e.length&&e.forEach(function(e){r.uiState.schemas.push(e)}),i.next(!0)},function(e){r.uiState.schemas=[],i.next(!0)});O.forkJoin(t.map(function(e){return r.service.getBusinessEntitybyId(e.schemaMetadataId)})).subscribe(function(e){e&&0<e.length&&e.forEach(function(e){r.uiState.schemas.push(e)}),i.next(!0)},function(e){r.uiState.schemas=[],i.next(!0)})})):(this.uiState.schemas=[],i.next(!0)),i.asObservable()},Sp.prototype.getFlowFormInfoById=function(e){var r=this,i=new v.Subject;return e&&O.forkJoin(this.service.GetFlowFormbyId(e),this.service.getParametersbyFlowFormKey(e).pipe(re.map(function(e){return r.setFormParamCxt(e),e})),this.service.getComponentsbyFlowformkey(e),this.service.getExecuteFormbyFlowFormKey(e),this.service.getBizActivities(e),this.service.getCustomizeActions(e)).subscribe(function(e){var t=new Xe;t.flowForm=e[0],t.formalParameters=e[1],t.bizComponents=e[2].filter(function(e){return"Activity"!==e.ownerType}),t.excuteForms=e[3],t.bizActivities=e[4],t.customizeActions=e[5],r.uiState.flowFormInfo=t,r.updateSchemas().subscribe(function(e){i.next(t)})}),i.asObservable()},Sp.prototype.getFormFormatsByBizCategory=function(){var e,t;return this.uiState.flowFormInfo.flowForm.businessObjectId?(e="/api/runtime/wf/v1.0/formFormat/query?param=",t='{"bizCategory":"'+this.uiState.flowFormInfo.flowForm.businessObjectId+'"}',t=encodeURIComponent(t),this.http.get(e+=t)):v.from(new Array)},Sp.prototype.saveProcess=function(e,t,r){return this.service.saveProcess(e,t,r)},Sp.prototype.deployProcess=function(e){return this.service.deployProcess(e)},Sp.prototype.releaseProcess=function(e,t){var e=JSON.parse(e),r=this.resolver.resolveComponentFactory(Jc).create(this.injector),t=(r.instance.procName=e.DefaultProcess.Name,r.instance.procVersion=1===t?1:t+1,r.instance.processDefinitionKey=e.DefaultProcess.Key,{title:this.localePipe.transform("app.processDesigner.releaseProcess"),width:500,height:550,buttons:r.instance.btnRef,showButtons:!0}),i=this.modalService.show(r,t);r.instance.submit.subscribe(function(e){i.close()}),r.instance.cancel.subscribe(function(e){i.close()})},Sp.prototype.auditProcessDef=function(e,t,r){var i=new bc;i.auditId=e,i.success=t,i.processDefKey=r,this.service.auditProcessDef(i)},Sp.prototype.saveRTProcess=function(e,t){return this.service.saveRTProcess(e,t)},Sp.prototype.saveAsProcess=function(r,e){var i=this,t=this.resolver.resolveComponentFactory(tl).create(this.injector),e=(t.instance.procKey=r.DefaultProcess.Key,t.instance.procName=r.DefaultProcess.Name+this.localePipe.transform("app.processDesigner.copy"),t.instance.isAdministratorConfig=this.uiState.isAdministratorConfig,t.instance.enableAdminOrgAut=this.uiState.enableAdminOrgAut,t.instance.administrator=this.uiState.administrator,t.instance.accessLevel=e.accessLevel,this.uiState.enableAdminOrgAut||this.uiState.isAdministratorConfig||(t.instance.organization=e.procOrg.orgId,t.instance.organizationName=e.procOrg.orgName),{title:this.localePipe.transform("app.processDesigner.saveAs"),width:450,height:400,buttons:t.instance.btnRef,showButtons:!0}),n=this.modalService.show(t,e);t.instance.submit.subscribe(function(e){r.DefaultProcess.Name=e.procName;var t=new Ic;t.accessLevel=e.accessLevel,t.procOrg={orgId:e.organization,orgName:e.organizationName},i.saveProcess(r.ConvertToJson(),t,1).subscribe(function(e){i.notify.success({title:i.localePipe.transform("app.processDesigner.tips"),msg:i.localePipe.transform("app.processDesigner.saveAsSuccess"),timeout:3e3})},function(e){i.notify.error({title:i.localePipe.transform("app.processDesigner.tips"),msg:i.localePipe.transform("app.processDesigner.saveAsFail"),timeout:3e3})}),n.close()}),t.instance.cancel.subscribe(function(e){n.close()})},Sp.prototype.syncDtProcess=function(e,t,r){var i,n=this;void 0===r&&(r=!0),e&&(i=JSON.parse(e),r?this.message.question(this.localePipe.transform("app.processDesigner.syncDt"),function(){n.service.syncDtProcess(e,t).subscribe(function(e){n.notify.success({title:n.localePipe.transform("app.processDesigner.tips"),msg:n.localePipe.transform("app.processDesigner.syncSuccess"),timeout:3e3}),n.auditProcessDef(Cc,!0,i.DefaultProcess.Key)},function(e){n.notify.error({title:n.localePipe.transform("app.processDesigner.tips"),msg:e.error.Message,timeout:3e3}),n.auditProcessDef(Cc,!1,i.DefaultProcess.Key)})}):this.service.syncDtProcess(e,t).subscribe(function(e){n.notify.success({title:n.localePipe.transform("app.processDesigner.tips"),msg:n.localePipe.transform("app.processDesigner.syncSuccess"),timeout:3e3}),n.auditProcessDef(Cc,!0,i.DefaultProcess.Key)},function(e){n.notify.error({title:n.localePipe.transform("app.processDesigner.tips"),msg:e.error.Message,timeout:3e3}),n.auditProcessDef(Cc,!1,i.DefaultProcess.Key)}))},Sp.prototype.beforeCompleteStrategyChange=function(e,t){var r=this,t="/api/runtime/wf/v1.0/processInstances/runtimeActivityInstances?procDefId="+t.rtProcDefId+"&activityDefinitionId="+e.Id;return this.http.get(t).pipe(re.switchMap(function(e){return e&&0<e.length?(r.message.info(r.localePipe.transform("app.processDesigner.beforeCompleteStrategyChange")),v.of(!1)):v.of(!0)}))},Sp.prototype.getProcessCategory=function(e){return this.service.GetFlowFormbyId(e)},Sp.prototype.setFormParamCxt=function(e){var t=this;this.uiState.formalParameterContext=[],e&&0<e.length&&e.forEach(function(e){"CDTSchema"===e.dataType&&(e=[{key:"schemaId_"+e.code,name:"schemaId_"+e.name,description:"schemaId_"+e.name},{key:"metadataId_"+e.code,name:"metadataId_"+e.name,description:"metadataId_"+e.name}],t.uiState.formalParameterContext=t.uiState.formalParameterContext.concat(e))})},Sp.prototype.copy=function(e,t){this.eventBus.emit(e,t)},Sp.prototype.batchSet=function(e,t){this.eventBus.emit(e,t)},Sp.prototype.getProcDefsByKey=function(e){if(e)return this.http.get("/api/runtime/wf/v1.0/procDefs/key?procDefKey="+e)},Sp.prototype.checkExpressionsByPayload=function(e,t){return this.http.post("/api/runtime/wf/v1.0/flowForm/checkExpressionsByPayload",{bizDefKey:e,schema:t})},Sp.prototype.getBeMappingByBizDefKey=function(e){return this.http.get("/api/runtime/wf/v1.0/flowForm/getBeMappingByBizDefKey?bizDefKey="+e)},Sp.decorators=[{type:b.Injectable}],Sp.ctorParameters=function(){return[{type:a},{type:et},{type:l},{type:Te.NotifyService},{type:r.MessagerService},{type:en},{type:Qs},{type:Ul},{type:$l},{type:cc},{type:gc},{type:Lc},{type:Gc},{type:mp},{type:xp},{type:i.BsModalService},{type:b.Injector},{type:b.ComponentFactoryResolver},{type:t.HttpService},{type:qc},{type:x}]},Sp);function Sp(e,t,r,i,n,o,a,s,l,c,p,d,u,m,f,h,y,g,v,b,x){this.uiState=e,this.service=t,this.util=r,this.notify=i,this.message=n,this.process=o,this.activity=a,this.subProcess=s,this.autoActAdapter=l,this.catchEventAdapter=c,this.messageActAdapter=p,this.notifyActAdapter=d,this.creationActAdapter=u,this.billNodeActivityAdapter=m,this.sequenceActivityAdapter=f,this.modalService=h,this.injector=y,this.resolver=g,this.http=v,this.eventBus=b,this.localePipe=x}Tp.prototype.ngOnInit=function(){},Tp.prototype.clickOK=function(){this.submit.next(this.record)},Tp.prototype.clickCancel=function(){this.cancel.next()},Tp.decorators=[{type:b.Component,args:[{selector:"lib-note",template:'<div class="f-page">\r\n  <div class="f-page-main f-utils-fill-flex-column h-100">\r\n    <div class="f-utils-fill-flex-column farris-overflow-y-auto h-100">\r\n      <textarea class="form-control content-textarea" style="height: 100%;" [(ngModel)]="record" [placeholder]="placeholder"></textarea>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #footer>\r\n  <button type="button" class="btn btn-secondary btn-sm" (click)="clickCancel()">{{\'component.note.clickCancel\' | wfLocale}}</button>\r\n  <button type="button" class="btn btn-primary btn-sm mx-2" (click)="clickOK()">{{\'component.note.clickOK\' | wfLocale}}</button>\r\n</ng-template>\r\n',providers:[x],styles:[""]}]}],Tp.ctorParameters=function(){return[{type:b.ChangeDetectorRef,decorators:[{type:b.Optional}]},{type:String,decorators:[{type:b.Inject,args:[b.LOCALE_ID]}]},{type:undefined,decorators:[{type:b.Inject,args:[o]}]},{type:x,decorators:[{type:b.Optional}]}]},Tp.propDecorators={footer:[{type:b.ViewChild,args:["footer"]}]};var Ep=Tp;function Tp(e,t,r,i){this.cdr=e,this.localeId=t,this.resources=r,this.localePipe=i,this.submit=new v.Subject,this.cancel=new v.Subject,this.placeholder=this.localePipe.transform("component.note.placeholder"),this.localePipe=this.localePipe||new x(t,r)}var Ap=function(){},kp=function(){},Op=function(){},I=(Mp.getBasePath=function(){try{return window.gspframeworkService.common.getBasePath.get()}catch(e){}},Mp.PF_CMP_ID1="7433df25-9260-4c24-86f0-9da3e89450fb",Mp.PF_CMP_ID2="d0783800-ed60-488c-b053-8806a15947fe",Mp.PF_CMP_ID3="b89e9b9a-2e2d-4bd0-b354-187219544d34",Mp.PF_CMP_ID4="a8b8f7a4-49ae-4b7d-88d2-b3772b9d0ae5",Mp.IMAGE_PATH=Mp.getBasePath()+"/platform/runtime/common/web/@gsp-wf/wf-process-editor/images",Mp);function Mp(){}Np.isPfComponent=function(e){return e===I.PF_CMP_ID1||e===I.PF_CMP_ID2||e===I.PF_CMP_ID3||e===I.PF_CMP_ID4},Np.createNM=function(){function e(){return(65536*(1+Math.random())|0).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()};var Dp=Np;function Np(){}var Lp,Fp={ShowTips:"ShowTips"},rp=function(){},Rp=(n(Vp,Lp=rp),Vp);function Vp(){return null!==Lp&&Lp.apply(this,arguments)||this}n(Up,zp=Rp);var zp,Bp=Up;function Up(){return null!==zp&&zp.apply(this,arguments)||this}n(_p,jp=Rp);var jp,Hp=_p;function _p(){return null!==jp&&jp.apply(this,arguments)||this}n(qp,Gp=rp);var Gp,Kp=qp;function qp(){return null!==Gp&&Gp.apply(this,arguments)||this}n($p,Wp=Rp);var Wp,Jp=$p;function $p(){return null!==Wp&&Wp.apply(this,arguments)||this}n(Zp,Yp=Rp);var Yp,Xp=Zp;function Zp(){return null!==Yp&&Yp.apply(this,arguments)||this}n(td,Qp=Rp);var Qp,ed=td;function td(){return null!==Qp&&Qp.apply(this,arguments)||this}n(nd,rd=rp);var rd,id=nd;function nd(){return null!==rd&&rd.apply(this,arguments)||this}var od={AssignUser:"AssignUser",Transfer:"Transfer",AddSignFront:"AddSignFront",AddSignBehind:"AddSignBehind",Notify:"Notify"},S=(ad.getVariableSettings=function(e,t){var r,i,n,o,a,s,l=new Array,c=e.DefaultProcess.GetExtensionElements();if(t&&0<t.length)try{for(var p=ue(t),d=p.next();!d.done;d=p.next()){var u=d.value,m={variableCode:u.variableCode,variableName:u.variableName,tag:u.tag,executionTime:u.executionTime,value:u.value,valueText:u.valueText};if("component"===u.tag&&0<c.length)try{for(var f=ue(c),h=f.next();!h.done;h=f.next()){var y=h.value;if(y instanceof de.Component&&y.Id===u.value){var g={Id:y.Id,Name:y.Name,MetadataId:y.MetadataId,MethodCode:y.MethodCode,ActualParameters:[]};if(y.ActualParameters&&0<y.ActualParameters.length)try{for(var v=ue(y.ActualParameters),b=v.next();!b.done;b=v.next()){var x=b.value,w={Name:x.Name,Value:x.Value,Tag:x.Tag};g.ActualParameters.push(w)}}catch(P){a={error:P}}finally{try{b&&!b.done&&(s=v["return"])&&s.call(v)}finally{if(a)throw a.error}}m.component=g}}}catch(C){n={error:C}}finally{try{h&&!h.done&&(o=f["return"])&&o.call(f)}finally{if(n)throw n.error}}l.push(m)}}catch(I){r={error:I}}finally{try{d&&!d.done&&(i=p["return"])&&i.call(p)}finally{if(r)throw r.error}}return l},ad.getMessageNotices=function(e){return e&&0!=e.length?e.map(function(e){var t,r,i,n,o=new Object;if(o.content=e.content,o.sendTime=e.sendTime,o.sendType=e.sendType,o.subject=e.subject,e.smsMessageTemplate){var a=new Object;if(a.code=e.smsMessageTemplate.code,a.content=e.smsMessageTemplate.content,a.smsMessageVariables=new Array,e.smsMessageTemplate.smsMessageVariables&&0<e.smsMessageTemplate.smsMessageVariables.length)try{for(var s=ue(e.smsMessageTemplate.smsMessageVariables),l=s.next();!l.done;l=s.next()){var c=l.value,p=new Object;p.id=Dp.createNM(),p.code=c.code,p.value=c.value,p.tag=c.tag,a.smsMessageVariables.push(p)}}catch(C){t={error:C}}finally{try{l&&!l.done&&(r=s["return"])&&r.call(s)}finally{if(t)throw t.error}}o.smsMessageTemplate=a}var d=new Array;if(e.receiver){var u,m,f=e.receiver.split(","),h=e.receiverText.split(","),y=new Ap;for(u in y.type="userParticipant",y.userIds="",y.userNames="",f)"procInstCreator"===f[u]?((m=new Ap).type="processParticipant",m.processParticipant="procInstCreator",d.push(m)):"workItemParticipant"===f[u]?((m=new Ap).type="processParticipant",m.processParticipant="workItemParticipant",d.push(m)):(y.userIds+=f[u]+",",y.userNames+=h[u]+",");y.userIds&&(y.userIds=y.userIds.substring(0,y.userIds.length-1),y.userNames=y.userNames.substring(0,y.userNames.length-1),d.push(y))}if(e.receiverExpressions&&0<e.receiverExpressions.length)try{for(var g=ue(e.receiverExpressions),v=g.next();!v.done;v=g.next()){var b,x,w,P=v.value;P instanceof de.ActivityExecutorParticipantExpression?((b=new Ap).type="processParticipant",b.processParticipant="activityExecutorParticipant",b.activityDefId=P.activityDefId,b.activityDefName=P.activityDefName,d.push(b)):P instanceof de.UserParticipantExpression?((x=new Ap).type="variableParticipant",x.variableParticipant=P.UserId,x.variableName=P.name,x.orgType=P.OrgType,d.push(x)):P instanceof de.PositionParticipantExpression&&((w=new Ap).type="positionParticipant",w.positionId=P.PositionId,w.positionName=P.PositionName,w.positionType=P.PositionType,"1"===w.positionType&&(w.orgId=P.OrgId,w.orgType=P.OrgType),d.push(w))}}catch(I){i={error:I}}finally{try{v&&!v.done&&(n=g["return"])&&n.call(g)}finally{if(i)throw i.error}}return 0<d.length&&(o.receivers=d),o}):null},ad.getBizComponentList=function(e){var t,r,i,n,o=new Array;if(e&&0<e.length)try{for(var a=ue(e),s=a.next();!s.done;s=a.next()){var l=s.value,c=new kp;if(c.id=l.Id,c.name=l.Name,c.metadataId=l.MetadataId,c.methodCode=l.MethodCode,c.executionTime=l.Time,c.isForCompensation=l.isForCompensation,c.scopeType=l.ScopeType||null,c.actualParameters=new Array,l.ActualParameters&&0<l.ActualParameters.length)try{for(var p=ue(l.ActualParameters),d=p.next();!d.done;d=p.next()){var u=d.value,m=new Op;m.code=u.Name,m.name=u.Name,m.value=u.Value,c.actualParameters.push(m)}}catch(f){i={error:f}}finally{try{d&&!d.done&&(n=p["return"])&&n.call(p)}finally{if(i)throw i.error}}o.push(c)}}catch(h){t={error:h}}finally{try{s&&!s.done&&(r=a["return"])&&r.call(a)}finally{if(t)throw t.error}}return o},ad.getPerformerList=function(e){var o=new Array;return e.forEach(function(e){var t,r,i,n;null!=e&&(e.participantExpression instanceof de.UserParticipantExpression?(r=e.participantExpression)&&((n=new Rp).id=r.id,n.performerId=r.UserId,n.performerName=r.name,n.type=r.ClrTypeID,n.orgId=r.OrgId,n.orgName=r.OrgName,n.orgType=r.OrgType,n.condition=e.condition?e.condition.Value:"",n.tag=r.Tag,n.order=e.order,o.push(n)):e.participantExpression instanceof de.VariableParticipantExpression?(r=e.participantExpression)&&((n=new Bp).id=r.id,n.name=r.Name,n.type=r.ClrTypeID,n.condition=e.condition?e.condition.Value:"",n.tag=r.Tag,n.relation=r.Relation,n.varType=r.VarType,n.varValue=r.VarValue,n.order=e.order,o.push(n)):e.participantExpression instanceof de.PositionParticipantExpression?(r=e.participantExpression)&&((n=new Hp).id=r.id,n.performerId=r.PositionId,n.positionType=r.PositionType,n.performerName=r.PositionName,n.type=r.ClrTypeID,n.orgId=r.OrgId||"",n.orgName=r.OrgName||"",n.orgType=r.OrgType||"",n.condition=e.condition?e.condition.Value:"",n.order=e.order,o.push(n)):e.participantExpression instanceof de.ComponentParticipantExpression?(r=e.participantExpression)&&((n=new Kp).id=r.id,n.name=r.componentName,n.metadataId=r.componentId,n.methodCode=r.methodCode,n.methodName=r.methodName,n.type=r.ClrTypeID,n.actualParameters=new Array,r.actualParameters&&0<r.actualParameters.length&&(t=[],r.actualParameters.forEach(function(e){return t.push({code:e.Name,value:e.Value,valueText:e.ValueText,tag:e.Tag})}),n.actualParameters=t),e.condition&&(n.condition=e.condition.Value),n.order=e.order,o.push(n)):e.participantExpression instanceof de.ReportingLineParticipantExpression?(i=e.participantExpression)&&((r=new Jp).id=i.id,r.reportingLineDefId=i.ReportingLineDefId,r.reportingLineDefName=i.ReportingLineDefName,r.refOrgId=i.RefOrgId,r.refUserId=i.RefUserId,r.refEmployeeId=i.RefEmployeeId,r.dimension=i.Dimension,r.performerName=i.RefUserId,r.tag=i.Tag,r.type=i.ClrTypeID,e.condition&&(r.condition=e.condition.Value),r.order=e.order,o.push(r)):e.participantExpression instanceof de.ActivityExecutorParticipantExpression?(i=e.participantExpression)&&((n=new Xp).id=i.id,n.type=i.ClrTypeID,n.activityDefId=i.activityDefId,n.activityDefName=i.activityDefName,n.performerName="<"+i.activityDefName+pe.mxResources.get("eventHandler"),e.condition&&(n.condition=e.condition.Value),n.order=e.order,o.push(n)):e.participantExpression instanceof de.MatrixParticipantExpression?(i=e.participantExpression)&&((r=new ed).id=i.id,r.matrixDefId=i.matrixDefId,r.matrixDefName=i.matrixDefName,r.conditionField1=i.conditionField1,r.conditionFieldText1=i.conditionFieldText1,r.conditionField2=i.conditionField2,r.conditionFieldText2=i.conditionFieldText2,r.conditionField3=i.conditionField3,r.conditionFieldText3=i.conditionFieldText3,r.multivaluedCondition=i.multivaluedCondition,r.dataFieldAlias=i.dataFieldAlias,r.type=i.ClrTypeID,r.order=e.order,e.condition&&(r.condition=e.condition.Value),o.push(r)):e.participantExpression instanceof de.OrganizationParticipantExpression&&(i=e.participantExpression)&&((n=new id).id=i.id,n.type=i.ClrTypeID,n.name=i.name,n.actionScope=i.actionScope,n.organizationLevel=i.organizationLevel,n.organizationId=i.organizationId,n.organizationCode=i.organizationCode,n.organizationName=i.organizationName,n.includeChildren=i.includeChildren,n.parentsUntil=i.parentsUntil,n.tag=i.tag,n.order=e.order,e.condition&&(n.condition=e.condition.Value),o.push(n)))}),o},ad.getPerformerListTest=function(e){var o=new Array;return e.forEach(function(e){var t,r,i,n;null!=e&&(e instanceof de.UserParticipantExpression?(r=e)&&((n=new Rp).id=r.id,n.performerId=r.UserId,n.performerName=r.name,n.type=r.ClrTypeID,n.orgId=r.OrgId,n.orgName=r.OrgName,n.orgType=r.OrgType,n.condition=e.condition?e.condition.Value:"",n.tag=r.Tag,n.order=e.order,o.push(n)):e instanceof de.VariableParticipantExpression?(r=e)&&((n=new Bp).id=r.id,n.name=r.Name,n.type=r.ClrTypeID,n.condition=e.condition?e.condition.Value:"",n.tag=r.Tag,n.relation=r.Relation,n.varType=r.VarType,n.varValue=r.VarValue,n.order=e.order,o.push(n)):e instanceof de.PositionParticipantExpression?(r=e)&&((n=new Hp).id=r.id,n.performerId=r.PositionId,n.positionType=r.PositionType,n.performerName=r.PositionName,n.type=r.ClrTypeID,n.orgId=r.OrgId||"",n.orgName=r.OrgName||"",n.orgType=r.OrgType||"",n.condition=e.condition?e.condition.Value:"",n.order=e.order,o.push(n)):e instanceof de.ComponentParticipantExpression?(r=e)&&((n=new Kp).id=r.id,n.name=r.componentName,n.metadataId=r.componentId,n.methodCode=r.methodCode,n.methodName=r.methodName,n.type=r.ClrTypeID,n.actualParameters=new Array,r.actualParameters&&0<r.actualParameters.length&&(t=[],r.actualParameters.forEach(function(e){return t.push({code:e.Name,value:e.Value,valueText:e.ValueText,tag:e.Tag})}),n.actualParameters=t),e.condition&&(n.condition=e.condition.Value),n.order=e.order,o.push(n)):e instanceof de.ReportingLineParticipantExpression?(i=e)&&((r=new Jp).id=i.id,r.reportingLineDefId=i.ReportingLineDefId,r.reportingLineDefName=i.ReportingLineDefName,r.refOrgId=i.RefOrgId,r.refUserId=i.RefUserId,r.refEmployeeId=i.RefEmployeeId,r.dimension=i.Dimension,r.performerName=i.RefUserId,r.tag=i.Tag,r.type=i.ClrTypeID,e.condition&&(r.condition=e.condition.Value),r.order=e.order,o.push(r)):e instanceof de.ActivityExecutorParticipantExpression?(i=e)&&((n=new Xp).id=i.id,n.type=i.ClrTypeID,n.activityDefId=i.activityDefId,n.activityDefName=i.activityDefName,n.performerName="<"+i.activityDefName+pe.mxResources.get("eventHandler"),e.condition&&(n.condition=e.condition.Value),n.order=e.order,o.push(n)):e instanceof de.MatrixParticipantExpression?(i=e)&&((r=new ed).id=i.id,r.matrixDefId=i.matrixDefId,r.matrixDefName=i.matrixDefName,r.conditionField1=i.conditionField1,r.conditionFieldText1=i.conditionFieldText1,r.conditionField2=i.conditionField2,r.conditionFieldText2=i.conditionFieldText2,r.conditionField3=i.conditionField3,r.conditionFieldText3=i.conditionFieldText3,r.multivaluedCondition=i.multivaluedCondition,r.dataFieldAlias=i.dataFieldAlias,r.type=i.ClrTypeID,r.order=e.order,e.condition&&(r.condition=e.condition.Value),o.push(r)):e instanceof de.OrganizationParticipantExpression&&(i=e)&&((n=new id).id=i.id,n.type=i.ClrTypeID,n.name=i.name,n.actionScope=i.actionScope,n.organizationLevel=i.organizationLevel,n.organizationId=i.organizationId,n.organizationCode=i.organizationCode,n.organizationName=i.organizationName,n.includeChildren=i.includeChildren,n.parentsUntil=i.parentsUntil,n.tag=i.tag,n.order=e.order,e.condition&&(n.condition=e.condition.Value),o.push(n)))}),o},ad.getNotifyAble=function(e,t){var r,i,n=new No;return n.action=od.Notify,(n.enable=e)&&(e=[],(r=(t=t.filter(function(e){return e.actionScope===od.Notify})).find(function(e){return e.organizationLevel&&!e.order}))?((i=new id).id=r.id,i.type=r.ClrTypeID,i.name=r.name,i.actionScope=r.actionScope,i.organizationLevel=r.organizationLevel,i.organizationId=r.organizationId,i.organizationCode=r.organizationCode,i.organizationName=r.organizationName,i.includeChildren=r.includeChildren,i.parentsUntil=r.parentsUntil,i.tag=r.tag,i.order=1,e.push(i)):e=ad.getPerformerListTest(t),n.scope=new Fo,e&&0<e.length?(n.scope.participantInfo=new Ko,n.scope.participantInfo.potentialOwnerList=e,n.scope.participantInfo.isAllScope=!0):(n.scope.participantInfo=new Ko,n.scope.participantInfo.isAllScope=!1)),n},ad.updateFormalParameters=function(e,t){t=t||[];var r,i,n,o,a=e.GetDataObjects();if(null!==t&&0<t.length)try{for(var s=ue(t),l=s.next();!l.done;l=s.next()){var c,p,d=l.value,u=new B.DataType(e.Model);try{for(var m=ue(a),f=m.next();!f.done;f=m.next()){var h=f.value;h instanceof B.DataObject&&h.Name===d.code&&e.RemoveDataObject(h.Id)}}catch(y){n={error:y}}finally{try{f&&!f.done&&(o=m["return"])&&o.call(m)}finally{if(n)throw n.error}}u.Category=B.DataTypes.BasicType,u.BasicType=d.dataType,u.Description=d.description,0===d.parameterMode&&((c=new de.ValuedDataObject(e.Model)).Name=d.code,c.Documentation=d.name,c.DataType=u,c.IsAllowNull=d.allowNull,(d.initialValue||d.initialValueType)&&((p=new de.VariableSetting(e.Model)).variableCode=d.code,p.variableName=d.name,p.tag=d.initialValueType,p.value=d.initialValue,p.valueText=d.initialValue,c.variableSetting=p),e.AddDataObject(c))}}catch(g){r={error:g}}finally{try{l&&!l.done&&(i=s["return"])&&i.call(s)}finally{if(r)throw r.error}}},ad);function ad(){}n(E,sd=ce.ProcessCell),E.prototype.getFarrisPropConfig=function(){var e,t,r,i,n,o,a=[],s=(a=(a=this.editorUi.procExtProps&&0<this.editorUi.procExtProps.length?JSON.parse(JSON.stringify(this.editorUi.procExtProps)).sort(function(e,t){return e.sortOrder-t.sortOrder}):a).sort(function(e,t){return e.sortOrder-t.sortOrder}),{}),l=new ce.ElementPropertyConfig,c=(l.categoryId="usual",l.categoryName=pe.mxResources.get("basicInfo"),l.tabId="basic",l.tabName=pe.mxResources.get("basic"),l.properties=[{propertyID:Li,propertyName:pe.mxResources.get("name"),propertyType:"string",visible:!this.editorUi.multiLangEnabled},{propertyID:Fi,propertyName:pe.mxResources.get("nameLanguage"),propertyType:"multiLanguage",visible:this.editorUi.multiLangEnabled},{propertyID:Vi,propertyName:pe.mxResources.get("key"),propertyType:"string",readonly:!0},{propertyID:Yi,propertyName:pe.mxResources.get("entryForm"),propertyType:"modal"},{propertyID:Bi,propertyName:pe.mxResources.get("startMode"),propertyType:"select"},{propertyID:zi,propertyName:pe.mxResources.get("wfTitle"),propertyType:"modal"}],new ce.ElementPropertyConfig),p=(c.categoryId="formDef",c.categoryName=pe.mxResources.get("formDef"),c.tabId="basic",c.tabName=pe.mxResources.get("basic"),c.properties=[{propertyID:Ui,propertyName:pe.mxResources.get("formsPC"),propertyType:"modal"},{propertyID:ji,propertyName:pe.mxResources.get("formsMobile"),propertyType:"modal"}],new ce.ElementPropertyConfig),d=(p.categoryId="process",p.categoryName=pe.mxResources.get("process"),p.tabId="advanced",p.tabName=pe.mxResources.get("advanced"),p.properties=[{propertyID:Hi,propertyName:pe.mxResources.get("wfComponent"),propertyType:"modal"}],new ce.ElementPropertyConfig),u=(d.categoryId="advanced",d.categoryName=pe.mxResources.get("otherConfig"),d.tabId="advanced",d.tabName=pe.mxResources.get("advanced"),d.properties=[{propertyID:_i,propertyName:pe.mxResources.get("processVariables"),propertyType:"modal"},{propertyID:Gi,propertyName:pe.mxResources.get("customizeAction"),propertyType:"modal"},{propertyID:Ki,propertyName:pe.mxResources.get("enablePriority"),propertyType:"select"},{propertyID:Qi,propertyName:pe.mxResources.get("enableWholeOrderRetrieve"),propertyType:"select",description:pe.mxResources.get("description")},{propertyID:qi,propertyName:pe.mxResources.get("messageProperty"),propertyType:"modal"}],new ce.ElementPropertyConfig),m=(u.categoryId="messageProperty",u.categoryName=pe.mxResources.get("timelinessInfo"),u.tabId="advanced",u.tabName=pe.mxResources.get("advanced"),u.properties=[{propertyID:Wi,propertyName:pe.mxResources.get("timeLimitControl"),propertyType:"modal"},{propertyID:Ji,propertyName:pe.mxResources.get("messageNotice"),propertyType:"modal"}],new Array);try{for(var f=ue(a),h=f.next();!h.done;h=f.next()){var y=h.value;if(!y.parentId){var g={parent:y,childs:new Array};try{for(var v=ue(a),b=v.next();!b.done;b=v.next()){var x=b.value;x.parentId===y.id&&g.childs.push(x)}}catch(S){r={error:S}}finally{try{b&&!b.done&&(i=v["return"])&&i.call(v)}finally{if(r)throw r.error}}m.push(g)}}}catch(E){e={error:E}}finally{try{h&&!h.done&&(t=f["return"])&&t.call(f)}finally{if(e)throw e.error}}if(m&&0<m.length){var w=new ce.ElementPropertyConfig;w.categoryId="extendProperty",w.categoryName=pe.mxResources.get("extendProperty"),w.tabId="advanced",w.tabName=pe.mxResources.get("advanced"),w.properties=new Array;try{for(var P=ue(m),C=P.next();!C.done;C=P.next()){var I=C.value;w.properties.push({propertyID:I.parent.id,propertyName:I.parent.propertyTitle,propertyType:"modal"})}}catch(T){n={error:T}}finally{try{C&&!C.done&&(o=P["return"])&&o.call(P)}finally{if(n)throw n.error}}return this.setProcessPropertyValue(s,m),{propertyConfig:[l,c,p,u,d,w],propertyData:s}}return this.setProcessPropertyValue(s,m),{propertyConfig:[l,c,p,u,d],propertyData:s}},E.prototype.updateProps=function(e){var t=e.propertyID;if(t)switch(t){case"EntryForm":this.updateProcessHeader(e.propertyValue.name,e.propertyValue.businessObjectId,e.propertyValue.id),this.updateFlowFormInfo(e.formalParameters,e.processBizComponnets,e.executeForms,e.customizeActions,e.bizCmps),this.bindProcessTitleExpression(e.flowForm.processDescription);break;case Hi:this.updateProcessComponents(e.propertyValue);break;case Ui:this.updateExecuteForm(e.propertyValue,"PC"),e.parameters&&0<e.parameters.length&&S.updateFormalParameters(this.process,e.parameters);break;case ji:this.updateExecuteForm(e.propertyValue,"MOBILE"),e.parameters&&0<e.parameters.length&&S.updateFormalParameters(this.process,e.parameters);break;case Gi:this.updateCustomizeActions(e.propertyValue);break;case zi:this.modifyProcessTitleExpression(e.propertyValue);break;case $i:this.updateAllowPreAssign(e.propertyValue);break;case Bi:this.updateStartMode(e.propertyValue,e.allBizCmps,e.bizCmps);break;case Ki:this.updateEnablePriority(e.propertyValue);break;case Qi:this.updateEnableWholeOrderRetrieve(e.propertyValue);break;case _i:this.updateProcessVariables(e.propertyValue);break;case Wi:this.updateProcessTimeLimitControl(e.propertyValue);break;case Ji:this.updateProcessMessageNotices(e.propertyValue);break;case qi:this.updateImageSettings(e.propertyValue);break;default:-1<this.editorUi.procExtProps.findIndex(function(e){return e.id===t})?this.resetExtendProperty(e.propertyValue):sd.prototype.updateProps.call(this,e)}},E.prototype.setProcessPropertyValue=function(e,t){var r,i,n=this.process;if(n){n.Name||(n.Name="默认流程"),n.Key||(n.Key=B.BpmnModelHelper.GenerateElementId()),e[Ni]=n.Id,e[Ri]=n.ClrTypeID,e[Li]=n.Name,e[Fi]=n.NameLanguage||{"zh-CHS":n.Name},e[Vi]=n.Key,e[zi]="";var o,a,s=n.GetExtensionElements(),l=[],c=void 0,p=void 0,d=[],u=[],m=new Array;for(o in s)s[o]instanceof de.ProcessHeader&&(e[Yi]={id:s[o].BizDefKey,name:s[o].BizDefName},e[$i]=s[o].allowPreAssign,e[Bi]=s[o].startMode,e[Ki]=s[o].enablePriority||!1,e[Qi]=s[o].enableWholeOrderRetrieve||!1),s[o]instanceof de.Component&&s[o].Time!==de.ToolTime.UNDEFINITION&&l.push(this.convert2Component(s[o])),s[o]instanceof de.ExecuteForm&&("PC"===(a=s[o]).TerminalType?c=a:"MOBILE"===a.TerminalType&&(p=a)),s[o]instanceof de.TitleExpression&&(e[zi]=s[o].valueLanguage||s[o].value),s[o]instanceof de.CustomizeAction&&d.push(s[o]),s[o]instanceof de.MessageNotice&&m.push(this.getMessageNotice(s[o])),s[o]instanceof de.TimeLimitControl&&(e[Wi]=this.getPrcocessTimeLimitInfo(s[o])),s[o]instanceof de.ExtendProperty&&u.push(s[o]),s[o]instanceof de.ImageSettings&&(e[qi]=s[o]);n=this.getProcessVariables(n);e[_i]=n,e[Hi]=l,e[Ui]=c,e[ji]=p,e[Gi]=d,e[Ji]=m;try{for(var f=ue(t),h=f.next();!h.done;h=f.next()){var y=h.value;u&&0<u.length&&y.childs.sort(function(e,t){return e.sortOrder-t.sortOrder}).forEach(function(t){u.forEach(function(e){e.key==t.code&&(t.value=e.value)})}),e[y.parent.id]=y.childs}}catch(g){r={error:g}}finally{try{h&&!h.done&&(i=f["return"])&&i.call(f)}finally{if(r)throw r.error}}}},E.prototype.getProcessVariables=function(e){var t,r,i,n,o,a,s=new Array,l=e.GetExtensionElements(),e=e.GetDataObjects();if(null!==e&&0<e.length)try{for(var c=ue(e),p=c.next();!p.done;p=c.next()){var d=p.value;if(d instanceof de.ValuedDataObject&&d.DataType.Category!==B.DataTypes.CustomType){var u={id:d.Id,name:d.Name,documentation:d.Documentation,basicType:d.DataType.BasicType,tag:d.variableSetting?d.variableSetting.tag:"",value:d.variableSetting?d.variableSetting.value:"",valueText:d.variableSetting?d.variableSetting.valueText:"",description:d.DataType.Description};if(d.variableSetting&&"component"===d.variableSetting.tag&&0<l.length)try{for(var m=ue(l),f=m.next();!f.done;f=m.next()){var h=f.value;if(h instanceof de.Component&&h.Id===d.variableSetting.value){var y={Id:h.Id,Name:h.Name,MetadataId:h.MetadataId,MethodCode:h.MethodCode,ActualParameters:[]};if(h.ActualParameters&&0<h.ActualParameters.length)try{for(var g=ue(h.ActualParameters),v=g.next();!v.done;v=g.next()){var b=v.value,x={Name:b.Name,Value:b.Value,Tag:b.Tag};y.ActualParameters.push(x)}}catch(w){o={error:w}}finally{try{v&&!v.done&&(a=g["return"])&&a.call(g)}finally{if(o)throw o.error}}u.component=y}}}catch(P){i={error:P}}finally{try{f&&!f.done&&(n=m["return"])&&n.call(m)}finally{if(i)throw i.error}}s.push(u)}}}catch(C){t={error:C}}finally{try{p&&!p.done&&(r=c["return"])&&r.call(c)}finally{if(t)throw t.error}}return s},E.prototype.getPrcocessTimeLimitInfo=function(e){var t,r,i,n,o;if(e&&((o=new de.TimeLimitControlInfo).enable=e.enable,o.tag=e.tag,o.dueTime=e.dueTime,o.timeUnit=e.timeUnit,o.expireOperations=new Array,e.expireOperations)&&0<e.expireOperations.length){e=e.expireOperations;try{for(var a=ue(e),s=a.next();!s.done;s=a.next()){var l,c=s.value;if(0<c.ClrTypeID.indexOf("SendMessageExpireOperation")){var p=c,d=new de.SendMessageExpireOperationInfo;if(d.timeDuration=p.timeDuration,d.durationType=p.durationType,d.timeUnit=p.timeUnit,d.message=p.message,d.sendType=p.sendType,d.subject=p.subject,d.id=p.id,d.receiver=p.receiver,d.receiverText=p.receiverText,d.cycleEnable=p.cycleEnable,d.cycleTime=p.cycleTime,d.cycleTimeUnit=p.cycleTimeUnit,d.operationTypeName=p.operationTypeName||"SendMessageExpireOperation",p.smsMessageTemplate){var u=new Object;if(u.code=p.smsMessageTemplate.code,u.content=p.smsMessageTemplate.content,u.smsMessageVariables=new Array,p.smsMessageTemplate.smsMessageVariables&&0<p.smsMessageTemplate.smsMessageVariables.length)try{for(var m=ue(p.smsMessageTemplate.smsMessageVariables),f=m.next();!f.done;f=m.next()){var h=f.value,y=new Object;y.id=Dp.createNM(),y.code=h.code,y.value=h.value,y.tag=h.tag,u.smsMessageVariables.push(y)}}catch(g){i={error:g}}finally{try{f&&!f.done&&(n=m["return"])&&n.call(m)}finally{if(i)throw i.error}}d.smsMessageTemplate=u}o.expireOperations.push(d)}else 0<c.ClrTypeID.indexOf("AutoHandleExpireOperation")&&(p=c,(l=new de.AutoHandleExpireOperationInfo).id=p.id,l.durationType=p.durationType,l.timeDuration=p.timeDuration,l.timeUnit=p.timeUnit,l.operationTypeName=p.operationTypeName||"AutoHandleExpireOperation",l.autoHandleType=p.autoHandleType,l.message=p.message,o.expireOperations.push(l))}}catch(v){t={error:v}}finally{try{s&&!s.done&&(r=a["return"])&&r.call(a)}finally{if(t)throw t.error}}}return o},E.prototype.getMessageNotice=function(e){var t,r,i,n,o=new Object;if(o.content=e.content,o.sendTime=e.sendTime,o.sendType=e.sendType,o.subject=e.subject,e.smsMessageTemplate){var a=new Object;if(a.code=e.smsMessageTemplate.code,a.content=e.smsMessageTemplate.content,a.smsMessageVariables=new Array,e.smsMessageTemplate.smsMessageVariables&&0<e.smsMessageTemplate.smsMessageVariables.length)try{for(var s=ue(e.smsMessageTemplate.smsMessageVariables),l=s.next();!l.done;l=s.next()){var c=l.value,p=new Object;p.id=Dp.createNM(),p.code=c.code,p.value=c.value,p.tag=c.tag,a.smsMessageVariables.push(p)}}catch(C){t={error:C}}finally{try{l&&!l.done&&(r=s["return"])&&r.call(s)}finally{if(t)throw t.error}}o.smsMessageTemplate=a}var d=new Array;if(e.receiver){var u,m,f=e.receiver.split(","),h=e.receiverText.split(","),y=new Ap;for(u in y.type="userParticipant",y.userIds="",y.userNames="",f)"procInstCreator"===f[u]?((m=new Ap).type="processParticipant",m.processParticipant="procInstCreator",d.push(m)):"workItemParticipant"===f[u]?((m=new Ap).type="processParticipant",m.processParticipant="workItemParticipant",d.push(m)):(y.userIds+=f[u]+",",y.userNames+=h[u]+",");y.userIds&&(y.userIds=y.userIds.substring(0,y.userIds.length-1),y.userNames=y.userNames.substring(0,y.userNames.length-1),d.push(y))}if(e.receiverExpressions&&0<e.receiverExpressions.length)try{for(var g=ue(e.receiverExpressions),v=g.next();!v.done;v=g.next()){var b,x,w,P=v.value;P instanceof de.ActivityExecutorParticipantExpression?((b=new Ap).type="processParticipant",b.processParticipant="activityExecutorParticipant",b.activityDefId=P.activityDefId,b.activityDefName=P.activityDefName,d.push(b)):P instanceof de.UserParticipantExpression?((x=new Ap).type="variableParticipant",x.variableParticipant=P.UserId,x.variableName=P.name,x.orgType=P.OrgType,d.push(x)):P instanceof de.PositionParticipantExpression&&((w=new Ap).type="positionParticipant",w.positionId=P.PositionId,w.positionName=P.PositionName,w.positionType=P.PositionType,"1"===w.positionType&&(w.orgId=P.OrgId,w.orgType=P.OrgType),d.push(w))}}catch(I){i={error:I}}finally{try{v&&!v.done&&(n=g["return"])&&n.call(g)}finally{if(i)throw i.error}}return 0<d.length&&(o.receivers=d),o},E.prototype.convert2Component=function(e){var t,r,i=new kp;if(i.id=e.Id,i.name=e.Name,i.metadataId=e.MetadataId,i.methodCode=e.MethodCode,i.executionTime=e.Time,i.isForCompensation=e.isForCompensation,i.scopeType=e.ScopeType||null,i.actualParameters=new Array,e.ActualParameters&&0<e.ActualParameters.length)try{for(var n=ue(e.ActualParameters),o=n.next();!o.done;o=n.next()){var a=o.value,s=new Op;s.code=a.Name,s.name=a.Name,s.value=a.Value,i.actualParameters.push(s)}}catch(l){t={error:l}}finally{try{o&&!o.done&&(r=n["return"])&&r.call(n)}finally{if(t)throw t.error}}return i},E.prototype.setProcessHeader=function(e,t,r,i){var n=this.process,o=n.GetExtensionElements(),n=new de.ProcessHeader(n.Model,e,t,r,i);o.push(n)},E.prototype.updateFlowFormInfo=function(e,t,r,i,n){this.updateFormalParameters(e,t.filter(function(e){return"Schema"===e.ownerType})),this.setProcessComponents(t,n),this.updateExecuteForms(r),this.updateCustomizeActions(i)},E.prototype.updateFormalParameters=function(e,m){void 0===m&&(m=new Array),e=e||[];var t,r,f=this.process,h=f.GetDataObjects();if(null!==e&&0<e.length){var i=function(t){var e,r,i,n=new B.DataType(f.Model);if("CDTSchema"===t.dataType){try{for(var o=ue(h),a=o.next();!a.done;a=o.next())(l=a.value)instanceof B.DataObject&&l.DataType.Category===B.DataTypes.CustomType&&f.RemoveDataObject(l.Id)}catch(d){i={error:d}}finally{try{a&&!a.done&&(s=o["return"])&&s.call(o)}finally{if(i)throw i.error}}var s=new de.CDTSchemaType(f.Model);t.newSchemaId&&t.newSchemaMetadataId?(s.SchemaId=t.newSchemaId,s.MetadataId=t.newSchemaMetadataId):(s.SchemaId=t.schemaId,s.MetadataId=t.schemaMetadataId),s.ComponentId=m.filter(function(e){return e.owner===t.schemaId})[0].id,n.Category=B.DataTypes.CustomType,n.CustomType=s}else{try{for(var l,c=ue(h),p=c.next();!p.done;p=c.next())(l=p.value)instanceof B.DataObject&&l.Name===t.code&&f.RemoveDataObject(l.Id)}catch(u){e={error:u}}finally{try{p&&!p.done&&(r=c["return"])&&r.call(c)}finally{if(e)throw e.error}}n.Category=B.DataTypes.BasicType,n.BasicType=t.dataType}n.Description=t.description,0===t.parameterMode&&((i=new de.ValuedDataObject(f.Model)).Name=t.code,i.Documentation=t.name,i.DataType=n,i.IsAllowNull=t.allowNull,(t.initialValue||t.initialValueType)&&((s=new de.VariableSetting(f.Model)).variableCode=t.code,s.variableName=t.name,s.tag=t.initialValueType,s.value=t.initialValue,s.valueText=t.initialValue,i.variableSetting=s),f.AddDataObject(i))};try{for(var n=ue(e),o=n.next();!o.done;o=n.next())i(o.value)}catch(a){t={error:a}}finally{try{o&&!o.done&&(r=n["return"])&&r.call(n)}finally{if(t)throw t.error}}}},E.prototype.setProcessComponents=function(e,R){var V,z,B,U,j,H,_,G,K,q,W,J,$,Y,X,Z,Q,ee,te,t,r=this.process,i=r.GetExtensionElements();if(0<i.length)for(var n=i.length;0<n;n--)i[n-1]instanceof de.Component&&i[n-1].Time!==de.ToolTime.UNDEFINITION&&i.splice(n-1,1),i[n-1]instanceof de.ProcessHeader&&(t=i[n-1]);if(t.startMode!==de.StartMode.DIRECT){var o=e.find(function(e){return e.executionTime===de.ToolTime.LOADDATA});if(o){var a=new de.Component(r.Model);if(a.Time=o.executionTime,a.MetadataId=o.metadataId,a.MethodCode=o.methodCode,a.Id=o.id,a.Name=o.name,a.isForCompensation=o.isForCompensation,a.ActualParameters=[],o.scopeType?a.ScopeType=o.scopeType:a.ScopeType="Undefined",o.actualParameters&&0<o.actualParameters.length)try{for(var s=ue(o.actualParameters),l=s.next();!l.done;l=s.next()){var c=l.value,p=new de.ActualParameter(r.Model,c.code,c.value);a.ActualParameters.push(p)}}catch(D){V={error:D}}finally{try{l&&!l.done&&(E=s["return"])&&E.call(s)}finally{if(V)throw V.error}}if(i.push(a),t.startMode==de.StartMode.EXTERNAL_PROCESS){var re=!1,o=R;if(o&&0<o.length)try{for(var d=ue(o),u=d.next();!u.done;u=d.next())if("ExternalProcess"===u.value.scopeType){re=!0;break}}catch(N){z={error:N}}finally{try{u&&!u.done&&(B=d["return"])&&B.call(d)}finally{if(z)throw z.error}}if(re)try{for(var m=ue(e),f=m.next();!f.done;f=m.next()){b=f.value;if((k=new de.Component(r.Model)).Time=b.executionTime,k.MetadataId=b.metadataId,k.MethodCode=b.methodCode,k.Id=b.id,k.Name=b.name,k.isForCompensation=b.isForCompensation,k.ActualParameters=[],b.scopeType?k.ScopeType=b.scopeType:k.ScopeType="Undefined",b.actualParameters&&0<b.actualParameters.length)try{for(var h=ue(b.actualParameters),y=h.next();!y.done;y=h.next()){c=y.value,p=new de.ActualParameter(r.Model,c.code,c.value);k.ActualParameters.push(p)}}catch(L){q={error:L}}finally{try{y&&!y.done&&(W=h["return"])&&W.call(h)}finally{if(q)throw q.error}}k.Time!==de.ToolTime.LOADDATA&&k.ScopeType!==de.StartMode.DIRECT&&k.ScopeType!==de.StartMode.SUB_PROCESS&&"Undefined"!==k.ScopeType&&i.push(k)}}catch(F){G={error:F}}finally{try{f&&!f.done&&(K=m["return"])&&K.call(m)}finally{if(G)throw G.error}}else if(e&&0<e.length)try{for(var g=ue(e),v=g.next();!v.done;v=g.next()){var b=v.value;if((k=new de.Component(r.Model)).Time=b.executionTime,k.MetadataId=b.metadataId,k.MethodCode=b.methodCode,k.Id=b.id,k.Name=b.name,k.isForCompensation=b.isForCompensation,k.ActualParameters=[],b.scopeType?k.ScopeType=b.scopeType:k.ScopeType="Undefined",b.actualParameters&&0<b.actualParameters.length)try{for(var x=ue(b.actualParameters),w=x.next();!w.done;w=x.next()){var c=w.value,p=new de.ActualParameter(r.Model,c.code,c.value);k.ActualParameters.push(p)}}catch(ie){H={error:ie}}finally{try{w&&!w.done&&(_=x["return"])&&_.call(x)}finally{if(H)throw H.error}}k.Time!==de.ToolTime.LOADDATA&&k.ScopeType!==de.StartMode.DIRECT&&k.ScopeType!==de.StartMode.SUB_PROCESS&&i.push(k)}}catch(ne){U={error:ne}}finally{try{v&&!v.done&&(j=g["return"])&&j.call(g)}finally{if(U)throw U.error}}this.editorUi.fireEvent(new pe.mxEventObject(ce.PmfEvents.ShowProperty))}else if(t.startMode==de.StartMode.SUB_PROCESS&&e&&0<e.length)try{for(var P=ue(e),C=P.next();!C.done;C=P.next()){b=C.value;if((k=new de.Component(r.Model)).Time=b.executionTime,k.MetadataId=b.metadataId,k.MethodCode=b.methodCode,k.Id=b.id,k.Name=b.name,k.isForCompensation=b.isForCompensation,k.ActualParameters=[],b.scopeType?k.ScopeType=b.scopeType:k.ScopeType="Undefined",b.actualParameters&&0<b.actualParameters.length)try{for(var I=ue(b.actualParameters),S=I.next();!S.done;S=I.next()){c=S.value,p=new de.ActualParameter(r.Model,c.code,c.value);k.ActualParameters.push(p)}}catch(oe){Y={error:oe}}finally{try{S&&!S.done&&(X=I["return"])&&X.call(I)}finally{if(Y)throw Y.error}}k.Time!==de.ToolTime.LOADDATA&&k.ScopeType!==de.StartMode.DIRECT&&k.ScopeType!==de.StartMode.EXTERNAL_PROCESS&&"Undefined"!==k.ScopeType&&i.push(k)}}catch(ae){J={error:ae}}finally{try{C&&!C.done&&($=P["return"])&&$.call(P)}finally{if(J)throw J.error}}}}else{var E=e.filter(function(e){return!1===Dp.isPfComponent(e.metadataId)});if(E&&0<E.length)try{for(var T=ue(E),A=T.next();!A.done;A=T.next()){var k,b=A.value;if((k=new de.Component(r.Model)).Time=b.executionTime,k.MetadataId=b.metadataId,k.MethodCode=b.methodCode,k.Id=b.id,k.Name=b.name,k.isForCompensation=b.isForCompensation,b.scopeType?k.ScopeType=b.scopeType:k.ScopeType="Undefined",k.ActualParameters=[],b.actualParameters&&0<b.actualParameters.length)try{for(var O=ue(b.actualParameters),M=O.next();!M.done;M=O.next()){c=M.value,p=new de.ActualParameter(r.Model,c.code,c.value);k.ActualParameters.push(p)}}catch(se){ee={error:se}}finally{try{M&&!M.done&&(te=O["return"])&&te.call(O)}finally{if(ee)throw ee.error}}k.ScopeType!==de.StartMode.EXTERNAL_PROCESS&&k.ScopeType!==de.StartMode.SUB_PROCESS&&i.push(k)}}catch(le){Z={error:le}}finally{try{A&&!A.done&&(Q=T["return"])&&Q.call(T)}finally{if(Z)throw Z.error}}}},E.prototype.updateExecuteForms=function(e){var t,r,i=this.process.GetExtensionElements();if(0<i.length)for(var n=i.length;0<n;n--)i[n-1]instanceof de.ExecuteForm&&i.splice(n-1,1);try{for(var o=ue(e),a=o.next();!a.done;a=o.next()){var s=a.value;this.updateExecuteForm(s)}}catch(l){t={error:l}}finally{try{a&&!a.done&&(r=o["return"])&&r.call(o)}finally{if(t)throw t.error}}},E.prototype.updateExecuteForm=function(e,t){var r,i=this.process,n=i.GetExtensionElements();if(0<n.length)for(var o=n.length;0<o;o--)n[o-1]instanceof de.ExecuteForm&&n[o-1].TerminalType===(t||e.TerminalType)&&n.splice(o-1,1);if(e){var a=e.ActualParameters,s=new Array;if(a&&0<a.length)try{for(var l=ue(a),c=l.next();!c.done;c=l.next()){var p=c.value,d=new de.ActualParameter(i.Model,p.Name,p.Value);p.Tag?d.Tag=p.Tag:p.Value?8<=p.Value.length&&'{"expr":'===p.Value.slice(0,8)?d.Tag="expression":d.Tag="constant":d.Tag="variable",s.push(d)}}catch(m){r={error:m}}finally{try{c&&!c.done&&(u=l["return"])&&u.call(l)}finally{if(r)throw r.error}}var a=B.BpmnModelHelper.GenerateElementId(),u=new de.ExecuteForm(i.Model,a,e.Name,s);u.ComponentId=e.ComponentId,u.FormType=e.FormType,u.formFormatId=e.formFormatId,u.formatConfigId=e.formatConfigId,u.TerminalType=e.TerminalType,n.push(u)}},E.prototype.updateCustomizeActions=function(e){var t,r,i,n,o=this.process,a=o.GetExtensionElements();if(0<a.length)for(var s=a.length;0<s;s--)a[s-1]instanceof de.CustomizeAction&&a.splice(s-1,1);if(e&&0<e.length)try{for(var l=ue(e),c=l.next();!c.done;c=l.next()){var p=c.value,d=new de.CustomizeAction(o.Model);if(d.id=B.BpmnModelHelper.GenerateElementId(),d.code=p.code,d.name=p.name,d.terminalType=p.terminalType,d.actualParameters=[],p.actualParameters&&0<p.actualParameters.length)try{for(var u=ue(p.actualParameters),m=u.next();!m.done;m=u.next()){var f=m.value,h=new de.ActualParameter(o.Model,f.Name,f.Value,f.ValueText,f.Tag||"expression");d.actualParameters.push(h)}}catch(y){i={error:y}}finally{try{m&&!m.done&&(n=u["return"])&&n.call(u)}finally{if(i)throw i.error}}a.push(d)}}catch(g){t={error:g}}finally{try{c&&!c.done&&(r=l["return"])&&r.call(l)}finally{if(t)throw t.error}}},E.prototype.modifyProcessTitleExpression=function(e){var t=this.process,r=t.GetExtensionElements();if(0<r.length)for(var i=r.length;0<i;i--)r[i-1]instanceof de.TitleExpression&&r.splice(i-1,1);var n=new de.TitleExpression(t.Model),n="string"==typeof e||null==e?new de.TitleExpression(t.Model,e):new de.TitleExpression(t.Model,e["zh-CHS"],e);r.push(n)},E.prototype.updateProcessHeader=function(e,t,r){var i=this.process.GetExtensionElements();if(null!==i&&0<i.length)for(var n in i)if(i[n]instanceof de.ProcessHeader)return i[n].BizDefName=e,i[n].BizObjId=t,void(i[n].BizDefKey=r)},E.prototype.bindProcessTitleExpression=function(e){var t=this.process,r=t.GetExtensionElements(),i=r.find(function(e){return e.ClrTypeID===de.TitleExpression.Clr_Type_ID});i&&i.value||(i=new de.TitleExpression(t.Model,e),r.push(i))},E.prototype.updateProcessComponents=function(e){var t,r,i,n,o=this.process,a=o.GetExtensionElements();if(0<a.length)for(var s=a.length;0<s;s--)a[s-1]instanceof de.Component&&a[s-1].Time!==de.ToolTime.UNDEFINITION&&a.splice(s-1,1);if(e&&0<e.length)try{for(var l=ue(e),c=l.next();!c.done;c=l.next()){var p=c.value,d=new de.Component(o.Model);if(d.Time=p.executionTime,d.MetadataId=p.metadataId,d.MethodCode=p.methodCode,d.Id=p.id,d.Name=p.name,d.isForCompensation=p.isForCompensation,d.ActualParameters=[],p.actualParameters&&0<p.actualParameters.length)try{for(var u=ue(p.actualParameters),m=u.next();!m.done;m=u.next()){var f=m.value,h=new de.ActualParameter(o.Model,f.code,f.value);d.ActualParameters.push(h)}}catch(y){i={error:y}}finally{try{m&&!m.done&&(n=u["return"])&&n.call(u)}finally{if(i)throw i.error}}a.push(d)}}catch(g){t={error:g}}finally{try{c&&!c.done&&(r=l["return"])&&r.call(l)}finally{if(t)throw t.error}}},E.prototype.updateAllowPreAssign=function(e){var t=this.process.GetExtensionElements();if(null!==t&&0<t.length)for(var r in t)if(t[r]instanceof de.ProcessHeader)return void(t[r].allowPreAssign=e)},E.prototype.updateEnablePriority=function(e){var t=this.process.GetExtensionElements();if(null!==t&&0<t.length)for(var r in t)if(t[r]instanceof de.ProcessHeader)return void(t[r].enablePriority=e)},E.prototype.updateStartMode=function(e,t,r){var i,n;switch(e){case de.StartMode.DIRECT:this.editorUi.fireEvent(new pe.mxEventObject(Fp.ShowTips,"data",{type:"message",level:"info",message:pe.mxResources.get("directTips")}));break;case de.StartMode.EXTERNAL_PROCESS:this.editorUi.fireEvent(new pe.mxEventObject(Fp.ShowTips,"data",{type:"message",level:"info",message:pe.mxResources.get("externalTips")}));break;case de.StartMode.SUB_PROCESS:this.editorUi.fireEvent(new pe.mxEventObject(Fp.ShowTips,"data",{type:"message",level:"info",message:pe.mxResources.get("subprocessTips")}))}var o=this.process,a=o.GetExtensionElements();if(null!==a&&0<a.length){if(a.filter(function(e){return e instanceof de.ProcessHeader})[0].startMode=e,0<a.length)for(var s=a.length;0<s;s--)a[s-1]instanceof de.Component&&a[s-1].Time!==de.ToolTime.UNDEFINITION&&a[s-1].Time!==de.ToolTime.LOADDATA&&a.splice(s-1,1);t&&t.forEach(function(e){var t=new de.Component(o.Model);t.Time=e.executionTime,t.MetadataId=e.metadataId,t.MethodCode=e.methodCode,t.Id=e.id,t.Name=e.name,t.isForCompensation=e.isForCompensation,t.ActualParameters=[],e.scopeType?t.ScopeType=e.scopeType:t.ScopeType="Undefined",e.actualParameters&&e.actualParameters.forEach(function(e){e=new de.ActualParameter(o.Model,e.code,e.value);t.ActualParameters.push(e)}),a.push(t)});t=a.filter(function(e){return e instanceof de.Component});if(e===de.StartMode.SUB_PROCESS)for(s=a.length;0<s;s--)a[s-1]instanceof de.Component&&(d=a[s-1]).Time!==de.ToolTime.UNDEFINITION&&d.Time!==de.ToolTime.LOADDATA&&d.ScopeType!==de.StartMode.SUB_PROCESS&&"All_Process"!==d.ScopeType&&a.splice(s-1,1);if(e===de.StartMode.DIRECT){t=t.filter(function(e){return Dp.isPfComponent(e.MetadataId)});if(t&&0<t.length)for(s=a.length;0<s;s--)a[s-1]instanceof de.Component&&(d=a[s-1],!Dp.isPfComponent(d.MetadataId)&&d.ScopeType!==de.StartMode.EXTERNAL_PROCESS&&d.ScopeType!==de.StartMode.SUB_PROCESS||a.splice(s-1,1))}else if(e===de.StartMode.EXTERNAL_PROCESS){var l=!1,t=r;if(t&&0<t.length){try{for(var c=ue(t),p=c.next();!p.done;p=c.next())if("ExternalProcess"===p.value.scopeType){l=!0;break}}catch(u){i={error:u}}finally{try{p&&!p.done&&(n=c["return"])&&n.call(c)}finally{if(i)throw i.error}}if(l)for(var d,s=a.length;0<s;s--)a[s-1]instanceof de.Component&&((d=a[s-1]).Time===de.ToolTime.UNDEFINITION||d.Time===de.ToolTime.LOADDATA||d.ScopeType!==de.StartMode.DIRECT&&d.ScopeType!==de.StartMode.SUB_PROCESS&&"Undefined"!==d.ScopeType||a.splice(s-1,1))}}}this.editorUi.fireEvent(new pe.mxEventObject(ce.PmfEvents.ShowProperty))},E.prototype.updateProcessVariables=function(e){var t,r,i,n,o,a,s=this.process,l=s.GetDataObjects(),c=s.GetExtensionElements();if(l&&0<l.length)try{for(var p=ue(l),d=p.next();!d.done;d=p.next())!function(t){var e;t instanceof de.ValuedDataObject&&t.DataType.Category!==B.DataTypes.CustomType&&(t.variableSetting&&"component"===t.variableSetting.tag&&(e=c.findIndex(function(e){return e instanceof de.Component&&e.Id===t.variableSetting.value}),c.splice(e,1)),s.RemoveDataObject(t.Id))}(d.value)}catch(I){t={error:I}}finally{try{d&&!d.done&&(r=p["return"])&&r.call(p)}finally{if(t)throw t.error}}if(null!==e&&0<e.length)try{for(var u=ue(e),m=u.next();!m.done;m=u.next()){var f=m.value,h=new B.DataType(s.Model),y=(h.Category=B.DataTypes.BasicType,h.BasicType=f.basicType,h.Description=f.description,new de.ValuedDataObject(s.Model));if(y.Id=f.id,y.Name=f.name,y.Documentation=f.documentation,y.DataType=h,f.tag&&f.value){var g=new de.VariableSetting(s.Model);if(g.variableCode=f.name,g.variableName=f.documentation,g.tag=f.tag,g.value=f.value,g.valueText=f.valueText,"component"===(y.variableSetting=g).tag){var v=f.component;if(v){var b=new de.Component(s.Model);if(b.MetadataId=v.MetadataId,b.MethodCode=v.MethodCode,b.Id=v.Id,b.Name=v.Name,b.ActualParameters=new Array,v.ActualParameters&&0<v.ActualParameters.length)try{for(var x=ue(v.ActualParameters),w=x.next();!w.done;w=x.next()){var P=w.value,C=new de.ActualParameter(s.Model,P.Name,P.Value);C.Tag=P.Tag,b.ActualParameters.push(C)}}catch(S){o={error:S}}finally{try{w&&!w.done&&(a=x["return"])&&a.call(x)}finally{if(o)throw o.error}}c.push(b)}}}s.AddDataObject(y)}}catch(E){i={error:E}}finally{try{m&&!m.done&&(n=u["return"])&&n.call(u)}finally{if(i)throw i.error}}},E.prototype.updateProcessTimeLimitControl=function(e){var t,r,i,n,o=this.process,a=o.GetExtensionElements();if(0<a.length)for(var s=a.length;0<s;s--)a[s-1]instanceof de.TimeLimitControl&&a.splice(s-1,1);if(e){var l=new de.TimeLimitControl(o.Model);if(l.enable=e.enable,l.tag=e.tag,l.dueTime=e.dueTime,l.timeUnit=e.timeUnit,l.expireOperations=new Array,e.expireOperations&&0<e.expireOperations.length)try{for(var c=ue(e.expireOperations),p=c.next();!p.done;p=c.next()){var d,u=p.value;if("SendMessageExpireOperation"!==u.operationTypeName&&u.operationTypeName)"AutoHandleExpireOperation"===u.operationTypeName&&(m=u,(d=new de.AutoHandleExpireOperation(o.Model)).id=B.BpmnModelHelper.GenerateElementId(),d.durationType=m.durationType,d.timeDuration=m.timeDuration,d.timeUnit=m.timeUnit,d.operationTypeName=m.operationTypeName||"AutoHandleExpireOperation",d.autoHandleType=m.autoHandleType,d.message=m.message,l.expireOperations.push(d));else{var m=u,f=new de.SendMessageExpireOperation(o.Model);if(f.id=B.BpmnModelHelper.GenerateElementId(),f.durationType=m.durationType,f.timeDuration=m.timeDuration,f.timeUnit=m.timeUnit,f.operationTypeName=m.operationTypeName||"SendMessageExpireOperation",f.message=m.message,f.subject=m.subject,f.sendType=m.sendType,f.receiver=m.receiver,f.receiverText=m.receiverText,f.cycleEnable=m.cycleEnable,f.cycleTime=m.cycleTime,f.cycleTimeUnit=m.cycleTimeUnit,m.smsMessageTemplate){var h=new de.SmsMessageTemplate(o.Model);if(h.code=m.smsMessageTemplate.code,h.content=m.smsMessageTemplate.content,h.smsMessageVariables=new Array,m.smsMessageTemplate.smsMessageVariables&&0<m.smsMessageTemplate.smsMessageVariables.length)try{for(var y=ue(m.smsMessageTemplate.smsMessageVariables),g=y.next();!g.done;g=y.next()){var v=g.value,b=new de.SmsMessageVariable(o.Model);b.code=v.code,b.value=v.value,b.tag=v.tag,h.smsMessageVariables.push(b)}}catch(x){i={error:x}}finally{try{g&&!g.done&&(n=y["return"])&&n.call(y)}finally{if(i)throw i.error}}f.smsMessageTemplate=h}l.expireOperations.push(f)}}}catch(w){t={error:w}}finally{try{p&&!p.done&&(r=c["return"])&&r.call(c)}finally{if(t)throw t.error}}a.push(l)}},E.prototype.updateProcessMessageNotices=function(e){var t,r,i,R,n,V,o,z,a=this.process,s=a.GetExtensionElements();if(0<s.length)for(var l=s.length;0<l;l--)s[l-1]instanceof de.MessageNotice&&s.splice(l-1,1);if(e&&0<e.length)try{for(var c=ue(e),p=c.next();!p.done;p=c.next()){var d=p.value,u=new de.MessageNotice(a.Model);if(u.sendType=d.sendType,u.sendTime=d.sendTime,u.subject=d.subject,u.content=d.content,d.receivers=d.receivers.filter(function(e){return e.type}),d.receivers&&0<d.receivers.length){var m=d.receivers.filter(function(e){return"userParticipant"===e.type||"processParticipant"===e.type&&"activityExecutorParticipant"!==e.processParticipant}),f=d.receivers.filter(function(e){return"variableParticipant"===e.type||"positionParticipant"===e.type||"processParticipant"===e.type&&"activityExecutorParticipant"===e.processParticipant});if(m&&0<m.length){var h="",y="";try{for(var g=ue(m),v=g.next();!v.done;v=g.next()){var b=v.value;"processParticipant"===b.type?(h+=b.processParticipant+",","procInstCreator"===b.processParticipant?y+="流程发起人,":"workItemParticipant"===b.processParticipant&&(y+="任务接收人,")):"userParticipant"===b.type&&(h+=b.userIds+",",y+=b.userNames+",")}}catch(D){i={error:D}}finally{try{v&&!v.done&&(R=g["return"])&&R.call(g)}finally{if(i)throw i.error}}h=h&&h.substring(0,h.length-1),y=y&&y.substring(0,y.length-1),u.receiver=h,u.receiverText=y}if(f&&0<f.length){var x=new Array;try{for(var w=ue(f),P=w.next();!P.done;P=w.next()){var C,I,S,E=P.value;"processParticipant"===E.type&&((C=new de.ActivityExecutorParticipantExpression(a.Model)).id=B.BpmnModelHelper.GenerateElementId(),C.activityDefId=E.activityDefId,C.activityDefName=E.activityDefName,x.push(C)),"variableParticipant"===E.type&&((I=new de.UserParticipantExpression(a.Model,E.variableParticipant,E.variableName,E.orgType)).id=B.BpmnModelHelper.GenerateElementId(),I.Tag="expression",I.OrgType=E.orgType,x.push(I)),"positionParticipant"===E.type&&((S=new de.PositionParticipantExpression(a.Model,E.positionId,E.positionName)).id=B.BpmnModelHelper.GenerateElementId(),S.PositionType=E.positionType,"1"===E.positionType&&(S.OrgId=E.orgId,S.OrgType=E.orgType),x.push(S))}}catch(N){n={error:N}}finally{try{P&&!P.done&&(V=w["return"])&&V.call(w)}finally{if(n)throw n.error}}u.receiverExpressions=x}}if(d.smsMessageTemplate){var T=new de.SmsMessageTemplate(a.Model);if(T.code=d.smsMessageTemplate.code,T.content=d.smsMessageTemplate.content,T.smsMessageVariables=new Array,d.smsMessageTemplate.smsMessageVariables&&0<d.smsMessageTemplate.smsMessageVariables.length)try{for(var A=ue(d.smsMessageTemplate.smsMessageVariables),k=A.next();!k.done;k=A.next()){var O=k.value,M=new de.SmsMessageVariable(a.Model);M.code=O.code,M.value=O.value,M.tag=O.tag,T.smsMessageVariables.push(M)}}catch(L){o={error:L}}finally{try{k&&!k.done&&(z=A["return"])&&z.call(A)}finally{if(o)throw o.error}}u.smsMessageTemplate=T}s.push(u)}}catch(F){t={error:F}}finally{try{p&&!p.done&&(r=c["return"])&&r.call(c)}finally{if(t)throw t.error}}},E.prototype.updateImageSettings=function(e){var t=this.process,r=t.GetExtensionElements();if(0<r.length)for(var i=r.length;0<i;i--)r[i-1]instanceof de.ImageSettings&&r.splice(i-1,1);e&&((t=new de.ImageSettings(t.Model)).imageOperation=e.imageOperation,r.push(t))},E.prototype.resetExtendProperty=function(e){var t,r,i,n,o=this.process,a=o.GetExtensionElements();try{for(var s=ue(e),l=s.next();!l.done;l=s.next()){var c=l.value;try{for(var p=ue(a),d=p.next();!d.done;d=p.next()){var u,m=d.value;m instanceof de.ExtendProperty&&m.key===c.code&&-1<(u=a.indexOf(m))&&a.splice(u,1)}}catch(f){i={error:f}}finally{try{d&&!d.done&&(n=p["return"])&&n.call(p)}finally{if(i)throw i.error}}}}catch(h){t={error:h}}finally{try{l&&!l.done&&(r=s["return"])&&r.call(s)}finally{if(t)throw t.error}}e&&e.forEach(function(e){var t=new de.ExtendProperty(o.Model);t.key=e.code,t.value=e.value,a.push(t)})},E.prototype.updateEnableWholeOrderRetrieve=function(e){var t=this.process.GetExtensionElements();if(null!==t&&0<t.length)for(var r in t)if(t[r]instanceof de.ProcessHeader)return void(t[r].enableWholeOrderRetrieve=e)};var sd,ld=E;function E(){return null!==sd&&sd.apply(this,arguments)||this}n(dd,cd=ce.Graph),dd.prototype.bpmnCellsSelectionChanged=function(e,t,r){var i=this,n=(cd.prototype.bpmnCellsSelectionChanged.call(this,e,t,r),this.getSelectionCells());this.getChildVertices(this.getDefaultParent()).forEach(function(e){n.includes(e)&&e.imgUrls&&e.imgUrls[B.FlowNodeState.Selected]?e.setStyle(pe.mxUtils.setStyle(e.getStyle(),pe.mxConstants.STYLE_IMAGE,e.imgUrls[B.FlowNodeState.Selected])):e.setStyle(pe.mxUtils.setStyle(e.getStyle(),pe.mxConstants.STYLE_IMAGE,e.imgUrls[B.FlowNodeState.Default])),i.refresh(e)})},dd.prototype.createProcessCell=function(e){var t=new ld;return t.process=e.DefaultProcess,t.plane=e.DefaultDiagram.BpmnPlane,t.editorUi=this.editorUi,t},dd.prototype.createBpmnModelWithProcInfo=function(e,t){var r,i=this.createBpmnModel();this.bpmnModel=i,this.processCell=this.createProcessCell(this.bpmnModel),"zh-CHS"===this.editorUi.langCode&&(this.bpmnModel.DefaultProcess.Name=e.name||i.DefaultProcess.Name),this.bpmnModel.DefaultProcess.NameLanguage=((r={})[this.editorUi.langCode]=e.name||i.DefaultProcess.Name,r),this.processCell.setProcessHeader(e.ffId,e.bizObjId,e.ffName,e.startMode),this.processCell.updateFlowFormInfo(e.formalParameters,e.processBizComponnets,e.executeForms,e.customizeActions,t),this.processCell.modifyProcessTitleExpression(e.processDescription)},dd.prototype.setDefaultStyles=function(){cd.prototype.setDefaultStyles.call(this),this.getStylesheet().getDefaultEdgeStyle()[pe.mxConstants.STYLE_ROUNDED]=1};var cd,pd=dd;function dd(e,t,r,i,n,o){e=cd.call(this,e,t,r,i,n,o)||this;return e.localePipe=null,e.processCell=new ld,e}n(fd,ud=ce.Sidebar),fd.prototype.addBizActPalette=function(e){var r=this,i=(this.palettes.bizactivitylib&&(this.container.removeChild(this.palettes.bizactivitylib[0]),this.container.removeChild(this.palettes.bizactivitylib[1]),delete this.palettes.bizactivitylib),this.bizActivities=e,new Array);this.bizActivities&&this.bizActivities.forEach(function(e){var t="image="+I.IMAGE_PATH+"/bizActivity.png;",t=ce.BpmnCellHelper.generate(de.UserActivity.Clr_Type_ID,undefined,new pe.mxGeometry(0,0,r.defaultImageWidth,r.defaultImageHeight),t);t.name=e.name,t.bizActivity=e,i.push(r.createItemFactory([t],t.name,r.defaultImageWidth,r.defaultImageHeight))}),0<i.length&&this.addPaletteFunctions("bizactivitylib",pe.mxResources.get("bizactivitylib"),!0,i)};var ud,md=fd;function fd(){var e=null!==ud&&ud.apply(this,arguments)||this;return e.bizActivities=[],e}n(gd,hd=ce.ExclusiveGatewayCell),gd.prototype.createFlowElement=function(e){e=hd.prototype.createFlowElement.call(this,e);return e.Id="ExclusiveGateway"+B.BpmnModelHelper.GenerateElementId(),e};var hd,yd=gd;function gd(){var e,t=null!==hd&&hd.apply(this,arguments)||this;return t.imgUrls=((e={})[B.FlowNodeState.Default]=I.IMAGE_PATH+"/ExclusiveGateway.png",e[B.FlowNodeState.Selected]=I.IMAGE_PATH+"/ExclusiveGateway_select.svg",e),t}n(xd,vd=ce.NodeCell),xd.prototype.createFlowElement=function(e){e=vd.prototype.createFlowElement.call(this,e);return e.Id="AifCreationBillActivity"+B.BpmnModelHelper.GenerateElementId(),e},xd.prototype.getFarrisPropConfig=function(){var e=this.flowElement,t=new ce.ElementPropertyConfig,r=new Object,i=(t.categoryId="general",t.categoryName=pe.mxResources.get("basicInformation"),t.tabId="basic",t.tabName=pe.mxResources.get("basicAttributes"),t.properties=[{propertyID:Bc,propertyName:pe.mxResources.get("name"),propertyType:"string",visible:!this.editorUi.multiLangEnabled},{propertyID:Uc,propertyName:pe.mxResources.get("nameLanguage"),propertyType:"multiLanguage",visible:this.editorUi.multiLangEnabled},{propertyID:zc,propertyName:pe.mxResources.get("id"),propertyType:"string",readonly:!0}],new ce.ElementPropertyConfig);return i.categoryId="bifDef",i.categoryName=pe.mxResources.get("bifDef"),i.tabId="basic",i.tabName=pe.mxResources.get("basicAttributes"),i.properties=[{propertyID:Hc,propertyName:pe.mxResources.get("aifProcess"),propertyType:"modal"}],r[zc]=e.Id,r[jc]=e.ClrTypeID,r[Bc]=e.Name||pe.mxResources.get("autoAif"),r[Uc]=e.NameLanguage||{"zh-CHS":e.Name},r[Hc]=e.aifProcessCode,r[_c]=e.isRelied,{propertyConfig:[t,i],propertyData:r}},xd.prototype.updateProps=function(e){e.propertyID===Hc?this.resetProcessCode(this.flowElement,e):vd.prototype.updateProps.call(this,e)},xd.prototype.resetProcessCode=function(e,t){t=t.propertyValue;e.aifProcessCode=t||null},xd.CLR_TYPE_ID=de.AifCreationBillActivity.Clr_Type_ID;var vd,bd=xd;function xd(e,t,r){e=vd.call(this,e,t,r)||this;return e.clrTypeId=xd.CLR_TYPE_ID,e.name="自动生单",e.nameLanguage={"zh-CHS":"自动生单","zh-CHT":"自動生單",en:"Creation Bill "},e.imgUrls=((t={})[B.FlowNodeState.Default]=I.IMAGE_PATH+"/aifCreationActivity.png",t[B.FlowNodeState.Selected]=I.IMAGE_PATH+"/aifCreationActivity_select.svg",t),e}n(Cd,wd=ce.NodeCell),Cd.prototype.createFlowElement=function(e){e=wd.prototype.createFlowElement.call(this,e);return e.Id="autoActivity"+B.BpmnModelHelper.GenerateElementId(),e},Cd.prototype.getFarrisPropConfig=function(){var e=this.flowElement,t=new ce.ElementPropertyConfig,r=new ce.ElementPropertyConfig,i={};return t.categoryId="basicProperty",t.categoryName=pe.mxResources.get("basicInformation"),t.tabId="basic",t.tabName=pe.mxResources.get("basicAttributes"),t.properties=[{propertyID:_l,propertyName:pe.mxResources.get("name"),propertyType:"string",visible:!this.editorUi.multiLangEnabled},{propertyID:Gl,propertyName:pe.mxResources.get("nameLanguage"),propertyType:"multiLanguage",visible:this.editorUi.multiLangEnabled},{propertyID:Hl,propertyName:pe.mxResources.get("id"),propertyType:"string",readonly:!0}],r.categoryId="activityProperty",r.categoryName=pe.mxResources.get("activityProperty"),r.tabId="basic",r.tabName=pe.mxResources.get("basicAttributes"),r.properties=[{propertyID:ql,propertyName:pe.mxResources.get("tools"),propertyType:"modal"},{propertyID:Wl,propertyName:pe.mxResources.get("variableSettings"),propertyType:"modal"}],i[Hl]=e.Id,i[Kl]=e.ClrTypeID,i[_l]=e.Name,i[Gl]=e.NameLanguage||{"zh-CHS":e.Name},i[ql]=S.getBizComponentList(e.tools),i[Wl]=S.getVariableSettings(e.Model,e.variableSettings),{propertyConfig:[t,r],propertyData:i}},Cd.prototype.updateProps=function(e){var t=this.flowElement;switch(e.propertyID){case ql:this.updateAutoActivityTools(t,e);break;case Wl:this.updateVariableSettings(t,e);break;default:wd.prototype.updateProps.call(this,e)}},Cd.prototype.updateAutoActivityTools=function(e,t){var r,i,n,o,t=t.propertyValue;if(e.tools=new Array,t&&0<t.length)try{for(var a=ue(t),s=a.next();!s.done;s=a.next()){var l=s.value,c=new de.Component(e.Model);if(c.Id=l.id,c.Name=l.name,c.ComponentType="WebServiceComponent",c.MetadataId=l.metadataId,c.MethodCode=l.methodCode,c.isForCompensation=l.isForCompensation,c.ActualParameters=[],l.actualParameters&&0<l.actualParameters.length)try{for(var p=ue(l.actualParameters),d=p.next();!d.done;d=p.next()){var u=d.value,m=new de.ActualParameter(e.Model,u.code,u.value);c.ActualParameters.push(m)}}catch(f){n={error:f}}finally{try{d&&!d.done&&(o=p["return"])&&o.call(p)}finally{if(n)throw n.error}}e.tools.push(c)}}catch(h){r={error:h}}finally{try{s&&!s.done&&(i=a["return"])&&i.call(a)}finally{if(r)throw r.error}}},Cd.prototype.updateVariableSettings=function(e,t){var r,i,n,o,a,s=e.Model,l=s.DefaultProcess.GetExtensionElements();if(e.variableSettings&&0<e.variableSettings.length)try{for(var c=ue(e.variableSettings),p=c.next();!p.done;p=c.next())!function(t){var e;"component"===t.tag&&(e=l.findIndex(function(e){return e instanceof de.Component&&e.Id===t.value}),l.splice(e,1))}(f=p.value)}catch(P){r={error:P}}finally{try{p&&!p.done&&(d=c["return"])&&d.call(c)}finally{if(r)throw r.error}}e.variableSettings=new Array;var d=t.propertyValue;if(d&&0<d.length)try{for(var u=ue(d),m=u.next();!m.done;m=u.next()){var f=m.value,h=new de.VariableSetting(s);if(h.variableCode=f.variableCode,h.variableName=f.variableName,h.tag=f.tag,h.executionTime=f.executionTime,h.value=f.value,h.valueText=f.valueText,e.variableSettings.push(h),"component"===h.tag){var y=f.component;if(y){var g=new de.Component(s);if(g.MetadataId=y.MetadataId,g.MethodCode=y.MethodCode,g.Id=y.Id,g.Name=y.Name,g.ActualParameters=new Array,y.ActualParameters&&0<y.ActualParameters.length)try{for(var v=ue(y.ActualParameters),b=v.next();!b.done;b=v.next()){var x=b.value,w=new de.ActualParameter(s,x.Name,x.Value);w.Tag=x.Tag,g.ActualParameters.push(w)}}catch(C){o={error:C}}finally{try{b&&!b.done&&(a=v["return"])&&a.call(v)}finally{if(o)throw o.error}}l.push(g)}}}}catch(I){i={error:I}}finally{try{m&&!m.done&&(n=u["return"])&&n.call(u)}finally{if(i)throw i.error}}},Cd.CLR_TYPE_ID=de.AutoActivity.Clr_Type_ID;var wd,Pd=Cd;function Cd(e,t,r){e=wd.call(this,e,t,r)||this;return e.clrTypeId=Cd.CLR_TYPE_ID,e.name="服务",e.nameLanguage={"zh-CHS":"服务","zh-CHT":"服務",en:"Service "},e.imgUrls=((t={})[B.FlowNodeState.Default]=I.IMAGE_PATH+"/auto.png",t[B.FlowNodeState.Selected]=I.IMAGE_PATH+"/auto_select.svg",t),e}n(Ed,Id=ce.NodeCell),Ed.prototype.createFlowElement=function(e){e=Id.prototype.createFlowElement.call(this,e);return e.Id="CallActivitySubProcess"+B.BpmnModelHelper.GenerateElementId(),e},Ed.prototype.getFarrisPropConfig=function(){var e=this.flowElement,t=new ce.ElementPropertyConfig,r=new ce.ElementPropertyConfig,i={};return t.categoryId="basicProperty",t.categoryName=pe.mxResources.get("basicInformation"),t.tabId="basic",t.tabName=pe.mxResources.get("basicAttributes"),t.properties=[{propertyID:Nl,propertyName:pe.mxResources.get("name"),propertyType:"string",visible:!this.editorUi.multiLangEnabled},{propertyID:Ll,propertyName:pe.mxResources.get("nameLanguage"),propertyType:"multiLanguage",visible:this.editorUi.multiLangEnabled},{propertyID:Dl,propertyName:pe.mxResources.get("id"),propertyType:"string",readonly:!0}],r.categoryId="activityProperty",r.categoryName=pe.mxResources.get("activityProperty"),r.tabId="basic",r.tabName=pe.mxResources.get("basicAttributes"),r.properties=[{propertyID:Rl,propertyName:pe.mxResources.get("callActivitySubProcess"),propertyType:"modal"},{propertyID:zl,propertyName:pe.mxResources.get("variableSettings"),propertyType:"modal"},{propertyID:Vl,propertyName:pe.mxResources.get("backWardRule"),propertyType:"modal"},{propertyID:Bl,propertyName:pe.mxResources.get("multiInstanceLoopCharacteristics"),propertyType:"modal"}],i[Dl]=e.Id,i[Fl]=e.ClrTypeID,i[Nl]=e.Name,i[Ll]=e.NameLanguage||{"zh-CHS":e.Name},i[Rl]={calledBizDefKey:e.calledBizDefKey,calledElement:e.CalledElement,inheritVariables:e.inheritVariables,inheritBizDataId:e.inheritBizDataId,bizDataId:e.bizDataId,aifProcessCode:e.aifProcessCode,useAutoCreationData:e.useAutoCreationData},i[Vl]=e.backWardRule,i[zl]=S.getVariableSettings(e.Model,e.variableSettings),i[Bl]=e.LoopCharacteristics,{propertyConfig:[t,r],propertyData:i}},Ed.prototype.updateProps=function(e){var t=this.flowElement;switch(e.propertyID){case Rl:this.updateSubProcessConfig(t,e);break;case Vl:this.updateBackWardRule(t,e);break;case zl:this.updateVariableSettings(t,e);break;case Bl:this.updateMultiInstanceLoopCharacteristic(t,e);break;default:Id.prototype.updateProps.call(this,e)}},Ed.prototype.updateSubProcessConfig=function(e,t){t=t.propertyValue;e&&(e.calledBizDefKey=t.calledBizDefKey,e.CalledElement=t.calledElement,e.inheritBizDataId=t.inheritBizDataId,e.inheritVariables=t.inheritVariables,e.bizDataId=t.bizDataId,e.aifProcessCode=t.aifProcessCode,e.useAutoCreationData=t.useAutoCreationData)},Ed.prototype.updateBackWardRule=function(e,t){var t=t.propertyValue,r=new de.BackWardRule(e.Model);r.TargetRef=t.TargetRef,r.SelectTargetAble=t.SelectTargetAble,r.WaitReturn=t.WaitReturn,r.ResubmitEffect=t.ResubmitEffect,r.DynamicBackWardRuleAble=t.DynamicBackWardRuleAble,r.SelectTargetList=t.SelectTargetList,e.backWardRule=r},Ed.prototype.updateVariableSettings=function(e,t){var r,i,n,o,a,s=this.flowElement.Model,l=s.DefaultProcess.GetExtensionElements();if(e.variableSettings&&0<e.variableSettings.length)try{for(var c=ue(e.variableSettings),p=c.next();!p.done;p=c.next())!function(t){var e;"component"===t.tag&&(e=l.findIndex(function(e){return e instanceof de.Component&&e.Id===t.value}),l.splice(e,1))}(f=p.value)}catch(P){r={error:P}}finally{try{p&&!p.done&&(d=c["return"])&&d.call(c)}finally{if(r)throw r.error}}e.variableSettings=new Array;var d=t.propertyValue;if(d&&0<d.length)try{for(var u=ue(d),m=u.next();!m.done;m=u.next()){var f=m.value,h=new de.VariableSetting(s);if(h.variableCode=f.variableCode,h.variableName=f.variableName,h.tag=f.tag,h.executionTime=f.executionTime,h.value=f.value,h.valueText=f.valueText,e.variableSettings.push(h),"component"===h.tag){var y=f.component;if(y){var g=new de.Component(s);if(g.MetadataId=y.MetadataId,g.MethodCode=y.MethodCode,g.Id=y.Id,g.Name=y.Name,g.ActualParameters=new Array,y.ActualParameters&&0<y.ActualParameters.length)try{for(var v=ue(y.ActualParameters),b=v.next();!b.done;b=v.next()){var x=b.value,w=new de.ActualParameter(s,x.Name,x.Value);w.Tag=x.Tag,g.ActualParameters.push(w)}}catch(C){o={error:C}}finally{try{b&&!b.done&&(a=v["return"])&&a.call(v)}finally{if(o)throw o.error}}l.push(g)}}}}catch(I){i={error:I}}finally{try{m&&!m.done&&(n=u["return"])&&n.call(u)}finally{if(i)throw i.error}}},Ed.prototype.updateMultiInstanceLoopCharacteristic=function(e,t){var r,i,n=t.propertyValue,o=new B.MultiInstanceLoopCharacteristics(e.Model);if(o.enable=n.enable,o.sequential=n.sequential,o.loopCardinality=n.loopCardinality,o.completionCondition=n.completionCondition,o.completionConditionRules=n.completionConditionRules,e.LoopCharacteristics=o,t.propertyValue){var n=t.propertyValue,a=new B.MultiInstanceLoopCharacteristics(e.Model),t=(a.enable=n.enable,a.sequential=n.sequential,a.loopCardinality=new B.Expression(e.Model),n.loopCardinality&&((o=new de.SemanticExpression(e.Model)).Value=n.loopCardinality,a.loopCardinality.MexExpression=o),a.completionCondition=n.completionCondition,n.completionConditionRules);if(a.completionConditionRules=null,t&&0<t.length){a.completionConditionRules=new Array;try{for(var s=ue(t),l=s.next();!l.done;l=s.next()){var c=l.value,p=new de.CounterSignRule(e.Model),d=new de.Condition(e.Model);d.Value=c.CompletionCondition.Value,p.ConclusionValue=c.ConclusionValue,p.CalculateType=c.CalculateType,p.ConditionValue=c.ConditionValue,p.WaitAllVotes=c.WaitAllVotes,p.CompletionCondition=d,a.completionConditionRules.push(p)}}catch(u){r={error:u}}finally{try{l&&!l.done&&(i=s["return"])&&i.call(s)}finally{if(r)throw r.error}}}e.LoopCharacteristics=a}},Ed.CLR_TYPE_ID=de.CallActivitySubProcess.Clr_Type_ID;var Id,Sd=Ed;function Ed(e,t,r){e=Id.call(this,e,t,r)||this;return e.clrTypeId=Ed.CLR_TYPE_ID,e.name="子流程",e.nameLanguage={"zh-CHS":"子流程","zh-CHT":"子流程",en:"Sub-Process"},e.imgUrls=((t={})[B.FlowNodeState.Default]=I.IMAGE_PATH+"/sub.png",t[B.FlowNodeState.Selected]=I.IMAGE_PATH+"/sub_select.svg",t),e}n(kd,Td=ce.NodeCell),kd.prototype.createFlowElement=function(e){var t=Td.prototype.createFlowElement.call(this,e);return t.Id="IntermediateCatchEvent"+B.BpmnModelHelper.GenerateElementId(),null==e&&t.initEventDefinitions(),t},kd.prototype.bindBpmnModel=function(e,t){Td.prototype.bindBpmnModel.call(this,e,t);this.editorUi.graph.bpmnModel;this.addSignals(this.flowElement)},kd.prototype.addSignals=function(e){var t,r,i=e.Model;if(e.EventDefinitions&&0<e.EventDefinitions.length){i.signals||(i.signals=[]);try{for(var n=ue(e.EventDefinitions),o=n.next();!o.done;o=n.next())!function(e){var t=e;-1===i.signals.findIndex(function(e){return e.Name===t.SignalRef})&&((e=new B.Signal(i)).Name=t.SignalRef,i.signals.push(e))}(o.value)}catch(a){t={error:a}}finally{try{o&&!o.done&&(r=n["return"])&&r.call(n)}finally{if(t)throw t.error}}}},kd.prototype.getFarrisPropConfig=function(){var e=this.flowElement,t=new ce.ElementPropertyConfig,r=new ce.ElementPropertyConfig,i={};return t.categoryId="basicProperty",t.categoryName=pe.mxResources.get("basicInformation"),t.tabId="basic",t.tabName=pe.mxResources.get("basicAttributes"),t.properties=[{propertyID:ic,propertyName:pe.mxResources.get("name"),propertyType:"string",visible:!this.editorUi.multiLangEnabled},{propertyID:nc,propertyName:pe.mxResources.get("nameLanguage"),propertyType:"multiLanguage",visible:this.editorUi.multiLangEnabled},{propertyID:rc,propertyName:pe.mxResources.get("id"),propertyType:"string",readonly:!0}],r.categoryId="activityProperty",r.categoryName=pe.mxResources.get("activityProperty"),r.tabId="basic",r.tabName=pe.mxResources.get("basicAttributes"),r.properties=[{propertyID:sc,propertyName:pe.mxResources.get("eventDefinitions"),propertyType:"modal"},{propertyID:lc,propertyName:pe.mxResources.get("variableSettings"),propertyType:"modal"}],e.EventDefinitions&&this.isBackEventExist(e.EventDefinitions)&&(r.properties.push({propertyID:ac,propertyName:pe.mxResources.get("backWardRule"),propertyType:"modal"}),i[ac]=e.backWardRule),i[rc]=e.Id,i[oc]=e.ClrTypeID,i[ic]=e.Name,i[nc]=e.NameLanguage||{"zh-CHS":e.Name},i[sc]=e.EventDefinitions,i[lc]=S.getVariableSettings(e.Model,e.variableSettings),{propertyConfig:[t,r],propertyData:i}},kd.prototype.isBackEventExist=function(e){var t,r;try{for(var i=ue(e),n=i.next();!n.done;n=i.next())if("Back"===n.value.triggerAction)return!0}catch(o){t={error:o}}finally{try{n&&!n.done&&(r=i["return"])&&r.call(i)}finally{if(t)throw t.error}}return!1},kd.prototype.updateProps=function(e){var t=this.flowElement;switch(e.propertyID){case sc:this.updateEventDefinitions(t,e);break;case ac:this.updateBackWardRule(t,e);break;case lc:this.updateVariableSettings(t,e);break;default:Td.prototype.updateProps.call(this,e)}},kd.prototype.updateEventDefinitions=function(e,t){var r,i;if(e){this.removeSignals(e);t=t.propertyValue;e.EventDefinitions=new Array;try{for(var n=ue(t),o=n.next();!o.done;o=n.next()){var a=o.value,s=new de.SignalEventDefinitionImpl(e.Model);s.name=a.name,s.triggerAction=a.triggerAction,s.Async=!1,s.SignalRef=a.SignalRef,e.EventDefinitions.push(s)}}catch(l){r={error:l}}finally{try{o&&!o.done&&(i=n["return"])&&i.call(n)}finally{if(r)throw r.error}}this.addSignals(e)}this.isBackEventExist(e.EventDefinitions)?e.backWardRule||(e.backWardRule=new de.BackWardRule(e.Model)):e.backWardRule=null},kd.prototype.updateBackWardRule=function(e,t){var t=t.propertyValue,r=new de.BackWardRule(e.Model);r.TargetRef=t.TargetRef,r.SelectTargetAble=t.SelectTargetAble,r.WaitReturn=t.WaitReturn,r.ResubmitEffect=t.ResubmitEffect,r.DynamicBackWardRuleAble=t.DynamicBackWardRuleAble,r.SelectTargetList=t.SelectTargetList,e.backWardRule=r},kd.prototype.updateVariableSettings=function(e,t){var r,i,n,o,a,s=e.Model,l=s.DefaultProcess.GetExtensionElements();if(e.variableSettings&&0<e.variableSettings.length)try{for(var c=ue(e.variableSettings),p=c.next();!p.done;p=c.next())!function(t){var e;"component"===t.tag&&(e=l.findIndex(function(e){return e instanceof de.Component&&e.Id===t.value}),l.splice(e,1))}(f=p.value)}catch(P){r={error:P}}finally{try{p&&!p.done&&(d=c["return"])&&d.call(c)}finally{if(r)throw r.error}}e.variableSettings=new Array;var d=t.propertyValue;if(d&&0<d.length)try{for(var u=ue(d),m=u.next();!m.done;m=u.next()){var f=m.value,h=new de.VariableSetting(s);if(h.variableCode=f.variableCode,h.variableName=f.variableName,h.tag=f.tag,h.executionTime=f.executionTime,h.value=f.value,h.valueText=f.valueText,e.variableSettings.push(h),"component"===h.tag){var y=f.component;if(y){var g=new de.Component(s);if(g.MetadataId=y.MetadataId,g.MethodCode=y.MethodCode,g.Id=y.Id,g.Name=y.Name,g.ActualParameters=new Array,y.ActualParameters&&0<y.ActualParameters.length)try{for(var v=ue(y.ActualParameters),b=v.next();!b.done;b=v.next()){var x=b.value,w=new de.ActualParameter(s,x.Name,x.Value);w.Tag=x.Tag,g.ActualParameters.push(w)}}catch(C){o={error:C}}finally{try{b&&!b.done&&(a=v["return"])&&a.call(v)}finally{if(o)throw o.error}}l.push(g)}}}}catch(I){i={error:I}}finally{try{m&&!m.done&&(n=u["return"])&&n.call(u)}finally{if(i)throw i.error}}},kd.prototype.removeSignals=function(e){var t,r,i,n,o=e.Model;if(e.EventDefinitions&&0<e.EventDefinitions.length){var a,s=o.DefaultProcess.GetFlowElements(),l=new Map;for(a in s)if(s[a]instanceof de.IntermediateCatchEventImpl&&s[a].Id!==e.Id){var c=s[a];try{for(var p=ue(c.EventDefinitions),d=p.next();!d.done;d=p.next()){var u=d.value;l.get(u.SignalRef)||l.set(u.SignalRef,u)}}catch(h){t={error:h}}finally{try{d&&!d.done&&(r=p["return"])&&r.call(p)}finally{if(t)throw t.error}}}try{for(var m=ue(e.EventDefinitions),f=m.next();!f.done;f=m.next())!function(e){var t=e;l.get(t.SignalRef)||-1<(e=o.signals.findIndex(function(e){return e.Name===t.SignalRef}))&&o.signals.splice(e,1)}(f.value)}catch(y){i={error:y}}finally{try{f&&!f.done&&(n=m["return"])&&n.call(m)}finally{if(i)throw i.error}}}},kd.CLR_TYPE_ID=de.IntermediateCatchEventImpl.Clr_Type_ID;var Td,Ad=kd;function kd(e,t,r){e=Td.call(this,e,t,r)||this;return e.clrTypeId=kd.CLR_TYPE_ID,e.name="信号捕获",e.nameLanguage={"zh-CHS":"信号捕获","zh-CHT":"訊號捕獲",en:"Acquisition"},e.imgUrls=((t={})[B.FlowNodeState.Default]=I.IMAGE_PATH+"/catchEvent.png",t[B.FlowNodeState.Selected]=I.IMAGE_PATH+"/catchEvent_select.svg",t),e}n(Dd,Od=ce.NodeCell),Dd.prototype.createFlowElement=function(e){e=Od.prototype.createFlowElement.call(this,e);return e.Id="MessageActivity"+B.BpmnModelHelper.GenerateElementId(),e},Dd.prototype.getFarrisPropConfig=function(){var e=this.flowElement,t=new ce.ElementPropertyConfig,r=new ce.ElementPropertyConfig,i={};return t.categoryId="basicProperty",t.categoryName=pe.mxResources.get("basicInformation"),t.tabId="basic",t.tabName=pe.mxResources.get("basicAttributes"),t.properties=[{propertyID:uc,propertyName:pe.mxResources.get("name"),propertyType:"string",visible:!this.editorUi.multiLangEnabled},{propertyID:mc,propertyName:pe.mxResources.get("nameLanguage"),propertyType:"multiLanguage",visible:this.editorUi.multiLangEnabled},{propertyID:dc,propertyName:pe.mxResources.get("id"),propertyType:"string",readonly:!0}],r.categoryId="activityProperty",r.categoryName=pe.mxResources.get("activityProperty"),r.tabId="basic",r.tabName=pe.mxResources.get("basicAttributes"),r.properties=[{propertyID:hc,propertyName:pe.mxResources.get("messageNotice"),propertyType:"modal"},{propertyID:yc,propertyName:pe.mxResources.get("variableSettings"),propertyType:"modal"}],i[dc]=e.Id,i[fc]=e.ClrTypeID,i[uc]=e.Name,i[mc]=e.NameLanguage||{"zh-CHS":e.Name},i[hc]=S.getMessageNotices(e.messageNotices),i[yc]=S.getVariableSettings(e.Model,e.variableSettings),{propertyConfig:[t,r],propertyData:i}},Dd.prototype.updateProps=function(e){var t=this.flowElement;switch(e.propertyID){case hc:this.updateMessageNotices(t,e);break;case yc:this.updateVariableSettings(t,e);break;default:Od.prototype.updateProps.call(this,e)}},Dd.prototype.updateMessageNotices=function(e,t){var r,i,n,o,a,R,s,V,l=e.Model,t=t.propertyValue;if(e.messageNotices=new Array,t&&0<t.length)try{for(var c=ue(t),p=c.next();!p.done;p=c.next()){var d=p.value,u=new de.MessageNotice(l);if(u.sendType=d.sendType,u.sendTime=d.sendTime,u.subject=d.subject,u.content=d.content,d.smsMessageTemplate){var m=new de.SmsMessageTemplate(l);if(m.code=d.smsMessageTemplate.code,m.content=d.smsMessageTemplate.content,m.smsMessageVariables=new Array,d.smsMessageTemplate.smsMessageVariables&&0<d.smsMessageTemplate.smsMessageVariables.length)try{for(var f=ue(d.smsMessageTemplate.smsMessageVariables),h=f.next();!h.done;h=f.next()){var y=h.value,g=new de.SmsMessageVariable(l);g.code=y.code,g.value=y.value,g.tag=y.tag,m.smsMessageVariables.push(g)}}catch(D){n={error:D}}finally{try{h&&!h.done&&(o=f["return"])&&o.call(f)}finally{if(n)throw n.error}}u.smsMessageTemplate=m}if(d.receivers&&0<d.receivers.length){var v=d.receivers.filter(function(e){return"userParticipant"===e.type||"processParticipant"===e.type&&"activityExecutorParticipant"!==e.processParticipant}),b=d.receivers.filter(function(e){return"variableParticipant"===e.type||"positionParticipant"===e.type||"processParticipant"===e.type&&"activityExecutorParticipant"===e.processParticipant});if(v&&0<v.length){var x="",w="";try{for(var P=ue(v),C=P.next();!C.done;C=P.next()){var I=C.value;"processParticipant"===I.type?(x+=I.processParticipant+",","procInstCreator"===I.processParticipant?w+="流程发起人,":"workItemParticipant"===I.processParticipant&&(w+="任务接收人,")):"userParticipant"===I.type&&(x+=I.userIds+",",w+=I.userNames+",")}}catch(N){a={error:N}}finally{try{C&&!C.done&&(R=P["return"])&&R.call(P)}finally{if(a)throw a.error}}x=x&&x.substring(0,x.length-1),w=w&&w.substring(0,w.length-1),u.receiver=x,u.receiverText=w}if(b&&0<b.length){var S=new Array;try{for(var E=ue(b),T=E.next();!T.done;T=E.next()){var A,k,O,M=T.value;"processParticipant"===M.type&&((A=new de.ActivityExecutorParticipantExpression(e.Model)).id=B.BpmnModelHelper.GenerateElementId(),A.activityDefId=M.activityDefId,A.activityDefName=M.activityDefName,S.push(A)),"variableParticipant"===M.type&&((k=new de.UserParticipantExpression(e.Model,M.variableParticipant,M.variableName,M.orgType)).id=B.BpmnModelHelper.GenerateElementId(),k.Tag="expression",k.OrgType=M.orgType,S.push(k)),"positionParticipant"===M.type&&((O=new de.PositionParticipantExpression(e.Model,M.positionId,M.positionName)).id=B.BpmnModelHelper.GenerateElementId(),O.PositionType=M.positionType,"1"===M.positionType&&(O.OrgId=M.orgId,O.OrgType=M.orgType),S.push(O))}}catch(L){s={error:L}}finally{try{T&&!T.done&&(V=E["return"])&&V.call(E)}finally{if(s)throw s.error}}u.receiverExpressions=S}}e.messageNotices.push(u)}}catch(F){r={error:F}}finally{try{p&&!p.done&&(i=c["return"])&&i.call(c)}finally{if(r)throw r.error}}},Dd.prototype.updateVariableSettings=function(e,t){var r,i,n,o,a,s=e.Model,l=s.DefaultProcess.GetExtensionElements();if(e.variableSettings&&0<e.variableSettings.length)try{for(var c=ue(e.variableSettings),p=c.next();!p.done;p=c.next())!function(t){var e;"component"===t.tag&&(e=l.findIndex(function(e){return e instanceof de.Component&&e.Id===t.value}),l.splice(e,1))}(f=p.value)}catch(P){r={error:P}}finally{try{p&&!p.done&&(d=c["return"])&&d.call(c)}finally{if(r)throw r.error}}e.variableSettings=new Array;var d=t.propertyValue;if(d&&0<d.length)try{for(var u=ue(d),m=u.next();!m.done;m=u.next()){var f=m.value,h=new de.VariableSetting(s);if(h.variableCode=f.variableCode,h.variableName=f.variableName,h.tag=f.tag,h.executionTime=f.executionTime,h.value=f.value,h.valueText=f.valueText,e.variableSettings.push(h),"component"===h.tag){var y=f.component;if(y){var g=new de.Component(s);if(g.MetadataId=y.MetadataId,g.MethodCode=y.MethodCode,g.Id=y.Id,g.Name=y.Name,g.ActualParameters=new Array,y.ActualParameters&&0<y.ActualParameters.length)try{for(var v=ue(y.ActualParameters),b=v.next();!b.done;b=v.next()){var x=b.value,w=new de.ActualParameter(s,x.Name,x.Value);w.Tag=x.Tag,g.ActualParameters.push(w)}}catch(C){o={error:C}}finally{try{b&&!b.done&&(a=v["return"])&&a.call(v)}finally{if(o)throw o.error}}l.push(g)}}}}catch(I){i={error:I}}finally{try{m&&!m.done&&(n=u["return"])&&n.call(u)}finally{if(i)throw i.error}}},Dd.CLR_TYPE_ID=de.MessageActivity.Clr_Type_ID;var Od,Md=Dd;function Dd(e,t,r){e=Od.call(this,e,t,r)||this;return e.clrTypeId=Dd.CLR_TYPE_ID,e.name="消息",e.nameLanguage={"zh-CHS":"消息","zh-CHT":"消息",en:"Message"},e.imgUrls=((t={})[B.FlowNodeState.Default]=I.IMAGE_PATH+"/message.png",t[B.FlowNodeState.Selected]=I.IMAGE_PATH+"/message_select.svg",t),e}var Nd,Ld=function(){},Fd=function(){},Rd=function(){},Vd=function(){this.assignStrategy=new Rd,this.humanPerformerList=new Array,this.potentialOwnerList=new Array,this.isAllScope=!1},zd=function(){},Bd=(n(Ud,Nd=ce.NodeCell),Ud.prototype.createFlowElement=function(e){var t=Nd.prototype.createFlowElement.call(this,e);return t.Id="NotifyActivity"+B.BpmnModelHelper.GenerateElementId(),null==e&&(t.notifyAble=this.editorUi.generalConfig.enableNotify),t},Ud.prototype.getFarrisPropConfig=function(){var e,t,r,i,n,o,a=this.editorUi,s=this.flowElement,l=[],c=(a.procExtProps&&0<a.procExtProps.length&&JSON.parse(JSON.stringify(a.procExtProps)).forEach(function(e){e.propertyLocation&&-1!=e.propertyLocation.indexOf("activity")&&!e.parentId?l.push(e):e.propertyLocation&&-1!=e.propertyLocation.indexOf("activity")&&e.parentId}),l=l.sort(function(e,t){return e.sortOrder-t.sortOrder}),[]),a=(c=(c=a.procExtProps&&0<a.procExtProps.length?JSON.parse(JSON.stringify(a.procExtProps)).sort(function(e,t){return e.sortOrder-t.sortOrder}):c).sort(function(e,t){return e.sortOrder-t.sortOrder}),new ce.ElementPropertyConfig),p=new ce.ElementPropertyConfig,d={},u=(a.categoryId="basicProperty",a.categoryName=pe.mxResources.get("basicInformation"),a.tabId="basic",a.tabName=pe.mxResources.get("basicAttributes"),a.properties=[{propertyID:Ec,propertyName:pe.mxResources.get("name"),propertyType:"string",visible:!this.editorUi.multiLangEnabled},{propertyID:Tc,propertyName:pe.mxResources.get("nameLanguage"),propertyType:"multiLanguage",visible:this.editorUi.multiLangEnabled},{propertyID:Sc,propertyName:pe.mxResources.get("id"),propertyType:"string",readonly:!0}],new ce.ElementPropertyConfig),m=(u.categoryId="performerProperty",u.categoryName=pe.mxResources.get("performerProperty"),u.tabId="basic",u.tabName=pe.mxResources.get("basicAttributes"),u.properties=[{propertyID:kc,propertyName:pe.mxResources.get("notifyRecipient"),propertyType:"modal"}],new ce.ElementPropertyConfig),f=(m.categoryId="formDef",m.categoryName=pe.mxResources.get("formDef"),m.tabId="basic",m.tabName=pe.mxResources.get("basicAttributes"),m.properties=[{propertyID:Oc,propertyName:pe.mxResources.get("pcForm"),propertyType:"modal"},{propertyID:Mc,propertyName:pe.mxResources.get("webForm"),propertyType:"modal"}],new ce.ElementPropertyConfig),h=(f.categoryId="activityProperty",f.categoryName=pe.mxResources.get("activityProperty"),f.tabId="basic",f.tabName=pe.mxResources.get("basicAttributes"),f.properties=[{propertyID:Nc,propertyName:pe.mxResources.get("notifyAble"),propertyType:"modal"}],p.categoryId="advanced",p.categoryName=pe.mxResources.get("otherConfigurations"),p.tabId="advanced",p.tabName=pe.mxResources.get("advancedAttributes"),p.properties=[{propertyID:Dc,propertyName:pe.mxResources.get("messageNotice"),propertyType:"modal"}],new Array);try{for(var y=ue(c),g=y.next();!g.done;g=y.next()){var v=g.value;if(!v.parentId){var b={parent:v,childs:new Array};try{for(var x=ue(c),w=x.next();!w.done;w=x.next()){var P=w.value;P.parentId===v.id&&b.childs.push(P)}}catch(T){r={error:T}}finally{try{w&&!w.done&&(i=x["return"])&&i.call(x)}finally{if(r)throw r.error}}h.push(b)}}}catch(A){e={error:A}}finally{try{g&&!g.done&&(t=y["return"])&&t.call(y)}finally{if(e)throw e.error}}if(h&&0<h.length){var C=new ce.ElementPropertyConfig;C.categoryId="extendPropertyConfig",C.categoryName=pe.mxResources.get("extendPropertyConfig"),C.tabId="advanced",C.tabName=pe.mxResources.get("advancedAttributes"),C.properties=new Array;try{for(var I=ue(h),S=I.next();!S.done;S=I.next()){var E=S.value;C.properties.push({propertyID:E.parent.id,propertyName:E.parent.propertyTitle,propertyType:"modal"})}}catch(k){n={error:k}}finally{try{S&&!S.done&&(o=I["return"])&&o.call(I)}finally{if(n)throw n.error}}return this.setPropertyData(s,d,h),{propertyConfig:[a,u,m,f,p,C],propertyData:d}}return this.setPropertyData(s,d,h),{propertyConfig:[a,u,m,f,p],propertyData:d}},Ud.prototype.setPropertyData=function(e,t,r){var i,n;t[Sc]=e.Id,t[Ac]=e.ClrTypeID,t[Ec]=e.Name,t[Tc]=e.NameLanguage||{"zh-CHS":e.Name},t[kc]=this.getParticipantInfo(e),t[Dc]=S.getMessageNotices(e.messageNotices),t[Oc]=e.executeForms?e.executeForms.find(function(e){return"PC"===e.TerminalType}):null,t[Mc]=e.executeForms?e.executeForms.find(function(e){return"MOBILE"===e.TerminalType}):null,t[Nc]=S.getNotifyAble(e.notifyAble,e.dynamicParticipants);try{for(var o=ue(r),a=o.next();!a.done;a=o.next()){var s=a.value;e.extendProperties&&0<e.extendProperties.length&&s.childs.sort(function(e,t){return e.sortOrder-t.sortOrder}).forEach(function(t){e.extendProperties.forEach(function(e){e.key==t.code&&(t.value=e.value)})}),t[s.parent.id]=s.childs}}catch(l){i={error:l}}finally{try{a&&!a.done&&(n=o["return"])&&n.call(o)}finally{if(i)throw i.error}}},Ud.prototype.getParticipantInfo=function(e){var t=new Vd,e=e.GetResourceRoles().filter(function(e){return e instanceof de.HumanPerformerImpl});return t.humanPerformerList=S.getPerformerList(e),t},Ud.prototype.updateProps=function(e){var t=this.flowElement,r=this.editorUi,i=e.propertyID;switch(i){case kc:this.updateParticipant(t,e);break;case Dc:this.updateMessageNotices(t,e);break;case Oc:this.updateStartActivityForm(t,e,"PC"),e.parameters&&0<e.parameters.length&&S.updateFormalParameters(r.graph.bpmnModel.DefaultProcess,e.parameters);break;case Mc:this.updateStartActivityForm(t,e,"MOBILE"),e.parameters&&0<e.parameters.length&&S.updateFormalParameters(r.graph.bpmnModel.DefaultProcess,e.parameters);break;case Nc:this.updateNotifySet(t,e);break;default:-1<this.editorUi.procExtProps.findIndex(function(e){return e.id===i})?this.resetExtendProperty(t,e):Nd.prototype.updateProps.call(this,e)}},Ud.prototype.updateParticipant=function(t,e){var r,i,e=e.propertyValue,n=t.GetResourceRoles();if(n&&0<n.length&&n.forEach(function(e){e instanceof de.HumanPerformerImpl&&t.RemoveResourceRole(e.Id)}),e.humanPerformerList&&0<e.humanPerformerList.length)try{for(var o=ue(e.humanPerformerList),a=o.next();!a.done;a=o.next()){var s=a.value;switch(s.type){case de.UserParticipantExpression.Clr_Type_ID:this.addUserParticipant(t,s,"humanPerformer",null);break;case de.PositionParticipantExpression.Clr_Type_ID:this.addPositionParticipant(t,s,"humanPerformer",null);break;case de.VariableParticipantExpression.Clr_Type_ID:this.addVariableParticipant(t,s,"humanPerformer",null);break;case de.ComponentParticipantExpression.Clr_Type_ID:this.addComponentParticipant(t,s,"humanPerformer",null);break;case de.ReportingLineParticipantExpression.Clr_Type_ID:this.addReportingLineParticipant(t,s,"humanPerformer",null);break;case de.ActivityExecutorParticipantExpression.Clr_Type_ID:this.addActivityExecutorParticipant(t,s,"humanPerformer",null);break;case de.MatrixParticipantExpression.Clr_Type_ID:this.addMatrixParticipant(t,s,"humanPerformer",null)}}}catch(l){r={error:l}}finally{try{a&&!a.done&&(i=o["return"])&&i.call(o)}finally{if(r)throw r.error}}},Ud.prototype.addUserParticipant=function(e,t,r,i){var n,o,a=new de.UserParticipantExpression(e.Model,t.performerId,t.performerName,t.orgType);a.id=t.id,a.OrgId=t.orgId,a.OrgName=t.orgName,a.Tag=t.tag,a.OrgType=t.orgType,a.order=t.order,"humanPerformer"===r?((n=new de.HumanPerformerImpl(e.Model)).participantExpression=a,t.condition&&((o=new de.Condition(e.Model)).Value=t.condition,n.condition=o),n.order=t.order,e.AddResourceRole(n)):"potentialOwner"===r&&((n=new de.PotentialOwnerImpl(e.Model)).participantExpression=a,t.condition&&((o=new de.Condition(e.Model)).Value=t.condition,n.condition=o),n.order=t.order,i?(a.actionScope=i,e.dynamicParticipants.push(a)):e.AddResourceRole(n))},Ud.prototype.addVariableParticipant=function(e,t,r,i){var n,o,a=new de.VariableParticipantExpression(e.Model,t.performerId,t.performerName,t.orgType);a.id=t.id,a.Name=t.performerName||t.name,a.Tag=t.tag,a.VarValue=t.varValue,a.VarType=t.varType,a.Relation=t.relation,a.order=t.order,"humanPerformer"===r?((n=new de.HumanPerformerImpl(e.Model)).participantExpression=a,t.condition&&((o=new de.Condition(e.Model)).Value=t.condition,n.condition=o),n.order=t.order,e.AddResourceRole(n)):"potentialOwner"===r&&((n=new de.PotentialOwnerImpl(e.Model)).participantExpression=a,t.condition&&((o=new de.Condition(e.Model)).Value=t.condition,n.condition=o),n.order=t.order,i?(a.actionScope=i,e.dynamicParticipants.push(a)):e.AddResourceRole(n))},Ud.prototype.addPositionParticipant=function(e,t,r,i){var n,o,a=new de.PositionParticipantExpression(e.Model,t.performerId,t.performerName);a.id=t.id,a.PositionType=t.positionType,a.order=t.order,"1"===t.positionType&&(a.OrgId=t.orgId,a.OrgName=t.orgName,a.OrgType=t.orgType),"humanPerformer"===r?((n=new de.HumanPerformerImpl(e.Model)).participantExpression=a,t.condition&&((o=new de.Condition(e.Model)).Value=t.condition,n.condition=o),n.order=t.order,e.AddResourceRole(n)):"potentialOwner"===r&&((n=new de.PotentialOwnerImpl(e.Model)).participantExpression=a,t.condition&&((o=new de.Condition(e.Model)).Value=t.condition,n.condition=o),n.order=t.order,i?(a.actionScope=i,e.dynamicParticipants.push(a)):e.AddResourceRole(n))},Ud.prototype.addComponentParticipant=function(e,t,r,i){var n,o,a,s=new de.ComponentParticipantExpression(e.Model);if(s.id=t.id,s.componentId=t.metadataId,s.componentName=t.name,s.methodName=t.methodName,s.methodCode=t.methodCode,s.order=t.order,t.actualParameters&&0<t.actualParameters.length){var l=new Array;try{for(var c=ue(t.actualParameters),p=c.next();!p.done;p=c.next()){var d=p.value,u=new de.ActualParameter(e.Model,d.code,d.value,d.valueText);if(u.Tag=d.tag,d.fetchValueMode)switch(d.fetchValueMode){case"express":case"none":u.Tag="expression";break;default:u.Tag="constant"}l.push(u)}}catch(m){o={error:m}}finally{try{p&&!p.done&&(n=c["return"])&&n.call(c)}finally{if(o)throw o.error}}s.actualParameters=l}"humanPerformer"===r?((n=new de.HumanPerformerImpl(e.Model)).participantExpression=s,t.condition&&((a=new de.Condition(e.Model)).Value=t.condition,n.condition=a),n.order=t.order,e.AddResourceRole(n)):"potentialOwner"===r&&((o=new de.PotentialOwnerImpl(e.Model)).participantExpression=s,t.condition&&((a=new de.Condition(e.Model)).Value=t.condition,o.condition=a),o.order=t.order,i?(s.actionScope=i,e.dynamicParticipants.push(s)):e.AddResourceRole(o))},Ud.prototype.addReportingLineParticipant=function(e,t,r,i){var n,o,a=new de.ReportingLineParticipantExpression(e.Model);a.id=t.id,a.ReportingLineDefId=t.reportingLineDefId,a.ReportingLineDefName=t.reportingLineDefName,a.RefOrgId=t.refOrgId,a.RefUserId=t.refUserId,a.RefEmployeeId=t.refEmployeeId,a.order=t.order,a.Dimension=t.dimension,a.Tag=t.tag,"humanPerformer"===r?((n=new de.HumanPerformerImpl(e.Model)).participantExpression=a,t.condition&&((o=new de.Condition(e.Model)).Value=t.condition,n.condition=o),n.order=t.order,e.AddResourceRole(n)):"potentialOwner"===r&&((n=new de.PotentialOwnerImpl(e.Model)).participantExpression=a,t.condition&&((o=new de.Condition(e.Model)).Value=t.condition,n.condition=o),n.order=t.order,i?(a.actionScope=i,e.dynamicParticipants.push(a)):e.AddResourceRole(n))},Ud.prototype.addActivityExecutorParticipant=function(e,t,r,i){var n,o,a=new de.ActivityExecutorParticipantExpression(e.Model);a.id=t.id,a.activityDefId=t.activityDefId,a.order=t.order,a.activityDefName=t.activityDefName,"humanPerformer"===r?((n=new de.HumanPerformerImpl(e.Model)).participantExpression=a,t.condition&&((o=new de.Condition(e.Model)).Value=t.condition,n.condition=o),n.order=t.order,e.AddResourceRole(n)):"potentialOwner"===r&&((n=new de.PotentialOwnerImpl(e.Model)).participantExpression=a,t.condition&&((o=new de.Condition(e.Model)).Value=t.condition,n.condition=o),n.order=t.order,i?(a.actionScope=i,e.dynamicParticipants.push(a)):e.AddResourceRole(n))},Ud.prototype.addMatrixParticipant=function(e,t,r,i){var n,o,a=new de.MatrixParticipantExpression(e.Model);a.order=t.order,a.id=t.id,a.matrixDefId=t.matrixDefId,a.matrixDefName=t.matrixDefName,a.conditionField1=t.conditionField1,a.conditionFieldText1=t.conditionFieldText1,a.conditionField2=t.conditionField2,a.conditionFieldText2=t.conditionFieldText2,a.conditionField3=t.conditionField3,a.conditionFieldText3=t.conditionFieldText3,a.multivaluedCondition=t.multivaluedCondition,a.dataFieldAlias=t.dataFieldAlias,"humanPerformer"===r?((n=new de.HumanPerformerImpl(e.Model)).participantExpression=a,t.condition&&((o=new de.Condition(e.Model)).Value=t.condition,n.condition=o),n.order=t.order,e.AddResourceRole(n)):"potentialOwner"===r&&((n=new de.PotentialOwnerImpl(e.Model)).participantExpression=a,t.condition&&((o=new de.Condition(e.Model)).Value=t.condition,n.condition=o),n.order=t.order,i?(a.actionScope=i,e.dynamicParticipants.push(a)):e.AddResourceRole(n))},Ud.prototype.addOrganizationParticipant=function(e,t,r,i){var n,o,a=new de.OrganizationParticipantExpression(e.Model);a.id=t.id,a.order=t.order,a.actionScope=de.ActionScope.AssignUser,a.organizationLevel=t.organizationLevel,a.organizationId=t.organizationId,a.organizationName=t.organizationName,a.includeChildren=t.includeChildren,a.tag=t.tag,t.condition&&((o=new de.Condition(e.Model)).Value=t.condition,a.condition=o),"humanPerformer"===r?((n=new de.HumanPerformerImpl(e.Model)).participantExpression=a,t.condition&&((o=new de.Condition(e.Model)).Value=t.condition,n.condition=o),n.order=t.order,e.AddResourceRole(n)):"potentialOwner"===r&&((n=new de.PotentialOwnerImpl(e.Model)).participantExpression=a,t.condition&&((o=new de.Condition(e.Model)).Value=t.condition,n.condition=o),n.order=t.order,i?(a.actionScope=i,e.dynamicParticipants.push(a)):e.AddResourceRole(n))},Ud.prototype.updateStartActivityForm=function(e,t,r){var i;if(e){t=t.propertyValue;if(e.executeForms||(e.executeForms=new Array),e.executeForms=e.executeForms.filter(function(e){return e.TerminalType!==r}),t){var n=t.ActualParameters,o=new Array;if(n&&0<n.length)try{for(var a=ue(n),s=a.next();!s.done;s=a.next()){var l=s.value,c=new de.ActualParameter(e.Model,l.Name,l.Value);l.Tag?c.Tag=l.Tag:l.Value?8<=l.Value.length&&'{"expr":'===l.Value.slice(0,8)?c.Tag="expression":c.Tag="constant":c.Tag="variable",o.push(c)}}catch(d){i={error:d}}finally{try{s&&!s.done&&(p=a["return"])&&p.call(a)}finally{if(i)throw i.error}}var n=B.BpmnModelHelper.GenerateElementId(),p=new de.ExecuteForm(e.Model,n,t.Name,o);p.ComponentId=t.ComponentId,p.FormType=t.FormType,p.formFormatId=t.formFormatId,p.formatConfigId=t.formatConfigId,p.TerminalType=t.TerminalType,e.executeForms.push(p)}}},Ud.prototype.updateNotifySet=function(e,t){var r,i,t=t.propertyValue;if(e.dynamicParticipants=e.dynamicParticipants.filter(function(e){return e.actionScope!==de.ActionScope.Notify}),e.notifyAble=t.enable,t.scope)if(t.scope.organizationLevel){var n=new de.OrganizationParticipantExpression(e.Model);n.id=B.BpmnModelHelper.GenerateElementId(),n.actionScope=de.ActionScope.Notify,n.organizationLevel=t.scope.organizationLevel,n.organizationId=t.scope.organizationId,n.organizationName=t.scope.organizationName,n.includeChildren=t.scope.includeChildren,n.tag=t.scope.tag,e.dynamicParticipants.push(n)}else{n=t.scope.participantInfo;if(n.isAllScope&&n.potentialOwnerList&&0<n.potentialOwnerList.length)try{for(var o=ue(n.potentialOwnerList),a=o.next();!a.done;a=o.next()){var s=a.value;switch(s.type){case de.UserParticipantExpression.Clr_Type_ID:this.addUserParticipant(e,s,"potentialOwner",de.ActionScope.Notify);break;case de.VariableParticipantExpression.Clr_Type_ID:this.addVariableParticipant(e,s,"potentialOwner",de.ActionScope.Notify);break;case de.PositionParticipantExpression.Clr_Type_ID:this.addPositionParticipant(e,s,"potentialOwner",de.ActionScope.Notify);break;case de.ComponentParticipantExpression.Clr_Type_ID:this.addComponentParticipant(e,s,"potentialOwner",de.ActionScope.Notify);break;case de.ReportingLineParticipantExpression.Clr_Type_ID:this.addReportingLineParticipant(e,s,"potentialOwner",de.ActionScope.Notify);break;case de.ActivityExecutorParticipantExpression.Clr_Type_ID:this.addActivityExecutorParticipant(e,s,"potentialOwner",de.ActionScope.Notify);break;case de.MatrixParticipantExpression.Clr_Type_ID:this.addMatrixParticipant(e,s,"potentialOwner",de.ActionScope.Notify);break;case de.OrganizationParticipantExpression.Clr_Type_ID:this.addOrganizationParticipant(e,s,"potentialOwner",de.ActionScope.Notify)}}}catch(l){r={error:l}}finally{try{a&&!a.done&&(i=o["return"])&&i.call(o)}finally{if(r)throw r.error}}}},Ud.prototype.resetExtendProperty=function(r,e){var t,i;if(r){var n=e.propertyValue;r.extendProperties||(r.extendProperties=new Array);try{for(var o=ue(e.propertyValue),a=o.next();!a.done;a=o.next())!function(t){var e=r.extendProperties.findIndex(function(e){return e.key===t.code});-1<e&&r.extendProperties.splice(e,1)}(a.value)}catch(s){t={error:s}}finally{try{a&&!a.done&&(i=o["return"])&&i.call(o)}finally{if(t)throw t.error}}n&&n.forEach(function(e){var t=new de.ExtendProperty(r.Model);t.key=e.code,t.value=e.value,r.extendProperties.push(t)})}},Ud.prototype.updateMessageNotices=function(e,t){var r,i,n,o,a,R,s,V,l=e.Model,t=t.propertyValue;if(e.messageNotices=new Array,t&&0<t.length)try{for(var c=ue(t),p=c.next();!p.done;p=c.next()){var d=p.value,u=new de.MessageNotice(l);if(u.sendType=d.sendType,u.sendTime=d.sendTime,u.subject=d.subject,u.content=d.content,d.smsMessageTemplate){var m=new de.SmsMessageTemplate(l);if(m.code=d.smsMessageTemplate.code,m.content=d.smsMessageTemplate.content,m.smsMessageVariables=new Array,d.smsMessageTemplate.smsMessageVariables&&0<d.smsMessageTemplate.smsMessageVariables.length)try{for(var f=ue(d.smsMessageTemplate.smsMessageVariables),h=f.next();!h.done;h=f.next()){var y=h.value,g=new de.SmsMessageVariable(l);g.code=y.code,g.value=y.value,g.tag=y.tag,m.smsMessageVariables.push(g)}}catch(D){n={error:D}}finally{try{h&&!h.done&&(o=f["return"])&&o.call(f)}finally{if(n)throw n.error}}u.smsMessageTemplate=m}if(d.receivers=d.receivers.filter(function(e){return e.type}),d.receivers&&0<d.receivers.length){var v=d.receivers.filter(function(e){return"userParticipant"===e.type||"processParticipant"===e.type&&"activityExecutorParticipant"!==e.processParticipant}),b=d.receivers.filter(function(e){return"variableParticipant"===e.type||"positionParticipant"===e.type||"processParticipant"===e.type&&"activityExecutorParticipant"===e.processParticipant});if(v&&0<v.length){var x="",w="";try{for(var P=ue(v),C=P.next();!C.done;C=P.next()){var I=C.value;"processParticipant"===I.type?(x+=I.processParticipant+",","procInstCreator"===I.processParticipant?w+="流程发起人,":"workItemParticipant"===I.processParticipant&&(w+="任务接收人,")):"userParticipant"===I.type&&(x+=I.userIds+",",w+=I.userNames+",")}}catch(N){a={error:N}}finally{try{C&&!C.done&&(R=P["return"])&&R.call(P)}finally{if(a)throw a.error}}x=x&&x.substring(0,x.length-1),w=w&&w.substring(0,w.length-1),u.receiver=x,u.receiverText=w}if(b&&0<b.length){var S=new Array;try{for(var E=ue(b),T=E.next();!T.done;T=E.next()){var A,k,O,M=T.value;"processParticipant"===M.type&&((A=new de.ActivityExecutorParticipantExpression(e.Model)).id=B.BpmnModelHelper.GenerateElementId(),A.activityDefId=M.activityDefId,A.activityDefName=M.activityDefName,S.push(A)),"variableParticipant"===M.type&&((k=new de.UserParticipantExpression(e.Model,M.variableParticipant,M.variableName,M.orgType)).id=B.BpmnModelHelper.GenerateElementId(),k.Tag="expression",k.OrgType=M.orgType,S.push(k)),"positionParticipant"===M.type&&((O=new de.PositionParticipantExpression(e.Model,M.positionId,M.positionName)).id=B.BpmnModelHelper.GenerateElementId(),O.PositionType=M.positionType,"1"===M.positionType&&(O.OrgId=M.orgId,O.OrgType=M.orgType),S.push(O))}}catch(L){s={error:L}}finally{try{T&&!T.done&&(V=E["return"])&&V.call(E)}finally{if(s)throw s.error}}u.receiverExpressions=S}}e.messageNotices.push(u)}}catch(F){r={error:F}}finally{try{p&&!p.done&&(i=c["return"])&&i.call(c)}finally{if(r)throw r.error}}},Ud.CLR_TYPE_ID=de.NotifyActivity.Clr_Type_ID,Ud);function Ud(e,t,r){e=Nd.call(this,e,t,r)||this;return e.clrTypeId=Ud.CLR_TYPE_ID,e.name="知会",e.nameLanguage={"zh-CHS":"知会","zh-CHT":"知會",en:"Notify"},e.imgUrls=((t={})[B.FlowNodeState.Default]=I.IMAGE_PATH+"/notify.png",t[B.FlowNodeState.Selected]=I.IMAGE_PATH+"/notify_backup.png",t),e}n(T,jd=ce.NodeCell),T.prototype.createFlowElement=function(e){var t,r,i,n,o=jd.prototype.createFlowElement.call(this,e),a=this.editorUi,s=a.graph.bpmnModel;if(o.Id="UserActivity"+B.BpmnModelHelper.GenerateElementId(),null==e)if(o.transferAble=a.generalConfig.enableTransfer,o.AddSignBehindAble=a.generalConfig.enableAddSignBehind,o.AddSignFrontAble=a.generalConfig.enableAddSignFront,o.NotifyAble=a.generalConfig.enableNotify,this.bizActivity){e=this.bizActivity;o.BizActivityID=e.id,o.BizActivityName=e.name,o.Tools=[];try{for(var l=ue(e.bizComponents),c=l.next();!c.done;c=l.next()){var p=c.value,d=new de.Component(o.Model);if(d.Id=p.id,d.Name=p.name,d.Time=p.executionTime,d.ComponentType="CommonComponent",d.MetadataId=p.metadataId,d.MethodCode=p.methodCode,d.ActualParameters=[],p.actualParameters&&0<p.actualParameters.length)try{for(var u=ue(p.actualParameters),m=u.next();!m.done;m=u.next()){var f=m.value,h=new de.ActualParameter(s,f.code,f.value);d.ActualParameters.push(h)}}catch(y){i={error:y}}finally{try{m&&!m.done&&(n=u["return"])&&n.call(u)}finally{if(i)throw i.error}}o.Tools.push(d)}}catch(g){t={error:g}}finally{try{c&&!c.done&&(r=l["return"])&&r.call(l)}finally{if(t)throw t.error}}o.setBizConclusions(s,e.bizActions)}else o.BizActivityID="",o.initConclusions(s);return o},T.prototype.createDiagramElement=function(){var e;return null!=this.bizActivity&&(this.imgUrls=((e={})[B.FlowNodeState.Default]=I.IMAGE_PATH+"/bizActivity.png",e[B.FlowNodeState.Selected]=I.IMAGE_PATH+"/bizActivity_select.svg",e)),jd.prototype.createDiagramElement.call(this)},T.prototype.getFarrisPropConfig=function(){return this.getFarrisPropConfigByIsOperation()},T.prototype.getFarrisPropConfigByIsOperation=function(e){void 0===e&&(e=!1);var t,r,i,n,o,a,s=this.editorUi,l=[],c=(l=(l=s.procExtProps&&0<s.procExtProps.length?JSON.parse(JSON.stringify(s.procExtProps)).sort(function(e,t){return e.sortOrder-t.sortOrder}):l).sort(function(e,t){return e.sortOrder-t.sortOrder}),this.flowElement),p=new ce.ElementPropertyConfig,d={},u=(p.categoryId="basicProperty",p.categoryName=pe.mxResources.get("basicInformation"),p.tabId="basic",p.tabName=pe.mxResources.get("basicAttributes"),p.properties=[{propertyID:as,propertyName:pe.mxResources.get("name"),propertyType:"string",visible:!this.editorUi.multiLangEnabled},{propertyID:ss,propertyName:pe.mxResources.get("nameLanguage"),propertyType:"multiLanguage",visible:this.editorUi.multiLangEnabled},{propertyID:os,propertyName:pe.mxResources.get("id"),propertyType:"string",readonly:!0},{propertyID:Ss,propertyName:pe.mxResources.get("wfTitleExpression"),propertyType:"modal"}],new ce.ElementPropertyConfig),m=(u.categoryId="performerProperty",u.categoryName=pe.mxResources.get("participant"),u.tabId="basic",u.tabName=pe.mxResources.get("basicAttributes"),u.properties=[{propertyID:cs,propertyName:pe.mxResources.get("participantSchemes"),propertyType:"modal"},{propertyID:ps,propertyName:pe.mxResources.get("participantOptions"),propertyType:"modal"}],e||(c.ExecuteWorkItemMode===de.ExecuteWorkItemMode.Preempt?(u.properties.push({propertyID:ms,propertyName:pe.mxResources.get("completeStrategy"),propertyType:"select"}),d[ms]=c.ExecuteWorkItemMode):(u.properties=u.properties.concat([{propertyID:ms,propertyName:pe.mxResources.get("completeStrategy"),propertyType:"select"},{propertyID:fs,propertyName:pe.mxResources.get("signRule"),propertyType:"modal"}]),d[ms]=c.ExecuteWorkItemMode,d[fs]=c.CounterSignRules)),new ce.ElementPropertyConfig),e=(m.categoryId="approvalProperty",m.categoryName=pe.mxResources.get("operationsManage"),m.tabId="approvalProperty",m.tabName=pe.mxResources.get("operationsConfig"),m.properties=[{propertyID:ds,propertyName:pe.mxResources.get("approvalItems"),propertyType:"modal"},{propertyID:Us,propertyName:pe.mxResources.get("wfCustomizeAction"),propertyType:"modal"}],c.Conclusions&&this.isBackConclusionExist(c.Conclusions)&&(m.properties.push({propertyID:Ps,propertyName:pe.mxResources.get("backWardRule"),propertyType:"modal"}),d[Ps]=c.BackWardRule),m.properties=m.properties.concat([{propertyID:ys,propertyName:pe.mxResources.get("retrievable"),propertyType:"select"}]),e||(m.properties=m.properties.concat([{propertyID:gs,propertyName:pe.mxResources.get("addSignFrontAble"),propertyType:"modal"},{propertyID:vs,propertyName:pe.mxResources.get("addSignBehindAble"),propertyType:"modal"}])),s.generalConfig.enableTransfer&&(m.properties=m.properties.concat([{propertyID:Ts,propertyName:pe.mxResources.get("transferScope"),propertyType:"modal"}])),m.properties=m.properties.concat([{propertyID:bs,propertyName:pe.mxResources.get("notifyAble"),propertyType:"modal"},{propertyID:Rs,propertyName:pe.mxResources.get("urgeHandleRule"),propertyType:"modal"}]),c.SelectTargetAble?(m.properties=m.properties.concat([{propertyID:xs,propertyName:pe.mxResources.get("selectTargetAble"),propertyType:"select"},{propertyID:ws,propertyName:pe.mxResources.get("jumpScope"),propertyType:"modal"}]),d[xs]=c.SelectTargetAble,d[ws]=c.JumpScope):(m.properties=m.properties.concat([{propertyID:xs,propertyName:pe.mxResources.get("selectTargetAble"),propertyType:"select"}]),d[xs]=c.SelectTargetAble),c.otherAssignNodes?(m.properties=m.properties.concat([{propertyID:js,propertyName:pe.mxResources.get("otherAssignNodes"),propertyType:"select"},{propertyID:_s,propertyName:pe.mxResources.get("otherAssignActivityNodeInfos"),propertyType:"modal"}]),d[js]=!0,d[_s]=c.otherAssignNodes.otherAssignActivityNodeInfos||c.otherAssignNodes.otherAssignActivityNodeInfos,c.otherAssignNodes.otherAssignActivities&&(c.otherAssignNodes.otherAssignActivities=null)):(m.properties=m.properties.concat([{propertyID:js,propertyName:pe.mxResources.get("otherAssignNodes"),propertyType:"select"}]),d[js]=!1),new ce.ElementPropertyConfig),s=(e.categoryId="eventListeners",e.categoryName=pe.mxResources.get("eventListeners"),e.tabId="advanced",e.tabName=pe.mxResources.get("advancedAttributes"),e.properties=[{propertyID:Cs,propertyName:pe.mxResources.get("tools"),propertyType:"modal"},{propertyID:zs,propertyName:pe.mxResources.get("checkConditions"),propertyType:"modal"},{propertyID:Ms,propertyName:pe.mxResources.get("variableSettings"),propertyType:"modal"}],new ce.ElementPropertyConfig),f=(s.categoryId="ApprovalSettings",s.categoryName=pe.mxResources.get("approvalSettings"),s.tabId="advanced",s.tabName=pe.mxResources.get("advancedAttributes"),s.properties=[{propertyID:Os,propertyName:pe.mxResources.get("anonymousSet"),propertyType:"modal"},{propertyID:Fs,propertyName:pe.mxResources.get("approvalPivotConfig"),propertyType:"modal"},{propertyID:Vs,propertyName:pe.mxResources.get("imageSettings"),propertyType:"modal"},{propertyID:hs,propertyName:pe.mxResources.get("multiInstanceLoopCharacteristics"),propertyType:"modal"}],d[hs]=c.LoopCharacteristics,new ce.ElementPropertyConfig),h=(f.categoryId="taskTimeliness",f.categoryName=pe.mxResources.get("taskTimeliness"),f.tabId="advanced",f.tabName=pe.mxResources.get("advancedAttributes"),f.properties=[{propertyID:ks,propertyName:pe.mxResources.get("timeLimitControl"),propertyType:"modal"},{propertyID:Ds,propertyName:pe.mxResources.get("messageNotice"),propertyType:"modal"}],new ce.ElementPropertyConfig),y=(h.categoryId="formDef",h.categoryName=pe.mxResources.get("formDef"),h.tabId="basic",h.tabName=pe.mxResources.get("basicAttributes"),h.properties=[{propertyID:As,propertyName:pe.mxResources.get("displayTerminal"),propertyType:"select"},{propertyID:Ns,propertyName:pe.mxResources.get("pcForm"),propertyType:"modal"},{propertyID:Ls,propertyName:pe.mxResources.get("webForm"),propertyType:"modal"}],new Array);try{for(var g=ue(l),v=g.next();!v.done;v=g.next()){var b=v.value;if(!b.parentId){var x={parent:b,childs:new Array};try{for(var w=ue(l),P=w.next();!P.done;P=w.next()){var C=P.value;C.parentId===b.id&&x.childs.push(C)}}catch(A){i={error:A}}finally{try{P&&!P.done&&(n=w["return"])&&n.call(w)}finally{if(i)throw i.error}}y.push(x)}}}catch(k){t={error:k}}finally{try{v&&!v.done&&(r=g["return"])&&r.call(g)}finally{if(t)throw t.error}}if(y&&0<y.length){var I=new ce.ElementPropertyConfig;I.categoryId="extendPropertyConfig",I.categoryName=pe.mxResources.get("extendPropertyConfig"),I.tabId="advanced",I.tabName=pe.mxResources.get("advancedAttributes"),I.properties=new Array;try{for(var S=ue(y),E=S.next();!E.done;E=S.next()){var T=E.value;I.properties.push({propertyID:T.parent.id,propertyName:T.parent.propertyTitle,propertyType:"modal"})}}catch(O){o={error:O}}finally{try{E&&!E.done&&(a=S["return"])&&a.call(S)}finally{if(o)throw o.error}}return this.setPropertyData(c,d,y),{propertyConfig:[p,u,h,m,e,f,s,I],propertyData:d}}return this.setPropertyData(c,d,y),{propertyConfig:[p,u,h,m,e,f,s],propertyData:d}},T.prototype.isBackConclusionExist=function(e){var t,r;try{for(var i=ue(e),n=i.next();!n.done;n=i.next())if(n.value.WorkFlowAction===de.WorkFlowAction.Backward)return!0}catch(o){t={error:o}}finally{try{n&&!n.done&&(r=i["return"])&&r.call(i)}finally{if(t)throw t.error}}return!1},T.prototype.setPropertyData=function(e,t,r){var i,n;t[os]=e.Id,t[ls]=e.ClrTypeID,t[as]=e.Name,t[ss]=e.NameLanguage||{"zh-CHS":e.Name},t[qs]=e.BizActivityID,t[Ms]=S.getVariableSettings(e.Model,e.variableSettings),t[cs]=this.getParticipantInfo(e),t[ps]=this.getParticipantOptions(e),t[ds]=e.Conclusions,t[Cs]=S.getBizComponentList(e.Tools),t[Us]=e.customizeActions||[],t[us]=this.getAssignStrategy(e),t[ys]=e.Retrievable,t[Is]=e.SelectBranch,t[gs]=this.getSignFrontInfo(e),t[vs]=this.getSignBehindInfo(e),t[Ts]=this.getTransferScopeInfo(e),t[bs]=this.getNotifyAble(e),t[ks]=this.getTimeLimitInfo(e),t[Ss]=e.taskTitle?e.taskTitle.valueLanguage||e.taskTitle.value:"",t[Os]={isAnonymity:e.anonymous,anonymous:e.anonymousText},t[Ds]=S.getMessageNotices(e.messageNotices),t[Vs]=e.imageSettings,t[Ns]=e.ExecuteForms?e.ExecuteForms.find(function(e){return"PC"===e.TerminalType}):null,t[Ls]=e.ExecuteForms?e.ExecuteForms.find(function(e){return"MOBILE"===e.TerminalType}):null,t[Fs]=e.approvalPivotConfig,t[As]=e.DisplayTerminal||de.DisplayTerminal.ALL,t[Rs]=this.getUrgeHandleRule(e);try{for(var o=ue(r),a=o.next();!a.done;a=o.next()){var s=a.value;e.extendProperties&&0<e.extendProperties.length&&s.childs.sort(function(e,t){return e.sortOrder-t.sortOrder}).forEach(function(t){e.extendProperties.forEach(function(e){e.key==t.code&&(t.value=e.value)})}),t[s.parent.id]=s.childs}}catch(l){i={error:l}}finally{try{a&&!a.done&&(n=o["return"])&&n.call(o)}finally{if(i)throw i.error}}t[zs]=this.getCheckConditions(e)},T.prototype.getParticipantInfo=function(e){var t=new Vd,r=(t.assignStrategy.assignStrategy=e.AssignmentStrategy,e.GetResourceRoles().filter(function(e){return e instanceof de.HumanPerformerImpl}));return t.humanPerformerList=S.getPerformerList(r),e.AssignmentStrategy===de.AssignmentStrategy.ASSIGN&&(e.AssignPerformerConfig&&((r=new Fd).operator=e.AssignPerformerConfig.Operator,r.multiSelect=e.AssignPerformerConfig.MultiSelect,r.necessary=e.AssignPerformerConfig.Necessary,t.assignStrategy.assignConfig=r,t.isAllScope=e.AssignPerformerConfig.AllowGlobalAssign),r=e.GetResourceRoles().filter(function(e){return e instanceof de.PotentialOwnerImpl}),t.potentialOwnerList=S.getPerformerList(r)),t},T.prototype.getParticipantOptions=function(e){var t={};return null!=e.ParticipantSetting&&(t.ExclusionPerformers=e.ParticipantSetting.ExclusionPerformers,t.NoPerformerStrategy=e.ParticipantSetting.NoPerformerStrategy,t.HistoricFirst=e.ParticipantSetting.HistoricFirst,t.automaticPerformers=e.ParticipantSetting.automaticPerformers),t},T.prototype.getAssignStrategy=function(e){var t,r=new Rd;return r.assignStrategy=e.AssignmentStrategy,e.AssignPerformerConfig&&((t=new Fd).operator=e.AssignPerformerConfig.Operator,t.multiSelect=e.AssignPerformerConfig.MultiSelect,t.necessary=e.AssignPerformerConfig.Necessary,r.assignConfig=t),r},T.prototype.getSignFrontInfo=function(e){var t,r,i,n=new Lo;return n.action=de.ActionScope.AddSignFront,e.AddSignFrontAble?(n.enable=!0,r=[],(t=(e=e.dynamicParticipants.filter(function(e){return e.actionScope===de.ActionScope.AddSignFront})).find(function(e){return e.organizationLevel&&!e.order}))?((i=new id).id=t.id,i.type=t.ClrTypeID,i.name=t.name,i.actionScope=t.actionScope,i.organizationLevel=t.organizationLevel,i.organizationId=t.organizationId,i.organizationCode=t.organizationCode,i.organizationName=t.organizationName,i.includeChildren=t.includeChildren,i.parentsUntil=t.parentsUntil,i.tag=t.tag,i.order=1,r.push(i)):r=S.getPerformerListTest(e),n.scope=new Fo,r&&0<r.length?(n.scope.participantInfo=new Vd,n.scope.participantInfo.potentialOwnerList=r,n.scope.participantInfo.isAllScope=!0):(n.scope.participantInfo=new Vd,n.scope.participantInfo.isAllScope=!1)):n.enable=!1,n},T.prototype.getSignBehindInfo=function(e){var t,r,i,n=new Lo;return n.action=de.ActionScope.AddSignBehind,e.AddSignBehindAble?(n.enable=!0,r=[],(t=(e=e.dynamicParticipants.filter(function(e){return e.actionScope===de.ActionScope.AddSignBehind})).find(function(e){return e.organizationLevel&&!e.order}))?((i=new id).id=t.id,i.type=t.ClrTypeID,i.name=t.name,i.actionScope=t.actionScope,i.organizationLevel=t.organizationLevel,i.organizationId=t.organizationId,i.organizationCode=t.organizationCode,i.organizationName=t.organizationName,i.includeChildren=t.includeChildren,i.parentsUntil=t.parentsUntil,i.tag=t.tag,i.order=1,r.push(i)):r=S.getPerformerListTest(e),n.scope=new Fo,r&&0<r.length?(n.scope.participantInfo=new Vd,n.scope.participantInfo.potentialOwnerList=r,n.scope.participantInfo.isAllScope=!0):(n.scope.participantInfo=new Vd,n.scope.participantInfo.isAllScope=!1)):n.enable=!1,n},T.prototype.getTransferScopeInfo=function(e){var t,r,i,n,o=new Lo;return o.action=de.ActionScope.Transfer,e.transferAble?(o.enable=!0,i=[],(r=(t=e.dynamicParticipants.filter(function(e){return e.actionScope===de.ActionScope.Transfer})).find(function(e){return e.organizationLevel&&!e.order}))?((n=new id).id=r.id,n.type=r.ClrTypeID,n.name=r.name,n.actionScope=r.actionScope,n.organizationLevel=r.organizationLevel,n.organizationId=r.organizationId,n.organizationCode=r.organizationCode,n.organizationName=r.organizationName,n.includeChildren=r.includeChildren,n.parentsUntil=r.parentsUntil,n.tag=r.tag,n.order=1,i.push(n)):i=S.getPerformerListTest(t),o.scope=new Fo,i&&0<i.length?(o.scope.participantInfo=new Vd,o.scope.participantInfo.potentialOwnerList=i,o.scope.participantInfo.isAllScope=!0):(o.scope.participantInfo=new Vd,o.scope.participantInfo.isAllScope=!1)):o.enable=e.transferAble,o},T.prototype.getNotifyAble=function(e){var t,r,i,n,o=new Lo;return o.action=de.ActionScope.Notify,e.NotifyAble?(o.enable=!0,i=[],(r=(t=e.dynamicParticipants.filter(function(e){return e.actionScope===de.ActionScope.Notify})).find(function(e){return e.organizationLevel&&!e.order}))?((n=new id).id=r.id,n.type=r.ClrTypeID,n.name=r.name,n.actionScope=r.actionScope,n.organizationLevel=r.organizationLevel,n.organizationId=r.organizationId,n.organizationCode=r.organizationCode,n.organizationName=r.organizationName,n.includeChildren=r.includeChildren,n.parentsUntil=r.parentsUntil,n.tag=r.tag,n.order=1,i.push(n)):i=S.getPerformerListTest(t),o.scope=new Fo,i&&0<i.length?(o.scope.participantInfo=new Vd,o.scope.participantInfo.potentialOwnerList=i,o.scope.participantInfo.isAllScope=!0):(o.scope.participantInfo=new Vd,o.scope.participantInfo.isAllScope=!1)):o.enable=e.NotifyAble,o},T.prototype.getTimeLimitInfo=function(e){var t,r,i,n;if(e.timeLimitControl){var o=new de.TimeLimitControlInfo;if(o.enable=e.timeLimitControl.enable,o.tag=e.timeLimitControl.tag,o.dueTime=e.timeLimitControl.dueTime,o.timeUnit=e.timeLimitControl.timeUnit,o.expireOperations=new Array,e.timeLimitControl.expireOperations&&0<e.timeLimitControl.expireOperations.length){e=e.timeLimitControl.expireOperations;try{for(var a=ue(e),s=a.next();!s.done;s=a.next()){var l,c=s.value;if(0<c.ClrTypeID.indexOf("SendMessageExpireOperation")){var p=c,d=new de.SendMessageExpireOperationInfo;if(d.timeDuration=p.timeDuration,d.durationType=p.durationType,d.timeUnit=p.timeUnit,d.message=p.message,d.sendType=p.sendType,d.subject=p.subject,d.id=p.id,d.receiver=p.receiver,d.cycleEnable=p.cycleEnable,d.cycleTime=p.cycleTime,d.cycleTimeUnit=p.cycleTimeUnit,d.operationTypeName=p.operationTypeName||"SendMessageExpireOperation",p.smsMessageTemplate){var u=new Object;if(u.code=p.smsMessageTemplate.code,u.content=p.smsMessageTemplate.content,u.smsMessageVariables=new Array,p.smsMessageTemplate.smsMessageVariables&&0<p.smsMessageTemplate.smsMessageVariables.length)try{for(var m=ue(p.smsMessageTemplate.smsMessageVariables),f=m.next();!f.done;f=m.next()){var h=f.value,y=new Object;y.id=Dp.createNM(),y.code=h.code,y.value=h.value,y.tag=h.tag,u.smsMessageVariables.push(y)}}catch(g){i={error:g}}finally{try{f&&!f.done&&(n=m["return"])&&n.call(m)}finally{if(i)throw i.error}}d.smsMessageTemplate=u}o.expireOperations.push(d)}else 0<c.ClrTypeID.indexOf("AutoHandleExpireOperation")&&(p=c,(l=new de.AutoHandleExpireOperationInfo).id=p.id,l.durationType=p.durationType,l.timeDuration=p.timeDuration,l.timeUnit=p.timeUnit,l.operationTypeName=p.operationTypeName||"AutoHandleExpireOperation",l.autoHandleType=p.autoHandleType,l.message=p.message,o.expireOperations.push(l))}}catch(v){t={error:v}}finally{try{s&&!s.done&&(r=a["return"])&&r.call(a)}finally{if(t)throw t.error}}}return o}return null},T.prototype.getUrgeHandleRule=function(e){var t,r;if(!e.urgeHandleRule)return null;var e=e.urgeHandleRule,i={urgeHandleAble:e.urgeHandleAble,sendType:e.sendType,earlyTime:e.earlyTime,intervalTime:e.intervalTime,urgeMessageSubject:e.urgeMessageSubject,urgeMessageContent:e.urgeMessageContent,addReminder:e.addReminder,subjectEditable:e.subjectEditable,contentEditable:e.contentEditable};if(e.smsMessageTemplate){var n=new Object;if(n.code=e.smsMessageTemplate.code,n.content=e.smsMessageTemplate.content,n.smsMessageVariables=new Array,e.smsMessageTemplate.smsMessageVariables&&0<e.smsMessageTemplate.smsMessageVariables.length)try{for(var o=ue(e.smsMessageTemplate.smsMessageVariables),a=o.next();!a.done;a=o.next()){var s=a.value,l=new Object;l.id=Dp.createNM(),l.code=s.code,l.value=s.value,l.tag=s.tag,n.smsMessageVariables.push(l)}}catch(c){t={error:c}}finally{try{a&&!a.done&&(r=o["return"])&&r.call(o)}finally{if(t)throw t.error}}i.smsMessageTemplate=n}return i},T.prototype.getCheckConditions=function(e){return e.checkConditions&&0<e.checkConditions.length?e.checkConditions.map(function(e){return{value:e.value,checkTime:e.checkTime,errorTips:e.errorTips?Array.from(e.errorTips).reduce(function(e,t){var t=Ye(t,2),r=t[0],t=t[1];return Object.assign(e,((e={})[r]=t,e))},{}):null}}):null},T.prototype.updateProps=function(e){this.updatePropsByIsOperation(e)},T.prototype.updatePropsByIsOperation=function(e,t){void 0===t&&(t=!1);var r=this.editorUi,i=this.flowElement,n=e.propertyID;switch(n){case cs:this.updateParticipant(i,e,t);break;case ps:this.updateParticipantOptions(i,e);break;case ms:this.resetExecuteWorkItemMode(i,e,t);break;case As:this.resetDisplayTerminal(i,e);break;case fs:this.resetSignRules(i,e,t);break;case ds:this.resetApprovalItems(i,e,t);break;case Ns:this.resetExecuteForm(i,e,"PC"),e.parameters&&0<e.parameters.length&&S.updateFormalParameters(r.graph.bpmnModel.DefaultProcess,e.parameters);break;case Ls:this.resetExecuteForm(i,e,"MOBILE"),e.parameters&&0<e.parameters.length&&S.updateFormalParameters(r.graph.bpmnModel.DefaultProcess,e.parameters);break;case xs:this.resetSelectTargetAble(i,e,t);break;case ws:this.resetJumpScope(i,e);break;case Ps:this.resetBackWardRule(i,e);break;case hs:this.resetMultiInstanceLoopCharacteristics(i,e);break;case Cs:this.resetTools(i,e);break;case Ss:this.modifyTitleExpression(i,e);break;case gs:this.updateSignFrontSet(i,e);break;case vs:this.updateSignBehindsSet(i,e);break;case bs:this.updateNotifySet(i,e);break;case Ts:this.updateTransferScope(i,e);break;case Us:this.updateCustomizeActions(i,e);break;case ks:this.updateTimeLimitControl(i,e);break;case Os:this.updateAnonymousSet(i,e);break;case Ms:this.updateVariableSettings(i,e);break;case Ds:this.updateMessageNotices(i,e);break;case Fs:this.updateApprovalPivotConfig(i,e);break;case Rs:this.updateUrgeHandleRule(i,e);break;case Vs:this.updateImageSettings(i,e);break;case zs:this.updateCheckConditions(i,e,t);break;case Hs:case _s:this.updateOtherAssignActivities(i,e);break;case js:this.updateOtherAssignNodes(i,e);break;default:-1<r.procExtProps.findIndex(function(e){return e.id===n})?this.resetExtendProperty(i,e):jd.prototype.updateProps.call(this,e)}},T.prototype.updateParticipant=function(t,e,r){void 0===r&&(r=!1);var i,n,o,a,r=e.propertyValue;if(!(r.assignStrategy.assignStrategy===de.AssignmentStrategy.CLAIM&&t.ParticipantSetting&&t.ParticipantSetting.automaticPerformers&&0<t.ParticipantSetting.automaticPerformers.length)){this.checkOtherAssignNodes(t,r),t.AssignPerformerConfig=null,t.AssignmentStrategy=r.assignStrategy.assignStrategy;e=t.GetResourceRoles();if(e&&0<e.length&&e.forEach(function(e){(e instanceof de.HumanPerformerImpl||e instanceof de.PotentialOwnerImpl)&&t.RemoveResourceRole(e.Id)}),r.humanPerformerList&&0<r.humanPerformerList.length)try{for(var s=ue(r.humanPerformerList),l=s.next();!l.done;l=s.next()){var c=l.value;switch(c.type){case de.UserParticipantExpression.Clr_Type_ID:this.addUserParticipant(t,c,"humanPerformer",null);break;case de.VariableParticipantExpression.Clr_Type_ID:this.addVariableParticipant(t,c,"humanPerformer",null);break;case de.PositionParticipantExpression.Clr_Type_ID:this.addPositionParticipant(t,c,"humanPerformer",null);break;case de.ComponentParticipantExpression.Clr_Type_ID:this.addComponentParticipant(t,c,"humanPerformer",null);break;case de.ReportingLineParticipantExpression.Clr_Type_ID:this.addReportingLineParticipant(t,c,"humanPerformer",null);break;case de.ActivityExecutorParticipantExpression.Clr_Type_ID:this.addActivityExecutorParticipant(t,c,"humanPerformer",null);break;case de.MatrixParticipantExpression.Clr_Type_ID:this.addMatrixParticipant(t,c,"humanPerformer",null)}}}catch(m){i={error:m}}finally{try{l&&!l.done&&(n=s["return"])&&n.call(s)}finally{if(i)throw i.error}}if(r.assignStrategy.assignStrategy===de.AssignmentStrategy.ASSIGN){e=new de.AssignPerformerConfig(t.Model);if(e.Operator=r.assignStrategy.assignConfig.operator,e.MultiSelect=r.assignStrategy.assignConfig.multiSelect,e.Necessary=r.assignStrategy.assignConfig.necessary,e.AllowGlobalAssign=r.isAllScope,t.AssignPerformerConfig=e,!r.isAllScope&&r.potentialOwnerList&&0<r.potentialOwnerList.length)try{for(var p=ue(r.potentialOwnerList),d=p.next();!d.done;d=p.next()){var u=d.value;switch(u.type){case de.UserParticipantExpression.Clr_Type_ID:this.addUserParticipant(t,u,"potentialOwner",null);break;case de.VariableParticipantExpression.Clr_Type_ID:this.addVariableParticipant(t,u,"potentialOwner",null);break;case de.PositionParticipantExpression.Clr_Type_ID:this.addPositionParticipant(t,u,"potentialOwner",null);break;case de.ComponentParticipantExpression.Clr_Type_ID:this.addComponentParticipant(t,u,"potentialOwner",null);break;case de.ReportingLineParticipantExpression.Clr_Type_ID:this.addReportingLineParticipant(t,u,"potentialOwner",null);break;case de.ActivityExecutorParticipantExpression.Clr_Type_ID:this.addActivityExecutorParticipant(t,u,"potentialOwner",null);break;case de.MatrixParticipantExpression.Clr_Type_ID:this.addMatrixParticipant(t,u,"potentialOwner",null);break;case de.OrganizationParticipantExpression.Clr_Type_ID:this.addOrganizationParticipant(t,u,"potentialOwner",null)}}}catch(f){o={error:f}}finally{try{d&&!d.done&&(a=p["return"])&&a.call(p)}finally{if(o)throw o.error}}}t.AssignmentStrategy===de.AssignmentStrategy.CLAIM&&(t.ExecuteWorkItemMode=de.ExecuteWorkItemMode.Preempt,t.CounterSignRules=null)}},T.prototype.checkOtherAssignNodes=function(t,e){if(t.AssignmentStrategy===de.AssignmentStrategy.ASSIGN){var r,i,n,o=t.Model.DefaultProcess.GetFlowElements();if(e.assignStrategy.assignStrategy!==de.AssignmentStrategy.ASSIGN)for(var a in o)o[a]instanceof de.UserActivity?(r=o[a]).otherAssignNodes&&r.otherAssignNodes.otherAssignActivities&&0<r.otherAssignNodes.otherAssignActivities.length&&-1<r.otherAssignNodes.otherAssignActivities.findIndex(function(e){return e===t.Id})&&(r.otherAssignNodes.otherAssignActivities=r.otherAssignNodes.otherAssignActivities.filter(function(e){return e!==t.Id})):o[a]instanceof de.OperationActivity?(i=o[a]).otherAssignNodes&&i.otherAssignNodes.otherAssignActivities&&0<i.otherAssignNodes.otherAssignActivities.length&&-1<i.otherAssignNodes.otherAssignActivities.findIndex(function(e){return e===t.Id})&&(i.otherAssignNodes.otherAssignActivities=i.otherAssignNodes.otherAssignActivities.filter(function(e){return e!==t.Id})):o[a]instanceof de.StartActivity&&(n=o[a]).otherAssignNodes&&n.otherAssignNodes.otherAssignActivities&&0<n.otherAssignNodes.otherAssignActivities.length&&-1<n.otherAssignNodes.otherAssignActivities.findIndex(function(e){return e===t.Id})&&(n.otherAssignNodes.otherAssignActivities=n.otherAssignNodes.otherAssignActivities.filter(function(e){return e!==t.Id}));else if("currentUser"===t.AssignPerformerConfig.Operator&&"currentUser"!==e.assignStrategy.assignConfig.operator)for(var a in o)o[a]instanceof de.UserActivity?(r=o[a]).otherAssignNodes&&r.otherAssignNodes.otherAssignActivities&&0<r.otherAssignNodes.otherAssignActivities.length&&-1<r.otherAssignNodes.otherAssignActivities.findIndex(function(e){return e===t.Id})&&(r.otherAssignNodes.otherAssignActivities=r.otherAssignNodes.otherAssignActivities.filter(function(e){return e!==t.Id})):o[a]instanceof de.OperationActivity&&(i=o[a]).otherAssignNodes&&i.otherAssignNodes.otherAssignActivities&&0<i.otherAssignNodes.otherAssignActivities.length&&-1<i.otherAssignNodes.otherAssignActivities.findIndex(function(e){return e===t.Id})&&(i.otherAssignNodes.otherAssignActivities=i.otherAssignNodes.otherAssignActivities.filter(function(e){return e!==t.Id}));else if("procInstCreator"===t.AssignPerformerConfig.Operator&&"procInstCreator"!==e.assignStrategy.assignConfig.operator)for(var a in o)o[a]instanceof de.StartActivity&&(n=o[a]).otherAssignNodes&&n.otherAssignNodes.otherAssignActivities&&0<n.otherAssignNodes.otherAssignActivities.length&&-1<n.otherAssignNodes.otherAssignActivities.findIndex(function(e){return e===t.Id})&&(n.otherAssignNodes.otherAssignActivities=n.otherAssignNodes.otherAssignActivities.filter(function(e){return e!==t.Id}))}},T.prototype.addUserParticipant=function(e,t,r,i){var n,o,a;t instanceof de.UserParticipantExpression?n=t:((n=new de.UserParticipantExpression(e.Model,t.performerId,t.performerName,t.orgType)).id=t.id,n.OrgId=t.orgId,n.actionScope=de.ActionScope.Default,n.OrgName=t.orgName,n.Tag=t.tag,n.OrgType=t.orgType,n.order=t.order,t.condition&&((a=new de.Condition(e.Model)).Value=t.condition,n.condition=a)),"humanPerformer"===r?((o=new de.HumanPerformerImpl(e.Model)).participantExpression=n,t.condition&&((a=new de.Condition(e.Model)).Value=t.condition,o.condition=a),o.order=t.order,e.AddResourceRole(o)):"potentialOwner"===r&&((o=new de.PotentialOwnerImpl(e.Model)).participantExpression=n,t.condition&&((a=new de.Condition(e.Model)).Value=t.condition,o.condition=a),o.order=t.order,i?(n.actionScope=i,e.dynamicParticipants.push(n)):e.AddResourceRole(o))},T.prototype.addVariableParticipant=function(e,t,r,i){var n,o,a;t instanceof de.VariableParticipantExpression?n=t:((n=new de.VariableParticipantExpression(e.Model,t.performerId,t.performerName,t.orgType)).id=t.id,n.actionScope=de.ActionScope.Default,n.Name=t.performerName||t.name,n.Tag=t.tag,n.VarValue=t.varValue,n.VarType=t.varType,n.order=t.order,n.Relation=t.relation,t.condition&&((a=new de.Condition(e.Model)).Value=t.condition,n.condition=a)),"humanPerformer"===r?((o=new de.HumanPerformerImpl(e.Model)).participantExpression=n,t.condition&&((a=new de.Condition(e.Model)).Value=t.condition,o.condition=a),o.order=t.order,e.AddResourceRole(o)):"potentialOwner"===r&&((o=new de.PotentialOwnerImpl(e.Model)).participantExpression=n,t.condition&&((a=new de.Condition(e.Model)).Value=t.condition,o.condition=a),o.order=t.order,i?(n.actionScope=i,e.dynamicParticipants.push(n)):e.AddResourceRole(o))},T.prototype.addPositionParticipant=function(e,t,r,i){var n,o,a;t instanceof de.PositionParticipantExpression?n=t:((n=new de.PositionParticipantExpression(e.Model,t.performerId,t.performerName)).id=t.id,n.actionScope=de.ActionScope.Default,n.PositionType=t.positionType,n.order=t.order,"1"===t.positionType&&(n.OrgId=t.orgId,n.OrgName=t.orgName,n.OrgType=t.orgType),t.condition&&((a=new de.Condition(e.Model)).Value=t.condition,n.condition=a)),"humanPerformer"===r?((o=new de.HumanPerformerImpl(e.Model)).participantExpression=n,t.condition&&((a=new de.Condition(e.Model)).Value=t.condition,o.condition=a),o.order=t.order,e.AddResourceRole(o)):"potentialOwner"===r&&((o=new de.PotentialOwnerImpl(e.Model)).participantExpression=n,t.condition&&((a=new de.Condition(e.Model)).Value=t.condition,o.condition=a),o.order=t.order,i?(n.actionScope=i,e.dynamicParticipants.push(n)):e.AddResourceRole(o))},T.prototype.addComponentParticipant=function(e,t,r,i){var n,o,a,s;if(t instanceof de.ComponentParticipantExpression)n=t;else{if((n=new de.ComponentParticipantExpression(e.Model)).id=t.id,n.componentId=t.metadataId,n.actionScope=de.ActionScope.Default,n.componentName=t.name,n.methodName=t.methodName,n.order=t.order,n.methodCode=t.methodCode,t.actualParameters&&0<t.actualParameters.length){var l=new Array;try{for(var c=ue(t.actualParameters),p=c.next();!p.done;p=c.next()){var d=p.value,u=new de.ActualParameter(e.Model,d.code,d.value,d.valueText);if(u.Tag=d.tag,d.fetchValueMode)switch(d.fetchValueMode){case"express":case"none":u.Tag="expression";break;default:u.Tag="constant"}l.push(u)}}catch(m){a={error:m}}finally{try{p&&!p.done&&(o=c["return"])&&o.call(c)}finally{if(a)throw a.error}}n.actualParameters=l}t.condition&&((s=new de.Condition(e.Model)).Value=t.condition,n.condition=s)}"humanPerformer"===r?((o=new de.HumanPerformerImpl(e.Model)).participantExpression=n,t.condition&&((s=new de.Condition(e.Model)).Value=t.condition,o.condition=s),o.order=t.order,e.AddResourceRole(o)):"potentialOwner"===r&&((a=new de.PotentialOwnerImpl(e.Model)).participantExpression=n,t.condition&&((s=new de.Condition(e.Model)).Value=t.condition,a.condition=s),a.order=t.order,i?(n.actionScope=i,e.dynamicParticipants.push(n)):e.AddResourceRole(a))},T.prototype.addReportingLineParticipant=function(e,t,r,i){var n,o,a;t instanceof de.ReportingLineParticipantExpression?n=t:((n=new de.ReportingLineParticipantExpression(e.Model)).id=t.id,n.actionScope=de.ActionScope.Default,n.ReportingLineDefId=t.reportingLineDefId,n.ReportingLineDefName=t.reportingLineDefName,n.RefOrgId=t.refOrgId,n.RefUserId=t.refUserId,n.RefEmployeeId=t.refEmployeeId,n.order=t.order,n.Dimension=t.dimension,n.Tag=t.tag,t.condition&&((a=new de.Condition(e.Model)).Value=t.condition,n.condition=a)),"humanPerformer"===r?((o=new de.HumanPerformerImpl(e.Model)).participantExpression=n,t.condition&&((a=new de.Condition(e.Model)).Value=t.condition,o.condition=a),o.order=t.order,e.AddResourceRole(o)):"potentialOwner"===r&&((o=new de.PotentialOwnerImpl(e.Model)).participantExpression=n,t.condition&&((a=new de.Condition(e.Model)).Value=t.condition,o.condition=a),o.order=t.order,i?(n.actionScope=i,e.dynamicParticipants.push(n)):e.AddResourceRole(o))},T.prototype.addActivityExecutorParticipant=function(e,t,r,i){var n,o,a;t instanceof de.ActivityExecutorParticipantExpression?n=t:((n=new de.ActivityExecutorParticipantExpression(e.Model)).id=t.id,n.activityDefId=t.activityDefId,n.actionScope=de.ActionScope.Default,n.order=t.order,n.activityDefName=t.activityDefName,t.condition&&((a=new de.Condition(e.Model)).Value=t.condition,n.condition=a)),"humanPerformer"===r?((o=new de.HumanPerformerImpl(e.Model)).participantExpression=n,t.condition&&((a=new de.Condition(e.Model)).Value=t.condition,o.condition=a),o.order=t.order,e.AddResourceRole(o)):"potentialOwner"===r&&((o=new de.PotentialOwnerImpl(e.Model)).participantExpression=n,t.condition&&((a=new de.Condition(e.Model)).Value=t.condition,o.condition=a),o.order=t.order,i?(n.actionScope=i,e.dynamicParticipants.push(n)):e.AddResourceRole(o))},T.prototype.addMatrixParticipant=function(e,t,r,i){var n,o,a;n=new de.MatrixParticipantExpression(e.Model),t instanceof de.MatrixParticipantExpression?n=t:((n=new de.MatrixParticipantExpression(e.Model)).order=t.order,n.id=t.id,n.actionScope=de.ActionScope.Default,n.matrixDefId=t.matrixDefId,n.matrixDefName=t.matrixDefName,n.conditionField1=t.conditionField1,n.conditionFieldText1=t.conditionFieldText1,n.conditionField2=t.conditionField2,n.conditionFieldText2=t.conditionFieldText2,n.conditionField3=t.conditionField3,n.conditionFieldText3=t.conditionFieldText3,n.multivaluedCondition=t.multivaluedCondition,n.dataFieldAlias=t.dataFieldAlias,t.condition&&((a=new de.Condition(e.Model)).Value=t.condition,n.condition=a)),"humanPerformer"===r?((o=new de.HumanPerformerImpl(e.Model)).participantExpression=n,t.condition&&((a=new de.Condition(e.Model)).Value=t.condition,o.condition=a),o.order=t.order,e.AddResourceRole(o)):"potentialOwner"===r&&((o=new de.PotentialOwnerImpl(e.Model)).participantExpression=n,t.condition&&((a=new de.Condition(e.Model)).Value=t.condition,o.condition=a),o.order=t.order,i?(n.actionScope=i,e.dynamicParticipants.push(n)):e.AddResourceRole(o))},T.prototype.addOrganizationParticipant=function(e,t,r,i){var n,o,a;t instanceof de.OrganizationParticipantExpression?n=t:((n=new de.OrganizationParticipantExpression(e.Model)).id=t.id,n.order=t.order,n.actionScope=de.ActionScope.AssignUser,"DEPARTMENT"===t.organizationLevel?n.organizationLevel=de.OrganizationLevel.DEPARTMENT:"UNIT"===t.organizationLevel?n.organizationLevel=de.OrganizationLevel.UNIT:"DEFAULT"===t.organizationLevel&&(n.organizationLevel=de.OrganizationLevel.DEFAULT),n.organizationId=t.organizationId,n.organizationName=t.organizationName,n.includeChildren=t.includeChildren,n.tag=t.tag,t.condition&&((a=new de.Condition(e.Model)).Value=t.condition,n.condition=a)),"humanPerformer"===r?((o=new de.HumanPerformerImpl(e.Model)).participantExpression=n,t.condition&&((a=new de.Condition(e.Model)).Value=t.condition,o.condition=a),o.order=t.order,e.AddResourceRole(o)):"potentialOwner"===r&&((o=new de.PotentialOwnerImpl(e.Model)).participantExpression=n,t.condition&&((a=new de.Condition(e.Model)).Value=t.condition,o.condition=a),o.order=t.order,i?(n.actionScope=i,e.dynamicParticipants.push(n)):e.AddResourceRole(o))},T.prototype.updateParticipantOptions=function(e,t){var r,t=t.propertyValue;null!=e.ParticipantSetting?(e.ParticipantSetting.ExclusionPerformers=t.ExclusionPerformers,e.ParticipantSetting.NoPerformerStrategy=t.NoPerformerStrategy,e.ParticipantSetting.HistoricFirst=t.HistoricFirst,e.ParticipantSetting.automaticPerformers=t.automaticPerformers):((r=new de.ParticipantSetting(e.Model)).ExclusionPerformers=t.ExclusionPerformers,r.NoPerformerStrategy=t.NoPerformerStrategy,r.HistoricFirst=t.HistoricFirst,r.automaticPerformers=t.automaticPerformers,e.ParticipantSetting=r)},T.prototype.resetExecuteWorkItemMode=function(e,t,r){void 0===r&&(r=!1),e&&(e.ExecuteWorkItemMode=t.propertyValue,e.ExecuteWorkItemMode===de.ExecuteWorkItemMode.Preempt?e.CounterSignRules=null:(e.CounterSignRules||(e.CounterSignRules=new Array),e.SelectTargetAble=!1,e.JumpScope=null,e.AssignmentStrategy===de.AssignmentStrategy.CLAIM&&(e.AssignmentStrategy=de.AssignmentStrategy.ALL)))},T.prototype.resetDisplayTerminal=function(e,t,r){void 0===r&&(r=!1),e&&(e.DisplayTerminal=t.propertyValue)},T.prototype.resetSignRules=function(e,t,r){var i,n;if(void 0===r&&(r=!1),e){r=t.propertyValue;if(e.CounterSignRules=null,r&&0<r.length){e.CounterSignRules=new Array;try{for(var o=ue(r),a=o.next();!a.done;a=o.next()){var s=a.value,l=new de.CounterSignRule(e.Model),c=new de.Condition(e.Model);c.Value=s.completionCondition,l.ConclusionValue=s.conclusionValue,l.CalculateType=s.calculateType,l.ConditionValue=s.conditionValue,l.WaitAllVotes=s.waitAllVotes,l.CompletionCondition=c,e.CounterSignRules.push(l)}}catch(p){i={error:p}}finally{try{a&&!a.done&&(n=o["return"])&&n.call(o)}finally{if(i)throw i.error}}}}},T.prototype.resetApprovalItems=function(e,t,r){var i,n;if(void 0===r&&(r=!1),e){r=t.propertyValue;e.Conclusions=new Array;try{for(var o=ue(r),a=o.next();!a.done;a=o.next()){var s=a.value,l=new de.ConclusionItem(e.Model);l.Value=s.value,l.Text=s.text,l.WorkFlowAction=s.workFlowAction,l.IsDefault=s.isDefault,l.commentNecessary=s.commentNecessary,l.certification=s.certification,l.attachmentNecessary=s.attachmentNecessary,l.signatureNecessary=s.signatureNecessary,l.defaultComment=s.defaultComment,e.Conclusions.push(l)}}catch(c){i={error:c}}finally{try{a&&!a.done&&(n=o["return"])&&n.call(o)}finally{if(i)throw i.error}}}this.isBackConclusionExist(e.Conclusions)?e.BackWardRule||(e.BackWardRule=new de.BackWardRule(e.Model)):e.BackWardRule=null},T.prototype.resetExecuteForm=function(e,t,r){var i;if(e){t=t.propertyValue;if(e.ExecuteForms||(e.ExecuteForms=new Array),e.ExecuteForms=e.ExecuteForms.filter(function(e){return e.TerminalType!==r}),t){var n=t.ActualParameters,o=new Array;if(n&&0<n.length)try{for(var a=ue(n),s=a.next();!s.done;s=a.next()){var l=s.value,c=new de.ActualParameter(e.Model,l.Name,l.Value);l.Tag?c.Tag=l.Tag:l.Value?8<=l.Value.length&&'{"expr":'===l.Value.slice(0,8)?c.Tag="expression":c.Tag="constant":c.Tag="variable",o.push(c)}}catch(d){i={error:d}}finally{try{s&&!s.done&&(p=a["return"])&&p.call(a)}finally{if(i)throw i.error}}var n=B.BpmnModelHelper.GenerateElementId(),p=new de.ExecuteForm(e.Model,n,t.Name,o);p.ComponentId=t.ComponentId,p.FormType=t.FormType,p.formFormatId=t.formFormatId,p.formatConfigId=t.formatConfigId,p.TerminalType=t.TerminalType,e.ExecuteForms.push(p)}}},T.prototype.resetSelectTargetAble=function(e,t,r){void 0===r&&(r=!1);r=t.propertyValue;e.SelectTargetAble=r,e.SelectTargetAble||(e.JumpScope=null)},T.prototype.resetJumpScope=function(e,t){var r,t=t.propertyValue;t?((r=new de.JumpScope(e.Model)).Category=t.Category,r.DefaultType=t.DefaultType,r.DestinationActivities=t.DestinationActivities,r.DefaultActivity=t.DefaultActivity,e.JumpScope=r):e.JumpScope=null},T.prototype.resetBackWardRule=function(e,t){var t=t.propertyValue,r=new de.BackWardRule(e.Model);r.TargetRef=t.TargetRef,r.SelectTargetAble=t.SelectTargetAble,r.WaitReturn=t.WaitReturn,r.ResubmitEffect=t.ResubmitEffect,r.DynamicBackWardRuleAble=t.DynamicBackWardRuleAble,r.SelectTargetList=t.SelectTargetList,e.BackWardRule=r},T.prototype.resetMultiInstanceLoopCharacteristics=function(e,t){var r,i;if(t.propertyValue){var t=t.propertyValue,n=new B.MultiInstanceLoopCharacteristics(e.Model),o=(n.enable=t.enable,n.sequential=t.sequential,n.loopCardinality=new B.Expression(e.Model),t.loopCardinality&&((o=new de.SemanticExpression(e.Model)).Value=t.loopCardinality,n.loopCardinality.MexExpression=o),n.completionCondition=t.completionCondition,t.completionConditionRules);if(n.completionConditionRules=null,o&&0<o.length){n.completionConditionRules=new Array;try{for(var a=ue(o),s=a.next();!s.done;s=a.next()){var l=s.value,c=new de.CounterSignRule(e.Model),p=new de.Condition(e.Model);p.Value=l.CompletionCondition.Value,c.ConclusionValue=l.ConclusionValue,c.CalculateType=l.CalculateType,c.ConditionValue=l.ConditionValue,c.WaitAllVotes=l.WaitAllVotes,c.CompletionCondition=p,n.completionConditionRules.push(c)}}catch(d){r={error:d}}finally{try{s&&!s.done&&(i=a["return"])&&i.call(a)}finally{if(r)throw r.error}}}e.LoopCharacteristics=n}},T.prototype.modifyTitleExpression=function(e,t){e.taskTitle?(e.taskTitle.valueLanguage=t.propertyValue,e.taskTitle.value=t.propertyValue["zh-CHS"]):(t=new de.TitleExpression(e.Model,t.propertyValue["zh-CHS"],t.propertyValue),e.taskTitle=t)},T.prototype.resetTools=function(e,t){var r,i,n,o,t=t.propertyValue;if(e.Tools=new Array,t&&0<t.length)try{for(var a=ue(t),s=a.next();!s.done;s=a.next()){var l=s.value,c=new de.Component(e.Model);if(c.Id=l.id,c.Name=l.name,c.Time=l.executionTime,c.ComponentType="WebServiceComponent",c.MetadataId=l.metadataId,c.MethodCode=l.methodCode,c.isForCompensation=l.isForCompensation,c.ActualParameters=[],l.actualParameters&&0<l.actualParameters.length)try{for(var p=ue(l.actualParameters),d=p.next();!d.done;d=p.next()){var u=d.value,m=new de.ActualParameter(e.Model,u.code,u.value);c.ActualParameters.push(m)}}catch(f){n={error:f}}finally{try{d&&!d.done&&(o=p["return"])&&o.call(p)}finally{if(n)throw n.error}}e.Tools.push(c)}}catch(h){r={error:h}}finally{try{s&&!s.done&&(i=a["return"])&&i.call(a)}finally{if(r)throw r.error}}},T.prototype.updateSignFrontSet=function(e,t){var r,i,t=t.propertyValue;if(e.dynamicParticipants=e.dynamicParticipants.filter(function(e){return e.actionScope!==de.ActionScope.AddSignFront}),e.AddSignFrontAble=t.enable,t.scope)if(t.scope.organizationLevel){var n=new de.OrganizationParticipantExpression(e.Model);n.id=B.BpmnModelHelper.GenerateElementId(),n.actionScope=de.ActionScope.AddSignFront,n.organizationLevel=t.scope.organizationLevel,n.organizationId=t.scope.organizationId,n.organizationName=t.scope.organizationName,n.includeChildren=t.scope.includeChildren,n.tag=t.scope.tag,e.dynamicParticipants.push(n)}else{n=t.scope.participantInfo;if(n.isAllScope&&n.potentialOwnerList&&0<n.potentialOwnerList.length)try{for(var o=ue(n.potentialOwnerList),a=o.next();!a.done;a=o.next()){var s=a.value;switch(s.type||(s instanceof de.ParticipantExpression?s.ClrTypeID:null)){case de.UserParticipantExpression.Clr_Type_ID:this.addUserParticipant(e,(0 instanceof de.ParticipantExpression,s),"potentialOwner",de.ActionScope.AddSignFront);break;case de.VariableParticipantExpression.Clr_Type_ID:this.addVariableParticipant(e,(0 instanceof de.ParticipantExpression,s),"potentialOwner",de.ActionScope.AddSignFront);break;case de.PositionParticipantExpression.Clr_Type_ID:this.addPositionParticipant(e,(0 instanceof de.ParticipantExpression,s),"potentialOwner",de.ActionScope.AddSignFront);break;case de.ComponentParticipantExpression.Clr_Type_ID:this.addComponentParticipant(e,(0 instanceof de.ParticipantExpression,s),"potentialOwner",de.ActionScope.AddSignFront);break;case de.ReportingLineParticipantExpression.Clr_Type_ID:this.addReportingLineParticipant(e,(0 instanceof de.ParticipantExpression,s),"potentialOwner",de.ActionScope.AddSignFront);break;case de.ActivityExecutorParticipantExpression.Clr_Type_ID:this.addActivityExecutorParticipant(e,(0 instanceof de.ParticipantExpression,s),"potentialOwner",de.ActionScope.AddSignFront);break;case de.MatrixParticipantExpression.Clr_Type_ID:this.addMatrixParticipant(e,(0 instanceof de.ParticipantExpression,s),"potentialOwner",de.ActionScope.AddSignFront);break;case de.OrganizationParticipantExpression.Clr_Type_ID:this.addOrganizationParticipant(e,(0 instanceof de.ParticipantExpression,s),"potentialOwner",de.ActionScope.AddSignFront)}}}catch(l){r={error:l}}finally{try{a&&!a.done&&(i=o["return"])&&i.call(o)}finally{if(r)throw r.error}}}},T.prototype.updateSignBehindsSet=function(e,t){var r,i,t=t.propertyValue;if(e.dynamicParticipants=e.dynamicParticipants.filter(function(e){return e.actionScope!==de.ActionScope.AddSignBehind}),e.AddSignBehindAble=t.enable,t.scope)if(t.scope.organizationLevel){var n=new de.OrganizationParticipantExpression(e.Model);n.id=B.BpmnModelHelper.GenerateElementId(),n.actionScope=de.ActionScope.AddSignBehind,n.organizationLevel=t.scope.organizationLevel,n.organizationId=t.scope.organizationId,n.organizationName=t.scope.organizationName,n.includeChildren=t.scope.includeChildren,n.tag=t.scope.tag,e.dynamicParticipants.push(n)}else{n=t.scope.participantInfo;if(n.isAllScope&&n.potentialOwnerList&&0<n.potentialOwnerList.length)try{for(var o=ue(n.potentialOwnerList),a=o.next();!a.done;a=o.next()){var s=a.value;switch(s.type||(s instanceof de.ParticipantExpression?s.ClrTypeID:null)){case de.UserParticipantExpression.Clr_Type_ID:this.addUserParticipant(e,(0 instanceof de.ParticipantExpression,s),"potentialOwner",de.ActionScope.AddSignBehind);break;case de.VariableParticipantExpression.Clr_Type_ID:this.addVariableParticipant(e,(0 instanceof de.ParticipantExpression,s),"potentialOwner",de.ActionScope.AddSignBehind);break;case de.PositionParticipantExpression.Clr_Type_ID:this.addPositionParticipant(e,(0 instanceof de.ParticipantExpression,s),"potentialOwner",de.ActionScope.AddSignBehind);break;case de.ComponentParticipantExpression.Clr_Type_ID:this.addComponentParticipant(e,(0 instanceof de.ParticipantExpression,s),"potentialOwner",de.ActionScope.AddSignBehind);break;case de.ReportingLineParticipantExpression.Clr_Type_ID:this.addReportingLineParticipant(e,(0 instanceof de.ParticipantExpression,s),"potentialOwner",de.ActionScope.AddSignBehind);break;case de.ActivityExecutorParticipantExpression.Clr_Type_ID:this.addActivityExecutorParticipant(e,(0 instanceof de.ParticipantExpression,s),"potentialOwner",de.ActionScope.AddSignBehind);break;case de.MatrixParticipantExpression.Clr_Type_ID:this.addMatrixParticipant(e,(0 instanceof de.ParticipantExpression,s),"potentialOwner",de.ActionScope.AddSignBehind);break;case de.OrganizationParticipantExpression.Clr_Type_ID:this.addOrganizationParticipant(e,(0 instanceof de.ParticipantExpression,s),"potentialOwner",de.ActionScope.AddSignBehind)}}}catch(l){r={error:l}}finally{try{a&&!a.done&&(i=o["return"])&&i.call(o)}finally{if(r)throw r.error}}}},T.prototype.updateNotifySet=function(e,t){var r,i,t=t.propertyValue;if(e.dynamicParticipants=e.dynamicParticipants.filter(function(e){return e.actionScope!==de.ActionScope.Notify}),e.NotifyAble=t.enable,t.scope)if(t.scope.organizationLevel){var n=new de.OrganizationParticipantExpression(e.Model);n.id=B.BpmnModelHelper.GenerateElementId(),n.actionScope=de.ActionScope.Notify,n.organizationLevel=t.scope.organizationLevel,n.organizationId=t.scope.organizationId,n.organizationName=t.scope.organizationName,n.includeChildren=t.scope.includeChildren,n.tag=t.scope.tag,e.dynamicParticipants.push(n)}else{n=t.scope.participantInfo;if(n.isAllScope&&n.potentialOwnerList&&0<n.potentialOwnerList.length)try{for(var o=ue(n.potentialOwnerList),a=o.next();!a.done;a=o.next()){var s=a.value;switch(s.type||(s instanceof de.ParticipantExpression?s.ClrTypeID:null)){case de.UserParticipantExpression.Clr_Type_ID:this.addUserParticipant(e,(0 instanceof de.ParticipantExpression,s),"potentialOwner",de.ActionScope.Notify);break;case de.VariableParticipantExpression.Clr_Type_ID:this.addVariableParticipant(e,(0 instanceof de.ParticipantExpression,s),"potentialOwner",de.ActionScope.Notify);break;case de.PositionParticipantExpression.Clr_Type_ID:this.addPositionParticipant(e,(0 instanceof de.ParticipantExpression,s),"potentialOwner",de.ActionScope.Notify);break;case de.ComponentParticipantExpression.Clr_Type_ID:this.addComponentParticipant(e,(0 instanceof de.ParticipantExpression,s),"potentialOwner",de.ActionScope.Notify);break;case de.ReportingLineParticipantExpression.Clr_Type_ID:this.addReportingLineParticipant(e,(0 instanceof de.ParticipantExpression,s),"potentialOwner",de.ActionScope.Notify);break;case de.ActivityExecutorParticipantExpression.Clr_Type_ID:this.addActivityExecutorParticipant(e,(0 instanceof de.ParticipantExpression,s),"potentialOwner",de.ActionScope.Notify);break;case de.MatrixParticipantExpression.Clr_Type_ID:this.addMatrixParticipant(e,(0 instanceof de.ParticipantExpression,s),"potentialOwner",de.ActionScope.Notify);break;case de.OrganizationParticipantExpression.Clr_Type_ID:this.addOrganizationParticipant(e,(0 instanceof de.ParticipantExpression,s),"potentialOwner",de.ActionScope.Notify)}}}catch(l){r={error:l}}finally{try{a&&!a.done&&(i=o["return"])&&i.call(o)}finally{if(r)throw r.error}}}},T.prototype.updateTransferScope=function(e,t){var r,i,t=t.propertyValue;if(e.dynamicParticipants=e.dynamicParticipants.filter(function(e){return e.actionScope!==de.ActionScope.Transfer}),e.transferAble=t.enable,t.scope)if(t.scope.organizationLevel){var n=new de.OrganizationParticipantExpression(e.Model);n.id=B.BpmnModelHelper.GenerateElementId(),n.actionScope=de.ActionScope.Transfer,n.organizationLevel=t.scope.organizationLevel,n.organizationId=t.scope.organizationId,n.organizationName=t.scope.organizationName,n.includeChildren=t.scope.includeChildren,n.tag=t.scope.tag,e.dynamicParticipants.push(n)}else{n=t.scope.participantInfo;if(n.isAllScope&&n.potentialOwnerList&&0<n.potentialOwnerList.length)try{for(var o=ue(n.potentialOwnerList),a=o.next();!a.done;a=o.next()){var s=a.value;switch(s.type||(s instanceof de.ParticipantExpression?s.ClrTypeID:null)){case de.UserParticipantExpression.Clr_Type_ID:this.addUserParticipant(e,(0 instanceof de.ParticipantExpression,s),"potentialOwner",de.ActionScope.Transfer);break;case de.VariableParticipantExpression.Clr_Type_ID:this.addVariableParticipant(e,(0 instanceof de.ParticipantExpression,s),"potentialOwner",de.ActionScope.Transfer);break;case de.PositionParticipantExpression.Clr_Type_ID:this.addPositionParticipant(e,(0 instanceof de.ParticipantExpression,s),"potentialOwner",de.ActionScope.Transfer);break;case de.ComponentParticipantExpression.Clr_Type_ID:this.addComponentParticipant(e,(0 instanceof de.ParticipantExpression,s),"potentialOwner",de.ActionScope.Transfer);break;case de.ReportingLineParticipantExpression.Clr_Type_ID:this.addReportingLineParticipant(e,(0 instanceof de.ParticipantExpression,s),"potentialOwner",de.ActionScope.Transfer);break;case de.ActivityExecutorParticipantExpression.Clr_Type_ID:this.addActivityExecutorParticipant(e,(0 instanceof de.ParticipantExpression,s),"potentialOwner",de.ActionScope.Transfer);break;case de.MatrixParticipantExpression.Clr_Type_ID:this.addMatrixParticipant(e,(0 instanceof de.ParticipantExpression,s),"potentialOwner",de.ActionScope.Transfer);break;case de.OrganizationParticipantExpression.Clr_Type_ID:this.addOrganizationParticipant(e,(0 instanceof de.ParticipantExpression,s),"potentialOwner",de.ActionScope.Transfer)}}}catch(l){r={error:l}}finally{try{a&&!a.done&&(i=o["return"])&&i.call(o)}finally{if(r)throw r.error}}}},T.prototype.updateTimeLimitControl=function(e,t){var r,i,n,o,t=t.propertyValue;if(e.timeLimitControl=null,t){var a=new de.TimeLimitControl(e.Model);if(a.enable=t.enable,a.tag=t.tag,a.dueTime=t.dueTime,a.timeUnit=t.timeUnit,a.expireOperations=new Array,t.expireOperations&&0<t.expireOperations.length)try{for(var s=ue(t.expireOperations),l=s.next();!l.done;l=s.next()){var c,p,d=l.value;if("SendMessageExpireOperation"!==d.operationTypeName&&d.operationTypeName)"AutoHandleExpireOperation"===d.operationTypeName&&(c=d,(p=new de.AutoHandleExpireOperation(e.Model)).id=d.id,p.durationType=c.durationType,p.timeDuration=c.timeDuration,p.timeUnit=c.timeUnit,p.operationTypeName=c.operationTypeName||"AutoHandleExpireOperation",p.autoHandleType=c.autoHandleType,p.message=c.message,a.expireOperations.push(p));else{var u=d,m=new de.SendMessageExpireOperation(e.Model);if(m.id=B.BpmnModelHelper.GenerateElementId(),m.durationType=u.durationType,m.timeDuration=u.timeDuration,m.timeUnit=u.timeUnit,m.message=u.message,m.subject=u.subject,m.sendType=u.sendType,m.receiver=u.receiver,m.cycleEnable=u.cycleEnable,m.cycleTime=u.cycleTime,m.cycleTimeUnit=u.cycleTimeUnit,m.operationTypeName=u.operationTypeName||"SendMessageExpireOperation",u.smsMessageTemplate){var f=new de.SmsMessageTemplate(e.Model);if(f.code=u.smsMessageTemplate.code,f.content=u.smsMessageTemplate.content,f.smsMessageVariables=new Array,u.smsMessageTemplate.smsMessageVariables&&0<u.smsMessageTemplate.smsMessageVariables.length)try{for(var h=ue(u.smsMessageTemplate.smsMessageVariables),y=h.next();!y.done;y=h.next()){var g=y.value,v=new de.SmsMessageVariable(e.Model);v.code=g.code,v.value=g.value,v.tag=g.tag,f.smsMessageVariables.push(v)}}catch(b){n={error:b}}finally{try{y&&!y.done&&(o=h["return"])&&o.call(h)}finally{if(n)throw n.error}}m.smsMessageTemplate=f}a.expireOperations.push(m)}}}catch(x){r={error:x}}finally{try{l&&!l.done&&(i=s["return"])&&i.call(s)}finally{if(r)throw r.error}}e.timeLimitControl=a}},T.prototype.updateAnonymousSet=function(e,t){t=t.propertyValue;t&&(e.anonymous=t.isAnonymity,e.anonymousText=t.anonymous)},T.prototype.updateCustomizeActions=function(e,t){var r,i,n,o,t=t.propertyValue;if(e.customizeActions=new Array,t&&0<t.length)try{for(var a=ue(t),s=a.next();!s.done;s=a.next()){var l=s.value,c=new de.CustomizeAction(e.Model);if(c.id=B.BpmnModelHelper.GenerateElementId(),c.code=l.code,c.name=l.name,c.terminalType=l.terminalType,c.actualParameters=[],l.actualParameters&&0<l.actualParameters.length)try{for(var p=ue(l.actualParameters),d=p.next();!d.done;d=p.next()){var u=d.value,m=new de.ActualParameter(e.Model,u.Name,u.Value,u.ValueText,u.Tag||"expression");c.actualParameters.push(m)}}catch(f){n={error:f}}finally{try{d&&!d.done&&(o=p["return"])&&o.call(p)}finally{if(n)throw n.error}}e.customizeActions.push(c)}}catch(h){r={error:h}}finally{try{s&&!s.done&&(i=a["return"])&&i.call(a)}finally{if(r)throw r.error}}},T.prototype.updateVariableSettings=function(e,t){var r,i,n,o,a,s=e.Model,l=s.DefaultProcess.GetExtensionElements();if(e.variableSettings&&0<e.variableSettings.length)try{for(var c=ue(e.variableSettings),p=c.next();!p.done;p=c.next())!function(t){var e;"component"===t.tag&&(e=l.findIndex(function(e){return e instanceof de.Component&&e.Id===t.value}),l.splice(e,1))}(f=p.value)}catch(P){r={error:P}}finally{try{p&&!p.done&&(d=c["return"])&&d.call(c)}finally{if(r)throw r.error}}e.variableSettings=new Array;var d=t.propertyValue;if(d&&0<d.length)try{for(var u=ue(d),m=u.next();!m.done;m=u.next()){var f=m.value,h=new de.VariableSetting(s);if(h.variableCode=f.variableCode,h.variableName=f.variableName,h.tag=f.tag,h.executionTime=f.executionTime,h.value=f.value,h.valueText=f.valueText,e.variableSettings.push(h),"component"===h.tag){var y=f.component;if(y){var g=new de.Component(s);if(g.MetadataId=y.MetadataId,g.MethodCode=y.MethodCode,g.Id=y.Id,g.Name=y.Name,g.ActualParameters=new Array,y.ActualParameters&&0<y.ActualParameters.length)try{for(var v=ue(y.ActualParameters),b=v.next();!b.done;b=v.next()){var x=b.value,w=new de.ActualParameter(s,x.Name,x.Value);w.Tag=x.Tag,g.ActualParameters.push(w)}}catch(C){o={error:C}}finally{try{b&&!b.done&&(a=v["return"])&&a.call(v)}finally{if(o)throw o.error}}l.push(g)}}}}catch(I){i={error:I}}finally{try{m&&!m.done&&(n=u["return"])&&n.call(u)}finally{if(i)throw i.error}}},T.prototype.updateImageSettings=function(e,t){var r,t=t.propertyValue;e.imageSettings&&(e.imageSettings=new de.ImageSettings(e.Model)),t&&t.imageOperation&&((r=new de.ImageSettings(e.Model)).imageOperation=t.imageOperation,e.imageSettings=r)},T.prototype.updateCheckConditions=function(e,t,r){void 0===r&&(r=!1);var i,n,r=t.propertyValue;e.checkConditions=new Array;try{for(var o=ue(r),a=o.next();!a.done;a=o.next()){var s=a.value;if(s.value){var l=new de.CheckCondition(e.Model);if(l.value=s.value,l.checkTime=s.checkTime,l.errorTips=new Map,s.errorTips)for(var c in s.errorTips)l.errorTips.set(c,s.errorTips[c]);e.checkConditions.push(l)}}}catch(p){i={error:p}}finally{try{a&&!a.done&&(n=o["return"])&&n.call(o)}finally{if(i)throw i.error}}},T.prototype.updateOtherAssignNodes=function(e,t){t=t.propertyValue;e.otherAssignNodes=t?new de.OtherAssignNodes(e.Model):null},T.prototype.updateOtherAssignActivities=function(r,e){e=e.propertyValue;e&&0<e.length?"string"==typeof e[0]?(r.otherAssignNodes.otherAssignActivityNodeInfos=new Array,e.forEach(function(e){var t=new de.OtherAssignActivityNodeInfo(r.Model);t.activityDefinitionId=e,t.required=!1,t.condition=new de.Condition(r.Model),r.otherAssignNodes.otherAssignActivityNodeInfos.push(t)})):(r.otherAssignNodes.otherAssignActivityNodeInfos=new Array,e.forEach(function(e){var t=new de.OtherAssignActivityNodeInfo(r.Model);t.activityDefinitionId=e.activityDefinitionId,t.required=e.required,t.condition=new de.Condition(r.Model),t.condition.Value=e.condition.Value,r.otherAssignNodes.otherAssignActivityNodeInfos.push(t)})):r.otherAssignNodes.otherAssignActivityNodeInfos=new Array},T.prototype.updateMessageNotices=function(e,t){var r,i,n,o,a,s,l,R,t=t.propertyValue;if(e.messageNotices=new Array,t&&0<t.length)try{for(var c=ue(t),p=c.next();!p.done;p=c.next()){var d=p.value,u=new de.MessageNotice(e.Model);if(u.sendType=d.sendType,u.sendTime=d.sendTime,u.subject=d.subject,u.content=d.content,d.receivers=d.receivers.filter(function(e){return e.type}),d.receivers&&0<d.receivers.length){var m=d.receivers.filter(function(e){return"userParticipant"===e.type||"processParticipant"===e.type&&"activityExecutorParticipant"!==e.processParticipant}),f=d.receivers.filter(function(e){return"variableParticipant"===e.type||"positionParticipant"===e.type||"processParticipant"===e.type&&"activityExecutorParticipant"===e.processParticipant});if(m&&0<m.length){var h="",y="";try{for(var g=ue(m),v=g.next();!v.done;v=g.next()){var b=v.value;"processParticipant"===b.type?(h+=b.processParticipant+",","procInstCreator"===b.processParticipant?y+="流程发起人,":"workItemParticipant"===b.processParticipant&&(y+="任务接收人,")):"userParticipant"===b.type&&(h+=b.userIds+",",y+=b.userNames+",")}}catch(D){n={error:D}}finally{try{v&&!v.done&&(o=g["return"])&&o.call(g)}finally{if(n)throw n.error}}h=h&&h.substring(0,h.length-1),y=y&&y.substring(0,y.length-1),u.receiver=h,u.receiverText=y}if(f&&0<f.length){var x=new Array;try{for(var w=ue(f),P=w.next();!P.done;P=w.next()){var C,I,S,E=P.value;"processParticipant"===E.type&&((C=new de.ActivityExecutorParticipantExpression(e.Model)).id=B.BpmnModelHelper.GenerateElementId(),C.activityDefId=E.activityDefId,C.activityDefName=E.activityDefName,x.push(C)),"variableParticipant"===E.type&&((I=new de.UserParticipantExpression(e.Model,E.variableParticipant,E.variableName,E.orgType)).id=B.BpmnModelHelper.GenerateElementId(),I.Tag="expression",I.OrgType=E.orgType,x.push(I)),"positionParticipant"===E.type&&((S=new de.PositionParticipantExpression(e.Model,E.positionId,E.positionName)).id=B.BpmnModelHelper.GenerateElementId(),S.PositionType=E.positionType,"1"===E.positionType&&(S.OrgId=E.orgId,S.OrgType=E.orgType),x.push(S))}}catch(N){a={error:N}}finally{try{P&&!P.done&&(s=w["return"])&&s.call(w)}finally{if(a)throw a.error}}u.receiverExpressions=x}}if(d.smsMessageTemplate){var T=new de.SmsMessageTemplate(e.Model);if(T.code=d.smsMessageTemplate.code,T.content=d.smsMessageTemplate.content,T.smsMessageVariables=new Array,d.smsMessageTemplate.smsMessageVariables&&0<d.smsMessageTemplate.smsMessageVariables.length)try{for(var A=ue(d.smsMessageTemplate.smsMessageVariables),k=A.next();!k.done;k=A.next()){var O=k.value,M=new de.SmsMessageVariable(e.Model);M.code=O.code,M.value=O.value,M.tag=O.tag,T.smsMessageVariables.push(M)}}catch(L){l={error:L}}finally{try{k&&!k.done&&(R=A["return"])&&R.call(A)}finally{if(l)throw l.error}}u.smsMessageTemplate=T}e.messageNotices.push(u)}}catch(F){r={error:F}}finally{try{p&&!p.done&&(i=c["return"])&&i.call(c)}finally{if(r)throw r.error}}},T.prototype.updateApprovalPivotConfig=function(e,t){var r,i,t=t.propertyValue,n=new de.ApprovalPivotConfig(e.Model);if(n.enable=t.enable,n.expand=t.expand,n.title=t.title,n.approvalPivots=new Array,t.approvalPivots&&0<t.approvalPivots.length)try{for(var o=ue(t.approvalPivots),a=o.next();!a.done;a=o.next()){var s,l=a.value,c=new de.ApprovalPivot(e.Model);c.type=l.type,c.title=l.title,c.description=l.description,l.condition&&((s=new de.Condition(e.Model)).Value=l.condition,c.condition=s),n.approvalPivots.push(c)}}catch(p){r={error:p}}finally{try{a&&!a.done&&(i=o["return"])&&i.call(o)}finally{if(r)throw r.error}}e.approvalPivotConfig=n},T.prototype.updateUrgeHandleRule=function(e,t){var r,i,t=t.propertyValue,n=new de.UrgeHandleRule(e.Model);if(n.urgeHandleAble=t.urgeHandleAble,n.sendType=t.sendType,n.earlyTime=t.earlyTime,n.intervalTime=t.intervalTime,n.urgeMessageSubject=t.urgeMessageSubject,n.urgeMessageContent=t.urgeMessageContent,n.addReminder=t.addReminder,n.subjectEditable=t.subjectEditable,n.contentEditable=t.contentEditable,t.smsMessageTemplate){var o=new de.SmsMessageTemplate(e.Model);if(o.code=t.smsMessageTemplate.code,o.content=t.smsMessageTemplate.content,o.smsMessageVariables=new Array,t.smsMessageTemplate.smsMessageVariables&&0<t.smsMessageTemplate.smsMessageVariables.length)try{for(var a=ue(t.smsMessageTemplate.smsMessageVariables),s=a.next();!s.done;s=a.next()){var l=s.value,c=new de.SmsMessageVariable(e.Model);c.code=l.code,c.value=l.value,c.tag=l.tag,o.smsMessageVariables.push(c)}}catch(p){r={error:p}}finally{try{s&&!s.done&&(i=a["return"])&&i.call(a)}finally{if(r)throw r.error}}n.smsMessageTemplate=o}e.urgeHandleRule=n},T.prototype.removeHumanResourceRoles=function(e){var t=this.flowElement.Model;if(e&&0<e.length){var r,i,n=t.DefaultProcess.GetFlowElements(),o="";for(r in n)n[r]instanceof de.UserActivity&&(i=n[r]).ParticipantSchemes&&0<i.ParticipantSchemes.length&&i.ParticipantSchemes[0].Performers&&(o+=i.ParticipantSchemes[0].Performers+",");e.filter(function(e){return o.indexOf(e)<0}).forEach(function(e){t.DefaultProcess.RemoveResourceRole(e)})}},T.prototype.resetExtendProperty=function(r,e){var t,i;if(r){var n=e.propertyValue;r.extendProperties||(r.extendProperties=new Array);try{for(var o=ue(e.propertyValue),a=o.next();!a.done;a=o.next())!function(t){var e=r.extendProperties.findIndex(function(e){return e.key===t.code});-1<e&&r.extendProperties.splice(e,1)}(a.value)}catch(s){t={error:s}}finally{try{a&&!a.done&&(i=o["return"])&&i.call(o)}finally{if(t)throw t.error}}n&&n.forEach(function(e){var t=new de.ExtendProperty(r.Model);t.key=e.code,t.value=e.value,r.extendProperties.push(t)})}},T.CLR_TYPE_ID=de.UserActivity.Clr_Type_ID;var jd,Hd=T;function T(e,t,r){e=jd.call(this,e,t,r)||this;return e.clrTypeId=T.CLR_TYPE_ID,e.name="审批",e.nameLanguage={"zh-CHS":"审批","zh-CHT":"審批",en:"Approve"},e.imgUrls=((t={})[B.FlowNodeState.Default]=I.IMAGE_PATH+"/approval.png",t[B.FlowNodeState.Selected]=I.IMAGE_PATH+"/approval_select.svg",t),e}n(Kd,_d=Hd),Kd.prototype.createFlowElement=function(e){return _d.prototype.createFlowElement.call(this,e)},Kd.prototype.getFarrisPropConfig=function(){return this.getFarrisPropConfigByIsOperation(!0)},Kd.prototype.updateProps=function(e){this.updatePropsByIsOperation(e,!0)},Kd.CLR_TYPE_ID=de.OperationActivity.Clr_Type_ID;var _d,Gd=Kd;function Kd(e,t,r){e=_d.call(this,e,t,r)||this;return e.clrTypeId=Kd.CLR_TYPE_ID,e.name="人工操作",e.nameLanguage={"zh-CHS":"人工操作","zh-CHT":"人工操作",en:"Operation"},e.imgUrls=((t={})[B.FlowNodeState.Default]=I.IMAGE_PATH+"/bizActivity.png",t[B.FlowNodeState.Selected]=I.IMAGE_PATH+"/bizActivity_select.svg",t),e}var qd,Wd="Id",Jd="Name",$d="NameLanguage",Yd="ClrTypeID",Xd="SelectTargetAble",Zd="JumpScope",Qd="wf_ExecuteForms_PC",eu="wf_ExecuteForms_Mobile",tu="otherAssignNodes",ru="otherAssignActivities",iu="OtherAssignActivityNodeInfos",nu="sendBackedTask",ou=(n(au,qd=ce.NodeCell),au.prototype.createFlowElement=function(e){var t,r=qd.prototype.createFlowElement.call(this,e),i=this.editorUi;return r.Id="startActivity"+B.BpmnModelHelper.GenerateElementId(),null==e&&i&&i.formFormats&&(e=i.formFormats,i=new Array,(t=e.filter(function(e){return"PC"===e.terminal&&1===e.status})[0])&&i.push(t),(t=e.filter(function(e){return"Mobile"===e.terminal&&1===e.status})[0])&&i.push(t),i)&&0<i.length&&r.setDefaultForms(i),r},au.prototype.getFarrisPropConfig=function(){var e,t,r,i,n,o,a=this.editorUi,s=this.flowElement,l=[],a=(l=(l=a.procExtProps&&0<a.procExtProps.length?JSON.parse(JSON.stringify(a.procExtProps)).sort(function(e,t){return e.sortOrder-t.sortOrder}):l).sort(function(e,t){return e.sortOrder-t.sortOrder}),new ce.ElementPropertyConfig),c=new Object,p=(a.categoryId="general",a.categoryName=pe.mxResources.get("basicInformation"),a.tabId="basic",a.tabName=pe.mxResources.get("basicAttributes"),a.properties=[{propertyID:Jd,propertyName:pe.mxResources.get("name"),propertyType:"string",visible:!this.editorUi.multiLangEnabled},{propertyID:$d,propertyName:pe.mxResources.get("nameLanguage"),propertyType:"multiLanguage",visible:this.editorUi.multiLangEnabled},{propertyID:Wd,propertyName:pe.mxResources.get("id"),propertyType:"string",readonly:!0}],new ce.ElementPropertyConfig),d=(p.categoryId="formDef",p.categoryName=pe.mxResources.get("formDef"),p.tabId="basic",p.tabName=pe.mxResources.get("basicAttributes"),p.properties=[{propertyID:Qd,propertyName:pe.mxResources.get("pcForm"),propertyType:"modal"},{propertyID:eu,propertyName:pe.mxResources.get("webForm"),propertyType:"modal"}],new ce.ElementPropertyConfig),u=(d.categoryId="activityConfig",d.categoryName=pe.mxResources.get("activityProperty"),d.tabId="basic",d.tabName=pe.mxResources.get("basicAttributes"),d.properties=[{propertyID:"sendBackedTask",propertyName:pe.mxResources.get("sendBackedTask"),propertyType:"select"}],s.selectTargetAble?(d.properties=d.properties.concat([{propertyID:Xd,propertyName:pe.mxResources.get("selectTargetAble"),propertyType:"select"},{propertyID:Zd,propertyName:pe.mxResources.get("jumpScope"),propertyType:"modal"}]),c.SelectTargetAble=s.selectTargetAble||!1,c.JumpScope=s.jumpScope):(d.properties=d.properties.concat([{propertyID:Xd,propertyName:pe.mxResources.get("selectTargetAble"),propertyType:"select"}]),c.SelectTargetAble=s.selectTargetAble||!1),s.otherAssignNodes?(d.properties=d.properties.concat([{propertyID:tu,propertyName:pe.mxResources.get("otherAssignNodes"),propertyType:"select"},{propertyID:iu,propertyName:pe.mxResources.get("otherAssignActivityNodeInfos"),propertyType:"modal"}]),c[tu]=!0,c[iu]=s.otherAssignNodes.otherAssignActivities||s.otherAssignNodes.otherAssignActivityNodeInfos,s.otherAssignNodes.otherAssignActivities&&(s.otherAssignNodes.otherAssignActivities=null)):(d.properties=d.properties.concat([{propertyID:tu,propertyName:pe.mxResources.get("otherAssignNodes"),propertyType:"select"}]),c[tu]=!1),new Array);try{for(var m=ue(l),f=m.next();!f.done;f=m.next()){var h=f.value;if(!h.parentId){var y={parent:h,childs:new Array};try{for(var g=ue(l),v=g.next();!v.done;v=g.next()){var b=v.value;b.parentId===h.id&&y.childs.push(b)}}catch(I){r={error:I}}finally{try{v&&!v.done&&(i=g["return"])&&i.call(g)}finally{if(r)throw r.error}}u.push(y)}}}catch(S){e={error:S}}finally{try{f&&!f.done&&(t=m["return"])&&t.call(m)}finally{if(e)throw e.error}}if(u&&0<u.length){var x=new ce.ElementPropertyConfig;x.categoryId="extendPropertyConfig",x.categoryName=pe.mxResources.get("extendPropertyConfig"),x.tabId="advanced",x.tabName=pe.mxResources.get("advancedAttributes"),x.properties=new Array;try{for(var w=ue(u),P=w.next();!P.done;P=w.next()){var C=P.value;x.properties.push({propertyID:C.parent.id,propertyName:C.parent.propertyTitle,propertyType:"modal"}),s.extendProperties&&0<s.extendProperties.length&&C.childs.sort(function(e,t){return e.sortOrder-t.sortOrder}).forEach(function(t){s.extendProperties.forEach(function(e){e.key==t.code&&(t.value=e.value)})}),c[C.parent.id]=C.childs}}catch(E){n={error:E}}finally{try{P&&!P.done&&(o=w["return"])&&o.call(w)}finally{if(n)throw n.error}}return c[Wd]=s.Id,c[Yd]=s.ClrTypeID,c[Jd]=s.Name||pe.mxResources.get("start"),c[$d]=s.NameLanguage||{"zh-CHS":s.Name},c[nu]=s.sendBackedTask,c[Qd]=s.ExecuteForms?s.ExecuteForms.find(function(e){return"PC"===e.TerminalType}):null,c[eu]=s.ExecuteForms?s.ExecuteForms.find(function(e){return"MOBILE"===e.TerminalType}):null,{propertyConfig:[a,p,d,x],propertyData:c}}return c[Wd]=s.Id,c[Yd]=s.ClrTypeID,c[Jd]=s.Name||pe.mxResources.get("start"),c[$d]=s.NameLanguage||{"zh-CHS":s.Name},c[nu]=s.sendBackedTask,c[Qd]=s.ExecuteForms?s.ExecuteForms.find(function(e){return"PC"===e.TerminalType}):null,c[eu]=s.ExecuteForms?s.ExecuteForms.find(function(e){return"MOBILE"===e.TerminalType}):null,{propertyConfig:[a,p,d],propertyData:c}},au.prototype.updateProps=function(e){var t=this.editorUi,r=this.flowElement,i=e.propertyID;switch(i){case Qd:this.updateStartActivityForm(r,e,"PC"),e.parameters&&0<e.parameters.length&&S.updateFormalParameters(t.graph.bpmnModel.DefaultProcess,e.parameters);break;case eu:this.updateStartActivityForm(r,e,"MOBILE"),e.parameters&&0<e.parameters.length&&S.updateFormalParameters(t.graph.bpmnModel.DefaultProcess,e.parameters);break;case Xd:this.resetSelectTargetAble(r,e);break;case Zd:this.resetJumpScope(r,e);break;case tu:this.updateOtherAssignNodes(r,e);break;case ru:case iu:this.updateOtherAssignActivities(r,e);break;default:-1<t.procExtProps.findIndex(function(e){return e.id===i})?this.resetExtendProperty(r,e):qd.prototype.updateProps.call(this,e)}},au.prototype.updateStartActivityForm=function(e,t,r){var i;if(e){t=t.propertyValue;if(e.ExecuteForms||(e.ExecuteForms=new Array),e.ExecuteForms=e.ExecuteForms.filter(function(e){return e.TerminalType!==r}),t){var n=t.ActualParameters,o=new Array;if(n&&0<n.length)try{for(var a=ue(n),s=a.next();!s.done;s=a.next()){var l=s.value,c=new de.ActualParameter(e.Model,l.Name,l.Value);l.Tag?c.Tag=l.Tag:l.Value?8<=l.Value.length&&'{"expr":'===l.Value.slice(0,8)?c.Tag="expression":c.Tag="constant":c.Tag="variable",o.push(c)}}catch(d){i={error:d}}finally{try{s&&!s.done&&(p=a["return"])&&p.call(a)}finally{if(i)throw i.error}}var n=B.BpmnModelHelper.GenerateElementId(),p=new de.ExecuteForm(e.Model,n,t.Name,o);p.ComponentId=t.ComponentId,p.FormType=t.FormType,p.formFormatId=t.formFormatId,p.formatConfigId=t.formatConfigId,p.TerminalType=t.TerminalType,e.ExecuteForms.push(p)}}},au.prototype.resetSelectTargetAble=function(e,t){t=t.propertyValue;e.selectTargetAble=t,e.selectTargetAble?e.jumpScope=new de.JumpScope(e.Model):e.jumpScope=null},au.prototype.resetJumpScope=function(e,t){var r,t=t.propertyValue;t?((r=new de.JumpScope(e.Model)).Category=t.Category,r.DefaultType=t.DefaultType,r.DefaultActivity=t.DefaultActivity,r.DestinationActivities=t.DestinationActivities,e.jumpScope=r):e.jumpScope=null},au.prototype.updateOtherAssignNodes=function(e,t){t=t.propertyValue;e.otherAssignNodes=t?new de.OtherAssignNodes(e.Model):null},au.prototype.updateOtherAssignActivities=function(r,e){e=e.propertyValue;e&&0<e.length?"string"==typeof e[0]?(r.otherAssignNodes.otherAssignActivityNodeInfos=new Array,e.forEach(function(e){var t=new de.OtherAssignActivityNodeInfo(r.Model);t.activityDefinitionId=e,t.required=!1,t.condition=new de.Condition(r.Model),r.otherAssignNodes.otherAssignActivityNodeInfos.push(t)})):(r.otherAssignNodes.otherAssignActivityNodeInfos=new Array,e.forEach(function(e){var t=new de.OtherAssignActivityNodeInfo(r.Model);t.activityDefinitionId=e.activityDefinitionId,t.required=e.required,t.condition=new de.Condition(r.Model),t.condition.Value=e.condition.Value,r.otherAssignNodes.otherAssignActivityNodeInfos.push(t)})):r.otherAssignNodes.otherAssignActivityNodeInfos=new Array},au.prototype.resetExtendProperty=function(r,e){var t,i;if(r){var n=e.propertyValue;r.extendProperties||(r.extendProperties=new Array);try{for(var o=ue(e.propertyValue),a=o.next();!a.done;a=o.next())!function(t){var e=r.extendProperties.findIndex(function(e){return e.key===t.code});-1<e&&r.extendProperties.splice(e,1)}(a.value)}catch(s){t={error:s}}finally{try{a&&!a.done&&(i=o["return"])&&i.call(o)}finally{if(t)throw t.error}}n&&n.forEach(function(e){var t=new de.ExtendProperty(r.Model);t.key=e.code,t.value=e.value,r.extendProperties.push(t)})}},au.CLR_TYPE_ID=de.StartActivity.Clr_Type_ID,au);function au(e,t,r){e=qd.call(this,e,t,r)||this;return e.clrTypeId=au.CLR_TYPE_ID,e.name="开始",e.nameLanguage={"zh-CHS":"开始","zh-CHT":"開始",en:"Start"},e.imgUrls=((t={})[B.FlowNodeState.Default]=I.IMAGE_PATH+"/start.png",t[B.FlowNodeState.Selected]=I.IMAGE_PATH+"/start_select.svg",t),e}n(cu,su=ce.ParallelGatewayCell),cu.prototype.createFlowElement=function(e){e=su.prototype.createFlowElement.call(this,e);return e.Id="ParallelGateway"+B.BpmnModelHelper.GenerateElementId(),e};var su,lu=cu;function cu(){var e,t=null!==su&&su.apply(this,arguments)||this;return t.imgUrls=((e={})[B.FlowNodeState.Default]=I.IMAGE_PATH+"/ParallelGateway.png",e[B.FlowNodeState.Selected]=I.IMAGE_PATH+"/ParallelGateway_select.svg",e),t}n(uu,pu=ce.EndEventCell),uu.prototype.createFlowElement=function(e){e=pu.prototype.createFlowElement.call(this,e);return e.Id="EndEvent"+B.BpmnModelHelper.GenerateElementId(),e};var pu,du=uu;function uu(){var e,t=null!==pu&&pu.apply(this,arguments)||this;return t.imgUrls=((e={})[B.FlowNodeState.Default]=I.IMAGE_PATH+"/end.png",e[B.FlowNodeState.Selected]=I.IMAGE_PATH+"/end_select.svg",e),t}n(hu,mu=ce.InclusiveGatewayCell),hu.prototype.createFlowElement=function(e){e=mu.prototype.createFlowElement.call(this,e);return e.Id="InclusiveGateway"+B.BpmnModelHelper.GenerateElementId(),e};var mu,fu=hu;function hu(){var e,t=null!==mu&&mu.apply(this,arguments)||this;return t.imgUrls=((e={})[B.FlowNodeState.Default]=I.IMAGE_PATH+"/InclusiveGateway.png",e[B.FlowNodeState.Selected]=I.IMAGE_PATH+"/InclusiveGateway_select.png",e),t}gu.prototype.ngOnInit=function(){var e,t,r=this.activityModel.dynamicParticipants.filter(function(e){return"AddSignFront"===e.actionScope}),i=this.activityModel.dynamicParticipants.filter(function(e){return"AddSignBehind"===e.actionScope}),n=this.activityModel.dynamicParticipants.filter(function(e){return"Transfer"===e.actionScope}),o=this.activityModel.dynamicParticipants.filter(function(e){return"Notify"===e.actionScope});!r[0]||r[0].organizationLevel?this.addSignFrontScope={enable:this.activityModel.AddSignFrontAble,action:"AddSignFront",scope:r[0]}:(e=new Fo,(t=new Ko).potentialOwnerList=r,t.isAllScope=!0,e.participantInfo=t,this.addSignFrontScope={enable:this.activityModel.AddSignFrontAble,action:"AddSignFront",scope:e}),!i[0]||i[0].organizationLevel?this.addSignBehindScope={enable:this.activityModel.AddSignBehindAble,action:"AddSignBehind",scope:i[0]}:(e=new Fo,(t=new Ko).potentialOwnerList=i,t.isAllScope=!0,e.participantInfo=t,this.addSignBehindScope={enable:this.activityModel.AddSignBehindAble,action:"AddSignBehind",scope:e}),!n[0]||n[0].organizationLevel?this.transferScope={enable:this.activityModel.transferAble,action:"Transfer",scope:n[0]}:(e=new Fo,(t=new Ko).potentialOwnerList=n,t.isAllScope=!0,e.participantInfo=t,this.transferScope={enable:this.activityModel.transferAble,action:"Transfer",scope:e}),!o[0]||o[0].organizationLevel?this.notifyScope={enable:this.activityModel.NotifyAble,action:"Notify",scope:o[0]}:(e=new Fo,(t=new Ko).potentialOwnerList=o,t.isAllScope=!0,e.participantInfo=t,this.notifyScope={enable:this.activityModel.NotifyAble,action:"Notify",scope:e}),this.backWardRule=this.activityModel.BackWardRule},gu.prototype.clickOK=function(){var e,t=[];this.addSignFrontEnable&&(e={type:"addSignfront",actis:this.addSignFrontActis,config:this.addSignFrontScope},t.push(e)),this.addSignBehindEnable&&(e={type:"addSignBehind",actis:this.addSignFrontActis,config:this.addSignBehindScope},t.push(e)),this.transferEnable&&(e={type:"transfer",actis:this.addSignFrontActis,config:this.transferScope},t.push(e)),this.notifyEnable&&(e={type:"notify",actis:this.addSignFrontActis,config:this.notifyScope},t.push(e)),this.backWardRuleEnable&&(e={type:"backWardRule",actis:this.addSignFrontActis,config:this.backWardRule},t.push(e)),t&&0<t.length&&this.batchSet(t),this.submit.next()},gu.prototype.clickCancel=function(){this.cancel.next()},gu.prototype.batchSet=function(e){this.viewModel.batchSet(bu.batchSetProperty,e)},gu.decorators=[{type:b.Component,args:[{selector:"lib-batch-set-properties",template:'<div class="f-page">\r\n  <section class="f-page-main d-flex flex-column"\r\n    style="overflow:scroll;border-radius:10px;border: 1.5px solid #F1F3F7;">\r\n    <div class="f-form-layout farris-form mx-3">\r\n      <fieldset class="f-section-formgroup">\r\n        <div class="f-section-formgroup-inputs">\r\n          <div class="col-12 mt-3">\r\n            <div class="farris-group-wrap">\r\n              <div class="form-group farris-form-group">\r\n                <label class="col-form-label">\r\n                  <span class="farris-label-text">{{\'component.batchSet.targetNode\' | wfLocale}}</span>\r\n                </label>\r\n                <div class="farris-input-wrap">\r\n                  <farris-lookup-grid #addSignFrontActisDialog [items]="useractivities" [columns]="cols"\r\n                    [resizable]="true" [singleSelect]="false" [idField]="\'Id\'" [textField]="\'Name\'" [(ngModel)]="actis1"\r\n                    [valueField]="\'Id\'" [pagination]="false" [pageIndex]="pageInfo.pageIndex" name="addSignFrontActis"\r\n                    [pageSize]="pageInfo.pageSize" [pageList]="pageInfo.pageList" [total]="total" [enableClear]="false"\r\n                    title="{{\'component.batchSet.targetNode\'|wfLocale}}" [displayType]="\'List\'"\r\n                    [remoteSearch]=\'false\' [enableToSelect]="false"\r\n                    placeholder="{{\'component.messageNoticeEdit.placeholder\'|wfLocale}}" [dictPicked]="frontActisSelect"\r\n                    [nosearch]="true" [showFilterBar]="false">\r\n                  </farris-lookup-grid>\r\n                  <div class="farris-feedback valid-feedback"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n    </fieldset>\r\n</div>\r\n\x3c!-- 征询 --\x3e\r\n  <div class="f-form-layout farris-form mx-3">\r\n    <fieldset class="f-section-formgroup">\r\n      <div class="f-section-formgroup-inputs">\r\n        <div class="farris-form form-inline farris-form-inline col-12">\r\n          <div class="farris-group-auto">\r\n            <div class="form-group farris-form-group">\r\n              <label class="col-3 col-form-label" style="padding-right: 79px;padding-left: 0px;">\r\n                <span class="farris-label-text">{{\'component.batchSet.addSignFront\' | wfLocale}}</span>\r\n              </label>\r\n              <div class="col-9 col-form-label">\r\n                <farris-switch [(ngModel)]="addSignFrontEnable" name="addSignFrontEnable"></farris-switch>\r\n                <div class="farris-feedback valid-feedback"></div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </fieldset>\r\n  </div>\r\n\x3c!-- 加签 --\x3e\r\n  <div class="f-form-layout farris-form mx-3">\r\n    <fieldset class="f-section-formgroup">\r\n      <div class="f-section-formgroup-inputs">\r\n        <div class="farris-form form-inline farris-form-inline col-12">\r\n          <div class="farris-group-auto">\r\n            <div class="form-group farris-form-group">\r\n              <label class="col-3 col-form-label" style="padding-right: 79px;padding-left: 0px;">\r\n                <span class="farris-label-text">{{\'component.batchSet.addSignBehind\' | wfLocale}}</span>\r\n              </label>\r\n              <div class="col-9 col-form-label">\r\n                <farris-switch [(ngModel)]="addSignBehindEnable" name="addSignBehindEnable"></farris-switch>\r\n                <div class="farris-feedback valid-feedback"></div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </fieldset>\r\n  </div>\r\n  <div class="f-form-layout farris-form mx-3">\r\n    <fieldset class="f-section-formgroup">\r\n      <div class="f-section-formgroup-inputs">\r\n        <div class="farris-form form-inline farris-form-inline col-12">\r\n          <div class="farris-group-auto">\r\n            <div class="form-group farris-form-group">\r\n              <label class="col-3 col-form-label" style="padding-right: 79px;padding-left: 0px;">\r\n                <span class="farris-label-text">{{\'component.batchSet.transfer\' | wfLocale}}</span>\r\n              </label>\r\n              <div class="col-9 col-form-label">\r\n                <farris-switch [(ngModel)]="transferEnable" name="transferEnable"></farris-switch>\r\n                <div class="farris-feedback valid-feedback"></div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </fieldset>\r\n  </div>\r\n  <div class="f-form-layout farris-form mx-3">\r\n    <fieldset class="f-section-formgroup">\r\n      <div class="f-section-formgroup-inputs">\r\n        <div class="farris-form form-inline farris-form-inline col-12">\r\n          <div class="farris-group-auto">\r\n            <div class="form-group farris-form-group">\r\n              <label class="col-3 col-form-label" style="padding-right: 79px;padding-left: 0px;">\r\n                <span class="farris-label-text">{{\'component.batchSet.notify\' | wfLocale}}</span>\r\n              </label>\r\n              <div class="col-9 col-form-label">\r\n                <farris-switch [(ngModel)]="notifyEnable" name="notifyEnable"></farris-switch>\r\n                <div class="farris-feedback valid-feedback"></div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </fieldset>\r\n  </div>\r\n  <div class="f-form-layout farris-form mx-3">\r\n    <fieldset class="f-section-formgroup">\r\n      <div class="f-section-formgroup-inputs">\r\n        <div class="farris-form form-inline farris-form-inline col-12">\r\n          <div class="farris-group-auto">\r\n            <div class="form-group farris-form-group">\r\n              <label class="col-3 col-form-label" style="padding-right: 54px;padding-left: 0px;">\r\n                <span class="farris-label-text">{{\'component.batchSet.backWardRule\' | wfLocale}}</span>\r\n              </label>\r\n              <div class="col-9 col-form-label">\r\n                <farris-switch [(ngModel)]="backWardRuleEnable" name="backWardRuleEnable"></farris-switch>\r\n                <div class="farris-feedback valid-feedback"></div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </fieldset>\r\n  </div>\r\n</section>\r\n</div>\r\n\r\n<ng-template #footer>\r\n  <button type="button" class="btn btn-secondary btn-sm" (click)="clickCancel()">{{\'component.note.clickCancel\' |\r\n    wfLocale}}</button>\r\n  <button type="button" class="btn btn-primary btn-sm mx-2" (click)="clickOK()">{{\'component.note.clickOK\' |\r\n    wfLocale}}</button>\r\n</ng-template>',providers:[x],styles:[""]}]}],gu.ctorParameters=function(){return[{type:a},{type:String,decorators:[{type:b.Inject,args:[b.LOCALE_ID]}]},{type:undefined,decorators:[{type:b.Inject,args:[o]}]},{type:x,decorators:[{type:b.Optional}]},{type:b.ComponentFactoryResolver},{type:b.Injector},{type:i.BsModalService},{type:Ip}]},gu.propDecorators={footer:[{type:b.ViewChild,args:["footer"]}],modalFooter:[{type:b.ViewChild,args:["iconSelectFooter"]}]};var yu=gu;function gu(e,t,r,i,n,o,a,s){var l=this;this.uistate=e,this.localeId=t,this.resources=r,this.localePipe=i,this.resolver=n,this.injector=o,this.modalService=a,this.viewModel=s,this.groupIcon2='<i class="f-icon f-icon-lookup"></i>',this.submit=new v.Subject,this.cancel=new v.Subject,this.cols=[{title:this.localePipe.transform("component.batchSet.name"),field:"Name",width:60,searchField:"Name"},{title:"ID",field:"Id",width:90,searchField:"Id"}],this.useractivities=[],this.useroperationnotifyactivities=[],this.useroperationsubcatchactivities=[],this.actis1=[],this.actis2=[],this.actis3=[],this.actis4=[],this.actis5=[],this.addSignFrontActis=[],this.addSignBehindActis=[],this.transferActis=[],this.notifyActis=[],this.backWardRuleActis=[],this.nullActis=[],this.addSignFrontEnable=!1,this.addSignBehindEnable=!1,this.transferEnable=!1,this.notifyEnable=!1,this.backWardRuleEnable=!1,this.backWardRule={},this.addSignFrontScope={},this.addSignBehindScope={},this.transferScope={},this.notifyScope={},this.pageInfo={pageIndex:1,pageList:[10,20,30,50],pageSize:20},this.frontActisSelect=function(e){return l.addSignFrontActis=e,v.of({closeDialog:!0})},this.behindActisSelect=function(e){return l.addSignBehindActis=e,v.of({closeDialog:!0})},this.notifyActisSelect=function(e){return l.notifyActis=e,v.of({closeDialog:!0})},this.transferActisSelect=function(e){return l.transferActis=e,v.of({closeDialog:!0})},this.backWardRuleActisSelect=function(e){return l.backWardRuleActis=e,v.of({closeDialog:!0})},this.actisSelect=function(e){return v.of({closeDialog:!0})},this.useractivities=this.uistate.userActList.filter(function(e){return e.ClrTypeID===de.UserActivity.Clr_Type_ID}),this.useroperationnotifyactivities=w(this.uistate.userActList,this.uistate.NotifyActKist),this.useroperationsubcatchactivities=w(this.uistate.userActList,this.uistate.SubAndCatchActList),this.localePipe=this.localePipe||new x(t,r)}var vu,bu={batchSetProperty:"batchSetProperty"},xu=(n(wu,vu=ce.EditorUi),wu.prototype.createActions=function(){var e=vu.prototype.createActions.call(this);return"edit"===this.action&&"rt"!==this.time||(e.getAction(ce.ActionKeys.pmf_delete).isEnabled=function(){return!1}),e},wu.prototype.createToolbox=function(){var e=vu.prototype.createToolbox.call(this),t=new ce.ToolboxGroup;return t.name=pe.mxResources.get("basicElements"),t.items.push(new ce.ToolboxItem(ou.CLR_TYPE_ID),new ce.ToolboxItem(yd.CLR_TYPE_ID),new ce.ToolboxItem(lu.CLR_TYPE_ID),new ce.ToolboxItem(fu.CLR_TYPE_ID),new ce.ToolboxItem(Hd.CLR_TYPE_ID),new ce.ToolboxItem(Gd.CLR_TYPE_ID),new ce.ToolboxItem(Bd.CLR_TYPE_ID),new ce.ToolboxItem(Sd.CLR_TYPE_ID),new ce.ToolboxItem(Pd.CLR_TYPE_ID),new ce.ToolboxItem(Ad.CLR_TYPE_ID),new ce.ToolboxItem(Md.CLR_TYPE_ID),new ce.ToolboxItem(bd.CLR_TYPE_ID),new ce.ToolboxItem(du.CLR_TYPE_ID)),e.groups=[t],e},wu.prototype.createGraphInstance=function(){var n=this,o=new pd(this,this.diagramContainer);return"view"===this.action||"rt"===this.time||"assignView"===this.action?o.setCellsLocked(!0):(o.setDropEnabled(!0),o.setConnectable(!0)),o.popupMenuHandler.autoExpand=!0,o.popupMenuHandler.factoryMethod=function(e,i,t){var r=o.getChildCells(o.getDefaultParent());null!=i&&-1<i.clrTypeId.indexOf("wf.UserActivity")&&-1<r.findIndex(function(e){return e.id===i.getId()})&&e.addItem("批量复制属性",null,function(){var e=n.resolver.resolveComponentFactory(yu).create(n.injector),t=(e.instance.activityModel=i.flowElement,{title:"批量复制属性",width:512,height:465,showButtons:!0,buttons:e.instance.footer}),r=n.modalService.show(e,t);e.instance.cancel.subscribe(function(e){return r.close()}),e.instance.submit.subscribe(function(e){r.close()})})},o},wu.prototype.createSidebar=function(){return new md(this,this.sidebarContainer)},wu.prototype.show=function(){var t=this,e=(vu.prototype.show.call(this),"view"!==this.action&&"assignView"!==this.action||((e=this.createSpan("")).style.fontSize="14px",e.style.color="white",e.style.borderRadius="20px",e.style.padding="4px 20px",e.style.background="rgb(199, 194, 187)",r=document.createTextNode(pe.mxResources.get("readOnly")),e.appendChild(r),(r=this.createDiv("")).style.position="absolute",r.style.top="10px",r.style.right="10px",r.style.zIndex="2",r.appendChild(e),this.container.appendChild(r)),document.createElement("a")),r=(e.setAttribute("href","javascript:void(0);"),document.createElement("img")),r=(e.style.marginRight="10px",r.src=I.IMAGE_PATH+"/zoomIn.svg",r.style.display="inline-block",r.style.verticalAlign="middle",e.appendChild(r),pe.mxEvent.addListener(e,"click",function(e){t.actions.getAction(ce.ActionKeys.pmf_zoomIn).execute(e)}),document.createElement("a")),i=(r.setAttribute("href","javascript:void(0);"),document.createElement("img")),i=(i.src=I.IMAGE_PATH+"/zoomOut.svg",i.style.display="inline-block",i.style.verticalAlign="middle",r.appendChild(i),pe.mxEvent.addListener(r,"click",function(e){t.actions.getAction(ce.ActionKeys.pmf_zoomOut).execute(e)}),this.createDiv("zoomBar")),n=(i.style.position="absolute",i.style.zIndex="2",10);this.showMenubar&&(n+=this.menubarHeight),this.showToolbar&&(n+=this.toolbarHeight),i.style.top=n+"px",i.style.left=(this.showSidebar?this.sidebarSplitPosition+this.sidebarSplitSize:0)+10+"px",i.appendChild(e),i.appendChild(r),this.container.appendChild(i),this.zoomBar=i},wu.prototype.sidebarSplitOnChange=function(e){vu.prototype.sidebarSplitOnChange.call(this,e),this.zoomBar&&(this.zoomBar.style.left=(this.showSidebar?this.sidebarSplitPosition+this.sidebarSplitSize:0)+10+"px")},wu.prototype.createSpan=function(e){var t=document.createElement("span");return t.className=e,t},wu.prototype.loadBizActivities=function(e){this.sidebar&&this.sidebar.addBizActPalette(e)},wu.prototype.batchCopyProperty=function(e){var t,r,i=e.value.targetNodeID;e.propertyValue=e.value.messageNotice,e.propertyID=Ds;try{for(var n=ue(i),o=n.next();!o.done;o=n.next()){var a=o.value,s=this.graph.getCellByFlowElementId(a);s&&(s.updateProps(e),this.graph.refresh())}}catch(l){t={error:l}}finally{try{o&&!o.done&&(r=n["return"])&&r.call(n)}finally{if(t)throw t.error}}},wu.prototype.batchSetProperty=function(e){var t,r,i,n,o,a,s,l,c,p,d,u;try{for(var m=ue(e),f=m.next();!f.done;f=m.next()){var h=f.value;switch(h.type){case"addSignfront":var y=h.actis;e.propertyValue=h.config,e.propertyID=gs;try{for(var g=ue(y),v=g.next();!v.done;v=g.next()){var b=v.value;(k=this.graph.getCellByFlowElementId(b.Id))&&(k.updateProps(e),this.graph.refresh())}}catch(O){i={error:O}}finally{try{v&&!v.done&&(n=g["return"])&&n.call(g)}finally{if(i)throw i.error}}break;case"addSignBehind":var x=h.actis;e.propertyValue=h.config,e.propertyID=vs;try{for(var w=ue(x),P=w.next();!P.done;P=w.next()){b=P.value;(k=this.graph.getCellByFlowElementId(b.Id))&&(k.updateProps(e),this.graph.refresh())}}catch(M){o={error:M}}finally{try{P&&!P.done&&(a=w["return"])&&a.call(w)}finally{if(o)throw o.error}}break;case"transfer":var R=h.actis;e.propertyValue=h.config,e.propertyID=Ts;try{for(var C=ue(R),I=C.next();!I.done;I=C.next()){b=I.value;(k=this.graph.getCellByFlowElementId(b.Id))&&(k.updateProps(e),this.graph.refresh())}}catch(D){s={error:D}}finally{try{I&&!I.done&&(l=C["return"])&&l.call(C)}finally{if(s)throw s.error}}break;case"notify":var V=h.actis;e.propertyValue=h.config,e.propertyID=bs;try{for(var S=ue(V),E=S.next();!E.done;E=S.next()){b=E.value;(k=this.graph.getCellByFlowElementId(b.Id))&&(k.updateProps(e),this.graph.refresh())}}catch(N){c={error:N}}finally{try{E&&!E.done&&(p=S["return"])&&p.call(S)}finally{if(c)throw c.error}}break;case"backWardRule":var z=h.actis;e.propertyValue=h.config,e.propertyID=Ps;try{for(var T=ue(z),A=T.next();!A.done;A=T.next()){var k,b=A.value;(k=this.graph.getCellByFlowElementId(b.Id))&&(k.updateProps(e),this.graph.refresh())}}catch(L){d={error:L}}finally{try{A&&!A.done&&(u=T["return"])&&u.call(T)}finally{if(d)throw d.error}}}}}catch(F){t={error:F}}finally{try{f&&!f.done&&(r=m["return"])&&r.call(m)}finally{if(t)throw t.error}}},wu.prototype.createBpmnModel=function(e,t){this.graph.createBpmnModelWithProcInfo(e,t)},wu.prototype.openBpmnModel=function(e){this.graph.loadBpmnModel(e)},wu.prototype.refreshProperty=function(e){e=this.graph.getCellByFlowElementId(e.Id);return this.getFarrisPropConfig([e])},wu.prototype.getActivities=function(){var t=[],r=this.graph.bpmnModel.DefaultProcess.GetFlowElements();return Object.keys(r).forEach(function(e){e=r[e];e.ClrTypeID!==de.UserActivity.Clr_Type_ID&&e.ClrTypeID!==de.OperationActivity.Clr_Type_ID||t.push(e)}),t},wu.prototype.getEndEvents=function(){var t=[],r=this.graph.bpmnModel.DefaultProcess.GetFlowElements();return Object.keys(r).forEach(function(e){e=r[e];"bpmn.EndEvent"!==e.ClrTypeID&&e.ClrTypeID!==de.UserActivity.Clr_Type_ID&&e.ClrTypeID!==de.OperationActivity.Clr_Type_ID||t.push(e)}),t},wu.prototype.getNotifyEvents=function(){var t=[],r=this.graph.bpmnModel.DefaultProcess.GetFlowElements();return Object.keys(r).forEach(function(e){e=r[e];"wf.NotifyActivity"===e.ClrTypeID&&t.push(e)}),t},wu.prototype.getMessageEvents=function(){var t=[],r=this.graph.bpmnModel.DefaultProcess.GetFlowElements();return Object.keys(r).forEach(function(e){e=r[e];"bpmn.MessageEvent"===e.ClrTypeID&&t.push(e)}),t},wu.prototype.getSubAndCatchEvents=function(){var t=[],r=this.graph.bpmnModel.DefaultProcess.GetFlowElements();return Object.keys(r).forEach(function(e){e=r[e];"wf.CallActivitySubProcess"!==e.ClrTypeID&&"wf.IntermediateCatchEventImpl"!==e.ClrTypeID||t.push(e)}),t},wu.prototype.getStartMode=function(){var e,t,r=null,i=this.graph.bpmnModel.DefaultProcess.GetExtensionElements();if(0<i.length)try{for(var n=ue(i),o=n.next();!o.done;o=n.next()){var a=o.value;a instanceof de.ProcessHeader&&(r=a.startMode)}}catch(s){e={error:s}}finally{try{o&&!o.done&&(t=n["return"])&&t.call(n)}finally{if(e)throw e.error}}return r},wu);function wu(e,t,r,i,n,o,a,s){r=vu.call(this,r,a,s=void 0===s?!0:s)||this,r.injector=i,r.modalService=n,r.resolver=o,r.generalConfig={enableTransfer:!0,enableNotify:!1,enableAddSignBehind:!1,enableAddSignFront:!1},a="";try{a=window.gspframeworkService.common.getBasePath.get()}catch(l){}return pe.mxResources.add(a+"/platform/runtime/common/web/@gsp-wf/wf-process-editor/resources/wf-process-editor"),r.showToolbar=!1,r.time=e,r.action=t,r}Cu.validator=function(e,t){var r,i=this.validateActivityList(e);return i.valid?(r=this.validatePrcoessVaris(e)).valid?{valid:!0,warningList:this.warningValidator(e,t)}:r:i},Cu.warningValidator=function(e,t){var r=new Array;return this.validateParallelGateway(e,r),this.validateProcCmps(e,t,r),this.validateApprovalPerformers(e,r),r},Cu.validateProcCmps=function(e,t,r){var i;if("inSuite"!==t){t=e.DefaultProcess.GetExtensionElements(),e=t.find(function(e){return e instanceof de.ProcessHeader});if(e){t=t.filter(function(e){return e instanceof de.Component});if(t&&0!==t.length){if(e.startMode===de.StartMode.DIRECT){e=t.filter(function(e){return Dp.isPfComponent(e.MetadataId)});if(e&&0<e.length){var n="";try{for(var o=ue(e),a=o.next();!a.done;a=o.next())var s=a.value,n=n.concat(s.Name+", ")}catch(c){i={error:c}}finally{try{a&&!a.done&&(l=o["return"])&&l.call(o)}finally{if(i)throw i.error}}n=n.slice(0,n.length-1);var l={id:"directProcessWithPFCmp",title:this.localePipe.instant("validate.directNoPf"),msg:this.localePipe.instant("validate.directNoPfMsg")+(n+" "),type:"processWarning"};r.push(l)}t.some(function(e){return e.Time===de.ToolTime.LOADDATA})||(l={id:"lackLoadDataCmp",title:this.localePipe.instant("validate.noLoadDataCmp"),msg:this.localePipe.instant("validate.noLoadDataCmpMsg"),type:"processWarning"},r.push(l)),t.some(function(e){return e.Time===de.ToolTime.PROCESSINSTANCE_STARTED})||(l={id:"lackProcessStartCmp",title:this.localePipe.instant("validate.noStartCmp"),msg:this.localePipe.instant("validate.noStartCmpMsg"),type:"processWarning"},r.push(l)),t.some(function(e){return e.Time===de.ToolTime.PROCESSINSTANCE_COMPLETED})||(l={id:"lackProcessCompleteCmp",title:this.localePipe.instant("validate.lackProcessCompleteCmp"),msg:this.localePipe.instant("validate.lackProcessCompleteCmpMsg"),type:"processWarning"},r.push(l)),t.some(function(e){return"PROCESSINSTANCE_ABORTED"===e.Time})||(l={id:"lackProcessAbortCmp",title:this.localePipe.instant("validate.lackProcessAbortCmp"),msg:this.localePipe.instant("validate.lackProcessAbortCmpMsg"),type:"processWarning"},r.push(l)),t.some(function(e){return"PROCESSINSTANCE_CANCELED"===e.Time})||(l={id:"lackProcessCancelCmp",title:this.localePipe.instant("validate.lackProcessCancelCmp"),msg:this.localePipe.instant("validate.lackProcessCancelCmpMsg"),type:"processWarning"},r.push(l)),t.some(function(e){return"PROCESSINSTANCE_ROLLBACK"===e.Time})||(l={id:"lackProcessBackCmp",title:this.localePipe.instant("validate.lackProcessBackCmp"),msg:this.localePipe.instant("validate.lackProcessBackCmpMsg"),type:"processWarning"},r.push(l)),t.some(function(e){return"PROCESSINSTANCE_RESUBMIT"===e.Time})||(l={id:"lackProcessReStartCmp",title:this.localePipe.instant("validate.lackProcessReStartCmp"),msg:this.localePipe.instant("validate.lackProcessReStartCmpMsg"),type:"processWarning"},r.push(l))}}else l={id:"lackCmp",title:this.localePipe.instant("validate.cmpsEmpty"),msg:this.localePipe.instant("validate.cmpsEmptyMsg"),type:"processWarning"},r.push(l)}else console.error(this.localePipe.instant("validate.noProcessHeader"))}},Cu.validateParallelGateway=function(e,t){var r,i=e.DefaultProcess.GetFlowElements(),n=0;for(r in i)i[r]instanceof B.ParallelGateway&&n++;n%2!=0&&(e={id:"parallelGatewayCheck",title:this.localePipe.instant("validate.parallelGatewayCheck"),msg:this.localePipe.instant("validate.parallelGatewayCheckMsg"),type:"processWarning"},t.push(e))},Cu.validateApprovalPerformers=function(e,t){var r,i=e.DefaultProcess.GetFlowElements(),n=0;for(r in i){var o=i[r];!(o instanceof de.UserActivity||o instanceof de.OperationActivity)||0!=o.GetResourceRoles().length||o.AssignPerformerConfig&&o.AssignPerformerConfig.AllowGlobalAssign||(o={id:"approvalPerformerCheck"+n,title:"【"+i[r].Name+"】"+this.localePipe.instant("validate.approvalPerformerCheck"),msg:"",type:"processWarning"},t.push(o),n++)}},Cu.validatePrcoessVaris=function(e){var t,r,i,n=e.DefaultProcess.GetDataObjects(),o=new Array,a=(n&&0<n.length&&(o=n.filter(function(e){return"CustomType"!==e.DataType.Category}).map(function(e){return e.Name})),e.DefaultProcess.GetFlowElements());for(i in a)if(a[i]instanceof de.UserActivity||a[i]instanceof de.OperationActivity||a[i]instanceof de.AutoActivity||a[i]instanceof de.MessageActivity||a[i]instanceof de.CallActivitySubProcess||a[i]instanceof de.IntermediateCatchEventImpl||a[i]instanceof de.NotifyActivity){var s=a[i].variableSettings;if(s){var l=this;try{for(var c=ue(s),p=c.next();!p.done;p=c.next()){var d=function(t){if(!o.some(function(e){return e===t.variableCode}))return{value:{valid:!1,type:"message",level:"warning",message:"【"+a[i].Name+"】"+l.localePipe.instant("validate.noVariable1")+"【"+t.variableName+"】"+l.localePipe.instant("validate.noVariable2")}}}(p.value);if("object"==typeof d)return d.value}}catch(u){t={error:u}}finally{try{p&&!p.done&&(r=c["return"])&&r.call(c)}finally{if(t)throw t.error}}}}return{valid:!0}},Cu.validateActivityList=function(e){var e=e.DefaultProcess.GetFlowElements(),t=this.validateActivityId(e);return t.valid?(e=this.validateActivityName(e)).valid?{valid:!0}:e:t},Cu.validateActivityId=function(e){for(var t in e)switch(e[t].ClrTypeID){case"wf.StartActivity":var r=e[t];if(r.Id.startsWith("startActivity"))break;return{valid:!1,type:"message",level:"error",message:this.localePipe.instant("validate.activity")+(""+r.Name)+this.localePipe.instant("validate.noStartActivity")};case"bpmn.ExclusiveGateway":r=e[t];if(r.Id.startsWith("ExclusiveGateway"))break;return{valid:!1,type:"message",level:"error",message:this.localePipe.instant("validate.activity")+(""+r.Name)+this.localePipe.instant("validate.noExclusiveGateway")};case"bpmn.ParallelGateway":var i=e[t];if(i.Id.startsWith("ParallelGateway"))break;return{valid:!1,type:"message",level:"error",message:this.localePipe.instant("validate.activity")+(""+i.Name)+this.localePipe.instant("validate.noParallelGateway")};case"wf.UserActivity":i=e[t];if(i.Id.startsWith("UserActivity"))break;return{valid:!1,type:"message",level:"error",message:this.localePipe.instant("validate.activity")+(""+i.Name)+this.localePipe.instant("validate.noUserActivity")};case"wf.OperationActivity":var n=e[t];if(n.Id.startsWith("UserActivity"))break;return{valid:!1,type:"message",level:"error",message:this.localePipe.instant("validate.activity")+(""+n.Name)+this.localePipe.instant("validate.noOperationActivity")};case"wf.NotifyActivity":n=e[t];if(n.Id.startsWith("NotifyActivity"))break;return{valid:!1,type:"message",level:"error",message:this.localePipe.instant("validate.activity")+(""+n.Name)+this.localePipe.instant("validate.noNotifyActivity")};case"wf.CallActivitySubProcess":var o=e[t];if(o.Id.startsWith("CallActivitySubProcess"))break;return{valid:!1,type:"message",level:"error",message:this.localePipe.instant("validate.activity")+(""+o.Name)+this.localePipe.instant("validate.noCallActivitySubProcess")};case"wf.AutoActivity":o=e[t];if(o.Id.startsWith("autoActivity"))break;return{valid:!1,type:"message",level:"error",message:this.localePipe.instant("validate.activity")+(""+o.Name)+this.localePipe.instant("validate.noAutoActivity")};case"wf.IntermediateCatchEventImpl":var a=e[t];if(a.Id.startsWith("IntermediateCatchEvent"))break;return{valid:!1,type:"message",level:"error",message:this.localePipe.instant("validate.activity")+(""+a.Name)+this.localePipe.instant("validate.noIntermediateCatchEvent")};case"wf.MessageActivity":a=e[t];if(a.Id.startsWith("MessageActivity"))break;return{valid:!1,type:"message",level:"error",message:this.localePipe.instant("validate.activity")+(""+a.Name)+this.localePipe.instant("validate.noMessageActivity")};case"wf.AifCreationBillActivity":var s=e[t];if(s.Id.startsWith("AifCreationBillActivity"))break;return{valid:!1,type:"message",level:"error",message:this.localePipe.instant("validate.activity")+(""+s.Name)+this.localePipe.instant("validate.noAifCreationBillActivity")};case"bpmn.EndEvent":s=e[t];if(s.Id.startsWith("EndEvent"))break;return{valid:!1,type:"message",level:"error",message:this.localePipe.instant("validate.activity")+(""+s.Name)+this.localePipe.instant("validate.noEndEvent")}}return{valid:!0}},Cu.validateActivityName=function(e){for(var t in e){var r=e[t];switch(r.ClrTypeID){case"wf.StartActivity":case"bpmn.ExclusiveGateway":case"bpmn.ParallelGateway":case"wf.UserActivity":case"wf.OperationActivity":case"wf.NotifyActivity":case"wf.CallActivitySubProcess":case"wf.AutoActivity":case"wf.IntermediateCatchEventImpl":case"wf.MessageActivity":case"wf.AifCreationBillActivity":case"bpmn.EndEvent":if(null==r.Name||""==r.Name)return{valid:!1,type:"message",level:"error",message:this.localePipe.instant("validate.mark")+(""+r.Id)+this.localePipe.instant("validate.noFlowNodeChsName")};if(128<new Blob([r.Name]).size)return{valid:!1,type:"message",level:"error",message:this.localePipe.instant("validate.activity")+(""+r.Name)+this.localePipe.instant("validate.nameExceedsLengthLimit")}}}return{valid:!0}},Cu.localePipe=null;var Pu=Cu;function Cu(){}var Iu="new",Su="batchCopyProperty",Eu="batchSetProperty",Tu={"zh-CHS":{validate:{noProcessHeader:"模型不存在processHeader属性",cmpsEmpty:"流程构件为空",cmpsEmptyMsg:"流程构件不允许为空，请联系表单开发确认问题",directNoPf:"启动方式为【直接】的流程不应该包含共享（PF）的流程构件",directNoPfMsg:"请移除以下共享（PF）的流程构件：",noLoadDataCmp:"缺少执行时机为[获取数据]的流程构件",noLoadDataCmpMsg:"流程定义不能缺少取数构件，请联系表单开发确认问题",noStartCmp:"缺少执行时机为[流程启动]的流程构件",noStartCmpMsg:"会导致流程启动时无法修改单据状态，请联系表单开发确认问题",lackProcessCompleteCmp:"缺少执行时机为[流程完成]的流程构件",lackProcessCompleteCmpMsg:"会导致流程完成时无法修改单据状态，请联系表单开发确认问题",lackProcessAbortCmp:"缺少执行时机为[流程终止]的流程构件",lackProcessAbortCmpMsg:"会导致流程终止时无法修改单据状态，请联系表单开发确认问题",lackProcessCancelCmp:"缺少执行时机为[流程终止]的流程构件",lackProcessCancelCmpMsg:"会导致流程终止时无法修改单据状态，请联系表单开发确认问题",lackProcessBackCmp:"缺少执行时机为[流程驳回]的流程构件",lackProcessBackCmpMsg:"会导致流程驳回时无法修改单据状态，请联系表单开发确认问题",lackProcessReStartCmp:"缺少执行时机为[重新提交]的流程构件",lackProcessReStartCmpMsg:"会导致流程重新提交时无法修改单据状态，请联系表单开发确认问题",parallelGatewayCheck:"【并行网关】没有成对出现",parallelGatewayCheckMsg:"【并行网关】需作为一条流程分支的拆分节点和汇聚节点成对出现，请修改",approvalPerformerCheck:"活动，未设置参与者",noVariable1:"活动【变量设置】属性中已设置变量",noVariable2:"在流程属性【流程变量】中已不存在，请修改！",activity:"活动【",noStartActivity:"】的标识不合法，不是以[startActivity]开头",noExclusiveGateway:"】的标识不合法，不是以[ExclusiveGateway]开头",noParallelGateway:"】的标识不合法，不是以[ParallelGateway]开头",noUserActivity:"】的标识不合法，不是以[UserActivity]开头",noOperationActivity:"】的标识不合法，不是以[OperationActivity]开头",noNotifyActivity:"】的标识不合法，不是以[NotifyActivity]开头",noCallActivitySubProcess:"】的标识不合法，不是以[CallActivitySubProcess]开头",noAutoActivity:"】的标识不合法，不是以[AutoActivity]开头",noIntermediateCatchEvent:"】的标识不合法，不是以[IntermediateCatchEventImpl]开头",noMessageActivity:"】的标识不合法，不是以[MessageActivity]开头",noAifCreationBillActivity:"】的标识不合法，不是以[AifCreationBillActivity]开头",noEndEvent:"】的标识不合法，不是以[EndEvent]开头",mark:"标识为【",noFlowNodeChsName:"】的活动简体中文名称为空，请修改",nameExceedsLengthLimit:"】的名称超长，不能超过40个字符，请修改"},processEditor:{tip:"提示",showButton:"显示查看模型按钮",changeRecord:"流程变更记录",noDtInfo:"不存在设计时流程信息！请先赋值！",noRtInfo:"不存在运行时流程信息！请先赋值！",wrongMoment:"设计器运行时机错误！",prompted:"系统提示",saveSuccess:"保存成功",waitReview:"保存成功，等待发起审核",successPublish:"发布成功",publishFail:"发布失败，",policyConflict:"会签策略下,“驳回规则”不允许“动态选择驳回级次”，请修改！",noPermissionToSave:"当前用户不具备另存流程的权限",closeProc1:"关闭此页面？",closeProc2:"系统可能不会保存您所做的更改。",viewModel:"查看模型",copied:"模型已经复制到剪贴板",button:{saveProc:"保存",releaseProc:"发布",sync:"同步设计时包",saveAs:"另存为",procRecord:"流程记录",viewProcModel:"查看模型",closeProc:"关闭"}},designer:{wfEditorUi:{basicElements:"基本元素",readOnly:"只读"},wfProcessCell:{basicInfo:"基本信息",name:"名称",nameLanguage:"名称",key:"标识",entryForm:"流程分类",startMode:"启动方式",wfTitle:"流程摘要",formDef:"表单定义",formsPC:"PC表单",formsMobile:"移动表单",process:"事件监听",advanced:"高级属性",basic:"基础属性",wfComponent:"流程构件",otherConfig:"其他配置",processVariables:"流程变量",basicElements:"基本元素",customizeAction:"自定义动作",timelinessInfo:"时效信息",enablePriority:"启用紧急程度",enableWholeOrderRetrieve:"撤回在审单据",messageProperty:"影像设置",timeLimitControl:"超时操作",messageNotice:"消息通知",extendProperty:"扩展属性",directTips:"提示：启动方式切换为直接，直接启动是默认的流程启动方式，切换后会移除共享(PF)相关构件，请知悉！",externalTips:"提示：启动方式切换为外部流程，适用于作为共享流程的外部流程相关场景，切换后保留流程上的共享（PF)相关构件，请知悉！",subprocessTips:"提示：启动方式切换为子流程，适用于调用式子流程的场景，切换后会移除除取数构件外的其他流程构件，请知悉！"},WfSequenceFlowEdge:{basicInfo:"基本信息",basic:"基础属性",name:"名称",nameLanguage:"名称",id:"标识",condition:"条件选项",ConditionExpression:"条件","default":"缺省转移线"},wfSidebar:{bizactivitylib:"业务活动"}},app:{processDesigner:{all:"所有",assign:"指派",claim:"领用",preempt:"抢占模式",parallel:"并行会签",sequential:"串行会签","true":"是","false":"否",dataId:"单据内码",procInstId:"流程实例ID",bizDefKey:"入口单据ID",processDefinitionKey:"流程定义KEY",procInstCreator:"流程发起人",businessCreator:"业务发起人",procInstDescription:"流程摘要",comment:"审批意见",bizDefName:"流程分类名称",curLoginUsername:"当前登录人名称",procInstCreatorName:"流程发起人名称",currentParticipantId:"当前办理人ID",currentParticipantName:"当前办理人名称",currentUser:"当前登录用户",preActExecutors:"上一个活动的执行人",collectionElementVariable:"多实例子活动元素变量",subCollectionElementVariable:"多实例子流程元素变量",nrOfInstances:"多实例总数量",nrOfCompletedInstances:"多实例已完成数量",nrOfActiveInstances:"多实例正在运行中的数量",nrOfForward:"通过实例数量",nrOfBackward:"驳回实例数量",nrOfAbort:"终止实例数量",conclusionType:"结论类型",conclusionValue:"结论值",directSuperior:"直接上级",higherSuperior:"间接上级",DIRECT:"直接",EXTERNAL_PROCESS:"外部流程",SUB_PROCESS:"子流程",ALL:"电脑端和移动端",WEB:"电脑端",APP:"移动端",conclusionTypeTips:"审批项流转方向，1正向，2反向，3终止",conclusionValueTips:'审批项编号，例如，"Pass"、"Back"、"Refuse"',copy:"_副本",saveAs:"另存为",tips:"系统提示",saveAsSuccess:"另存为成功",saveAsFail:"另存为失败，请检查流程是否正确！",syncDt:"是否将当前版本流程定义同步到设计时流程定义包",syncSuccess:"同步成功",beforeCompleteStrategyChange:"当前节点存在运行中的活动实例，不允许调整完成策略，请了解！",releaseProcess:"发布前审核",auto:"自动生单",push:"推式生单",pull:"拉式生单",creation:"通过生单流程生成目标单"}},multiInstanceLoopCharacteristics:{loopCharacteristics:"多实例设置",set:"（已设置）",notSet:"（未设置）",isEnable:"是否启用",isSequential:"是否串行",loopCardinality:"元素集合",completionConditionRules:"完成条件",promptAct1:"1、[集合]中的元素个数为子活动启动实例数量。",promptAct2:"2、子活动启动时系统会将[集合]中的元素拆分映射到各个子活动实例的[元素变量]。",promptProc1:"1、[集合]中的元素个数为子流程启动实例数量。",promptProc2:"2、子流程启动时系统会将[集合]中的元素拆分映射到各个子流程实例的[元素变量]。",checkPrompt:"当前节点存在运行中的活动实例，不允许调整",conditionRulesSet:"（已设置）",completionConditionRulesList:{forward:"正向",backward:"反向",abort:"终止"}},component:{optins:{wfOptions:"工作流选项",specified:"指定子流程",dynamic:"动态子流程",set:"（已设置）",notSet:"（未设置）",subProcessType:"子流程类型",processType:"流程类型",bizDef:"流程分类",procDef:"流程定义",clickCancel:"取消",clickOk:"确定"},voConfig:{documentInfo:"单据信息",viewModelSelection:"视图模型选择",cancel:"取消",clickOk:"确定",selectOne:"确定",documentTypeSelect:"单据类型选择",set:"（已设置）",notSet:"（未设置）",viewModel:"视图模型",documenttype:"单据类型",placeholder:"请选择"},variableSetting:{constant:"常量",expression:"表达式",component:"构件",ACTIVITY_STARTED:"活动开始",ACTIVITY_COMPLETED:"活动结束",varAssign:"变量赋值",varNumber:"变量编号",REQUIRED:"必填",varName:"变量名称",valueType:"值类型",executionTime:"执行时机",valueText:"变量值",processVariables:"流程变量",notSelectedVar:"尚未选中变量！",valueCannotEmpty:"变量值不允许为空！",set:"（已设置）",notSet:"（未设置）",add:"新增","delete":"删除",serialNumber:"序号",clickCancel:"取消",clickOK:"确定",inconsistentParameters:"当前构件方法参数不一致，请更新！",methodNotExist:"当前构件已不存在此方法，请更新！",parameterName:"参数名",parameterValue:"参数值",methodnotSelected:"尚未选择构件方法",metadataNotExist:"帮助元数据不存在，请联系系统管理员查看原因！",errorObtainComponent:"获取解析构件出错",componentSelection:"构件选择",componentName:"构件名称",parameterList:"参数列表",lineNumber:"序号"},urgeHandleRule:{urgentApproval:"催办审批：",pleaseApprove:"请您尽快审批",soOn:"的",urgeHandle:"催办",noSendingMethod:"尚未选择发送方式！",setMessageTemplate:"消息渠道启用短信时需设置消息模板",codeEmpty:"短信模板编号不允许为空",noMessageSubject:"尚未配置消息主题！",noMessageContent:"尚未选择消息内容！",earliestTimeNotEmpty:"最早允许催办时间不允许为空",minimumTimeNotEmpty:"最小允许催办间隔不允许为空",set:"（已设置）",notSet:"（未设置）",enableUrgeHandle:"启用催办",timeSetting:"时间设置",earliestTime:"最早允许催办时间（小时）",minimumInterval:"最小允许催办间隔（小时）",sendingMethod:"发送方式",messageSubject:"消息主题",supportEditing:"支持编辑",messageContent:"消息内容",displayReminder:"显示催办人",clickCancel:"取消",clickOK:"确定"},titleExpression:{"zh-CHS":"中文简体","zh-CHT":"中文繁体",en:"英文",taskDescription:"任务描述",set:"（已设置）",notSet:"（未设置）",currentLanguage:"当前摘要语言:",clickCancel:"取消",clickOK:"确定"},timeLimitControl:{timedOutOperation:"超时操作",constant:"固定值",scope:"时间范围",day:"天",hour:"时",minute:"分",BeforeDuration:"到期之前",OnDuration:"到期时",AfterDuration:"到期之后",SendMessageExpireOperation:"超时预警",AutoHandleExpireOperation:"自动办理",curDay:"当天",durationType:"期限类型",required:"必填",timeDuration:"时长",timeUnit:"单位",operationTypeName:"操作类型名称",sendType:"操作",onlyBeInteger:"任务期限只能是整数！",setOperation:"请设置超时操作！",setType:"请设置自动办理类型！",setComments:"请设置自动办理意见！",selectedOperation:"尚未选中预警操作！",notSupportAutomatic:"下一节点是由当前办理人指派的话，当前节点不支持任务自动办理",warningMessage:"预警消息",automaticProcessing:"自动办理",set:"（已设置）",notSet:"（未设置）",timelinessControl:"任务处理时效控制",isEnable:"是否启用",taskDeadline:"任务期限",timelyOperation:"时效预警操作",actionList:"操作列表",add:"新增",remove:"删除",clickCancel:"取消",clickOK:"确定",workItemParticipant:"当前节点办理人",procInstCreator:"流程发起人","to-doMessageTimeOut":"您有一条待办消息即将超时。",messageTimeOut:"您有一条消息即将超时",agree:"同意"},sendMessageOperation:{procInstCreator:"流程发起人",workItemParticipant:"当前节点办理人",preActExecutors:"上一节点办理人",day:"天",hour:"时",minute:"分",cycleTimeNotEmpty:"循环时间间隔不允许为空！",sendMethodNotEmpty:"发送方式不允许为空！",subjectNotEmpty:"消息主题不允许为空！",contentNotEmpty:"消息内容不允许为空！",recipientNotEmpty:"接收人不允许为空！",messageTemplate:"消息渠道启用短信时需设置消息模板",smsTemplateNumberNotEmpty:"短信模板编号不允许为空",cycleEnable:"启用循环预警",cycleTime:"循环时间间隔",sendType:"发送方式",subject:"消息主题",message:"消息内容",receiverVari:"接收人",sysUsers:"系统用户",clickCancel:"取消",clickOK:"确定",opinionsNotEmpty:"自动办理意见不允许为空！",processingNotEmpty:"自动办理不允许为空！",automaticProcessSet:"自动办理设置",automaticProcessMethod:"自动办理方式",automaticOpinionHandle:"自动办理意见"},smsMessageTemplate:{smsTemplateContent:"第三方短信服务商里定义的模板原文，例如:阿里云您的管控大数据平台账号已开通,用户名为:${username}，初始密码为:${code}，请及时登录系统",code:"变量",value:"值",noRowsSelected:"尚未选中行",smsMessageTemplate:"短信服务模板",tips1:"消息模板是指已经在第三方短信服务商定义模板后，需要在GS Cloud里将短信服务商的模板变量和GS Cloud变量关联",tips2:"第三方短信服务商里定义的模板编号，例如: 阿里云 SMS_220626324",tips3:"将第三方短信服务商模板里的变量和GSCloud里的变量配置关联",smsTemplateNumber:"短信模板编号",smsVariableBinding:"短信变量绑定",addSmsVariable:"新增",deleteSmsVariable:"删除"},signRule:{countersignRules:"会签规则",byNumber:"按数量",byProportion:"按比例(%)",customConditions:"自定义条件",value:"编号",text:"名称",conclusionName:"结论名称",conclusionValue:"结论值",calculateType:"计算方式",conditionValue:"条件值",waitAllVotes:"等待全员办结",yes:"是",no:"否",notEmpty:"完成策略为会签时，会签规则不允许为空，请了解！",pleaseSelect:"请首先选中一条审批项！",maxConditionValue:"条件值最大值是100",minConditionValue:"条件值最小值是0",noConditional:"结论执行方式为全票或一票时不需要条件值",set:"（已设置）",ruleList:"规则列表",approvalOptions:"审批选项",clickCancel:"取消",deleteRow:"重置",clickOK:"确定"},saveAsEdit:{"public":"公有","private":"私有",code:"编号",name:"名称",nameNotEmpty:"流程名称不能为空",organizationNotEmpty:"维护组织不能为空",organization:"组织",basicAttributes:"基础属性",processName:"流程名称",processKeyValue:"流程Key值",maintenanceOrg:"维护组织",accessLevel:"访问级别",saveAsCancel:"取消",saveAsOK:"确定"},release:{release:"流程发布",update:"流程更新",applicantName:"申请人名称",applicantDepartment:"申请人部门",procName:"流程名称",procVersion:"流程版本",releaseType:"发布类型",textDetail:"说明",saveAsCancel:"取消",saveAsOK:"确定"},processVariables:{string:"字符",integer:"整形",decimal:"小数","boolean":"布尔",constant:"常量",expression:"表达式",component:"构件",name:"变量编号",required:"必填",documentation:"变量名称",basicType:"变量类型",description:"描述",tag:"初始值类型",valueText:"初始值",processVariables:"流程变量",notSelected:"尚未选中流程变量！",variableNumberEmpty:"变量编号不允许为空！",variableNameEmpty:"变量名称不允许为空！",variableNumberNotStandard:"变量编号只能包含字母、数字和下划线，且不能以数字开头！",tagNotEmpty:"初始值类型不允许为空！",codeDuplicates:"流程变量编号不允许重复！",alreadyExists:"新增的变量已存在！",set:"（已设置）",notSet:"（未设置）",add:"新增","delete":"删除",number:"序号",clickCancel:"取消",clickOK:"确定"},participant:{user:"用户",variable:"变量参与者",position:"岗位",role:"角色",component:"构件参与者",reportingLine:"汇报关系",matrix:"矩阵",activityExecutor:"历史活动办理人",organization:"单位/部门",all:"所有",assign:"指派",claim:"领用",currentUser:"当前办理人",procInstCreator:"流程发起人",participantSet:"参与者设置",order:"序号",type:"类型",performerName:"名称",description:"描述",condition:"启用条件",dataMovement1:"是否将默认办理人数据移动到到备选办理人？",dataMovement2:"是否将备选办理人数据移动到默认办理人？",participantSelection:"参与者选择",selectProcessVariables:"尚未选择流程变量！",selectVariableValueType:"尚未选择变量值类型！",selectRelation:"尚未选择关系！",selectPosition:"尚未选择岗位！",selectOrgType:"尚未选择组织类型！",orgFill:"尚未填写组织！",refOrgIdNotNull:"参照类型为组织时，参照组织字段不能为空",refUserIdNotNull:"参照类型为系统用户/员工时，参照人字段不能为空",repDefConfigured:"该汇报关系已经进行过配置",atLeastOneCondition:"条件字段至少要存在一个",dataFieldAliasNotNull:"数据字段不能为空",matrixConfigured:"该矩阵已经进行过配置",selectPerformer:"尚未选择参与者",definitionDeleted:"该条汇报关系数据的定义已删除，该条数据将删除",matrixDeleted:"该条矩阵数据的定义已删除，该条数据将删除",selectParticipantInfo:"请先选中一条参与者信息！",noRowSelected:"尚未选中行！",selectDefaultHandler:"请先选中一条默认办理人",selectpotentialtHandler:"请先选中一条备选办理人",org:"组织：",positionType1:"岗位类型：通用岗位，组织：",positionType2:"岗位类型：通用岗位",positionType3:"岗位类型：组织岗位",comp:"构件：","parameters:":",参数：{","referencePerson:":"参照人：","referenceOrganization:":"参照组织：",condition1:"条件1：",condition2:"条件2：",condition3:"条件3：",data:"数据：",set:"（已设置）",notSet:"（未设置）",allocationPolicy:"分配策略",operator:"指派操作人",multiSelect:"允许多选",necessary:"只有一个待选用户时，仍需手工选择",notifyRecipient:"知会接收人",defaultHandler:"默认办理人","new":"新增",editPerformer:"编辑",removePerformer:"移除",clearPerformer:"清空",moveUp:"上移",moveDown:"下移",alternativeHandler:"备选办理人",isAllScope:"指定参与人时不限范围，从全员用户中选择",clickCancel:"取消",clickOK:"确定",alternativeScope:"备选范围",orgId:"组织ID",includeChildren:"包含下级",conditon:"启用条件",currentUnit:"本单位",currentDepartment:"本部门",variableOrganization:"变量组织"},activityExecutor:{name:"名称",eventHandler:">活动办理人",nodeName:"节点名称",enablingConditions:"启用条件",activityList:"活动列表",clickCancel:"取消",clickOK:"确定"},componentPerformer:{componentMethod:"当前构件方法参数不一致，请更新！",methodNotExist:"当前构件已不存在此方法，请更新！",code:"编号",name:"名称",description:"描述",valueText:"参数值",help:"帮助",errorObtaining:"获取解析构件出错",componentSelection:"构件选择",metadataNotExist:"帮助元数据不存在！",serverSideNotFound:"服务器端未找到帮助元数据，请检查元数据是否已经部署到环境中",componentName:"构件名称",componentSelect:"构件选择",parameterList:"参数列表"},matrixPerformer:{code:"编号",name:"名称",help:"帮助",multivalue:"多值",enumSelection:"枚举选择",refMatrixTable:"引用矩阵表",matrixTable:"矩阵表",curDataFieldValue:"结果列",conditionFields:"条件字段",condition:"启用条件",key:"键",value:"值",notSelectEnum:"尚未选中枚举值",cancel:"取消",onConfirm:"确定",lineNumber:"序号"},performerOptions:{leave:"向下流转",throwException:"异常提示",sys:"用户ID",administrative_staff:"员工ID",procInstCreator:"流程发起人",preActExecutors:"上一节点办理人",allPassExecutors:"所有已办理人员",performerOptions:"参与者选项",exclusionNotAllowed:"所有已办理人员已设置自动审批，上个节点已办理人员默认不允许排除！",approvalNotAllowed:"【分配策略】为【领用】时，不允许设置自动审批，请了解！",approvalNotAllowedAsSet:"所有已办理人员已设置不允许审批，所以上个节点已办理人员默认不允许自动审批！",allocationStrategyIsCollect:"【分配策略】为【领用】时，不允许设置自动审批，请了解！",set:"（已设置）",advancedOptions:"参与者高级选项",historicFirst:"再次进入节点时，办理人是节点的已办人员",noPerformerStrategy:"办理人为空策略：",excludeProcInstCreator:"排除办理人选项",defaultNotParticipate:"流程发起人默认不参与审批",excludePreActExecutors:"上个节点已办理人员默认不参与审批",excludeAllPassExecutors:"所有已办理人员默认不参与审批",excludeExprPerformer:"流程变量：",variableOrgTypes:"变量值类型：",automaticApprovalOptions:"自动审批选项",autoProcInstCreator:"流程发起人默认自动审批通过",autoPreActExecutors:"上一节点办理人员默认自动审批通过",autoAllPassExecutors:"所有已办理人员默认自动审批通过",cancel:"取消",clickOK:"确定"},positionPerformer:{orgPosition:"组织岗",generalPosition:"通用岗",sysPositions:"系统岗位",positionType:"岗位类型",role:"角色",position:"岗位",sysType:"组织类型",placeholder:"请选择",orgId:"组织ID",condition:"启用条件",clickCancel:"取消",clickOK:"确定"},reportingLine:{higherSuperior:"间接上级",directSuperior:"直接上级",code:"编号",name:"名称",dept:"组织",sysUser:"系统用户",employee:"员工",businessFields:"业务字段",defName:"汇报定义",dimension:"汇报级别",curReportingRefer:"参照类型",usersName:"参照人",refOrgId:"参照组织",condition:"启用条件",definitionOfReport:"汇报关系定义"},userPerformer:{regularUser:"固定用户",variablePart:"变量参与者",sys:"系统用户",administrative_organization:"员工",cantUseContext:"行政人员类型不能使用此上下文变量",user:"用户",variable:"变量",condition:"启用条件"},variablePerformer:{sys:"用户ID",administrative_staff:"员工ID",oneself:"本人",administrative_organization:"部门ID",cantUseContext:"行政人员类型不能使用此上下文变量",processVariables:"流程变量",variableOrgTypes:"变量值类型",relationShipType:"关系",condition:"启用条件"},orgPotentialOwner:{optionSettings:"选项设置",global:"全员",currentUnit:"本单位",currentDepartment:"本部门",addSignBehind:"加签",addSignFront:"征询",transfer:"移交",notify:"知会",set:"（已设置）",notSet:"（未设置）",option:"选项",enable:"是否启用",range:"范围",orgId:"组织ID",variableOrganization:"变量组织",includeChildren:"包含下级",clickCancel:"取消",clickOK:"确定",limit:"限定人员范围",turnOffPrompt:"请关闭限定人员范围选项"},note:{placeholder:"请输入流程变更记录",clickCancel:"取消",clickOK:"确定"},MessageNotice:{notify:"消息通知",subject:"消息主题",content:"消息内容",sendTime:"发送时机",sendType:"发送方式",receiverText:"消息接收人",procInstCreator:"流程发起人，",workItemParticipant:"任务接收人，",messageSet:"消息设置",selectedRow:"尚未选中消息通知！",noCopy:"没有待复制的消息通知属性！",batchCopy:"批量复制",set:"（已设置）",notSet:"（未设置）",add:"新增",edit:"编辑","delete":"删除",lineNumber:"序号",clickCancel:"取消",clickOK:"确定",messContent:'{"expr":"\'您有一条消息通知。\'","sexpr":""}',procComplete:"流程完成",procAborted:"流程终止",procRollBack:"流程驳回",workCreated:"任务创建",actComplete:"活动完成",actAborted:"活动终止",email:"邮件",sms:"短信",cloudplus:"云",processParticipant:"流程参与人",variableParticipant:"变量参与者",userParticipant:"指定用户",positionParticipant:"岗位",activityExecutorParticipant:"历史办理人",sys:"系统用户",administrative_organization:"员工",name:"名称",noTargetNode:"尚未选中节点！","noMessageNotifyAttribute!":"没有消息通知属性！"},messageNoticeEdit:{procInstCreator:"流程发起人",activityExecutorParticipant:"历史办理人",workItemParticipant:"任务办理人",sys:"系统用户",administrative_organization:"员工",processParticipant:"流程参与人",workItemReceiveParticipant:"任务接收人",variableParticipant:"变量参与者",userParticipant:"指定用户",positionParticipant:"岗位",sendType:"发送方式不允许为空",smsMessageTemplate:"消息渠道启用短信时需设置消息模板",smsMessageTemplateCode:"短信模板编号不允许为空",sendTime:"发送时机不允许为空",subject:"消息主题不允许为空",content:"消息内容不允许为空",receivers:"接收人不允许为空！",processParticipantNotNull:"流程参与人不允许为空",activityDefIdNotNull:"流程参与人为历史办理人时，办理节点不允许为空",variableParticipantNotNull:"变量参与者不允许为空",orgType:"变量参与者组织类型不允许为空",userIds:"指定用户不允许为空",positionId:"岗位不允许为空",activityList:"活动列表",position:"岗位",optionalNodes:"可选节点",targetNodeList:"目标节点列表",placeholder:"请选择目标节点",optionalAttribute:"可选属性",lineNumber:"序号",clickCancel:"取消",clickOK:"确定",messSendType:"消息渠道",messSubject:"消息主题",enable:"启用表达式",messContent:"消息内容",recipient:"接收人",addReceiver:"添加",organization:"组织：",posi:"岗位："},jumpScope:{targetNodeOptions:"目标节点选项",name:"名称",outConnectNode:"流程图连线节点",global:"流程内所有节点",afterNodes:"所有后继节点",specifiedSet:"流程图连线节点+附加节点",firstNode:"条件为true的连线节点，当有多条时默认选中首条",nullNode:"默认为空，每次都手动选择",specifyNode:"指定默认节点",noSetTargetNode:"尚未设置目标节点选项，请了解！",noSetSpecifyNode:"尚未指定默认节点，请了解！",selectedRow:"请首先选中一条选项！",optionalNodes:"可选节点",listOfAdditional:"附加节点列表",pleaseSelect1:"请选择附加节点",defaultNode:"默认节点",pleaseSelect2:"请选择默认节点",defaultNodeList:"默认节点列表",clickCancel:"取消",clickOK:"确定",set:"（已设置）"},imageSet:{imageSet:"影像设置",onlyView:"仅可查看",edit:"编辑",reScanStart:"发起重扫",reScanComplete:"重扫完成",mutualExclusion:"【仅可查看】选项与其他选项互斥，请了解！",set:"（已设置）",notSet:"（未设置）",imageOperation:"影像操作权限",clickCancel:"取消",clickOK:"确定"},extendProperty:{extendProperty:"扩展属性","true":"是","false":"否",set:"（已设置）",notSet:"（未设置）",illustrate:"说明",placeholder:"请选择",cancel:"取消",clickOK:"确定"},expressionEditor:{expressionEditor:"条件编辑",notSet:"（未设置）",clickCancel:"取消",changeType:"切换类型",clickOK:"确定"},executeForms:{executeForms:"表单定义",parameters:"参数【",typeAsvariable:"】类型为变量，但在流程变量里不存在",parameterSettings:"参数设置",formDefinitionList:"表单定义列表",notSet:"（未设置）","default":"流程默认表单",processEmbeddedForm:"流程嵌表单",formEmbedProcess:"表单嵌流程",clickCancel:"取消",clickOK:"确定",noForm:"暂无表单格式",form:"选择表单",placeholder:"请选择",parametersSet:"参数",key:"变量编号",name:"变量名称",lineNumber:"序号",code:"编号",tag:"类型",value:"参数值",variable:"变量",constant:"常量",expression:"表达式",method:"方法标识",methodName:"方法名称",description:"描述",workFlowAction:"流转方向",formOperations:"表单操作",executionTime:"执行时机",sortOrder:"执行顺序",methodParameters:"参数",selectFormActionConfig:"尚未选中表单操作配置！",selectFormAction:"尚未选中表单操作！",editParam:"设置",formEvents:"表单事件",buttonName:"按钮名称",enable:"是否可用",disabled:"是否禁用",hidden:"是否隐藏",fieldName:"字段名称",editable:"是否可写",readonly:"是否只读",required:"是否必填",saveFail:"保存配置失败，请联系管理员查看原因！",checkedRows:"尚未选择按钮集合",checkeds:"尚未选择字段集合",enableBtn:"可用",disabledBtn:"禁用",hiddenBtn:"隐藏",btnBatchReset:"重置",editableBtn:"可写",readonlyBtn:"只读",requiredBtn:"必填",add:"新增","delete":"删除",other:"其他",formBtn:"表单按钮",formfield:"表单字段",apptag:"单据类型",functionMenu:"功能菜单",formFormat:"表单格式",docFormatNumber:"单据格式编号",docFormatName:"单据格式名称",selectedRow:"尚未选择表单定义！",set:"（已设置）"},eventDefinition:{eventDefinition:"信号定义",pass:"正向",back:"反向",abort:"终止",signalRef:"信号编号",name:"信号名称",triggerAction:"流转方向",selectedRow:"尚未选中一条触发事件！",dataLength:"至少需要一个信号定义，请了解！",codeNotNull:"信号编号不允许为空！",nameNotNull:"信号名称不允许为空！",codeNotNumber:"信号编号不允许为纯数字！",codeRepeat:"信号编号不允许重复！",set:"（已设置）",notSet:"（未设置）",add:"新增","delete":"删除",clickCancel:"取消",clickOK:"确定"},entryFormEditor:{flowForm:"流程分类",code:"编号",name:"名称",base:"类型",foundation:"基础",extend:"扩展",selectedRow:"尚未选择流程分类",absent:"流程分类已经不存在",lineNumber:"序号",clickCancel:"取消",clickOK:"重新绑定"},editComponentParameter:{code:"编号",name:"名称",required:"必填",yes:"是",no:"否",value:"参数值",openComponentFail:"获取解析构件出错",componentSelection:"构件选择",curComponent:"请选择流程构件",executionTime:"请选择执行时机",para:"参数",paraRequired:"】必填",execuTime:"执行时机",parameterList:"参数列表",clickCancel:"取消",clickOK:"确定"},customizeAction:{customizeAction:"自定义动作",app:"移动",web:"web",all:"web,移动",name:"名称",code:"编号",terminalType:"适用终端",isAll:"是否默认",yes:"是",no:"否",paramName:"编号",valueText:"名称",value:"参数值",addActions:"自定义动作选择",actionExisted:"新增的自定义动作已经存在！",selectedRow:"请首先选中一条选项！",set:"（已设置）",notSet:"（未设置）",add:"新增","delete":"删除",parameterList:"参数列表",clickCancel:"取消",clickOK:"确定"},checkCondition:{zhChs:"简体中文",zhCht:"繁体中文",en:"英文",checkCondition:"活动校验规则",set:"（已设置）",notSet:"（未设置）",nodeEntry:"节点进入",activityBeforeStarted:"节点进入条件",enterErrorTips:"进入条件不匹配提示语",activityBeforeCompleted:"节点离开",activityBeforeCompletedValue:"节点离开条件",leaveErrorTips:"离开条件不匹配提示语",clickCancel:"取消",clickOK:"确定"},batchSet:{targetNode:"目标节点",addSignFront:"征询",addSignBehind:"加签",transfer:"移交",notify:"知会",backWardRule:"驳回规则",name:"名称"},subProcess:{subProcessSet:"子流程设置",specified:"指定子流程",dynamic:"动态子流程",inheritParent:"与父流程相同",autoCreation:"自动生成下游单据",variablesExpression:"变量表达式",rteNull:"请选中一条生单流程",orderProcess:"生单流程",clickOk:"确定",clickCancel:"取消",inheritBizDataId:"当子流程与父流程单据不一致时，请设置子流程单据内码！",set:"（已设置）",notSet:"（未设置）",radioGroupProcessType:"子流程类型",flowForm:"流程分类",processDef:"流程定义",radioGroupBillSource:"单据来源",autoCreationProcess:"生单流程",bizDataId:"单据内码",setOption:"设置选项",SameParentProcess:"与父流程同一张业务单据",setBizDataId:"设置单据内码",subProcessOpt:"子流程选项"},backwardRule:{reEdit:"驳回活动节点已不存在，请重新编辑",backwardRule:"驳回规则",initialActityId:"开始节点",precursorActivityId:"前置节点",empty:"空",name:"名称",id:"标识",sequence:"顺序流转",backToMe:"返回我",backToCurrentNode:"返回本节点",popover:"1.顺序流转:按照流转线顺序进行流转; 2.返回我:完成策略为抢占：只给驳回人创建任务,完成策略为会签：驳回人与未审批人收到新任务，已审批人员自动审批通过; 3.返回本节点:实际效果受“再次进入节点时，办理人是否是节点已办人员影响”选项的影响",selectAbleClick:"会签策略下，不允许动态选择驳回目标节点!",dictPicked:"“驳回至空”选项请搭配“允许动态选择驳回目标节点”使用",set:"（已设置）",notSet:"（未设置）","rejectedTo:":"驳回至：",backScope:"驳回范围",defaultPrompt:"默认选取全部历史驳回节点",title:"活动列表",dynamicSelection:"允许动态选择驳回目标节点",resubmitEffectOptions:"返回设置",popover1:"1.顺序流转:按照流转线顺序进行流转; ",popover2:"2.返回我:完成策略为抢占：只给驳回人创建任务,完成策略为会签：驳回人与未审批人收到新任务，已审批人员自动审批通过;",popover3:"3.返回本节点:实际效果受“再次进入节点时，办理人是否是节点已办人员影响”选项的影响",allowModification:"允许修改返回设置",clickCancel:"取消",clickOk:"确定"},assignStrategy:{all:"所有",assign:"指派",claim:"领用",currentUser:"当前办理人",procInstCreator:"流程发起人",assignStrategy:"分配策略",option:"选项",assignmentRules:"指派规则",operator:"指派操作人",multiSelect:"允许选择多个待选用户",necessary:"只有一个待选用户时，仍需手工选择",clickCancel:"取消",clickOK:"确定"},assignScope:{assignScopeList:"指派节点列表",required:"必填",yes:"是",no:"否",condition:"条件",add:"增加","delete":"删除",name:"名称",deleteRow:"请首先选中一条选项！",curActivity:"尚未选中行",set:"（已设置）",notSet:"（未设置）",nodeList:"节点列表",moveUp:"上移",moveDown:"下移",clickCancel:"取消",clickOK:"确定"},assignPerformer:{currentUser:"当前办理人",procInstCreator:"流程发起人",global:"全员",currentUnit:"本单位",currentDepartment:"本部门",assignPerformer:"指派规则",set:"（已设置）",operator:"指派操作人",multiSelect:"允许选择多个待选用户",necessary:"只有一个待选用户时，仍需手工选择",clickCancel:"取消",clickOK:"确定"},approvelItems:{approvalOptions:"审批选项",forward:"正向",backward:"反向",abort:"终止",value:"编号",text:"名称",workFlowAction:"流转方向",isDefault:"默认",no:"否",yes:"是",commentNecessary:"意见必填",attachmentNecessary:"附件上传",certification:"数字签名",signatureNecessary:"手写签名必填",defaultComment:"默认意见","zh-CHS":"中文简体","zh-CHT":"中文繁体",en:"英文",workFlowActionNotNull:"审批项流转方向不允许为空，请修改！",deleteRow:"请首先选中一条选项！",set:"（已设置）",notSet:"（未设置）",add:"新增","delete":"删除",clickCancel:"取消",clickOK:"确定",approvalAction:"审批动作",lineNumber:"序号"},approvalPivot:{remind:"文字提示",type:"类型",condition:"条件",title:"显示名称",description:"详细说明",approvalPivot:"审批要点",selectedRow:"尚未选中审批要点！",configTitle:"尚未填写显示标题！",set:"（已设置）",notSet:"（未设置）",enable:"是否启用",expand:"是否展开",showTitle:"显示标题",list:"列表",add:"新增","delete":"删除",clickCancel:"取消",clickOK:"确定"},anonymousSet:{anonymousOpt:"匿名选项",approver:"审批人",set:"（已设置）",notSet:"（未设置）",anonymousSet:"匿名设置",isAnonymity:"是否启用",anonymous:"匿名代称",clickCancel:"取消",clickOK:"确定"},activityList:{name:"名称",checkeds:"尚未选择活动节点",lineNumber:"序号",clickCancel:"取消",clickOK:"确定"},activityComponent:{component:"构件",method:"构件方法",inconsistentParameters:"参数不一致，请检查",longerExists:"构件已不存在此构件方法",absent:"取消",pleaseCheck:"，请检查",edit:"编辑",deleteRow:"删除",executionTime:"执行时机",cmpName:"构件名称",metadataId:"构件ID",methodCode:"构件方法",isForCompensation:"补偿操作",yes:"是",no:"否",operate:"操作",code:"编号",name:"名称",value:"参数值",editComponent:"编辑构件",confirmDelete:"确认是否删除构件？",curComponent:"尚未选中构件！",newComponent:"新建构件",sameCmp:"存在相同的流程构件",cmpMethod:"构件方法：",executionTimeNotNull:"构件执行时机不允许为空！",param:"的参数",required:"必填",set:"（已设置）",notSet:"（未设置）",PROCESSINSTANCE_STARTED:"流程启动",PROCESSINSTANCE_SUSPENDED:"流程挂起",PROCESSINSTANCE_RESUMED:"流程恢复",PROCESSINSTANCE_COMPLETED:"流程完成",PROCESSINSTANCE_ABORTED:"流程终止",PROCESSINSTANCE_CANCELED:"流程取消",PROCESSINSTANCE_REACTIVATED:"流程复活",PROCESSINSTANCE_ROLLBACK:"流程驳回",PROCESSINSTANCE_RESUBMIT:"重新提交",ACTIVITY_AND_PARTICIPANT_UPDATED:"环节办理人变更",PROCESSINSTANCE_ABORTED_BY_ADMIN:"管理员终止",PROCESSINSTANCE_BEFORE_START:"流程启动前",WORKITEM_BEFORE_COMPLETE:"任务完成前",WORKITEM_AFTER_COMPLETE:"任务完成后",LOADDATA:"获取数据",ACTIVITY_STARTED:"活动启动",ACTIVITY_COMPLETED:"活动完成",ACTIVITY_ABORTED:"活动终止",WORKITEM_CREATED:"工作项创建",WORKITEM_COMPLETED:"工作项完成",WORKITEM_SUSPENDED:"工作项挂起",WORKITEM_RESUMED:"工作项恢复",WORKITEM_ABORTED:"工作项终止",WORKITEM_RETRIEVED:"工作项取回",WORKITEM_CLAIMED:"工作项领用",WORKITEM_UNCLAIMED:"工作项反领用",ACTIVITY_ASSIGNMENT:"任务分配前",deleteNotAllowed:"取数构件不允许删除，请了解！",tips:"提示：",prefabricated:"已经预制外部流程构件，此处只保留取数构件",add:"新增",moveUp:"上移",moveDown:"下移",clickCancel:"取消",clickOK:"确定"}}},en:{validate:{noProcessHeader:"processHeader attribute does not exist in the model",cmpsEmpty:"Process component is empty",cmpsEmptyMsg:"The process component cannot be empty, please contact the form development to confirm the problem",directNoPf:"A process whose startup mode is [direct] should not contain shared (PF) process components",directNoPfMsg:"Please remove the following process components of sharing (PF):",noLoadDataCmp:"There is no process component whose execution opportunity is [get data]",noLoadDataCmpMsg:"The process definition cannot be short of fetching components, please contact the form development to confirm the problem",noStartCmp:"The process component whose execution opportunity is [Process Start] is missing",noStartCmpMsg:"The document status cannot be modified when the process is started, please contact the form development to confirm the problem",lackProcessCompleteCmp:"There is no process component whose execution opportunity is [Process Completion]",lackProcessCompleteCmpMsg:"The document status cannot be modified when the process is completed, please contact the form development to confirm the problem",lackProcessAbortCmp:"Lack of process component with execution timing of [process termination]",lackProcessAbortCmpMsg:"The document status cannot be modified when the process is terminated, please contact the form development to confirm the problem",lackProcessCancelCmp:"The process component with execution opportunity of [Process Termination] is missing",lackProcessCancelCmpMsg:"The document status cannot be modified when the process is terminated, please contact the form development to confirm the problem",lackProcessBackCmp:"Lack of process component with execution opportunity of [Process Rejection]",lackProcessBackCmpMsg:"The document status cannot be modified when the process is rejected, please contact the form development to confirm the problem",lackProcessReStartCmp:"Lack of process component with execution opportunity of [resubmit]",lackProcessReStartCmpMsg:"It will lead to the failure to modify the document status when the process is resubmitted, please contact the form development to confirm the problem",parallelGatewayCheck:"[Parallel Gateway] does not appear in pairs",parallelGatewayCheckMsg:"Parallel Gateway needs to appear as a split node and a sink node of a process branch in pairs, please modify it",approvalPerformerCheck:"activity, no participant set",noVariable1:"A variable has been set in the variable setting attribute of the activity",noVariable2:"It no longer exists in the process attribute Process Variable. Please modify it!",activity:"activity [",noStartActivity:"] is illegal and does not start with [startActivity]",noExclusiveGateway:"] is illegal and does not start with [ExclusiveGateway]",noParallelGateway:"] is illegal and does not start with [ParallelGateway]",noUserActivity:"] is illegal and does not start with [UserActivity]",noOperationActivity:"] is illegal and does not start with [OperationActivity]",noNotifyActivity:"] is illegal and does not start with [NotifyActivity]",noCallActivitySubProcess:"] is illegal and does not start with [CallActivitySubProcess]",noAutoActivity:"] is illegal and does not start with [AutoActivity]",noIntermediateCatchEvent:"] is illegal and does not start with [MediaTechEventTimpl]",noMessageActivity:"] is illegal and does not start with [MessageActivity]",noAifCreationBillActivity:"] is illegal and does not start with [AifCreationBillActivity]",noEndEvent:"] is illegal and does not start with [EndEvent]",mark:"The logo is [",noFlowNodeChsName:"] is empty, please modify it",nameExceedsLengthLimit:"] is too long and cannot exceed 40 characters. Please modify it."},processEditor:{tip:"Tip",showButton:"Show Model View Button",changeRecord:"Process Change Record",noDtInfo:"No design time process information exists! Please assign it first!",noRtInfo:"No runtime process information exists! Please assign it first!",wrongMoment:"Wrong moment for the editor!",prompted:"System Prompt",saveSuccess:"Save successful",waitReview:"Save successful, awaiting review initiation",successPublish:"Publish successful",publishFail:"Publish failed,",policyConflict:"In countersign strategy, 'Rejection Rule' does not allow 'Dynamically Select Rejection Levels', please modify!",noPermissionToSave:"The current user does not have permission to save the process",closeProc1:"Close this page?",closeProc2:"The system may not save the changes you made.",viewModel:"View Model",copied:"The model has been copied to the clipboard",button:{saveProc:"Save",releaseProc:"Publish",sync:"Synchronize Design Time Package",saveAs:"Save As",procRecord:"Process Record",viewProcModel:"View Model",closeProc:"Close"}},designer:{wfEditorUi:{basicElements:"Basic Elements",readOnly:"Read-only"},wfProcessCell:{basicInfo:"Basic Information",name:"Name",nameLanguage:"Name",key:"Identifier",entryForm:"Process Category",startMode:"Start Mode",wfTitle:"Process Summary",formDef:"Form Definition",formsPC:"PC Form",formsMobile:"Mobile Form",process:"Event Listener",advanced:"Advanced Properties",basic:"Basic Properties",wfComponent:"Process Component",otherConfig:"Other Configuration",processVariables:"Process Variables",basicElements:"Basic Elements",customizeAction:"Custom Actions",timelinessInfo:"Timeliness Information",enablePriority:"Enable Priority",enableWholeOrderRetrieve:"Withdraw Documents Under Review",messageProperty:"Image Setting",timeLimitControl:"Timeout Operation",messageNotice:"Message Notification",extendProperty:"Extended Properties",directTips:"Tip: Switching start mode to 'Direct' will remove shared (PF) related components as it is the default start mode. Please be aware of this!",externalTips:"Tip: Switching start mode to 'External Process' is suitable for scenarios where the process serves as an external process for sharing. After switching, shared (PF) related components on the process will be retained. Please be aware of this!",subprocessTips:"Tip: Switching start mode to 'Subprocess' is suitable for invoking sub-processes. After switching, all process components except those for data extraction will be removed. Please be aware of this!"},WfSequenceFlowEdge:{basicInfo:"Basic Information",basic:"Basic Properties",name:"Name",nameLanguage:"Name",id:"Identifier",condition:"Condition Options",ConditionExpression:"Condition Expression","default":"Default Transition"},wfSidebar:{bizactivitylib:"Business Activity Library"}},app:{processDesigner:{all:"All",assign:"Assign",claim:"Claim",preempt:"Preempt Mode",parallel:"Parallel Countersignature",sequential:"Sequential Countersignature","true":"Yes","false":"No",dataId:"Document ID",procInstId:"Process Instance ID",bizDefKey:"Entrance Document ID",processDefinitionKey:"Process Definition Key",procInstCreator:"Process Initiator",businessCreator:"Business Initiator",procInstDescription:"Process Summary",comment:"Approval Comment",bizDefName:"Process Category Name",curLoginUsername:"Current Login User Name",procInstCreatorName:"Process Initiator Name",currentParticipantId:"Current Participant ID",currentParticipantName:"Current Participant Name",currentUser:"Current Login User",preActExecutors:"Executors of the Previous Activity",collectionElementVariable:"MultiInstance Child activity element variables",subCollectionElementVariable:"MultiInstance Sub-process element variables",nrOfInstances:"Total number of multiple instances",nrOfCompletedInstances:"Number of multi-instance completed",nrOfActiveInstances:"The number of multiple instances running",nrOfForward:"Number of Passed Instances",nrOfBackward:"Number of rejected instances",nrOfAbort:"Number of terminated instances",conclusionType:"Conclusion Type",conclusionValue:"Conclusion Value",directSuperior:"Direct Superior",higherSuperior:"Indirect Superior",DIRECT:"Direct",EXTERNAL_PROCESS:"External Process",SUB_PROCESS:"Subprocess",ALL:"PC and Mobile",WEB:"PC",APP:"Mobile",conclusionTypeTips:"The direction of item circulation, 1 for forward, 2 for backward, 3 for termination",conclusionValueTips:"Item number, for example, 'Pass', 'Back', 'Refuse'",copy:"_Copy",saveAs:"Save As",tips:"System Tips",saveAsSuccess:"Save As Successful",saveAsFail:"Save As Failed, please check if the process is correct!",syncDt:"Whether to synchronize the current version of the process definition to the design-time process definition package",syncSuccess:"Synchronization Successful",beforeCompleteStrategyChange:"There are running activity instances in the current node, adjusting the completion strategy is not allowed, please be aware!",releaseProcess:"Review before Release",auto:"Auto-generated Form",push:"Push-generated Form",pull:"Pull-generated Form",creation:"Generate the target form through the form generation process"}},multiInstanceLoopCharacteristics:{loopCharacteristics:"Multi-instance Setup",set:"(Set)",notSet:"(Not Set)",isEnable:"Enable",isSequential:"Sequential",loopCardinality:"Elements Collections",completionConditionRules:"Completion COnditions",promptAct1:"1. The number of elements in [Collection] is the number of instances of the sub-activity start.",promptAct2:"2. When the sub-activity starts, the system will split and map the elements in the [Collection] to the [Element Variables] of each sub-activity instance.",promptProc1:"1. The number of elements in [Collection] is the number of instances of the sub-process start.",promptProc2:"2. When the sub-process starts, the system will split and map the elements in the [Collection] to the [Element Variables] of each sub-process instance.",checkPrompt:"There are running activity instances in the current node, adjusting is not allowed",conditionRulesSet:"(Set)",completionConditionRulesList:{forward:"Forward",backward:"BackWard",abort:"Abort"}},component:{optins:{wfOptions:"Workflow Options",specified:"Specified Subprocess",dynamic:"Dynamic Subprocess",set:"(Set)",notSet:"(Not Set)",subProcessType:"Subprocess Type",processType:"Process Type",bizDef:"Process Category",procDef:"Process Definition",clickCancel:"Cancel",clickOk:"OK"},voConfig:{documentInfo:"Document Information",viewModelSelection:"View Model Selection",cancel:"Cancel",clickOk:"OK",selectOne:"Select One",documentTypeSelect:"Document Type Selection",set:"(Set)",notSet:"(Not Set)",viewModel:"View Model",documenttype:"Document Type",placeholder:"Please Select"},variableSetting:{constant:"Constant",expression:"Expression",component:"Component",ACTIVITY_STARTED:"Activity Started",ACTIVITY_COMPLETED:"Activity Completed",varAssign:"Variable Assignment",varNumber:"Variable Number",REQUIRED:"Required",varName:"Variable Name",valueType:"Value Type",executionTime:"Execution Time",valueText:"Variable Value",processVariables:"Process Variables",notSelectedVar:"Variable Not Selected!",valueCannotEmpty:"Variable Value Cannot be Empty!",set:"(Set)",notSet:"(Not Set)",add:"Add","delete":"Delete",serialNumber:"Serial Number",clickCancel:"Cancel",clickOK:"OK",inconsistentParameters:"Inconsistent Method Parameters for the Current Component, Please Update!",methodNotExist:"The Current Component No Longer Exists This Method, Please Update!",parameterName:"Parameter Name",parameterValue:"Parameter Value",methodnotSelected:"Component Method Not Selected Yet",metadataNotExist:"Help Metadata Does Not Exist, Please Contact the System Administrator for Details!",errorObtainComponent:"Error Obtaining Parsed Component",componentSelection:"Component Selection",componentName:"Component Name",parameterList:"Parameter List",lineNumber:"No."},urgeHandleRule:{urgentApproval:"Urge Approval:",pleaseApprove:"Please Approve",soOn:" ",urgeHandle:"Urge Handle",noSendingMethod:"No Sending Method Selected Yet!",setMessageTemplate:"Message Template Needs to be Set When Using SMS as the Message Channel",codeEmpty:"SMS Template Number Cannot be Empty",noMessageSubject:"No Message Subject Configured Yet!",noMessageContent:"No Message Content Selected Yet!",earliestTimeNotEmpty:"Earliest Urge Time Cannot be Empty",minimumTimeNotEmpty:"Minimum Urge Interval Cannot be Empty",set:"(Set)",notSet:"(Not Set)",enableUrgeHandle:"Enable Urgent Handling",timeSetting:"Time Setting",earliestTime:"Earliest Urge Time (Hours)",minimumInterval:"Minimum Urge Interval (Hours)",sendingMethod:"Sending Method",messageSubject:"Message Subject",supportEditing:"Support Editing",messageContent:"Message Content",displayReminder:"Display Urgent Reminder",clickCancel:"Cancel",clickOK:"OK"},titleExpression:{"zh-CHS":"Simplified Chinese","zh-CHT":"Traditional Chinese",en:"English",taskDescription:"Task Description",set:"(Set)",notSet:"(Not Set)",currentLanguage:"Current Summary Language:",clickCancel:"Cancel",clickOK:"OK"},timeLimitControl:{timedOutOperation:"Timed Out Operation",constant:"Constant",scope:"Time Scope",day:"Day(s)",hour:"Hour(s)",minute:"Minute(s)",BeforeDuration:"Before Due",OnDuration:"On Due",AfterDuration:"After Due",SendMessageExpireOperation:"Expiring Alert",AutoHandleExpireOperation:"Automatic Processing",curDay:"Current Day",durationType:"Duration Type",required:"Required",timeDuration:"Duration",timeUnit:"Unit",operationTypeName:"Operation Type Name",sendType:"Operation",onlyBeInteger:"Task Duration Can Only Be an Integer!",setOperation:"Please Set Timeout Operation!",setType:"Please Set Automatic Processing Type!",setComments:"Please Set Automatic Processing Opinion!",selectedOperation:"No Expiring Operation Selected Yet!",notSupportAutomatic:"If the Next Node is Assigned by the Current Operator, the Current Node Does Not Support Automatic Task Processing",warningMessage:"Warning Message",automaticProcessing:"Automatic Processing",set:"(Set)",notSet:"(Not Set)",timelinessControl:"Task Processing Timeliness Control",isEnable:"Enable or Not",taskDeadline:"Task Deadline",timelyOperation:"Timely Alert Operation",actionList:"Action List",add:"Add",remove:"Remove",clickCancel:"Cancel",clickOK:"OK",workItemParticipant:"Current Node Operator",procInstCreator:"Process Initiator","to-doMessageTimeOut":"You Have a Pending Task Message About to Time Out.",messageTimeOut:"You Have a Message About to Time Out",agree:"Agree"},sendMessageOperation:{procInstCreator:"Process Initiator",workItemParticipant:"Current Node Handler",preActExecutors:"Previous Node Handlers",day:"Day",hour:"Hour",minute:"Minute",cycleTimeNotEmpty:"Cycle time interval cannot be empty!",sendMethodNotEmpty:"Send method cannot be empty!",subjectNotEmpty:"Message subject cannot be empty!",contentNotEmpty:"Message content cannot be empty!",recipientNotEmpty:"Recipient cannot be empty!",messageTemplate:"Message template needs to be set when SMS channel is enabled",smsTemplateNumberNotEmpty:"SMS template number cannot be empty",cycleEnable:"Enable cycle warning",cycleTime:"Cycle time interval",sendType:"Send method",subject:"Message subject",message:"Message content",receiverVari:"Recipient",sysUsers:"System users",clickCancel:"Cancel",clickOK:"OK",opinionsNotEmpty:"Automatic handling opinion cannot be empty!",processingNotEmpty:"Automatic handling cannot be empty!",automaticProcessSet:"Automatic handling settings",automaticProcessMethod:"Automatic handling method",automaticOpinionHandle:"Automatic handling opinion"},smsMessageTemplate:{smsTemplateContent:"Template text defined in third-party SMS service provider, for example: Your GS Cloud data platform account has been activated. Username: ${username}, initial password: ${code}. Please log in to the system in time.",code:"Variable",value:"Value",noRowsSelected:"No rows selected",smsMessageTemplate:"SMS Service Template",tips1:"Message template refers to the association of template variables defined by third-party SMS service provider with GS Cloud variables after the template has been defined.",tips2:"Template number defined in the third-party SMS service provider, for example: Aliyun SMS_220626324",tips3:"Configure the association between variables in the third-party SMS service provider's template and variables in GSCloud",smsTemplateNumber:"SMS template number",smsVariableBinding:"SMS variable binding",addSmsVariable:"Add",deleteSmsVariable:"Delete"},signRule:{countersignRules:"Countersign rules",byNumber:"By Quantity",byProportion:"By Percentage (%)",customConditions:"Custom Conditions",value:"Number",text:"Name",conclusionName:"Conclusion Name",conclusionValue:"Conclusion Value",calculateType:"Calculation Method",conditionValue:"Condition Value",waitAllVotes:"Wait for all members to complete",yes:"Yes",no:"No",notEmpty:"When the completion strategy is countersignature, the countersign rules cannot be empty. Please understand!",pleaseSelect:"Please select an item first!",maxConditionValue:"The maximum value of the condition must be 100",minConditionValue:"The minimum value of the condition must be 0",noConditional:"No conditional value is required when the execution mode is unanimous or one vote",set:"(Set)",ruleList:"Rule List",approvalOptions:"Approval Options",clickCancel:"Cancel",deleteRow:"Reset",clickOK:"OK"},saveAsEdit:{"public":"Public","private":"Private",code:"Number",name:"Name",nameNotEmpty:"Process name cannot be empty",organizationNotEmpty:"Maintenance organization cannot be empty",organization:"Organization",basicAttributes:"Basic Attributes",processName:"Process name",processKeyValue:"Process Key value",maintenanceOrg:"Maintenance organization",accessLevel:"Access level",saveAsCancel:"Cancel",saveAsOK:"OK"},release:{release:"Process Release",update:"Process Update",applicantName:"Applicant Name",applicantDepartment:"Applicant Department",procName:"Process name",procVersion:"Process version",releaseType:"Release type",textDetail:"Description",saveAsCancel:"Cancel",saveAsOK:"OK"},processVariables:{string:"String",integer:"Integer",decimal:"Decimal","boolean":"Boolean",constant:"Constant",expression:"Expression",component:"Component",name:"Variable number",required:"Required",documentation:"Variable name",basicType:"Variable type",description:"Description",tag:"Initial value type",valueText:"Initial value",processVariables:"Process variables",notSelected:"No process variables selected!",variableNumberEmpty:"Variable number cannot be empty!",variableNameEmpty:"Variable name cannot be empty!",variableNumberNotStandard:"Variable number can only contain letters, numbers, and underscores, and cannot start with a number!",tagNotEmpty:"Initial value type cannot be empty!",codeDuplicates:"Process variable number cannot be duplicated!",alreadyExists:"The added variable already exists!",set:"(Set)",notSet:"(Not Set)",add:"Add","delete":"Delete",number:"Number",clickCancel:"Cancel",clickOK:"OK"},participant:{user:"User",variable:"Variable Participant",position:"Position",role:"Role",component:"Component Participant",reportingLine:"Reporting Line",matrix:"Matrix",activityExecutor:"Historical Activity Executor",organization:"Organization/Department",all:"All",assign:"Assign",claim:"Claim",currentUser:"Current Handler",procInstCreator:"Process Initiator",participantSet:"Participant Set",order:"Order",type:"Type",performerName:"Name",description:"Description",condition:"Enable Condition",dataMovement1:"Move default handler data to alternative handlers?",dataMovement2:"Move alternative handler data to default handler?",participantSelection:"Participant Selection",selectProcessVariables:"Process variables not selected yet!",selectVariableValueType:"Variable value type not selected yet!",selectRelation:"Relation not selected yet!",selectPosition:"Position not selected yet!",selectOrgType:"Organization type not selected yet!",orgFill:"Organization not filled yet!",refOrgIdNotNull:"When reference type is organization, the reference organization field cannot be empty",refUserIdNotNull:"When reference type is system user/employee, the reference person field cannot be empty",repDefConfigured:"The reporting line has already been configured",atLeastOneCondition:"At least one condition field must exist",dataFieldAliasNotNull:"Data field cannot be empty",matrixConfigured:"The matrix has already been configured",selectPerformer:"Performer not selected yet",definitionDeleted:"The definition of this reporting line data has been deleted, this data will be deleted",matrixDeleted:"The definition of this matrix data has been deleted, this data will be deleted",selectParticipantInfo:"Please select a participant information first!",noRowSelected:"No row selected yet!",selectDefaultHandler:"Please select a default handler first",selectpotentialtHandler:"Please select an alternative handler first",org:"Organization:",positionType1:"Position type: General position, Organization:",positionType2:"Position type: General position",positionType3:"Position type: Organization position",comp:"Component:","parameters:":", Parameters: {","referencePerson:":"Reference person: ","referenceOrganization:":"Reference organization: ",condition1:"Condition 1: ",condition2:"Condition 2: ",condition3:"Condition 3: ",data:"Data: ",set:"(Set)",notSet:"(Not set)",allocationPolicy:"Allocation Policy",operator:"Assign Operator",multiSelect:"Allow Multiple Selection",necessary:"Only one candidate user, still requires manual selection",notifyRecipient:"Notify Recipient",defaultHandler:"Default Handler","new":"Add",editPerformer:"Edit",removePerformer:"Remove",clearPerformer:"Clear",moveUp:"Move Up",moveDown:"Move Down",alternativeHandler:"Alternative Handler",isAllScope:"When specifying participants, there is no restriction, select from all users",clickCancel:"Cancel",clickOK:"OK",alternativeScope:"Alternative Scope",orgId:"OrgID",includeChildren:"Include Children",conditon:"Conditon",currentUnit:"Current Unit",currentDepartment:"Current Department",variableOrganization:"Variable Org"},activityExecutor:{name:"Name",eventHandler:">Activity Executor",nodeName:"Node Name",enablingConditions:"Enable Conditions",activityList:"Activity List",clickCancel:"Cancel",clickOK:"OK"},componentPerformer:{componentMethod:"Current component method parameters are inconsistent, please update!",methodNotExist:"This method does not exist in the current component, please update!",code:"Code",name:"Name",description:"Description",valueText:"Parameter Value",help:"Help",errorObtaining:"Error obtaining parsing component",componentSelection:"Component Selection",metadataNotExist:"Help metadata does not exist!",serverSideNotFound:"Server side did not find help metadata, please check if the metadata has been deployed to the environment",componentName:"Component Name",componentSelect:"Component Selection",parameterList:"Parameter List"},matrixPerformer:{code:"Code",name:"Name",help:"Help",multivalue:"Multi",enumSelection:"Enum Selection",refMatrixTable:"Reference Matrix Table",matrixTable:"Matrix Table",curDataFieldValue:"Result Column",conditionFields:"Condition Fields",condition:"Enable Condition",key:"Key",value:"Value",notSelectEnum:"Enum value not selected yet",cancel:"Cancel",onConfirm:"Confirm",lineNumber:"Line Number"},performerOptions:{leave:"Flow Down",throwException:"Exception Prompt",sys:"User ID",administrative_staff:"Employee ID",procInstCreator:"Process Initiator",preActExecutors:"Previous Node Executors",allPassExecutors:"All Approved Personnel",performerOptions:"Performer Options",exclusionNotAllowed:"All Approved Personnel have set automatic approval, previous node executors are not allowed to be excluded by default!",approvalNotAllowed:"When [Allocation Policy] is [Claim], automatic approval is not allowed to be set, please be aware!",approvalNotAllowedAsSet:"All Approved Personnel have set not allowed for approval, previous node executors are not allowed to be automatically approved by default!",allocationStrategyIsCollect:"When [Allocation Policy] is [Claim], automatic approval is not allowed to be set, please be aware!",set:"(Set)",advancedOptions:"Advanced Performer Options",historicFirst:"When entering the node again, the handler is the previously handled personnel of the node",noPerformerStrategy:"Handler is Empty Strategy:",excludeProcInstCreator:"Exclude Handler Options",defaultNotParticipate:"Process Initiator does not participate in approval by default",excludePreActExecutors:"Previous node executors do not participate in approval by default",excludeAllPassExecutors:"All Approved Personnel do not participate in approval by default",excludeExprPerformer:"Process Variable:",variableOrgTypes:"Variable Value Types:",automaticApprovalOptions:"Automatic Approval Options",autoProcInstCreator:"Process Initiator is automatically approved by default",autoPreActExecutors:"Previous node executors are automatically approved by default",autoAllPassExecutors:"All Approved Personnel are automatically approved by default",cancel:"Cancel",clickOK:"OK"},positionPerformer:{orgPosition:"Organization Position",generalPosition:"General Position",sysPositions:"System Positions",positionType:"Position Type",role:"Role",position:"Position",sysType:"Organization Type",placeholder:"Please select",orgId:"Organization ID",condition:"Enable Condition",clickCancel:"Cancel",clickOK:"OK"},reportingLine:{higherSuperior:"Indirect Supervisor",directSuperior:"Direct Supervisor",code:"Code",name:"Name",dept:"Organization",sysUser:"System User",employee:"Employee",businessFields:"Business Fields",defName:"Reporting Definition",dimension:"Reporting Level",curReportingRefer:"Reference Type",usersName:"Reference Person",refOrgId:"Reference Organization",condition:"Enable Condition",definitionOfReport:"Definition of Reporting Relationship"},userPerformer:{regularUser:"Regular User",variablePart:"Variable Participant",sys:"System User",administrative_organization:"Employee",cantUseContext:"Administrative staff type cannot use this context variable",user:"User",variable:"Variable",condition:"Enable Condition"},variablePerformer:{sys:"User ID",administrative_staff:"Employee ID",oneself:"Self",administrative_organization:"Department ID",cantUseContext:"Administrative staff type cannot use this context variable",processVariables:"Process Variables",variableOrgTypes:"Variable Value Types",relationShipType:"Relationship",condition:"Enable Condition"},orgPotentialOwner:{optionSettings:"Option Settings",global:"All Members",currentUnit:"Current Unit",currentDepartment:"Current Department",addSignBehind:"Add Signature",addSignFront:"Consult",transfer:"Transfer",notify:"Notify",set:"(Set)",notSet:"(Not Set)",option:"Option",enable:"Enable or Not",range:"Range",OrgId:"Org Id",variableOrganization:"Variable Org",includeChildren:"Include Subordinates",clickCancel:"Cancel",clickOK:"OK",limit:"Limit Scope",turnOffPrompt:"Please Turn off the Scope of People option!"},note:{placeholder:"Please enter process change record",clickCancel:"Cancel",clickOK:"OK"},MessageNotice:{notify:"Message Notice",subject:"Message Subject",content:"Message Content",sendTime:"Sending Time",sendType:"Send Method",receiverText:"Message Receiver",procInstCreator:"Process Initiator,",workItemParticipant:"Task Receiver,",messageSet:"Message Settings",selectedRow:"No message notification selected yet!",noCopy:"No message notification attributes to copy!",batchCopy:"Batch Copy",set:"(Set)",notSet:"(Not Set)",add:"Add",edit:"Edit","delete":"Delete",lineNumber:"Number",clickCancel:"Cancel",clickOK:"OK",messContent:{expr:"'You have a message notification.'",sexpr:""},procComplete:"Process Completed",procAborted:"Process Aborted",procRollBack:"Process Rejected",workCreated:"Task Created",actComplete:"Activity Completed",actAborted:"Activity Aborted",email:"Email",sms:"SMS",cloudplus:"Cloud",processParticipant:"Process Participant",variableParticipant:"Variable Participant",userParticipant:"Designated User",positionParticipant:"Position",activityExecutorParticipant:"Historical Handler",sys:"System User",administrative_organization:"Employee",name:"Name",noTargetNode:"No node selected yet!","noMessageNotifyAttribute!":"No message notification attribute!"},messageNoticeEdit:{procInstCreator:"Process Initiator",activityExecutorParticipant:"Historical Handler",workItemParticipant:"Task Handler",sys:"System User",administrative_organization:"Employee",processParticipant:"Process Participant",workItemReceiveParticipant:"Task Receiver",variableParticipant:"Variable Participant",userParticipant:"Designated User",positionParticipant:"Position",sendType:"Send method cannot be empty",smsMessageTemplate:"Message channel requires SMS, please set the message template",smsMessageTemplateCode:"SMS template code cannot be empty",sendTime:"Sending time cannot be empty",subject:"Message subject cannot be empty",content:"Message content cannot be empty",receivers:"Receiver cannot be empty!",processParticipantNotNull:"Process participant cannot be empty",activityDefIdNotNull:"When process participant is historical handler, the handling node cannot be empty",variableParticipantNotNull:"Variable participant cannot be empty",orgType:"Organization type of variable participant cannot be empty",userIds:"Designated user cannot be empty",positionId:"Position cannot be empty",activityList:"Activity List",position:"Position",optionalNodes:"Optional Nodes",targetNodeList:"Target Node List",placeholder:"Please select target node",optionalAttribute:"Optional Attributes",lineNumber:"Number",clickCancel:"Cancel",clickOK:"OK",messSendType:"Message Channel",messSubject:"Message Subject",enable:"Enable Expression",messContent:"Message Content",recipient:"Receiver",addReceiver:"Add",organization:"Organization:",posi:"Position:"},jumpScope:{targetNodeOptions:"Target Node Options",name:"Name",outConnectNode:"Process Diagram Connection Node",global:"All Nodes within the Process",afterNodes:"All Successor Nodes",specifiedSet:"Process Diagram Connection Node + Additional Nodes",firstNode:"Conditional true connection node, when there are multiple options, the first one is selected by default",nullNode:"Default is empty, manual selection every time",specifyNode:"Specify the default node",noSetTargetNode:"Target node options not set yet, please understand!",noSetSpecifyNode:"Default node not specified yet, please understand!",selectedRow:"Please select an option first!",optionalNodes:"Optional Nodes",listOfAdditional:"List of Additional Nodes",pleaseSelect1:"Please select additional nodes",defaultNode:"Default Node",pleaseSelect2:"Please select default node",defaultNodeList:"Default Node List",clickCancel:"Cancel",clickOK:"OK",set:"(Set)"},imageSet:{imageSet:"Image Setting",onlyView:"View Only",edit:"Edit",reScanStart:"Initiate Re-scan",reScanComplete:"Re-scan Complete",mutualExclusion:"[View Only] option is exclusive with other options, please understand!",set:"(Set)",notSet:"(Not Set)",imageOperation:"Image Operation Permission",clickCancel:"Cancel",clickOK:"OK"},extendProperty:{extendProperty:"Extended Property","true":"Yes","false":"No",set:"(Set)",notSet:"(Not Set)",illustrate:"Illustrate",placeholder:"Please select",cancel:"Cancel",clickOK:"OK"},expressionEditor:{expressionEditor:"Expression Editor",notSet:"(Not Set)",clickCancel:"Cancel",changeType:"Switch Type",clickOK:"OK"},executeForms:{executeForms:"Form Definition",parameters:"Parameters [",typeAsvariable:"] is of variable type, but does not exist in process variables",parameterSettings:"Parameter Settings",formDefinitionList:"Form Definition List",notSet:"(Not Set)","default":"Process Default Form",processEmbeddedForm:"Process-Embedded Form",formEmbedProcess:"Form-Embedded Process",clickCancel:"Cancel",clickOK:"OK",noForm:"No Form Format",form:"Select Form",placeholder:"Please select",parametersSet:"Parameters",key:"Variable ID",name:"Variable Name",lineNumber:"Serial Number",code:"Code",tag:"Type",value:"Parameter Value",variable:"Variable",constant:"Constant",expression:"Expression",method:"Method Identifier",methodName:"Method Name",description:"Description",workFlowAction:"Workflow Direction",formOperations:"Form Operations",executionTime:"Execution Time",sortOrder:"Execution Order",methodParameters:"Parameters",selectFormActionConfig:"Form Action Configuration not selected!",selectFormAction:"Form Action not selected!",editParam:"Settings",formEvents:"Form Events",buttonName:"Button Name",enable:"Enabled",disabled:"Disabled",hidden:"Hidden",fieldName:"Field Name",editable:"Editable",readonly:"Read-only",required:"Required",saveFail:"Failed to save configuration. Please contact the administrator for details!",checkedRows:"No button collection selected",checkeds:"No field collection selected",enableBtn:"Enabled",disabledBtn:"Disabled",hiddenBtn:"Hidden",btnBatchReset:"Reset",editableBtn:"Editable",readonlyBtn:"Read-only",requiredBtn:"Required",add:"Add","delete":"Delete",other:"Other",formBtn:"Form Button",formfield:"Form Field",apptag:"Document Type",functionMenu:"Function Menu",formFormat:"Form Format",docFormatNumber:"Document Format Number",docFormatName:"Document Format Name",selectedRow:"No form definition selected!",set:"(Set)"},eventDefinition:{eventDefinition:"Signal Definition",pass:"Forward",back:"Backward",abort:"Abort",signalRef:"Signal ID",name:"Signal Name",triggerAction:"Workflow Direction",selectedRow:"No trigger event selected!",dataLength:"At least one signal definition is required!",codeNotNull:"Signal ID cannot be empty!",nameNotNull:"Signal Name cannot be empty!",codeNotNumber:"Signal ID cannot be pure numbers!",codeRepeat:"Signal ID cannot be repeated!",set:"(Set)",notSet:"(Not Set)",add:"Add","delete":"Delete",clickCancel:"Cancel",clickOK:"OK"},entryFormEditor:{flowForm:"Process Category",code:"Code",name:"Name",base:"Base",foundation:"Foundation",extend:"Extended",selectedRow:"No process category selected",absent:"Process category no longer exists",lineNumber:"Serial Number",clickCancel:"Cancel",clickOK:"Rebind"},editComponentParameter:{code:"Code",name:"Name",required:"Required",yes:"Yes",no:"No",value:"Parameter Value",openComponentFail:"Failed to parse component",componentSelection:"Component Selection",curComponent:"Please select a process component",executionTime:"Please select execution time",para:"Parameter",paraRequired:"] is required",execuTime:"Execution Time",parameterList:"Parameter List",clickCancel:"Cancel",clickOK:"OK"},customizeAction:{customizeAction:"Customize Action",app:"Mobile",web:"Web",all:"Web, Mobile",name:"Name",code:"Code",terminalType:"Terminal Type",isAll:"Default",yes:"Yes",no:"No",paramName:"Code",valueText:"Name",value:"Parameter Value",addActions:"Select Custom Actions",actionExisted:"The added custom action already exists!",selectedRow:"Please select an option first!",set:"(Set)",notSet:"(Not set)",add:"Add","delete":"Delete",parameterList:"Parameter List",clickCancel:"Cancel",clickOK:"OK"},checkCondition:{zhChs:"Simplified Chinese",zhCht:"Traditional Chinese",en:"English",checkCondition:"Activity Validation Rule",set:"(Set)",notSet:"(Not set)",nodeEntry:"Node Entry",activityBeforeStarted:"Node Entry Condition",enterErrorTips:"Enter Condition Mismatch Tips",activityBeforeCompleted:"Node Exit",activityBeforeCompletedValue:"Node Exit Condition",leaveErrorTips:"Leave Condition Mismatch Tips",clickCancel:"Cancel",clickOK:"OK"},batchSet:{targetNode:"target Node",addSignFront:"addSign Front",addSignBehind:"addSign Behind",transfer:"transfer",notify:"notify",backWardRule:"backWard Rule",name:"name"},subProcess:{subProcessSet:"Subprocess Settings",specified:"Specify Subprocess",dynamic:"Dynamic Subprocess",inheritParent:"Same as Parent Process",autoCreation:"Auto Generate Downstream Documents",variablesExpression:"Variable Expression",rteNull:"Please select a document workflow",orderProcess:"Document Workflow",clickOk:"OK",clickCancel:"Cancel",inheritBizDataId:"When the subprocess is inconsistent with the parent process document, please set the subprocess document ID!",set:"(Set)",notSet:"(Not set)",radioGroupProcessType:"Sub Type",flowForm:"Flow Category",processDef:"Process Definition",radioGroupBillSource:"Source",autoCreationProcess:"Auto Process",bizDataId:"Document ID",setOption:"Set options",SameParentProcess:"The same business document as the parent process",setBizDataId:"Set document ID",subProcessOpt:"Subprocess Options"},backwardRule:{reEdit:"The rejected activity node no longer exists. Please re-edit.",backwardRule:"Rejection Rule",initialActityId:"Start Node",precursorActivityId:"Predecessor Node",empty:"Empty",name:"Name",id:"Identifier",sequence:"Sequential Transition",backToMe:"Return to Me",backToCurrentNode:"Return to Current Node",popover:"1. Sequential Transition: Transition according to the order of the flow lines; 2. Return to Me: If the completion strategy is Preemptive, only create tasks for the person who rejected it. If the completion strategy is Countersignature, the person who rejected it and the unapproved person will receive new tasks, and the approved personnel will automatically approve them; 3. Return to Current Node: The actual effect is affected by the option 'Is the executor a person who has already processed the node when entering the node again'",selectAbleClick:"Under the Countersignature strategy, dynamic selection of rejection target nodes is not allowed!",dictPicked:"Please use the 'Revert to Empty' option with the 'Allow dynamic selection of rejection target nodes' option",set:"(Set)",notSet:"(Not set)","rejectedTo:":"Reverted to:",backScope:"Scope of rejection",defaultPrompt:"All historical rejection nodes are selected by default",title:"Activity List",dynamicSelection:"Allow dynamic selection of rejection target nodes",resubmitEffectOptions:"Return Settings",popover1:"1. Sequential Transition: Transition according to the order of the flow lines;",popover2:"2. Return to Me: If the completion strategy is Preemptive, only create tasks for the person who rejected it. If the completion strategy is Countersignature, the person who rejected it and the unapproved person will receive new tasks, and the approved personnel will automatically approve them;",popover3:"3. Return to Current Node: The actual effect is affected by the option 'Is the executor a person who has already processed the node when entering the node again'",allowModification:"Allow modification of return settings",clickCancel:"Cancel",clickOk:"OK"},assignStrategy:{all:"All",assign:"Assign",claim:"Claim",currentUser:"Current Executor",procInstCreator:"Process Initiator",assignStrategy:"Assignment Strategy",option:"Option",assignmentRules:"Assignment Rules",operator:"Assign Operator",multiSelect:"Multiple candidate users can be selected",necessary:"Only one candidate user, still requires manual selection",clickCancel:"Cancel",clickOK:"OK"},assignScope:{assignScopeList:"Assigned Node List",required:"Required",yes:"Yes",no:"No",condition:"Condition",add:"Add","delete":"Delete",name:"Name",deleteRow:"Please select an option first!",curActivity:"No row selected",set:"(Set)",notSet:"(Not set)",nodeList:"Node List",moveUp:"Move Up",moveDown:"Move Down",clickCancel:"Cancel",clickOK:"OK"},assignPerformer:{currentUser:"Current User",procInstCreator:"Process Initiator",global:"Global",currentUnit:"Current Unit",currentDepartment:"Current Department",assignPerformer:"Assign Rule",set:"(Set)",operator:"Assign Operator",multiSelect:"Allow Selecting Multiple Candidates",necessary:"When there is only one candidate, manual selection is still required",clickCancel:"Cancel",clickOK:"OK"},approvelItems:{approvalOptions:"Approval Options",forward:"Forward",backward:"Backward",abort:"Abort",value:"Number",text:"Name",workFlowAction:"Workflow Direction",isDefault:"Default",no:"No",yes:"Yes",commentNecessary:"Comment Required",attachmentNecessary:"Attachment Upload",certification:"Digital Signature",signatureNecessary:"Manual Signature Required",defaultComment:"Default Comment","zh-CHS":"Simplified Chinese","zh-CHT":"Traditional Chinese",en:"English",workFlowActionNotNull:"Approval item workflow direction cannot be empty, please modify!",deleteRow:"Please select an option first!",set:"(Set)",notSet:"(Not Set)",add:"Add","delete":"Delete",clickCancel:"Cancel",clickOK:"OK",approvalAction:"Approval Action",lineNumber:"Number"},approvalPivot:{remind:"Text Prompt",type:"Type",condition:"Condition",title:"Display Name",description:"Detailed Description",approvalPivot:"Approval Key Point",selectedRow:"Approval key point not selected!",configTitle:"Display title not filled!",set:"(Set)",notSet:"(Not Set)",enable:"Enable",expand:"Expand",showTitle:"Display Title",list:"List",add:"Add","delete":"Delete",clickCancel:"Cancel",clickOK:"OK"},anonymousSet:{anonymousOpt:"Anonymous Option",approver:"Approver",set:"(Set)",notSet:"(Not Set)",anonymousSet:"Anonymous Settings",isAnonymity:"Enable",anonymous:"Anonymous Alias",clickCancel:"Cancel",clickOK:"OK"},activityList:{name:"Name",checkeds:"No activity nodes selected",lineNumber:"Number",clickCancel:"Cancel",clickOK:"OK"},activityComponent:{component:"Component",method:"Component Method",inconsistentParameters:"Inconsistent parameters, please check",longerExists:"The component no longer exists in this method",absent:"Cancel",pleaseCheck:", please check",edit:"Edit",deleteRow:"Delete",executionTime:"Execution Time",cmpName:"Component Name",metadataId:"Component ID",methodCode:"Component Method",isForCompensation:"Compensation Operation",yes:"Yes",no:"No",operate:"Operate",code:"Code",name:"Name",value:"Parameter Value",editComponent:"Edit Component",confirmDelete:"Confirm whether to delete the component?",curComponent:"No component selected!",newComponent:"New Component",sameCmp:"There are duplicate process components",cmpMethod:"Component Method:",executionTimeNotNull:"Component execution time cannot be empty!",param:" parameter",required:"Required",set:"(Set)",notSet:"(Not Set)",PROCESSINSTANCE_STARTED:"Process Started",PROCESSINSTANCE_SUSPENDED:"Process Suspended",PROCESSINSTANCE_RESUMED:"Process Resumed",PROCESSINSTANCE_COMPLETED:"Process Completed",PROCESSINSTANCE_ABORTED:"Process Aborted",PROCESSINSTANCE_CANCELED:"Process Canceled",PROCESSINSTANCE_REACTIVATED:"Process Reactivated",PROCESSINSTANCE_ROLLBACK:"Process Rolled Back",PROCESSINSTANCE_RESUBMIT:"Resubmit Process",ACTIVITY_AND_PARTICIPANT_UPDATED:"Activity Participants Changed",PROCESSINSTANCE_ABORTED_BY_ADMIN:"Terminated by Administrator",PROCESSINSTANCE_BEFORE_START:"Before Process Start",WORKITEM_BEFORE_COMPLETE:"Before Task Completion",WORKITEM_AFTER_COMPLETE:"After Task Completion",LOADDATA:"Retrieve Data",ACTIVITY_STARTED:"Activity Started",ACTIVITY_COMPLETED:"Activity Completed",ACTIVITY_ABORTED:"Activity Aborted",WORKITEM_CREATED:"Work Item Created",WORKITEM_COMPLETED:"Work Item Completed",WORKITEM_SUSPENDED:"Work Item Suspended",WORKITEM_RESUMED:"Work Item Resumed",WORKITEM_ABORTED:"Work Item Aborted",WORKITEM_RETRIEVED:"Work Item Retrieved",WORKITEM_CLAIMED:"Work Item Claimed",WORKITEM_UNCLAIMED:"Work Item Unclaimed",ACTIVITY_ASSIGNMENT:"Task Assignment",deleteNotAllowed:"The data retrieval component cannot be deleted, please understand!",tips:"Tips:",prefabricated:"External process components have been prefabricated, only data retrieval components are retained here",add:"Add",moveUp:"Move Up",moveDown:"Move Down",clickCancel:"Cancel",clickOK:"OK"}}},"zh-CHT":{validate:{noProcessHeader:"模型不存在processHeader内容",cmpsEmpty:"流程構件為空",cmpsEmptyMsg:"流程構件不允許為空,請聯系表單開發確認問題",directNoPf:"啟動管道為【直接】的流程不應該包含共亯（PF）的流程構件",directNoPfMsg:"請移除以下共亯（PF）的流程構件:",noLoadDataCmp:"缺少執行時機為[獲取數據]的流程構件",noLoadDataCmpMsg:"流程定義不能缺少取數構件,請聯系表單開發確認問題",noStartCmp:"缺少執行時機為[流程啟動]的流程構件",noStartCmpMsg:"會導致流程啟動時無法修改單據狀態,請聯系表單開發確認問題",lackProcessCompleteCmp:"缺少執行時機為[流程完成]的流程構件",lackProcessCompleteCmpMsg:"會導致流程完成時無法修改單據狀態,請聯系表單開發確認問題",lackProcessAbortCmp:"缺少執行時機為[流程終止]的流程構件",lackProcessAbortCmpMsg:"會導致流程終止時無法修改單據狀態,請聯系表單開發確認問題",lackProcessCancelCmp:"缺少執行時機為[流程終止]的流程構件",lackProcessCancelCmpMsg:"會導致流程終止時無法修改單據狀態,請聯系表單開發確認問題",lackProcessBackCmp:"缺少執行時機為[流程駁回]的流程構件",lackProcessBackCmpMsg:"會導致流程駁回時無法修改單據狀態,請聯系表單開發確認問題",lackProcessReStartCmp:"缺少執行時機為[重新提交]的流程構件",lackProcessReStartCmpMsg:"會導致流程重新提交時無法修改單據狀態,請聯系表單開發確認問題",parallelGatewayCheck:"【並行閘道】沒有成對出現",parallelGatewayCheckMsg:"【並行閘道】需作為一條流程分支的折開節點和彙聚節點成對出現,請修改",approvalPerformerCheck:"活動,未設定參與者",noVariable1:"活動【變數設定】内容中已設定變數",noVariable2:"在流程内容【流程變數】中已不存在,請修改！",activity:"活動【",noStartActivity:"】的標識不合法,不是以[startActivity]開頭",noExclusiveGateway:"】的標識不合法,不是以[ExclusiveGateway]開頭",noParallelGateway:"】的標識不合法,不是以[ParallelGateway]開頭",noUserActivity:"】的標識不合法,不是以[UserActivity]開頭",noOperationActivity:"】的標識不合法,不是以[OperationActivity]開頭",noNotifyActivity:"】的標識不合法,不是以[NotifyActivity]開頭",noCallActivitySubProcess:"】的標識不合法,不是以[CallActivitySubProcess]開頭",noAutoActivity:"】的標識不合法,不是以[AutoActivity]開頭",noIntermediateCatchEvent:"】的標識不合法,不是以[IntermediateCatchEventImpl]開頭",noMessageActivity:"】的標識不合法,不是以[MessageActivity]開頭",noAifCreationBillActivity:"】的標識不合法,不是以[AifCreationBillActivity]開頭",noEndEvent:"】的標識不合法,不是以[EndEvent]開頭",mark:"標識為【",noFlowNodeChsName:"】的活動簡體中文名稱為空，請修改",nameExceedsLengthLimit:"】的名稱超長，不能超過40個字元，請修改"},processEditor:{tip:"提示",showButton:"顯示查看模型按鈕",changeRecord:"流程變更記錄",noDtInfo:"不存在設計時流程信息！請先賦值！",noRtInfo:"不存在運行時流程信息！請先賦值！",wrongMoment:"設計者運行時機錯誤！",prompted:"系統提示",saveSuccess:"保存成功",waitReview:"保存成功，等待發起審核",successPublish:"發布成功",publishFail:"發布失敗，",policyConflict:"會簽策略下，“駁回規則”不允許“動態選擇駁回級次”，請修改！",noPermissionToSave:"當前用戶不具備另存流程的權限",closeProc1:"關閉此頁面？",closeProc2:"系統可能不會保存您所做的更改。",viewModel:"查看模型",copied:"模型已經復制到剪貼板",button:{saveProc:"保存",releaseProc:"發布",sync:"同步設計時包",saveAs:"另存為",procRecord:"流程記錄",viewProcModel:"查看模型",closeProc:"關閉"}},designer:{wfEditorUi:{basicElements:"基本元素",readOnly:"只讀"},wfProcessCell:{basicInfo:"基本信息",name:"名稱",nameLanguage:"名稱",key:"標識",entryForm:"流程分類",startMode:"啟動方式",wfTitle:"流程摘要",formDef:"表單定義",formsPC:"PC表單",formsMobile:"移動表單",process:"事件監聽",advanced:"高級屬性",basic:"基礎屬性",wfComponent:"流程構件",otherConfig:"其他配置",processVariables:"流程變量",basicElements:"基本元素",customizeAction:"自定義動作",timelinessInfo:"時效信息",enablePriority:"啟用緊急程度",enableWholeOrderRetrieve:"撤回在審單據",messageProperty:"影像設置",timeLimitControl:"超時操作",messageNotice:"消息通知",extendProperty:"擴展屬性",directTips:"提示：啟動方式切換為直接，直接啟動是默認的流程啟動方式，切換後會移除共享(PF)相關構件，請知悉！",externalTips:"提示：啟動方式切換為外部流程，適用於作為共享流程的外部流程相關場景，切換後保留流程上的共享（PF)相關構件，請知悉！",subprocessTips:"提示：啟動方式切換為子流程，適用於調用式子流程的場景，切換後會移除除取數構件外的其他流程構件，請知悉！"},WfSequenceFlowEdge:{basicInfo:"基本信息",basic:"基礎屬性",name:"名稱",nameLanguage:"名稱",id:"標識",condition:"條件選項",ConditionExpression:"條件","default":"缺省轉移線"},wfSidebar:{bizactivitylib:"業務活動"}},app:{processDesigner:{all:"所有",assign:"指派",claim:"領用",preempt:"搶占模式",parallel:"並行會簽",sequential:"串行會簽","true":"是","false":"否",dataId:"單據內碼",procInstId:"流程實例ID",bizDefKey:"入口單據ID",processDefinitionKey:"流程定義KEY",procInstCreator:"流程發起人",businessCreator:"業務發起人",procInstDescription:"流程摘要",comment:"審批意見",bizDefName:"流程分類名稱",curLoginUsername:"當前登錄人名稱",procInstCreatorName:"流程發起人名稱",currentParticipantId:"當前辦理人ID",currentParticipantName:"當前辦理人名稱",currentUser:"當前登錄用戶",preActExecutors:"上一個活動的執行人",collectionElementVariable:"多實例子活動元素變數",subCollectionElementVariable:"多實例子流程元素變數",nrOfInstances:"多實例總數量",nrOfCompletedInstances:"多實例已完成數量",nrOfActiveInstances:"多實例正在運行中的數量",nrOfForward:"通過實例數量",nrOfBackward:"駁回實例數量",nrOfAbort:"終止實例數量",conclusionType:"結論類型",conclusionValue:"結論值",directSuperior:"直接上級",higherSuperior:"間接上級",DIRECT:"直接",EXTERNAL_PROCESS:"外部流程",SUB_PROCESS:"子流程",ALL:"電腦端和移動端",WEB:"電腦端",APP:"移動端",conclusionTypeTips:"審批項流轉方向，1正向，2反向，3終止",conclusionValueTips:"審批項編號，例如，Pass、Back、Refuse",copy:"_副本",saveAs:"另存為",tips:"系統提示",saveAsSuccess:"另存為成功",saveAsFail:"另存為失敗，請檢查流程是否正確！",syncDt:"是否將當前版本流程定義同步到設計時流程定義包",syncSuccess:"同步成功",beforeCompleteStrategyChange:"當前節點存在運行中的活動實例，不允許調整完成策略，請了解！",releaseProcess:"發布前審核",auto:"自動生單",push:"推式生單",pull:"拉式生單",creation:"通過生單流程生成目標單"}},multiInstanceLoopCharacteristics:{loopCharacteristics:"多實例設置",set:"（已設置）",notSet:"（未設置）",isEnable:"是否啟用",isSequential:"是否串行",loopCardinality:"元素集合",completionConditionRules:"完成條件",promptAct1:"1、[集合]中的元素個數為子活動啟動實例數量。",promptAct2:"2、子活動啟動時系統會將[集合]中的元素拆分映射到各個子活動實例的[元素變數]。",promptProc1:"1、[集合]中的元素個數為子流程啟動實例數量。",promptProc2:"2、子流程啟動時系統會將[集合]中的元素拆分映射到各個子流程實例的[元素變數]。",checkPrompt:"當前節點存在運行中的活動實例，不允許調整",conditionRulesSet:"（已設置）",completionConditionRulesList:{forward:"正向",backward:"反向",abort:"終止"}},component:{optins:{wfOptions:"工作流選項",specified:"指定子流程",dynamic:"動態子流程",set:"（已設置）",notSet:"（未設置）",subProcessType:"子流程類型",processType:"流程類型",bizDef:"流程分類",procDef:"流程定義",clickCancel:"取消",clickOk:"確定"},voConfig:{documentInfo:"單據信息",viewModelSelection:"視圖模型選擇",cancel:"取消",clickOk:"確定",selectOne:"確定",documentTypeSelect:"單據類型選擇",set:"（已設置）",notSet:"（未設置）",viewModel:"視圖模型",documenttype:"單據類型",placeholder:"請選擇"},variableSetting:{constant:"常數",expression:"表達式",component:"構件",ACTIVITY_STARTED:"活動開始",ACTIVITY_COMPLETED:"活動結束",varAssign:"變量賦值",varNumber:"變量編號",REQUIRED:"必填",varName:"變量名稱",valueType:"值類型",executionTime:"執行時機",valueText:"變量值",processVariables:"流程變量",notSelectedVar:"尚未選中變量！",valueCannotEmpty:"變量值不允許為空！",set:"（已設置）",notSet:"（未設置）",add:"新增","delete":"刪除",serialNumber:"序號",clickCancel:"取消",clickOK:"確定",inconsistentParameters:"當前構件方法參數不一致，請更新！",methodNotExist:"當前構件已不存在此方法，請更新！",parameterName:"參數名",parameterValue:"參數值",methodnotSelected:"尚未選擇構件方法",metadataNotExist:"幫助元數據不存在，請聯繫系統管理員查看原因！",errorObtainComponent:"獲取解析構件錯誤",componentSelection:"構件選擇",componentName:"構件名稱",parameterList:"參數列表",lineNumber:"序號"},urgeHandleRule:{urgentApproval:"催辦審批：",pleaseApprove:"請您儘快審批",soOn:"的",urgeHandle:"催辦",noSendingMethod:"尚未選擇發送方式！",setMessageTemplate:"消息渠道啟用簡訊時需設置消息模板",codeEmpty:"簡訊模板編號不允許為空",noMessageSubject:"尚未配置消息主題！",noMessageContent:"尚未選擇消息內容！",earliestTimeNotEmpty:"最早允許催辦時間不允許為空",minimumTimeNotEmpty:"最小允許催辦間隔不允許為空",set:"（已設置）",notSet:"（未設置）",enableUrgeHandle:"啟用催辦",timeSetting:"時間設置",earliestTime:"最早允許催辦時間（小時）",minimumInterval:"最小允許催辦間隔（小時）",sendingMethod:"發送方式",messageSubject:"消息主題",supportEditing:"支持編輯",messageContent:"消息內容",displayReminder:"顯示催辦人",clickCancel:"取消",clickOK:"確定"},titleExpression:{"zh-CHS":"中文简体","zh-CHT":"中文繁體",en:"英文",taskDescription:"任務描述",set:"（已設置）",notSet:"（未設置）",currentLanguage:"當前摘要語言:",clickCancel:"取消",clickOK:"確定"},timeLimitControl:{timedOutOperation:"超時操作",constant:"固定值",scope:"時間範圍",day:"天",hour:"時",minute:"分",BeforeDuration:"到期之前",OnDuration:"到期時",AfterDuration:"到期之後",SendMessageExpireOperation:"超時預警",AutoHandleExpireOperation:"自動辦理",curDay:"當天",durationType:"期限類型",required:"必填",timeDuration:"時長",timeUnit:"單位",operationTypeName:"操作類型名稱",sendType:"操作",onlyBeInteger:"任務期限只能是整數！",setOperation:"請設置超時操作！",setType:"請設置自動辦理類型！",setComments:"請設置自動辦理意見！",selectedOperation:"尚未選中預警操作！",notSupportAutomatic:"下一節點是由當前辦理人指派的話，當前節點不支持任務自動辦理",warningMessage:"預警消息",automaticProcessing:"自動辦理",set:"（已設置）",notSet:"（未設置）",timelinessControl:"任務處理時效控制",isEnable:"是否啟用",taskDeadline:"任務期限",timelyOperation:"時效預警操作",actionList:"操作列表",add:"新增",remove:"刪除",clickCancel:"取消",clickOK:"確定",workItemParticipant:"當前節點辦理人",procInstCreator:"流程發起人","to-doMessageTimeOut":"您有一條待辦消息即將超時。",messageTimeOut:"您有一條消息即將超時",agree:"同意"},sendMessageOperation:{procInstCreator:"流程發起人",workItemParticipant:"當前節點辦理人",preActExecutors:"上一節點辦理人",day:"天",hour:"時",minute:"分",cycleTimeNotEmpty:"循環時間間隔不允許為空！",sendMethodNotEmpty:"發送方式不允許為空！",subjectNotEmpty:"消息主題不允許為空！",contentNotEmpty:"消息內容不允許為空！",recipientNotEmpty:"接收人不允許為空！",messageTemplate:"消息渠道啟用短信時需設置消息模板",smsTemplateNumberNotEmpty:"短信模板編號不允許為空",cycleEnable:"啟用循環預警",cycleTime:"循環時間間隔",sendType:"發送方式",subject:"消息主題",message:"消息內容",receiverVari:"接收人",sysUsers:"系統用戶",clickCancel:"取消",clickOK:"確定",opinionsNotEmpty:"自動辦理意見不允許為空！",processingNotEmpty:"自動辦理不允許為空！",automaticProcessSet:"自動辦理設置",automaticProcessMethod:"自動辦理方式",automaticOpinionHandle:"自動辦理意見"},smsMessageTemplate:{smsTemplateContent:"協力廠商簡訊服務商裏定義的範本原文，例如：阿裡雲您的管控大數據平臺帳號已開通，用戶名為：${username}，初始密碼為：${code}，請及時登入系統",code:"變量",value:"值",noRowsSelected:"尚未選中行",smsMessageTemplate:"短信服務模板",tips1:"消息模板是指已經在第三方短信服務商定義模板後，需要在GS Cloud裡將短信服務商的模板變量和GS Cloud變量關聯",tips2:"第三方短信服務商裡定義的模板編號，例如: 阿里雲 SMS_220626324",tips3:"將第三方短信服務商模板裡的變量和GSCloud裡的變量配置關聯",smsTemplateNumber:"短信模板編號",smsVariableBinding:"短信變量綁定",addSmsVariable:"新增",deleteSmsVariable:"刪除"},signRule:{countersignRules:"會簽規則",byNumber:"按數量",byProportion:"按比例(%)",customConditions:"自定義條件",value:"編號",text:"名稱",conclusionName:"結論名稱",conclusionValue:"結論值",calculateType:"計算方式",conditionValue:"條件值",waitAllVotes:"等待全員辦結",yes:"是",no:"否",notEmpty:"完成策略為會簽時，會簽規則不允許為空，請了解！",pleaseSelect:"請首先選中一條審批項！",maxConditionValue:"條件值最大值是100",minConditionValue:"條件值最小值是0",noConditional:"結論執行方式為全票或一票時不需要條件值",set:"（已設置）",ruleList:"規則列表",approvalOptions:"審批選項",clickCancel:"取消",deleteRow:"重置",clickOK:"確定"},saveAsEdit:{"public":"公有","private":"私有",code:"編號",name:"名稱",nameNotEmpty:"流程名稱不能為空",organizationNotEmpty:"維護組織不能為空",organization:"組織",basicAttributes:"基礎屬性",processName:"流程名稱",processKeyValue:"流程Key值",maintenanceOrg:"維護組織",accessLevel:"訪問級別",saveAsCancel:"取消",saveAsOK:"確定"},release:{release:"流程發布",update:"流程更新",applicantName:"申請人名稱",applicantDepartment:"申請人部門",procName:"流程名稱",procVersion:"流程版本",releaseType:"發布類型",textDetail:"說明",saveAsCancel:"取消",saveAsOK:"確定"},processVariables:{string:"字符",integer:"整型",decimal:"小數","boolean":"布爾",constant:"常量",expression:"表達式",component:"構件",name:"變量編號",required:"必填",documentation:"變量名稱",basicType:"變量類型",description:"描述",tag:"初始值類型",valueText:"初始值",processVariables:"流程變量",notSelected:"尚未選中流程變量！",variableNumberEmpty:"變量編號不允許為空！",variableNameEmpty:"變量名稱不允許為空！",variableNumberNotStandard:"變量編號只能包含字母、數字和下劃線，且不能以數字開頭！",tagNotEmpty:"初始值類型不允許為空！",codeDuplicates:"流程變量編號不允許重複！",alreadyExists:"新增的變量已存在！",set:"（已設置）",notSet:"（未設置）",add:"新增","delete":"刪除",number:"序號",clickCancel:"取消",clickOK:"確定"},participant:{user:"用戶",variable:"變量參與者",position:"崗位",role:"角色",component:"構件參與者",reportingLine:"匯報關係",matrix:"矩陣",activityExecutor:"歷史活動辦理人",organization:"單位/部門",all:"所有",assign:"指派",claim:"領用",currentUser:"當前辦理人",procInstCreator:"流程發起人",participantSet:"參與者設置",order:"序號",type:"類型",performerName:"名稱",description:"描述",condition:"啟用條件",dataMovement1:"是否將默認辦理人數據移動到到備選辦理人？",dataMovement2:"是否將備選辦理人數據移動到默認辦理人？",participantSelection:"參與者選擇",selectProcessVariables:"尚未選擇流程變量！",selectVariableValueType:"尚未選擇變量值類型！",selectRelation:"尚未選擇關係！",selectPosition:"尚未選擇崗位！",selectOrgType:"尚未選擇組織類型！",orgFill:"尚未填寫組織！",refOrgIdNotNull:"參照類型為組織時，參照組織欄位不能為空",refUserIdNotNull:"參照類型為系統用戶/員工時，參照人欄位不能為空",repDefConfigured:"該匯報關係已經進行過配置",atLeastOneCondition:"條件欄位至少要存在一個",dataFieldAliasNotNull:"數據欄位不能為空",matrixConfigured:"該矩陣已經進行過配置",selectPerformer:"尚未選擇參與者",definitionDeleted:"該條匯報關係數據的定義已刪除，該條數據將刪除",matrixDeleted:"該條矩陣數據的定義已刪除，該條數據將刪除",selectParticipantInfo:"請先選中一條參與者信息！",noRowSelected:"尚未選中行！",selectDefaultHandler:"請先選中一條默認辦理人",selectpotentialtHandler:"請先選中一條備選辦理人",org:"組織：",positionType1:"崗位類型：通用崗位，組織：",positionType2:"崗位類型：通用崗位",positionType3:"崗位類型：組織崗位",comp:"構件：","parameters:":"，參數：{","referencePerson:":"參照人：","referenceOrganization:":"參照組織：",condition1:"條件1：",condition2:"條件2：",condition3:"條件3：",data:"數據：",set:"（已設置）",notSet:"（未設置）",allocationPolicy:"分配策略",operator:"指派操作人",multiSelect:"允許多選",necessary:"只有一個待選用戶時，仍需手工選擇",notifyRecipient:"知會接收人",defaultHandler:"默認辦理人","new":"新增",editPerformer:"編輯",removePerformer:"移除",clearPerformer:"清空",moveUp:"上移",moveDown:"下移",alternativeHandler:"備選辦理人",isAllScope:"指定參與人時不限範圍，從全員用戶中選擇",clickCancel:"取消",clickOK:"確定",alternativeScope:"備選範圍",orgId:"組織ID",includeChildren:"包含下級",conditon:"啟用條件",currentUnit:"本組織",currentDepartment:"本部門",variableOrganization:"變量組織"},activityExecutor:{name:"名稱",eventHandler:">活動辦理人",nodeName:"節點名稱",enablingConditions:"啟用條件",activityList:"活動列表",clickCancel:"取消",clickOK:"確定"},componentPerformer:{componentMethod:"當前構件方法參數不一致，請更新！",methodNotExist:"當前構件已不存在此方法，請更新！",code:"編號",name:"名稱",description:"描述",valueText:"參數值",help:"幫助",errorObtaining:"獲取解析構件出錯",componentSelection:"構件選擇",metadataNotExist:"幫助元數據不存在！",serverSideNotFound:"服務器端未找到幫助元數據，請檢查元數據是否已經部署到環境中",componentName:"構件名稱",componentSelect:"構件選擇",parameterList:"參數列表"},matrixPerformer:{code:"編號",name:"名稱",help:"幫助",multivalue:"多值",enumSelection:"枚舉選擇",refMatrixTable:"引用矩陣表",matrixTable:"矩陣表",curDataFieldValue:"結果列",conditionFields:"條件字段",condition:"啟用條件",key:"鍵",value:"值",notSelectEnum:"尚未選中枚舉值",cancel:"取消",onConfirm:"確定",lineNumber:"序號"},performerOptions:{leave:"向下流轉",throwException:"異常提示",sys:"用戶ID",administrative_staff:"員工ID",procInstCreator:"流程發起人",preActExecutors:"上一節點辦理人",allPassExecutors:"所有已辦理人員",performerOptions:"參與者選項",exclusionNotAllowed:"所有已辦理人員已設置自動審批，上個節點已辦理人員默認不允許排除！",approvalNotAllowed:"【分配策略】為【領用】時，不允許設置自動審批，請了解！",approvalNotAllowedAsSet:"所有已辦理人員已設置不允許審批，所以上個節點已辦理人員默認不允許自動審批！",allocationStrategyIsCollect:"【分配策略】為【領用】時，不允許設置自動審批，請了解！",set:"（已設置）",advancedOptions:"參與者高級選項",historicFirst:"再次進入節點時，辦理人是節點的已辦人員",noPerformerStrategy:"辦理人為空策略：",excludeProcInstCreator:"排除辦理人選項",defaultNotParticipate:"流程發起人默認不參與審批",excludePreActExecutors:"上個節點已辦理人員默認不參與審批",excludeAllPassExecutors:"所有已辦理人員默認不參與審批",excludeExprPerformer:"流程變量：",variableOrgTypes:"變量值類型：",automaticApprovalOptions:"自動審批選項",autoProcInstCreator:"流程發起人默認自動審批通過",autoPreActExecutors:"上一節點辦理人員默認自動審批通過",autoAllPassExecutors:"所有已辦理人員默認自動審批通過",cancel:"取消",clickOK:"確定"},positionPerformer:{orgPosition:"組織岗",generalPosition:"通用岗",sysPositions:"系統岗位",positionType:"岗位類型",role:"角色",position:"岗位",sysType:"組織類型",placeholder:"請選擇",orgId:"組織ID",condition:"啟用條件",clickCancel:"取消",clickOK:"確定"},reportingLine:{higherSuperior:"間接上級",directSuperior:"直接上級",code:"編號",name:"名稱",dept:"組織",sysUser:"系統用戶",employee:"員工",businessFields:"業務字段",defName:"匯報定義",dimension:"匯報級別",curReportingRefer:"參照類型",usersName:"參照人",refOrgId:"參照組織",condition:"啟用條件",definitionOfReport:"匯報關係定義"},userPerformer:{regularUser:"固定使用者",variablePart:"變數參與者",sys:"系統使用者",administrative_organization:"員工",cantUseContext:"行政人員類型不能使用此上下文變數",user:"使用者",variable:"變數",condition:"啟用條件"},variablePerformer:{sys:"使用者ID",administrative_staff:"員工ID",oneself:"本人",administrative_organization:"部門ID",cantUseContext:"行政人員類型不能使用此上下文變數",processVariables:"流程變數",variableOrgTypes:"變數值類型",relationShipType:"關係",condition:"啟用條件"},orgPotentialOwner:{optionSettings:"選項設置",global:"全體成員",currentUnit:"本單位",currentDepartment:"本部門",addSignBehind:"加簽",addSignFront:"徵詢",transfer:"移交",notify:"知會",set:"（已設置）",notSet:"（未設置）",option:"選項",enable:"是否啟用",range:"範圍",OrgId:"組織ID",variableOrganization:"變數組織",includeChildren:"包含下級",clickCancel:"取消",clickOK:"確定",limit:"限定人員範圍",turnOffPrompt:"請關閉限定人員範圍選項"},note:{placeholder:"請輸入流程變更記錄",clickCancel:"取消",clickOK:"確定"},MessageNotice:{notify:"消息通知",subject:"消息主題",content:"消息內容",sendTime:"發送時機",sendType:"發送方式",receiverText:"消息接收人",procInstCreator:"流程發起人，",workItemParticipant:"任務接收人，",messageSet:"消息設置",selectedRow:"尚未選中消息通知！",noCopy:"沒有待複製的消息通知屬性！",batchCopy:"批量複製",set:"（已設置）",notSet:"（未設置）",add:"新增",edit:"編輯","delete":"刪除",lineNumber:"序號",clickCancel:"取消",clickOK:"確定",messContent:'{"expr":"\'您有一條消息通知。\'","sexpr":""}',procComplete:"流程完成",procAborted:"流程終止",procRollBack:"流程驳回",workCreated:"任務創建",actComplete:"活動完成",actAborted:"活動終止",email:"郵件",sms:"短信",cloudplus:"雲",processParticipant:"流程參與人",variableParticipant:"變數參與者",userParticipant:"指定使用者",positionParticipant:"崗位",activityExecutorParticipant:"歷史辦理人",sys:"系統使用者",administrative_organization:"員工",name:"名稱",noTargetNode:"尚未選中節點！","noMessageNotifyAttribute!":"沒有消息通知屬性！"},messageNoticeEdit:{procInstCreator:"流程發起人",activityExecutorParticipant:"歷史辦理人",workItemParticipant:"任務辦理人",sys:"系統使用者",administrative_organization:"員工",processParticipant:"流程參與人",workItemReceiveParticipant:"任務接收人",variableParticipant:"變數參與者",userParticipant:"指定使用者",positionParticipant:"崗位",sendType:"發送方式不允許為空",smsMessageTemplate:"消息渠道啟用短信時需設置消息模板",smsMessageTemplateCode:"短信模板編號不允許為空",sendTime:"發送時機不允許為空",subject:"消息主題不允許為空",content:"消息內容不允許為空",receivers:"接收人不允許為空！",processParticipantNotNull:"流程參與人不允許為空",activityDefIdNotNull:"流程參與人為歷史辦理人時，辦理節點不允許為空",variableParticipantNotNull:"變數參與者不允許為空",orgType:"變數參與者組織類型不允許為空",userIds:"指定使用者不允許為空",positionId:"崗位不允許為空",activityList:"活動列表",position:"崗位",optionalNodes:"可選節點",targetNodeList:"目標節點列表",placeholder:"請選擇目標節點",optionalAttribute:"可選屬性",lineNumber:"序號",clickCancel:"取消",clickOK:"確定",messSendType:"消息渠道",messSubject:"消息主題",enable:"啟用表達式",messContent:"消息內容",recipient:"接收人",addReceiver:"添加",organization:"組織：",posi:"崗位："},jumpScope:{targetNodeOptions:"目標節點選項",name:"名稱",outConnectNode:"流程圖連線節點",global:"流程內所有節點",afterNodes:"所有後繼節點",specifiedSet:"流程圖連線節點+附加節點",firstNode:"條件為true的連線節點，當有多條時默認選中首條",nullNode:"默認為空，每次都手動選擇",specifyNode:"指定默認節點",noSetTargetNode:"尚未設置目標節點選項，請了解！",noSetSpecifyNode:"尚未指定默認節點，請了解！",selectedRow:"請首先選中一條選項！",optionalNodes:"可選節點",listOfAdditional:"附加節點列表",pleaseSelect1:"請選擇附加節點",defaultNode:"默認節點",pleaseSelect2:"請選擇默認節點",defaultNodeList:"默認節點列表",clickCancel:"取消",clickOK:"確定",set:"（已設置）"},imageSet:{imageSet:"影像設置",onlyView:"僅可查看",edit:"編輯",reScanStart:"發起重掃",reScanComplete:"重掃完成",mutualExclusion:"【僅可查看】選項與其他選項互斥，請了解！",set:"（已設置）",notSet:"（未設置）",imageOperation:"影像操作權限",clickCancel:"取消",clickOK:"確定"},extendProperty:{extendProperty:"擴展屬性","true":"是","false":"否",set:"（已設置）",notSet:"（未設置）",illustrate:"說明",placeholder:"請選擇",cancel:"取消",clickOK:"確定"},expressionEditor:{expressionEditor:"條件編輯",notSet:"（未設置）",clickCancel:"取消",changeType:"切換類型",clickOK:"確定"},executeForms:{executeForms:"表單定義",parameters:"參數【",typeAsvariable:"】類型為變量，但在流程變量裡不存在",parameterSettings:"參數設置",formDefinitionList:"表單定義列表",notSet:"（未設置）","default":"流程默認表單",processEmbeddedForm:"流程嵌表單",formEmbedProcess:"表單嵌流程",clickCancel:"取消",clickOK:"確定",noForm:"暫無表單格式",form:"選擇表單",placeholder:"請選擇",parametersSet:"參數",key:"變量編號",name:"變量名稱",lineNumber:"序號",code:"編號",tag:"類型",value:"參數值",variable:"變量",constant:"常量",expression:"表達式",method:"方法標識",methodName:"方法名稱",description:"描述",workFlowAction:"流轉方向",formOperations:"表單操作",executionTime:"執行時機",sortOrder:"執行順序",methodParameters:"參數",selectFormActionConfig:"尚未選中表單操作配置！",selectFormAction:"尚未選中表單操作！",editParam:"設置",formEvents:"表單事件",buttonName:"按鈕名稱",enable:"是否可用",disabled:"是否禁用",hidden:"是否隱藏",fieldName:"字段名稱",editable:"是否可寫",readonly:"是否只讀",required:"是否必填",saveFail:"保存配置失敗，請聯繫管理員查看原因！",checkedRows:"尚未選擇按鈕集合",checkeds:"尚未選擇字段集合",enableBtn:"可用",disabledBtn:"禁用",hiddenBtn:"隱藏",btnBatchReset:"重置",editableBtn:"可寫",readonlyBtn:"只讀",requiredBtn:"必填",add:"新增","delete":"刪除",other:"其他",formBtn:"表單按鈕",formfield:"表單字段",apptag:"單據類型",functionMenu:"功能菜單",formFormat:"表單格式",docFormatNumber:"單據格式編號",docFormatName:"單據格式名稱",selectedRow:"尚未選擇表單定義！",set:"（已設置）"},eventDefinition:{eventDefinition:"信號定義",pass:"正向",back:"反向",abort:"終止",signalRef:"信號編號",name:"信號名稱",triggerAction:"流轉方向",selectedRow:"尚未選中一條觸發事件！",dataLength:"至少需要一個信號定義，請了解！",codeNotNull:"信號編號不允許為空！",nameNotNull:"信號名稱不允許為空！",codeNotNumber:"信號編號不允許為純數字！",codeRepeat:"信號編號不允許重複！",set:"（已設置）",notSet:"（未設置）",add:"新增","delete":"刪除",clickCancel:"取消",clickOK:"確定"},entryFormEditor:{flowForm:"流程分類",code:"編號",name:"名稱",base:"類型",foundation:"基礎",extend:"擴展",selectedRow:"尚未選擇流程分類",absent:"流程分類已經不存在",lineNumber:"序號",clickCancel:"取消",clickOK:"重新綁定"},editComponentParameter:{code:"編號",name:"名稱",required:"必填",yes:"是",no:"否",value:"參數值",openComponentFail:"獲取解析構件出錯",componentSelection:"構件選擇",curComponent:"請選擇流程構件",executionTime:"請選擇執行時機",para:"參數",paraRequired:"】必填",execuTime:"執行時機",parameterList:"參數列表",clickCancel:"取消",clickOK:"確定"},customizeAction:{customizeAction:"自定義動作",app:"移動",web:"web",all:"web,移動",name:"名稱",code:"編號",terminalType:"適用終端",isAll:"是否默認",yes:"是",no:"否",paramName:"編號",valueText:"名稱",value:"參數值",addActions:"自定義動作選擇",actionExisted:"新增的自定義動作已經存在！",selectedRow:"請首先選中一條選項！",set:"（已設置）",notSet:"（未設置）",add:"新增","delete":"刪除",parameterList:"參數列表",clickCancel:"取消",clickOK:"確定"},checkCondition:{zhChs:"簡體中文",zhCht:"繁體中文",en:"英文",checkCondition:"活動校驗規則",set:"（已設置）",notSet:"（未設置）",nodeEntry:"節點進入",activityBeforeStarted:"節點進入條件",enterErrorTips:"進入條件不匹配提示語",activityBeforeCompleted:"節點離開",activityBeforeCompletedValue:"節點離開條件",leaveErrorTips:"離開條件不匹配提示語",clickCancel:"取消",clickOK:"確定"},batchSet:{targetNode:"目標節點",addSignFront:"徵詢",addSignBehind:"加簽",transfer:"移交",notify:"知會",backWardRule:"駁回規則",name:"名稱"},subProcess:{subProcessSet:"子流程設置",specified:"指定子流程",dynamic:"動態子流程",inheritParent:"與父流程相同",autoCreation:"自动生成下游單據",variablesExpression:"變量表達式",rteNull:"請選中一條生單流程",orderProcess:"生單流程",clickOk:"確定",clickCancel:"取消",inheritBizDataId:"當子流程與父流程單據不一致時，請設置子流程單據內碼！",set:"（已設置）",notSet:"（未設置）",radioGroupProcessType:"子流程類型",flowForm:"流程分類",processDef:"流程定義",radioGroupBillSource:"單據來源",autoCreationProcess:"生單流程",bizDataId:"單據內碼",setOption:"設置選項",SameParentProcess:"與父流程同一張業務單據",setBizDataId:"設置單據內碼",subProcessOpt:"子流程選項"},backwardRule:{reEdit:"駁回活動節點已不存在，請重新編輯",backwardRule:"駁回規則",initialActityId:"開始節點",precursorActivityId:"前置節點",empty:"空",name:"名稱",id:"標識",sequence:"順序流轉",backToMe:"返回我",backToCurrentNode:"返回本節點",popover:"1.順序流轉:按照流轉線順序進行流轉; 2.返回我:完成策略為搶佔：只給駁回人創建任務,完成策略為會簽：駁回人與未審批人收到新任務，已審批人員自動審批通過; 3.返回本節點:實際效果受“再次進入節點時，辦理人是否是節點已辦人員影響”選項的影響",selectAbleClick:"會簽策略下，不允許動態選擇駁回目標節點!",dictPicked:"“駁回至空”選項請搭配“允許動態選擇駁回目標節點”使用",set:"（已設置）",notSet:"（未設置）","rejectedTo:":"駁回至：",backScope:"駁回範圍",defaultPrompt:"默認選取全部歷史駁回節點",title:"活動列表",dynamicSelection:"允許修改返回設置",resubmitEffectOptions:"返回設置",popover1:"1.順序流轉:按照流轉線順序進行流轉; ",popover2:"2.返回我:完成策略為搶佔：只給駁回人創建任務,完成策略為會簽：駁回人與未審批人收到新任務，已審批人員自動審批通過;",popover3:"3.返回本節點:實際效果受“再次進入節點時，辦理人是否是節點已辦人員影響”選項的影響",allowModification:"允許修改返回設置",clickCancel:"取消",clickOk:"確定"},assignStrategy:{all:"所有",assign:"指派",claim:"領用",currentUser:"當前辦理人",procInstCreator:"流程發起人",assignStrategy:"分配策略",option:"選項",assignmentRules:"指派規則",operator:"指派操作人",multiSelect:"允許選擇多個待選用戶",necessary:"只有一個待選用戶時，仍需手工選擇",clickCancel:"取消",clickOK:"確定"},assignScope:{assignScopeList:"指派節點列表",required:"必填",yes:"是",no:"否",condition:"條件",add:"增加","delete":"刪除",name:"名稱",deleteRow:"請首先選中壹條選項！",curActivity:"尚未選中行",set:"（已設置）",notSet:"（未設置）",nodeList:"節點列表",moveUp:"上移",moveDown:"下移",clickCancel:"取消",clickOK:"確定"},assignPerformer:{currentUser:"當前辦理人",procInstCreator:"流程發起人",global:"全員",currentUnit:"本單位",currentDepartment:"本部門",assignPerformer:"指派規則",set:"（已設置）",operator:"指派操作人",multiSelect:"允許選擇多個待選用戶",necessary:"只有一個待選用戶時，仍需手工選擇",clickCancel:"取消",clickOK:"確定"},approvelItems:{approvalOptions:"審批選項",forward:"正向",backward:"反向",abort:"終止",value:"編號",text:"名稱",workFlowAction:"流轉方向",isDefault:"默認",no:"否",yes:"是",commentNecessary:"意見必填",attachmentNecessary:"附件上傳",certification:"數字簽名",signatureNecessary:"手寫簽名必填",defaultComment:"默認意見","zh-CHS":"中文簡體","zh-CHT":"中文繁體",en:"英文",workFlowActionNotNull:"審批項流轉方向不允許為空，請修改！",deleteRow:"請首先選中壹條選項！",set:"（已設置）",notSet:"（未設置）",add:"新增","delete":"刪除",clickCancel:"取消",clickOK:"確定",approvalAction:"審批動作",lineNumber:"序號"},approvalPivot:{remind:"文字提示",type:"類型",condition:"條件",title:"顯示名稱",description:"詳細說明",approvalPivot:"審批要點",selectedRow:"尚未選中審批要點！",configTitle:"尚未填寫顯示標題！",set:"（已設置）",notSet:"（未設置）",enable:"是否啟用",expand:"是否展開",showTitle:"顯示標題",list:"列表",add:"新增","delete":"刪除",clickCancel:"取消",clickOK:"確定"},anonymousSet:{anonymousOpt:"匿名選項",approver:"審批人",set:"（已設置）",notSet:"（未設置）",anonymousSet:"匿名設置",isAnonymity:"是否啟用",anonymous:"匿名代稱",clickCancel:"取消",clickOK:"確定"},activityList:{name:"名稱",checkeds:"尚未選擇活動節點",lineNumber:"序號",clickCancel:"取消",clickOK:"確定"},activityComponent:{component:"構件",method:"構件方法",inconsistentParameters:"參數不壹致，請檢查",longerExists:"構件已不存在此構件方法",absent:"取消",pleaseCheck:"，請檢查",edit:"編輯",deleteRow:"刪除",executionTime:"執行時機",cmpName:"構件名稱",metadataId:"構件ID",methodCode:"構件方法",isForCompensation:"補償操作",yes:"是",no:"否",operate:"操作",code:"編號",name:"名稱",value:"參數值",editComponent:"編輯構件",confirmDelete:"確認是否刪除構件？",curComponent:"尚未選中構件！",newComponent:"新建構件",sameCmp:"存在相同的流程構件",cmpMethod:"構件方法：",executionTimeNotNull:"構件執行時機不允許為空！",param:"的參數",required:"必填",set:"（已設置）",notSet:"（未設置）",PROCESSINSTANCE_STARTED:"流程啟動",PROCESSINSTANCE_SUSPENDED:"流程挂起",PROCESSINSTANCE_RESUMED:"流程恢復",PROCESSINSTANCE_COMPLETED:"流程完成",PROCESSINSTANCE_ABORTED:"流程終止",PROCESSINSTANCE_CANCELED:"流程取消",PROCESSINSTANCE_REACTIVATED:"流程復活",PROCESSINSTANCE_ROLLBACK:"流程驳回",PROCESSINSTANCE_RESUBMIT:"重新提交",ACTIVITY_AND_PARTICIPANT_UPDATED:"環節辦理人變更",PROCESSINSTANCE_ABORTED_BY_ADMIN:"管理員終止",PROCESSINSTANCE_BEFORE_START:"流程啟動前",WORKITEM_BEFORE_COMPLETE:"任務完成前",WORKITEM_AFTER_COMPLETE:"任務完成後",LOADDATA:"獲取數據",ACTIVITY_STARTED:"活動啟動",ACTIVITY_COMPLETED:"活動完成",ACTIVITY_ABORTED:"活動終止",WORKITEM_CREATED:"工作項創建",WORKITEM_COMPLETED:"工作項完成",WORKITEM_SUSPENDED:"工作項挂起",WORKITEM_RESUMED:"工作項恢復",WORKITEM_ABORTED:"工作項終止",WORKITEM_RETRIEVED:"工作項取回",WORKITEM_CLAIMED:"工作項領用",WORKITEM_UNCLAIMED:"工作項反領用",ACTIVITY_ASSIGNMENT:"任務分配前",deleteNotAllowed:"取數構件不允許刪除，請了解！",tips:"提示：",prefabricated:"已經預製外部流程構件，此處只保留取數構件",add:"新增",moveUp:"上移",moveDown:"下移",clickCancel:"取消",clickOK:"確定"}}}},Au=Tu,Au=(Object.defineProperty(A.prototype,"time",{get:function(){return this._time},set:function(e){this._time=e,this.uiState.time=e},enumerable:!0,configurable:!0}),Object.defineProperty(A.prototype,"scene",{get:function(){return this.uiState.scene},set:function(e){this.uiState.scene=e},enumerable:!0,configurable:!0}),A.prototype.ngOnInit=function(){var t=this;this.procNameTitle=this.processInfo?this.processInfo.processName:this.rtProcessInfo.procName,this.rtProcessInfo&&this.rtProcessInfo.rtProcDefId&&(this.uiState.procDefId=this.rtProcessInfo.rtProcDefId),this.addEventBusListener(),this.uiState.initUIState(),this.showLoading(),this.addPropertyChangedHandler(),this.uiState.getMessageChannels(),focus(),document.body.addEventListener("keydown",function(e){!t.showModelButton&&e.shiftKey&&"Slash"===e.code&&(t.showModelButton=!0,t.notify.success(t.localePipe.transform("processEditor.showButton")),t.viewProcModel())}),this.cdr&&this.cdr.detectChanges(),this.createEditorUi()},A.prototype.createEditorUi=function(){var i=this;this.service.getGeneralConfig().subscribe(function(r){var e=(i._time===We.rt?i.rtProcessInfo:i.processInfo).flowFormId;i.viewModel.getProcessCategory(e).subscribe(function(e){var t=i._time===We.dt?e.businessObjectId:undefined;i.service.getFormFormat(t).pipe(re.switchMap(function(e){return i.cdr&&i.cdr.detectChanges(),i.editorUi=new xu(i._time,i.action,i.editorUiContainerER.nativeElement,i.injector,i.modalService,i.resolver),i.editorUi.multiLangEnabled=!0,i.editorUi.langCode=i.localeId,i.editorUi.bizCategoryId=t,i.editorUi.mode=i.mode,i.editorUi.scene=i.uiState.scene,i.editorUi.procType=i.procType,i.editorUi.generalConfig=r,i.editorUi.formFormats=e,v.of({})})).pipe(re.delay(200)).subscribe(function(){i.openProcContent()})})})},A.prototype.addEditorUiListeners=function(e){var r=this;e.addListener(ce.PmfEvents.ShowProperty,function(e,t){t=t.getProperty("cells");r.viewModel.setProperty(r.editorUi.getFarrisPropConfig(t))}),e.graph.addListener(ce.PmfEvents.CellsInserted,function(e,t){r.uiState.getUserActList(r.editorUi.getActivities()),r.uiState.getNotifyEventList(r.editorUi.getNotifyEvents()),r.uiState.getEndEventList(r.editorUi.getEndEvents())}),e.graph.addListener(pe.mxEvent.CELLS_REMOVED,function(){r.uiState.getUserActList(r.editorUi.getActivities()),r.uiState.getNotifyEventList(r.editorUi.getNotifyEvents()),r.uiState.getEndEventList(r.editorUi.getEndEvents())})},A.prototype.addEventBusListener=function(){var t=this;this.eventBus.on(Su,function(e){e&&t.editorUi.batchCopyProperty(e)}),this.eventBus.on(Eu,function(e){e&&t.editorUi.batchSetProperty(e)})},A.prototype.addPropertyChangedHandler=function(){var t=this;return this.propertyPanel.propertyChanged.subscribe(function(e){t.updateChangeProperty(e)}),this.propertyPanel.submitModal.subscribe(function(e){t.updateChangeProperty(e.changeObject,e.parameters)}),!1},A.prototype.updateChangeProperty=function(t,e){var r=this;switch(void 0===e&&(e=null),this.changedFlag=!1,t.Id=this.uiState.propertyData.Id,e&&(t.parameters=e),t.propertyID){case Yi:this.bindEntryFormInfo(t);break;case ds:this.editorUi.updateProperty(t),this.activity.buildCounterSignVariables(t.propertyValue);break;case ms:this.beforeCompleteStrategyChange(t).subscribe(function(e){e&&(r.editorUi.updateProperty(t),r.completeStrategyChanged(t.propertyValue)),r.viewModel.setProperty(r.editorUi.refreshProperty(t))});break;case fs:this.editorUi.updateProperty(t);break;case Ji:case Ds:case hc:case Dc:t.propertyValue.isBatchCopy?this.editorUi.batchCopyProperty(t):this.editorUi.updateProperty(t);break;case Bi:this.updateStartMode(t);break;default:this.editorUi.updateProperty(t)}this.uiState.getUserActList(this.editorUi.getActivities()),this.uiState.getEndEventList(this.editorUi.getEndEvents()),this.uiState.getNotifyEventList(this.editorUi.getNotifyEvents()),this.uiState.getStartMode(this.editorUi.getStartMode()),this.editorUi.getStartMode()==de.StartMode.SUB_PROCESS?this.uiState.subActivityContext=this.uiState.subActivityContext.concat(this.uiState.subProcessElementContext):this.uiState.subActivityContext=this.uiState.subActivityContext.filter(function(t){return r.uiState.subProcessElementContext.some(function(e){return e.key!=t.key})}),this.viewModel.setProperty(this.editorUi.refreshProperty(t))},A.prototype.bindEntryFormInfo=function(t){var r=this,e=t.propertyValue.id;e&&this.viewModel.getFlowFormInfoById(e).subscribe(function(e){t.flowForm=e.flowForm,t.formalParameters=e.formalParameters,t.processBizComponnets=e.bizComponents,t.executeForms=[],e.excuteForms.forEach(function(e){e.isDefault&&(e=r.ConvertExecuteForm(e),t.executeForms=t.executeForms.concat(e))}),t.customizeActions=e.customizeActions.filter(function(e){return!0===e.isAll}).map(function(e){return{id:e.id,code:e.code,name:e.name,terminalType:e.terminal,actualParameters:e.actualParameters.map(function(e){return{Name:e.code,Value:e.value,ValueText:e.name,Tag:"expression"}})}}),r.editorUi.loadBizActivities(e.bizActivities||[]),r.service.getBizCmp().subscribe(function(e){t.bizCmps=e,r.editorUi.updateProperty(t),r.uiState.getUserActList(r.editorUi.getActivities()),r.uiState.getEndEventList(r.editorUi.getEndEvents()),r.uiState.getNotifyEventList(r.editorUi.getNotifyEvents()),r.uiState.getStartMode(r.editorUi.getStartMode()),r.editorUi.getStartMode()==de.StartMode.SUB_PROCESS?r.uiState.subActivityContext=r.uiState.subActivityContext.concat(r.uiState.subProcessElementContext):r.uiState.subActivityContext=r.uiState.subActivityContext.filter(function(t){return r.uiState.subProcessElementContext.some(function(e){return e.key!=t.key})}),r.viewModel.setProperty(r.editorUi.refreshProperty(t))})})},A.prototype.updateStartMode=function(r){var i=this,e=this.editorUi.graph.bpmnModel.DefaultProcess.GetExtensionElements();null!==e&&0<e.length&&(e=e.filter(function(e){return e instanceof de.ProcessHeader})[0].BizDefKey,this.service.getAllBizCmp(e).subscribe(function(t){i.service.getBizCmp().subscribe(function(e){r.allBizCmps=t,r.bizCmps=e,i.editorUi.updateProperty(r),i.uiState.getUserActList(i.editorUi.getActivities()),i.uiState.getEndEventList(i.editorUi.getEndEvents()),i.uiState.getStartMode(i.editorUi.getStartMode()),i.editorUi.getStartMode()==de.StartMode.SUB_PROCESS?i.uiState.subActivityContext=i.uiState.subActivityContext.concat(i.uiState.subProcessElementContext):i.uiState.subActivityContext=i.uiState.subActivityContext.filter(function(t){return i.uiState.subProcessElementContext.some(function(e){return e.key!=t.key})}),i.viewModel.setProperty(i.editorUi.refreshProperty(r))})}))},A.prototype.note=function(e){var t=this,r=this.resolver.resolveComponentFactory(Ep).create(this.injector),e=(r.instance.record=e,{title:this.localePipe.transform("processEditor.changeRecord"),width:800,height:520,showButtons:!0,buttons:r.instance.footer}),i=this.modalService.show(r,e);r.instance.cancel.subscribe(function(e){return i.close()}),r.instance.submit.subscribe(function(e){t.editorUi.graph.bpmnModel.DefaultProcess.Documentation=e,i.close()})},A.prototype.openProcContent=function(){var t=this;if(this.time===We.dt){if(!this.processInfo)throw new Error(this.localePipe.transform("processEditor.noDtInfo"));this.processInfo.processKey===Iu&&this.processInfo.flowFormId?this.openNewProcess(this.processInfo.flowFormId):this.viewModel.getFlowFormInfoById(this.processInfo.flowFormId).subscribe(function(e){t.editorUi.loadBizActivities(e.bizActivities||[]),t.getProcContent(t.processInfo.processKey).subscribe(function(e){t.uiState.content=t.checkModelContent(JSON.stringify(e)),t.openProcess(t.uiState.content)})})}else if(this.time===We.rt){if(!this.rtProcessInfo)throw new Error(this.localePipe.transform("processEditor.noRtInfo"));this.viewModel.getFlowFormInfoById(this.rtProcessInfo.flowFormId).subscribe(function(e){t.editorUi.loadBizActivities(e.bizActivities||[]),t.getProcContent(t.rtProcessInfo.rtProcDefId).subscribe(function(e){t.uiState.content=t.checkModelContent(JSON.stringify(e)),t.openProcess(t.uiState.content)})})}},A.prototype.openNewProcess=function(a){var s=this;this.viewModel.getFlowFormInfoById(a).subscribe(function(r){var e,i=r.bizComponents,n=r.customizeActions.filter(function(e){return!0===e.isAll}).map(function(e){return{id:e.id,code:e.code,name:e.name,terminalType:e.terminal,actualParameters:e.actualParameters.map(function(e){return{Name:e.code,Value:e.value,ValueText:e.name,Tag:"expression"}})}}),o=[];r.excuteForms.forEach(function(e){e.isDefault&&(e=s.ConvertExecuteForm(e),o=o.concat(e))}),0===o.length||-1===o.findIndex(function(e){return e.TerminalType===zt})||-1===o.findIndex(function(e){return e.TerminalType===Bt})?s.viewModel.getFormFormatsByBizCategory().subscribe(function(e){e&&0<e.length&&(-1===o.findIndex(function(e){return e.TerminalType===zt})&&(t=e.filter(function(e){return"PC"===e.terminal&&0===e.status})[0])&&o.push(s.formFormat2ExecuteForm(t)),-1===o.findIndex(function(e){return e.TerminalType===Bt}))&&(t=e.filter(function(e){return"Mobile"===e.terminal&&0===e.status})[0])&&o.push(s.formFormat2ExecuteForm(t));var t,e={name:s.processInfo.processName,bizObjId:s.processInfo.bizObjId,ffId:a,ffName:s.processInfo.flowFormName,startMode:s.processInfo.startMode,formalParameters:r.formalParameters,processBizComponnets:i,executeForms:o,customizeActions:n,processDescription:r.flowForm.processDescription};s.createBpmnModel(r.bizActivities||[],e)}):(e={name:s.processInfo.processName,bizObjId:s.processInfo.bizObjId,ffId:a,ffName:s.processInfo.flowFormName,startMode:s.processInfo.startMode,formalParameters:r.formalParameters,processBizComponnets:i,executeForms:o,customizeActions:n,processDescription:r.flowForm.processDescription},s.createBpmnModel(r.bizActivities||[],e))})},A.prototype.createBpmnModel=function(t,r){var i=this;this.service.getBizCmp().subscribe(function(e){i.editorUi.show(),i.addEditorUiListeners(i.editorUi),i.editorUi.loadBizActivities(t||[]),i.editorUi.createBpmnModel(r,e),i.service.getProcExtendProperty(r.BizDefKey,r.startMode,i.editorUi.bizCategoryId).subscribe(function(e){var t=[];e.forEach(function(e){!e.bizCategoryId&&!e.bizDefKey||-1==e.bizCategoryId.indexOf(i.editorUi.bizCategoryId)&&"*"!==e.bizCategoryId&&-1==e.bizDefKey.indexOf(r.BizDefKey)&&"*"!==e.bizDefKey||-1==e.startMode.indexOf(r.startMode)&&"*"!==e.startMode||t.push(e)}),i.editorUi.procExtProps=t,i.flag&&(i.flag=!1,i.closeLoading()),i.viewModel.initProcessProperty(i.editorUi.getFarrisPropConfig()),i.uiState.getStartMode(i.editorUi.getStartMode()),i.editorUi.getStartMode()==de.StartMode.SUB_PROCESS?i.uiState.subActivityContext=i.uiState.subActivityContext.concat(i.uiState.subProcessElementContext):i.uiState.subActivityContext=i.uiState.subActivityContext.filter(function(t){return i.uiState.subProcessElementContext.some(function(e){return e.key!=t.key})}),i.uiState.bpmnModel=i.editorUi.graph.bpmnModel,i.addGraphModelChangedListener()})})},A.prototype.openProcess=function(r){var i=this,e=new B.BpmnModel,n=(e.LoadFromJson(r),e.DefaultProcess.GetExtensionElements().filter(function(e){return e instanceof de.ProcessHeader})[0]);this.service.getProcExtendProperty(n.BizDefKey,n.startMode,this.editorUi.bizCategoryId).subscribe(function(e){var t=[];e.forEach(function(e){!e.bizCategoryId&&!e.bizDefKey||-1==e.bizCategoryId.indexOf(i.editorUi.bizCategoryId)&&"*"!==e.bizCategoryId&&-1==e.bizDefKey.indexOf(n.BizDefKey)&&"*"!==e.bizDefKey||-1==e.startMode.indexOf(n.startMode)&&"*"!==e.startMode||t.push(e)}),i.editorUi.procExtProps=t,i.editorUi.show(),i.addEditorUiListeners(i.editorUi),i.editorUi.openBpmnModel(r),i.flag&&(i.flag=!1,i.closeLoading()),i.viewModel.initProcessProperty(i.editorUi.getFarrisPropConfig()),i.uiState.getUserActList(i.editorUi.getActivities()),i.uiState.getEndEventList(i.editorUi.getEndEvents()),i.uiState.getNotifyEventList(i.editorUi.getNotifyEvents()),i.uiState.getMessageEventList(i.editorUi.getMessageEvents()),i.uiState.getSubAndCatchEventsList(i.editorUi.getSubAndCatchEvents()),i.uiState.bpmnModel=i.editorUi.graph.bpmnModel,i.uiState.getStartMode(i.editorUi.getStartMode()),i.editorUi.getStartMode()==de.StartMode.SUB_PROCESS?i.uiState.subActivityContext=i.uiState.subActivityContext.concat(i.uiState.subProcessElementContext):i.uiState.subActivityContext=i.uiState.subActivityContext.filter(function(t){return i.uiState.subProcessElementContext.some(function(e){return e.key!=t.key})}),i.addGraphModelChangedListener()})},A.prototype.addGraphModelChangedListener=function(){var e=this;this.editorUi.graph.model.addListener(pe.mxEvent.CHANGE,function(){e.changedFlag=!1})},A.prototype.showTip=function(e){var t=this;if("message"===e.type)switch(e.level){case"warning":this.message.warning(e.message);break;case"error":this.message.error(e.message);break;case"question":this.message.question(e.message,function(){t.questionOKHandle(e)});break;default:this.message.info(e.message)}else if("notify"===e.type)switch(e.level){case"warning":this.notify.warning(e.message);break;case"error":this.notify.error(e.message);break;default:this.notify.info(e.message)}},A.prototype.showVerify=function(e){this.errorList=e,this.createValidationTips()},A.prototype.questionOKHandle=function(e){e.action},A.prototype.getProcContent=function(e){if(e){if(this.time===We.dt)return this.service.getProcContentbyKey(e);if(this.time===We.rt)return this.service.getRTProcContentbyId(e);throw new Error(this.localePipe.transform("processEditor.wrongMoment"))}},A.prototype.save=function(e){var t=this,r=(this.uiState.content=e,this.showLoading(),JSON.parse(this.uiState.content));this.saveHttp().subscribe(function(e){t.closeLoading(),t.procNameTitle=r.DefaultProcess.Name,t.notify.success({title:t.localePipe.transform("processEditor.prompted"),msg:t.localePipe.transform("processEditor.saveSuccess"),timeout:3e3}),t.time===We.dt?t.viewModel.auditProcessDef(xc,!0,r.DefaultProcess.Key):t.time===We.rt&&t.viewModel.auditProcessDef(wc,!0,r.DefaultProcess.Key),t.changedFlag=!1},function(e){t.closeLoading(),t.notify.error({title:t.localePipe.transform("processEditor.prompted"),msg:e.error.Message,timeout:3e3}),t.time===We.dt?t.viewModel.auditProcessDef(xc,!1,r.DefaultProcess.Key):t.time===We.rt&&t.viewModel.auditProcessDef(wc,!1,r.DefaultProcess.Key)})},A.prototype.release=function(t){var r=this;this.uiState.content=t,this.showLoading(),this.uiState.getReleaseConfig().subscribe(function(e){"true"===e.currentValue?(r.viewModel.saveProcess(r.uiState.content,r.processInfo,1).subscribe(function(e){r.viewModel.getProcDefsByKey(JSON.parse(t).DefaultProcess.Key).subscribe(function(e){e=Math.max.apply(Math,e.map(function(e){return e.version<<0}));r.viewModel.releaseProcess(t,e===-Infinity?1:e),r.closeLoading()})}),r.notify.success({title:r.localePipe.transform("processEditor.prompted"),msg:r.localePipe.transform("processEditor.waitReview"),timeout:3e3}),e=JSON.parse(r.uiState.content),r.viewModel.auditProcessDef(Pc,!0,e.DefaultProcess.Key)):r.viewModel.deployProcess(r.uiState.content).subscribe(function(e){r.closeLoading(),r.viewModel.saveProcess(r.uiState.content,r.processInfo,0).subscribe(function(e){}),r.notify.success({title:r.localePipe.transform("processEditor.prompted"),msg:r.localePipe.transform("processEditor.successPublish"),timeout:3e3});var t=JSON.parse(r.uiState.content);r.viewModel.auditProcessDef(Pc,!0,t.DefaultProcess.Key)},function(e){r.closeLoading(),r.notify.error({title:r.localePipe.transform("processEditor.prompted"),msg:r.localePipe.transform("processEditor.publishFail")+(""+e.error.Message),timeout:3e3});e=JSON.parse(r.uiState.content);r.viewModel.auditProcessDef(Pc,!1,e.DefaultProcess.Key)})})},A.prototype.saveHttp=function(){if(this.uiState.content){if(this.time===We.dt)return this.viewModel.saveProcess(this.uiState.content,this.processInfo,1);if(this.time===We.rt)return this.viewModel.saveRTProcess(this.uiState.content,this.rtProcessInfo.rtProcDefId);throw new Error(this.localePipe.transform("processEditor.wrongMoment"))}},A.prototype.showLoading=function(){this.loadService.show({container:"body",message:"",type:1})},A.prototype.closeLoading=function(){this.loadService.close()},A.prototype.ConvertExecuteForm=function(e){var t=new Array;if("web,app"===e.terminal){var r=new Rt,r=(r.ComponentId=e.appId,r.formFormatId=e.formFormatId,r.FormType=e.formType,r.Name=e.name,r.TerminalType=zt,e.actualParameters&&0<e.actualParameters.length&&(r.ActualParameters=e.actualParameters.map(function(e){return{Name:e.code,Value:e.value}})),t.push(r),new Rt);r.ComponentId=e.appId,r.formFormatId=e.formFormatId,r.FormType=e.formType,r.Name=e.name,r.TerminalType=Bt,e.actualParameters&&0<e.actualParameters.length&&(r.ActualParameters=e.actualParameters.map(function(e){return{Name:e.code,Tag:e.valueType||l.initVariableType(e.value),Value:e.value}})),t.push(r)}else{var i=new Rt;switch(i.ComponentId=e.appId,i.formFormatId=e.formFormatId,i.FormType=e.formType,i.Name=e.name,e.terminal){case"web":i.TerminalType=zt;break;case"app":i.TerminalType=Bt}e.actualParameters&&0<e.actualParameters.length&&(i.ActualParameters=e.actualParameters.map(function(e){return{Name:e.code,Tag:e.valueType||l.initVariableType(e.value),Value:e.value}})),t.push(i)}return t},A.prototype.formFormat2ExecuteForm=function(e){var t=new Rt;switch(t.Id=l.GenerateElementId(),t.ComponentId=null,t.formFormatId=e.id,t.FormType="0",t.Name=e.name,e.terminal){case"PC":t.TerminalType=zt;break;case"Mobile":t.TerminalType=Bt}return e.urlParameters&&0<e.urlParameters.length&&(t.ActualParameters=e.urlParameters.map(function(e){return{Name:e.code,Tag:e.valueType||l.initVariableType(e.value),Value:e.value}})),t},A.prototype.completeStrategyChanged=function(e){var t,r,i=this;e!==this.uiState.completeIterator[0].key&&(this.uiState.propertyData.SignRule||((e=this.resolver.resolveComponentFactory(on).create(this.injector)).instance.value=[],t=Object.assign(e.instance.modalConfig,{buttons:e.instance.modalFooter}),r=this.modalService.show(e,t),e.instance.closeModal.subscribe(function(e){return r.close()}),e.instance.submitModal.subscribe(function(e){i.updateChangeProperty({categoryId:"performerProperty",propertyID:fs,propertyValue:e.value}),r.close()})),!0===this.uiState.propertyData.BackWardRule.SelectTargetAble)&&setTimeout(function(){i.message.warning(i.localePipe.transform("processEditor.policyConflict"))},500)},A.prototype.OtherAssignNodesChanged=function(e){var t=this,r=this.resolver.resolveComponentFactory(ts).create(this.injector),i=-1<e.Id.indexOf("startActivity")?"startActivity":"userActivity",e=("startActivity"===i?(r.instance.value=[],(e=this.uiState.userActList.filter(function(e){return e.Id!==t.uiState.propertyData.Id&&"ASSIGN"===e.AssignmentStrategy&&e.AssignPerformerConfig&&"procInstCreator"===e.AssignPerformerConfig.Operator}))&&0<e.length?r.instance.value=e.map(function(e){return e.Id}):r.instance.value=new Array):r.instance.value=[],r.instance.location=i,Object.assign(r.instance.modalConfig,{buttons:r.instance.modalFooter})),n=this.modalService.show(r,e);r.instance.closeModal.subscribe(function(e){return n.close()}),r.instance.submitModal.subscribe(function(e){t.updateChangeProperty({categoryId:i="activityConfig",propertyID:Hs,propertyValue:e.value}),n.close()})},A.prototype.beforeCompleteStrategyChange=function(e){return this.time===We.rt?this.viewModel.beforeCompleteStrategyChange(e,this.rtProcessInfo):v.of(!0)},A.prototype.checkModelContent=function(e){var t=JSON.parse(e),r=t.DefaultProcess.extensionElements.find(function(e){return"wf.ProcessHeader"===e.ClrTypeID}).BizDefKey;return this.time===We.dt?r===this.processInfo.flowFormId?e:(t.DefaultProcess.extensionElements.find(function(e){return"wf.ProcessHeader"===e.ClrTypeID}).BizDefKey=this.processInfo.flowFormId,t.DefaultProcess.extensionElements.find(function(e){return"wf.ProcessHeader"===e.ClrTypeID}).BizDefName=this.uiState.flowFormInfo.flowForm.name,JSON.stringify(t)):this.time===We.rt?r===this.rtProcessInfo.flowFormId?e:(t.DefaultProcess.extensionElements.find(function(e){return"wf.ProcessHeader"===e.ClrTypeID}).BizDefKey=this.rtProcessInfo.flowFormId,t.DefaultProcess.extensionElements.find(function(e){return"wf.ProcessHeader"===e.ClrTypeID}).BizDefName=this.uiState.flowFormInfo.flowForm.name,JSON.stringify(t)):void 0},A.prototype.showModeChange=function(e){var e=e||{},t=e.mode,t=void 0===t?_.ShowMode.panel:t,r=e.wideWidth,r=void 0===r?330:r,e=e.smallWidth,e=void 0===e?41:e;t===_.ShowMode.panel?(this.panelWidth=r,this.rightPanelWidth=r):t===_.ShowMode.sidebar&&(this.panelWidth=e,this.rightPanelWidth=e)},A.prototype.saveProc=function(){var e=this.editorUi.graph.bpmnModel,t=Pu.validator(e,this.scene);0==t.valid?this.showTip(t):(t.warningList&&0<t.warningList.length?this.showVerify(t.warningList):this.clearValidationTips(),this.save(e.ConvertToJson()))},A.prototype.saveAs=function(){var e,t;this.uiState.enableAdminOrgAut||this.uiState.isAdministratorConfig&&null!==this.uiState.administrator||!this.uiState.isAdministratorConfig?(e=this.editorUi.graph.bpmnModel,0==(t=Pu.validator(e,this.scene)).valid?this.showTip(t):(t.warningList&&0<t.warningList.length?this.showVerify(t.warningList):this.clearValidationTips(),(t=new B.BpmnModel).LoadFromJson(e.ConvertToJson()),t.DefaultProcess.Key=l.GenerateElementId(),t.DefaultProcess.Id=l.GenerateElementId(),t.DefaultDiagram.BpmnPlane.BpmnElementId=t.DefaultProcess.Id,this.viewModel.saveAsProcess(t,this.processInfo))):this.message.info(this.localePipe.transform("processEditor.noPermissionToSave"))},A.prototype.releaseProc=function(){var e=this.editorUi.graph.bpmnModel,t=Pu.validator(e,this.scene);0==t.valid?this.showTip(t):(t.warningList&&0<t.warningList.length?this.showVerify(t.warningList):this.clearValidationTips(),this.release(e.ConvertToJson()))},A.prototype.sync=function(){var e=this.editorUi.graph.bpmnModel,t=Pu.validator(e,this.scene);0==t.valid?this.showTip(t):(t.warningList&&0<t.warningList.length?this.showVerify(t.warningList):this.clearValidationTips(),this.viewModel.syncDtProcess(e.ConvertToJson(),this.rtProcessInfo))},A.prototype.procRecord=function(){var e=this.editorUi.graph.bpmnModel.DefaultProcess.Documentation;this.note(e)},A.prototype.batchSet=function(){var e=this.resolver.resolveComponentFactory(yu).create(this.injector),t={title:"批量设置",width:512,height:565,showButtons:!0,buttons:e.instance.footer},r=this.modalService.show(e,t);e.instance.cancel.subscribe(function(e){return r.close()}),e.instance.submit.subscribe(function(e){r.close()})},A.prototype.closeProc=function(){var t=this;this.changedFlag?this.message.confirm(this.localePipe.transform("processEditor.closeProc1"),this.localePipe.transform("processEditor.closeProc2")).subscribe(function(e){e&&t.close.emit()}):this.close.emit()},A.prototype.viewProcModel=function(){var e={title:this.localePipe.transform("processEditor.viewModel"),width:800,height:520,showButtons:!1};this.notify.success(this.localePipe.transform("processEditor.copied")),this.copy(this.editorUi.graph.bpmnModel.ConvertToJson()),this.modalService.show(this.editorUi.graph.bpmnModel.ConvertToJson(),e)},A.prototype.rzStop=function(e){this.panelWidth=e.size.width,this.editorUi&&this.editorUi.graph.refresh()},A.prototype.createValidationTips=function(){this.verifySer.clear(),this.verifyContainer=this.verifySer.createVerify({parent:this.contentEl,verifyList:this.errorList,verifyType:this.tabTypeList,showList:!0,showType:"processWarning",verifyResultTipsTmpl:this.tipsTmpl}),this.listclick=this.verifyContainer.validatorClick.subscribe(function(e){console.log(e)}),this.showchange=this.verifyContainer.listshowChange.subscribe(function(e){console.log(e)})},A.prototype.clearValidationTips=function(){this.errorList=[],this.verifySer&&this.verifySer.clear()},A.prototype.copy=function(e){var t=document.createElement("input");t.setAttribute("value",e),document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t)},A.decorators=[{type:b.Component,args:[{selector:"wf-process-editor",template:'<div class="f-page">\r\n  <div class="f-page-header mt-1">\r\n    <nav class="f-page-header-base py-0">\r\n      <div class="f-title">\r\n        <span class="f-title-icon f-text-orna-manage">\r\n          <i class="f-icon f-icon-page-title-administer"></i>\r\n        </span>\r\n        <h4 class="f-title-text">{{procNameTitle}}</h4>\r\n      </div>\r\n      <div class="btn-toolbar btn-group-lg">\r\n        <ng-container *ngIf="action===\'edit\'&&time===\'dt\'">\r\n          <button class="btn btn-primary btn-lg mr-2" (click)="saveProc()">{{ \'processEditor.button.saveProc\' | wfLocale }}</button>\r\n          <button class="btn btn-secondary mr-2" (click)="releaseProc()">{{ \'processEditor.button.releaseProc\' | wfLocale }}</button>\r\n        </ng-container>\r\n        <ng-container *ngIf="action===\'edit\'&&time===\'rt\'">\r\n          <button class="btn btn-primary btn-lg mr-2" (click)="saveProc()">{{ \'processEditor.button.saveProc\' | wfLocale }}</button>\r\n          <button class="btn btn-secondary mr-2" (click)="sync()">{{ \'processEditor.button.sync\' | wfLocale }}</button>\r\n        </ng-container>\r\n        <ng-container *ngIf="time===\'dt\'&&action!=\'assignView\'">\r\n          <button class="btn btn-secondary btn-lg mr-2" (click)="saveAs()">{{ \'processEditor.button.saveAs\' | wfLocale }}</button>\r\n        </ng-container>\r\n        <button class="btn btn-secondary mr-2" (click)="procRecord()">{{ \'processEditor.button.procRecord\' | wfLocale }}</button>\r\n        <ng-container *ngIf="showModelButton">\r\n          <button class="btn btn-secondary mr-2" (click)="viewProcModel()">{{ \'processEditor.button.viewProcModel\' | wfLocale }}</button>\r\n          </ng-container>\r\n        <button class="btn btn-secondary mr-2" (click)="closeProc()">{{ \'processEditor.button.closeProc\' | wfLocale }}</button>\r\n      </div>\r\n    </nav>\r\n  </div>\r\n  <div class="f-page-main">\r\n    <div class="f-utils-flex-column h-100">\r\n      <div class="flex-auto d-flex flex-fill flex-row" style="position:relative; overflow: hidden">\r\n        <farris-splitter style="display: flex; flex-grow: 1">\r\n          <farris-splitter-pane style="display: flex; flex-grow: 1" id="gspWfDesignerPane">\r\n            <div class="flex-grow-1 h-100">\r\n              <div style="position: relative; height: 100%; width: 100%;">\r\n                <div id="editorUiContainer" class="editorUiContainer geEditor" #editorUiContainer>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </farris-splitter-pane>\r\n          <farris-splitter-pane class="f-page-content-main f-component-splitter-pane" style="margin: 0 0 0 10px"\r\n            ngResizable [rzHandles]="\'w\'" [ngStyle]="{ width: rightPanelWidth + \'px\' }" (rzStop)="rzStop($event)"\r\n            [relatedIframeParent]="\'#gspWfDesignerPane\'">\r\n            <div class="h-100 d-flex flex-column">\r\n              <div class="f-utils-fill-flex-column">\r\n                <app-property-panel #propertyPanel [(propertyConfig)]="uiState.propertyConfig"\r\n                  [(propertyData)]="uiState.propertyData" [enableChangeMode]="true" [showCloseBtn]="false"\r\n                  isWhiteTheme="true" (showModeChange)="showModeChange($event)" style="height:100%;width:100%;">\r\n                </app-property-panel>\r\n              </div>\r\n            </div>\r\n          </farris-splitter-pane>\r\n        </farris-splitter>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n<ng-template #tipsTmpl let-datas>\r\n  <span class="f-icon f-icon-question" style="font-size:14px;"></span>{{datas[0][\'list\'].length}}\r\n</ng-template>\r\n',providers:[{provide:o,useValue:Au},x],styles:["\n    .bpmn-designer {\n      height: 100%;\n      min-height: 400px;\n      width: 100%;\n    }"]}]}],A.ctorParameters=function(){return[{type:a},{type:Ip},{type:et},{type:Se.LoadingService},{type:Te.NotifyService},{type:r.MessagerService},{type:Qs},{type:b.Injector},{type:i.BsModalService},{type:b.ComponentFactoryResolver},{type:qc},{type:b.ChangeDetectorRef,decorators:[{type:b.Optional}]},{type:String,decorators:[{type:b.Inject,args:[b.LOCALE_ID]}]},{type:undefined,decorators:[{type:b.Inject,args:[o]}]},{type:x,decorators:[{type:b.Optional}]}]},A.propDecorators={cls:[{type:b.HostBinding,args:["class"]}],time:[{type:b.Input}],processInfo:[{type:b.Input}],rtProcessInfo:[{type:b.Input}],action:[{type:b.Input}],mode:[{type:b.Input}],scene:[{type:b.Input}],procType:[{type:b.Input}],close:[{type:b.Output}],propertyPanel:[{type:b.ViewChild,args:["propertyPanel"]}],tipsTmpl:[{type:b.ViewChild,args:["tipsTmpl"]}],iframe:[{type:b.ViewChild,args:["iframe"]}],contentEl:[{type:b.ViewChild,args:["content"]}],editorUiContainerER:[{type:b.ViewChild,args:["editorUiContainer"]}],editorUiContainerVCR:[{type:b.ViewChild,args:["editorUiContainer",{read:b.ViewContainerRef}]}]},A);function A(e,t,r,i,n,o,a,s,l,c,p,d,u,m,f){var h=this;this.uiState=e,this.viewModel=t,this.service=r,this.loadService=i,this.notify=n,this.message=o,this.activity=a,this.injector=s,this.modalService=l,this.resolver=c,this.eventBus=p,this.cdr=d,this.localeId=u,this.resources=m,this.localePipe=f,this.flag=!0,this.cls="farris-main-area flex-column",this.action="edit",this.mode="general",this.procType="wf",this.close=new b.EventEmitter,this.errorList=[],this.tabTypeList=[{id:"processWarning",type:"processWarning",title:this.localePipe.instant("processEditor.tip"),iconCls:"f-icon-default",iconStyle:"color:#f49730;"}],this.panelWidth=330,this.propertyPanelResizable=!0,this.rightPanelWidth=330,this.changedFlag=!1,this.showModelButton=!1,this.localePipe=this.localePipe||new x(u,m),this.cdr=this.cdr||this.injector.get(b.ChangeDetectorRef,null),this.verifySer=this.injector.get(se.VerifyDetailService),this.localeId=this.injector.get(b.LOCALE_ID,null)||this.localeId,Pu.localePipe=this.localePipe,v.forkJoin(this.uiState.getEnableAdminOrgAut(),this.uiState.getEnableFlowFormAut()).subscribe(function(e){h.uiState.enableAdminOrgAut=e[0],h.uiState.enableFlowFormAut=e[1],h.uiState.enableAdminOrgAut||h.uiState.getAdministratorInfo()})}Object.defineProperty(Ou.prototype,"value",{set:function(e){this.assingPerformerConfigForm=new he.FormGroup({multiSelect:new he.FormControl(e.multiSelect),necessary:new he.FormControl(e.necessary)}),this.operator=e.operator||"currentUser",this.allowGlobalAssign=e.allowGlobalAssign||!1,e.assignScope&&(this.organizationLevel=e.assignScope.organizationLevel,this.includeChildren=e.assignScope.includeChildren)},enumerable:!0,configurable:!0}),Ou.prototype.ngOnInit=function(){},Ou.prototype.clickOK=function(){var t=this,e=(this.config={operator:this.operator,multiSelect:this.assingPerformerConfigForm.get("multiSelect").value,necessary:this.assingPerformerConfigForm.get("necessary").value,allowGlobalAssign:this.allowGlobalAssign},this.allowGlobalAssign&&this.organizationLevel!==this.organizationLevelCollection[0].value&&((e=new Fo).actionScope=Ro,e.organizationLevel=this.organizationLevel,e.organizationId=this.organizationLevelCollection.find(function(e){return e.value===t.organizationLevel}).orgId,e.organizationName=this.organizationLevelCollection.find(function(e){return e.value===t.organizationLevel}).text,e.includeChildren=this.includeChildren,e.tag="variable",this.config.assignScope=e),{value:this.config,parameters:null});this.submitModal.emit(e)},Ou.prototype.clickCancel=function(){this.closeModal.emit()},Ou.prototype.valueChange=function(e){switch(e.value){case this.organizationLevelCollection[0].value:this.includeChildren=!1;break;case this.organizationLevelCollection[1].value:this.includeChildren=!0;break;case this.organizationLevelCollection[2].value:this.includeChildren=!1}},Ou.decorators=[{type:b.Component,args:[{selector:"app-assign-performer-config",template:'<div class="f-page">\r\n  <section class="f-page-main d-flex flex-column">\r\n    <farris-section class="pt-0 f-section-form f-section-in-mainsubcard" mainTitle="{{\'component.assignPerformer.assignPerformer\'|wfLocale}}" [enableAccordion]="\'default\'"\r\n      [enableMaximize]="false">\r\n      <div class="f-form-layout farris-form farris-form-controls-inline">\r\n        <fieldset class="f-section-formgroup">\r\n          <div class="f-section-formgroup-inputs">\r\n            <div class="col-12">\r\n              <div class="farris-group-wrap">\r\n                <div class="form-group">\r\n                  <label class="col-form-label">\r\n                    <span class="farris-label-text">{{\'component.assignPerformer.operator\'|wfLocale}}</span>\r\n                  </label>\r\n                  <div class="farris-input-wrap" style="width: 300px;">\r\n                    <farris-combo-list [(ngModel)]="operator" name="operator" [ngModelOptions]="{standalone: true}"\r\n                      [idField]="\'value\'" [textField]="\'text\'" [valueField]="\'value\'" [data]="operatorCollection"\r\n                      [panelHeight]="60">\r\n                    </farris-combo-list>\r\n                    <div class="farris-feedback valid-feedback"></div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div class="col-6">\r\n              <div class="farris-group-wrap ml-2 pl-4">\r\n                <div class="form-group farris-form-group">\r\n                  <div class="farris-input-wrap">\r\n                    <div class="custom-control custom-checkbox">\r\n                      <input class="custom-control-input" type="checkbox" id="multiSelect" formControlName="multiSelect"\r\n                        [readOnly]="false" />\r\n                      <label class="custom-control-label" for="multiSelect">{{\'component.assignPerformer.multiSelect\'|wfLocale}}</label>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div class="col-6">\r\n              <div class="farris-group-wrap">\r\n                <div class="form-group farris-form-group">\r\n                  <div class="farris-input-wrap">\r\n                    <div class="custom-control custom-checkbox">\r\n                      <input class="custom-control-input" type="checkbox" id="necessary" formControlName="necessary" [readOnly]="false" />\r\n                      <label class="custom-control-label" for="necessary">{{\'component.assignPerformer.necessary\'|wfLocale}}</label>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </fieldset>\r\n      </div>\r\n    </farris-section>\r\n    \x3c!-- <farris-section class="pt-0 f-section-form f-section-in-mainsubcard" [mainTitle]="\'备选范围\'" [enableAccordion]="\'default\'"\r\n      [enableMaximize]="false">\r\n      <div class="f-form-layout farris-form farris-form-controls-inline">\r\n        <fieldset class="f-section-formgroup">\r\n          <div class="f-section-formgroup-inputs">\r\n            <div class="col-12">\r\n              <div class="farris-group-wrap ml-2 pl-4">\r\n                <div class="form-group">\r\n                  <div class="farris-input-wrap" style="width: 300px;">\r\n                    <farris-radiogroup [(ngModel)]="assignScope" [data]="assignScopeList" name="assignScope"\r\n                      [horizontal]="true">\r\n                    </farris-radiogroup>\r\n                    <div class="farris-feedback valid-feedback"></div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </fieldset>\r\n      </div>\r\n    </farris-section>\r\n    <farris-section class="pt-0 f-section-grid f-section-in-managelist" [mainTitle]="\'备选范围\'" [enableAccordion]="\'default\'"\r\n      [enableMaximize]="false" style="height: 200px;">\r\n      <app-performer [type]="\'assignPerformer\'"></app-performer>\r\n    </farris-section> --\x3e\r\n  </section>\r\n</div>\r\n\r\n\x3c!--\r\n<div class="f-page">\r\n  <div class="f-utils-fill-flex-column farris-split-section m-2 h-100">\r\n    <section class="f-utils-fill-flex-column h-100">\r\n      <div class="f-section-header pt-2 mx-2">\r\n        <div class="f-title">\r\n          <h4 class="f-title-text">指派规则选项</h4>\r\n        </div>\r\n      </div>\r\n      <div class="f-utils-fill-flex-column h-100">\r\n        <form class="h-100" [formGroup]="assingPerformerConfigForm">\r\n          <div class="f-utils-fill-flex-column justify-content-center h-100 pb-4">\r\n            <div class="my-2 mx-5">\r\n              <div class="farris-group-wrap">\r\n                <div class="form-group">\r\n                  <label class="col-form-label">\r\n                    <span class="farris-label-text">指派操作人</span>\r\n                  </label>\r\n                  <div class="farris-input-wrap mt-1" style="width: 300px;">\r\n                    <farris-combo-list [(ngModel)]="operator" name="operator" [ngModelOptions]="{standalone: true}"\r\n                      [idField]="\'value\'" [textField]="\'text\'" [valueField]="\'value\'" [data]="operatorCollection"\r\n                      [panelHeight]="60">\r\n                    </farris-combo-list>\r\n                    <div class="farris-feedback valid-feedback"></div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div class="my-2 mx-5">\r\n              <div class="farris-input-wrap">\r\n                <div class="custom-control custom-checkbox">\r\n                  <input class="custom-control-input" type="checkbox" id="multiSelect" formControlName="multiSelect"\r\n                    [readOnly]="false" />\r\n                  <label class="custom-control-label" for="multiSelect">允许选择多个待选用户</label>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div class="my-2 mx-5">\r\n              <div class="farris-input-wrap">\r\n                <div class="custom-control custom-checkbox">\r\n                  <input class="custom-control-input" type="checkbox" id="necessary" formControlName="necessary" [readOnly]="false" />\r\n                  <label class="custom-control-label" for="necessary">只有一个待选用户时，仍需手工选择</label>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div class="mx-2 mt-3">\r\n              <div class="title-content">\r\n                <h4 class="title-text">设定的参与者范围外指派</h4><span class="title-line"></span>\r\n              </div>\r\n            </div>\r\n            <div class="farris-form form-inline farris-form-inline my-1">\r\n              <div class="col-12 mt-3">\r\n                <div class="farris-group-wrap">\r\n                  <div class="form-group farris-form-group">\r\n                    <label class="col-form-label">\r\n                      <span class="farris-label-text">是否启用</span>\r\n                    </label>\r\n                    <div class="farris-input-wrap ml-1">\r\n                      <farris-switch [(ngModel)]="allowGlobalAssign" [ngModelOptions]="{standalone: true}" name="allowGlobalAssign"></farris-switch>\r\n                      <div class="farris-feedback valid-feedback"></div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <div class="d-flex flex-row">\r\n                <div class="col-8 my-2">\r\n                  <div class="farris-group-wrap">\r\n                    <div class="form-group farris-form-group">\r\n                      <label class="col-form-label">\r\n                        <span class="farris-label-text">组织范围</span>\r\n                      </label>\r\n                      <div class="farris-input-wrap ml-1">\r\n                        <farris-combo-list [panelHeight]="100" [(ngModel)]="organizationLevel" [ngModelOptions]="{standalone: true}"\r\n                          name="organizationLevel" [idField]="\'value\'" [textField]="\'text\'" [valueField]="\'value\'"\r\n                          [data]="organizationLevelCollection" [readonly]="allowGlobalAssign===false" (valueChange)="valueChange($event)">\r\n                        </farris-combo-list>\r\n                        <div class="farris-feedback valid-feedback"></div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n                <div class="col-4 my-2">\r\n                  <div class="farris-input-wrap pt-1">\r\n                    <div class="custom-control custom-checkbox mr-3">\r\n                      <input class="custom-control-input" type="checkbox" [(ngModel)]="includeChildren" [ngModelOptions]="{standalone: true}"\r\n                        name="includeChildren" id="includeChildren" [disabled]="!(allowGlobalAssign===true && organizationLevel === organizationLevelCollection[2].value)" />\r\n                      <label class="custom-control-label" for="includeChildren">包含下级</label>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </section>\r\n  </div>\r\n</div> --\x3e\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type="button" class="btn btn-secondary btn-sm px-3 mx-2" (click)="clickCancel()">{{\'component.assignPerformer.clickCancel\'|wfLocale}}</button>\r\n  <button type="button" class="btn btn-primary btn-sm px-3 mx-2" (click)="clickOK()">{{\'component.assignPerformer.clickOK\'|wfLocale}}</button>\r\n</ng-template>\r\n\r\n',providers:[x],styles:[".title-content{color:#000;display:inline-flex;align-items:center;line-height:1.375rem;position:relative;overflow:hidden;padding:0 0 0 1rem;min-width:415px}.title-content ::before{content:'';width:.25rem;height:1.125rem;background:#59a1ff;border-radius:1px;position:absolute;top:50%;left:0;margin-top:-.5625rem}.title-text{font-size:1rem;line-height:1.375rem;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;margin-bottom:0;margin-right:10px}.title-line{flex-grow:1;border-bottom:1px dashed rgba(0,0,0,.1)}"]}]}],Ou.ctorParameters=function(){return[{type:b.ChangeDetectorRef,decorators:[{type:b.Optional}]},{type:String,decorators:[{type:b.Inject,args:[b.LOCALE_ID]}]},{type:undefined,decorators:[{type:b.Inject,args:[o]}]},{type:x,decorators:[{type:b.Optional}]}]},Ou.propDecorators={cls:[{type:b.HostBinding,args:["class"]}],closeModal:[{type:b.Output}],submitModal:[{type:b.Output}],value:[{type:b.Input}],modalFooter:[{type:b.ViewChild,args:["iconSelectFooter"]}]};var ku=Ou;function Ou(e,t,r,i){this.cdr=e,this.localeId=t,this.resources=r,this.localePipe=i,this.cls="farris-main-area flex-column",this.closeModal=new b.EventEmitter,this.submitModal=new b.EventEmitter,this.allowGlobalAssign=!1,this.operatorCollection=[{text:this.localePipe.transform("component.assignPerformer.currentUser"),value:"currentUser"},{text:this.localePipe.transform("component.assignPerformer.procInstCreator"),value:"procInstCreator"}],this.operator="currentUser",this.organizationLevelCollection=[{value:"GLOBAL",text:this.localePipe.transform("component.assignPerformer.global"),orgId:"global"},{value:"UNIT",text:this.localePipe.transform("component.assignPerformer.currentUnit"),orgId:"currentUnit"},{value:"DEPARTMENT",text:this.localePipe.transform("component.assignPerformer.currentDepartment"),orgId:"currentDepartment"}],this.organizationLevel=this.organizationLevelCollection[0].value,this.includeChildren=!1,this.modalConfig={title:this.localePipe.transform("component.assignPerformer.assignPerformer"),width:720,height:490,showButtons:!0},this.localePipe=this.localePipe||new x(t,r)}Du.prototype.transform=function(e,t){return e.filter(function(e){return e.Id!==t})},Du.decorators=[{type:b.Pipe,args:[{name:"jumpScopePipe"}]}];var Mu=Du;function Du(){}Lu.prototype.transform=function(e,t){void 0===t&&(t="");var r="";return e.forEach(function(e){r+=e.performerName+"，"}),(r=r&&r.substring(0,r.length-1))||t},Lu.decorators=[{type:b.Pipe,args:[{name:"usersName"}]}],Lu.ctorParameters=function(){return[]};var Nu=Lu;function Lu(){}Ru.prototype.transform=function(e,t){void 0===t&&(t="");var r="";return e.forEach(function(e){r+=e.performerId+","}),(r=r&&r.substring(0,r.length-1))||t},Ru.decorators=[{type:b.Pipe,args:[{name:"usersId"}]}],Ru.ctorParameters=function(){return[]};var Fu=Ru;function Ru(){}var Vu=[a,Ip,en,Qs,Ul,$l,cc,gc,Lc,Gc,mp,xp],zu=[et],Bu=[],Uu=(Object.defineProperty(ju.prototype,"value",{set:function(e){e&&(this.callActivitySubProcess=e,this.getProcessDefKey(this.callActivitySubProcess.calledElement),this.getFlowForm(this.callActivitySubProcess.calledBizDefKey))},enumerable:!0,configurable:!0}),ju.prototype.ngOnInit=function(){},ju.prototype.clickOK=function(){var e;this.validator()&&(e={value:this.callActivitySubProcess,parameters:null},this.submitModal.emit(e))},ju.prototype.clickCancel=function(){this.closeModal.emit()},ju.prototype.processConfirm=function(e){e&&(this.callActivitySubProcess.calledElement=e.procDefKey,this.callActivitySubProcess.calledElementName=e.name)},ju.prototype.clearProcessDef=function(e){this.callActivitySubProcess.calledElement="",this.callActivitySubProcess.calledElementName=""},ju.prototype.flowFormConfirm=function(e){e&&(this.callActivitySubProcess.calledBizDefKey=e.id,this.callActivitySubProcess.calledBizDefName=e.name)},ju.prototype.clearFlowForm=function(e){this.callActivitySubProcess.calledBizDefKey="",this.callActivitySubProcess.calledBizDefName=""},ju.prototype.setBizDataId=function(){this.showExprHelp()},ju.prototype.showExprHelp=function(){var e,t,r,i,n,o,a=this,s=new Array;if(0<this.designerState.schemas.length){try{for(var l=ue(this.designerState.schemas),c=l.next();!c.done;c=l.next()){var p=c.value;this.expr.addSchema("Schema",p)}}catch(g){e={error:g}}finally{try{c&&!c.done&&(o=l["return"])&&o.call(l)}finally{if(e)throw e.error}}this.designerState.schemas[0].entityTypes&&0<this.designerState.schemas[0].entityTypes.length&&(o=this.designerState.schemas[0].entityTypes[0],this.expr.addInjectedEntity(o.name,"Schema",o.name,D.InjectedType.EntityType))}if(s=this.designerState.addContext(s),0<this.designerState.subActivityContext.length)try{for(var d=ue(this.designerState.subActivityContext),u=d.next();!u.done;u=d.next()){var m=u.value;s.push(m)}}catch(v){t={error:v}}finally{try{u&&!u.done&&(r=d["return"])&&r.call(d)}finally{if(t)throw t.error}}if(0<s.length)try{for(var f=ue(s),h=f.next();!h.done;h=f.next()){var y=h.value;this.expr.addContext(y)}}catch(b){i={error:b}}finally{try{h&&!h.done&&(n=f["return"])&&n.call(f)}finally{if(i)throw i.error}}this.expr.addExpressionText(this.callActivitySubProcess.bizDataId),this.expr.buildExpression().then(function(e){a.callActivitySubProcess.bizDataId=e,0<s.length&&(a.expr.exprEntity.contextEntities=a.expr.exprEntity.contextEntities.filter(function(t){return!s.some(function(e){return e.key===t.key})}))})},ju.prototype.valueChange=function(e){e&&(this.callActivitySubProcess.bizDataId=null)},ju.prototype.validator=function(){return!(!this.callActivitySubProcess.inheritBizDataId&&!this.callActivitySubProcess.bizDataId&&(this.message.warning(this.localePipe.transform("component.subProcess.inheritBizDataId")),1))},ju.prototype.getProcessDefKey=function(e){var t=this,r=this.util.getProcessDefinitionWebApi();e&&this.http.get(r+="/procDefKey/"+e).subscribe(function(e){t.callActivitySubProcess.calledElementName=e.name})},ju.prototype.getFlowForm=function(e){var t=this,r=this.util.getFlowFormWebApi();e&&this.http.get(r+="/"+e).subscribe(function(e){t.callActivitySubProcess.calledBizDefName=e.name})},ju.decorators=[{type:b.Component,args:[{selector:"lib-call-activity-sub-process",template:'<div class="f-page">\r\n  <div class="f-utils-fill-flex-column farris-split-section m-2 h-100">\r\n    <section class="f-utils-fill-flex-column h-100">\r\n      <div class="f-section-header pt-2 mx-2">\r\n        <div class="f-title">\r\n          <h4 class="f-title-text">{{\'component.subProcess.setOption\' | wfLocale}}</h4>\r\n        </div>\r\n      </div>\r\n      <div class="f-utils-fill-flex-column h-100">\r\n        <form class="h-100">\r\n          <div class="farris-form form-inline farris-form-inline">\r\n            <div class="farris-group-wrap mt-1">\r\n              <div class="form-group farris-form-group">\r\n                <label class="col-form-label">\r\n                  <span class="farris-label-text">{{\'component.subProcess.flowForm\' | wfLocale}}</span>\r\n                </label>\r\n                <div class="farris-input-wrap ml-1">\r\n                  <wf-bizprocess-lookup title="{{\'component.subProcess.flowForm\' | wfLocale}}" [sourceType]="\'flowform\'" [displayTxt]="callActivitySubProcess.calledBizDefName"\r\n                    (afterConfirm)="flowFormConfirm($event)" (clear)="clearFlowForm($event)">\r\n                  </wf-bizprocess-lookup>\r\n                  <div class="farris-feedback valid-feedback"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div class="farris-group-wrap my-4">\r\n              <div class="form-group farris-form-group">\r\n                <label class="col-form-label">\r\n                  <span class="farris-label-text">{{\'component.subProcess.processDef\' | wfLocale}}</span>\r\n                </label>\r\n                <div class="farris-input-wrap ml-1">\r\n                  <wf-bizprocess-lookup title="{{\'component.subProcess.processDef\' | wfLocale}}"  [displayTxt]="callActivitySubProcess.calledElementName"\r\n                    (afterConfirm)="processConfirm($event)" (clear)="clearProcessDef($event)">\r\n                  </wf-bizprocess-lookup>\r\n                  <div class="farris-feedback valid-feedback"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            \x3c!-- <div class="farris-group-wrap my-4">\r\n              <div class="form-group farris-form-group">\r\n                <label class="col-form-label">\r\n                  <span class="farris-label-info text-danger">*</span>\r\n                  <span class="farris-label-text">继承变量</span>\r\n                </label>\r\n                <div class="farris-input-wrap ml-1">\r\n                  <farris-switch [(ngModel)]="callActivitySubProcess.inheritVariables" name="inheritVariables">\r\n                  </farris-switch>\r\n                  <div class="farris-feedback valid-feedback"></div>\r\n                </div>\r\n              </div>\r\n            </div> --\x3e\r\n            <div class="farris-group-wrap my-4">\r\n              <div class="form-group farris-form-group">\r\n                <label class="ml-4 pl-3">\r\n                  <span class="farris-label-text">{{\'component.subProcess.SameParentProcess\' | wfLocale}}</span>\r\n                </label>\r\n                <div class="farris-input-wrap ml-3">\r\n                  <farris-switch  [(ngModel)]="callActivitySubProcess.inheritBizDataId" name="inheritBizDataId"\r\n                    (valueChange)="valueChange($event)">\r\n                  </farris-switch>\r\n                  <div class="farris-feedback valid-feedback"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div *ngIf="!callActivitySubProcess.inheritBizDataId" class="farris-group-wrap">\r\n              <div class="form-group farris-form-group">\r\n                <label class="ml-4 pl-3">\r\n                  <span class="farris-label-text">{{\'component.subProcess.setBizDataId\' | wfLocale}}</span>\r\n                </label>\r\n                <div class="farris-input-wrap ml-3">\r\n                  <input-group class="form-control" style="width: 100%;padding:0;border:0;" [enableClear]="false"\r\n                    [ngModel]="callActivitySubProcess.bizDataId" name="bizDataId"\r\n                    [editable]="false" (clickHandle)="setBizDataId()" [groupText]="groupIcon"></input-group>\r\n                  <div class="farris-feedback valid-feedback"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </section>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type="button" class="btn btn-secondary btn-sm mx-2" (click)="clickCancel()">{{\'component.subProcess.clickCancel\' | wfLocale}}</button>\r\n  <button type="button" class="btn btn-primary btn-sm mx-2" (click)="clickOK()">{{\'component.subProcess.clickOk\' | wfLocale}}</button>\r\n</ng-template>\r\n',providers:[x],styles:[""]}]}],ju.ctorParameters=function(){return[{type:r.MessagerService},{type:l},{type:t.HttpService},{type:a},{type:D.ExpressionService},{type:b.ChangeDetectorRef,decorators:[{type:b.Optional}]},{type:String,decorators:[{type:b.Inject,args:[b.LOCALE_ID]}]},{type:undefined,decorators:[{type:b.Inject,args:[o]}]},{type:x,decorators:[{type:b.Optional}]}]},ju.propDecorators={cls:[{type:b.HostBinding,args:["class"]}],value:[{type:b.Input}],closeModal:[{type:b.Output}],submitModal:[{type:b.Output}],modalFooter:[{type:b.ViewChild,args:["iconSelectFooter"]}]},ju);function ju(e,t,r,i,n,o,a,s,l){this.message=e,this.util=t,this.http=r,this.designerState=i,this.expr=n,this.cdr=o,this.localeId=a,this.resources=s,this.localePipe=l,this.cls="farris-main-area flex-column",this.closeModal=new b.EventEmitter,this.submitModal=new b.EventEmitter,this.modalConfig={title:this.localePipe.transform("component.subProcess.subProcessOpt"),width:500,height:380,showButtons:!0},this.callActivitySubProcess=new ol,this.groupIcon='<i class="f-icon f-icon-lookup"></i>',this.localePipe=this.localePipe||new x(a,s)}var Hu=function(){},_u=function(){this.id=l.createNM(),this.formMethodConfigs=new Array},Gu=function(){},Ku=function(){},qu=[{text:"正向",value:"Forward"},{text:"反向",value:"Backward"},{text:"终止",value:"Abort"}],Wu=[{text:"流转前",value:"Pre"},{text:"流转后",value:"Post"}],Ju=function(){this.id=l.createNM(),this.workFlowAction=qu[0].value,this.executionTime=Wu[0].value,this.sortOrder=1},$u=(Object.defineProperty(Yu.prototype,"formFormatId",{get:function(){return this._fromFormatId},set:function(e){this._fromFormatId=e,this._fromFormatId&&this.getFormMethods()},enumerable:!0,configurable:!0}),Yu.prototype.ngOnInit=function(){var n=this;this.cols=[{field:"workFlowAction",width:80,title:this.localePipe.transform("component.executeForms.workFlowAction"),formatter:{type:"enum",options:{valueField:"value",textField:"text",data:qu}},editor:{type:g.EditorTypes.COMBOLIST,options:{valueField:"value",textField:"text",data:qu,idField:"value",panelHeight:"auto",enableClear:!1}},validators:[{type:"required",messager:"必填"}]},{field:"method",width:100,title:this.localePipe.transform("component.executeForms.formOperations"),editor:{type:"input-group",options:{groupText:'<i class="f-icon f-icon-lookup"></i>',editable:!1,clickHandle:function(e){e.formControl.setValue(e.instance.value||""),n.e=e,n.methodsDialog.show(),n.state="edit"},clear:function(e){console.log("clear",e)}}},formatter:function(t,e,r){var i;return t&&(i=n.formMethods.find(function(e){return e.method===t}))?i.methodName:""},validators:[{type:"required",messager:"必填"}]},{field:"executionTime",width:80,title:this.localePipe.transform("component.executeForms.executionTime"),formatter:{type:"enum",options:{valueField:"value",textField:"text",data:Wu}},editor:{type:g.EditorTypes.COMBOLIST,options:{valueField:"value",textField:"text",data:Wu,idField:"value",panelHeight:"auto",enableClear:!1}},validators:[{type:"required",messager:"必填"}]},{field:"sortOrder",width:60,title:this.localePipe.transform("component.executeForms.sortOrder"),editor:{type:g.EditorTypes.NUMBERBOX,options:{}},formatter:{type:"number",options:{precision:0}},validators:[{type:"required",messager:"必填"}]},{field:"methodParameters",width:80,title:this.localePipe.transform("component.executeForms.methodParameters"),template:this.cell,halign:"center",align:"center"}]},Yu.prototype.add=function(){this.methodsDialog.show(),this.state="add"},Yu.prototype["delete"]=function(){var t=this;this.grid.selectedRow?this.operations=this.operations.filter(function(e){return e.id!==t.grid.selectedRow.id}):this.message.info(this.localePipe.transform("component.executeForms.selectFormActionConfig"))},Yu.prototype.editParam=function(s){var l=this,e=this.resolver.resolveComponentFactory(Wt).create(this.injector),t=(e.instance.mode="usual",e.instance.showFormType=!1,s.rowData.methodParameters?e.instance.parameters=w(s.rowData.methodParameters.map(function(e){return Object.assign({},e)})):e.instance.parameters=new Array,{title:this.localePipe.transform("component.executeForms.parameterSettings"),width:620,height:400,showButtons:!0,buttons:e.instance.modalFooter}),c=this.modalService.show(e,t);e.instance.submit.subscribe(function(e){var t,r;try{for(var i=ue(l.operations),n=i.next();!n.done;n=i.next()){var o=n.value;o.id===s.rowData.id&&(o.methodParameters=e.parameters)}}catch(a){t={error:a}}finally{try{n&&!n.done&&(r=i["return"])&&r.call(i)}finally{if(t)throw t.error}}c.close()}),e.instance.cancel.subscribe(function(e){c.close()})},Yu.prototype.methodSelected=function(){var e;if(this.methodGrid.selectedRow){var t=this.methodGrid.selectedRow.data;if("edit"===this.state){if(this.e){this.e.formControl.setValue(t.method),this.e.instance.cd.detectChanges();try{for(var r=ue(this.operations),i=r.next();!i.done;i=r.next()){var n=i.value;n.id===t.id&&(n.method=t.method,n.sortOrder=t.sortOrder,n.methodParameters=t.methodParameters)}}catch(a){e={error:a}}finally{try{i&&!i.done&&(o=r["return"])&&o.call(r)}finally{if(e)throw e.error}}}}else{var o=new Ju;o.formFormatConfigId=this.formFormatConfigId,o.method=t.method,o.sortOrder=t.sortOrder,o.methodParameters=t.methodParameters,this.operations=this.operations.concat([o])}this.methodsDialog.close()}else this.message.info(this.localePipe.transform("component.executeForms.selectFormAction"))},Yu.prototype.validator=function(){var e,t;this.grid.endCellEdit();try{for(var r=ue(this.operations),i=r.next();!i.done;i=r.next())if(!i.value.method)return this.message.info(this.localePipe.transform("component.executeForms.selectFormAction")),!1}catch(n){e={error:n}}finally{try{i&&!i.done&&(t=r["return"])&&t.call(r)}finally{if(e)throw e.error}}return!0},Yu.prototype.getFormMethods=function(){var e,t=this;this.formFormatId&&(e="/api/runtime/wf/v1.0/formOperation?formFormatId="+this.formFormatId,this.http.get(e).subscribe(function(e){e&&(t.formMethods=e)}))},Yu.decorators=[{type:b.Component,args:[{selector:"lib-form-operation-config",template:'<div class="f-utils-fill-flex-column h-100" style="background: #FFF;">\r\n  <farris-datagrid class="f-component-grid f-utils-fill" [columns]="cols" [data]="operations" #grid\r\n    [idField]="\'id\'" [showLineNumber]="true" [fitColumns]="true" [striped]="true" [showCheckbox]="false"\r\n    [virtualized]="true" [pagination]="false" [useThemes]="false" [fit]="true"\r\n    [editable]="true" [editMode]="\'cell\'" >\r\n  </farris-datagrid>\r\n  <ng-template #cell let-ctx>\r\n    <a href="javascript: void(0);" title="{{\'component.executeForms.parameterSettings\'|wfLocale}}" (click)="editParam(ctx)">{{\'component.executeForms.editParam\'|wfLocale}}</a>\r\n  </ng-template>\r\n</div>\r\n\r\n<ng-template #buttonRef>\r\n  <button class="btn btn-sm btn-default px-3" (click)="methodsDialog.close()">{{\'component.executeForms.clickCancel\'|wfLocale}}</button>\r\n  <button class="btn btn-sm btn-primary px-3" (click)="methodSelected()">{{\'component.executeForms.clickOK\'|wfLocale}}</button>\r\n</ng-template>\r\n<farris-dialog #methodsDialog [buttons]="buttonRef" [width]="700" [height]="500" title="{{\'component.executeForms.formEvents\'|wfLocale}}">\r\n  <div class="f-page f-page-is-managelist">\r\n    <div class="f-page-main">\r\n      <div class="f-struct-wrapper f-utils-fill-flex-column">\r\n        <farris-section class="f-section-grid f-section-in-managelist p-0" [showHeader]="false">\r\n          <farris-datagrid class="f-component-grid" [columns]="methodCols" [data]="formMethods" #methodGrid [idField]="\'id\'"\r\n            [showLineNumber]="true" [striped]="true" [showCheckbox]="false" [virtualized]="true" [pagination]="false"\r\n            [fit]="true" [fitColumns]="true">\r\n          </farris-datagrid>\r\n        </farris-section>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</farris-dialog>\r\n\r\n',providers:[x],styles:[""]}]}],Yu.ctorParameters=function(){return[{type:t.HttpService},{type:r.MessagerService},{type:b.ComponentFactoryResolver},{type:b.Injector},{type:i.BsModalService},{type:b.ChangeDetectorRef,decorators:[{type:b.Optional}]},{type:String,decorators:[{type:b.Inject,args:[b.LOCALE_ID]}]},{type:undefined,decorators:[{type:b.Inject,args:[o]}]},{type:x,decorators:[{type:b.Optional}]}]},Yu.propDecorators={formFormatId:[{type:b.Input}],formFormatConfigId:[{type:b.Input}],operations:[{type:b.Input}],methodsDialog:[{type:b.ViewChild,args:["methodsDialog"]}],grid:[{type:b.ViewChild,args:["grid"]}],methodGrid:[{type:b.ViewChild,args:["methodGrid"]}],cell:[{type:b.ViewChild,args:["cell"]}]},Yu);function Yu(e,t,r,i,n,o,a,s,l){this.http=e,this.message=t,this.resolver=r,this.injector=i,this.modalService=n,this.cdr=o,this.localeId=a,this.resources=s,this.localePipe=l,this.operations=new Array,this.cols=new Array,this.methodCols=[{field:"method",width:100,title:this.localePipe.transform("component.executeForms.method"),showTips:!0},{field:"methodName",width:80,title:this.localePipe.transform("component.executeForms.methodName"),showTips:!0},{field:"description",width:120,title:this.localePipe.transform("component.executeForms.description"),showTips:!0}],this.formMethods=new Array,this.state="add"}Object.defineProperty(k.prototype,"formFormatId",{get:function(){return this._formFormatId},set:function(e){this._formFormatId=e,this.config.formFormatId=e},enumerable:!0,configurable:!0}),Object.defineProperty(k.prototype,"formatConfigId",{get:function(){return this._formatConfigId},set:function(e){(this._formatConfigId=e)||(this.state="new")},enumerable:!0,configurable:!0}),k.prototype.ngOnInit=function(){this.buttonCols=[{field:"buttonName",width:100,title:this.localePipe.transform("component.executeForms.buttonName"),filter:!0},{title:this.localePipe.transform("component.executeForms.enable"),field:"enable",width:80,template:this.btnEnable,align:"center",hAlign:"center"},{title:this.localePipe.transform("component.executeForms.disabled"),field:"disabled",width:80,template:this.btnDisabled,align:"center",hAlign:"center"},{title:this.localePipe.transform("component.executeForms.hidden"),field:"hidden",width:80,template:this.btnHidden,align:"center",hAlign:"center"}],this.fieldCols=[{field:"fieldName",width:100,title:this.localePipe.transform("component.executeForms.fieldName")},{title:this.localePipe.transform("component.executeForms.editable"),field:"editable",width:80,template:this.fieldEditable,align:"center",hAlign:"center"},{title:this.localePipe.transform("component.executeForms.readonly"),field:"readonly",width:80,template:this.fieldReadonly,align:"center",hAlign:"center"},{title:this.localePipe.transform("component.executeForms.hidden"),field:"hidden",width:80,template:this.fieldHidden,align:"center",hAlign:"center"},{title:this.localePipe.transform("component.executeForms.required"),field:"required",width:80,template:this.fieldRequired,align:"center",hAlign:"center"}],this.getConfig()},k.prototype.submit=function(){var t=this,r=new v.Subject;return this.validator().subscribe(function(e){e?(t.setBtnAndFieldConfigs(),t.extendComponentRef?t.extendComponentRef.instance.submit().subscribe(function(e){e?(t.config.id=e,t.saveConfig(t.config).subscribe(function(e){r.next({result:!0,configId:t.config.id})},function(e){t.message.error(t.localePipe.transform("component.executeForms.saveFail")),r.next({result:!1,configId:t.config.id})})):"new"===t.state&&0===t.config.formButtonConfigs.length&&0===t.config.formFieldConfigs.length&&0===t.operationConfig.operations.length?setTimeout(function(){r.next({result:!0,configId:null})},10):t.saveConfig(t.config).subscribe(function(e){r.next({result:!0,configId:t.config.id})},function(e){t.message.error(t.localePipe.transform("component.executeForms.saveFail")),r.next({result:!1,configId:t.config.id})})}):"new"===t.state&&0===t.config.formButtonConfigs.length&&0===t.config.formFieldConfigs.length&&0===t.operationConfig.operations.length?setTimeout(function(){r.next({result:!0,configId:null})},10):t.saveConfig(t.config).subscribe(function(e){r.next({result:!0,configId:t.config.id})},function(e){t.message.error(t.localePipe.transform("component.executeForms.saveFail")),r.next({result:!1,configId:t.config.id})})):setTimeout(function(){r.next({result:!1})},10)}),r.asObservable()},k.prototype.searchField=function(e){var t={field:e.field="fieldName",value:e.value},r=(this.fieldTree.searchData=t,{label:this.localePipe.transform("component.executeForms.fieldName"),value:"fieldName"});this.fieldTree.searchFields?this.fieldTree.searchFields.some(function(e){return e.value===r.value})||(this.fieldTree.searchFields=this.fieldTree.searchFields.concat(r)):(this.fieldTree.searchFields=[],this.fieldTree.searchFields=this.fieldTree.searchFields.concat(r)),this.fieldTree.searchHandle.search(e.field,e.value,"client")},k.prototype.btnConfigChange=function(e,t,r){var i,n;if(e)try{for(var o=ue(this.buttonConfigs),a=o.next();!a.done;a=o.next()){var s=a.value;if(s.id===r){switch(t){case"enable":s.enable=e,s.disabled=!1,s.hidden=!1;break;case"disabled":s.disabled=e,s.enable=!1,s.hidden=!1;break;case"hidden":s.hidden=e,s.disabled=!1,s.enable=!1}this.btnGrid.updateRow(r,s)}}}catch(l){i={error:l}}finally{try{a&&!a.done&&(n=o["return"])&&n.call(o)}finally{if(i)throw i.error}}this.btnGrid.cd.detectChanges()},k.prototype.btnBatchOperate=function(e){var t,r,i=this.btnGrid.checkedRows;if(i&&0<i.length){try{for(var n=ue(i),o=n.next();!o.done;o=n.next()){var a=o.value;this.btnConfigChange(!0,e,a.id)}}catch(s){t={error:s}}finally{try{o&&!o.done&&(r=n["return"])&&r.call(n)}finally{if(t)throw t.error}}this.btnGrid.cd.detectChanges()}else this.message.info(this.localePipe.transform("component.executeForms.checkedRows"))},k.prototype.btnBatchReset=function(){var e,t,r=this.btnGrid.checkedRows;if(r&&0<r.length){var i=function(t){var e,r,i=l.formFormat.formButtons.find(function(e){return e.id===t.id});try{for(var n=ue(l.buttonConfigs),o=n.next();!o.done;o=n.next()){var a=o.value;a.id===t.id&&(a.enable="Enable"===i.buttonState,a.disabled="Disabled"===i.buttonState,a.hidden="Hidden"===i.buttonState),l.btnGrid.updateRow(a.id,a)}}catch(s){e={error:s}}finally{try{o&&!o.done&&(r=n["return"])&&r.call(n)}finally{if(e)throw e.error}}},l=this;try{for(var n=ue(r),o=n.next();!o.done;o=n.next())i(o.value)}catch(a){e={error:a}}finally{try{o&&!o.done&&(t=n["return"])&&t.call(n)}finally{if(e)throw e.error}}this.btnGrid.cd.detectChanges()}else this.message.info(this.localePipe.transform("component.executeForms.checkedRows"))},k.prototype.fieldConfigChange=function(e,t,r,i){void 0===i&&(i=!0),e&&this.fieldSwitchChange(this.fieldConfigs,t,r),i&&this.fieldTree.searchHandle.research()},k.prototype.fieldSwitchChange=function(e,t,r){var i,n;if(0<e.length)try{for(var o=ue(e),a=o.next();!a.done;a=o.next()){var s=a.value;if(s.data.id===r){switch(t){case"editable":s.data.editable=!0,s.data.readonly=!1,s.data.hidden=!1,s.data.required=!1;break;case"readonly":s.data.editable=!1,s.data.readonly=!0,s.data.hidden=!1,s.data.required=!1;break;case"hidden":s.data.editable=!1,s.data.readonly=!1,s.data.hidden=!0,s.data.required=!1;break;case"required":s.data.editable=!1,s.data.readonly=!1,s.data.hidden=!1,s.data.required=!0}return}s.children&&0<s.children.length&&this.fieldSwitchChange(s.children,t,r)}}catch(l){i={error:l}}finally{try{a&&!a.done&&(n=o["return"])&&n.call(o)}finally{if(i)throw i.error}}},k.prototype.fieldBatchOperate=function(e){var t,r,i=this.fieldTree.checkeds;if(i&&0<i.length){try{for(var n=ue(i),o=n.next();!o.done;o=n.next()){var a=o.value;this.fieldConfigChange(!0,e,a.data.id,!1)}}catch(s){t={error:s}}finally{try{o&&!o.done&&(r=n["return"])&&r.call(n)}finally{if(t)throw t.error}}this.fieldTree.searchHandle.research()}else this.message.info(this.localePipe.transform("component.executeForms.checkeds"))},k.prototype.fieldBatchReset=function(){var e,t,r=this.fieldTree.checkeds;if(r&&0<r.length){var i=this;try{for(var n=ue(r),o=n.next();!o.done;o=n.next())!function(t){var e=i.formatFieldList.find(function(e){return e.id===t.data.id});i.resetFieldConfig(i.fieldConfigs,t.data.id,e)}(o.value)}catch(a){e={error:a}}finally{try{o&&!o.done&&(t=n["return"])&&t.call(n)}finally{if(e)throw e.error}}this.fieldTree.searchHandle.research()}else this.message.info(this.localePipe.transform("component.executeForms.checkeds"))},k.prototype.resetFieldConfig=function(e,t,r){var i,n;if(0<e.length)try{for(var o=ue(e),a=o.next();!a.done;a=o.next()){var s=a.value;if(!0===s.leaf&&s.data.id===t)return s.data.editable="Editable"===r.fieldState,s.data.readonly="Readonly"===r.fieldState,s.data.hidden="Hidden"===r.fieldState,void(s.data.required="Required"===r.fieldState);s.children&&0<s.children.length&&this.resetFieldConfig(s.children,t,r)}}catch(l){i={error:l}}finally{try{a&&!a.done&&(n=o["return"])&&n.call(o)}finally{if(i)throw i.error}}},k.prototype.validator=function(){var e,t=this;return this.extendComponentRef?(e=this.extendComponentRef.instance.validator())instanceof v.Observable?e.pipe(re.switchMap(function(e){return e&&t.innerValidator()?v.of(!0):v.of(!1)})):e?v.of(this.innerValidator()):v.of(!1):v.of(this.innerValidator())},k.prototype.innerValidator=function(){return this.operationConfig.validator()},k.prototype.setBtnAndFieldConfigs=function(){this.config.formButtonConfigs=new Array;var e,t,i=this;try{for(var r=ue(this.buttonConfigs),n=r.next();!n.done;n=r.next())!function(t){var e=i.formFormat.formButtons.find(function(e){return e.buttonId===t.buttonId}),r=new Gu;if(r.buttonId=t.buttonId,t.enable)r.buttonState="Enable";else if(t.disabled)r.buttonState="Disabled";else{if(!t.hidden)return;r.buttonState="Hidden"}!e.buttonState&&r.buttonState&&i.config.formButtonConfigs.push(r),e.buttonState&&e.buttonState!==r.buttonState&&i.config.formButtonConfigs.push(r)}(n.value)}catch(o){e={error:o}}finally{try{n&&!n.done&&(t=r["return"])&&t.call(r)}finally{if(e)throw e.error}}this.config.formFieldConfigs=new Array,this.getFieldConfigs(this.fieldConfigs),this.config.formMethodConfigs=this.operationConfig.operations||new Array},k.prototype.getFieldConfigs=function(e){var t,r;if(e&&0<e.length){var i=this;try{for(var n=ue(e),o=n.next();!o.done;o=n.next())!function(t){if(t.children&&0<t.children.length&&i.getFieldConfigs(t.children),!1===t.leaf)return;var e=i.formatFieldList.find(function(e){return e.fieldId===t.data.fieldId}),r=new Ku;if(r.fieldId=t.data.fieldId,t.data.editable)r.fieldState="Editable";else if(t.data.readonly)r.fieldState="Readonly";else if(t.data.hidden)r.fieldState="Hidden";else{if(!t.data.required)return;r.fieldState="Required"}!e.fieldState&&r.fieldState&&i.config.formFieldConfigs.push(r),e.fieldState&&e.fieldState!==r.fieldState&&i.config.formFieldConfigs.push(r)}(o.value)}catch(a){t={error:a}}finally{try{o&&!o.done&&(r=n["return"])&&r.call(n)}finally{if(t)throw t.error}}}},k.prototype.getConfig=function(){var x=this;this.formFormatId&&v.forkJoin(this.getFormFormatType(),this.getFormFormat(),this.getFormFormatConfig()).subscribe(function(e){var t,r,i,n,o,a,s=e[0],s=(s&&(x.formFormatType=s,x.formFormatType.extendImpl?(x.showExtendTab=!0,x.createExtendComponent(x.formFormatType.extendImpl)):x.showExtendTab=!1),e[1]),s=(s&&(x.formFormat=x.convertFormFormat(s)),e[2]);if(s&&(x.config=s),x.formFormat.formButtons){x.buttonConfigs=x.formFormat.formButtons.map(function(e){return Object.assign({},e,{enable:"Enable"===e.buttonState,disabled:"Disabled"===e.buttonState,hidden:"Hidden"===e.buttonState})});e=new Array;s&&s.formButtonConfigs&&(e=s.formButtonConfigs);try{for(var l=ue(e),c=l.next();!c.done;c=l.next()){var p=c.value;try{for(var d=ue(x.buttonConfigs),u=d.next();!u.done;u=d.next()){var m=u.value;if(m.buttonId===p.buttonId){switch(p.buttonState){case"Enable":m.enable=!0,m.disabled=!1,m.hidden=!1;break;case"Disabled":m.enable=!1,m.disabled=!0,m.hidden=!1;break;case"Hidden":m.enable=!1,m.disabled=!1,m.hidden=!0}break}}}catch(g){i={error:g}}finally{try{u&&!u.done&&(n=d["return"])&&n.call(d)}finally{if(i)throw i.error}}}}catch(v){t={error:v}}finally{try{c&&!c.done&&(r=l["return"])&&r.call(l)}finally{if(t)throw t.error}}}if(x.formFormat.formFields){x.fieldConfigs=w(x.formFormat.formFields),x.orgFieldConfigs(x.fieldConfigs);e=new Array;s&&s.formFieldConfigs&&(e=s.formFieldConfigs);try{for(var f=ue(e),h=f.next();!h.done;h=f.next()){var y=h.value;x.setFieldConfig(x.fieldConfigs,y)}}catch(b){o={error:b}}finally{try{h&&!h.done&&(a=f["return"])&&a.call(f)}finally{if(o)throw o.error}}}})},k.prototype.createExtendComponent=function(e){var n=this,t=e.split("#")[0],o=e.split("#")[1];System["import"](t).then(function(e){var i=Object.values(e)[0].create(n.injector);o?i.componentFactoryResolver._factories.forEach(function(e,t,r){var e=e.selector;o==e&&(e=i.componentFactoryResolver.resolveComponentFactory(t),n.extendComponentRef=e.create(i.injector),n.extendComponentRef.instance.formFormatId=n.formFormatId,n.extendComponentRef.instance.formatConfigId=n.formatConfigId,n.container.clear(),n.container.insert(n.extendComponentRef.hostView))}):(e=i._bootstrapComponents[0])&&(e=i.componentFactoryResolver.resolveComponentFactory(e),n.extendComponentRef=e.create(i.injector),n.extendComponentRef.instance.formFormatId=n.formFormatId,n.extendComponentRef.instance.formatConfigId=n.formatConfigId,n.container.clear(),n.container.insert(n.extendComponentRef.hostView))})},k.prototype.orgFieldConfigs=function(e){var t,r;if(0<e.length)try{for(var i=ue(e),n=i.next();!n.done;n=i.next()){var o=n.value;o.data=Object.assign({},o.data,{editable:"Editable"===o.data.fieldState,readonly:"Readonly"===o.data.fieldState,hidden:"Hidden"===o.data.fieldState,required:"Required"===o.data.fieldState}),o.children&&o.children&&this.orgFieldConfigs(o.children)}}catch(a){t={error:a}}finally{try{n&&!n.done&&(r=i["return"])&&r.call(i)}finally{if(t)throw t.error}}},k.prototype.setFieldConfig=function(e,t){var r,i;if(0<e.length)try{for(var n=ue(e),o=n.next();!o.done;o=n.next()){var a=o.value;if(a.data.fieldId===t.fieldId){switch(t.fieldState){case"Editable":a.data.editable=!0,a.data.readonly=!1,a.data.hidden=!1,a.data.required=!1;break;case"Readonly":a.data.editable=!1,a.data.readonly=!0,a.data.hidden=!1,a.data.required=!1;break;case"Hidden":a.data.editable=!1,a.data.readonly=!1,a.data.hidden=!0,a.data.required=!1;break;case"Required":a.data.editable=!1,a.data.readonly=!1,a.data.hidden=!1,a.data.required=!0}return}a.children&&0<a.children.length&&this.setFieldConfig(a.children,t)}}catch(s){r={error:s}}finally{try{o&&!o.done&&(i=n["return"])&&i.call(n)}finally{if(r)throw r.error}}},k.prototype.saveConfig=function(e){return this.http.post("/api/runtime/wf/v1.0/formFormatConfig",e)},k.prototype.getFormFormat=function(){var e;return this.formFormatId?(e="/api/runtime/wf/v1.0/formFormat/"+this.formFormatId,e=encodeURI(e),this.http.get(e)):v.of(null)},k.prototype.getFormFormatType=function(){var e;if(this.formFormatId)return e="/api/runtime/wf/v1.0/formFormatType/formFormat?formFormat="+this.formFormatId,this.http.get(e)},k.prototype.getFormFormatConfig=function(){var e;return this.formatConfigId?(e="/api/runtime/wf/v1.0/formFormatConfig/"+this.formatConfigId,e=encodeURI(e),this.http.get(e)):v.of(null)},k.prototype.convertFormFormat=function(e){return e.status||(e.status=0),this.convertformFields(e.formFields),this.getFormatFieldList(e.formFields,this.formatFieldList),e},k.prototype.convertformFields=function(e){var t,r;if(e&&0<e.length)try{for(var i=ue(e),n=i.next();!n.done;n=i.next()){var o=n.value;"boolean"==typeof o.leaf||null!=o.leaf&&o.leaf!==undefined||(o.leaf=!0),o.children&&o.children&&this.orgFieldConfigs(o.children)}}catch(a){t={error:a}}finally{try{n&&!n.done&&(r=i["return"])&&r.call(i)}finally{if(t)throw t.error}}},k.prototype.getFormatFieldList=function(e,t){var r,i;if(e&&0<e.length)try{for(var n=ue(e),o=n.next();!o.done;o=n.next()){var a=o.value;t.push(a.data),a.children&&a.children&&this.getFormatFieldList(a.children,t)}}catch(s){r={error:s}}finally{try{o&&!o.done&&(i=n["return"])&&i.call(n)}finally{if(r)throw r.error}}},k.prototype.getFormatField=function(e,t){var r,i;try{for(var n=ue(e),o=n.next();!o.done;o=n.next()){var a=o.value;if(a.data.fieldId===t)return a;if(a.children&&0<a.children.length)return this.getFormatField(a.children,t)}}catch(s){r={error:s}}finally{try{o&&!o.done&&(i=n["return"])&&i.call(n)}finally{if(r)throw r.error}}},k.decorators=[{type:b.Component,args:[{selector:"lib-form-format-config",template:'\r\n\x3c!--需要嵌套的层-----------标签页----------------\x3e\r\n<farris-tabs class="h-100 f-component-tabs f-tabs-has-grid" [value]="\'buttonConfig\'" [contentFill]="true">\r\n  <farris-tab title="{{\'component.executeForms.formBtn\'|wfLocale}}" [id]="\'buttonConfig\'">\r\n    <ng-template farrisTabsExtend>\r\n      <farris-button [type]="\'link\'" (click)="btnBatchOperate(\'enable\')">\r\n        {{\'component.executeForms.enableBtn\'|wfLocale}}\r\n      </farris-button>\r\n      <farris-button [type]="\'link\'" (click)="btnBatchOperate(\'disabled\')">\r\n        {{\'component.executeForms.disabledBtn\'|wfLocale}}\r\n      </farris-button>\r\n      <farris-button [type]="\'link\'" (click)="btnBatchOperate(\'hidden\')">\r\n        {{\'component.executeForms.hiddenBtn\'|wfLocale}}\r\n      </farris-button>\r\n      <farris-button [type]="\'link\'" (click)="btnBatchReset()">\r\n        {{\'component.executeForms.btnBatchReset\'|wfLocale}}\r\n      </farris-button>\r\n    </ng-template>\r\n    <ng-template #content>\r\n      <div class="f-utils-fill-flex-column" style="background: #FFF;">\r\n        <farris-datagrid class="f-component-grid f-utils-fill" [columns]="buttonCols" [data]="buttonConfigs" #btnGrid\r\n          [idField]="\'id\'" [showLineNumber]="false" [fitColumns]="true" [striped]="true"\r\n          [virtualized]="true" [pagination]="false" [useThemes]="false" [fit]="true" [showAllCheckbox]="true"\r\n          [showCheckbox]="true" [multiSelect]="true" [enableFilterRow]="true">\r\n        </farris-datagrid>\r\n      </div>\r\n    </ng-template>\r\n  </farris-tab>\r\n  <farris-tab title="{{\'component.executeForms.formfield\'|wfLocale}}" [id]="\'fieldConfig\'">\r\n    <ng-template farrisTabsExtend>\r\n      <farris-button [type]="\'link\'" (click)="fieldBatchOperate(\'editable\')">\r\n        {{\'component.executeForms.editableBtn\'|wfLocale}}\r\n      </farris-button>\r\n      <farris-button [type]="\'link\'" (click)="fieldBatchOperate(\'readonly\')">\r\n        {{\'component.executeForms.readonlyBtn\'|wfLocale}}\r\n      </farris-button>\r\n      <farris-button [type]="\'link\'" (click)="fieldBatchOperate(\'hidden\')">\r\n        {{\'component.executeForms.hiddenBtn\'|wfLocale}}\r\n      </farris-button>\r\n      <farris-button [type]="\'link\'" (click)="fieldBatchOperate(\'required\')">\r\n        {{\'component.executeForms.requiredBtn\'|wfLocale}}\r\n      </farris-button>\r\n      <farris-button [type]="\'link\'" (click)="fieldBatchReset()">\r\n        {{\'component.executeForms.btnBatchReset\'|wfLocale}}\r\n      </farris-button>\r\n    </ng-template>\r\n    <ng-template #content>\r\n      <div class="f-utils-fill-flex-column" style="background: #FFF;">\r\n        <farris-treetable #fieldTree [columns]="fieldCols" [showFilterBar]="true" [searchFields] = "searchFields"\r\n          [showBorder]="false" [showHeader]="true" [data]="fieldConfigs" [fit]="true" [fitColumns]="true"\r\n          [idField]="\'id\'" [virtualized]="false" [singleSelect]="false" [showCheckbox]="true"\r\n          [showCheckAll]="true" [striped]="true" [fixedHeader]="true" (search)="searchField($event)">\r\n        </farris-treetable>\r\n      </div>\r\n    </ng-template>\r\n  </farris-tab>\r\n  <farris-tab title="{{\'component.executeForms.formEvents\'|wfLocale}}" [id]="\'operationConfig\'" [show]="showMethodTab">\r\n    <ng-template farrisTabsExtend>\r\n      <farris-button [type]="\'link\'" (click)="operationConfig.add()">\r\n        {{\'component.executeForms.add\'|wfLocale}}\r\n      </farris-button>\r\n      <farris-button [type]="\'link\'" (click)="operationConfig.delete()">\r\n        {{\'component.executeForms.delete\'|wfLocale}}\r\n      </farris-button>\r\n    </ng-template>\r\n    <ng-template #content>\r\n      <lib-form-operation-config\r\n        [formFormatId]="formFormatId"\r\n        [formFormatConfigId]="config.id"\r\n        [operations]="config.formMethodConfigs"\r\n        class="h-100"></lib-form-operation-config>\r\n    </ng-template>\r\n  </farris-tab>\r\n  <farris-tab title="{{\'component.executeForms.other\'|wfLocale}}" [id]="\'extendConfig\'" [show]="showExtendTab">\r\n    <ng-template #content>\r\n      <ng-container #container></ng-container>\r\n    </ng-template>\r\n  </farris-tab>\r\n</farris-tabs>\r\n\x3c!--Tab区域--\x3e\r\n\r\n  \x3c!-- </section>\r\n</div> --\x3e\r\n\r\n<ng-template #btnEnable let-ctx>\r\n  <farris-switch [(ngModel)]="ctx.rowData.enable" (valueChange)="btnConfigChange($event, ctx.field, ctx.rowData.id)"></farris-switch>\r\n</ng-template>\r\n<ng-template #btnDisabled let-ctx>\r\n  <farris-switch [(ngModel)]="ctx.rowData.disabled" (valueChange)="btnConfigChange($event, ctx.field, ctx.rowData.id)"></farris-switch>\r\n</ng-template>\r\n<ng-template #btnHidden let-ctx>\r\n  <farris-switch [(ngModel)]="ctx.rowData.hidden" (valueChange)="btnConfigChange($event, ctx.field, ctx.rowData.id)"></farris-switch>\r\n</ng-template>\r\n<ng-template #fieldEditable let-ctx>\r\n  <farris-switch *ngIf="ctx.node.leaf" size="small" [(ngModel)]="ctx.node.data.editable"\r\n  (valueChange)="fieldConfigChange($event, ctx.column.field, ctx.node.data.id)">\r\n  </farris-switch>\r\n</ng-template>\r\n<ng-template #fieldReadonly let-ctx>\r\n  <farris-switch *ngIf="ctx.node.leaf" size="small" [(ngModel)]="ctx.node.data.readonly"\r\n    (valueChange)="fieldConfigChange($event, ctx.column.field, ctx.node.data.id)">\r\n  </farris-switch>\r\n</ng-template>\r\n<ng-template #fieldHidden let-ctx>\r\n  <farris-switch *ngIf="ctx.node.leaf" size="small" [(ngModel)]="ctx.node.data.hidden"\r\n    (valueChange)="fieldConfigChange($event, ctx.column.field, ctx.node.data.id)">\r\n  </farris-switch>\r\n</ng-template>\r\n<ng-template #fieldRequired let-ctx>\r\n  <farris-switch *ngIf="ctx.node.leaf" size="small" [(ngModel)]="ctx.node.data.required"\r\n    (valueChange)="fieldConfigChange($event, ctx.column.field, ctx.node.data.id)">\r\n  </farris-switch>\r\n</ng-template>\r\n\r\n\r\n',providers:[x],styles:[""]}]}],k.ctorParameters=function(){return[{type:t.HttpService},{type:r.MessagerService},{type:Te.NotifyService},{type:b.Injector},{type:b.ChangeDetectorRef,decorators:[{type:b.Optional}]},{type:String,decorators:[{type:b.Inject,args:[b.LOCALE_ID]}]},{type:undefined,decorators:[{type:b.Inject,args:[o]}]},{type:x,decorators:[{type:b.Optional}]}]},k.propDecorators={btnEnable:[{type:b.ViewChild,args:["btnEnable"]}],btnDisabled:[{type:b.ViewChild,args:["btnDisabled"]}],btnHidden:[{type:b.ViewChild,args:["btnHidden"]}],fieldEditable:[{type:b.ViewChild,args:["fieldEditable"]}],fieldReadonly:[{type:b.ViewChild,args:["fieldReadonly"]}],fieldHidden:[{type:b.ViewChild,args:["fieldHidden"]}],fieldRequired:[{type:b.ViewChild,args:["fieldRequired"]}],btnGrid:[{type:b.ViewChild,args:["btnGrid"]}],fieldTree:[{type:b.ViewChild,args:["fieldTree"]}],operationConfig:[{type:b.ViewChild,args:[$u]}],container:[{type:b.ViewChild,args:["container",{read:b.ViewContainerRef}]}],showMethodTab:[{type:b.Input}]};var Xu=k;function k(e,t,r,i,n,o,a,s){this.http=e,this.message=t,this.notify=r,this.injector=i,this.cdr=n,this.localeId=o,this.resources=a,this.localePipe=s,this.config=new _u,this.formFormat=new Hu,this.state="edit",this.showMethodTab=!0,this.buttonCols=[],this.buttonConfigs=new Array,this.fieldCols=[],this.fieldConfigs=new Array,this.formatFieldList=new Array,this.showExtendTab=!1,this.localePipe=this.localePipe||new x(o,a);var l={label:this.localePipe.transform("component.executeForms.fieldName"),value:"fieldName"};this.searchFields?this.searchFields.some(function(e){return e.value===l.value})||(this.searchFields=this.searchFields.concat(l)):(this.searchFields=[],this.searchFields=this.searchFields.concat(l))}Qu.prototype.ngOnInit=function(){},Qu.prototype.ngOnChanges=function(e){e.formFormatId&&e.formFormatId.currentValue?this.showComponentRef():(this.componentRef=this.createWFComponentRef(),this.componentRef.instance.formFormatId=null,this.componentRef.instance.formatConfigId=null,this.componentRef.instance.showMethodTab=this.showMethodTab,this.container.clear(),this.container.insert(this.componentRef.hostView))},Qu.prototype.submit=function(){return this.componentRef.instance.submit()},Qu.prototype.showComponentRef=function(){this.componentRef=this.createWFComponentRef(),this.componentRef.instance.formFormatId=this.formFormatId,this.componentRef.instance.formatConfigId=this.formatConfigId,this.componentRef.instance.showMethodTab=this.showMethodTab,this.container.clear(),this.container.insert(this.componentRef.hostView)},Qu.prototype.createWFComponentRef=function(){return this.cfr.resolveComponentFactory(Xu).create(this.injector)},Qu.prototype.getFormFormatType=function(){var e;if(this.formFormatId)return e="/api/runtime/wf/v1.0/formFormatType/formFormat?formFormat="+this.formFormatId,this.http.get(e)},Qu.decorators=[{type:b.Component,args:[{selector:"lib-form-config-container",template:"<ng-container #container></ng-container>\r\n",styles:[""]}]}],Qu.ctorParameters=function(){return[{type:b.Injector},{type:b.ComponentFactoryResolver},{type:t.HttpService}]},Qu.propDecorators={container:[{type:b.ViewChild,args:["container",{read:b.ViewContainerRef}]}],modalFooter:[{type:b.ViewChild,args:["iconSelectFooter"]}],formFormatId:[{type:b.Input}],formatConfigId:[{type:b.Input}],showMethodTab:[{type:b.Input}]};var Zu=Qu;function Qu(e,t,r){this.injector=e,this.cfr=t,this.http=r,this.showMethodTab=!0}var em={FromBE:0,FromVO:1,FromNone:2},tm=(em[em.FromBE]="FromBE",em[em.FromVO]="FromVO",em[em.FromNone]="FromNone",rm.getCommonModelType=function(e){return"com."+ne.CommonModelUtil.GetGeneratedConfigID(e)},rm.judgeVoTemplateType=function(e){return!0===e.IsVirtual?e.TemplateVoInfo&&null!=e.TemplateVoInfo.TemplateVoId?em.FromVO:em.FromNone:em.FromBE},rm);function rm(){}nm.prototype.ngOnInit=function(){},nm.prototype.processNameChange=function(e){this.queryParam.filterArgs.name=new f.TextValue,this.queryParam.filterArgs.name.hasValue=!0,this.queryParam.filterArgs.name.value=e,this.queryParam.filterArgsExt.name=e},nm.prototype.processTypeChange=function(e){e=e.selections[0];this.queryParam.filterArgs.billProcessType=new f.TextValue,null!=e&&(""!=e.value&&(this.queryParam.filterArgs.billProcessType.hasValue=!0),this.queryParam.filterArgs.billProcessType.value=e.value)},nm.prototype.enabledStateChange=function(e){e=e.selections[0];this.queryParam.filterArgs.isEnabled=new f.TextValue,null!=e&&(""!=e.value&&(this.queryParam.filterArgs.isEnabled.hasValue=!0),this.queryParam.filterArgs.isEnabled.value=String(e.value))},nm.prototype.sysInitChange=function(e){e=e.selections[0];this.queryParam.filterArgs.sysInit=new f.TextValue,null!=e&&(""!=e.value&&(this.queryParam.filterArgs.sysInit.hasValue=!0),this.queryParam.filterArgs.sysInit.value=String(e.value))},nm.prototype.selectUpBill=function(){var t=this,e=this.resolver.resolveComponentFactory(Fe.SelectMetadataRTComponent).create(this.injector),r=(e.instance.typeList="GSPViewModel",e.instance.selectedMetadata.subscribe(function(e){t.clearUpBill();e=e.metadata,e=JSON.parse(e.content);tm.judgeVoTemplateType(e)===em.FromBE?(t.queryParam.filterArgs.upBillVoId=new f.TextValue,t.queryParam.filterArgs.upBillVoId.hasValue=!0,t.queryParam.filterArgs.upBillVoId.value=e.ID,t.queryParam.filterArgsExt.upBillVoName=e.MainObject.Name):t.notify.error(t.localePipe.transform("pleaseSelectNonVirtualVO"))},function(e){console.error(e),t.messager.error(null!=e.error&&(e.error.Message||e.error.message)||e.message),t.clearUpBill()}),{title:this.localePipe.transform("billSelector"),width:930,height:573,showButtons:!1}),i=this.modalService.show(e,r);e.instance.closeModalEmitter.subscribe(function(e){return i.close()})},nm.prototype.selectDownBill=function(){var t=this,e=this.resolver.resolveComponentFactory(Fe.SelectMetadataRTComponent).create(this.injector),r=(e.instance.typeList="GSPViewModel",e.instance.selectedMetadata.subscribe(function(e){t.clearDownBill();e=e.metadata,e=JSON.parse(e.content);tm.judgeVoTemplateType(e)===em.FromBE?(t.queryParam.filterArgs.downBillVoId=new f.TextValue,t.queryParam.filterArgs.downBillVoId.hasValue=!0,t.queryParam.filterArgs.downBillVoId.value=e.ID,t.queryParam.filterArgsExt.downBillVoName=e.MainObject.Name):t.notify.error(t.localePipe.transform("pleaseSelectNonVirtualVO"))},function(e){console.error(e),t.messager.error(null!=e.error&&(e.error.Message||e.error.message)||e.message),t.clearUpBill()}),{title:this.localePipe.transform("billSelector"),width:930,height:573,showButtons:!1}),i=this.modalService.show(e,r);e.instance.closeModalEmitter.subscribe(function(e){return i.close()})},nm.prototype.clearProcessName=function(){delete this.queryParam.filterArgs.name,this.queryParam.filterArgsExt.name=null},nm.prototype.clearProcessType=function(){delete this.queryParam.filterArgs.billProcessType},nm.prototype.clearUpBill=function(){delete this.queryParam.filterArgs.upBillVoId,this.queryParam.filterArgsExt.upBillVoName=null},nm.prototype.clearDownBill=function(){delete this.queryParam.filterArgs.downBillVoId,this.queryParam.filterArgsExt.downBillVoName=null},nm.prototype.clearIsEnabled=function(){delete this.queryParam.filterArgs.isEnabled},nm.prototype.clearIsPublished=function(){},nm.prototype.clearSysInit=function(){delete this.queryParam.filterArgs.sysInit},nm.prototype.clickBtnFilter=function(){this.queryParam.filterArgs.pageIndex=0,this.onSearchEmitter.emit(this.queryParam)},nm.prototype.clickBtnClear=function(){var e=this.queryParam;e.filterArgsExt={},e.filterArgs.upBillVoId=null,e.filterArgs.downBillVoId=null,e.filterArgs.sysInit=null,e.filterArgs.name=null,this.queryParam=e},nm.decorators=[{type:b.Component,args:[{selector:"app-proc-help-query-solution",template:'<farris-section #sectionQuerySolution class="f-section-scheme f-section-in-managelist" [expandStatus]="true"\r\n  [enableMaximize]="false" [enableAccordion]="\'\'" mainTitle="{{ \'querySolution\' | aifLocale }}" [fill]="false"\r\n  [showHeader]="true">\r\n  <ng-template farrisSectionTitle>\r\n    <div\r\n      style="border-radius: 6px; padding: 5px 12px; background: linear-gradient(-51deg, rgb(42, 135, 255, 0.2) 0%, rgb(50, 139, 255, 0.2) 100%);">\r\n      <span style="font-size: 13px;color: #2A87FF;line-height: 16px;">{{ \'querySolution\' | aifLocale }}</span>\r\n    </div>\r\n  </ng-template>\r\n\r\n  <ng-template farrisSectionToolbar>\r\n    <div class="query-solution">\r\n      <div class="solution-action">\r\n        <ng-container *ngIf="sectionQuerySolution.expandStatus == true">\r\n          <div class="btn-group">\r\n            <button class="btn btn-primary" (click)="clickBtnFilter()">{{ \'filter\' | aifLocale }}</button>\r\n          </div>\r\n          <div class="icon-group">\r\n            <span class="icon-group-remove" title="{{\'clear\' | aifLocale}}" (click)="clickBtnClear()">\r\n              <span class="f-icon f-icon-remove"></span>\r\n            </span>\r\n            <span class="divide"></span>\r\n            <span class="icon-group-setup" *ngIf="false">\r\n              <span class="f-icon f-icon-home-setup"></span>\r\n            </span>\r\n            <span class="icon-group-packup" title="{{ \'collapse\' | aifLocale }}"\r\n              (click)="sectionQuerySolution.expandStatus = false">\r\n              <span class="f-icon f-icon-packup"></span>\r\n            </span>\r\n          </div>\r\n        </ng-container>\r\n        <ng-container *ngIf="sectionQuerySolution.expandStatus == false">\r\n          <div class="icon-group">\r\n            <span class="icon-group-packup" title="{{ \'expand\' | aifLocale }}"\r\n              (click)="sectionQuerySolution.expandStatus = true">\r\n              <span class="f-icon f-icon-packup" style="transform: rotate(180deg);"></span>\r\n            </span>\r\n          </div>\r\n        </ng-container>\r\n      </div>\r\n    </div>\r\n  </ng-template>\r\n\r\n  <div class="form f-form-layout farris-form farris-form-controls-inline"\r\n    *ngIf="sectionQuerySolution.expandStatus == true">\r\n    \x3c!-- 流程名称 --\x3e\r\n    <div class="col-12 col-md-6 col-xl-3">\r\n      <div class="farris-group-wrap">\r\n        <div class="form-group farris-form-group">\r\n          <label for="" class="col-form-label" title="{{\'processName\' | aifLocale}}">\r\n            <span class="farris-label-text">{{"processName" | aifLocale}}</span>\r\n          </label>\r\n          <div class="farris-input-wrap">\r\n            <input-group [ngModel]="queryParam.filterArgsExt.name" (valueChange)="processNameChange($event)"\r\n              (clear)="clearProcessName()">\r\n            </input-group>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    \x3c!-- 流程类型 --\x3e\r\n    \x3c!-- <div class="col-12 col-md-6 col-xl-3" *ngIf="true">\r\n      <div class="farris-group-wrap">\r\n        <div class="form-group farris-form-group">\r\n          <label for="" class="col-form-label" title="{{\'processType\' | aifLocale}}">\r\n            <span class="farris-label-text">{{"processType" | aifLocale}}</span>\r\n          </label>\r\n          <div class="farris-input-wrap">\r\n            <farris-combo-list #comboProcessType [ngModel]="queryParam.filterArgs.billProcessType?.value"\r\n              [idField]="comboProcessTypeIdField" [valueField]="comboProcessTypeValueField"\r\n              [textField]="comboProcessTypeTextField" [data]="comboProcessTypeData" (clear)="clearProcessType()"\r\n              (valueChange)="processTypeChange($event)" [editable]="false"></farris-combo-list>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div> --\x3e\r\n\r\n    \x3c!-- 上游单据 --\x3e\r\n    <div class="col-12 col-md-6 col-xl-3">\r\n      <div class="farris-group-wrap">\r\n        <div class="form-group farris-form-group">\r\n          <label for="" class="col-form-label" title="{{\'upBill\' | aifLocale}}">\r\n            <span class="farris-label-text">{{"upBill" | aifLocale}}</span>\r\n          </label>\r\n          <div class="farris-input-wrap">\r\n            <input-group [editable]="false" [ngModel]="queryParam.filterArgsExt.upBillVoName"\r\n              (clickHandle)="selectUpBill()" [groupText]="groupIcon" (clear)="clearUpBill()"></input-group>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    \x3c!-- 下游单据 --\x3e\r\n    <div class="col-12 col-md-6 col-xl-3">\r\n      <div class="farris-group-wrap">\r\n        <div class="form-group farris-form-group">\r\n          <label for="" class="col-form-label" title="{{\'downBill\' | aifLocale}}">\r\n            <span class="farris-label-text">{{"downBill" | aifLocale}}</span>\r\n          </label>\r\n          <div class="farris-input-wrap">\r\n            <input-group [editable]="false" [ngModel]="queryParam.filterArgsExt.downBillVoName"\r\n              (clickHandle)="selectDownBill()" [groupText]="groupIcon" (clear)="clearDownBill()">\r\n            </input-group>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    \x3c!-- 启用状态 --\x3e\r\n    \x3c!-- <div class="col-12 col-md-6 col-xl-3">\r\n      <div class="farris-group-wrap">\r\n        <div class="form-group farris-form-group">\r\n          <label for="enabledState" class="col-form-label" title="{{\'enabledState\' | aifLocale}}">\r\n            <span class="farris-label-text">{{"enabledState" | aifLocale}}</span>\r\n          </label>\r\n          <div class="farris-input-wrap">\r\n            <farris-combo-list #comboEnabledState [ngModel]="queryParam.filterArgs.isEnabled?.value"\r\n              [idField]="comboEnabledStateIdField" [valueField]="comboEnabledStateValueField"\r\n              [textField]="comboEnabledStateTextField" [data]="comboEnabledStateData" (clear)="clearIsEnabled()"\r\n              (valueChange)="enabledStateChange($event)" [editable]="false"></farris-combo-list>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div> --\x3e\r\n\r\n    \x3c!-- 系统预置 --\x3e\r\n    <div class="col-12 col-md-6 col-xl-3" *ngIf="true">\r\n      <div class="farris-group-wrap">\r\n        <div class="form-group farris-form-group">\r\n          <label for="" class="col-form-label" title="{{\'sysInit\' | aifLocale}}">\r\n            <span class="farris-label-text">{{"sysInit" | aifLocale}}</span>\r\n          </label>\r\n          <div class="farris-input-wrap">\r\n            <farris-combo-list #comboSysInit [ngModel]="queryParam.filterArgs.sysInit?.value"\r\n              [idField]="comboSysInitIdField" [valueField]="comboSysInitValueField" [textField]="comboSysInitTextField"\r\n              [data]="comboSysInitData" (clear)="clearSysInit()" (valueChange)="sysInitChange($event)"\r\n              [editable]="false">\r\n            </farris-combo-list>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</farris-section>',styles:[".query-solution span{vertical-align:middle;margin:0 3px;cursor:pointer}"]}]}],nm.ctorParameters=function(){return[{type:xl},{type:r.MessagerService},{type:Te.NotifyService},{type:Fe.GSPMetadataRTService},{type:i.BsModalService},{type:b.Injector},{type:b.ComponentFactoryResolver},{type:wi}]},nm.propDecorators={queryParam:[{type:b.Input,args:["queryParam"]}],queryParamChange:[{type:b.Output,args:["queryParamChange"]}],onSearchEmitter:[{type:b.Output,args:["onSearch"]}],comboSysInit:[{type:b.ViewChild,args:["comboSysInit"]}]};var im=nm;function nm(e,t,r,i,n,o,a,s){this.procHelpService=e,this.messager=t,this.notify=r,this.metadataService=i,this.modalService=n,this.injector=o,this.resolver=a,this.localePipe=s,this.groupIcon='<i class="f-icon f-icon-lookup"></i>',this.queryParamChange=new b.EventEmitter,this.onSearchEmitter=new b.EventEmitter,this.comboSysInitIdField="value",this.comboSysInitValueField="value",this.comboSysInitTextField="text",this.comboSysInitData=[{value:"",text:this.localePipe.transform("all")},{value:"true",text:this.localePipe.transform("yes")},{value:"false",text:this.localePipe.transform("no")}]}am.forRoot=function(e){return{ngModule:am,providers:[{provide:xi,useValue:e||{}}]}},am.decorators=[{type:b.NgModule,args:[{declarations:[wi],exports:[wi]}]}];var om=am;function am(){}lm.decorators=[{type:b.NgModule,args:[{imports:[_e.CommonModule,fe.HttpClientModule,Fe.MetadataRTSelectModule,Fe.GSPMetadataRTServiceModule.forRoot(""),Ve.FResponseToolbarModule,Ie.ListFilterModule,xe.AngularDraggableModule,ge.FarrisCommonModule.forRoot(),we.FarrisFormsModule,ke.FarrisSectionModule,g.DatagridEditorsModule,ve.DatagridModule.forRoot(w(g.EditorProviders)),ye.ComboListModule,Pe.InputGroupModule,be.FarrisDialogModule,Me.SwitchModule,De.FarrisTabsModule,Ee.LookupModule,Se.LoadingModule.forRoot({message:"Loading..."}),Te.NotifyModule.forRoot(),r.MessagerModule.forRoot({width:550,height:450}),i.ModalModule.forRoot(),om],providers:[t.CacheService,t.SessionService,t.HttpService,Re.FrmEventBus,Re.FuncsService,Se.LoadingService,Re.AppService,Re.FrameworkService,Fe.GSPMetadataRTService,Le.BusinessObjectRtService,xl],declarations:[El,im],entryComponents:[El,im]}]}];var sm=lm;function lm(){}pm.prototype.transform=function(e,t){void 0===t&&(t="");var r="";return e.forEach(function(e){r+=e.activityDefName+"，"}),(r=r&&r.substring(0,r.length-1))||t},pm.decorators=[{type:b.Pipe,args:[{name:"activityExecutor"}]}],pm.ctorParameters=function(){return[]};var cm=pm;function pm(){}um.prototype.transform=function(e,t){void 0===t&&(t="");var r="";return e.forEach(function(e){r+=e.name+"，"}),(r=r&&r.substring(0,r.length-1))||t},um.decorators=[{type:b.Pipe,args:[{name:"variableName"}]}],um.ctorParameters=function(){return[]};var dm=um;function um(){}var mm=localStorage.getItem("languageCode")||"zh-CHS",Ie=(fm.decorators=[{type:b.NgModule,args:[{imports:[_e.CommonModule,fe.HttpClientModule,he.FormsModule,he.ReactiveFormsModule,Fe.MetadataRTSelectModule,Fe.GSPMetadataRTServiceModule.forRoot(""),Ve.FResponseToolbarModule,Ie.ListFilterModule,xe.AngularDraggableModule,ge.FarrisCommonModule.forRoot(),we.FarrisFormsModule,ke.FarrisSectionModule,g.DatagridEditorsModule,ve.DatagridModule.forRoot(w(g.EditorProviders)),ye.ComboListModule,Pe.InputGroupModule,be.FarrisDialogModule,Me.SwitchModule,De.FarrisTabsModule,Ee.LookupModule,Ne.TreeTableModule,Se.LoadingModule.forRoot({message:"Loading..."}),Te.NotifyModule.forRoot(),r.MessagerModule.forRoot({width:550,height:450}),i.ModalModule.forRoot(),Ae.PaginationModule,Oe.SplitterModule,Ce.LanguageTextboxModule,om],providers:[t.CacheService,t.SessionService,t.HttpService,Re.FrmEventBus,Re.FuncsService,Re.LoadingService,Re.AppService,Re.FrameworkService,{provide:b.LOCALE_ID,useValue:mm},Fe.GSPMetadataRTService,Le.BusinessObjectRtService,Qc],declarations:[ip],entryComponents:[ip]}]}],fm);function fm(){}hm.prototype.resolve=function(e,t){return this.translate.defaultLang=this.curLanguage,this.translate.getTranslation(this.curLanguage)},hm.decorators=[{type:b.Injectable}],hm.ctorParameters=function(){return[{type:He.TranslateService},{type:String,decorators:[{type:b.Inject,args:[b.LOCALE_ID]}]}]};xe=hm;function hm(e,t){this.translate=e,this.curLanguage=t}ym.decorators=[{type:b.NgModule,args:[{imports:[_e.CommonModule,Ge.RouterModule.forChild([{path:"WfProcessEditor",component:Au,children:[],resolve:{translate:xe}}])],exports:[Ge.RouterModule]}]}];ge=ym;function ym(){}gm.forRoot=function(e){return{ngModule:gm,providers:[{provide:o,useValue:e||{}}]}},gm.decorators=[{type:b.NgModule,args:[{declarations:[x],exports:[x]}]}];mm=gm;function gm(){}function vm(e){return new je.TranslateHttpLoader(e,"platform/runtime/common/web/@gsp-wf/wf-process-editor/i18n/",".json?v="+(new Date).getTime())}var bm=localStorage.getItem("languageCode")||"zh-CHS",xm=Tu,wm=F,_e=(Pm.decorators=[{type:b.NgModule,args:[{declarations:[Au,ut,mn,ku,on,cn,$t,gn,In,Mu,Et,ko,Io,zn,_n,ei,Eo,Nu,Fu,dm,cm,Zn,Qt,tl,ma,ar,nr,Uu,Ur,Rr,Zl,va,xr,Ca,dr,vr,ai,ri,_t,Xu,Zu,Wt,$u,ka,Yn,Fa,Ep,so,io,zr,di,Al,uo,yi,ni,Ua,Ga,qr,It,Po,Jc,$a,Kt,op,cp,ts,Lr,Oi,Zr,yu,$s,Wo],imports:[He.TranslateModule.forRoot({loader:{provide:He.TranslateLoader,useFactory:vm,deps:[fe.HttpClient]}}),_e.CommonModule,he.ReactiveFormsModule,he.FormsModule,fe.HttpClientModule,j.SysManagerUIModule,H.RtfAppHelpModule,U.CommonComponentUiModule,Fe.GSPMetadataRTServiceModule.forRoot(""),Fe.MetadataRTSelectModule,Ne.TreeTableModule,G.DataTableModule,K.LayoutModule,Te.NotifyModule,be.FarrisDialogModule,Oe.SplitterModule,Pe.InputGroupModule,Ee.LookupModule,q.FlexLayoutModule,W.FarrisPanelModule,J.FarrisResponsiveModule,Ve.FResponseToolbarModule,D.ExpressionModule,_.PropertyPanelModule,De.FarrisTabsModule,Se.LoadingModule.forRoot({message:"加载中..."}),r.MessagerModule.forRoot({width:500}),i.ModalModule,$.PopoverModule,Ae.PaginationModule,X.FarrisDropdownModule,g.DatagridEditorsModule,ve.DatagridModule.forRoot(w(g.EditorProviders,[Ue.PersonnelSelectorDataGridEditorProvider])),ye.ComboListModule,Z.WizardModule,we.FarrisFormsModule,Me.SwitchModule,ee.WfBizprocessLookupModule,te.NumberSpinnerModule,Q.PerfectScrollbarModule,ke.FarrisSectionModule,ie.FarrisButtonModule,sm,Ie,ie.FarrisButtonModule,oe.ComboLookupModule,ae.SysmgrLookupModule,X.FDropdownDirectiveTypeModule,Ce.LanguageTextboxModule,se.VerifyDetailModule,le.FarrisHtmlEditorModule,me.WfTaskHandlerModule,Y.DatagridFilterRowModule.forRoot(),om,ze.DataEntityModule,Be.BizProcessApiModule,Ue.PersonnelSelectorModule,ge,mm],providers:[t.SessionService,t.HttpService,D.ExpressionService,U.CommonComponentUiRTService,Vu,zu,Bu,Rn,l,Jn,qc,oo,{provide:b.LOCALE_ID,useValue:bm},{provide:o,useValue:xm},x,xe,Zr,wi,{provide:xi,useValue:wm}],exports:[Au,Wo],entryComponents:[ut,mn,ku,on,cn,$t,gn,In,Et,Fe.SelectMetadataRTComponent,ko,Io,zn,_n,ei,Eo,Zn,Qt,tl,ma,ar,nr,Uu,Ur,Rr,Zl,va,xr,Ca,dr,vr,ai,ri,ni,_t,Xu,Zu,Wt,$u,ka,Fa,Ep,so,io,zr,El,di,Al,uo,yi,Ua,Ga,qr,It,Po,Jc,$a,Kt,op,cp,ts,Oi,yu,$s,Wo]}]}],Pm);function Pm(){}fe=function(){};e.WfProcessEditorService=Ke,e.WfProcessEditorComponent=Au,e.HttpLoaderFactory=vm,e.WfProcessEditorModule=_e,e.ProcessTime=We,e.ProcessInfo=Ic,e.ProcessOrganization=qo,e.RTProcessInfo=fe,e.ActionScope=od,e.ActivityExecutorParticipant=Xp,e.ActualParameter=Ld,e.AssignConfig=Fd,e.AssignStrategy=Rd,e.BizComponent=kp,e.BizParameter=Op,e.ComponentParticipant=Kp,e.MatrixParticipant=ed,e.MessageReceiver=Ap,e.OrganizationLevel={DEPARTMENT:"DEPARTMENT",UNIT:"UNIT",EXPRESSION:"EXPRESSION",DEFAULT:"DEFAULT"},e.OrganizationParticipant=id,e.Participant=rp,e.ParticipantInfo=Vd,e.PositionParticipant=Hp,e.ProcExtendProperty=zd,e.ReportingLineParticipant=Jp,e.UserParticipant=Rp,e.VariablePerformer=Bp,e.AifCreationBillActivityCell=bd,e.AutoActivityCell=Pd,e.CallActivitySubProcessCell=Sd,e.IntermediateCatchEventImplCell=Ad,e.MessageActivityCell=Md,e.NotifyActivityCell=Bd,e.OperationActivityCell=Gd,e.PropertyHelper=S,e.StartActivityCell=ou,e.UserActivityCell=Hd,e.WfEndEventCell=du,e.WfExclusiveGatewayCell=yd,e.WfInclusiveGatewayCell=fu,e.WfParallelGatewayCell=lu,e.WfProcessCell=ld,e.WfConstants=I,e.WfDesignerUtils=Dp,e.WfEditorUi=xu,e.WfEvents=Fp,e.WfGraph=pd,e.WfSidebar=md,e.WfValidatorAdapter=Pu,e.ɵo=Gc,e.ɵk=$l,e.ɵr=mp,e.ɵh=en,e.ɵl=cc,e.ɵm=gc,e.ɵn=Lc,e.ɵd=a,e.ɵe=Ip,e.ɵs=xp,e.ɵj=Ul,e.ɵi=Qs,e.ɵg=l,e.ɵf=et,e.ɵc=Tu,e.ɵa=o,e.ɵb=x,e.ɵet=mm,e.ɵeu=Vu,e.ɵev=zu,e.ɵew=Bu,e.ɵes=xe,e.ɵbg=Et,e.ɵbh=xt,e.ɵbi=yt,e.ɵbj=Pt,e.ɵdt=qr,e.ɵem=im,e.ɵek=El,e.ɵel=F,e.ɵeh=sm,e.ɵej=xl,e.ɵei=om,e.ɵq=wi,e.ɵp=xi,e.ɵct=va,e.ɵdi=ka,e.ɵy=cn,e.ɵw=ku,e.ɵea=ts,e.ɵds=Ga,e.ɵbe=In,e.ɵef=yu,e.ɵen=Ie,e.ɵeo=Qc,e.ɵep=ip,e.ɵeq=tp,e.ɵco=Uu,e.ɵdo=Al,e.ɵdr=Ua,e.ɵcm=ar,e.ɵcn=nr,e.ɵdu=It,e.ɵu=ut,e.ɵcs=Zl,e.ɵdc=_t,e.ɵdd=Ut,e.ɵz=$t,e.ɵbc=Lt,e.ɵba=Ot,e.ɵbb=Dt,e.ɵdg=Zu,e.ɵde=Xu,e.ɵdf=$u,e.ɵdh=Wt,e.ɵdx=Kt,e.ɵv=mn,e.ɵdn=di,e.ɵdp=yi,e.ɵbd=gn,e.ɵbf=Mu,e.ɵdq=ni,e.ɵdb=ri,e.ɵda=ai,e.ɵeg=$s,e.ɵdk=Ep,e.ɵcj=ma,e.ɵck=Wo,e.ɵdw=$a,e.ɵcl=da,e.ɵbr=Rn,e.ɵbk=ko,e.ɵbm=ki,e.ɵbn=An,e.ɵbl=Mn,e.ɵcc=uo,e.ɵcg=cm,e.ɵbv=_n,e.ɵbw=Un,e.ɵdl=io,e.ɵca=so,e.ɵcb=oo,e.ɵbp=Io,e.ɵbo=Eo,e.ɵbt=ei,e.ɵbu=Zr,e.ɵbx=Zn,e.ɵby=Yn,e.ɵbz=Jn,e.ɵbq=zn,e.ɵce=Fu,e.ɵcd=Nu,e.ɵcf=dm,e.ɵbs=Po,e.ɵcu=xr,e.ɵdv=Jc,e.ɵci=tl,e.ɵt=qc,e.ɵx=on,e.ɵcr=Lr,e.ɵec=Si,e.ɵed=Ai,e.ɵeb=Oi,e.ɵee=Ci,e.ɵdm=zr,e.ɵcq=Rr,e.ɵcp=Ur,e.ɵch=Qt,e.ɵdj=Fa,e.ɵcv=Ca,e.ɵcz=mr,e.ɵcx=vr,e.ɵcy=hr,e.ɵcw=dr,e.ɵdy=op,e.ɵdz=cp,e.ɵer=ge,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=gsp-wf-wf-process-editor.umd.min.js.map