/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { Component, HostBinding, Output, EventEmitter, Input, ViewChild, TemplateRef, ChangeDetectorRef, Optional, Inject, LOCALE_ID } from '@angular/core';
import { ActionOrganizationScopeDesign, ActionScope, OrganizationPotentialOwner, OrganizationLevel } from './actionOrganizationScope';
import { WF_LANG_RESOURCES, WfLocalePipe } from '../../i18n/pipe/wf-process-editor-locale.pipe';
import { ExprEditMode, ExpressionService, InjectedType } from '@gsp-svc/expression';
import { ProcessDesignerUIState } from '../../app/process-designer.uistate';
import { AlternativeParticipantComponent } from '../participant/alternative-participant/alternative-participant.component';
import { OrganizationParticipantExpression } from '../../domain/entities/organization-participant-expression';
import { ParticipantInfo } from '../participant/participant.info';
import { MessagerService } from '@farris/ui-messager';
var OrganizationPotentialOwnerComponent = /** @class */ (function () {
    function OrganizationPotentialOwnerComponent(cdr, localeId, resources, localePipe, expr, message, designerUIState) {
        var _this = this;
        this.cdr = cdr;
        this.localeId = localeId;
        this.resources = resources;
        this.localePipe = localePipe;
        this.expr = expr;
        this.message = message;
        this.designerUIState = designerUIState;
        this.cls = 'farris-main-area flex-column';
        this.closeModal = new EventEmitter();
        this.submitModal = new EventEmitter();
        this.editorParams = {};
        this.organizationLevelCollection = [{
                value: 'GLOBAL',
                text: this.localePipe.transform('component.orgPotentialOwner.global'),
                orgId: 'global',
            }, {
                value: 'UNIT',
                text: this.localePipe.transform('component.orgPotentialOwner.currentUnit'),
                orgId: 'currentUnit'
            }, {
                value: 'DEPARTMENT',
                text: this.localePipe.transform('component.orgPotentialOwner.currentDepartment'),
                orgId: 'currentDepartment'
            },
            {
                value: 'VARORGANIZATION',
                text: this.localePipe.transform('component.orgPotentialOwner.variableOrganization'),
                orgId: ''
            }];
        this.actionCollection = [{
                value: ActionScope.AddSignBehind, name: this.localePipe.transform('component.orgPotentialOwner.addSignBehind')
            }, {
                value: ActionScope.AddSignFront, name: this.localePipe.transform('component.orgPotentialOwner.addSignFront')
            }, {
                value: ActionScope.Transfer, name: this.localePipe.transform('component.orgPotentialOwner.transfer')
            }, {
                value: ActionScope.Notify, name: this.localePipe.transform('component.orgPotentialOwner.notify')
            }];
        this.enable = false;
        this.organizationLevel = this.organizationLevelCollection[0].value;
        this.action = this.actionCollection[0].value;
        this.includeChildren = false;
        this.organizationId = '';
        this.showClearButton = false;
        this.actionName = (/**
         * @return {?}
         */
        function () {
            return _this.actionCollection.find((/**
             * @param {?} a
             * @return {?}
             */
            function (a) { return a.value === _this.action; })).name;
        });
        this.modalConfig = {
            title: this.localePipe.transform('component.orgPotentialOwner.optionSettings'),
            width: 760,
            height: 506,
            showButtons: true
        };
        this.localePipe = this.localePipe || new WfLocalePipe(localeId, resources);
    }
    Object.defineProperty(OrganizationPotentialOwnerComponent.prototype, "value", {
        set: /**
         * @param {?} v
         * @return {?}
         */
        function (v) {
            var _this = this;
            this.action = (/** @type {?} */ (v.action));
            if (this.action === this.actionCollection[2].value) {
                if (v.enable === null || v.enable === undefined) {
                    this.enable = true;
                }
                else {
                    this.enable = v.enable;
                }
            }
            else {
                this.enable = v.enable;
            }
            if (v.scope) {
                this.alternativeParticipant.participant.isAllScope = true;
                /** @type {?} */
                var organizationParticipantExpression = new OrganizationParticipantExpression();
                organizationParticipantExpression.actionScope = (/** @type {?} */ (v.action));
                if (v.scope.organizationLevel === OrganizationLevel.DEFAULT && v.scope.tag === 'expression') {
                    organizationParticipantExpression.organizationLevel = OrganizationLevel.VARORGANIZATION;
                    organizationParticipantExpression.tag = v.scope.tag;
                    this.organizationLevel = OrganizationLevel.VARORGANIZATION;
                }
                else if (v.scope.organizationLevel) {
                    this.organizationLevel = v.scope.organizationLevel;
                }
                this.includeChildren = v.scope.includeChildren;
                organizationParticipantExpression.includeChildren = v.scope.includeChildren;
                this.organizationId = v.scope.organizationId;
                organizationParticipantExpression.organizationId = v.scope.organizationId;
                organizationParticipantExpression.organizationName = this.organizationLevelCollection.find((/**
                 * @param {?} o
                 * @return {?}
                 */
                function (o) { return o.value === _this.organizationLevel; })).text;
                this.alternativeParticipant.addOrganizationParticipant(organizationParticipantExpression);
                if (v.scope.participantInfo) {
                    this.alternativeParticipant.participant = v.scope.participantInfo;
                }
                else {
                    this.alternativeParticipant.participant = new ParticipantInfo();
                }
            }
            else {
                this.alternativeParticipant.participant.isAllScope = false;
            }
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    OrganizationPotentialOwnerComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
    };
    /**
     * @return {?}
     */
    OrganizationPotentialOwnerComponent.prototype.clickOK = /**
     * @return {?}
     */
    function () {
        if (this.validate()) {
            /** @type {?} */
            var scope = new ActionOrganizationScopeDesign();
            scope.enable = this.enable;
            scope.action = (/** @type {?} */ (this.action));
            if (this.alternativeParticipant.participant.isAllScope) {
                /** @type {?} */
                var potential = new OrganizationPotentialOwner();
                potential.actionScope = this.action;
                // potential.organizationLevel = this.organizationLevel as OrganizationLevel;
                // potential.organizationId = this.organizationLevelCollection.find(o => o.value === this.organizationLevel).orgId || this.organizationId;
                // potential.organizationName = this.organizationLevelCollection.find(o => o.value === this.organizationLevel).text;
                // potential.includeChildren = this.includeChildren;
                // if (potential.organizationLevel === OrganizationLevel.VARORGANIZATION) {
                //   potential.tag = 'expression';
                //   potential.organizationLevel = OrganizationLevel.DEFAULT;
                // } else {
                //   potential.tag = 'variable';
                // }
                scope.scope = (/** @type {?} */ (potential));
                scope.scope.participantInfo = this.alternativeParticipant.participant;
            }
            /** @type {?} */
            var object = { value: scope, parameters: null };
            this.submitModal.emit(object);
        }
    };
    /**
     * @return {?}
     */
    OrganizationPotentialOwnerComponent.prototype.clickCancel = /**
     * @return {?}
     */
    function () {
        this.closeModal.emit();
    };
    /**
     * @return {?}
     */
    OrganizationPotentialOwnerComponent.prototype.validate = /**
     * @return {?}
     */
    function () {
        if (this.alternativeParticipant.participant.isAllScope &&
            (!this.alternativeParticipant.participant.potentialOwnerList || this.alternativeParticipant.participant.potentialOwnerList.length <= 0)) {
            this.message.info(this.localePipe.transform('component.orgPotentialOwner.turnOffPrompt'));
            return false;
        }
        else {
            return true;
        }
    };
    /**
     * @param {?} event
     * @return {?}
     */
    OrganizationPotentialOwnerComponent.prototype.valueChange = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        switch (event.value) {
            case this.organizationLevelCollection[0].value:
                this.includeChildren = false;
                break;
            case this.organizationLevelCollection[1].value:
                this.includeChildren = true;
                break;
            case this.organizationLevelCollection[2].value:
                this.includeChildren = false;
                break;
            case this.organizationLevelCollection[3].value:
                this.includeChildren = true;
                this.organizationId = '';
                break;
        }
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    OrganizationPotentialOwnerComponent.prototype.clear = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        this.organizationId = '';
    };
    /**
     * @param {?} data
     * @return {?}
     */
    OrganizationPotentialOwnerComponent.prototype.selectValue = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        this.showExprHelp();
    };
    /**
     * @return {?}
     */
    OrganizationPotentialOwnerComponent.prototype.showExprHelp = /**
     * @return {?}
     */
    function () {
        var _this = this;
        var e_1, _a, e_2, _b, e_3, _c, e_4, _d, e_5, _e;
        /** @type {?} */
        var context = new Array();
        // if(this.expr.exprEntity.contextEntities.find(x => x.key === 'CurrentLanguage')) {
        //   context.push(this.expr.exprEntity.contextEntities.find(x => x.key === 'CurrentLanguage'));
        // }
        // this.expr.clearContext();
        this.expr.setEditPattern(ExprEditMode.Advanced);
        if (this.designerUIState.schemas.length > 0) {
            try {
                for (var _f = tslib_1.__values(this.designerUIState.schemas), _g = _f.next(); !_g.done; _g = _f.next()) {
                    var schema = _g.value;
                    this.expr.addSchema('Schema', schema);
                }
            }
            catch (e_1_1) { e_1 = { error: e_1_1 }; }
            finally {
                try {
                    if (_g && !_g.done && (_a = _f.return)) _a.call(_f);
                }
                finally { if (e_1) throw e_1.error; }
            }
            if (this.designerUIState.schemas[0].entityTypes && this.designerUIState.schemas[0].entityTypes.length > 0) {
                /** @type {?} */
                var entityType = this.designerUIState.schemas[0].entityTypes[0];
                this.expr.addInjectedEntity(entityType.name, 'Schema', entityType.name, InjectedType.EntityType);
            }
        }
        if (this.designerUIState.participantContext.length > 0) {
            try {
                for (var _h = tslib_1.__values(this.designerUIState.participantContext), _j = _h.next(); !_j.done; _j = _h.next()) {
                    var variable = _j.value;
                    context.push(variable);
                }
            }
            catch (e_2_1) { e_2 = { error: e_2_1 }; }
            finally {
                try {
                    if (_j && !_j.done && (_b = _h.return)) _b.call(_h);
                }
                finally { if (e_2) throw e_2.error; }
            }
        }
        if (this.designerUIState.processVariableContext.length > 0) {
            var _loop_1 = function (variable) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    context.push(variable);
                }
            };
            try {
                for (var _k = tslib_1.__values(this.designerUIState.processVariableContext), _l = _k.next(); !_l.done; _l = _k.next()) {
                    var variable = _l.value;
                    _loop_1(variable);
                }
            }
            catch (e_3_1) { e_3 = { error: e_3_1 }; }
            finally {
                try {
                    if (_l && !_l.done && (_c = _k.return)) _c.call(_k);
                }
                finally { if (e_3) throw e_3.error; }
            }
        }
        if (this.designerUIState.subActivityContext.length > 0) {
            var _loop_2 = function (variable) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    context.push(variable);
                }
            };
            try {
                for (var _m = tslib_1.__values(this.designerUIState.subActivityContext), _o = _m.next(); !_o.done; _o = _m.next()) {
                    var variable = _o.value;
                    _loop_2(variable);
                }
            }
            catch (e_4_1) { e_4 = { error: e_4_1 }; }
            finally {
                try {
                    if (_o && !_o.done && (_d = _m.return)) _d.call(_m);
                }
                finally { if (e_4) throw e_4.error; }
            }
        }
        if (context.length > 0) {
            try {
                for (var context_1 = tslib_1.__values(context), context_1_1 = context_1.next(); !context_1_1.done; context_1_1 = context_1.next()) {
                    var v = context_1_1.value;
                    this.expr.addContext(v);
                }
            }
            catch (e_5_1) { e_5 = { error: e_5_1 }; }
            finally {
                try {
                    if (context_1_1 && !context_1_1.done && (_e = context_1.return)) _e.call(context_1);
                }
                finally { if (e_5) throw e_5.error; }
            }
        }
        // 预置表达式展示文本
        if (this.organizationId) {
            this.expr.addExpressionText(this.organizationId);
        }
        else {
            this.expr.addExpressionText('');
        }
        this.expr.buildExpression().then((/**
         * @param {?} expressioninfo
         * @return {?}
         */
        function (expressioninfo) {
            if (expressioninfo) {
                _this.organizationId = expressioninfo;
                _this.organizationLevelCollection[3].orgId = expressioninfo;
            }
            //点击确定后，去除表达式里面的新增的上下文变量
            if (context.length > 0) {
                _this.expr.exprEntity.contextEntities = _this.expr.exprEntity.contextEntities.filter((/**
                 * @param {?} x
                 * @return {?}
                 */
                function (x) { return !context.some((/**
                 * @param {?} y
                 * @return {?}
                 */
                function (y) { return y.key === x.key; })); }));
            }
        }));
    };
    OrganizationPotentialOwnerComponent.decorators = [
        { type: Component, args: [{
                    selector: 'app-organization-potential-owner',
                    template: "<div class=\"f-page\">\r\n  <div class=\"f-utils-fill-flex-column farris-split-section m-2 h-100 farris-overflow-y-auto farris-overflow-y-auto\">\r\n    <section class=\"f-utils-fill-flex-column h-100\">\r\n      <div class=\"f-utils-fill-flex-column h-100 farris-overflow-y-auto\" style=\"border-radius:16px;border: 1.5px solid #F1F3F7;\">\r\n        <div class=\"farris-form form-inline farris-form-inline\">\r\n          <div class=\"col-12 farris-group-auto my-3 pr-5\">\r\n            <div class=\"farris-group-wrap\">\r\n              <div class=\"form-group farris-form-group\">\r\n                <label class=\"col-form-label\" style=\"width: 5.3rem\">\r\n                  <span class=\"farris-label-text\">{{('component.orgPotentialOwner.enable'|wfLocale) + actionName()}}</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap ml-1\">\r\n                  <farris-switch [(ngModel)]=\"enable\" name=\"enable\"></farris-switch>\r\n                  <div class=\"farris-feedback valid-feedback\"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"col-12 farris-group-auto my-3 pr-5\">\r\n            <wf-alternative-participant [editorParams] = \"editorParams.nodeType\">\r\n            </wf-alternative-participant>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </section>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type=\"button\" class=\"btn btn-secondary btn-sm mx-2\" (click)=\"clickCancel()\">{{'component.orgPotentialOwner.clickCancel'|wfLocale}}</button>\r\n  <button type=\"button\" class=\"btn btn-primary btn-sm mx-2\" (click)=\"clickOK()\">{{'component.orgPotentialOwner.clickOK'|wfLocale}}</button>\r\n</ng-template>\r\n",
                    providers: [
                        WfLocalePipe,
                    ],
                    styles: [".title-content{color:#000;display:inline-flex;align-items:center;line-height:1.375rem;position:relative;overflow:hidden;padding:0 0 0 1rem;min-width:390px}.title-content ::before{content:'';width:.25rem;height:1.125rem;background:#59a1ff;border-radius:1px;position:absolute;top:50%;left:0;margin-top:-.5625rem}.title-text{font-size:1rem;line-height:1.375rem;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;margin-bottom:0;margin-right:10px}.title-line{flex-grow:1;border-bottom:1px dashed rgba(0,0,0,.1)}"]
                }] }
    ];
    /** @nocollapse */
    OrganizationPotentialOwnerComponent.ctorParameters = function () { return [
        { type: ChangeDetectorRef, decorators: [{ type: Optional }] },
        { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
        { type: undefined, decorators: [{ type: Inject, args: [WF_LANG_RESOURCES,] }] },
        { type: WfLocalePipe, decorators: [{ type: Optional }] },
        { type: ExpressionService },
        { type: MessagerService },
        { type: ProcessDesignerUIState }
    ]; };
    OrganizationPotentialOwnerComponent.propDecorators = {
        cls: [{ type: HostBinding, args: ['class',] }],
        closeModal: [{ type: Output }],
        submitModal: [{ type: Output }],
        editorParams: [{ type: Input }],
        alternativeParticipant: [{ type: ViewChild, args: [AlternativeParticipantComponent,] }],
        value: [{ type: Input }],
        modalFooter: [{ type: ViewChild, args: ['iconSelectFooter',] }]
    };
    return OrganizationPotentialOwnerComponent;
}());
export { OrganizationPotentialOwnerComponent };
if (false) {
    /** @type {?} */
    OrganizationPotentialOwnerComponent.prototype.cls;
    /** @type {?} */
    OrganizationPotentialOwnerComponent.prototype.closeModal;
    /** @type {?} */
    OrganizationPotentialOwnerComponent.prototype.submitModal;
    /** @type {?} */
    OrganizationPotentialOwnerComponent.prototype.editorParams;
    /** @type {?} */
    OrganizationPotentialOwnerComponent.prototype.alternativeParticipant;
    /** @type {?} */
    OrganizationPotentialOwnerComponent.prototype.modalFooter;
    /** @type {?} */
    OrganizationPotentialOwnerComponent.prototype.organizationLevelCollection;
    /** @type {?} */
    OrganizationPotentialOwnerComponent.prototype.actionCollection;
    /** @type {?} */
    OrganizationPotentialOwnerComponent.prototype.enable;
    /** @type {?} */
    OrganizationPotentialOwnerComponent.prototype.organizationLevel;
    /** @type {?} */
    OrganizationPotentialOwnerComponent.prototype.action;
    /** @type {?} */
    OrganizationPotentialOwnerComponent.prototype.includeChildren;
    /** @type {?} */
    OrganizationPotentialOwnerComponent.prototype.organizationId;
    /** @type {?} */
    OrganizationPotentialOwnerComponent.prototype.showClearButton;
    /** @type {?} */
    OrganizationPotentialOwnerComponent.prototype.actionName;
    /** @type {?} */
    OrganizationPotentialOwnerComponent.prototype.modalConfig;
    /**
     * @type {?}
     * @private
     */
    OrganizationPotentialOwnerComponent.prototype.cdr;
    /**
     * @type {?}
     * @private
     */
    OrganizationPotentialOwnerComponent.prototype.localeId;
    /**
     * @type {?}
     * @private
     */
    OrganizationPotentialOwnerComponent.prototype.resources;
    /**
     * @type {?}
     * @private
     */
    OrganizationPotentialOwnerComponent.prototype.localePipe;
    /**
     * @type {?}
     * @private
     */
    OrganizationPotentialOwnerComponent.prototype.expr;
    /**
     * @type {?}
     * @private
     */
    OrganizationPotentialOwnerComponent.prototype.message;
    /**
     * @type {?}
     * @private
     */
    OrganizationPotentialOwnerComponent.prototype.designerUIState;
}
var OrganizationPotentialOwnerConverter = /** @class */ (function () {
    function OrganizationPotentialOwnerConverter(localePipe) {
        this.localePipe = localePipe;
    }
    /**
     * @param {?} data
     * @return {?}
     */
    OrganizationPotentialOwnerConverter.prototype.convertTo = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        if (data && data.action === (/** @type {?} */ (ActionScope.Transfer)) && (data.enable === null || data.enable === undefined)) {
            return this.localePipe.transform("component.orgPotentialOwner.set");
        }
        else {
            if (data && data.enable) {
                return this.localePipe.transform("component.orgPotentialOwner.set");
            }
            else {
                return this.localePipe.transform("component.orgPotentialOwner.notSet");
            }
        }
    };
    return OrganizationPotentialOwnerConverter;
}());
export { OrganizationPotentialOwnerConverter };
if (false) {
    /**
     * @type {?}
     * @private
     */
    OrganizationPotentialOwnerConverter.prototype.localePipe;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoib3JnYW5pemF0aW9uLXBvdGVudGlhbC1vd25lci5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZ3NwLXdmL3dmLXByb2Nlc3MtZWRpdG9yLyIsInNvdXJjZXMiOlsibGliL3ZpZXdzL29yZ2FuaXphdGlvbi1wb3RlbnRpYWwtb3duZXIvb3JnYW5pemF0aW9uLXBvdGVudGlhbC1vd25lci5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFVLFdBQVcsRUFBRSxNQUFNLEVBQUUsWUFBWSxFQUFFLEtBQUssRUFBRSxTQUFTLEVBQUUsV0FBVyxFQUFFLGlCQUFpQixFQUFFLFFBQVEsRUFBRSxNQUFNLEVBQUUsU0FBUyxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBRXBLLE9BQU8sRUFBRSw2QkFBNkIsRUFBRSxXQUFXLEVBQUUsMEJBQTBCLEVBQUUsaUJBQWlCLEVBQUUsTUFBTSwyQkFBMkIsQ0FBQztBQUN0SSxPQUFPLEVBQUUsaUJBQWlCLEVBQUUsWUFBWSxFQUFFLE1BQU0sK0NBQStDLENBQUM7QUFDaEcsT0FBTyxFQUFFLFlBQVksRUFBRSxpQkFBaUIsRUFBRSxZQUFZLEVBQWEsTUFBTSxxQkFBcUIsQ0FBQztBQUMvRixPQUFPLEVBQUUsc0JBQXNCLEVBQUUsTUFBTSxvQ0FBb0MsQ0FBQztBQUM1RSxPQUFPLEVBQUUsK0JBQStCLEVBQUUsTUFBTSwwRUFBMEUsQ0FBQztBQUMzSCxPQUFPLEVBQUUsaUNBQWlDLEVBQUUsTUFBTSwyREFBMkQsQ0FBQztBQUM5RyxPQUFPLEVBQWUsZUFBZSxFQUFFLE1BQU0saUNBQWlDLENBQUM7QUFDL0UsT0FBTyxFQUFFLGVBQWUsRUFBRSxNQUFNLHFCQUFxQixDQUFDO0FBRXREO0lBOEZFLDZDQUNzQixHQUFzQixFQUNmLFFBQWdCLEVBQ1IsU0FBYyxFQUM3QixVQUF3QixFQUNwQyxJQUF1QixFQUN2QixPQUF3QixFQUN4QixlQUF1QztRQVBqRCxpQkFVRTtRQVRvQixRQUFHLEdBQUgsR0FBRyxDQUFtQjtRQUNmLGFBQVEsR0FBUixRQUFRLENBQVE7UUFDUixjQUFTLEdBQVQsU0FBUyxDQUFLO1FBQzdCLGVBQVUsR0FBVixVQUFVLENBQWM7UUFDcEMsU0FBSSxHQUFKLElBQUksQ0FBbUI7UUFDdkIsWUFBTyxHQUFQLE9BQU8sQ0FBaUI7UUFDeEIsb0JBQWUsR0FBZixlQUFlLENBQXdCO1FBM0ZqRCxRQUFHLEdBQUcsOEJBQThCLENBQUM7UUFFM0IsZUFBVSxHQUFHLElBQUksWUFBWSxFQUFPLENBQUM7UUFDckMsZ0JBQVcsR0FBRyxJQUFJLFlBQVksRUFBTyxDQUFDO1FBRXZDLGlCQUFZLEdBQVEsRUFBRSxDQUFDO1FBNkNoQyxnQ0FBMkIsR0FBRyxDQUFDO2dCQUM3QixLQUFLLEVBQUUsUUFBUTtnQkFDZixJQUFJLEVBQUUsSUFBSSxDQUFDLFVBQVUsQ0FBQyxTQUFTLENBQUMsb0NBQW9DLENBQUM7Z0JBQ3JFLEtBQUssRUFBRSxRQUFRO2FBQ2hCLEVBQUU7Z0JBQ0QsS0FBSyxFQUFFLE1BQU07Z0JBQ2IsSUFBSSxFQUFFLElBQUksQ0FBQyxVQUFVLENBQUMsU0FBUyxDQUFDLHlDQUF5QyxDQUFDO2dCQUMxRSxLQUFLLEVBQUUsYUFBYTthQUNyQixFQUFFO2dCQUNELEtBQUssRUFBRSxZQUFZO2dCQUNuQixJQUFJLEVBQUUsSUFBSSxDQUFDLFVBQVUsQ0FBQyxTQUFTLENBQUMsK0NBQStDLENBQUM7Z0JBQ2hGLEtBQUssRUFBRSxtQkFBbUI7YUFDM0I7WUFDRDtnQkFDRSxLQUFLLEVBQUUsaUJBQWlCO2dCQUN4QixJQUFJLEVBQUUsSUFBSSxDQUFDLFVBQVUsQ0FBQyxTQUFTLENBQUMsa0RBQWtELENBQUM7Z0JBQ25GLEtBQUssRUFBRSxFQUFFO2FBQ1YsQ0FBQyxDQUFDO1FBQ0gscUJBQWdCLEdBQUcsQ0FBQztnQkFDaEIsS0FBSyxFQUFFLFdBQVcsQ0FBQyxhQUFhLEVBQUUsSUFBSSxFQUFFLElBQUksQ0FBQyxVQUFVLENBQUMsU0FBUyxDQUFDLDJDQUEyQyxDQUFDO2FBQ2pILEVBQUU7Z0JBQ0MsS0FBSyxFQUFFLFdBQVcsQ0FBQyxZQUFZLEVBQUUsSUFBSSxFQUFFLElBQUksQ0FBQyxVQUFVLENBQUMsU0FBUyxDQUFDLDBDQUEwQyxDQUFDO2FBQy9HLEVBQUU7Z0JBQ0MsS0FBSyxFQUFFLFdBQVcsQ0FBQyxRQUFRLEVBQUUsSUFBSSxFQUFFLElBQUksQ0FBQyxVQUFVLENBQUMsU0FBUyxDQUFDLHNDQUFzQyxDQUFDO2FBQ3ZHLEVBQUU7Z0JBQ0QsS0FBSyxFQUFFLFdBQVcsQ0FBQyxNQUFNLEVBQUUsSUFBSSxFQUFFLElBQUksQ0FBQyxVQUFVLENBQUMsU0FBUyxDQUFDLG9DQUFvQyxDQUFDO2FBQ25HLENBQUMsQ0FBQztRQUNELFdBQU0sR0FBRyxLQUFLLENBQUM7UUFDZixzQkFBaUIsR0FBRyxJQUFJLENBQUMsMkJBQTJCLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDO1FBQzlELFdBQU0sR0FBRyxJQUFJLENBQUMsZ0JBQWdCLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDO1FBQ3hDLG9CQUFlLEdBQUcsS0FBSyxDQUFDO1FBQ3hCLG1CQUFjLEdBQUcsRUFBRSxDQUFDO1FBQ3BCLG9CQUFlLEdBQUcsS0FBSyxDQUFDO1FBd0V4QixlQUFVOzs7UUFBRztZQUNYLE9BQU8sS0FBSSxDQUFDLGdCQUFnQixDQUFDLElBQUk7Ozs7WUFBQyxVQUFBLENBQUMsSUFBSSxPQUFBLENBQUMsQ0FBQyxLQUFLLEtBQUssS0FBSSxDQUFDLE1BQU0sRUFBdkIsQ0FBdUIsRUFBQyxDQUFDLElBQUksQ0FBQztRQUN2RSxDQUFDLEVBQUE7UUFtRUQsZ0JBQVcsR0FBRztZQUNaLEtBQUssRUFBRSxJQUFJLENBQUMsVUFBVSxDQUFDLFNBQVMsQ0FBQyw0Q0FBNEMsQ0FBQztZQUM5RSxLQUFLLEVBQUUsR0FBRztZQUNWLE1BQU0sRUFBRSxHQUFHO1lBQ1gsV0FBVyxFQUFFLElBQUk7U0FDbEIsQ0FBQztRQXZJQSxJQUFJLENBQUMsVUFBVSxHQUFHLElBQUksQ0FBQyxVQUFVLElBQUksSUFBSSxZQUFZLENBQUMsUUFBUSxFQUFFLFNBQVMsQ0FBQyxDQUFDO0lBQzVFLENBQUM7SUFyRkYsc0JBQ0ksc0RBQUs7Ozs7O1FBRFQsVUFDVSxDQUFnQztZQUQxQyxpQkFxQ0M7WUFuQ0MsSUFBSSxDQUFDLE1BQU0sR0FBRyxtQkFBQSxDQUFDLENBQUMsTUFBTSxFQUFPLENBQUM7WUFDOUIsSUFBSSxJQUFJLENBQUMsTUFBTSxLQUFLLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLEVBQUU7Z0JBQ2xELElBQUksQ0FBQyxDQUFDLE1BQU0sS0FBSyxJQUFJLElBQUksQ0FBQyxDQUFDLE1BQU0sS0FBSyxTQUFTLEVBQUU7b0JBQy9DLElBQUksQ0FBQyxNQUFNLEdBQUcsSUFBSSxDQUFDO2lCQUNwQjtxQkFBTTtvQkFDTCxJQUFJLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQyxNQUFNLENBQUM7aUJBQ3hCO2FBQ0Y7aUJBQU07Z0JBQ0wsSUFBSSxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUMsTUFBTSxDQUFDO2FBQ3hCO1lBQ0QsSUFBSSxDQUFDLENBQUMsS0FBSyxFQUFFO2dCQUNYLElBQUksQ0FBQyxzQkFBc0IsQ0FBQyxXQUFXLENBQUMsVUFBVSxHQUFHLElBQUksQ0FBQzs7b0JBQ3RELGlDQUFpQyxHQUFHLElBQUksaUNBQWlDLEVBQUU7Z0JBQy9FLGlDQUFpQyxDQUFDLFdBQVcsR0FBRyxtQkFBQSxDQUFDLENBQUMsTUFBTSxFQUFPLENBQUM7Z0JBQ2hFLElBQUksQ0FBQyxDQUFDLEtBQUssQ0FBQyxpQkFBaUIsS0FBSyxpQkFBaUIsQ0FBQyxPQUFPLElBQUksQ0FBQyxDQUFDLEtBQUssQ0FBQyxHQUFHLEtBQUssWUFBWSxFQUFFO29CQUMzRixpQ0FBaUMsQ0FBQyxpQkFBaUIsR0FBRyxpQkFBaUIsQ0FBQyxlQUFlLENBQUM7b0JBQ3hGLGlDQUFpQyxDQUFDLEdBQUcsR0FBRyxDQUFDLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQztvQkFDcEQsSUFBSSxDQUFDLGlCQUFpQixHQUFHLGlCQUFpQixDQUFDLGVBQWUsQ0FBQztpQkFDNUQ7cUJBQU0sSUFBRyxDQUFDLENBQUMsS0FBSyxDQUFDLGlCQUFpQixFQUFDO29CQUNsQyxJQUFJLENBQUMsaUJBQWlCLEdBQUcsQ0FBQyxDQUFDLEtBQUssQ0FBQyxpQkFBaUIsQ0FBQztpQkFDcEQ7Z0JBQ0QsSUFBSSxDQUFDLGVBQWUsR0FBRyxDQUFDLENBQUMsS0FBSyxDQUFDLGVBQWUsQ0FBQztnQkFDL0MsaUNBQWlDLENBQUMsZUFBZSxHQUFHLENBQUMsQ0FBQyxLQUFLLENBQUMsZUFBZSxDQUFDO2dCQUM1RSxJQUFJLENBQUMsY0FBYyxHQUFHLENBQUMsQ0FBQyxLQUFLLENBQUMsY0FBYyxDQUFDO2dCQUM3QyxpQ0FBaUMsQ0FBQyxjQUFjLEdBQUcsQ0FBQyxDQUFDLEtBQUssQ0FBQyxjQUFjLENBQUM7Z0JBQzFFLGlDQUFpQyxDQUFDLGdCQUFnQixHQUFHLElBQUksQ0FBQywyQkFBMkIsQ0FBQyxJQUFJOzs7O2dCQUFDLFVBQUEsQ0FBQyxJQUFJLE9BQUEsQ0FBQyxDQUFDLEtBQUssS0FBSyxLQUFJLENBQUMsaUJBQWlCLEVBQWxDLENBQWtDLEVBQUMsQ0FBQyxJQUFJLENBQUM7Z0JBQ3pJLElBQUksQ0FBQyxzQkFBc0IsQ0FBQywwQkFBMEIsQ0FBQyxpQ0FBaUMsQ0FBQyxDQUFDO2dCQUMxRixJQUFHLENBQUMsQ0FBQyxLQUFLLENBQUMsZUFBZSxFQUFDO29CQUN6QixJQUFJLENBQUMsc0JBQXNCLENBQUMsV0FBVyxHQUFHLENBQUMsQ0FBQyxLQUFLLENBQUMsZUFBZSxDQUFDO2lCQUNuRTtxQkFBSztvQkFDSixJQUFJLENBQUMsc0JBQXNCLENBQUMsV0FBVyxHQUFHLElBQUksZUFBZSxFQUFFLENBQUM7aUJBQ2pFO2FBQ0Y7aUJBQUs7Z0JBQ0osSUFBSSxDQUFDLHNCQUFzQixDQUFDLFdBQVcsQ0FBQyxVQUFVLEdBQUcsS0FBSyxDQUFDO2FBQzVEO1FBQ0gsQ0FBQzs7O09BQUE7Ozs7SUFrREQsc0RBQVE7OztJQUFSO0lBQ0EsQ0FBQzs7OztJQUVELHFEQUFPOzs7SUFBUDtRQUNFLElBQUcsSUFBSSxDQUFDLFFBQVEsRUFBRSxFQUFDOztnQkFDWCxLQUFLLEdBQUcsSUFBSSw2QkFBNkIsRUFBRTtZQUNqRCxLQUFLLENBQUMsTUFBTSxHQUFHLElBQUksQ0FBQyxNQUFNLENBQUM7WUFDM0IsS0FBSyxDQUFDLE1BQU0sR0FBRyxtQkFBQSxJQUFJLENBQUMsTUFBTSxFQUFPLENBQUM7WUFDbEMsSUFBSSxJQUFJLENBQUMsc0JBQXNCLENBQUMsV0FBVyxDQUFDLFVBQVUsRUFBRTs7b0JBQ2hELFNBQVMsR0FBRyxJQUFJLDBCQUEwQixFQUFFO2dCQUNsRCxTQUFTLENBQUMsV0FBVyxHQUFHLElBQUksQ0FBQyxNQUFNLENBQUM7Z0JBQ3BDLDZFQUE2RTtnQkFDN0UsMElBQTBJO2dCQUMxSSxvSEFBb0g7Z0JBQ3BILG9EQUFvRDtnQkFDcEQsMkVBQTJFO2dCQUMzRSxrQ0FBa0M7Z0JBQ2xDLDZEQUE2RDtnQkFDN0QsV0FBVztnQkFDWCxnQ0FBZ0M7Z0JBQ2hDLElBQUk7Z0JBQ0osS0FBSyxDQUFDLEtBQUssR0FBRyxtQkFBQSxTQUFTLEVBQU8sQ0FBQztnQkFDL0IsS0FBSyxDQUFDLEtBQUssQ0FBQyxlQUFlLEdBQUcsSUFBSSxDQUFDLHNCQUFzQixDQUFDLFdBQVcsQ0FBQzthQUN2RTs7Z0JBQ0ssTUFBTSxHQUFHLEVBQUUsS0FBSyxFQUFFLEtBQUssRUFBRSxVQUFVLEVBQUUsSUFBSSxFQUFFO1lBQ2pELElBQUksQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDO1NBQy9CO0lBQ0gsQ0FBQzs7OztJQUNELHlEQUFXOzs7SUFBWDtRQUNFLElBQUksQ0FBQyxVQUFVLENBQUMsSUFBSSxFQUFFLENBQUM7SUFDekIsQ0FBQzs7OztJQUVELHNEQUFROzs7SUFBUjtRQUNFLElBQUcsSUFBSSxDQUFDLHNCQUFzQixDQUFDLFdBQVcsQ0FBQyxVQUFVO1lBQ25ELENBQUMsQ0FBQyxJQUFJLENBQUMsc0JBQXNCLENBQUMsV0FBVyxDQUFDLGtCQUFrQixJQUFJLElBQUksQ0FBQyxzQkFBc0IsQ0FBQyxXQUFXLENBQUMsa0JBQWtCLENBQUMsTUFBTSxJQUFJLENBQUMsQ0FBQyxFQUFFO1lBQ3ZJLElBQUksQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsU0FBUyxDQUFDLDJDQUEyQyxDQUFDLENBQUMsQ0FBQztZQUMxRixPQUFPLEtBQUssQ0FBQztTQUNkO2FBQUs7WUFDSixPQUFPLElBQUksQ0FBQztTQUNiO0lBQ0wsQ0FBQzs7Ozs7SUFDRCx5REFBVzs7OztJQUFYLFVBQVksS0FBVTtRQUNwQixRQUFRLEtBQUssQ0FBQyxLQUFLLEVBQUU7WUFDbkIsS0FBSyxJQUFJLENBQUMsMkJBQTJCLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSztnQkFDNUMsSUFBSSxDQUFDLGVBQWUsR0FBRyxLQUFLLENBQUM7Z0JBQzdCLE1BQU07WUFDUixLQUFLLElBQUksQ0FBQywyQkFBMkIsQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLO2dCQUM1QyxJQUFJLENBQUMsZUFBZSxHQUFHLElBQUksQ0FBQztnQkFDNUIsTUFBTTtZQUNSLEtBQUssSUFBSSxDQUFDLDJCQUEyQixDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUs7Z0JBQzVDLElBQUksQ0FBQyxlQUFlLEdBQUcsS0FBSyxDQUFDO2dCQUM3QixNQUFNO1lBQ1IsS0FBSyxJQUFJLENBQUMsMkJBQTJCLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSztnQkFDNUMsSUFBSSxDQUFDLGVBQWUsR0FBRyxJQUFJLENBQUM7Z0JBQzVCLElBQUksQ0FBQyxjQUFjLEdBQUcsRUFBRSxDQUFDO2dCQUN6QixNQUFNO1NBQ1Q7SUFDSCxDQUFDOzs7OztJQUlELG1EQUFLOzs7O0lBQUwsVUFBTSxNQUFNO1FBQ1YsSUFBSSxDQUFDLGNBQWMsR0FBRyxFQUFFLENBQUM7SUFDM0IsQ0FBQzs7Ozs7SUFDRCx5REFBVzs7OztJQUFYLFVBQVksSUFBUztRQUNuQixJQUFJLENBQUMsWUFBWSxFQUFFLENBQUM7SUFDdEIsQ0FBQzs7OztJQUVELDBEQUFZOzs7SUFBWjtRQUFBLGlCQXlEQzs7O1lBeERPLE9BQU8sR0FBRyxJQUFJLEtBQUssRUFBYTtRQUN0QyxvRkFBb0Y7UUFDcEYsK0ZBQStGO1FBQy9GLElBQUk7UUFDSiw0QkFBNEI7UUFDNUIsSUFBSSxDQUFDLElBQUksQ0FBQyxjQUFjLENBQUMsWUFBWSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBQ2hELElBQUksSUFBSSxDQUFDLGVBQWUsQ0FBQyxPQUFPLENBQUMsTUFBTSxHQUFHLENBQUMsRUFBRTs7Z0JBQzNDLEtBQXFCLElBQUEsS0FBQSxpQkFBQSxJQUFJLENBQUMsZUFBZSxDQUFDLE9BQU8sQ0FBQSxnQkFBQSw0QkFBRTtvQkFBOUMsSUFBTSxNQUFNLFdBQUE7b0JBQ2YsSUFBSSxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsUUFBUSxFQUFFLE1BQU0sQ0FBQyxDQUFDO2lCQUN2Qzs7Ozs7Ozs7O1lBQ0QsSUFBSSxJQUFJLENBQUMsZUFBZSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxXQUFXLElBQUksSUFBSSxDQUFDLGVBQWUsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUMsV0FBVyxDQUFDLE1BQU0sR0FBRyxDQUFDLEVBQUU7O29CQUNuRyxVQUFVLEdBQUcsSUFBSSxDQUFDLGVBQWUsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQztnQkFDakUsSUFBSSxDQUFDLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxVQUFVLENBQUMsSUFBSSxFQUFFLFFBQVEsRUFDbkQsVUFBVSxDQUFDLElBQUksRUFBRSxZQUFZLENBQUMsVUFBVSxDQUFDLENBQUM7YUFDN0M7U0FDRjtRQUNELElBQUksSUFBSSxDQUFDLGVBQWUsQ0FBQyxrQkFBa0IsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxFQUFFOztnQkFDdEQsS0FBdUIsSUFBQSxLQUFBLGlCQUFBLElBQUksQ0FBQyxlQUFlLENBQUMsa0JBQWtCLENBQUEsZ0JBQUEsNEJBQUU7b0JBQTNELElBQU0sUUFBUSxXQUFBO29CQUNqQixPQUFPLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDO2lCQUN4Qjs7Ozs7Ozs7O1NBQ0Y7UUFDRCxJQUFJLElBQUksQ0FBQyxlQUFlLENBQUMsc0JBQXNCLENBQUMsTUFBTSxHQUFHLENBQUMsRUFBRTtvQ0FDL0MsUUFBUTtnQkFDakIsSUFBSSxDQUFDLE9BQU8sQ0FBQyxJQUFJOzs7O2dCQUFDLFVBQUEsQ0FBQyxJQUFJLE9BQUEsQ0FBQyxDQUFDLEdBQUcsS0FBSyxRQUFRLENBQUMsR0FBRyxFQUF0QixDQUFzQixFQUFDLEVBQUU7b0JBQzlDLE9BQU8sQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUM7aUJBQ3hCOzs7Z0JBSEgsS0FBdUIsSUFBQSxLQUFBLGlCQUFBLElBQUksQ0FBQyxlQUFlLENBQUMsc0JBQXNCLENBQUEsZ0JBQUE7b0JBQTdELElBQU0sUUFBUSxXQUFBOzRCQUFSLFFBQVE7aUJBSWxCOzs7Ozs7Ozs7U0FDRjtRQUNELElBQUksSUFBSSxDQUFDLGVBQWUsQ0FBQyxrQkFBa0IsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxFQUFFO29DQUMzQyxRQUFRO2dCQUNqQixJQUFJLENBQUMsT0FBTyxDQUFDLElBQUk7Ozs7Z0JBQUMsVUFBQSxDQUFDLElBQUksT0FBQSxDQUFDLENBQUMsR0FBRyxLQUFLLFFBQVEsQ0FBQyxHQUFHLEVBQXRCLENBQXNCLEVBQUMsRUFBRTtvQkFDOUMsT0FBTyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQztpQkFDeEI7OztnQkFISCxLQUF1QixJQUFBLEtBQUEsaUJBQUEsSUFBSSxDQUFDLGVBQWUsQ0FBQyxrQkFBa0IsQ0FBQSxnQkFBQTtvQkFBekQsSUFBTSxRQUFRLFdBQUE7NEJBQVIsUUFBUTtpQkFJbEI7Ozs7Ozs7OztTQUNGO1FBQ0QsSUFBSSxPQUFPLENBQUMsTUFBTSxHQUFHLENBQUMsRUFBRTs7Z0JBQ3RCLEtBQWdCLElBQUEsWUFBQSxpQkFBQSxPQUFPLENBQUEsZ0NBQUEscURBQUU7b0JBQXBCLElBQU0sQ0FBQyxvQkFBQTtvQkFDVixJQUFJLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUMsQ0FBQztpQkFDekI7Ozs7Ozs7OztTQUNGO1FBQ0QsWUFBWTtRQUNaLElBQUksSUFBSSxDQUFDLGNBQWMsRUFBRTtZQUN2QixJQUFJLENBQUMsSUFBSSxDQUFDLGlCQUFpQixDQUFDLElBQUksQ0FBQyxjQUFjLENBQUMsQ0FBQztTQUNsRDthQUFNO1lBQ0wsSUFBSSxDQUFDLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxFQUFFLENBQUMsQ0FBQztTQUNqQztRQUNELElBQUksQ0FBQyxJQUFJLENBQUMsZUFBZSxFQUFFLENBQUMsSUFBSTs7OztRQUFDLFVBQUMsY0FBc0I7WUFDdEQsSUFBSSxjQUFjLEVBQUU7Z0JBQ2xCLEtBQUksQ0FBQyxjQUFjLEdBQUcsY0FBYyxDQUFDO2dCQUNyQyxLQUFJLENBQUMsMkJBQTJCLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxHQUFHLGNBQWMsQ0FBQzthQUM1RDtZQUNELHdCQUF3QjtZQUN4QixJQUFHLE9BQU8sQ0FBQyxNQUFNLEdBQUcsQ0FBQyxFQUFFO2dCQUNyQixLQUFJLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxlQUFlLEdBQUcsS0FBSSxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsZUFBZSxDQUFDLE1BQU07Ozs7Z0JBQUMsVUFBQSxDQUFDLElBQUksT0FBQSxDQUFDLE9BQU8sQ0FBQyxJQUFJOzs7O2dCQUFDLFVBQUEsQ0FBQyxJQUFJLE9BQUEsQ0FBQyxDQUFDLEdBQUcsS0FBSyxDQUFDLENBQUMsR0FBRyxFQUFmLENBQWUsRUFBQyxFQUFuQyxDQUFtQyxFQUFDLENBQUM7YUFDOUg7UUFDSCxDQUFDLEVBQUMsQ0FBQztJQUNMLENBQUM7O2dCQXZPRixTQUFTLFNBQUM7b0JBQ1QsUUFBUSxFQUFFLGtDQUFrQztvQkFDNUMsNndEQUE0RDtvQkFFNUQsU0FBUyxFQUFFO3dCQUNSLFlBQVk7cUJBQ2Q7O2lCQUNGOzs7O2dCQWxCNkYsaUJBQWlCLHVCQTBHMUcsUUFBUTs2Q0FDUixNQUFNLFNBQUMsU0FBUztnREFDaEIsTUFBTSxTQUFDLGlCQUFpQjtnQkF6R0QsWUFBWSx1QkEwR25DLFFBQVE7Z0JBekdVLGlCQUFpQjtnQkFLL0IsZUFBZTtnQkFKZixzQkFBc0I7OztzQkFlNUIsV0FBVyxTQUFDLE9BQU87NkJBR25CLE1BQU07OEJBQ04sTUFBTTsrQkFFTixLQUFLO3lDQUVMLFNBQVMsU0FBQywrQkFBK0I7d0JBRXpDLEtBQUs7OEJBdUNMLFNBQVMsU0FBQyxrQkFBa0I7O0lBcUwvQiwwQ0FBQztDQUFBLEFBL09ELElBK09DO1NBdk9ZLG1DQUFtQzs7O0lBQzlDLGtEQUNxQzs7SUFFckMseURBQStDOztJQUMvQywwREFBZ0Q7O0lBRWhELDJEQUFnQzs7SUFFaEMscUVBQW9HOztJQXlDcEcsMERBQTZEOztJQUU3RCwwRUFpQkc7O0lBQ0gsK0RBUUM7O0lBQ0QscURBQWU7O0lBQ2YsZ0VBQThEOztJQUM5RCxxREFBd0M7O0lBQ3hDLDhEQUF3Qjs7SUFDeEIsNkRBQW9COztJQUNwQiw4REFBd0I7O0lBd0V4Qix5REFFQzs7SUFtRUQsMERBS0U7Ozs7O0lBL0lBLGtEQUEwQzs7Ozs7SUFDMUMsdURBQTJDOzs7OztJQUMzQyx3REFBaUQ7Ozs7O0lBQ2pELHlEQUE0Qzs7Ozs7SUFDNUMsbURBQStCOzs7OztJQUMvQixzREFBZ0M7Ozs7O0lBQ2hDLDhEQUErQzs7QUEySW5EO0lBQ0UsNkNBQ1UsVUFBd0I7UUFBeEIsZUFBVSxHQUFWLFVBQVUsQ0FBYztJQUM5QixDQUFDOzs7OztJQUVMLHVEQUFTOzs7O0lBQVQsVUFBVSxJQUFtQztRQUMzQyxJQUFJLElBQUksSUFBSSxJQUFJLENBQUMsTUFBTSxLQUFLLG1CQUFBLFdBQVcsQ0FBQyxRQUFRLEVBQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxNQUFNLEtBQUssSUFBSSxJQUFJLElBQUksQ0FBQyxNQUFNLEtBQUssU0FBUyxDQUFDLEVBQUU7WUFDOUcsT0FBTyxJQUFJLENBQUMsVUFBVSxDQUFDLFNBQVMsQ0FBQyxpQ0FBaUMsQ0FBQyxDQUFDO1NBQ3JFO2FBQU07WUFDTCxJQUFJLElBQUksSUFBSSxJQUFJLENBQUMsTUFBTSxFQUFFO2dCQUN2QixPQUFPLElBQUksQ0FBQyxVQUFVLENBQUMsU0FBUyxDQUFDLGlDQUFpQyxDQUFDLENBQUM7YUFDckU7aUJBQU07Z0JBQ0wsT0FBTyxJQUFJLENBQUMsVUFBVSxDQUFDLFNBQVMsQ0FBQyxvQ0FBb0MsQ0FBQyxDQUFDO2FBQ3hFO1NBQ0Y7SUFDSCxDQUFDO0lBQ0gsMENBQUM7QUFBRCxDQUFDLEFBaEJELElBZ0JDOzs7Ozs7O0lBZEcseURBQWdDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50LCBPbkluaXQsIEhvc3RCaW5kaW5nLCBPdXRwdXQsIEV2ZW50RW1pdHRlciwgSW5wdXQsIFZpZXdDaGlsZCwgVGVtcGxhdGVSZWYsIENoYW5nZURldGVjdG9yUmVmLCBPcHRpb25hbCwgSW5qZWN0LCBMT0NBTEVfSUQgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgVHlwZUNvbnZlcnRlciB9IGZyb20gJ0BmYXJyaXMvaWRlLXByb3BlcnR5LXBhbmVsJztcclxuaW1wb3J0IHsgQWN0aW9uT3JnYW5pemF0aW9uU2NvcGVEZXNpZ24sIEFjdGlvblNjb3BlLCBPcmdhbml6YXRpb25Qb3RlbnRpYWxPd25lciwgT3JnYW5pemF0aW9uTGV2ZWwgfSBmcm9tICcuL2FjdGlvbk9yZ2FuaXphdGlvblNjb3BlJztcclxuaW1wb3J0IHsgV0ZfTEFOR19SRVNPVVJDRVMsIFdmTG9jYWxlUGlwZSB9IGZyb20gJy4uLy4uL2kxOG4vcGlwZS93Zi1wcm9jZXNzLWVkaXRvci1sb2NhbGUucGlwZSc7XHJcbmltcG9ydCB7IEV4cHJFZGl0TW9kZSwgRXhwcmVzc2lvblNlcnZpY2UsIEluamVjdGVkVHlwZSwgVmFyRW50aXR5IH0gZnJvbSAnQGdzcC1zdmMvZXhwcmVzc2lvbic7XHJcbmltcG9ydCB7IFByb2Nlc3NEZXNpZ25lclVJU3RhdGUgfSBmcm9tICcuLi8uLi9hcHAvcHJvY2Vzcy1kZXNpZ25lci51aXN0YXRlJztcclxuaW1wb3J0IHsgQWx0ZXJuYXRpdmVQYXJ0aWNpcGFudENvbXBvbmVudCB9IGZyb20gJy4uL3BhcnRpY2lwYW50L2FsdGVybmF0aXZlLXBhcnRpY2lwYW50L2FsdGVybmF0aXZlLXBhcnRpY2lwYW50LmNvbXBvbmVudCc7XHJcbmltcG9ydCB7IE9yZ2FuaXphdGlvblBhcnRpY2lwYW50RXhwcmVzc2lvbiB9IGZyb20gJy4uLy4uL2RvbWFpbi9lbnRpdGllcy9vcmdhbml6YXRpb24tcGFydGljaXBhbnQtZXhwcmVzc2lvbic7XHJcbmltcG9ydCB7IFBhcnRpY2lwYW50LCBQYXJ0aWNpcGFudEluZm8gfSBmcm9tICcuLi9wYXJ0aWNpcGFudC9wYXJ0aWNpcGFudC5pbmZvJztcclxuaW1wb3J0IHsgTWVzc2FnZXJTZXJ2aWNlIH0gZnJvbSAnQGZhcnJpcy91aS1tZXNzYWdlcic7XHJcblxyXG5AQ29tcG9uZW50KHtcclxuICBzZWxlY3RvcjogJ2FwcC1vcmdhbml6YXRpb24tcG90ZW50aWFsLW93bmVyJyxcclxuICB0ZW1wbGF0ZVVybDogJy4vb3JnYW5pemF0aW9uLXBvdGVudGlhbC1vd25lci5jb21wb25lbnQuaHRtbCcsXHJcbiAgc3R5bGVVcmxzOiBbJy4vb3JnYW5pemF0aW9uLXBvdGVudGlhbC1vd25lci5jb21wb25lbnQuc2NzcyddLFxyXG4gIHByb3ZpZGVyczogW1xyXG4gICAgIFdmTG9jYWxlUGlwZSxcclxuICBdXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBPcmdhbml6YXRpb25Qb3RlbnRpYWxPd25lckNvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCB7XHJcbiAgQEhvc3RCaW5kaW5nKCdjbGFzcycpXHJcbiAgY2xzID0gJ2ZhcnJpcy1tYWluLWFyZWEgZmxleC1jb2x1bW4nO1xyXG5cclxuICBAT3V0cHV0KCkgY2xvc2VNb2RhbCA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xyXG4gIEBPdXRwdXQoKSBzdWJtaXRNb2RhbCA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xyXG5cclxuICBASW5wdXQoKSBlZGl0b3JQYXJhbXM6IGFueSA9IHt9O1xyXG5cclxuICBAVmlld0NoaWxkKEFsdGVybmF0aXZlUGFydGljaXBhbnRDb21wb25lbnQpIGFsdGVybmF0aXZlUGFydGljaXBhbnQ6IEFsdGVybmF0aXZlUGFydGljaXBhbnRDb21wb25lbnQ7XHJcblxyXG4gIEBJbnB1dCgpXHJcbiAgc2V0IHZhbHVlKHY6IEFjdGlvbk9yZ2FuaXphdGlvblNjb3BlRGVzaWduKSB7XHJcbiAgICB0aGlzLmFjdGlvbiA9IHYuYWN0aW9uIGFzIGFueTtcclxuICAgIGlmICh0aGlzLmFjdGlvbiA9PT0gdGhpcy5hY3Rpb25Db2xsZWN0aW9uWzJdLnZhbHVlKSB7XHJcbiAgICAgIGlmICh2LmVuYWJsZSA9PT0gbnVsbCB8fCB2LmVuYWJsZSA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgdGhpcy5lbmFibGUgPSB0cnVlO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHRoaXMuZW5hYmxlID0gdi5lbmFibGU7XHJcbiAgICAgIH1cclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuZW5hYmxlID0gdi5lbmFibGU7XHJcbiAgICB9XHJcbiAgICBpZiAodi5zY29wZSkge1xyXG4gICAgICB0aGlzLmFsdGVybmF0aXZlUGFydGljaXBhbnQucGFydGljaXBhbnQuaXNBbGxTY29wZSA9IHRydWU7XHJcbiAgICAgIGxldCBvcmdhbml6YXRpb25QYXJ0aWNpcGFudEV4cHJlc3Npb24gPSBuZXcgT3JnYW5pemF0aW9uUGFydGljaXBhbnRFeHByZXNzaW9uKCk7XHJcbiAgICAgIG9yZ2FuaXphdGlvblBhcnRpY2lwYW50RXhwcmVzc2lvbi5hY3Rpb25TY29wZSA9IHYuYWN0aW9uIGFzIGFueTtcclxuICAgICAgaWYgKHYuc2NvcGUub3JnYW5pemF0aW9uTGV2ZWwgPT09IE9yZ2FuaXphdGlvbkxldmVsLkRFRkFVTFQgJiYgdi5zY29wZS50YWcgPT09ICdleHByZXNzaW9uJykge1xyXG4gICAgICAgIG9yZ2FuaXphdGlvblBhcnRpY2lwYW50RXhwcmVzc2lvbi5vcmdhbml6YXRpb25MZXZlbCA9IE9yZ2FuaXphdGlvbkxldmVsLlZBUk9SR0FOSVpBVElPTjtcclxuICAgICAgICBvcmdhbml6YXRpb25QYXJ0aWNpcGFudEV4cHJlc3Npb24udGFnID0gdi5zY29wZS50YWc7XHJcbiAgICAgICAgdGhpcy5vcmdhbml6YXRpb25MZXZlbCA9IE9yZ2FuaXphdGlvbkxldmVsLlZBUk9SR0FOSVpBVElPTjtcclxuICAgICAgfSBlbHNlIGlmKHYuc2NvcGUub3JnYW5pemF0aW9uTGV2ZWwpe1xyXG4gICAgICAgIHRoaXMub3JnYW5pemF0aW9uTGV2ZWwgPSB2LnNjb3BlLm9yZ2FuaXphdGlvbkxldmVsO1xyXG4gICAgICB9XHJcbiAgICAgIHRoaXMuaW5jbHVkZUNoaWxkcmVuID0gdi5zY29wZS5pbmNsdWRlQ2hpbGRyZW47XHJcbiAgICAgIG9yZ2FuaXphdGlvblBhcnRpY2lwYW50RXhwcmVzc2lvbi5pbmNsdWRlQ2hpbGRyZW4gPSB2LnNjb3BlLmluY2x1ZGVDaGlsZHJlbjtcclxuICAgICAgdGhpcy5vcmdhbml6YXRpb25JZCA9IHYuc2NvcGUub3JnYW5pemF0aW9uSWQ7XHJcbiAgICAgIG9yZ2FuaXphdGlvblBhcnRpY2lwYW50RXhwcmVzc2lvbi5vcmdhbml6YXRpb25JZCA9IHYuc2NvcGUub3JnYW5pemF0aW9uSWQ7XHJcbiAgICAgIG9yZ2FuaXphdGlvblBhcnRpY2lwYW50RXhwcmVzc2lvbi5vcmdhbml6YXRpb25OYW1lID0gdGhpcy5vcmdhbml6YXRpb25MZXZlbENvbGxlY3Rpb24uZmluZChvID0+IG8udmFsdWUgPT09IHRoaXMub3JnYW5pemF0aW9uTGV2ZWwpLnRleHQ7XHJcbiAgICAgIHRoaXMuYWx0ZXJuYXRpdmVQYXJ0aWNpcGFudC5hZGRPcmdhbml6YXRpb25QYXJ0aWNpcGFudChvcmdhbml6YXRpb25QYXJ0aWNpcGFudEV4cHJlc3Npb24pO1xyXG4gICAgICBpZih2LnNjb3BlLnBhcnRpY2lwYW50SW5mbyl7XHJcbiAgICAgICAgdGhpcy5hbHRlcm5hdGl2ZVBhcnRpY2lwYW50LnBhcnRpY2lwYW50ID0gdi5zY29wZS5wYXJ0aWNpcGFudEluZm87XHJcbiAgICAgIH1lbHNlIHtcclxuICAgICAgICB0aGlzLmFsdGVybmF0aXZlUGFydGljaXBhbnQucGFydGljaXBhbnQgPSBuZXcgUGFydGljaXBhbnRJbmZvKCk7XHJcbiAgICAgIH1cclxuICAgIH1lbHNlIHtcclxuICAgICAgdGhpcy5hbHRlcm5hdGl2ZVBhcnRpY2lwYW50LnBhcnRpY2lwYW50LmlzQWxsU2NvcGUgPSBmYWxzZTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIEBWaWV3Q2hpbGQoJ2ljb25TZWxlY3RGb290ZXInKSBtb2RhbEZvb3RlcjogVGVtcGxhdGVSZWY8YW55PjtcclxuXHJcbiAgb3JnYW5pemF0aW9uTGV2ZWxDb2xsZWN0aW9uID0gW3tcclxuICAgIHZhbHVlOiAnR0xPQkFMJyxcclxuICAgIHRleHQ6IHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oJ2NvbXBvbmVudC5vcmdQb3RlbnRpYWxPd25lci5nbG9iYWwnKSxcclxuICAgIG9yZ0lkOiAnZ2xvYmFsJyxcclxuICB9LCB7XHJcbiAgICB2YWx1ZTogJ1VOSVQnLFxyXG4gICAgdGV4dDogdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybSgnY29tcG9uZW50Lm9yZ1BvdGVudGlhbE93bmVyLmN1cnJlbnRVbml0JyksXHJcbiAgICBvcmdJZDogJ2N1cnJlbnRVbml0J1xyXG4gIH0sIHtcclxuICAgIHZhbHVlOiAnREVQQVJUTUVOVCcsXHJcbiAgICB0ZXh0OiB0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKCdjb21wb25lbnQub3JnUG90ZW50aWFsT3duZXIuY3VycmVudERlcGFydG1lbnQnKSxcclxuICAgIG9yZ0lkOiAnY3VycmVudERlcGFydG1lbnQnXHJcbiAgfSxcclxuICB7XHJcbiAgICB2YWx1ZTogJ1ZBUk9SR0FOSVpBVElPTicsXHJcbiAgICB0ZXh0OiB0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKCdjb21wb25lbnQub3JnUG90ZW50aWFsT3duZXIudmFyaWFibGVPcmdhbml6YXRpb24nKSxcclxuICAgIG9yZ0lkOiAnJ1xyXG4gIH1dO1xyXG4gIGFjdGlvbkNvbGxlY3Rpb24gPSBbe1xyXG4gICAgICB2YWx1ZTogQWN0aW9uU2NvcGUuQWRkU2lnbkJlaGluZCwgbmFtZTogdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybSgnY29tcG9uZW50Lm9yZ1BvdGVudGlhbE93bmVyLmFkZFNpZ25CZWhpbmQnKVxyXG4gIH0sIHtcclxuICAgICAgdmFsdWU6IEFjdGlvblNjb3BlLkFkZFNpZ25Gcm9udCwgbmFtZTogdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybSgnY29tcG9uZW50Lm9yZ1BvdGVudGlhbE93bmVyLmFkZFNpZ25Gcm9udCcpXHJcbiAgfSwge1xyXG4gICAgICB2YWx1ZTogQWN0aW9uU2NvcGUuVHJhbnNmZXIsIG5hbWU6IHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oJ2NvbXBvbmVudC5vcmdQb3RlbnRpYWxPd25lci50cmFuc2ZlcicpXHJcbiAgfSwge1xyXG4gICAgdmFsdWU6IEFjdGlvblNjb3BlLk5vdGlmeSwgbmFtZTogdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybSgnY29tcG9uZW50Lm9yZ1BvdGVudGlhbE93bmVyLm5vdGlmeScpXHJcbn1dO1xyXG4gIGVuYWJsZSA9IGZhbHNlO1xyXG4gIG9yZ2FuaXphdGlvbkxldmVsID0gdGhpcy5vcmdhbml6YXRpb25MZXZlbENvbGxlY3Rpb25bMF0udmFsdWU7XHJcbiAgYWN0aW9uID0gdGhpcy5hY3Rpb25Db2xsZWN0aW9uWzBdLnZhbHVlO1xyXG4gIGluY2x1ZGVDaGlsZHJlbiA9IGZhbHNlO1xyXG4gIG9yZ2FuaXphdGlvbklkID0gJyc7XHJcbiAgc2hvd0NsZWFyQnV0dG9uID0gZmFsc2U7XHJcblxyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgQE9wdGlvbmFsKCkgcHJpdmF0ZSBjZHI6IENoYW5nZURldGVjdG9yUmVmLFxyXG4gICAgQEluamVjdChMT0NBTEVfSUQpIHByaXZhdGUgbG9jYWxlSWQ6IHN0cmluZyxcclxuICAgIEBJbmplY3QoV0ZfTEFOR19SRVNPVVJDRVMpIHByaXZhdGUgcmVzb3VyY2VzOiBhbnksXHJcbiAgICBAT3B0aW9uYWwoKSBwcml2YXRlIGxvY2FsZVBpcGU6IFdmTG9jYWxlUGlwZSxcclxuICAgIHByaXZhdGUgZXhwcjogRXhwcmVzc2lvblNlcnZpY2UsXHJcbiAgICBwcml2YXRlIG1lc3NhZ2U6IE1lc3NhZ2VyU2VydmljZSxcclxuICAgIHByaXZhdGUgZGVzaWduZXJVSVN0YXRlOiBQcm9jZXNzRGVzaWduZXJVSVN0YXRlXHJcbiAgKSB7XHJcbiAgICB0aGlzLmxvY2FsZVBpcGUgPSB0aGlzLmxvY2FsZVBpcGUgfHwgbmV3IFdmTG9jYWxlUGlwZShsb2NhbGVJZCwgcmVzb3VyY2VzKTtcclxuICAgfVxyXG5cclxuICBuZ09uSW5pdCgpIHtcclxuICB9XHJcblxyXG4gIGNsaWNrT0soKSB7XHJcbiAgICBpZih0aGlzLnZhbGlkYXRlKCkpe1xyXG4gICAgICBjb25zdCBzY29wZSA9IG5ldyBBY3Rpb25Pcmdhbml6YXRpb25TY29wZURlc2lnbigpO1xyXG4gICAgICBzY29wZS5lbmFibGUgPSB0aGlzLmVuYWJsZTtcclxuICAgICAgc2NvcGUuYWN0aW9uID0gdGhpcy5hY3Rpb24gYXMgYW55O1xyXG4gICAgICBpZiAodGhpcy5hbHRlcm5hdGl2ZVBhcnRpY2lwYW50LnBhcnRpY2lwYW50LmlzQWxsU2NvcGUpIHtcclxuICAgICAgICBjb25zdCBwb3RlbnRpYWwgPSBuZXcgT3JnYW5pemF0aW9uUG90ZW50aWFsT3duZXIoKTtcclxuICAgICAgICBwb3RlbnRpYWwuYWN0aW9uU2NvcGUgPSB0aGlzLmFjdGlvbjtcclxuICAgICAgICAvLyBwb3RlbnRpYWwub3JnYW5pemF0aW9uTGV2ZWwgPSB0aGlzLm9yZ2FuaXphdGlvbkxldmVsIGFzIE9yZ2FuaXphdGlvbkxldmVsO1xyXG4gICAgICAgIC8vIHBvdGVudGlhbC5vcmdhbml6YXRpb25JZCA9IHRoaXMub3JnYW5pemF0aW9uTGV2ZWxDb2xsZWN0aW9uLmZpbmQobyA9PiBvLnZhbHVlID09PSB0aGlzLm9yZ2FuaXphdGlvbkxldmVsKS5vcmdJZCB8fCB0aGlzLm9yZ2FuaXphdGlvbklkO1xyXG4gICAgICAgIC8vIHBvdGVudGlhbC5vcmdhbml6YXRpb25OYW1lID0gdGhpcy5vcmdhbml6YXRpb25MZXZlbENvbGxlY3Rpb24uZmluZChvID0+IG8udmFsdWUgPT09IHRoaXMub3JnYW5pemF0aW9uTGV2ZWwpLnRleHQ7XHJcbiAgICAgICAgLy8gcG90ZW50aWFsLmluY2x1ZGVDaGlsZHJlbiA9IHRoaXMuaW5jbHVkZUNoaWxkcmVuO1xyXG4gICAgICAgIC8vIGlmIChwb3RlbnRpYWwub3JnYW5pemF0aW9uTGV2ZWwgPT09IE9yZ2FuaXphdGlvbkxldmVsLlZBUk9SR0FOSVpBVElPTikge1xyXG4gICAgICAgIC8vICAgcG90ZW50aWFsLnRhZyA9ICdleHByZXNzaW9uJztcclxuICAgICAgICAvLyAgIHBvdGVudGlhbC5vcmdhbml6YXRpb25MZXZlbCA9IE9yZ2FuaXphdGlvbkxldmVsLkRFRkFVTFQ7XHJcbiAgICAgICAgLy8gfSBlbHNlIHtcclxuICAgICAgICAvLyAgIHBvdGVudGlhbC50YWcgPSAndmFyaWFibGUnO1xyXG4gICAgICAgIC8vIH1cclxuICAgICAgICBzY29wZS5zY29wZSA9IHBvdGVudGlhbCBhcyBhbnk7XHJcbiAgICAgICAgc2NvcGUuc2NvcGUucGFydGljaXBhbnRJbmZvID0gdGhpcy5hbHRlcm5hdGl2ZVBhcnRpY2lwYW50LnBhcnRpY2lwYW50O1xyXG4gICAgICB9XHJcbiAgICAgIGNvbnN0IG9iamVjdCA9IHsgdmFsdWU6IHNjb3BlLCBwYXJhbWV0ZXJzOiBudWxsIH07XHJcbiAgICAgIHRoaXMuc3VibWl0TW9kYWwuZW1pdChvYmplY3QpO1xyXG4gICAgfVxyXG4gIH1cclxuICBjbGlja0NhbmNlbCgpIHtcclxuICAgIHRoaXMuY2xvc2VNb2RhbC5lbWl0KCk7XHJcbiAgfVxyXG5cclxuICB2YWxpZGF0ZSgpIHtcclxuICAgIGlmKHRoaXMuYWx0ZXJuYXRpdmVQYXJ0aWNpcGFudC5wYXJ0aWNpcGFudC5pc0FsbFNjb3BlICYmIFxyXG4gICAgICAoIXRoaXMuYWx0ZXJuYXRpdmVQYXJ0aWNpcGFudC5wYXJ0aWNpcGFudC5wb3RlbnRpYWxPd25lckxpc3QgfHwgdGhpcy5hbHRlcm5hdGl2ZVBhcnRpY2lwYW50LnBhcnRpY2lwYW50LnBvdGVudGlhbE93bmVyTGlzdC5sZW5ndGggPD0gMCkpIHtcclxuICAgICAgICB0aGlzLm1lc3NhZ2UuaW5mbyh0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKCdjb21wb25lbnQub3JnUG90ZW50aWFsT3duZXIudHVybk9mZlByb21wdCcpKTtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgIH1lbHNlIHtcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgfVxyXG4gIH1cclxuICB2YWx1ZUNoYW5nZShldmVudDogYW55KSB7XHJcbiAgICBzd2l0Y2ggKGV2ZW50LnZhbHVlKSB7XHJcbiAgICAgIGNhc2UgdGhpcy5vcmdhbml6YXRpb25MZXZlbENvbGxlY3Rpb25bMF0udmFsdWU6XHJcbiAgICAgICAgdGhpcy5pbmNsdWRlQ2hpbGRyZW4gPSBmYWxzZTtcclxuICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSB0aGlzLm9yZ2FuaXphdGlvbkxldmVsQ29sbGVjdGlvblsxXS52YWx1ZTpcclxuICAgICAgICB0aGlzLmluY2x1ZGVDaGlsZHJlbiA9IHRydWU7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgdGhpcy5vcmdhbml6YXRpb25MZXZlbENvbGxlY3Rpb25bMl0udmFsdWU6XHJcbiAgICAgICAgdGhpcy5pbmNsdWRlQ2hpbGRyZW4gPSBmYWxzZTtcclxuICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSB0aGlzLm9yZ2FuaXphdGlvbkxldmVsQ29sbGVjdGlvblszXS52YWx1ZTpcclxuICAgICAgICB0aGlzLmluY2x1ZGVDaGlsZHJlbiA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5vcmdhbml6YXRpb25JZCA9ICcnO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgfVxyXG4gIH1cclxuICBhY3Rpb25OYW1lID0gKCkgPT4ge1xyXG4gICAgcmV0dXJuIHRoaXMuYWN0aW9uQ29sbGVjdGlvbi5maW5kKGEgPT4gYS52YWx1ZSA9PT0gdGhpcy5hY3Rpb24pLm5hbWU7XHJcbiAgfVxyXG4gIGNsZWFyKCRldmVudCkge1xyXG4gICAgdGhpcy5vcmdhbml6YXRpb25JZCA9ICcnO1xyXG4gIH1cclxuICBzZWxlY3RWYWx1ZShkYXRhOiBhbnkpIHtcclxuICAgIHRoaXMuc2hvd0V4cHJIZWxwKCk7XHJcbiAgfVxyXG5cclxuICBzaG93RXhwckhlbHAoKSB7XHJcbiAgICBjb25zdCBjb250ZXh0ID0gbmV3IEFycmF5PFZhckVudGl0eT4oKTtcclxuICAgIC8vIGlmKHRoaXMuZXhwci5leHByRW50aXR5LmNvbnRleHRFbnRpdGllcy5maW5kKHggPT4geC5rZXkgPT09ICdDdXJyZW50TGFuZ3VhZ2UnKSkge1xyXG4gICAgLy8gICBjb250ZXh0LnB1c2godGhpcy5leHByLmV4cHJFbnRpdHkuY29udGV4dEVudGl0aWVzLmZpbmQoeCA9PiB4LmtleSA9PT0gJ0N1cnJlbnRMYW5ndWFnZScpKTtcclxuICAgIC8vIH1cclxuICAgIC8vIHRoaXMuZXhwci5jbGVhckNvbnRleHQoKTtcclxuICAgIHRoaXMuZXhwci5zZXRFZGl0UGF0dGVybihFeHByRWRpdE1vZGUuQWR2YW5jZWQpO1xyXG4gICAgaWYgKHRoaXMuZGVzaWduZXJVSVN0YXRlLnNjaGVtYXMubGVuZ3RoID4gMCkge1xyXG4gICAgICBmb3IgKGNvbnN0IHNjaGVtYSBvZiB0aGlzLmRlc2lnbmVyVUlTdGF0ZS5zY2hlbWFzKSB7XHJcbiAgICAgICAgdGhpcy5leHByLmFkZFNjaGVtYSgnU2NoZW1hJywgc2NoZW1hKTtcclxuICAgICAgfVxyXG4gICAgICBpZiAodGhpcy5kZXNpZ25lclVJU3RhdGUuc2NoZW1hc1swXS5lbnRpdHlUeXBlcyAmJiB0aGlzLmRlc2lnbmVyVUlTdGF0ZS5zY2hlbWFzWzBdLmVudGl0eVR5cGVzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICBjb25zdCBlbnRpdHlUeXBlID0gdGhpcy5kZXNpZ25lclVJU3RhdGUuc2NoZW1hc1swXS5lbnRpdHlUeXBlc1swXTtcclxuICAgICAgICB0aGlzLmV4cHIuYWRkSW5qZWN0ZWRFbnRpdHkoZW50aXR5VHlwZS5uYW1lLCAnU2NoZW1hJyxcclxuICAgICAgICAgIGVudGl0eVR5cGUubmFtZSwgSW5qZWN0ZWRUeXBlLkVudGl0eVR5cGUpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBpZiAodGhpcy5kZXNpZ25lclVJU3RhdGUucGFydGljaXBhbnRDb250ZXh0Lmxlbmd0aCA+IDApIHtcclxuICAgICAgZm9yIChjb25zdCB2YXJpYWJsZSBvZiB0aGlzLmRlc2lnbmVyVUlTdGF0ZS5wYXJ0aWNpcGFudENvbnRleHQpIHtcclxuICAgICAgICBjb250ZXh0LnB1c2godmFyaWFibGUpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBpZiAodGhpcy5kZXNpZ25lclVJU3RhdGUucHJvY2Vzc1ZhcmlhYmxlQ29udGV4dC5sZW5ndGggPiAwKSB7XHJcbiAgICAgIGZvciAoY29uc3QgdmFyaWFibGUgb2YgdGhpcy5kZXNpZ25lclVJU3RhdGUucHJvY2Vzc1ZhcmlhYmxlQ29udGV4dCkge1xyXG4gICAgICAgIGlmICghY29udGV4dC5zb21lKGMgPT4gYy5rZXkgPT09IHZhcmlhYmxlLmtleSkpIHtcclxuICAgICAgICAgIGNvbnRleHQucHVzaCh2YXJpYWJsZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBpZiAodGhpcy5kZXNpZ25lclVJU3RhdGUuc3ViQWN0aXZpdHlDb250ZXh0Lmxlbmd0aCA+IDApIHtcclxuICAgICAgZm9yIChjb25zdCB2YXJpYWJsZSBvZiB0aGlzLmRlc2lnbmVyVUlTdGF0ZS5zdWJBY3Rpdml0eUNvbnRleHQpIHtcclxuICAgICAgICBpZiAoIWNvbnRleHQuc29tZShjID0+IGMua2V5ID09PSB2YXJpYWJsZS5rZXkpKSB7XHJcbiAgICAgICAgICBjb250ZXh0LnB1c2godmFyaWFibGUpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgaWYgKGNvbnRleHQubGVuZ3RoID4gMCkge1xyXG4gICAgICBmb3IgKGNvbnN0IHYgb2YgY29udGV4dCkge1xyXG4gICAgICAgIHRoaXMuZXhwci5hZGRDb250ZXh0KHYpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICAvLyDpooTnva7ooajovr7lvI/lsZXnpLrmlofmnKxcclxuICAgIGlmICh0aGlzLm9yZ2FuaXphdGlvbklkKSB7XHJcbiAgICAgIHRoaXMuZXhwci5hZGRFeHByZXNzaW9uVGV4dCh0aGlzLm9yZ2FuaXphdGlvbklkKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuZXhwci5hZGRFeHByZXNzaW9uVGV4dCgnJyk7XHJcbiAgICB9XHJcbiAgICB0aGlzLmV4cHIuYnVpbGRFeHByZXNzaW9uKCkudGhlbigoZXhwcmVzc2lvbmluZm86IHN0cmluZykgPT4ge1xyXG4gICAgICBpZiAoZXhwcmVzc2lvbmluZm8pIHtcclxuICAgICAgICB0aGlzLm9yZ2FuaXphdGlvbklkID0gZXhwcmVzc2lvbmluZm87XHJcbiAgICAgICAgdGhpcy5vcmdhbml6YXRpb25MZXZlbENvbGxlY3Rpb25bM10ub3JnSWQgPSBleHByZXNzaW9uaW5mbztcclxuICAgICAgfVxyXG4gICAgICAvL+eCueWHu+ehruWumuWQju+8jOWOu+mZpOihqOi+vuW8j+mHjOmdoueahOaWsOWinueahOS4iuS4i+aWh+WPmOmHj1xyXG4gICAgICBpZihjb250ZXh0Lmxlbmd0aCA+IDApIHtcclxuICAgICAgICB0aGlzLmV4cHIuZXhwckVudGl0eS5jb250ZXh0RW50aXRpZXMgPSB0aGlzLmV4cHIuZXhwckVudGl0eS5jb250ZXh0RW50aXRpZXMuZmlsdGVyKHggPT4gIWNvbnRleHQuc29tZSh5ID0+IHkua2V5ID09PSB4LmtleSkpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIG1vZGFsQ29uZmlnID0ge1xyXG4gICAgdGl0bGU6IHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oJ2NvbXBvbmVudC5vcmdQb3RlbnRpYWxPd25lci5vcHRpb25TZXR0aW5ncycpLFxyXG4gICAgd2lkdGg6IDc2MCxcclxuICAgIGhlaWdodDogNTA2LFxyXG4gICAgc2hvd0J1dHRvbnM6IHRydWVcclxuICB9O1xyXG59XHJcbmV4cG9ydCBjbGFzcyBPcmdhbml6YXRpb25Qb3RlbnRpYWxPd25lckNvbnZlcnRlciBpbXBsZW1lbnRzIFR5cGVDb252ZXJ0ZXIge1xyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgcHJpdmF0ZSBsb2NhbGVQaXBlOiBXZkxvY2FsZVBpcGVcclxuICApIHsgfVxyXG5cclxuICBjb252ZXJ0VG8oZGF0YTogQWN0aW9uT3JnYW5pemF0aW9uU2NvcGVEZXNpZ24pOiBzdHJpbmcge1xyXG4gICAgaWYgKGRhdGEgJiYgZGF0YS5hY3Rpb24gPT09IEFjdGlvblNjb3BlLlRyYW5zZmVyIGFzIGFueSAmJiAoZGF0YS5lbmFibGUgPT09IG51bGwgfHwgZGF0YS5lbmFibGUgPT09IHVuZGVmaW5lZCkpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oXCJjb21wb25lbnQub3JnUG90ZW50aWFsT3duZXIuc2V0XCIpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgaWYgKGRhdGEgJiYgZGF0YS5lbmFibGUpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybShcImNvbXBvbmVudC5vcmdQb3RlbnRpYWxPd25lci5zZXRcIik7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oXCJjb21wb25lbnQub3JnUG90ZW50aWFsT3duZXIubm90U2V0XCIpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcbiJdfQ==