/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { Component, HostBinding, Output, EventEmitter, TemplateRef, Input, ViewChild, ComponentFactoryResolver, Injector, Inject, Optional, ChangeDetectorRef, LOCALE_ID } from '@angular/core';
import { ActivityComponentRepository } from './activity-component.repository';
import { ActivityComponentUIState } from './activity-component.uistate';
import { ActivityComponentViewModel } from './activity-component.viewmodel';
import { BizComponentEntity } from '../../domain/entities/biz-component.entity';
import { ProcessDesignerUIState } from '../../app/process-designer.uistate';
import { ExprEditMode, ExpressionService, InjectedType } from '@gsp-svc/expression';
import { BsModalService } from '@farris/ui-modal';
import { CommonComponentUiRTService } from '@gsp-cmp/ccmp-ui';
import { DatagridComponent } from '@farris/ui-datagrid';
import { forkJoin, of } from 'rxjs';
import { EditorTypes } from '@farris/ui-datagrid-editors';
import { MessagerService } from '@farris/ui-messager';
import { EditComponentParameterComponent } from '../edit-component-parameter/edit-component-parameter.component';
import { WF_LANG_RESOURCES, WfLocalePipe } from '../../i18n/pipe/wf-process-editor-locale.pipe';
var ActivityComponentComponent = /** @class */ (function () {
    function ActivityComponentComponent(uistate, viewModel, designerState, expr, resolver, injector, modalService, componentService, repository, message, cdr, localeId, resources, localePipe) {
        this.uistate = uistate;
        this.viewModel = viewModel;
        this.designerState = designerState;
        this.expr = expr;
        this.resolver = resolver;
        this.injector = injector;
        this.modalService = modalService;
        this.componentService = componentService;
        this.repository = repository;
        this.message = message;
        this.cdr = cdr;
        this.localeId = localeId;
        this.resources = resources;
        this.localePipe = localePipe;
        this.cls = 'farris-main-area flex-column';
        this.closeModal = new EventEmitter();
        this.submitModal = new EventEmitter();
        this.editorParams = {};
        this.exBizTips = false;
        this.modalConfig = {
            title: this.localePipe.transform('component.activityComponent.component'),
            width: 960,
            height: 506,
            showButtons: true
        };
        this.buttonGroupData = [
            {
                id: 'edit',
                text: this.localePipe.transform('component.activityComponent.edit'),
            },
            {
                id: 'deleteRow',
                text: this.localePipe.transform('component.activityComponent.deleteRow'),
            }
        ];
        this.editState = 'new'; // 编辑状态，用于区分是新增还是编辑  new | edit
        // 编辑状态，用于区分是新增还是编辑  new | edit
        this.isPreExternalProcessCmps = false;
        this.columns = [];
        this.paramColumns = [];
        this.paramAfterEdit = (/**
         * @param {?} rowIndex
         * @param {?} rowData
         * @param {?=} column
         * @return {?}
         */
        function (rowIndex, rowData, column) {
            return of(true);
        });
        this.localePipe = this.localePipe || new WfLocalePipe(localeId, resources);
    }
    Object.defineProperty(ActivityComponentComponent.prototype, "value", {
        set: /**
         * @param {?} cpts
         * @return {?}
         */
        function (cpts) {
            var _this = this;
            var e_1, _a;
            if (cpts && cpts.length > 0) {
                /** @type {?} */
                var metaDataIdList = new Array();
                try {
                    for (var cpts_1 = tslib_1.__values(cpts), cpts_1_1 = cpts_1.next(); !cpts_1_1.done; cpts_1_1 = cpts_1.next()) {
                        var cmp = cpts_1_1.value;
                        if (metaDataIdList.indexOf(cmp.metadataId) == -1) {
                            metaDataIdList.push(cmp.metadataId);
                        }
                    }
                }
                catch (e_1_1) { e_1 = { error: e_1_1 }; }
                finally {
                    try {
                        if (cpts_1_1 && !cpts_1_1.done && (_a = cpts_1.return)) _a.call(cpts_1);
                    }
                    finally { if (e_1) throw e_1.error; }
                }
                if (metaDataIdList.length > 0) {
                    forkJoin(metaDataIdList.map((/**
                     * @param {?} metaDataId
                     * @return {?}
                     */
                    function (metaDataId) { return _this.designerState.getHelpMetaData(metaDataId, ''); }))).subscribe((/**
                     * @param {?} cmpMetas
                     * @return {?}
                     */
                    function (cmpMetas) {
                        var e_2, _a;
                        var _loop_1 = function (cpt) {
                            /** @type {?} */
                            var bizComponent = new BizComponentEntity(cpt.name, cpt.metadataId, cpt.methodCode);
                            bizComponent.executionTime = cpt.executionTime,
                                bizComponent.id = cpt.id;
                            bizComponent.isForCompensation = cpt.isForCompensation;
                            bizComponent.actualParameters = new Array();
                            bizComponent.scopeType = cpt.scopeType || null;
                            /** @type {?} */
                            var meta = cmpMetas.find((/**
                             * @param {?} m
                             * @return {?}
                             */
                            function (m) { return m.id === cpt.metadataId; }));
                            /** @type {?} */
                            var content = JSON.parse(meta.content);
                            /** @type {?} */
                            var operation = content.operations.find((/**
                             * @param {?} o
                             * @return {?}
                             */
                            function (o) { return o.code === cpt.methodCode; }));
                            if (operation) {
                                bizComponent.actualParameters = cpt.actualParameters.map((/**
                                 * @param {?} a
                                 * @return {?}
                                 */
                                function (a) {
                                    /** @type {?} */
                                    var p = operation.parameters.find((/**
                                     * @param {?} i
                                     * @return {?}
                                     */
                                    function (i) { return i.code === a.code; }));
                                    if (p) {
                                        return {
                                            code: a.code,
                                            name: a.name,
                                            value: a.value,
                                            required: a.code.toLowerCase() === 'wfcontext' ? false : p.required
                                        };
                                    }
                                    else {
                                        console.error(_this.localePipe.transform('component.activityComponent.method') + cpt.methodCode + _this.localePipe.transform('component.activityComponent.inconsistentParameters'));
                                        return {
                                            code: a.code,
                                            name: a.name,
                                            value: a.value,
                                            required: false
                                        };
                                    }
                                }));
                            }
                            else {
                                console.error(_this.localePipe.transform('component.activityComponent.longerExists') + cpt.methodCode + _this.localePipe.transform('component.activityComponent.pleaseCheck'));
                            }
                            _this.uistate.components.push(bizComponent);
                        };
                        try {
                            for (var cpts_2 = tslib_1.__values(cpts), cpts_2_1 = cpts_2.next(); !cpts_2_1.done; cpts_2_1 = cpts_2.next()) {
                                var cpt = cpts_2_1.value;
                                _loop_1(cpt);
                            }
                        }
                        catch (e_2_1) { e_2 = { error: e_2_1 }; }
                        finally {
                            try {
                                if (cpts_2_1 && !cpts_2_1.done && (_a = cpts_2.return)) _a.call(cpts_2);
                            }
                            finally { if (e_2) throw e_2.error; }
                        }
                    }));
                }
            }
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    ActivityComponentComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        // 2023-5-25 网速慢的时候会导致加载不出来流程构件，因此加个延时
        setTimeout((/**
         * @return {?}
         */
        function () {
            _this.restart();
        }), 300);
    };
    /**
     * @return {?}
     */
    ActivityComponentComponent.prototype.restart = /**
     * @return {?}
     */
    function () {
        var _this = this;
        if (this.designerState.startMode === 'EXTERNAL_PROCESS') {
            this.repository.getBizCmp((/**
             * @param {?} cmps
             * @return {?}
             */
            function (cmps) {
                var e_3, _a;
                if (cmps && cmps.length > 0) {
                    try {
                        // 此处标记有外部流程通用构件
                        for (var cmps_1 = tslib_1.__values(cmps), cmps_1_1 = cmps_1.next(); !cmps_1_1.done; cmps_1_1 = cmps_1.next()) {
                            var c = cmps_1_1.value;
                            if (c.scopeType === 'ExternalProcess') {
                                _this.exBizTips = true;
                                break;
                            }
                        }
                    }
                    catch (e_3_1) { e_3 = { error: e_3_1 }; }
                    finally {
                        try {
                            if (cmps_1_1 && !cmps_1_1.done && (_a = cmps_1.return)) _a.call(cmps_1);
                        }
                        finally { if (e_3) throw e_3.error; }
                    }
                }
            }));
        }
        this.location = this.editorParams.location;
        if (this.location === 'activity') {
            this.uistate.executionCollection = this.uistate.activityCollection;
            this.columns = [
                {
                    field: 'executionTime', width: 100, title: this.localePipe.transform('component.activityComponent.executionTime'),
                    editor: {
                        type: EditorTypes.COMBOLIST,
                        options: { data: this.uistate.executionCollection, groupField: 'text', valueField: 'value', textField: 'text', idField: 'value', panelHeight: 'auto' }
                    },
                    formatter: (/**
                     * @param {?} v
                     * @param {?} d
                     * @param {?} i
                     * @return {?}
                     */
                    function (v, d, i) {
                        if (v) {
                            return _this.uistate.executionCollection.find((/**
                             * @param {?} item
                             * @return {?}
                             */
                            function (item) { return item.value === v; })).text;
                        }
                        else {
                            return '';
                        }
                    }),
                    validators: [
                        { type: 'required', messager: '必填' }
                    ]
                },
                {
                    field: 'name', width: 100, title: this.localePipe.transform('component.activityComponent.cmpName')
                },
                { field: 'metadataId', width: 100, title: this.localePipe.transform('component.activityComponent.metadataId') },
                { field: 'methodCode', width: 100, title: this.localePipe.transform('component.activityComponent.methodCode') },
                {
                    field: 'isForCompensation', width: 50, title: this.localePipe.transform('component.activityComponent.isForCompensation'),
                    editor: { type: EditorTypes.SWITCH, options: {} },
                    formatter: { type: 'boolean', options: { trueText: this.localePipe.transform('component.activityComponent.yes'), falseText: this.localePipe.transform('component.activityComponent.no') } }
                },
                { title: this.localePipe.transform('component.activityComponent.operate'), width: 70, template: this.btnTemplate }
            ];
        }
        else if (this.location === 'autoActivity') {
            this.columns = [
                {
                    field: 'name', width: 100, title: this.localePipe.transform('component.activityComponent.cmpName')
                },
                { field: 'metadataId', width: 100, title: this.localePipe.transform('component.activityComponent.metadataId') },
                { field: 'methodCode', width: 100, title: this.localePipe.transform('component.activityComponent.methodCode') },
                {
                    field: 'isForCompensation', width: 50, title: this.localePipe.transform('component.activityComponent.isForCompensation'),
                    editor: { type: EditorTypes.SWITCH, options: {} },
                    formatter: { type: 'boolean', options: { trueText: this.localePipe.transform('component.activityComponent.yes'), falseText: this.localePipe.transform('component.activityComponent.no') } }
                },
                { title: this.localePipe.transform('component.activityComponent.operate'), width: 70, template: this.btnTemplate }
            ];
        }
        else {
            this.columns = [
                {
                    field: 'executionTime', width: 100, title: this.localePipe.transform('component.activityComponent.executionTime'),
                    editor: {
                        type: EditorTypes.COMBOLIST,
                        options: { data: this.uistate.executionCollection, groupField: 'text', valueField: 'value', textField: 'text', idField: 'value', panelHeight: 'auto' }
                    },
                    formatter: (/**
                     * @param {?} v
                     * @param {?} d
                     * @param {?} i
                     * @return {?}
                     */
                    function (v, d, i) {
                        if (v) {
                            return _this.uistate.executionCollection.find((/**
                             * @param {?} item
                             * @return {?}
                             */
                            function (item) { return item.value === v; })).text;
                        }
                        else {
                            return '';
                        }
                    }),
                    validators: [
                        { type: 'required', messager: '必填' }
                    ]
                },
                {
                    field: 'name', width: 100, title: this.localePipe.transform('component.activityComponent.cmpName')
                },
                { field: 'metadataId', width: 100, title: this.localePipe.transform('component.activityComponent.metadataId') },
                { field: 'methodCode', width: 100, title: this.localePipe.transform('component.activityComponent.methodCode') },
                { title: this.localePipe.transform('component.activityComponent.operate'), width: 70, template: this.btnTemplate }
            ];
        }
        if (this.uistate.components && this.uistate.components.length > 0) {
            this.cmplist.selectRow(this.uistate.components[0].id, true);
        }
        this.paramColumns = [
            { field: 'code', width: 50, title: this.localePipe.transform('component.activityComponent.code') },
            { field: 'name', width: 50, title: this.localePipe.transform('component.activityComponent.name') },
            {
                field: 'value', width: 100, title: this.localePipe.transform('component.activityComponent.value'),
                editor: {
                    type: 'input-group',
                    options: {
                        groupText: '<i class="f-icon f-icon-lookup"></i>',
                        editable: false,
                        clickHandle: (/**
                         * @param {?} e
                         * @return {?}
                         */
                        function (e) {
                            e.formControl.setValue(e.instance.value ? e.instance.value : '');
                            _this.showExprHelp(e);
                        }),
                        clear: (/**
                         * @param {?} e
                         * @return {?}
                         */
                        function (e) {
                            console.log('clear', e);
                        })
                    }
                }
            }
        ];
        // 选中当前行
        this.repository.subject.subscribe((/**
         * @param {?} cmp
         * @return {?}
         */
        function (cmp) {
            _this.cmplist.loadData(_this.uistate.components);
            if (cmp) {
                _this.cmplist.selectRow(cmp.id, true);
            }
            else {
                _this.uistate.curComponent = null;
            }
        }));
    };
    /**
     * @return {?}
     */
    ActivityComponentComponent.prototype.ngAfterViewInit = /**
     * @return {?}
     */
    function () {
        if (this.uistate.components && this.uistate.components.length > 0) {
            this.cmplist.selectRow(this.uistate.components[0].id, true);
        }
    };
    /**
     * @return {?}
     */
    ActivityComponentComponent.prototype.edit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.editState = 'edit';
        /** @type {?} */
        var compFactory = this.resolver.resolveComponentFactory(EditComponentParameterComponent);
        /** @type {?} */
        var compRef = compFactory.create(this.injector);
        /** @type {?} */
        var modalConfig = {
            title: this.localePipe.transform('component.activityComponent.editComponent'),
            width: 700,
            height: 400,
            buttons: compRef.instance.editFooter,
            showButtons: true,
            initialState: {
                curComponent: JSON.parse(JSON.stringify(this.uistate.curComponent))
            }
        };
        /** @type {?} */
        var editDialog = this.modalService.show(compRef, modalConfig);
        compRef.instance.canEdit = false;
        compRef.instance.editState = this.editState;
        compRef.instance.location = this.location;
        compRef.instance.executionTimingList = this.uistate.executionCollection;
        // compRef.instance.curComponent = JSON.parse(JSON.stringify(this.uistate.curComponent));
        compRef.instance.submitEmitter.subscribe((/**
         * @param {?} cmp
         * @return {?}
         */
        function (cmp) {
            /** @type {?} */
            var i = _this.uistate.components.findIndex((/**
             * @param {?} item
             * @return {?}
             */
            function (item) { return item.id === cmp.id; }));
            _this.uistate.components[i] = cmp;
            _this.cmplist.loadData(_this.uistate.components);
            editDialog.close();
        }));
        compRef.instance.closeEmitter.subscribe((/**
         * @param {?} re
         * @return {?}
         */
        function (re) {
            editDialog.close();
        }));
        setTimeout((/**
         * @return {?}
         */
        function () {
            compRef.instance.cd.detectChanges();
        }));
    };
    /**
     * @return {?}
     */
    ActivityComponentComponent.prototype.deleteRow = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.message.confirm(this.localePipe.transform('component.activityComponent.confirmDelete')).subscribe((/**
         * @param {?} v
         * @return {?}
         */
        function (v) {
            if (v) {
                _this.closeCellEdit();
                _this.viewModel.deleteRow();
                _this.cmplist.loadData(_this.uistate.components);
            }
        }));
    };
    /**
     * @return {?}
     */
    ActivityComponentComponent.prototype.moveUp = /**
     * @return {?}
     */
    function () {
        if (!this.uistate.curComponent) {
            this.message.info(this.localePipe.transform('component.activityComponent.curComponent'));
            return;
        }
        /** @type {?} */
        var curCmpId = this.uistate.curComponent.id;
        /** @type {?} */
        var i = this.uistate.components.findIndex((/**
         * @param {?} c
         * @return {?}
         */
        function (c) { return c.id === curCmpId; }));
        if (i === 0) {
            return;
        }
        this.repository.swapArray(this.uistate.components, i, i - 1);
        this.cmplist.loadData(this.uistate.components);
        this.cmplist.selectRow(curCmpId, true);
    };
    /**
     * @return {?}
     */
    ActivityComponentComponent.prototype.moveDown = /**
     * @return {?}
     */
    function () {
        if (!this.uistate.curComponent) {
            this.message.info(this.localePipe.transform('component.activityComponent.curComponent'));
            return;
        }
        /** @type {?} */
        var curCmpId = this.uistate.curComponent.id;
        /** @type {?} */
        var i = this.uistate.components.findIndex((/**
         * @param {?} c
         * @return {?}
         */
        function (c) { return c.id === curCmpId; }));
        if (i === this.uistate.components.length - 1) {
            return;
        }
        this.repository.swapArray(this.uistate.components, i, i + 1);
        this.cmplist.loadData(this.uistate.components);
        this.cmplist.selectRow(curCmpId, true);
    };
    /**
     * @param {?} buttonId
     * @param {?} ctx
     * @return {?}
     */
    ActivityComponentComponent.prototype.clickAction = /**
     * @param {?} buttonId
     * @param {?} ctx
     * @return {?}
     */
    function (buttonId, ctx) {
        this.uistate.curComponent = ctx.rowData;
        switch (buttonId) {
            case 'edit':
                this.edit();
                break;
            case 'deleteRow':
                this.deleteRow();
                break;
        }
    };
    /**
     * @return {?}
     */
    ActivityComponentComponent.prototype.clickOK = /**
     * @return {?}
     */
    function () {
        this.closeCellEdit();
        if (this.validator()) {
            /** @type {?} */
            var object = { value: this.uistate.components, parameters: null };
            this.submitModal.emit(object);
        }
    };
    /**
     * @return {?}
     */
    ActivityComponentComponent.prototype.clickCancel = /**
     * @return {?}
     */
    function () {
        this.closeModal.emit();
    };
    /**
     * @return {?}
     */
    ActivityComponentComponent.prototype.componentSelect = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.editState = 'new';
        /** @type {?} */
        var compFactory = this.resolver.resolveComponentFactory(EditComponentParameterComponent);
        /** @type {?} */
        var compRef = compFactory.create(this.injector);
        /** @type {?} */
        var modalConfig = {
            title: this.localePipe.transform('component.activityComponent.newComponent'),
            width: 700,
            height: 400,
            buttons: compRef.instance.editFooter,
            showButtons: true
        };
        /** @type {?} */
        var editDialog = this.modalService.show(compRef, modalConfig);
        compRef.instance.canEdit = true;
        compRef.instance.editState = this.editState;
        compRef.instance.location = this.location;
        compRef.instance.executionTimingList = this.uistate.executionCollection;
        compRef.instance.curComponent = new BizComponentEntity();
        compRef.instance.submitEmitter.subscribe((/**
         * @param {?} cmp
         * @return {?}
         */
        function (cmp) {
            _this.uistate.components.push(cmp);
            _this.cmplist.loadData(_this.uistate.components);
            editDialog.close();
        }));
        compRef.instance.closeEmitter.subscribe((/**
         * @param {?} re
         * @return {?}
         */
        function (re) {
            editDialog.close();
        }));
        setTimeout((/**
         * @return {?}
         */
        function () {
            compRef.instance.cd.detectChanges();
        }));
    };
    /**
     * 取数构件帮助new
     */
    /**
     * 取数构件帮助new
     * @param {?} metadataId
     * @param {?} sessionId
     * @return {?}
     */
    ActivityComponentComponent.prototype.openComponentSelectorNew = /**
     * 取数构件帮助new
     * @param {?} metadataId
     * @param {?} sessionId
     * @return {?}
     */
    function (metadataId, sessionId) {
        var _this = this;
        this.componentService.openSelector(metadataId, sessionId).subscribe((/**
         * @param {?} selectorResult
         * @return {?}
         */
        function (selectorResult) {
            selectorResult.confirmEvent.subscribe((/**
             * @param {?} result
             * @return {?}
             */
            function (result) {
                _this.viewModel.componentSelect(result);
            }));
        }));
    };
    /**
     * @param {?} e
     * @return {?}
     */
    ActivityComponentComponent.prototype.showExprHelp = /**
     * @param {?} e
     * @return {?}
     */
    function (e) {
        var _this = this;
        var e_4, _a, e_5, _b, e_6, _c, e_7, _d;
        /** @type {?} */
        var context = new Array();
        // if(this.expr.exprEntity.contextEntities.find(x => x.key === 'CurrentLanguage')) {
        //   context.push(this.expr.exprEntity.contextEntities.find(x => x.key === 'CurrentLanguage'));
        // }
        // this.expr.clearContext();
        if (this.designerState.schemas.length > 0) {
            try {
                for (var _e = tslib_1.__values(this.designerState.schemas), _f = _e.next(); !_f.done; _f = _e.next()) {
                    var schema = _f.value;
                    this.expr.addSchema('Schema', schema);
                }
            }
            catch (e_4_1) { e_4 = { error: e_4_1 }; }
            finally {
                try {
                    if (_f && !_f.done && (_a = _e.return)) _a.call(_e);
                }
                finally { if (e_4) throw e_4.error; }
            }
            if (this.designerState.schemas[0].entityTypes && this.designerState.schemas[0].entityTypes.length > 0) {
                /** @type {?} */
                var entityType = this.designerState.schemas[0].entityTypes[0];
                this.expr.addInjectedEntity(entityType.name, 'Schema', entityType.name, InjectedType.EntityType);
            }
        }
        context = this.designerState.addContext(context);
        if (this.location === 'activity') {
            var _loop_2 = function (variable) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    context.push(variable);
                }
            };
            try {
                for (var _g = tslib_1.__values(this.designerState.activityComponentContext), _h = _g.next(); !_h.done; _h = _g.next()) {
                    var variable = _h.value;
                    _loop_2(variable);
                }
            }
            catch (e_5_1) { e_5 = { error: e_5_1 }; }
            finally {
                try {
                    if (_h && !_h.done && (_b = _g.return)) _b.call(_g);
                }
                finally { if (e_5) throw e_5.error; }
            }
        }
        if (this.location === 'activity') {
            var _loop_3 = function (variable) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    context.push(variable);
                }
            };
            try {
                for (var _j = tslib_1.__values(this.designerState.subActivityContext), _k = _j.next(); !_k.done; _k = _j.next()) {
                    var variable = _k.value;
                    _loop_3(variable);
                }
            }
            catch (e_6_1) { e_6 = { error: e_6_1 }; }
            finally {
                try {
                    if (_k && !_k.done && (_c = _j.return)) _c.call(_j);
                }
                finally { if (e_6) throw e_6.error; }
            }
        }
        if (context.length > 0) {
            try {
                for (var context_1 = tslib_1.__values(context), context_1_1 = context_1.next(); !context_1_1.done; context_1_1 = context_1.next()) {
                    var v = context_1_1.value;
                    this.expr.addContext(v);
                }
            }
            catch (e_7_1) { e_7 = { error: e_7_1 }; }
            finally {
                try {
                    if (context_1_1 && !context_1_1.done && (_d = context_1.return)) _d.call(context_1);
                }
                finally { if (e_7) throw e_7.error; }
            }
        }
        this.expr.setEditPattern(ExprEditMode.Advanced); // 默认打开高级表达式编辑器
        this.expr.addExpressionText(e.instance.value);
        this.expr.buildExpression().then((/**
         * @param {?} expressioninfo
         * @return {?}
         */
        function (expressioninfo) {
            e.formControl.setValue(expressioninfo);
            e.instance.cd.detectChanges();
            //点击确定后，去除表达式里面的新增的上下文变量
            if (context.length > 0) {
                _this.expr.exprEntity.contextEntities = _this.expr.exprEntity.contextEntities.filter((/**
                 * @param {?} x
                 * @return {?}
                 */
                function (x) { return !context.some((/**
                 * @param {?} y
                 * @return {?}
                 */
                function (y) { return y.key === x.key; })); }));
            }
        }));
    };
    /**
     * @param {?} data
     * @return {?}
     */
    ActivityComponentComponent.prototype.selectionChange = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        this.uistate.curComponent = data.data;
    };
    /**
     * @private
     * @return {?}
     */
    ActivityComponentComponent.prototype.closeCellEdit = /**
     * @private
     * @return {?}
     */
    function () {
        this.cmplist.endCellEdit();
        if (this.paramlist) {
            this.paramlist.endCellEdit();
        }
    };
    /**
     * @private
     * @return {?}
     */
    ActivityComponentComponent.prototype.validator = /**
     * @private
     * @return {?}
     */
    function () {
        var e_8, _a;
        // 校验是否存在重复的构件
        /** @type {?} */
        var cache = [];
        var _loop_4 = function (cmp) {
            var e_9, _a;
            if (cache.find((/**
             * @param {?} c
             * @return {?}
             */
            function (c) { return c.methodCode === cmp.methodCode && JSON.stringify(c.actualParameters) === JSON.stringify(cmp.actualParameters) &&
                c.executionTime === cmp.executionTime; }))) {
                console.log(cmp.actualParameters);
                this_1.message.warning(this_1.localePipe.transform('component.activityComponent.sameCmp') + ("" + cmp.name) + this_1.localePipe.transform('component.activityComponent.cmpMethod') + cmp.methodCode + this_1.localePipe.transform('component.activityComponent.pleaseCheck'));
                return { value: false };
            }
            cache.push(cmp);
            if (!cmp.executionTime && this_1.location !== 'autoActivity') {
                this_1.message.warning(this_1.localePipe.transform('component.activityComponent.executionTimeNotNull'));
                return { value: false };
            }
            try {
                for (var _b = tslib_1.__values(cmp.actualParameters), _c = _b.next(); !_c.done; _c = _b.next()) {
                    var param = _c.value;
                    if (param.required && !param.value) {
                        this_1.message.warning(this_1.localePipe.transform('component.activityComponent.component') + ("\u3010" + cmp.name + "\u3011") + this_1.localePipe.transform('component.activityComponent.param') + ("\u3010" + param.code + "\u3011") + this_1.localePipe.transform('component.activityComponent.required'));
                        return { value: false };
                    }
                }
            }
            catch (e_9_1) { e_9 = { error: e_9_1 }; }
            finally {
                try {
                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                }
                finally { if (e_9) throw e_9.error; }
            }
        };
        var this_1 = this;
        try {
            for (var _b = tslib_1.__values(this.uistate.components), _c = _b.next(); !_c.done; _c = _b.next()) {
                var cmp = _c.value;
                var state_1 = _loop_4(cmp);
                if (typeof state_1 === "object")
                    return state_1.value;
            }
        }
        catch (e_8_1) { e_8 = { error: e_8_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_8) throw e_8.error; }
        }
        return true;
    };
    ActivityComponentComponent.decorators = [
        { type: Component, args: [{
                    selector: 'app-activity-component',
                    template: "<div class=\"f-page\">\r\n  <div class=\"f-page-header\">\r\n    <nav class=\"f-page-header-base\">\r\n      <div class=\"f-title\">\r\n              <ng-container *ngIf=\"exBizTips\">\r\n                <div  class=\"f-component-wizard-page-detail-header\">\r\n                  <div class=\"page-friendly-reminder\" style=\"background:#E6F7FF;padding: 0.5rem!important\">\r\n                    <div class=\"reminder-message\">\r\n                      <span class=\"reminder-title\">\r\n                        <span class=\"f-icon f-icon-info\">\r\n                        </span>\r\n                        <span class=\"reminder-name\" style=\"padding-left: 0.25rem\">{{'component.activityComponent.tips' | wfLocale}}\r\n                        </span>\r\n                      </span>\r\n                      <span class=\"message\">{{'component.activityComponent.prefabricated' | wfLocale}}\r\n                      </span>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </ng-container>\r\n      </div>\r\n      <div class=\"btn-toolbar btn-group-lg\">\r\n        <button class=\"btn btn-primary mr-2\" (click)=\"componentSelect()\">{{'component.activityComponent.add' | wfLocale}}</button>\r\n        <button class=\"btn btn-secondary mr-2\" (click)=\"moveUp()\">{{'component.activityComponent.moveUp' | wfLocale}}</button>\r\n        <button class=\"btn btn-secondary\" (click)=\"moveDown()\">{{'component.activityComponent.moveDown' | wfLocale}}</button>\r\n      </div>\r\n    </nav>\r\n  </div>\r\n  <div class=\"f-page-main f-utils-fill-flex-column h-100\">\r\n    <div class=\"f-utils-fill-flex-column farris-overflow-y-auto h-100\" style=\"border-radius:16px;border: 1.5px solid #F1F3F7;margin-left: 6px;margin-right: 6px;\">\r\n      <div [style.height.%]=\"uistate.curComponent?100:100\">\r\n        <farris-datagrid #cmplist [data]=\"uistate.components\" [idField]=\"'id'\" [columns]=\"columns\" [fit]=\"true\"\r\n          [showGroupColumn]=\"true\" [fitColumns]=\"true\" [editable]=\"true\" [editMode]=\"'cell'\" [pagination]=\"false\"\r\n          [showCheckbox]=\"false\" [groupRows]=\"true\" [multiSelect]=\"false\" (selectChanged)=\"selectionChange($event)\"\r\n          [closeOtherGridEditor]=\"true\" [mergeCell]=\"true\" [mergeFields]=\"['executionTime']\">\r\n        </farris-datagrid>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #buttonsTemplate let-ctx>\r\n  <farris-button-group [count]=\"2\" [data]=\"buttonGroupData\" (change)=\"clickAction($event, ctx)\">\r\n  </farris-button-group>\r\n</ng-template>\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type=\"button\" class=\"btn btn-secondary btn-sm px-3\" (click)=\"clickCancel()\">{{'component.activityComponent.clickCancel' | wfLocale}}</button>\r\n  <button type=\"button\" class=\"btn btn-primary btn-sm px-3 mx-2\" (click)=\"clickOK()\">{{'component.activityComponent.clickOK' | wfLocale}}</button>\r\n</ng-template>\r\n",
                    providers: [ActivityComponentRepository, ActivityComponentUIState, ActivityComponentViewModel,
                        WfLocalePipe,
                    ],
                    styles: [""]
                }] }
    ];
    /** @nocollapse */
    ActivityComponentComponent.ctorParameters = function () { return [
        { type: ActivityComponentUIState },
        { type: ActivityComponentViewModel },
        { type: ProcessDesignerUIState },
        { type: ExpressionService },
        { type: ComponentFactoryResolver },
        { type: Injector },
        { type: BsModalService },
        { type: CommonComponentUiRTService },
        { type: ActivityComponentRepository },
        { type: MessagerService },
        { type: ChangeDetectorRef, decorators: [{ type: Optional }] },
        { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
        { type: undefined, decorators: [{ type: Inject, args: [WF_LANG_RESOURCES,] }] },
        { type: WfLocalePipe, decorators: [{ type: Optional }] }
    ]; };
    ActivityComponentComponent.propDecorators = {
        cls: [{ type: HostBinding, args: ['class',] }],
        closeModal: [{ type: Output }],
        submitModal: [{ type: Output }],
        editorParams: [{ type: Input }],
        modalFooter: [{ type: ViewChild, args: ['iconSelectFooter',] }],
        btnTemplate: [{ type: ViewChild, args: ['buttonsTemplate',] }],
        cmplist: [{ type: ViewChild, args: ['cmplist',] }],
        paramlist: [{ type: ViewChild, args: ['paramlist',] }],
        value: [{ type: Input }]
    };
    return ActivityComponentComponent;
}());
export { ActivityComponentComponent };
if (false) {
    /** @type {?} */
    ActivityComponentComponent.prototype.cls;
    /** @type {?} */
    ActivityComponentComponent.prototype.closeModal;
    /** @type {?} */
    ActivityComponentComponent.prototype.submitModal;
    /** @type {?} */
    ActivityComponentComponent.prototype.editorParams;
    /** @type {?} */
    ActivityComponentComponent.prototype.modalFooter;
    /** @type {?} */
    ActivityComponentComponent.prototype.btnTemplate;
    /** @type {?} */
    ActivityComponentComponent.prototype.cmplist;
    /** @type {?} */
    ActivityComponentComponent.prototype.paramlist;
    /** @type {?} */
    ActivityComponentComponent.prototype.exBizTips;
    /** @type {?} */
    ActivityComponentComponent.prototype.modalConfig;
    /** @type {?} */
    ActivityComponentComponent.prototype.buttonGroupData;
    /** @type {?} */
    ActivityComponentComponent.prototype.editState;
    /** @type {?} */
    ActivityComponentComponent.prototype.isPreExternalProcessCmps;
    /** @type {?} */
    ActivityComponentComponent.prototype.location;
    /** @type {?} */
    ActivityComponentComponent.prototype.columns;
    /** @type {?} */
    ActivityComponentComponent.prototype.paramColumns;
    /** @type {?} */
    ActivityComponentComponent.prototype.paramAfterEdit;
    /** @type {?} */
    ActivityComponentComponent.prototype.uistate;
    /** @type {?} */
    ActivityComponentComponent.prototype.viewModel;
    /**
     * @type {?}
     * @private
     */
    ActivityComponentComponent.prototype.designerState;
    /**
     * @type {?}
     * @private
     */
    ActivityComponentComponent.prototype.expr;
    /**
     * @type {?}
     * @private
     */
    ActivityComponentComponent.prototype.resolver;
    /**
     * @type {?}
     * @private
     */
    ActivityComponentComponent.prototype.injector;
    /**
     * @type {?}
     * @private
     */
    ActivityComponentComponent.prototype.modalService;
    /**
     * @type {?}
     * @private
     */
    ActivityComponentComponent.prototype.componentService;
    /**
     * @type {?}
     * @private
     */
    ActivityComponentComponent.prototype.repository;
    /**
     * @type {?}
     * @private
     */
    ActivityComponentComponent.prototype.message;
    /**
     * @type {?}
     * @private
     */
    ActivityComponentComponent.prototype.cdr;
    /**
     * @type {?}
     * @private
     */
    ActivityComponentComponent.prototype.localeId;
    /**
     * @type {?}
     * @private
     */
    ActivityComponentComponent.prototype.resources;
    /**
     * @type {?}
     * @private
     */
    ActivityComponentComponent.prototype.localePipe;
}
var ActivityComponentConverter = /** @class */ (function () {
    function ActivityComponentConverter(localePipe) {
        this.localePipe = localePipe;
    }
    /**
     * @param {?} data
     * @return {?}
     */
    ActivityComponentConverter.prototype.convertTo = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        if (data && data.length > 0) {
            return this.localePipe.transform("component.activityComponent.set");
        }
        else {
            return this.localePipe.transform("component.activityComponent.notSet");
        }
    };
    return ActivityComponentConverter;
}());
export { ActivityComponentConverter };
if (false) {
    /**
     * @type {?}
     * @private
     */
    ActivityComponentConverter.prototype.localePipe;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYWN0aXZpdHktY29tcG9uZW50LmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0Bnc3Atd2Yvd2YtcHJvY2Vzcy1lZGl0b3IvIiwic291cmNlcyI6WyJsaWIvdmlld3MvYWN0aXZpdHktY29tcG9uZW50L2FjdGl2aXR5LWNvbXBvbmVudC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFVLFdBQVcsRUFBRSxNQUFNLEVBQUUsWUFBWSxFQUFFLFdBQVcsRUFBRSxLQUFLLEVBQUUsU0FBUyxFQUFFLHdCQUF3QixFQUFFLFFBQVEsRUFBaUIsTUFBTSxFQUFFLFFBQVEsRUFBRSxpQkFBaUIsRUFBRSxTQUFTLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFFdk4sT0FBTyxFQUFFLDJCQUEyQixFQUFFLE1BQU0saUNBQWlDLENBQUM7QUFDOUUsT0FBTyxFQUFFLHdCQUF3QixFQUFFLE1BQU0sOEJBQThCLENBQUM7QUFDeEUsT0FBTyxFQUFFLDBCQUEwQixFQUFFLE1BQU0sZ0NBQWdDLENBQUM7QUFDNUUsT0FBTyxFQUFFLGtCQUFrQixFQUFFLE1BQU0sNENBQTRDLENBQUM7QUFDaEYsT0FBTyxFQUFFLHNCQUFzQixFQUFFLE1BQU0sb0NBQW9DLENBQUM7QUFDNUUsT0FBTyxFQUFFLFlBQVksRUFBRSxpQkFBaUIsRUFBRSxZQUFZLEVBQWEsTUFBTSxxQkFBcUIsQ0FBQztBQUMvRixPQUFPLEVBQUUsY0FBYyxFQUFFLE1BQU0sa0JBQWtCLENBQUM7QUFDbEQsT0FBTyxFQUFrQiwwQkFBMEIsRUFBRSxNQUFNLGtCQUFrQixDQUFDO0FBRTlFLE9BQU8sRUFBYyxpQkFBaUIsRUFBRSxNQUFNLHFCQUFxQixDQUFDO0FBQ3BFLE9BQU8sRUFBRSxRQUFRLEVBQUUsRUFBRSxFQUFFLE1BQU0sTUFBTSxDQUFDO0FBQ3BDLE9BQU8sRUFBRSxXQUFXLEVBQUUsTUFBTSw2QkFBNkIsQ0FBQztBQUMxRCxPQUFPLEVB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QUFJLElBQUksSUFBSSxDQUFDLE1BQU0sR0FBRyxDQUFDLEVBQUU7WUFDM0IsT0FBTyxJQUFJLENBQUMsVUFBVSxDQUFDLFNBQVMsQ0FBQyxpQ0FBaUMsQ0FBQyxDQUFDO1NBQ3JFO2FBQU07WUFDTCxPQUFPLElBQUksQ0FBQyxVQUFVLENBQUMsU0FBUyxDQUFDLG9DQUFvQyxDQUFDLENBQUM7U0FDeEU7SUFDSCxDQUFDO0lBQ0gsaUNBQUM7QUFBRCxDQUFDLEFBWkQsSUFZQzs7Ozs7OztJQVZHLGdEQUFnQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCwgT25Jbml0LCBIb3N0QmluZGluZywgT3V0cHV0LCBFdmVudEVtaXR0ZXIsIFRlbXBsYXRlUmVmLCBJbnB1dCwgVmlld0NoaWxkLCBDb21wb25lbnRGYWN0b3J5UmVzb2x2ZXIsIEluamVjdG9yLCBBZnRlclZpZXdJbml0LCBJbmplY3QsIE9wdGlvbmFsLCBDaGFuZ2VEZXRlY3RvclJlZiwgTE9DQUxFX0lEIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IFR5cGVDb252ZXJ0ZXIgfSBmcm9tICdAZmFycmlzL2lkZS1wcm9wZXJ0eS1wYW5lbCc7XHJcbmltcG9ydCB7IEFjdGl2aXR5Q29tcG9uZW50UmVwb3NpdG9yeSB9IGZyb20gJy4vYWN0aXZpdHktY29tcG9uZW50LnJlcG9zaXRvcnknO1xyXG5pbXBvcnQgeyBBY3Rpdml0eUNvbXBvbmVudFVJU3RhdGUgfSBmcm9tICcuL2FjdGl2aXR5LWNvbXBvbmVudC51aXN0YXRlJztcclxuaW1wb3J0IHsgQWN0aXZpdHlDb21wb25lbnRWaWV3TW9kZWwgfSBmcm9tICcuL2FjdGl2aXR5LWNvbXBvbmVudC52aWV3bW9kZWwnO1xyXG5pbXBvcnQgeyBCaXpDb21wb25lbnRFbnRpdHkgfSBmcm9tICcuLi8uLi9kb21haW4vZW50aXRpZXMvYml6LWNvbXBvbmVudC5lbnRpdHknO1xyXG5pbXBvcnQgeyBQcm9jZXNzRGVzaWduZXJVSVN0YXRlIH0gZnJvbSAnLi4vLi4vYXBwL3Byb2Nlc3MtZGVzaWduZXIudWlzdGF0ZSc7XHJcbmltcG9ydCB7IEV4cHJFZGl0TW9kZSwgRXhwcmVzc2lvblNlcnZpY2UsIEluamVjdGVkVHlwZSwgVmFyRW50aXR5IH0gZnJvbSAnQGdzcC1zdmMvZXhwcmVzc2lvbic7XHJcbmltcG9ydCB7IEJzTW9kYWxTZXJ2aWNlIH0gZnJvbSAnQGZhcnJpcy91aS1tb2RhbCc7XHJcbmltcG9ydCB7IFNlbGVjdG9yUmVzdWx0LCBDb21tb25Db21wb25lbnRVaVJUU2VydmljZSB9IGZyb20gJ0Bnc3AtY21wL2NjbXAtdWknO1xyXG5pbXBvcnQgeyBHc3BDb21wb25lbnQgfSBmcm9tICdAZ3NwLWNtcC9jb21tb24tY29tcG9uZW50JztcclxuaW1wb3J0IHsgRGF0YUNvbHVtbiwgRGF0YWdyaWRDb21wb25lbnQgfSBmcm9tICdAZmFycmlzL3VpLWRhdGFncmlkJztcclxuaW1wb3J0IHsgZm9ya0pvaW4sIG9mIH0gZnJvbSAncnhqcyc7XHJcbmltcG9ydCB7IEVkaXRvclR5cGVzIH0gZnJvbSAnQGZhcnJpcy91aS1kYXRhZ3JpZC1lZGl0b3JzJztcclxuaW1wb3J0IHsgTWVzc2FnZXJTZXJ2aWNlIH0gZnJvbSAnQGZhcnJpcy91aS1tZXNzYWdlcic7XHJcbmltcG9ydCB7IEVkaXRDb21wb25lbnRQYXJhbWV0ZXJDb21wb25lbnQgfSBmcm9tICcuLi9lZGl0LWNvbXBvbmVudC1wYXJhbWV0ZXIvZWRpdC1jb21wb25lbnQtcGFyYW1ldGVyLmNvbXBvbmVudCc7XHJcbmltcG9ydCB7IFdGX0xBTkdfUkVTT1VSQ0VTLCBXZkxvY2FsZVBpcGUgfSBmcm9tICcuLi8uLi9pMThuL3BpcGUvd2YtcHJvY2Vzcy1lZGl0b3ItbG9jYWxlLnBpcGUnO1xyXG5pbXBvcnQgeyBXRl9QUk9DRVNTX0VESVRPUl9MQU5HX1JFU09VUkNFUyB9IGZyb20gJy4uLy4uL2kxOG4vYXNzZXRzL2xhbmcucmVzb3VyY2UnO1xyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgc2VsZWN0b3I6ICdhcHAtYWN0aXZpdHktY29tcG9uZW50JyxcclxuICB0ZW1wbGF0ZVVybDogJy4vYWN0aXZpdHktY29tcG9uZW50LmNvbXBvbmVudC5odG1sJyxcclxuICBzdHlsZVVybHM6IFsnLi9hY3Rpdml0eS1jb21wb25lbnQuY29tcG9uZW50LnNjc3MnXSxcclxuICBwcm92aWRlcnM6IFtBY3Rpdml0eUNvbXBvbmVudFJlcG9zaXRvcnksIEFjdGl2aXR5Q29tcG9uZW50VUlTdGF0ZSwgQWN0aXZpdHlDb21wb25lbnRWaWV3TW9kZWwsXHJcbiAgICAgV2ZMb2NhbGVQaXBlLFxyXG4gIF1cclxufSlcclxuZXhwb3J0IGNsYXNzIEFjdGl2aXR5Q29tcG9uZW50Q29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0LCBBZnRlclZpZXdJbml0IHtcclxuICBASG9zdEJpbmRpbmcoJ2NsYXNzJylcclxuICBjbHMgPSAnZmFycmlzLW1haW4tYXJlYSBmbGV4LWNvbHVtbic7XHJcbiAgQE91dHB1dCgpIGNsb3NlTW9kYWwgPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcclxuICBAT3V0cHV0KCkgc3VibWl0TW9kYWwgPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcclxuICBASW5wdXQoKSBlZGl0b3JQYXJhbXM6IGFueSA9IHt9O1xyXG4gIEBWaWV3Q2hpbGQoJ2ljb25TZWxlY3RGb290ZXInKSBtb2RhbEZvb3RlcjogVGVtcGxhdGVSZWY8YW55PjtcclxuICBAVmlld0NoaWxkKCdidXR0b25zVGVtcGxhdGUnKSBidG5UZW1wbGF0ZTogVGVtcGxhdGVSZWY8YW55PjtcclxuICBAVmlld0NoaWxkKCdjbXBsaXN0JykgY21wbGlzdDogRGF0YWdyaWRDb21wb25lbnQ7XHJcbiAgQFZpZXdDaGlsZCgncGFyYW1saXN0JykgcGFyYW1saXN0OiBEYXRhZ3JpZENvbXBvbmVudDtcclxuICBleEJpelRpcHMgPSBmYWxzZTtcclxuICBtb2RhbENvbmZpZyA9IHtcclxuICAgIHRpdGxlOiB0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKCdjb21wb25lbnQuYWN0aXZpdHlDb21wb25lbnQuY29tcG9uZW50JyksXHJcbiAgICB3aWR0aDogOTYwLFxyXG4gICAgaGVpZ2h0OiA1MDYsXHJcbiAgICBzaG93QnV0dG9uczogdHJ1ZVxyXG4gIH07XHJcbiAgQElucHV0KClcclxuICBzZXQgdmFsdWUoY3B0czogYW55W10pIHtcclxuICAgIGlmIChjcHRzICYmIGNwdHMubGVuZ3RoID4gMCkge1xyXG4gICAgICBsZXQgbWV0YURhdGFJZExpc3QgPSBuZXcgQXJyYXkoKTtcclxuICAgICAgZm9yIChjb25zdCBjbXAgb2YgY3B0cykge1xyXG4gICAgICAgIGlmIChtZXRhRGF0YUlkTGlzdC5pbmRleE9mKGNtcC5tZXRhZGF0YUlkKSA9PSAtMSkge1xyXG4gICAgICAgICAgbWV0YURhdGFJZExpc3QucHVzaChjbXAubWV0YWRhdGFJZCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIGlmIChtZXRhRGF0YUlkTGlzdC5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgZm9ya0pvaW4obWV0YURhdGFJZExpc3QubWFwKChtZXRhRGF0YUlkOiBzdHJpbmcpID0+IHRoaXMuZGVzaWduZXJTdGF0ZS5nZXRIZWxwTWV0YURhdGEobWV0YURhdGFJZCwgJycpKSkuc3Vic2NyaWJlKGNtcE1ldGFzID0+IHtcclxuICAgICAgICAgIGZvciAoY29uc3QgY3B0IG9mIGNwdHMpIHtcclxuICAgICAgICAgICAgY29uc3QgYml6Q29tcG9uZW50ID0gbmV3IEJpekNvbXBvbmVudEVudGl0eShjcHQubmFtZSwgY3B0Lm1ldGFkYXRhSWQsIGNwdC5tZXRob2RDb2RlKTtcclxuICAgICAgICAgICAgYml6Q29tcG9uZW50LmV4ZWN1dGlvblRpbWUgPSBjcHQuZXhlY3V0aW9uVGltZSxcclxuICAgICAgICAgICAgYml6Q29tcG9uZW50LmlkID0gY3B0LmlkO1xyXG4gICAgICAgICAgICBiaXpDb21wb25lbnQuaXNGb3JDb21wZW5zYXRpb24gPSBjcHQuaXNGb3JDb21wZW5zYXRpb247XHJcbiAgICAgICAgICAgIGJpekNvbXBvbmVudC5hY3R1YWxQYXJhbWV0ZXJzID0gbmV3IEFycmF5KCk7XHJcbiAgICAgICAgICAgIGJpekNvbXBvbmVudC5zY29wZVR5cGUgPSBjcHQuc2NvcGVUeXBlIHx8IG51bGw7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBtZXRhID0gY21wTWV0YXMuZmluZChtID0+IG0uaWQgPT09IGNwdC5tZXRhZGF0YUlkKTtcclxuICAgICAgICAgICAgY29uc3QgY29udGVudCA9IEpTT04ucGFyc2UobWV0YS5jb250ZW50KTtcclxuICAgICAgICAgICAgY29uc3Qgb3BlcmF0aW9uID0gY29udGVudC5vcGVyYXRpb25zLmZpbmQobyA9PiBvLmNvZGUgPT09IGNwdC5tZXRob2RDb2RlKTtcclxuICAgICAgICAgICAgaWYgKG9wZXJhdGlvbikge1xyXG4gICAgICAgICAgICAgIGJpekNvbXBvbmVudC5hY3R1YWxQYXJhbWV0ZXJzID0gY3B0LmFjdHVhbFBhcmFtZXRlcnMubWFwKGEgPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcCA9IG9wZXJhdGlvbi5wYXJhbWV0ZXJzLmZpbmQoaSA9PiBpLmNvZGUgPT09IGEuY29kZSk7XHJcbiAgICAgICAgICAgICAgICBpZiAocCkge1xyXG4gICAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvZGU6IGEuY29kZSxcclxuICAgICAgICAgICAgICAgICAgICBuYW1lOiBhLm5hbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGEudmFsdWUsXHJcbiAgICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IGEuY29kZS50b0xvd2VyQ2FzZSgpID09PSd3ZmNvbnRleHQnPyBmYWxzZSA6IHAucmVxdWlyZWRcclxuICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IodGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybSgnY29tcG9uZW50LmFjdGl2aXR5Q29tcG9uZW50Lm1ldGhvZCcpICsgY3B0Lm1ldGhvZENvZGUgKyB0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKCdjb21wb25lbnQuYWN0aXZpdHlDb21wb25lbnQuaW5jb25zaXN0ZW50UGFyYW1ldGVycycpKTtcclxuICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgICAgICBjb2RlOiBhLmNvZGUsXHJcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogYS5uYW1lLFxyXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBhLnZhbHVlLFxyXG4gICAgICAgICAgICAgICAgICAgIHJlcXVpcmVkOiBmYWxzZVxyXG4gICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IodGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybSgnY29tcG9uZW50LmFjdGl2aXR5Q29tcG9uZW50LmxvbmdlckV4aXN0cycpICsgY3B0Lm1ldGhvZENvZGUgKyB0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKCdjb21wb25lbnQuYWN0aXZpdHlDb21wb25lbnQucGxlYXNlQ2hlY2snKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy51aXN0YXRlLmNvbXBvbmVudHMucHVzaChiaXpDb21wb25lbnQpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBidXR0b25Hcm91cERhdGEgPSBbXHJcbiAgICB7XHJcbiAgICAgIGlkOiAnZWRpdCcsXHJcbiAgICAgIHRleHQ6IHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oJ2NvbXBvbmVudC5hY3Rpdml0eUNvbXBvbmVudC5lZGl0JyksXHJcbiAgICB9LFxyXG4gICAge1xyXG4gICAgICBpZDogJ2RlbGV0ZVJvdycsXHJcbiAgICAgIHRleHQ6IHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oJ2NvbXBvbmVudC5hY3Rpdml0eUNvbXBvbmVudC5kZWxldGVSb3cnKSxcclxuICAgIH1cclxuICBdO1xyXG4gIGVkaXRTdGF0ZSA9ICduZXcnOyAvLyDnvJbovpHnirbmgIHvvIznlKjkuo7ljLrliIbmmK/mlrDlop7ov5jmmK/nvJbovpEgIG5ldyB8IGVkaXRcclxuICBpc1ByZUV4dGVybmFsUHJvY2Vzc0NtcHMgPSBmYWxzZTtcclxuICBsb2NhdGlvbjogJ2FjdGl2aXR5JyB8ICdwcm9jZXNzJyB8ICdhdXRvQWN0aXZpdHknO1xyXG4gIGNvbHVtbnMgPSBbXTtcclxuICBwYXJhbUNvbHVtbnMgPSBbXTtcclxuICBjb25zdHJ1Y3RvcihcclxuICAgIHB1YmxpYyB1aXN0YXRlOiBBY3Rpdml0eUNvbXBvbmVudFVJU3RhdGUsXHJcbiAgICBwdWJsaWMgdmlld01vZGVsOiBBY3Rpdml0eUNvbXBvbmVudFZpZXdNb2RlbCxcclxuICAgIHByaXZhdGUgZGVzaWduZXJTdGF0ZTogUHJvY2Vzc0Rlc2lnbmVyVUlTdGF0ZSxcclxuICAgIHByaXZhdGUgZXhwcjogRXhwcmVzc2lvblNlcnZpY2UsXHJcbiAgICBwcml2YXRlIHJlc29sdmVyOiBDb21wb25lbnRGYWN0b3J5UmVzb2x2ZXIsXHJcbiAgICBwcml2YXRlIGluamVjdG9yOiBJbmplY3RvcixcclxuICAgIHByaXZhdGUgbW9kYWxTZXJ2aWNlOiBCc01vZGFsU2VydmljZSxcclxuICAgIHByaXZhdGUgY29tcG9uZW50U2VydmljZTogQ29tbW9uQ29tcG9uZW50VWlSVFNlcnZpY2UsXHJcbiAgICBwcml2YXRlIHJlcG9zaXRvcnk6IEFjdGl2aXR5Q29tcG9uZW50UmVwb3NpdG9yeSxcclxuICAgIHByaXZhdGUgbWVzc2FnZTogTWVzc2FnZXJTZXJ2aWNlLFxyXG4gICAgQE9wdGlvbmFsKCkgcHJpdmF0ZSBjZHI6IENoYW5nZURldGVjdG9yUmVmLFxyXG4gICAgQEluamVjdChMT0NBTEVfSUQpIHByaXZhdGUgbG9jYWxlSWQ6IHN0cmluZyxcclxuICAgIEBJbmplY3QoV0ZfTEFOR19SRVNPVVJDRVMpIHByaXZhdGUgcmVzb3VyY2VzOiBhbnksXHJcbiAgICBAT3B0aW9uYWwoKSBwcml2YXRlIGxvY2FsZVBpcGU6IFdmTG9jYWxlUGlwZVxyXG4gICkge1xyXG4gICAgdGhpcy5sb2NhbGVQaXBlID0gdGhpcy5sb2NhbGVQaXBlIHx8IG5ldyBXZkxvY2FsZVBpcGUobG9jYWxlSWQsIHJlc291cmNlcyk7XHJcbiAgfVxyXG5cclxuICBuZ09uSW5pdCgpIHtcclxuICAgIC8vIDIwMjMtNS0yNSDnvZHpgJ/mhaLnmoTml7blgJnkvJrlr7zoh7TliqDovb3kuI3lh7rmnaXmtYHnqIvmnoTku7bvvIzlm6DmraTliqDkuKrlu7bml7ZcclxuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICB0aGlzLnJlc3RhcnQoKTtcclxuICAgIH0sIDMwMClcclxuICB9XHJcblxyXG4gIHJlc3RhcnQoKSB7XHJcbiAgICBpZiAodGhpcy5kZXNpZ25lclN0YXRlLnN0YXJ0TW9kZSA9PT0gJ0VYVEVSTkFMX1BST0NFU1MnKSB7XHJcbiAgICAgIHRoaXMucmVwb3NpdG9yeS5nZXRCaXpDbXAoKGNtcHMpID0+IHtcclxuICAgICAgICBpZiAoY21wcyAmJiBjbXBzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgIC8vIOatpOWkhOagh+iusOacieWklumDqOa1geeoi+mAmueUqOaehOS7tlxyXG4gICAgICAgICAgZm9yIChjb25zdCBjIG9mIGNtcHMpIHtcclxuICAgICAgICAgICAgaWYgKGMuc2NvcGVUeXBlID09PSAnRXh0ZXJuYWxQcm9jZXNzJykge1xyXG4gICAgICAgICAgICAgIHRoaXMuZXhCaXpUaXBzID0gdHJ1ZTtcclxuICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICB0aGlzLmxvY2F0aW9uID0gdGhpcy5lZGl0b3JQYXJhbXMubG9jYXRpb247XHJcbiAgICBpZiAodGhpcy5sb2NhdGlvbiA9PT0gJ2FjdGl2aXR5Jykge1xyXG4gICAgICB0aGlzLnVpc3RhdGUuZXhlY3V0aW9uQ29sbGVjdGlvbiA9IHRoaXMudWlzdGF0ZS5hY3Rpdml0eUNvbGxlY3Rpb247XHJcbiAgICAgIHRoaXMuY29sdW1ucyA9IFtcclxuICAgICAgICB7XHJcbiAgICAgICAgICBmaWVsZDogJ2V4ZWN1dGlvblRpbWUnLCB3aWR0aDogMTAwLCB0aXRsZTogdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybSgnY29tcG9uZW50LmFjdGl2aXR5Q29tcG9uZW50LmV4ZWN1dGlvblRpbWUnKSxcclxuICAgICAgICAgIGVkaXRvcjoge1xyXG4gICAgICAgICAgICB0eXBlOiBFZGl0b3JUeXBlcy5DT01CT0xJU1QsXHJcbiAgICAgICAgICAgIG9wdGlvbnM6IHsgZGF0YTogdGhpcy51aXN0YXRlLmV4ZWN1dGlvbkNvbGxlY3Rpb24sIGdyb3VwRmllbGQ6ICd0ZXh0JywgdmFsdWVGaWVsZDogJ3ZhbHVlJywgdGV4dEZpZWxkOiAndGV4dCcsIGlkRmllbGQ6ICd2YWx1ZScsIHBhbmVsSGVpZ2h0OiAnYXV0bycgfVxyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIGZvcm1hdHRlcjogKHYsIGQsIGkpID0+IHtcclxuICAgICAgICAgICAgaWYgKHYpIHtcclxuICAgICAgICAgICAgICByZXR1cm4gdGhpcy51aXN0YXRlLmV4ZWN1dGlvbkNvbGxlY3Rpb24uZmluZChpdGVtID0+IGl0ZW0udmFsdWUgPT09IHYpLnRleHQ7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgcmV0dXJuICcnO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgdmFsaWRhdG9yczogW1xyXG4gICAgICAgICAgICB7IHR5cGU6ICdyZXF1aXJlZCcsIG1lc3NhZ2VyOiAn5b+F5aGrJyB9XHJcbiAgICAgICAgICBdXHJcbiAgICAgICAgfSxcclxuICAgICAgICB7XHJcbiAgICAgICAgICBmaWVsZDogJ25hbWUnLCB3aWR0aDogMTAwLCB0aXRsZTogdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybSgnY29tcG9uZW50LmFjdGl2aXR5Q29tcG9uZW50LmNtcE5hbWUnKVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgeyBmaWVsZDogJ21ldGFkYXRhSWQnLCB3aWR0aDogMTAwLCB0aXRsZTogdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybSgnY29tcG9uZW50LmFjdGl2aXR5Q29tcG9uZW50Lm1ldGFkYXRhSWQnKSB9LFxyXG4gICAgICAgIHsgZmllbGQ6ICdtZXRob2RDb2RlJywgd2lkdGg6IDEwMCwgdGl0bGU6IHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oJ2NvbXBvbmVudC5hY3Rpdml0eUNvbXBvbmVudC5tZXRob2RDb2RlJykgfSxcclxuICAgICAgICB7XHJcbiAgICAgICAgICBmaWVsZDogJ2lzRm9yQ29tcGVuc2F0aW9uJywgd2lkdGg6IDUwLCB0aXRsZTogdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybSgnY29tcG9uZW50LmFjdGl2aXR5Q29tcG9uZW50LmlzRm9yQ29tcGVuc2F0aW9uJyksXHJcbiAgICAgICAgICBlZGl0b3I6IHsgdHlwZTogRWRpdG9yVHlwZXMuU1dJVENILCBvcHRpb25zOiB7fSB9LFxyXG4gICAgICAgICAgZm9ybWF0dGVyOiB7IHR5cGU6ICdib29sZWFuJywgb3B0aW9uczogeyB0cnVlVGV4dDogdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybSgnY29tcG9uZW50LmFjdGl2aXR5Q29tcG9uZW50LnllcycpLCBmYWxzZVRleHQ6IHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oJ2NvbXBvbmVudC5hY3Rpdml0eUNvbXBvbmVudC5ubycpIH0gfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgeyB0aXRsZTogdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybSgnY29tcG9uZW50LmFjdGl2aXR5Q29tcG9uZW50Lm9wZXJhdGUnKSwgd2lkdGg6IDcwLCB0ZW1wbGF0ZTogdGhpcy5idG5UZW1wbGF0ZSB9XHJcbiAgICAgIF07XHJcbiAgICB9IGVsc2UgaWYgKHRoaXMubG9jYXRpb24gPT09ICdhdXRvQWN0aXZpdHknKSB7XHJcbiAgICAgIHRoaXMuY29sdW1ucyA9IFtcclxuICAgICAgICB7XHJcbiAgICAgICAgICBmaWVsZDogJ25hbWUnLCB3aWR0aDogMTAwLCB0aXRsZTogdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybSgnY29tcG9uZW50LmFjdGl2aXR5Q29tcG9uZW50LmNtcE5hbWUnKVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgeyBmaWVsZDogJ21ldGFkYXRhSWQnLCB3aWR0aDogMTAwLCB0aXRsZTogdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybSgnY29tcG9uZW50LmFjdGl2aXR5Q29tcG9uZW50Lm1ldGFkYXRhSWQnKSB9LFxyXG4gICAgICAgIHsgZmllbGQ6ICdtZXRob2RDb2RlJywgd2lkdGg6IDEwMCwgdGl0bGU6IHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oJ2NvbXBvbmVudC5hY3Rpdml0eUNvbXBvbmVudC5tZXRob2RDb2RlJykgfSxcclxuICAgICAgICB7XHJcbiAgICAgICAgICBmaWVsZDogJ2lzRm9yQ29tcGVuc2F0aW9uJywgd2lkdGg6IDUwLCB0aXRsZTogdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybSgnY29tcG9uZW50LmFjdGl2aXR5Q29tcG9uZW50LmlzRm9yQ29tcGVuc2F0aW9uJyksXHJcbiAgICAgICAgICBlZGl0b3I6IHsgdHlwZTogRWRpdG9yVHlwZXMuU1dJVENILCBvcHRpb25zOiB7fSB9LFxyXG4gICAgICAgICAgZm9ybWF0dGVyOiB7IHR5cGU6ICdib29sZWFuJywgb3B0aW9uczogeyB0cnVlVGV4dDogdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybSgnY29tcG9uZW50LmFjdGl2aXR5Q29tcG9uZW50LnllcycpLCBmYWxzZVRleHQ6IHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oJ2NvbXBvbmVudC5hY3Rpdml0eUNvbXBvbmVudC5ubycpIH0gfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgeyB0aXRsZTogdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybSgnY29tcG9uZW50LmFjdGl2aXR5Q29tcG9uZW50Lm9wZXJhdGUnKSwgd2lkdGg6IDcwLCB0ZW1wbGF0ZTogdGhpcy5idG5UZW1wbGF0ZSB9XHJcbiAgICAgIF07XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLmNvbHVtbnMgPSBbXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgZmllbGQ6ICdleGVjdXRpb25UaW1lJywgd2lkdGg6IDEwMCwgdGl0bGU6IHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oJ2NvbXBvbmVudC5hY3Rpdml0eUNvbXBvbmVudC5leGVjdXRpb25UaW1lJyksXHJcbiAgICAgICAgICBlZGl0b3I6IHtcclxuICAgICAgICAgICAgdHlwZTogRWRpdG9yVHlwZXMuQ09NQk9MSVNULFxyXG4gICAgICAgICAgICBvcHRpb25zOiB7IGRhdGE6IHRoaXMudWlzdGF0ZS5leGVjdXRpb25Db2xsZWN0aW9uLCBncm91cEZpZWxkOiAndGV4dCcsIHZhbHVlRmllbGQ6ICd2YWx1ZScsIHRleHRGaWVsZDogJ3RleHQnLCBpZEZpZWxkOiAndmFsdWUnLCBwYW5lbEhlaWdodDogJ2F1dG8nIH1cclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBmb3JtYXR0ZXI6ICh2LCBkLCBpKSA9PiB7XHJcbiAgICAgICAgICAgIGlmICh2KSB7XHJcbiAgICAgICAgICAgICAgcmV0dXJuIHRoaXMudWlzdGF0ZS5leGVjdXRpb25Db2xsZWN0aW9uLmZpbmQoaXRlbSA9PiBpdGVtLnZhbHVlID09PSB2KS50ZXh0O1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgIHJldHVybiAnJztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIHZhbGlkYXRvcnM6IFtcclxuICAgICAgICAgICAgeyB0eXBlOiAncmVxdWlyZWQnLCBtZXNzYWdlcjogJ+W/heWhqycgfVxyXG4gICAgICAgICAgXVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgZmllbGQ6ICduYW1lJywgd2lkdGg6IDEwMCwgdGl0bGU6IHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oJ2NvbXBvbmVudC5hY3Rpdml0eUNvbXBvbmVudC5jbXBOYW1lJylcclxuICAgICAgICB9LFxyXG4gICAgICAgIHsgZmllbGQ6ICdtZXRhZGF0YUlkJywgd2lkdGg6IDEwMCwgdGl0bGU6IHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oJ2NvbXBvbmVudC5hY3Rpdml0eUNvbXBvbmVudC5tZXRhZGF0YUlkJykgfSxcclxuICAgICAgICB7IGZpZWxkOiAnbWV0aG9kQ29kZScsIHdpZHRoOiAxMDAsIHRpdGxlOiB0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKCdjb21wb25lbnQuYWN0aXZpdHlDb21wb25lbnQubWV0aG9kQ29kZScpIH0sXHJcbiAgICAgICAgeyB0aXRsZTogdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybSgnY29tcG9uZW50LmFjdGl2aXR5Q29tcG9uZW50Lm9wZXJhdGUnKSwgd2lkdGg6IDcwLCB0ZW1wbGF0ZTogdGhpcy5idG5UZW1wbGF0ZSB9XHJcbiAgICAgIF07XHJcbiAgICB9XHJcbiAgICBpZiAodGhpcy51aXN0YXRlLmNvbXBvbmVudHMgJiYgdGhpcy51aXN0YXRlLmNvbXBvbmVudHMubGVuZ3RoID4gMCkge1xyXG4gICAgICB0aGlzLmNtcGxpc3Quc2VsZWN0Um93KHRoaXMudWlzdGF0ZS5jb21wb25lbnRzWzBdLmlkLCB0cnVlKTtcclxuICAgIH1cclxuXHJcbiAgICB0aGlzLnBhcmFtQ29sdW1ucyA9IFtcclxuICAgICAgeyBmaWVsZDogJ2NvZGUnLCB3aWR0aDogNTAsIHRpdGxlOiB0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKCdjb21wb25lbnQuYWN0aXZpdHlDb21wb25lbnQuY29kZScpIH0sXHJcbiAgICAgIHsgZmllbGQ6ICduYW1lJywgd2lkdGg6IDUwLCB0aXRsZTogdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybSgnY29tcG9uZW50LmFjdGl2aXR5Q29tcG9uZW50Lm5hbWUnKSB9LFxyXG4gICAgICB7XHJcbiAgICAgICAgZmllbGQ6ICd2YWx1ZScsIHdpZHRoOiAxMDAsIHRpdGxlOiB0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKCdjb21wb25lbnQuYWN0aXZpdHlDb21wb25lbnQudmFsdWUnKSAsXHJcbiAgICAgICAgZWRpdG9yOiB7XHJcbiAgICAgICAgICB0eXBlOiAnaW5wdXQtZ3JvdXAnLFxyXG4gICAgICAgICAgb3B0aW9uczoge1xyXG4gICAgICAgICAgICBncm91cFRleHQ6ICc8aSBjbGFzcz1cImYtaWNvbiBmLWljb24tbG9va3VwXCI+PC9pPicsXHJcbiAgICAgICAgICAgIGVkaXRhYmxlOiBmYWxzZSxcclxuICAgICAgICAgICAgY2xpY2tIYW5kbGU6IChlKSA9PiB7XHJcbiAgICAgICAgICAgICAgZS5mb3JtQ29udHJvbC5zZXRWYWx1ZShlLmluc3RhbmNlLnZhbHVlID8gZS5pbnN0YW5jZS52YWx1ZSA6ICcnKTtcclxuICAgICAgICAgICAgICB0aGlzLnNob3dFeHBySGVscChlKTtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgY2xlYXI6IChlKSA9PiB7XHJcbiAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2NsZWFyJywgZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIF07XHJcbiAgICAvLyDpgInkuK3lvZPliY3ooYxcclxuICAgIHRoaXMucmVwb3NpdG9yeS5zdWJqZWN0LnN1YnNjcmliZShjbXAgPT4ge1xyXG4gICAgICB0aGlzLmNtcGxpc3QubG9hZERhdGEodGhpcy51aXN0YXRlLmNvbXBvbmVudHMpO1xyXG4gICAgICBpZiAoY21wKSB7XHJcbiAgICAgICAgdGhpcy5jbXBsaXN0LnNlbGVjdFJvdyhjbXAuaWQsIHRydWUpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHRoaXMudWlzdGF0ZS5jdXJDb21wb25lbnQgPSBudWxsO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIG5nQWZ0ZXJWaWV3SW5pdCgpIHtcclxuICAgIGlmICh0aGlzLnVpc3RhdGUuY29tcG9uZW50cyAmJiB0aGlzLnVpc3RhdGUuY29tcG9uZW50cy5sZW5ndGggPiAwKSB7XHJcbiAgICAgIHRoaXMuY21wbGlzdC5zZWxlY3RSb3codGhpcy51aXN0YXRlLmNvbXBvbmVudHNbMF0uaWQsIHRydWUpO1xyXG4gICAgfVxyXG4gIH1cclxuICBlZGl0KCkge1xyXG4gICAgdGhpcy5lZGl0U3RhdGUgPSAnZWRpdCc7XHJcbiAgICBjb25zdCBjb21wRmFjdG9yeSA9IHRoaXMucmVzb2x2ZXIucmVzb2x2ZUNvbXBvbmVudEZhY3RvcnkoRWRpdENvbXBvbmVudFBhcmFtZXRlckNvbXBvbmVudCk7XHJcbiAgICBjb25zdCBjb21wUmVmID0gY29tcEZhY3RvcnkuY3JlYXRlKHRoaXMuaW5qZWN0b3IpO1xyXG4gICAgY29uc3QgbW9kYWxDb25maWcgPSB7XHJcbiAgICAgIHRpdGxlOiB0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKCdjb21wb25lbnQuYWN0aXZpdHlDb21wb25lbnQuZWRpdENvbXBvbmVudCcpLFxyXG4gICAgICB3aWR0aDogNzAwLFxyXG4gICAgICBoZWlnaHQ6IDQwMCxcclxuICAgICAgYnV0dG9uczogY29tcFJlZi5pbnN0YW5jZS5lZGl0Rm9vdGVyLFxyXG4gICAgICBzaG93QnV0dG9uczogdHJ1ZSxcclxuICAgICAgaW5pdGlhbFN0YXRlOiB7XHJcbiAgICAgICAgY3VyQ29tcG9uZW50OiBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHRoaXMudWlzdGF0ZS5jdXJDb21wb25lbnQpKVxyXG4gICAgICB9XHJcbiAgICB9O1xyXG4gICAgY29uc3QgZWRpdERpYWxvZyA9IHRoaXMubW9kYWxTZXJ2aWNlLnNob3coY29tcFJlZiwgbW9kYWxDb25maWcpO1xyXG4gICAgY29tcFJlZi5pbnN0YW5jZS5jYW5FZGl0ID0gZmFsc2U7XHJcbiAgICBjb21wUmVmLmluc3RhbmNlLmVkaXRTdGF0ZSA9IHRoaXMuZWRpdFN0YXRlO1xyXG4gICAgY29tcFJlZi5pbnN0YW5jZS5sb2NhdGlvbiA9IHRoaXMubG9jYXRpb247XHJcbiAgICBjb21wUmVmLmluc3RhbmNlLmV4ZWN1dGlvblRpbWluZ0xpc3QgPSB0aGlzLnVpc3RhdGUuZXhlY3V0aW9uQ29sbGVjdGlvbjtcclxuICAgIC8vIGNvbXBSZWYuaW5zdGFuY2UuY3VyQ29tcG9uZW50ID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSh0aGlzLnVpc3RhdGUuY3VyQ29tcG9uZW50KSk7XHJcbiAgICBjb21wUmVmLmluc3RhbmNlLnN1Ym1pdEVtaXR0ZXIuc3Vic2NyaWJlKGNtcCA9PiB7XHJcbiAgICAgIGNvbnN0IGkgPSB0aGlzLnVpc3RhdGUuY29tcG9uZW50cy5maW5kSW5kZXgoaXRlbSA9PiBpdGVtLmlkID09PSBjbXAuaWQpO1xyXG4gICAgICB0aGlzLnVpc3RhdGUuY29tcG9uZW50c1tpXSA9IGNtcDtcclxuICAgICAgdGhpcy5jbXBsaXN0LmxvYWREYXRhKHRoaXMudWlzdGF0ZS5jb21wb25lbnRzKTtcclxuICAgICAgZWRpdERpYWxvZy5jbG9zZSgpXHJcbiAgICB9KTtcclxuICAgIGNvbXBSZWYuaW5zdGFuY2UuY2xvc2VFbWl0dGVyLnN1YnNjcmliZShyZSA9PiB7XHJcbiAgICAgIGVkaXREaWFsb2cuY2xvc2UoKVxyXG4gICAgfSk7XHJcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgY29tcFJlZi5pbnN0YW5jZS5jZC5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICB9KVxyXG4gIH1cclxuICBkZWxldGVSb3coKSB7XHJcbiAgICB0aGlzLm1lc3NhZ2UuY29uZmlybSh0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKCdjb21wb25lbnQuYWN0aXZpdHlDb21wb25lbnQuY29uZmlybURlbGV0ZScpKS5zdWJzY3JpYmUoKHYpID0+IHtcclxuICAgICAgaWYgKHYpIHtcclxuICAgICAgICB0aGlzLmNsb3NlQ2VsbEVkaXQoKTtcclxuICAgICAgICB0aGlzLnZpZXdNb2RlbC5kZWxldGVSb3coKTtcclxuICAgICAgICB0aGlzLmNtcGxpc3QubG9hZERhdGEodGhpcy51aXN0YXRlLmNvbXBvbmVudHMpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcbiAgbW92ZVVwKCkge1xyXG4gICAgaWYgKCF0aGlzLnVpc3RhdGUuY3VyQ29tcG9uZW50KSB7XHJcbiAgICAgIHRoaXMubWVzc2FnZS5pbmZvKHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oJ2NvbXBvbmVudC5hY3Rpdml0eUNvbXBvbmVudC5jdXJDb21wb25lbnQnKSk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGNvbnN0IGN1ckNtcElkOiBzdHJpbmcgPSB0aGlzLnVpc3RhdGUuY3VyQ29tcG9uZW50LmlkO1xyXG4gICAgY29uc3QgaSA9IHRoaXMudWlzdGF0ZS5jb21wb25lbnRzLmZpbmRJbmRleChjID0+IGMuaWQgPT09IGN1ckNtcElkKTtcclxuICAgIGlmIChpID09PSAwKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIHRoaXMucmVwb3NpdG9yeS5zd2FwQXJyYXkodGhpcy51aXN0YXRlLmNvbXBvbmVudHMsIGksIGkgLSAxKTtcclxuXHJcbiAgICB0aGlzLmNtcGxpc3QubG9hZERhdGEodGhpcy51aXN0YXRlLmNvbXBvbmVudHMpO1xyXG4gICAgdGhpcy5jbXBsaXN0LnNlbGVjdFJvdyhjdXJDbXBJZCwgdHJ1ZSk7XHJcbiAgfVxyXG5cclxuICBtb3ZlRG93bigpIHtcclxuICAgIGlmICghdGhpcy51aXN0YXRlLmN1ckNvbXBvbmVudCkge1xyXG4gICAgICB0aGlzLm1lc3NhZ2UuaW5mbyh0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKCdjb21wb25lbnQuYWN0aXZpdHlDb21wb25lbnQuY3VyQ29tcG9uZW50JykpO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBjb25zdCBjdXJDbXBJZDogc3RyaW5nID0gdGhpcy51aXN0YXRlLmN1ckNvbXBvbmVudC5pZDtcclxuICAgIGNvbnN0IGkgPSB0aGlzLnVpc3RhdGUuY29tcG9uZW50cy5maW5kSW5kZXgoYyA9PiBjLmlkID09PSBjdXJDbXBJZCk7XHJcbiAgICBpZiAoaSA9PT0gdGhpcy51aXN0YXRlLmNvbXBvbmVudHMubGVuZ3RoIC0gMSkge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICB0aGlzLnJlcG9zaXRvcnkuc3dhcEFycmF5KHRoaXMudWlzdGF0ZS5jb21wb25lbnRzLCBpLCBpICsgMSk7XHJcblxyXG4gICAgdGhpcy5jbXBsaXN0LmxvYWREYXRhKHRoaXMudWlzdGF0ZS5jb21wb25lbnRzKTtcclxuICAgIHRoaXMuY21wbGlzdC5zZWxlY3RSb3coY3VyQ21wSWQsIHRydWUpO1xyXG4gIH1cclxuXHJcbiAgY2xpY2tBY3Rpb24oYnV0dG9uSWQ6IHN0cmluZywgY3R4OiBhbnkpIHtcclxuICAgIHRoaXMudWlzdGF0ZS5jdXJDb21wb25lbnQgPSBjdHgucm93RGF0YTtcclxuICAgIHN3aXRjaCAoYnV0dG9uSWQpIHtcclxuICAgICAgY2FzZSAnZWRpdCc6XHJcbiAgICAgICAgdGhpcy5lZGl0KCk7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgJ2RlbGV0ZVJvdyc6XHJcbiAgICAgICAgdGhpcy5kZWxldGVSb3coKTtcclxuICAgICAgICBicmVhaztcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGNsaWNrT0soKSB7XHJcbiAgICB0aGlzLmNsb3NlQ2VsbEVkaXQoKTtcclxuICAgIGlmICh0aGlzLnZhbGlkYXRvcigpKSB7XHJcbiAgICAgIGNvbnN0IG9iamVjdCA9IHsgdmFsdWU6IHRoaXMudWlzdGF0ZS5jb21wb25lbnRzLCBwYXJhbWV0ZXJzOiBudWxsIH07XHJcbiAgICAgIHRoaXMuc3VibWl0TW9kYWwuZW1pdChvYmplY3QpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgY2xpY2tDYW5jZWwoKSB7XHJcbiAgICB0aGlzLmNsb3NlTW9kYWwuZW1pdCgpO1xyXG4gIH1cclxuICBjb21wb25lbnRTZWxlY3QoKSB7XHJcbiAgICB0aGlzLmVkaXRTdGF0ZSA9ICduZXcnO1xyXG4gICAgY29uc3QgY29tcEZhY3RvcnkgPSB0aGlzLnJlc29sdmVyLnJlc29sdmVDb21wb25lbnRGYWN0b3J5KEVkaXRDb21wb25lbnRQYXJhbWV0ZXJDb21wb25lbnQpO1xyXG4gICAgY29uc3QgY29tcFJlZiA9IGNvbXBGYWN0b3J5LmNyZWF0ZSh0aGlzLmluamVjdG9yKTtcclxuICAgIGNvbnN0IG1vZGFsQ29uZmlnID0ge1xyXG4gICAgICB0aXRsZTogdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybSgnY29tcG9uZW50LmFjdGl2aXR5Q29tcG9uZW50Lm5ld0NvbXBvbmVudCcpLFxyXG4gICAgICB3aWR0aDogNzAwLFxyXG4gICAgICBoZWlnaHQ6IDQwMCxcclxuICAgICAgYnV0dG9uczogY29tcFJlZi5pbnN0YW5jZS5lZGl0Rm9vdGVyLFxyXG4gICAgICBzaG93QnV0dG9uczogdHJ1ZVxyXG4gICAgfTtcclxuICAgIGNvbnN0IGVkaXREaWFsb2cgPSB0aGlzLm1vZGFsU2VydmljZS5zaG93KGNvbXBSZWYsIG1vZGFsQ29uZmlnKTtcclxuICAgIGNvbXBSZWYuaW5zdGFuY2UuY2FuRWRpdCA9IHRydWU7XHJcbiAgICBjb21wUmVmLmluc3RhbmNlLmVkaXRTdGF0ZSA9IHRoaXMuZWRpdFN0YXRlO1xyXG4gICAgY29tcFJlZi5pbnN0YW5jZS5sb2NhdGlvbiA9IHRoaXMubG9jYXRpb247XHJcbiAgICBjb21wUmVmLmluc3RhbmNlLmV4ZWN1dGlvblRpbWluZ0xpc3QgPSB0aGlzLnVpc3RhdGUuZXhlY3V0aW9uQ29sbGVjdGlvbjtcclxuICAgIGNvbXBSZWYuaW5zdGFuY2UuY3VyQ29tcG9uZW50ID0gbmV3IEJpekNvbXBvbmVudEVudGl0eSgpO1xyXG4gICAgY29tcFJlZi5pbnN0YW5jZS5zdWJtaXRFbWl0dGVyLnN1YnNjcmliZShjbXAgPT4ge1xyXG4gICAgICB0aGlzLnVpc3RhdGUuY29tcG9uZW50cy5wdXNoKGNtcCk7XHJcbiAgICAgIHRoaXMuY21wbGlzdC5sb2FkRGF0YSh0aGlzLnVpc3RhdGUuY29tcG9uZW50cyk7XHJcbiAgICAgIGVkaXREaWFsb2cuY2xvc2UoKVxyXG4gICAgfSk7XHJcbiAgICBjb21wUmVmLmluc3RhbmNlLmNsb3NlRW1pdHRlci5zdWJzY3JpYmUocmUgPT4ge1xyXG4gICAgICBlZGl0RGlhbG9nLmNsb3NlKClcclxuICAgIH0pO1xyXG4gICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgIGNvbXBSZWYuaW5zdGFuY2UuY2QuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gICAgfSlcclxuICB9XHJcbiAgLyoqXHJcbiAgICog5Y+W5pWw5p6E5Lu25biu5YqpbmV3XHJcbiAgICovXHJcbiAgb3BlbkNvbXBvbmVudFNlbGVjdG9yTmV3KG1ldGFkYXRhSWQ6IHN0cmluZywgc2Vzc2lvbklkOiBzdHJpbmcpIHtcclxuICAgIHRoaXMuY29tcG9uZW50U2VydmljZS5vcGVuU2VsZWN0b3IobWV0YWRhdGFJZCwgc2Vzc2lvbklkKS5zdWJzY3JpYmUoXHJcbiAgICAgIChzZWxlY3RvclJlc3VsdDogU2VsZWN0b3JSZXN1bHQpID0+IHtcclxuICAgICAgICBzZWxlY3RvclJlc3VsdC5jb25maXJtRXZlbnQuc3Vic2NyaWJlKFxyXG4gICAgICAgICAgKHJlc3VsdDogR3NwQ29tcG9uZW50KSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMudmlld01vZGVsLmNvbXBvbmVudFNlbGVjdChyZXN1bHQpO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgIH0pO1xyXG4gIH1cclxuICBzaG93RXhwckhlbHAoZTogYW55KSB7XHJcbiAgICBsZXQgY29udGV4dCA9IG5ldyBBcnJheTxWYXJFbnRpdHk+KCk7XHJcbiAgICAvLyBpZih0aGlzLmV4cHIuZXhwckVudGl0eS5jb250ZXh0RW50aXRpZXMuZmluZCh4ID0+IHgua2V5ID09PSAnQ3VycmVudExhbmd1YWdlJykpIHtcclxuICAgIC8vICAgY29udGV4dC5wdXNoKHRoaXMuZXhwci5leHByRW50aXR5LmNvbnRleHRFbnRpdGllcy5maW5kKHggPT4geC5rZXkgPT09ICdDdXJyZW50TGFuZ3VhZ2UnKSk7XHJcbiAgICAvLyB9XHJcbiAgICAvLyB0aGlzLmV4cHIuY2xlYXJDb250ZXh0KCk7XHJcbiAgICBpZiAodGhpcy5kZXNpZ25lclN0YXRlLnNjaGVtYXMubGVuZ3RoID4gMCkge1xyXG4gICAgICBmb3IgKGNvbnN0IHNjaGVtYSBvZiB0aGlzLmRlc2lnbmVyU3RhdGUuc2NoZW1hcykge1xyXG4gICAgICAgIHRoaXMuZXhwci5hZGRTY2hlbWEoJ1NjaGVtYScsIHNjaGVtYSk7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKHRoaXMuZGVzaWduZXJTdGF0ZS5zY2hlbWFzWzBdLmVudGl0eVR5cGVzICYmIHRoaXMuZGVzaWduZXJTdGF0ZS5zY2hlbWFzWzBdLmVudGl0eVR5cGVzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICBjb25zdCBlbnRpdHlUeXBlID0gdGhpcy5kZXNpZ25lclN0YXRlLnNjaGVtYXNbMF0uZW50aXR5VHlwZXNbMF07XHJcbiAgICAgICAgdGhpcy5leHByLmFkZEluamVjdGVkRW50aXR5KGVudGl0eVR5cGUubmFtZSwgJ1NjaGVtYScsXHJcbiAgICAgICAgICBlbnRpdHlUeXBlLm5hbWUsIEluamVjdGVkVHlwZS5FbnRpdHlUeXBlKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgY29udGV4dCA9IHRoaXMuZGVzaWduZXJTdGF0ZS5hZGRDb250ZXh0KGNvbnRleHQpO1xyXG4gICAgaWYgKHRoaXMubG9jYXRpb24gPT09ICdhY3Rpdml0eScpIHtcclxuICAgICAgZm9yIChjb25zdCB2YXJpYWJsZSBvZiB0aGlzLmRlc2lnbmVyU3RhdGUuYWN0aXZpdHlDb21wb25lbnRDb250ZXh0KSB7XHJcbiAgICAgICAgaWYgKCFjb250ZXh0LnNvbWUoYyA9PiBjLmtleSA9PT0gdmFyaWFibGUua2V5KSkge1xyXG4gICAgICAgICAgY29udGV4dC5wdXNoKHZhcmlhYmxlKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIGlmICh0aGlzLmxvY2F0aW9uID09PSAnYWN0aXZpdHknKSB7XHJcbiAgICAgIGZvciAoY29uc3QgdmFyaWFibGUgb2YgdGhpcy5kZXNpZ25lclN0YXRlLnN1YkFjdGl2aXR5Q29udGV4dCkge1xyXG4gICAgICAgIGlmICghY29udGV4dC5zb21lKGMgPT4gYy5rZXkgPT09IHZhcmlhYmxlLmtleSkpIHtcclxuICAgICAgICAgIGNvbnRleHQucHVzaCh2YXJpYWJsZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBpZiAoY29udGV4dC5sZW5ndGggPiAwKSB7XHJcbiAgICAgIGZvciAoY29uc3QgdiBvZiBjb250ZXh0KSB7XHJcbiAgICAgICAgdGhpcy5leHByLmFkZENvbnRleHQodik7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIHRoaXMuZXhwci5zZXRFZGl0UGF0dGVybihFeHByRWRpdE1vZGUuQWR2YW5jZWQpOyAvLyDpu5jorqTmiZPlvIDpq5jnuqfooajovr7lvI/nvJbovpHlmahcclxuICAgIHRoaXMuZXhwci5hZGRFeHByZXNzaW9uVGV4dChlLmluc3RhbmNlLnZhbHVlKTtcclxuICAgIHRoaXMuZXhwci5idWlsZEV4cHJlc3Npb24oKS50aGVuKChleHByZXNzaW9uaW5mbzogc3RyaW5nKSA9PiB7XHJcbiAgICAgIGUuZm9ybUNvbnRyb2wuc2V0VmFsdWUoZXhwcmVzc2lvbmluZm8pO1xyXG4gICAgICBlLmluc3RhbmNlLmNkLmRldGVjdENoYW5nZXMoKTtcclxuICAgICAgLy/ngrnlh7vnoa7lrprlkI7vvIzljrvpmaTooajovr7lvI/ph4zpnaLnmoTmlrDlop7nmoTkuIrkuIvmloflj5jph49cclxuICAgICAgaWYoY29udGV4dC5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgdGhpcy5leHByLmV4cHJFbnRpdHkuY29udGV4dEVudGl0aWVzID0gdGhpcy5leHByLmV4cHJFbnRpdHkuY29udGV4dEVudGl0aWVzLmZpbHRlcih4ID0+ICFjb250ZXh0LnNvbWUoeSA9PiB5LmtleSA9PT0geC5rZXkpKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG4gIHNlbGVjdGlvbkNoYW5nZShkYXRhOiBhbnkpIHtcclxuICAgIHRoaXMudWlzdGF0ZS5jdXJDb21wb25lbnQgPSBkYXRhLmRhdGE7XHJcbiAgfVxyXG4gIHBhcmFtQWZ0ZXJFZGl0ID0gKHJvd0luZGV4OiBudW1iZXIsIHJvd0RhdGE6IGFueSwgY29sdW1uPzogRGF0YUNvbHVtbikgPT4ge1xyXG4gICAgcmV0dXJuIG9mKHRydWUpO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBjbG9zZUNlbGxFZGl0KCkge1xyXG4gICAgdGhpcy5jbXBsaXN0LmVuZENlbGxFZGl0KCk7XHJcbiAgICBpZiAodGhpcy5wYXJhbWxpc3QpIHtcclxuICAgICAgdGhpcy5wYXJhbWxpc3QuZW5kQ2VsbEVkaXQoKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgdmFsaWRhdG9yKCk6IGJvb2xlYW4ge1xyXG4gICAgLy8g5qCh6aqM5piv5ZCm5a2Y5Zyo6YeN5aSN55qE5p6E5Lu2XHJcbiAgICBjb25zdCBjYWNoZSA9IFtdO1xyXG4gICAgZm9yIChjb25zdCBjbXAgb2YgdGhpcy51aXN0YXRlLmNvbXBvbmVudHMpIHtcclxuICAgICAgaWYgKGNhY2hlLmZpbmQoYyA9PiBjLm1ldGhvZENvZGUgPT09IGNtcC5tZXRob2RDb2RlICYmIEpTT04uc3RyaW5naWZ5KGMuYWN0dWFsUGFyYW1ldGVycykgPT09IEpTT04uc3RyaW5naWZ5KGNtcC5hY3R1YWxQYXJhbWV0ZXJzKSAmJlxyXG4gICAgICAgIGMuZXhlY3V0aW9uVGltZSA9PT0gY21wLmV4ZWN1dGlvblRpbWUpKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coY21wLmFjdHVhbFBhcmFtZXRlcnMpO1xyXG4gICAgICAgIHRoaXMubWVzc2FnZS53YXJuaW5nKHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oJ2NvbXBvbmVudC5hY3Rpdml0eUNvbXBvbmVudC5zYW1lQ21wJykgKyBgJHtjbXAubmFtZX1gICsgdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybSgnY29tcG9uZW50LmFjdGl2aXR5Q29tcG9uZW50LmNtcE1ldGhvZCcpKyBjbXAubWV0aG9kQ29kZSArIHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oJ2NvbXBvbmVudC5hY3Rpdml0eUNvbXBvbmVudC5wbGVhc2VDaGVjaycpKTtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgIH1cclxuICAgICAgY2FjaGUucHVzaChjbXApO1xyXG4gICAgICBpZiAoIWNtcC5leGVjdXRpb25UaW1lICYmIHRoaXMubG9jYXRpb24gIT09ICdhdXRvQWN0aXZpdHknKSB7XHJcbiAgICAgICAgdGhpcy5tZXNzYWdlLndhcm5pbmcodGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybSgnY29tcG9uZW50LmFjdGl2aXR5Q29tcG9uZW50LmV4ZWN1dGlvblRpbWVOb3ROdWxsJykpO1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgfVxyXG4gICAgICBmb3IgKGNvbnN0IHBhcmFtIG9mIGNtcC5hY3R1YWxQYXJhbWV0ZXJzKSB7XHJcbiAgICAgICAgaWYgKHBhcmFtLnJlcXVpcmVkICYmICFwYXJhbS52YWx1ZSkge1xyXG4gICAgICAgICAgdGhpcy5tZXNzYWdlLndhcm5pbmcodGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybSgnY29tcG9uZW50LmFjdGl2aXR5Q29tcG9uZW50LmNvbXBvbmVudCcpICsgYOOAkCR7Y21wLm5hbWV944CRYCArIHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oJ2NvbXBvbmVudC5hY3Rpdml0eUNvbXBvbmVudC5wYXJhbScpICsgYOOAkCR7cGFyYW0uY29kZX3jgJFgICsgdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybSgnY29tcG9uZW50LmFjdGl2aXR5Q29tcG9uZW50LnJlcXVpcmVkJykpO1xyXG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRydWU7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgQWN0aXZpdHlDb21wb25lbnRDb252ZXJ0ZXIgaW1wbGVtZW50cyBUeXBlQ29udmVydGVyIHtcclxuICBjb25zdHJ1Y3RvcihcclxuICAgIHByaXZhdGUgbG9jYWxlUGlwZTogV2ZMb2NhbGVQaXBlXHJcbiAgKSB7IH1cclxuXHJcbiAgY29udmVydFRvKGRhdGE6IGFueVtdKTogc3RyaW5nIHtcclxuICAgIGlmIChkYXRhICYmIGRhdGEubGVuZ3RoID4gMCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybShcImNvbXBvbmVudC5hY3Rpdml0eUNvbXBvbmVudC5zZXRcIik7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICByZXR1cm4gdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybShcImNvbXBvbmVudC5hY3Rpdml0eUNvbXBvbmVudC5ub3RTZXRcIik7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcbiJdfQ==