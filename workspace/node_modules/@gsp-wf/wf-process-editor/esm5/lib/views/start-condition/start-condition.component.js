/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { ChangeDetectorRef, Component, ComponentFactoryResolver, EventEmitter, Inject, Injector, Input, LOCALE_ID, Output, TemplateRef, ViewChild } from '@angular/core';
import { ActivatedRoute, Router } from '@angular/router';
import { BpmnModelJsonHelper, ComponentConditionContent, ConditionEntity, ConditionType, ExpressionConditionContent } from '@edp-bif/common-api';
import { DatagridComponent } from '@farris/ui-datagrid';
import { LoadingService } from '@farris/ui-loading';
import { MessagerService } from '@farris/ui-messager';
import { BsModalService } from '@farris/ui-modal';
import { NotifyService } from '@farris/ui-notify';
import { GSPMetadataRTService, SelectMetadataRTComponent } from '@gsp-lcm/metadatart-selector';
import { ExpressionService, InjectedType } from '@gsp-svc/expression';
import { FrameworkService } from '@gsp-sys/rtf-common';
import { of } from 'rxjs';
import { AifLocalePipe, BIF_LANG_RESOURCES } from '../aif-ui-common/pipe/aif-ui-common-locale.pipe';
import { StartConditionService } from './start-condition.service';
import { DataEntityService } from '@gsp-svc/data-entity-adapter';
import { EditorTypes } from '@farris/ui-datagrid-editors';
import { AbstractDatagridComponent } from './abstract-datagrid-component';
import { LANG_RESOURCES } from './i18n/lang.resource';
import { ProcessDesignerUIState } from '../../app/process-designer.uistate';
var ɵ0 = LANG_RESOURCES;
var StartConditionComponent = /** @class */ (function (_super) {
    tslib_1.__extends(StartConditionComponent, _super);
    function StartConditionComponent(startConditionService, designerState, metadata, expr, des, messager, notify, modal, framework, router, activatedRoute, loading, localeId, localePipe, cfr, cdf, inj) {
        var _this = _super.call(this, messager, notify, metadata, modal, localePipe, inj, cfr, cdf) || this;
        _this.startConditionService = startConditionService;
        _this.designerState = designerState;
        _this.metadata = metadata;
        _this.expr = expr;
        _this.des = des;
        _this.messager = messager;
        _this.notify = notify;
        _this.modal = modal;
        _this.framework = framework;
        _this.router = router;
        _this.activatedRoute = activatedRoute;
        _this.loading = loading;
        _this.localePipe = localePipe;
        _this.cfr = cfr;
        _this.cdf = cdf;
        _this.inj = inj;
        _this.groupIcon = '<i class="f-icon f-icon-lookup"></i>';
        _this.closeModal = new EventEmitter();
        _this.submitModal = new EventEmitter();
        _this.editorParams = {};
        _this.modalConfig = {
            title: '启动条件',
            width: 900,
            height: 400,
            showButtons: true,
            showHeader: false
        };
        _this.dgIdField = "id";
        _this.designedConditionEntities = new Array();
        _this.editingRowId = null;
        _this.canEdit = true;
        _this.beforeEdit = (/**
         * @param {...?} args
         * @return {?}
         */
        function () {
            var args = [];
            for (var _i = 0; _i < arguments.length; _i++) {
                args[_i] = arguments[_i];
            }
            // console.log('Before Edit', args);
            return of(true);
        });
        _this.afterEdit = (/**
         * @param {?} rowIndex
         * @param {?} rowData
         * @param {...?} args
         * @return {?}
         */
        function (rowIndex, rowData) {
            var args = [];
            for (var _i = 2; _i < arguments.length; _i++) {
                args[_i - 2] = arguments[_i];
            }
            if (rowData.component && rowData.component.compMetadataId) {
                return of(true);
            }
            else if (rowData.expression && rowData.expression.exprContent) {
                return of(true);
            }
            else {
                _this.notify.warning(_this.localePipe.instant("eventRouterConditionsContentCantBeEmpty"));
                return of(false);
            }
        });
        return _this;
    }
    Object.defineProperty(StartConditionComponent.prototype, "value", {
        set: /**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            data = data ? data : '[]';
            /** @type {?} */
            var conditionEntities = data ? [] : BpmnModelJsonHelper.FromJson(data, ConditionEntity);
            this.designedConditionEntities = conditionEntities.map((/**
             * @param {?} item
             * @return {?}
             */
            function (item) {
                /** @type {?} */
                var entity = {
                    id: item.id,
                    isEnabled: item.isEnabled,
                    name: item.name,
                    type: item.type,
                    remarks: item.remarks,
                    component: {},
                    expression: {},
                };
                if (entity.type == ConditionType.COMPONENT) {
                    /** @type {?} */
                    var compCondCont = new ComponentConditionContent();
                    compCondCont.LoadFromJson(item.content);
                    entity.component.compId = compCondCont.componentId;
                    entity.component.compMetadataId = compCondCont.componentMetadataId;
                    entity.component.compName = compCondCont.name;
                    entity.displayedContent = entity.component.compName;
                }
                else if (entity.type == ConditionType.EXPRESSION) {
                    /** @type {?} */
                    var exprContent = new ExpressionConditionContent();
                    exprContent.LoadFromJson(item.content);
                    entity.expression.exprContent = exprContent.expressionContent;
                    entity.displayedContent = entity.expression.exprContent;
                }
                else {
                }
                return entity;
            }));
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(StartConditionComponent.prototype, "dgData", {
        get: /**
         * @return {?}
         */
        function () {
            return this.designedConditionEntities;
        },
        set: /**
         * @param {?} arr
         * @return {?}
         */
        function (arr) {
            this.designedConditionEntities = arr;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(StartConditionComponent.prototype, "dgTotal", {
        get: /**
         * @return {?}
         */
        function () {
            return this.dgData.length || 0;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    StartConditionComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        this.configDgColumns();
    };
    /**
     * @return {?}
     */
    StartConditionComponent.prototype.clickOk = /**
     * @return {?}
     */
    function () {
        if (this.dg.isEditing() || this.editingRowId != null) {
            return;
        }
        /** @type {?} */
        var conditionEntities = this.designedConditionEntities.map((/**
         * @param {?} entity
         * @return {?}
         */
        function (entity) {
            /** @type {?} */
            var item = new ConditionEntity();
            item.id = entity.id;
            item.isEnabled = entity.isEnabled;
            item.name = entity.name;
            item.type = entity.type;
            item.remarks = entity.remarks;
            if (entity.type == ConditionType.COMPONENT) {
                /** @type {?} */
                var compCondCont = new ComponentConditionContent();
                compCondCont.name = entity.component.compName;
                compCondCont.componentId = entity.component.compId;
                compCondCont.componentMetadataId = entity.component.compMetadataId;
                item.content = compCondCont.ConvertToJson();
            }
            else if (entity.type == ConditionType.EXPRESSION) {
                /** @type {?} */
                var exprContent = new ExpressionConditionContent();
                exprContent.expressionContent = entity.expression.exprContent;
                item.content = exprContent.ConvertToJson();
            }
            else {
            }
            return item;
        }));
        /** @type {?} */
        var val = BpmnModelJsonHelper.ToJson(conditionEntities);
        /** @type {?} */
        var obj = { value: val, parameters: null };
        this.submitModal.emit(obj);
    };
    /**
     * @return {?}
     */
    StartConditionComponent.prototype.clickCancel = /**
     * @return {?}
     */
    function () {
        this.closeModal.emit();
    };
    /**
     * @return {?}
     */
    StartConditionComponent.prototype.load = /**
     * @return {?}
     */
    function () {
        throw new Error('Method not implemented.');
    };
    /**
     * @param {?} args
     * @return {?}
     */
    StartConditionComponent.prototype.toolbarClickHandler = /**
     * @param {?} args
     * @return {?}
     */
    function (args) {
        switch (args.id) {
            case 'btn-add':
                this.add();
                break;
            case 'btn-remove':
                this.remove(null);
                break;
        }
    };
    /**
     * @return {?}
     */
    StartConditionComponent.prototype.add = /**
     * @return {?}
     */
    function () {
        var _this = this;
        if (this.dg.isEditing() == false || this.dg.isEditing() == null) {
            /** @type {?} */
            var newItem_1 = this.startConditionService.createConditionEntity();
            /** @type {?} */
            var newEntity = {
                id: newItem_1.id,
                name: newItem_1.name,
                type: newItem_1.type,
                isEnabled: newItem_1.isEnabled,
                remarks: newItem_1.remarks,
                component: {},
                expression: {},
            };
            this.dgData = tslib_1.__spread(this.dgData, [newEntity]);
            this.cdf.detectChanges();
            setTimeout((/**
             * @return {?}
             */
            function () {
                _this.dg.editRow(newItem_1.id);
                _this.editingRowId = newItem_1.id;
            }), 0);
        }
        else {
            this.notify.warning(this.localePipe.instant("pleaseEndCurrentRowEditing"));
        }
    };
    /**
     * 行删除
     * @param ctx
     */
    /**
     * 行删除
     * @param {?} evt
     * @param {?=} ctx
     * @return {?}
     */
    StartConditionComponent.prototype.remove = /**
     * 行删除
     * @param {?} evt
     * @param {?=} ctx
     * @return {?}
     */
    function (evt, ctx) {
        var e_1, _a;
        /** @type {?} */
        var ids = [];
        if (ctx == null) {
            // 批量删除
            this.dg.checkeds.forEach((/**
             * @param {?} it
             * @return {?}
             */
            function (it) {
                ids.push(it.id);
            }));
        }
        else {
            // 行内删除
            ids.push(ctx.rowData.id);
        }
        if (ids.length == 0) {
            this.notify.warning(this.localePipe.instant("pleaseSelectOneItemAtLeast"));
            if (evt != null) {
                evt.stopPropagation();
            }
            return false;
        }
        try {
            for (var ids_1 = tslib_1.__values(ids), ids_1_1 = ids_1.next(); !ids_1_1.done; ids_1_1 = ids_1.next()) {
                var id = ids_1_1.value;
                this.dg.deleteRow(id);
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (ids_1_1 && !ids_1_1.done && (_a = ids_1.return)) _a.call(ids_1);
            }
            finally { if (e_1) throw e_1.error; }
        }
        this.dgData = this.dg.data;
        if (this.editingRowId != null) {
            if (ids.includes(this.editingRowId)) {
                this.editingRowId = null;
            }
            else {
                this.dg.editRow(this.editingRowId);
            }
        }
        this.cdf.detectChanges();
        if (evt != null) {
            evt.stopPropagation();
        }
        return false;
    };
    /**
     * @param {?} e
     * @return {?}
     */
    StartConditionComponent.prototype.selectContent = /**
     * @param {?} e
     * @return {?}
     */
    function (e) {
        switch (e.form.value.type) {
            case ConditionType.COMPONENT:
                this.selectCommonComp(e);
                break;
            case ConditionType.EXPRESSION:
                this.showExpression(e);
                break;
            // case ConditionType.FULL_EXPRESSION:
            //   this.showExpression(e);
            //   break;
            // case ConditionType.INCREMENTAL_EXPRESSION:
            //   this.showExpression(e);
            //   break;
            case ConditionType.VOACTION:
                this.selectVOAction(e);
                break;
        }
    };
    /**
     * @param {?} e
     * @return {?}
     */
    StartConditionComponent.prototype.selectCommonComp = /**
     * @param {?} e
     * @return {?}
     */
    function (e) {
        /** @type {?} */
        var compFactory = this.cfr.resolveComponentFactory(SelectMetadataRTComponent);
        /** @type {?} */
        var compRef = compFactory.create(this.inj);
        compRef.instance.typeList = "CommonComponent";
        // compRef.instance.boId = `${this.processContent.upBillBoId},${this.processContent.downBillBoId}`;
        compRef.instance.selectedMetadata.subscribe((/**
         * @param {?} metadata4RefDto
         * @return {?}
         */
        function (metadata4RefDto) {
            /** @type {?} */
            var content = new ComponentConditionContent();
            /** @type {?} */
            var metadata = metadata4RefDto.metadata;
            /** @type {?} */
            var entity = e.form.bindingData;
            entity.component.compName = metadata.name;
            entity.component.compMetadataId = metadata.id;
            /** @type {?} */
            var metadataContent = JSON.parse(metadata.content);
            entity.component.compId = metadataContent.id || metadataContent.Id || metadataContent.ID || metadata.id;
            entity.displayedContent = entity.component.compName;
            e.formControl.setValue(entity.displayedContent);
            e.instance.cd.detectChanges();
        }));
        /** @type {?} */
        var modalConfig = {
            title: this.localePipe.instant("commonComponentMetadataSelector"),
            width: 930,
            height: 573,
            showButtons: false
        };
        /** @type {?} */
        var dialog = this.modal.show(compRef, modalConfig);
        compRef.instance.closeModalEmitter.subscribe((/**
         * @param {?} $event
         * @return {?}
         */
        function ($event) { return dialog.close(); }));
    };
    /**
     * @param {?} e
     * @return {?}
     */
    StartConditionComponent.prototype.selectVOAction = /**
     * @param {?} e
     * @return {?}
     */
    function (e) {
    };
    /**
     * @param {?} e
     * @return {?}
     */
    StartConditionComponent.prototype.showExpression = /**
     * @param {?} e
     * @return {?}
     */
    function (e) {
        var _this = this;
        var e_2, _a, e_3, _b;
        // this.expr.clearContext();
        /** @type {?} */
        var context = new Array();
        if (this.designerState.subActivityContext.length > 0) {
            var _loop_1 = function (variable) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    context.push(variable);
                }
            };
            try {
                for (var _c = tslib_1.__values(this.designerState.subActivityContext), _d = _c.next(); !_d.done; _d = _c.next()) {
                    var variable = _d.value;
                    _loop_1(variable);
                }
            }
            catch (e_2_1) { e_2 = { error: e_2_1 }; }
            finally {
                try {
                    if (_d && !_d.done && (_a = _c.return)) _a.call(_c);
                }
                finally { if (e_2) throw e_2.error; }
            }
        }
        if (context.length > 0) {
            try {
                for (var context_1 = tslib_1.__values(context), context_1_1 = context_1.next(); !context_1_1.done; context_1_1 = context_1.next()) {
                    var v = context_1_1.value;
                    this.expr.addContext(v);
                }
            }
            catch (e_3_1) { e_3 = { error: e_3_1 }; }
            finally {
                try {
                    if (context_1_1 && !context_1_1.done && (_b = context_1.return)) _b.call(context_1);
                }
                finally { if (e_3) throw e_3.error; }
            }
        }
        this.expr.addExpressionText(e.formControl.value);
        this.configExpressionExpendFuncs();
        /** @type {?} */
        var schema$ = this.des.getSchemaById(this.editorParams.voId);
        schema$.subscribe((/**
         * @param {?} schema
         * @return {?}
         */
        function (schema) {
            _this.expr.addNewSchema(schema.name, schema);
            _this.expr.addInjectedEntity(schema.entityTypes[0].code, schema.name, schema.entityTypes[0].code, InjectedType.EntityType);
            _this.expr.buildExpression(!_this.canEdit).then((/**
             * @param {?} expressioninfo
             * @return {?}
             */
            function (expressioninfo) {
                /** @type {?} */
                var content = new ExpressionConditionContent();
                /** @type {?} */
                var temp = expressioninfo;
                /** @type {?} */
                var entity = e.form.bindingData;
                entity.expression.exprContent = temp;
                entity.displayedContent = entity.expression.exprContent;
                e.formControl.setValue(entity.displayedContent);
                e.instance.cd.detectChanges();
                //点击确定后，去除表达式里面的新增的上下文变量
                if (context.length > 0) {
                    _this.expr.exprEntity.contextEntities = _this.expr.exprEntity.contextEntities.filter((/**
                     * @param {?} x
                     * @return {?}
                     */
                    function (x) { return !context.some((/**
                     * @param {?} y
                     * @return {?}
                     */
                    function (y) { return y.key === x.key; })); }));
                }
            }));
        }));
    };
    /**
     * @param {?} e
     * @return {?}
     */
    StartConditionComponent.prototype.clearContent = /**
     * @param {?} e
     * @return {?}
     */
    function (e) {
        /** @type {?} */
        var entity = e.form.bindingData;
        entity.displayedContent = null;
        //构件
        entity.component.compName = null;
        entity.component.compMetadataId = null;
        entity.component.compId = null;
        //表达式
        entity.expression.exprContent = null;
        //VO动作
        e.formControl.setValue(null);
        e.instance.cd.detectChanges();
    };
    /**
     * @return {?}
     */
    StartConditionComponent.prototype.configDgColumns = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.dgColumns = [
            // { field: 'id', title: this.localePipeService.instant("id"), width: 160 },
            {
                field: 'isEnabled', title: this.localePipe.instant("isEnabled"), width: 100, template: this.dgIsEnabledStateCell,
            },
            {
                field: 'type', title: this.localePipe.instant("type"), width: 120,
                editor: {
                    type: EditorTypes.SELECT,
                    options: {
                        idField: "value",
                        valueField: 'value',
                        textField: 'text',
                        data: [
                            // { value: ConditionType.VOACTION, text: this.localePipeService.instant("billAction") },
                            // { value: ConditionType.EXPRESSION, text: this.localePipe.instant("expression") },
                            { value: ConditionType.COMPONENT, text: this.localePipe.instant("commonComponent") },
                        ]
                    },
                    validators: [
                        { type: 'required', messager: this.localePipe.instant("typeMustNotBeNull") },
                    ]
                },
                validators: [
                    { type: 'required' },
                ],
                formatter: (/**
                 * @param {?} value
                 * @param {?} rowData
                 * @param {?} rowIndex
                 * @return {?}
                 */
                function (value, rowData, rowIndex) {
                    switch (value) {
                        case ConditionType.COMPONENT:
                            return _this.localePipe.instant("commonComponent");
                        case ConditionType.EXPRESSION:
                            return _this.localePipe.instant("expression");
                        // case ConditionType.FULL_EXPRESSION:
                        //   return this.localePipe.instant("fullExpression");
                        // case ConditionType.INCREMENTAL_EXPRESSION:
                        //   return this.localePipe.instant("incrementalExpression");
                        case ConditionType.VOACTION:
                            return _this.localePipe.instant("billAction");
                        default:
                            return "Unknown";
                    }
                })
            },
            {
                field: "displayedContent", title: this.localePipe.instant("content"), width: 200,
                editor: {
                    type: EditorTypes.INPUTGROUP,
                    options: {
                        groupText: this.groupIcon,
                        editable: false,
                        clickHandle: (/**
                         * @param {?} e
                         * @return {?}
                         */
                        function (e) {
                            _this.selectContent(e);
                        }),
                        clear: (/**
                         * @param {?} e
                         * @return {?}
                         */
                        function (e) {
                            _this.clearContent(e);
                        }),
                    },
                    validators: [
                        { type: 'required', messager: this.localePipe.instant("contentMustNotBeNull") }
                    ]
                },
                validators: [
                    { type: 'required' },
                ],
            },
            {
                field: 'remarks', title: this.localePipe.instant("description"), width: 200,
                editor: {
                    type: EditorTypes.TEXTAREA, options: {},
                }
            },
            { field: null, title: this.localePipe.instant("operation"), width: 250, template: this.dgOpCell, halign: 'center', align: 'center' },
        ];
    };
    /**
     * @param {?} param
     * @return {?}
     */
    StartConditionComponent.prototype.beginEdit = /**
     * @param {?} param
     * @return {?}
     */
    function (param) {
        // console.log('Begin Edit', param);
        this.editingRowId = param.rowData.id;
        /** @type {?} */
        var editors = param.gridInstance.getEditors();
        /** @type {?} */
        var select = editors[0];
        select.instance.formControl.valueChanges.subscribe((/**
         * @param {?} val
         * @return {?}
         */
        function (val) {
            if (select.instance.dr.form.bindingData.type != val) {
                select.instance.group.bindingData.displayedContent = null;
                select.instance.group.controls.displayedContent.setValue(null);
                select.instance.group.bindingData.remarks = null;
                select.instance.group.controls.remarks.setValue(null);
                select.instance.dr.cd.detectChanges();
            }
        }));
    };
    /**
     * @param {...?} args
     * @return {?}
     */
    StartConditionComponent.prototype.endEdit = /**
     * @param {...?} args
     * @return {?}
     */
    function () {
        var args = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            args[_i] = arguments[_i];
        }
        // console.log('End Edit', args);
        this.editingRowId = null;
    };
    /**
     * @param {...?} args
     * @return {?}
     */
    StartConditionComponent.prototype.cancelEdited = /**
     * @param {...?} args
     * @return {?}
     */
    function () {
        var args = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            args[_i] = arguments[_i];
        }
        // console.log('取消编辑', args);
        this.editingRowId = null;
    };
    /**
     * @return {?}
     */
    StartConditionComponent.prototype.configExpressionExpendFuncs = /**
     * @return {?}
     */
    function () {
        // let changeDetails: VarEntity =
        // {
        //   key: "changeDetails",
        //   name: "业务实体变更集列表",
        //   description: "业务实体变更集列表"
        // }
        // this.expr.addContext(changeDetails);
    };
    StartConditionComponent.decorators = [
        { type: Component, args: [{
                    selector: 'lib-start-condition',
                    template: "<div class=\"f-page f-page-is-managelist p-2\">\r\n  <div class=\"f-page-header-base\" style=\"min-height: unset;\">\r\n    <div class=\"f-title\">\r\n      <span class=\"f-title-icon f-text-orna-param\">\r\n        <i class=\"f-icon f-icon-clock\"></i>\r\n      </span>\r\n      <h4 class=\"f-title-text\" style=\"font-size: 1rem;\">\r\n        {{ 'startCondition' | aifLocale }}\r\n      </h4>\r\n    </div>\r\n    <f-response-toolbar class=\"f-toolbar\" #toolbar [datas]=\"toolbarData\" (rtClickEvent)=\"toolbarClickHandler($event)\"\r\n      [style.display]=\"canEdit==false?'none':null\">\r\n    </f-response-toolbar>\r\n  </div>\r\n  <div class=\"f-utils-fill-flex-column\">\r\n    <farris-datagrid #dg=\"datagrid\" [columns]=\"dgColumns\" [data]=\"dgData\" [editable]=\"canEdit\" [editMode]=\"'row'\"\r\n      [idField]=\"dgIdField\" [showLineNumber]=\"true\" [striped]=\"false\" [showBorder]=\"true\" [pagination]=\"false\"\r\n      [showAllCheckbox]=\"true\" [selectOnCheck]=\"false\" [checkOnSelect]=\"false\" [onlySelectSelf]=\"true\"\r\n      [showCheckbox]=\"true\" [multiSelect]=\"true\" [keepSelect]=\"true\" [fitColumns]=\"true\" [fit]=\"true\"\r\n      [virtualized]=\"false\" [clickToEdit]=\"false\" [beforeEdit]=\"beforeEdit\" (beginEdit)=\"beginEdit($event)\"\r\n      [afterEdit]=\"afterEdit\" (endEdit)=\"endEdit($event)\" (cancelEdited)=\"cancelEdited($event)\">\r\n    </farris-datagrid>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #dgIsEnabledStateCell let-ctx>\r\n  <div class=\"f-datagrid-cell-formgroup farris-group-auto\" style=\"line-height: 100%;\">\r\n    <farris-switch checked id=\"isEnabled\" [disabled]=\"!canEdit\" checkedLabel=\"{{'yes'|aifLocale}}\"\r\n      uncheckedLabel=\"{{'no'|aifLocale}}\" [(ngModel)]=\"ctx.rowData.isEnabled\"></farris-switch>\r\n  </div>\r\n</ng-template>\r\n\r\n<ng-template #dgOpCell let-ctx>\r\n  <ng-container\r\n    *ngIf=\"dg.isEditing()!=false&&dg.isEditing()!=null&&dg.selectedRow.id==ctx.rowData.id; else elseTemplate\">\r\n    <button class=\"btn btn-link mr-2\" [disabled]=\"!canEdit\" (click)=\"endRowEdit(ctx)\" title=\"{{'confirm'|aifLocale}}\">\r\n      <span class=\"f-icon f-icon-check\" [ngClass]=\"{'f-pretend-link': canEdit}\"\r\n        style=\"width: 20px; height: 20px; font-size: 20px;\"></span>\r\n    </button>\r\n  </ng-container>\r\n  <ng-template #elseTemplate>\r\n    <button class=\"btn btn-link mr-2\" [disabled]=\"!canEdit\" (click)=\"startRowEdit(ctx)\" title=\"{{'edit'|aifLocale}}\">\r\n      <span class=\"f-icon f-icon-edit-button\" [ngClass]=\"{'f-pretend-link': canEdit}\"\r\n        style=\"width: 20px; height: 20px; font-size: 20px;\"></span>\r\n    </button>\r\n  </ng-template>\r\n  <button class=\"btn btn-link mr-2\" [disabled]=\"!canEdit\" (click)=\"rowMove($event, ctx, -1)\"\r\n    title=\"{{'moveUp'|aifLocale}}\">\r\n    <span class=\"f-icon f-icon-arrow-seek-up\" [ngClass]=\"{'f-pretend-link': canEdit}\"\r\n      style=\"width: 20px; height: 20px; font-size: 20px;\"></span>\r\n  </button>\r\n  <button class=\"btn btn-link mr-2\" [disabled]=\"!canEdit\" (click)=\"rowMove($event, ctx, 1)\"\r\n    title=\"{{'moveDown'|aifLocale}}\">\r\n    <span class=\"f-icon f-icon-arrow-seek-down\" [ngClass]=\"{'f-pretend-link': canEdit}\"\r\n      style=\"width: 20px; height: 20px; font-size: 20px;\"></span>\r\n  </button>\r\n  <button class=\"btn btn-link mr-2\" [disabled]=\"!canEdit\" (click)=\"remove($event, ctx)\" title=\"{{'remove'|aifLocale}}\">\r\n    <span class=\"f-icon f-icon-delete\" [ngClass]=\"{'f-pretend-link': canEdit}\"\r\n      style=\"width: 20px; height: 20px; font-size: 20px;\"></span>\r\n  </button>\r\n</ng-template>\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type=\"button\" class=\"btn btn-secondary btn-sm px-3 mx-2\" (click)=\"clickCancel()\">\u53D6\u6D88</button>\r\n  <button type=\"button\" class=\"btn btn-primary btn-sm px-3 mx-2\" (click)=\"clickOk()\">\u786E\u5B9A</button>\r\n</ng-template>\r\n",
                    providers: [
                        { provide: BIF_LANG_RESOURCES, useValue: ɵ0 },
                        AifLocalePipe,
                        StartConditionService,
                    ],
                    styles: [""]
                }] }
    ];
    /** @nocollapse */
    StartConditionComponent.ctorParameters = function () { return [
        { type: StartConditionService },
        { type: ProcessDesignerUIState },
        { type: GSPMetadataRTService },
        { type: ExpressionService },
        { type: DataEntityService },
        { type: MessagerService },
        { type: NotifyService },
        { type: BsModalService },
        { type: FrameworkService },
        { type: Router },
        { type: ActivatedRoute },
        { type: LoadingService },
        { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
        { type: AifLocalePipe },
        { type: ComponentFactoryResolver },
        { type: ChangeDetectorRef },
        { type: Injector }
    ]; };
    StartConditionComponent.propDecorators = {
        closeModal: [{ type: Output }],
        submitModal: [{ type: Output }],
        value: [{ type: Input }],
        editorParams: [{ type: Input }],
        modalFooter: [{ type: ViewChild, args: ['iconSelectFooter',] }],
        dg: [{ type: ViewChild, args: ["dg",] }],
        dgIsEnabledStateCell: [{ type: ViewChild, args: ["dgIsEnabledStateCell",] }],
        dgOpCell: [{ type: ViewChild, args: ["dgOpCell",] }]
    };
    return StartConditionComponent;
}(AbstractDatagridComponent));
export { StartConditionComponent };
if (false) {
    /** @type {?} */
    StartConditionComponent.prototype.groupIcon;
    /** @type {?} */
    StartConditionComponent.prototype.closeModal;
    /** @type {?} */
    StartConditionComponent.prototype.submitModal;
    /** @type {?} */
    StartConditionComponent.prototype.editorParams;
    /** @type {?} */
    StartConditionComponent.prototype.modalFooter;
    /** @type {?} */
    StartConditionComponent.prototype.modalConfig;
    /** @type {?} */
    StartConditionComponent.prototype.dg;
    /** @type {?} */
    StartConditionComponent.prototype.dgIdField;
    /** @type {?} */
    StartConditionComponent.prototype.dgColumns;
    /** @type {?} */
    StartConditionComponent.prototype.designedConditionEntities;
    /** @type {?} */
    StartConditionComponent.prototype.dgIsEnabledStateCell;
    /** @type {?} */
    StartConditionComponent.prototype.dgOpCell;
    /** @type {?} */
    StartConditionComponent.prototype.editingRowId;
    /** @type {?} */
    StartConditionComponent.prototype.canEdit;
    /** @type {?} */
    StartConditionComponent.prototype.beforeEdit;
    /** @type {?} */
    StartConditionComponent.prototype.afterEdit;
    /** @type {?} */
    StartConditionComponent.prototype.startConditionService;
    /**
     * @type {?}
     * @private
     */
    StartConditionComponent.prototype.designerState;
    /** @type {?} */
    StartConditionComponent.prototype.metadata;
    /** @type {?} */
    StartConditionComponent.prototype.expr;
    /** @type {?} */
    StartConditionComponent.prototype.des;
    /** @type {?} */
    StartConditionComponent.prototype.messager;
    /** @type {?} */
    StartConditionComponent.prototype.notify;
    /** @type {?} */
    StartConditionComponent.prototype.modal;
    /** @type {?} */
    StartConditionComponent.prototype.framework;
    /** @type {?} */
    StartConditionComponent.prototype.router;
    /** @type {?} */
    StartConditionComponent.prototype.activatedRoute;
    /** @type {?} */
    StartConditionComponent.prototype.loading;
    /** @type {?} */
    StartConditionComponent.prototype.localePipe;
    /** @type {?} */
    StartConditionComponent.prototype.cfr;
    /** @type {?} */
    StartConditionComponent.prototype.cdf;
    /** @type {?} */
    StartConditionComponent.prototype.inj;
}
var StartConditionConverter = /** @class */ (function () {
    function StartConditionConverter() {
    }
    /**
     * @param {?} data
     * @return {?}
     */
    StartConditionConverter.prototype.convertTo = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        if (data && data.StartCondition) {
            return '（已设置）';
        }
        return '（未设置）';
    };
    return StartConditionConverter;
}());
export { StartConditionConverter };
export { ɵ0 };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3RhcnQtY29uZGl0aW9uLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0Bnc3Atd2Yvd2YtcHJvY2Vzcy1lZGl0b3IvIiwic291cmNlcyI6WyJsaWIvdmlld3Mvc3RhcnQtY29uZGl0aW9uL3N0YXJ0LWNvbmRpdGlvbi5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxPQUFPLEVBQUUsaUJBQWlCLEVBQUUsU0FBUyxFQUFFLHdCQUF3QixFQUFFLFlBQVksRUFBRSxNQUFNLEVBQUUsUUFBUSxFQUFFLEtBQUssRUFBRSxTQUFTLEVBQVUsTUFBTSxFQUFFLFdBQVcsRUFBRSxTQUFTLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDakwsT0FBTyxFQUFFLGNBQWMsRUFBRSxNQUFNLEVBQUUsTUFBTSxpQkFBaUIsQ0FBQztBQUN6RCxPQUFPLEVBQUUsbUJBQW1CLEVBQUUseUJBQXlCLEVBQUUsZUFBZSxFQUFFLGFBQWEsRUFBRSwwQkFBMEIsRUFBRSxNQUFNLHFCQUFxQixDQUFDO0FBRWpKLE9BQU8sRUFBYyxpQkFBaUIsRUFBRSxNQUFNLHFCQUFxQixDQUFDO0FBQ3BFLE9BQU8sRUFBRSxjQUFjLEVBQUUsTUFBTSxvQkFBb0IsQ0FBQztBQUNwRCxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFDdEQsT0FBTyxFQUFFLGNBQWMsRUFBRSxNQUFNLGtCQUFrQixDQUFDO0FBQ2xELE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQztBQUVsRCxPQUFPLEVBQUUsb0JBQW9CLEVBQW1CLHlCQUF5QixFQUFFLE1BQU0sOEJBQThCLENBQUM7QUFDaEgsT0FBTyxFQUFFLGlCQUFpQixFQUFFLFlBQVksRUFBYSxNQUFNLHFCQUFxQixDQUFDO0FBQ2pGLE9BQU8sRUFBRSxnQkFBZ0IsRUFBRSxNQUFNLHFCQUFxQixDQUFDO0FBQ3ZELE9BQU8sRUFBYyxFQUFFLEVBQUUsTUFBTSxNQUFNLENBQUM7QUFD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QixzQ0FBb0I7O0FBMlh4QjtJQUVFO0lBQWdCLENBQUM7Ozs7O0lBRWpCLDJDQUFTOzs7O0lBQVQsVUFBVSxJQUFTO1FBQ2pCLElBQUksSUFBSSxJQUFJLElBQUksQ0FBQyxjQUFjLEVBQUU7WUFDL0IsT0FBTyxPQUFPLENBQUM7U0FDaEI7UUFDRCxPQUFPLE9BQU8sQ0FBQztJQUNqQixDQUFDO0lBQ0gsOEJBQUM7QUFBRCxDQUFDLEFBVkQsSUFVQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENoYW5nZURldGVjdG9yUmVmLCBDb21wb25lbnQsIENvbXBvbmVudEZhY3RvcnlSZXNvbHZlciwgRXZlbnRFbWl0dGVyLCBJbmplY3QsIEluamVjdG9yLCBJbnB1dCwgTE9DQUxFX0lELCBPbkluaXQsIE91dHB1dCwgVGVtcGxhdGVSZWYsIFZpZXdDaGlsZCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBBY3RpdmF0ZWRSb3V0ZSwgUm91dGVyIH0gZnJvbSAnQGFuZ3VsYXIvcm91dGVyJztcclxuaW1wb3J0IHsgQnBtbk1vZGVsSnNvbkhlbHBlciwgQ29tcG9uZW50Q29uZGl0aW9uQ29udGVudCwgQ29uZGl0aW9uRW50aXR5LCBDb25kaXRpb25UeXBlLCBFeHByZXNzaW9uQ29uZGl0aW9uQ29udGVudCB9IGZyb20gJ0BlZHAtYmlmL2NvbW1vbi1hcGknO1xyXG5pbXBvcnQgeyBUeXBlQ29udmVydGVyIH0gZnJvbSAnQGZhcnJpcy9pZGUtcHJvcGVydHktcGFuZWwnO1xyXG5pbXBvcnQgeyBEYXRhQ29sdW1uLCBEYXRhZ3JpZENvbXBvbmVudCB9IGZyb20gJ0BmYXJyaXMvdWktZGF0YWdyaWQnO1xyXG5pbXBvcnQgeyBMb2FkaW5nU2VydmljZSB9IGZyb20gJ0BmYXJyaXMvdWktbG9hZGluZyc7XHJcbmltcG9ydCB7IE1lc3NhZ2VyU2VydmljZSB9IGZyb20gJ0BmYXJyaXMvdWktbWVzc2FnZXInO1xyXG5pbXBvcnQgeyBCc01vZGFsU2VydmljZSB9IGZyb20gJ0BmYXJyaXMvdWktbW9kYWwnO1xyXG5pbXBvcnQgeyBOb3RpZnlTZXJ2aWNlIH0gZnJvbSAnQGZhcnJpcy91aS1ub3RpZnknO1xyXG5pbXBvcnQgeyBSZXNwb25zZVRvb2xiYXJDbGlja0V2ZW50IH0gZnJvbSAnQGZhcnJpcy91aS1yZXNwb25zZS10b29sYmFyJztcclxuaW1wb3J0IHsgR1NQTWV0YWRhdGFSVFNlcnZpY2UsIE1ldGFkYXRhNFJlZkR0bywgU2VsZWN0TWV0YWRhdGFSVENvbXBvbmVudCB9IGZyb20gJ0Bnc3AtbGNtL21ldGFkYXRhcnQtc2VsZWN0b3InO1xyXG5pbXBvcnQgeyBFeHByZXNzaW9uU2VydmljZSwgSW5qZWN0ZWRUeXBlLCBWYXJFbnRpdHkgfSBmcm9tICdAZ3NwLXN2Yy9leHByZXNzaW9uJztcclxuaW1wb3J0IHsgRnJhbWV3b3JrU2VydmljZSB9IGZyb20gJ0Bnc3Atc3lzL3J0Zi1jb21tb24nO1xyXG5pbXBvcnQgeyBPYnNlcnZhYmxlLCBvZiB9IGZyb20gJ3J4anMnO1xyXG5pbXBvcnQgeyBBaWZMb2NhbGVQaXBlLCBCSUZfTEFOR19SRVNPVVJDRVMgfSBmcm9tICcuLi9haWYtdWktY29tbW9uL3BpcGUvYWlmLXVpLWNvbW1vbi1sb2NhbGUucGlwZSc7XHJcbmltcG9ydCB7IElDb25kaXRpb25FbnRpdHk0RGcgfSBmcm9tICcuL2VudGl0eS9JQ29uZGl0aW9uRW50aXR5NERnJztcclxuaW1wb3J0IHsgU3RhcnRDb25kaXRpb25TZXJ2aWNlIH0gZnJvbSAnLi9zdGFydC1jb25kaXRpb24uc2VydmljZSc7XHJcbmltcG9ydCB7IERhdGFFbnRpdHlTZXJ2aWNlIH0gZnJvbSAnQGdzcC1zdmMvZGF0YS1lbnRpdHktYWRhcHRlcic7XHJcbmltcG9ydCB7IEVkaXRvclR5cGVzIH0gZnJvbSAnQGZhcnJpcy91aS1kYXRhZ3JpZC1lZGl0b3JzJztcclxuaW1wb3J0IHsgQWJzdHJhY3REYXRhZ3JpZENvbXBvbmVudCB9IGZyb20gJy4vYWJzdHJhY3QtZGF0YWdyaWQtY29tcG9uZW50JztcclxuaW1wb3J0IHsgTEFOR19SRVNPVVJDRVMgfSBmcm9tICcuL2kxOG4vbGFuZy5yZXNvdXJjZSc7XHJcbmltcG9ydCB7IFByb2Nlc3NEZXNpZ25lclVJU3RhdGUgfSBmcm9tICcuLi8uLi9hcHAvcHJvY2Vzcy1kZXNpZ25lci51aXN0YXRlJztcclxuXHJcblxyXG5AQ29tcG9uZW50KHtcclxuICBzZWxlY3RvcjogJ2xpYi1zdGFydC1jb25kaXRpb24nLFxyXG4gIHRlbXBsYXRlVXJsOiAnLi9zdGFydC1jb25kaXRpb24uY29tcG9uZW50Lmh0bWwnLFxyXG4gIHN0eWxlVXJsczogWycuL3N0YXJ0LWNvbmRpdGlvbi5jb21wb25lbnQuY3NzJ10sXHJcbiAgcHJvdmlkZXJzOiBbXHJcbiAgICB7IHByb3ZpZGU6IEJJRl9MQU5HX1JFU09VUkNFUywgdXNlVmFsdWU6IExBTkdfUkVTT1VSQ0VTIH0sXHJcbiAgICBBaWZMb2NhbGVQaXBlLFxyXG4gICAgU3RhcnRDb25kaXRpb25TZXJ2aWNlLFxyXG4gIF1cclxufSlcclxuZXhwb3J0IGNsYXNzIFN0YXJ0Q29uZGl0aW9uQ29tcG9uZW50IGV4dGVuZHMgQWJzdHJhY3REYXRhZ3JpZENvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCB7XHJcbiAgcmVhZG9ubHkgZ3JvdXBJY29uID0gJzxpIGNsYXNzPVwiZi1pY29uIGYtaWNvbi1sb29rdXBcIj48L2k+JztcclxuXHJcbiAgQE91dHB1dCgpIGNsb3NlTW9kYWwgPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcclxuICBAT3V0cHV0KCkgc3VibWl0TW9kYWwgPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcclxuXHJcbiAgQElucHV0KClcclxuICBzZXQgdmFsdWUoZGF0YTogc3RyaW5nKSB7XHJcbiAgICBkYXRhID0gZGF0YSA/IGRhdGEgOiAnW10nO1xyXG4gICAgY29uc3QgY29uZGl0aW9uRW50aXRpZXM6IENvbmRpdGlvbkVudGl0eVtdID0gZGF0YSA/IFtdIDogQnBtbk1vZGVsSnNvbkhlbHBlci5Gcm9tSnNvbihkYXRhLCBDb25kaXRpb25FbnRpdHkpO1xyXG4gICAgdGhpcy5kZXNpZ25lZENvbmRpdGlvbkVudGl0aWVzID0gY29uZGl0aW9uRW50aXRpZXMubWFwKChpdGVtKSA9PiB7XHJcbiAgICAgIGNvbnN0IGVudGl0eTogSUNvbmRpdGlvbkVudGl0eTREZyA9IHtcclxuICAgICAgICBpZDogaXRlbS5pZCxcclxuICAgICAgICBpc0VuYWJsZWQ6IGl0ZW0uaXNFbmFibGVkLFxyXG4gICAgICAgIG5hbWU6IGl0ZW0ubmFtZSxcclxuICAgICAgICB0eXBlOiBpdGVtLnR5cGUsXHJcbiAgICAgICAgcmVtYXJrczogaXRlbS5yZW1hcmtzLFxyXG4gICAgICAgIGNvbXBvbmVudDoge30sXHJcbiAgICAgICAgZXhwcmVzc2lvbjoge30sXHJcbiAgICAgIH07XHJcblxyXG4gICAgICBpZiAoZW50aXR5LnR5cGUgPT0gQ29uZGl0aW9uVHlwZS5DT01QT05FTlQpIHtcclxuICAgICAgICBjb25zdCBjb21wQ29uZENvbnQgPSBuZXcgQ29tcG9uZW50Q29uZGl0aW9uQ29udGVudCgpO1xyXG4gICAgICAgIGNvbXBDb25kQ29udC5Mb2FkRnJvbUpzb24oaXRlbS5jb250ZW50KTtcclxuXHJcbiAgICAgICAgZW50aXR5LmNvbXBvbmVudC5jb21wSWQgPSBjb21wQ29uZENvbnQuY29tcG9uZW50SWQ7XHJcbiAgICAgICAgZW50aXR5LmNvbXBvbmVudC5jb21wTWV0YWRhdGFJZCA9IGNvbXBDb25kQ29udC5jb21wb25lbnRNZXRhZGF0YUlkO1xyXG4gICAgICAgIGVudGl0eS5jb21wb25lbnQuY29tcE5hbWUgPSBjb21wQ29uZENvbnQubmFtZTtcclxuXHJcbiAgICAgICAgZW50aXR5LmRpc3BsYXllZENvbnRlbnQgPSBlbnRpdHkuY29tcG9uZW50LmNvbXBOYW1lO1xyXG4gICAgICB9IGVsc2UgaWYgKGVudGl0eS50eXBlID09IENvbmRpdGlvblR5cGUuRVhQUkVTU0lPTikge1xyXG4gICAgICAgIGNvbnN0IGV4cHJDb250ZW50ID0gbmV3IEV4cHJlc3Npb25Db25kaXRpb25Db250ZW50KCk7XHJcbiAgICAgICAgZXhwckNvbnRlbnQuTG9hZEZyb21Kc29uKGl0ZW0uY29udGVudCk7XHJcblxyXG4gICAgICAgIGVudGl0eS5leHByZXNzaW9uLmV4cHJDb250ZW50ID0gZXhwckNvbnRlbnQuZXhwcmVzc2lvbkNvbnRlbnQ7XHJcbiAgICAgICAgZW50aXR5LmRpc3BsYXllZENvbnRlbnQgPSBlbnRpdHkuZXhwcmVzc2lvbi5leHByQ29udGVudDtcclxuICAgICAgfSBlbHNlIHtcclxuXHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIGVudGl0eTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgQElucHV0KCkgZWRpdG9yUGFyYW1zOiB7XHJcbiAgICBiaXpUeXBlSWQ/OiBzdHJpbmc7XHJcbiAgICB2b0lkPzogc3RyaW5nO1xyXG4gIH0gPSB7fTtcclxuXHJcbiAgQFZpZXdDaGlsZCgnaWNvblNlbGVjdEZvb3RlcicpIG1vZGFsRm9vdGVyOiBUZW1wbGF0ZVJlZjxhbnk+O1xyXG4gIG1vZGFsQ29uZmlnID0ge1xyXG4gICAgdGl0bGU6ICflkK/liqjmnaHku7YnLFxyXG4gICAgd2lkdGg6IDkwMCxcclxuICAgIGhlaWdodDogNDAwLFxyXG4gICAgc2hvd0J1dHRvbnM6IHRydWUsXHJcbiAgICBzaG93SGVhZGVyOiBmYWxzZVxyXG4gIH07XHJcblxyXG4gIEBWaWV3Q2hpbGQoXCJkZ1wiKVxyXG4gIGRnOiBEYXRhZ3JpZENvbXBvbmVudDtcclxuICBkZ0lkRmllbGQ6IHN0cmluZyA9IFwiaWRcIjtcclxuICBkZ0NvbHVtbnM6IERhdGFDb2x1bW5bXTtcclxuICBnZXQgZGdEYXRhKCk6IElDb25kaXRpb25FbnRpdHk0RGdbXSB7XHJcbiAgICByZXR1cm4gdGhpcy5kZXNpZ25lZENvbmRpdGlvbkVudGl0aWVzO1xyXG4gIH1cclxuICBzZXQgZGdEYXRhKGFycjogSUNvbmRpdGlvbkVudGl0eTREZ1tdKSB7XHJcbiAgICB0aGlzLmRlc2lnbmVkQ29uZGl0aW9uRW50aXRpZXMgPSBhcnI7XHJcbiAgfVxyXG4gIGdldCBkZ1RvdGFsKCk6IG51bWJlciB7XHJcbiAgICByZXR1cm4gdGhpcy5kZ0RhdGEubGVuZ3RoIHx8IDA7XHJcbiAgfVxyXG4gIGRlc2lnbmVkQ29uZGl0aW9uRW50aXRpZXM6IEFycmF5PElDb25kaXRpb25FbnRpdHk0RGc+ID0gbmV3IEFycmF5KCk7XHJcblxyXG4gIEBWaWV3Q2hpbGQoXCJkZ0lzRW5hYmxlZFN0YXRlQ2VsbFwiKVxyXG4gIGRnSXNFbmFibGVkU3RhdGVDZWxsOiBUZW1wbGF0ZVJlZjxhbnk+O1xyXG4gIEBWaWV3Q2hpbGQoXCJkZ09wQ2VsbFwiKVxyXG4gIGRnT3BDZWxsOiBUZW1wbGF0ZVJlZjxhbnk+O1xyXG5cclxuICBlZGl0aW5nUm93SWQ6IHN0cmluZyA9IG51bGw7XHJcbiAgY2FuRWRpdDogYW55ID0gdHJ1ZTtcclxuXHJcbiAgY29uc3RydWN0b3IoXHJcbiAgICBwdWJsaWMgc3RhcnRDb25kaXRpb25TZXJ2aWNlOiBTdGFydENvbmRpdGlvblNlcnZpY2UsXHJcbiAgICBwcml2YXRlIGRlc2lnbmVyU3RhdGU6IFByb2Nlc3NEZXNpZ25lclVJU3RhdGUsXHJcbiAgICBwdWJsaWMgbWV0YWRhdGE6IEdTUE1ldGFkYXRhUlRTZXJ2aWNlLFxyXG4gICAgcHVibGljIGV4cHI6IEV4cHJlc3Npb25TZXJ2aWNlLFxyXG4gICAgcHVibGljIGRlczogRGF0YUVudGl0eVNlcnZpY2UsXHJcbiAgICBwdWJsaWMgbWVzc2FnZXI6IE1lc3NhZ2VyU2VydmljZSxcclxuICAgIHB1YmxpYyBub3RpZnk6IE5vdGlmeVNlcnZpY2UsXHJcbiAgICBwdWJsaWMgbW9kYWw6IEJzTW9kYWxTZXJ2aWNlLFxyXG4gICAgcHVibGljIGZyYW1ld29yazogRnJhbWV3b3JrU2VydmljZSxcclxuICAgIHB1YmxpYyByb3V0ZXI6IFJvdXRlcixcclxuICAgIHB1YmxpYyBhY3RpdmF0ZWRSb3V0ZTogQWN0aXZhdGVkUm91dGUsXHJcbiAgICBwdWJsaWMgbG9hZGluZzogTG9hZGluZ1NlcnZpY2UsXHJcbiAgICBASW5qZWN0KExPQ0FMRV9JRCkgbG9jYWxlSWQ6IHN0cmluZyxcclxuICAgIHB1YmxpYyBsb2NhbGVQaXBlOiBBaWZMb2NhbGVQaXBlLFxyXG4gICAgcHVibGljIGNmcjogQ29tcG9uZW50RmFjdG9yeVJlc29sdmVyLFxyXG4gICAgcHVibGljIGNkZjogQ2hhbmdlRGV0ZWN0b3JSZWYsXHJcbiAgICBwdWJsaWMgaW5qOiBJbmplY3RvcixcclxuICApIHtcclxuICAgIHN1cGVyKG1lc3NhZ2VyLCBub3RpZnksIG1ldGFkYXRhLCBtb2RhbCwgbG9jYWxlUGlwZSwgaW5qLCBjZnIsIGNkZilcclxuICB9XHJcblxyXG4gIG5nT25Jbml0KCkge1xyXG4gICAgdGhpcy5jb25maWdEZ0NvbHVtbnMoKTtcclxuICB9XHJcblxyXG4gIGNsaWNrT2soKSB7XHJcbiAgICBpZiAodGhpcy5kZy5pc0VkaXRpbmcoKSB8fCB0aGlzLmVkaXRpbmdSb3dJZCAhPSBudWxsKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGNvbnN0IGNvbmRpdGlvbkVudGl0aWVzID0gdGhpcy5kZXNpZ25lZENvbmRpdGlvbkVudGl0aWVzLm1hcCgoZW50aXR5KSA9PiB7XHJcbiAgICAgIGNvbnN0IGl0ZW06IENvbmRpdGlvbkVudGl0eSA9IG5ldyBDb25kaXRpb25FbnRpdHkoKTtcclxuICAgICAgaXRlbS5pZCA9IGVudGl0eS5pZDtcclxuICAgICAgaXRlbS5pc0VuYWJsZWQgPSBlbnRpdHkuaXNFbmFibGVkO1xyXG4gICAgICBpdGVtLm5hbWUgPSBlbnRpdHkubmFtZTtcclxuICAgICAgaXRlbS50eXBlID0gZW50aXR5LnR5cGU7XHJcbiAgICAgIGl0ZW0ucmVtYXJrcyA9IGVudGl0eS5yZW1hcmtzO1xyXG5cclxuICAgICAgaWYgKGVudGl0eS50eXBlID09IENvbmRpdGlvblR5cGUuQ09NUE9ORU5UKSB7XHJcbiAgICAgICAgY29uc3QgY29tcENvbmRDb250ID0gbmV3IENvbXBvbmVudENvbmRpdGlvbkNvbnRlbnQoKTtcclxuICAgICAgICBjb21wQ29uZENvbnQubmFtZSA9IGVudGl0eS5jb21wb25lbnQuY29tcE5hbWU7XHJcbiAgICAgICAgY29tcENvbmRDb250LmNvbXBvbmVudElkID0gZW50aXR5LmNvbXBvbmVudC5jb21wSWQ7XHJcbiAgICAgICAgY29tcENvbmRDb250LmNvbXBvbmVudE1ldGFkYXRhSWQgPSBlbnRpdHkuY29tcG9uZW50LmNvbXBNZXRhZGF0YUlkO1xyXG5cclxuICAgICAgICBpdGVtLmNvbnRlbnQgPSBjb21wQ29uZENvbnQuQ29udmVydFRvSnNvbigpO1xyXG4gICAgICB9IGVsc2UgaWYgKGVudGl0eS50eXBlID09IENvbmRpdGlvblR5cGUuRVhQUkVTU0lPTikge1xyXG4gICAgICAgIGNvbnN0IGV4cHJDb250ZW50ID0gbmV3IEV4cHJlc3Npb25Db25kaXRpb25Db250ZW50KCk7XHJcbiAgICAgICAgZXhwckNvbnRlbnQuZXhwcmVzc2lvbkNvbnRlbnQgPSBlbnRpdHkuZXhwcmVzc2lvbi5leHByQ29udGVudDtcclxuXHJcbiAgICAgICAgaXRlbS5jb250ZW50ID0gZXhwckNvbnRlbnQuQ29udmVydFRvSnNvbigpO1xyXG4gICAgICB9IGVsc2Uge1xyXG5cclxuICAgICAgfVxyXG5cclxuICAgICAgcmV0dXJuIGl0ZW07XHJcbiAgICB9KTtcclxuXHJcbiAgICBjb25zdCB2YWwgPSBCcG1uTW9kZWxKc29uSGVscGVyLlRvSnNvbihjb25kaXRpb25FbnRpdGllcyk7XHJcbiAgICBjb25zdCBvYmogPSB7IHZhbHVlOiB2YWwsIHBhcmFtZXRlcnM6IG51bGwgfTtcclxuICAgIHRoaXMuc3VibWl0TW9kYWwuZW1pdChvYmopO1xyXG4gIH1cclxuXHJcbiAgY2xpY2tDYW5jZWwoKSB7XHJcbiAgICB0aGlzLmNsb3NlTW9kYWwuZW1pdCgpO1xyXG4gIH1cclxuXHJcbiAgbG9hZCgpOiB2b2lkIHtcclxuICAgIHRocm93IG5ldyBFcnJvcignTWV0aG9kIG5vdCBpbXBsZW1lbnRlZC4nKTtcclxuICB9XHJcblxyXG4gIHRvb2xiYXJDbGlja0hhbmRsZXIoYXJnczogUmVzcG9uc2VUb29sYmFyQ2xpY2tFdmVudCkge1xyXG4gICAgc3dpdGNoIChhcmdzLmlkKSB7XHJcbiAgICAgIGNhc2UgJ2J0bi1hZGQnOlxyXG4gICAgICAgIHRoaXMuYWRkKCk7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgJ2J0bi1yZW1vdmUnOlxyXG4gICAgICAgIHRoaXMucmVtb3ZlKG51bGwpO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgYWRkKCkge1xyXG4gICAgaWYgKHRoaXMuZGcuaXNFZGl0aW5nKCkgPT0gZmFsc2UgfHwgdGhpcy5kZy5pc0VkaXRpbmcoKSA9PSBudWxsKSB7XHJcbiAgICAgIGNvbnN0IG5ld0l0ZW0gPSB0aGlzLnN0YXJ0Q29uZGl0aW9uU2VydmljZS5jcmVhdGVDb25kaXRpb25FbnRpdHkoKTtcclxuICAgICAgY29uc3QgbmV3RW50aXR5OiBJQ29uZGl0aW9uRW50aXR5NERnID0ge1xyXG4gICAgICAgIGlkOiBuZXdJdGVtLmlkLFxyXG4gICAgICAgIG5hbWU6IG5ld0l0ZW0ubmFtZSxcclxuICAgICAgICB0eXBlOiBuZXdJdGVtLnR5cGUsXHJcbiAgICAgICAgaXNFbmFibGVkOiBuZXdJdGVtLmlzRW5hYmxlZCxcclxuICAgICAgICByZW1hcmtzOiBuZXdJdGVtLnJlbWFya3MsXHJcbiAgICAgICAgY29tcG9uZW50OiB7fSxcclxuICAgICAgICBleHByZXNzaW9uOiB7fSxcclxuICAgICAgfTtcclxuXHJcbiAgICAgIHRoaXMuZGdEYXRhID0gWy4uLnRoaXMuZGdEYXRhLCBuZXdFbnRpdHldO1xyXG4gICAgICB0aGlzLmNkZi5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuZGcuZWRpdFJvdyhuZXdJdGVtLmlkKTtcclxuICAgICAgICB0aGlzLmVkaXRpbmdSb3dJZCA9IG5ld0l0ZW0uaWQ7XHJcbiAgICAgIH0sIDApO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5ub3RpZnkud2FybmluZyh0aGlzLmxvY2FsZVBpcGUuaW5zdGFudChcInBsZWFzZUVuZEN1cnJlbnRSb3dFZGl0aW5nXCIpKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOihjOWIoOmZpFxyXG4gICAqIEBwYXJhbSBjdHggXHJcbiAgICovXHJcbiAgcmVtb3ZlKGV2dDogRXZlbnQsIGN0eD86IHsgcm93SW5kZXg6IG51bWJlciwgcm93RGF0YTogeyBpZDtba2V5OiBzdHJpbmddOiBhbnkgfSB9KSB7XHJcbiAgICBjb25zdCBpZHM6IHN0cmluZ1tdID0gW107XHJcbiAgICBpZiAoY3R4ID09IG51bGwpIHtcclxuICAgICAgLy8g5om56YeP5Yig6ZmkXHJcbiAgICAgIHRoaXMuZGcuY2hlY2tlZHMuZm9yRWFjaChpdCA9PiB7XHJcbiAgICAgICAgaWRzLnB1c2goaXQuaWQpO1xyXG4gICAgICB9KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIC8vIOihjOWGheWIoOmZpFxyXG4gICAgICBpZHMucHVzaChjdHgucm93RGF0YS5pZCk7XHJcbiAgICB9XHJcbiAgICBpZiAoaWRzLmxlbmd0aCA9PSAwKSB7XHJcbiAgICAgIHRoaXMubm90aWZ5Lndhcm5pbmcodGhpcy5sb2NhbGVQaXBlLmluc3RhbnQoXCJwbGVhc2VTZWxlY3RPbmVJdGVtQXRMZWFzdFwiKSk7XHJcbiAgICAgIGlmIChldnQgIT0gbnVsbCkge1xyXG4gICAgICAgIGV2dC5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgICBmb3IgKGxldCBpZCBvZiBpZHMpIHtcclxuICAgICAgdGhpcy5kZy5kZWxldGVSb3coaWQpO1xyXG4gICAgfVxyXG4gICAgdGhpcy5kZ0RhdGEgPSB0aGlzLmRnLmRhdGE7XHJcbiAgICBpZiAodGhpcy5lZGl0aW5nUm93SWQgIT0gbnVsbCkge1xyXG4gICAgICBpZiAoaWRzLmluY2x1ZGVzKHRoaXMuZWRpdGluZ1Jvd0lkKSkge1xyXG4gICAgICAgIHRoaXMuZWRpdGluZ1Jvd0lkID0gbnVsbDtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICB0aGlzLmRnLmVkaXRSb3codGhpcy5lZGl0aW5nUm93SWQpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICB0aGlzLmNkZi5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICBpZiAoZXZ0ICE9IG51bGwpIHtcclxuICAgICAgZXZ0LnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG4gIH1cclxuXHJcbiAgc2VsZWN0Q29udGVudChlOiB7IGluc3RhbmNlLCBmb3JtLCBmb3JtQ29udHJvbCwgJGV2ZW50IH0pIHtcclxuICAgIHN3aXRjaCAoZS5mb3JtLnZhbHVlLnR5cGUpIHtcclxuICAgICAgY2FzZSBDb25kaXRpb25UeXBlLkNPTVBPTkVOVDpcclxuICAgICAgICB0aGlzLnNlbGVjdENvbW1vbkNvbXAoZSk7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgQ29uZGl0aW9uVHlwZS5FWFBSRVNTSU9OOlxyXG4gICAgICAgIHRoaXMuc2hvd0V4cHJlc3Npb24oZSk7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIC8vIGNhc2UgQ29uZGl0aW9uVHlwZS5GVUxMX0VYUFJFU1NJT046XHJcbiAgICAgIC8vICAgdGhpcy5zaG93RXhwcmVzc2lvbihlKTtcclxuICAgICAgLy8gICBicmVhaztcclxuICAgICAgLy8gY2FzZSBDb25kaXRpb25UeXBlLklOQ1JFTUVOVEFMX0VYUFJFU1NJT046XHJcbiAgICAgIC8vICAgdGhpcy5zaG93RXhwcmVzc2lvbihlKTtcclxuICAgICAgLy8gICBicmVhaztcclxuICAgICAgY2FzZSBDb25kaXRpb25UeXBlLlZPQUNUSU9OOlxyXG4gICAgICAgIHRoaXMuc2VsZWN0Vk9BY3Rpb24oZSk7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgc2VsZWN0Q29tbW9uQ29tcChlOiB7IGluc3RhbmNlLCBmb3JtLCBmb3JtQ29udHJvbCwgJGV2ZW50IH0pOiB2b2lkIHtcclxuICAgIGNvbnN0IGNvbXBGYWN0b3J5ID0gdGhpcy5jZnIucmVzb2x2ZUNvbXBvbmVudEZhY3RvcnkoU2VsZWN0TWV0YWRhdGFSVENvbXBvbmVudCk7XHJcbiAgICBjb25zdCBjb21wUmVmID0gY29tcEZhY3RvcnkuY3JlYXRlKHRoaXMuaW5qKTtcclxuICAgIGNvbXBSZWYuaW5zdGFuY2UudHlwZUxpc3QgPSBcIkNvbW1vbkNvbXBvbmVudFwiO1xyXG4gICAgLy8gY29tcFJlZi5pbnN0YW5jZS5ib0lkID0gYCR7dGhpcy5wcm9jZXNzQ29udGVudC51cEJpbGxCb0lkfSwke3RoaXMucHJvY2Vzc0NvbnRlbnQuZG93bkJpbGxCb0lkfWA7XHJcbiAgICBjb21wUmVmLmluc3RhbmNlLnNlbGVjdGVkTWV0YWRhdGEuc3Vic2NyaWJlKFxyXG4gICAgICAobWV0YWRhdGE0UmVmRHRvOiBNZXRhZGF0YTRSZWZEdG8pID0+IHtcclxuICAgICAgICBjb25zdCBjb250ZW50ID0gbmV3IENvbXBvbmVudENvbmRpdGlvbkNvbnRlbnQoKTtcclxuXHJcbiAgICAgICAgY29uc3QgbWV0YWRhdGEgPSBtZXRhZGF0YTRSZWZEdG8ubWV0YWRhdGE7XHJcbiAgICAgICAgY29uc3QgZW50aXR5OiBJQ29uZGl0aW9uRW50aXR5NERnID0gZS5mb3JtLmJpbmRpbmdEYXRhO1xyXG4gICAgICAgIGVudGl0eS5jb21wb25lbnQuY29tcE5hbWUgPSBtZXRhZGF0YS5uYW1lO1xyXG4gICAgICAgIGVudGl0eS5jb21wb25lbnQuY29tcE1ldGFkYXRhSWQgPSBtZXRhZGF0YS5pZDtcclxuICAgICAgICBjb25zdCBtZXRhZGF0YUNvbnRlbnQgPSBKU09OLnBhcnNlKG1ldGFkYXRhLmNvbnRlbnQpO1xyXG4gICAgICAgIGVudGl0eS5jb21wb25lbnQuY29tcElkID0gbWV0YWRhdGFDb250ZW50LmlkIHx8IG1ldGFkYXRhQ29udGVudC5JZCB8fCBtZXRhZGF0YUNvbnRlbnQuSUQgfHwgbWV0YWRhdGEuaWQ7XHJcbiAgICAgICAgZW50aXR5LmRpc3BsYXllZENvbnRlbnQgPSBlbnRpdHkuY29tcG9uZW50LmNvbXBOYW1lO1xyXG5cclxuICAgICAgICBlLmZvcm1Db250cm9sLnNldFZhbHVlKGVudGl0eS5kaXNwbGF5ZWRDb250ZW50KTtcclxuICAgICAgICBlLmluc3RhbmNlLmNkLmRldGVjdENoYW5nZXMoKTtcclxuICAgICAgfVxyXG4gICAgKTtcclxuICAgIGNvbnN0IG1vZGFsQ29uZmlnID0ge1xyXG4gICAgICB0aXRsZTogdGhpcy5sb2NhbGVQaXBlLmluc3RhbnQoXCJjb21tb25Db21wb25lbnRNZXRhZGF0YVNlbGVjdG9yXCIpLFxyXG4gICAgICB3aWR0aDogOTMwLFxyXG4gICAgICBoZWlnaHQ6IDU3MyxcclxuICAgICAgc2hvd0J1dHRvbnM6IGZhbHNlXHJcbiAgICB9O1xyXG4gICAgY29uc3QgZGlhbG9nID0gdGhpcy5tb2RhbC5zaG93KGNvbXBSZWYsIG1vZGFsQ29uZmlnKTtcclxuICAgIGNvbXBSZWYuaW5zdGFuY2UuY2xvc2VNb2RhbEVtaXR0ZXIuc3Vic2NyaWJlKCRldmVudCA9PiBkaWFsb2cuY2xvc2UoKSk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgc2VsZWN0Vk9BY3Rpb24oZTogeyBpbnN0YW5jZSwgZm9ybSwgZm9ybUNvbnRyb2wsICRldmVudCB9KTogdm9pZCB7XHJcblxyXG4gIH1cclxuXHJcbiAgcHVibGljIHNob3dFeHByZXNzaW9uKGU6IHsgaW5zdGFuY2UsIGZvcm0sIGZvcm1Db250cm9sLCAkZXZlbnQgfSk6IHZvaWQge1xyXG4gICAgLy8gdGhpcy5leHByLmNsZWFyQ29udGV4dCgpO1xyXG4gICAgY29uc3QgY29udGV4dCA9IG5ldyBBcnJheTxWYXJFbnRpdHk+KCk7XHJcbiAgICBpZiAodGhpcy5kZXNpZ25lclN0YXRlLnN1YkFjdGl2aXR5Q29udGV4dC5sZW5ndGggPiAwKSB7XHJcbiAgICAgIGZvciAoY29uc3QgdmFyaWFibGUgb2YgdGhpcy5kZXNpZ25lclN0YXRlLnN1YkFjdGl2aXR5Q29udGV4dCkge1xyXG4gICAgICAgIGlmICghY29udGV4dC5zb21lKGMgPT4gYy5rZXkgPT09IHZhcmlhYmxlLmtleSkpIHtcclxuICAgICAgICAgIGNvbnRleHQucHVzaCh2YXJpYWJsZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBpZiAoY29udGV4dC5sZW5ndGggPiAwKSB7XHJcbiAgICAgIGZvciAoY29uc3QgdiBvZiBjb250ZXh0KSB7XHJcbiAgICAgICAgdGhpcy5leHByLmFkZENvbnRleHQodik7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICB0aGlzLmV4cHIuYWRkRXhwcmVzc2lvblRleHQoZS5mb3JtQ29udHJvbC52YWx1ZSk7XHJcbiAgICB0aGlzLmNvbmZpZ0V4cHJlc3Npb25FeHBlbmRGdW5jcygpO1xyXG5cclxuICAgIGxldCBzY2hlbWEkOiBPYnNlcnZhYmxlPGFueT4gPSB0aGlzLmRlcy5nZXRTY2hlbWFCeUlkKHRoaXMuZWRpdG9yUGFyYW1zLnZvSWQpO1xyXG4gICAgc2NoZW1hJC5zdWJzY3JpYmUoXHJcbiAgICAgIChzY2hlbWEpID0+IHtcclxuICAgICAgICB0aGlzLmV4cHIuYWRkTmV3U2NoZW1hKHNjaGVtYS5uYW1lLCBzY2hlbWEpO1xyXG4gICAgICAgIHRoaXMuZXhwci5hZGRJbmplY3RlZEVudGl0eShzY2hlbWEuZW50aXR5VHlwZXNbMF0uY29kZSwgc2NoZW1hLm5hbWUsIHNjaGVtYS5lbnRpdHlUeXBlc1swXS5jb2RlLCBJbmplY3RlZFR5cGUuRW50aXR5VHlwZSk7XHJcblxyXG4gICAgICAgIHRoaXMuZXhwci5idWlsZEV4cHJlc3Npb24oIXRoaXMuY2FuRWRpdCkudGhlbihcclxuICAgICAgICAgIGV4cHJlc3Npb25pbmZvID0+IHtcclxuICAgICAgICAgICAgY29uc3QgY29udGVudDogRXhwcmVzc2lvbkNvbmRpdGlvbkNvbnRlbnQgPSBuZXcgRXhwcmVzc2lvbkNvbmRpdGlvbkNvbnRlbnQoKTtcclxuXHJcbiAgICAgICAgICAgIGxldCB0ZW1wOiBhbnkgPSBleHByZXNzaW9uaW5mbztcclxuICAgICAgICAgICAgY29uc3QgZW50aXR5OiBJQ29uZGl0aW9uRW50aXR5NERnID0gZS5mb3JtLmJpbmRpbmdEYXRhO1xyXG4gICAgICAgICAgICBlbnRpdHkuZXhwcmVzc2lvbi5leHByQ29udGVudCA9IHRlbXA7XHJcbiAgICAgICAgICAgIGVudGl0eS5kaXNwbGF5ZWRDb250ZW50ID0gZW50aXR5LmV4cHJlc3Npb24uZXhwckNvbnRlbnQ7XHJcblxyXG4gICAgICAgICAgICBlLmZvcm1Db250cm9sLnNldFZhbHVlKGVudGl0eS5kaXNwbGF5ZWRDb250ZW50KTtcclxuICAgICAgICAgICAgZS5pbnN0YW5jZS5jZC5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICAgICAgICAgIC8v54K55Ye756Gu5a6a5ZCO77yM5Y676Zmk6KGo6L6+5byP6YeM6Z2i55qE5paw5aKe55qE5LiK5LiL5paH5Y+Y6YePXHJcbiAgICAgICAgICAgIGlmKGNvbnRleHQubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgIHRoaXMuZXhwci5leHByRW50aXR5LmNvbnRleHRFbnRpdGllcyA9IHRoaXMuZXhwci5leHByRW50aXR5LmNvbnRleHRFbnRpdGllcy5maWx0ZXIoeCA9PiAhY29udGV4dC5zb21lKHkgPT4geS5rZXkgPT09IHgua2V5KSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICApO1xyXG4gICAgICB9XHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgY2xlYXJDb250ZW50KGU6IHsgaW5zdGFuY2UsIGZvcm0sIGZvcm1Db250cm9sLCAkZXZlbnQgfSkge1xyXG4gICAgY29uc3QgZW50aXR5OiBJQ29uZGl0aW9uRW50aXR5NERnID0gZS5mb3JtLmJpbmRpbmdEYXRhO1xyXG4gICAgZW50aXR5LmRpc3BsYXllZENvbnRlbnQgPSBudWxsO1xyXG5cclxuICAgIC8v5p6E5Lu2XHJcbiAgICBlbnRpdHkuY29tcG9uZW50LmNvbXBOYW1lID0gbnVsbDtcclxuICAgIGVudGl0eS5jb21wb25lbnQuY29tcE1ldGFkYXRhSWQgPSBudWxsO1xyXG4gICAgZW50aXR5LmNvbXBvbmVudC5jb21wSWQgPSBudWxsO1xyXG5cclxuICAgIC8v6KGo6L6+5byPXHJcbiAgICBlbnRpdHkuZXhwcmVzc2lvbi5leHByQ29udGVudCA9IG51bGw7XHJcblxyXG4gICAgLy9WT+WKqOS9nFxyXG5cclxuICAgIGUuZm9ybUNvbnRyb2wuc2V0VmFsdWUobnVsbCk7XHJcbiAgICBlLmluc3RhbmNlLmNkLmRldGVjdENoYW5nZXMoKTtcclxuICB9XHJcblxyXG4gIGNvbmZpZ0RnQ29sdW1ucygpIHtcclxuICAgIHRoaXMuZGdDb2x1bW5zID0gW1xyXG4gICAgICAvLyB7IGZpZWxkOiAnaWQnLCB0aXRsZTogdGhpcy5sb2NhbGVQaXBlU2VydmljZS5pbnN0YW50KFwiaWRcIiksIHdpZHRoOiAxNjAgfSxcclxuICAgICAge1xyXG4gICAgICAgIGZpZWxkOiAnaXNFbmFibGVkJywgdGl0bGU6IHRoaXMubG9jYWxlUGlwZS5pbnN0YW50KFwiaXNFbmFibGVkXCIpLCB3aWR0aDogMTAwLCB0ZW1wbGF0ZTogdGhpcy5kZ0lzRW5hYmxlZFN0YXRlQ2VsbCxcclxuICAgICAgfSxcclxuICAgICAge1xyXG4gICAgICAgIGZpZWxkOiAndHlwZScsIHRpdGxlOiB0aGlzLmxvY2FsZVBpcGUuaW5zdGFudChcInR5cGVcIiksIHdpZHRoOiAxMjAsXHJcbiAgICAgICAgZWRpdG9yOiB7XHJcbiAgICAgICAgICB0eXBlOiBFZGl0b3JUeXBlcy5TRUxFQ1QsXHJcbiAgICAgICAgICBvcHRpb25zOiB7XHJcbiAgICAgICAgICAgIGlkRmllbGQ6IFwidmFsdWVcIixcclxuICAgICAgICAgICAgdmFsdWVGaWVsZDogJ3ZhbHVlJyxcclxuICAgICAgICAgICAgdGV4dEZpZWxkOiAndGV4dCcsXHJcbiAgICAgICAgICAgIGRhdGE6IFtcclxuICAgICAgICAgICAgICAvLyB7IHZhbHVlOiBDb25kaXRpb25UeXBlLlZPQUNUSU9OLCB0ZXh0OiB0aGlzLmxvY2FsZVBpcGVTZXJ2aWNlLmluc3RhbnQoXCJiaWxsQWN0aW9uXCIpIH0sXHJcbiAgICAgICAgICAgICAgLy8geyB2YWx1ZTogQ29uZGl0aW9uVHlwZS5FWFBSRVNTSU9OLCB0ZXh0OiB0aGlzLmxvY2FsZVBpcGUuaW5zdGFudChcImV4cHJlc3Npb25cIikgfSxcclxuICAgICAgICAgICAgICB7IHZhbHVlOiBDb25kaXRpb25UeXBlLkNPTVBPTkVOVCwgdGV4dDogdGhpcy5sb2NhbGVQaXBlLmluc3RhbnQoXCJjb21tb25Db21wb25lbnRcIikgfSxcclxuICAgICAgICAgICAgICAvLyB7IHZhbHVlOiBDb25kaXRpb25UeXBlLkZVTExfRVhQUkVTU0lPTiwgdGV4dDogdGhpcy5sb2NhbGVQaXBlLmluc3RhbnQoXCJmdWxsRXhwcmVzc2lvblwiKSB9LFxyXG4gICAgICAgICAgICAgIC8vIHsgdmFsdWU6IENvbmRpdGlvblR5cGUuSU5DUkVNRU5UQUxfRVhQUkVTU0lPTiwgdGV4dDogdGhpcy5sb2NhbGVQaXBlLmluc3RhbnQoXCJpbmNyZW1lbnRhbEV4cHJlc3Npb25cIikgfSxcclxuICAgICAgICAgICAgXVxyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIHZhbGlkYXRvcnM6IFtcclxuICAgICAgICAgICAgeyB0eXBlOiAncmVxdWlyZWQnLCBtZXNzYWdlcjogdGhpcy5sb2NhbGVQaXBlLmluc3RhbnQoXCJ0eXBlTXVzdE5vdEJlTnVsbFwiKSB9LFxyXG4gICAgICAgICAgXVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgdmFsaWRhdG9yczogW1xyXG4gICAgICAgICAgeyB0eXBlOiAncmVxdWlyZWQnIH0sXHJcbiAgICAgICAgXSxcclxuICAgICAgICBmb3JtYXR0ZXI6ICh2YWx1ZTogQ29uZGl0aW9uVHlwZSwgcm93RGF0YTogYW55LCByb3dJbmRleDogYW55KSA9PiB7XHJcbiAgICAgICAgICBzd2l0Y2ggKHZhbHVlKSB7XHJcbiAgICAgICAgICAgIGNhc2UgQ29uZGl0aW9uVHlwZS5DT01QT05FTlQ6XHJcbiAgICAgICAgICAgICAgcmV0dXJuIHRoaXMubG9jYWxlUGlwZS5pbnN0YW50KFwiY29tbW9uQ29tcG9uZW50XCIpO1xyXG4gICAgICAgICAgICBjYXNlIENvbmRpdGlvblR5cGUuRVhQUkVTU0lPTjpcclxuICAgICAgICAgICAgICByZXR1cm4gdGhpcy5sb2NhbGVQaXBlLmluc3RhbnQoXCJleHByZXNzaW9uXCIpO1xyXG4gICAgICAgICAgICAvLyBjYXNlIENvbmRpdGlvblR5cGUuRlVMTF9FWFBSRVNTSU9OOlxyXG4gICAgICAgICAgICAvLyAgIHJldHVybiB0aGlzLmxvY2FsZVBpcGUuaW5zdGFudChcImZ1bGxFeHByZXNzaW9uXCIpO1xyXG4gICAgICAgICAgICAvLyBjYXNlIENvbmRpdGlvblR5cGUuSU5DUkVNRU5UQUxfRVhQUkVTU0lPTjpcclxuICAgICAgICAgICAgLy8gICByZXR1cm4gdGhpcy5sb2NhbGVQaXBlLmluc3RhbnQoXCJpbmNyZW1lbnRhbEV4cHJlc3Npb25cIik7XHJcbiAgICAgICAgICAgIGNhc2UgQ29uZGl0aW9uVHlwZS5WT0FDVElPTjpcclxuICAgICAgICAgICAgICByZXR1cm4gdGhpcy5sb2NhbGVQaXBlLmluc3RhbnQoXCJiaWxsQWN0aW9uXCIpO1xyXG4gICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgIHJldHVybiBcIlVua25vd25cIjtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH0sXHJcbiAgICAgIHtcclxuICAgICAgICBmaWVsZDogXCJkaXNwbGF5ZWRDb250ZW50XCIsIHRpdGxlOiB0aGlzLmxvY2FsZVBpcGUuaW5zdGFudChcImNvbnRlbnRcIiksIHdpZHRoOiAyMDAsXHJcbiAgICAgICAgZWRpdG9yOiB7XHJcbiAgICAgICAgICB0eXBlOiBFZGl0b3JUeXBlcy5JTlBVVEdST1VQLFxyXG4gICAgICAgICAgb3B0aW9uczoge1xyXG4gICAgICAgICAgICBncm91cFRleHQ6IHRoaXMuZ3JvdXBJY29uLFxyXG4gICAgICAgICAgICBlZGl0YWJsZTogZmFsc2UsXHJcbiAgICAgICAgICAgIGNsaWNrSGFuZGxlOiAoZTogeyBpbnN0YW5jZSwgZm9ybSwgZm9ybUNvbnRyb2wsICRldmVudCB9KSA9PiB7XHJcbiAgICAgICAgICAgICAgdGhpcy5zZWxlY3RDb250ZW50KGUpO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBjbGVhcjogKGU6IHsgaW5zdGFuY2UsIGZvcm0sIGZvcm1Db250cm9sLCAkZXZlbnQgfSkgPT4ge1xyXG4gICAgICAgICAgICAgIHRoaXMuY2xlYXJDb250ZW50KGUpO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIHZhbGlkYXRvcnM6IFtcclxuICAgICAgICAgICAgeyB0eXBlOiAncmVxdWlyZWQnLCBtZXNzYWdlcjogdGhpcy5sb2NhbGVQaXBlLmluc3RhbnQoXCJjb250ZW50TXVzdE5vdEJlTnVsbFwiKSB9XHJcbiAgICAgICAgICBdXHJcbiAgICAgICAgfSxcclxuICAgICAgICB2YWxpZGF0b3JzOiBbXHJcbiAgICAgICAgICB7IHR5cGU6ICdyZXF1aXJlZCcgfSxcclxuICAgICAgICBdLFxyXG4gICAgICB9LFxyXG4gICAgICB7XHJcbiAgICAgICAgZmllbGQ6ICdyZW1hcmtzJywgdGl0bGU6IHRoaXMubG9jYWxlUGlwZS5pbnN0YW50KFwiZGVzY3JpcHRpb25cIiksIHdpZHRoOiAyMDAsXHJcbiAgICAgICAgZWRpdG9yOiB7XHJcbiAgICAgICAgICB0eXBlOiBFZGl0b3JUeXBlcy5URVhUQVJFQSwgb3B0aW9uczoge30sXHJcbiAgICAgICAgfVxyXG4gICAgICB9LFxyXG4gICAgICB7IGZpZWxkOiBudWxsLCB0aXRsZTogdGhpcy5sb2NhbGVQaXBlLmluc3RhbnQoXCJvcGVyYXRpb25cIiksIHdpZHRoOiAyNTAsIHRlbXBsYXRlOiB0aGlzLmRnT3BDZWxsLCBoYWxpZ246ICdjZW50ZXInLCBhbGlnbjogJ2NlbnRlcicgfSxcclxuICAgIF07XHJcbiAgfVxyXG5cclxuICBiZWZvcmVFZGl0ID0gKC4uLmFyZ3MpID0+IHtcclxuICAgIC8vIGNvbnNvbGUubG9nKCdCZWZvcmUgRWRpdCcsIGFyZ3MpO1xyXG4gICAgcmV0dXJuIG9mKHRydWUpO1xyXG4gIH1cclxuXHJcbiAgYmVnaW5FZGl0KHBhcmFtOiB7IHJvd0luZGV4OiBudW1iZXIsIHJvd0RhdGE6IGFueSwgY29sdW1uOiBhbnksIGdyaWRJbnN0YW5jZTogRGF0YWdyaWRDb21wb25lbnQgfSkge1xyXG4gICAgLy8gY29uc29sZS5sb2coJ0JlZ2luIEVkaXQnLCBwYXJhbSk7XHJcbiAgICB0aGlzLmVkaXRpbmdSb3dJZCA9IHBhcmFtLnJvd0RhdGEuaWQ7XHJcbiAgICBjb25zdCBlZGl0b3JzID0gcGFyYW0uZ3JpZEluc3RhbmNlLmdldEVkaXRvcnMoKTtcclxuICAgIGNvbnN0IHNlbGVjdCA9IGVkaXRvcnNbMF07XHJcbiAgICBzZWxlY3QuaW5zdGFuY2UuZm9ybUNvbnRyb2wudmFsdWVDaGFuZ2VzLnN1YnNjcmliZSgodmFsKSA9PiB7XHJcbiAgICAgIGlmIChzZWxlY3QuaW5zdGFuY2UuZHIuZm9ybS5iaW5kaW5nRGF0YS50eXBlICE9IHZhbCkge1xyXG4gICAgICAgIHNlbGVjdC5pbnN0YW5jZS5ncm91cC5iaW5kaW5nRGF0YS5kaXNwbGF5ZWRDb250ZW50ID0gbnVsbDtcclxuICAgICAgICBzZWxlY3QuaW5zdGFuY2UuZ3JvdXAuY29udHJvbHMuZGlzcGxheWVkQ29udGVudC5zZXRWYWx1ZShudWxsKTtcclxuXHJcbiAgICAgICAgc2VsZWN0Lmluc3RhbmNlLmdyb3VwLmJpbmRpbmdEYXRhLnJlbWFya3MgPSBudWxsO1xyXG4gICAgICAgIHNlbGVjdC5pbnN0YW5jZS5ncm91cC5jb250cm9scy5yZW1hcmtzLnNldFZhbHVlKG51bGwpO1xyXG4gICAgICAgIHNlbGVjdC5pbnN0YW5jZS5kci5jZC5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgYWZ0ZXJFZGl0ID0gKHJvd0luZGV4LCByb3dEYXRhOiBJQ29uZGl0aW9uRW50aXR5NERnLCAuLi5hcmdzKSA9PiB7XHJcbiAgICBpZiAocm93RGF0YS5jb21wb25lbnQgJiYgcm93RGF0YS5jb21wb25lbnQuY29tcE1ldGFkYXRhSWQpIHtcclxuICAgICAgcmV0dXJuIG9mKHRydWUpO1xyXG4gICAgfSBlbHNlIGlmIChyb3dEYXRhLmV4cHJlc3Npb24gJiYgcm93RGF0YS5leHByZXNzaW9uLmV4cHJDb250ZW50KSB7XHJcbiAgICAgIHJldHVybiBvZih0cnVlKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMubm90aWZ5Lndhcm5pbmcodGhpcy5sb2NhbGVQaXBlLmluc3RhbnQoXCJldmVudFJvdXRlckNvbmRpdGlvbnNDb250ZW50Q2FudEJlRW1wdHlcIikpO1xyXG4gICAgICByZXR1cm4gb2YoZmFsc2UpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgZW5kRWRpdCguLi5hcmdzKSB7XHJcbiAgICAvLyBjb25zb2xlLmxvZygnRW5kIEVkaXQnLCBhcmdzKTtcclxuICAgIHRoaXMuZWRpdGluZ1Jvd0lkID0gbnVsbDtcclxuICB9XHJcblxyXG4gIGNhbmNlbEVkaXRlZCguLi5hcmdzKSB7XHJcbiAgICAvLyBjb25zb2xlLmxvZygn5Y+W5raI57yW6L6RJywgYXJncyk7XHJcbiAgICB0aGlzLmVkaXRpbmdSb3dJZCA9IG51bGw7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgY29uZmlnRXhwcmVzc2lvbkV4cGVuZEZ1bmNzKCkge1xyXG4gICAgLy8gbGV0IGNoYW5nZURldGFpbHM6IFZhckVudGl0eSA9XHJcbiAgICAvLyB7XHJcbiAgICAvLyAgIGtleTogXCJjaGFuZ2VEZXRhaWxzXCIsXHJcbiAgICAvLyAgIG5hbWU6IFwi5Lia5Yqh5a6e5L2T5Y+Y5pu06ZuG5YiX6KGoXCIsXHJcbiAgICAvLyAgIGRlc2NyaXB0aW9uOiBcIuS4muWKoeWunuS9k+WPmOabtOmbhuWIl+ihqFwiXHJcbiAgICAvLyB9XHJcbiAgICAvLyB0aGlzLmV4cHIuYWRkQ29udGV4dChjaGFuZ2VEZXRhaWxzKTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBTdGFydENvbmRpdGlvbkNvbnZlcnRlciBpbXBsZW1lbnRzIFR5cGVDb252ZXJ0ZXIge1xyXG5cclxuICBjb25zdHJ1Y3RvcigpIHsgfVxyXG5cclxuICBjb252ZXJ0VG8oZGF0YTogYW55KTogc3RyaW5nIHtcclxuICAgIGlmIChkYXRhICYmIGRhdGEuU3RhcnRDb25kaXRpb24pIHtcclxuICAgICAgcmV0dXJuICfvvIjlt7Lorr7nva7vvIknO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuICfvvIjmnKrorr7nva7vvIknO1xyXG4gIH1cclxufSJdfQ==