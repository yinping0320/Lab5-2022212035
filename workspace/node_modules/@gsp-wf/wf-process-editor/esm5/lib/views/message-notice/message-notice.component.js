/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { Component, HostBinding, EventEmitter, Output, Input, ViewChild, TemplateRef, ComponentFactoryResolver, Injector, ChangeDetectorRef, Optional, Inject, LOCALE_ID } from '@angular/core';
import { MessageNotice } from './message-notice';
import { BsModalService } from '@farris/ui-modal';
import { MessagerService } from '@farris/ui-messager';
import { MessageNoticeEditComponent } from './message-notice-edit/message-notice-edit.component';
import { DatagridComponent } from '@farris/ui-datagrid';
import { ProcessDeUtil } from '../../domain/process-de-util';
import { ProcessDesignerUIState } from '../../app/process-designer.uistate';
import { MessageNoticeCopyComponent } from './message-notice-copy/message-notice-copy.component';
import { ProcessDesignerViewModel } from '../../app/process-designer.viewmodel';
import { HttpService } from '@ecp-caf/caf-common';
import { MessageReceiver } from './message-receiver';
import { WF_LANG_RESOURCES, WfLocalePipe } from '../../i18n/pipe/wf-process-editor-locale.pipe';
var MessageNoticeComponent = /** @class */ (function () {
    function MessageNoticeComponent(resolver, injector, modalService, message, uistate, viewModel, http, cdr, localeId, resources, localePipe) {
        this.resolver = resolver;
        this.injector = injector;
        this.modalService = modalService;
        this.message = message;
        this.uistate = uistate;
        this.viewModel = viewModel;
        this.http = http;
        this.cdr = cdr;
        this.localeId = localeId;
        this.resources = resources;
        this.localePipe = localePipe;
        this.cls = 'farris-main-area flex-column';
        this.closeModal = new EventEmitter();
        this.submitModal = new EventEmitter();
        this.editorParams = {};
        this.modalConfig = {
            title: this.localePipe.transform('component.MessageNotice.notify'),
            width: 760,
            height: 480,
            showButtons: true
        };
        this.messageNotices = new Array();
        this.columns = [];
        this.location = 'activity';
        this.processSendTime = [
            { value: 'PROCESSINSTANCE_COMPLETED', text: this.localePipe.transform('component.MessageNotice.procComplete') },
            { value: 'PROCESSINSTANCE_ABORTED', text: this.localePipe.transform('component.MessageNotice.procAborted') },
            { value: 'PROCESSINSTANCE_ROLLBACK', text: this.localePipe.transform('component.MessageNotice.procRollBack') }
        ];
        this.activitySendTime = [
            { value: 'WORKITEM_CREATED', text: this.localePipe.transform('component.MessageNotice.workCreated') },
            { value: 'ACTIVITY_COMPLETED', text: this.localePipe.transform('component.MessageNotice.actComplete') },
            { value: 'ACTIVITY_ABORTED', text: this.localePipe.transform('component.MessageNotice.actAborted') },
        ];
        this.localePipe = this.localePipe || new WfLocalePipe(localeId, resources);
        this.GetOrganizationType();
    }
    Object.defineProperty(MessageNoticeComponent.prototype, "value", {
        set: /**
         * @param {?} notices
         * @return {?}
         */
        function (notices) {
            if (notices && notices.length > 0) {
                this.messageNotices = notices.map((/**
                 * @param {?} n
                 * @return {?}
                 */
                function (n) { return ({
                    id: ProcessDeUtil.GenerateElementId(),
                    content: n.content,
                    sendTime: n.sendTime,
                    sendType: n.sendType,
                    subject: n.subject,
                    receiver: n.receiver,
                    receiverText: n.receiverText,
                    receivers: n.receivers ? n.receivers : new Array(),
                    smsMessageTemplate: n.smsMessageTemplate
                }); }));
            }
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    MessageNoticeComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.location = this.editorParams.location;
        this.columns = [
            {
                field: 'subject', width: 100, title: this.localePipe.transform('component.MessageNotice.subject'),
            }, {
                field: 'content', width: 150, title: this.localePipe.transform('component.MessageNotice.content'), showTips: true,
            }, {
                field: 'sendTime', width: 100, title: this.localePipe.transform('component.MessageNotice.sendTime'),
                formatter: {
                    type: 'enum',
                    options: { valueField: 'value', textField: 'text', data: this.location === 'process' ? this.processSendTime : this.activitySendTime }
                },
            }, {
                field: 'sendType', width: 100, title: this.localePipe.transform('component.MessageNotice.sendType'),
                formatter: {
                    type: 'enum',
                    options: { valueField: 'value', textField: 'name', data: this.uistate.messageChannels.map((/**
                         * @param {?} m
                         * @return {?}
                         */
                        function (m) { return ({ value: m.code, name: m.name }); })) }
                },
            }, {
                field: 'receiverText', width: 120, title: this.localePipe.transform('component.MessageNotice.receiverText'), showTips: true, formatter: (/**
                 * @param {?} v
                 * @param {?} d
                 * @param {?} i
                 * @return {?}
                 */
                function (v, d, i) {
                    var e_1, _a;
                    /** @type {?} */
                    var receiverText = '';
                    if (d.receivers && d.receivers.length > 0) {
                        try {
                            for (var _b = tslib_1.__values(d.receivers), _c = _b.next(); !_c.done; _c = _b.next()) {
                                var receiver = _c.value;
                                if (receiver.type === 'processParticipant') {
                                    if (receiver.processParticipant === 'procInstCreator') {
                                        receiverText += _this.localePipe.transform('component.MessageNotice.procInstCreator');
                                    }
                                    else if (receiver.processParticipant === 'workItemParticipant') {
                                        receiverText += _this.localePipe.transform('component.MessageNotice.workItemParticipant');
                                    }
                                    else if (receiver.processParticipant === 'activityExecutorParticipant') {
                                        receiverText += (receiver.activityDefName + '，');
                                    }
                                }
                                else if (receiver.type === 'userParticipant') {
                                    receiverText += (receiver.userNames + '，');
                                }
                                else if (receiver.type === 'variableParticipant') {
                                    receiverText += (receiver.variableName + '，');
                                }
                                else if (receiver.type === 'positionParticipant') {
                                    receiverText += (receiver.positionName + '，');
                                }
                            }
                        }
                        catch (e_1_1) { e_1 = { error: e_1_1 }; }
                        finally {
                            try {
                                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                            }
                            finally { if (e_1) throw e_1.error; }
                        }
                    }
                    if (receiverText) {
                        receiverText = receiverText.substring(0, receiverText.length - 1);
                    }
                    return receiverText;
                }),
            }
        ];
        if (this.location === 'messageActivity') {
            this.columns = this.columns.filter((/**
             * @param {?} c
             * @return {?}
             */
            function (c) { return c.field !== 'sendTime'; }));
        }
    };
    /**
     * @return {?}
     */
    MessageNoticeComponent.prototype.add = /**
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var dialog;
        /** @type {?} */
        var compFactory = this.resolver.resolveComponentFactory(MessageNoticeEditComponent);
        /** @type {?} */
        var compRef = compFactory.create(this.injector);
        compRef.instance.location = this.location;
        /** @type {?} */
        var messageNotice = new MessageNotice();
        if (this.location === 'activity') {
            messageNotice.sendTime = 'WORKITEM_CREATED';
            /** @type {?} */
            var messageReceiver = new MessageReceiver();
            messageReceiver.type = 'processParticipant';
            messageReceiver.processParticipant = 'workItemParticipant';
            messageNotice.receivers = [messageReceiver];
        }
        else if (this.location === 'process') {
            messageNotice.sendTime = 'PROCESSINSTANCE_COMPLETED';
            /** @type {?} */
            var messageReceiver = new MessageReceiver();
            messageReceiver.type = 'processParticipant';
            messageReceiver.processParticipant = 'procInstCreator';
            messageNotice.receivers = [messageReceiver];
        }
        else if (this.location === 'messageActivity') {
            /** @type {?} */
            var messageReceiver = new MessageReceiver();
            messageReceiver.type = 'processParticipant';
            messageReceiver.processParticipant = 'procInstCreator';
            messageNotice.receivers = [messageReceiver];
        }
        compRef.instance.value = messageNotice;
        compRef.instance.submitEmitter.subscribe((/**
         * @param {?} re
         * @return {?}
         */
        function (re) {
            _this.messageNotices = _this.messageNotices.concat([re]);
            dialog.close();
        }));
        compRef.instance.closeEmitter.subscribe((/**
         * @param {?} re
         * @return {?}
         */
        function (re) {
            dialog.close();
        }));
        /** @type {?} */
        var modalConfig = {
            title: this.localePipe.transform('component.MessageNotice.messageSet'),
            width: 760,
            height: 480,
            showButtons: true,
            buttons: compRef.instance.footer
        };
        dialog = this.modalService.show(compRef, modalConfig);
    };
    /**
     * @return {?}
     */
    MessageNoticeComponent.prototype.edit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        if (!this.grid.selectedRow) {
            this.message.info(this.localePipe.transform('component.MessageNotice.selectedRow'));
            return;
        }
        /** @type {?} */
        var dialog;
        /** @type {?} */
        var compFactory = this.resolver.resolveComponentFactory(MessageNoticeEditComponent);
        /** @type {?} */
        var compRef = compFactory.create(this.injector);
        compRef.instance.location = this.location;
        compRef.instance.value = this.grid.selectedRow.data;
        compRef.instance.submitEmitter.subscribe((/**
         * @param {?} re
         * @return {?}
         */
        function (re) {
            _this.messageNotices = _this.messageNotices.map((/**
             * @param {?} m
             * @return {?}
             */
            function (m) {
                if (m.id === re.id) {
                    return re;
                }
                return m;
            }));
            _this.grid.unSelectRow(_this.grid.selectedRow.data.id, true);
            dialog.close();
        }));
        compRef.instance.closeEmitter.subscribe((/**
         * @param {?} re
         * @return {?}
         */
        function (re) {
            dialog.close();
        }));
        /** @type {?} */
        var modalConfig = {
            title: this.localePipe.transform('component.MessageNotice.messageSet'),
            width: 760,
            height: 480,
            showButtons: true,
            buttons: compRef.instance.footer
        };
        dialog = this.modalService.show(compRef, modalConfig);
    };
    /**
     * @return {?}
     */
    MessageNoticeComponent.prototype.batchCopy = /**
     * @return {?}
     */
    function () {
        var _this = this;
        if (!this.messageNotices) {
            this.message.info(this.localePipe.transform('component.MessageNotice.noCopy'));
            return;
        }
        /** @type {?} */
        var dialog;
        /** @type {?} */
        var compFactory = this.resolver.resolveComponentFactory(MessageNoticeCopyComponent);
        /** @type {?} */
        var compRef = compFactory.create(this.injector);
        compRef.instance.messageNotices = this.messageNotices;
        compRef.instance.submitEmitter.subscribe((/**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            _this.viewModel.copy(ResourceKeys.batchCopyProperty, data);
            dialog.close();
        }));
        compRef.instance.closeEmitter.subscribe((/**
         * @param {?} re
         * @return {?}
         */
        function (re) {
            dialog.close();
        }));
        /** @type {?} */
        var modalConfig = {
            title: this.localePipe.transform('component.MessageNotice.batchCopy'),
            width: 800,
            height: 515,
            showButtons: true,
            buttons: compRef.instance.modalFooter
        };
        dialog = this.modalService.show(compRef, modalConfig);
    };
    /**
     * @return {?}
     */
    MessageNoticeComponent.prototype.delete = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var selected = this.grid.selectedRow;
        if (!selected) {
            this.message.info(this.localePipe.transform('component.MessageNotice.selectedRow'));
            return;
        }
        this.messageNotices = this.messageNotices.filter((/**
         * @param {?} m
         * @return {?}
         */
        function (m) { return m.id !== selected.id; }));
    };
    /**
     * @return {?}
     */
    MessageNoticeComponent.prototype.clickOK = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var object = { value: this.messageNotices, parameters: null };
        this.submitModal.emit(object);
    };
    /**
     * @return {?}
     */
    MessageNoticeComponent.prototype.clickCancel = /**
     * @return {?}
     */
    function () {
        this.closeModal.emit();
    };
    /**
     * @private
     * @return {?}
     */
    MessageNoticeComponent.prototype.GetOrganizationType = /**
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var url = '/api/runtime/sys/v1.0/authfields/globalauthfields';
        this.http.get(url)
            .subscribe((/**
         * @param {?} data
         * @return {?}
         */
        function (data) { return _this.uistate.orgTypeCollection = data.map((/**
         * @param {?} d
         * @return {?}
         */
        function (d) { return ({ value: d.id, text: d.name }); })); }));
    };
    MessageNoticeComponent.decorators = [
        { type: Component, args: [{
                    selector: 'lib-message-notice',
                    template: "<div class=\"f-page\">\r\n  <div class=\"f-page-header\">\r\n    <nav class=\"f-page-header-base\">\r\n      <div class=\"f-title\">\r\n      </div>\r\n      <div class=\"btn-toolbar btn-group-lg\">\r\n        <button class=\"btn btn-primary mr-2\" (click)=\"add()\">{{'component.MessageNotice.add' | wfLocale}}</button>\r\n        <button class=\"btn btn-secondary mr-2\" (click)=\"edit()\">{{'component.MessageNotice.edit' | wfLocale}}</button>\r\n        <button class=\"btn btn-secondary mr-2\" [disabled]=\"location!=='activity'\" (click)=\"batchCopy()\">{{'component.MessageNotice.batchCopy' | wfLocale}}</button>\r\n        <button class=\"btn btn-secondary\" (click)=\"delete()\">{{'component.MessageNotice.delete' | wfLocale}}</button>\r\n      </div>\r\n    </nav>\r\n  </div>\r\n  <div class=\"f-page-main f-utils-fill-flex-column h-100\">\r\n    <div class=\"f-utils-fill-flex-column farris-overflow-y-auto h-100\" style=\"border-radius:16px;border: 1.5px solid #F1F3F7;\">\r\n      <farris-datagrid #grid [data]=\"messageNotices\" [columns]=\"columns\" [idField]=\"'id'\" [fit]=\"true\"\r\n        [fitColumns]=\"true\" [editable]=\"false\" [pagination]=\"false\" [showCheckbox]=\"false\"\r\n        [multiSelect]=\"false\" [showLineNumber]=\"true\" lineNumberTitle=\"{{'component.MessageNotice.lineNumber'|wfLocale}}\" [lineNumberWidth]=\"50\"\r\n        [striped]=\"true\">\r\n      </farris-datagrid>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type=\"button\" class=\"btn btn-secondary btn-sm px-3 mx-2\" (click)=\"clickCancel()\">{{'component.MessageNotice.clickCancel' | wfLocale}}</button>\r\n  <button type=\"button\" class=\"btn btn-primary btn-sm px-3 mx-2\" (click)=\"clickOK()\">{{'component.MessageNotice.clickOK' | wfLocale}}</button>\r\n</ng-template>\r\n",
                    providers: [
                        WfLocalePipe,
                    ],
                    styles: [""]
                }] }
    ];
    /** @nocollapse */
    MessageNoticeComponent.ctorParameters = function () { return [
        { type: ComponentFactoryResolver },
        { type: Injector },
        { type: BsModalService },
        { type: MessagerService },
        { type: ProcessDesignerUIState },
        { type: ProcessDesignerViewModel },
        { type: HttpService },
        { type: ChangeDetectorRef, decorators: [{ type: Optional }] },
        { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
        { type: undefined, decorators: [{ type: Inject, args: [WF_LANG_RESOURCES,] }] },
        { type: WfLocalePipe, decorators: [{ type: Optional }] }
    ]; };
    MessageNoticeComponent.propDecorators = {
        cls: [{ type: HostBinding, args: ['class',] }],
        closeModal: [{ type: Output }],
        submitModal: [{ type: Output }],
        value: [{ type: Input }],
        editorParams: [{ type: Input }],
        modalFooter: [{ type: ViewChild, args: ['iconSelectFooter',] }],
        grid: [{ type: ViewChild, args: ['grid',] }]
    };
    return MessageNoticeComponent;
}());
export { MessageNoticeComponent };
if (false) {
    /** @type {?} */
    MessageNoticeComponent.prototype.cls;
    /** @type {?} */
    MessageNoticeComponent.prototype.closeModal;
    /** @type {?} */
    MessageNoticeComponent.prototype.submitModal;
    /** @type {?} */
    MessageNoticeComponent.prototype.editorParams;
    /** @type {?} */
    MessageNoticeComponent.prototype.modalFooter;
    /** @type {?} */
    MessageNoticeComponent.prototype.grid;
    /** @type {?} */
    MessageNoticeComponent.prototype.modalConfig;
    /** @type {?} */
    MessageNoticeComponent.prototype.messageNotices;
    /** @type {?} */
    MessageNoticeComponent.prototype.columns;
    /** @type {?} */
    MessageNoticeComponent.prototype.location;
    /** @type {?} */
    MessageNoticeComponent.prototype.processSendTime;
    /** @type {?} */
    MessageNoticeComponent.prototype.activitySendTime;
    /**
     * @type {?}
     * @private
     */
    MessageNoticeComponent.prototype.resolver;
    /**
     * @type {?}
     * @private
     */
    MessageNoticeComponent.prototype.injector;
    /**
     * @type {?}
     * @private
     */
    MessageNoticeComponent.prototype.modalService;
    /**
     * @type {?}
     * @private
     */
    MessageNoticeComponent.prototype.message;
    /**
     * @type {?}
     * @private
     */
    MessageNoticeComponent.prototype.uistate;
    /**
     * @type {?}
     * @private
     */
    MessageNoticeComponent.prototype.viewModel;
    /**
     * @type {?}
     * @private
     */
    MessageNoticeComponent.prototype.http;
    /**
     * @type {?}
     * @private
     */
    MessageNoticeComponent.prototype.cdr;
    /**
     * @type {?}
     * @private
     */
    MessageNoticeComponent.prototype.localeId;
    /**
     * @type {?}
     * @private
     */
    MessageNoticeComponent.prototype.resources;
    /**
     * @type {?}
     * @private
     */
    MessageNoticeComponent.prototype.localePipe;
}
/** @enum {string} */
var ResourceKeys = {
    batchCopyProperty: 'batchCopyProperty',
};
export { ResourceKeys };
var MessageNoticeConverter = /** @class */ (function () {
    function MessageNoticeConverter(localePipe) {
        this.localePipe = localePipe;
    }
    /**
     * @param {?} data
     * @return {?}
     */
    MessageNoticeConverter.prototype.convertTo = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        if (data && data.length > 0) {
            return this.localePipe.transform("component.MessageNotice.set");
        }
        else {
            return this.localePipe.transform("component.MessageNotice.notSet");
        }
    };
    return MessageNoticeConverter;
}());
export { MessageNoticeConverter };
if (false) {
    /**
     * @type {?}
     * @private
     */
    MessageNoticeConverter.prototype.localePipe;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWVzc2FnZS1ub3RpY2UuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGdzcC13Zi93Zi1wcm9jZXNzLWVkaXRvci8iLCJzb3VyY2VzIjpbImxpYi92aWV3cy9tZXNzYWdlLW5vdGljZS9tZXNzYWdlLW5vdGljZS5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFVLFdBQVcsRUFBRSxZQUFZLEVBQUUsTUFBTSxFQUFFLEtBQUssRUFBRSxTQUFTLEVBQUUsV0FBVyxFQUFFLHdCQUF3QixFQUFFLFFBQVEsRUFBYyxpQkFBaUIsRUFBRSxRQUFRLEVBQUUsTUFBTSxFQUFFLFNBQVMsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUVwTixPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0sa0JBQWtCLENBQUM7QUFDakQsT0FBTyxFQUFFLGNBQWMsRUFBRSxNQUFNLGtCQUFrQixDQUFDO0FBQ2xELE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUN0RCxPQUFPLEVBQUUsMEJBQTBCLEVBQUUsTUFBTSxxREFBcUQsQ0FBQztBQUNqRyxPQUFPLEVBQUUsaUJBQWlCLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUN4RCxPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0sOEJBQThCLENBQUM7QUFDN0QsT0FBTyxFQUFFLHNCQUFzQixFQUFFLE1BQU0sb0NBQW9DLENBQUM7QUFDNUUsT0FBTyxFQUFFLDBCQUEwQixFQUFFLE1BQU0scURBQXFELENBQUM7QUFDakcsT0FBTyxFQUFFLHdCQUF3QixFQUFFLE1BQU0sc0NBQXNDLENBQUM7QUFDaEYsT0FBTyxFQUFFLFdBQVcsRUFBRSxNQUFNLHFCQUFxQixDQUFDO0FBQ2xELE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxvQkFBb0IsQ0FBQztBQUNyRCxPQUFPLEVBQUUsaUJBQWlCLEVBQUUsWUFBWSxFQUFFLE1BQU0sK0NBQStDLENBQUM7QUFHaEc7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OztJQUN6QixxQ0FBMEM7Ozs7O0lBQzFDLDBDQUEyQzs7Ozs7SUFDM0MsMkNBQWlEOzs7OztJQUNqRCw0Q0FBNEM7Ozs7SUFnTTlDLG1CQUFvQixtQkFBbUI7OztBQUd6QztJQUNFLGdDQUNVLFVBQXdCO1FBQXhCLGVBQVUsR0FBVixVQUFVLENBQWM7SUFDOUIsQ0FBQzs7Ozs7SUFFTCwwQ0FBUzs7OztJQUFULFVBQVUsSUFBVztRQUNuQixJQUFJLElBQUksSUFBSSxJQUFJLENBQUMsTUFBTSxHQUFHLENBQUMsRUFBRTtZQUMzQixPQUFPLElBQUksQ0FBQyxVQUFVLENBQUMsU0FBUyxDQUFDLDZCQUE2QixDQUFDLENBQUM7U0FDakU7YUFBTTtZQUNMLE9BQU8sSUFBSSxDQUFDLFVBQVUsQ0FBQyxTQUFTLENBQUMsZ0NBQWdDLENBQUMsQ0FBQztTQUNwRTtJQUNILENBQUM7SUFDSCw2QkFBQztBQUFELENBQUMsQUFaRCxJQVlDOzs7Ozs7O0lBVkcsNENBQWdDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50LCBPbkluaXQsIEhvc3RCaW5kaW5nLCBFdmVudEVtaXR0ZXIsIE91dHB1dCwgSW5wdXQsIFZpZXdDaGlsZCwgVGVtcGxhdGVSZWYsIENvbXBvbmVudEZhY3RvcnlSZXNvbHZlciwgSW5qZWN0b3IsIEVsZW1lbnRSZWYsIENoYW5nZURldGVjdG9yUmVmLCBPcHRpb25hbCwgSW5qZWN0LCBMT0NBTEVfSUQgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgVHlwZUNvbnZlcnRlciB9IGZyb20gJ0BmYXJyaXMvaWRlLXByb3BlcnR5LXBhbmVsJztcclxuaW1wb3J0IHsgTWVzc2FnZU5vdGljZSB9IGZyb20gJy4vbWVzc2FnZS1ub3RpY2UnO1xyXG5pbXBvcnQgeyBCc01vZGFsU2VydmljZSB9IGZyb20gJ0BmYXJyaXMvdWktbW9kYWwnO1xyXG5pbXBvcnQgeyBNZXNzYWdlclNlcnZpY2UgfSBmcm9tICdAZmFycmlzL3VpLW1lc3NhZ2VyJztcclxuaW1wb3J0IHsgTWVzc2FnZU5vdGljZUVkaXRDb21wb25lbnQgfSBmcm9tICcuL21lc3NhZ2Utbm90aWNlLWVkaXQvbWVzc2FnZS1ub3RpY2UtZWRpdC5jb21wb25lbnQnO1xyXG5pbXBvcnQgeyBEYXRhZ3JpZENvbXBvbmVudCB9IGZyb20gJ0BmYXJyaXMvdWktZGF0YWdyaWQnO1xyXG5pbXBvcnQgeyBQcm9jZXNzRGVVdGlsIH0gZnJvbSAnLi4vLi4vZG9tYWluL3Byb2Nlc3MtZGUtdXRpbCc7XHJcbmltcG9ydCB7IFByb2Nlc3NEZXNpZ25lclVJU3RhdGUgfSBmcm9tICcuLi8uLi9hcHAvcHJvY2Vzcy1kZXNpZ25lci51aXN0YXRlJztcclxuaW1wb3J0IHsgTWVzc2FnZU5vdGljZUNvcHlDb21wb25lbnQgfSBmcm9tICcuL21lc3NhZ2Utbm90aWNlLWNvcHkvbWVzc2FnZS1ub3RpY2UtY29weS5jb21wb25lbnQnO1xyXG5pbXBvcnQgeyBQcm9jZXNzRGVzaWduZXJWaWV3TW9kZWwgfSBmcm9tICcuLi8uLi9hcHAvcHJvY2Vzcy1kZXNpZ25lci52aWV3bW9kZWwnO1xyXG5pbXBvcnQgeyBIdHRwU2VydmljZSB9IGZyb20gJ0BlY3AtY2FmL2NhZi1jb21tb24nO1xyXG5pbXBvcnQgeyBNZXNzYWdlUmVjZWl2ZXIgfSBmcm9tICcuL21lc3NhZ2UtcmVjZWl2ZXInO1xyXG5pbXBvcnQgeyBXRl9MQU5HX1JFU09VUkNFUywgV2ZMb2NhbGVQaXBlIH0gZnJvbSAnLi4vLi4vaTE4bi9waXBlL3dmLXByb2Nlc3MtZWRpdG9yLWxvY2FsZS5waXBlJztcclxuaW1wb3J0IHsgV0ZfUFJPQ0VTU19FRElUT1JfTEFOR19SRVNPVVJDRVMgfSBmcm9tICcuLi8uLi9pMThuL2Fzc2V0cy9sYW5nLnJlc291cmNlJztcclxuXHJcbkBDb21wb25lbnQoe1xyXG4gIHNlbGVjdG9yOiAnbGliLW1lc3NhZ2Utbm90aWNlJyxcclxuICB0ZW1wbGF0ZVVybDogJy4vbWVzc2FnZS1ub3RpY2UuY29tcG9uZW50Lmh0bWwnLFxyXG4gIHN0eWxlVXJsczogWycuL21lc3NhZ2Utbm90aWNlLmNvbXBvbmVudC5zY3NzJ10sXHJcbiAgcHJvdmlkZXJzOiBbXHJcbiAgICAgV2ZMb2NhbGVQaXBlLFxyXG4gIF1cclxufSlcclxuZXhwb3J0IGNsYXNzIE1lc3NhZ2VOb3RpY2VDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQge1xyXG4gIEBIb3N0QmluZGluZygnY2xhc3MnKVxyXG4gIGNscyA9ICdmYXJyaXMtbWFpbi1hcmVhIGZsZXgtY29sdW1uJztcclxuXHJcbiAgQE91dHB1dCgpIGNsb3NlTW9kYWwgPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcclxuICBAT3V0cHV0KCkgc3VibWl0TW9kYWwgPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcclxuXHJcbiAgQElucHV0KClcclxuICBzZXQgdmFsdWUobm90aWNlczogYW55W10pIHtcclxuICAgIGlmIChub3RpY2VzICYmIG5vdGljZXMubGVuZ3RoID4gMCkge1xyXG4gICAgICB0aGlzLm1lc3NhZ2VOb3RpY2VzID0gbm90aWNlcy5tYXAobiA9PiAoe1xyXG4gICAgICAgIGlkOiBQcm9jZXNzRGVVdGlsLkdlbmVyYXRlRWxlbWVudElkKCksXHJcbiAgICAgICAgY29udGVudDogbi5jb250ZW50LFxyXG4gICAgICAgIHNlbmRUaW1lOiBuLnNlbmRUaW1lLFxyXG4gICAgICAgIHNlbmRUeXBlOiBuLnNlbmRUeXBlLFxyXG4gICAgICAgIHN1YmplY3Q6IG4uc3ViamVjdCxcclxuICAgICAgICByZWNlaXZlcjogbi5yZWNlaXZlcixcclxuICAgICAgICByZWNlaXZlclRleHQ6IG4ucmVjZWl2ZXJUZXh0LFxyXG4gICAgICAgIHJlY2VpdmVyczogbi5yZWNlaXZlcnMgPyBuLnJlY2VpdmVycyA6IG5ldyBBcnJheSgpLFxyXG4gICAgICAgIHNtc01lc3NhZ2VUZW1wbGF0ZTogbi5zbXNNZXNzYWdlVGVtcGxhdGVcclxuICAgICAgfSkpO1xyXG4gICAgfVxyXG4gIH1cclxuICBASW5wdXQoKSBlZGl0b3JQYXJhbXM6IGFueSA9IHt9O1xyXG4gIEBWaWV3Q2hpbGQoJ2ljb25TZWxlY3RGb290ZXInKSBtb2RhbEZvb3RlcjogVGVtcGxhdGVSZWY8YW55PjtcclxuICBAVmlld0NoaWxkKCdncmlkJykgZ3JpZDogRGF0YWdyaWRDb21wb25lbnQ7XHJcblxyXG4gIG1vZGFsQ29uZmlnID0ge1xyXG4gICAgdGl0bGU6IHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oJ2NvbXBvbmVudC5NZXNzYWdlTm90aWNlLm5vdGlmeScpLFxyXG4gICAgd2lkdGg6IDc2MCxcclxuICAgIGhlaWdodDogNDgwLFxyXG4gICAgc2hvd0J1dHRvbnM6IHRydWVcclxuICB9O1xyXG5cclxuICBtZXNzYWdlTm90aWNlczogQXJyYXk8TWVzc2FnZU5vdGljZT4gPSBuZXcgQXJyYXkoKTtcclxuICBjb2x1bW5zID0gW107XHJcblxyXG4gIGxvY2F0aW9uOiAnYWN0aXZpdHknIHwgJ3Byb2Nlc3MnIHwgJ21lc3NhZ2VBY3Rpdml0eScgPSAnYWN0aXZpdHknO1xyXG5cclxuICBjb25zdHJ1Y3RvcihcclxuICAgIHByaXZhdGUgcmVzb2x2ZXI6IENvbXBvbmVudEZhY3RvcnlSZXNvbHZlcixcclxuICAgIHByaXZhdGUgaW5qZWN0b3I6IEluamVjdG9yLFxyXG4gICAgcHJpdmF0ZSBtb2RhbFNlcnZpY2U6IEJzTW9kYWxTZXJ2aWNlLFxyXG4gICAgcHJpdmF0ZSBtZXNzYWdlOiBNZXNzYWdlclNlcnZpY2UsXHJcbiAgICBwcml2YXRlIHVpc3RhdGU6IFByb2Nlc3NEZXNpZ25lclVJU3RhdGUsXHJcbiAgICBwcml2YXRlIHZpZXdNb2RlbDogUHJvY2Vzc0Rlc2lnbmVyVmlld01vZGVsLFxyXG4gICAgcHJpdmF0ZSBodHRwOiBIdHRwU2VydmljZSxcclxuICAgIEBPcHRpb25hbCgpIHByaXZhdGUgY2RyOiBDaGFuZ2VEZXRlY3RvclJlZixcclxuICAgIEBJbmplY3QoTE9DQUxFX0lEKSBwcml2YXRlIGxvY2FsZUlkOiBzdHJpbmcsXHJcbiAgICBASW5qZWN0KFdGX0xBTkdfUkVTT1VSQ0VTKSBwcml2YXRlIHJlc291cmNlczogYW55LFxyXG4gICAgQE9wdGlvbmFsKCkgcHJpdmF0ZSBsb2NhbGVQaXBlOiBXZkxvY2FsZVBpcGVcclxuICApIHtcclxuICAgIHRoaXMubG9jYWxlUGlwZSA9IHRoaXMubG9jYWxlUGlwZSB8fCBuZXcgV2ZMb2NhbGVQaXBlKGxvY2FsZUlkLCByZXNvdXJjZXMpO1xyXG4gICAgdGhpcy5HZXRPcmdhbml6YXRpb25UeXBlKCk7XHJcbiAgfVxyXG5cclxuICBuZ09uSW5pdCgpIHtcclxuICAgIHRoaXMubG9jYXRpb24gPSB0aGlzLmVkaXRvclBhcmFtcy5sb2NhdGlvbjtcclxuICAgIHRoaXMuY29sdW1ucyA9IFtcclxuICAgICAge1xyXG4gICAgICAgIGZpZWxkOiAnc3ViamVjdCcsIHdpZHRoOiAxMDAsIHRpdGxlOiB0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKCdjb21wb25lbnQuTWVzc2FnZU5vdGljZS5zdWJqZWN0JyksXHJcbiAgICAgIH0sIHtcclxuICAgICAgICBmaWVsZDogJ2NvbnRlbnQnLCB3aWR0aDogMTUwLCB0aXRsZTogdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybSgnY29tcG9uZW50Lk1lc3NhZ2VOb3RpY2UuY29udGVudCcpLCBzaG93VGlwczogdHJ1ZSxcclxuICAgICAgfSwge1xyXG4gICAgICAgIGZpZWxkOiAnc2VuZFRpbWUnLCB3aWR0aDogMTAwLCB0aXRsZTogdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybSgnY29tcG9uZW50Lk1lc3NhZ2VOb3RpY2Uuc2VuZFRpbWUnKSxcclxuICAgICAgICBmb3JtYXR0ZXI6IHtcclxuICAgICAgICAgIHR5cGU6ICdlbnVtJyxcclxuICAgICAgICAgIG9wdGlvbnM6IHsgdmFsdWVGaWVsZDogJ3ZhbHVlJywgdGV4dEZpZWxkOiAndGV4dCcsIGRhdGE6IHRoaXMubG9jYXRpb24gPT09ICdwcm9jZXNzJyA/IHRoaXMucHJvY2Vzc1NlbmRUaW1lIDogdGhpcy5hY3Rpdml0eVNlbmRUaW1lIH1cclxuICAgICAgICB9LFxyXG4gICAgICB9LCB7XHJcbiAgICAgICAgZmllbGQ6ICdzZW5kVHlwZScsIHdpZHRoOiAxMDAsIHRpdGxlOiB0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKCdjb21wb25lbnQuTWVzc2FnZU5vdGljZS5zZW5kVHlwZScpLFxyXG4gICAgICAgIGZvcm1hdHRlcjoge1xyXG4gICAgICAgICAgdHlwZTogJ2VudW0nLFxyXG4gICAgICAgICAgb3B0aW9uczogeyB2YWx1ZUZpZWxkOiAndmFsdWUnLCB0ZXh0RmllbGQ6ICduYW1lJywgZGF0YTogdGhpcy51aXN0YXRlLm1lc3NhZ2VDaGFubmVscy5tYXAobSA9PiAoeyB2YWx1ZTogbS5jb2RlLCBuYW1lOiBtLm5hbWUgfSkpIH1cclxuICAgICAgICB9LFxyXG4gICAgICB9LCB7XHJcbiAgICAgICAgZmllbGQ6ICdyZWNlaXZlclRleHQnLCB3aWR0aDogMTIwLCB0aXRsZTogdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybSgnY29tcG9uZW50Lk1lc3NhZ2VOb3RpY2UucmVjZWl2ZXJUZXh0JyksIHNob3dUaXBzOiB0cnVlLCBmb3JtYXR0ZXI6ICh2LCBkLCBpKSA9PiB7XHJcbiAgICAgICAgICBsZXQgcmVjZWl2ZXJUZXh0ID0gJyc7XHJcbiAgICAgICAgICBpZiAoZC5yZWNlaXZlcnMgJiYgZC5yZWNlaXZlcnMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IHJlY2VpdmVyIG9mIGQucmVjZWl2ZXJzKSB7XHJcbiAgICAgICAgICAgICAgaWYgKHJlY2VpdmVyLnR5cGUgPT09ICdwcm9jZXNzUGFydGljaXBhbnQnKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAocmVjZWl2ZXIucHJvY2Vzc1BhcnRpY2lwYW50ID09PSAncHJvY0luc3RDcmVhdG9yJykge1xyXG4gICAgICAgICAgICAgICAgICByZWNlaXZlclRleHQgKz0gdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybSgnY29tcG9uZW50Lk1lc3NhZ2VOb3RpY2UucHJvY0luc3RDcmVhdG9yJyk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHJlY2VpdmVyLnByb2Nlc3NQYXJ0aWNpcGFudCA9PT0gJ3dvcmtJdGVtUGFydGljaXBhbnQnKSB7XHJcbiAgICAgICAgICAgICAgICAgIHJlY2VpdmVyVGV4dCArPSB0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKCdjb21wb25lbnQuTWVzc2FnZU5vdGljZS53b3JrSXRlbVBhcnRpY2lwYW50Jyk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHJlY2VpdmVyLnByb2Nlc3NQYXJ0aWNpcGFudCA9PT0gJ2FjdGl2aXR5RXhlY3V0b3JQYXJ0aWNpcGFudCcpIHtcclxuICAgICAgICAgICAgICAgICAgcmVjZWl2ZXJUZXh0ICs9IChyZWNlaXZlci5hY3Rpdml0eURlZk5hbWUgKyAn77yMJyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgfSBlbHNlIGlmIChyZWNlaXZlci50eXBlID09PSAndXNlclBhcnRpY2lwYW50Jykge1xyXG4gICAgICAgICAgICAgICAgcmVjZWl2ZXJUZXh0ICs9IChyZWNlaXZlci51c2VyTmFtZXMgKyAn77yMJyk7XHJcbiAgICAgICAgICAgICAgfSBlbHNlIGlmIChyZWNlaXZlci50eXBlID09PSAndmFyaWFibGVQYXJ0aWNpcGFudCcpIHtcclxuICAgICAgICAgICAgICAgIHJlY2VpdmVyVGV4dCArPSAocmVjZWl2ZXIudmFyaWFibGVOYW1lICsgJ++8jCcpO1xyXG4gICAgICAgICAgICAgIH0gZWxzZSBpZiAocmVjZWl2ZXIudHlwZSA9PT0gJ3Bvc2l0aW9uUGFydGljaXBhbnQnKSB7XHJcbiAgICAgICAgICAgICAgICByZWNlaXZlclRleHQgKz0gKHJlY2VpdmVyLnBvc2l0aW9uTmFtZSArICfvvIwnKTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGlmIChyZWNlaXZlclRleHQpIHtcclxuICAgICAgICAgICAgcmVjZWl2ZXJUZXh0ID0gcmVjZWl2ZXJUZXh0LnN1YnN0cmluZygwLCByZWNlaXZlclRleHQubGVuZ3RoIC0gMSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICByZXR1cm4gcmVjZWl2ZXJUZXh0O1xyXG4gICAgICAgIH0sXHJcbiAgICAgIH1dO1xyXG4gICAgaWYgKHRoaXMubG9jYXRpb24gPT09ICdtZXNzYWdlQWN0aXZpdHknKSB7XHJcbiAgICAgIHRoaXMuY29sdW1ucyA9IHRoaXMuY29sdW1ucy5maWx0ZXIoYyA9PiBjLmZpZWxkICE9PSAnc2VuZFRpbWUnKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGFkZCgpIHtcclxuICAgIGxldCBkaWFsb2c6IGFueTtcclxuICAgIGNvbnN0IGNvbXBGYWN0b3J5ID0gdGhpcy5yZXNvbHZlci5yZXNvbHZlQ29tcG9uZW50RmFjdG9yeShNZXNzYWdlTm90aWNlRWRpdENvbXBvbmVudCk7XHJcbiAgICBjb25zdCBjb21wUmVmID0gY29tcEZhY3RvcnkuY3JlYXRlKHRoaXMuaW5qZWN0b3IpO1xyXG4gICAgY29tcFJlZi5pbnN0YW5jZS5sb2NhdGlvbiA9IHRoaXMubG9jYXRpb247XHJcbiAgICBjb25zdCBtZXNzYWdlTm90aWNlID0gbmV3IE1lc3NhZ2VOb3RpY2UoKTtcclxuICAgIGlmICh0aGlzLmxvY2F0aW9uID09PSAnYWN0aXZpdHknKSB7XHJcbiAgICAgIG1lc3NhZ2VOb3RpY2Uuc2VuZFRpbWUgPSAnV09SS0lURU1fQ1JFQVRFRCc7XHJcbiAgICAgIGNvbnN0IG1lc3NhZ2VSZWNlaXZlciA9IG5ldyBNZXNzYWdlUmVjZWl2ZXIoKTtcclxuICAgICAgbWVzc2FnZVJlY2VpdmVyLnR5cGUgPSAncHJvY2Vzc1BhcnRpY2lwYW50JztcclxuICAgICAgbWVzc2FnZVJlY2VpdmVyLnByb2Nlc3NQYXJ0aWNpcGFudCA9ICd3b3JrSXRlbVBhcnRpY2lwYW50JztcclxuICAgICAgbWVzc2FnZU5vdGljZS5yZWNlaXZlcnMgPSBbbWVzc2FnZVJlY2VpdmVyXTtcclxuICAgIH0gZWxzZSBpZiAodGhpcy5sb2NhdGlvbiA9PT0gJ3Byb2Nlc3MnKSB7XHJcbiAgICAgIG1lc3NhZ2VOb3RpY2Uuc2VuZFRpbWUgPSAnUFJPQ0VTU0lOU1RBTkNFX0NPTVBMRVRFRCc7XHJcbiAgICAgIGNvbnN0IG1lc3NhZ2VSZWNlaXZlciA9IG5ldyBNZXNzYWdlUmVjZWl2ZXIoKTtcclxuICAgICAgbWVzc2FnZVJlY2VpdmVyLnR5cGUgPSAncHJvY2Vzc1BhcnRpY2lwYW50JztcclxuICAgICAgbWVzc2FnZVJlY2VpdmVyLnByb2Nlc3NQYXJ0aWNpcGFudCA9ICdwcm9jSW5zdENyZWF0b3InO1xyXG4gICAgICBtZXNzYWdlTm90aWNlLnJlY2VpdmVycyA9IFttZXNzYWdlUmVjZWl2ZXJdO1xyXG4gICAgfSBlbHNlIGlmICh0aGlzLmxvY2F0aW9uID09PSAnbWVzc2FnZUFjdGl2aXR5Jykge1xyXG4gICAgICBjb25zdCBtZXNzYWdlUmVjZWl2ZXIgPSBuZXcgTWVzc2FnZVJlY2VpdmVyKCk7XHJcbiAgICAgIG1lc3NhZ2VSZWNlaXZlci50eXBlID0gJ3Byb2Nlc3NQYXJ0aWNpcGFudCc7XHJcbiAgICAgIG1lc3NhZ2VSZWNlaXZlci5wcm9jZXNzUGFydGljaXBhbnQgPSAncHJvY0luc3RDcmVhdG9yJztcclxuICAgICAgbWVzc2FnZU5vdGljZS5yZWNlaXZlcnMgPSBbbWVzc2FnZVJlY2VpdmVyXTtcclxuICAgIH1cclxuICAgIGNvbXBSZWYuaW5zdGFuY2UudmFsdWUgPSBtZXNzYWdlTm90aWNlO1xyXG4gICAgY29tcFJlZi5pbnN0YW5jZS5zdWJtaXRFbWl0dGVyLnN1YnNjcmliZSgocmU6IE1lc3NhZ2VOb3RpY2UpID0+IHtcclxuICAgICAgdGhpcy5tZXNzYWdlTm90aWNlcyA9IHRoaXMubWVzc2FnZU5vdGljZXMuY29uY2F0KFtyZV0pO1xyXG4gICAgICBkaWFsb2cuY2xvc2UoKTtcclxuICAgIH0pO1xyXG4gICAgY29tcFJlZi5pbnN0YW5jZS5jbG9zZUVtaXR0ZXIuc3Vic2NyaWJlKHJlID0+IHtcclxuICAgICAgZGlhbG9nLmNsb3NlKCk7XHJcbiAgICB9KTtcclxuICAgIGNvbnN0IG1vZGFsQ29uZmlnID0ge1xyXG4gICAgICB0aXRsZTogdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybSgnY29tcG9uZW50Lk1lc3NhZ2VOb3RpY2UubWVzc2FnZVNldCcpLFxyXG4gICAgICB3aWR0aDogNzYwLFxyXG4gICAgICBoZWlnaHQ6IDQ4MCxcclxuICAgICAgc2hvd0J1dHRvbnM6IHRydWUsXHJcbiAgICAgIGJ1dHRvbnM6IGNvbXBSZWYuaW5zdGFuY2UuZm9vdGVyXHJcbiAgICB9O1xyXG4gICAgZGlhbG9nID0gdGhpcy5tb2RhbFNlcnZpY2Uuc2hvdyhjb21wUmVmLCBtb2RhbENvbmZpZyk7XHJcbiAgfVxyXG4gIGVkaXQoKSB7XHJcbiAgICBpZiAoIXRoaXMuZ3JpZC5zZWxlY3RlZFJvdykge1xyXG4gICAgICB0aGlzLm1lc3NhZ2UuaW5mbyh0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKCdjb21wb25lbnQuTWVzc2FnZU5vdGljZS5zZWxlY3RlZFJvdycpKTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgbGV0IGRpYWxvZzogYW55O1xyXG4gICAgY29uc3QgY29tcEZhY3RvcnkgPSB0aGlzLnJlc29sdmVyLnJlc29sdmVDb21wb25lbnRGYWN0b3J5KE1lc3NhZ2VOb3RpY2VFZGl0Q29tcG9uZW50KTtcclxuICAgIGNvbnN0IGNvbXBSZWYgPSBjb21wRmFjdG9yeS5jcmVhdGUodGhpcy5pbmplY3Rvcik7XHJcbiAgICBjb21wUmVmLmluc3RhbmNlLmxvY2F0aW9uID0gdGhpcy5sb2NhdGlvbjtcclxuICAgIGNvbXBSZWYuaW5zdGFuY2UudmFsdWUgPSB0aGlzLmdyaWQuc2VsZWN0ZWRSb3cuZGF0YTtcclxuICAgIGNvbXBSZWYuaW5zdGFuY2Uuc3VibWl0RW1pdHRlci5zdWJzY3JpYmUoKHJlOiBNZXNzYWdlTm90aWNlKSA9PiB7XHJcbiAgICAgIHRoaXMubWVzc2FnZU5vdGljZXMgPSB0aGlzLm1lc3NhZ2VOb3RpY2VzLm1hcChtID0+IHtcclxuICAgICAgICBpZiAobS5pZCA9PT0gcmUuaWQpIHtcclxuICAgICAgICAgIHJldHVybiByZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG07XHJcbiAgICAgIH0pO1xyXG4gICAgICB0aGlzLmdyaWQudW5TZWxlY3RSb3codGhpcy5ncmlkLnNlbGVjdGVkUm93LmRhdGEuaWQsIHRydWUpO1xyXG4gICAgICBkaWFsb2cuY2xvc2UoKTtcclxuICAgIH0pO1xyXG4gICAgY29tcFJlZi5pbnN0YW5jZS5jbG9zZUVtaXR0ZXIuc3Vic2NyaWJlKHJlID0+IHtcclxuICAgICAgZGlhbG9nLmNsb3NlKCk7XHJcbiAgICB9KTtcclxuICAgIGNvbnN0IG1vZGFsQ29uZmlnID0ge1xyXG4gICAgICB0aXRsZTogdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybSgnY29tcG9uZW50Lk1lc3NhZ2VOb3RpY2UubWVzc2FnZVNldCcpLFxyXG4gICAgICB3aWR0aDogNzYwLFxyXG4gICAgICBoZWlnaHQ6IDQ4MCxcclxuICAgICAgc2hvd0J1dHRvbnM6IHRydWUsXHJcbiAgICAgIGJ1dHRvbnM6IGNvbXBSZWYuaW5zdGFuY2UuZm9vdGVyXHJcbiAgICB9O1xyXG4gICAgZGlhbG9nID0gdGhpcy5tb2RhbFNlcnZpY2Uuc2hvdyhjb21wUmVmLCBtb2RhbENvbmZpZyk7XHJcbiAgfVxyXG4gIGJhdGNoQ29weSgpIHtcclxuICAgIGlmICghdGhpcy5tZXNzYWdlTm90aWNlcykge1xyXG4gICAgICB0aGlzLm1lc3NhZ2UuaW5mbyh0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKCdjb21wb25lbnQuTWVzc2FnZU5vdGljZS5ub0NvcHknKSk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGxldCBkaWFsb2c6IGFueTtcclxuICAgIGNvbnN0IGNvbXBGYWN0b3J5ID0gdGhpcy5yZXNvbHZlci5yZXNvbHZlQ29tcG9uZW50RmFjdG9yeShNZXNzYWdlTm90aWNlQ29weUNvbXBvbmVudCk7XHJcbiAgICBjb25zdCBjb21wUmVmID0gY29tcEZhY3RvcnkuY3JlYXRlKHRoaXMuaW5qZWN0b3IpO1xyXG4gICAgY29tcFJlZi5pbnN0YW5jZS5tZXNzYWdlTm90aWNlcyA9IHRoaXMubWVzc2FnZU5vdGljZXM7XHJcbiAgICBjb21wUmVmLmluc3RhbmNlLnN1Ym1pdEVtaXR0ZXIuc3Vic2NyaWJlKChkYXRhOiBhbnkpID0+IHtcclxuICAgICAgdGhpcy52aWV3TW9kZWwuY29weShSZXNvdXJjZUtleXMuYmF0Y2hDb3B5UHJvcGVydHksIGRhdGEpO1xyXG4gICAgICBkaWFsb2cuY2xvc2UoKTtcclxuICAgIH0pO1xyXG4gICAgY29tcFJlZi5pbnN0YW5jZS5jbG9zZUVtaXR0ZXIuc3Vic2NyaWJlKHJlID0+IHtcclxuICAgICAgZGlhbG9nLmNsb3NlKCk7XHJcbiAgICB9KTtcclxuICAgIGNvbnN0IG1vZGFsQ29uZmlnID0ge1xyXG4gICAgICB0aXRsZTogdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybSgnY29tcG9uZW50Lk1lc3NhZ2VOb3RpY2UuYmF0Y2hDb3B5JyksXHJcbiAgICAgIHdpZHRoOiA4MDAsXHJcbiAgICAgIGhlaWdodDogNTE1LFxyXG4gICAgICBzaG93QnV0dG9uczogdHJ1ZSxcclxuICAgICAgYnV0dG9uczogY29tcFJlZi5pbnN0YW5jZS5tb2RhbEZvb3RlclxyXG4gICAgfTtcclxuICAgIGRpYWxvZyA9IHRoaXMubW9kYWxTZXJ2aWNlLnNob3coY29tcFJlZiwgbW9kYWxDb25maWcpO1xyXG4gIH1cclxuICBkZWxldGUoKSB7XHJcbiAgICBjb25zdCBzZWxlY3RlZCA9IHRoaXMuZ3JpZC5zZWxlY3RlZFJvdztcclxuICAgIGlmICghc2VsZWN0ZWQpIHtcclxuICAgICAgdGhpcy5tZXNzYWdlLmluZm8odGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybSgnY29tcG9uZW50Lk1lc3NhZ2VOb3RpY2Uuc2VsZWN0ZWRSb3cnKSk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIHRoaXMubWVzc2FnZU5vdGljZXMgPSB0aGlzLm1lc3NhZ2VOb3RpY2VzLmZpbHRlcihtID0+IG0uaWQgIT09IHNlbGVjdGVkLmlkKTtcclxuICB9XHJcbiAgY2xpY2tPSygpIHtcclxuICAgIGNvbnN0IG9iamVjdCA9IHsgdmFsdWU6IHRoaXMubWVzc2FnZU5vdGljZXMsIHBhcmFtZXRlcnM6IG51bGwgfTtcclxuICAgIHRoaXMuc3VibWl0TW9kYWwuZW1pdChvYmplY3QpO1xyXG4gIH1cclxuICBjbGlja0NhbmNlbCgpIHtcclxuICAgIHRoaXMuY2xvc2VNb2RhbC5lbWl0KCk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIEdldE9yZ2FuaXphdGlvblR5cGUoKSB7XHJcbiAgICBjb25zdCB1cmwgPSAnL2FwaS9ydW50aW1lL3N5cy92MS4wL2F1dGhmaWVsZHMvZ2xvYmFsYXV0aGZpZWxkcyc7XHJcbiAgICB0aGlzLmh0dHAuZ2V0KHVybClcclxuICAgICAgLnN1YnNjcmliZSgoZGF0YTogYW55KSA9PiB0aGlzLnVpc3RhdGUub3JnVHlwZUNvbGxlY3Rpb24gPSBkYXRhLm1hcChkID0+ICh7IHZhbHVlOiBkLmlkLCB0ZXh0OiBkLm5hbWUgfSkpKTtcclxuICB9XHJcblxyXG4gIHByb2Nlc3NTZW5kVGltZSA9IFtcclxuICAgIHsgdmFsdWU6ICdQUk9DRVNTSU5TVEFOQ0VfQ09NUExFVEVEJywgdGV4dDogdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybSgnY29tcG9uZW50Lk1lc3NhZ2VOb3RpY2UucHJvY0NvbXBsZXRlJykgfSxcclxuICAgIHsgdmFsdWU6ICdQUk9DRVNTSU5TVEFOQ0VfQUJPUlRFRCcsIHRleHQ6IHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oJ2NvbXBvbmVudC5NZXNzYWdlTm90aWNlLnByb2NBYm9ydGVkJykgfSxcclxuICAgIHsgdmFsdWU6ICdQUk9DRVNTSU5TVEFOQ0VfUk9MTEJBQ0snLCB0ZXh0OiB0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKCdjb21wb25lbnQuTWVzc2FnZU5vdGljZS5wcm9jUm9sbEJhY2snKSB9XHJcbiAgXTtcclxuXHJcbiAgYWN0aXZpdHlTZW5kVGltZSA9IFtcclxuICAgIHsgdmFsdWU6ICdXT1JLSVRFTV9DUkVBVEVEJywgdGV4dDogdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybSgnY29tcG9uZW50Lk1lc3NhZ2VOb3RpY2Uud29ya0NyZWF0ZWQnKSB9LFxyXG4gICAgeyB2YWx1ZTogJ0FDVElWSVRZX0NPTVBMRVRFRCcsIHRleHQ6IHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oJ2NvbXBvbmVudC5NZXNzYWdlTm90aWNlLmFjdENvbXBsZXRlJykgfSxcclxuICAgIHsgdmFsdWU6ICdBQ1RJVklUWV9BQk9SVEVEJywgdGV4dDogdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybSgnY29tcG9uZW50Lk1lc3NhZ2VOb3RpY2UuYWN0QWJvcnRlZCcpIH0sXHJcbiAgXTtcclxufVxyXG5cclxuZXhwb3J0IGVudW0gUmVzb3VyY2VLZXlzIHtcclxuICBiYXRjaENvcHlQcm9wZXJ0eSA9ICdiYXRjaENvcHlQcm9wZXJ0eSdcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIE1lc3NhZ2VOb3RpY2VDb252ZXJ0ZXIgaW1wbGVtZW50cyBUeXBlQ29udmVydGVyIHtcclxuICBjb25zdHJ1Y3RvcihcclxuICAgIHByaXZhdGUgbG9jYWxlUGlwZTogV2ZMb2NhbGVQaXBlXHJcbiAgKSB7IH1cclxuXHJcbiAgY29udmVydFRvKGRhdGE6IGFueVtdKTogc3RyaW5nIHtcclxuICAgIGlmIChkYXRhICYmIGRhdGEubGVuZ3RoID4gMCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybShcImNvbXBvbmVudC5NZXNzYWdlTm90aWNlLnNldFwiKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJldHVybiB0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKFwiY29tcG9uZW50Lk1lc3NhZ2VOb3RpY2Uubm90U2V0XCIpO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG4iXX0=