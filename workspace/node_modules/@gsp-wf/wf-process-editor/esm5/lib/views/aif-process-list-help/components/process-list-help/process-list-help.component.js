/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { Component, ViewChild, TemplateRef, EventEmitter, Inject, LOCALE_ID, Output, Input } from '@angular/core';
import { ProcessListHelpService } from '../../services/process-list-help.service';
import { MessagerService } from '@farris/ui-messager';
import { NotifyService } from '@farris/ui-notify';
import { BsModalService } from '@farris/ui-modal';
import { FrameworkService } from '@gsp-sys/rtf-common';
import { Router, ActivatedRoute } from '@angular/router';
import { LoadingService } from '@farris/ui-loading';
import { of } from 'rxjs';
import { switchMap, catchError } from 'rxjs/operators';
import { BifMetadataType } from '../../entity/BifMetadataType';
import { ProcessFilterConditionArgs } from '../../entity/ProcessFilterConditionArgs';
import { TextValue } from '@edp-bif/common-api';
import { OrderByDirection } from '../../entity/OrderByDirection';
import { DatagridComponent } from '@farris/ui-datagrid';
import { AifLocalePipe, BIF_LANG_RESOURCES } from '../../../aif-ui-common/pipe/aif-ui-common-locale.pipe';
import { AIF_PROCESS_LIST_HELP_LANG_RESOURCES } from '../../i18n/lang.resource';
var ɵ0 = AIF_PROCESS_LIST_HELP_LANG_RESOURCES;
var ProcessListHelpComponent = /** @class */ (function () {
    function ProcessListHelpComponent(procHelpService, messager, notify, modalService, frameworkService, router, activatedRoute, loading, localeId, localePipe) {
        this.procHelpService = procHelpService;
        this.messager = messager;
        this.notify = notify;
        this.modalService = modalService;
        this.frameworkService = frameworkService;
        this.router = router;
        this.activatedRoute = activatedRoute;
        this.loading = loading;
        this.localePipe = localePipe;
        this.closeModal = new EventEmitter();
        this.submitModal = new EventEmitter();
        this.editorParams = {};
        this.modalConfig = {
            title: this.localePipe.transform("creationProcess"),
            width: 1250,
            height: 500,
            showButtons: true
        };
        this.procEmitter = new EventEmitter();
        this.ttIdField = "id";
        this.ttData = [];
        this.ttColumns = [];
        this.cascadeCheck = false;
        this.cascadeDown = false;
        this.cascadeUp = false;
        this.defaultPageSize = 30;
        this.pageList = [this.defaultPageSize, 50, 100, 200, 500];
        /**
         * 已设置流程
         */
        this.setProcess = {
            showText: ""
        };
        this.queryParam = this.createDefaultQueryParam();
    }
    Object.defineProperty(ProcessListHelpComponent.prototype, "value", {
        set: /**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            if (data) {
                this.processCode = data;
                this.setProcess.code = this.processCode;
                this.setProcess.showText = this.processCode;
            }
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    ProcessListHelpComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.configTtColumns();
        // if (this.editorParams && this.editorParams.bizTypeId) {
        //   this.queryParam.filterArgs.bizType = new TextValue();
        //   this.queryParam.filterArgs.bizType.value = this.editorParams.bizTypeId;
        //   this.queryParam.filterArgs.bizType.hasValue = true;
        // }
        if (this.processCode != null) {
            this.procHelpService.getProcessNameByCode(this.processCode).subscribe((/**
             * @param {?} processName
             * @return {?}
             */
            function (processName) {
                _this.setProcess.name = processName;
                if (_this.setProcess.name) {
                    _this.setProcess.showText = _this.setProcess.name + "(" + _this.setProcess.code + ")";
                }
                else {
                    _this.setProcess.showText = _this.setProcess.code;
                }
            }));
        }
        this.loadItems(this.queryParam.filterArgs).subscribe((/**
         * @return {?}
         */
        function () {
            setTimeout((/**
             * @return {?}
             */
            function () {
                if (_this.ttData && _this.ttData.length > 0) {
                    /** @type {?} */
                    var proc = _this.processCode != null ? _this.ttData.find((/**
                     * @param {?} it
                     * @return {?}
                     */
                    function (it) { return it.code == _this.processCode; })) : _this.ttData[0];
                    proc && _this.tt.selectRow(proc.id);
                }
            }), 300);
        }));
    };
    /**
     * @param {?=} evt
     * @return {?}
     */
    ProcessListHelpComponent.prototype.clickOk = /**
     * @param {?=} evt
     * @return {?}
     */
    function (evt) {
        if (this.tt.selectedRow == null) {
            this.notify.warning(this.localePipe.transform("pleaseSelectOneItemOnly"));
            return;
        }
        this.procEmitter.emit(this.tt.selectedRow.data);
        /** @type {?} */
        var object = { value: this.tt.selectedRow.data.code, parameters: null };
        this.submitModal.emit(object);
        this.modalRef && this.modalRef.close();
    };
    /**
     * @param {?=} evt
     * @return {?}
     */
    ProcessListHelpComponent.prototype.clickCancel = /**
     * @param {?=} evt
     * @return {?}
     */
    function (evt) {
        this.procEmitter.complete();
        this.closeModal.emit();
        this.modalRef && this.modalRef.close();
    };
    /**
     * @param {?} param
     * @return {?}
     */
    ProcessListHelpComponent.prototype.onSearch = /**
     * @param {?} param
     * @return {?}
     */
    function (param) {
        var _this = this;
        this.queryParam = param;
        console.log(this.queryParam);
        this.loadItems(this.queryParam.filterArgs).subscribe((/**
         * @return {?}
         */
        function () {
            _this.tt.clearCheckeds();
            _this.tt.clearSelections();
        }));
    };
    /**
     * @param {?} ctx
     * @return {?}
     */
    ProcessListHelpComponent.prototype.clickNameCell = /**
     * @param {?} ctx
     * @return {?}
     */
    function (ctx) {
        this.procHelpService.openBifManagerApp(ctx.rowData);
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    ProcessListHelpComponent.prototype.onPageSizeChanged = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        var _this = this;
        // console.log('PageSize Changed:', $event);
        /** @type {?} */
        var checkedIds = this.tt.checkeds.map((/**
         * @param {?} r
         * @return {?}
         */
        function (r) { return r.data.id; }));
        this.queryParam.filterArgs.pageSize = $event.pageSize;
        this.loadItems(this.queryParam.filterArgs).subscribe((/**
         * @return {?}
         */
        function () {
            setTimeout((/**
             * @return {?}
             */
            function () {
                _this.tt.checkRows(checkedIds, true);
                _this.tt.refresh();
            }), 0);
        }));
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    ProcessListHelpComponent.prototype.onPageChanged = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        var _this = this;
        // console.log('PageNumber Changed:', $event);
        /** @type {?} */
        var checkedIds = this.tt.checkeds.map((/**
         * @param {?} r
         * @return {?}
         */
        function (r) { return r.data.id; }));
        this.queryParam.filterArgs.pageIndex = $event.pageIndex - 1;
        this.queryParam.filterArgs.pageSize = $event.pageSize;
        this.loadItems(this.queryParam.filterArgs).subscribe((/**
         * @return {?}
         */
        function () {
            setTimeout((/**
             * @return {?}
             */
            function () {
                _this.tt.checkRows(checkedIds, true);
                _this.tt.refresh();
            }), 0);
        }));
    };
    /**
     * @param {?} pageInfo
     * @return {?}
     */
    ProcessListHelpComponent.prototype.pageChangeHandler = /**
     * @param {?} pageInfo
     * @return {?}
     */
    function (pageInfo) {
        var _this = this;
        /** @type {?} */
        var checkedIds = this.tt.checkeds.map((/**
         * @param {?} r
         * @return {?}
         */
        function (r) { return r.data.id; }));
        this.queryParam.filterArgs.pageIndex = pageInfo.pageIndex - 1;
        this.queryParam.filterArgs.pageSize = pageInfo.pageSize;
        this.loadItems(this.queryParam.filterArgs).subscribe((/**
         * @return {?}
         */
        function () {
            setTimeout((/**
             * @return {?}
             */
            function () {
                _this.tt.checkRows(checkedIds, true);
                _this.tt.refresh();
            }), 0);
        }));
    };
    /**
     * @param {?} size
     * @return {?}
     */
    ProcessListHelpComponent.prototype.pageSizeChangeHandler = /**
     * @param {?} size
     * @return {?}
     */
    function (size) {
        var _this = this;
        /** @type {?} */
        var checkedIds = this.tt.checkeds.map((/**
         * @param {?} r
         * @return {?}
         */
        function (r) { return r.data.id; }));
        this.queryParam.filterArgs.pageSize = size;
        this.loadItems(this.queryParam.filterArgs).subscribe((/**
         * @return {?}
         */
        function () {
            setTimeout((/**
             * @return {?}
             */
            function () {
                _this.tt.checkRows(checkedIds, true);
                _this.tt.refresh();
            }), 0);
        }));
    };
    /**
     * @return {?}
     */
    ProcessListHelpComponent.prototype.removeSetProcess = /**
     * @return {?}
     */
    function () {
    };
    /**
     * @private
     * @param {?} args
     * @return {?}
     */
    ProcessListHelpComponent.prototype.loadItems = /**
     * @private
     * @param {?} args
     * @return {?}
     */
    function (args) {
        var _this = this;
        /** @type {?} */
        var loadingComp = this.loading.show({ message: this.localePipe.transform("loading") });
        return this.procHelpService.getDatagridData(args).pipe(switchMap((/**
         * @param {?} listRes
         * @return {?}
         */
        function (listRes) {
            _this.ttData = tslib_1.__spread(listRes.entities);
            //更新分页信息
            _this.tt.setPageIndex(listRes.pageIndex + 1);
            _this.tt.total = listRes.totalCount;
            _this.tt.pageSize = listRes.pageSize;
            // this.page.setCurrentPage(this.paginationId, listRes.pageIndex + 1);
            // this.page.setItemsPerPage(this.paginationId, listRes.pageSize);
            // this.page.setTotalItems(this.paginationId, listRes.totalCount);
            loadingComp.close();
            return of(listRes);
        })), catchError((/**
         * @param {?} err
         * @return {?}
         */
        function (err) {
            loadingComp.close();
            setTimeout((/**
             * @return {?}
             */
            function () {
                //todo 确定异常结构, 目前采用兼容取值方式
                _this.messager.error(err.error == null ? err.message : (err.error.Message || err.error.message || err.message));
            }), 300);
            throw err;
        })));
    };
    /**
     * @private
     * @return {?}
     */
    ProcessListHelpComponent.prototype.configTtColumns = /**
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        this.ttColumns = [
            // {
            //   field: "isEnabled", title: this.localePipe.transform("enabledState"), width: 100, sortable: false,
            //   formatter: (value: boolean, rowData, rowIndex) => {
            //     if (value == true) {
            //       return this.localePipe.transform("enabled");
            //     } else if (value == false) {
            //       return this.localePipe.transform("disabled");
            //     } else {
            //       return "-";
            //     }
            //   }
            // },
            { field: "code", title: this.localePipe.transform("code"), width: 120, sortable: true },
            {
                field: "name", title: this.localePipe.transform("name"), width: 250, sortable: true,
                template: this.nameCellTemp,
            },
            { field: "upBillVoName", title: this.localePipe.transform("upBill"), width: 120, sortable: true },
            { field: "downBillVoName", title: this.localePipe.transform("downBill"), width: 120, sortable: true },
            // {
            //   field: "bifMetadataType", title: this.localePipe.transform("processType"), width: 120, sortable: false,
            //   formatter: (value: BifMetadataType, rowData, rowIndex) => {
            //     if (value == BifMetadataType.BifCreationProcess) {
            //       return this.localePipe.transform("creation");
            //     } else if (value == BifMetadataType.BifWritebackProcess) {
            //       return this.localePipe.transform("writeback");
            //     } else {
            //       return "-";
            //     }
            //   }
            // },
            {
                field: "sysInit", title: this.localePipe.transform("sysInit"), width: 80, sortable: false,
                formatter: (/**
                 * @param {?} value
                 * @param {?} rowData
                 * @param {?} rowIndex
                 * @return {?}
                 */
                function (value, rowData, rowIndex) {
                    if (value == true) {
                        return _this.localePipe.transform("yes");
                    }
                    else if (value == false) {
                        return _this.localePipe.transform("no");
                    }
                    else {
                        return "-";
                    }
                })
            },
        ];
    };
    /**
     * @private
     * @return {?}
     */
    ProcessListHelpComponent.prototype.createDefaultQueryParam = /**
     * @private
     * @return {?}
     */
    function () {
        /** @type {?} */
        var queryParam = {
            filterArgs: new ProcessFilterConditionArgs(),
            filterArgsExt: {}
        };
        queryParam.filterArgs.pageSize = this.defaultPageSize;
        queryParam.filterArgs.pageIndex = 0;
        queryParam.filterArgs.OrderByLastModifiedTime = new TextValue();
        queryParam.filterArgs.OrderByLastModifiedTime.value = OrderByDirection.Desc;
        queryParam.filterArgs.OrderByLastModifiedTime.hasValue = true;
        queryParam.filterArgs.billProcessType = new TextValue();
        queryParam.filterArgs.billProcessType.value = BifMetadataType.BifCreationProcess;
        queryParam.filterArgs.billProcessType.hasValue = true;
        queryParam.filterArgs.isEnabled = new TextValue();
        queryParam.filterArgs.isEnabled.value = "true";
        queryParam.filterArgs.isEnabled.hasValue = true;
        return queryParam;
    };
    ProcessListHelpComponent.decorators = [
        { type: Component, args: [{
                    selector: 'app-process-list-help',
                    template: "<div class=\"f-page f-page-is-managelist\" id=\"bif-manager-list\">\r\n  <app-proc-help-query-solution id=\"query-solution\" #querySolution [(queryParam)]=\"queryParam\"\r\n    (onSearch)=\"onSearch($event)\">\r\n  </app-proc-help-query-solution>\r\n\r\n  <div class=\"f-page-main\" id=\"page-main\">\r\n    <div *ngIf=\"setProcess&&setProcess.code\" class=\"d-flex px-2\" style=\"line-height: 32px; height: 32px;\">\r\n      <div>\r\n        {{\"setProcess\" | aifLocale}}\r\n      </div>\r\n      <div class=\"farris-tags\">\r\n        <ul class=\"farris-tags-item-container\">\r\n          <li class=\"farris-tag-item farris-tag-item-info\">\r\n            <span class=\"tag-box\">\r\n              {{setProcess&&setProcess.showText}}\r\n            </span>\r\n            <span *ngIf=\"false\" class=\"tag-delete\" (click)=\"removeSetProcess()\">\r\n              <i class=\"f-icon f-icon-close\"></i>\r\n            </span>\r\n          </li>\r\n        </ul>\r\n      </div>\r\n    </div>\r\n    <div class=\"f-utils-fill-flex-column\">\r\n      <farris-datagrid id=\"tt\" #tt [data]=\"ttData\" [columns]=\"ttColumns\" [idField]=\"ttIdField\" [multiSelect]=\"true\"\r\n        [showCheckbox]=\"false\" [showAllCheckbox]=\"false\" [onlySelectSelf]=\"true\" [keepSelect]=\"true\"\r\n        [selectOnCheck]=\"true\" [checkOnSelect]=\"false\" [showHeader]=\"true\" [fit]=\"true\" [fitColumns]=\"true\"\r\n        [pagination]=\"true\" [showPageList]=\"true\" [pageSize]=\"defaultPageSize\" [pageList]=\"pageList\"\r\n        (pageChanged)=\"onPageChanged($event)\" (pageSizeChanged)=\"onPageSizeChanged($event)\" [remoteSort]=\"false\">\r\n      </farris-datagrid>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #nameCellTemp let-ctx>\r\n  <a href=\"javascript: void(0);\" (click)=\"clickNameCell(ctx)\">{{ctx?.rowData?.name}}</a>\r\n</ng-template>\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type=\"button\" class=\"btn btn-secondary btn-sm px-3 mx-2\" (click)=\"clickCancel()\">\r\n    {{'clickCancel' | aifLocale}}\r\n  </button>\r\n  <button type=\"button\" class=\"btn btn-primary btn-sm px-3 mx-2\" (click)=\"clickOk()\">\r\n    {{'clickOk' | aifLocale}}\r\n  </button>\r\n</ng-template>\r\n",
                    providers: [
                        { provide: BIF_LANG_RESOURCES, useValue: ɵ0 },
                        AifLocalePipe,
                    ],
                    styles: [""]
                }] }
    ];
    /** @nocollapse */
    ProcessListHelpComponent.ctorParameters = function () { return [
        { type: ProcessListHelpService },
        { type: MessagerService },
        { type: NotifyService },
        { type: BsModalService },
        { type: FrameworkService },
        { type: Router },
        { type: ActivatedRoute },
        { type: LoadingService },
        { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
        { type: AifLocalePipe }
    ]; };
    ProcessListHelpComponent.propDecorators = {
        closeModal: [{ type: Output }],
        submitModal: [{ type: Output }],
        value: [{ type: Input }],
        editorParams: [{ type: Input }],
        tt: [{ type: ViewChild, args: ["tt",] }],
        nameCellTemp: [{ type: ViewChild, args: ['nameCellTemp',] }],
        modalFooter: [{ type: ViewChild, args: ['iconSelectFooter',] }]
    };
    return ProcessListHelpComponent;
}());
export { ProcessListHelpComponent };
if (false) {
    /** @type {?} */
    ProcessListHelpComponent.prototype.closeModal;
    /** @type {?} */
    ProcessListHelpComponent.prototype.submitModal;
    /** @type {?} */
    ProcessListHelpComponent.prototype.editorParams;
    /**
     * @type {?}
     * @private
     */
    ProcessListHelpComponent.prototype.processCode;
    /** @type {?} */
    ProcessListHelpComponent.prototype.modalConfig;
    /** @type {?} */
    ProcessListHelpComponent.prototype.procEmitter;
    /** @type {?} */
    ProcessListHelpComponent.prototype.queryParam;
    /** @type {?} */
    ProcessListHelpComponent.prototype.tt;
    /** @type {?} */
    ProcessListHelpComponent.prototype.ttIdField;
    /** @type {?} */
    ProcessListHelpComponent.prototype.ttData;
    /** @type {?} */
    ProcessListHelpComponent.prototype.ttColumns;
    /** @type {?} */
    ProcessListHelpComponent.prototype.cascadeCheck;
    /** @type {?} */
    ProcessListHelpComponent.prototype.cascadeDown;
    /** @type {?} */
    ProcessListHelpComponent.prototype.cascadeUp;
    /** @type {?} */
    ProcessListHelpComponent.prototype.nameCellTemp;
    /** @type {?} */
    ProcessListHelpComponent.prototype.modalFooter;
    /** @type {?} */
    ProcessListHelpComponent.prototype.modalRef;
    /** @type {?} */
    ProcessListHelpComponent.prototype.defaultPageSize;
    /** @type {?} */
    ProcessListHelpComponent.prototype.pageList;
    /**
     * 已设置流程
     * @type {?}
     */
    ProcessListHelpComponent.prototype.setProcess;
    /**
     * @type {?}
     * @private
     */
    ProcessListHelpComponent.prototype.procHelpService;
    /**
     * @type {?}
     * @private
     */
    ProcessListHelpComponent.prototype.messager;
    /**
     * @type {?}
     * @private
     */
    ProcessListHelpComponent.prototype.notify;
    /**
     * @type {?}
     * @private
     */
    ProcessListHelpComponent.prototype.modalService;
    /**
     * @type {?}
     * @private
     */
    ProcessListHelpComponent.prototype.frameworkService;
    /**
     * @type {?}
     * @private
     */
    ProcessListHelpComponent.prototype.router;
    /**
     * @type {?}
     * @private
     */
    ProcessListHelpComponent.prototype.activatedRoute;
    /**
     * @type {?}
     * @private
     */
    ProcessListHelpComponent.prototype.loading;
    /**
     * @type {?}
     * @private
     */
    ProcessListHelpComponent.prototype.localePipe;
}
export { ɵ0 };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicHJvY2Vzcy1saXN0LWhlbHAuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGdzcC13Zi93Zi1wcm9jZXNzLWVkaXRvci8iLCJzb3VyY2VzIjpbImxpYi92aWV3cy9haWYtcHJvY2Vzcy1saXN0LWhlbHAvY29tcG9uZW50cy9wcm9jZXNzLWxpc3QtaGVscC9wcm9jZXNzLWxpc3QtaGVscC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFVLFNBQVMsRUFBRSxXQUFXLEVBQUUsWUFBWSxFQUFFLE1BQU0sRUFBRSxTQUFTLEVBQUUsTUFBTSxFQUFFLEtBQUssRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUUxSCxPQUFPLEVBQUUsc0JBQXNCLEVBQUUsTUFBTSwwQ0FBMEMsQ0FBQztBQUNsRixPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFDdEQsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLG1CQUFtQixDQUFDO0FBQ2xELE9BQU8sRUFBRSxjQUFjLEVBQWMsTUFBTSxrQkFBa0IsQ0FBQztBQUM5RCxPQUFPLEVBQUUsZ0JBQWdCLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUN2RCxPQUFPLEVBQUUsTUFBTSxFQUFFLGNBQWMsRUFBRSxNQUFNLGlCQUFpQixDQUFDO0FBQ3pELE9BQU8sRUFBRSxjQUFjLEVBQUUsTUFBTSxvQkFBb0IsQ0FBQztBQUNwRCxPQUFPLEVBQWMsRUFBRSxFQUFFLE1BQU0sTUFBTSxDQUFDO0FBQ3RDLE9BQU8sRUFBRSxTQUFTLEVBQUUsVUFBVSxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFFdkQsT0FBTyxFQUFFLGVBQWUsRUFBRSxNQUFNLDhCQUE4QixDQUFDO0FBQy9ELE9BQU8sRUFBRSwwQkFBMEIsRUFBRSxNQUFNLHlDQUF5QyxDQUFDO0FBQ3JGLE9BQU8sRUFBRSxTQUFTLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUNoRCxPQUFPLEVBQUUs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LHNCQUFzQjtnQkFDdEIsZUFBZTtnQkFDZixhQUFhO2dCQUNiLGNBQWM7Z0JBQ2QsZ0JBQWdCO2dCQUNoQixNQUFNO2dCQUFFLGNBQWM7Z0JBQ3RCLGNBQWM7NkNBeUZsQixNQUFNLFNBQUMsU0FBUztnQkEvRVosYUFBYTs7OzZCQWFuQixNQUFNOzhCQUNOLE1BQU07d0JBRU4sS0FBSzsrQkFTTCxLQUFLO3FCQWVMLFNBQVMsU0FBQyxJQUFJOytCQVFkLFNBQVMsU0FBQyxjQUFjOzhCQUd4QixTQUFTLFNBQUMsa0JBQWtCOztJQTBSL0IsK0JBQUM7Q0FBQSxBQTFVRCxJQTBVQztTQWpVWSx3QkFBd0I7OztJQUNuQyw4Q0FBK0M7O0lBQy9DLCtDQUFnRDs7SUFXaEQsZ0RBRU87Ozs7O0lBRVAsK0NBQTRCOztJQUM1QiwrQ0FLRTs7SUFFRiwrQ0FBc0M7O0lBQ3RDLDhDQUE4Qjs7SUFFOUIsc0NBQ3NCOztJQUN0Qiw2Q0FBeUI7O0lBQ3pCLDBDQUFtQjs7SUFDbkIsNkNBQXNCOztJQUN0QixnREFBcUI7O0lBQ3JCLCtDQUFvQjs7SUFDcEIsNkNBQWtCOztJQUNsQixnREFDK0I7O0lBRS9CLCtDQUM4Qjs7SUFFOUIsNENBQXFCOztJQUVyQixtREFBc0M7O0lBQ3RDLDRDQUFxRDs7Ozs7SUFLckQsOENBTUk7Ozs7O0lBR0YsbURBQStDOzs7OztJQUMvQyw0Q0FBaUM7Ozs7O0lBQ2pDLDBDQUE2Qjs7Ozs7SUFDN0IsZ0RBQW9DOzs7OztJQUNwQyxvREFBMEM7Ozs7O0lBQzFDLDBDQUFzQjs7Ozs7SUFDdEIsa0RBQXNDOzs7OztJQUN0QywyQ0FBK0I7Ozs7O0lBRS9CLDhDQUFpQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCwgT25Jbml0LCBWaWV3Q2hpbGQsIFRlbXBsYXRlUmVmLCBFdmVudEVtaXR0ZXIsIEluamVjdCwgTE9DQUxFX0lELCBPdXRwdXQsIElucHV0IH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IEZhcnJpc1NlY3Rpb25Db21wb25lbnQgfSBmcm9tICdAZmFycmlzL3VpLXNlY3Rpb24nO1xyXG5pbXBvcnQgeyBQcm9jZXNzTGlzdEhlbHBTZXJ2aWNlIH0gZnJvbSAnLi4vLi4vc2VydmljZXMvcHJvY2Vzcy1saXN0LWhlbHAuc2VydmljZSc7XHJcbmltcG9ydCB7IE1lc3NhZ2VyU2VydmljZSB9IGZyb20gJ0BmYXJyaXMvdWktbWVzc2FnZXInO1xyXG5pbXBvcnQgeyBOb3RpZnlTZXJ2aWNlIH0gZnJvbSAnQGZhcnJpcy91aS1ub3RpZnknO1xyXG5pbXBvcnQgeyBCc01vZGFsU2VydmljZSwgQnNNb2RhbFJlZiB9IGZyb20gJ0BmYXJyaXMvdWktbW9kYWwnO1xyXG5pbXBvcnQgeyBGcmFtZXdvcmtTZXJ2aWNlIH0gZnJvbSAnQGdzcC1zeXMvcnRmLWNvbW1vbic7XHJcbmltcG9ydCB7IFJvdXRlciwgQWN0aXZhdGVkUm91dGUgfSBmcm9tICdAYW5ndWxhci9yb3V0ZXInO1xyXG5pbXBvcnQgeyBMb2FkaW5nU2VydmljZSB9IGZyb20gJ0BmYXJyaXMvdWktbG9hZGluZyc7XHJcbmltcG9ydCB7IE9ic2VydmFibGUsIG9mIH0gZnJvbSAncnhqcyc7XHJcbmltcG9ydCB7IHN3aXRjaE1hcCwgY2F0Y2hFcnJvciB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcclxuaW1wb3J0IHsgSVJ0UHJvY1F1ZXJ5UGFyYW0gfSBmcm9tICcuLi8uLi9lbnRpdHkvSVByb2NRdWVyeVBhcmFtJztcclxuaW1wb3J0IHsgQmlmTWV0YWRhdGFUeXBlIH0gZnJvbSAnLi4vLi4vZW50aXR5L0JpZk1ldGFkYXRhVHlwZSc7XHJcbmltcG9ydCB7IFByb2Nlc3NGaWx0ZXJDb25kaXRpb25BcmdzIH0gZnJvbSAnLi4vLi4vZW50aXR5L1Byb2Nlc3NGaWx0ZXJDb25kaXRpb25BcmdzJztcclxuaW1wb3J0IHsgVGV4dFZhbHVlIH0gZnJvbSAnQGVkcC1iaWYvY29tbW9uLWFwaSc7XHJcbmltcG9ydCB7IE9yZGVyQnlEaXJlY3Rpb24gfSBmcm9tICcuLi8uLi9lbnRpdHkvT3JkZXJCeURpcmVjdGlvbic7XHJcbmltcG9ydCB7IERhdGFncmlkQ29tcG9uZW50IH0gZnJvbSAnQGZhcnJpcy91aS1kYXRhZ3JpZCc7XHJcbmltcG9ydCB7IFJ0QmlsbFByb2Nlc3NMaXN0UmVzdWx0IH0gZnJvbSAnLi4vLi4vZW50aXR5L1J0QmlsbFByb2Nlc3NMaXN0UmVzdWx0JztcclxuaW1wb3J0IHsgQWlmTG9jYWxlUGlwZSwgQklGX0xBTkdfUkVTT1VSQ0VTIH0gZnJvbSAnLi4vLi4vLi4vYWlmLXVpLWNvbW1vbi9waXBlL2FpZi11aS1jb21tb24tbG9jYWxlLnBpcGUnO1xyXG5pbXBvcnQgeyBBSUZfUFJPQ0VTU19MSVNUX0hFTFBfTEFOR19SRVNPVVJDRVMgfSBmcm9tICcuLi8uLi9pMThuL2xhbmcucmVzb3VyY2UnO1xyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgc2VsZWN0b3I6ICdhcHAtcHJvY2Vzcy1saXN0LWhlbHAnLFxyXG4gIHRlbXBsYXRlVXJsOiAnLi9wcm9jZXNzLWxpc3QtaGVscC5jb21wb25lbnQuaHRtbCcsXHJcbiAgc3R5bGVVcmxzOiBbJy4vcHJvY2Vzcy1saXN0LWhlbHAuY29tcG9uZW50LmNzcyddLFxyXG4gIHByb3ZpZGVyczogW1xyXG4gICAgeyBwcm92aWRlOiBCSUZfTEFOR19SRVNPVVJDRVMsIHVzZVZhbHVlOiBBSUZfUFJPQ0VTU19MSVNUX0hFTFBfTEFOR19SRVNPVVJDRVMgfSxcclxuICAgIEFpZkxvY2FsZVBpcGUsXHJcbiAgXVxyXG59KVxyXG5leHBvcnQgY2xhc3MgUHJvY2Vzc0xpc3RIZWxwQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0IHtcclxuICBAT3V0cHV0KCkgY2xvc2VNb2RhbCA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xyXG4gIEBPdXRwdXQoKSBzdWJtaXRNb2RhbCA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xyXG5cclxuICBASW5wdXQoKVxyXG4gIHNldCB2YWx1ZShkYXRhOiBhbnkpIHtcclxuICAgIGlmIChkYXRhKSB7XHJcbiAgICAgIHRoaXMucHJvY2Vzc0NvZGUgPSBkYXRhO1xyXG4gICAgICB0aGlzLnNldFByb2Nlc3MuY29kZSA9IHRoaXMucHJvY2Vzc0NvZGU7XHJcbiAgICAgIHRoaXMuc2V0UHJvY2Vzcy5zaG93VGV4dCA9IHRoaXMucHJvY2Vzc0NvZGU7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBASW5wdXQoKSBlZGl0b3JQYXJhbXM6IHtcclxuICAgIGJpelR5cGVJZD86IHN0cmluZ1xyXG4gIH0gPSB7fTtcclxuXHJcbiAgcHJpdmF0ZSBwcm9jZXNzQ29kZTogc3RyaW5nO1xyXG4gIG1vZGFsQ29uZmlnID0ge1xyXG4gICAgdGl0bGU6IHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oXCJjcmVhdGlvblByb2Nlc3NcIiksXHJcbiAgICB3aWR0aDogMTI1MCxcclxuICAgIGhlaWdodDogNTAwLFxyXG4gICAgc2hvd0J1dHRvbnM6IHRydWVcclxuICB9O1xyXG5cclxuICBwcm9jRW1pdHRlciA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xyXG4gIHF1ZXJ5UGFyYW06IElSdFByb2NRdWVyeVBhcmFtO1xyXG5cclxuICBAVmlld0NoaWxkKFwidHRcIilcclxuICB0dDogRGF0YWdyaWRDb21wb25lbnQ7XHJcbiAgdHRJZEZpZWxkOiBzdHJpbmcgPSBcImlkXCI7XHJcbiAgdHREYXRhOiBhbnlbXSA9IFtdO1xyXG4gIHR0Q29sdW1uczogYW55W10gPSBbXTtcclxuICBjYXNjYWRlQ2hlY2sgPSBmYWxzZTtcclxuICBjYXNjYWRlRG93biA9IGZhbHNlO1xyXG4gIGNhc2NhZGVVcCA9IGZhbHNlO1xyXG4gIEBWaWV3Q2hpbGQoJ25hbWVDZWxsVGVtcCcpXHJcbiAgbmFtZUNlbGxUZW1wOiBUZW1wbGF0ZVJlZjxhbnk+O1xyXG5cclxuICBAVmlld0NoaWxkKCdpY29uU2VsZWN0Rm9vdGVyJylcclxuICBtb2RhbEZvb3RlcjogVGVtcGxhdGVSZWY8YW55PjtcclxuXHJcbiAgbW9kYWxSZWY6IEJzTW9kYWxSZWY7XHJcblxyXG4gIHJlYWRvbmx5IGRlZmF1bHRQYWdlU2l6ZTogbnVtYmVyID0gMzA7XHJcbiAgcGFnZUxpc3QgPSBbdGhpcy5kZWZhdWx0UGFnZVNpemUsIDUwLCAxMDAsIDIwMCwgNTAwXTtcclxuXHJcbiAgLyoqXHJcbiAgICog5bey6K6+572u5rWB56iLXHJcbiAgICovXHJcbiAgc2V0UHJvY2Vzczoge1xyXG4gICAgY29kZT86IHN0cmluZztcclxuICAgIG5hbWU/OiBzdHJpbmc7XHJcbiAgICBzaG93VGV4dD86IHN0cmluZztcclxuICB9ID0ge1xyXG4gICAgICBzaG93VGV4dDogXCJcIlxyXG4gICAgfTtcclxuXHJcbiAgY29uc3RydWN0b3IoXHJcbiAgICBwcml2YXRlIHByb2NIZWxwU2VydmljZTogUHJvY2Vzc0xpc3RIZWxwU2VydmljZSxcclxuICAgIHByaXZhdGUgbWVzc2FnZXI6IE1lc3NhZ2VyU2VydmljZSxcclxuICAgIHByaXZhdGUgbm90aWZ5OiBOb3RpZnlTZXJ2aWNlLFxyXG4gICAgcHJpdmF0ZSBtb2RhbFNlcnZpY2U6IEJzTW9kYWxTZXJ2aWNlLFxyXG4gICAgcHJpdmF0ZSBmcmFtZXdvcmtTZXJ2aWNlOiBGcmFtZXdvcmtTZXJ2aWNlLFxyXG4gICAgcHJpdmF0ZSByb3V0ZXI6IFJvdXRlcixcclxuICAgIHByaXZhdGUgYWN0aXZhdGVkUm91dGU6IEFjdGl2YXRlZFJvdXRlLFxyXG4gICAgcHJpdmF0ZSBsb2FkaW5nOiBMb2FkaW5nU2VydmljZSxcclxuICAgIEBJbmplY3QoTE9DQUxFX0lEKSBsb2NhbGVJZDogc3RyaW5nLFxyXG4gICAgcHJpdmF0ZSBsb2NhbGVQaXBlOiBBaWZMb2NhbGVQaXBlLFxyXG4gICkge1xyXG4gICAgdGhpcy5xdWVyeVBhcmFtID0gdGhpcy5jcmVhdGVEZWZhdWx0UXVlcnlQYXJhbSgpO1xyXG4gIH1cclxuXHJcbiAgbmdPbkluaXQoKSB7XHJcbiAgICB0aGlzLmNvbmZpZ1R0Q29sdW1ucygpO1xyXG4gICAgLy8gaWYgKHRoaXMuZWRpdG9yUGFyYW1zICYmIHRoaXMuZWRpdG9yUGFyYW1zLmJpelR5cGVJZCkge1xyXG4gICAgLy8gICB0aGlzLnF1ZXJ5UGFyYW0uZmlsdGVyQXJncy5iaXpUeXBlID0gbmV3IFRleHRWYWx1ZSgpO1xyXG4gICAgLy8gICB0aGlzLnF1ZXJ5UGFyYW0uZmlsdGVyQXJncy5iaXpUeXBlLnZhbHVlID0gdGhpcy5lZGl0b3JQYXJhbXMuYml6VHlwZUlkO1xyXG4gICAgLy8gICB0aGlzLnF1ZXJ5UGFyYW0uZmlsdGVyQXJncy5iaXpUeXBlLmhhc1ZhbHVlID0gdHJ1ZTtcclxuICAgIC8vIH1cclxuICAgIGlmICh0aGlzLnByb2Nlc3NDb2RlICE9IG51bGwpIHtcclxuICAgICAgdGhpcy5wcm9jSGVscFNlcnZpY2UuZ2V0UHJvY2Vzc05hbWVCeUNvZGUodGhpcy5wcm9jZXNzQ29kZSkuc3Vic2NyaWJlKFxyXG4gICAgICAgIChwcm9jZXNzTmFtZSkgPT4ge1xyXG4gICAgICAgICAgdGhpcy5zZXRQcm9jZXNzLm5hbWUgPSBwcm9jZXNzTmFtZTtcclxuICAgICAgICAgIGlmICh0aGlzLnNldFByb2Nlc3MubmFtZSkge1xyXG4gICAgICAgICAgICB0aGlzLnNldFByb2Nlc3Muc2hvd1RleHQgPSBgJHt0aGlzLnNldFByb2Nlc3MubmFtZX0oJHt0aGlzLnNldFByb2Nlc3MuY29kZX0pYDtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0UHJvY2Vzcy5zaG93VGV4dCA9IHRoaXMuc2V0UHJvY2Vzcy5jb2RlO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgKTtcclxuICAgIH1cclxuICAgIHRoaXMubG9hZEl0ZW1zKHRoaXMucXVlcnlQYXJhbS5maWx0ZXJBcmdzKS5zdWJzY3JpYmUoKCkgPT4ge1xyXG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICBpZiAodGhpcy50dERhdGEgJiYgdGhpcy50dERhdGEubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgY29uc3QgcHJvYyA9IHRoaXMucHJvY2Vzc0NvZGUgIT0gbnVsbCA/IHRoaXMudHREYXRhLmZpbmQoKGl0KSA9PiBpdC5jb2RlID09IHRoaXMucHJvY2Vzc0NvZGUpIDogdGhpcy50dERhdGFbMF07XHJcbiAgICAgICAgICBwcm9jICYmIHRoaXMudHQuc2VsZWN0Um93KHByb2MuaWQpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSwgMzAwKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgY2xpY2tPayhldnQ/KSB7XHJcbiAgICBpZiAodGhpcy50dC5zZWxlY3RlZFJvdyA9PSBudWxsKSB7XHJcbiAgICAgIHRoaXMubm90aWZ5Lndhcm5pbmcodGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybShcInBsZWFzZVNlbGVjdE9uZUl0ZW1Pbmx5XCIpKTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgdGhpcy5wcm9jRW1pdHRlci5lbWl0KHRoaXMudHQuc2VsZWN0ZWRSb3cuZGF0YSk7XHJcbiAgICBjb25zdCBvYmplY3QgPSB7IHZhbHVlOiB0aGlzLnR0LnNlbGVjdGVkUm93LmRhdGEuY29kZSwgcGFyYW1ldGVyczogbnVsbCB9O1xyXG4gICAgdGhpcy5zdWJtaXRNb2RhbC5lbWl0KG9iamVjdCk7XHJcbiAgICB0aGlzLm1vZGFsUmVmICYmIHRoaXMubW9kYWxSZWYuY2xvc2UoKTtcclxuICB9XHJcblxyXG4gIGNsaWNrQ2FuY2VsKGV2dD8pIHtcclxuICAgIHRoaXMucHJvY0VtaXR0ZXIuY29tcGxldGUoKTtcclxuICAgIHRoaXMuY2xvc2VNb2RhbC5lbWl0KCk7XHJcbiAgICB0aGlzLm1vZGFsUmVmICYmIHRoaXMubW9kYWxSZWYuY2xvc2UoKTtcclxuICB9XHJcblxyXG4gIG9uU2VhcmNoKHBhcmFtOiBhbnkpIHtcclxuICAgIHRoaXMucXVlcnlQYXJhbSA9IHBhcmFtO1xyXG4gICAgY29uc29sZS5sb2codGhpcy5xdWVyeVBhcmFtKTtcclxuICAgIHRoaXMubG9hZEl0ZW1zKHRoaXMucXVlcnlQYXJhbS5maWx0ZXJBcmdzKS5zdWJzY3JpYmUoXHJcbiAgICAgICgpID0+IHtcclxuICAgICAgICB0aGlzLnR0LmNsZWFyQ2hlY2tlZHMoKTtcclxuICAgICAgICB0aGlzLnR0LmNsZWFyU2VsZWN0aW9ucygpO1xyXG4gICAgICB9XHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgY2xpY2tOYW1lQ2VsbChjdHgpIHtcclxuICAgIHRoaXMucHJvY0hlbHBTZXJ2aWNlLm9wZW5CaWZNYW5hZ2VyQXBwKGN0eC5yb3dEYXRhKTtcclxuICB9XHJcblxyXG4gIG9uUGFnZVNpemVDaGFuZ2VkKCRldmVudDogeyBwYWdlSW5kZXg6IG51bWJlciwgcGFnZVNpemU6IG51bWJlciB9KSB7XHJcbiAgICAvLyBjb25zb2xlLmxvZygnUGFnZVNpemUgQ2hhbmdlZDonLCAkZXZlbnQpO1xyXG4gICAgbGV0IGNoZWNrZWRJZHMgPSB0aGlzLnR0LmNoZWNrZWRzLm1hcChyID0+IHIuZGF0YS5pZCk7XHJcblxyXG4gICAgdGhpcy5xdWVyeVBhcmFtLmZpbHRlckFyZ3MucGFnZVNpemUgPSAkZXZlbnQucGFnZVNpemU7XHJcbiAgICB0aGlzLmxvYWRJdGVtcyh0aGlzLnF1ZXJ5UGFyYW0uZmlsdGVyQXJncykuc3Vic2NyaWJlKFxyXG4gICAgICAoKSA9PiB7XHJcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICB0aGlzLnR0LmNoZWNrUm93cyhjaGVja2VkSWRzLCB0cnVlKTtcclxuICAgICAgICAgIHRoaXMudHQucmVmcmVzaCgpO1xyXG4gICAgICAgIH0sIDApO1xyXG4gICAgICB9XHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgb25QYWdlQ2hhbmdlZCgkZXZlbnQ6IHsgcGFnZUluZGV4OiBudW1iZXIsIHBhZ2VTaXplOiBudW1iZXIgfSkge1xyXG4gICAgLy8gY29uc29sZS5sb2coJ1BhZ2VOdW1iZXIgQ2hhbmdlZDonLCAkZXZlbnQpO1xyXG4gICAgbGV0IGNoZWNrZWRJZHMgPSB0aGlzLnR0LmNoZWNrZWRzLm1hcChyID0+IHIuZGF0YS5pZCk7XHJcblxyXG4gICAgdGhpcy5xdWVyeVBhcmFtLmZpbHRlckFyZ3MucGFnZUluZGV4ID0gJGV2ZW50LnBhZ2VJbmRleCAtIDE7XHJcbiAgICB0aGlzLnF1ZXJ5UGFyYW0uZmlsdGVyQXJncy5wYWdlU2l6ZSA9ICRldmVudC5wYWdlU2l6ZTtcclxuICAgIHRoaXMubG9hZEl0ZW1zKHRoaXMucXVlcnlQYXJhbS5maWx0ZXJBcmdzKS5zdWJzY3JpYmUoXHJcbiAgICAgICgpID0+IHtcclxuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgIHRoaXMudHQuY2hlY2tSb3dzKGNoZWNrZWRJZHMsIHRydWUpO1xyXG4gICAgICAgICAgdGhpcy50dC5yZWZyZXNoKCk7XHJcbiAgICAgICAgfSwgMCk7XHJcbiAgICAgIH1cclxuICAgICk7XHJcbiAgfVxyXG5cclxuICBwYWdlQ2hhbmdlSGFuZGxlcihwYWdlSW5mbzogeyBwYWdlSW5kZXg6IG51bWJlciwgcGFnZVNpemU6IG51bWJlciB9KSB7XHJcbiAgICBsZXQgY2hlY2tlZElkcyA9IHRoaXMudHQuY2hlY2tlZHMubWFwKHIgPT4gci5kYXRhLmlkKTtcclxuXHJcbiAgICB0aGlzLnF1ZXJ5UGFyYW0uZmlsdGVyQXJncy5wYWdlSW5kZXggPSBwYWdlSW5mby5wYWdlSW5kZXggLSAxO1xyXG4gICAgdGhpcy5xdWVyeVBhcmFtLmZpbHRlckFyZ3MucGFnZVNpemUgPSBwYWdlSW5mby5wYWdlU2l6ZTtcclxuICAgIHRoaXMubG9hZEl0ZW1zKHRoaXMucXVlcnlQYXJhbS5maWx0ZXJBcmdzKS5zdWJzY3JpYmUoXHJcbiAgICAgICgpID0+IHtcclxuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgIHRoaXMudHQuY2hlY2tSb3dzKGNoZWNrZWRJZHMsIHRydWUpO1xyXG4gICAgICAgICAgdGhpcy50dC5yZWZyZXNoKCk7XHJcbiAgICAgICAgfSwgMCk7XHJcbiAgICAgIH1cclxuICAgICk7XHJcbiAgfVxyXG5cclxuICBwYWdlU2l6ZUNoYW5nZUhhbmRsZXIoc2l6ZTogbnVtYmVyKSB7XHJcbiAgICBsZXQgY2hlY2tlZElkcyA9IHRoaXMudHQuY2hlY2tlZHMubWFwKHIgPT4gci5kYXRhLmlkKTtcclxuXHJcbiAgICB0aGlzLnF1ZXJ5UGFyYW0uZmlsdGVyQXJncy5wYWdlU2l6ZSA9IHNpemU7XHJcbiAgICB0aGlzLmxvYWRJdGVtcyh0aGlzLnF1ZXJ5UGFyYW0uZmlsdGVyQXJncykuc3Vic2NyaWJlKFxyXG4gICAgICAoKSA9PiB7XHJcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICB0aGlzLnR0LmNoZWNrUm93cyhjaGVja2VkSWRzLCB0cnVlKTtcclxuICAgICAgICAgIHRoaXMudHQucmVmcmVzaCgpO1xyXG4gICAgICAgIH0sIDApO1xyXG4gICAgICB9XHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgcmVtb3ZlU2V0UHJvY2VzcygpIHtcclxuXHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGxvYWRJdGVtcyhhcmdzOiBQcm9jZXNzRmlsdGVyQ29uZGl0aW9uQXJncyk6IE9ic2VydmFibGU8YW55PiB7XHJcbiAgICBjb25zdCBsb2FkaW5nQ29tcCA9IHRoaXMubG9hZGluZy5zaG93KHsgbWVzc2FnZTogdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybShcImxvYWRpbmdcIikgfSk7XHJcbiAgICByZXR1cm4gdGhpcy5wcm9jSGVscFNlcnZpY2UuZ2V0RGF0YWdyaWREYXRhKGFyZ3MpLnBpcGUoXHJcbiAgICAgIHN3aXRjaE1hcChcclxuICAgICAgICAobGlzdFJlczogUnRCaWxsUHJvY2Vzc0xpc3RSZXN1bHQpID0+IHtcclxuICAgICAgICAgIHRoaXMudHREYXRhID0gWy4uLmxpc3RSZXMuZW50aXRpZXNdO1xyXG4gICAgICAgICAgLy/mm7TmlrDliIbpobXkv6Hmga9cclxuICAgICAgICAgIHRoaXMudHQuc2V0UGFnZUluZGV4KGxpc3RSZXMucGFnZUluZGV4ICsgMSk7XHJcbiAgICAgICAgICB0aGlzLnR0LnRvdGFsID0gbGlzdFJlcy50b3RhbENvdW50O1xyXG4gICAgICAgICAgdGhpcy50dC5wYWdlU2l6ZSA9IGxpc3RSZXMucGFnZVNpemU7XHJcbiAgICAgICAgICAvLyB0aGlzLnBhZ2Uuc2V0Q3VycmVudFBhZ2UodGhpcy5wYWdpbmF0aW9uSWQsIGxpc3RSZXMucGFnZUluZGV4ICsgMSk7XHJcbiAgICAgICAgICAvLyB0aGlzLnBhZ2Uuc2V0SXRlbXNQZXJQYWdlKHRoaXMucGFnaW5hdGlvbklkLCBsaXN0UmVzLnBhZ2VTaXplKTtcclxuICAgICAgICAgIC8vIHRoaXMucGFnZS5zZXRUb3RhbEl0ZW1zKHRoaXMucGFnaW5hdGlvbklkLCBsaXN0UmVzLnRvdGFsQ291bnQpO1xyXG5cclxuICAgICAgICAgIGxvYWRpbmdDb21wLmNsb3NlKCk7XHJcbiAgICAgICAgICByZXR1cm4gb2YobGlzdFJlcyk7XHJcbiAgICAgICAgfVxyXG4gICAgICApLFxyXG4gICAgICBjYXRjaEVycm9yKFxyXG4gICAgICAgIChlcnIpID0+IHtcclxuICAgICAgICAgIGxvYWRpbmdDb21wLmNsb3NlKCk7XHJcbiAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgLy90b2RvIOehruWumuW8guW4uOe7k+aehCwg55uu5YmN6YeH55So5YW85a655Y+W5YC85pa55byPXHJcbiAgICAgICAgICAgIHRoaXMubWVzc2FnZXIuZXJyb3IoZXJyLmVycm9yID09IG51bGwgPyBlcnIubWVzc2FnZSA6IChlcnIuZXJyb3IuTWVzc2FnZSB8fCBlcnIuZXJyb3IubWVzc2FnZSB8fCBlcnIubWVzc2FnZSkpO1xyXG4gICAgICAgICAgfSwgMzAwKTtcclxuICAgICAgICAgIHRocm93IGVycjtcclxuICAgICAgICB9XHJcbiAgICAgIClcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGNvbmZpZ1R0Q29sdW1ucygpIHtcclxuICAgIHRoaXMudHRDb2x1bW5zID0gW1xyXG4gICAgICAvLyB7XHJcbiAgICAgIC8vICAgZmllbGQ6IFwiaXNFbmFibGVkXCIsIHRpdGxlOiB0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKFwiZW5hYmxlZFN0YXRlXCIpLCB3aWR0aDogMTAwLCBzb3J0YWJsZTogZmFsc2UsXHJcbiAgICAgIC8vICAgZm9ybWF0dGVyOiAodmFsdWU6IGJvb2xlYW4sIHJvd0RhdGEsIHJvd0luZGV4KSA9PiB7XHJcbiAgICAgIC8vICAgICBpZiAodmFsdWUgPT0gdHJ1ZSkge1xyXG4gICAgICAvLyAgICAgICByZXR1cm4gdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybShcImVuYWJsZWRcIik7XHJcbiAgICAgIC8vICAgICB9IGVsc2UgaWYgKHZhbHVlID09IGZhbHNlKSB7XHJcbiAgICAgIC8vICAgICAgIHJldHVybiB0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKFwiZGlzYWJsZWRcIik7XHJcbiAgICAgIC8vICAgICB9IGVsc2Uge1xyXG4gICAgICAvLyAgICAgICByZXR1cm4gXCItXCI7XHJcbiAgICAgIC8vICAgICB9XHJcbiAgICAgIC8vICAgfVxyXG4gICAgICAvLyB9LFxyXG4gICAgICB7IGZpZWxkOiBcImNvZGVcIiwgdGl0bGU6IHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oXCJjb2RlXCIpLCB3aWR0aDogMTIwLCBzb3J0YWJsZTogdHJ1ZSB9LFxyXG4gICAgICB7XHJcbiAgICAgICAgZmllbGQ6IFwibmFtZVwiLCB0aXRsZTogdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybShcIm5hbWVcIiksIHdpZHRoOiAyNTAsIHNvcnRhYmxlOiB0cnVlLFxyXG4gICAgICAgIHRlbXBsYXRlOiB0aGlzLm5hbWVDZWxsVGVtcCxcclxuICAgICAgfSxcclxuICAgICAgeyBmaWVsZDogXCJ1cEJpbGxWb05hbWVcIiwgdGl0bGU6IHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oXCJ1cEJpbGxcIiksIHdpZHRoOiAxMjAsIHNvcnRhYmxlOiB0cnVlIH0sXHJcbiAgICAgIHsgZmllbGQ6IFwiZG93bkJpbGxWb05hbWVcIiwgdGl0bGU6IHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oXCJkb3duQmlsbFwiKSwgd2lkdGg6IDEyMCwgc29ydGFibGU6IHRydWUgfSxcclxuICAgICAgLy8ge1xyXG4gICAgICAvLyAgIGZpZWxkOiBcImJpZk1ldGFkYXRhVHlwZVwiLCB0aXRsZTogdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybShcInByb2Nlc3NUeXBlXCIpLCB3aWR0aDogMTIwLCBzb3J0YWJsZTogZmFsc2UsXHJcbiAgICAgIC8vICAgZm9ybWF0dGVyOiAodmFsdWU6IEJpZk1ldGFkYXRhVHlwZSwgcm93RGF0YSwgcm93SW5kZXgpID0+IHtcclxuICAgICAgLy8gICAgIGlmICh2YWx1ZSA9PSBCaWZNZXRhZGF0YVR5cGUuQmlmQ3JlYXRpb25Qcm9jZXNzKSB7XHJcbiAgICAgIC8vICAgICAgIHJldHVybiB0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKFwiY3JlYXRpb25cIik7XHJcbiAgICAgIC8vICAgICB9IGVsc2UgaWYgKHZhbHVlID09IEJpZk1ldGFkYXRhVHlwZS5CaWZXcml0ZWJhY2tQcm9jZXNzKSB7XHJcbiAgICAgIC8vICAgICAgIHJldHVybiB0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKFwid3JpdGViYWNrXCIpO1xyXG4gICAgICAvLyAgICAgfSBlbHNlIHtcclxuICAgICAgLy8gICAgICAgcmV0dXJuIFwiLVwiO1xyXG4gICAgICAvLyAgICAgfVxyXG4gICAgICAvLyAgIH1cclxuICAgICAgLy8gfSxcclxuICAgICAge1xyXG4gICAgICAgIGZpZWxkOiBcInN5c0luaXRcIiwgdGl0bGU6IHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oXCJzeXNJbml0XCIpLCB3aWR0aDogODAsIHNvcnRhYmxlOiBmYWxzZSxcclxuICAgICAgICBmb3JtYXR0ZXI6ICh2YWx1ZTogYm9vbGVhbiwgcm93RGF0YSwgcm93SW5kZXgpID0+IHtcclxuICAgICAgICAgIGlmICh2YWx1ZSA9PSB0cnVlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKFwieWVzXCIpO1xyXG4gICAgICAgICAgfSBlbHNlIGlmICh2YWx1ZSA9PSBmYWxzZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybShcIm5vXCIpO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIFwiLVwiO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfSxcclxuICAgICAgLy8ge1xyXG4gICAgICAvLyAgIGZpZWxkOiBudWxsLCB0aXRsZTogdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybShcImlzRXh0ZW5kUHJvY2Vzc1wiKSwgd2lkdGg6IDgwLCBzb3J0YWJsZTogZmFsc2UsXHJcbiAgICAgIC8vICAgZm9ybWF0dGVyOiAodmFsdWU6IGJvb2xlYW4sIHJvd0RhdGEsIHJvd0luZGV4KSA9PiB7XHJcbiAgICAgIC8vICAgICBpZiAocm93RGF0YS5wYXJlbnRJZCA9PSBudWxsKSB7XHJcbiAgICAgIC8vICAgICAgIHJldHVybiB0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKFwibm9cIik7XHJcbiAgICAgIC8vICAgICB9IGVsc2Uge1xyXG4gICAgICAvLyAgICAgICByZXR1cm4gdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybShcInllc1wiKTtcclxuICAgICAgLy8gICAgIH1cclxuICAgICAgLy8gICB9XHJcbiAgICAgIC8vIH0sXHJcbiAgICAgIC8vIHsgZmllbGQ6IFwiYnVzaW5lc3NUeXBlXCIsIHRpdGxlOiB0aGlzLnRyYW5zbGF0ZVNlcnZpY2UuaW5zdGFudChcImJ1c2luZXNzVHlwZVwiKSwgd2lkdGg6IDEyMCB9LFxyXG4gICAgICAvLyB7IGZpZWxkOiBcImNyZWF0b3JcIiwgdGl0bGU6IHRoaXMudHJhbnNsYXRlU2VydmljZS5pbnN0YW50KFwiY3JlYXRvclwiKSwgd2lkdGg6IDEyMCB9LFxyXG4gICAgICAvLyB7IGZpZWxkOiBcImNyZWF0ZWRUaW1lXCIsIHRpdGxlOiB0aGlzLnRyYW5zbGF0ZVNlcnZpY2UuaW5zdGFudChcImNyZWF0ZWRUaW1lXCIpLCB3aWR0aDogMTIwIH0sXHJcbiAgICAgIC8vIHsgZmllbGQ6IFwibGFzdE1vZGlmaWVyXCIsIHRpdGxlOiB0aGlzLnRyYW5zbGF0ZVNlcnZpY2UuaW5zdGFudChcImxhc3RNb2RpZmllclwiKSwgd2lkdGg6IDEyMCB9LFxyXG4gICAgICAvLyB7XHJcbiAgICAgIC8vICAgZmllbGQ6IFwibGFzdE1vZGlmaWVkVGltZVwiLCB0aXRsZTogdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybShcImxhc3RNb2RpZmllZFRpbWVcIiksIHdpZHRoOiAxMjAsIHNvcnRhYmxlOiB0cnVlLFxyXG4gICAgICAvLyAgIGZvcm1hdHRlcjoge1xyXG4gICAgICAvLyAgICAgdHlwZTogJ2RhdGV0aW1lJyxcclxuICAgICAgLy8gICAgIG9wdGlvbnM6IHtcclxuICAgICAgLy8gICAgICAgZm9ybWF0OiAnWVlZWS1NTS1ERCBISDptbTpzcydcclxuICAgICAgLy8gICAgIH1cclxuICAgICAgLy8gICB9LFxyXG4gICAgICAvLyB9LFxyXG4gICAgXTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgY3JlYXRlRGVmYXVsdFF1ZXJ5UGFyYW0oKSB7XHJcbiAgICBjb25zdCBxdWVyeVBhcmFtID0ge1xyXG4gICAgICBmaWx0ZXJBcmdzOiBuZXcgUHJvY2Vzc0ZpbHRlckNvbmRpdGlvbkFyZ3MoKSxcclxuICAgICAgZmlsdGVyQXJnc0V4dDoge31cclxuICAgIH07XHJcblxyXG4gICAgcXVlcnlQYXJhbS5maWx0ZXJBcmdzLnBhZ2VTaXplID0gdGhpcy5kZWZhdWx0UGFnZVNpemU7XHJcbiAgICBxdWVyeVBhcmFtLmZpbHRlckFyZ3MucGFnZUluZGV4ID0gMDtcclxuICAgIHF1ZXJ5UGFyYW0uZmlsdGVyQXJncy5PcmRlckJ5TGFzdE1vZGlmaWVkVGltZSA9IG5ldyBUZXh0VmFsdWUoKTtcclxuICAgIHF1ZXJ5UGFyYW0uZmlsdGVyQXJncy5PcmRlckJ5TGFzdE1vZGlmaWVkVGltZS52YWx1ZSA9IE9yZGVyQnlEaXJlY3Rpb24uRGVzYztcclxuICAgIHF1ZXJ5UGFyYW0uZmlsdGVyQXJncy5PcmRlckJ5TGFzdE1vZGlmaWVkVGltZS5oYXNWYWx1ZSA9IHRydWU7XHJcbiAgICBxdWVyeVBhcmFtLmZpbHRlckFyZ3MuYmlsbFByb2Nlc3NUeXBlID0gbmV3IFRleHRWYWx1ZSgpO1xyXG4gICAgcXVlcnlQYXJhbS5maWx0ZXJBcmdzLmJpbGxQcm9jZXNzVHlwZS52YWx1ZSA9IEJpZk1ldGFkYXRhVHlwZS5CaWZDcmVhdGlvblByb2Nlc3M7XHJcbiAgICBxdWVyeVBhcmFtLmZpbHRlckFyZ3MuYmlsbFByb2Nlc3NUeXBlLmhhc1ZhbHVlID0gdHJ1ZTtcclxuICAgIHF1ZXJ5UGFyYW0uZmlsdGVyQXJncy5pc0VuYWJsZWQgPSBuZXcgVGV4dFZhbHVlKCk7XHJcbiAgICBxdWVyeVBhcmFtLmZpbHRlckFyZ3MuaXNFbmFibGVkLnZhbHVlID0gXCJ0cnVlXCI7XHJcbiAgICBxdWVyeVBhcmFtLmZpbHRlckFyZ3MuaXNFbmFibGVkLmhhc1ZhbHVlID0gdHJ1ZTtcclxuXHJcblxyXG4gICAgcmV0dXJuIHF1ZXJ5UGFyYW07XHJcbiAgfVxyXG59XHJcbiJdfQ==