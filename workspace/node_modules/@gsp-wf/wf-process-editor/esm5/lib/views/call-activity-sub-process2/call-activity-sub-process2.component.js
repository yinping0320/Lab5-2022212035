/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { Component, HostBinding, Input, Output, EventEmitter, ViewChild, TemplateRef, ComponentFactoryResolver, Injector, Optional, ChangeDetectorRef, Inject, LOCALE_ID } from '@angular/core';
import { CallActivitySubProcess } from '../call-activity-sub-process/call-activity-sub-process.entity';
import { MessagerService } from '@farris/ui-messager';
import { ProcessDeUtil } from '../../domain/process-de-util';
import { HttpService } from '@ecp-caf/caf-common';
import { ProcessDesignerUIState } from '../../app/process-designer.uistate';
import { ExpressionService, InjectedType } from '@gsp-svc/expression';
import { FarrisRadioGroupComponent } from '@farris/ui-forms';
import { ProcessListHelpComponent } from '../../views/aif-process-list-help/components/process-list-help/process-list-help.component';
import { NotifyService } from '@farris/ui-notify';
import { BsModalService } from '@farris/ui-modal';
import { SubProcessType } from '../call-activity-sub-process/SubProcessType';
import { BillSourceType } from '../call-activity-sub-process/BillSourceType';
import { WF_LANG_RESOURCES, WfLocalePipe } from '../../i18n/pipe/wf-process-editor-locale.pipe';
var CallActivitySubProcess2Component = /** @class */ (function () {
    function CallActivitySubProcess2Component(notify, modalService, message, util, http, designerState, expr, cfr, inj, cdr, localeId, resources, localePipe) {
        this.notify = notify;
        this.modalService = modalService;
        this.message = message;
        this.util = util;
        this.http = http;
        this.designerState = designerState;
        this.expr = expr;
        this.cfr = cfr;
        this.inj = inj;
        this.cdr = cdr;
        this.localeId = localeId;
        this.resources = resources;
        this.localePipe = localePipe;
        this.cls = 'farris-main-area flex-column';
        this.editorParams = {};
        this.closeModal = new EventEmitter();
        this.submitModal = new EventEmitter();
        this.modalConfig = {
            title: this.localePipe.transform('component.subProcess.subProcessSet'),
            width: 600,
            height: 342,
            showButtons: true
        };
        this.callActivitySubProcess = new CallActivitySubProcess();
        this.groupIcon = '<i class="f-icon f-icon-lookup"></i>';
        this.subProcessType = SubProcessType;
        this.billSourceType = BillSourceType;
        this.radioGroupProcessTypeData = [
            { value: "Specified", name: this.localePipe.transform('component.subProcess.specified') },
            { value: "Dynamic", name: this.localePipe.transform('component.subProcess.dynamic') },
        ];
        this.radioGroupBillSourceData = [
            { value: BillSourceType.InheritParent, name: this.localePipe.transform('component.subProcess.inheritParent') },
            { value: BillSourceType.AutoCreation, name: this.localePipe.transform('component.subProcess.autoCreation') },
            { value: BillSourceType.VariablesExpression, name: this.localePipe.transform('component.subProcess.variablesExpression') },
        ];
        this.localePipe = this.localePipe || new WfLocalePipe(localeId, resources);
    }
    Object.defineProperty(CallActivitySubProcess2Component.prototype, "value", {
        set: /**
         * @param {?} v
         * @return {?}
         */
        function (v) {
            if (v) {
                this.callActivitySubProcess = v;
                // 为子流程类型赋值
                if (this.callActivitySubProcess.calledElement == null || this.callActivitySubProcess.calledElement == "") {
                    if (this.callActivitySubProcess.calledBizDefKey == null || this.callActivitySubProcess.calledBizDefKey == "") {
                        this.callActivitySubProcess.subProcessType = SubProcessType.Specified;
                    }
                    else {
                        this.callActivitySubProcess.subProcessType = SubProcessType.Dynamic;
                    }
                }
                else {
                    this.callActivitySubProcess.subProcessType = SubProcessType.Specified;
                }
                // 为单据来源类型赋值
                if (this.callActivitySubProcess.inheritBizDataId === true) {
                    this.callActivitySubProcess.billSourceType = BillSourceType.InheritParent;
                }
                else if (this.callActivitySubProcess.inheritBizDataId === false && this.callActivitySubProcess.useAutoCreationData === false) {
                    this.callActivitySubProcess.billSourceType = BillSourceType.VariablesExpression;
                }
                else if (this.callActivitySubProcess.inheritBizDataId === false && this.callActivitySubProcess.useAutoCreationData === true) {
                    this.callActivitySubProcess.billSourceType = BillSourceType.AutoCreation;
                }
                this.getProcessDefKey(this.callActivitySubProcess.calledElement);
                this.getFlowForm(this.callActivitySubProcess.calledBizDefKey);
                this.getAifProcessName(this.callActivitySubProcess.aifProcessCode);
            }
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    CallActivitySubProcess2Component.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
    };
    /**
     * @return {?}
     */
    CallActivitySubProcess2Component.prototype.clickOK = /**
     * @return {?}
     */
    function () {
        if (this.validator()) {
            /** @type {?} */
            var object = { value: this.callActivitySubProcess, parameters: null };
            this.submitModal.emit(object);
        }
    };
    /**
     * @return {?}
     */
    CallActivitySubProcess2Component.prototype.clickCancel = /**
     * @return {?}
     */
    function () {
        this.closeModal.emit();
    };
    /**
     * @param {?} args
     * @return {?}
     */
    CallActivitySubProcess2Component.prototype.processConfirm = /**
     * @param {?} args
     * @return {?}
     */
    function (args) {
        if (args) {
            this.callActivitySubProcess.calledElement = args.procDefKey;
            this.callActivitySubProcess.calledElementName = args.name;
        }
    };
    /**
     * @param {?} val
     * @return {?}
     */
    CallActivitySubProcess2Component.prototype.processTypeChange = /**
     * @param {?} val
     * @return {?}
     */
    function (val) {
        console.log(val);
        if (val == SubProcessType.Specified) {
            this.callActivitySubProcess.calledBizDefKey = null;
            this.callActivitySubProcess.calledBizDefName = null;
        }
        else if (val == SubProcessType.Dynamic) {
            this.callActivitySubProcess.calledElement = null;
            this.callActivitySubProcess.calledElementName = null;
        }
    };
    /**
     * @param {?} val
     * @return {?}
     */
    CallActivitySubProcess2Component.prototype.billSourceChange = /**
     * @param {?} val
     * @return {?}
     */
    function (val) {
        console.log(val);
        if (val == BillSourceType.InheritParent) {
            this.callActivitySubProcess.inheritBizDataId = true;
            this.callActivitySubProcess.useAutoCreationData = false;
        }
        else if (val == BillSourceType.AutoCreation) {
            this.callActivitySubProcess.inheritBizDataId = false;
            this.callActivitySubProcess.useAutoCreationData = true;
        }
        else if (val == BillSourceType.VariablesExpression) {
            this.callActivitySubProcess.inheritBizDataId = false;
            this.callActivitySubProcess.useAutoCreationData = false;
        }
    };
    /**
     * @return {?}
     */
    CallActivitySubProcess2Component.prototype.selectProcess = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.openProcHelp().subscribe((/**
         * @param {?} rte
         * @return {?}
         */
        function (rte) {
            if (rte == null) {
                _this.notify.warning(_this.localePipe.transform('component.subProcess.rteNull'));
                return;
            }
            _this.callActivitySubProcess.aifProcessCode = rte.code;
            _this.callActivitySubProcess.aifProcessName = rte.name;
        }));
    };
    /**
     * @return {?}
     */
    CallActivitySubProcess2Component.prototype.clearProcess = /**
     * @return {?}
     */
    function () {
        this.callActivitySubProcess.aifProcessCode = null;
        this.callActivitySubProcess.aifProcessName = null;
    };
    /**
     * @return {?}
     */
    CallActivitySubProcess2Component.prototype.openProcHelp = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var cmpF = this.cfr.resolveComponentFactory(ProcessListHelpComponent);
        /** @type {?} */
        var cmpR = cmpF.create(this.inj, []);
        cmpR.instance.editorParams = this.editorParams;
        /** @type {?} */
        var modalRef = this.modalService.show(cmpR, {
            title: this.localePipe.transform('component.subProcess.orderProcess'),
            width: 1250,
            height: 500,
            resizable: true,
            buttons: [
                {
                    text: this.localePipe.transform('component.subProcess.clickOk'),
                    cls: "btn btn-primary",
                    handle: (/**
                     * @param {?} evt
                     * @return {?}
                     */
                    function (evt) {
                        cmpR.instance.clickOk(evt);
                        modalRef.close();
                    })
                },
                {
                    text: this.localePipe.transform('component.subProcess.clickCancel'),
                    cls: "btn btn-secondary",
                    handle: (/**
                     * @param {?} evt
                     * @return {?}
                     */
                    function (evt) {
                        cmpR.instance.clickCancel(evt);
                        modalRef.close();
                    })
                }
            ],
            closed: (/**
             * @return {?}
             */
            function () {
                modalRef.dialog.destroy();
            })
        });
        cmpR.instance.modalRef = modalRef;
        return cmpR.instance.procEmitter.asObservable();
    };
    /**
     * @param {?} args
     * @return {?}
     */
    CallActivitySubProcess2Component.prototype.clearProcessDef = /**
     * @param {?} args
     * @return {?}
     */
    function (args) {
        this.callActivitySubProcess.calledElement = '';
        this.callActivitySubProcess.calledElementName = '';
    };
    /**
     * @param {?} args
     * @return {?}
     */
    CallActivitySubProcess2Component.prototype.flowFormConfirm = /**
     * @param {?} args
     * @return {?}
     */
    function (args) {
        if (args) {
            this.callActivitySubProcess.calledBizDefKey = args.id;
            this.callActivitySubProcess.calledBizDefName = args.name;
        }
    };
    /**
     * @param {?} args
     * @return {?}
     */
    CallActivitySubProcess2Component.prototype.clearFlowForm = /**
     * @param {?} args
     * @return {?}
     */
    function (args) {
        this.callActivitySubProcess.calledBizDefKey = '';
        this.callActivitySubProcess.calledBizDefName = '';
    };
    /**
     * @return {?}
     */
    CallActivitySubProcess2Component.prototype.setBizDataId = /**
     * @return {?}
     */
    function () {
        this.showExprHelp();
    };
    /**
     * @private
     * @return {?}
     */
    CallActivitySubProcess2Component.prototype.showExprHelp = /**
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        var e_1, _a, e_2, _b, e_3, _c;
        /** @type {?} */
        var context = new Array();
        // if(this.expr.exprEntity.contextEntities.find(x => x.key === 'CurrentLanguage')) {
        //   context.push(this.expr.exprEntity.contextEntities.find(x => x.key === 'CurrentLanguage'));
        // }
        // this.expr.clearContext();
        if (this.designerState.schemas.length > 0) {
            try {
                for (var _d = tslib_1.__values(this.designerState.schemas), _e = _d.next(); !_e.done; _e = _d.next()) {
                    var schema = _e.value;
                    this.expr.addSchema('Schema', schema);
                }
            }
            catch (e_1_1) { e_1 = { error: e_1_1 }; }
            finally {
                try {
                    if (_e && !_e.done && (_a = _d.return)) _a.call(_d);
                }
                finally { if (e_1) throw e_1.error; }
            }
            if (this.designerState.schemas[0].entityTypes && this.designerState.schemas[0].entityTypes.length > 0) {
                /** @type {?} */
                var entityType = this.designerState.schemas[0].entityTypes[0];
                this.expr.addInjectedEntity(entityType.name, 'Schema', entityType.name, InjectedType.EntityType);
            }
        }
        context = this.designerState.addContext(context);
        if (this.designerState.subActivityContext.length > 0) {
            try {
                for (var _f = tslib_1.__values(this.designerState.subActivityContext), _g = _f.next(); !_g.done; _g = _f.next()) {
                    var variable = _g.value;
                    context.push(variable);
                    // this.expr.addContext(variable);
                }
            }
            catch (e_2_1) { e_2 = { error: e_2_1 }; }
            finally {
                try {
                    if (_g && !_g.done && (_b = _f.return)) _b.call(_f);
                }
                finally { if (e_2) throw e_2.error; }
            }
        }
        if (context.length > 0) {
            try {
                for (var context_1 = tslib_1.__values(context), context_1_1 = context_1.next(); !context_1_1.done; context_1_1 = context_1.next()) {
                    var v = context_1_1.value;
                    this.expr.addContext(v);
                }
            }
            catch (e_3_1) { e_3 = { error: e_3_1 }; }
            finally {
                try {
                    if (context_1_1 && !context_1_1.done && (_c = context_1.return)) _c.call(context_1);
                }
                finally { if (e_3) throw e_3.error; }
            }
        }
        this.expr.addExpressionText(this.callActivitySubProcess.bizDataId);
        this.expr.buildExpression().then((/**
         * @param {?} expressioninfo
         * @return {?}
         */
        function (expressioninfo) {
            _this.callActivitySubProcess.bizDataId = expressioninfo;
            //点击确定后，去除表达式里面的新增的上下文变量
            if (context.length > 0) {
                _this.expr.exprEntity.contextEntities = _this.expr.exprEntity.contextEntities.filter((/**
                 * @param {?} x
                 * @return {?}
                 */
                function (x) { return !context.some((/**
                 * @param {?} y
                 * @return {?}
                 */
                function (y) { return y.key === x.key; })); }));
            }
        }));
    };
    /**
     * @param {?} bool
     * @return {?}
     */
    CallActivitySubProcess2Component.prototype.valueChange = /**
     * @param {?} bool
     * @return {?}
     */
    function (bool) {
        if (bool) {
            this.callActivitySubProcess.bizDataId = null;
        }
    };
    /**
     * @private
     * @return {?}
     */
    CallActivitySubProcess2Component.prototype.validator = /**
     * @private
     * @return {?}
     */
    function () {
        if (!this.callActivitySubProcess.inheritBizDataId && !this.callActivitySubProcess.useAutoCreationData && !this.callActivitySubProcess.bizDataId) {
            this.message.warning(this.localePipe.transform('component.subProcess.inheritBizDataId'));
            return false;
        }
        return true;
    };
    /**
     * @private
     * @param {?} key
     * @return {?}
     */
    CallActivitySubProcess2Component.prototype.getProcessDefKey = /**
     * @private
     * @param {?} key
     * @return {?}
     */
    function (key) {
        var _this = this;
        /** @type {?} */
        var url = this.util.getProcessDefinitionWebApi();
        if (key) {
            url += "/procDefKey/" + key;
            this.http.get(url).subscribe((/**
             * @param {?} re
             * @return {?}
             */
            function (re) {
                _this.callActivitySubProcess.calledElementName = re.name;
            }));
        }
    };
    /**
     * @private
     * @param {?} id
     * @return {?}
     */
    CallActivitySubProcess2Component.prototype.getFlowForm = /**
     * @private
     * @param {?} id
     * @return {?}
     */
    function (id) {
        var _this = this;
        /** @type {?} */
        var url = this.util.getFlowFormWebApi();
        if (id) {
            url += "/" + id;
            this.http.get(url).subscribe((/**
             * @param {?} re
             * @return {?}
             */
            function (re) {
                _this.callActivitySubProcess.calledBizDefName = re.name;
            }));
        }
    };
    /**
     * @param {?} code
     * @return {?}
     */
    CallActivitySubProcess2Component.prototype.getAifProcessName = /**
     * @param {?} code
     * @return {?}
     */
    function (code) {
        var _this = this;
        if (code != null && code != "") {
            this.http.request("GET", "/api/runtime/aif/v1.0/rtbillcreationprocess/getname/" + code, { responseType: 'text' }).subscribe((/**
             * @param {?} res
             * @return {?}
             */
            function (res) {
                _this.callActivitySubProcess.aifProcessName = res;
            }), (/**
             * @param {?} err
             * @return {?}
             */
            function (err) {
                if (err.error && typeof err.error == "string") {
                    err.error = JSON.parse(err.error);
                }
                setTimeout((/**
                 * @return {?}
                 */
                function () {
                    //todo 确定异常结构, 目前采用兼容取值方式
                    _this.message.error(err.error == null ? err.message : (err.error.Message || err.error.message || err.message));
                }), 300);
                throw err;
            }));
        }
    };
    CallActivitySubProcess2Component.decorators = [
        { type: Component, args: [{
                    selector: 'lib-call-activity-sub-process2',
                    template: "<div class=\"f-page\">\r\n  <div class=\"f-utils-fill-flex-column farris-split-section my-2 mx-3 h-100\" style=\"border-radius:16px;border: 1.5px solid #F1F3F7;\">\r\n    <section>\r\n      <div class=\"f-utils-fill-flex-column h-100\" style=\"margin-top: 15px;\">\r\n        <div class=\"h-100\">\r\n          <div class=\"farris-form form-inline farris-form-inline\">\r\n            <div class=\"farris-group-wrap mt-1\">\r\n              <div class=\"form-group farris-form-group\">\r\n                <label class=\"col-form-label\">\r\n                  <span class=\"farris-label-text\">{{'component.subProcess.radioGroupProcessType' | wfLocale}}</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap ml-1\">\r\n                  <farris-radiogroup #radioGroupProcessType\r\n                    [(ngModel)]=\"callActivitySubProcess&&callActivitySubProcess.subProcessType\" [horizontal]=\"false\"\r\n                    [data]=\"radioGroupProcessTypeData\" (changeValue)=\"processTypeChange($event)\">\r\n                  </farris-radiogroup>\r\n                  <div class=\"farris-feedback valid-feedback\"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <div class=\"farris-group-wrap mt-1\" *ngIf=\"callActivitySubProcess.subProcessType==subProcessType.Dynamic\">\r\n              <div class=\"form-group farris-form-group\">\r\n                <label class=\"col-form-label\">\r\n                  <span class=\"farris-label-text\">{{'component.subProcess.flowForm' | wfLocale}}</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap ml-1\">\r\n                  <wf-bizprocess-lookup title=\"{{'component.subProcess.flowForm' | wfLocale}}\" [sourceType]=\"'flowform'\"\r\n                    [displayTxt]=\"callActivitySubProcess.calledBizDefName\" (afterConfirm)=\"flowFormConfirm($event)\"\r\n                    (clear)=\"clearFlowForm($event)\">\r\n                  </wf-bizprocess-lookup>\r\n                  <div class=\"farris-feedback valid-feedback\"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <div class=\"farris-group-wrap mt-1\" *ngIf=\"callActivitySubProcess.subProcessType==subProcessType.Specified\">\r\n              <div class=\"form-group farris-form-group\">\r\n                <label class=\"col-form-label\">\r\n                  <span class=\"farris-label-text\">{{'component.subProcess.processDef' | wfLocale}}</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap ml-1\">\r\n                  <wf-bizprocess-lookup title=\"{{'component.subProcess.processDef' | wfLocale}}\" [displayTxt]=\"callActivitySubProcess.calledElementName\"\r\n                    (afterConfirm)=\"processConfirm($event)\" (clear)=\"clearProcessDef($event)\">\r\n                  </wf-bizprocess-lookup>\r\n                  <div class=\"farris-feedback valid-feedback\"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </section>\r\n    <section class=\"\">\r\n      <div class=\"f-utils-fill-flex-column h-100\">\r\n        <div class=\"h-100\">\r\n          <div class=\"farris-form form-inline farris-form-inline\">\r\n\r\n            <div class=\"farris-group-wrap mt-1\">\r\n              <div class=\"form-group farris-form-group\">\r\n                <label class=\"col-form-label\">\r\n                  <span class=\"farris-label-text\">{{'component.subProcess.radioGroupBillSource' | wfLocale}}</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap ml-1\">\r\n                  <farris-radiogroup #radioGroupBillSource\r\n                    [(ngModel)]=\"callActivitySubProcess&&callActivitySubProcess.billSourceType\" [horizontal]=\"false\"\r\n                    [data]=\"radioGroupBillSourceData\" (changeValue)=\"billSourceChange($event)\">\r\n                  </farris-radiogroup>\r\n                </div>\r\n                <div class=\"farris-feedback valid-feedback\"></div>\r\n              </div>\r\n            </div>\r\n\r\n            <div class=\"farris-group-wrap mt-1\"\r\n              *ngIf=\"callActivitySubProcess.billSourceType==billSourceType.AutoCreation\">\r\n              <div class=\"form-group farris-form-group\">\r\n                <label class=\"col-form-label\">\r\n                  <span class=\"farris-label-text\">{{'component.subProcess.autoCreationProcess' | wfLocale}}</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap ml-1\">\r\n                  <input-group [ngModel]=\"callActivitySubProcess&&callActivitySubProcess.aifProcessName\"\r\n                    [editable]=\"false\" (clickHandle)=\"selectProcess()\" [groupText]=\"groupIcon\" (clear)=\"clearProcess()\">\r\n                  </input-group>\r\n                  <div class=\"farris-feedback valid-feedback\"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <div class=\"farris-group-wrap mt-1\"\r\n              *ngIf=\"callActivitySubProcess.billSourceType==billSourceType.VariablesExpression\">\r\n              <div class=\"form-group farris-form-group\">\r\n                <label class=\"col-form-label\">\r\n                  <span class=\"farris-label-text\">{{'component.subProcess.bizDataId' | wfLocale}}</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap ml-1\">\r\n                  <input-group [ngModel]=\"callActivitySubProcess.bizDataId\" [enableClear]=\"false\"\r\n                    [ngModel]=\"callActivitySubProcess.bizDataId\" name=\"bizDataId\" [editable]=\"false\"\r\n                    (clickHandle)=\"setBizDataId()\" [groupText]=\"groupIcon\">\r\n                  </input-group>\r\n                  <div class=\"farris-feedback valid-feedback\"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </section>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type=\"button\" class=\"btn btn-secondary btn-sm mx-2\" (click)=\"clickCancel()\">{{'component.subProcess.clickCancel' | wfLocale}}</button>\r\n  <button type=\"button\" class=\"btn btn-primary btn-sm mx-2\" (click)=\"clickOK()\">{{'component.subProcess.clickOk' | wfLocale}}</button>\r\n</ng-template>\r\n",
                    providers: [
                        WfLocalePipe,
                    ]
                }] }
    ];
    /** @nocollapse */
    CallActivitySubProcess2Component.ctorParameters = function () { return [
        { type: NotifyService },
        { type: BsModalService },
        { type: MessagerService },
        { type: ProcessDeUtil },
        { type: HttpService },
        { type: ProcessDesignerUIState },
        { type: ExpressionService },
        { type: ComponentFactoryResolver },
        { type: Injector },
        { type: ChangeDetectorRef, decorators: [{ type: Optional }] },
        { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
        { type: undefined, decorators: [{ type: Inject, args: [WF_LANG_RESOURCES,] }] },
        { type: WfLocalePipe, decorators: [{ type: Optional }] }
    ]; };
    CallActivitySubProcess2Component.propDecorators = {
        cls: [{ type: HostBinding, args: ['class',] }],
        editorParams: [{ type: Input }],
        value: [{ type: Input }],
        closeModal: [{ type: Output }],
        submitModal: [{ type: Output }],
        modalFooter: [{ type: ViewChild, args: ['iconSelectFooter',] }],
        radioGroupProcessType: [{ type: ViewChild, args: ["radioGroupProcessType",] }],
        radioGroupBillSource: [{ type: ViewChild, args: ["radioGroupBillSource",] }]
    };
    return CallActivitySubProcess2Component;
}());
export { CallActivitySubProcess2Component };
if (false) {
    /** @type {?} */
    CallActivitySubProcess2Component.prototype.cls;
    /** @type {?} */
    CallActivitySubProcess2Component.prototype.editorParams;
    /** @type {?} */
    CallActivitySubProcess2Component.prototype.closeModal;
    /** @type {?} */
    CallActivitySubProcess2Component.prototype.submitModal;
    /** @type {?} */
    CallActivitySubProcess2Component.prototype.modalFooter;
    /** @type {?} */
    CallActivitySubProcess2Component.prototype.modalConfig;
    /** @type {?} */
    CallActivitySubProcess2Component.prototype.callActivitySubProcess;
    /** @type {?} */
    CallActivitySubProcess2Component.prototype.groupIcon;
    /** @type {?} */
    CallActivitySubProcess2Component.prototype.subProcessType;
    /** @type {?} */
    CallActivitySubProcess2Component.prototype.billSourceType;
    /** @type {?} */
    CallActivitySubProcess2Component.prototype.radioGroupProcessType;
    /** @type {?} */
    CallActivitySubProcess2Component.prototype.radioGroupProcessTypeData;
    /** @type {?} */
    CallActivitySubProcess2Component.prototype.radioGroupBillSource;
    /** @type {?} */
    CallActivitySubProcess2Component.prototype.radioGroupBillSourceData;
    /**
     * @type {?}
     * @private
     */
    CallActivitySubProcess2Component.prototype.notify;
    /**
     * @type {?}
     * @private
     */
    CallActivitySubProcess2Component.prototype.modalService;
    /**
     * @type {?}
     * @private
     */
    CallActivitySubProcess2Component.prototype.message;
    /**
     * @type {?}
     * @private
     */
    CallActivitySubProcess2Component.prototype.util;
    /**
     * @type {?}
     * @private
     */
    CallActivitySubProcess2Component.prototype.http;
    /**
     * @type {?}
     * @private
     */
    CallActivitySubProcess2Component.prototype.designerState;
    /**
     * @type {?}
     * @private
     */
    CallActivitySubProcess2Component.prototype.expr;
    /**
     * @type {?}
     * @private
     */
    CallActivitySubProcess2Component.prototype.cfr;
    /**
     * @type {?}
     * @private
     */
    CallActivitySubProcess2Component.prototype.inj;
    /**
     * @type {?}
     * @private
     */
    CallActivitySubProcess2Component.prototype.cdr;
    /**
     * @type {?}
     * @private
     */
    CallActivitySubProcess2Component.prototype.localeId;
    /**
     * @type {?}
     * @private
     */
    CallActivitySubProcess2Component.prototype.resources;
    /**
     * @type {?}
     * @private
     */
    CallActivitySubProcess2Component.prototype.localePipe;
}
var CallActivitySubProcess2Converter = /** @class */ (function () {
    function CallActivitySubProcess2Converter(localePipe) {
        this.localePipe = localePipe;
    }
    /**
     * @param {?} data
     * @return {?}
     */
    CallActivitySubProcess2Converter.prototype.convertTo = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        if (data && (data.calledBizDefKey || data.calledElement)) {
            return this.localePipe.transform("component.subProcess.set");
        }
        return this.localePipe.transform("component.subProcess.notSet");
    };
    return CallActivitySubProcess2Converter;
}());
export { CallActivitySubProcess2Converter };
if (false) {
    /**
     * @type {?}
     * @private
     */
    CallActivitySubProcess2Converter.prototype.localePipe;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2FsbC1hY3Rpdml0eS1zdWItcHJvY2VzczIuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGdzcC13Zi93Zi1wcm9jZXNzLWVkaXRvci8iLCJzb3VyY2VzIjpbImxpYi92aWV3cy9jYWxsLWFjdGl2aXR5LXN1Yi1wcm9jZXNzMi9jYWxsLWFjdGl2aXR5LXN1Yi1wcm9jZXNzMi5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFVLFdBQVcsRUFBRSxLQUFLLEVBQUUsTUFBTSxFQUFFLFlBQVksRUFBRSxTQUFTLEVBQUUsV0FBVyxFQUFFLHdCQUF3QixFQUFFLFFBQVEsRUFBRSxRQUFRLEVBQUUsaUJBQWlCLEVBQUUsTUFBTSxFQUFFLFNBQVMsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUV4TSxPQUFPLEVBQUUsc0JBQXNCLEVBQUUsTUFBTSwrREFBK0QsQ0FBQztBQUN2RyxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFDdEQsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLDhCQUE4QixDQUFDO0FBQzdELE9BQU8sRUFBRSxXQUFXLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUVsRCxPQUFPLEVBQUUsc0JBQXNCLEVBQUUsTUFBTSxvQ0FBb0MsQ0FBQztBQUM1RSxPQUFPLEVBQUUsaUJBQWlCLEVBQUUsWUFBWSxFQUFhLE1BQU0scUJBQXFCLENBQUM7QUFFakYsT0FBTyxFQUFFLHlCQUF5QixFQUFFLE1BQU0sa0JBQWtCLENBQUM7QUFFN0QsT0FBTyxFQUFFLHdCQUF3QixFQUFFLE1BQU0sNEZBQTRGLENBQUM7QUFDdEksT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLG1CQUFtQixDQUFDO0FBQ2xELE9BQU8sRUFBRSxjQUFjLEVBQUUsTUFBTSxrQkFBa0IsQ0FBQztBQUNsRCxPQUFPLEVBQUUsY0FBYyxFQUFFLE1BQU0sNkNBQTZDLENBQUM7QUFDN0UsT0FBTyxFQUFF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LElBQUksSUFBSSxDQUFDLElBQUksQ0FBQyxlQUFlLElBQUksSUFBSSxDQUFDLGFBQWEsQ0FBQyxFQUFFO1lBQ3hELE9BQU8sSUFBSSxDQUFDLFVBQVUsQ0FBQyxTQUFTLENBQUMsMEJBQTBCLENBQUMsQ0FBQztTQUM5RDtRQUNELE9BQU8sSUFBSSxDQUFDLFVBQVUsQ0FBQyxTQUFTLENBQUMsNkJBQTZCLENBQUMsQ0FBQztJQUNsRSxDQUFDO0lBQ0gsdUNBQUM7QUFBRCxDQUFDLEFBWEQsSUFXQzs7Ozs7OztJQVRHLHNEQUFnQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCwgT25Jbml0LCBIb3N0QmluZGluZywgSW5wdXQsIE91dHB1dCwgRXZlbnRFbWl0dGVyLCBWaWV3Q2hpbGQsIFRlbXBsYXRlUmVmLCBDb21wb25lbnRGYWN0b3J5UmVzb2x2ZXIsIEluamVjdG9yLCBPcHRpb25hbCwgQ2hhbmdlRGV0ZWN0b3JSZWYsIEluamVjdCwgTE9DQUxFX0lEIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IFR5cGVDb252ZXJ0ZXIgfSBmcm9tICdAZmFycmlzL2lkZS1wcm9wZXJ0eS1wYW5lbCc7XHJcbmltcG9ydCB7IENhbGxBY3Rpdml0eVN1YlByb2Nlc3MgfSBmcm9tICcuLi9jYWxsLWFjdGl2aXR5LXN1Yi1wcm9jZXNzL2NhbGwtYWN0aXZpdHktc3ViLXByb2Nlc3MuZW50aXR5JztcclxuaW1wb3J0IHsgTWVzc2FnZXJTZXJ2aWNlIH0gZnJvbSAnQGZhcnJpcy91aS1tZXNzYWdlcic7XHJcbmltcG9ydCB7IFByb2Nlc3NEZVV0aWwgfSBmcm9tICcuLi8uLi9kb21haW4vcHJvY2Vzcy1kZS11dGlsJztcclxuaW1wb3J0IHsgSHR0cFNlcnZpY2UgfSBmcm9tICdAZWNwLWNhZi9jYWYtY29tbW9uJztcclxuaW1wb3J0IHsgT2JzZXJ2YWJsZSB9IGZyb20gJ3J4anMnO1xyXG5pbXBvcnQgeyBQcm9jZXNzRGVzaWduZXJVSVN0YXRlIH0gZnJvbSAnLi4vLi4vYXBwL3Byb2Nlc3MtZGVzaWduZXIudWlzdGF0ZSc7XHJcbmltcG9ydCB7IEV4cHJlc3Npb25TZXJ2aWNlLCBJbmplY3RlZFR5cGUsIFZhckVudGl0eSB9IGZyb20gJ0Bnc3Atc3ZjL2V4cHJlc3Npb24nO1xyXG5pbXBvcnQgeyBDb21ib0xpc3RDb21wb25lbnQgfSBmcm9tICdAZmFycmlzL3VpLWNvbWJvLWxpc3QnO1xyXG5pbXBvcnQgeyBGYXJyaXNSYWRpb0dyb3VwQ29tcG9uZW50IH0gZnJvbSAnQGZhcnJpcy91aS1mb3Jtcyc7XHJcbmltcG9ydCB7IElSdFNob3dFbnRpdHkgfSBmcm9tICcuLi8uLi92aWV3cy9haWYtcHJvY2Vzcy1saXN0LWhlbHAvZW50aXR5L0lSdFNob3dFbnRpdHknO1xyXG5pbXBvcnQgeyBQcm9jZXNzTGlzdEhlbHBDb21wb25lbnQgfSBmcm9tICcuLi8uLi92aWV3cy9haWYtcHJvY2Vzcy1saXN0LWhlbHAvY29tcG9uZW50cy9wcm9jZXNzLWxpc3QtaGVscC9wcm9jZXNzLWxpc3QtaGVscC5jb21wb25lbnQnO1xyXG5pbXBvcnQgeyBOb3RpZnlTZXJ2aWNlIH0gZnJvbSAnQGZhcnJpcy91aS1ub3RpZnknO1xyXG5pbXBvcnQgeyBCc01vZGFsU2VydmljZSB9IGZyb20gJ0BmYXJyaXMvdWktbW9kYWwnO1xyXG5pbXBvcnQgeyBTdWJQcm9jZXNzVHlwZSB9IGZyb20gJy4uL2NhbGwtYWN0aXZpdHktc3ViLXByb2Nlc3MvU3ViUHJvY2Vzc1R5cGUnO1xyXG5pbXBvcnQgeyBCaWxsU291cmNlVHlwZSB9IGZyb20gJy4uL2NhbGwtYWN0aXZpdHktc3ViLXByb2Nlc3MvQmlsbFNvdXJjZVR5cGUnO1xyXG5pbXBvcnQgeyBXRl9MQU5HX1JFU09VUkNFUywgV2ZMb2NhbGVQaXBlIH0gZnJvbSAnLi4vLi4vaTE4bi9waXBlL3dmLXByb2Nlc3MtZWRpdG9yLWxvY2FsZS5waXBlJztcclxuaW1wb3J0IHsgV0ZfUFJPQ0VTU19FRElUT1JfTEFOR19SRVNPVVJDRVMgfSBmcm9tICcuLi8uLi9pMThuL2Fzc2V0cy9sYW5nLnJlc291cmNlJztcclxuXHJcbkBDb21wb25lbnQoe1xyXG4gIHNlbGVjdG9yOiAnbGliLWNhbGwtYWN0aXZpdHktc3ViLXByb2Nlc3MyJyxcclxuICB0ZW1wbGF0ZVVybDogJy4vY2FsbC1hY3Rpdml0eS1zdWItcHJvY2VzczIuY29tcG9uZW50Lmh0bWwnLFxyXG4gIHByb3ZpZGVyczogW1xyXG4gICAgIFdmTG9jYWxlUGlwZSxcclxuICBdXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBDYWxsQWN0aXZpdHlTdWJQcm9jZXNzMkNvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCB7XHJcbiAgQEhvc3RCaW5kaW5nKCdjbGFzcycpXHJcbiAgY2xzID0gJ2ZhcnJpcy1tYWluLWFyZWEgZmxleC1jb2x1bW4nO1xyXG5cclxuICBASW5wdXQoKSBlZGl0b3JQYXJhbXM6IHtcclxuICAgIGJpelR5cGVJZD86IHN0cmluZ1xyXG4gIH0gPSB7fTtcclxuXHJcbiAgQElucHV0KCkgc2V0IHZhbHVlKHY6IENhbGxBY3Rpdml0eVN1YlByb2Nlc3MpIHtcclxuICAgIGlmICh2KSB7XHJcbiAgICAgIHRoaXMuY2FsbEFjdGl2aXR5U3ViUHJvY2VzcyA9IHY7XHJcbiAgICAgIC8vIOS4uuWtkOa1geeoi+exu+Wei+i1i+WAvFxyXG4gICAgICBpZiAodGhpcy5jYWxsQWN0aXZpdHlTdWJQcm9jZXNzLmNhbGxlZEVsZW1lbnQgPT0gbnVsbCB8fCB0aGlzLmNhbGxBY3Rpdml0eVN1YlByb2Nlc3MuY2FsbGVkRWxlbWVudCA9PSBcIlwiKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuY2FsbEFjdGl2aXR5U3ViUHJvY2Vzcy5jYWxsZWRCaXpEZWZLZXkgPT0gbnVsbCB8fCB0aGlzLmNhbGxBY3Rpdml0eVN1YlByb2Nlc3MuY2FsbGVkQml6RGVmS2V5ID09IFwiXCIpIHtcclxuICAgICAgICAgIHRoaXMuY2FsbEFjdGl2aXR5U3ViUHJvY2Vzcy5zdWJQcm9jZXNzVHlwZSA9IFN1YlByb2Nlc3NUeXBlLlNwZWNpZmllZDtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgdGhpcy5jYWxsQWN0aXZpdHlTdWJQcm9jZXNzLnN1YlByb2Nlc3NUeXBlID0gU3ViUHJvY2Vzc1R5cGUuRHluYW1pYztcclxuICAgICAgICB9XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgdGhpcy5jYWxsQWN0aXZpdHlTdWJQcm9jZXNzLnN1YlByb2Nlc3NUeXBlID0gU3ViUHJvY2Vzc1R5cGUuU3BlY2lmaWVkO1xyXG4gICAgICB9XHJcbiAgICAgIC8vIOS4uuWNleaNruadpea6kOexu+Wei+i1i+WAvFxyXG4gICAgICBpZiAodGhpcy5jYWxsQWN0aXZpdHlTdWJQcm9jZXNzLmluaGVyaXRCaXpEYXRhSWQgPT09IHRydWUpIHtcclxuICAgICAgICB0aGlzLmNhbGxBY3Rpdml0eVN1YlByb2Nlc3MuYmlsbFNvdXJjZVR5cGUgPSBCaWxsU291cmNlVHlwZS5Jbmhlcml0UGFyZW50O1xyXG4gICAgICB9IGVsc2UgaWYgKHRoaXMuY2FsbEFjdGl2aXR5U3ViUHJvY2Vzcy5pbmhlcml0Qml6RGF0YUlkID09PSBmYWxzZSAmJiB0aGlzLmNhbGxBY3Rpdml0eVN1YlByb2Nlc3MudXNlQXV0b0NyZWF0aW9uRGF0YSA9PT0gZmFsc2UpIHtcclxuICAgICAgICB0aGlzLmNhbGxBY3Rpdml0eVN1YlByb2Nlc3MuYmlsbFNvdXJjZVR5cGUgPSBCaWxsU291cmNlVHlwZS5WYXJpYWJsZXNFeHByZXNzaW9uO1xyXG4gICAgICB9IGVsc2UgaWYgKHRoaXMuY2FsbEFjdGl2aXR5U3ViUHJvY2Vzcy5pbmhlcml0Qml6RGF0YUlkID09PSBmYWxzZSAmJiB0aGlzLmNhbGxBY3Rpdml0eVN1YlByb2Nlc3MudXNlQXV0b0NyZWF0aW9uRGF0YSA9PT0gdHJ1ZSkge1xyXG4gICAgICAgIHRoaXMuY2FsbEFjdGl2aXR5U3ViUHJvY2Vzcy5iaWxsU291cmNlVHlwZSA9IEJpbGxTb3VyY2VUeXBlLkF1dG9DcmVhdGlvbjtcclxuICAgICAgfVxyXG4gICAgICB0aGlzLmdldFByb2Nlc3NEZWZLZXkodGhpcy5jYWxsQWN0aXZpdHlTdWJQcm9jZXNzLmNhbGxlZEVsZW1lbnQpO1xyXG4gICAgICB0aGlzLmdldEZsb3dGb3JtKHRoaXMuY2FsbEFjdGl2aXR5U3ViUHJvY2Vzcy5jYWxsZWRCaXpEZWZLZXkpO1xyXG4gICAgICB0aGlzLmdldEFpZlByb2Nlc3NOYW1lKHRoaXMuY2FsbEFjdGl2aXR5U3ViUHJvY2Vzcy5haWZQcm9jZXNzQ29kZSk7XHJcbiAgICB9XHJcbiAgfVxyXG4gIEBPdXRwdXQoKSBjbG9zZU1vZGFsID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XHJcbiAgQE91dHB1dCgpIHN1Ym1pdE1vZGFsID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XHJcblxyXG4gIEBWaWV3Q2hpbGQoJ2ljb25TZWxlY3RGb290ZXInKSBtb2RhbEZvb3RlcjogVGVtcGxhdGVSZWY8YW55PjtcclxuICBtb2RhbENvbmZpZyA9IHtcclxuICAgIHRpdGxlOiB0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKCdjb21wb25lbnQuc3ViUHJvY2Vzcy5zdWJQcm9jZXNzU2V0JyksXHJcbiAgICB3aWR0aDogNjAwLFxyXG4gICAgaGVpZ2h0OiAzNDIsXHJcbiAgICBzaG93QnV0dG9uczogdHJ1ZVxyXG4gIH07XHJcblxyXG4gIGNhbGxBY3Rpdml0eVN1YlByb2Nlc3M6IENhbGxBY3Rpdml0eVN1YlByb2Nlc3MgPSBuZXcgQ2FsbEFjdGl2aXR5U3ViUHJvY2VzcygpO1xyXG5cclxuICBncm91cEljb24gPSAnPGkgY2xhc3M9XCJmLWljb24gZi1pY29uLWxvb2t1cFwiPjwvaT4nO1xyXG5cclxuICByZWFkb25seSBzdWJQcm9jZXNzVHlwZSA9IFN1YlByb2Nlc3NUeXBlO1xyXG4gIHJlYWRvbmx5IGJpbGxTb3VyY2VUeXBlID0gQmlsbFNvdXJjZVR5cGU7XHJcbiAgLy8gQFZpZXdDaGlsZChcImNvbWJvUHJvY2Vzc1R5cGVcIilcclxuICAvLyBjb21ib1Byb2Nlc3NUeXBlOiBDb21ib0xpc3RDb21wb25lbnQ7XHJcbiAgLy8gY29tYm9Qcm9jZXNzVHlwZUlkRmllbGQgPSBcInZhbHVlXCI7XHJcbiAgLy8gY29tYm9Qcm9jZXNzVHlwZVZhbHVlRmllbGQgPSBcInZhbHVlXCI7XHJcbiAgLy8gY29tYm9Qcm9jZXNzVHlwZVRleHRGaWVsZCA9IFwidGV4dFwiO1xyXG4gIC8vIGNvbWJvUHJvY2Vzc1R5cGVEYXRhID0gW1xyXG4gIC8vICAgeyB2YWx1ZTogXCJTcGVjaWZpZWRcIiwgdGV4dDogXCLmjIflrprlrZDmtYHnqItcIiB9LFxyXG4gIC8vICAgeyB2YWx1ZTogXCJEeW5hbWljXCIsIHRleHQ6IFwi5Yqo5oCB5a2Q5rWB56iLXCIgfSxcclxuICAvLyBdO1xyXG5cclxuICAvLyBAVmlld0NoaWxkKFwiY29tYm9CaWxsU291cmNlXCIpXHJcbiAgLy8gY29tYm9CaWxsU291cmNlOiBDb21ib0xpc3RDb21wb25lbnQ7XHJcbiAgLy8gY29tYm9CaWxsU291cmNlSWRGaWVsZCA9IFwidmFsdWVcIjtcclxuICAvLyBjb21ib0JpbGxTb3VyY2VWYWx1ZUZpZWxkID0gXCJ2YWx1ZVwiO1xyXG4gIC8vIGNvbWJvQmlsbFNvdXJjZVRleHRGaWVsZCA9IFwidGV4dFwiO1xyXG4gIC8vIGNvbWJvQmlsbFNvdXJjZURhdGEgPSBbXHJcbiAgLy8gICB7IHZhbHVlOiBCaWxsU291cmNlVHlwZS5Jbmhlcml0UGFyZW50LCB0ZXh0OiAn5LiO54i25rWB56iL55u45ZCMJyB9LFxyXG4gIC8vICAgeyB2YWx1ZTogQmlsbFNvdXJjZVR5cGUuQXV0b0NyZWF0aW9uLCB0ZXh0OiAn6Ieq5Yqo55Sf5oiQ5LiL5ri45Y2V5o2uJyB9LFxyXG4gIC8vICAgeyB2YWx1ZTogQmlsbFNvdXJjZVR5cGUuVmFyaWFibGVzRXhwcmVzc2lvbiwgdGV4dDogJ+WPmOmHj+ihqOi+vuW8jycgfSxcclxuICAvLyBdO1xyXG5cclxuICBAVmlld0NoaWxkKFwicmFkaW9Hcm91cFByb2Nlc3NUeXBlXCIpXHJcbiAgcmFkaW9Hcm91cFByb2Nlc3NUeXBlOiBGYXJyaXNSYWRpb0dyb3VwQ29tcG9uZW50O1xyXG4gIHJhZGlvR3JvdXBQcm9jZXNzVHlwZURhdGEgPSBbXHJcbiAgICB7IHZhbHVlOiBcIlNwZWNpZmllZFwiLCBuYW1lOiB0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKCdjb21wb25lbnQuc3ViUHJvY2Vzcy5zcGVjaWZpZWQnKSB9LFxyXG4gICAgeyB2YWx1ZTogXCJEeW5hbWljXCIsIG5hbWU6IHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oJ2NvbXBvbmVudC5zdWJQcm9jZXNzLmR5bmFtaWMnKSB9LFxyXG4gIF07XHJcblxyXG4gIEBWaWV3Q2hpbGQoXCJyYWRpb0dyb3VwQmlsbFNvdXJjZVwiKVxyXG4gIHJhZGlvR3JvdXBCaWxsU291cmNlOiBGYXJyaXNSYWRpb0dyb3VwQ29tcG9uZW50O1xyXG4gIHJhZGlvR3JvdXBCaWxsU291cmNlRGF0YSA9IFtcclxuICAgIHsgdmFsdWU6IEJpbGxTb3VyY2VUeXBlLkluaGVyaXRQYXJlbnQsIG5hbWU6IHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oJ2NvbXBvbmVudC5zdWJQcm9jZXNzLmluaGVyaXRQYXJlbnQnKSB9LFxyXG4gICAgeyB2YWx1ZTogQmlsbFNvdXJjZVR5cGUuQXV0b0NyZWF0aW9uLCBuYW1lOiB0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKCdjb21wb25lbnQuc3ViUHJvY2Vzcy5hdXRvQ3JlYXRpb24nKSB9LFxyXG4gICAgeyB2YWx1ZTogQmlsbFNvdXJjZVR5cGUuVmFyaWFibGVzRXhwcmVzc2lvbiwgbmFtZTogdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybSgnY29tcG9uZW50LnN1YlByb2Nlc3MudmFyaWFibGVzRXhwcmVzc2lvbicpIH0sXHJcbiAgXTtcclxuXHJcbiAgY29uc3RydWN0b3IoXHJcbiAgICBwcml2YXRlIG5vdGlmeTogTm90aWZ5U2VydmljZSxcclxuICAgIHByaXZhdGUgbW9kYWxTZXJ2aWNlOiBCc01vZGFsU2VydmljZSxcclxuICAgIHByaXZhdGUgbWVzc2FnZTogTWVzc2FnZXJTZXJ2aWNlLFxyXG4gICAgcHJpdmF0ZSB1dGlsOiBQcm9jZXNzRGVVdGlsLFxyXG4gICAgcHJpdmF0ZSBodHRwOiBIdHRwU2VydmljZSxcclxuICAgIHByaXZhdGUgZGVzaWduZXJTdGF0ZTogUHJvY2Vzc0Rlc2lnbmVyVUlTdGF0ZSxcclxuICAgIHByaXZhdGUgZXhwcjogRXhwcmVzc2lvblNlcnZpY2UsXHJcbiAgICBwcml2YXRlIGNmcjogQ29tcG9uZW50RmFjdG9yeVJlc29sdmVyLFxyXG4gICAgcHJpdmF0ZSBpbmo6IEluamVjdG9yLFxyXG4gICAgQE9wdGlvbmFsKCkgcHJpdmF0ZSBjZHI6IENoYW5nZURldGVjdG9yUmVmLFxyXG4gICAgQEluamVjdChMT0NBTEVfSUQpIHByaXZhdGUgbG9jYWxlSWQ6IHN0cmluZyxcclxuICAgIEBJbmplY3QoV0ZfTEFOR19SRVNPVVJDRVMpIHByaXZhdGUgcmVzb3VyY2VzOiBhbnksXHJcbiAgICBAT3B0aW9uYWwoKSBwcml2YXRlIGxvY2FsZVBpcGU6IFdmTG9jYWxlUGlwZVxyXG4gICkge1xyXG4gICAgdGhpcy5sb2NhbGVQaXBlID0gdGhpcy5sb2NhbGVQaXBlIHx8IG5ldyBXZkxvY2FsZVBpcGUobG9jYWxlSWQsIHJlc291cmNlcyk7XHJcbiAgIH1cclxuXHJcbiAgbmdPbkluaXQoKSB7XHJcbiAgfVxyXG5cclxuXHJcbiAgY2xpY2tPSygpIHtcclxuICAgIGlmICh0aGlzLnZhbGlkYXRvcigpKSB7XHJcbiAgICAgIGNvbnN0IG9iamVjdCA9IHsgdmFsdWU6IHRoaXMuY2FsbEFjdGl2aXR5U3ViUHJvY2VzcywgcGFyYW1ldGVyczogbnVsbCB9O1xyXG4gICAgICB0aGlzLnN1Ym1pdE1vZGFsLmVtaXQob2JqZWN0KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGNsaWNrQ2FuY2VsKCkge1xyXG4gICAgdGhpcy5jbG9zZU1vZGFsLmVtaXQoKTtcclxuICB9XHJcblxyXG4gIHByb2Nlc3NDb25maXJtKGFyZ3M6IGFueSkge1xyXG4gICAgaWYgKGFyZ3MpIHtcclxuICAgICAgdGhpcy5jYWxsQWN0aXZpdHlTdWJQcm9jZXNzLmNhbGxlZEVsZW1lbnQgPSBhcmdzLnByb2NEZWZLZXk7XHJcbiAgICAgIHRoaXMuY2FsbEFjdGl2aXR5U3ViUHJvY2Vzcy5jYWxsZWRFbGVtZW50TmFtZSA9IGFyZ3MubmFtZTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByb2Nlc3NUeXBlQ2hhbmdlKHZhbCkge1xyXG4gICAgY29uc29sZS5sb2codmFsKTtcclxuICAgIGlmICh2YWwgPT0gU3ViUHJvY2Vzc1R5cGUuU3BlY2lmaWVkKSB7XHJcbiAgICAgIHRoaXMuY2FsbEFjdGl2aXR5U3ViUHJvY2Vzcy5jYWxsZWRCaXpEZWZLZXkgPSBudWxsO1xyXG4gICAgICB0aGlzLmNhbGxBY3Rpdml0eVN1YlByb2Nlc3MuY2FsbGVkQml6RGVmTmFtZSA9IG51bGw7XHJcbiAgICB9IGVsc2UgaWYgKHZhbCA9PSBTdWJQcm9jZXNzVHlwZS5EeW5hbWljKSB7XHJcbiAgICAgIHRoaXMuY2FsbEFjdGl2aXR5U3ViUHJvY2Vzcy5jYWxsZWRFbGVtZW50ID0gbnVsbDtcclxuICAgICAgdGhpcy5jYWxsQWN0aXZpdHlTdWJQcm9jZXNzLmNhbGxlZEVsZW1lbnROYW1lID0gbnVsbDtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGJpbGxTb3VyY2VDaGFuZ2UodmFsKSB7XHJcbiAgICBjb25zb2xlLmxvZyh2YWwpO1xyXG4gICAgaWYgKHZhbCA9PSBCaWxsU291cmNlVHlwZS5Jbmhlcml0UGFyZW50KSB7XHJcbiAgICAgIHRoaXMuY2FsbEFjdGl2aXR5U3ViUHJvY2Vzcy5pbmhlcml0Qml6RGF0YUlkID0gdHJ1ZTtcclxuICAgICAgdGhpcy5jYWxsQWN0aXZpdHlTdWJQcm9jZXNzLnVzZUF1dG9DcmVhdGlvbkRhdGEgPSBmYWxzZTtcclxuICAgIH0gZWxzZSBpZiAodmFsID09IEJpbGxTb3VyY2VUeXBlLkF1dG9DcmVhdGlvbikge1xyXG4gICAgICB0aGlzLmNhbGxBY3Rpdml0eVN1YlByb2Nlc3MuaW5oZXJpdEJpekRhdGFJZCA9IGZhbHNlO1xyXG4gICAgICB0aGlzLmNhbGxBY3Rpdml0eVN1YlByb2Nlc3MudXNlQXV0b0NyZWF0aW9uRGF0YSA9IHRydWU7XHJcbiAgICB9IGVsc2UgaWYgKHZhbCA9PSBCaWxsU291cmNlVHlwZS5WYXJpYWJsZXNFeHByZXNzaW9uKSB7XHJcbiAgICAgIHRoaXMuY2FsbEFjdGl2aXR5U3ViUHJvY2Vzcy5pbmhlcml0Qml6RGF0YUlkID0gZmFsc2U7XHJcbiAgICAgIHRoaXMuY2FsbEFjdGl2aXR5U3ViUHJvY2Vzcy51c2VBdXRvQ3JlYXRpb25EYXRhID0gZmFsc2U7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBzZWxlY3RQcm9jZXNzKCkge1xyXG4gICAgdGhpcy5vcGVuUHJvY0hlbHAoKS5zdWJzY3JpYmUoXHJcbiAgICAgIChydGU6IElSdFNob3dFbnRpdHkpID0+IHtcclxuICAgICAgICBpZiAocnRlID09IG51bGwpIHtcclxuICAgICAgICAgIHRoaXMubm90aWZ5Lndhcm5pbmcodGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybSgnY29tcG9uZW50LnN1YlByb2Nlc3MucnRlTnVsbCcpKTtcclxuICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5jYWxsQWN0aXZpdHlTdWJQcm9jZXNzLmFpZlByb2Nlc3NDb2RlID0gcnRlLmNvZGU7XHJcbiAgICAgICAgdGhpcy5jYWxsQWN0aXZpdHlTdWJQcm9jZXNzLmFpZlByb2Nlc3NOYW1lID0gcnRlLm5hbWU7XHJcbiAgICAgIH1cclxuICAgICk7XHJcbiAgfVxyXG5cclxuICBjbGVhclByb2Nlc3MoKSB7XHJcbiAgICB0aGlzLmNhbGxBY3Rpdml0eVN1YlByb2Nlc3MuYWlmUHJvY2Vzc0NvZGUgPSBudWxsO1xyXG4gICAgdGhpcy5jYWxsQWN0aXZpdHlTdWJQcm9jZXNzLmFpZlByb2Nlc3NOYW1lID0gbnVsbDtcclxuICB9XHJcblxyXG4gIG9wZW5Qcm9jSGVscCgpIHtcclxuICAgIGNvbnN0IGNtcEYgPSB0aGlzLmNmci5yZXNvbHZlQ29tcG9uZW50RmFjdG9yeShQcm9jZXNzTGlzdEhlbHBDb21wb25lbnQpO1xyXG4gICAgY29uc3QgY21wUiA9IGNtcEYuY3JlYXRlKHRoaXMuaW5qLCBbXSk7XHJcbiAgICBjbXBSLmluc3RhbmNlLmVkaXRvclBhcmFtcyA9IHRoaXMuZWRpdG9yUGFyYW1zO1xyXG4gICAgY29uc3QgbW9kYWxSZWYgPSB0aGlzLm1vZGFsU2VydmljZS5zaG93KGNtcFIsIHtcclxuICAgICAgdGl0bGU6IHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oJ2NvbXBvbmVudC5zdWJQcm9jZXNzLm9yZGVyUHJvY2VzcycpLFxyXG4gICAgICB3aWR0aDogMTI1MCxcclxuICAgICAgaGVpZ2h0OiA1MDAsXHJcbiAgICAgIHJlc2l6YWJsZTogdHJ1ZSxcclxuICAgICAgYnV0dG9uczogW1xyXG4gICAgICAgIHtcclxuICAgICAgICAgIHRleHQ6IHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oJ2NvbXBvbmVudC5zdWJQcm9jZXNzLmNsaWNrT2snKSxcclxuICAgICAgICAgIGNsczogXCJidG4gYnRuLXByaW1hcnlcIixcclxuICAgICAgICAgIGhhbmRsZTogKGV2dCkgPT4ge1xyXG4gICAgICAgICAgICBjbXBSLmluc3RhbmNlLmNsaWNrT2soZXZ0KTtcclxuICAgICAgICAgICAgbW9kYWxSZWYuY2xvc2UoKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIHtcclxuICAgICAgICAgIHRleHQ6IHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oJ2NvbXBvbmVudC5zdWJQcm9jZXNzLmNsaWNrQ2FuY2VsJyksXHJcbiAgICAgICAgICBjbHM6IFwiYnRuIGJ0bi1zZWNvbmRhcnlcIixcclxuICAgICAgICAgIGhhbmRsZTogKGV2dCkgPT4ge1xyXG4gICAgICAgICAgICBjbXBSLmluc3RhbmNlLmNsaWNrQ2FuY2VsKGV2dCk7XHJcbiAgICAgICAgICAgIG1vZGFsUmVmLmNsb3NlKCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICBdLFxyXG4gICAgICBjbG9zZWQ6ICgpID0+IHtcclxuICAgICAgICBtb2RhbFJlZi5kaWFsb2cuZGVzdHJveSgpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICAgIGNtcFIuaW5zdGFuY2UubW9kYWxSZWYgPSBtb2RhbFJlZjtcclxuXHJcbiAgICByZXR1cm4gY21wUi5pbnN0YW5jZS5wcm9jRW1pdHRlci5hc09ic2VydmFibGUoKTtcclxuICB9XHJcblxyXG4gIGNsZWFyUHJvY2Vzc0RlZihhcmdzOiBhbnkpIHtcclxuICAgIHRoaXMuY2FsbEFjdGl2aXR5U3ViUHJvY2Vzcy5jYWxsZWRFbGVtZW50ID0gJyc7XHJcbiAgICB0aGlzLmNhbGxBY3Rpdml0eVN1YlByb2Nlc3MuY2FsbGVkRWxlbWVudE5hbWUgPSAnJztcclxuICB9XHJcblxyXG4gIGZsb3dGb3JtQ29uZmlybShhcmdzOiBhbnkpIHtcclxuICAgIGlmIChhcmdzKSB7XHJcbiAgICAgIHRoaXMuY2FsbEFjdGl2aXR5U3ViUHJvY2Vzcy5jYWxsZWRCaXpEZWZLZXkgPSBhcmdzLmlkO1xyXG4gICAgICB0aGlzLmNhbGxBY3Rpdml0eVN1YlByb2Nlc3MuY2FsbGVkQml6RGVmTmFtZSA9IGFyZ3MubmFtZTtcclxuICAgIH1cclxuICB9XHJcbiAgY2xlYXJGbG93Rm9ybShhcmdzOiBhbnkpIHtcclxuICAgIHRoaXMuY2FsbEFjdGl2aXR5U3ViUHJvY2Vzcy5jYWxsZWRCaXpEZWZLZXkgPSAnJztcclxuICAgIHRoaXMuY2FsbEFjdGl2aXR5U3ViUHJvY2Vzcy5jYWxsZWRCaXpEZWZOYW1lID0gJyc7XHJcbiAgfVxyXG5cclxuICBzZXRCaXpEYXRhSWQoKSB7XHJcbiAgICB0aGlzLnNob3dFeHBySGVscCgpO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBzaG93RXhwckhlbHAoKSB7XHJcbiAgICBsZXQgY29udGV4dCA9IG5ldyBBcnJheTxWYXJFbnRpdHk+KCk7XHJcbiAgICAvLyBpZih0aGlzLmV4cHIuZXhwckVudGl0eS5jb250ZXh0RW50aXRpZXMuZmluZCh4ID0+IHgua2V5ID09PSAnQ3VycmVudExhbmd1YWdlJykpIHtcclxuICAgIC8vICAgY29udGV4dC5wdXNoKHRoaXMuZXhwci5leHByRW50aXR5LmNvbnRleHRFbnRpdGllcy5maW5kKHggPT4geC5rZXkgPT09ICdDdXJyZW50TGFuZ3VhZ2UnKSk7XHJcbiAgICAvLyB9XHJcbiAgICAvLyB0aGlzLmV4cHIuY2xlYXJDb250ZXh0KCk7XHJcbiAgICBpZiAodGhpcy5kZXNpZ25lclN0YXRlLnNjaGVtYXMubGVuZ3RoID4gMCkge1xyXG4gICAgICBmb3IgKGNvbnN0IHNjaGVtYSBvZiB0aGlzLmRlc2lnbmVyU3RhdGUuc2NoZW1hcykge1xyXG4gICAgICAgIHRoaXMuZXhwci5hZGRTY2hlbWEoJ1NjaGVtYScsIHNjaGVtYSk7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKHRoaXMuZGVzaWduZXJTdGF0ZS5zY2hlbWFzWzBdLmVudGl0eVR5cGVzICYmIHRoaXMuZGVzaWduZXJTdGF0ZS5zY2hlbWFzWzBdLmVudGl0eVR5cGVzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICBjb25zdCBlbnRpdHlUeXBlID0gdGhpcy5kZXNpZ25lclN0YXRlLnNjaGVtYXNbMF0uZW50aXR5VHlwZXNbMF07XHJcbiAgICAgICAgdGhpcy5leHByLmFkZEluamVjdGVkRW50aXR5KGVudGl0eVR5cGUubmFtZSwgJ1NjaGVtYScsXHJcbiAgICAgICAgICBlbnRpdHlUeXBlLm5hbWUsIEluamVjdGVkVHlwZS5FbnRpdHlUeXBlKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgY29udGV4dCA9IHRoaXMuZGVzaWduZXJTdGF0ZS5hZGRDb250ZXh0KGNvbnRleHQpO1xyXG4gICAgaWYgKHRoaXMuZGVzaWduZXJTdGF0ZS5zdWJBY3Rpdml0eUNvbnRleHQubGVuZ3RoID4gMCkge1xyXG4gICAgICBmb3IgKGNvbnN0IHZhcmlhYmxlIG9mIHRoaXMuZGVzaWduZXJTdGF0ZS5zdWJBY3Rpdml0eUNvbnRleHQpIHtcclxuICAgICAgICBjb250ZXh0LnB1c2godmFyaWFibGUpO1xyXG4gICAgICAgIC8vIHRoaXMuZXhwci5hZGRDb250ZXh0KHZhcmlhYmxlKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgaWYgKGNvbnRleHQubGVuZ3RoID4gMCkge1xyXG4gICAgICBmb3IgKGNvbnN0IHYgb2YgY29udGV4dCkge1xyXG4gICAgICAgIHRoaXMuZXhwci5hZGRDb250ZXh0KHYpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICB0aGlzLmV4cHIuYWRkRXhwcmVzc2lvblRleHQodGhpcy5jYWxsQWN0aXZpdHlTdWJQcm9jZXNzLmJpekRhdGFJZCk7XHJcbiAgICB0aGlzLmV4cHIuYnVpbGRFeHByZXNzaW9uKCkudGhlbigoZXhwcmVzc2lvbmluZm86IHN0cmluZykgPT4ge1xyXG4gICAgICB0aGlzLmNhbGxBY3Rpdml0eVN1YlByb2Nlc3MuYml6RGF0YUlkID0gZXhwcmVzc2lvbmluZm87XHJcbiAgICAgIC8v54K55Ye756Gu5a6a5ZCO77yM5Y676Zmk6KGo6L6+5byP6YeM6Z2i55qE5paw5aKe55qE5LiK5LiL5paH5Y+Y6YePXHJcbiAgICAgIGlmKGNvbnRleHQubGVuZ3RoID4gMCkge1xyXG4gICAgICAgIHRoaXMuZXhwci5leHByRW50aXR5LmNvbnRleHRFbnRpdGllcyA9IHRoaXMuZXhwci5leHByRW50aXR5LmNvbnRleHRFbnRpdGllcy5maWx0ZXIoeCA9PiAhY29udGV4dC5zb21lKHkgPT4geS5rZXkgPT09IHgua2V5KSk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgdmFsdWVDaGFuZ2UoYm9vbDogYm9vbGVhbikge1xyXG4gICAgaWYgKGJvb2wpIHtcclxuICAgICAgdGhpcy5jYWxsQWN0aXZpdHlTdWJQcm9jZXNzLmJpekRhdGFJZCA9IG51bGw7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHZhbGlkYXRvcigpOiBib29sZWFuIHtcclxuICAgIGlmICghdGhpcy5jYWxsQWN0aXZpdHlTdWJQcm9jZXNzLmluaGVyaXRCaXpEYXRhSWQgJiYgIXRoaXMuY2FsbEFjdGl2aXR5U3ViUHJvY2Vzcy51c2VBdXRvQ3JlYXRpb25EYXRhICYmICF0aGlzLmNhbGxBY3Rpdml0eVN1YlByb2Nlc3MuYml6RGF0YUlkKSB7XHJcbiAgICAgIHRoaXMubWVzc2FnZS53YXJuaW5nKHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oJ2NvbXBvbmVudC5zdWJQcm9jZXNzLmluaGVyaXRCaXpEYXRhSWQnKSk7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICAgIHJldHVybiB0cnVlO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBnZXRQcm9jZXNzRGVmS2V5KGtleTogc3RyaW5nKSB7XHJcbiAgICBsZXQgdXJsID0gdGhpcy51dGlsLmdldFByb2Nlc3NEZWZpbml0aW9uV2ViQXBpKCk7XHJcbiAgICBpZiAoa2V5KSB7XHJcbiAgICAgIHVybCArPSBgL3Byb2NEZWZLZXkvJHtrZXl9YDtcclxuICAgICAgdGhpcy5odHRwLmdldCh1cmwpLnN1YnNjcmliZSgocmU6IGFueSkgPT4ge1xyXG4gICAgICAgIHRoaXMuY2FsbEFjdGl2aXR5U3ViUHJvY2Vzcy5jYWxsZWRFbGVtZW50TmFtZSA9IHJlLm5hbWU7XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH1cclxuICBwcml2YXRlIGdldEZsb3dGb3JtKGlkOiBzdHJpbmcpIHtcclxuICAgIGxldCB1cmwgPSB0aGlzLnV0aWwuZ2V0Rmxvd0Zvcm1XZWJBcGkoKTtcclxuICAgIGlmIChpZCkge1xyXG4gICAgICB1cmwgKz0gYC8ke2lkfWA7XHJcbiAgICAgIHRoaXMuaHR0cC5nZXQodXJsKS5zdWJzY3JpYmUoKHJlOiBhbnkpID0+IHtcclxuICAgICAgICB0aGlzLmNhbGxBY3Rpdml0eVN1YlByb2Nlc3MuY2FsbGVkQml6RGVmTmFtZSA9IHJlLm5hbWU7XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgZ2V0QWlmUHJvY2Vzc05hbWUoY29kZTogc3RyaW5nKSB7XHJcbiAgICBpZiAoY29kZSAhPSBudWxsICYmIGNvZGUgIT0gXCJcIikge1xyXG4gICAgICB0aGlzLmh0dHAucmVxdWVzdChcIkdFVFwiLCBgL2FwaS9ydW50aW1lL2FpZi92MS4wL3J0YmlsbGNyZWF0aW9ucHJvY2Vzcy9nZXRuYW1lLyR7Y29kZX1gLCB7IHJlc3BvbnNlVHlwZTogJ3RleHQnIH0pLnN1YnNjcmliZShcclxuICAgICAgICAocmVzOiBhbnkpID0+IHtcclxuICAgICAgICAgIHRoaXMuY2FsbEFjdGl2aXR5U3ViUHJvY2Vzcy5haWZQcm9jZXNzTmFtZSA9IHJlcztcclxuICAgICAgICB9LFxyXG4gICAgICAgIChlcnIpID0+IHtcclxuICAgICAgICAgIGlmIChlcnIuZXJyb3IgJiYgdHlwZW9mIGVyci5lcnJvciA9PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgICAgIGVyci5lcnJvciA9IEpTT04ucGFyc2UoZXJyLmVycm9yKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICAvL3RvZG8g56Gu5a6a5byC5bi457uT5p6ELCDnm67liY3ph4fnlKjlhbzlrrnlj5blgLzmlrnlvI9cclxuICAgICAgICAgICAgdGhpcy5tZXNzYWdlLmVycm9yKGVyci5lcnJvciA9PSBudWxsID8gZXJyLm1lc3NhZ2UgOiAoZXJyLmVycm9yLk1lc3NhZ2UgfHwgZXJyLmVycm9yLm1lc3NhZ2UgfHwgZXJyLm1lc3NhZ2UpKTtcclxuICAgICAgICAgIH0sIDMwMCk7XHJcbiAgICAgICAgICB0aHJvdyBlcnI7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcblxyXG5cclxuZXhwb3J0IGNsYXNzIENhbGxBY3Rpdml0eVN1YlByb2Nlc3MyQ29udmVydGVyIGltcGxlbWVudHMgVHlwZUNvbnZlcnRlciB7XHJcbiAgY29uc3RydWN0b3IoXHJcbiAgICBwcml2YXRlIGxvY2FsZVBpcGU6IFdmTG9jYWxlUGlwZVxyXG4gICkgeyB9XHJcblxyXG4gIGNvbnZlcnRUbyhkYXRhOiBhbnkpOiBzdHJpbmcge1xyXG4gICAgaWYgKGRhdGEgJiYgKGRhdGEuY2FsbGVkQml6RGVmS2V5IHx8IGRhdGEuY2FsbGVkRWxlbWVudCkpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oXCJjb21wb25lbnQuc3ViUHJvY2Vzcy5zZXRcIik7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybShcImNvbXBvbmVudC5zdWJQcm9jZXNzLm5vdFNldFwiKTtcclxuICB9XHJcbn1cclxuIl19