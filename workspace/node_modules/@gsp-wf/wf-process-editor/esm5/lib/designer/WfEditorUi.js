/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { EditorUi, ActionKeys, ToolboxGroup, ToolboxItem } from "@edp-pmf/grapheditor";
import { WfGraph } from "./WfGraph";
import { ProcessHeader, UserActivity, OperationActivity } from "@gsp-wf/wf-process-model";
import { WfSidebar } from "./WfSidebar";
import { WfConstants } from "./WfConstants";
import { mxEvent, mxResources } from "@edp-pmf/mxgraph-ts";
import { UserActivityPropertyKeys } from "./wf-cell/property-keys/UserActivityPropertyKeys";
import { WfExclusiveGatewayCell } from "./wf-cell/WfExclusiveGatewayCell";
import { AifCreationBillActivityCell } from "./wf-cell/AifCreationBillActivityCell";
import { AutoActivityCell } from "./wf-cell/AutoActivityCell";
import { CallActivitySubProcessCell } from "./wf-cell/CallActivitySubProcessCell";
import { IntermediateCatchEventImplCell } from "./wf-cell/IntermediateCatchEventImplCell";
import { MessageActivityCell } from "./wf-cell/MessageActivityCell";
import { NotifyActivityCell } from "./wf-cell/NotifyActivityCell";
import { OperationActivityCell } from "./wf-cell/OperationActivityCell";
import { StartActivityCell } from "./wf-cell/StartActivityCell";
import { UserActivityCell } from "./wf-cell/UserActivityCell";
import { WfParallelGatewayCell } from "./wf-cell/WfParallelGatewayCell";
import { WfEndEventCell } from "./wf-cell/WfEndEventCell";
import { WfInclusiveGatewayCell } from "./wf-cell/WfInclusiveGatewayCell";
import { BatchSetPropertiesComponent } from "../views/batch-set-properties/batch-set-properties.component";
var WfEditorUi = /** @class */ (function (_super) {
    tslib_1.__extends(WfEditorUi, _super);
    function WfEditorUi(time, action, container, injector, modalService, resolver, eventSource, importLinks) {
        if (importLinks === void 0) { importLinks = true; }
        var _this = _super.call(this, container, eventSource, importLinks) || this;
        _this.injector = injector;
        _this.modalService = modalService;
        _this.resolver = resolver;
        _this.generalConfig = {
            enableTransfer: true,
            enableNotify: false,
            enableAddSignBehind: false,
            enableAddSignFront: false,
        };
        /** @type {?} */
        var rootPath = '';
        try {
            rootPath = ((/** @type {?} */ (window))).gspframeworkService.common.getBasePath.get();
        }
        catch (error) {
        }
        mxResources.add(rootPath + "/platform/runtime/common/web/@gsp-wf/wf-process-editor/resources/wf-process-editor");
        _this.showToolbar = false;
        _this.time = time;
        _this.action = action;
        return _this;
    }
    /**
     * @return {?}
     */
    WfEditorUi.prototype.createActions = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var actions = _super.prototype.createActions.call(this);
        // 只有设计时编辑状态下才启用删除动作
        if (!(this.action === 'edit' && this.time !== 'rt')) {
            /** @type {?} */
            var deleteAction = actions.getAction(ActionKeys.pmf_delete);
            deleteAction.isEnabled = (/**
             * @return {?}
             */
            function () { return false; });
        }
        return actions;
    };
    /**
     * @return {?}
     */
    WfEditorUi.prototype.createToolbox = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var toolbox = _super.prototype.createToolbox.call(this);
        /** @type {?} */
        var g1 = new ToolboxGroup();
        g1.name = mxResources.get('basicElements');
        g1.items.push(new ToolboxItem(StartActivityCell.CLR_TYPE_ID), new ToolboxItem(WfExclusiveGatewayCell.CLR_TYPE_ID), new ToolboxItem(WfParallelGatewayCell.CLR_TYPE_ID), 
        // 暂时隐藏包容网关
        new ToolboxItem(WfInclusiveGatewayCell.CLR_TYPE_ID), new ToolboxItem(UserActivityCell.CLR_TYPE_ID), new ToolboxItem(OperationActivityCell.CLR_TYPE_ID), new ToolboxItem(NotifyActivityCell.CLR_TYPE_ID), new ToolboxItem(CallActivitySubProcessCell.CLR_TYPE_ID), new ToolboxItem(AutoActivityCell.CLR_TYPE_ID), new ToolboxItem(IntermediateCatchEventImplCell.CLR_TYPE_ID), new ToolboxItem(MessageActivityCell.CLR_TYPE_ID), new ToolboxItem(AifCreationBillActivityCell.CLR_TYPE_ID), new ToolboxItem(WfEndEventCell.CLR_TYPE_ID));
        toolbox.groups = [g1];
        return toolbox;
    };
    /**
     * @return {?}
     */
    WfEditorUi.prototype.createGraphInstance = /**
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var graph = new WfGraph(this, this.diagramContainer);
        if (this.action === 'view' || this.time === 'rt' || this.action === 'assignView') {
            graph.setCellsLocked(true);
        }
        else {
            graph.setDropEnabled(true);
            graph.setConnectable(true);
        }
        //TODO：右键查看只显示在审批节点上
        graph.popupMenuHandler.autoExpand = true;
        graph.popupMenuHandler.factoryMethod = (/**
         * @param {?} menu
         * @param {?} cell
         * @param {?} evt
         * @return {?}
         */
        function (menu, cell, evt) {
            /** @type {?} */
            var actList = graph.getChildCells(graph.getDefaultParent());
            if (cell != null
                && cell.clrTypeId.indexOf('wf.UserActivity') > -1
                && actList.findIndex((/**
                 * @param {?} a
                 * @return {?}
                 */
                function (a) { return a.id === cell.getId(); })) > -1) {
                menu.addItem('批量复制属性', null, (/**
                 * @return {?}
                 */
                function () {
                    /** @type {?} */
                    var compFactory = _this.resolver.resolveComponentFactory(BatchSetPropertiesComponent);
                    /** @type {?} */
                    var compRef = compFactory.create(_this.injector);
                    compRef.instance.activityModel = cell.flowElement;
                    /** @type {?} */
                    var modalConfig = {
                        title: '批量复制属性',
                        width: 512,
                        height: 465,
                        showButtons: true,
                        buttons: compRef.instance.footer
                    };
                    /** @type {?} */
                    var dialog = _this.modalService.show(compRef, modalConfig);
                    compRef.instance.cancel.subscribe((/**
                     * @param {?} $event
                     * @return {?}
                     */
                    function ($event) { return dialog.close(); }));
                    compRef.instance.submit.subscribe((/**
                     * @param {?} data
                     * @return {?}
                     */
                    function (data) {
                        dialog.close();
                    }));
                }));
            }
        });
        return graph;
    };
    /**
     * @return {?}
     */
    WfEditorUi.prototype.createSidebar = /**
     * @return {?}
     */
    function () {
        return new WfSidebar(this, this.sidebarContainer);
    };
    /**
     * @return {?}
     */
    WfEditorUi.prototype.show = /**
     * @return {?}
     */
    function () {
        var _this = this;
        _super.prototype.show.call(this);
        if (this.action === 'view' || this.action === 'assignView') {
            /** @type {?} */
            var span = this.createSpan('');
            span.style.fontSize = '14px';
            span.style.color = 'white';
            span.style.borderRadius = '20px';
            span.style.padding = '4px 20px';
            span.style.background = 'rgb(199, 194, 187)';
            /** @type {?} */
            var v = document.createTextNode(mxResources.get('readOnly'));
            span.appendChild(v);
            /** @type {?} */
            var d = this.createDiv('');
            d.style.position = 'absolute';
            d.style.top = '10px';
            d.style.right = '10px';
            d.style.zIndex = "2";
            d.appendChild(span);
            this.container.appendChild(d);
        }
        /** @type {?} */
        var buttonIn = document.createElement('a');
        buttonIn.setAttribute('href', 'javascript:void(0);');
        /** @type {?} */
        var buttonInImg = document.createElement('img');
        buttonIn.style.marginRight = '10px';
        buttonInImg.src = WfConstants.IMAGE_PATH + '/zoomIn.svg';
        buttonInImg.style.display = "inline-block";
        buttonInImg.style.verticalAlign = "middle";
        buttonIn.appendChild(buttonInImg);
        mxEvent.addListener(buttonIn, 'click', (/**
         * @param {?} evt
         * @return {?}
         */
        function (evt) {
            _this.actions.getAction(ActionKeys.pmf_zoomIn).execute(evt);
        }));
        /** @type {?} */
        var buttonOut = document.createElement('a');
        buttonOut.setAttribute('href', 'javascript:void(0);');
        /** @type {?} */
        var buttonOutImg = document.createElement('img');
        buttonOutImg.src = WfConstants.IMAGE_PATH + '/zoomOut.svg';
        buttonOutImg.style.display = "inline-block";
        buttonOutImg.style.verticalAlign = "middle";
        buttonOut.appendChild(buttonOutImg);
        mxEvent.addListener(buttonOut, 'click', (/**
         * @param {?} evt
         * @return {?}
         */
        function (evt) {
            _this.actions.getAction(ActionKeys.pmf_zoomOut).execute(evt);
        }));
        /** @type {?} */
        var zoomBar = this.createDiv('zoomBar');
        zoomBar.style.position = 'absolute';
        zoomBar.style.zIndex = "2";
        /** @type {?} */
        var t = 10;
        if (this.showMenubar) {
            t += this.menubarHeight;
        }
        if (this.showToolbar) {
            t += this.toolbarHeight;
        }
        zoomBar.style.top = t + 'px';
        zoomBar.style.left = (this.showSidebar ? this.sidebarSplitPosition + this.sidebarSplitSize : 0) + 10 + "px";
        zoomBar.appendChild(buttonIn);
        zoomBar.appendChild(buttonOut);
        this.container.appendChild(zoomBar);
        this.zoomBar = zoomBar;
    };
    /**
     * @param {?} value
     * @return {?}
     */
    WfEditorUi.prototype.sidebarSplitOnChange = /**
     * @param {?} value
     * @return {?}
     */
    function (value) {
        _super.prototype.sidebarSplitOnChange.call(this, value);
        // 分割条移动后更新缩放条位置
        if (this.zoomBar) {
            this.zoomBar.style.left = (this.showSidebar ? this.sidebarSplitPosition + this.sidebarSplitSize : 0) + 10 + "px";
        }
    };
    /**
     * 创建带指定样式类的span
     * @param classname
     * @returns
     */
    /**
     * 创建带指定样式类的span
     * @param {?} classname
     * @return {?}
     */
    WfEditorUi.prototype.createSpan = /**
     * 创建带指定样式类的span
     * @param {?} classname
     * @return {?}
     */
    function (classname) {
        /** @type {?} */
        var elt = document.createElement('span');
        elt.className = classname;
        return elt;
    };
    /**
     * 加载业务活动
     * @param bizActivities
     */
    /**
     * 加载业务活动
     * @param {?} bizActivities
     * @return {?}
     */
    WfEditorUi.prototype.loadBizActivities = /**
     * 加载业务活动
     * @param {?} bizActivities
     * @return {?}
     */
    function (bizActivities) {
        this.sidebar && this.sidebar.addBizActPalette(bizActivities);
    };
    /**
     * 批量复制属性
     * @param obj
     */
    /**
     * 批量复制属性
     * @param {?} obj
     * @return {?}
     */
    WfEditorUi.prototype.batchCopyProperty = /**
     * 批量复制属性
     * @param {?} obj
     * @return {?}
     */
    function (obj) {
        var e_1, _a;
        // 放弃不需要的参数
        /** @type {?} */
        var ids = obj.value.targetNodeID;
        obj.propertyValue = obj.value.messageNotice;
        // todo：多个活动具有同名属性时，如何更合理定义PropertyKey？
        obj.propertyID = UserActivityPropertyKeys.messageNotice;
        try {
            for (var ids_1 = tslib_1.__values(ids), ids_1_1 = ids_1.next(); !ids_1_1.done; ids_1_1 = ids_1.next()) {
                var id = ids_1_1.value;
                /** @type {?} */
                var cell = this.graph.getCellByFlowElementId(id);
                if (cell) {
                    cell.updateProps(obj);
                    this.graph.refresh();
                }
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (ids_1_1 && !ids_1_1.done && (_a = ids_1.return)) _a.call(ids_1);
            }
            finally { if (e_1) throw e_1.error; }
        }
    };
    /**
   * 批量设置属性
   * @param obj
   */
    /**
     * 批量设置属性
     * @param {?} obj
     * @return {?}
     */
    WfEditorUi.prototype.batchSetProperty = /**
     * 批量设置属性
     * @param {?} obj
     * @return {?}
     */
    function (obj) {
        var e_2, _a, e_3, _b, e_4, _c, e_5, _d, e_6, _e, e_7, _f;
        try {
            for (var obj_1 = tslib_1.__values(obj), obj_1_1 = obj_1.next(); !obj_1_1.done; obj_1_1 = obj_1.next()) {
                var v = obj_1_1.value;
                switch (v.type) {
                    case 'addSignfront':
                        /** @type {?} */
                        var afId = v.actis;
                        obj.propertyValue = v.config;
                        obj.propertyID = UserActivityPropertyKeys.AddSignFrontAble;
                        try {
                            for (var afId_1 = tslib_1.__values(afId), afId_1_1 = afId_1.next(); !afId_1_1.done; afId_1_1 = afId_1.next()) {
                                var id = afId_1_1.value;
                                /** @type {?} */
                                var cell = this.graph.getCellByFlowElementId(id.Id);
                                if (cell) {
                                    cell.updateProps(obj);
                                    this.graph.refresh();
                                }
                            }
                        }
                        catch (e_3_1) { e_3 = { error: e_3_1 }; }
                        finally {
                            try {
                                if (afId_1_1 && !afId_1_1.done && (_b = afId_1.return)) _b.call(afId_1);
                            }
                            finally { if (e_3) throw e_3.error; }
                        }
                        break;
                    case 'addSignBehind':
                        /** @type {?} */
                        var abId = v.actis;
                        obj.propertyValue = v.config;
                        obj.propertyID = UserActivityPropertyKeys.AddSignBehindAble;
                        try {
                            for (var abId_1 = tslib_1.__values(abId), abId_1_1 = abId_1.next(); !abId_1_1.done; abId_1_1 = abId_1.next()) {
                                var id = abId_1_1.value;
                                /** @type {?} */
                                var cell = this.graph.getCellByFlowElementId(id.Id);
                                if (cell) {
                                    cell.updateProps(obj);
                                    this.graph.refresh();
                                }
                            }
                        }
                        catch (e_4_1) { e_4 = { error: e_4_1 }; }
                        finally {
                            try {
                                if (abId_1_1 && !abId_1_1.done && (_c = abId_1.return)) _c.call(abId_1);
                            }
                            finally { if (e_4) throw e_4.error; }
                        }
                        break;
                    case 'transfer':
                        /** @type {?} */
                        var trId = v.actis;
                        obj.propertyValue = v.config;
                        obj.propertyID = UserActivityPropertyKeys.transferScope;
                        try {
                            for (var trId_1 = tslib_1.__values(trId), trId_1_1 = trId_1.next(); !trId_1_1.done; trId_1_1 = trId_1.next()) {
                                var id = trId_1_1.value;
                                /** @type {?} */
                                var cell = this.graph.getCellByFlowElementId(id.Id);
                                if (cell) {
                                    cell.updateProps(obj);
                                    this.graph.refresh();
                                }
                            }
                        }
                        catch (e_5_1) { e_5 = { error: e_5_1 }; }
                        finally {
                            try {
                                if (trId_1_1 && !trId_1_1.done && (_d = trId_1.return)) _d.call(trId_1);
                            }
                            finally { if (e_5) throw e_5.error; }
                        }
                        break;
                    case 'notify':
                        /** @type {?} */
                        var ntId = v.actis;
                        obj.propertyValue = v.config;
                        obj.propertyID = UserActivityPropertyKeys.NotifyAble;
                        try {
                            for (var ntId_1 = tslib_1.__values(ntId), ntId_1_1 = ntId_1.next(); !ntId_1_1.done; ntId_1_1 = ntId_1.next()) {
                                var id = ntId_1_1.value;
                                /** @type {?} */
                                var cell = this.graph.getCellByFlowElementId(id.Id);
                                if (cell) {
                                    cell.updateProps(obj);
                                    this.graph.refresh();
                                }
                            }
                        }
                        catch (e_6_1) { e_6 = { error: e_6_1 }; }
                        finally {
                            try {
                                if (ntId_1_1 && !ntId_1_1.done && (_e = ntId_1.return)) _e.call(ntId_1);
                            }
                            finally { if (e_6) throw e_6.error; }
                        }
                        break;
                    // 驳回规则需要特殊处理：子流程和信号的赋简版
                    case 'backWardRule':
                        /** @type {?} */
                        var bwId = v.actis;
                        obj.propertyValue = v.config;
                        obj.propertyID = UserActivityPropertyKeys.BackWardRule;
                        try {
                            for (var bwId_1 = tslib_1.__values(bwId), bwId_1_1 = bwId_1.next(); !bwId_1_1.done; bwId_1_1 = bwId_1.next()) {
                                var id = bwId_1_1.value;
                                /** @type {?} */
                                var cell = this.graph.getCellByFlowElementId(id.Id);
                                if (cell) {
                                    cell.updateProps(obj);
                                    this.graph.refresh();
                                }
                            }
                        }
                        catch (e_7_1) { e_7 = { error: e_7_1 }; }
                        finally {
                            try {
                                if (bwId_1_1 && !bwId_1_1.done && (_f = bwId_1.return)) _f.call(bwId_1);
                            }
                            finally { if (e_7) throw e_7.error; }
                        }
                        break;
                }
            }
        }
        catch (e_2_1) { e_2 = { error: e_2_1 }; }
        finally {
            try {
                if (obj_1_1 && !obj_1_1.done && (_a = obj_1.return)) _a.call(obj_1);
            }
            finally { if (e_2) throw e_2.error; }
        }
    };
    /**
     * 创建新流程
     * @param newProcInfo
     * @param bizCmps
     */
    /**
     * 创建新流程
     * @param {?} newProcInfo
     * @param {?=} bizCmps
     * @return {?}
     */
    WfEditorUi.prototype.createBpmnModel = /**
     * 创建新流程
     * @param {?} newProcInfo
     * @param {?=} bizCmps
     * @return {?}
     */
    function (newProcInfo, bizCmps) {
        this.graph.createBpmnModelWithProcInfo(newProcInfo, bizCmps);
    };
    /**
     * 打开流程
     * @param content
     */
    /**
     * 打开流程
     * @param {?} content
     * @return {?}
     */
    WfEditorUi.prototype.openBpmnModel = /**
     * 打开流程
     * @param {?} content
     * @return {?}
     */
    function (content) {
        this.graph.loadBpmnModel(content);
    };
    /**
     * 获取属性配置，刷新属性框
     * @param obj
     * @returns
     */
    /**
     * 获取属性配置，刷新属性框
     * @param {?} obj
     * @return {?}
     */
    WfEditorUi.prototype.refreshProperty = /**
     * 获取属性配置，刷新属性框
     * @param {?} obj
     * @return {?}
     */
    function (obj) {
        /** @type {?} */
        var cell = this.graph.getCellByFlowElementId(obj.Id);
        return this.getFarrisPropConfig([cell]);
    };
    /**
     * 获取用户活动
     * @returns
     */
    /**
     * 获取用户活动
     * @return {?}
     */
    WfEditorUi.prototype.getActivities = /**
     * 获取用户活动
     * @return {?}
     */
    function () {
        /** @type {?} */
        var list = [];
        /** @type {?} */
        var bpmnModel = this.graph.bpmnModel;
        /** @type {?} */
        var flowDict = bpmnModel.DefaultProcess.GetFlowElements();
        Object.keys(flowDict).forEach((/**
         * @param {?} key
         * @return {?}
         */
        function (key) {
            /** @type {?} */
            var flowElt = flowDict[key];
            if (flowElt.ClrTypeID === UserActivity.Clr_Type_ID
                || flowElt.ClrTypeID === OperationActivity.Clr_Type_ID) {
                list.push(flowElt);
            }
        }));
        return list;
    };
    /**
     * 获取结束事件
     * @returns
     */
    /**
     * 获取结束事件
     * @return {?}
     */
    WfEditorUi.prototype.getEndEvents = /**
     * 获取结束事件
     * @return {?}
     */
    function () {
        /** @type {?} */
        var userActArray = [];
        /** @type {?} */
        var bpmnModel = this.graph.bpmnModel;
        /** @type {?} */
        var flowDict = bpmnModel.DefaultProcess.GetFlowElements();
        Object.keys(flowDict).forEach((/**
         * @param {?} key
         * @return {?}
         */
        function (key) {
            /** @type {?} */
            var flowElt = flowDict[key];
            if (flowElt.ClrTypeID === 'bpmn.EndEvent' || flowElt.ClrTypeID === UserActivity.Clr_Type_ID
                || flowElt.ClrTypeID === OperationActivity.Clr_Type_ID) {
                userActArray.push(flowElt);
            }
        }));
        return userActArray;
    };
    /**
     * 获取知会事件
     * @returns
     */
    /**
     * 获取知会事件
     * @return {?}
     */
    WfEditorUi.prototype.getNotifyEvents = /**
     * 获取知会事件
     * @return {?}
     */
    function () {
        /** @type {?} */
        var list = [];
        /** @type {?} */
        var bpmnModel = this.graph.bpmnModel;
        /** @type {?} */
        var flowDict = bpmnModel.DefaultProcess.GetFlowElements();
        Object.keys(flowDict).forEach((/**
         * @param {?} key
         * @return {?}
         */
        function (key) {
            /** @type {?} */
            var flowElt = flowDict[key];
            if (flowElt.ClrTypeID === 'wf.NotifyActivity') {
                list.push(flowElt);
            }
        }));
        return list;
    };
    /**
     * 获取消息事件
     * @returns
     */
    /**
     * 获取消息事件
     * @return {?}
     */
    WfEditorUi.prototype.getMessageEvents = /**
     * 获取消息事件
     * @return {?}
     */
    function () {
        /** @type {?} */
        var list = [];
        /** @type {?} */
        var bpmnModel = this.graph.bpmnModel;
        /** @type {?} */
        var flowDict = bpmnModel.DefaultProcess.GetFlowElements();
        Object.keys(flowDict).forEach((/**
         * @param {?} key
         * @return {?}
         */
        function (key) {
            /** @type {?} */
            var flowElt = flowDict[key];
            if (flowElt.ClrTypeID === 'bpmn.MessageEvent') {
                list.push(flowElt);
            }
        }));
        return list;
    };
    /**
     * 获取子流程和信号捕获节点
     * @returns
     */
    /**
     * 获取子流程和信号捕获节点
     * @return {?}
     */
    WfEditorUi.prototype.getSubAndCatchEvents = /**
     * 获取子流程和信号捕获节点
     * @return {?}
     */
    function () {
        /** @type {?} */
        var list = [];
        /** @type {?} */
        var bpmnModel = this.graph.bpmnModel;
        /** @type {?} */
        var flowDict = bpmnModel.DefaultProcess.GetFlowElements();
        Object.keys(flowDict).forEach((/**
         * @param {?} key
         * @return {?}
         */
        function (key) {
            /** @type {?} */
            var flowElt = flowDict[key];
            if (flowElt.ClrTypeID === 'wf.CallActivitySubProcess' ||
                flowElt.ClrTypeID === 'wf.IntermediateCatchEventImpl') {
                list.push(flowElt);
            }
        }));
        return list;
    };
    /**
     * 获取启动方式
     * @returns
     */
    /**
     * 获取启动方式
     * @return {?}
     */
    WfEditorUi.prototype.getStartMode = /**
     * 获取启动方式
     * @return {?}
     */
    function () {
        var e_8, _a;
        /** @type {?} */
        var startMode = null;
        /** @type {?} */
        var bpmnModel = this.graph.bpmnModel;
        /** @type {?} */
        var extendElements = bpmnModel.DefaultProcess.GetExtensionElements();
        if (extendElements.length > 0) {
            try {
                for (var extendElements_1 = tslib_1.__values(extendElements), extendElements_1_1 = extendElements_1.next(); !extendElements_1_1.done; extendElements_1_1 = extendElements_1.next()) {
                    var e = extendElements_1_1.value;
                    if (e instanceof ProcessHeader) {
                        startMode = e.startMode;
                    }
                }
            }
            catch (e_8_1) { e_8 = { error: e_8_1 }; }
            finally {
                try {
                    if (extendElements_1_1 && !extendElements_1_1.done && (_a = extendElements_1.return)) _a.call(extendElements_1);
                }
                finally { if (e_8) throw e_8.error; }
            }
        }
        return startMode;
    };
    return WfEditorUi;
}(EditorUi));
export { WfEditorUi };
if (false) {
    /** @type {?} */
    WfEditorUi.prototype.editor;
    /** @type {?} */
    WfEditorUi.prototype.graph;
    /** @type {?} */
    WfEditorUi.prototype.sidebar;
    /** @type {?} */
    WfEditorUi.prototype.time;
    /** @type {?} */
    WfEditorUi.prototype.bizCategoryId;
    /** @type {?} */
    WfEditorUi.prototype.action;
    /** @type {?} */
    WfEditorUi.prototype.mode;
    /** @type {?} */
    WfEditorUi.prototype.scene;
    /** @type {?} */
    WfEditorUi.prototype.procType;
    /** @type {?} */
    WfEditorUi.prototype.procExtProps;
    /** @type {?} */
    WfEditorUi.prototype.formFormats;
    /** @type {?} */
    WfEditorUi.prototype.generalConfig;
    /** @type {?} */
    WfEditorUi.prototype.zoomBar;
    /**
     * @type {?}
     * @private
     */
    WfEditorUi.prototype.injector;
    /**
     * @type {?}
     * @private
     */
    WfEditorUi.prototype.modalService;
    /**
     * @type {?}
     * @private
     */
    WfEditorUi.prototype.resolver;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiV2ZFZGl0b3JVaS5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0Bnc3Atd2Yvd2YtcHJvY2Vzcy1lZGl0b3IvIiwic291cmNlcyI6WyJsaWIvZGVzaWduZXIvV2ZFZGl0b3JVaS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUFBLE9BQU8sRUFBUSxRQUFRLEVBQVMsVUFBVSxFQUFFLFlBQVksRUFBRSxXQUFXLEVBQUUsTUFBTSxzQkFBc0IsQ0FBQztBQUNwRyxPQUFPLEVBQUUsT0FBTyxFQUFFLE1BQU0sV0FBVyxDQUFDO0FBQ3BDLE9BQU8sRUFBRSxhQUFhLEVBQWUsWUFBWSxFQUFFLGlCQUFpQixFQUFFLE1BQU0sMEJBQTBCLENBQUM7QUFDdkcsT0FBTyxFQUFFLFNBQVMsRUFBRSxNQUFNLGFBQWEsQ0FBQztBQUN4QyxPQUFPLEVBQUUsV0FBVyxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQzVDLE9BQU8sRUFBRSxPQUFPLEVBQUUsV0FBVyxFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFDM0QsT0FBTyxFQUFFLHdCQUF3QixFQUFFLE1BQU0sa0RBQWtELENBQUM7QUFDNUYsT0FBTyxFQUFFLHNCQUFzQixFQUFFLE1BQU0sa0NBQWtDLENBQUM7QUFDMUUsT0FBTyxFQUFFLDJCQUEyQixFQUFFLE1BQU0sdUNBQXVDLENBQUM7QUFDcEYsT0FBTyxFQUFFLGdCQUFnQixFQUFFLE1BQU0sNEJBQTRCLENBQUM7QUFDOUQsT0FBTyxFQUFFLDBCQUEwQixFQUFFLE1BQU0sc0NBQXNDLENBQUM7QUFDbEYsT0FBTyxFQUFFLDhCQUE4QixFQUFFLE1BQU0sMENBQTBDLENBQUM7QUFDMUYsT0FBTyxFQUFFLG1CQUFtQixFQUFFLE1BQU0sK0JBQStCLENBQUM7QUFDcEUsT0FBTyxFQUFFLGtCQUFrQixFQUFFLE1BQU0sOEJBQThCLENBQUM7QUFDbEUsT0FBTyxFQUFFLHFCQUFxQixFQUFFLE1BQU0saUNBQWlDLENBQUM7QUFDeEUsT0FBTyxFQUFFLGlCQUFpQixFQUFFLE1B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QUNGO1FBQ0QsT0FBTyxTQUFTLENBQUM7SUFDbkIsQ0FBQztJQUNILGlCQUFDO0FBQUQsQ0FBQyxBQWhiRCxDQUFnQyxRQUFRLEdBZ2J2Qzs7OztJQS9hQyw0QkFBaUM7O0lBQ2pDLDJCQUFlOztJQUNmLDZCQUFtQjs7SUFDbkIsMEJBQWE7O0lBQ2IsbUNBQXNCOztJQUN0Qiw0QkFBZTs7SUFDZiwwQkFBYTs7SUFDYiwyQkFBYzs7SUFDZCw4QkFBaUI7O0lBQ2pCLGtDQUFrQjs7SUFDbEIsaUNBQWlCOztJQUNqQixtQ0FLRTs7SUFFRiw2QkFBd0I7Ozs7O0lBRTJDLDhCQUEyQjs7Ozs7SUFDNUYsa0NBQXFDOzs7OztJQUNyQyw4QkFBMkMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDZWxsLCBFZGl0b3JVaSwgR3JhcGgsIEFjdGlvbktleXMsIFRvb2xib3hHcm91cCwgVG9vbGJveEl0ZW0gfSBmcm9tIFwiQGVkcC1wbWYvZ3JhcGhlZGl0b3JcIjtcclxuaW1wb3J0IHsgV2ZHcmFwaCB9IGZyb20gXCIuL1dmR3JhcGhcIjtcclxuaW1wb3J0IHsgUHJvY2Vzc0hlYWRlciwgQml6QWN0aXZpdHksIFVzZXJBY3Rpdml0eSwgT3BlcmF0aW9uQWN0aXZpdHkgfSBmcm9tIFwiQGdzcC13Zi93Zi1wcm9jZXNzLW1vZGVsXCI7XHJcbmltcG9ydCB7IFdmU2lkZWJhciB9IGZyb20gXCIuL1dmU2lkZWJhclwiO1xyXG5pbXBvcnQgeyBXZkNvbnN0YW50cyB9IGZyb20gXCIuL1dmQ29uc3RhbnRzXCI7XHJcbmltcG9ydCB7IG14RXZlbnQsIG14UmVzb3VyY2VzIH0gZnJvbSBcIkBlZHAtcG1mL214Z3JhcGgtdHNcIjtcclxuaW1wb3J0IHsgVXNlckFjdGl2aXR5UHJvcGVydHlLZXlzIH0gZnJvbSBcIi4vd2YtY2VsbC9wcm9wZXJ0eS1rZXlzL1VzZXJBY3Rpdml0eVByb3BlcnR5S2V5c1wiO1xyXG5pbXBvcnQgeyBXZkV4Y2x1c2l2ZUdhdGV3YXlDZWxsIH0gZnJvbSBcIi4vd2YtY2VsbC9XZkV4Y2x1c2l2ZUdhdGV3YXlDZWxsXCI7XHJcbmltcG9ydCB7IEFpZkNyZWF0aW9uQmlsbEFjdGl2aXR5Q2VsbCB9IGZyb20gXCIuL3dmLWNlbGwvQWlmQ3JlYXRpb25CaWxsQWN0aXZpdHlDZWxsXCI7XHJcbmltcG9ydCB7IEF1dG9BY3Rpdml0eUNlbGwgfSBmcm9tIFwiLi93Zi1jZWxsL0F1dG9BY3Rpdml0eUNlbGxcIjtcclxuaW1wb3J0IHsgQ2FsbEFjdGl2aXR5U3ViUHJvY2Vzc0NlbGwgfSBmcm9tIFwiLi93Zi1jZWxsL0NhbGxBY3Rpdml0eVN1YlByb2Nlc3NDZWxsXCI7XHJcbmltcG9ydCB7IEludGVybWVkaWF0ZUNhdGNoRXZlbnRJbXBsQ2VsbCB9IGZyb20gXCIuL3dmLWNlbGwvSW50ZXJtZWRpYXRlQ2F0Y2hFdmVudEltcGxDZWxsXCI7XHJcbmltcG9ydCB7IE1lc3NhZ2VBY3Rpdml0eUNlbGwgfSBmcm9tIFwiLi93Zi1jZWxsL01lc3NhZ2VBY3Rpdml0eUNlbGxcIjtcclxuaW1wb3J0IHsgTm90aWZ5QWN0aXZpdHlDZWxsIH0gZnJvbSBcIi4vd2YtY2VsbC9Ob3RpZnlBY3Rpdml0eUNlbGxcIjtcclxuaW1wb3J0IHsgT3BlcmF0aW9uQWN0aXZpdHlDZWxsIH0gZnJvbSBcIi4vd2YtY2VsbC9PcGVyYXRpb25BY3Rpdml0eUNlbGxcIjtcclxuaW1wb3J0IHsgU3RhcnRBY3Rpdml0eUNlbGwgfSBmcm9tIFwiLi93Zi1jZWxsL1N0YXJ0QWN0aXZpdHlDZWxsXCI7XHJcbmltcG9ydCB7IFVzZXJBY3Rpdml0eUNlbGwgfSBmcm9tIFwiLi93Zi1jZWxsL1VzZXJBY3Rpdml0eUNlbGxcIjtcclxuaW1wb3J0IHsgV2ZQYXJhbGxlbEdhdGV3YXlDZWxsIH0gZnJvbSBcIi4vd2YtY2VsbC9XZlBhcmFsbGVsR2F0ZXdheUNlbGxcIjtcclxuaW1wb3J0IHsgV2ZFbmRFdmVudENlbGwgfSBmcm9tIFwiLi93Zi1jZWxsL1dmRW5kRXZlbnRDZWxsXCI7XHJcbmltcG9ydCB7IFdmSW5jbHVzaXZlR2F0ZXdheUNlbGwgfSBmcm9tIFwiLi93Zi1jZWxsL1dmSW5jbHVzaXZlR2F0ZXdheUNlbGxcIjtcclxuaW1wb3J0IHsgV2ZQcm9jZXNzRWRpdG9yQ29tcG9uZW50IH0gZnJvbSBcIi4uL3dmLXByb2Nlc3MtZWRpdG9yLmNvbXBvbmVudFwiO1xyXG5pbXBvcnQgeyBCYXRjaFNldFByb3BlcnRpZXNDb21wb25lbnQgfSBmcm9tIFwiLi4vdmlld3MvYmF0Y2gtc2V0LXByb3BlcnRpZXMvYmF0Y2gtc2V0LXByb3BlcnRpZXMuY29tcG9uZW50XCI7XHJcbmltcG9ydCB7IEJzTW9kYWxTZXJ2aWNlLCBNb2RhbE9wdGlvbnMgfSBmcm9tIFwiQGZhcnJpcy91aS1tb2RhbFwiO1xyXG5pbXBvcnQgeyBDb21wb25lbnRGYWN0b3J5UmVzb2x2ZXIsIEluamVjdG9yIH0gZnJvbSBcIkBhbmd1bGFyL2NvcmVcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBXZkVkaXRvclVpIGV4dGVuZHMgRWRpdG9yVWkge1xyXG4gIGVkaXRvcjogV2ZQcm9jZXNzRWRpdG9yQ29tcG9uZW50O1xyXG4gIGdyYXBoOiBXZkdyYXBoO1xyXG4gIHNpZGViYXI6IFdmU2lkZWJhcjtcclxuICB0aW1lOiBzdHJpbmc7XHJcbiAgYml6Q2F0ZWdvcnlJZDogc3RyaW5nO1xyXG4gIGFjdGlvbjogc3RyaW5nO1xyXG4gIG1vZGU6IHN0cmluZztcclxuICBzY2VuZTogc3RyaW5nO1xyXG4gIHByb2NUeXBlOiBzdHJpbmc7XHJcbiAgcHJvY0V4dFByb3BzOiBhbnk7XHJcbiAgZm9ybUZvcm1hdHM6IGFueTtcclxuICBnZW5lcmFsQ29uZmlnOiB7IGVuYWJsZVRyYW5zZmVyOiBib29sZWFuOyBlbmFibGVOb3RpZnk6IGJvb2xlYW47IGVuYWJsZUFkZFNpZ25CZWhpbmQ6IGJvb2xlYW47IGVuYWJsZUFkZFNpZ25Gcm9udDogYm9vbGVhbjsgfSA9IHtcclxuICAgIGVuYWJsZVRyYW5zZmVyOiB0cnVlLFxyXG4gICAgZW5hYmxlTm90aWZ5OiBmYWxzZSxcclxuICAgIGVuYWJsZUFkZFNpZ25CZWhpbmQ6IGZhbHNlLFxyXG4gICAgZW5hYmxlQWRkU2lnbkZyb250OiBmYWxzZSxcclxuICB9O1xyXG5cclxuICB6b29tQmFyOiBIVE1MRGl2RWxlbWVudDtcclxuXHJcbiAgY29uc3RydWN0b3IodGltZTogc3RyaW5nLCBhY3Rpb246IHN0cmluZywgY29udGFpbmVyPzogSFRNTEVsZW1lbnQsIHByaXZhdGUgaW5qZWN0b3I/OiBJbmplY3RvcixcclxuICAgIHByaXZhdGUgbW9kYWxTZXJ2aWNlPzogQnNNb2RhbFNlcnZpY2UsXHJcbiAgICBwcml2YXRlIHJlc29sdmVyPzogQ29tcG9uZW50RmFjdG9yeVJlc29sdmVyLCBldmVudFNvdXJjZT86IGFueSwgaW1wb3J0TGlua3M6IGJvb2xlYW4gPSB0cnVlLCkge1xyXG4gICAgc3VwZXIoY29udGFpbmVyLCBldmVudFNvdXJjZSwgaW1wb3J0TGlua3MpO1xyXG4gICAgbGV0IHJvb3RQYXRoID0gJyc7XHJcbiAgICB0cnkge1xyXG4gICAgICByb290UGF0aCA9ICh3aW5kb3cgYXMgYW55KS5nc3BmcmFtZXdvcmtTZXJ2aWNlLmNvbW1vbi5nZXRCYXNlUGF0aC5nZXQoKTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICB9XHJcbiAgICBteFJlc291cmNlcy5hZGQocm9vdFBhdGggKyBcIi9wbGF0Zm9ybS9ydW50aW1lL2NvbW1vbi93ZWIvQGdzcC13Zi93Zi1wcm9jZXNzLWVkaXRvci9yZXNvdXJjZXMvd2YtcHJvY2Vzcy1lZGl0b3JcIik7XHJcbiAgICB0aGlzLnNob3dUb29sYmFyID0gZmFsc2U7XHJcbiAgICB0aGlzLnRpbWUgPSB0aW1lO1xyXG4gICAgdGhpcy5hY3Rpb24gPSBhY3Rpb247XHJcbiAgfVxyXG5cclxuICBjcmVhdGVBY3Rpb25zKCkge1xyXG4gICAgY29uc3QgYWN0aW9ucyA9IHN1cGVyLmNyZWF0ZUFjdGlvbnMoKTtcclxuXHJcbiAgICAvLyDlj6rmnInorr7orqHml7bnvJbovpHnirbmgIHkuIvmiY3lkK/nlKjliKDpmaTliqjkvZxcclxuICAgIGlmICghKHRoaXMuYWN0aW9uID09PSAnZWRpdCcgJiYgdGhpcy50aW1lICE9PSAncnQnKSkge1xyXG4gICAgICBjb25zdCBkZWxldGVBY3Rpb24gPSBhY3Rpb25zLmdldEFjdGlvbihBY3Rpb25LZXlzLnBtZl9kZWxldGUpO1xyXG5cclxuICAgICAgZGVsZXRlQWN0aW9uLmlzRW5hYmxlZCA9ICgpID0+IGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBhY3Rpb25zO1xyXG4gIH1cclxuXHJcbiAgY3JlYXRlVG9vbGJveCgpIHtcclxuICAgIGNvbnN0IHRvb2xib3ggPSBzdXBlci5jcmVhdGVUb29sYm94KCk7XHJcblxyXG4gICAgY29uc3QgZzEgPSBuZXcgVG9vbGJveEdyb3VwKCk7XHJcbiAgICBnMS5uYW1lID0gbXhSZXNvdXJjZXMuZ2V0KCdiYXNpY0VsZW1lbnRzJyk7XHJcbiAgICBnMS5pdGVtcy5wdXNoKFxyXG4gICAgICBuZXcgVG9vbGJveEl0ZW0oU3RhcnRBY3Rpdml0eUNlbGwuQ0xSX1RZUEVfSUQpLFxyXG4gICAgICBuZXcgVG9vbGJveEl0ZW0oV2ZFeGNsdXNpdmVHYXRld2F5Q2VsbC5DTFJfVFlQRV9JRCksXHJcbiAgICAgIG5ldyBUb29sYm94SXRlbShXZlBhcmFsbGVsR2F0ZXdheUNlbGwuQ0xSX1RZUEVfSUQpLFxyXG4gICAgICAvLyDmmoLml7bpmpDol4/ljIXlrrnnvZHlhbNcclxuICAgICAgbmV3IFRvb2xib3hJdGVtKFdmSW5jbHVzaXZlR2F0ZXdheUNlbGwuQ0xSX1RZUEVfSUQpLFxyXG4gICAgICBuZXcgVG9vbGJveEl0ZW0oVXNlckFjdGl2aXR5Q2VsbC5DTFJfVFlQRV9JRCksXHJcbiAgICAgIG5ldyBUb29sYm94SXRlbShPcGVyYXRpb25BY3Rpdml0eUNlbGwuQ0xSX1RZUEVfSUQpLFxyXG4gICAgICBuZXcgVG9vbGJveEl0ZW0oTm90aWZ5QWN0aXZpdHlDZWxsLkNMUl9UWVBFX0lEKSxcclxuICAgICAgbmV3IFRvb2xib3hJdGVtKENhbGxBY3Rpdml0eVN1YlByb2Nlc3NDZWxsLkNMUl9UWVBFX0lEKSxcclxuICAgICAgbmV3IFRvb2xib3hJdGVtKEF1dG9BY3Rpdml0eUNlbGwuQ0xSX1RZUEVfSUQpLFxyXG4gICAgICBuZXcgVG9vbGJveEl0ZW0oSW50ZXJtZWRpYXRlQ2F0Y2hFdmVudEltcGxDZWxsLkNMUl9UWVBFX0lEKSxcclxuICAgICAgbmV3IFRvb2xib3hJdGVtKE1lc3NhZ2VBY3Rpdml0eUNlbGwuQ0xSX1RZUEVfSUQpLFxyXG4gICAgICBuZXcgVG9vbGJveEl0ZW0oQWlmQ3JlYXRpb25CaWxsQWN0aXZpdHlDZWxsLkNMUl9UWVBFX0lEKSxcclxuICAgICAgbmV3IFRvb2xib3hJdGVtKFdmRW5kRXZlbnRDZWxsLkNMUl9UWVBFX0lEKSxcclxuICAgICk7XHJcblxyXG4gICAgdG9vbGJveC5ncm91cHMgPSBbZzFdO1xyXG5cclxuICAgIHJldHVybiB0b29sYm94O1xyXG4gIH1cclxuXHJcbiAgY3JlYXRlR3JhcGhJbnN0YW5jZSgpOiBHcmFwaCB7XHJcbiAgICBjb25zdCBncmFwaCA9IG5ldyBXZkdyYXBoKHRoaXMsIHRoaXMuZGlhZ3JhbUNvbnRhaW5lcik7XHJcblxyXG4gICAgaWYgKHRoaXMuYWN0aW9uID09PSAndmlldycgfHwgdGhpcy50aW1lID09PSAncnQnIHx8IHRoaXMuYWN0aW9uID09PSAnYXNzaWduVmlldycpIHtcclxuICAgICAgZ3JhcGguc2V0Q2VsbHNMb2NrZWQodHJ1ZSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBncmFwaC5zZXREcm9wRW5hYmxlZCh0cnVlKTtcclxuICAgICAgZ3JhcGguc2V0Q29ubmVjdGFibGUodHJ1ZSk7XHJcbiAgICB9XHJcbiAgICAvL1RPRE/vvJrlj7PplK7mn6XnnIvlj6rmmL7npLrlnKjlrqHmibnoioLngrnkuIpcclxuICAgIGdyYXBoLnBvcHVwTWVudUhhbmRsZXIuYXV0b0V4cGFuZCA9IHRydWU7XHJcbiAgICBncmFwaC5wb3B1cE1lbnVIYW5kbGVyLmZhY3RvcnlNZXRob2QgPSAobWVudSwgY2VsbCwgZXZ0KSA9PiB7XHJcbiAgICAgIGNvbnN0IGFjdExpc3QgPSBncmFwaC5nZXRDaGlsZENlbGxzKGdyYXBoLmdldERlZmF1bHRQYXJlbnQoKSlcclxuICAgICAgaWYgKGNlbGwgIT0gbnVsbFxyXG4gICAgICAgICYmIGNlbGwuY2xyVHlwZUlkLmluZGV4T2YoJ3dmLlVzZXJBY3Rpdml0eScpID4gLTFcclxuICAgICAgICAmJiBhY3RMaXN0LmZpbmRJbmRleChhID0+IGEuaWQgPT09IGNlbGwuZ2V0SWQoKSkgPiAtMSkge1xyXG4gICAgICAgIG1lbnUuYWRkSXRlbSgn5om56YeP5aSN5Yi25bGe5oCnJywgbnVsbCwgKCkgPT4ge1xyXG4gICAgICAgICAgY29uc3QgY29tcEZhY3RvcnkgPSB0aGlzLnJlc29sdmVyLnJlc29sdmVDb21wb25lbnRGYWN0b3J5KEJhdGNoU2V0UHJvcGVydGllc0NvbXBvbmVudCk7XHJcbiAgICAgICAgICBjb25zdCBjb21wUmVmID0gY29tcEZhY3RvcnkuY3JlYXRlKHRoaXMuaW5qZWN0b3IpO1xyXG4gICAgICAgICAgY29tcFJlZi5pbnN0YW5jZS5hY3Rpdml0eU1vZGVsID0gY2VsbC5mbG93RWxlbWVudDtcclxuICAgICAgICAgIGNvbnN0IG1vZGFsQ29uZmlnOiBNb2RhbE9wdGlvbnMgPSB7XHJcbiAgICAgICAgICAgIHRpdGxlOiAn5om56YeP5aSN5Yi25bGe5oCnJyxcclxuICAgICAgICAgICAgd2lkdGg6IDUxMixcclxuICAgICAgICAgICAgaGVpZ2h0OiA0NjUsXHJcbiAgICAgICAgICAgIHNob3dCdXR0b25zOiB0cnVlLFxyXG4gICAgICAgICAgICBidXR0b25zOiBjb21wUmVmLmluc3RhbmNlLmZvb3RlclxyXG4gICAgICAgICAgfTtcclxuICAgICAgICAgIGNvbnN0IGRpYWxvZyA9IHRoaXMubW9kYWxTZXJ2aWNlLnNob3coY29tcFJlZiwgbW9kYWxDb25maWcpO1xyXG4gICAgICAgICAgY29tcFJlZi5pbnN0YW5jZS5jYW5jZWwuc3Vic2NyaWJlKCRldmVudCA9PiBkaWFsb2cuY2xvc2UoKSk7XHJcbiAgICAgICAgICBjb21wUmVmLmluc3RhbmNlLnN1Ym1pdC5zdWJzY3JpYmUoKGRhdGE6IHN0cmluZykgPT4ge1xyXG4gICAgICAgICAgICBkaWFsb2cuY2xvc2UoKTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIGdyYXBoO1xyXG4gIH1cclxuXHJcbiAgY3JlYXRlU2lkZWJhcigpOiBXZlNpZGViYXIge1xyXG4gICAgcmV0dXJuIG5ldyBXZlNpZGViYXIodGhpcywgdGhpcy5zaWRlYmFyQ29udGFpbmVyKTtcclxuICB9XHJcblxyXG4gIHNob3coKTogdm9pZCB7XHJcbiAgICBzdXBlci5zaG93KCk7XHJcblxyXG4gICAgaWYgKHRoaXMuYWN0aW9uID09PSAndmlldycgfHwgdGhpcy5hY3Rpb24gPT09ICdhc3NpZ25WaWV3Jykge1xyXG4gICAgICBjb25zdCBzcGFuID0gdGhpcy5jcmVhdGVTcGFuKCcnKTtcclxuICAgICAgc3Bhbi5zdHlsZS5mb250U2l6ZSA9ICcxNHB4JztcclxuICAgICAgc3Bhbi5zdHlsZS5jb2xvciA9ICd3aGl0ZSc7XHJcbiAgICAgIHNwYW4uc3R5bGUuYm9yZGVyUmFkaXVzID0gJzIwcHgnO1xyXG4gICAgICBzcGFuLnN0eWxlLnBhZGRpbmcgPSAnNHB4IDIwcHgnO1xyXG4gICAgICBzcGFuLnN0eWxlLmJhY2tncm91bmQgPSAncmdiKDE5OSwgMTk0LCAxODcpJztcclxuICAgICAgY29uc3QgdiA9IGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKG14UmVzb3VyY2VzLmdldCgncmVhZE9ubHknKSk7XHJcbiAgICAgIHNwYW4uYXBwZW5kQ2hpbGQodik7XHJcbiAgICAgIGNvbnN0IGQgPSB0aGlzLmNyZWF0ZURpdignJyk7XHJcbiAgICAgIGQuc3R5bGUucG9zaXRpb24gPSAnYWJzb2x1dGUnO1xyXG4gICAgICBkLnN0eWxlLnRvcCA9ICcxMHB4JztcclxuICAgICAgZC5zdHlsZS5yaWdodCA9ICcxMHB4JztcclxuICAgICAgZC5zdHlsZS56SW5kZXggPSBcIjJcIjtcclxuICAgICAgZC5hcHBlbmRDaGlsZChzcGFuKTtcclxuICAgICAgdGhpcy5jb250YWluZXIuYXBwZW5kQ2hpbGQoZCk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgYnV0dG9uSW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XHJcbiAgICBidXR0b25Jbi5zZXRBdHRyaWJ1dGUoJ2hyZWYnLCAnamF2YXNjcmlwdDp2b2lkKDApOycpO1xyXG4gICAgbGV0IGJ1dHRvbkluSW1nID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW1nJyk7XHJcbiAgICBidXR0b25Jbi5zdHlsZS5tYXJnaW5SaWdodCA9ICcxMHB4JztcclxuICAgIGJ1dHRvbkluSW1nLnNyYyA9IFdmQ29uc3RhbnRzLklNQUdFX1BBVEggKyAnL3pvb21Jbi5zdmcnO1xyXG4gICAgYnV0dG9uSW5JbWcuc3R5bGUuZGlzcGxheSA9IFwiaW5saW5lLWJsb2NrXCI7XHJcbiAgICBidXR0b25JbkltZy5zdHlsZS52ZXJ0aWNhbEFsaWduID0gXCJtaWRkbGVcIjtcclxuICAgIGJ1dHRvbkluLmFwcGVuZENoaWxkKGJ1dHRvbkluSW1nKTtcclxuICAgIG14RXZlbnQuYWRkTGlzdGVuZXIoYnV0dG9uSW4sICdjbGljaycsIChldnQ6IFBvaW50ZXJFdmVudCkgPT4ge1xyXG4gICAgICB0aGlzLmFjdGlvbnMuZ2V0QWN0aW9uKEFjdGlvbktleXMucG1mX3pvb21JbikuZXhlY3V0ZShldnQpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgY29uc3QgYnV0dG9uT3V0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpO1xyXG4gICAgYnV0dG9uT3V0LnNldEF0dHJpYnV0ZSgnaHJlZicsICdqYXZhc2NyaXB0OnZvaWQoMCk7Jyk7XHJcbiAgICBsZXQgYnV0dG9uT3V0SW1nID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW1nJyk7XHJcbiAgICBidXR0b25PdXRJbWcuc3JjID0gV2ZDb25zdGFudHMuSU1BR0VfUEFUSCArICcvem9vbU91dC5zdmcnO1xyXG4gICAgYnV0dG9uT3V0SW1nLnN0eWxlLmRpc3BsYXkgPSBcImlubGluZS1ibG9ja1wiO1xyXG4gICAgYnV0dG9uT3V0SW1nLnN0eWxlLnZlcnRpY2FsQWxpZ24gPSBcIm1pZGRsZVwiO1xyXG4gICAgYnV0dG9uT3V0LmFwcGVuZENoaWxkKGJ1dHRvbk91dEltZyk7XHJcbiAgICBteEV2ZW50LmFkZExpc3RlbmVyKGJ1dHRvbk91dCwgJ2NsaWNrJywgKGV2dDogUG9pbnRlckV2ZW50KSA9PiB7XHJcbiAgICAgIHRoaXMuYWN0aW9ucy5nZXRBY3Rpb24oQWN0aW9uS2V5cy5wbWZfem9vbU91dCkuZXhlY3V0ZShldnQpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgY29uc3Qgem9vbUJhciA9IHRoaXMuY3JlYXRlRGl2KCd6b29tQmFyJyk7XHJcbiAgICB6b29tQmFyLnN0eWxlLnBvc2l0aW9uID0gJ2Fic29sdXRlJztcclxuICAgIHpvb21CYXIuc3R5bGUuekluZGV4ID0gXCIyXCI7XHJcbiAgICBsZXQgdCA9IDEwO1xyXG4gICAgaWYgKHRoaXMuc2hvd01lbnViYXIpIHtcclxuICAgICAgdCArPSB0aGlzLm1lbnViYXJIZWlnaHQ7XHJcbiAgICB9XHJcbiAgICBpZiAodGhpcy5zaG93VG9vbGJhcikge1xyXG4gICAgICB0ICs9IHRoaXMudG9vbGJhckhlaWdodDtcclxuICAgIH1cclxuICAgIHpvb21CYXIuc3R5bGUudG9wID0gdCArICdweCc7XHJcbiAgICB6b29tQmFyLnN0eWxlLmxlZnQgPSAodGhpcy5zaG93U2lkZWJhciA/IHRoaXMuc2lkZWJhclNwbGl0UG9zaXRpb24gKyB0aGlzLnNpZGViYXJTcGxpdFNpemUgOiAwKSArIDEwICsgXCJweFwiO1xyXG5cclxuICAgIHpvb21CYXIuYXBwZW5kQ2hpbGQoYnV0dG9uSW4pO1xyXG4gICAgem9vbUJhci5hcHBlbmRDaGlsZChidXR0b25PdXQpO1xyXG4gICAgdGhpcy5jb250YWluZXIuYXBwZW5kQ2hpbGQoem9vbUJhcik7XHJcbiAgICB0aGlzLnpvb21CYXIgPSB6b29tQmFyO1xyXG4gIH1cclxuXHJcbiAgc2lkZWJhclNwbGl0T25DaGFuZ2UodmFsdWU6IG51bWJlcik6IHZvaWQge1xyXG4gICAgc3VwZXIuc2lkZWJhclNwbGl0T25DaGFuZ2UodmFsdWUpO1xyXG5cclxuICAgIC8vIOWIhuWJsuadoeenu+WKqOWQjuabtOaWsOe8qeaUvuadoeS9jee9rlxyXG4gICAgaWYgKHRoaXMuem9vbUJhcikge1xyXG4gICAgICB0aGlzLnpvb21CYXIuc3R5bGUubGVmdCA9ICh0aGlzLnNob3dTaWRlYmFyID8gdGhpcy5zaWRlYmFyU3BsaXRQb3NpdGlvbiArIHRoaXMuc2lkZWJhclNwbGl0U2l6ZSA6IDApICsgMTAgKyBcInB4XCI7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDliJvlu7rluKbmjIflrprmoLflvI/nsbvnmoRzcGFuXHJcbiAgICogQHBhcmFtIGNsYXNzbmFtZVxyXG4gICAqIEByZXR1cm5zXHJcbiAgICovXHJcbiAgY3JlYXRlU3BhbihjbGFzc25hbWU6IHN0cmluZyk6IEhUTUxTcGFuRWxlbWVudCB7XHJcbiAgICBsZXQgZWx0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xyXG4gICAgZWx0LmNsYXNzTmFtZSA9IGNsYXNzbmFtZTtcclxuXHJcbiAgICByZXR1cm4gZWx0O1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog5Yqg6L295Lia5Yqh5rS75YqoXHJcbiAgICogQHBhcmFtIGJpekFjdGl2aXRpZXNcclxuICAgKi9cclxuICBsb2FkQml6QWN0aXZpdGllcyhiaXpBY3Rpdml0aWVzOiBCaXpBY3Rpdml0eVtdKSB7XHJcbiAgICB0aGlzLnNpZGViYXIgJiYgdGhpcy5zaWRlYmFyLmFkZEJpekFjdFBhbGV0dGUoYml6QWN0aXZpdGllcyk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDmibnph4/lpI3liLblsZ7mgKdcclxuICAgKiBAcGFyYW0gb2JqXHJcbiAgICovXHJcbiAgYmF0Y2hDb3B5UHJvcGVydHkob2JqOiBhbnkpIHtcclxuICAgIC8vIOaUvuW8g+S4jemcgOimgeeahOWPguaVsFxyXG4gICAgY29uc3QgaWRzID0gb2JqLnZhbHVlLnRhcmdldE5vZGVJRDtcclxuICAgIG9iai5wcm9wZXJ0eVZhbHVlID0gb2JqLnZhbHVlLm1lc3NhZ2VOb3RpY2U7XHJcbiAgICAvLyB0b2Rv77ya5aSa5Liq5rS75Yqo5YW35pyJ5ZCM5ZCN5bGe5oCn5pe277yM5aaC5L2V5pu05ZCI55CG5a6a5LmJUHJvcGVydHlLZXnvvJ9cclxuICAgIG9iai5wcm9wZXJ0eUlEID0gVXNlckFjdGl2aXR5UHJvcGVydHlLZXlzLm1lc3NhZ2VOb3RpY2U7XHJcbiAgICBmb3IgKGNvbnN0IGlkIG9mIGlkcykge1xyXG4gICAgICBjb25zdCBjZWxsID0gdGhpcy5ncmFwaC5nZXRDZWxsQnlGbG93RWxlbWVudElkKGlkKTtcclxuICAgICAgaWYgKGNlbGwpIHtcclxuICAgICAgICBjZWxsLnVwZGF0ZVByb3BzKG9iaik7XHJcbiAgICAgICAgdGhpcy5ncmFwaC5yZWZyZXNoKCk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gKiDmibnph4/orr7nva7lsZ7mgKdcclxuICogQHBhcmFtIG9ialxyXG4gKi9cclxuICBiYXRjaFNldFByb3BlcnR5KG9iajogYW55KSB7XHJcbiAgICBmb3IgKGNvbnN0IHYgb2Ygb2JqKSB7XHJcbiAgICAgIHN3aXRjaCAodi50eXBlKSB7XHJcbiAgICAgICAgY2FzZSAnYWRkU2lnbmZyb250JzpcclxuICAgICAgICAgIGNvbnN0IGFmSWQgPSB2LmFjdGlzO1xyXG4gICAgICAgICAgb2JqLnByb3BlcnR5VmFsdWUgPSB2LmNvbmZpZztcclxuICAgICAgICAgIG9iai5wcm9wZXJ0eUlEID0gVXNlckFjdGl2aXR5UHJvcGVydHlLZXlzLkFkZFNpZ25Gcm9udEFibGU7XHJcbiAgICAgICAgICBmb3IgKGNvbnN0IGlkIG9mIGFmSWQpIHtcclxuICAgICAgICAgICAgY29uc3QgY2VsbCA9IHRoaXMuZ3JhcGguZ2V0Q2VsbEJ5Rmxvd0VsZW1lbnRJZChpZC5JZCk7XHJcbiAgICAgICAgICAgIGlmIChjZWxsKSB7XHJcbiAgICAgICAgICAgICAgY2VsbC51cGRhdGVQcm9wcyhvYmopO1xyXG4gICAgICAgICAgICAgIHRoaXMuZ3JhcGgucmVmcmVzaCgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlICdhZGRTaWduQmVoaW5kJzpcclxuICAgICAgICAgIGNvbnN0IGFiSWQgPSB2LmFjdGlzO1xyXG4gICAgICAgICAgb2JqLnByb3BlcnR5VmFsdWUgPSB2LmNvbmZpZztcclxuICAgICAgICAgIG9iai5wcm9wZXJ0eUlEID0gVXNlckFjdGl2aXR5UHJvcGVydHlLZXlzLkFkZFNpZ25CZWhpbmRBYmxlO1xyXG4gICAgICAgICAgZm9yIChjb25zdCBpZCBvZiBhYklkKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNlbGwgPSB0aGlzLmdyYXBoLmdldENlbGxCeUZsb3dFbGVtZW50SWQoaWQuSWQpO1xyXG4gICAgICAgICAgICBpZiAoY2VsbCkge1xyXG4gICAgICAgICAgICAgIGNlbGwudXBkYXRlUHJvcHMob2JqKTtcclxuICAgICAgICAgICAgICB0aGlzLmdyYXBoLnJlZnJlc2goKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSAndHJhbnNmZXInOlxyXG4gICAgICAgICAgY29uc3QgdHJJZCA9IHYuYWN0aXM7XHJcbiAgICAgICAgICBvYmoucHJvcGVydHlWYWx1ZSA9IHYuY29uZmlnO1xyXG4gICAgICAgICAgb2JqLnByb3BlcnR5SUQgPSBVc2VyQWN0aXZpdHlQcm9wZXJ0eUtleXMudHJhbnNmZXJTY29wZTtcclxuICAgICAgICAgIGZvciAoY29uc3QgaWQgb2YgdHJJZCkge1xyXG4gICAgICAgICAgICBjb25zdCBjZWxsID0gdGhpcy5ncmFwaC5nZXRDZWxsQnlGbG93RWxlbWVudElkKGlkLklkKTtcclxuICAgICAgICAgICAgaWYgKGNlbGwpIHtcclxuICAgICAgICAgICAgICBjZWxsLnVwZGF0ZVByb3BzKG9iaik7XHJcbiAgICAgICAgICAgICAgdGhpcy5ncmFwaC5yZWZyZXNoKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgJ25vdGlmeSc6XHJcbiAgICAgICAgICBjb25zdCBudElkID0gdi5hY3RpcztcclxuICAgICAgICAgIG9iai5wcm9wZXJ0eVZhbHVlID0gdi5jb25maWc7XHJcbiAgICAgICAgICBvYmoucHJvcGVydHlJRCA9IFVzZXJBY3Rpdml0eVByb3BlcnR5S2V5cy5Ob3RpZnlBYmxlO1xyXG4gICAgICAgICAgZm9yIChjb25zdCBpZCBvZiBudElkKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNlbGwgPSB0aGlzLmdyYXBoLmdldENlbGxCeUZsb3dFbGVtZW50SWQoaWQuSWQpO1xyXG4gICAgICAgICAgICBpZiAoY2VsbCkge1xyXG4gICAgICAgICAgICAgIGNlbGwudXBkYXRlUHJvcHMob2JqKTtcclxuICAgICAgICAgICAgICB0aGlzLmdyYXBoLnJlZnJlc2goKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgLy8g6amz5Zue6KeE5YiZ6ZyA6KaB54m55q6K5aSE55CG77ya5a2Q5rWB56iL5ZKM5L+h5Y+355qE6LWL566A54mIXHJcbiAgICAgICAgY2FzZSAnYmFja1dhcmRSdWxlJzpcclxuICAgICAgICAgIGNvbnN0IGJ3SWQgPSB2LmFjdGlzO1xyXG4gICAgICAgICAgb2JqLnByb3BlcnR5VmFsdWUgPSB2LmNvbmZpZztcclxuICAgICAgICAgIG9iai5wcm9wZXJ0eUlEID0gVXNlckFjdGl2aXR5UHJvcGVydHlLZXlzLkJhY2tXYXJkUnVsZTtcclxuICAgICAgICAgIGZvciAoY29uc3QgaWQgb2YgYndJZCkge1xyXG4gICAgICAgICAgICBjb25zdCBjZWxsID0gdGhpcy5ncmFwaC5nZXRDZWxsQnlGbG93RWxlbWVudElkKGlkLklkKTtcclxuICAgICAgICAgICAgaWYgKGNlbGwpIHtcclxuICAgICAgICAgICAgICBjZWxsLnVwZGF0ZVByb3BzKG9iaik7XHJcbiAgICAgICAgICAgICAgdGhpcy5ncmFwaC5yZWZyZXNoKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDliJvlu7rmlrDmtYHnqItcclxuICAgKiBAcGFyYW0gbmV3UHJvY0luZm9cclxuICAgKiBAcGFyYW0gYml6Q21wc1xyXG4gICAqL1xyXG4gIGNyZWF0ZUJwbW5Nb2RlbChuZXdQcm9jSW5mbzogYW55LCBiaXpDbXBzPzogYW55KSB7XHJcbiAgICB0aGlzLmdyYXBoLmNyZWF0ZUJwbW5Nb2RlbFdpdGhQcm9jSW5mbyhuZXdQcm9jSW5mbywgYml6Q21wcyk7XHJcblxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog5omT5byA5rWB56iLXHJcbiAgICogQHBhcmFtIGNvbnRlbnRcclxuICAgKi9cclxuICBvcGVuQnBtbk1vZGVsKGNvbnRlbnQ6IHN0cmluZykge1xyXG4gICAgdGhpcy5ncmFwaC5sb2FkQnBtbk1vZGVsKGNvbnRlbnQpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog6I635Y+W5bGe5oCn6YWN572u77yM5Yi35paw5bGe5oCn5qGGXHJcbiAgICogQHBhcmFtIG9ialxyXG4gICAqIEByZXR1cm5zXHJcbiAgICovXHJcbiAgcmVmcmVzaFByb3BlcnR5KG9iajogYW55KSB7XHJcbiAgICBjb25zdCBjZWxsID0gdGhpcy5ncmFwaC5nZXRDZWxsQnlGbG93RWxlbWVudElkKG9iai5JZCk7XHJcbiAgICByZXR1cm4gdGhpcy5nZXRGYXJyaXNQcm9wQ29uZmlnKFtjZWxsXSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDojrflj5bnlKjmiLfmtLvliqhcclxuICAgKiBAcmV0dXJuc1xyXG4gICAqL1xyXG4gIGdldEFjdGl2aXRpZXMoKSB7XHJcbiAgICBjb25zdCBsaXN0ID0gW107XHJcbiAgICBjb25zdCBicG1uTW9kZWwgPSB0aGlzLmdyYXBoLmJwbW5Nb2RlbDtcclxuICAgIGNvbnN0IGZsb3dEaWN0ID0gYnBtbk1vZGVsLkRlZmF1bHRQcm9jZXNzLkdldEZsb3dFbGVtZW50cygpO1xyXG4gICAgT2JqZWN0LmtleXMoZmxvd0RpY3QpLmZvckVhY2goKGtleSkgPT4ge1xyXG4gICAgICBjb25zdCBmbG93RWx0ID0gZmxvd0RpY3Rba2V5XTtcclxuICAgICAgaWYgKGZsb3dFbHQuQ2xyVHlwZUlEID09PSBVc2VyQWN0aXZpdHkuQ2xyX1R5cGVfSURcclxuICAgICAgICB8fCBmbG93RWx0LkNsclR5cGVJRCA9PT0gT3BlcmF0aW9uQWN0aXZpdHkuQ2xyX1R5cGVfSUQpIHtcclxuICAgICAgICBsaXN0LnB1c2goZmxvd0VsdCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIGxpc3Q7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDojrflj5bnu5PmnZ/kuovku7ZcclxuICAgKiBAcmV0dXJuc1xyXG4gICAqL1xyXG4gIGdldEVuZEV2ZW50cygpIHtcclxuICAgIGNvbnN0IHVzZXJBY3RBcnJheSA9IFtdO1xyXG4gICAgY29uc3QgYnBtbk1vZGVsID0gdGhpcy5ncmFwaC5icG1uTW9kZWw7XHJcbiAgICBjb25zdCBmbG93RGljdCA9IGJwbW5Nb2RlbC5EZWZhdWx0UHJvY2Vzcy5HZXRGbG93RWxlbWVudHMoKTtcclxuICAgIE9iamVjdC5rZXlzKGZsb3dEaWN0KS5mb3JFYWNoKChrZXkpID0+IHtcclxuICAgICAgY29uc3QgZmxvd0VsdCA9IGZsb3dEaWN0W2tleV07XHJcbiAgICAgIGlmIChmbG93RWx0LkNsclR5cGVJRCA9PT0gJ2JwbW4uRW5kRXZlbnQnIHx8IGZsb3dFbHQuQ2xyVHlwZUlEID09PSBVc2VyQWN0aXZpdHkuQ2xyX1R5cGVfSURcclxuICAgICAgICB8fCBmbG93RWx0LkNsclR5cGVJRCA9PT0gT3BlcmF0aW9uQWN0aXZpdHkuQ2xyX1R5cGVfSUQpIHtcclxuICAgICAgICB1c2VyQWN0QXJyYXkucHVzaChmbG93RWx0KTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gdXNlckFjdEFycmF5O1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog6I635Y+W55+l5Lya5LqL5Lu2XHJcbiAgICogQHJldHVybnNcclxuICAgKi9cclxuICBnZXROb3RpZnlFdmVudHMoKSB7XHJcbiAgICBjb25zdCBsaXN0ID0gW107XHJcbiAgICBjb25zdCBicG1uTW9kZWwgPSB0aGlzLmdyYXBoLmJwbW5Nb2RlbDtcclxuICAgIGNvbnN0IGZsb3dEaWN0ID0gYnBtbk1vZGVsLkRlZmF1bHRQcm9jZXNzLkdldEZsb3dFbGVtZW50cygpO1xyXG4gICAgT2JqZWN0LmtleXMoZmxvd0RpY3QpLmZvckVhY2goKGtleSkgPT4ge1xyXG4gICAgICBjb25zdCBmbG93RWx0ID0gZmxvd0RpY3Rba2V5XTtcclxuICAgICAgaWYgKGZsb3dFbHQuQ2xyVHlwZUlEID09PSAnd2YuTm90aWZ5QWN0aXZpdHknKSB7XHJcbiAgICAgICAgbGlzdC5wdXNoKGZsb3dFbHQpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICAgIHJldHVybiBsaXN0O1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog6I635Y+W5raI5oGv5LqL5Lu2XHJcbiAgICogQHJldHVybnNcclxuICAgKi9cclxuICBnZXRNZXNzYWdlRXZlbnRzKCkge1xyXG4gICAgY29uc3QgbGlzdCA9IFtdO1xyXG4gICAgY29uc3QgYnBtbk1vZGVsID0gdGhpcy5ncmFwaC5icG1uTW9kZWw7XHJcbiAgICBjb25zdCBmbG93RGljdCA9IGJwbW5Nb2RlbC5EZWZhdWx0UHJvY2Vzcy5HZXRGbG93RWxlbWVudHMoKTtcclxuICAgIE9iamVjdC5rZXlzKGZsb3dEaWN0KS5mb3JFYWNoKChrZXkpID0+IHtcclxuICAgICAgY29uc3QgZmxvd0VsdCA9IGZsb3dEaWN0W2tleV07XHJcbiAgICAgIGlmIChmbG93RWx0LkNsclR5cGVJRCA9PT0gJ2JwbW4uTWVzc2FnZUV2ZW50Jykge1xyXG4gICAgICAgIGxpc3QucHVzaChmbG93RWx0KTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gbGlzdDtcclxuICB9XHJcbiAgLyoqXHJcbiAgICog6I635Y+W5a2Q5rWB56iL5ZKM5L+h5Y+35o2V6I636IqC54K5XHJcbiAgICogQHJldHVybnNcclxuICAgKi9cclxuICBnZXRTdWJBbmRDYXRjaEV2ZW50cygpIHtcclxuICAgIGNvbnN0IGxpc3QgPSBbXTtcclxuICAgIGNvbnN0IGJwbW5Nb2RlbCA9IHRoaXMuZ3JhcGguYnBtbk1vZGVsO1xyXG4gICAgY29uc3QgZmxvd0RpY3QgPSBicG1uTW9kZWwuRGVmYXVsdFByb2Nlc3MuR2V0Rmxvd0VsZW1lbnRzKCk7XHJcbiAgICBPYmplY3Qua2V5cyhmbG93RGljdCkuZm9yRWFjaCgoa2V5KSA9PiB7XHJcbiAgICAgIGNvbnN0IGZsb3dFbHQgPSBmbG93RGljdFtrZXldO1xyXG4gICAgICBpZiAoZmxvd0VsdC5DbHJUeXBlSUQgPT09ICd3Zi5DYWxsQWN0aXZpdHlTdWJQcm9jZXNzJyB8fFxyXG4gICAgICBmbG93RWx0LkNsclR5cGVJRCA9PT0gJ3dmLkludGVybWVkaWF0ZUNhdGNoRXZlbnRJbXBsJykge1xyXG4gICAgICAgIGxpc3QucHVzaChmbG93RWx0KTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gbGlzdDtcclxuICB9XHJcbiAgLyoqXHJcbiAgICog6I635Y+W5ZCv5Yqo5pa55byPXHJcbiAgICogQHJldHVybnNcclxuICAgKi9cclxuICBnZXRTdGFydE1vZGUoKSB7XHJcbiAgICBsZXQgc3RhcnRNb2RlID0gbnVsbDtcclxuICAgIGNvbnN0IGJwbW5Nb2RlbCA9IHRoaXMuZ3JhcGguYnBtbk1vZGVsO1xyXG4gICAgY29uc3QgZXh0ZW5kRWxlbWVudHMgPSBicG1uTW9kZWwuRGVmYXVsdFByb2Nlc3MuR2V0RXh0ZW5zaW9uRWxlbWVudHMoKTtcclxuICAgIGlmIChleHRlbmRFbGVtZW50cy5sZW5ndGggPiAwKSB7XHJcbiAgICAgIGZvciAoY29uc3QgZSBvZiBleHRlbmRFbGVtZW50cykge1xyXG4gICAgICAgIGlmIChlIGluc3RhbmNlb2YgUHJvY2Vzc0hlYWRlcikge1xyXG4gICAgICAgICAgc3RhcnRNb2RlID0gZS5zdGFydE1vZGU7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gc3RhcnRNb2RlO1xyXG4gIH1cclxufVxyXG4iXX0=