/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { NodeCell, ElementPropertyConfig } from "@edp-pmf/grapheditor";
import { mxResources } from "@edp-pmf/mxgraph-ts";
import { BpmnModelHelper, FlowNodeState } from "@edp-pmf/bpmn-model";
import { StartActivity, ExtendProperty, JumpScope, ExecuteForm, ActualParameter, OtherAssignNodes, OtherAssignActivityNodeInfo, Condition } from "@gsp-wf/wf-process-model";
import { WfConstants } from "../WfConstants";
import { StartActivityPropertyKeys } from "./property-keys/StartActivityPropertyKeys";
import { PropertyHelper } from "./PropertyHelper";
/**
 * 开始活动节点
 */
var StartActivityCell = /** @class */ (function (_super) {
    tslib_1.__extends(StartActivityCell, _super);
    function StartActivityCell(value, geometry, style) {
        var _a;
        var _this = _super.call(this, value, geometry, style) || this;
        _this.clrTypeId = StartActivityCell.CLR_TYPE_ID;
        _this.name = "开始";
        _this.nameLanguage = {
            "zh-CHS": "开始",
            "zh-CHT": "開始",
            "en": "Start",
        };
        _this.imgUrls = (_a = {},
            _a[FlowNodeState.Default] = WfConstants.IMAGE_PATH + "/start.png",
            _a[FlowNodeState.Selected] = WfConstants.IMAGE_PATH + "/start_select.svg",
            _a);
        return _this;
    }
    /**
     * @param {?=} flowElt
     * @return {?}
     */
    StartActivityCell.prototype.createFlowElement = /**
     * @param {?=} flowElt
     * @return {?}
     */
    function (flowElt) {
        /** @type {?} */
        var flowNode = (/** @type {?} */ (_super.prototype.createFlowElement.call(this, flowElt)));
        /** @type {?} */
        var editorUi = this.editorUi;
        flowNode.Id = "startActivity" + BpmnModelHelper.GenerateElementId();
        // 创建而非复制时执行
        if (flowElt == null) {
            // 设置默认表单
            if (editorUi && editorUi.formFormats) {
                /** @type {?} */
                var formFormats = editorUi.formFormats;
                /** @type {?} */
                var startActivityForms = new Array();
                /** @type {?} */
                var pcForm = formFormats.filter((/**
                 * @param {?} f
                 * @return {?}
                 */
                function (f) { return f.terminal === 'PC' && f.status === 1; }))[0];
                if (pcForm) {
                    startActivityForms.push(pcForm);
                }
                /** @type {?} */
                var mobileForm = formFormats.filter((/**
                 * @param {?} f
                 * @return {?}
                 */
                function (f) { return f.terminal === 'Mobile' && f.status === 1; }))[0];
                if (mobileForm) {
                    startActivityForms.push(mobileForm);
                }
                if (startActivityForms && startActivityForms.length > 0) {
                    flowNode.setDefaultForms(startActivityForms);
                }
            }
        }
        return flowNode;
    };
    /**
     * @return {?}
     */
    StartActivityCell.prototype.getFarrisPropConfig = /**
     * @return {?}
     */
    function () {
        var e_1, _a, e_2, _b, e_3, _c;
        /** @type {?} */
        var editorUi = this.editorUi;
        /** @type {?} */
        var act = (/** @type {?} */ (this.flowElement));
        /** @type {?} */
        var extendList = [];
        if (editorUi.procExtProps && editorUi.procExtProps.length > 0) {
            extendList = JSON.parse(JSON.stringify(editorUi.procExtProps)).sort((/**
             * @param {?} a
             * @param {?} b
             * @return {?}
             */
            function (a, b) {
                return a.sortOrder - b.sortOrder;
            }));
        }
        extendList = extendList.sort((/**
         * @param {?} a
         * @param {?} b
         * @return {?}
         */
        function (a, b) {
            return a.sortOrder - b.sortOrder;
        }));
        /** @type {?} */
        var PropertyConfig = new ElementPropertyConfig();
        /** @type {?} */
        var propertyData = new Object();
        PropertyConfig.categoryId = 'general';
        PropertyConfig.categoryName = mxResources.get('basicInformation');
        PropertyConfig.tabId = 'basic';
        PropertyConfig.tabName = mxResources.get('basicAttributes');
        PropertyConfig.properties = [
            { propertyID: StartActivityPropertyKeys.Name, propertyName: mxResources.get('name'), propertyType: 'string', visible: !this.editorUi.multiLangEnabled },
            { propertyID: StartActivityPropertyKeys.NameLanguage, propertyName: mxResources.get('nameLanguage'), propertyType: 'multiLanguage', visible: this.editorUi.multiLangEnabled },
            { propertyID: StartActivityPropertyKeys.Id, propertyName: mxResources.get('id'), propertyType: 'string', readonly: true }
        ];
        /** @type {?} */
        var formDef = new ElementPropertyConfig();
        formDef.categoryId = 'formDef';
        formDef.categoryName = mxResources.get('formDef');
        formDef.tabId = 'basic';
        formDef.tabName = mxResources.get('basicAttributes');
        formDef.properties = [
            { propertyID: StartActivityPropertyKeys.wf_ExecuteForms_PC, propertyName: mxResources.get('pcForm'), propertyType: 'modal' },
            { propertyID: StartActivityPropertyKeys.wf_ExecuteForms_Mobile, propertyName: mxResources.get('webForm'), propertyType: 'modal' },
        ];
        /** @type {?} */
        var ActivityConfig = new ElementPropertyConfig();
        ActivityConfig.categoryId = 'activityConfig';
        ActivityConfig.categoryName = mxResources.get('activityProperty');
        ActivityConfig.tabId = 'basic';
        ActivityConfig.tabName = mxResources.get('basicAttributes');
        ActivityConfig.properties = [
            // { propertyID: StartActivityPropertyKeys.ExecuteForms, propertyName: mxResources.get('formDef'), propertyType: 'modal' },
            { propertyID: 'sendBackedTask', propertyName: mxResources.get('sendBackedTask'), propertyType: 'select' }
        ];
        if (act.selectTargetAble) {
            ActivityConfig.properties = ActivityConfig.properties.concat([
                { propertyID: StartActivityPropertyKeys.SelectTargetAble, propertyName: mxResources.get('selectTargetAble'), propertyType: 'select' },
                { propertyID: StartActivityPropertyKeys.JumpScope, propertyName: mxResources.get('jumpScope'), propertyType: 'modal' }
            ]);
            propertyData.SelectTargetAble = act.selectTargetAble || false;
            propertyData.JumpScope = act.jumpScope;
        }
        else {
            ActivityConfig.properties = ActivityConfig.properties.concat([
                { propertyID: StartActivityPropertyKeys.SelectTargetAble, propertyName: mxResources.get('selectTargetAble'), propertyType: 'select' }
            ]);
            propertyData.SelectTargetAble = act.selectTargetAble || false;
        }
        if (act.otherAssignNodes) {
            ActivityConfig.properties = ActivityConfig.properties.concat([
                { propertyID: StartActivityPropertyKeys.otherAssignNodes, propertyName: mxResources.get('otherAssignNodes'), propertyType: 'select' },
                // { propertyID: StartActivityPropertyKeys.otherAssignActivities, propertyName: mxResources.get('otherAssignActivities'), propertyType: 'modal' }
                { propertyID: StartActivityPropertyKeys.otherAssignActivityNodeInfos, propertyName: mxResources.get('otherAssignActivityNodeInfos'), propertyType: 'modal' }
            ]);
            propertyData[StartActivityPropertyKeys.otherAssignNodes] = true;
            // propertyData[StartActivityPropertyKeys.otherAssignActivities] = act.otherAssignNodes.otherAssignActivities;
            propertyData[StartActivityPropertyKeys.otherAssignActivityNodeInfos] = act.otherAssignNodes.otherAssignActivities || act.otherAssignNodes.otherAssignActivityNodeInfos;
            if (act.otherAssignNodes.otherAssignActivities) {
                act.otherAssignNodes.otherAssignActivities = null;
            }
        }
        else {
            ActivityConfig.properties = ActivityConfig.properties.concat([
                { propertyID: StartActivityPropertyKeys.otherAssignNodes, propertyName: mxResources.get('otherAssignNodes'), propertyType: 'select' }
            ]);
            propertyData[StartActivityPropertyKeys.otherAssignNodes] = false;
        }
        /** @type {?} */
        var groupList = new Array();
        try {
            for (var extendList_1 = tslib_1.__values(extendList), extendList_1_1 = extendList_1.next(); !extendList_1_1.done; extendList_1_1 = extendList_1.next()) {
                var extend = extendList_1_1.value;
                if (!extend.parentId) {
                    /** @type {?} */
                    var group = { parent: extend, childs: new Array() };
                    try {
                        for (var extendList_2 = tslib_1.__values(extendList), extendList_2_1 = extendList_2.next(); !extendList_2_1.done; extendList_2_1 = extendList_2.next()) {
                            var e = extendList_2_1.value;
                            if (e.parentId === extend.id) {
                                group.childs.push(e);
                            }
                        }
                    }
                    catch (e_2_1) { e_2 = { error: e_2_1 }; }
                    finally {
                        try {
                            if (extendList_2_1 && !extendList_2_1.done && (_b = extendList_2.return)) _b.call(extendList_2);
                        }
                        finally { if (e_2) throw e_2.error; }
                    }
                    groupList.push(group);
                }
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (extendList_1_1 && !extendList_1_1.done && (_a = extendList_1.return)) _a.call(extendList_1);
            }
            finally { if (e_1) throw e_1.error; }
        }
        // 没有扩展属性值的时候不显示扩展属性一栏
        if (groupList && groupList.length > 0) {
            /** @type {?} */
            var ExtendPropertyConfig = new ElementPropertyConfig();
            ExtendPropertyConfig.categoryId = 'extendPropertyConfig';
            ExtendPropertyConfig.categoryName = mxResources.get('extendPropertyConfig');
            ExtendPropertyConfig.tabId = 'advanced';
            ExtendPropertyConfig.tabName = mxResources.get('advancedAttributes');
            ExtendPropertyConfig.properties = new Array();
            try {
                for (var groupList_1 = tslib_1.__values(groupList), groupList_1_1 = groupList_1.next(); !groupList_1_1.done; groupList_1_1 = groupList_1.next()) {
                    var g = groupList_1_1.value;
                    ExtendPropertyConfig.properties.push({ propertyID: g.parent.id, propertyName: g.parent.propertyTitle, propertyType: 'modal' });
                    // 取回模型上的value值给到扩展属性组件里
                    if (act.extendProperties && act.extendProperties.length > 0) {
                        g.childs.sort((/**
                         * @param {?} a
                         * @param {?} b
                         * @return {?}
                         */
                        function (a, b) {
                            return a.sortOrder - b.sortOrder;
                        })).forEach((/**
                         * @param {?} d
                         * @return {?}
                         */
                        function (d) {
                            act.extendProperties.forEach((/**
                             * @param {?} e
                             * @return {?}
                             */
                            function (e) {
                                if (e.key == d.code) {
                                    d.value = e.value;
                                }
                            }));
                        }));
                    }
                    propertyData[g.parent.id] = g.childs;
                }
            }
            catch (e_3_1) { e_3 = { error: e_3_1 }; }
            finally {
                try {
                    if (groupList_1_1 && !groupList_1_1.done && (_c = groupList_1.return)) _c.call(groupList_1);
                }
                finally { if (e_3) throw e_3.error; }
            }
            // todo：与else分支代码重复，可提取至if语句外，本次修改仅针对名称多语，故暂不修改
            propertyData[StartActivityPropertyKeys.Id] = act.Id;
            propertyData[StartActivityPropertyKeys.ClrTypeID] = act.ClrTypeID;
            propertyData[StartActivityPropertyKeys.Name] = act.Name || mxResources.get('start');
            propertyData[StartActivityPropertyKeys.NameLanguage] = act.NameLanguage || {
                "zh-CHS": act.Name,
            };
            propertyData[StartActivityPropertyKeys.sendBackedTask] = act.sendBackedTask;
            propertyData[StartActivityPropertyKeys.wf_ExecuteForms_PC] =
                act.ExecuteForms ? act.ExecuteForms.find((/**
                 * @param {?} e
                 * @return {?}
                 */
                function (e) { return e.TerminalType === 'PC'; })) : null;
            propertyData[StartActivityPropertyKeys.wf_ExecuteForms_Mobile] =
                act.ExecuteForms ? act.ExecuteForms.find((/**
                 * @param {?} e
                 * @return {?}
                 */
                function (e) { return e.TerminalType === 'MOBILE'; })) : null;
            return {
                propertyConfig: [PropertyConfig, formDef, ActivityConfig, ExtendPropertyConfig],
                propertyData: propertyData
            };
        }
        else {
            propertyData[StartActivityPropertyKeys.Id] = act.Id;
            propertyData[StartActivityPropertyKeys.ClrTypeID] = act.ClrTypeID;
            propertyData[StartActivityPropertyKeys.Name] = act.Name || mxResources.get('start');
            propertyData[StartActivityPropertyKeys.NameLanguage] = act.NameLanguage || {
                "zh-CHS": act.Name,
            };
            propertyData[StartActivityPropertyKeys.sendBackedTask] = act.sendBackedTask;
            propertyData[StartActivityPropertyKeys.wf_ExecuteForms_PC] =
                act.ExecuteForms ? act.ExecuteForms.find((/**
                 * @param {?} e
                 * @return {?}
                 */
                function (e) { return e.TerminalType === 'PC'; })) : null;
            propertyData[StartActivityPropertyKeys.wf_ExecuteForms_Mobile] =
                act.ExecuteForms ? act.ExecuteForms.find((/**
                 * @param {?} e
                 * @return {?}
                 */
                function (e) { return e.TerminalType === 'MOBILE'; })) : null;
            return {
                propertyConfig: [PropertyConfig, formDef, ActivityConfig],
                propertyData: propertyData
            };
        }
    };
    /**
     * @param {?} obj
     * @return {?}
     */
    StartActivityCell.prototype.updateProps = /**
     * @param {?} obj
     * @return {?}
     */
    function (obj) {
        /** @type {?} */
        var editorUi = this.editorUi;
        /** @type {?} */
        var startActivity = this.flowElement;
        /** @type {?} */
        var propertyId = obj.propertyID;
        switch (propertyId) {
            case StartActivityPropertyKeys.wf_ExecuteForms_PC:
                this.updateStartActivityForm(startActivity, obj, 'PC');
                if (obj.parameters && obj.parameters.length > 0) {
                    PropertyHelper.updateFormalParameters(editorUi.graph.bpmnModel.DefaultProcess, obj.parameters);
                }
                break;
            case StartActivityPropertyKeys.wf_ExecuteForms_Mobile:
                this.updateStartActivityForm(startActivity, obj, 'MOBILE');
                if (obj.parameters && obj.parameters.length > 0) {
                    PropertyHelper.updateFormalParameters(editorUi.graph.bpmnModel.DefaultProcess, obj.parameters);
                }
                break;
            case StartActivityPropertyKeys.SelectTargetAble:
                this.resetSelectTargetAble(startActivity, obj);
                break;
            case StartActivityPropertyKeys.JumpScope:
                this.resetJumpScope(startActivity, obj);
                break;
            case StartActivityPropertyKeys.otherAssignNodes:
                this.updateOtherAssignNodes(startActivity, obj);
                break;
            case StartActivityPropertyKeys.otherAssignActivities:
                this.updateOtherAssignActivities(startActivity, obj);
                break;
            case StartActivityPropertyKeys.otherAssignActivityNodeInfos:
                this.updateOtherAssignActivities(startActivity, obj);
                break;
            default:
                // 判断ResourceKeys是不是groupid,是就走resetExtendProperty
                if (editorUi.procExtProps.findIndex((/**
                 * @param {?} p
                 * @return {?}
                 */
                function (p) { return p.id === propertyId; })) > -1) {
                    this.resetExtendProperty(startActivity, obj);
                }
                else {
                    _super.prototype.updateProps.call(this, obj);
                }
                break;
        }
    };
    /**
     * @param {?} start
     * @param {?} obj
     * @param {?} terminal
     * @return {?}
     */
    StartActivityCell.prototype.updateStartActivityForm = /**
     * @param {?} start
     * @param {?} obj
     * @param {?} terminal
     * @return {?}
     */
    function (start, obj, terminal) {
        var e_4, _a;
        if (start) {
            /** @type {?} */
            var form = (/** @type {?} */ (obj.propertyValue));
            if (!start.ExecuteForms) {
                start.ExecuteForms = new Array();
            }
            start.ExecuteForms = start.ExecuteForms.filter((/**
             * @param {?} e
             * @return {?}
             */
            function (e) { return e.TerminalType !== terminal; }));
            if (form) {
                /** @type {?} */
                var params = (/** @type {?} */ (form.ActualParameters));
                /** @type {?} */
                var actParas = new Array();
                if (params && params.length > 0) {
                    try {
                        for (var params_1 = tslib_1.__values(params), params_1_1 = params_1.next(); !params_1_1.done; params_1_1 = params_1.next()) {
                            var para = params_1_1.value;
                            /** @type {?} */
                            var actPara = new ActualParameter(start.Model, para.Name, para.Value);
                            if (para.Tag) {
                                actPara.Tag = para.Tag;
                            }
                            else {
                                if (para.Value) {
                                    if (para.Value.length >= 8 && para.Value.slice(0, 8) === "{\"expr\":") {
                                        actPara.Tag = 'expression';
                                    }
                                    else {
                                        actPara.Tag = 'constant';
                                    }
                                }
                                else {
                                    actPara.Tag = 'variable';
                                }
                            }
                            actParas.push(actPara);
                        }
                    }
                    catch (e_4_1) { e_4 = { error: e_4_1 }; }
                    finally {
                        try {
                            if (params_1_1 && !params_1_1.done && (_a = params_1.return)) _a.call(params_1);
                        }
                        finally { if (e_4) throw e_4.error; }
                    }
                }
                /** @type {?} */
                var id = BpmnModelHelper.GenerateElementId();
                /** @type {?} */
                var item = new ExecuteForm(start.Model, id, form.Name, actParas);
                item.ComponentId = form.ComponentId;
                item.FormType = form.FormType;
                item.formFormatId = form.formFormatId;
                item.formatConfigId = form.formatConfigId;
                item.TerminalType = form.TerminalType;
                start.ExecuteForms.push(item);
            }
        }
    };
    /**
     * 更新是否允许跳转属性
     * @param startActivity
     * @param obj
     */
    /**
     * 更新是否允许跳转属性
     * @param {?} startActivity
     * @param {?} obj
     * @return {?}
     */
    StartActivityCell.prototype.resetSelectTargetAble = /**
     * 更新是否允许跳转属性
     * @param {?} startActivity
     * @param {?} obj
     * @return {?}
     */
    function (startActivity, obj) {
        /** @type {?} */
        var selectTargetAble = (/** @type {?} */ (obj.propertyValue));
        startActivity.selectTargetAble = selectTargetAble;
        if (startActivity.selectTargetAble) {
            startActivity.jumpScope = new JumpScope(startActivity.Model);
        }
        else {
            startActivity.jumpScope = null;
        }
    };
    /**
     * @param {?} startActivity
     * @param {?} obj
     * @return {?}
     */
    StartActivityCell.prototype.resetJumpScope = /**
     * @param {?} startActivity
     * @param {?} obj
     * @return {?}
     */
    function (startActivity, obj) {
        /** @type {?} */
        var data = obj.propertyValue;
        if (data) {
            /** @type {?} */
            var jumpScope = new JumpScope(startActivity.Model);
            jumpScope.Category = data.Category;
            jumpScope.DefaultType = data.DefaultType;
            jumpScope.DefaultActivity = data.DefaultActivity;
            jumpScope.DestinationActivities = data.DestinationActivities;
            startActivity.jumpScope = jumpScope;
        }
        else {
            startActivity.jumpScope = null;
        }
    };
    /**
     * @param {?} startActivity
     * @param {?} obj
     * @return {?}
     */
    StartActivityCell.prototype.updateOtherAssignNodes = /**
     * @param {?} startActivity
     * @param {?} obj
     * @return {?}
     */
    function (startActivity, obj) {
        /** @type {?} */
        var data = obj.propertyValue;
        if (data) {
            // const otherAssignNodes = new OtherAssignNodes(startActivity.Model);
            // otherAssignNodes.otherAssignActivities = new Array();
            // startActivity.otherAssignNodes = otherAssignNodes;
            startActivity.otherAssignNodes = new OtherAssignNodes(startActivity.Model);
        }
        else {
            startActivity.otherAssignNodes = null;
        }
    };
    /**
     * @param {?} startActivity
     * @param {?} obj
     * @return {?}
     */
    StartActivityCell.prototype.updateOtherAssignActivities = /**
     * @param {?} startActivity
     * @param {?} obj
     * @return {?}
     */
    function (startActivity, obj) {
        /** @type {?} */
        var data = obj.propertyValue;
        if (data && data.length > 0) {
            if (typeof data[0] === "string") {
                startActivity.otherAssignNodes.otherAssignActivityNodeInfos = new Array();
                data.forEach((/**
                 * @param {?} d
                 * @return {?}
                 */
                function (d) {
                    /** @type {?} */
                    var other = new OtherAssignActivityNodeInfo(startActivity.Model);
                    other.activityDefinitionId = d;
                    other.required = false;
                    other.condition = new Condition(startActivity.Model);
                    startActivity.otherAssignNodes.otherAssignActivityNodeInfos.push(other);
                }));
            }
            else {
                // startActivity.otherAssignNodes.otherAssignActivityNodeInfos = [...data];  
                startActivity.otherAssignNodes.otherAssignActivityNodeInfos = new Array();
                data.forEach((/**
                 * @param {?} d
                 * @return {?}
                 */
                function (d) {
                    /** @type {?} */
                    var other = new OtherAssignActivityNodeInfo(startActivity.Model);
                    other.activityDefinitionId = d.activityDefinitionId;
                    other.required = d.required;
                    other.condition = new Condition(startActivity.Model);
                    other.condition.Value = d.condition.Value;
                    startActivity.otherAssignNodes.otherAssignActivityNodeInfos.push(other);
                }));
            }
        }
        else {
            startActivity.otherAssignNodes.otherAssignActivityNodeInfos = new Array();
        }
    };
    /**
     * 更新开始节点扩展属性
     * @param startActivity
     * @param obj
     */
    /**
     * 更新开始节点扩展属性
     * @param {?} startActivity
     * @param {?} obj
     * @return {?}
     */
    StartActivityCell.prototype.resetExtendProperty = /**
     * 更新开始节点扩展属性
     * @param {?} startActivity
     * @param {?} obj
     * @return {?}
     */
    function (startActivity, obj) {
        var e_5, _a;
        if (startActivity) {
            /** @type {?} */
            var attributes = (/** @type {?} */ (obj.propertyValue));
            if (!startActivity.extendProperties) {
                startActivity.extendProperties = new Array();
            }
            var _loop_1 = function (o) {
                /** @type {?} */
                var index = startActivity.extendProperties.findIndex((/**
                 * @param {?} e
                 * @return {?}
                 */
                function (e) { return e.key === o.code; }));
                if (index > -1) {
                    startActivity.extendProperties.splice(index, 1);
                }
            };
            try {
                for (var _b = tslib_1.__values(obj.propertyValue), _c = _b.next(); !_c.done; _c = _b.next()) {
                    var o = _c.value;
                    _loop_1(o);
                }
            }
            catch (e_5_1) { e_5 = { error: e_5_1 }; }
            finally {
                try {
                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                }
                finally { if (e_5) throw e_5.error; }
            }
            if (attributes) {
                attributes.forEach((/**
                 * @param {?} a
                 * @return {?}
                 */
                function (a) {
                    /** @type {?} */
                    var item = new ExtendProperty(startActivity.Model);
                    item.key = a.code;
                    item.value = a.value;
                    startActivity.extendProperties.push(item);
                }));
            }
        }
    };
    StartActivityCell.CLR_TYPE_ID = StartActivity.Clr_Type_ID;
    return StartActivityCell;
}(NodeCell));
export { StartActivityCell };
if (false) {
    /** @type {?} */
    StartActivityCell.CLR_TYPE_ID;
    /** @type {?} */
    StartActivityCell.prototype.clrTypeId;
    /** @type {?} */
    StartActivityCell.prototype.name;
    /** @type {?} */
    StartActivityCell.prototype.nameLanguage;
    /** @type {?} */
    StartActivityCell.prototype.flowElement;
    /** @type {?} */
    StartActivityCell.prototype.editorUi;
    /** @type {?} */
    StartActivityCell.prototype.imgUrls;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiU3RhcnRBY3Rpdml0eUNlbGwuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZ3NwLXdmL3dmLXByb2Nlc3MtZWRpdG9yLyIsInNvdXJjZXMiOlsibGliL2Rlc2lnbmVyL3dmLWNlbGwvU3RhcnRBY3Rpdml0eUNlbGwudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxPQUFPLEVBQUUsUUFBUSxFQUFFLHFCQUFxQixFQUE0QixNQUFNLHNCQUFzQixDQUFDO0FBQ2pHLE9BQU8sRUFBYSxXQUFXLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUM3RCxPQUFPLEVBQUUsZUFBZSxFQUFFLGFBQWEsRUFBRSxNQUFNLHFCQUFxQixDQUFDO0FBQ3JFLE9BQU8sRUFBRSxhQUFhLEVBQUUsY0FBYyxFQUFFLFNBQVMsRUFBRSxXQUFXLEVBQUUsZUFBZSxFQUFFLGdCQUFnQixFQUFFLDJCQUEyQixFQUFFLFNBQVMsRUFBRSxNQUFNLDBCQUEwQixDQUFDO0FBRTVLLE9BQU8sRUFBRSxXQUFXLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUM3QyxPQUFPLEVBQUUseUJBQXlCLEVBQUUsTUFBTSwyQ0FBMkMsQ0FBQztBQUN0RixPQUFPLEVBQUUsY0FBYyxFQUFFLE1BQU0sa0JBQWtCLENBQUM7Ozs7QUFLbEQ7SUFBdUMsNkNBQVE7SUFpQjNDLDJCQUFZLEtBQVcsRUFBRSxRQUErQixFQUFFLEtBQWM7O1FBQXhFLFlBQ0ksa0JBQU0sS0FBSyxFQUFFLFFBQVEsRUFBRSxLQUFLLENBQUMsU0FDaEM7UUFsQkQsZUFBUyxHQUFXLGlCQUFpQixDQUFDLFdBQVcsQ0FBQztRQUNsRCxVQUFJLEdBQVcsSUFBSSxDQUFDO1FBQ3BCLGtCQUFZLEdBQWdDO1lBQzFDLFFBQVEsRUFBRSxJQUFJO1lBQ2QsUUFBUSxFQUFFLElBQUk7WUFDZCxJQUFJLEVBQUUsT0FBTztTQUNoQixDQUFDO1FBS0EsYUFBTztZQUNILEdBQUMsYUFBYSxDQUFDLE9BQU8sSUFBRyxXQUFXLENBQUMsVUFBVSxHQUFH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IjpbImltcG9ydCB7IE5vZGVDZWxsLCBFbGVtZW50UHJvcGVydHlDb25maWcsIEZhcnJpc1Byb3BDb25maWdXaXRoRGF0YSB9IGZyb20gXCJAZWRwLXBtZi9ncmFwaGVkaXRvclwiO1xyXG5pbXBvcnQgeyBNeEdyYXBoTlMsIG14UmVzb3VyY2VzIH0gZnJvbSBcIkBlZHAtcG1mL214Z3JhcGgtdHNcIjtcclxuaW1wb3J0IHsgQnBtbk1vZGVsSGVscGVyLCBGbG93Tm9kZVN0YXRlIH0gZnJvbSBcIkBlZHAtcG1mL2JwbW4tbW9kZWxcIjtcclxuaW1wb3J0IHsgU3RhcnRBY3Rpdml0eSwgRXh0ZW5kUHJvcGVydHksIEp1bXBTY29wZSwgRXhlY3V0ZUZvcm0sIEFjdHVhbFBhcmFtZXRlciwgT3RoZXJBc3NpZ25Ob2RlcywgT3RoZXJBc3NpZ25BY3Rpdml0eU5vZGVJbmZvLCBDb25kaXRpb24gfSBmcm9tIFwiQGdzcC13Zi93Zi1wcm9jZXNzLW1vZGVsXCI7XHJcbmltcG9ydCB7IFdmRWRpdG9yVWkgfSBmcm9tIFwiLi4vV2ZFZGl0b3JVaVwiO1xyXG5pbXBvcnQgeyBXZkNvbnN0YW50cyB9IGZyb20gXCIuLi9XZkNvbnN0YW50c1wiO1xyXG5pbXBvcnQgeyBTdGFydEFjdGl2aXR5UHJvcGVydHlLZXlzIH0gZnJvbSBcIi4vcHJvcGVydHkta2V5cy9TdGFydEFjdGl2aXR5UHJvcGVydHlLZXlzXCI7XHJcbmltcG9ydCB7IFByb3BlcnR5SGVscGVyIH0gZnJvbSBcIi4vUHJvcGVydHlIZWxwZXJcIjtcclxuXHJcbi8qKlxyXG4gKiDlvIDlp4vmtLvliqjoioLngrlcclxuICovXHJcbmV4cG9ydCBjbGFzcyBTdGFydEFjdGl2aXR5Q2VsbCBleHRlbmRzIE5vZGVDZWxsIHtcclxuICAgIGNsclR5cGVJZDogc3RyaW5nID0gU3RhcnRBY3Rpdml0eUNlbGwuQ0xSX1RZUEVfSUQ7XHJcbiAgICBuYW1lOiBzdHJpbmcgPSBcIuW8gOWni1wiO1xyXG4gICAgbmFtZUxhbmd1YWdlOiB7IFtsYW5nOiBzdHJpbmddOiBzdHJpbmc7IH0gPSB7XHJcbiAgICAgIFwiemgtQ0hTXCI6IFwi5byA5aeLXCIsXHJcbiAgICAgIFwiemgtQ0hUXCI6IFwi6ZaL5aeLXCIsXHJcbiAgICAgIFwiZW5cIjogXCJTdGFydFwiLFxyXG4gIH07XHJcbiAgICBzdGF0aWMgQ0xSX1RZUEVfSUQ6IHN0cmluZyA9IFN0YXJ0QWN0aXZpdHkuQ2xyX1R5cGVfSUQ7XHJcbiAgICBmbG93RWxlbWVudDogU3RhcnRBY3Rpdml0eTtcclxuICAgIGVkaXRvclVpOiBXZkVkaXRvclVpO1xyXG5cclxuICAgIGltZ1VybHMgPSB7XHJcbiAgICAgICAgW0Zsb3dOb2RlU3RhdGUuRGVmYXVsdF06IFdmQ29uc3RhbnRzLklNQUdFX1BBVEggKyBcIi9zdGFydC5wbmdcIixcclxuICAgICAgICBbRmxvd05vZGVTdGF0ZS5TZWxlY3RlZF06IFdmQ29uc3RhbnRzLklNQUdFX1BBVEggKyBcIi9zdGFydF9zZWxlY3Quc3ZnXCIsXHJcbiAgICB9O1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKHZhbHVlPzogYW55LCBnZW9tZXRyeT86IE14R3JhcGhOUy5teEdlb21ldHJ5LCBzdHlsZT86IHN0cmluZykge1xyXG4gICAgICAgIHN1cGVyKHZhbHVlLCBnZW9tZXRyeSwgc3R5bGUpO1xyXG4gICAgfVxyXG5cclxuICAgIGNyZWF0ZUZsb3dFbGVtZW50KGZsb3dFbHQ/OiBTdGFydEFjdGl2aXR5KSB7XHJcbiAgICAgICAgY29uc3QgZmxvd05vZGUgPSBzdXBlci5jcmVhdGVGbG93RWxlbWVudChmbG93RWx0KSBhcyBTdGFydEFjdGl2aXR5O1xyXG4gICAgICAgIGNvbnN0IGVkaXRvclVpID0gdGhpcy5lZGl0b3JVaTtcclxuICAgICAgICBmbG93Tm9kZS5JZCA9IFwic3RhcnRBY3Rpdml0eVwiICsgQnBtbk1vZGVsSGVscGVyLkdlbmVyYXRlRWxlbWVudElkKCk7XHJcbiAgICAgICAgLy8g5Yib5bu66ICM6Z2e5aSN5Yi25pe25omn6KGMXHJcbiAgICAgICAgaWYgKGZsb3dFbHQgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAvLyDorr7nva7pu5jorqTooajljZVcclxuICAgICAgICAgICAgaWYgKGVkaXRvclVpICYmIGVkaXRvclVpLmZvcm1Gb3JtYXRzKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBmb3JtRm9ybWF0cyA9IGVkaXRvclVpLmZvcm1Gb3JtYXRzO1xyXG4gICAgICAgICAgICAgICAgY29uc3Qgc3RhcnRBY3Rpdml0eUZvcm1zID0gbmV3IEFycmF5KCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBwY0Zvcm0gPSBmb3JtRm9ybWF0cy5maWx0ZXIoZiA9PiBmLnRlcm1pbmFsID09PSAnUEMnICYmIGYuc3RhdHVzID09PSAxKVswXTtcclxuICAgICAgICAgICAgICAgIGlmIChwY0Zvcm0pIHtcclxuICAgICAgICAgICAgICAgICAgICBzdGFydEFjdGl2aXR5Rm9ybXMucHVzaChwY0Zvcm0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgbW9iaWxlRm9ybSA9IGZvcm1Gb3JtYXRzLmZpbHRlcihmID0+IGYudGVybWluYWwgPT09ICdNb2JpbGUnICYmIGYuc3RhdHVzID09PSAxKVswXTtcclxuICAgICAgICAgICAgICAgIGlmIChtb2JpbGVGb3JtKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3RhcnRBY3Rpdml0eUZvcm1zLnB1c2gobW9iaWxlRm9ybSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKHN0YXJ0QWN0aXZpdHlGb3JtcyAmJiBzdGFydEFjdGl2aXR5Rm9ybXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGZsb3dOb2RlLnNldERlZmF1bHRGb3JtcyhzdGFydEFjdGl2aXR5Rm9ybXMpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gZmxvd05vZGU7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0RmFycmlzUHJvcENvbmZpZygpOiBGYXJyaXNQcm9wQ29uZmlnV2l0aERhdGEge1xyXG4gICAgICAgIGNvbnN0IGVkaXRvclVpID0gdGhpcy5lZGl0b3JVaTtcclxuICAgICAgICBjb25zdCBhY3QgPSB0aGlzLmZsb3dFbGVtZW50IGFzIFN0YXJ0QWN0aXZpdHk7XHJcbiAgICAgICAgbGV0IGV4dGVuZExpc3QgPSBbXTtcclxuICAgICAgICBpZiAoZWRpdG9yVWkucHJvY0V4dFByb3BzICYmIGVkaXRvclVpLnByb2NFeHRQcm9wcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIGV4dGVuZExpc3QgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGVkaXRvclVpLnByb2NFeHRQcm9wcykpLnNvcnQoKGEsIGIpID0+IHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBhLnNvcnRPcmRlciAtIGIuc29ydE9yZGVyO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZXh0ZW5kTGlzdCA9IGV4dGVuZExpc3Quc29ydCgoYSwgYikgPT4ge1xyXG4gICAgICAgICAgICByZXR1cm4gYS5zb3J0T3JkZXIgLSBiLnNvcnRPcmRlcjtcclxuICAgICAgICB9KVxyXG5cclxuICAgICAgICBsZXQgUHJvcGVydHlDb25maWc6IEVsZW1lbnRQcm9wZXJ0eUNvbmZpZyA9IG5ldyBFbGVtZW50UHJvcGVydHlDb25maWcoKTtcclxuICAgICAgICBsZXQgcHJvcGVydHlEYXRhOiBhbnkgPSBuZXcgT2JqZWN0KCk7XHJcbiAgICAgICAgUHJvcGVydHlDb25maWcuY2F0ZWdvcnlJZCA9ICdnZW5lcmFsJztcclxuICAgICAgICBQcm9wZXJ0eUNvbmZpZy5jYXRlZ29yeU5hbWUgPSBteFJlc291cmNlcy5nZXQoJ2Jhc2ljSW5mb3JtYXRpb24nKTtcclxuICAgICAgICBQcm9wZXJ0eUNvbmZpZy50YWJJZCA9ICdiYXNpYyc7XHJcbiAgICAgICAgUHJvcGVydHlDb25maWcudGFiTmFtZSA9IG14UmVzb3VyY2VzLmdldCgnYmFzaWNBdHRyaWJ1dGVzJyk7XHJcbiAgICAgICAgUHJvcGVydHlDb25maWcucHJvcGVydGllcyA9IFtcclxuICAgICAgICAgICAgeyBwcm9wZXJ0eUlEOiBTdGFydEFjdGl2aXR5UHJvcGVydHlLZXlzLk5hbWUsIHByb3BlcnR5TmFtZTogbXhSZXNvdXJjZXMuZ2V0KCduYW1lJyksIHByb3BlcnR5VHlwZTogJ3N0cmluZycsIHZpc2libGU6ICF0aGlzLmVkaXRvclVpLm11bHRpTGFuZ0VuYWJsZWQgfSxcclxuICAgICAgICAgICAgeyBwcm9wZXJ0eUlEOiBTdGFydEFjdGl2aXR5UHJvcGVydHlLZXlzLk5hbWVMYW5ndWFnZSwgcHJvcGVydHlOYW1lOiBteFJlc291cmNlcy5nZXQoJ25hbWVMYW5ndWFnZScpLCBwcm9wZXJ0eVR5cGU6ICdtdWx0aUxhbmd1YWdlJywgdmlzaWJsZTogdGhpcy5lZGl0b3JVaS5tdWx0aUxhbmdFbmFibGVkIH0sXHJcbiAgICAgICAgICAgIHsgcHJvcGVydHlJRDogU3RhcnRBY3Rpdml0eVByb3BlcnR5S2V5cy5JZCwgcHJvcGVydHlOYW1lOiBteFJlc291cmNlcy5nZXQoJ2lkJyksIHByb3BlcnR5VHlwZTogJ3N0cmluZycsIHJlYWRvbmx5OiB0cnVlIH1cclxuICAgICAgICBdO1xyXG5cclxuICAgICAgICBsZXQgZm9ybURlZiA9IG5ldyBFbGVtZW50UHJvcGVydHlDb25maWcoKTtcclxuICAgICAgICBmb3JtRGVmLmNhdGVnb3J5SWQgPSAnZm9ybURlZic7XHJcbiAgICAgICAgZm9ybURlZi5jYXRlZ29yeU5hbWUgPSBteFJlc291cmNlcy5nZXQoJ2Zvcm1EZWYnKTtcclxuICAgICAgICBmb3JtRGVmLnRhYklkID0gJ2Jhc2ljJztcclxuICAgICAgICBmb3JtRGVmLnRhYk5hbWUgPSBteFJlc291cmNlcy5nZXQoJ2Jhc2ljQXR0cmlidXRlcycpO1xyXG4gICAgICAgIGZvcm1EZWYucHJvcGVydGllcyA9IFtcclxuICAgICAgICAgICAgeyBwcm9wZXJ0eUlEOiBTdGFydEFjdGl2aXR5UHJvcGVydHlLZXlzLndmX0V4ZWN1dGVGb3Jtc19QQywgcHJvcGVydHlOYW1lOiBteFJlc291cmNlcy5nZXQoJ3BjRm9ybScpLCBwcm9wZXJ0eVR5cGU6ICdtb2RhbCcgfSxcclxuICAgICAgICAgICAgeyBwcm9wZXJ0eUlEOiBTdGFydEFjdGl2aXR5UHJvcGVydHlLZXlzLndmX0V4ZWN1dGVGb3Jtc19Nb2JpbGUsIHByb3BlcnR5TmFtZTogbXhSZXNvdXJjZXMuZ2V0KCd3ZWJGb3JtJyksIHByb3BlcnR5VHlwZTogJ21vZGFsJyB9LFxyXG4gICAgICAgIF07XHJcblxyXG4gICAgICAgIGxldCBBY3Rpdml0eUNvbmZpZzogRWxlbWVudFByb3BlcnR5Q29uZmlnID0gbmV3IEVsZW1lbnRQcm9wZXJ0eUNvbmZpZygpO1xyXG4gICAgICAgIEFjdGl2aXR5Q29uZmlnLmNhdGVnb3J5SWQgPSAnYWN0aXZpdHlDb25maWcnO1xyXG4gICAgICAgIEFjdGl2aXR5Q29uZmlnLmNhdGVnb3J5TmFtZSA9IG14UmVzb3VyY2VzLmdldCgnYWN0aXZpdHlQcm9wZXJ0eScpO1xyXG4gICAgICAgIEFjdGl2aXR5Q29uZmlnLnRhYklkID0gJ2Jhc2ljJztcclxuICAgICAgICBBY3Rpdml0eUNvbmZpZy50YWJOYW1lID0gbXhSZXNvdXJjZXMuZ2V0KCdiYXNpY0F0dHJpYnV0ZXMnKTtcclxuICAgICAgICBBY3Rpdml0eUNvbmZpZy5wcm9wZXJ0aWVzID0gW1xyXG4gICAgICAgICAgICAvLyB7IHByb3BlcnR5SUQ6IFN0YXJ0QWN0aXZpdHlQcm9wZXJ0eUtleXMuRXhlY3V0ZUZvcm1zLCBwcm9wZXJ0eU5hbWU6IG14UmVzb3VyY2VzLmdldCgnZm9ybURlZicpLCBwcm9wZXJ0eVR5cGU6ICdtb2RhbCcgfSxcclxuICAgICAgICAgICAgeyBwcm9wZXJ0eUlEOiAnc2VuZEJhY2tlZFRhc2snLCBwcm9wZXJ0eU5hbWU6IG14UmVzb3VyY2VzLmdldCgnc2VuZEJhY2tlZFRhc2snKSwgcHJvcGVydHlUeXBlOiAnc2VsZWN0JyB9XHJcbiAgICAgICAgXTtcclxuXHJcbiAgICAgICAgaWYgKGFjdC5zZWxlY3RUYXJnZXRBYmxlKSB7XHJcbiAgICAgICAgICAgIEFjdGl2aXR5Q29uZmlnLnByb3BlcnRpZXMgPSBBY3Rpdml0eUNvbmZpZy5wcm9wZXJ0aWVzLmNvbmNhdChbXHJcbiAgICAgICAgICAgICAgICB7IHByb3BlcnR5SUQ6IFN0YXJ0QWN0aXZpdHlQcm9wZXJ0eUtleXMuU2VsZWN0VGFyZ2V0QWJsZSwgcHJvcGVydHlOYW1lOiBteFJlc291cmNlcy5nZXQoJ3NlbGVjdFRhcmdldEFibGUnKSwgcHJvcGVydHlUeXBlOiAnc2VsZWN0JyB9LFxyXG4gICAgICAgICAgICAgICAgeyBwcm9wZXJ0eUlEOiBTdGFydEFjdGl2aXR5UHJvcGVydHlLZXlzLkp1bXBTY29wZSwgcHJvcGVydHlOYW1lOiBteFJlc291cmNlcy5nZXQoJ2p1bXBTY29wZScpLCBwcm9wZXJ0eVR5cGU6ICdtb2RhbCcgfV0pO1xyXG4gICAgICAgICAgICBwcm9wZXJ0eURhdGEuU2VsZWN0VGFyZ2V0QWJsZSA9IGFjdC5zZWxlY3RUYXJnZXRBYmxlIHx8IGZhbHNlO1xyXG4gICAgICAgICAgICBwcm9wZXJ0eURhdGEuSnVtcFNjb3BlID0gYWN0Lmp1bXBTY29wZTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBBY3Rpdml0eUNvbmZpZy5wcm9wZXJ0aWVzID0gQWN0aXZpdHlDb25maWcucHJvcGVydGllcy5jb25jYXQoW1xyXG4gICAgICAgICAgICAgICAgeyBwcm9wZXJ0eUlEOiBTdGFydEFjdGl2aXR5UHJvcGVydHlLZXlzLlNlbGVjdFRhcmdldEFibGUsIHByb3BlcnR5TmFtZTogbXhSZXNvdXJjZXMuZ2V0KCdzZWxlY3RUYXJnZXRBYmxlJyksIHByb3BlcnR5VHlwZTogJ3NlbGVjdCcgfV0pO1xyXG4gICAgICAgICAgICBwcm9wZXJ0eURhdGEuU2VsZWN0VGFyZ2V0QWJsZSA9IGFjdC5zZWxlY3RUYXJnZXRBYmxlIHx8IGZhbHNlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGFjdC5vdGhlckFzc2lnbk5vZGVzKSB7XHJcbiAgICAgICAgICAgIEFjdGl2aXR5Q29uZmlnLnByb3BlcnRpZXMgPSBBY3Rpdml0eUNvbmZpZy5wcm9wZXJ0aWVzLmNvbmNhdChbXHJcbiAgICAgICAgICAgICAgICB7IHByb3BlcnR5SUQ6IFN0YXJ0QWN0aXZpdHlQcm9wZXJ0eUtleXMub3RoZXJBc3NpZ25Ob2RlcywgcHJvcGVydHlOYW1lOiBteFJlc291cmNlcy5nZXQoJ290aGVyQXNzaWduTm9kZXMnKSwgcHJvcGVydHlUeXBlOiAnc2VsZWN0JyB9LFxyXG4gICAgICAgICAgICAgICAgLy8geyBwcm9wZXJ0eUlEOiBTdGFydEFjdGl2aXR5UHJvcGVydHlLZXlzLm90aGVyQXNzaWduQWN0aXZpdGllcywgcHJvcGVydHlOYW1lOiBteFJlc291cmNlcy5nZXQoJ290aGVyQXNzaWduQWN0aXZpdGllcycpLCBwcm9wZXJ0eVR5cGU6ICdtb2RhbCcgfVxyXG4gICAgICAgICAgICAgICAgeyBwcm9wZXJ0eUlEOiBTdGFydEFjdGl2aXR5UHJvcGVydHlLZXlzLm90aGVyQXNzaWduQWN0aXZpdHlOb2RlSW5mb3MsIHByb3BlcnR5TmFtZTogbXhSZXNvdXJjZXMuZ2V0KCdvdGhlckFzc2lnbkFjdGl2aXR5Tm9kZUluZm9zJyksIHByb3BlcnR5VHlwZTogJ21vZGFsJyB9XHJcbiAgICAgICAgICAgIF0pO1xyXG4gICAgICAgICAgICBwcm9wZXJ0eURhdGFbU3RhcnRBY3Rpdml0eVByb3BlcnR5S2V5cy5vdGhlckFzc2lnbk5vZGVzXSA9IHRydWU7XHJcbiAgICAgICAgICAgIC8vIHByb3BlcnR5RGF0YVtTdGFydEFjdGl2aXR5UHJvcGVydHlLZXlzLm90aGVyQXNzaWduQWN0aXZpdGllc10gPSBhY3Qub3RoZXJBc3NpZ25Ob2Rlcy5vdGhlckFzc2lnbkFjdGl2aXRpZXM7XHJcbiAgICAgICAgICAgIHByb3BlcnR5RGF0YVtTdGFydEFjdGl2aXR5UHJvcGVydHlLZXlzLm90aGVyQXNzaWduQWN0aXZpdHlOb2RlSW5mb3NdID0gYWN0Lm90aGVyQXNzaWduTm9kZXMub3RoZXJBc3NpZ25BY3Rpdml0aWVzIHx8IGFjdC5vdGhlckFzc2lnbk5vZGVzLm90aGVyQXNzaWduQWN0aXZpdHlOb2RlSW5mb3M7XHJcbiAgICAgICAgICAgIGlmKGFjdC5vdGhlckFzc2lnbk5vZGVzLm90aGVyQXNzaWduQWN0aXZpdGllcyl7XHJcbiAgICAgICAgICAgICAgICBhY3Qub3RoZXJBc3NpZ25Ob2Rlcy5vdGhlckFzc2lnbkFjdGl2aXRpZXMgPSBudWxsO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIEFjdGl2aXR5Q29uZmlnLnByb3BlcnRpZXMgPSBBY3Rpdml0eUNvbmZpZy5wcm9wZXJ0aWVzLmNvbmNhdChbXHJcbiAgICAgICAgICAgICAgICB7IHByb3BlcnR5SUQ6IFN0YXJ0QWN0aXZpdHlQcm9wZXJ0eUtleXMub3RoZXJBc3NpZ25Ob2RlcywgcHJvcGVydHlOYW1lOiBteFJlc291cmNlcy5nZXQoJ290aGVyQXNzaWduTm9kZXMnKSwgcHJvcGVydHlUeXBlOiAnc2VsZWN0JyB9XHJcbiAgICAgICAgICAgIF0pO1xyXG4gICAgICAgICAgICBwcm9wZXJ0eURhdGFbU3RhcnRBY3Rpdml0eVByb3BlcnR5S2V5cy5vdGhlckFzc2lnbk5vZGVzXSA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgZ3JvdXBMaXN0ID0gbmV3IEFycmF5KCk7XHJcbiAgICAgICAgZm9yIChjb25zdCBleHRlbmQgb2YgZXh0ZW5kTGlzdCkge1xyXG4gICAgICAgICAgICBpZiAoIWV4dGVuZC5wYXJlbnRJZCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZ3JvdXAgPSB7IHBhcmVudDogZXh0ZW5kLCBjaGlsZHM6IG5ldyBBcnJheSgpIH07XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGUgb2YgZXh0ZW5kTGlzdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChlLnBhcmVudElkID09PSBleHRlbmQuaWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZ3JvdXAuY2hpbGRzLnB1c2goZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZ3JvdXBMaXN0LnB1c2goZ3JvdXApXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgLy8g5rKh5pyJ5omp5bGV5bGe5oCn5YC855qE5pe25YCZ5LiN5pi+56S65omp5bGV5bGe5oCn5LiA5qCPXHJcbiAgICAgICAgaWYgKGdyb3VwTGlzdCAmJiBncm91cExpc3QubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICBsZXQgRXh0ZW5kUHJvcGVydHlDb25maWc6IEVsZW1lbnRQcm9wZXJ0eUNvbmZpZyA9IG5ldyBFbGVtZW50UHJvcGVydHlDb25maWcoKTtcclxuICAgICAgICAgICAgRXh0ZW5kUHJvcGVydHlDb25maWcuY2F0ZWdvcnlJZCA9ICdleHRlbmRQcm9wZXJ0eUNvbmZpZyc7XHJcbiAgICAgICAgICAgIEV4dGVuZFByb3BlcnR5Q29uZmlnLmNhdGVnb3J5TmFtZSA9IG14UmVzb3VyY2VzLmdldCgnZXh0ZW5kUHJvcGVydHlDb25maWcnKTtcclxuICAgICAgICAgICAgRXh0ZW5kUHJvcGVydHlDb25maWcudGFiSWQgPSAnYWR2YW5jZWQnO1xyXG4gICAgICAgICAgICBFeHRlbmRQcm9wZXJ0eUNvbmZpZy50YWJOYW1lID0gbXhSZXNvdXJjZXMuZ2V0KCdhZHZhbmNlZEF0dHJpYnV0ZXMnKTtcclxuICAgICAgICAgICAgRXh0ZW5kUHJvcGVydHlDb25maWcucHJvcGVydGllcyA9IG5ldyBBcnJheSgpO1xyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IGcgb2YgZ3JvdXBMaXN0KSB7XHJcbiAgICAgICAgICAgICAgICBFeHRlbmRQcm9wZXJ0eUNvbmZpZy5wcm9wZXJ0aWVzLnB1c2goXHJcbiAgICAgICAgICAgICAgICAgICAgeyBwcm9wZXJ0eUlEOiBnLnBhcmVudC5pZCwgcHJvcGVydHlOYW1lOiBnLnBhcmVudC5wcm9wZXJ0eVRpdGxlLCBwcm9wZXJ0eVR5cGU6ICdtb2RhbCcgfSk7XHJcbiAgICAgICAgICAgICAgICAvLyDlj5blm57mqKHlnovkuIrnmoR2YWx1ZeWAvOe7meWIsOaJqeWxleWxnuaAp+e7hOS7tumHjFxyXG4gICAgICAgICAgICAgICAgaWYgKGFjdC5leHRlbmRQcm9wZXJ0aWVzICYmIGFjdC5leHRlbmRQcm9wZXJ0aWVzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICBnLmNoaWxkcy5zb3J0KChhLCBiKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhLnNvcnRPcmRlciAtIGIuc29ydE9yZGVyO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pLmZvckVhY2goKGQ6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhY3QuZXh0ZW5kUHJvcGVydGllcy5mb3JFYWNoKGUgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGUua2V5ID09IGQuY29kZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQudmFsdWUgPSBlLnZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHByb3BlcnR5RGF0YVtnLnBhcmVudC5pZF0gPSBnLmNoaWxkcztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyB0b2Rv77ya5LiOZWxzZeWIhuaUr+S7o+eggemHjeWkje+8jOWPr+aPkOWPluiHs2lm6K+t5Y+l5aSW77yM5pys5qyh5L+u5pS55LuF6ZKI5a+55ZCN56ew5aSa6K+t77yM5pWF5pqC5LiN5L+u5pS5XHJcbiAgICAgICAgICAgIHByb3BlcnR5RGF0YVtTdGFydEFjdGl2aXR5UHJvcGVydHlLZXlzLklkXSA9IGFjdC5JZDtcclxuICAgICAgICAgICAgcHJvcGVydHlEYXRhW1N0YXJ0QWN0aXZpdHlQcm9wZXJ0eUtleXMuQ2xyVHlwZUlEXSA9IGFjdC5DbHJUeXBlSUQ7XHJcbiAgICAgICAgICAgIHByb3BlcnR5RGF0YVtTdGFydEFjdGl2aXR5UHJvcGVydHlLZXlzLk5hbWVdID0gYWN0Lk5hbWUgfHwgbXhSZXNvdXJjZXMuZ2V0KCdzdGFydCcpO1xyXG4gICAgICAgICAgICBwcm9wZXJ0eURhdGFbU3RhcnRBY3Rpdml0eVByb3BlcnR5S2V5cy5OYW1lTGFuZ3VhZ2VdID0gYWN0Lk5hbWVMYW5ndWFnZSB8fCB7XHJcbiAgICAgICAgICAgICAgICBcInpoLUNIU1wiOiBhY3QuTmFtZSxcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIHByb3BlcnR5RGF0YVtTdGFydEFjdGl2aXR5UHJvcGVydHlLZXlzLnNlbmRCYWNrZWRUYXNrXSA9IGFjdC5zZW5kQmFja2VkVGFzaztcclxuXHJcbiAgICAgICAgICAgIHByb3BlcnR5RGF0YVtTdGFydEFjdGl2aXR5UHJvcGVydHlLZXlzLndmX0V4ZWN1dGVGb3Jtc19QQ10gPVxyXG4gICAgICAgICAgICAgICAgYWN0LkV4ZWN1dGVGb3JtcyA/IGFjdC5FeGVjdXRlRm9ybXMuZmluZChlID0+IGUuVGVybWluYWxUeXBlID09PSAnUEMnKSA6IG51bGw7XHJcbiAgICAgICAgICAgIHByb3BlcnR5RGF0YVtTdGFydEFjdGl2aXR5UHJvcGVydHlLZXlzLndmX0V4ZWN1dGVGb3Jtc19Nb2JpbGVdID1cclxuICAgICAgICAgICAgICAgIGFjdC5FeGVjdXRlRm9ybXMgPyBhY3QuRXhlY3V0ZUZvcm1zLmZpbmQoZSA9PiBlLlRlcm1pbmFsVHlwZSA9PT0gJ01PQklMRScpIDogbnVsbDtcclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIHByb3BlcnR5Q29uZmlnOiBbUHJvcGVydHlDb25maWcsIGZvcm1EZWYsIEFjdGl2aXR5Q29uZmlnLCBFeHRlbmRQcm9wZXJ0eUNvbmZpZ10sXHJcbiAgICAgICAgICAgICAgICBwcm9wZXJ0eURhdGE6IHByb3BlcnR5RGF0YVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcHJvcGVydHlEYXRhW1N0YXJ0QWN0aXZpdHlQcm9wZXJ0eUtleXMuSWRdID0gYWN0LklkO1xyXG4gICAgICAgICAgICBwcm9wZXJ0eURhdGFbU3RhcnRBY3Rpdml0eVByb3BlcnR5S2V5cy5DbHJUeXBlSURdID0gYWN0LkNsclR5cGVJRDtcclxuICAgICAgICAgICAgcHJvcGVydHlEYXRhW1N0YXJ0QWN0aXZpdHlQcm9wZXJ0eUtleXMuTmFtZV0gPSBhY3QuTmFtZSB8fCBteFJlc291cmNlcy5nZXQoJ3N0YXJ0Jyk7XHJcbiAgICAgICAgICAgIHByb3BlcnR5RGF0YVtTdGFydEFjdGl2aXR5UHJvcGVydHlLZXlzLk5hbWVMYW5ndWFnZV0gPSBhY3QuTmFtZUxhbmd1YWdlIHx8IHtcclxuICAgICAgICAgICAgICAgIFwiemgtQ0hTXCI6IGFjdC5OYW1lLFxyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgcHJvcGVydHlEYXRhW1N0YXJ0QWN0aXZpdHlQcm9wZXJ0eUtleXMuc2VuZEJhY2tlZFRhc2tdID0gYWN0LnNlbmRCYWNrZWRUYXNrO1xyXG5cclxuICAgICAgICAgICAgcHJvcGVydHlEYXRhW1N0YXJ0QWN0aXZpdHlQcm9wZXJ0eUtleXMud2ZfRXhlY3V0ZUZvcm1zX1BDXSA9XHJcbiAgICAgICAgICAgICAgICBhY3QuRXhlY3V0ZUZvcm1zID8gYWN0LkV4ZWN1dGVGb3Jtcy5maW5kKGUgPT4gZS5UZXJtaW5hbFR5cGUgPT09ICdQQycpIDogbnVsbDtcclxuICAgICAgICAgICAgcHJvcGVydHlEYXRhW1N0YXJ0QWN0aXZpdHlQcm9wZXJ0eUtleXMud2ZfRXhlY3V0ZUZvcm1zX01vYmlsZV0gPVxyXG4gICAgICAgICAgICAgICAgYWN0LkV4ZWN1dGVGb3JtcyA/IGFjdC5FeGVjdXRlRm9ybXMuZmluZChlID0+IGUuVGVybWluYWxUeXBlID09PSAnTU9CSUxFJykgOiBudWxsO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIHByb3BlcnR5Q29uZmlnOiBbUHJvcGVydHlDb25maWcsIGZvcm1EZWYsIEFjdGl2aXR5Q29uZmlnXSxcclxuICAgICAgICAgICAgICAgIHByb3BlcnR5RGF0YTogcHJvcGVydHlEYXRhXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgdXBkYXRlUHJvcHMob2JqOiBhbnkpIHtcclxuICAgICAgICBjb25zdCBlZGl0b3JVaSA9IHRoaXMuZWRpdG9yVWk7XHJcbiAgICAgICAgY29uc3Qgc3RhcnRBY3Rpdml0eSA9IHRoaXMuZmxvd0VsZW1lbnQ7XHJcbiAgICAgICAgY29uc3QgcHJvcGVydHlJZDogc3RyaW5nID0gb2JqLnByb3BlcnR5SUQ7XHJcbiAgICAgICAgc3dpdGNoIChwcm9wZXJ0eUlkKSB7XHJcbiAgICAgICAgICAgIGNhc2UgU3RhcnRBY3Rpdml0eVByb3BlcnR5S2V5cy53Zl9FeGVjdXRlRm9ybXNfUEM6XHJcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVN0YXJ0QWN0aXZpdHlGb3JtKHN0YXJ0QWN0aXZpdHksIG9iaiwgJ1BDJyk7XHJcbiAgICAgICAgICAgICAgICBpZiAob2JqLnBhcmFtZXRlcnMgJiYgb2JqLnBhcmFtZXRlcnMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIFByb3BlcnR5SGVscGVyLnVwZGF0ZUZvcm1hbFBhcmFtZXRlcnMoZWRpdG9yVWkuZ3JhcGguYnBtbk1vZGVsLkRlZmF1bHRQcm9jZXNzLCBvYmoucGFyYW1ldGVycyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBTdGFydEFjdGl2aXR5UHJvcGVydHlLZXlzLndmX0V4ZWN1dGVGb3Jtc19Nb2JpbGU6XHJcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVN0YXJ0QWN0aXZpdHlGb3JtKHN0YXJ0QWN0aXZpdHksIG9iaiwgJ01PQklMRScpO1xyXG4gICAgICAgICAgICAgICAgaWYgKG9iai5wYXJhbWV0ZXJzICYmIG9iai5wYXJhbWV0ZXJzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICBQcm9wZXJ0eUhlbHBlci51cGRhdGVGb3JtYWxQYXJhbWV0ZXJzKGVkaXRvclVpLmdyYXBoLmJwbW5Nb2RlbC5EZWZhdWx0UHJvY2Vzcywgb2JqLnBhcmFtZXRlcnMpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgU3RhcnRBY3Rpdml0eVByb3BlcnR5S2V5cy5TZWxlY3RUYXJnZXRBYmxlOlxyXG4gICAgICAgICAgICAgICAgdGhpcy5yZXNldFNlbGVjdFRhcmdldEFibGUoc3RhcnRBY3Rpdml0eSwgb2JqKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIFN0YXJ0QWN0aXZpdHlQcm9wZXJ0eUtleXMuSnVtcFNjb3BlOlxyXG4gICAgICAgICAgICAgICAgdGhpcy5yZXNldEp1bXBTY29wZShzdGFydEFjdGl2aXR5LCBvYmopO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgU3RhcnRBY3Rpdml0eVByb3BlcnR5S2V5cy5vdGhlckFzc2lnbk5vZGVzOlxyXG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGVPdGhlckFzc2lnbk5vZGVzKHN0YXJ0QWN0aXZpdHksIG9iaik7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBTdGFydEFjdGl2aXR5UHJvcGVydHlLZXlzLm90aGVyQXNzaWduQWN0aXZpdGllczpcclxuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlT3RoZXJBc3NpZ25BY3Rpdml0aWVzKHN0YXJ0QWN0aXZpdHksIG9iaik7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBTdGFydEFjdGl2aXR5UHJvcGVydHlLZXlzLm90aGVyQXNzaWduQWN0aXZpdHlOb2RlSW5mb3M6XHJcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZU90aGVyQXNzaWduQWN0aXZpdGllcyhzdGFydEFjdGl2aXR5LCBvYmopO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAvLyDliKTmlq1SZXNvdXJjZUtleXPmmK/kuI3mmK9ncm91cGlkLOaYr+Wwsei1sHJlc2V0RXh0ZW5kUHJvcGVydHlcclxuICAgICAgICAgICAgICAgIGlmIChlZGl0b3JVaS5wcm9jRXh0UHJvcHMuZmluZEluZGV4KHAgPT4gcC5pZCA9PT0gcHJvcGVydHlJZCkgPiAtMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVzZXRFeHRlbmRQcm9wZXJ0eShzdGFydEFjdGl2aXR5LCBvYmopO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBzdXBlci51cGRhdGVQcm9wcyhvYmopO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHVwZGF0ZVN0YXJ0QWN0aXZpdHlGb3JtKHN0YXJ0OiBTdGFydEFjdGl2aXR5LCBvYmo6IGFueSwgdGVybWluYWw6IHN0cmluZykge1xyXG4gICAgICAgIGlmIChzdGFydCkge1xyXG4gICAgICAgICAgICBsZXQgZm9ybSA9IG9iai5wcm9wZXJ0eVZhbHVlIGFzIGFueTtcclxuICAgICAgICAgICAgaWYgKCFzdGFydC5FeGVjdXRlRm9ybXMpIHtcclxuICAgICAgICAgICAgICAgIHN0YXJ0LkV4ZWN1dGVGb3JtcyA9IG5ldyBBcnJheTxFeGVjdXRlRm9ybT4oKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBzdGFydC5FeGVjdXRlRm9ybXMgPSBzdGFydC5FeGVjdXRlRm9ybXMuZmlsdGVyKGUgPT4gZS5UZXJtaW5hbFR5cGUgIT09IHRlcm1pbmFsKTtcclxuICAgICAgICAgICAgaWYgKGZvcm0pIHtcclxuICAgICAgICAgICAgICAgIGxldCBwYXJhbXMgPSBmb3JtLkFjdHVhbFBhcmFtZXRlcnMgYXMgYW55W107XHJcbiAgICAgICAgICAgICAgICBsZXQgYWN0UGFyYXMgPSBuZXcgQXJyYXk8QWN0dWFsUGFyYW1ldGVyPigpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHBhcmFtcyAmJiBwYXJhbXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAobGV0IHBhcmEgb2YgcGFyYW1zKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBhY3RQYXJhID0gbmV3IEFjdHVhbFBhcmFtZXRlcihzdGFydC5Nb2RlbCwgcGFyYS5OYW1lLCBwYXJhLlZhbHVlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBhcmEuVGFnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3RQYXJhLlRhZyA9IHBhcmEuVGFnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBhcmEuVmFsdWUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocGFyYS5WYWx1ZS5sZW5ndGggPj0gOCAmJiBwYXJhLlZhbHVlLnNsaWNlKDAsIDgpID09PSBge1wiZXhwclwiOmApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0UGFyYS5UYWcgPSAnZXhwcmVzc2lvbic7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0UGFyYS5UYWcgPSAnY29uc3RhbnQnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0UGFyYS5UYWcgPSAndmFyaWFibGUnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhY3RQYXJhcy5wdXNoKGFjdFBhcmEpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IGlkID0gQnBtbk1vZGVsSGVscGVyLkdlbmVyYXRlRWxlbWVudElkKCk7XHJcbiAgICAgICAgICAgICAgICBsZXQgaXRlbSA9IG5ldyBFeGVjdXRlRm9ybShzdGFydC5Nb2RlbCwgaWQsIGZvcm0uTmFtZSwgYWN0UGFyYXMpO1xyXG4gICAgICAgICAgICAgICAgaXRlbS5Db21wb25lbnRJZCA9IGZvcm0uQ29tcG9uZW50SWQ7XHJcbiAgICAgICAgICAgICAgICBpdGVtLkZvcm1UeXBlID0gZm9ybS5Gb3JtVHlwZTtcclxuICAgICAgICAgICAgICAgIGl0ZW0uZm9ybUZvcm1hdElkID0gZm9ybS5mb3JtRm9ybWF0SWQ7XHJcbiAgICAgICAgICAgICAgICBpdGVtLmZvcm1hdENvbmZpZ0lkID0gZm9ybS5mb3JtYXRDb25maWdJZDtcclxuICAgICAgICAgICAgICAgIGl0ZW0uVGVybWluYWxUeXBlID0gZm9ybS5UZXJtaW5hbFR5cGU7XHJcbiAgICAgICAgICAgICAgICBzdGFydC5FeGVjdXRlRm9ybXMucHVzaChpdGVtKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOabtOaWsOaYr+WQpuWFgeiuuOi3s+i9rOWxnuaAp1xyXG4gICAgICogQHBhcmFtIHN0YXJ0QWN0aXZpdHlcclxuICAgICAqIEBwYXJhbSBvYmpcclxuICAgICAqL1xyXG4gICAgcmVzZXRTZWxlY3RUYXJnZXRBYmxlKHN0YXJ0QWN0aXZpdHk6IFN0YXJ0QWN0aXZpdHksIG9iajogYW55KSB7XHJcbiAgICAgICAgY29uc3Qgc2VsZWN0VGFyZ2V0QWJsZSA9IG9iai5wcm9wZXJ0eVZhbHVlIGFzIGJvb2xlYW47XHJcbiAgICAgICAgc3RhcnRBY3Rpdml0eS5zZWxlY3RUYXJnZXRBYmxlID0gc2VsZWN0VGFyZ2V0QWJsZTtcclxuICAgICAgICBpZiAoc3RhcnRBY3Rpdml0eS5zZWxlY3RUYXJnZXRBYmxlKSB7XHJcbiAgICAgICAgICAgIHN0YXJ0QWN0aXZpdHkuanVtcFNjb3BlID0gbmV3IEp1bXBTY29wZShzdGFydEFjdGl2aXR5Lk1vZGVsKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBzdGFydEFjdGl2aXR5Lmp1bXBTY29wZSA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHJlc2V0SnVtcFNjb3BlKHN0YXJ0QWN0aXZpdHk6IFN0YXJ0QWN0aXZpdHksIG9iajogYW55KSB7XHJcbiAgICAgICAgY29uc3QgZGF0YSA9IG9iai5wcm9wZXJ0eVZhbHVlO1xyXG4gICAgICAgIGlmIChkYXRhKSB7XHJcbiAgICAgICAgICAgIGxldCBqdW1wU2NvcGUgPSBuZXcgSnVtcFNjb3BlKHN0YXJ0QWN0aXZpdHkuTW9kZWwpO1xyXG4gICAgICAgICAgICBqdW1wU2NvcGUuQ2F0ZWdvcnkgPSBkYXRhLkNhdGVnb3J5O1xyXG4gICAgICAgICAgICBqdW1wU2NvcGUuRGVmYXVsdFR5cGUgPSBkYXRhLkRlZmF1bHRUeXBlO1xyXG4gICAgICAgICAgICBqdW1wU2NvcGUuRGVmYXVsdEFjdGl2aXR5ID0gZGF0YS5EZWZhdWx0QWN0aXZpdHk7XHJcbiAgICAgICAgICAgIGp1bXBTY29wZS5EZXN0aW5hdGlvbkFjdGl2aXRpZXMgPSBkYXRhLkRlc3RpbmF0aW9uQWN0aXZpdGllcztcclxuICAgICAgICAgICAgc3RhcnRBY3Rpdml0eS5qdW1wU2NvcGUgPSBqdW1wU2NvcGU7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgc3RhcnRBY3Rpdml0eS5qdW1wU2NvcGUgPSBudWxsO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICB1cGRhdGVPdGhlckFzc2lnbk5vZGVzKHN0YXJ0QWN0aXZpdHk6IFN0YXJ0QWN0aXZpdHksIG9iajogYW55KSB7XHJcbiAgICAgICAgY29uc3QgZGF0YTogYm9vbGVhbiA9IG9iai5wcm9wZXJ0eVZhbHVlO1xyXG4gICAgICAgIGlmIChkYXRhKSB7XHJcbiAgICAgICAgICAgIC8vIGNvbnN0IG90aGVyQXNzaWduTm9kZXMgPSBuZXcgT3RoZXJBc3NpZ25Ob2RlcyhzdGFydEFjdGl2aXR5Lk1vZGVsKTtcclxuICAgICAgICAgICAgLy8gb3RoZXJBc3NpZ25Ob2Rlcy5vdGhlckFzc2lnbkFjdGl2aXRpZXMgPSBuZXcgQXJyYXkoKTtcclxuICAgICAgICAgICAgLy8gc3RhcnRBY3Rpdml0eS5vdGhlckFzc2lnbk5vZGVzID0gb3RoZXJBc3NpZ25Ob2RlcztcclxuICAgICAgICAgICAgc3RhcnRBY3Rpdml0eS5vdGhlckFzc2lnbk5vZGVzID0gbmV3IE90aGVyQXNzaWduTm9kZXMoc3RhcnRBY3Rpdml0eS5Nb2RlbCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgc3RhcnRBY3Rpdml0eS5vdGhlckFzc2lnbk5vZGVzID0gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgdXBkYXRlT3RoZXJBc3NpZ25BY3Rpdml0aWVzKHN0YXJ0QWN0aXZpdHk6IFN0YXJ0QWN0aXZpdHksIG9iajogYW55KSB7XHJcbiAgICAgICAgY29uc3QgZGF0YTphbnlbXSA9IG9iai5wcm9wZXJ0eVZhbHVlO1xyXG4gICAgICAgIGlmIChkYXRhICYmIGRhdGEubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICBpZiAodHlwZW9mIGRhdGFbMF0gPT09IFwic3RyaW5nXCIpIHtcclxuICAgICAgICAgICAgICAgIHN0YXJ0QWN0aXZpdHkub3RoZXJBc3NpZ25Ob2Rlcy5vdGhlckFzc2lnbkFjdGl2aXR5Tm9kZUluZm9zID0gbmV3IEFycmF5PE90aGVyQXNzaWduQWN0aXZpdHlOb2RlSW5mbz4oKTtcclxuICAgICAgICAgICAgICAgIGRhdGEuZm9yRWFjaChkID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgb3RoZXIgPSBuZXcgT3RoZXJBc3NpZ25BY3Rpdml0eU5vZGVJbmZvKHN0YXJ0QWN0aXZpdHkuTW9kZWwpO1xyXG4gICAgICAgICAgICAgICAgICAgIG90aGVyLmFjdGl2aXR5RGVmaW5pdGlvbklkID0gZDtcclxuICAgICAgICAgICAgICAgICAgICBvdGhlci5yZXF1aXJlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIG90aGVyLmNvbmRpdGlvbiA9IG5ldyBDb25kaXRpb24oc3RhcnRBY3Rpdml0eS5Nb2RlbCk7XHJcbiAgICAgICAgICAgICAgICAgICAgc3RhcnRBY3Rpdml0eS5vdGhlckFzc2lnbk5vZGVzLm90aGVyQXNzaWduQWN0aXZpdHlOb2RlSW5mb3MucHVzaChvdGhlcik7XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8gc3RhcnRBY3Rpdml0eS5vdGhlckFzc2lnbk5vZGVzLm90aGVyQXNzaWduQWN0aXZpdHlOb2RlSW5mb3MgPSBbLi4uZGF0YV07ICBcclxuICAgICAgICAgICAgICAgIHN0YXJ0QWN0aXZpdHkub3RoZXJBc3NpZ25Ob2Rlcy5vdGhlckFzc2lnbkFjdGl2aXR5Tm9kZUluZm9zID0gbmV3IEFycmF5PE90aGVyQXNzaWduQWN0aXZpdHlOb2RlSW5mbz4oKTtcclxuICAgICAgICAgICAgICAgIGRhdGEuZm9yRWFjaChkID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgb3RoZXIgPSBuZXcgT3RoZXJBc3NpZ25BY3Rpdml0eU5vZGVJbmZvKHN0YXJ0QWN0aXZpdHkuTW9kZWwpO1xyXG4gICAgICAgICAgICAgICAgICAgIG90aGVyLmFjdGl2aXR5RGVmaW5pdGlvbklkID0gZC5hY3Rpdml0eURlZmluaXRpb25JZDtcclxuICAgICAgICAgICAgICAgICAgICBvdGhlci5yZXF1aXJlZCA9IGQucmVxdWlyZWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgb3RoZXIuY29uZGl0aW9uID0gbmV3IENvbmRpdGlvbihzdGFydEFjdGl2aXR5Lk1vZGVsKTtcclxuICAgICAgICAgICAgICAgICAgICBvdGhlci5jb25kaXRpb24uVmFsdWUgPSBkLmNvbmRpdGlvbi5WYWx1ZTsgICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgIHN0YXJ0QWN0aXZpdHkub3RoZXJBc3NpZ25Ob2Rlcy5vdGhlckFzc2lnbkFjdGl2aXR5Tm9kZUluZm9zLnB1c2gob3RoZXIpO1xyXG4gICAgICAgICAgICAgICAgfSk7IFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgc3RhcnRBY3Rpdml0eS5vdGhlckFzc2lnbk5vZGVzLm90aGVyQXNzaWduQWN0aXZpdHlOb2RlSW5mb3MgPSBuZXcgQXJyYXkoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDmm7TmlrDlvIDlp4voioLngrnmianlsZXlsZ7mgKdcclxuICAgICAqIEBwYXJhbSBzdGFydEFjdGl2aXR5XHJcbiAgICAgKiBAcGFyYW0gb2JqXHJcbiAgICAgKi9cclxuICAgIHJlc2V0RXh0ZW5kUHJvcGVydHkoc3RhcnRBY3Rpdml0eTogU3RhcnRBY3Rpdml0eSwgb2JqOiBhbnkpIHtcclxuICAgICAgICBpZiAoc3RhcnRBY3Rpdml0eSkge1xyXG4gICAgICAgICAgICBsZXQgYXR0cmlidXRlcyA9IG9iai5wcm9wZXJ0eVZhbHVlIGFzIGFueTtcclxuICAgICAgICAgICAgaWYgKCFzdGFydEFjdGl2aXR5LmV4dGVuZFByb3BlcnRpZXMpIHtcclxuICAgICAgICAgICAgICAgIHN0YXJ0QWN0aXZpdHkuZXh0ZW5kUHJvcGVydGllcyA9IG5ldyBBcnJheTxFeHRlbmRQcm9wZXJ0eT4oKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IG8gb2Ygb2JqLnByb3BlcnR5VmFsdWUpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGluZGV4ID0gc3RhcnRBY3Rpdml0eS5leHRlbmRQcm9wZXJ0aWVzLmZpbmRJbmRleChlID0+IGUua2V5ID09PSBvLmNvZGUpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGluZGV4ID4gLTEpIHtcclxuICAgICAgICAgICAgICAgICAgICBzdGFydEFjdGl2aXR5LmV4dGVuZFByb3BlcnRpZXMuc3BsaWNlKGluZGV4LCAxKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoYXR0cmlidXRlcykge1xyXG4gICAgICAgICAgICAgICAgYXR0cmlidXRlcy5mb3JFYWNoKChhOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgaXRlbSA9IG5ldyBFeHRlbmRQcm9wZXJ0eShzdGFydEFjdGl2aXR5Lk1vZGVsKTtcclxuICAgICAgICAgICAgICAgICAgICBpdGVtLmtleSA9IGEuY29kZTtcclxuICAgICAgICAgICAgICAgICAgICBpdGVtLnZhbHVlID0gYS52YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICBzdGFydEFjdGl2aXR5LmV4dGVuZFByb3BlcnRpZXMucHVzaChpdGVtKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbiJdfQ==