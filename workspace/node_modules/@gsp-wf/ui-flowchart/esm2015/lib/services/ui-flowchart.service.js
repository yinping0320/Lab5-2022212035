/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Injectable } from '@angular/core';
import { from } from 'rxjs';
import { HttpService } from '@ecp-caf/caf-common';
import { translate } from './i18n/index';
import { map } from 'rxjs/operators';
export class UiFlowchartService {
    /**
     * @param {?} httpSvc
     */
    constructor(httpSvc) {
        this.httpSvc = httpSvc;
    }
    /**
     * @param {?} payload
     * @return {?}
     */
    getForecastProcessListByPayload(payload) {
        /** @type {?} */
        const url = '/api/runtime/wf/v1.0/processInstances/startProcess-simulation';
        return this.httpSvc.post(url, payload).pipe(map((/**
         * @param {?} re
         * @return {?}
         */
        (re) => re.procDefs)));
    }
    /**
     * @param {?} dataId
     * @return {?}
     */
    getRuntimeProcInstsByDataId(dataId) {
        if (dataId) {
            /** @type {?} */
            const url = `/api/runtime/wf/v1.0/processInstances/runtimeProcInstList?dataId=${dataId}`;
            return this.httpSvc.get(url);
        }
        else {
            return from(new Array());
        }
    }
    /**
     * @param {?} dataId
     * @return {?}
     */
    getHistoricProcInstsByDataId(dataId) {
        if (dataId) {
            /** @type {?} */
            const url = `/api/runtime/wf/v1.0/processInstances/historicProcInstList?dataId=${dataId}`;
            return this.httpSvc.get(url);
        }
        else {
            return from(new Array());
        }
    }
    /**
     * 基于流程实例ID获取流程实例
     * @param {?} procInstId 流程实例id
     * @return {?}
     */
    getProcInstanceById(procInstId) {
        /** @type {?} */
        const url = `/api/runtime/wf/v1.0/processInstances/${procInstId}`;
        return this.httpSvc.get(url);
    }
    /**
     * 基于流程实例ID获取bpmnModel
     * @param {?} procInstId
     * @return {?}
     */
    getBpmnModelbyProcInstId(procInstId) {
        /** @type {?} */
        const url = `/api/runtime/wf/v1.0/processInstances/${procInstId}/bpmnModel`;
        return this.httpSvc.get(url);
    }
    /**
     * 基于流程定义ID获取bpmnModel
     * @param {?} procDefId
     * @return {?}
     */
    getBpmnModelbyProcDefId(procDefId) {
        /** @type {?} */
        const url = `/api/runtime/wf/v1.0/procDefs/${procDefId}/bpmnModel`;
        return this.httpSvc.get(url);
    }
    /**
     * @param {?} superActInstId
     * @param {?} superProcInstId
     * @return {?}
     */
    getSubProcessInstance(superActInstId, superProcInstId) {
        if (superActInstId) {
            /** @type {?} */
            const url = `/api/runtime/wf/v1.0/processInstances/subProcInst?superActInstId=${superActInstId}&superProcInstId=${superProcInstId}`;
            return this.httpSvc.get(url);
        }
    }
    /**
     * 获取所有包含预解析的流程实例信息
     * @param {?} procInstId
     * @return {?}
     */
    getForecastProcessByProcInstId(procInstId) {
        /** @type {?} */
        const url = `/api/runtime/wf/v1.0/processInstances/${procInstId}/forecastProcess`;
        return this.httpSvc.get(url);
    }
    /**
     * 获取流程预测数据
     * @param {?} payload
     * @return {?}
     */
    getForecastProcessByPayload(payload) {
        /** @type {?} */
        const url = '/api/runtime/wf/v1.0/processInstances/forecastProcess';
        return this.httpSvc.post(url, payload);
    }
    /**
     * @param {?} procInstId
     * @return {?}
     */
    getCompleteProcessInfoByProcInstId(procInstId) {
        /** @type {?} */
        const url = `/api/runtime/wf/v1.0/processInstances/${procInstId}/flowChartInfo`;
        return this.httpSvc.get(url);
    }
    /**
     * 基于流程实例Id获取所有活动实例
     * @param {?} procInstId procInstId
     * @return {?}
     */
    getAllActiInstsbyProcInstId(procInstId) {
        /** @type {?} */
        const url = `/api/runtime/wf/v1.0/processInstances/${procInstId}/activityInstanceSlims`;
        return this.httpSvc.get(url);
    }
    /**
     * 基于流程实例ID获取所有的流转实例
     * @param {?} procInstId procInstId
     * @return {?}
     */
    getTransitionInstanceSlimsByProcInstId(procInstId) {
        /** @type {?} */
        const url = `/api/runtime/wf/v1.0/processInstances/${procInstId}/transitionInstanceSlims`;
        return this.httpSvc.get(url);
    }
    /**
     * @param {?} procInstId
     * @return {?}
     */
    getFormInfoByProcInstId(procInstId) {
        /** @type {?} */
        const url = `/api/runtime/wf/v1.0/processInstances/${procInstId}/formInfo`;
        return this.httpSvc.get(url);
    }
    /**
     * @param {?} procInstId
     * @param {?} actInstId
     * @return {?}
     */
    getFormInfoByActInstId(procInstId, actInstId) {
        /** @type {?} */
        let url = `/api/runtime/wf/v1.0/processInstances/${procInstId}/formInfo`;
        if (actInstId) {
            url += `?actInstId=${actInstId}`;
        }
        return this.httpSvc.get(url);
    }
    /**
     * 获取审批日志信息
     * @param {?} procInstId
     * @param {?=} activityDefinitionId
     * @return {?}
     */
    getWorkItemLogs(procInstId, activityDefinitionId) {
        /** @type {?} */
        const logUrl = activityDefinitionId ?
            `/api/runtime/wf/v1.0/processInstances/${procInstId}/logs?activityDefinitionId=${activityDefinitionId}` :
            `/api/runtime/wf/v1.0/processInstances/${procInstId}/logs`;
        return this.httpSvc.get(logUrl);
    }
    /**
     * @param {?} name
     * @return {?}
     */
    getI18nValue(name) {
        if (!name) {
            return '';
        }
        /** @type {?} */
        const defaultLang = localStorage.getItem('languageCode');
        /** @type {?} */
        const langData = defaultLang ? translate[defaultLang] : translate['zh-CHS'];
        /** @type {?} */
        let resultVal = '';
        if (name.indexOf('.') === -1) {
            resultVal = langData[name];
        }
        else {
            resultVal = name.split('.').reduce((/**
             * @param {?} obj
             * @param {?} key
             * @return {?}
             */
            (obj, key) => {
                if (obj) {
                    return obj[key];
                }
                else {
                    return null;
                }
            }), langData);
        }
        return resultVal;
    }
    /**
     * @param {?} processId
     * @return {?}
     */
    getProcessInstanceById(processId) {
        /** @type {?} */
        const url = `/api/runtime/wf/v1.0/processInstances/${processId}`;
        return this.httpSvc.get(url);
    }
    /**
     * @param {?} dataId
     * @return {?}
     */
    getProcInstIdByDataId(dataId) {
        /** @type {?} */
        const url = `/api/runtime/wf/v1.0/processInstances/procInstId?bizInstId=${dataId}`;
        return this.httpSvc.get(url);
    }
    /**
     * @param {?} procInstId
     * @param {?} actInstId
     * @param {?} bizInstId
     * @return {?}
     */
    retryAifCreation(procInstId, actInstId, bizInstId) {
        return this.httpSvc.post("/api/runtime/wf/v1.0/aifactivityinstance/retry", actInstId);
    }
    /**
     * 是否是外部流程第三方的任务
     * @param {?} processInstanceId 流程实例ID
     * @return {?}
     */
    ifThirdTask(processInstanceId) {
        /** @type {?} */
        const url = `/api/runtime/task/v1.0/instances/wfExternalProcess?processInstanceId=${processInstanceId}`;
        return this.httpSvc.get(url);
    }
    /**
     * 获取查看共享流程图的相关参数
     * @param {?} bizId 单据内码
     * @return {?}
     */
    getFsParamsByBizId(bizId) {
        /** @type {?} */
        const url = `/api/runtime/task/v1.0/tasks/third/bizId?bizId=${bizId}`;
        return this.httpSvc.get(url);
    }
    /**
     * 获取共享查看流程图的URL
     * @param {?} params 参数
     * @return {?}
     */
    viewFsProcessNew(params) {
        /** @type {?} */
        const url = `/api/fssp/ssp/v1.0/mybill/fswybz/viewprocess`;
        return this.httpSvc.post(url, params);
    }
    /**
     * @return {?}
     */
    getFlowChartStyleConfig() {
        /** @type {?} */
        const url = `/platform/runtime/common/web/@gsp-wf/wf-process-editor/config/cell-style-config.json`;
        return this.httpSvc.get(url);
    }
    /**
     * 获取多实例子流程
     * @param {?} actInst 活动实例
     * @param {?} superProcInstId 父流程实例id
     * @return {?}
     */
    getMutiChildInstance(actInst, superProcInstId) {
        /** @type {?} */
        const actInstId = actInst.activityInstanceId;
        /** @type {?} */
        const isMultiInstanceRoot = actInst.multiInstanceRoot || false;
        /** @type {?} */
        let url = `/api/runtime/wf/v1.0/processInstances/subProcInstList?actInstId=${actInstId}&isMultiInstanceRoot=${isMultiInstanceRoot}&superProcInstId=${superProcInstId}`;
        return this.httpSvc.get(url);
    }
}
UiFlowchartService.decorators = [
    { type: Injectable }
];
/** @nocollapse */
UiFlowchartService.ctorParameters = () => [
    { type: HttpService }
];
if (false) {
    /**
     * @type {?}
     * @private
     */
    UiFlowchartService.prototype.httpSvc;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidWktZmxvd2NoYXJ0LnNlcnZpY2UuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZ3NwLXdmL3VpLWZsb3djaGFydC8iLCJzb3VyY2VzIjpbImxpYi9zZXJ2aWNlcy91aS1mbG93Y2hhcnQuc2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUMzQyxPQUFPLEVBQWMsSUFBSSxFQUFNLE1BQU0sTUFBTSxDQUFDO0FBQzVDLE9BQU8sRUFBRSxXQUFXLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUNsRCxPQUFPLEVBQUUsU0FBUyxFQUFFLE1BQU0sY0FBYyxDQUFDO0FBRXpDLE9BQU8sRUFBRSxHQUFHLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUlyQyxNQUFNLE9BQU8sa0JBQWtCOzs7O0lBQzdCLFlBQW9CLE9BQW9CO1FBQXBCLFlBQU8sR0FBUCxPQUFPLENBQWE7SUFBSSxDQUFDOzs7OztJQUU3QywrQkFBK0IsQ0FBQyxPQUErQjs7Y0FDdkQsR0FBRyxHQUFHLCtEQUErRDtRQUMzRSxPQUFPLElBQUksQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLEdBQUcsRUFBRSxPQUFPLENBQUMsQ0FBQyxJQUFJLENBQ3pDLEdBQUc7Ozs7UUFBQyxDQUFDLEVBQU8sRUFBRSxFQUFFLENBQUMsRUFBRSxDQUFDLFFBQVEsRUFBQyxDQUM5QixDQUFDO0lBQ0osQ0FBQzs7Ozs7SUFFRCwyQkFBMkIsQ0FBQyxNQUFjO1FBQ3hDLElBQUksTUFBTSxFQUFFOztrQkFDSixHQUFHLEdBQUcsb0VBQW9FLE1BQU0sRUFBRTtZQUN4RixPQUFPLElBQUksQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1NBQzlCO2FBQU07WUFDTCxPQUFPLElBQUksQ0FBQyxJQUFJLEtBQUssRUFBRSxDQUFDLENBQUM7U0FDMUI7SUFDSCxDQUFDOzs7OztJQUVELDRCQUE0QixDQUFDLE1BQWM7UUFD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Q3RLLE9BQU8sSUFBSSxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUM7SUFDL0IsQ0FBQzs7O1lBek1GLFVBQVU7Ozs7WUFORixXQUFXOzs7Ozs7O0lBUU4scUNBQTRCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSW5qZWN0YWJsZSB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBPYnNlcnZhYmxlLCBmcm9tLCBvZiB9IGZyb20gJ3J4anMnO1xyXG5pbXBvcnQgeyBIdHRwU2VydmljZSB9IGZyb20gJ0BlY3AtY2FmL2NhZi1jb21tb24nO1xyXG5pbXBvcnQgeyB0cmFuc2xhdGUgfSBmcm9tICcuL2kxOG4vaW5kZXgnO1xyXG5pbXBvcnQgeyBGb3JlY2FzdFByb2Nlc3NQYXlsb2FkIH0gZnJvbSAnLi4vZW50aXR5L2ZvcmVjYXN0LXByb2Nlc3MtcGF5bG9hZCc7XHJcbmltcG9ydCB7IG1hcCB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcclxuaW1wb3J0IHsgQWN0aXZpdHlJbnN0YW5jZVNsaW0gfSBmcm9tICcuLi9mbG93LWNoYXJ0L2VudGl0eSc7XHJcblxyXG5ASW5qZWN0YWJsZSgpXHJcbmV4cG9ydCBjbGFzcyBVaUZsb3djaGFydFNlcnZpY2Uge1xyXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgaHR0cFN2YzogSHR0cFNlcnZpY2UpIHsgfVxyXG5cclxuICBnZXRGb3JlY2FzdFByb2Nlc3NMaXN0QnlQYXlsb2FkKHBheWxvYWQ6IEZvcmVjYXN0UHJvY2Vzc1BheWxvYWQpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgY29uc3QgdXJsID0gJy9hcGkvcnVudGltZS93Zi92MS4wL3Byb2Nlc3NJbnN0YW5jZXMvc3RhcnRQcm9jZXNzLXNpbXVsYXRpb24nO1xyXG4gICAgcmV0dXJuIHRoaXMuaHR0cFN2Yy5wb3N0KHVybCwgcGF5bG9hZCkucGlwZShcclxuICAgICAgbWFwKChyZTogYW55KSA9PiByZS5wcm9jRGVmcylcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICBnZXRSdW50aW1lUHJvY0luc3RzQnlEYXRhSWQoZGF0YUlkOiBzdHJpbmcpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgaWYgKGRhdGFJZCkge1xyXG4gICAgICBjb25zdCB1cmwgPSBgL2FwaS9ydW50aW1lL3dmL3YxLjAvcHJvY2Vzc0luc3RhbmNlcy9ydW50aW1lUHJvY0luc3RMaXN0P2RhdGFJZD0ke2RhdGFJZH1gO1xyXG4gICAgICByZXR1cm4gdGhpcy5odHRwU3ZjLmdldCh1cmwpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcmV0dXJuIGZyb20obmV3IEFycmF5KCkpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgZ2V0SGlzdG9yaWNQcm9jSW5zdHNCeURhdGFJZChkYXRhSWQ6IHN0cmluZyk6IE9ic2VydmFibGU8YW55PiB7XHJcbiAgICBpZiAoZGF0YUlkKSB7XHJcbiAgICAgIGNvbnN0IHVybCA9IGAvYXBpL3J1bnRpbWUvd2YvdjEuMC9wcm9jZXNzSW5zdGFuY2VzL2hpc3RvcmljUHJvY0luc3RMaXN0P2RhdGFJZD0ke2RhdGFJZH1gO1xyXG4gICAgICByZXR1cm4gdGhpcy5odHRwU3ZjLmdldCh1cmwpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcmV0dXJuIGZyb20obmV3IEFycmF5KCkpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog5Z+65LqO5rWB56iL5a6e5L6LSUTojrflj5bmtYHnqIvlrp7kvotcclxuICAgKiBAcGFyYW0gcHJvY0luc3RJZCDmtYHnqIvlrp7kvotpZFxyXG4gICAqL1xyXG4gIGdldFByb2NJbnN0YW5jZUJ5SWQocHJvY0luc3RJZDogc3RyaW5nKTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgIGNvbnN0IHVybCA9IGAvYXBpL3J1bnRpbWUvd2YvdjEuMC9wcm9jZXNzSW5zdGFuY2VzLyR7cHJvY0luc3RJZH1gO1xyXG4gICAgcmV0dXJuIHRoaXMuaHR0cFN2Yy5nZXQodXJsKTtcclxuICB9XHJcbiAgLyoqXHJcbiAgICog5Z+65LqO5rWB56iL5a6e5L6LSUTojrflj5ZicG1uTW9kZWxcclxuICAgKi9cclxuICBnZXRCcG1uTW9kZWxieVByb2NJbnN0SWQocHJvY0luc3RJZDogc3RyaW5nKTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgIGNvbnN0IHVybCA9IGAvYXBpL3J1bnRpbWUvd2YvdjEuMC9wcm9jZXNzSW5zdGFuY2VzLyR7cHJvY0luc3RJZH0vYnBtbk1vZGVsYDtcclxuICAgIHJldHVybiB0aGlzLmh0dHBTdmMuZ2V0KHVybCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDln7rkuo7mtYHnqIvlrprkuYlJROiOt+WPlmJwbW5Nb2RlbFxyXG4gICAqL1xyXG4gIGdldEJwbW5Nb2RlbGJ5UHJvY0RlZklkKHByb2NEZWZJZDogc3RyaW5nKTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgIGNvbnN0IHVybCA9IGAvYXBpL3J1bnRpbWUvd2YvdjEuMC9wcm9jRGVmcy8ke3Byb2NEZWZJZH0vYnBtbk1vZGVsYDtcclxuICAgIHJldHVybiB0aGlzLmh0dHBTdmMuZ2V0KHVybCk7XHJcbiAgfVxyXG5cclxuICBnZXRTdWJQcm9jZXNzSW5zdGFuY2Uoc3VwZXJBY3RJbnN0SWQ6IHN0cmluZywgc3VwZXJQcm9jSW5zdElkOiBzdHJpbmcpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgaWYgKHN1cGVyQWN0SW5zdElkKSB7XHJcbiAgICAgIGNvbnN0IHVybCA9IGAvYXBpL3J1bnRpbWUvd2YvdjEuMC9wcm9jZXNzSW5zdGFuY2VzL3N1YlByb2NJbnN0P3N1cGVyQWN0SW5zdElkPSR7c3VwZXJBY3RJbnN0SWR9JnN1cGVyUHJvY0luc3RJZD0ke3N1cGVyUHJvY0luc3RJZH1gO1xyXG4gICAgICByZXR1cm4gdGhpcy5odHRwU3ZjLmdldCh1cmwpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog6I635Y+W5omA5pyJ5YyF5ZCr6aKE6Kej5p6Q55qE5rWB56iL5a6e5L6L5L+h5oGvXHJcbiAgICovXHJcbiAgZ2V0Rm9yZWNhc3RQcm9jZXNzQnlQcm9jSW5zdElkKHByb2NJbnN0SWQ6IHN0cmluZyk6IE9ic2VydmFibGU8YW55PiB7XHJcbiAgICBjb25zdCB1cmwgPSBgL2FwaS9ydW50aW1lL3dmL3YxLjAvcHJvY2Vzc0luc3RhbmNlcy8ke3Byb2NJbnN0SWR9L2ZvcmVjYXN0UHJvY2Vzc2A7XHJcbiAgICByZXR1cm4gdGhpcy5odHRwU3ZjLmdldCh1cmwpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog6I635Y+W5rWB56iL6aKE5rWL5pWw5o2uXHJcbiAgICovXHJcbiAgZ2V0Rm9yZWNhc3RQcm9jZXNzQnlQYXlsb2FkKHBheWxvYWQ6IGFueSkge1xyXG4gICAgY29uc3QgdXJsID0gJy9hcGkvcnVudGltZS93Zi92MS4wL3Byb2Nlc3NJbnN0YW5jZXMvZm9yZWNhc3RQcm9jZXNzJztcclxuICAgIHJldHVybiB0aGlzLmh0dHBTdmMucG9zdCh1cmwsIHBheWxvYWQpO1xyXG4gIH1cclxuXHJcbiAgZ2V0Q29tcGxldGVQcm9jZXNzSW5mb0J5UHJvY0luc3RJZChwcm9jSW5zdElkOiBzdHJpbmcpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgY29uc3QgdXJsID0gYC9hcGkvcnVudGltZS93Zi92MS4wL3Byb2Nlc3NJbnN0YW5jZXMvJHtwcm9jSW5zdElkfS9mbG93Q2hhcnRJbmZvYDtcclxuICAgIHJldHVybiB0aGlzLmh0dHBTdmMuZ2V0KHVybCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDln7rkuo7mtYHnqIvlrp7kvotJZOiOt+WPluaJgOaciea0u+WKqOWunuS+i1xyXG4gICAqIEBwYXJhbSBwcm9jSW5zdElkIHByb2NJbnN0SWRcclxuICAgKi9cclxuICBnZXRBbGxBY3RpSW5zdHNieVByb2NJbnN0SWQocHJvY0luc3RJZDogc3RyaW5nKTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgIGNvbnN0IHVybCA9IGAvYXBpL3J1bnRpbWUvd2YvdjEuMC9wcm9jZXNzSW5zdGFuY2VzLyR7cHJvY0luc3RJZH0vYWN0aXZpdHlJbnN0YW5jZVNsaW1zYDtcclxuICAgIHJldHVybiB0aGlzLmh0dHBTdmMuZ2V0KHVybCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDln7rkuo7mtYHnqIvlrp7kvotJROiOt+WPluaJgOacieeahOa1gei9rOWunuS+i1xyXG4gICAqIEBwYXJhbSBwcm9jSW5zdElkIHByb2NJbnN0SWRcclxuICAgKi9cclxuICBnZXRUcmFuc2l0aW9uSW5zdGFuY2VTbGltc0J5UHJvY0luc3RJZChwcm9jSW5zdElkOiBzdHJpbmcpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgY29uc3QgdXJsID0gYC9hcGkvcnVudGltZS93Zi92MS4wL3Byb2Nlc3NJbnN0YW5jZXMvJHtwcm9jSW5zdElkfS90cmFuc2l0aW9uSW5zdGFuY2VTbGltc2A7XHJcbiAgICByZXR1cm4gdGhpcy5odHRwU3ZjLmdldCh1cmwpO1xyXG4gIH1cclxuXHJcbiAgZ2V0Rm9ybUluZm9CeVByb2NJbnN0SWQocHJvY0luc3RJZDogc3RyaW5nKTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgIGNvbnN0IHVybCA9IGAvYXBpL3J1bnRpbWUvd2YvdjEuMC9wcm9jZXNzSW5zdGFuY2VzLyR7cHJvY0luc3RJZH0vZm9ybUluZm9gO1xyXG4gICAgcmV0dXJuIHRoaXMuaHR0cFN2Yy5nZXQodXJsKTtcclxuICB9XHJcblxyXG4gIGdldEZvcm1JbmZvQnlBY3RJbnN0SWQocHJvY0luc3RJZDogc3RyaW5nLCBhY3RJbnN0SWQ6IHN0cmluZyk6IE9ic2VydmFibGU8YW55PiB7XHJcbiAgICBsZXQgdXJsID0gYC9hcGkvcnVudGltZS93Zi92MS4wL3Byb2Nlc3NJbnN0YW5jZXMvJHtwcm9jSW5zdElkfS9mb3JtSW5mb2A7XHJcbiAgICBpZiAoYWN0SW5zdElkKSB7XHJcbiAgICAgIHVybCArPSBgP2FjdEluc3RJZD0ke2FjdEluc3RJZH1gO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRoaXMuaHR0cFN2Yy5nZXQodXJsKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOiOt+WPluWuoeaJueaXpeW/l+S/oeaBr1xyXG4gICAqIEBwYXJhbSBQcm9jSW5zdElkIFByb2NJbnN0SWRcclxuICAgKiDmlrDmlLnpgKDnmoTmjqXlj6NcclxuICAgKi9cclxuICBnZXRXb3JrSXRlbUxvZ3MocHJvY0luc3RJZDogc3RyaW5nLCBhY3Rpdml0eURlZmluaXRpb25JZD86IHN0cmluZyk6IE9ic2VydmFibGU8YW55PiB7XHJcbiAgICBjb25zdCBsb2dVcmwgPSBhY3Rpdml0eURlZmluaXRpb25JZCA/XHJcbiAgICAgIGAvYXBpL3J1bnRpbWUvd2YvdjEuMC9wcm9jZXNzSW5zdGFuY2VzLyR7cHJvY0luc3RJZH0vbG9ncz9hY3Rpdml0eURlZmluaXRpb25JZD0ke2FjdGl2aXR5RGVmaW5pdGlvbklkfWAgOlxyXG4gICAgICBgL2FwaS9ydW50aW1lL3dmL3YxLjAvcHJvY2Vzc0luc3RhbmNlcy8ke3Byb2NJbnN0SWR9L2xvZ3NgO1xyXG4gICAgcmV0dXJuIHRoaXMuaHR0cFN2Yy5nZXQobG9nVXJsKTtcclxuICB9XHJcblxyXG4gIGdldEkxOG5WYWx1ZShuYW1lOiBzdHJpbmcpIHtcclxuICAgIGlmICghbmFtZSkgeyByZXR1cm4gJyc7IH1cclxuICAgIGNvbnN0IGRlZmF1bHRMYW5nID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2xhbmd1YWdlQ29kZScpO1xyXG4gICAgY29uc3QgbGFuZ0RhdGEgPSBkZWZhdWx0TGFuZyA/IHRyYW5zbGF0ZVtkZWZhdWx0TGFuZ10gOiB0cmFuc2xhdGVbJ3poLUNIUyddO1xyXG4gICAgbGV0IHJlc3VsdFZhbCA9ICcnO1xyXG4gICAgaWYgKG5hbWUuaW5kZXhPZignLicpID09PSAtMSkge1xyXG4gICAgICByZXN1bHRWYWwgPSBsYW5nRGF0YVtuYW1lXTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJlc3VsdFZhbCA9IG5hbWUuc3BsaXQoJy4nKS5yZWR1Y2UoKG9iaiwga2V5KSA9PiB7XHJcbiAgICAgICAgaWYgKG9iaikge1xyXG4gICAgICAgICAgcmV0dXJuIG9ialtrZXldO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgIH0sIGxhbmdEYXRhKTtcclxuICAgIH1cclxuICAgIHJldHVybiByZXN1bHRWYWw7XHJcbiAgfVxyXG5cclxuICBnZXRQcm9jZXNzSW5zdGFuY2VCeUlkKHByb2Nlc3NJZDogc3RyaW5nKTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgIGNvbnN0IHVybCA9IGAvYXBpL3J1bnRpbWUvd2YvdjEuMC9wcm9jZXNzSW5zdGFuY2VzLyR7cHJvY2Vzc0lkfWA7XHJcbiAgICByZXR1cm4gdGhpcy5odHRwU3ZjLmdldCh1cmwpO1xyXG4gIH1cclxuXHJcbiAgZ2V0UHJvY0luc3RJZEJ5RGF0YUlkKGRhdGFJZDogc3RyaW5nKTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgIGNvbnN0IHVybCA9IGAvYXBpL3J1bnRpbWUvd2YvdjEuMC9wcm9jZXNzSW5zdGFuY2VzL3Byb2NJbnN0SWQ/Yml6SW5zdElkPSR7ZGF0YUlkfWA7XHJcbiAgICByZXR1cm4gdGhpcy5odHRwU3ZjLmdldCh1cmwpO1xyXG4gIH1cclxuXHJcbiAgcmV0cnlBaWZDcmVhdGlvbihwcm9jSW5zdElkOiBzdHJpbmcsIGFjdEluc3RJZDogc3RyaW5nLCBiaXpJbnN0SWQ6IHN0cmluZykge1xyXG4gICAgcmV0dXJuIHRoaXMuaHR0cFN2Yy5wb3N0KFwiL2FwaS9ydW50aW1lL3dmL3YxLjAvYWlmYWN0aXZpdHlpbnN0YW5jZS9yZXRyeVwiLCBhY3RJbnN0SWQpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog5piv5ZCm5piv5aSW6YOo5rWB56iL56ys5LiJ5pa555qE5Lu75YqhXHJcbiAgICogQHBhcmFtIHByb2Nlc3NJbnN0YW5jZUlkIOa1geeoi+WunuS+i0lEXHJcbiAgICovXHJcbiAgaWZUaGlyZFRhc2socHJvY2Vzc0luc3RhbmNlSWQ6IHN0cmluZyk6IE9ic2VydmFibGU8YW55PiB7XHJcbiAgICBjb25zdCB1cmwgPSBgL2FwaS9ydW50aW1lL3Rhc2svdjEuMC9pbnN0YW5jZXMvd2ZFeHRlcm5hbFByb2Nlc3M/cHJvY2Vzc0luc3RhbmNlSWQ9JHtwcm9jZXNzSW5zdGFuY2VJZH1gO1xyXG4gICAgcmV0dXJuIHRoaXMuaHR0cFN2Yy5nZXQodXJsKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOiOt+WPluafpeeci+WFseS6q+a1geeoi+WbvueahOebuOWFs+WPguaVsFxyXG4gICAqIEBwYXJhbSBiaXpJZCDljZXmja7lhoXnoIFcclxuICAgKi9cclxuICBnZXRGc1BhcmFtc0J5Qml6SWQoYml6SWQ6IHN0cmluZyk6IE9ic2VydmFibGU8YW55PiB7XHJcbiAgICBjb25zdCB1cmwgPSBgL2FwaS9ydW50aW1lL3Rhc2svdjEuMC90YXNrcy90aGlyZC9iaXpJZD9iaXpJZD0ke2JpeklkfWA7XHJcbiAgICByZXR1cm4gdGhpcy5odHRwU3ZjLmdldCh1cmwpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog6I635Y+W5YWx5Lqr5p+l55yL5rWB56iL5Zu+55qEVVJMXHJcbiAgICogQHBhcmFtIHBhcmFtcyDlj4LmlbBcclxuICAgKi9cclxuICB2aWV3RnNQcm9jZXNzTmV3KHBhcmFtczogYW55KTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgIGNvbnN0IHVybCA9IGAvYXBpL2Zzc3Avc3NwL3YxLjAvbXliaWxsL2Zzd3liei92aWV3cHJvY2Vzc2A7XHJcbiAgICByZXR1cm4gdGhpcy5odHRwU3ZjLnBvc3QodXJsLCBwYXJhbXMpO1xyXG4gIH1cclxuXHJcblxyXG4gIGdldEZsb3dDaGFydFN0eWxlQ29uZmlnKCk6IE9ic2VydmFibGU8YW55PiB7XHJcbiAgICBjb25zdCB1cmwgPSBgL3BsYXRmb3JtL3J1bnRpbWUvY29tbW9uL3dlYi9AZ3NwLXdmL3dmLXByb2Nlc3MtZWRpdG9yL2NvbmZpZy9jZWxsLXN0eWxlLWNvbmZpZy5qc29uYDtcclxuICAgIHJldHVybiB0aGlzLmh0dHBTdmMuZ2V0KHVybCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDojrflj5blpJrlrp7kvovlrZDmtYHnqItcclxuICAgKiBAcGFyYW0gYWN0SW5zdCDmtLvliqjlrp7kvotcclxuICAgKiBAcGFyYW0gc3VwZXJQcm9jSW5zdElkIOeItua1geeoi+WunuS+i2lkXHJcbiAgICogQHJldHVybnMgXHJcbiAgICovXHJcbiAgZ2V0TXV0aUNoaWxkSW5zdGFuY2UoYWN0SW5zdDogQWN0aXZpdHlJbnN0YW5jZVNsaW0sIHN1cGVyUHJvY0luc3RJZDogc3RyaW5nKTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgIGNvbnN0IGFjdEluc3RJZCA9IGFjdEluc3QuYWN0aXZpdHlJbnN0YW5jZUlkO1xyXG4gICAgY29uc3QgaXNNdWx0aUluc3RhbmNlUm9vdCA9IGFjdEluc3QubXVsdGlJbnN0YW5jZVJvb3QgfHwgZmFsc2U7IFxyXG4gICAgbGV0IHVybCA9IGAvYXBpL3J1bnRpbWUvd2YvdjEuMC9wcm9jZXNzSW5zdGFuY2VzL3N1YlByb2NJbnN0TGlzdD9hY3RJbnN0SWQ9JHthY3RJbnN0SWR9JmlzTXVsdGlJbnN0YW5jZVJvb3Q9JHtpc011bHRpSW5zdGFuY2VSb290fSZzdXBlclByb2NJbnN0SWQ9JHtzdXBlclByb2NJbnN0SWR9YDtcclxuICAgIHJldHVybiB0aGlzLmh0dHBTdmMuZ2V0KHVybCk7XHJcbiAgfVxyXG5cclxufVxyXG4iXX0=