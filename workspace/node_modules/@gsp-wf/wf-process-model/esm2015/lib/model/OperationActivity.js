/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { BpmnModel, BpmnModelHelper } from "@edp-pmf/bpmn-model";
import { BackWardRule } from "./extension/completion-strategy/BackWardRule";
import { ConclusionItem } from "./extension/completion-strategy/ConclusionItem";
import { WorkFlowAction } from "./extension/completion-strategy/WorkFlowAction";
import { Component } from "./extension/tool/Component";
import { UserActivity } from "./flow-node/UserActivity";
import { OrganizationPotentialOwner } from "./OrganizationPotentialOwner";
import { ActivityExecutorParticipant } from "./participants/old/ActivityExecutorParticipant";
import { ComponentParticipant } from "./participants/old/ComponentParticipant";
import { MatrixParticipant } from "./participants/old/MatrixParticipant";
import { PositionParticipant } from "./participants/old/PositionParticipant";
import { ReportingLineParticipant } from "./participants/old/ReportingLineParticipant";
import { UserParticipant } from "./participants/old/UserParticipant";
import { PotentialOwnerImpl } from "./PotentialOwnerImpl";
import { HumanPerformerImpl } from "./HumanPerformerImpl";
export class OperationActivity extends UserActivity {
    /**
     * @param {?} model
     */
    constructor(model) {
        super(model);
        this.ClrTypeID = OperationActivity.Clr_Type_ID;
    }
    /**
     * @param {?} model
     * @return {?}
     */
    initConclusions(model) {
        /** @type {?} */
        let submit = new ConclusionItem(model);
        submit.Value = 'Send';
        submit.Text = '发送';
        submit.WorkFlowAction = WorkFlowAction.Forward;
        submit.IsDefault = true;
        submit.commentNecessary = false;
        this.Conclusions.push(submit);
        /** @type {?} */
        let back = new ConclusionItem(model);
        back.Value = 'Back';
        back.Text = '驳回';
        back.WorkFlowAction = WorkFlowAction.Backward;
        back.IsDefault = false;
        back.commentNecessary = true;
        this.Conclusions.push(back);
        // 审批项存在反向时，初始化驳回规则
        this.BackWardRule = new BackWardRule(model);
    }
    /**
     * @return {?}
     */
    NewInstance() {
        return new OperationActivity(this.Model);
    }
    /**
     * @return {?}
     */
    clone() {
        /** @type {?} */
        const operationActivity = new OperationActivity(this.Model);
        operationActivity.Name = this.Name;
        if (this.taskTitle) {
            operationActivity.taskTitle = this.taskTitle.clone();
        }
        /** @type {?} */
        const resourceRoles = this.GetResourceRoles();
        if (resourceRoles && resourceRoles.length > 0) {
            for (const role of resourceRoles) {
                if (role instanceof UserParticipant) {
                    /** @type {?} */
                    const user = (/** @type {?} */ (role));
                    /** @type {?} */
                    const userParticipant = user.clone();
                    operationActivity.AddResourceRole(userParticipant);
                }
                else if (role instanceof PositionParticipant) {
                    /** @type {?} */
                    const position = (/** @type {?} */ (role));
                    /** @type {?} */
                    const positionParticipant = position.clone();
                    operationActivity.AddResourceRole(positionParticipant);
                }
                else if (role instanceof ReportingLineParticipant) {
                    /** @type {?} */
                    const reportingLine = (/** @type {?} */ (role));
                    /** @type {?} */
                    const reportingLineParticipant = reportingLine.clone();
                    operationActivity.AddResourceRole(reportingLineParticipant);
                }
                else if (role instanceof ActivityExecutorParticipant) {
                    /** @type {?} */
                    const activityExecutor = (/** @type {?} */ (role));
                    /** @type {?} */
                    const activityExecutorParticipant = activityExecutor.clone();
                    operationActivity.AddResourceRole(activityExecutorParticipant);
                }
                else if (role instanceof ComponentParticipant) {
                    /** @type {?} */
                    const component = (/** @type {?} */ (role));
                    /** @type {?} */
                    const componentParticipant = component.clone();
                    operationActivity.AddResourceRole(componentParticipant);
                }
                else if (role instanceof MatrixParticipant) {
                    /** @type {?} */
                    const matrix = (/** @type {?} */ (role));
                    /** @type {?} */
                    const matrixParticipant = matrix.clone();
                    operationActivity.AddResourceRole(matrixParticipant);
                }
                else if (role instanceof OrganizationPotentialOwner) {
                    /** @type {?} */
                    const org = (/** @type {?} */ (role));
                    /** @type {?} */
                    const organizationPotentialOwner = org.clone();
                    operationActivity.AddResourceRole(organizationPotentialOwner);
                    // 2023-5-31 复制人工操作节点没带上参与者 发现是缺少HumanPerformerImpl和PotentialOwnerImpl
                }
                else if (role instanceof HumanPerformerImpl) {
                    /** @type {?} */
                    const performer = (/** @type {?} */ (role));
                    /** @type {?} */
                    const humanPerformerImpl = performer.clone();
                    operationActivity.AddResourceRole(humanPerformerImpl);
                }
                else if (role instanceof PotentialOwnerImpl) {
                    /** @type {?} */
                    const owner = (/** @type {?} */ (role));
                    /** @type {?} */
                    const potentialOwnerImpl = owner.clone();
                    operationActivity.AddResourceRole(potentialOwnerImpl);
                }
            }
        }
        operationActivity.ParticipantSchemes = new Array();
        if (this.ParticipantSchemes && this.ParticipantSchemes.length > 0) {
            for (const s of this.ParticipantSchemes) {
                /** @type {?} */
                const scheme = s.clone();
                operationActivity.ParticipantSchemes.push(scheme);
            }
        }
        if (this.ParticipantSetting) {
            operationActivity.ParticipantSetting = this.ParticipantSetting.clone();
        }
        operationActivity.AssignmentStrategy = this.AssignmentStrategy;
        if (this.AssignPerformerConfig) {
            operationActivity.AssignPerformerConfig = this.AssignPerformerConfig.clone();
        }
        operationActivity.PerformerNotFundExecption = this.PerformerNotFundExecption;
        operationActivity.Retrievable = this.Retrievable;
        operationActivity.IsRollback = this.IsRollback;
        operationActivity.SelectBranch = this.SelectBranch;
        operationActivity.NotifyAble = this.NotifyAble;
        operationActivity.AddSignFrontAble = this.AddSignFrontAble;
        operationActivity.AddSignBehindAble = this.AddSignBehindAble;
        operationActivity.Priority = this.Priority;
        operationActivity.ExecuteWorkItemMode = this.ExecuteWorkItemMode;
        operationActivity.DisplayTerminal = this.DisplayTerminal;
        operationActivity.SelectTargetAble = this.SelectTargetAble;
        if (this.JumpScope) {
            operationActivity.JumpScope = this.JumpScope.clone();
        }
        if (this.BackWardRule) {
            operationActivity.BackWardRule = this.BackWardRule.clone();
        }
        operationActivity.transferAble = this.transferAble;
        operationActivity.ExecuteForms = new Array();
        if (this.ExecuteForms && this.ExecuteForms.length > 0) {
            for (const f of this.ExecuteForms) {
                /** @type {?} */
                const executeForm = f.clone();
                operationActivity.ExecuteForms.push(executeForm);
            }
        }
        operationActivity.customizeActions = new Array();
        if (this.customizeActions && this.customizeActions.length > 0) {
            for (const a of this.customizeActions) {
                /** @type {?} */
                const customizeAction = a.clone();
                operationActivity.customizeActions.push(customizeAction);
            }
        }
        operationActivity.CounterSignRules = new Array();
        if (this.CounterSignRules && this.CounterSignRules.length > 0) {
            for (const r of this.CounterSignRules) {
                /** @type {?} */
                const counterSignRule = r.clone();
                operationActivity.CounterSignRules.push(counterSignRule);
            }
        }
        operationActivity.AdhocActivitySecurities = new Array();
        if (this.AdhocActivitySecurities && this.AdhocActivitySecurities.length > 0) {
            for (const s of this.AdhocActivitySecurities) {
                operationActivity.AdhocActivitySecurities.push(s);
            }
        }
        // TODO: 这个好像暂时还没启用，赋空值
        operationActivity.NotificationList = new Array();
        operationActivity.anonymous = this.anonymous;
        operationActivity.anonymousText = this.anonymousText;
        operationActivity.BizActivityID = this.BizActivityID;
        operationActivity.BizActivityName = this.BizActivityName;
        operationActivity.Conclusions = new Array();
        if (this.Conclusions && this.Conclusions.length > 0) {
            for (const c of this.Conclusions) {
                /** @type {?} */
                const conclusion = c.clone();
                operationActivity.Conclusions.push(conclusion);
            }
        }
        operationActivity.Tools = new Array();
        if (this.Tools && this.Tools.length > 0) {
            for (const t of this.Tools) {
                if (t instanceof Component) {
                    /** @type {?} */
                    const c = (/** @type {?} */ (t));
                    /** @type {?} */
                    const tool = c.clone();
                    operationActivity.Tools.push(tool);
                }
            }
        }
        // TODO: 这个好像暂时还没启用，赋空值
        operationActivity.BizParameters = new Array();
        if (this.timeLimitControl) {
            operationActivity.timeLimitControl = this.timeLimitControl.clone();
        }
        operationActivity.variableSettings = new Array();
        if (this.variableSettings && this.variableSettings.length > 0) {
            for (const v of this.variableSettings) {
                /** @type {?} */
                const variableSetting = v.clone();
                operationActivity.variableSettings.push(variableSetting);
            }
        }
        operationActivity.messageNotices = new Array();
        if (this.messageNotices && this.messageNotices.length > 0) {
            for (const m of this.messageNotices) {
                /** @type {?} */
                const messageNotice = m.clone();
                operationActivity.messageNotices.push(messageNotice);
            }
        }
        if (this.approvalPivotConfig) {
            operationActivity.approvalPivotConfig = this.approvalPivotConfig.clone();
        }
        if (this.urgeHandleRule) {
            operationActivity.urgeHandleRule = this.urgeHandleRule.clone();
        }
        return operationActivity;
    }
}
OperationActivity.Clr_Type_ID = "wf.OperationActivity";
OperationActivity.MEXTAG = 'wf.OperationActivity';
if (false) {
    /** @type {?} */
    OperationActivity.Clr_Type_ID;
    /**
     * @type {?}
     * @protected
     */
    OperationActivity.MEXTAG;
    /** @type {?} */
    OperationActivity.prototype.ClrTypeID;
}
BpmnModelHelper.RegisterElementType(new OperationActivity(new BpmnModel()));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiT3BlcmF0aW9uQWN0aXZpdHkuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZ3NwLXdmL3dmLXByb2Nlc3MtbW9kZWwvIiwic291cmNlcyI6WyJsaWIvbW9kZWwvT3BlcmF0aW9uQWN0aXZpdHkudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQUUsZUFBZSxFQUFnRSxNQUFNLHFCQUFxQixDQUFDO0FBQy9ILE9BQU8sRUFBRSxZQUFZLEVBQUUsTUFBTSw4Q0FBOEMsQ0FBQztBQUM1RSxPQUFPLEVBQUUsY0FBYyxFQUFFLE1BQU0sZ0RBQWdELENBQUM7QUFDaEYsT0FBTyxFQUFFLGNBQWMsRUFBRSxNQUFNLGdEQUFnRCxDQUFDO0FBQ2hGLE9BQU8sRUFBRSxTQUFTLEVBQUUsTUFBTSw0QkFBNEIsQ0FBQztBQUN2RCxPQUFPLEVBQUUsWUFBWSxFQUFFLE1BQU0sMEJBQTBCLENBQUM7QUFDeEQsT0FBTyxFQUFFLDBCQUEwQixFQUFFLE1BQU0sOEJBQThCLENBQUM7QUFDMUUsT0FBTyxFQUFFLDJCQUEyQixFQUFFLE1BQU0sZ0RBQWdELENBQUM7QUFDN0YsT0FBTyxFQUFFLG9CQUFvQixFQUFFLE1BQU0seUNBQXlDLENBQUM7QUFDL0UsT0FBTyxFQUFFLGlCQUFpQixFQUFFLE1BQU0sc0NBQXNDLENBQUM7QUFDekUsT0FBTyxFQUFFLG1CQUFtQixFQUFFLE1BQU0sd0NBQXdDLENBQUM7QUFDN0UsT0FBTyxFQUFFLHdCQUF3QixFQUFFLE1BQU0sNkNBQTZDLENBQUM7QUFDdkYsT0FBTyxFQUFFLGVBQWUsRUFBRSxNQUFNLG9DQUFvQyxDQUFDO0FBQ3JFLE9BQU8sRUFBRSxrQkFBa0IsRUFBRSxNQUFNLHNCQUFzQixDQUFDO0FBQzFELE9BQU8sRUFBRSxrQkFBa0IsRUFBRSxNQUFNLHNCQUFzQixDQUFDO0FBRTFELE1BQU0sT0FBTyxpQkFBa0IsU0FBUSxZQUFZOzs7O0lBS2pELFlBQVksS0FBZ0I7UUFDMUIsS0FBSyxDQUFD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QUFlLENBQUMsQ0FBQzthQUMxRDtTQUNGO1FBRUQsaUJBQWlCLENBQUMsY0FBYyxHQUFHLElBQUksS0FBSyxFQUFFLENBQUM7UUFDL0MsSUFBSSxJQUFJLENBQUMsY0FBYyxJQUFJLElBQUksQ0FBQyxjQUFjLENBQUMsTUFBTSxHQUFHLENBQUMsRUFBRTtZQUN6RCxLQUFLLE1BQU0sQ0FBQyxJQUFJLElBQUksQ0FBQyxjQUFjLEVBQUU7O3NCQUM3QixhQUFhLEdBQUcsQ0FBQyxDQUFDLEtBQUssRUFBRTtnQkFDL0IsaUJBQWlCLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxhQUFhLENBQUMsQ0FBQzthQUN0RDtTQUNGO1FBQ0QsSUFBSSxJQUFJLENBQUMsbUJBQW1CLEVBQUU7WUFDNUIsaUJBQWlCLENBQUMsbUJBQW1CLEdBQUcsSUFBSSxDQUFDLG1CQUFtQixDQUFDLEtBQUssRUFBRSxDQUFDO1NBQzFFO1FBQ0QsSUFBSSxJQUFJLENBQUMsY0FBYyxFQUFFO1lBQ3ZCLGlCQUFpQixDQUFDLGNBQWMsR0FBRyxJQUFJLENBQUMsY0FBYyxDQUFDLEtBQUssRUFBRSxDQUFDO1NBQ2hFO1FBQ0QsT0FBTyxpQkFBaUIsQ0FBQztJQUMzQixDQUFDOztBQW5NTSw2QkFBVyxHQUFXLHNCQUFzQixDQUFDO0FBRW5DLHdCQUFNLEdBQVcsc0JBQXNCLENBQUM7OztJQUZ6RCw4QkFBb0Q7Ozs7O0lBRXBELHlCQUF5RDs7SUFEekQsc0NBQWtEOztBQW9NcEQsZUFBZSxDQUFDLG1CQUFtQixDQUFDLElBQUksaUJBQWlCLENBQUMsSUFBSSxTQUFTLEVBQUUsQ0FBQyxDQUFDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBCcG1uTW9kZWwsIEJwbW5Nb2RlbEhlbHBlciwgRXh0ZW5zaW9uRWxlbWVudCwgRXh0ZW5zaW9uTWV0aG9kLCBWYWxpZGF0aW9uRXJyb3IsIFVzZXJUYXNrIH0gZnJvbSBcIkBlZHAtcG1mL2JwbW4tbW9kZWxcIjtcclxuaW1wb3J0IHsgQmFja1dhcmRSdWxlIH0gZnJvbSBcIi4vZXh0ZW5zaW9uL2NvbXBsZXRpb24tc3RyYXRlZ3kvQmFja1dhcmRSdWxlXCI7XHJcbmltcG9ydCB7IENvbmNsdXNpb25JdGVtIH0gZnJvbSBcIi4vZXh0ZW5zaW9uL2NvbXBsZXRpb24tc3RyYXRlZ3kvQ29uY2x1c2lvbkl0ZW1cIjtcclxuaW1wb3J0IHsgV29ya0Zsb3dBY3Rpb24gfSBmcm9tIFwiLi9leHRlbnNpb24vY29tcGxldGlvbi1zdHJhdGVneS9Xb3JrRmxvd0FjdGlvblwiO1xyXG5pbXBvcnQgeyBDb21wb25lbnQgfSBmcm9tIFwiLi9leHRlbnNpb24vdG9vbC9Db21wb25lbnRcIjtcclxuaW1wb3J0IHsgVXNlckFjdGl2aXR5IH0gZnJvbSBcIi4vZmxvdy1ub2RlL1VzZXJBY3Rpdml0eVwiO1xyXG5pbXBvcnQgeyBPcmdhbml6YXRpb25Qb3RlbnRpYWxPd25lciB9IGZyb20gXCIuL09yZ2FuaXphdGlvblBvdGVudGlhbE93bmVyXCI7XHJcbmltcG9ydCB7IEFjdGl2aXR5RXhlY3V0b3JQYXJ0aWNpcGFudCB9IGZyb20gXCIuL3BhcnRpY2lwYW50cy9vbGQvQWN0aXZpdHlFeGVjdXRvclBhcnRpY2lwYW50XCI7XHJcbmltcG9ydCB7IENvbXBvbmVudFBhcnRpY2lwYW50IH0gZnJvbSBcIi4vcGFydGljaXBhbnRzL29sZC9Db21wb25lbnRQYXJ0aWNpcGFudFwiO1xyXG5pbXBvcnQgeyBNYXRyaXhQYXJ0aWNpcGFudCB9IGZyb20gXCIuL3BhcnRpY2lwYW50cy9vbGQvTWF0cml4UGFydGljaXBhbnRcIjtcclxuaW1wb3J0IHsgUG9zaXRpb25QYXJ0aWNpcGFudCB9IGZyb20gXCIuL3BhcnRpY2lwYW50cy9vbGQvUG9zaXRpb25QYXJ0aWNpcGFudFwiO1xyXG5pbXBvcnQgeyBSZXBvcnRpbmdMaW5lUGFydGljaXBhbnQgfSBmcm9tIFwiLi9wYXJ0aWNpcGFudHMvb2xkL1JlcG9ydGluZ0xpbmVQYXJ0aWNpcGFudFwiO1xyXG5pbXBvcnQgeyBVc2VyUGFydGljaXBhbnQgfSBmcm9tIFwiLi9wYXJ0aWNpcGFudHMvb2xkL1VzZXJQYXJ0aWNpcGFudFwiO1xyXG5pbXBvcnQgeyBQb3RlbnRpYWxPd25lckltcGwgfSBmcm9tIFwiLi9Qb3RlbnRpYWxPd25lckltcGxcIjtcclxuaW1wb3J0IHsgSHVtYW5QZXJmb3JtZXJJbXBsIH0gZnJvbSBcIi4vSHVtYW5QZXJmb3JtZXJJbXBsXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgT3BlcmF0aW9uQWN0aXZpdHkgZXh0ZW5kcyBVc2VyQWN0aXZpdHkge1xyXG4gIHN0YXRpYyBDbHJfVHlwZV9JRDogc3RyaW5nID0gXCJ3Zi5PcGVyYXRpb25BY3Rpdml0eVwiO1xyXG4gIENsclR5cGVJRDogc3RyaW5nID0gT3BlcmF0aW9uQWN0aXZpdHkuQ2xyX1R5cGVfSUQ7XHJcbiAgcHJvdGVjdGVkIHN0YXRpYyBNRVhUQUc6IHN0cmluZyA9ICd3Zi5PcGVyYXRpb25BY3Rpdml0eSc7XHJcblxyXG4gIGNvbnN0cnVjdG9yKG1vZGVsOiBCcG1uTW9kZWwpIHtcclxuICAgIHN1cGVyKG1vZGVsKTtcclxuICB9XHJcblxyXG4gIGluaXRDb25jbHVzaW9ucyhtb2RlbDogQnBtbk1vZGVsKSB7XHJcbiAgICBsZXQgc3VibWl0ID0gbmV3IENvbmNsdXNpb25JdGVtKG1vZGVsKTtcclxuICAgIHN1Ym1pdC5WYWx1ZSA9ICdTZW5kJztcclxuICAgIHN1Ym1pdC5UZXh0ID0gJ+WPkemAgSc7XHJcbiAgICBzdWJtaXQuV29ya0Zsb3dBY3Rpb24gPSBXb3JrRmxvd0FjdGlvbi5Gb3J3YXJkO1xyXG4gICAgc3VibWl0LklzRGVmYXVsdCA9IHRydWU7XHJcbiAgICBzdWJtaXQuY29tbWVudE5lY2Vzc2FyeSA9IGZhbHNlO1xyXG4gICAgdGhpcy5Db25jbHVzaW9ucy5wdXNoKHN1Ym1pdCk7XHJcblxyXG4gICAgbGV0IGJhY2sgPSBuZXcgQ29uY2x1c2lvbkl0ZW0obW9kZWwpO1xyXG4gICAgYmFjay5WYWx1ZSA9ICdCYWNrJztcclxuICAgIGJhY2suVGV4dCA9ICfpqbPlm54nO1xyXG4gICAgYmFjay5Xb3JrRmxvd0FjdGlvbiA9IFdvcmtGbG93QWN0aW9uLkJhY2t3YXJkO1xyXG4gICAgYmFjay5Jc0RlZmF1bHQgPSBmYWxzZTtcclxuICAgIGJhY2suY29tbWVudE5lY2Vzc2FyeSA9IHRydWU7XHJcbiAgICB0aGlzLkNvbmNsdXNpb25zLnB1c2goYmFjayk7XHJcblxyXG4gICAgLy8g5a6h5om56aG55a2Y5Zyo5Y+N5ZCR5pe277yM5Yid5aeL5YyW6amz5Zue6KeE5YiZXHJcbiAgICB0aGlzLkJhY2tXYXJkUnVsZSA9IG5ldyBCYWNrV2FyZFJ1bGUobW9kZWwpO1xyXG4gIH1cclxuXHJcbiAgTmV3SW5zdGFuY2UoKTogT3BlcmF0aW9uQWN0aXZpdHkge1xyXG4gICAgcmV0dXJuIG5ldyBPcGVyYXRpb25BY3Rpdml0eSh0aGlzLk1vZGVsKTtcclxuICB9XHJcblxyXG4gIGNsb25lKCk6IE9wZXJhdGlvbkFjdGl2aXR5IHtcclxuICAgIGNvbnN0IG9wZXJhdGlvbkFjdGl2aXR5ID0gbmV3IE9wZXJhdGlvbkFjdGl2aXR5KHRoaXMuTW9kZWwpO1xyXG4gICAgb3BlcmF0aW9uQWN0aXZpdHkuTmFtZSA9IHRoaXMuTmFtZTtcclxuICAgIGlmICh0aGlzLnRhc2tUaXRsZSkge1xyXG4gICAgICBvcGVyYXRpb25BY3Rpdml0eS50YXNrVGl0bGUgPSB0aGlzLnRhc2tUaXRsZS5jbG9uZSgpO1xyXG4gICAgfVxyXG4gICAgY29uc3QgcmVzb3VyY2VSb2xlcyA9IHRoaXMuR2V0UmVzb3VyY2VSb2xlcygpO1xyXG4gICAgaWYgKHJlc291cmNlUm9sZXMgJiYgcmVzb3VyY2VSb2xlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgIGZvciAoY29uc3Qgcm9sZSBvZiByZXNvdXJjZVJvbGVzKSB7XHJcbiAgICAgICAgaWYgKHJvbGUgaW5zdGFuY2VvZiBVc2VyUGFydGljaXBhbnQpIHtcclxuICAgICAgICAgIGNvbnN0IHVzZXIgPSByb2xlIGFzIFVzZXJQYXJ0aWNpcGFudDtcclxuICAgICAgICAgIGNvbnN0IHVzZXJQYXJ0aWNpcGFudCA9IHVzZXIuY2xvbmUoKTtcclxuICAgICAgICAgIG9wZXJhdGlvbkFjdGl2aXR5LkFkZFJlc291cmNlUm9sZSh1c2VyUGFydGljaXBhbnQpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAocm9sZSBpbnN0YW5jZW9mIFBvc2l0aW9uUGFydGljaXBhbnQpIHtcclxuICAgICAgICAgIGNvbnN0IHBvc2l0aW9uID0gcm9sZSBhcyBQb3NpdGlvblBhcnRpY2lwYW50O1xyXG4gICAgICAgICAgY29uc3QgcG9zaXRpb25QYXJ0aWNpcGFudCA9IHBvc2l0aW9uLmNsb25lKCk7XHJcbiAgICAgICAgICBvcGVyYXRpb25BY3Rpdml0eS5BZGRSZXNvdXJjZVJvbGUocG9zaXRpb25QYXJ0aWNpcGFudCk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChyb2xlIGluc3RhbmNlb2YgUmVwb3J0aW5nTGluZVBhcnRpY2lwYW50KSB7XHJcbiAgICAgICAgICBjb25zdCByZXBvcnRpbmdMaW5lID0gcm9sZSBhcyBSZXBvcnRpbmdMaW5lUGFydGljaXBhbnQ7XHJcbiAgICAgICAgICBjb25zdCByZXBvcnRpbmdMaW5lUGFydGljaXBhbnQgPSByZXBvcnRpbmdMaW5lLmNsb25lKCk7XHJcbiAgICAgICAgICBvcGVyYXRpb25BY3Rpdml0eS5BZGRSZXNvdXJjZVJvbGUocmVwb3J0aW5nTGluZVBhcnRpY2lwYW50KTtcclxuICAgICAgICB9IGVsc2UgaWYgKHJvbGUgaW5zdGFuY2VvZiBBY3Rpdml0eUV4ZWN1dG9yUGFydGljaXBhbnQpIHtcclxuICAgICAgICAgIGNvbnN0IGFjdGl2aXR5RXhlY3V0b3IgPSByb2xlIGFzIEFjdGl2aXR5RXhlY3V0b3JQYXJ0aWNpcGFudDtcclxuICAgICAgICAgIGNvbnN0IGFjdGl2aXR5RXhlY3V0b3JQYXJ0aWNpcGFudCA9IGFjdGl2aXR5RXhlY3V0b3IuY2xvbmUoKTtcclxuICAgICAgICAgIG9wZXJhdGlvbkFjdGl2aXR5LkFkZFJlc291cmNlUm9sZShhY3Rpdml0eUV4ZWN1dG9yUGFydGljaXBhbnQpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAocm9sZSBpbnN0YW5jZW9mIENvbXBvbmVudFBhcnRpY2lwYW50KSB7XHJcbiAgICAgICAgICBjb25zdCBjb21wb25lbnQgPSByb2xlIGFzIENvbXBvbmVudFBhcnRpY2lwYW50O1xyXG4gICAgICAgICAgY29uc3QgY29tcG9uZW50UGFydGljaXBhbnQgPSBjb21wb25lbnQuY2xvbmUoKTtcclxuICAgICAgICAgIG9wZXJhdGlvbkFjdGl2aXR5LkFkZFJlc291cmNlUm9sZShjb21wb25lbnRQYXJ0aWNpcGFudCk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChyb2xlIGluc3RhbmNlb2YgTWF0cml4UGFydGljaXBhbnQpIHtcclxuICAgICAgICAgIGNvbnN0IG1hdHJpeCA9IHJvbGUgYXMgTWF0cml4UGFydGljaXBhbnQ7XHJcbiAgICAgICAgICBjb25zdCBtYXRyaXhQYXJ0aWNpcGFudCA9IG1hdHJpeC5jbG9uZSgpO1xyXG4gICAgICAgICAgb3BlcmF0aW9uQWN0aXZpdHkuQWRkUmVzb3VyY2VSb2xlKG1hdHJpeFBhcnRpY2lwYW50KTtcclxuICAgICAgICB9IGVsc2UgaWYgKHJvbGUgaW5zdGFuY2VvZiBPcmdhbml6YXRpb25Qb3RlbnRpYWxPd25lcikge1xyXG4gICAgICAgICAgY29uc3Qgb3JnID0gcm9sZSBhcyBPcmdhbml6YXRpb25Qb3RlbnRpYWxPd25lcjtcclxuICAgICAgICAgIGNvbnN0IG9yZ2FuaXphdGlvblBvdGVudGlhbE93bmVyID0gb3JnLmNsb25lKCk7XHJcbiAgICAgICAgICBvcGVyYXRpb25BY3Rpdml0eS5BZGRSZXNvdXJjZVJvbGUob3JnYW5pemF0aW9uUG90ZW50aWFsT3duZXIpO1xyXG4gICAgICAgICAgLy8gMjAyMy01LTMxIOWkjeWItuS6uuW3peaTjeS9nOiKgueCueayoeW4puS4iuWPguS4juiAhSDlj5HnjrDmmK/nvLrlsJFIdW1hblBlcmZvcm1lckltcGzlkoxQb3RlbnRpYWxPd25lckltcGxcclxuICAgICAgICB9IGVsc2UgaWYgKHJvbGUgaW5zdGFuY2VvZiBIdW1hblBlcmZvcm1lckltcGwpIHtcclxuICAgICAgICAgIGNvbnN0IHBlcmZvcm1lciA9IHJvbGUgYXMgSHVtYW5QZXJmb3JtZXJJbXBsO1xyXG4gICAgICAgICAgY29uc3QgaHVtYW5QZXJmb3JtZXJJbXBsID0gcGVyZm9ybWVyLmNsb25lKCk7XHJcbiAgICAgICAgICBvcGVyYXRpb25BY3Rpdml0eS5BZGRSZXNvdXJjZVJvbGUoaHVtYW5QZXJmb3JtZXJJbXBsKTtcclxuICAgICAgICB9IGVsc2UgaWYgKHJvbGUgaW5zdGFuY2VvZiBQb3RlbnRpYWxPd25lckltcGwpIHtcclxuICAgICAgICAgIGNvbnN0IG93bmVyID0gcm9sZSBhcyBQb3RlbnRpYWxPd25lckltcGw7XHJcbiAgICAgICAgICBjb25zdCBwb3RlbnRpYWxPd25lckltcGwgPSBvd25lci5jbG9uZSgpO1xyXG4gICAgICAgICAgb3BlcmF0aW9uQWN0aXZpdHkuQWRkUmVzb3VyY2VSb2xlKHBvdGVudGlhbE93bmVySW1wbCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBvcGVyYXRpb25BY3Rpdml0eS5QYXJ0aWNpcGFudFNjaGVtZXMgPSBuZXcgQXJyYXkoKTtcclxuICAgIGlmICh0aGlzLlBhcnRpY2lwYW50U2NoZW1lcyAmJiB0aGlzLlBhcnRpY2lwYW50U2NoZW1lcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgIGZvciAoY29uc3QgcyBvZiB0aGlzLlBhcnRpY2lwYW50U2NoZW1lcykge1xyXG4gICAgICAgIGNvbnN0IHNjaGVtZSA9IHMuY2xvbmUoKTtcclxuICAgICAgICBvcGVyYXRpb25BY3Rpdml0eS5QYXJ0aWNpcGFudFNjaGVtZXMucHVzaChzY2hlbWUpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBpZiAodGhpcy5QYXJ0aWNpcGFudFNldHRpbmcpIHtcclxuICAgICAgb3BlcmF0aW9uQWN0aXZpdHkuUGFydGljaXBhbnRTZXR0aW5nID0gdGhpcy5QYXJ0aWNpcGFudFNldHRpbmcuY2xvbmUoKTtcclxuICAgIH1cclxuICAgIG9wZXJhdGlvbkFjdGl2aXR5LkFzc2lnbm1lbnRTdHJhdGVneSA9IHRoaXMuQXNzaWdubWVudFN0cmF0ZWd5O1xyXG4gICAgaWYgKHRoaXMuQXNzaWduUGVyZm9ybWVyQ29uZmlnKSB7XHJcbiAgICAgIG9wZXJhdGlvbkFjdGl2aXR5LkFzc2lnblBlcmZvcm1lckNvbmZpZyA9IHRoaXMuQXNzaWduUGVyZm9ybWVyQ29uZmlnLmNsb25lKCk7XHJcbiAgICB9XHJcblxyXG4gICAgb3BlcmF0aW9uQWN0aXZpdHkuUGVyZm9ybWVyTm90RnVuZEV4ZWNwdGlvbiA9IHRoaXMuUGVyZm9ybWVyTm90RnVuZEV4ZWNwdGlvbjtcclxuICAgIG9wZXJhdGlvbkFjdGl2aXR5LlJldHJpZXZhYmxlID0gdGhpcy5SZXRyaWV2YWJsZTtcclxuICAgIG9wZXJhdGlvbkFjdGl2aXR5LklzUm9sbGJhY2sgPSB0aGlzLklzUm9sbGJhY2s7XHJcbiAgICBvcGVyYXRpb25BY3Rpdml0eS5TZWxlY3RCcmFuY2ggPSB0aGlzLlNlbGVjdEJyYW5jaDtcclxuICAgIG9wZXJhdGlvbkFjdGl2aXR5Lk5vdGlmeUFibGUgPSB0aGlzLk5vdGlmeUFibGU7XHJcbiAgICBvcGVyYXRpb25BY3Rpdml0eS5BZGRTaWduRnJvbnRBYmxlID0gdGhpcy5BZGRTaWduRnJvbnRBYmxlO1xyXG4gICAgb3BlcmF0aW9uQWN0aXZpdHkuQWRkU2lnbkJlaGluZEFibGUgPSB0aGlzLkFkZFNpZ25CZWhpbmRBYmxlO1xyXG4gICAgb3BlcmF0aW9uQWN0aXZpdHkuUHJpb3JpdHkgPSB0aGlzLlByaW9yaXR5O1xyXG4gICAgb3BlcmF0aW9uQWN0aXZpdHkuRXhlY3V0ZVdvcmtJdGVtTW9kZSA9IHRoaXMuRXhlY3V0ZVdvcmtJdGVtTW9kZTtcclxuICAgIG9wZXJhdGlvbkFjdGl2aXR5LkRpc3BsYXlUZXJtaW5hbCA9IHRoaXMuRGlzcGxheVRlcm1pbmFsO1xyXG5cclxuICAgIG9wZXJhdGlvbkFjdGl2aXR5LlNlbGVjdFRhcmdldEFibGUgPSB0aGlzLlNlbGVjdFRhcmdldEFibGU7XHJcbiAgICBpZiAodGhpcy5KdW1wU2NvcGUpIHtcclxuICAgICAgb3BlcmF0aW9uQWN0aXZpdHkuSnVtcFNjb3BlID0gdGhpcy5KdW1wU2NvcGUuY2xvbmUoKTtcclxuICAgIH1cclxuICAgIGlmICh0aGlzLkJhY2tXYXJkUnVsZSkge1xyXG4gICAgICBvcGVyYXRpb25BY3Rpdml0eS5CYWNrV2FyZFJ1bGUgPSB0aGlzLkJhY2tXYXJkUnVsZS5jbG9uZSgpO1xyXG4gICAgfVxyXG4gICAgb3BlcmF0aW9uQWN0aXZpdHkudHJhbnNmZXJBYmxlID0gdGhpcy50cmFuc2ZlckFibGU7XHJcbiAgICBvcGVyYXRpb25BY3Rpdml0eS5FeGVjdXRlRm9ybXMgPSBuZXcgQXJyYXkoKTtcclxuICAgIGlmICh0aGlzLkV4ZWN1dGVGb3JtcyAmJiB0aGlzLkV4ZWN1dGVGb3Jtcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgIGZvciAoY29uc3QgZiBvZiB0aGlzLkV4ZWN1dGVGb3Jtcykge1xyXG4gICAgICAgIGNvbnN0IGV4ZWN1dGVGb3JtID0gZi5jbG9uZSgpO1xyXG4gICAgICAgIG9wZXJhdGlvbkFjdGl2aXR5LkV4ZWN1dGVGb3Jtcy5wdXNoKGV4ZWN1dGVGb3JtKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgb3BlcmF0aW9uQWN0aXZpdHkuY3VzdG9taXplQWN0aW9ucyA9IG5ldyBBcnJheSgpO1xyXG4gICAgaWYgKHRoaXMuY3VzdG9taXplQWN0aW9ucyAmJiB0aGlzLmN1c3RvbWl6ZUFjdGlvbnMubGVuZ3RoID4gMCkge1xyXG4gICAgICBmb3IgKGNvbnN0IGEgb2YgdGhpcy5jdXN0b21pemVBY3Rpb25zKSB7XHJcbiAgICAgICAgY29uc3QgY3VzdG9taXplQWN0aW9uID0gYS5jbG9uZSgpO1xyXG4gICAgICAgIG9wZXJhdGlvbkFjdGl2aXR5LmN1c3RvbWl6ZUFjdGlvbnMucHVzaChjdXN0b21pemVBY3Rpb24pO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBvcGVyYXRpb25BY3Rpdml0eS5Db3VudGVyU2lnblJ1bGVzID0gbmV3IEFycmF5KCk7XHJcbiAgICBpZiAodGhpcy5Db3VudGVyU2lnblJ1bGVzICYmIHRoaXMuQ291bnRlclNpZ25SdWxlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgIGZvciAoY29uc3QgciBvZiB0aGlzLkNvdW50ZXJTaWduUnVsZXMpIHtcclxuICAgICAgICBjb25zdCBjb3VudGVyU2lnblJ1bGUgPSByLmNsb25lKCk7XHJcbiAgICAgICAgb3BlcmF0aW9uQWN0aXZpdHkuQ291bnRlclNpZ25SdWxlcy5wdXNoKGNvdW50ZXJTaWduUnVsZSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIG9wZXJhdGlvbkFjdGl2aXR5LkFkaG9jQWN0aXZpdHlTZWN1cml0aWVzID0gbmV3IEFycmF5KCk7XHJcbiAgICBpZiAodGhpcy5BZGhvY0FjdGl2aXR5U2VjdXJpdGllcyAmJiB0aGlzLkFkaG9jQWN0aXZpdHlTZWN1cml0aWVzLmxlbmd0aCA+IDApIHtcclxuICAgICAgZm9yIChjb25zdCBzIG9mIHRoaXMuQWRob2NBY3Rpdml0eVNlY3VyaXRpZXMpIHtcclxuICAgICAgICBvcGVyYXRpb25BY3Rpdml0eS5BZGhvY0FjdGl2aXR5U2VjdXJpdGllcy5wdXNoKHMpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICAvLyBUT0RPOiDov5nkuKrlpb3lg4/mmoLml7bov5jmsqHlkK/nlKjvvIzotYvnqbrlgLxcclxuICAgIG9wZXJhdGlvbkFjdGl2aXR5Lk5vdGlmaWNhdGlvbkxpc3QgPSBuZXcgQXJyYXkoKTtcclxuXHJcbiAgICBvcGVyYXRpb25BY3Rpdml0eS5hbm9ueW1vdXMgPSB0aGlzLmFub255bW91cztcclxuICAgIG9wZXJhdGlvbkFjdGl2aXR5LmFub255bW91c1RleHQgPSB0aGlzLmFub255bW91c1RleHQ7XHJcbiAgICBvcGVyYXRpb25BY3Rpdml0eS5CaXpBY3Rpdml0eUlEID0gdGhpcy5CaXpBY3Rpdml0eUlEO1xyXG4gICAgb3BlcmF0aW9uQWN0aXZpdHkuQml6QWN0aXZpdHlOYW1lID0gdGhpcy5CaXpBY3Rpdml0eU5hbWU7XHJcblxyXG4gICAgb3BlcmF0aW9uQWN0aXZpdHkuQ29uY2x1c2lvbnMgPSBuZXcgQXJyYXkoKTtcclxuICAgIGlmICh0aGlzLkNvbmNsdXNpb25zICYmIHRoaXMuQ29uY2x1c2lvbnMubGVuZ3RoID4gMCkge1xyXG4gICAgICBmb3IgKGNvbnN0IGMgb2YgdGhpcy5Db25jbHVzaW9ucykge1xyXG4gICAgICAgIGNvbnN0IGNvbmNsdXNpb24gPSBjLmNsb25lKCk7XHJcbiAgICAgICAgb3BlcmF0aW9uQWN0aXZpdHkuQ29uY2x1c2lvbnMucHVzaChjb25jbHVzaW9uKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgb3BlcmF0aW9uQWN0aXZpdHkuVG9vbHMgPSBuZXcgQXJyYXkoKTtcclxuICAgIGlmICh0aGlzLlRvb2xzICYmIHRoaXMuVG9vbHMubGVuZ3RoID4gMCkge1xyXG4gICAgICBmb3IgKGNvbnN0IHQgb2YgdGhpcy5Ub29scykge1xyXG4gICAgICAgIGlmICh0IGluc3RhbmNlb2YgQ29tcG9uZW50KSB7XHJcbiAgICAgICAgICBjb25zdCBjID0gdCBhcyBDb21wb25lbnQ7XHJcbiAgICAgICAgICBjb25zdCB0b29sID0gYy5jbG9uZSgpO1xyXG4gICAgICAgICAgb3BlcmF0aW9uQWN0aXZpdHkuVG9vbHMucHVzaCh0b29sKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIC8vIFRPRE86IOi/meS4quWlveWDj+aaguaXtui/mOayoeWQr+eUqO+8jOi1i+epuuWAvFxyXG4gICAgb3BlcmF0aW9uQWN0aXZpdHkuQml6UGFyYW1ldGVycyA9IG5ldyBBcnJheSgpO1xyXG4gICAgaWYgKHRoaXMudGltZUxpbWl0Q29udHJvbCkge1xyXG4gICAgICBvcGVyYXRpb25BY3Rpdml0eS50aW1lTGltaXRDb250cm9sID0gdGhpcy50aW1lTGltaXRDb250cm9sLmNsb25lKCk7XHJcbiAgICB9XHJcbiAgICBvcGVyYXRpb25BY3Rpdml0eS52YXJpYWJsZVNldHRpbmdzID0gbmV3IEFycmF5KCk7XHJcbiAgICBpZiAodGhpcy52YXJpYWJsZVNldHRpbmdzICYmIHRoaXMudmFyaWFibGVTZXR0aW5ncy5sZW5ndGggPiAwKSB7XHJcbiAgICAgIGZvciAoY29uc3QgdiBvZiB0aGlzLnZhcmlhYmxlU2V0dGluZ3MpIHtcclxuICAgICAgICBjb25zdCB2YXJpYWJsZVNldHRpbmcgPSB2LmNsb25lKCk7XHJcbiAgICAgICAgb3BlcmF0aW9uQWN0aXZpdHkudmFyaWFibGVTZXR0aW5ncy5wdXNoKHZhcmlhYmxlU2V0dGluZyk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBvcGVyYXRpb25BY3Rpdml0eS5tZXNzYWdlTm90aWNlcyA9IG5ldyBBcnJheSgpO1xyXG4gICAgaWYgKHRoaXMubWVzc2FnZU5vdGljZXMgJiYgdGhpcy5tZXNzYWdlTm90aWNlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgIGZvciAoY29uc3QgbSBvZiB0aGlzLm1lc3NhZ2VOb3RpY2VzKSB7XHJcbiAgICAgICAgY29uc3QgbWVzc2FnZU5vdGljZSA9IG0uY2xvbmUoKTtcclxuICAgICAgICBvcGVyYXRpb25BY3Rpdml0eS5tZXNzYWdlTm90aWNlcy5wdXNoKG1lc3NhZ2VOb3RpY2UpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBpZiAodGhpcy5hcHByb3ZhbFBpdm90Q29uZmlnKSB7XHJcbiAgICAgIG9wZXJhdGlvbkFjdGl2aXR5LmFwcHJvdmFsUGl2b3RDb25maWcgPSB0aGlzLmFwcHJvdmFsUGl2b3RDb25maWcuY2xvbmUoKTtcclxuICAgIH1cclxuICAgIGlmICh0aGlzLnVyZ2VIYW5kbGVSdWxlKSB7XHJcbiAgICAgIG9wZXJhdGlvbkFjdGl2aXR5LnVyZ2VIYW5kbGVSdWxlID0gdGhpcy51cmdlSGFuZGxlUnVsZS5jbG9uZSgpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIG9wZXJhdGlvbkFjdGl2aXR5O1xyXG4gIH1cclxufVxyXG5CcG1uTW9kZWxIZWxwZXIuUmVnaXN0ZXJFbGVtZW50VHlwZShuZXcgT3BlcmF0aW9uQWN0aXZpdHkobmV3IEJwbW5Nb2RlbCgpKSk7XHJcbiJdfQ==