/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { BpmnModel, BpmnModelHelper, ExtensionElement, ExtensionMethod } from "@edp-pmf/bpmn-model";
import { AutomaticApprovalRule } from "../AutomaticApprovalRule";
export class ParticipantSetting extends ExtensionElement {
    /**
     * @param {?} model
     */
    constructor(model) {
        super(model);
        this.ClrTypeID = ParticipantSetting.Clr_Type_ID;
        this.MexTag = 'ParticipantSetting';
        this.NoPerformerStrategy = 'leave';
        this.HistoricFirst = false;
    }
    /**
     * @protected
     * @return {?}
     */
    resetBeforeLoadFrom() {
        super.ResetBeforeLoadFrom();
        this.NoPerformerStrategy = 'leave';
        this.HistoricFirst = true;
        this.ExclusionPerformers = new Array();
        this.automaticPerformers = new Array();
        this.automaticApprovalRules = new Array();
    }
    /**
     * @return {?}
     */
    ConvertToJsonObject() {
        /** @type {?} */
        let obj = super.ConvertToJsonObject();
        BpmnModelHelper.SetAttributeValue(obj, "ExclusionPerformers", this.ExclusionPerformers);
        BpmnModelHelper.SetAttributeValue(obj, "AutomaticPerformers", this.automaticPerformers);
        BpmnModelHelper.SetAttributeValue(obj, "NoPerformerStrategy", this.NoPerformerStrategy);
        BpmnModelHelper.SetAttributeValue(obj, "HistoricFirst", this.HistoricFirst);
        BpmnModelHelper.SetAttributeValue(obj, "Neighboring", this.Neighboring);
        if (this.automaticApprovalRules && this.automaticApprovalRules.length > 0) {
            /** @type {?} */
            const rules = new Array();
            for (const a of this.automaticApprovalRules) {
                rules.push(a.ConvertToJsonObject());
            }
            BpmnModelHelper.SetAttributeValue(obj, "AutomaticApprovalRules", rules);
        }
        return obj;
    }
    /**
     * @param {?} obj
     * @return {?}
     */
    LoadFromJsonObject(obj) {
        super.LoadFromJsonObject(obj);
        this.ExclusionPerformers = obj.ExclusionPerformers;
        this.NoPerformerStrategy = obj.NoPerformerStrategy;
        this.HistoricFirst = obj.HistoricFirst;
        this.Neighboring = obj.Neighboring;
        this.automaticPerformers = ExtensionMethod.GetAttributeValue(obj, "AutomaticPerformers");
        this.automaticApprovalRules = new Array();
        /** @type {?} */
        const rules = ExtensionMethod.GetAttributeValue(obj, "AutomaticApprovalRules");
        if (rules && rules.length > 0) {
            for (const r of rules) {
                /** @type {?} */
                const automaticApprovalRule = new AutomaticApprovalRule(this.Model);
                automaticApprovalRule.LoadFromJsonObject(r);
                this.automaticApprovalRules.push(automaticApprovalRule);
            }
        }
    }
    /**
     * @return {?}
     */
    NewInstance() {
        return new ParticipantSetting(this.Model);
    }
    /**
     * @return {?}
     */
    clone() {
        /** @type {?} */
        const participantSetting = new ParticipantSetting(this.Model);
        participantSetting.ExclusionPerformers = new Array();
        if (this.ExclusionPerformers && this.ExclusionPerformers.length > 0) {
            for (const e of this.ExclusionPerformers) {
                participantSetting.ExclusionPerformers.push(e);
            }
        }
        participantSetting.NoPerformerStrategy = this.NoPerformerStrategy;
        participantSetting.HistoricFirst = this.HistoricFirst;
        participantSetting.Neighboring = this.Neighboring;
        participantSetting.automaticPerformers = new Array();
        if (this.automaticPerformers && this.automaticPerformers.length > 0) {
            for (const a of this.automaticPerformers) {
                participantSetting.automaticPerformers.push(a);
            }
        }
        participantSetting.automaticApprovalRules = new Array();
        if (this.automaticApprovalRules && this.automaticApprovalRules.length > 0) {
            for (const r of this.automaticApprovalRules) {
                /** @type {?} */
                const automaticApprovalRule = r.clone();
                participantSetting.automaticApprovalRules.push(automaticApprovalRule);
            }
        }
        return participantSetting;
    }
}
ParticipantSetting.Clr_Type_ID = "wf.ParticipantSetting";
if (false) {
    /** @type {?} */
    ParticipantSetting.Clr_Type_ID;
    /** @type {?} */
    ParticipantSetting.prototype.ClrTypeID;
    /** @type {?} */
    ParticipantSetting.prototype.MexTag;
    /**
     * 参与者排除项
     * 场景示例：流程发起人不参与审批、已审人员不参与审批、上一活动审批人不参与审批、利益相关人（取自表单字段：报销人、排除本单位。。。假象的）
     * 为了保持扩展性，此处引用参与者Id，使用参与者解析器解析
     * @type {?}
     */
    ParticipantSetting.prototype.ExclusionPerformers;
    /**
     * 找不到参与者时处理策略：throwException, leave
     * @type {?}
     */
    ParticipantSetting.prototype.NoPerformerStrategy;
    /**
     * 再次进入该节点时，参与人为该节点的已办人员
     * 主要用于驳回和重新提交至驳回节点的场景
     * @type {?}
     */
    ParticipantSetting.prototype.HistoricFirst;
    /**
     * 连岗审批：同一办理人在相邻节点任务仅办理一次，下一环节自动完成
     * 与exclusionPerformers设置“上一活动审批人不参与审批”冲突
     * @type {?}
     */
    ParticipantSetting.prototype.Neighboring;
    /**
     * 自动审批项
     * 场景示例：流程发起人不参与审批、已审人员不参与审批、上一活动审批人不参与审批、利益相关人（取自表单字段：报销人、排除本单位。。。假象的）
     * 为了保持扩展性，此处引用参与者Id，使用参与者解析器解析
     * @type {?}
     */
    ParticipantSetting.prototype.automaticPerformers;
    /**
     * 自动审批规则List
     * @type {?}
     */
    ParticipantSetting.prototype.automaticApprovalRules;
}
BpmnModelHelper.RegisterElementType(new ParticipantSetting(new BpmnModel()));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiUGFydGljaXBhbnRTZXR0aW5nLmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGdzcC13Zi93Zi1wcm9jZXNzLW1vZGVsLyIsInNvdXJjZXMiOlsibGliL21vZGVsL3BhcnRpY2lwYW50cy9QYXJ0aWNpcGFudFNldHRpbmcudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQUUsZUFBZSxFQUFFLGdCQUFnQixFQUFtQixlQUFlLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUNySCxPQUFPLEVBQUUscUJBQXFCLEVBQUUsTUFBTSwwQkFBMEIsQ0FBQztBQUVqRSxNQUFNLE9BQU8sa0JBQW1CLFNBQVEsZ0JBQWdCOzs7O0lBeUNwRCxZQUFZLEtBQWdCO1FBQ3hCLEtBQUssQ0FBQyxLQUFLLENBQUMsQ0FBQztRQXZDUixjQUFTLEdBQVcsa0JBQWtCLENBQUMsV0FBVyxDQUFDO1FBQzVELFdBQU0sR0FBVyxvQkFBb0IsQ0FBQztRQXVDbEMsSUFBSSxDQUFDLG1CQUFtQixHQUFHLE9BQU8sQ0FBQztRQUNuQyxJQUFJLENBQUMsYUFBYSxHQUFHLEtBQUssQ0FBQztJQUMvQixDQUFDOzs7OztJQUVTLG1CQUFtQjtRQUN6QixLQUFLLENBQUMsbUJBQW1CLEVBQUUsQ0FBQztRQUM1QixJQUFJLENBQUMsbUJBQW1CLEdBQUcsT0FBTyxDQUFDO1FBQ25DLElBQUksQ0FBQyxhQUFhLEdBQUcsSUFBSSxDQUFDO1FBQzFCLElBQUksQ0FBQyxtQkFBbUIsR0FBRyxJQUFJLEtBQUssRUFBRSxDQUFDO1FBQ3ZDLElBQUksQ0FBQyxtQkFBbUIsR0FBRyxJQUFJLEtBQUssRUFBRSxDQUFDO1FBQ3ZDLElBQUksQ0FBQyxzQkFBc0IsR0FBRyxJQUFJLEtBQUssRUFBRSxDQUFDO0lBQzlDLENBQUM7Ozs7SUFFRCxtQkFBbUI7O1lBQ1gsR0FBRyxHQUFHLEtBQUssQ0FBQyxtQkFBbUIsRUFBRTtRQUNyQyxlQUFlLENBQUMsaUJBQWlCLENBQUMsR0FBRyxF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RUFBRSxDQUFDLENBQUMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEJwbW5Nb2RlbCwgQnBtbk1vZGVsSGVscGVyLCBFeHRlbnNpb25FbGVtZW50LCBJQ2xyVHlwZUVsZW1lbnQsIEV4dGVuc2lvbk1ldGhvZCB9IGZyb20gXCJAZWRwLXBtZi9icG1uLW1vZGVsXCI7XHJcbmltcG9ydCB7IEF1dG9tYXRpY0FwcHJvdmFsUnVsZSB9IGZyb20gXCIuLi9BdXRvbWF0aWNBcHByb3ZhbFJ1bGVcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBQYXJ0aWNpcGFudFNldHRpbmcgZXh0ZW5kcyBFeHRlbnNpb25FbGVtZW50IGltcGxlbWVudHMgSUNsclR5cGVFbGVtZW50IHtcclxuXHJcbiAgICBzdGF0aWMgQ2xyX1R5cGVfSUQ6IHN0cmluZyA9IFwid2YuUGFydGljaXBhbnRTZXR0aW5nXCI7XHJcbiAgICByZWFkb25seSBDbHJUeXBlSUQ6IHN0cmluZyA9IFBhcnRpY2lwYW50U2V0dGluZy5DbHJfVHlwZV9JRDtcclxuICAgIE1leFRhZzogc3RyaW5nID0gJ1BhcnRpY2lwYW50U2V0dGluZyc7XHJcblxyXG4gICAgLyoqXHJcbiAgICAqIOWPguS4juiAheaOkumZpOmhuVxyXG4gICAgKiDlnLrmma/npLrkvovvvJrmtYHnqIvlj5HotbfkurrkuI3lj4LkuI7lrqHmibnjgIHlt7LlrqHkurrlkZjkuI3lj4LkuI7lrqHmibnjgIHkuIrkuIDmtLvliqjlrqHmibnkurrkuI3lj4LkuI7lrqHmibnjgIHliKnnm4rnm7jlhbPkurrvvIjlj5boh6rooajljZXlrZfmrrXvvJrmiqXplIDkurrjgIHmjpLpmaTmnKzljZXkvY3jgILjgILjgILlgYfosaHnmoTvvIlcclxuICAgICog5Li65LqG5L+d5oyB5omp5bGV5oCn77yM5q2k5aSE5byV55So5Y+C5LiO6ICFSWTvvIzkvb/nlKjlj4LkuI7ogIXop6PmnpDlmajop6PmnpBcclxuICAgICovXHJcbiAgICBFeGNsdXNpb25QZXJmb3JtZXJzOiBBcnJheTxzdHJpbmc+O1xyXG4gICAgLyoqXHJcbiAgICAqIOaJvuS4jeWIsOWPguS4juiAheaXtuWkhOeQhuetlueVpe+8mnRocm93RXhjZXB0aW9uLCBsZWF2ZVxyXG4gICAgKi9cclxuICAgIE5vUGVyZm9ybWVyU3RyYXRlZ3k6IHN0cmluZztcclxuICAgIC8qKlxyXG4gICAgKiDlho3mrKHov5vlhaXor6XoioLngrnml7bvvIzlj4LkuI7kurrkuLror6XoioLngrnnmoTlt7Llip7kurrlkZhcclxuICAgICog5Li76KaB55So5LqO6amz5Zue5ZKM6YeN5paw5o+Q5Lqk6Iez6amz5Zue6IqC54K555qE5Zy65pmvXHJcbiAgICAqL1xyXG4gICAgSGlzdG9yaWNGaXJzdDogYm9vbGVhbjtcclxuICAgIC8qKlxyXG4gICAgKiDov57lspflrqHmibnvvJrlkIzkuIDlip7nkIbkurrlnKjnm7jpgrvoioLngrnku7vliqHku4Xlip7nkIbkuIDmrKHvvIzkuIvkuIDnjq/oioLoh6rliqjlrozmiJBcclxuICAgICog5LiOZXhjbHVzaW9uUGVyZm9ybWVyc+iuvue9ruKAnOS4iuS4gOa0u+WKqOWuoeaJueS6uuS4jeWPguS4juWuoeaJueKAneWGsueqgVxyXG4gICAgKi9cclxuICAgIE5laWdoYm9yaW5nOiBib29sZWFuO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICog6Ieq5Yqo5a6h5om56aG5XHJcbiAgICAgKiDlnLrmma/npLrkvovvvJrmtYHnqIvlj5HotbfkurrkuI3lj4LkuI7lrqHmibnjgIHlt7LlrqHkurrlkZjkuI3lj4LkuI7lrqHmibnjgIHkuIrkuIDmtLvliqjlrqHmibnkurrkuI3lj4LkuI7lrqHmibnjgIHliKnnm4rnm7jlhbPkurrvvIjlj5boh6rooajljZXlrZfmrrXvvJrmiqXplIDkurrjgIHmjpLpmaTmnKzljZXkvY3jgILjgILjgILlgYfosaHnmoTvvIlcclxuICAgICAqIOS4uuS6huS/neaMgeaJqeWxleaAp++8jOatpOWkhOW8leeUqOWPguS4juiAhUlk77yM5L2/55So5Y+C5LiO6ICF6Kej5p6Q5Zmo6Kej5p6QXHJcbiAgICAgKi9cclxuICAgIGF1dG9tYXRpY1BlcmZvcm1lcnM6IEFycmF5PHN0cmluZz47XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDoh6rliqjlrqHmibnop4TliJlMaXN0XHJcbiAgICAgKi9cclxuICAgIGF1dG9tYXRpY0FwcHJvdmFsUnVsZXM6IEFycmF5PEF1dG9tYXRpY0FwcHJvdmFsUnVsZT47XHJcblxyXG5cclxuXHJcbiAgICBjb25zdHJ1Y3Rvcihtb2RlbDogQnBtbk1vZGVsKSB7XHJcbiAgICAgICAgc3VwZXIobW9kZWwpO1xyXG4gICAgICAgIHRoaXMuTm9QZXJmb3JtZXJTdHJhdGVneSA9ICdsZWF2ZSc7XHJcbiAgICAgICAgdGhpcy5IaXN0b3JpY0ZpcnN0ID0gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgcHJvdGVjdGVkIHJlc2V0QmVmb3JlTG9hZEZyb20oKSB7XHJcbiAgICAgICAgc3VwZXIuUmVzZXRCZWZvcmVMb2FkRnJvbSgpO1xyXG4gICAgICAgIHRoaXMuTm9QZXJmb3JtZXJTdHJhdGVneSA9ICdsZWF2ZSc7XHJcbiAgICAgICAgdGhpcy5IaXN0b3JpY0ZpcnN0ID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLkV4Y2x1c2lvblBlcmZvcm1lcnMgPSBuZXcgQXJyYXkoKTtcclxuICAgICAgICB0aGlzLmF1dG9tYXRpY1BlcmZvcm1lcnMgPSBuZXcgQXJyYXkoKTtcclxuICAgICAgICB0aGlzLmF1dG9tYXRpY0FwcHJvdmFsUnVsZXMgPSBuZXcgQXJyYXkoKTtcclxuICAgIH1cclxuXHJcbiAgICBDb252ZXJ0VG9Kc29uT2JqZWN0KCk6IGFueSB7XHJcbiAgICAgICAgbGV0IG9iaiA9IHN1cGVyLkNvbnZlcnRUb0pzb25PYmplY3QoKTtcclxuICAgICAgICBCcG1uTW9kZWxIZWxwZXIuU2V0QXR0cmlidXRlVmFsdWUob2JqLCBcIkV4Y2x1c2lvblBlcmZvcm1lcnNcIiwgdGhpcy5FeGNsdXNpb25QZXJmb3JtZXJzKTtcclxuICAgICAgICBCcG1uTW9kZWxIZWxwZXIuU2V0QXR0cmlidXRlVmFsdWUob2JqLCBcIkF1dG9tYXRpY1BlcmZvcm1lcnNcIiwgdGhpcy5hdXRvbWF0aWNQZXJmb3JtZXJzKTtcclxuICAgICAgICBCcG1uTW9kZWxIZWxwZXIuU2V0QXR0cmlidXRlVmFsdWUob2JqLCBcIk5vUGVyZm9ybWVyU3RyYXRlZ3lcIiwgdGhpcy5Ob1BlcmZvcm1lclN0cmF0ZWd5KTtcclxuICAgICAgICBCcG1uTW9kZWxIZWxwZXIuU2V0QXR0cmlidXRlVmFsdWUob2JqLCBcIkhpc3RvcmljRmlyc3RcIiwgdGhpcy5IaXN0b3JpY0ZpcnN0KTtcclxuICAgICAgICBCcG1uTW9kZWxIZWxwZXIuU2V0QXR0cmlidXRlVmFsdWUob2JqLCBcIk5laWdoYm9yaW5nXCIsIHRoaXMuTmVpZ2hib3JpbmcpO1xyXG4gICAgICAgIGlmICh0aGlzLmF1dG9tYXRpY0FwcHJvdmFsUnVsZXMgJiYgdGhpcy5hdXRvbWF0aWNBcHByb3ZhbFJ1bGVzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgY29uc3QgcnVsZXMgPSBuZXcgQXJyYXkoKTtcclxuICAgICAgICAgICAgZm9yIChjb25zdCBhIG9mIHRoaXMuYXV0b21hdGljQXBwcm92YWxSdWxlcykge1xyXG4gICAgICAgICAgICAgICAgcnVsZXMucHVzaChhLkNvbnZlcnRUb0pzb25PYmplY3QoKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgQnBtbk1vZGVsSGVscGVyLlNldEF0dHJpYnV0ZVZhbHVlKG9iaiwgXCJBdXRvbWF0aWNBcHByb3ZhbFJ1bGVzXCIsIHJ1bGVzKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG9iajtcclxuICAgIH1cclxuXHJcbiAgICBMb2FkRnJvbUpzb25PYmplY3Qob2JqOiBhbnkpOiBhbnkge1xyXG4gICAgICAgIHN1cGVyLkxvYWRGcm9tSnNvbk9iamVjdChvYmopO1xyXG5cclxuICAgICAgICB0aGlzLkV4Y2x1c2lvblBlcmZvcm1lcnMgPSBvYmouRXhjbHVzaW9uUGVyZm9ybWVycztcclxuICAgICAgICB0aGlzLk5vUGVyZm9ybWVyU3RyYXRlZ3kgPSBvYmouTm9QZXJmb3JtZXJTdHJhdGVneTtcclxuICAgICAgICB0aGlzLkhpc3RvcmljRmlyc3QgPSBvYmouSGlzdG9yaWNGaXJzdDtcclxuICAgICAgICB0aGlzLk5laWdoYm9yaW5nID0gb2JqLk5laWdoYm9yaW5nO1xyXG4gICAgICAgIHRoaXMuYXV0b21hdGljUGVyZm9ybWVycyA9IEV4dGVuc2lvbk1ldGhvZC5HZXRBdHRyaWJ1dGVWYWx1ZShvYmosIFwiQXV0b21hdGljUGVyZm9ybWVyc1wiKTtcclxuXHJcbiAgICAgICAgdGhpcy5hdXRvbWF0aWNBcHByb3ZhbFJ1bGVzID0gbmV3IEFycmF5KCk7XHJcbiAgICAgICAgY29uc3QgcnVsZXMgPSBFeHRlbnNpb25NZXRob2QuR2V0QXR0cmlidXRlVmFsdWUob2JqLCBcIkF1dG9tYXRpY0FwcHJvdmFsUnVsZXNcIik7XHJcbiAgICAgICAgaWYgKHJ1bGVzICYmIHJ1bGVzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgZm9yIChjb25zdCByIG9mIHJ1bGVzKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBhdXRvbWF0aWNBcHByb3ZhbFJ1bGUgPSBuZXcgQXV0b21hdGljQXBwcm92YWxSdWxlKHRoaXMuTW9kZWwpO1xyXG4gICAgICAgICAgICAgICAgYXV0b21hdGljQXBwcm92YWxSdWxlLkxvYWRGcm9tSnNvbk9iamVjdChyKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuYXV0b21hdGljQXBwcm92YWxSdWxlcy5wdXNoKGF1dG9tYXRpY0FwcHJvdmFsUnVsZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgTmV3SW5zdGFuY2UoKTogUGFydGljaXBhbnRTZXR0aW5nIHtcclxuICAgICAgICByZXR1cm4gbmV3IFBhcnRpY2lwYW50U2V0dGluZyh0aGlzLk1vZGVsKTtcclxuICAgIH1cclxuXHJcbiAgICBjbG9uZSgpOiBQYXJ0aWNpcGFudFNldHRpbmcge1xyXG4gICAgICAgIGNvbnN0IHBhcnRpY2lwYW50U2V0dGluZyA9IG5ldyBQYXJ0aWNpcGFudFNldHRpbmcodGhpcy5Nb2RlbCk7XHJcbiAgICAgICAgcGFydGljaXBhbnRTZXR0aW5nLkV4Y2x1c2lvblBlcmZvcm1lcnMgPSBuZXcgQXJyYXkoKTtcclxuICAgICAgICBpZiAodGhpcy5FeGNsdXNpb25QZXJmb3JtZXJzICYmIHRoaXMuRXhjbHVzaW9uUGVyZm9ybWVycy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgZSBvZiB0aGlzLkV4Y2x1c2lvblBlcmZvcm1lcnMpIHtcclxuICAgICAgICAgICAgICAgIHBhcnRpY2lwYW50U2V0dGluZy5FeGNsdXNpb25QZXJmb3JtZXJzLnB1c2goZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcGFydGljaXBhbnRTZXR0aW5nLk5vUGVyZm9ybWVyU3RyYXRlZ3kgPSB0aGlzLk5vUGVyZm9ybWVyU3RyYXRlZ3k7XHJcbiAgICAgICAgcGFydGljaXBhbnRTZXR0aW5nLkhpc3RvcmljRmlyc3QgPSB0aGlzLkhpc3RvcmljRmlyc3Q7XHJcbiAgICAgICAgcGFydGljaXBhbnRTZXR0aW5nLk5laWdoYm9yaW5nID0gdGhpcy5OZWlnaGJvcmluZztcclxuICAgICAgICBwYXJ0aWNpcGFudFNldHRpbmcuYXV0b21hdGljUGVyZm9ybWVycyA9IG5ldyBBcnJheSgpO1xyXG4gICAgICAgIGlmICh0aGlzLmF1dG9tYXRpY1BlcmZvcm1lcnMgJiYgdGhpcy5hdXRvbWF0aWNQZXJmb3JtZXJzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgZm9yIChjb25zdCBhIG9mIHRoaXMuYXV0b21hdGljUGVyZm9ybWVycykge1xyXG4gICAgICAgICAgICAgICAgcGFydGljaXBhbnRTZXR0aW5nLmF1dG9tYXRpY1BlcmZvcm1lcnMucHVzaChhKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBwYXJ0aWNpcGFudFNldHRpbmcuYXV0b21hdGljQXBwcm92YWxSdWxlcyA9IG5ldyBBcnJheSgpO1xyXG4gICAgICAgIGlmICh0aGlzLmF1dG9tYXRpY0FwcHJvdmFsUnVsZXMgJiYgdGhpcy5hdXRvbWF0aWNBcHByb3ZhbFJ1bGVzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgZm9yIChjb25zdCByIG9mIHRoaXMuYXV0b21hdGljQXBwcm92YWxSdWxlcykge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgYXV0b21hdGljQXBwcm92YWxSdWxlID0gci5jbG9uZSgpO1xyXG4gICAgICAgICAgICAgICAgcGFydGljaXBhbnRTZXR0aW5nLmF1dG9tYXRpY0FwcHJvdmFsUnVsZXMucHVzaChhdXRvbWF0aWNBcHByb3ZhbFJ1bGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gcGFydGljaXBhbnRTZXR0aW5nO1xyXG4gICAgfVxyXG59XHJcbkJwbW5Nb2RlbEhlbHBlci5SZWdpc3RlckVsZW1lbnRUeXBlKG5ldyBQYXJ0aWNpcGFudFNldHRpbmcobmV3IEJwbW5Nb2RlbCgpKSk7Il19