/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { BpmnModel, BpmnModelHelper, ServiceTask } from "@edp-pmf/bpmn-model";
import { ExtendProperty } from "./ExtendProperty";
import { Component } from "./extension/tool/Component";
import { Tool } from "./extension/tool/Tool";
import { VariableSetting } from "./VariableSetting";
export class AutoActivity extends ServiceTask {
    /**
     * @param {?} model
     */
    constructor(model) {
        super(model);
        this.ClrTypeID = AutoActivity.Clr_Type_ID;
    }
    /**
     * @return {?}
     */
    ResetBeforeLoadFrom() {
        super.ResetBeforeLoadFrom();
        this.tools = new Array();
        this.variableSettings = new Array();
        this.extendProperties = new Array();
    }
    /**
     * @return {?}
     */
    ConvertToJsonObject() {
        /** @type {?} */
        let obj = super.ConvertToJsonObject();
        return obj;
    }
    /**
     * @param {?} obj
     * @return {?}
     */
    LoadFromJsonObject(obj) {
        super.LoadFromJsonObject(obj);
    }
    /**
     * @protected
     * @return {?}
     */
    GetExtensionElements4ConvertTo() {
        /** @type {?} */
        let list = super.GetExtensionElements4ConvertTo();
        if (this.tools != null) {
            for (const item of this.tools) {
                item.MexTag = AutoActivity.MEXTAG;
                list.push(item);
            }
        }
        if (this.variableSettings != null && this.variableSettings.length > 0) {
            for (const item of this.variableSettings) {
                item.MexTag = AutoActivity.MEXTAG;
                list.push(item);
            }
        }
        if (this.extendProperties != null && this.extendProperties.length > 0) {
            for (const item of this.extendProperties) {
                item.MexTag = AutoActivity.MEXTAG;
                list.push(item);
            }
        }
        return list;
    }
    /**
     * @protected
     * @param {?} extensionElements
     * @return {?}
     */
    SetExtensionElements4LoadFrom(extensionElements) {
        super.SetExtensionElements4LoadFrom(extensionElements);
        for (let extensionElement of extensionElements) {
            if (extensionElement.MexTag !== AutoActivity.MEXTAG)
                continue;
            switch (extensionElement.ClrTypeID) {
                case VariableSetting.Clr_Type_ID:
                    this.variableSettings.push((/** @type {?} */ (extensionElement)));
                    break;
                case ExtendProperty.Clr_Type_ID:
                    this.extendProperties.push((/** @type {?} */ (extensionElement)));
                    break;
                default:
                    if (extensionElement instanceof Tool) {
                        this.tools.push((/** @type {?} */ (extensionElement)));
                    }
                    break;
            }
        }
    }
    /**
     * @return {?}
     */
    NewInstance() {
        return new AutoActivity(this.Model);
    }
    /**
     * @return {?}
     */
    clone() {
        /** @type {?} */
        const autoActivity = new AutoActivity(this.Model);
        autoActivity.Name = this.Name;
        autoActivity.tools = new Array();
        if (this.tools && this.tools.length > 0) {
            for (const t of this.tools) {
                if (t instanceof Component) {
                    /** @type {?} */
                    const c = (/** @type {?} */ (t));
                    /** @type {?} */
                    const tool = c.clone();
                    autoActivity.tools.push(tool);
                }
            }
        }
        autoActivity.variableSettings = new Array();
        if (this.variableSettings && this.variableSettings.length > 0) {
            for (const v of this.variableSettings) {
                /** @type {?} */
                const variableSetting = v.clone();
                autoActivity.variableSettings.push(variableSetting);
            }
        }
        autoActivity.extendProperties = new Array();
        if (this.extendProperties && this.extendProperties.length > 0) {
            for (const e of this.extendProperties) {
                /** @type {?} */
                const extendProperty = e.clone();
                autoActivity.extendProperties.push(extendProperty);
            }
        }
        return autoActivity;
    }
}
AutoActivity.Clr_Type_ID = "wf.AutoActivity";
AutoActivity.MEXTAG = 'wf.AutoActivity';
if (false) {
    /** @type {?} */
    AutoActivity.Clr_Type_ID;
    /**
     * @type {?}
     * @private
     */
    AutoActivity.MEXTAG;
    /** @type {?} */
    AutoActivity.prototype.ClrTypeID;
    /** @type {?} */
    AutoActivity.prototype.tools;
    /** @type {?} */
    AutoActivity.prototype.variableSettings;
    /** @type {?} */
    AutoActivity.prototype.extendProperties;
}
BpmnModelHelper.RegisterElementType(new AutoActivity(new BpmnModel()));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQXV0b0FjdGl2aXR5LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGdzcC13Zi93Zi1wcm9jZXNzLW1vZGVsLyIsInNvdXJjZXMiOlsibGliL21vZGVsL0F1dG9BY3Rpdml0eS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUFFLFNBQVMsRUFBRSxlQUFlLEVBQUUsV0FBVyxFQUFvQixNQUFNLHFCQUFxQixDQUFDO0FBQ2hHLE9BQU8sRUFBRSxjQUFjLEVBQUUsTUFBTSxrQkFBa0IsQ0FBQztBQUNsRCxPQUFPLEVBQUUsU0FBUyxFQUFFLE1BQU0sNEJBQTRCLENBQUM7QUFDdkQsT0FBTyxFQUFFLElBQUksRUFBRSxNQUFNLHVCQUF1QixDQUFDO0FBQzdDLE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQztBQUVwRCxNQUFNLE9BQU8sWUFBYSxTQUFRLFdBQVc7Ozs7SUFTekMsWUFBWSxLQUFnQjtRQUN4QixLQUFLLENBQUMsS0FBSyxDQUFDLENBQUM7UUFSakIsY0FBUyxHQUFXLFlBQVksQ0FBQyxXQUFXLENBQUM7SUFTN0MsQ0FBQzs7OztJQUVELG1CQUFtQjtRQUNmLEtBQUssQ0FBQyxtQkFBbUIsRUFBRSxDQUFDO1FBRTVCLElBQUksQ0FBQyxLQUFLLEdBQUcsSUFBSSxLQUFLLEVBQVEsQ0FBQztRQUMvQixJQUFJLENBQUMsZ0JBQWdCLEdBQUcsSUFBSSxLQUFLLEVBQUUsQ0FBQztRQUNwQyxJQUFJLENBQUMsZ0JBQWdCLEdBQUcsSUFBSSxLQUFLLEVBQWtCLENBQUM7SUFDeEQsQ0FBQzs7OztJQUVELG1CQUFtQjs7WUFDWCxHQUFHLEdBQUcsS0FBSyxDQUFDLG1CQUFtQixFQUFFO1FBRXJDLE9BQU8sR0FBRyxDQUFDO0lBQ2YsQ0FBQzs7Ozs7SUFFRCxrQkFBa0IsQ0FBQyxHQUFRO1FBQ3ZCLEtBQUssQ0FBQyxrQkFBa0IsQ0FBQyxHQUFHLENBQUMsQ0FBQztJQUVsQyxDQUFDOzs7OztJQUVTLDhCQUE4Qjs7WUFD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Q0QsWUFBWSxDQUFDLGdCQUFnQixHQUFHLElBQUksS0FBSyxFQUFFLENBQUM7UUFDNUMsSUFBSSxJQUFJLENBQUMsZ0JBQWdCLElBQUksSUFBSSxDQUFDLGdCQUFnQixDQUFDLE1BQU0sR0FBRyxDQUFDLEVBQUU7WUFDM0QsS0FBSyxNQUFNLENBQUMsSUFBSSxJQUFJLENBQUMsZ0JBQWdCLEVBQUU7O3NCQUM3QixlQUFlLEdBQUcsQ0FBQyxDQUFDLEtBQUssRUFBRTtnQkFDakMsWUFBWSxDQUFDLGdCQUFnQixDQUFDLElBQUksQ0FBQyxlQUFlLENBQUMsQ0FBQzthQUN2RDtTQUNKO1FBQ0QsWUFBWSxDQUFDLGdCQUFnQixHQUFHLElBQUksS0FBSyxFQUFrQixDQUFDO1FBQzVELElBQUksSUFBSSxDQUFDLGdCQUFnQixJQUFJLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxFQUFFO1lBQzNELEtBQUssTUFBTSxDQUFDLElBQUksSUFBSSxDQUFDLGdCQUFnQixFQUFFOztzQkFDN0IsY0FBYyxHQUFHLENBQUMsQ0FBQyxLQUFLLEVBQUU7Z0JBQ2hDLFlBQVksQ0FBQyxnQkFBZ0IsQ0FBQyxJQUFJLENBQUMsY0FBYyxDQUFDLENBQUM7YUFDdEQ7U0FDSjtRQUNELE9BQU8sWUFBWSxDQUFDO0lBQ3hCLENBQUM7O0FBM0dNLHdCQUFXLEdBQVcsaUJBQWlCLENBQUM7QUFFaEMsbUJBQU0sR0FBVyxpQkFBaUIsQ0FBQzs7O0lBRmxELHlCQUErQzs7Ozs7SUFFL0Msb0JBQWtEOztJQURsRCxpQ0FBNkM7O0lBRzdDLDZCQUFtQjs7SUFDbkIsd0NBQXlDOztJQUN6Qyx3Q0FBd0M7O0FBdUc1QyxlQUFlLENBQUMsbUJBQW1CLENBQUMsSUFBSSxZQUFZLENBQUMsSUFBSSxTQUFTLEVBQUUsQ0FBQyxDQUFDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBCcG1uTW9kZWwsIEJwbW5Nb2RlbEhlbHBlciwgU2VydmljZVRhc2ssIEV4dGVuc2lvbkVsZW1lbnQgfSBmcm9tIFwiQGVkcC1wbWYvYnBtbi1tb2RlbFwiO1xyXG5pbXBvcnQgeyBFeHRlbmRQcm9wZXJ0eSB9IGZyb20gXCIuL0V4dGVuZFByb3BlcnR5XCI7XHJcbmltcG9ydCB7IENvbXBvbmVudCB9IGZyb20gXCIuL2V4dGVuc2lvbi90b29sL0NvbXBvbmVudFwiO1xyXG5pbXBvcnQgeyBUb29sIH0gZnJvbSBcIi4vZXh0ZW5zaW9uL3Rvb2wvVG9vbFwiO1xyXG5pbXBvcnQgeyBWYXJpYWJsZVNldHRpbmcgfSBmcm9tIFwiLi9WYXJpYWJsZVNldHRpbmdcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBBdXRvQWN0aXZpdHkgZXh0ZW5kcyBTZXJ2aWNlVGFzayB7XHJcbiAgICBzdGF0aWMgQ2xyX1R5cGVfSUQ6IHN0cmluZyA9IFwid2YuQXV0b0FjdGl2aXR5XCI7XHJcbiAgICBDbHJUeXBlSUQ6IHN0cmluZyA9IEF1dG9BY3Rpdml0eS5DbHJfVHlwZV9JRDtcclxuICAgIHByaXZhdGUgc3RhdGljIE1FWFRBRzogc3RyaW5nID0gJ3dmLkF1dG9BY3Rpdml0eSc7XHJcblxyXG4gICAgdG9vbHM6IEFycmF5PFRvb2w+O1xyXG4gICAgdmFyaWFibGVTZXR0aW5nczogQXJyYXk8VmFyaWFibGVTZXR0aW5nPjtcclxuICAgIGV4dGVuZFByb3BlcnRpZXM6IEFycmF5PEV4dGVuZFByb3BlcnR5PjtcclxuXHJcbiAgICBjb25zdHJ1Y3Rvcihtb2RlbDogQnBtbk1vZGVsKSB7XHJcbiAgICAgICAgc3VwZXIobW9kZWwpO1xyXG4gICAgfVxyXG5cclxuICAgIFJlc2V0QmVmb3JlTG9hZEZyb20oKSB7XHJcbiAgICAgICAgc3VwZXIuUmVzZXRCZWZvcmVMb2FkRnJvbSgpO1xyXG5cclxuICAgICAgICB0aGlzLnRvb2xzID0gbmV3IEFycmF5PFRvb2w+KCk7XHJcbiAgICAgICAgdGhpcy52YXJpYWJsZVNldHRpbmdzID0gbmV3IEFycmF5KCk7XHJcbiAgICAgICAgdGhpcy5leHRlbmRQcm9wZXJ0aWVzID0gbmV3IEFycmF5PEV4dGVuZFByb3BlcnR5PigpO1xyXG4gICAgfVxyXG5cclxuICAgIENvbnZlcnRUb0pzb25PYmplY3QoKTogYW55IHtcclxuICAgICAgICBsZXQgb2JqID0gc3VwZXIuQ29udmVydFRvSnNvbk9iamVjdCgpO1xyXG5cclxuICAgICAgICByZXR1cm4gb2JqO1xyXG4gICAgfVxyXG5cclxuICAgIExvYWRGcm9tSnNvbk9iamVjdChvYmo6IGFueSkge1xyXG4gICAgICAgIHN1cGVyLkxvYWRGcm9tSnNvbk9iamVjdChvYmopO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBwcm90ZWN0ZWQgR2V0RXh0ZW5zaW9uRWxlbWVudHM0Q29udmVydFRvKCk6IEV4dGVuc2lvbkVsZW1lbnRbXSB7XHJcbiAgICAgICAgbGV0IGxpc3QgPSBzdXBlci5HZXRFeHRlbnNpb25FbGVtZW50czRDb252ZXJ0VG8oKTtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMudG9vbHMgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgdGhpcy50b29scykge1xyXG4gICAgICAgICAgICAgICAgaXRlbS5NZXhUYWcgPSBBdXRvQWN0aXZpdHkuTUVYVEFHO1xyXG4gICAgICAgICAgICAgICAgbGlzdC5wdXNoKGl0ZW0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLnZhcmlhYmxlU2V0dGluZ3MgIT0gbnVsbCAmJiB0aGlzLnZhcmlhYmxlU2V0dGluZ3MubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgdGhpcy52YXJpYWJsZVNldHRpbmdzKSB7XHJcbiAgICAgICAgICAgICAgICBpdGVtLk1leFRhZyA9IEF1dG9BY3Rpdml0eS5NRVhUQUc7XHJcbiAgICAgICAgICAgICAgICBsaXN0LnB1c2goaXRlbSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuZXh0ZW5kUHJvcGVydGllcyAhPSBudWxsICYmIHRoaXMuZXh0ZW5kUHJvcGVydGllcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgaXRlbSBvZiB0aGlzLmV4dGVuZFByb3BlcnRpZXMpIHtcclxuICAgICAgICAgICAgICAgIGl0ZW0uTWV4VGFnID0gQXV0b0FjdGl2aXR5Lk1FWFRBRztcclxuICAgICAgICAgICAgICAgIGxpc3QucHVzaChpdGVtKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbGlzdDtcclxuICAgIH1cclxuICAgIHByb3RlY3RlZCBTZXRFeHRlbnNpb25FbGVtZW50czRMb2FkRnJvbShleHRlbnNpb25FbGVtZW50czogRXh0ZW5zaW9uRWxlbWVudFtdKSB7XHJcbiAgICAgICAgc3VwZXIuU2V0RXh0ZW5zaW9uRWxlbWVudHM0TG9hZEZyb20oZXh0ZW5zaW9uRWxlbWVudHMpO1xyXG5cclxuICAgICAgICBmb3IgKGxldCBleHRlbnNpb25FbGVtZW50IG9mIGV4dGVuc2lvbkVsZW1lbnRzKSB7XHJcbiAgICAgICAgICAgIGlmIChleHRlbnNpb25FbGVtZW50Lk1leFRhZyAhPT0gQXV0b0FjdGl2aXR5Lk1FWFRBRylcclxuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICBzd2l0Y2ggKGV4dGVuc2lvbkVsZW1lbnQuQ2xyVHlwZUlEKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlIFZhcmlhYmxlU2V0dGluZy5DbHJfVHlwZV9JRDpcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnZhcmlhYmxlU2V0dGluZ3MucHVzaChleHRlbnNpb25FbGVtZW50IGFzIFZhcmlhYmxlU2V0dGluZyk7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIEV4dGVuZFByb3BlcnR5LkNscl9UeXBlX0lEOlxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZXh0ZW5kUHJvcGVydGllcy5wdXNoKGV4dGVuc2lvbkVsZW1lbnQgYXMgRXh0ZW5kUHJvcGVydHkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZXh0ZW5zaW9uRWxlbWVudCBpbnN0YW5jZW9mIFRvb2wpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50b29scy5wdXNoKGV4dGVuc2lvbkVsZW1lbnQgYXMgVG9vbCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgTmV3SW5zdGFuY2UoKTogQXV0b0FjdGl2aXR5IHtcclxuICAgICAgICByZXR1cm4gbmV3IEF1dG9BY3Rpdml0eSh0aGlzLk1vZGVsKTtcclxuICAgIH1cclxuICAgIGNsb25lKCk6IEF1dG9BY3Rpdml0eSB7XHJcbiAgICAgICAgY29uc3QgYXV0b0FjdGl2aXR5ID0gbmV3IEF1dG9BY3Rpdml0eSh0aGlzLk1vZGVsKTtcclxuICAgICAgICBhdXRvQWN0aXZpdHkuTmFtZSA9IHRoaXMuTmFtZTtcclxuXHJcbiAgICAgICAgYXV0b0FjdGl2aXR5LnRvb2xzID0gbmV3IEFycmF5KCk7XHJcbiAgICAgICAgaWYgKHRoaXMudG9vbHMgJiYgdGhpcy50b29scy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgdCBvZiB0aGlzLnRvb2xzKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodCBpbnN0YW5jZW9mIENvbXBvbmVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGMgPSB0IGFzIENvbXBvbmVudDtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCB0b29sID0gYy5jbG9uZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGF1dG9BY3Rpdml0eS50b29scy5wdXNoKHRvb2wpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGF1dG9BY3Rpdml0eS52YXJpYWJsZVNldHRpbmdzID0gbmV3IEFycmF5KCk7XHJcbiAgICAgICAgaWYgKHRoaXMudmFyaWFibGVTZXR0aW5ncyAmJiB0aGlzLnZhcmlhYmxlU2V0dGluZ3MubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IHYgb2YgdGhpcy52YXJpYWJsZVNldHRpbmdzKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB2YXJpYWJsZVNldHRpbmcgPSB2LmNsb25lKCk7XHJcbiAgICAgICAgICAgICAgICBhdXRvQWN0aXZpdHkudmFyaWFibGVTZXR0aW5ncy5wdXNoKHZhcmlhYmxlU2V0dGluZyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgYXV0b0FjdGl2aXR5LmV4dGVuZFByb3BlcnRpZXMgPSBuZXcgQXJyYXk8RXh0ZW5kUHJvcGVydHk+KCk7XHJcbiAgICAgICAgaWYgKHRoaXMuZXh0ZW5kUHJvcGVydGllcyAmJiB0aGlzLmV4dGVuZFByb3BlcnRpZXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IGUgb2YgdGhpcy5leHRlbmRQcm9wZXJ0aWVzKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBleHRlbmRQcm9wZXJ0eSA9IGUuY2xvbmUoKTtcclxuICAgICAgICAgICAgICAgIGF1dG9BY3Rpdml0eS5leHRlbmRQcm9wZXJ0aWVzLnB1c2goZXh0ZW5kUHJvcGVydHkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBhdXRvQWN0aXZpdHk7XHJcbiAgICB9XHJcbn1cclxuQnBtbk1vZGVsSGVscGVyLlJlZ2lzdGVyRWxlbWVudFR5cGUobmV3IEF1dG9BY3Rpdml0eShuZXcgQnBtbk1vZGVsKCkpKTtcclxuIl19