/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { BpmnModel, BpmnModelHelper, BpmnModelJsonHelper, CallActivity, SubProcessDataAssociations, MultiInstanceLoopCharacteristics } from "@edp-pmf/bpmn-model";
import { BackWardRule } from "./extension/completion-strategy/BackWardRule";
import { VariableSetting } from "./VariableSetting";
export class CallActivitySubProcess extends CallActivity {
    /**
     * @param {?} model
     */
    constructor(model) {
        super(model);
        this.ClrTypeID = CallActivitySubProcess.Clr_Type_ID;
        this.aifProcessCode = null;
        this.useAutoCreationData = false;
        this.SubProcessDataAssociations = new SubProcessDataAssociations(model);
        this.inheritVariables = true;
        this.inheritBizDataId = true;
        this.backWardRule = new BackWardRule(model);
        this.LoopCharacteristics = new MultiInstanceLoopCharacteristics(model);
        this.aifProcessCode = null;
        this.useAutoCreationData = false;
    }
    /**
     * @return {?}
     */
    ResetBeforeLoadFrom() {
        super.ResetBeforeLoadFrom();
        this.SubProcessDataAssociations = new SubProcessDataAssociations(this.Model);
        this.inheritVariables = true;
        this.inheritBizDataId = true;
        this.variableSettings = new Array();
        this.aifProcessCode = null;
        this.useAutoCreationData = false;
    }
    /**
     * @return {?}
     */
    ConvertToJsonObject() {
        /** @type {?} */
        let obj = super.ConvertToJsonObject();
        BpmnModelHelper.SetAttributeValue(obj, 'CalledBizDefKey', this.calledBizDefKey);
        BpmnModelHelper.SetAttributeValue(obj, 'BizDataId', this.bizDataId);
        BpmnModelHelper.SetAttributeValue(obj, 'InheritVariables', this.inheritVariables);
        BpmnModelHelper.SetAttributeValue(obj, 'InheritBizDataId', this.inheritBizDataId);
        BpmnModelHelper.SetAttributeValue(obj, 'aifProcessCode', this.aifProcessCode);
        BpmnModelHelper.SetAttributeValue(obj, 'useAutoCreationData', this.useAutoCreationData);
        return obj;
    }
    /**
     * @param {?} obj
     * @return {?}
     */
    LoadFromJsonObject(obj) {
        super.LoadFromJsonObject(obj);
        this.calledBizDefKey = obj.CalledBizDefKey;
        this.bizDataId = obj.BizDataId;
        this.inheritVariables = obj.InheritVariables;
        this.inheritBizDataId = obj.InheritBizDataId;
        this.aifProcessCode = BpmnModelJsonHelper.GetAttributeValueAsString(obj, "aifProcessCode");
        this.useAutoCreationData = BpmnModelJsonHelper.GetAttributeValueAsBoolean(obj, "useAutoCreationData");
    }
    /**
     * @protected
     * @return {?}
     */
    GetExtensionElements4ConvertTo() {
        /** @type {?} */
        let list = super.GetExtensionElements4ConvertTo();
        if (this.backWardRule != null) {
            this.backWardRule.MexTag = CallActivitySubProcess.MEXTAG;
            list.push(this.backWardRule);
        }
        if (this.variableSettings != null && this.variableSettings.length > 0) {
            for (const item of this.variableSettings) {
                item.MexTag = CallActivitySubProcess.MEXTAG;
                list.push(item);
            }
        }
        return list;
    }
    /**
     * @protected
     * @param {?} extensionElements
     * @return {?}
     */
    SetExtensionElements4LoadFrom(extensionElements) {
        super.SetExtensionElements4LoadFrom(extensionElements);
        for (let extensionElement of extensionElements) {
            if (extensionElement.MexTag !== CallActivitySubProcess.MEXTAG)
                continue;
            switch (extensionElement.ClrTypeID) {
                case VariableSetting.Clr_Type_ID:
                    this.variableSettings.push((/** @type {?} */ (extensionElement)));
                    ;
                    break;
                case BackWardRule.Clr_Type_ID:
                    this.backWardRule = ((/** @type {?} */ (extensionElement)));
                    break;
                default:
                    break;
            }
        }
    }
    /**
     * @return {?}
     */
    NewInstance() {
        return new CallActivitySubProcess(this.Model);
    }
    /**
     * @return {?}
     */
    clone() {
        /** @type {?} */
        const callActivitySubProcess = new CallActivitySubProcess(this.Model);
        callActivitySubProcess.Name = this.Name;
        callActivitySubProcess.IsForCompensation = this.IsForCompensation;
        callActivitySubProcess.CalledElement = this.CalledElement;
        callActivitySubProcess.calledBizDefKey = this.calledBizDefKey;
        callActivitySubProcess.bizDataId = this.bizDataId;
        callActivitySubProcess.inheritBizDataId = this.inheritBizDataId;
        callActivitySubProcess.inheritVariables = this.inheritVariables;
        callActivitySubProcess.variableSettings = new Array();
        if (this.variableSettings && this.variableSettings.length > 0) {
            for (const v of this.variableSettings) {
                /** @type {?} */
                const variableSetting = v.clone();
                callActivitySubProcess.variableSettings.push(variableSetting);
            }
        }
        if (this.backWardRule) {
            callActivitySubProcess.backWardRule = this.backWardRule.clone();
        }
        if (this.LoopCharacteristics) {
            callActivitySubProcess.LoopCharacteristics = this.LoopCharacteristics.clone();
        }
        callActivitySubProcess.aifProcessCode = null;
        if (this.aifProcessCode) {
            callActivitySubProcess.aifProcessCode = this.aifProcessCode;
        }
        callActivitySubProcess.useAutoCreationData = this.useAutoCreationData;
        return callActivitySubProcess;
    }
}
CallActivitySubProcess.Clr_Type_ID = "wf.CallActivitySubProcess";
CallActivitySubProcess.MEXTAG = "wf.CallActivitySubProcess";
if (false) {
    /** @type {?} */
    CallActivitySubProcess.Clr_Type_ID;
    /**
     * @type {?}
     * @private
     */
    CallActivitySubProcess.MEXTAG;
    /** @type {?} */
    CallActivitySubProcess.prototype.ClrTypeID;
    /** @type {?} */
    CallActivitySubProcess.prototype.calledBizDefKey;
    /** @type {?} */
    CallActivitySubProcess.prototype.bizDataId;
    /** @type {?} */
    CallActivitySubProcess.prototype.inheritVariables;
    /** @type {?} */
    CallActivitySubProcess.prototype.inheritBizDataId;
    /** @type {?} */
    CallActivitySubProcess.prototype.backWardRule;
    /** @type {?} */
    CallActivitySubProcess.prototype.variableSettings;
    /** @type {?} */
    CallActivitySubProcess.prototype.aifProcessCode;
    /** @type {?} */
    CallActivitySubProcess.prototype.useAutoCreationData;
}
BpmnModelHelper.RegisterElementType(new CallActivitySubProcess(new BpmnModel()));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQ2FsbEFjdGl2aXR5U3ViUHJvY2Vzcy5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0Bnc3Atd2Yvd2YtcHJvY2Vzcy1tb2RlbC8iLCJzb3VyY2VzIjpbImxpYi9tb2RlbC9DYWxsQWN0aXZpdHlTdWJQcm9jZXNzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFFLGVBQWUsRUFBRSxtQkFBbUIsRUFBb0IsWUFBWSxFQUFFLDBCQUEwQixFQUFFLGdDQUFnQyxFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFDcEwsT0FBTyxFQUFFLFlBQVksRUFBRSxNQUFNLDhDQUE4QyxDQUFDO0FBQzVFLE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQztBQUVwRCxNQUFNLE9BQU8sc0JBQXVCLFNBQVEsWUFBWTs7OztJQWdCcEQsWUFBWSxLQUFnQjtRQUN4QixLQUFLLENBQUMsS0FBSyxDQUFDLENBQUM7UUFmakIsY0FBUyxHQUFXLHNCQUFzQixDQUFDLFdBQVcsQ0FBQztRQVd2RCxtQkFBYyxHQUFXLElBQUksQ0FBQztRQUM5Qix3QkFBbUIsR0FBWSxLQUFLLENBQUM7UUFJakMsSUFBSSxDQUFDLDBCQUEwQixHQUFHLElBQUksMEJBQTBCLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDeEUsSUFBSSxDQUFDLGdCQUFnQixHQUFHLElBQUksQ0FBQztRQUM3QixJQUFJLENBQUMsZ0JBQWdCLEdBQUcsSUFBSSxDQUFDO1FBQzdCLElBQUksQ0FBQyxZQUFZLEdBQUcsSUFBSSxZQUFZLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDNUMsSUFBSSxDQUFDLG1CQUFtQixHQUFHLElBQUksZ0NBQWdDLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDdkUsSUFBSSxDQUFDLGNBQWMsR0FBRyxJQUFJLENBQUM7UUFDM0IsSUFBSSxDQUFDLG1CQUFtQixHQUFHLEtBQUssQ0FBQztJQUNyQyxDQUFDOzs7O0lBRUQsbUJBQW1CO1FBQ2YsS0FBSyxDQUFD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QUF5SHpDLGVBQWUsQ0FBQyxtQkFBbUIsQ0FBQyxJQUFJLHNCQUFzQixDQUFDLElBQUksU0FBUyxFQUFFLENBQUMsQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQnBtbk1vZGVsLCBCcG1uTW9kZWxIZWxwZXIsIEJwbW5Nb2RlbEpzb25IZWxwZXIsIEV4dGVuc2lvbkVsZW1lbnQsIENhbGxBY3Rpdml0eSwgU3ViUHJvY2Vzc0RhdGFBc3NvY2lhdGlvbnMsIE11bHRpSW5zdGFuY2VMb29wQ2hhcmFjdGVyaXN0aWNzIH0gZnJvbSBcIkBlZHAtcG1mL2JwbW4tbW9kZWxcIjtcclxuaW1wb3J0IHsgQmFja1dhcmRSdWxlIH0gZnJvbSBcIi4vZXh0ZW5zaW9uL2NvbXBsZXRpb24tc3RyYXRlZ3kvQmFja1dhcmRSdWxlXCI7XHJcbmltcG9ydCB7IFZhcmlhYmxlU2V0dGluZyB9IGZyb20gXCIuL1ZhcmlhYmxlU2V0dGluZ1wiO1xyXG5cclxuZXhwb3J0IGNsYXNzIENhbGxBY3Rpdml0eVN1YlByb2Nlc3MgZXh0ZW5kcyBDYWxsQWN0aXZpdHkge1xyXG4gICAgc3RhdGljIENscl9UeXBlX0lEOiBzdHJpbmcgPSBcIndmLkNhbGxBY3Rpdml0eVN1YlByb2Nlc3NcIjtcclxuICAgIENsclR5cGVJRDogc3RyaW5nID0gQ2FsbEFjdGl2aXR5U3ViUHJvY2Vzcy5DbHJfVHlwZV9JRDtcclxuICAgIHByaXZhdGUgc3RhdGljIE1FWFRBRzogc3RyaW5nID0gXCJ3Zi5DYWxsQWN0aXZpdHlTdWJQcm9jZXNzXCI7XHJcblxyXG4gICAgY2FsbGVkQml6RGVmS2V5OiBzdHJpbmc7XHJcbiAgICBiaXpEYXRhSWQ6IHN0cmluZztcclxuICAgIGluaGVyaXRWYXJpYWJsZXM6IGJvb2xlYW47XHJcbiAgICBpbmhlcml0Qml6RGF0YUlkOiBib29sZWFuO1xyXG5cclxuICAgIGJhY2tXYXJkUnVsZTogQmFja1dhcmRSdWxlO1xyXG5cclxuICAgIHZhcmlhYmxlU2V0dGluZ3M6IEFycmF5PFZhcmlhYmxlU2V0dGluZz47XHJcbiAgICBhaWZQcm9jZXNzQ29kZTogc3RyaW5nID0gbnVsbDtcclxuICAgIHVzZUF1dG9DcmVhdGlvbkRhdGE6IGJvb2xlYW4gPSBmYWxzZTtcclxuXHJcbiAgICBjb25zdHJ1Y3Rvcihtb2RlbDogQnBtbk1vZGVsKSB7XHJcbiAgICAgICAgc3VwZXIobW9kZWwpO1xyXG4gICAgICAgIHRoaXMuU3ViUHJvY2Vzc0RhdGFBc3NvY2lhdGlvbnMgPSBuZXcgU3ViUHJvY2Vzc0RhdGFBc3NvY2lhdGlvbnMobW9kZWwpO1xyXG4gICAgICAgIHRoaXMuaW5oZXJpdFZhcmlhYmxlcyA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5pbmhlcml0Qml6RGF0YUlkID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLmJhY2tXYXJkUnVsZSA9IG5ldyBCYWNrV2FyZFJ1bGUobW9kZWwpO1xyXG4gICAgICAgIHRoaXMuTG9vcENoYXJhY3RlcmlzdGljcyA9IG5ldyBNdWx0aUluc3RhbmNlTG9vcENoYXJhY3RlcmlzdGljcyhtb2RlbCk7XHJcbiAgICAgICAgdGhpcy5haWZQcm9jZXNzQ29kZSA9IG51bGw7XHJcbiAgICAgICAgdGhpcy51c2VBdXRvQ3JlYXRpb25EYXRhID0gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgUmVzZXRCZWZvcmVMb2FkRnJvbSgpIHtcclxuICAgICAgICBzdXBlci5SZXNldEJlZm9yZUxvYWRGcm9tKCk7XHJcblxyXG4gICAgICAgIHRoaXMuU3ViUHJvY2Vzc0RhdGFBc3NvY2lhdGlvbnMgPSBuZXcgU3ViUHJvY2Vzc0RhdGFBc3NvY2lhdGlvbnModGhpcy5Nb2RlbCk7XHJcbiAgICAgICAgdGhpcy5pbmhlcml0VmFyaWFibGVzID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLmluaGVyaXRCaXpEYXRhSWQgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMudmFyaWFibGVTZXR0aW5ncyA9IG5ldyBBcnJheSgpO1xyXG4gICAgICAgIHRoaXMuYWlmUHJvY2Vzc0NvZGUgPSBudWxsO1xyXG4gICAgICAgIHRoaXMudXNlQXV0b0NyZWF0aW9uRGF0YSA9IGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIENvbnZlcnRUb0pzb25PYmplY3QoKTogYW55IHtcclxuICAgICAgICBsZXQgb2JqID0gc3VwZXIuQ29udmVydFRvSnNvbk9iamVjdCgpO1xyXG5cclxuICAgICAgICBCcG1uTW9kZWxIZWxwZXIuU2V0QXR0cmlidXRlVmFsdWUob2JqLCAnQ2FsbGVkQml6RGVmS2V5JywgdGhpcy5jYWxsZWRCaXpEZWZLZXkpO1xyXG4gICAgICAgIEJwbW5Nb2RlbEhlbHBlci5TZXRBdHRyaWJ1dGVWYWx1ZShvYmosICdCaXpEYXRhSWQnLCB0aGlzLmJpekRhdGFJZCk7XHJcbiAgICAgICAgQnBtbk1vZGVsSGVscGVyLlNldEF0dHJpYnV0ZVZhbHVlKG9iaiwgJ0luaGVyaXRWYXJpYWJsZXMnLCB0aGlzLmluaGVyaXRWYXJpYWJsZXMpO1xyXG4gICAgICAgIEJwbW5Nb2RlbEhlbHBlci5TZXRBdHRyaWJ1dGVWYWx1ZShvYmosICdJbmhlcml0Qml6RGF0YUlkJywgdGhpcy5pbmhlcml0Qml6RGF0YUlkKTtcclxuICAgICAgICBCcG1uTW9kZWxIZWxwZXIuU2V0QXR0cmlidXRlVmFsdWUob2JqLCAnYWlmUHJvY2Vzc0NvZGUnLCB0aGlzLmFpZlByb2Nlc3NDb2RlKTtcclxuICAgICAgICBCcG1uTW9kZWxIZWxwZXIuU2V0QXR0cmlidXRlVmFsdWUob2JqLCAndXNlQXV0b0NyZWF0aW9uRGF0YScsIHRoaXMudXNlQXV0b0NyZWF0aW9uRGF0YSk7XHJcbiAgICAgICAgcmV0dXJuIG9iajtcclxuICAgIH1cclxuICAgIExvYWRGcm9tSnNvbk9iamVjdChvYmo6IGFueSkge1xyXG4gICAgICAgIHN1cGVyLkxvYWRGcm9tSnNvbk9iamVjdChvYmopO1xyXG5cclxuICAgICAgICB0aGlzLmNhbGxlZEJpekRlZktleSA9IG9iai5DYWxsZWRCaXpEZWZLZXk7XHJcbiAgICAgICAgdGhpcy5iaXpEYXRhSWQgPSBvYmouQml6RGF0YUlkO1xyXG4gICAgICAgIHRoaXMuaW5oZXJpdFZhcmlhYmxlcyA9IG9iai5Jbmhlcml0VmFyaWFibGVzO1xyXG4gICAgICAgIHRoaXMuaW5oZXJpdEJpekRhdGFJZCA9IG9iai5Jbmhlcml0Qml6RGF0YUlkO1xyXG4gICAgICAgIHRoaXMuYWlmUHJvY2Vzc0NvZGUgPSBCcG1uTW9kZWxKc29uSGVscGVyLkdldEF0dHJpYnV0ZVZhbHVlQXNTdHJpbmcob2JqLCBcImFpZlByb2Nlc3NDb2RlXCIpO1xyXG4gICAgICAgIHRoaXMudXNlQXV0b0NyZWF0aW9uRGF0YSA9IEJwbW5Nb2RlbEpzb25IZWxwZXIuR2V0QXR0cmlidXRlVmFsdWVBc0Jvb2xlYW4ob2JqLCBcInVzZUF1dG9DcmVhdGlvbkRhdGFcIik7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIHByb3RlY3RlZCBHZXRFeHRlbnNpb25FbGVtZW50czRDb252ZXJ0VG8oKTogRXh0ZW5zaW9uRWxlbWVudFtdIHtcclxuICAgICAgICBsZXQgbGlzdCA9IHN1cGVyLkdldEV4dGVuc2lvbkVsZW1lbnRzNENvbnZlcnRUbygpO1xyXG5cclxuICAgICAgICBpZiAodGhpcy5iYWNrV2FyZFJ1bGUgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICB0aGlzLmJhY2tXYXJkUnVsZS5NZXhUYWcgPSBDYWxsQWN0aXZpdHlTdWJQcm9jZXNzLk1FWFRBRztcclxuICAgICAgICAgICAgbGlzdC5wdXNoKHRoaXMuYmFja1dhcmRSdWxlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMudmFyaWFibGVTZXR0aW5ncyAhPSBudWxsICYmIHRoaXMudmFyaWFibGVTZXR0aW5ncy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgaXRlbSBvZiB0aGlzLnZhcmlhYmxlU2V0dGluZ3MpIHtcclxuICAgICAgICAgICAgICAgIGl0ZW0uTWV4VGFnID0gQ2FsbEFjdGl2aXR5U3ViUHJvY2Vzcy5NRVhUQUc7XHJcbiAgICAgICAgICAgICAgICBsaXN0LnB1c2goaXRlbSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGxpc3Q7XHJcbiAgICB9XHJcbiAgICBwcm90ZWN0ZWQgU2V0RXh0ZW5zaW9uRWxlbWVudHM0TG9hZEZyb20oZXh0ZW5zaW9uRWxlbWVudHM6IEV4dGVuc2lvbkVsZW1lbnRbXSkge1xyXG4gICAgICAgIHN1cGVyLlNldEV4dGVuc2lvbkVsZW1lbnRzNExvYWRGcm9tKGV4dGVuc2lvbkVsZW1lbnRzKTtcclxuXHJcbiAgICAgICAgZm9yIChsZXQgZXh0ZW5zaW9uRWxlbWVudCBvZiBleHRlbnNpb25FbGVtZW50cykge1xyXG4gICAgICAgICAgICBpZiAoZXh0ZW5zaW9uRWxlbWVudC5NZXhUYWcgIT09IENhbGxBY3Rpdml0eVN1YlByb2Nlc3MuTUVYVEFHKVxyXG4gICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgIHN3aXRjaCAoZXh0ZW5zaW9uRWxlbWVudC5DbHJUeXBlSUQpIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgVmFyaWFibGVTZXR0aW5nLkNscl9UeXBlX0lEOlxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudmFyaWFibGVTZXR0aW5ncy5wdXNoKGV4dGVuc2lvbkVsZW1lbnQgYXMgVmFyaWFibGVTZXR0aW5nKTs7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIEJhY2tXYXJkUnVsZS5DbHJfVHlwZV9JRDpcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmJhY2tXYXJkUnVsZSA9IChleHRlbnNpb25FbGVtZW50IGFzIEJhY2tXYXJkUnVsZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIE5ld0luc3RhbmNlKCk6IENhbGxBY3Rpdml0eVN1YlByb2Nlc3Mge1xyXG4gICAgICAgIHJldHVybiBuZXcgQ2FsbEFjdGl2aXR5U3ViUHJvY2Vzcyh0aGlzLk1vZGVsKTtcclxuICAgIH1cclxuXHJcbiAgICBjbG9uZSgpOiBDYWxsQWN0aXZpdHlTdWJQcm9jZXNzIHtcclxuICAgICAgICBjb25zdCBjYWxsQWN0aXZpdHlTdWJQcm9jZXNzID0gbmV3IENhbGxBY3Rpdml0eVN1YlByb2Nlc3ModGhpcy5Nb2RlbCk7XHJcbiAgICAgICAgY2FsbEFjdGl2aXR5U3ViUHJvY2Vzcy5OYW1lID0gdGhpcy5OYW1lO1xyXG4gICAgICAgIGNhbGxBY3Rpdml0eVN1YlByb2Nlc3MuSXNGb3JDb21wZW5zYXRpb24gPSB0aGlzLklzRm9yQ29tcGVuc2F0aW9uO1xyXG4gICAgICAgIGNhbGxBY3Rpdml0eVN1YlByb2Nlc3MuQ2FsbGVkRWxlbWVudCA9IHRoaXMuQ2FsbGVkRWxlbWVudDtcclxuICAgICAgICBjYWxsQWN0aXZpdHlTdWJQcm9jZXNzLmNhbGxlZEJpekRlZktleSA9IHRoaXMuY2FsbGVkQml6RGVmS2V5O1xyXG4gICAgICAgIGNhbGxBY3Rpdml0eVN1YlByb2Nlc3MuYml6RGF0YUlkID0gdGhpcy5iaXpEYXRhSWQ7XHJcbiAgICAgICAgY2FsbEFjdGl2aXR5U3ViUHJvY2Vzcy5pbmhlcml0Qml6RGF0YUlkID0gdGhpcy5pbmhlcml0Qml6RGF0YUlkO1xyXG4gICAgICAgIGNhbGxBY3Rpdml0eVN1YlByb2Nlc3MuaW5oZXJpdFZhcmlhYmxlcyA9IHRoaXMuaW5oZXJpdFZhcmlhYmxlcztcclxuXHJcbiAgICAgICAgY2FsbEFjdGl2aXR5U3ViUHJvY2Vzcy52YXJpYWJsZVNldHRpbmdzID0gbmV3IEFycmF5KCk7XHJcbiAgICAgICAgaWYgKHRoaXMudmFyaWFibGVTZXR0aW5ncyAmJiB0aGlzLnZhcmlhYmxlU2V0dGluZ3MubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IHYgb2YgdGhpcy52YXJpYWJsZVNldHRpbmdzKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB2YXJpYWJsZVNldHRpbmcgPSB2LmNsb25lKCk7XHJcbiAgICAgICAgICAgICAgICBjYWxsQWN0aXZpdHlTdWJQcm9jZXNzLnZhcmlhYmxlU2V0dGluZ3MucHVzaCh2YXJpYWJsZVNldHRpbmcpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5iYWNrV2FyZFJ1bGUpIHtcclxuICAgICAgICAgICAgY2FsbEFjdGl2aXR5U3ViUHJvY2Vzcy5iYWNrV2FyZFJ1bGUgPSB0aGlzLmJhY2tXYXJkUnVsZS5jbG9uZSgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYodGhpcy5Mb29wQ2hhcmFjdGVyaXN0aWNzKSB7XHJcbiAgICAgICAgICAgIGNhbGxBY3Rpdml0eVN1YlByb2Nlc3MuTG9vcENoYXJhY3RlcmlzdGljcyA9IHRoaXMuTG9vcENoYXJhY3RlcmlzdGljcy5jbG9uZSgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2FsbEFjdGl2aXR5U3ViUHJvY2Vzcy5haWZQcm9jZXNzQ29kZSA9IG51bGw7XHJcbiAgICAgICAgaWYgKHRoaXMuYWlmUHJvY2Vzc0NvZGUpIHtcclxuICAgICAgICAgICAgY2FsbEFjdGl2aXR5U3ViUHJvY2Vzcy5haWZQcm9jZXNzQ29kZSA9IHRoaXMuYWlmUHJvY2Vzc0NvZGU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNhbGxBY3Rpdml0eVN1YlByb2Nlc3MudXNlQXV0b0NyZWF0aW9uRGF0YSA9IHRoaXMudXNlQXV0b0NyZWF0aW9uRGF0YTtcclxuXHJcbiAgICAgICAgcmV0dXJuIGNhbGxBY3Rpdml0eVN1YlByb2Nlc3M7XHJcbiAgICB9XHJcblxyXG59XHJcbkJwbW5Nb2RlbEhlbHBlci5SZWdpc3RlckVsZW1lbnRUeXBlKG5ldyBDYWxsQWN0aXZpdHlTdWJQcm9jZXNzKG5ldyBCcG1uTW9kZWwoKSkpOyJdfQ==