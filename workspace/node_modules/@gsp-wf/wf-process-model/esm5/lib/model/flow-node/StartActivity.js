/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { BpmnModel, BpmnModelHelper, StartEvent, ExtensionMethod } from "@edp-pmf/bpmn-model";
import { ExtendProperty } from "../ExtendProperty";
import { ExecuteForm, TerminalType } from "../extension/ExecuteForm";
import { JumpScope } from "../extension/JumpScope";
import { OtherAssignNodes } from "../extension/OtherAssignNodes";
import { ActualParameter } from "../parameter/WFActualParameter";
var StartActivity = /** @class */ (function (_super) {
    tslib_1.__extends(StartActivity, _super);
    function StartActivity(model) {
        var _this = _super.call(this, model) || this;
        _this.ClrTypeID = StartActivity.Clr_Type_ID;
        _this.sendBackedTask = true;
        _this.selectTargetAble = false;
        return _this;
    }
    /**
     * @return {?}
     */
    StartActivity.prototype.ResetBeforeLoadFrom = /**
     * @return {?}
     */
    function () {
        _super.prototype.ResetBeforeLoadFrom.call(this);
        this.ExecuteForms = new Array();
        this.extendProperties = new Array();
        this.sendBackedTask = true;
        this.selectTargetAble = false;
        this.jumpScope = null;
        this.otherAssignNodes = null;
    };
    /**
     * @return {?}
     */
    StartActivity.prototype.ConvertToJsonObject = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var obj = _super.prototype.ConvertToJsonObject.call(this);
        BpmnModelHelper.SetAttributeValue(obj, 'SendBackedTask', this.sendBackedTask);
        BpmnModelHelper.SetAttributeValue(obj, 'SelectTargetAble', this.selectTargetAble);
        return obj;
    };
    /**
     * @param {?} obj
     * @return {?}
     */
    StartActivity.prototype.LoadFromJsonObject = /**
     * @param {?} obj
     * @return {?}
     */
    function (obj) {
        _super.prototype.LoadFromJsonObject.call(this, obj);
        this.sendBackedTask = ExtensionMethod.GetAttributeValue4Boolean(obj, "SendBackedTask");
        this.selectTargetAble = ExtensionMethod.GetAttributeValue4Boolean(obj, "SelectTargetAble");
    };
    /**
     * @protected
     * @return {?}
     */
    StartActivity.prototype.GetExtensionElements4ConvertTo = /**
     * @protected
     * @return {?}
     */
    function () {
        var e_1, _a, e_2, _b;
        /** @type {?} */
        var list = _super.prototype.GetExtensionElements4ConvertTo.call(this);
        if (this.ExecuteForms != null) {
            try {
                for (var _c = tslib_1.__values(this.ExecuteForms), _d = _c.next(); !_d.done; _d = _c.next()) {
                    var form = _d.value;
                    form.MexTag = StartActivity.MEXTAG;
                    list.push(form);
                }
            }
            catch (e_1_1) { e_1 = { error: e_1_1 }; }
            finally {
                try {
                    if (_d && !_d.done && (_a = _c.return)) _a.call(_c);
                }
                finally { if (e_1) throw e_1.error; }
            }
        }
        if (this.extendProperties != null) {
            try {
                for (var _e = tslib_1.__values(this.extendProperties), _f = _e.next(); !_f.done; _f = _e.next()) {
                    var e = _f.value;
                    e.MexTag = StartActivity.MEXTAG;
                    list.push(e);
                }
            }
            catch (e_2_1) { e_2 = { error: e_2_1 }; }
            finally {
                try {
                    if (_f && !_f.done && (_b = _e.return)) _b.call(_e);
                }
                finally { if (e_2) throw e_2.error; }
            }
        }
        if (this.jumpScope != null) {
            this.jumpScope.MexTag = StartActivity.MEXTAG;
            list.push(this.jumpScope);
        }
        if (this.otherAssignNodes != null) {
            this.otherAssignNodes.MexTag = StartActivity.MEXTAG;
            list.push(this.otherAssignNodes);
        }
        return list;
    };
    /**
     * @protected
     * @param {?} extensionElements
     * @return {?}
     */
    StartActivity.prototype.SetExtensionElements4LoadFrom = /**
     * @protected
     * @param {?} extensionElements
     * @return {?}
     */
    function (extensionElements) {
        var e_3, _a;
        _super.prototype.SetExtensionElements4LoadFrom.call(this, extensionElements);
        try {
            for (var extensionElements_1 = tslib_1.__values(extensionElements), extensionElements_1_1 = extensionElements_1.next(); !extensionElements_1_1.done; extensionElements_1_1 = extensionElements_1.next()) {
                var extensionElement = extensionElements_1_1.value;
                if (extensionElement.MexTag !== StartActivity.MEXTAG)
                    continue;
                switch (extensionElement.ClrTypeID) {
                    case ExecuteForm.Clr_Type_ID:
                        this.ExecuteForms.push((/** @type {?} */ (extensionElement)));
                        break;
                    case ExtendProperty.Clr_Type_ID:
                        this.extendProperties.push((/** @type {?} */ (extensionElement)));
                        break;
                    case JumpScope.Clr_Type_ID:
                        this.jumpScope = ((/** @type {?} */ (extensionElement)));
                        break;
                    case OtherAssignNodes.Clr_Type_ID:
                        this.otherAssignNodes = ((/** @type {?} */ (extensionElement)));
                        break;
                    default:
                        break;
                }
            }
        }
        catch (e_3_1) { e_3 = { error: e_3_1 }; }
        finally {
            try {
                if (extensionElements_1_1 && !extensionElements_1_1.done && (_a = extensionElements_1.return)) _a.call(extensionElements_1);
            }
            finally { if (e_3) throw e_3.error; }
        }
    };
    /**
     * @return {?}
     */
    StartActivity.prototype.NewInstance = /**
     * @return {?}
     */
    function () {
        return new StartActivity(this.Model);
    };
    /**
    * 模型校验
    * @param errors 模型校验错误信息
    */
    /**
     * 模型校验
     * @param {?} errors 模型校验错误信息
     * @return {?}
     */
    StartActivity.prototype.Validate = /**
     * 模型校验
     * @param {?} errors 模型校验错误信息
     * @return {?}
     */
    function (errors) {
        // TODO: 需要添加自定义校验信息
        _super.prototype.Validate.call(this, errors);
    };
    /**
     * @return {?}
     */
    StartActivity.prototype.clone = /**
     * @return {?}
     */
    function () {
        var e_4, _a, e_5, _b;
        /** @type {?} */
        var startActivity = new StartActivity(this.Model);
        startActivity.Name = this.Name;
        startActivity.sendBackedTask = this.sendBackedTask;
        startActivity.selectTargetAble = this.selectTargetAble;
        startActivity.jumpScope = null;
        if (this.jumpScope) {
            startActivity.jumpScope = this.jumpScope.clone();
        }
        startActivity.ExecuteForms = new Array();
        if (this.ExecuteForms && this.ExecuteForms.length > 0) {
            try {
                for (var _c = tslib_1.__values(this.ExecuteForms), _d = _c.next(); !_d.done; _d = _c.next()) {
                    var f = _d.value;
                    /** @type {?} */
                    var executeForm = f.clone();
                    startActivity.ExecuteForms.push(executeForm);
                }
            }
            catch (e_4_1) { e_4 = { error: e_4_1 }; }
            finally {
                try {
                    if (_d && !_d.done && (_a = _c.return)) _a.call(_c);
                }
                finally { if (e_4) throw e_4.error; }
            }
        }
        if (this.extendProperties && this.extendProperties.length > 0) {
            try {
                for (var _e = tslib_1.__values(this.extendProperties), _f = _e.next(); !_f.done; _f = _e.next()) {
                    var e = _f.value;
                    /** @type {?} */
                    var extendProperty = e.clone();
                    startActivity.extendProperties.push(extendProperty);
                }
            }
            catch (e_5_1) { e_5 = { error: e_5_1 }; }
            finally {
                try {
                    if (_f && !_f.done && (_b = _e.return)) _b.call(_e);
                }
                finally { if (e_5) throw e_5.error; }
            }
        }
        if (this.otherAssignNodes) {
            startActivity.otherAssignNodes = this.otherAssignNodes.clone();
        }
        return startActivity;
    };
    /**
     * @param {?} forms
     * @return {?}
     */
    StartActivity.prototype.setDefaultForms = /**
     * @param {?} forms
     * @return {?}
     */
    function (forms) {
        var e_6, _a, e_7, _b;
        if (!this.ExecuteForms) {
            this.ExecuteForms = new Array();
        }
        try {
            for (var forms_1 = tslib_1.__values(forms), forms_1_1 = forms_1.next(); !forms_1_1.done; forms_1_1 = forms_1.next()) {
                var form = forms_1_1.value;
                /** @type {?} */
                var params = (/** @type {?} */ (form.urlParameters));
                /** @type {?} */
                var actParas = new Array();
                if (params && params.length > 0) {
                    try {
                        for (var params_1 = tslib_1.__values(params), params_1_1 = params_1.next(); !params_1_1.done; params_1_1 = params_1.next()) {
                            var para = params_1_1.value;
                            /** @type {?} */
                            var actPara = new ActualParameter(this.Model, para.code, para.value);
                            if (para.Value && para.Value.length >= 8 && para.Value.slice(0, 8) === "{\"expr\":") {
                                actPara.Tag = 'expression';
                            }
                            else {
                                actPara.Tag = 'constant';
                            }
                            actParas.push(actPara);
                        }
                    }
                    catch (e_7_1) { e_7 = { error: e_7_1 }; }
                    finally {
                        try {
                            if (params_1_1 && !params_1_1.done && (_b = params_1.return)) _b.call(params_1);
                        }
                        finally { if (e_7) throw e_7.error; }
                    }
                }
                /** @type {?} */
                var id = BpmnModelHelper.GenerateElementId();
                /** @type {?} */
                var item = new ExecuteForm(this.Model, id, form.name, actParas);
                item.ComponentId = null;
                item.FormType = '0';
                item.formFormatId = form.id;
                if (form.terminal === 'PC') {
                    item.TerminalType = TerminalType.PC;
                }
                else if (form.terminal === 'Mobile') {
                    item.TerminalType = TerminalType.MOBILE;
                }
                this.ExecuteForms.push(item);
            }
        }
        catch (e_6_1) { e_6 = { error: e_6_1 }; }
        finally {
            try {
                if (forms_1_1 && !forms_1_1.done && (_a = forms_1.return)) _a.call(forms_1);
            }
            finally { if (e_6) throw e_6.error; }
        }
    };
    StartActivity.Clr_Type_ID = "wf.StartActivity";
    StartActivity.MEXTAG = "wf.StartActivity";
    return StartActivity;
}(StartEvent));
export { StartActivity };
if (false) {
    /** @type {?} */
    StartActivity.Clr_Type_ID;
    /**
     * @type {?}
     * @private
     */
    StartActivity.MEXTAG;
    /** @type {?} */
    StartActivity.prototype.ClrTypeID;
    /** @type {?} */
    StartActivity.prototype.ExecuteForms;
    /** @type {?} */
    StartActivity.prototype.extendProperties;
    /** @type {?} */
    StartActivity.prototype.sendBackedTask;
    /** @type {?} */
    StartActivity.prototype.selectTargetAble;
    /** @type {?} */
    StartActivity.prototype.jumpScope;
    /** @type {?} */
    StartActivity.prototype.otherAssignNodes;
}
BpmnModelHelper.RegisterElementType(new StartActivity(new BpmnModel()));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiU3RhcnRBY3Rpdml0eS5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0Bnc3Atd2Yvd2YtcHJvY2Vzcy1tb2RlbC8iLCJzb3VyY2VzIjpbImxpYi9tb2RlbC9mbG93LW5vZGUvU3RhcnRBY3Rpdml0eS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQUUsZUFBZSxFQUFvQixVQUFVLEVBQUUsZUFBZSxFQUFtQixNQUFNLHFCQUFxQixDQUFDO0FBQ2pJLE9BQU8sRUFBRSxjQUFjLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQztBQUNuRCxPQUFPLEVBQUUsV0FBVyxFQUFFLFlBQVksRUFBRSxNQUFNLDBCQUEwQixDQUFDO0FBQ3JFLE9BQU8sRUFBRSxTQUFTLEVBQUUsTUFBTSx3QkFBd0IsQ0FBQztBQUNuRCxPQUFPLEVBQUUsZ0JBQWdCLEVBQUUsTUFBTSwrQkFBK0IsQ0FBQztBQUNqRSxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0sZ0NBQWdDLENBQUM7QUFFakU7SUFBbUMseUNBQVU7SUFDekMsdUJBQVksS0FBZ0I7UUFBNUIsWUFDSSxrQkFBTSxLQUFLLENBQUMsU0FFZjtRQUVELGVBQVMsR0FBVyxhQUFhLENBQUMsV0FBVyxDQUFDO1FBTTlDLG9CQUFjLEdBQVksSUFBSSxDQUFDO1FBVDNCLEtBQUksQ0FBQyxnQkFBZ0IsR0FBRyxLQUFLLENBQUM7O0lBQ2xDLENBQUM7Ozs7SUFlRCwyQ0FBbUI7OztJQUFuQjtRQUNJLGlCQUFNLG1CQUFtQixXQUFFLENBQUM7UUFDNUIsSUFBSSxDQUFDLFlBQVksR0FBRyxJQUFJLEtBQUssRUFBZSxDQUFDO1FBQzdDLElBQUksQ0FBQyxnQkFBZ0IsR0FBRyxJQUFJLEtBQUssRUFBa0IsQ0FBQztRQUNwRCxJQUFJLENBQUMsY0FBYyxHQUFHLElBQUksQ0FBQztRQUMzQixJQUFJLENBQUMsZ0JBQWdCLEdBQUcsS0FBSyxDQUFDO1FBQzlCLElBQUksQ0FBQyxTQUFTLEdBQUcsSUFBSSxDQUFD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QkFBTSxJQUFJLElBQUksQ0FBQyxRQUFRLEtBQUssUUFBUSxFQUFFO29CQUNuQyxJQUFJLENBQUMsWUFBWSxHQUFHLFlBQVksQ0FBQyxNQUFNLENBQUM7aUJBQzNDO2dCQUNELElBQUksQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO2FBQ2hDOzs7Ozs7Ozs7SUFDTCxDQUFDO0lBekpNLHlCQUFXLEdBQVcsa0JBQWtCLENBQUM7SUFFakMsb0JBQU0sR0FBVyxrQkFBa0IsQ0FBQztJQXlKdkQsb0JBQUM7Q0FBQSxBQWhLRCxDQUFtQyxVQUFVLEdBZ0s1QztTQWhLWSxhQUFhOzs7SUFLdEIsMEJBQWdEOzs7OztJQUVoRCxxQkFBbUQ7O0lBRG5ELGtDQUE4Qzs7SUFHOUMscUNBQWlDOztJQUNqQyx5Q0FBd0M7O0lBRXhDLHVDQUErQjs7SUFFL0IseUNBQTBCOztJQUMxQixrQ0FBcUI7O0lBRXJCLHlDQUFtQzs7QUFpSnZDLGVBQWUsQ0FBQyxtQkFBbUIsQ0FBQyxJQUFJLGFBQWEsQ0FBQyxJQUFJLFNBQVMsRUFBRSxDQUFDLENBQUMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEJwbW5Nb2RlbCwgQnBtbk1vZGVsSGVscGVyLCBFeHRlbnNpb25FbGVtZW50LCBTdGFydEV2ZW50LCBFeHRlbnNpb25NZXRob2QsIFZhbGlkYXRpb25FcnJvciB9IGZyb20gXCJAZWRwLXBtZi9icG1uLW1vZGVsXCI7XHJcbmltcG9ydCB7IEV4dGVuZFByb3BlcnR5IH0gZnJvbSBcIi4uL0V4dGVuZFByb3BlcnR5XCI7XHJcbmltcG9ydCB7IEV4ZWN1dGVGb3JtLCBUZXJtaW5hbFR5cGUgfSBmcm9tIFwiLi4vZXh0ZW5zaW9uL0V4ZWN1dGVGb3JtXCI7XHJcbmltcG9ydCB7IEp1bXBTY29wZSB9IGZyb20gXCIuLi9leHRlbnNpb24vSnVtcFNjb3BlXCI7XHJcbmltcG9ydCB7IE90aGVyQXNzaWduTm9kZXMgfSBmcm9tIFwiLi4vZXh0ZW5zaW9uL090aGVyQXNzaWduTm9kZXNcIjtcclxuaW1wb3J0IHsgQWN0dWFsUGFyYW1ldGVyIH0gZnJvbSBcIi4uL3BhcmFtZXRlci9XRkFjdHVhbFBhcmFtZXRlclwiO1xyXG5cclxuZXhwb3J0IGNsYXNzIFN0YXJ0QWN0aXZpdHkgZXh0ZW5kcyBTdGFydEV2ZW50IHtcclxuICAgIGNvbnN0cnVjdG9yKG1vZGVsOiBCcG1uTW9kZWwpIHtcclxuICAgICAgICBzdXBlcihtb2RlbCk7XHJcbiAgICAgICAgdGhpcy5zZWxlY3RUYXJnZXRBYmxlID0gZmFsc2U7XHJcbiAgICB9XHJcbiAgICBzdGF0aWMgQ2xyX1R5cGVfSUQ6IHN0cmluZyA9IFwid2YuU3RhcnRBY3Rpdml0eVwiO1xyXG4gICAgQ2xyVHlwZUlEOiBzdHJpbmcgPSBTdGFydEFjdGl2aXR5LkNscl9UeXBlX0lEO1xyXG4gICAgcHJpdmF0ZSBzdGF0aWMgTUVYVEFHOiBzdHJpbmcgPSBcIndmLlN0YXJ0QWN0aXZpdHlcIjtcclxuXHJcbiAgICBFeGVjdXRlRm9ybXM6IEFycmF5PEV4ZWN1dGVGb3JtPjtcclxuICAgIGV4dGVuZFByb3BlcnRpZXM6IEFycmF5PEV4dGVuZFByb3BlcnR5PjtcclxuXHJcbiAgICBzZW5kQmFja2VkVGFzazogYm9vbGVhbiA9IHRydWU7XHJcblxyXG4gICAgc2VsZWN0VGFyZ2V0QWJsZTogYm9vbGVhbjtcclxuICAgIGp1bXBTY29wZTogSnVtcFNjb3BlO1xyXG5cclxuICAgIG90aGVyQXNzaWduTm9kZXM6IE90aGVyQXNzaWduTm9kZXM7XHJcblxyXG4gICAgUmVzZXRCZWZvcmVMb2FkRnJvbSgpIHtcclxuICAgICAgICBzdXBlci5SZXNldEJlZm9yZUxvYWRGcm9tKCk7XHJcbiAgICAgICAgdGhpcy5FeGVjdXRlRm9ybXMgPSBuZXcgQXJyYXk8RXhlY3V0ZUZvcm0+KCk7XHJcbiAgICAgICAgdGhpcy5leHRlbmRQcm9wZXJ0aWVzID0gbmV3IEFycmF5PEV4dGVuZFByb3BlcnR5PigpO1xyXG4gICAgICAgIHRoaXMuc2VuZEJhY2tlZFRhc2sgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuc2VsZWN0VGFyZ2V0QWJsZSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuanVtcFNjb3BlID0gbnVsbDtcclxuICAgICAgICB0aGlzLm90aGVyQXNzaWduTm9kZXMgPSBudWxsO1xyXG4gICAgfVxyXG5cclxuICAgIENvbnZlcnRUb0pzb25PYmplY3QoKTogYW55IHtcclxuICAgICAgICBsZXQgb2JqID0gc3VwZXIuQ29udmVydFRvSnNvbk9iamVjdCgpO1xyXG4gICAgICAgIEJwbW5Nb2RlbEhlbHBlci5TZXRBdHRyaWJ1dGVWYWx1ZShvYmosICdTZW5kQmFja2VkVGFzaycsIHRoaXMuc2VuZEJhY2tlZFRhc2spO1xyXG4gICAgICAgIEJwbW5Nb2RlbEhlbHBlci5TZXRBdHRyaWJ1dGVWYWx1ZShvYmosICdTZWxlY3RUYXJnZXRBYmxlJywgdGhpcy5zZWxlY3RUYXJnZXRBYmxlKTtcclxuICAgICAgICByZXR1cm4gb2JqO1xyXG4gICAgfVxyXG4gICAgTG9hZEZyb21Kc29uT2JqZWN0KG9iajogYW55KSB7XHJcbiAgICAgICAgc3VwZXIuTG9hZEZyb21Kc29uT2JqZWN0KG9iaik7XHJcbiAgICAgICAgdGhpcy5zZW5kQmFja2VkVGFzayA9IEV4dGVuc2lvbk1ldGhvZC5HZXRBdHRyaWJ1dGVWYWx1ZTRCb29sZWFuKG9iaiwgXCJTZW5kQmFja2VkVGFza1wiKTtcclxuICAgICAgICB0aGlzLnNlbGVjdFRhcmdldEFibGUgPSBFeHRlbnNpb25NZXRob2QuR2V0QXR0cmlidXRlVmFsdWU0Qm9vbGVhbihvYmosIFwiU2VsZWN0VGFyZ2V0QWJsZVwiKTtcclxuICAgIH1cclxuXHJcbiAgICBwcm90ZWN0ZWQgR2V0RXh0ZW5zaW9uRWxlbWVudHM0Q29udmVydFRvKCk6IEV4dGVuc2lvbkVsZW1lbnRbXSB7XHJcbiAgICAgICAgbGV0IGxpc3QgPSBzdXBlci5HZXRFeHRlbnNpb25FbGVtZW50czRDb252ZXJ0VG8oKTtcclxuICAgICAgICBpZiAodGhpcy5FeGVjdXRlRm9ybXMgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICBmb3IgKGxldCBmb3JtIG9mIHRoaXMuRXhlY3V0ZUZvcm1zKSB7XHJcbiAgICAgICAgICAgICAgICBmb3JtLk1leFRhZyA9IFN0YXJ0QWN0aXZpdHkuTUVYVEFHO1xyXG4gICAgICAgICAgICAgICAgbGlzdC5wdXNoKGZvcm0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLmV4dGVuZFByb3BlcnRpZXMgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICBmb3IgKGxldCBlIG9mIHRoaXMuZXh0ZW5kUHJvcGVydGllcykge1xyXG4gICAgICAgICAgICAgICAgZS5NZXhUYWcgPSBTdGFydEFjdGl2aXR5Lk1FWFRBRztcclxuICAgICAgICAgICAgICAgIGxpc3QucHVzaChlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5qdW1wU2NvcGUgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICB0aGlzLmp1bXBTY29wZS5NZXhUYWcgPSBTdGFydEFjdGl2aXR5Lk1FWFRBRztcclxuICAgICAgICAgICAgbGlzdC5wdXNoKHRoaXMuanVtcFNjb3BlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMub3RoZXJBc3NpZ25Ob2RlcyAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIHRoaXMub3RoZXJBc3NpZ25Ob2Rlcy5NZXhUYWcgPSBTdGFydEFjdGl2aXR5Lk1FWFRBRztcclxuICAgICAgICAgICAgbGlzdC5wdXNoKHRoaXMub3RoZXJBc3NpZ25Ob2Rlcyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBsaXN0O1xyXG4gICAgfVxyXG4gICAgcHJvdGVjdGVkIFNldEV4dGVuc2lvbkVsZW1lbnRzNExvYWRGcm9tKGV4dGVuc2lvbkVsZW1lbnRzOiBFeHRlbnNpb25FbGVtZW50W10pIHtcclxuICAgICAgICBzdXBlci5TZXRFeHRlbnNpb25FbGVtZW50czRMb2FkRnJvbShleHRlbnNpb25FbGVtZW50cyk7XHJcbiAgICAgICAgZm9yIChsZXQgZXh0ZW5zaW9uRWxlbWVudCBvZiBleHRlbnNpb25FbGVtZW50cykge1xyXG4gICAgICAgICAgICBpZiAoZXh0ZW5zaW9uRWxlbWVudC5NZXhUYWcgIT09IFN0YXJ0QWN0aXZpdHkuTUVYVEFHKVxyXG4gICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgIHN3aXRjaCAoZXh0ZW5zaW9uRWxlbWVudC5DbHJUeXBlSUQpIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgRXhlY3V0ZUZvcm0uQ2xyX1R5cGVfSUQ6XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5FeGVjdXRlRm9ybXMucHVzaChleHRlbnNpb25FbGVtZW50IGFzIEV4ZWN1dGVGb3JtKTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgRXh0ZW5kUHJvcGVydHkuQ2xyX1R5cGVfSUQ6XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5leHRlbmRQcm9wZXJ0aWVzLnB1c2goZXh0ZW5zaW9uRWxlbWVudCBhcyBFeHRlbmRQcm9wZXJ0eSlcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgSnVtcFNjb3BlLkNscl9UeXBlX0lEOlxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuanVtcFNjb3BlID0gKGV4dGVuc2lvbkVsZW1lbnQgYXMgSnVtcFNjb3BlKTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgT3RoZXJBc3NpZ25Ob2Rlcy5DbHJfVHlwZV9JRDpcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm90aGVyQXNzaWduTm9kZXMgPSAoZXh0ZW5zaW9uRWxlbWVudCBhcyBPdGhlckFzc2lnbk5vZGVzKTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBOZXdJbnN0YW5jZSgpOiBTdGFydEFjdGl2aXR5IHtcclxuICAgICAgICByZXR1cm4gbmV3IFN0YXJ0QWN0aXZpdHkodGhpcy5Nb2RlbCk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICog5qih5Z6L5qCh6aqMXHJcbiAgICAqIEBwYXJhbSBlcnJvcnMg5qih5Z6L5qCh6aqM6ZSZ6K+v5L+h5oGvXHJcbiAgICAqL1xyXG4gICAgVmFsaWRhdGUoZXJyb3JzOiBWYWxpZGF0aW9uRXJyb3JbXSk6IHZvaWQge1xyXG4gICAgICAgIC8vIFRPRE86IOmcgOimgea3u+WKoOiHquWumuS5ieagoemqjOS/oeaBr1xyXG4gICAgICAgIHN1cGVyLlZhbGlkYXRlKGVycm9ycyk7XHJcbiAgICB9XHJcblxyXG4gICAgY2xvbmUoKTogU3RhcnRBY3Rpdml0eSB7XHJcbiAgICAgICAgY29uc3Qgc3RhcnRBY3Rpdml0eSA9IG5ldyBTdGFydEFjdGl2aXR5KHRoaXMuTW9kZWwpO1xyXG4gICAgICAgIHN0YXJ0QWN0aXZpdHkuTmFtZSA9IHRoaXMuTmFtZTtcclxuICAgICAgICBzdGFydEFjdGl2aXR5LnNlbmRCYWNrZWRUYXNrID0gdGhpcy5zZW5kQmFja2VkVGFzaztcclxuICAgICAgICBzdGFydEFjdGl2aXR5LnNlbGVjdFRhcmdldEFibGUgPSB0aGlzLnNlbGVjdFRhcmdldEFibGU7XHJcbiAgICAgICAgc3RhcnRBY3Rpdml0eS5qdW1wU2NvcGUgPSBudWxsO1xyXG4gICAgICAgIGlmICh0aGlzLmp1bXBTY29wZSkge1xyXG4gICAgICAgICAgICBzdGFydEFjdGl2aXR5Lmp1bXBTY29wZSA9IHRoaXMuanVtcFNjb3BlLmNsb25lKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHN0YXJ0QWN0aXZpdHkuRXhlY3V0ZUZvcm1zID0gbmV3IEFycmF5KCk7XHJcbiAgICAgICAgaWYgKHRoaXMuRXhlY3V0ZUZvcm1zICYmIHRoaXMuRXhlY3V0ZUZvcm1zLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgZm9yIChjb25zdCBmIG9mIHRoaXMuRXhlY3V0ZUZvcm1zKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBleGVjdXRlRm9ybSA9IGYuY2xvbmUoKVxyXG4gICAgICAgICAgICAgICAgc3RhcnRBY3Rpdml0eS5FeGVjdXRlRm9ybXMucHVzaChleGVjdXRlRm9ybSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuZXh0ZW5kUHJvcGVydGllcyAmJiB0aGlzLmV4dGVuZFByb3BlcnRpZXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IGUgb2YgdGhpcy5leHRlbmRQcm9wZXJ0aWVzKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBleHRlbmRQcm9wZXJ0eSA9IGUuY2xvbmUoKTtcclxuICAgICAgICAgICAgICAgIHN0YXJ0QWN0aXZpdHkuZXh0ZW5kUHJvcGVydGllcy5wdXNoKGV4dGVuZFByb3BlcnR5KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5vdGhlckFzc2lnbk5vZGVzKSB7XHJcbiAgICAgICAgICAgIHN0YXJ0QWN0aXZpdHkub3RoZXJBc3NpZ25Ob2RlcyA9IHRoaXMub3RoZXJBc3NpZ25Ob2Rlcy5jbG9uZSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gc3RhcnRBY3Rpdml0eTtcclxuICAgIH1cclxuXHJcbiAgICBzZXREZWZhdWx0Rm9ybXMoZm9ybXM6IEFycmF5PGFueT4pIHtcclxuICAgICAgICBpZiAoIXRoaXMuRXhlY3V0ZUZvcm1zKSB7XHJcbiAgICAgICAgICAgIHRoaXMuRXhlY3V0ZUZvcm1zID0gbmV3IEFycmF5KCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZvciAoY29uc3QgZm9ybSBvZiBmb3Jtcykge1xyXG4gICAgICAgICAgICBsZXQgcGFyYW1zID0gZm9ybS51cmxQYXJhbWV0ZXJzIGFzIGFueVtdO1xyXG4gICAgICAgICAgICBsZXQgYWN0UGFyYXMgPSBuZXcgQXJyYXk8QWN0dWFsUGFyYW1ldGVyPigpO1xyXG4gICAgICAgICAgICBpZiAocGFyYW1zICYmIHBhcmFtcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBwYXJhIG9mIHBhcmFtcykge1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBhY3RQYXJhID0gbmV3IEFjdHVhbFBhcmFtZXRlcih0aGlzLk1vZGVsLCBwYXJhLmNvZGUsIHBhcmEudmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChwYXJhLlZhbHVlICYmIHBhcmEuVmFsdWUubGVuZ3RoID49IDggJiYgcGFyYS5WYWx1ZS5zbGljZSgwLCA4KSA9PT0gYHtcImV4cHJcIjpgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdFBhcmEuVGFnID0gJ2V4cHJlc3Npb24nO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdFBhcmEuVGFnID0gJ2NvbnN0YW50JztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgYWN0UGFyYXMucHVzaChhY3RQYXJhKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjb25zdCBpZCA9IEJwbW5Nb2RlbEhlbHBlci5HZW5lcmF0ZUVsZW1lbnRJZCgpO1xyXG4gICAgICAgICAgICBsZXQgaXRlbSA9IG5ldyBFeGVjdXRlRm9ybSh0aGlzLk1vZGVsLCBpZCwgZm9ybS5uYW1lLCBhY3RQYXJhcyk7XHJcbiAgICAgICAgICAgIGl0ZW0uQ29tcG9uZW50SWQgPSBudWxsO1xyXG4gICAgICAgICAgICBpdGVtLkZvcm1UeXBlID0gJzAnO1xyXG4gICAgICAgICAgICBpdGVtLmZvcm1Gb3JtYXRJZCA9IGZvcm0uaWQ7XHJcbiAgICAgICAgICAgIGlmIChmb3JtLnRlcm1pbmFsID09PSAnUEMnKSB7XHJcbiAgICAgICAgICAgICAgICBpdGVtLlRlcm1pbmFsVHlwZSA9IFRlcm1pbmFsVHlwZS5QQztcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChmb3JtLnRlcm1pbmFsID09PSAnTW9iaWxlJykge1xyXG4gICAgICAgICAgICAgICAgaXRlbS5UZXJtaW5hbFR5cGUgPSBUZXJtaW5hbFR5cGUuTU9CSUxFO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuRXhlY3V0ZUZvcm1zLnB1c2goaXRlbSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxufVxyXG5cclxuQnBtbk1vZGVsSGVscGVyLlJlZ2lzdGVyRWxlbWVudFR5cGUobmV3IFN0YXJ0QWN0aXZpdHkobmV3IEJwbW5Nb2RlbCgpKSk7XHJcbiJdfQ==