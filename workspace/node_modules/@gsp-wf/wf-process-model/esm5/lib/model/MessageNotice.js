/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { BpmnModel, BpmnModelHelper, ExtensionElement, ExtensionMethod } from "@edp-pmf/bpmn-model";
import { ActivityExecutorParticipantExpression } from "./participants/ActivityExecutorParticipantExpression";
import { ComponentParticipantExpression } from "./participants/ComponentParticipantExpression";
import { MatrixParticipantExpression } from "./participants/MatrixParticipantExpression";
import { OrganizationParticipantExpression } from "./participants/OrganizationParticipantExpression";
import { PositionParticipantExpression } from "./participants/PositionParticipantExpression";
import { ReportingLineParticipantExpression } from "./participants/ReportingLineParticipantExpression";
import { UserParticipantExpression } from "./participants/UserParticipantExpression";
import { SmsMessageTemplate } from "./SmsMessageTemplate";
var MessageNotice = /** @class */ (function (_super) {
    tslib_1.__extends(MessageNotice, _super);
    function MessageNotice(model) {
        var _this = _super.call(this, model) || this;
        _this.ClrTypeID = MessageNotice.Clr_Type_ID;
        return _this;
    }
    /**
     * @protected
     * @return {?}
     */
    MessageNotice.prototype.ResetBeforeLoadFrom = /**
     * @protected
     * @return {?}
     */
    function () {
        _super.prototype.ResetBeforeLoadFrom.call(this);
        this.receiverExpressions = new Array();
        this.smsMessageTemplate = null;
    };
    /**
     * @return {?}
     */
    MessageNotice.prototype.ConvertToJsonObject = /**
     * @return {?}
     */
    function () {
        var e_1, _a;
        /** @type {?} */
        var obj = _super.prototype.ConvertToJsonObject.call(this);
        ExtensionMethod.SetAttributeValue(obj, "Content", this.content);
        ExtensionMethod.SetAttributeValue(obj, "SendTime", this.sendTime);
        ExtensionMethod.SetAttributeValue(obj, "SendType", this.sendType);
        ExtensionMethod.SetAttributeValue(obj, "Subject", this.subject);
        ExtensionMethod.SetAttributeValue(obj, "Receiver", this.receiver);
        ExtensionMethod.SetAttributeValue(obj, "ReceiverText", this.receiverText);
        if (this.receiverExpressions != null && this.receiverExpressions.length > 0) {
            /** @type {?} */
            var receiverList = new Array();
            try {
                for (var _b = tslib_1.__values(this.receiverExpressions), _c = _b.next(); !_c.done; _c = _b.next()) {
                    var receiver = _c.value;
                    receiverList.push(receiver.ConvertToJsonObject());
                }
            }
            catch (e_1_1) { e_1 = { error: e_1_1 }; }
            finally {
                try {
                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                }
                finally { if (e_1) throw e_1.error; }
            }
            ExtensionMethod.SetAttributeValue(obj, "ReceiverExpressions", receiverList);
        }
        if (this.smsMessageTemplate) {
            ExtensionMethod.SetAttributeValue(obj, "SmsMessageTemplate", this.smsMessageTemplate.ConvertToJsonObject());
        }
        return obj;
    };
    /**
     * @param {?} obj
     * @return {?}
     */
    MessageNotice.prototype.LoadFromJsonObject = /**
     * @param {?} obj
     * @return {?}
     */
    function (obj) {
        var e_2, _a;
        _super.prototype.LoadFromJsonObject.call(this, obj);
        this.content = ExtensionMethod.GetAttributeValue4String(obj, "Content");
        this.sendTime = ExtensionMethod.GetAttributeValue4String(obj, "SendTime");
        this.sendType = ExtensionMethod.GetAttributeValue4String(obj, "SendType");
        this.subject = ExtensionMethod.GetAttributeValue4String(obj, "Subject");
        this.receiver = ExtensionMethod.GetAttributeValue4String(obj, "Receiver");
        this.receiverText = ExtensionMethod.GetAttributeValue4String(obj, "ReceiverText");
        /** @type {?} */
        var receiverList = ExtensionMethod.GetAttributeValue(obj, "ReceiverExpressions");
        if (receiverList && receiverList.length > 0) {
            this.receiverExpressions = new Array();
            try {
                for (var receiverList_1 = tslib_1.__values(receiverList), receiverList_1_1 = receiverList_1.next(); !receiverList_1_1.done; receiverList_1_1 = receiverList_1.next()) {
                    var receiver = receiverList_1_1.value;
                    /** @type {?} */
                    var clrTypeID = ExtensionMethod.GetAttributeValue4String(receiver, "ClrTypeID");
                    switch (clrTypeID) {
                        case UserParticipantExpression.Clr_Type_ID:
                            /** @type {?} */
                            var userParticipantExpression = new UserParticipantExpression(this.Model);
                            userParticipantExpression.LoadFromJsonObject(receiver);
                            this.receiverExpressions.push(userParticipantExpression);
                            break;
                        case PositionParticipantExpression.Clr_Type_ID:
                            /** @type {?} */
                            var positionParticipantExpression = new PositionParticipantExpression(this.Model);
                            positionParticipantExpression.LoadFromJsonObject(receiver);
                            this.receiverExpressions.push(positionParticipantExpression);
                            break;
                        case ReportingLineParticipantExpression.Clr_Type_ID:
                            /** @type {?} */
                            var reportingLineParticipantExpression = new ReportingLineParticipantExpression(this.Model);
                            reportingLineParticipantExpression.LoadFromJsonObject(receiver);
                            this.receiverExpressions.push(reportingLineParticipantExpression);
                            break;
                        case OrganizationParticipantExpression.Clr_Type_ID:
                            /** @type {?} */
                            var organizationParticipantExpression = new OrganizationParticipantExpression(this.Model);
                            organizationParticipantExpression.LoadFromJsonObject(receiver);
                            this.receiverExpressions.push(organizationParticipantExpression);
                            break;
                        case MatrixParticipantExpression.Clr_Type_ID:
                            /** @type {?} */
                            var matrixParticipantExpression = new MatrixParticipantExpression(this.Model);
                            matrixParticipantExpression.LoadFromJsonObject(receiver);
                            this.receiverExpressions.push(matrixParticipantExpression);
                            break;
                        case ComponentParticipantExpression.Clr_Type_ID:
                            /** @type {?} */
                            var componentParticipantExpression = new ComponentParticipantExpression(this.Model);
                            componentParticipantExpression.LoadFromJsonObject(receiver);
                            this.receiverExpressions.push(componentParticipantExpression);
                            break;
                        case ActivityExecutorParticipantExpression.Clr_Type_ID:
                            /** @type {?} */
                            var activityExecutorParticipantExpression = new ActivityExecutorParticipantExpression(this.Model);
                            activityExecutorParticipantExpression.LoadFromJsonObject(receiver);
                            this.receiverExpressions.push(activityExecutorParticipantExpression);
                            break;
                        default:
                            break;
                    }
                }
            }
            catch (e_2_1) { e_2 = { error: e_2_1 }; }
            finally {
                try {
                    if (receiverList_1_1 && !receiverList_1_1.done && (_a = receiverList_1.return)) _a.call(receiverList_1);
                }
                finally { if (e_2) throw e_2.error; }
            }
        }
        /** @type {?} */
        var smsTemplateElement = ExtensionMethod.GetAttributeValue(obj, 'SmsMessageTemplate');
        if (smsTemplateElement) {
            /** @type {?} */
            var smsMessageTemplate = new SmsMessageTemplate(this.Model);
            smsMessageTemplate.LoadFromJsonObject(smsTemplateElement);
            this.smsMessageTemplate = smsMessageTemplate;
        }
    };
    /**
     * @return {?}
     */
    MessageNotice.prototype.NewInstance = /**
     * @return {?}
     */
    function () {
        return new MessageNotice(this.Model);
    };
    /**
     * @return {?}
     */
    MessageNotice.prototype.clone = /**
     * @return {?}
     */
    function () {
        var e_3, _a;
        /** @type {?} */
        var messageNotice = new MessageNotice(this.Model);
        messageNotice.content = this.content;
        messageNotice.sendTime = this.sendTime;
        messageNotice.sendType = this.sendType;
        messageNotice.subject = this.subject;
        messageNotice.receiver = this.receiver;
        messageNotice.receiverText = this.receiverText;
        messageNotice.receiverExpressions = new Array();
        if (this.receiverExpressions && this.receiverExpressions.length > 0) {
            try {
                for (var _b = tslib_1.__values(this.receiverExpressions), _c = _b.next(); !_c.done; _c = _b.next()) {
                    var r = _c.value;
                    if (r instanceof OrganizationParticipantExpression) {
                        /** @type {?} */
                        var o = (/** @type {?} */ (r));
                        /** @type {?} */
                        var organizationParticipantExpression = o.clone();
                        messageNotice.receiverExpressions.push(organizationParticipantExpression);
                    }
                    else if (r instanceof UserParticipantExpression) {
                        /** @type {?} */
                        var u = (/** @type {?} */ (r));
                        /** @type {?} */
                        var userParticipantExpression = u.clone();
                        messageNotice.receiverExpressions.push(userParticipantExpression);
                    }
                    else if (r instanceof PositionParticipantExpression) {
                        /** @type {?} */
                        var p = (/** @type {?} */ (r));
                        /** @type {?} */
                        var positionParticipantExpression = p.clone();
                        messageNotice.receiverExpressions.push(positionParticipantExpression);
                    }
                    else if (r instanceof ReportingLineParticipantExpression) {
                        /** @type {?} */
                        var re = (/** @type {?} */ (r));
                        /** @type {?} */
                        var reportingLineParticipantExpression = re.clone();
                        messageNotice.receiverExpressions.push(reportingLineParticipantExpression);
                    }
                    else if (r instanceof MatrixParticipantExpression) {
                        /** @type {?} */
                        var m = (/** @type {?} */ (r));
                        /** @type {?} */
                        var matrixParticipantExpression = m.clone();
                        messageNotice.receiverExpressions.push(matrixParticipantExpression);
                    }
                    else if (r instanceof ComponentParticipantExpression) {
                        /** @type {?} */
                        var c = (/** @type {?} */ (r));
                        /** @type {?} */
                        var componentParticipantExpression = c.clone();
                        messageNotice.receiverExpressions.push(componentParticipantExpression);
                    }
                    else if (r instanceof ActivityExecutorParticipantExpression) {
                        /** @type {?} */
                        var a = (/** @type {?} */ (r));
                        /** @type {?} */
                        var activityExecutorParticipantExpression = a.clone();
                        messageNotice.receiverExpressions.push(activityExecutorParticipantExpression);
                    }
                }
            }
            catch (e_3_1) { e_3 = { error: e_3_1 }; }
            finally {
                try {
                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                }
                finally { if (e_3) throw e_3.error; }
            }
        }
        if (this.smsMessageTemplate) {
            messageNotice.smsMessageTemplate = this.smsMessageTemplate.clone();
        }
        return messageNotice;
    };
    MessageNotice.Clr_Type_ID = "wf.MessageNotice";
    return MessageNotice;
}(ExtensionElement));
export { MessageNotice };
if (false) {
    /** @type {?} */
    MessageNotice.Clr_Type_ID;
    /** @type {?} */
    MessageNotice.prototype.ClrTypeID;
    /**
     * 消息内容
     * @type {?}
     */
    MessageNotice.prototype.content;
    /**
     * 消息发送时机
     * @type {?}
     */
    MessageNotice.prototype.sendTime;
    /**
     * 消息发送方式
     * @type {?}
     */
    MessageNotice.prototype.sendType;
    /**
     * 消息主题
     * @type {?}
     */
    MessageNotice.prototype.subject;
    /**
     * 消息接收人
     * @type {?}
     */
    MessageNotice.prototype.receiver;
    /**
     * 消息接收人显示
     * @type {?}
     */
    MessageNotice.prototype.receiverText;
    /** @type {?} */
    MessageNotice.prototype.receiverExpressions;
    /** @type {?} */
    MessageNotice.prototype.smsMessageTemplate;
}
BpmnModelHelper.RegisterElementType(new MessageNotice(new BpmnModel()));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiTWVzc2FnZU5vdGljZS5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0Bnc3Atd2Yvd2YtcHJvY2Vzcy1tb2RlbC8iLCJzb3VyY2VzIjpbImxpYi9tb2RlbC9NZXNzYWdlTm90aWNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsT0FBTyxFQUFFLFNBQVMsRUFBRSxlQUFlLEVBQUUsZ0JBQWdCLEVBQUUsZUFBZSxFQUFtQixNQUFNLHFCQUFxQixDQUFDO0FBQ3JILE9BQU8sRUFBRSxxQ0FBcUMsRUFBRSxNQUFNLHNEQUFzRCxDQUFDO0FBQzdHLE9BQU8sRUFBRSw4QkFBOEIsRUFBRSxNQUFNLCtDQUErQyxDQUFDO0FBQy9GLE9BQU8sRUFBRSwyQkFBMkIsRUFBRSxNQUFNLDRDQUE0QyxDQUFDO0FBQ3pGLE9BQU8sRUFBRSxpQ0FBaUMsRUFBRSxNQUFNLGtEQUFrRCxDQUFDO0FBRXJHLE9BQU8sRUFBRSw2QkFBNkIsRUFBRSxNQUFNLDhDQUE4QyxDQUFDO0FBQzdGLE9BQU8sRUFBRSxrQ0FBa0MsRUFBRSxNQUFNLG1EQUFtRCxDQUFDO0FBQ3ZHLE9BQU8sRUFBRSx5QkFBeUIsRUFBRSxNQUFNLDBDQUEwQyxDQUFDO0FBQ3JGLE9BQU8sRUFBRSxrQkFBa0IsRUFBRSxNQUFNLHNCQUFzQixDQUFDO0FBRTFEO0lBQW1DLHlDQUFnQjtJQXNDL0MsdUJBQVksS0FBZ0I7UUFBNUIsWUFDSSxrQkFBTSxLQUFLLENBQUMsU0FDZjtRQXRDUSxlQUFTLEdBQVcsYUFBYSxDQUFDLFdBQVcsQ0FBQzs7SUFzQ3ZELENBQUM7Ozs7O0lBRVMsMkNBQW1COzs7O0lBQTdCO1FBQ0ksaUJBQU0sbUJBQW1CLFdBQUUsQ0FBQztRQUM1QixJQUFJLENBQUMsbUJBQW1CLEdBQUcsSUFBSSxLQUFLLEVBQUUsQ0FBQztRQUN2QyxJQUFJLENBQUMsa0JBQWtCLEdBQUcsSUFBSSxDQUFDO0lBQ25DLENBQUM7Ozs7SUFFRCwyQ0FBbUI7OztJQUFuQjs7O1lBQ1EsR0FBRyxHQUFHLGlCQUFNLG1CQUFtQixXQUFFO1FBQ3JDLGVBQWUsQ0FBQyxpQkFBaUIsQ0FBQyxHQUFHLEVBQUUsU0FBUyxFQUFFLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQztRQUNoRSxlQUFlLENBQUMsaUJBQWlCLENBQUMsR0FBRyxFQUFFLFVBQVUsRUFBRSxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUM7UUFDbEUsZUFBZSxDQUFDLGlCQUFpQixDQUFDLEdBQUcsRUFBRSxVQUFVLEVBQUUsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBQ2xFLGVBQWUsQ0FBQyxpQkFBaUIsQ0FBQyxHQUFHLEVBQUUsU0FBUyxFQUFFLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQztRQUNoRSxlQUFlLENBQUMsaUJBQWlCLENBQUMsR0FBRyxFQUFFLFVBQVUsRUFBRSxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUM7UUFDbEUsZUFBZSxDQUFDLGlCQUFpQixDQUFDLEdBQUcsRUFBRSxjQUFjLEVBQUUsSUFBSSxDQUFDLFlBQVksQ0FBQyxDQUFDO1FBRTFFLElBQUksSUFBSSxDQUFDLG1CQUFtQixJQUFJLElBQUksSUFBSSxJQUFJLENBQUMsbUJBQW1CLENBQUMsTUFBTSxHQUFHLENBQUMsRUFBRTs7Z0JBQ25FLFlBQVksR0FBRyxJQUFJLEtBQUssRUFBRTs7Z0JBQ2hDLEtBQXVCLElBQUEsS0FBQSxpQkFBQSxJQUFJLENBQUMsbUJBQW1CLENBQUEsZ0JBQUEsNEJBQUU7b0JBQTVDLElBQU0sUUFBUSxXQUFBO29CQUNmLFlBQVksQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLG1CQUFtQixFQUFFLENBQUMsQ0FBQztpQkFDckQ7Ozs7Ozs7OztZQUNELGVBQWUsQ0FBQyxpQkFBaUIsQ0FBQyxHQUFHLEVBQUUscUJBQXFCLEVBQUUsWUFBWSxDQUFDLENBQUM7U0FDL0U7UUFDRCxJQUFJLElBQUksQ0FBQyxrQkFBa0IsRUFBRTtZQUN6QixlQUFlLENBQUMsaUJBQWlCLENBQUMsR0FBRyxFQUFFLG9CQUFvQixFQUFFLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxtQkFBbUIsRUFBRSxDQUFDLENBQUM7U0FDL0c7UUFFRCxPQUFPLEdBQUcsQ0FBQztJQUNmLENBQUM7Ozs7O0lBRUQsMENBQWtCOzs7O0lBQWxCLFVBQW1CLEdBQVE7O1FBQ3ZCLGlCQUFNLGtCQUFrQixZQUFDLEdBQUcsQ0FBQyxDQUFDO1FBRTlCLElBQUksQ0FBQyxPQUFPLEdBQUcsZUFBZSxDQUFDLHdCQUF3QixDQUFDLEdBQUcsRUFBRSxTQUFTLENBQUMsQ0FBQztRQUN4RSxJQUFJLENBQUMsUUFBUSxHQUFHLGVBQWUsQ0FBQyx3QkFBd0IsQ0FBQyxHQUFHLEVBQUUsVUFBVSxDQUFDLENBQUM7UUFDMUUsSUFBSSxDQUFDLFFBQVEsR0FBRyxlQUFlLENBQUMsd0JBQXdCLENBQUMsR0FBRyxFQUFFLFVBQVUsQ0FBQyxDQUFDO1FBQzFFLElBQUksQ0FBQyxPQUFPLEdBQUcsZUFBZSxDQUFDLHdCQUF3QixDQUFDLEdBQUcsRUFBRSxTQUFTLENBQUMsQ0FBQztRQUN4RSxJQUFJLENBQUMsUUFBUSxHQUFHLGVBQWUsQ0FBQyx3QkFBd0IsQ0FBQyxHQUFHLEVBQUUsVUFBVSxDQUFDLENBQUM7UUFDMUUsSUFBSSxDQUFDLFlBQVksR0FBRyxlQUFlLENBQUMsd0JBQXdCLENBQUMsR0FBRyxFQUFFLGNBQWMsQ0FBQyxDQUFDOztZQUU1RSxZQUFZLEdBQWUsZUFBZSxDQUFDLGlCQUFpQixDQUFDLEdBQUcsRUFBRSxxQkFBcUIsQ0FBQztRQUM5RixJQUFJLFlBQVksSUFBSSxZQUFZLENBQUMsTUFBTSxHQUFHLENBQUMsRUFBRTtZQUN6QyxJQUFJLENBQUMsbUJBQW1CLEdBQUcsSUFBSSxLQUFLLEVBQUUsQ0FBQzs7Z0JBQ3ZDLEtBQXVCLElBQUEsaUJBQUEsaUJBQUEsWUFBWSxDQUFBLDBDQUFBLG9FQUFFO29CQUFoQyxJQUFNLFFBQVEseUJBQUE7O3dCQUNULFNBQVMsR0FBRyxlQUFlLENBQUMsd0JBQXdCLENBQUMsUUFBUSxFQUFFLFdBQVcsQ0FBQztvQkFDakYsUUFBUSxTQUFTLEVBQUU7d0JBQ2YsS0FBSyx5QkFBeUIsQ0FBQyxXQUFXOztnQ0FDaEMseUJBQXlCLEdBQUcsSUFBSSx5QkFBeUIsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDOzRCQUMzRSx5QkFBeUIsQ0FBQyxrQkFBa0IsQ0FBQyxRQUFRLENBQUMsQ0FBQzs0QkFDdkQsSUFBSSxDQUFDLG1CQUFtQixDQUFDLElBQUksQ0FBQyx5QkFBeUIsQ0FBQyxDQUFDOzRCQUN6RCxNQUFNO3dCQUNWLEtBQUssNkJBQTZCLENBQUMsV0FBVzs7Z0NBQ3BDLDZCQUE2QixHQUFHLElBQUksNkJBQTZCLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQzs0QkFDbkYsNkJBQTZCLENBQUMsa0JBQWtCLENBQUMsUUFBUSxDQUFDLENBQUM7NEJBQzNELElBQUksQ0FBQyxtQkFBbUIsQ0FBQyxJQUFJLENBQUMsNkJBQTZCLENBQUMsQ0FBQzs0QkFDN0QsTUFBTTt3QkFDVixLQUFLLGtDQUFrQyxDQUFDLFdBQVc7O2dDQUN6QyxrQ0FBa0MsR0FBRyxJQUFJLGtDQUFrQyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUM7NEJBQzdGLGtDQUFrQyxDQUFDLGtCQUFrQixDQUFDLFFBQVEsQ0FBQyxDQUFDOzRCQUNoRSxJQUFJLENBQUMsbUJBQW1CLENBQUMsSUFBSSxDQUFDLGtDQUFrQyxDQUFDLENBQUM7NEJBQ2xFLE1BQU07d0JBQ1YsS0FBSyxpQ0FBaUMsQ0FBQyxXQUFXOztnQ0FDeEMsaUNBQWlDLEdBQUcsSUFBSSxpQ0FBaUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDOzRCQUMzRixpQ0FBaUMsQ0FBQyxrQkFBa0IsQ0FBQyxRQUFRLENBQUMsQ0FBQzs0QkFDL0QsSUFBSSxDQUFDLG1CQUFtQixDQUFDLElBQUksQ0FBQyxpQ0FBaUMsQ0FBQyxDQUFDOzRCQUNqRSxNQUFNO3dCQUNWLEtBQUssMkJBQTJCLENBQUMsV0FBVzs7Z0NBQ2xDLDJCQUEyQixHQUFHLElBQUksMkJBQTJCLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQzs0QkFDL0UsMkJBQTJCLENBQUMsa0JBQWtCLENBQUMsUUFBUSxDQUFDLENBQUM7NEJBQ3pELElBQUksQ0FBQyxtQkFBbUIsQ0FBQyxJQUFJLENBQUMsMkJBQTJCLENBQUMsQ0FBQzs0QkFDM0QsTUFBTTt3QkFDVixLQUFLLDhCQUE4QixDQUFDLFdBQVc7O2dDQUNyQyw4QkFBOEIsR0FBRyxJQUFJLDhCQUE4QixDQUFDLElBQUksQ0FBQyxLQUFLLENBQUM7NEJBQ3JGLDhCQUE4QixDQUFDLGtCQUFrQixDQUFDLFFBQVEsQ0FBQyxDQUFDOzRCQUM1RCxJQUFJLENBQUMsbUJBQW1CLENBQUMsSUFBSSxDQUFDLDhCQUE4QixDQUFDLENBQUM7NEJBQzlELE1BQU07d0JBQ1YsS0FBSyxxQ0FBcUMsQ0FBQyxXQUFXOztnQ0FDNUMscUNBQXFDLEdBQUcsSUFBSSxxQ0FBcUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDOzRCQUNuRyxxQ0FBcUMsQ0FBQyxrQkFBa0IsQ0FBQyxRQUFRLENBQUMsQ0FBQzs0QkFDbkUsSUFBSSxDQUFDLG1CQUFtQixDQUFDLElBQUksQ0FBQyxxQ0FBcUMsQ0FBQyxDQUFDOzRCQUNyRSxNQUFNO3dCQUNWOzRCQUNJLE1BQU07cUJBQ2I7aUJBQ0o7Ozs7Ozs7OztTQUNKOztZQUVLLGtCQUFrQixHQUFHLGVBQWUsQ0FBQyxpQkFBaUIsQ0FBQyxHQUFHLEVBQUUsb0JBQW9CLENBQUM7UUFDdkYsSUFBSSxrQkFBa0IsRUFBRTs7Z0JBQ2Qsa0JBQWtCLEdBQUcsSUFBSSxrQkFBa0IsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDO1lBQzdELGtCQUFrQixDQUFDLGtCQUFrQixDQUFDLGtCQUFrQixDQUFDLENBQUM7WUFDMUQsSUFBSSxDQUFDLGtCQUFrQixHQUFHLGtCQUFrQixDQUFDO1NBQ2hEO0lBQ0wsQ0FBQzs7OztJQUVELG1DQUFXOzs7SUFBWDtRQUNJLE9BQU8sSUFBSSxhQUFhLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQ3pDLENBQUM7Ozs7SUFFRCw2QkFBSzs7O0lBQUw7OztZQUNVLGFBQWEsR0FBRyxJQUFJLGFBQWEsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDO1FBQ25ELGFBQWEsQ0FBQyxPQUFPLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQztRQUNyQyxhQUFhLENBQUMsUUFBUSxHQUFHLElBQUksQ0FBQyxRQUFRLENBQUM7UUFDdkMsYUFBYSxDQUFDLFFBQVEsR0FBRyxJQUFJLENBQUMsUUFBUSxDQUFDO1FBQ3ZDLGFBQWEsQ0FBQyxPQUFPLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQztRQUNyQyxhQUFhLENBQUMsUUFBUSxHQUFHLElBQUksQ0FBQyxRQUFRLENBQUM7UUFDdkMsYUFBYSxDQUFDLFlBQVksR0FBRyxJQUFJLENBQUMsWUFBWSxDQUFDO1FBQy9DLGFBQWEsQ0FBQyxtQkFBbUIsR0FBRyxJQUFJLEtBQUssRUFBRSxDQUFDO1FBQ2hELElBQUksSUFBSSxDQUFDLG1CQUFtQixJQUFJLElBQUksQ0FBQyxtQkFBbUIsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxFQUFFOztnQkFDakUsS0FBZ0IsSUFBQSxLQUFBLGlCQUFBLElBQUksQ0FBQyxtQkFBbUIsQ0FBQSxnQkFBQSw0QkFBRTtvQkFBckMsSUFBTSxDQUFDLFdBQUE7b0JBQ1IsSUFBSSxDQUFDLFlBQVksaUNBQWlDLEVBQUU7OzRCQUMxQyxDQUFDLEdBQUcsbUJBQUEsQ0FBQyxFQUFxQzs7NEJBQzFDLGlDQUFpQyxHQUFHLENBQUMsQ0FBQyxLQUFLLEVBQUU7d0JBQ25ELGFBQWEsQ0FBQyxtQkFBbUIsQ0FBQyxJQUFJLENBQUMsaUNBQWlDLENBQUMsQ0FBQztxQkFDN0U7eUJBQ0ksSUFBSSxDQUFDLFlBQVkseUJBQXlCLEVBQUU7OzRCQUN2QyxDQUFDLEdBQUcsbUJBQUEsQ0FBQyxFQUE2Qjs7NEJBQ2xDLHlCQUF5QixHQUFHLENBQUMsQ0FBQyxLQUFLLEVBQUU7d0JBQzNDLGFBQWEsQ0FBQyxtQkFBbUIsQ0FBQyxJQUFJLENBQUMseUJBQXlCLENBQUMsQ0FBQztxQkFDckU7eUJBQ0ksSUFBSSxDQUFDLFlBQVksNkJBQTZCLEVBQUU7OzRCQUMzQyxDQUFDLEdBQUcsbUJBQUEsQ0FBQyxFQUFpQzs7NEJBQ3RDLDZCQUE2QixHQUFHLENBQUMsQ0FBQyxLQUFLLEVBQUU7d0JBQy9DLGFBQWEsQ0FBQyxtQkFBbUIsQ0FBQyxJQUFJLENBQUMsNkJBQTZCLENBQUMsQ0FBQztxQkFDekU7eUJBQ0ksSUFBSSxDQUFDLFlBQVksa0NBQWtDLEVBQUU7OzRCQUNoRCxFQUFFLEdBQUcsbUJBQUEsQ0FBQyxFQUFzQzs7NEJBQzVDLGtDQUFrQyxHQUFHLEVBQUUsQ0FBQyxLQUFLLEVBQUU7d0JBQ3JELGFBQWEsQ0FBQyxtQkFBbUIsQ0FBQyxJQUFJLENBQUMsa0NBQWtDLENBQUMsQ0FBQztxQkFDOUU7eUJBQ0ksSUFBSSxDQUFDLFlBQVksMkJBQTJCLEVBQUU7OzRCQUN6QyxDQUFDLEdBQUcsbUJBQUEsQ0FBQyxFQUErQjs7NEJBQ3BDLDJCQUEyQixHQUFHLENBQUMsQ0FBQyxLQUFLLEVBQUU7d0JBQzdDLGFBQWEsQ0FBQyxtQkFBbUIsQ0FBQyxJQUFJLENBQUMsMkJBQTJCLENBQUMsQ0FBQztxQkFDdkU7eUJBQ0ksSUFBSSxDQUFDLFlBQVksOEJBQThCLEVBQUU7OzRCQUM1QyxDQUFDLEdBQUcsbUJBQUEsQ0FBQyxFQUFrQzs7NEJBQ3ZDLDhCQUE4QixHQUFHLENBQUMsQ0FBQyxLQUFLLEVBQUU7d0JBQ2hELGFBQWEsQ0FBQyxtQkFBbUIsQ0FBQyxJQUFJLENBQUMsOEJBQThCLENBQUMsQ0FBQztxQkFDMUU7eUJBQU0sSUFBSSxDQUFDLFlBQVkscUNBQXFDLEVBQUU7OzRCQUNyRCxDQUFDLEdBQUcsbUJBQUEsQ0FBQyxFQUF5Qzs7NEJBQzlDLHFDQUFxQyxHQUFHLENBQUMsQ0FBQyxLQUFLLEVBQUU7d0JBQ3ZELGFBQWEsQ0FBQyxtQkFBbUIsQ0FBQyxJQUFJLENBQUMscUNBQXFDLENBQUMsQ0FBQztxQkFDakY7aUJBQ0o7Ozs7Ozs7OztTQUNKO1FBQ0QsSUFBSSxJQUFJLENBQUMsa0JBQWtCLEVBQUU7WUFDekIsYUFBYSxDQUFDLGtCQUFrQixHQUFHLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxLQUFLLEVBQUUsQ0FBQztTQUN0RTtRQUNELE9BQU8sYUFBYSxDQUFDO0lBQ3pCLENBQUM7SUE5TE0seUJBQVcsR0FBVyxrQkFBa0IsQ0FBQztJQWdNcEQsb0JBQUM7Q0FBQSxBQWpNRCxDQUFtQyxnQkFBZ0IsR0FpTWxEO1NBak1ZLGFBQWE7OztJQUN0QiwwQkFBZ0Q7O0lBQ2hELGtDQUF1RDs7Ozs7SUFLdkQsZ0NBQWdCOzs7OztJQUtoQixpQ0FBaUI7Ozs7O0lBS2pCLGlDQUFpQjs7Ozs7SUFLakIsZ0NBQWdCOzs7OztJQUtoQixpQ0FBaUI7Ozs7O0lBS2pCLHFDQUFxQjs7SUFFckIsNENBQWtEOztJQUVsRCwyQ0FBdUM7O0FBOEozQyxlQUFlLENBQUMsbUJBQW1CLENBQUMsSUFBSSxhQUFhLENBQUMsSUFBSSxTQUFTLEVBQUUsQ0FBQyxDQUFDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBCcG1uTW9kZWwsIEJwbW5Nb2RlbEhlbHBlciwgRXh0ZW5zaW9uRWxlbWVudCwgRXh0ZW5zaW9uTWV0aG9kLCBWYWxpZGF0aW9uRXJyb3IgfSBmcm9tIFwiQGVkcC1wbWYvYnBtbi1tb2RlbFwiO1xyXG5pbXBvcnQgeyBBY3Rpdml0eUV4ZWN1dG9yUGFydGljaXBhbnRFeHByZXNzaW9uIH0gZnJvbSBcIi4vcGFydGljaXBhbnRzL0FjdGl2aXR5RXhlY3V0b3JQYXJ0aWNpcGFudEV4cHJlc3Npb25cIjtcclxuaW1wb3J0IHsgQ29tcG9uZW50UGFydGljaXBhbnRFeHByZXNzaW9uIH0gZnJvbSBcIi4vcGFydGljaXBhbnRzL0NvbXBvbmVudFBhcnRpY2lwYW50RXhwcmVzc2lvblwiO1xyXG5pbXBvcnQgeyBNYXRyaXhQYXJ0aWNpcGFudEV4cHJlc3Npb24gfSBmcm9tIFwiLi9wYXJ0aWNpcGFudHMvTWF0cml4UGFydGljaXBhbnRFeHByZXNzaW9uXCI7XHJcbmltcG9ydCB7IE9yZ2FuaXphdGlvblBhcnRpY2lwYW50RXhwcmVzc2lvbiB9IGZyb20gXCIuL3BhcnRpY2lwYW50cy9Pcmdhbml6YXRpb25QYXJ0aWNpcGFudEV4cHJlc3Npb25cIjtcclxuaW1wb3J0IHsgUGFydGljaXBhbnRFeHByZXNzaW9uIH0gZnJvbSBcIi4vcGFydGljaXBhbnRzL1BhcnRpY2lwYW50RXhwcmVzc2lvblwiO1xyXG5pbXBvcnQgeyBQb3NpdGlvblBhcnRpY2lwYW50RXhwcmVzc2lvbiB9IGZyb20gXCIuL3BhcnRpY2lwYW50cy9Qb3NpdGlvblBhcnRpY2lwYW50RXhwcmVzc2lvblwiO1xyXG5pbXBvcnQgeyBSZXBvcnRpbmdMaW5lUGFydGljaXBhbnRFeHByZXNzaW9uIH0gZnJvbSBcIi4vcGFydGljaXBhbnRzL1JlcG9ydGluZ0xpbmVQYXJ0aWNpcGFudEV4cHJlc3Npb25cIjtcclxuaW1wb3J0IHsgVXNlclBhcnRpY2lwYW50RXhwcmVzc2lvbiB9IGZyb20gXCIuL3BhcnRpY2lwYW50cy9Vc2VyUGFydGljaXBhbnRFeHByZXNzaW9uXCI7XHJcbmltcG9ydCB7IFNtc01lc3NhZ2VUZW1wbGF0ZSB9IGZyb20gXCIuL1Ntc01lc3NhZ2VUZW1wbGF0ZVwiO1xyXG5cclxuZXhwb3J0IGNsYXNzIE1lc3NhZ2VOb3RpY2UgZXh0ZW5kcyBFeHRlbnNpb25FbGVtZW50IHtcclxuICAgIHN0YXRpYyBDbHJfVHlwZV9JRDogc3RyaW5nID0gXCJ3Zi5NZXNzYWdlTm90aWNlXCI7XHJcbiAgICByZWFkb25seSBDbHJUeXBlSUQ6IHN0cmluZyA9IE1lc3NhZ2VOb3RpY2UuQ2xyX1R5cGVfSUQ7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDmtojmga/lhoXlrrlcclxuICAgICAqL1xyXG4gICAgY29udGVudDogc3RyaW5nO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICog5raI5oGv5Y+R6YCB5pe25py6XHJcbiAgICAgKi9cclxuICAgIHNlbmRUaW1lOiBzdHJpbmc7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDmtojmga/lj5HpgIHmlrnlvI9cclxuICAgICAqL1xyXG4gICAgc2VuZFR5cGU6IHN0cmluZztcclxuXHJcbiAgICAvKipcclxuICAgICAqIOa2iOaBr+S4u+mimFxyXG4gICAgICovXHJcbiAgICBzdWJqZWN0OiBzdHJpbmc7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDmtojmga/mjqXmlLbkurpcclxuICAgICAqL1xyXG4gICAgcmVjZWl2ZXI6IHN0cmluZztcclxuXHJcbiAgICAvKipcclxuICAgICAqIOa2iOaBr+aOpeaUtuS6uuaYvuekulxyXG4gICAgICovXHJcbiAgICByZWNlaXZlclRleHQ6IHN0cmluZztcclxuXHJcbiAgICByZWNlaXZlckV4cHJlc3Npb25zOiBBcnJheTxQYXJ0aWNpcGFudEV4cHJlc3Npb24+O1xyXG5cclxuICAgIHNtc01lc3NhZ2VUZW1wbGF0ZTogU21zTWVzc2FnZVRlbXBsYXRlO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKG1vZGVsOiBCcG1uTW9kZWwpIHtcclxuICAgICAgICBzdXBlcihtb2RlbCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJvdGVjdGVkIFJlc2V0QmVmb3JlTG9hZEZyb20oKSB7XHJcbiAgICAgICAgc3VwZXIuUmVzZXRCZWZvcmVMb2FkRnJvbSgpO1xyXG4gICAgICAgIHRoaXMucmVjZWl2ZXJFeHByZXNzaW9ucyA9IG5ldyBBcnJheSgpO1xyXG4gICAgICAgIHRoaXMuc21zTWVzc2FnZVRlbXBsYXRlID0gbnVsbDtcclxuICAgIH1cclxuXHJcbiAgICBDb252ZXJ0VG9Kc29uT2JqZWN0KCk6IGFueSB7XHJcbiAgICAgICAgbGV0IG9iaiA9IHN1cGVyLkNvbnZlcnRUb0pzb25PYmplY3QoKTtcclxuICAgICAgICBFeHRlbnNpb25NZXRob2QuU2V0QXR0cmlidXRlVmFsdWUob2JqLCBcIkNvbnRlbnRcIiwgdGhpcy5jb250ZW50KTtcclxuICAgICAgICBFeHRlbnNpb25NZXRob2QuU2V0QXR0cmlidXRlVmFsdWUob2JqLCBcIlNlbmRUaW1lXCIsIHRoaXMuc2VuZFRpbWUpO1xyXG4gICAgICAgIEV4dGVuc2lvbk1ldGhvZC5TZXRBdHRyaWJ1dGVWYWx1ZShvYmosIFwiU2VuZFR5cGVcIiwgdGhpcy5zZW5kVHlwZSk7XHJcbiAgICAgICAgRXh0ZW5zaW9uTWV0aG9kLlNldEF0dHJpYnV0ZVZhbHVlKG9iaiwgXCJTdWJqZWN0XCIsIHRoaXMuc3ViamVjdCk7XHJcbiAgICAgICAgRXh0ZW5zaW9uTWV0aG9kLlNldEF0dHJpYnV0ZVZhbHVlKG9iaiwgXCJSZWNlaXZlclwiLCB0aGlzLnJlY2VpdmVyKTtcclxuICAgICAgICBFeHRlbnNpb25NZXRob2QuU2V0QXR0cmlidXRlVmFsdWUob2JqLCBcIlJlY2VpdmVyVGV4dFwiLCB0aGlzLnJlY2VpdmVyVGV4dCk7XHJcblxyXG4gICAgICAgIGlmICh0aGlzLnJlY2VpdmVyRXhwcmVzc2lvbnMgIT0gbnVsbCAmJiB0aGlzLnJlY2VpdmVyRXhwcmVzc2lvbnMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICBjb25zdCByZWNlaXZlckxpc3QgPSBuZXcgQXJyYXkoKTtcclxuICAgICAgICAgICAgZm9yIChjb25zdCByZWNlaXZlciBvZiB0aGlzLnJlY2VpdmVyRXhwcmVzc2lvbnMpIHtcclxuICAgICAgICAgICAgICAgIHJlY2VpdmVyTGlzdC5wdXNoKHJlY2VpdmVyLkNvbnZlcnRUb0pzb25PYmplY3QoKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgRXh0ZW5zaW9uTWV0aG9kLlNldEF0dHJpYnV0ZVZhbHVlKG9iaiwgXCJSZWNlaXZlckV4cHJlc3Npb25zXCIsIHJlY2VpdmVyTGlzdCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLnNtc01lc3NhZ2VUZW1wbGF0ZSkge1xyXG4gICAgICAgICAgICBFeHRlbnNpb25NZXRob2QuU2V0QXR0cmlidXRlVmFsdWUob2JqLCBcIlNtc01lc3NhZ2VUZW1wbGF0ZVwiLCB0aGlzLnNtc01lc3NhZ2VUZW1wbGF0ZS5Db252ZXJ0VG9Kc29uT2JqZWN0KCkpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIG9iajtcclxuICAgIH1cclxuXHJcbiAgICBMb2FkRnJvbUpzb25PYmplY3Qob2JqOiBhbnkpIHtcclxuICAgICAgICBzdXBlci5Mb2FkRnJvbUpzb25PYmplY3Qob2JqKTtcclxuXHJcbiAgICAgICAgdGhpcy5jb250ZW50ID0gRXh0ZW5zaW9uTWV0aG9kLkdldEF0dHJpYnV0ZVZhbHVlNFN0cmluZyhvYmosIFwiQ29udGVudFwiKTtcclxuICAgICAgICB0aGlzLnNlbmRUaW1lID0gRXh0ZW5zaW9uTWV0aG9kLkdldEF0dHJpYnV0ZVZhbHVlNFN0cmluZyhvYmosIFwiU2VuZFRpbWVcIik7XHJcbiAgICAgICAgdGhpcy5zZW5kVHlwZSA9IEV4dGVuc2lvbk1ldGhvZC5HZXRBdHRyaWJ1dGVWYWx1ZTRTdHJpbmcob2JqLCBcIlNlbmRUeXBlXCIpO1xyXG4gICAgICAgIHRoaXMuc3ViamVjdCA9IEV4dGVuc2lvbk1ldGhvZC5HZXRBdHRyaWJ1dGVWYWx1ZTRTdHJpbmcob2JqLCBcIlN1YmplY3RcIik7XHJcbiAgICAgICAgdGhpcy5yZWNlaXZlciA9IEV4dGVuc2lvbk1ldGhvZC5HZXRBdHRyaWJ1dGVWYWx1ZTRTdHJpbmcob2JqLCBcIlJlY2VpdmVyXCIpO1xyXG4gICAgICAgIHRoaXMucmVjZWl2ZXJUZXh0ID0gRXh0ZW5zaW9uTWV0aG9kLkdldEF0dHJpYnV0ZVZhbHVlNFN0cmluZyhvYmosIFwiUmVjZWl2ZXJUZXh0XCIpO1xyXG5cclxuICAgICAgICBjb25zdCByZWNlaXZlckxpc3Q6IEFycmF5PGFueT4gPSBFeHRlbnNpb25NZXRob2QuR2V0QXR0cmlidXRlVmFsdWUob2JqLCBcIlJlY2VpdmVyRXhwcmVzc2lvbnNcIik7XHJcbiAgICAgICAgaWYgKHJlY2VpdmVyTGlzdCAmJiByZWNlaXZlckxpc3QubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICB0aGlzLnJlY2VpdmVyRXhwcmVzc2lvbnMgPSBuZXcgQXJyYXkoKTtcclxuICAgICAgICAgICAgZm9yIChjb25zdCByZWNlaXZlciBvZiByZWNlaXZlckxpc3QpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGNsclR5cGVJRCA9IEV4dGVuc2lvbk1ldGhvZC5HZXRBdHRyaWJ1dGVWYWx1ZTRTdHJpbmcocmVjZWl2ZXIsIFwiQ2xyVHlwZUlEXCIpXHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKGNsclR5cGVJRCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgVXNlclBhcnRpY2lwYW50RXhwcmVzc2lvbi5DbHJfVHlwZV9JRDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdXNlclBhcnRpY2lwYW50RXhwcmVzc2lvbiA9IG5ldyBVc2VyUGFydGljaXBhbnRFeHByZXNzaW9uKHRoaXMuTW9kZWwpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VyUGFydGljaXBhbnRFeHByZXNzaW9uLkxvYWRGcm9tSnNvbk9iamVjdChyZWNlaXZlcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVjZWl2ZXJFeHByZXNzaW9ucy5wdXNoKHVzZXJQYXJ0aWNpcGFudEV4cHJlc3Npb24pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIFBvc2l0aW9uUGFydGljaXBhbnRFeHByZXNzaW9uLkNscl9UeXBlX0lEOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwb3NpdGlvblBhcnRpY2lwYW50RXhwcmVzc2lvbiA9IG5ldyBQb3NpdGlvblBhcnRpY2lwYW50RXhwcmVzc2lvbih0aGlzLk1vZGVsKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb25QYXJ0aWNpcGFudEV4cHJlc3Npb24uTG9hZEZyb21Kc29uT2JqZWN0KHJlY2VpdmVyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZWNlaXZlckV4cHJlc3Npb25zLnB1c2gocG9zaXRpb25QYXJ0aWNpcGFudEV4cHJlc3Npb24pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIFJlcG9ydGluZ0xpbmVQYXJ0aWNpcGFudEV4cHJlc3Npb24uQ2xyX1R5cGVfSUQ6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlcG9ydGluZ0xpbmVQYXJ0aWNpcGFudEV4cHJlc3Npb24gPSBuZXcgUmVwb3J0aW5nTGluZVBhcnRpY2lwYW50RXhwcmVzc2lvbih0aGlzLk1vZGVsKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVwb3J0aW5nTGluZVBhcnRpY2lwYW50RXhwcmVzc2lvbi5Mb2FkRnJvbUpzb25PYmplY3QocmVjZWl2ZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlY2VpdmVyRXhwcmVzc2lvbnMucHVzaChyZXBvcnRpbmdMaW5lUGFydGljaXBhbnRFeHByZXNzaW9uKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBPcmdhbml6YXRpb25QYXJ0aWNpcGFudEV4cHJlc3Npb24uQ2xyX1R5cGVfSUQ6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG9yZ2FuaXphdGlvblBhcnRpY2lwYW50RXhwcmVzc2lvbiA9IG5ldyBPcmdhbml6YXRpb25QYXJ0aWNpcGFudEV4cHJlc3Npb24odGhpcy5Nb2RlbCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9yZ2FuaXphdGlvblBhcnRpY2lwYW50RXhwcmVzc2lvbi5Mb2FkRnJvbUpzb25PYmplY3QocmVjZWl2ZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlY2VpdmVyRXhwcmVzc2lvbnMucHVzaChvcmdhbml6YXRpb25QYXJ0aWNpcGFudEV4cHJlc3Npb24pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIE1hdHJpeFBhcnRpY2lwYW50RXhwcmVzc2lvbi5DbHJfVHlwZV9JRDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbWF0cml4UGFydGljaXBhbnRFeHByZXNzaW9uID0gbmV3IE1hdHJpeFBhcnRpY2lwYW50RXhwcmVzc2lvbih0aGlzLk1vZGVsKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbWF0cml4UGFydGljaXBhbnRFeHByZXNzaW9uLkxvYWRGcm9tSnNvbk9iamVjdChyZWNlaXZlcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVjZWl2ZXJFeHByZXNzaW9ucy5wdXNoKG1hdHJpeFBhcnRpY2lwYW50RXhwcmVzc2lvbik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgQ29tcG9uZW50UGFydGljaXBhbnRFeHByZXNzaW9uLkNscl9UeXBlX0lEOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjb21wb25lbnRQYXJ0aWNpcGFudEV4cHJlc3Npb24gPSBuZXcgQ29tcG9uZW50UGFydGljaXBhbnRFeHByZXNzaW9uKHRoaXMuTW9kZWwpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb21wb25lbnRQYXJ0aWNpcGFudEV4cHJlc3Npb24uTG9hZEZyb21Kc29uT2JqZWN0KHJlY2VpdmVyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZWNlaXZlckV4cHJlc3Npb25zLnB1c2goY29tcG9uZW50UGFydGljaXBhbnRFeHByZXNzaW9uKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBBY3Rpdml0eUV4ZWN1dG9yUGFydGljaXBhbnRFeHByZXNzaW9uLkNscl9UeXBlX0lEOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBhY3Rpdml0eUV4ZWN1dG9yUGFydGljaXBhbnRFeHByZXNzaW9uID0gbmV3IEFjdGl2aXR5RXhlY3V0b3JQYXJ0aWNpcGFudEV4cHJlc3Npb24odGhpcy5Nb2RlbCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2aXR5RXhlY3V0b3JQYXJ0aWNpcGFudEV4cHJlc3Npb24uTG9hZEZyb21Kc29uT2JqZWN0KHJlY2VpdmVyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZWNlaXZlckV4cHJlc3Npb25zLnB1c2goYWN0aXZpdHlFeGVjdXRvclBhcnRpY2lwYW50RXhwcmVzc2lvbik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBzbXNUZW1wbGF0ZUVsZW1lbnQgPSBFeHRlbnNpb25NZXRob2QuR2V0QXR0cmlidXRlVmFsdWUob2JqLCAnU21zTWVzc2FnZVRlbXBsYXRlJyk7XHJcbiAgICAgICAgaWYgKHNtc1RlbXBsYXRlRWxlbWVudCkge1xyXG4gICAgICAgICAgICBjb25zdCBzbXNNZXNzYWdlVGVtcGxhdGUgPSBuZXcgU21zTWVzc2FnZVRlbXBsYXRlKHRoaXMuTW9kZWwpO1xyXG4gICAgICAgICAgICBzbXNNZXNzYWdlVGVtcGxhdGUuTG9hZEZyb21Kc29uT2JqZWN0KHNtc1RlbXBsYXRlRWxlbWVudCk7XHJcbiAgICAgICAgICAgIHRoaXMuc21zTWVzc2FnZVRlbXBsYXRlID0gc21zTWVzc2FnZVRlbXBsYXRlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBOZXdJbnN0YW5jZSgpOiBNZXNzYWdlTm90aWNlIHtcclxuICAgICAgICByZXR1cm4gbmV3IE1lc3NhZ2VOb3RpY2UodGhpcy5Nb2RlbCk7XHJcbiAgICB9XHJcblxyXG4gICAgY2xvbmUoKTogTWVzc2FnZU5vdGljZSB7XHJcbiAgICAgICAgY29uc3QgbWVzc2FnZU5vdGljZSA9IG5ldyBNZXNzYWdlTm90aWNlKHRoaXMuTW9kZWwpO1xyXG4gICAgICAgIG1lc3NhZ2VOb3RpY2UuY29udGVudCA9IHRoaXMuY29udGVudDtcclxuICAgICAgICBtZXNzYWdlTm90aWNlLnNlbmRUaW1lID0gdGhpcy5zZW5kVGltZTtcclxuICAgICAgICBtZXNzYWdlTm90aWNlLnNlbmRUeXBlID0gdGhpcy5zZW5kVHlwZTtcclxuICAgICAgICBtZXNzYWdlTm90aWNlLnN1YmplY3QgPSB0aGlzLnN1YmplY3Q7XHJcbiAgICAgICAgbWVzc2FnZU5vdGljZS5yZWNlaXZlciA9IHRoaXMucmVjZWl2ZXI7XHJcbiAgICAgICAgbWVzc2FnZU5vdGljZS5yZWNlaXZlclRleHQgPSB0aGlzLnJlY2VpdmVyVGV4dDtcclxuICAgICAgICBtZXNzYWdlTm90aWNlLnJlY2VpdmVyRXhwcmVzc2lvbnMgPSBuZXcgQXJyYXkoKTtcclxuICAgICAgICBpZiAodGhpcy5yZWNlaXZlckV4cHJlc3Npb25zICYmIHRoaXMucmVjZWl2ZXJFeHByZXNzaW9ucy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgciBvZiB0aGlzLnJlY2VpdmVyRXhwcmVzc2lvbnMpIHtcclxuICAgICAgICAgICAgICAgIGlmIChyIGluc3RhbmNlb2YgT3JnYW5pemF0aW9uUGFydGljaXBhbnRFeHByZXNzaW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbyA9IHIgYXMgT3JnYW5pemF0aW9uUGFydGljaXBhbnRFeHByZXNzaW9uO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG9yZ2FuaXphdGlvblBhcnRpY2lwYW50RXhwcmVzc2lvbiA9IG8uY2xvbmUoKTtcclxuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlTm90aWNlLnJlY2VpdmVyRXhwcmVzc2lvbnMucHVzaChvcmdhbml6YXRpb25QYXJ0aWNpcGFudEV4cHJlc3Npb24pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSBpZiAociBpbnN0YW5jZW9mIFVzZXJQYXJ0aWNpcGFudEV4cHJlc3Npb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCB1ID0gciBhcyBVc2VyUGFydGljaXBhbnRFeHByZXNzaW9uO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHVzZXJQYXJ0aWNpcGFudEV4cHJlc3Npb24gPSB1LmNsb25lKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZU5vdGljZS5yZWNlaXZlckV4cHJlc3Npb25zLnB1c2godXNlclBhcnRpY2lwYW50RXhwcmVzc2lvbik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmIChyIGluc3RhbmNlb2YgUG9zaXRpb25QYXJ0aWNpcGFudEV4cHJlc3Npb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBwID0gciBhcyBQb3NpdGlvblBhcnRpY2lwYW50RXhwcmVzc2lvbjtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBwb3NpdGlvblBhcnRpY2lwYW50RXhwcmVzc2lvbiA9IHAuY2xvbmUoKTtcclxuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlTm90aWNlLnJlY2VpdmVyRXhwcmVzc2lvbnMucHVzaChwb3NpdGlvblBhcnRpY2lwYW50RXhwcmVzc2lvbik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmIChyIGluc3RhbmNlb2YgUmVwb3J0aW5nTGluZVBhcnRpY2lwYW50RXhwcmVzc2lvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlID0gciBhcyBSZXBvcnRpbmdMaW5lUGFydGljaXBhbnRFeHByZXNzaW9uO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlcG9ydGluZ0xpbmVQYXJ0aWNpcGFudEV4cHJlc3Npb24gPSByZS5jbG9uZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2VOb3RpY2UucmVjZWl2ZXJFeHByZXNzaW9ucy5wdXNoKHJlcG9ydGluZ0xpbmVQYXJ0aWNpcGFudEV4cHJlc3Npb24pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSBpZiAociBpbnN0YW5jZW9mIE1hdHJpeFBhcnRpY2lwYW50RXhwcmVzc2lvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG0gPSByIGFzIE1hdHJpeFBhcnRpY2lwYW50RXhwcmVzc2lvbjtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBtYXRyaXhQYXJ0aWNpcGFudEV4cHJlc3Npb24gPSBtLmNsb25lKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZU5vdGljZS5yZWNlaXZlckV4cHJlc3Npb25zLnB1c2gobWF0cml4UGFydGljaXBhbnRFeHByZXNzaW9uKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHIgaW5zdGFuY2VvZiBDb21wb25lbnRQYXJ0aWNpcGFudEV4cHJlc3Npb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBjID0gciBhcyBDb21wb25lbnRQYXJ0aWNpcGFudEV4cHJlc3Npb247XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY29tcG9uZW50UGFydGljaXBhbnRFeHByZXNzaW9uID0gYy5jbG9uZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2VOb3RpY2UucmVjZWl2ZXJFeHByZXNzaW9ucy5wdXNoKGNvbXBvbmVudFBhcnRpY2lwYW50RXhwcmVzc2lvbik7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHIgaW5zdGFuY2VvZiBBY3Rpdml0eUV4ZWN1dG9yUGFydGljaXBhbnRFeHByZXNzaW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgYSA9IHIgYXMgQWN0aXZpdHlFeGVjdXRvclBhcnRpY2lwYW50RXhwcmVzc2lvbjtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBhY3Rpdml0eUV4ZWN1dG9yUGFydGljaXBhbnRFeHByZXNzaW9uID0gYS5jbG9uZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2VOb3RpY2UucmVjZWl2ZXJFeHByZXNzaW9ucy5wdXNoKGFjdGl2aXR5RXhlY3V0b3JQYXJ0aWNpcGFudEV4cHJlc3Npb24pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLnNtc01lc3NhZ2VUZW1wbGF0ZSkge1xyXG4gICAgICAgICAgICBtZXNzYWdlTm90aWNlLnNtc01lc3NhZ2VUZW1wbGF0ZSA9IHRoaXMuc21zTWVzc2FnZVRlbXBsYXRlLmNsb25lKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBtZXNzYWdlTm90aWNlO1xyXG4gICAgfVxyXG5cclxufVxyXG5CcG1uTW9kZWxIZWxwZXIuUmVnaXN0ZXJFbGVtZW50VHlwZShuZXcgTWVzc2FnZU5vdGljZShuZXcgQnBtbk1vZGVsKCkpKTsiXX0=