/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { BpmnModel, BpmnModelHelper, ServiceTask } from "@edp-pmf/bpmn-model";
import { ExtendProperty } from "./ExtendProperty";
import { Component } from "./extension/tool/Component";
import { Tool } from "./extension/tool/Tool";
import { VariableSetting } from "./VariableSetting";
var AutoActivity = /** @class */ (function (_super) {
    tslib_1.__extends(AutoActivity, _super);
    function AutoActivity(model) {
        var _this = _super.call(this, model) || this;
        _this.ClrTypeID = AutoActivity.Clr_Type_ID;
        return _this;
    }
    /**
     * @return {?}
     */
    AutoActivity.prototype.ResetBeforeLoadFrom = /**
     * @return {?}
     */
    function () {
        _super.prototype.ResetBeforeLoadFrom.call(this);
        this.tools = new Array();
        this.variableSettings = new Array();
        this.extendProperties = new Array();
    };
    /**
     * @return {?}
     */
    AutoActivity.prototype.ConvertToJsonObject = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var obj = _super.prototype.ConvertToJsonObject.call(this);
        return obj;
    };
    /**
     * @param {?} obj
     * @return {?}
     */
    AutoActivity.prototype.LoadFromJsonObject = /**
     * @param {?} obj
     * @return {?}
     */
    function (obj) {
        _super.prototype.LoadFromJsonObject.call(this, obj);
    };
    /**
     * @protected
     * @return {?}
     */
    AutoActivity.prototype.GetExtensionElements4ConvertTo = /**
     * @protected
     * @return {?}
     */
    function () {
        var e_1, _a, e_2, _b, e_3, _c;
        /** @type {?} */
        var list = _super.prototype.GetExtensionElements4ConvertTo.call(this);
        if (this.tools != null) {
            try {
                for (var _d = tslib_1.__values(this.tools), _e = _d.next(); !_e.done; _e = _d.next()) {
                    var item = _e.value;
                    item.MexTag = AutoActivity.MEXTAG;
                    list.push(item);
                }
            }
            catch (e_1_1) { e_1 = { error: e_1_1 }; }
            finally {
                try {
                    if (_e && !_e.done && (_a = _d.return)) _a.call(_d);
                }
                finally { if (e_1) throw e_1.error; }
            }
        }
        if (this.variableSettings != null && this.variableSettings.length > 0) {
            try {
                for (var _f = tslib_1.__values(this.variableSettings), _g = _f.next(); !_g.done; _g = _f.next()) {
                    var item = _g.value;
                    item.MexTag = AutoActivity.MEXTAG;
                    list.push(item);
                }
            }
            catch (e_2_1) { e_2 = { error: e_2_1 }; }
            finally {
                try {
                    if (_g && !_g.done && (_b = _f.return)) _b.call(_f);
                }
                finally { if (e_2) throw e_2.error; }
            }
        }
        if (this.extendProperties != null && this.extendProperties.length > 0) {
            try {
                for (var _h = tslib_1.__values(this.extendProperties), _j = _h.next(); !_j.done; _j = _h.next()) {
                    var item = _j.value;
                    item.MexTag = AutoActivity.MEXTAG;
                    list.push(item);
                }
            }
            catch (e_3_1) { e_3 = { error: e_3_1 }; }
            finally {
                try {
                    if (_j && !_j.done && (_c = _h.return)) _c.call(_h);
                }
                finally { if (e_3) throw e_3.error; }
            }
        }
        return list;
    };
    /**
     * @protected
     * @param {?} extensionElements
     * @return {?}
     */
    AutoActivity.prototype.SetExtensionElements4LoadFrom = /**
     * @protected
     * @param {?} extensionElements
     * @return {?}
     */
    function (extensionElements) {
        var e_4, _a;
        _super.prototype.SetExtensionElements4LoadFrom.call(this, extensionElements);
        try {
            for (var extensionElements_1 = tslib_1.__values(extensionElements), extensionElements_1_1 = extensionElements_1.next(); !extensionElements_1_1.done; extensionElements_1_1 = extensionElements_1.next()) {
                var extensionElement = extensionElements_1_1.value;
                if (extensionElement.MexTag !== AutoActivity.MEXTAG)
                    continue;
                switch (extensionElement.ClrTypeID) {
                    case VariableSetting.Clr_Type_ID:
                        this.variableSettings.push((/** @type {?} */ (extensionElement)));
                        break;
                    case ExtendProperty.Clr_Type_ID:
                        this.extendProperties.push((/** @type {?} */ (extensionElement)));
                        break;
                    default:
                        if (extensionElement instanceof Tool) {
                            this.tools.push((/** @type {?} */ (extensionElement)));
                        }
                        break;
                }
            }
        }
        catch (e_4_1) { e_4 = { error: e_4_1 }; }
        finally {
            try {
                if (extensionElements_1_1 && !extensionElements_1_1.done && (_a = extensionElements_1.return)) _a.call(extensionElements_1);
            }
            finally { if (e_4) throw e_4.error; }
        }
    };
    /**
     * @return {?}
     */
    AutoActivity.prototype.NewInstance = /**
     * @return {?}
     */
    function () {
        return new AutoActivity(this.Model);
    };
    /**
     * @return {?}
     */
    AutoActivity.prototype.clone = /**
     * @return {?}
     */
    function () {
        var e_5, _a, e_6, _b, e_7, _c;
        /** @type {?} */
        var autoActivity = new AutoActivity(this.Model);
        autoActivity.Name = this.Name;
        autoActivity.tools = new Array();
        if (this.tools && this.tools.length > 0) {
            try {
                for (var _d = tslib_1.__values(this.tools), _e = _d.next(); !_e.done; _e = _d.next()) {
                    var t = _e.value;
                    if (t instanceof Component) {
                        /** @type {?} */
                        var c = (/** @type {?} */ (t));
                        /** @type {?} */
                        var tool = c.clone();
                        autoActivity.tools.push(tool);
                    }
                }
            }
            catch (e_5_1) { e_5 = { error: e_5_1 }; }
            finally {
                try {
                    if (_e && !_e.done && (_a = _d.return)) _a.call(_d);
                }
                finally { if (e_5) throw e_5.error; }
            }
        }
        autoActivity.variableSettings = new Array();
        if (this.variableSettings && this.variableSettings.length > 0) {
            try {
                for (var _f = tslib_1.__values(this.variableSettings), _g = _f.next(); !_g.done; _g = _f.next()) {
                    var v = _g.value;
                    /** @type {?} */
                    var variableSetting = v.clone();
                    autoActivity.variableSettings.push(variableSetting);
                }
            }
            catch (e_6_1) { e_6 = { error: e_6_1 }; }
            finally {
                try {
                    if (_g && !_g.done && (_b = _f.return)) _b.call(_f);
                }
                finally { if (e_6) throw e_6.error; }
            }
        }
        autoActivity.extendProperties = new Array();
        if (this.extendProperties && this.extendProperties.length > 0) {
            try {
                for (var _h = tslib_1.__values(this.extendProperties), _j = _h.next(); !_j.done; _j = _h.next()) {
                    var e = _j.value;
                    /** @type {?} */
                    var extendProperty = e.clone();
                    autoActivity.extendProperties.push(extendProperty);
                }
            }
            catch (e_7_1) { e_7 = { error: e_7_1 }; }
            finally {
                try {
                    if (_j && !_j.done && (_c = _h.return)) _c.call(_h);
                }
                finally { if (e_7) throw e_7.error; }
            }
        }
        return autoActivity;
    };
    AutoActivity.Clr_Type_ID = "wf.AutoActivity";
    AutoActivity.MEXTAG = 'wf.AutoActivity';
    return AutoActivity;
}(ServiceTask));
export { AutoActivity };
if (false) {
    /** @type {?} */
    AutoActivity.Clr_Type_ID;
    /**
     * @type {?}
     * @private
     */
    AutoActivity.MEXTAG;
    /** @type {?} */
    AutoActivity.prototype.ClrTypeID;
    /** @type {?} */
    AutoActivity.prototype.tools;
    /** @type {?} */
    AutoActivity.prototype.variableSettings;
    /** @type {?} */
    AutoActivity.prototype.extendProperties;
}
BpmnModelHelper.RegisterElementType(new AutoActivity(new BpmnModel()));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQXV0b0FjdGl2aXR5LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGdzcC13Zi93Zi1wcm9jZXNzLW1vZGVsLyIsInNvdXJjZXMiOlsibGliL21vZGVsL0F1dG9BY3Rpdml0eS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQUUsZUFBZSxFQUFFLFdBQVcsRUFBb0IsTUFBTSxxQkFBcUIsQ0FBQztBQUNoRyxPQUFPLEVBQUUsY0FBYyxFQUFFLE1BQU0sa0JBQWtCLENBQUM7QUFDbEQsT0FBTyxFQUFFLFNBQVMsRUFBRSxNQUFNLDRCQUE0QixDQUFDO0FBQ3ZELE9BQU8sRUFBRSxJQUFJLEVBQUUsTUFBTSx1QkFBdUIsQ0FBQztBQUM3QyxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0sbUJBQW1CLENBQUM7QUFFcEQ7SUFBa0Msd0NBQVc7SUFTekMsc0JBQVksS0FBZ0I7UUFBNUIsWUFDSSxrQkFBTSxLQUFLLENBQUMsU0FDZjtRQVRELGVBQVMsR0FBVyxZQUFZLENBQUMsV0FBVyxDQUFDOztJQVM3QyxDQUFDOzs7O0lBRUQsMENBQW1COzs7SUFBbkI7UUFDSSxpQkFBTSxtQkFBbUIsV0FBRSxDQUFDO1FBRTVCLElBQUksQ0FBQyxLQUFLLEdBQUcsSUFBSSxLQUFLLEVBQVEsQ0FBQztRQUMvQixJQUFJLENBQUMsZ0JBQWdCLEdBQUcsSUFBSSxLQUFLLEVBQUUsQ0FBQztRQUNwQyxJQUFJLENBQUMsZ0JBQWdCLEdBQUcsSUFBSSxLQUFLLEVBQWtCLENBQUM7SUFDeEQsQ0FBQzs7OztJQUVELDBDQUFtQjs7O0lBQW5COztZQUNRLEdBQUcsR0FBRyxpQkFBTSxtQkFBbUIsV0FBRTtRQUVyQyxPQUFPLEdBQUcsQ0FBQztJQUNmLENBQUM7Ozs7O0lBRUQseUNBQWtCOzs7O0lBQWxCLFVBQW1CLEdBQVE7UUFDdkIsaUJBQU0sa0JBQWtCLFlBQUMsR0FBRyxDQUFDLENBQUM7SUFFbEMsQ0FBQzs7Ozs7SUFFUyxxREFBOEI7Ozs7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SjtRQUNELE9BQU8sWUFBWSxDQUFDO0lBQ3hCLENBQUM7SUEzR00sd0JBQVcsR0FBVyxpQkFBaUIsQ0FBQztJQUVoQyxtQkFBTSxHQUFXLGlCQUFpQixDQUFDO0lBMEd0RCxtQkFBQztDQUFBLEFBN0dELENBQWtDLFdBQVcsR0E2RzVDO1NBN0dZLFlBQVk7OztJQUNyQix5QkFBK0M7Ozs7O0lBRS9DLG9CQUFrRDs7SUFEbEQsaUNBQTZDOztJQUc3Qyw2QkFBbUI7O0lBQ25CLHdDQUF5Qzs7SUFDekMsd0NBQXdDOztBQXVHNUMsZUFBZSxDQUFDLG1CQUFtQixDQUFDLElBQUksWUFBWSxDQUFDLElBQUksU0FBUyxFQUFFLENBQUMsQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQnBtbk1vZGVsLCBCcG1uTW9kZWxIZWxwZXIsIFNlcnZpY2VUYXNrLCBFeHRlbnNpb25FbGVtZW50IH0gZnJvbSBcIkBlZHAtcG1mL2JwbW4tbW9kZWxcIjtcclxuaW1wb3J0IHsgRXh0ZW5kUHJvcGVydHkgfSBmcm9tIFwiLi9FeHRlbmRQcm9wZXJ0eVwiO1xyXG5pbXBvcnQgeyBDb21wb25lbnQgfSBmcm9tIFwiLi9leHRlbnNpb24vdG9vbC9Db21wb25lbnRcIjtcclxuaW1wb3J0IHsgVG9vbCB9IGZyb20gXCIuL2V4dGVuc2lvbi90b29sL1Rvb2xcIjtcclxuaW1wb3J0IHsgVmFyaWFibGVTZXR0aW5nIH0gZnJvbSBcIi4vVmFyaWFibGVTZXR0aW5nXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgQXV0b0FjdGl2aXR5IGV4dGVuZHMgU2VydmljZVRhc2sge1xyXG4gICAgc3RhdGljIENscl9UeXBlX0lEOiBzdHJpbmcgPSBcIndmLkF1dG9BY3Rpdml0eVwiO1xyXG4gICAgQ2xyVHlwZUlEOiBzdHJpbmcgPSBBdXRvQWN0aXZpdHkuQ2xyX1R5cGVfSUQ7XHJcbiAgICBwcml2YXRlIHN0YXRpYyBNRVhUQUc6IHN0cmluZyA9ICd3Zi5BdXRvQWN0aXZpdHknO1xyXG5cclxuICAgIHRvb2xzOiBBcnJheTxUb29sPjtcclxuICAgIHZhcmlhYmxlU2V0dGluZ3M6IEFycmF5PFZhcmlhYmxlU2V0dGluZz47XHJcbiAgICBleHRlbmRQcm9wZXJ0aWVzOiBBcnJheTxFeHRlbmRQcm9wZXJ0eT47XHJcblxyXG4gICAgY29uc3RydWN0b3IobW9kZWw6IEJwbW5Nb2RlbCkge1xyXG4gICAgICAgIHN1cGVyKG1vZGVsKTtcclxuICAgIH1cclxuXHJcbiAgICBSZXNldEJlZm9yZUxvYWRGcm9tKCkge1xyXG4gICAgICAgIHN1cGVyLlJlc2V0QmVmb3JlTG9hZEZyb20oKTtcclxuXHJcbiAgICAgICAgdGhpcy50b29scyA9IG5ldyBBcnJheTxUb29sPigpO1xyXG4gICAgICAgIHRoaXMudmFyaWFibGVTZXR0aW5ncyA9IG5ldyBBcnJheSgpO1xyXG4gICAgICAgIHRoaXMuZXh0ZW5kUHJvcGVydGllcyA9IG5ldyBBcnJheTxFeHRlbmRQcm9wZXJ0eT4oKTtcclxuICAgIH1cclxuXHJcbiAgICBDb252ZXJ0VG9Kc29uT2JqZWN0KCk6IGFueSB7XHJcbiAgICAgICAgbGV0IG9iaiA9IHN1cGVyLkNvbnZlcnRUb0pzb25PYmplY3QoKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIG9iajtcclxuICAgIH1cclxuXHJcbiAgICBMb2FkRnJvbUpzb25PYmplY3Qob2JqOiBhbnkpIHtcclxuICAgICAgICBzdXBlci5Mb2FkRnJvbUpzb25PYmplY3Qob2JqKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgcHJvdGVjdGVkIEdldEV4dGVuc2lvbkVsZW1lbnRzNENvbnZlcnRUbygpOiBFeHRlbnNpb25FbGVtZW50W10ge1xyXG4gICAgICAgIGxldCBsaXN0ID0gc3VwZXIuR2V0RXh0ZW5zaW9uRWxlbWVudHM0Q29udmVydFRvKCk7XHJcblxyXG4gICAgICAgIGlmICh0aGlzLnRvb2xzICE9IG51bGwpIHtcclxuICAgICAgICAgICAgZm9yIChjb25zdCBpdGVtIG9mIHRoaXMudG9vbHMpIHtcclxuICAgICAgICAgICAgICAgIGl0ZW0uTWV4VGFnID0gQXV0b0FjdGl2aXR5Lk1FWFRBRztcclxuICAgICAgICAgICAgICAgIGxpc3QucHVzaChpdGVtKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy52YXJpYWJsZVNldHRpbmdzICE9IG51bGwgJiYgdGhpcy52YXJpYWJsZVNldHRpbmdzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgZm9yIChjb25zdCBpdGVtIG9mIHRoaXMudmFyaWFibGVTZXR0aW5ncykge1xyXG4gICAgICAgICAgICAgICAgaXRlbS5NZXhUYWcgPSBBdXRvQWN0aXZpdHkuTUVYVEFHO1xyXG4gICAgICAgICAgICAgICAgbGlzdC5wdXNoKGl0ZW0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLmV4dGVuZFByb3BlcnRpZXMgIT0gbnVsbCAmJiB0aGlzLmV4dGVuZFByb3BlcnRpZXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgdGhpcy5leHRlbmRQcm9wZXJ0aWVzKSB7XHJcbiAgICAgICAgICAgICAgICBpdGVtLk1leFRhZyA9IEF1dG9BY3Rpdml0eS5NRVhUQUc7XHJcbiAgICAgICAgICAgICAgICBsaXN0LnB1c2goaXRlbSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGxpc3Q7XHJcbiAgICB9XHJcbiAgICBwcm90ZWN0ZWQgU2V0RXh0ZW5zaW9uRWxlbWVudHM0TG9hZEZyb20oZXh0ZW5zaW9uRWxlbWVudHM6IEV4dGVuc2lvbkVsZW1lbnRbXSkge1xyXG4gICAgICAgIHN1cGVyLlNldEV4dGVuc2lvbkVsZW1lbnRzNExvYWRGcm9tKGV4dGVuc2lvbkVsZW1lbnRzKTtcclxuXHJcbiAgICAgICAgZm9yIChsZXQgZXh0ZW5zaW9uRWxlbWVudCBvZiBleHRlbnNpb25FbGVtZW50cykge1xyXG4gICAgICAgICAgICBpZiAoZXh0ZW5zaW9uRWxlbWVudC5NZXhUYWcgIT09IEF1dG9BY3Rpdml0eS5NRVhUQUcpXHJcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgc3dpdGNoIChleHRlbnNpb25FbGVtZW50LkNsclR5cGVJRCkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSBWYXJpYWJsZVNldHRpbmcuQ2xyX1R5cGVfSUQ6XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy52YXJpYWJsZVNldHRpbmdzLnB1c2goZXh0ZW5zaW9uRWxlbWVudCBhcyBWYXJpYWJsZVNldHRpbmcpO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSBFeHRlbmRQcm9wZXJ0eS5DbHJfVHlwZV9JRDpcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmV4dGVuZFByb3BlcnRpZXMucHVzaChleHRlbnNpb25FbGVtZW50IGFzIEV4dGVuZFByb3BlcnR5KTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGV4dGVuc2lvbkVsZW1lbnQgaW5zdGFuY2VvZiBUb29sKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudG9vbHMucHVzaChleHRlbnNpb25FbGVtZW50IGFzIFRvb2wpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIE5ld0luc3RhbmNlKCk6IEF1dG9BY3Rpdml0eSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBBdXRvQWN0aXZpdHkodGhpcy5Nb2RlbCk7XHJcbiAgICB9XHJcbiAgICBjbG9uZSgpOiBBdXRvQWN0aXZpdHkge1xyXG4gICAgICAgIGNvbnN0IGF1dG9BY3Rpdml0eSA9IG5ldyBBdXRvQWN0aXZpdHkodGhpcy5Nb2RlbCk7XHJcbiAgICAgICAgYXV0b0FjdGl2aXR5Lk5hbWUgPSB0aGlzLk5hbWU7XHJcblxyXG4gICAgICAgIGF1dG9BY3Rpdml0eS50b29scyA9IG5ldyBBcnJheSgpO1xyXG4gICAgICAgIGlmICh0aGlzLnRvb2xzICYmIHRoaXMudG9vbHMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IHQgb2YgdGhpcy50b29scykge1xyXG4gICAgICAgICAgICAgICAgaWYgKHQgaW5zdGFuY2VvZiBDb21wb25lbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBjID0gdCBhcyBDb21wb25lbnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdG9vbCA9IGMuY2xvbmUoKTtcclxuICAgICAgICAgICAgICAgICAgICBhdXRvQWN0aXZpdHkudG9vbHMucHVzaCh0b29sKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBhdXRvQWN0aXZpdHkudmFyaWFibGVTZXR0aW5ncyA9IG5ldyBBcnJheSgpO1xyXG4gICAgICAgIGlmICh0aGlzLnZhcmlhYmxlU2V0dGluZ3MgJiYgdGhpcy52YXJpYWJsZVNldHRpbmdzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgZm9yIChjb25zdCB2IG9mIHRoaXMudmFyaWFibGVTZXR0aW5ncykge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdmFyaWFibGVTZXR0aW5nID0gdi5jbG9uZSgpO1xyXG4gICAgICAgICAgICAgICAgYXV0b0FjdGl2aXR5LnZhcmlhYmxlU2V0dGluZ3MucHVzaCh2YXJpYWJsZVNldHRpbmcpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGF1dG9BY3Rpdml0eS5leHRlbmRQcm9wZXJ0aWVzID0gbmV3IEFycmF5PEV4dGVuZFByb3BlcnR5PigpO1xyXG4gICAgICAgIGlmICh0aGlzLmV4dGVuZFByb3BlcnRpZXMgJiYgdGhpcy5leHRlbmRQcm9wZXJ0aWVzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgZm9yIChjb25zdCBlIG9mIHRoaXMuZXh0ZW5kUHJvcGVydGllcykge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZXh0ZW5kUHJvcGVydHkgPSBlLmNsb25lKCk7XHJcbiAgICAgICAgICAgICAgICBhdXRvQWN0aXZpdHkuZXh0ZW5kUHJvcGVydGllcy5wdXNoKGV4dGVuZFByb3BlcnR5KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gYXV0b0FjdGl2aXR5O1xyXG4gICAgfVxyXG59XHJcbkJwbW5Nb2RlbEhlbHBlci5SZWdpc3RlckVsZW1lbnRUeXBlKG5ldyBBdXRvQWN0aXZpdHkobmV3IEJwbW5Nb2RlbCgpKSk7XHJcbiJdfQ==