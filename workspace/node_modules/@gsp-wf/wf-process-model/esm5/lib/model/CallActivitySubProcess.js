/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { BpmnModel, BpmnModelHelper, BpmnModelJsonHelper, CallActivity, SubProcessDataAssociations, MultiInstanceLoopCharacteristics } from "@edp-pmf/bpmn-model";
import { BackWardRule } from "./extension/completion-strategy/BackWardRule";
import { VariableSetting } from "./VariableSetting";
var CallActivitySubProcess = /** @class */ (function (_super) {
    tslib_1.__extends(CallActivitySubProcess, _super);
    function CallActivitySubProcess(model) {
        var _this = _super.call(this, model) || this;
        _this.ClrTypeID = CallActivitySubProcess.Clr_Type_ID;
        _this.aifProcessCode = null;
        _this.useAutoCreationData = false;
        _this.SubProcessDataAssociations = new SubProcessDataAssociations(model);
        _this.inheritVariables = true;
        _this.inheritBizDataId = true;
        _this.backWardRule = new BackWardRule(model);
        _this.LoopCharacteristics = new MultiInstanceLoopCharacteristics(model);
        _this.aifProcessCode = null;
        _this.useAutoCreationData = false;
        return _this;
    }
    /**
     * @return {?}
     */
    CallActivitySubProcess.prototype.ResetBeforeLoadFrom = /**
     * @return {?}
     */
    function () {
        _super.prototype.ResetBeforeLoadFrom.call(this);
        this.SubProcessDataAssociations = new SubProcessDataAssociations(this.Model);
        this.inheritVariables = true;
        this.inheritBizDataId = true;
        this.variableSettings = new Array();
        this.aifProcessCode = null;
        this.useAutoCreationData = false;
    };
    /**
     * @return {?}
     */
    CallActivitySubProcess.prototype.ConvertToJsonObject = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var obj = _super.prototype.ConvertToJsonObject.call(this);
        BpmnModelHelper.SetAttributeValue(obj, 'CalledBizDefKey', this.calledBizDefKey);
        BpmnModelHelper.SetAttributeValue(obj, 'BizDataId', this.bizDataId);
        BpmnModelHelper.SetAttributeValue(obj, 'InheritVariables', this.inheritVariables);
        BpmnModelHelper.SetAttributeValue(obj, 'InheritBizDataId', this.inheritBizDataId);
        BpmnModelHelper.SetAttributeValue(obj, 'aifProcessCode', this.aifProcessCode);
        BpmnModelHelper.SetAttributeValue(obj, 'useAutoCreationData', this.useAutoCreationData);
        return obj;
    };
    /**
     * @param {?} obj
     * @return {?}
     */
    CallActivitySubProcess.prototype.LoadFromJsonObject = /**
     * @param {?} obj
     * @return {?}
     */
    function (obj) {
        _super.prototype.LoadFromJsonObject.call(this, obj);
        this.calledBizDefKey = obj.CalledBizDefKey;
        this.bizDataId = obj.BizDataId;
        this.inheritVariables = obj.InheritVariables;
        this.inheritBizDataId = obj.InheritBizDataId;
        this.aifProcessCode = BpmnModelJsonHelper.GetAttributeValueAsString(obj, "aifProcessCode");
        this.useAutoCreationData = BpmnModelJsonHelper.GetAttributeValueAsBoolean(obj, "useAutoCreationData");
    };
    /**
     * @protected
     * @return {?}
     */
    CallActivitySubProcess.prototype.GetExtensionElements4ConvertTo = /**
     * @protected
     * @return {?}
     */
    function () {
        var e_1, _a;
        /** @type {?} */
        var list = _super.prototype.GetExtensionElements4ConvertTo.call(this);
        if (this.backWardRule != null) {
            this.backWardRule.MexTag = CallActivitySubProcess.MEXTAG;
            list.push(this.backWardRule);
        }
        if (this.variableSettings != null && this.variableSettings.length > 0) {
            try {
                for (var _b = tslib_1.__values(this.variableSettings), _c = _b.next(); !_c.done; _c = _b.next()) {
                    var item = _c.value;
                    item.MexTag = CallActivitySubProcess.MEXTAG;
                    list.push(item);
                }
            }
            catch (e_1_1) { e_1 = { error: e_1_1 }; }
            finally {
                try {
                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                }
                finally { if (e_1) throw e_1.error; }
            }
        }
        return list;
    };
    /**
     * @protected
     * @param {?} extensionElements
     * @return {?}
     */
    CallActivitySubProcess.prototype.SetExtensionElements4LoadFrom = /**
     * @protected
     * @param {?} extensionElements
     * @return {?}
     */
    function (extensionElements) {
        var e_2, _a;
        _super.prototype.SetExtensionElements4LoadFrom.call(this, extensionElements);
        try {
            for (var extensionElements_1 = tslib_1.__values(extensionElements), extensionElements_1_1 = extensionElements_1.next(); !extensionElements_1_1.done; extensionElements_1_1 = extensionElements_1.next()) {
                var extensionElement = extensionElements_1_1.value;
                if (extensionElement.MexTag !== CallActivitySubProcess.MEXTAG)
                    continue;
                switch (extensionElement.ClrTypeID) {
                    case VariableSetting.Clr_Type_ID:
                        this.variableSettings.push((/** @type {?} */ (extensionElement)));
                        ;
                        break;
                    case BackWardRule.Clr_Type_ID:
                        this.backWardRule = ((/** @type {?} */ (extensionElement)));
                        break;
                    default:
                        break;
                }
            }
        }
        catch (e_2_1) { e_2 = { error: e_2_1 }; }
        finally {
            try {
                if (extensionElements_1_1 && !extensionElements_1_1.done && (_a = extensionElements_1.return)) _a.call(extensionElements_1);
            }
            finally { if (e_2) throw e_2.error; }
        }
    };
    /**
     * @return {?}
     */
    CallActivitySubProcess.prototype.NewInstance = /**
     * @return {?}
     */
    function () {
        return new CallActivitySubProcess(this.Model);
    };
    /**
     * @return {?}
     */
    CallActivitySubProcess.prototype.clone = /**
     * @return {?}
     */
    function () {
        var e_3, _a;
        /** @type {?} */
        var callActivitySubProcess = new CallActivitySubProcess(this.Model);
        callActivitySubProcess.Name = this.Name;
        callActivitySubProcess.IsForCompensation = this.IsForCompensation;
        callActivitySubProcess.CalledElement = this.CalledElement;
        callActivitySubProcess.calledBizDefKey = this.calledBizDefKey;
        callActivitySubProcess.bizDataId = this.bizDataId;
        callActivitySubProcess.inheritBizDataId = this.inheritBizDataId;
        callActivitySubProcess.inheritVariables = this.inheritVariables;
        callActivitySubProcess.variableSettings = new Array();
        if (this.variableSettings && this.variableSettings.length > 0) {
            try {
                for (var _b = tslib_1.__values(this.variableSettings), _c = _b.next(); !_c.done; _c = _b.next()) {
                    var v = _c.value;
                    /** @type {?} */
                    var variableSetting = v.clone();
                    callActivitySubProcess.variableSettings.push(variableSetting);
                }
            }
            catch (e_3_1) { e_3 = { error: e_3_1 }; }
            finally {
                try {
                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                }
                finally { if (e_3) throw e_3.error; }
            }
        }
        if (this.backWardRule) {
            callActivitySubProcess.backWardRule = this.backWardRule.clone();
        }
        if (this.LoopCharacteristics) {
            callActivitySubProcess.LoopCharacteristics = this.LoopCharacteristics.clone();
        }
        callActivitySubProcess.aifProcessCode = null;
        if (this.aifProcessCode) {
            callActivitySubProcess.aifProcessCode = this.aifProcessCode;
        }
        callActivitySubProcess.useAutoCreationData = this.useAutoCreationData;
        return callActivitySubProcess;
    };
    CallActivitySubProcess.Clr_Type_ID = "wf.CallActivitySubProcess";
    CallActivitySubProcess.MEXTAG = "wf.CallActivitySubProcess";
    return CallActivitySubProcess;
}(CallActivity));
export { CallActivitySubProcess };
if (false) {
    /** @type {?} */
    CallActivitySubProcess.Clr_Type_ID;
    /**
     * @type {?}
     * @private
     */
    CallActivitySubProcess.MEXTAG;
    /** @type {?} */
    CallActivitySubProcess.prototype.ClrTypeID;
    /** @type {?} */
    CallActivitySubProcess.prototype.calledBizDefKey;
    /** @type {?} */
    CallActivitySubProcess.prototype.bizDataId;
    /** @type {?} */
    CallActivitySubProcess.prototype.inheritVariables;
    /** @type {?} */
    CallActivitySubProcess.prototype.inheritBizDataId;
    /** @type {?} */
    CallActivitySubProcess.prototype.backWardRule;
    /** @type {?} */
    CallActivitySubProcess.prototype.variableSettings;
    /** @type {?} */
    CallActivitySubProcess.prototype.aifProcessCode;
    /** @type {?} */
    CallActivitySubProcess.prototype.useAutoCreationData;
}
BpmnModelHelper.RegisterElementType(new CallActivitySubProcess(new BpmnModel()));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQ2FsbEFjdGl2aXR5U3ViUHJvY2Vzcy5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0Bnc3Atd2Yvd2YtcHJvY2Vzcy1tb2RlbC8iLCJzb3VyY2VzIjpbImxpYi9tb2RlbC9DYWxsQWN0aXZpdHlTdWJQcm9jZXNzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsT0FBTyxFQUFFLFNBQVMsRUFBRSxlQUFlLEVBQUUsbUJBQW1CLEVBQW9CLFlBQVksRUFBRSwwQkFBMEIsRUFBRSxnQ0FBZ0MsRUFBRSxNQUFNLHFCQUFxQixDQUFDO0FBQ3BMLE9BQU8sRUFBRSxZQUFZLEVBQUUsTUFBTSw4Q0FBOEMsQ0FBQztBQUM1RSxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0sbUJBQW1CLENBQUM7QUFFcEQ7SUFBNEMsa0RBQVk7SUFnQnBELGdDQUFZLEtBQWdCO1FBQTVCLFlBQ0ksa0JBQU0sS0FBSyxDQUFDLFNBUWY7UUF2QkQsZUFBUyxHQUFXLHNCQUFzQixDQUFDLFdBQVcsQ0FBQztRQVd2RCxvQkFBYyxHQUFXLElBQUksQ0FBQztRQUM5Qix5QkFBbUIsR0FBWSxLQUFLLENBQUM7UUFJakMsS0FBSSxDQUFDLDBCQUEwQixHQUFHLElBQUksMEJBQTBCLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDeEUsS0FBSSxDQUFDLGdCQUFnQixHQUFHLElBQUksQ0FBQztRQUM3QixLQUFJLENBQUMsZ0JBQWdCLEdBQUcsSUFBSSxDQUFDO1FBQzdCLEtBQUksQ0FBQyxZQUFZLEdBQUcsSUFBSSxZQUFZLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDNUMsS0FBSSxDQUFDLG1CQUFtQixHQUFHLElBQUksZ0NBQWdDLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDdkUsS0FBSSxDQUFDLGNBQWMsR0FBRyxJQUFJLENBQUM7UUFDM0IsS0FBSSxDQUFDLG1CQUFtQixHQUFHLEtBQUssQ0FBQzs7SUFDckMsQ0FBQzs7OztJQUVELG9EQUFtQjs7O0lBQW5CO1FBQ0ksaUJBQU0sbUJBQW1CLFdB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MkJBQTJCLENBQUM7SUFtSWhFLDZCQUFDO0NBQUEsQUF0SUQsQ0FBNEMsWUFBWSxHQXNJdkQ7U0F0SVksc0JBQXNCOzs7SUFDL0IsbUNBQXlEOzs7OztJQUV6RCw4QkFBNEQ7O0lBRDVELDJDQUF1RDs7SUFHdkQsaURBQXdCOztJQUN4QiwyQ0FBa0I7O0lBQ2xCLGtEQUEwQjs7SUFDMUIsa0RBQTBCOztJQUUxQiw4Q0FBMkI7O0lBRTNCLGtEQUF5Qzs7SUFDekMsZ0RBQThCOztJQUM5QixxREFBcUM7O0FBeUh6QyxlQUFlLENBQUMsbUJBQW1CLENBQUMsSUFBSSxzQkFBc0IsQ0FBQyxJQUFJLFNBQVMsRUFBRSxDQUFDLENBQUMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEJwbW5Nb2RlbCwgQnBtbk1vZGVsSGVscGVyLCBCcG1uTW9kZWxKc29uSGVscGVyLCBFeHRlbnNpb25FbGVtZW50LCBDYWxsQWN0aXZpdHksIFN1YlByb2Nlc3NEYXRhQXNzb2NpYXRpb25zLCBNdWx0aUluc3RhbmNlTG9vcENoYXJhY3RlcmlzdGljcyB9IGZyb20gXCJAZWRwLXBtZi9icG1uLW1vZGVsXCI7XHJcbmltcG9ydCB7IEJhY2tXYXJkUnVsZSB9IGZyb20gXCIuL2V4dGVuc2lvbi9jb21wbGV0aW9uLXN0cmF0ZWd5L0JhY2tXYXJkUnVsZVwiO1xyXG5pbXBvcnQgeyBWYXJpYWJsZVNldHRpbmcgfSBmcm9tIFwiLi9WYXJpYWJsZVNldHRpbmdcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBDYWxsQWN0aXZpdHlTdWJQcm9jZXNzIGV4dGVuZHMgQ2FsbEFjdGl2aXR5IHtcclxuICAgIHN0YXRpYyBDbHJfVHlwZV9JRDogc3RyaW5nID0gXCJ3Zi5DYWxsQWN0aXZpdHlTdWJQcm9jZXNzXCI7XHJcbiAgICBDbHJUeXBlSUQ6IHN0cmluZyA9IENhbGxBY3Rpdml0eVN1YlByb2Nlc3MuQ2xyX1R5cGVfSUQ7XHJcbiAgICBwcml2YXRlIHN0YXRpYyBNRVhUQUc6IHN0cmluZyA9IFwid2YuQ2FsbEFjdGl2aXR5U3ViUHJvY2Vzc1wiO1xyXG5cclxuICAgIGNhbGxlZEJpekRlZktleTogc3RyaW5nO1xyXG4gICAgYml6RGF0YUlkOiBzdHJpbmc7XHJcbiAgICBpbmhlcml0VmFyaWFibGVzOiBib29sZWFuO1xyXG4gICAgaW5oZXJpdEJpekRhdGFJZDogYm9vbGVhbjtcclxuXHJcbiAgICBiYWNrV2FyZFJ1bGU6IEJhY2tXYXJkUnVsZTtcclxuXHJcbiAgICB2YXJpYWJsZVNldHRpbmdzOiBBcnJheTxWYXJpYWJsZVNldHRpbmc+O1xyXG4gICAgYWlmUHJvY2Vzc0NvZGU6IHN0cmluZyA9IG51bGw7XHJcbiAgICB1c2VBdXRvQ3JlYXRpb25EYXRhOiBib29sZWFuID0gZmFsc2U7XHJcblxyXG4gICAgY29uc3RydWN0b3IobW9kZWw6IEJwbW5Nb2RlbCkge1xyXG4gICAgICAgIHN1cGVyKG1vZGVsKTtcclxuICAgICAgICB0aGlzLlN1YlByb2Nlc3NEYXRhQXNzb2NpYXRpb25zID0gbmV3IFN1YlByb2Nlc3NEYXRhQXNzb2NpYXRpb25zKG1vZGVsKTtcclxuICAgICAgICB0aGlzLmluaGVyaXRWYXJpYWJsZXMgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuaW5oZXJpdEJpekRhdGFJZCA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5iYWNrV2FyZFJ1bGUgPSBuZXcgQmFja1dhcmRSdWxlKG1vZGVsKTtcclxuICAgICAgICB0aGlzLkxvb3BDaGFyYWN0ZXJpc3RpY3MgPSBuZXcgTXVsdGlJbnN0YW5jZUxvb3BDaGFyYWN0ZXJpc3RpY3MobW9kZWwpO1xyXG4gICAgICAgIHRoaXMuYWlmUHJvY2Vzc0NvZGUgPSBudWxsO1xyXG4gICAgICAgIHRoaXMudXNlQXV0b0NyZWF0aW9uRGF0YSA9IGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIFJlc2V0QmVmb3JlTG9hZEZyb20oKSB7XHJcbiAgICAgICAgc3VwZXIuUmVzZXRCZWZvcmVMb2FkRnJvbSgpO1xyXG5cclxuICAgICAgICB0aGlzLlN1YlByb2Nlc3NEYXRhQXNzb2NpYXRpb25zID0gbmV3IFN1YlByb2Nlc3NEYXRhQXNzb2NpYXRpb25zKHRoaXMuTW9kZWwpO1xyXG4gICAgICAgIHRoaXMuaW5oZXJpdFZhcmlhYmxlcyA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5pbmhlcml0Qml6RGF0YUlkID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLnZhcmlhYmxlU2V0dGluZ3MgPSBuZXcgQXJyYXkoKTtcclxuICAgICAgICB0aGlzLmFpZlByb2Nlc3NDb2RlID0gbnVsbDtcclxuICAgICAgICB0aGlzLnVzZUF1dG9DcmVhdGlvbkRhdGEgPSBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICBDb252ZXJ0VG9Kc29uT2JqZWN0KCk6IGFueSB7XHJcbiAgICAgICAgbGV0IG9iaiA9IHN1cGVyLkNvbnZlcnRUb0pzb25PYmplY3QoKTtcclxuXHJcbiAgICAgICAgQnBtbk1vZGVsSGVscGVyLlNldEF0dHJpYnV0ZVZhbHVlKG9iaiwgJ0NhbGxlZEJpekRlZktleScsIHRoaXMuY2FsbGVkQml6RGVmS2V5KTtcclxuICAgICAgICBCcG1uTW9kZWxIZWxwZXIuU2V0QXR0cmlidXRlVmFsdWUob2JqLCAnQml6RGF0YUlkJywgdGhpcy5iaXpEYXRhSWQpO1xyXG4gICAgICAgIEJwbW5Nb2RlbEhlbHBlci5TZXRBdHRyaWJ1dGVWYWx1ZShvYmosICdJbmhlcml0VmFyaWFibGVzJywgdGhpcy5pbmhlcml0VmFyaWFibGVzKTtcclxuICAgICAgICBCcG1uTW9kZWxIZWxwZXIuU2V0QXR0cmlidXRlVmFsdWUob2JqLCAnSW5oZXJpdEJpekRhdGFJZCcsIHRoaXMuaW5oZXJpdEJpekRhdGFJZCk7XHJcbiAgICAgICAgQnBtbk1vZGVsSGVscGVyLlNldEF0dHJpYnV0ZVZhbHVlKG9iaiwgJ2FpZlByb2Nlc3NDb2RlJywgdGhpcy5haWZQcm9jZXNzQ29kZSk7XHJcbiAgICAgICAgQnBtbk1vZGVsSGVscGVyLlNldEF0dHJpYnV0ZVZhbHVlKG9iaiwgJ3VzZUF1dG9DcmVhdGlvbkRhdGEnLCB0aGlzLnVzZUF1dG9DcmVhdGlvbkRhdGEpO1xyXG4gICAgICAgIHJldHVybiBvYmo7XHJcbiAgICB9XHJcbiAgICBMb2FkRnJvbUpzb25PYmplY3Qob2JqOiBhbnkpIHtcclxuICAgICAgICBzdXBlci5Mb2FkRnJvbUpzb25PYmplY3Qob2JqKTtcclxuXHJcbiAgICAgICAgdGhpcy5jYWxsZWRCaXpEZWZLZXkgPSBvYmouQ2FsbGVkQml6RGVmS2V5O1xyXG4gICAgICAgIHRoaXMuYml6RGF0YUlkID0gb2JqLkJpekRhdGFJZDtcclxuICAgICAgICB0aGlzLmluaGVyaXRWYXJpYWJsZXMgPSBvYmouSW5oZXJpdFZhcmlhYmxlcztcclxuICAgICAgICB0aGlzLmluaGVyaXRCaXpEYXRhSWQgPSBvYmouSW5oZXJpdEJpekRhdGFJZDtcclxuICAgICAgICB0aGlzLmFpZlByb2Nlc3NDb2RlID0gQnBtbk1vZGVsSnNvbkhlbHBlci5HZXRBdHRyaWJ1dGVWYWx1ZUFzU3RyaW5nKG9iaiwgXCJhaWZQcm9jZXNzQ29kZVwiKTtcclxuICAgICAgICB0aGlzLnVzZUF1dG9DcmVhdGlvbkRhdGEgPSBCcG1uTW9kZWxKc29uSGVscGVyLkdldEF0dHJpYnV0ZVZhbHVlQXNCb29sZWFuKG9iaiwgXCJ1c2VBdXRvQ3JlYXRpb25EYXRhXCIpO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBwcm90ZWN0ZWQgR2V0RXh0ZW5zaW9uRWxlbWVudHM0Q29udmVydFRvKCk6IEV4dGVuc2lvbkVsZW1lbnRbXSB7XHJcbiAgICAgICAgbGV0IGxpc3QgPSBzdXBlci5HZXRFeHRlbnNpb25FbGVtZW50czRDb252ZXJ0VG8oKTtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMuYmFja1dhcmRSdWxlICE9IG51bGwpIHtcclxuICAgICAgICAgICAgdGhpcy5iYWNrV2FyZFJ1bGUuTWV4VGFnID0gQ2FsbEFjdGl2aXR5U3ViUHJvY2Vzcy5NRVhUQUc7XHJcbiAgICAgICAgICAgIGxpc3QucHVzaCh0aGlzLmJhY2tXYXJkUnVsZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLnZhcmlhYmxlU2V0dGluZ3MgIT0gbnVsbCAmJiB0aGlzLnZhcmlhYmxlU2V0dGluZ3MubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgdGhpcy52YXJpYWJsZVNldHRpbmdzKSB7XHJcbiAgICAgICAgICAgICAgICBpdGVtLk1leFRhZyA9IENhbGxBY3Rpdml0eVN1YlByb2Nlc3MuTUVYVEFHO1xyXG4gICAgICAgICAgICAgICAgbGlzdC5wdXNoKGl0ZW0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBsaXN0O1xyXG4gICAgfVxyXG4gICAgcHJvdGVjdGVkIFNldEV4dGVuc2lvbkVsZW1lbnRzNExvYWRGcm9tKGV4dGVuc2lvbkVsZW1lbnRzOiBFeHRlbnNpb25FbGVtZW50W10pIHtcclxuICAgICAgICBzdXBlci5TZXRFeHRlbnNpb25FbGVtZW50czRMb2FkRnJvbShleHRlbnNpb25FbGVtZW50cyk7XHJcblxyXG4gICAgICAgIGZvciAobGV0IGV4dGVuc2lvbkVsZW1lbnQgb2YgZXh0ZW5zaW9uRWxlbWVudHMpIHtcclxuICAgICAgICAgICAgaWYgKGV4dGVuc2lvbkVsZW1lbnQuTWV4VGFnICE9PSBDYWxsQWN0aXZpdHlTdWJQcm9jZXNzLk1FWFRBRylcclxuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICBzd2l0Y2ggKGV4dGVuc2lvbkVsZW1lbnQuQ2xyVHlwZUlEKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlIFZhcmlhYmxlU2V0dGluZy5DbHJfVHlwZV9JRDpcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnZhcmlhYmxlU2V0dGluZ3MucHVzaChleHRlbnNpb25FbGVtZW50IGFzIFZhcmlhYmxlU2V0dGluZyk7O1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSBCYWNrV2FyZFJ1bGUuQ2xyX1R5cGVfSUQ6XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5iYWNrV2FyZFJ1bGUgPSAoZXh0ZW5zaW9uRWxlbWVudCBhcyBCYWNrV2FyZFJ1bGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBOZXdJbnN0YW5jZSgpOiBDYWxsQWN0aXZpdHlTdWJQcm9jZXNzIHtcclxuICAgICAgICByZXR1cm4gbmV3IENhbGxBY3Rpdml0eVN1YlByb2Nlc3ModGhpcy5Nb2RlbCk7XHJcbiAgICB9XHJcblxyXG4gICAgY2xvbmUoKTogQ2FsbEFjdGl2aXR5U3ViUHJvY2VzcyB7XHJcbiAgICAgICAgY29uc3QgY2FsbEFjdGl2aXR5U3ViUHJvY2VzcyA9IG5ldyBDYWxsQWN0aXZpdHlTdWJQcm9jZXNzKHRoaXMuTW9kZWwpO1xyXG4gICAgICAgIGNhbGxBY3Rpdml0eVN1YlByb2Nlc3MuTmFtZSA9IHRoaXMuTmFtZTtcclxuICAgICAgICBjYWxsQWN0aXZpdHlTdWJQcm9jZXNzLklzRm9yQ29tcGVuc2F0aW9uID0gdGhpcy5Jc0ZvckNvbXBlbnNhdGlvbjtcclxuICAgICAgICBjYWxsQWN0aXZpdHlTdWJQcm9jZXNzLkNhbGxlZEVsZW1lbnQgPSB0aGlzLkNhbGxlZEVsZW1lbnQ7XHJcbiAgICAgICAgY2FsbEFjdGl2aXR5U3ViUHJvY2Vzcy5jYWxsZWRCaXpEZWZLZXkgPSB0aGlzLmNhbGxlZEJpekRlZktleTtcclxuICAgICAgICBjYWxsQWN0aXZpdHlTdWJQcm9jZXNzLmJpekRhdGFJZCA9IHRoaXMuYml6RGF0YUlkO1xyXG4gICAgICAgIGNhbGxBY3Rpdml0eVN1YlByb2Nlc3MuaW5oZXJpdEJpekRhdGFJZCA9IHRoaXMuaW5oZXJpdEJpekRhdGFJZDtcclxuICAgICAgICBjYWxsQWN0aXZpdHlTdWJQcm9jZXNzLmluaGVyaXRWYXJpYWJsZXMgPSB0aGlzLmluaGVyaXRWYXJpYWJsZXM7XHJcblxyXG4gICAgICAgIGNhbGxBY3Rpdml0eVN1YlByb2Nlc3MudmFyaWFibGVTZXR0aW5ncyA9IG5ldyBBcnJheSgpO1xyXG4gICAgICAgIGlmICh0aGlzLnZhcmlhYmxlU2V0dGluZ3MgJiYgdGhpcy52YXJpYWJsZVNldHRpbmdzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgZm9yIChjb25zdCB2IG9mIHRoaXMudmFyaWFibGVTZXR0aW5ncykge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdmFyaWFibGVTZXR0aW5nID0gdi5jbG9uZSgpO1xyXG4gICAgICAgICAgICAgICAgY2FsbEFjdGl2aXR5U3ViUHJvY2Vzcy52YXJpYWJsZVNldHRpbmdzLnB1c2godmFyaWFibGVTZXR0aW5nKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRoaXMuYmFja1dhcmRSdWxlKSB7XHJcbiAgICAgICAgICAgIGNhbGxBY3Rpdml0eVN1YlByb2Nlc3MuYmFja1dhcmRSdWxlID0gdGhpcy5iYWNrV2FyZFJ1bGUuY2xvbmUoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmKHRoaXMuTG9vcENoYXJhY3RlcmlzdGljcykge1xyXG4gICAgICAgICAgICBjYWxsQWN0aXZpdHlTdWJQcm9jZXNzLkxvb3BDaGFyYWN0ZXJpc3RpY3MgPSB0aGlzLkxvb3BDaGFyYWN0ZXJpc3RpY3MuY2xvbmUoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNhbGxBY3Rpdml0eVN1YlByb2Nlc3MuYWlmUHJvY2Vzc0NvZGUgPSBudWxsO1xyXG4gICAgICAgIGlmICh0aGlzLmFpZlByb2Nlc3NDb2RlKSB7XHJcbiAgICAgICAgICAgIGNhbGxBY3Rpdml0eVN1YlByb2Nlc3MuYWlmUHJvY2Vzc0NvZGUgPSB0aGlzLmFpZlByb2Nlc3NDb2RlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjYWxsQWN0aXZpdHlTdWJQcm9jZXNzLnVzZUF1dG9DcmVhdGlvbkRhdGEgPSB0aGlzLnVzZUF1dG9DcmVhdGlvbkRhdGE7XHJcblxyXG4gICAgICAgIHJldHVybiBjYWxsQWN0aXZpdHlTdWJQcm9jZXNzO1xyXG4gICAgfVxyXG5cclxufVxyXG5CcG1uTW9kZWxIZWxwZXIuUmVnaXN0ZXJFbGVtZW50VHlwZShuZXcgQ2FsbEFjdGl2aXR5U3ViUHJvY2VzcyhuZXcgQnBtbk1vZGVsKCkpKTsiXX0=