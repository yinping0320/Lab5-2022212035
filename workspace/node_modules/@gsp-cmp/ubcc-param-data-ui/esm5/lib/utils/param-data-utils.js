/**
 * @fileoverview added by tsickle
 * Generated from: lib/utils/param-data-utils.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Injectable } from '@angular/core';
import { MessagerService } from '@farris/ui-messager';
import { NotifyService } from '@farris/ui-notify';
import { DataTypeConst } from '@ecp-caf/common-structure';
import { DataTypeExtensionConst, StructureTypeRefEnum } from '@gsp-cmp/ubcc-param-vo';
import * as i0 from "@angular/core";
import * as i1 from "@farris/ui-messager";
import * as i2 from "@farris/ui-notify";
var UbccParamDataUtils = /** @class */ (function () {
    function UbccParamDataUtils(messagerService, notify) {
        this.messagerService = messagerService;
        this.notify = notify;
    }
    /**
     * @param {?} dataType
     * @return {?}
     */
    UbccParamDataUtils.prototype.isHelpType = /**
     * @param {?} dataType
     * @return {?}
     */
    function (dataType) {
        if (!dataType) {
            return false;
        }
        if (this.isCollection(dataType)) {
            /** @type {?} */
            var elementType = this.getCollectionElementType(dataType);
            return this.isHelpTypeRef(elementType);
        }
        else {
            return this.isHelpTypeRef(dataType);
        }
    };
    /**
     * @param {?} dataType
     * @return {?}
     */
    UbccParamDataUtils.prototype.isHelpTypeRef = /**
     * @param {?} dataType
     * @return {?}
     */
    function (dataType) {
        /** @type {?} */
        var kind = dataType.getKind();
        if (!kind) {
            return false;
        }
        if (kind === DataTypeExtensionConst.UBCC_STRUCTURE_TYPE_REF) {
            /** @type {?} */
            var refType = (/** @type {?} */ (dataType));
            if (refType.type === StructureTypeRefEnum.HELP) {
                return true;
            }
            else {
                return false;
            }
        }
        else {
            return false;
        }
    };
    // private getHelpData(data:any,paramDataItem:any){
    //     if(!data.dataValue){
    //         return;
    //     }
    //     if (data.dataValueText) {
    //         paramDataItem.valueText = data.dataValueText;
    //     }
    //     else {
    //         let dataId = data.dataValue.split(',');
    //         let helpId=this.getHelpId(paramDataItem.parameterType);
    //         this.http.getHelpData(helpId, dataId).subscribe(
    //             (helpDataItems: Array<HelpDataItem>) => {
    //                 if (!helpDataItems) {
    //                     return;
    //                 }
    //                 let texts=[];
    //                 helpDataItems.map(helpDataItem => texts.push(helpDataItem.text));
    //                 paramDataItem.valueText=texts.join(',');
    //             }
    //         );
    //     }
    // }
    // private getHelpId(dataType:IDataType){
    //     if(this.isCollection(dataType)){
    //         let refType=this.getCollectionElementType(dataType) as StructureTypeRef;
    //         return refType&&refType.refId?refType.refId:null;
    //     }
    //     else{
    //         let refType=dataType as StructureTypeRef;
    //         return refType&&refType.refId?refType.refId:null;
    //     }
    // }
    // private getHelpData(data:any,paramDataItem:any){
    //     if(!data.dataValue){
    //         return;
    //     }
    //     if (data.dataValueText) {
    //         paramDataItem.valueText = data.dataValueText;
    //     }
    //     else {
    //         let dataId = data.dataValue.split(',');
    //         let helpId=this.getHelpId(paramDataItem.parameterType);
    //         this.http.getHelpData(helpId, dataId).subscribe(
    //             (helpDataItems: Array<HelpDataItem>) => {
    //                 if (!helpDataItems) {
    //                     return;
    //                 }
    //                 let texts=[];
    //                 helpDataItems.map(helpDataItem => texts.push(helpDataItem.text));
    //                 paramDataItem.valueText=texts.join(',');
    //             }
    //         );
    //     }
    // }
    // private getHelpId(dataType:IDataType){
    //     if(this.isCollection(dataType)){
    //         let refType=this.getCollectionElementType(dataType) as StructureTypeRef;
    //         return refType&&refType.refId?refType.refId:null;
    //     }
    //     else{
    //         let refType=dataType as StructureTypeRef;
    //         return refType&&refType.refId?refType.refId:null;
    //     }
    // }
    /**
     * @param {?} dataType
     * @return {?}
     */
    UbccParamDataUtils.prototype.getCollectionElementType = 
    // private getHelpData(data:any,paramDataItem:any){
    //     if(!data.dataValue){
    //         return;
    //     }
    //     if (data.dataValueText) {
    //         paramDataItem.valueText = data.dataValueText;
    //     }
    //     else {
    //         let dataId = data.dataValue.split(',');
    //         let helpId=this.getHelpId(paramDataItem.parameterType);
    //         this.http.getHelpData(helpId, dataId).subscribe(
    //             (helpDataItems: Array<HelpDataItem>) => {
    //                 if (!helpDataItems) {
    //                     return;
    //                 }
    //                 let texts=[];
    //                 helpDataItems.map(helpDataItem => texts.push(helpDataItem.text));
    //                 paramDataItem.valueText=texts.join(',');
    //             }
    //         );
    //     }
    // }
    // private getHelpId(dataType:IDataType){
    //     if(this.isCollection(dataType)){
    //         let refType=this.getCollectionElementType(dataType) as StructureTypeRef;
    //         return refType&&refType.refId?refType.refId:null;
    //     }
    //     else{
    //         let refType=dataType as StructureTypeRef;
    //         return refType&&refType.refId?refType.refId:null;
    //     }
    // }
    /**
     * @param {?} dataType
     * @return {?}
     */
    function (dataType) {
        /** @type {?} */
        var kind = dataType.getKind();
        switch (kind) {
            case DataTypeConst.DEFAULT_COLLECTION:
                /** @type {?} */
                var elementType = ((/** @type {?} */ (dataType))).elementType;
                return this.getCollectionElementType(elementType);
            default:
                return dataType;
        }
    };
    /**
     * @param {?} dataType
     * @return {?}
     */
    UbccParamDataUtils.prototype.isCollection = /**
     * @param {?} dataType
     * @return {?}
     */
    function (dataType) {
        if (!dataType) {
            return false;
        }
        if (dataType.getKind() === DataTypeConst.DEFAULT_COLLECTION) {
            return true;
        }
        else {
            return false;
        }
    };
    /**
     * @param {?} btnRef
     * @return {?}
     */
    UbccParamDataUtils.prototype.getModalConfig = /**
     * @param {?} btnRef
     * @return {?}
     */
    function (btnRef) {
        return {
            title: '参数配置',
            width: 650,
            height: 560,
            resizable: true,
            showButtons: true,
            showMaxButton: false,
            enableScroll: false,
            buttons: btnRef
        };
    };
    /**
     * @param {?} message
     * @param {?} infoType
     * @param {?} title
     * @param {?} timeout
     * @return {?}
     */
    UbccParamDataUtils.prototype.showInfo = /**
     * @param {?} message
     * @param {?} infoType
     * @param {?} title
     * @param {?} timeout
     * @return {?}
     */
    function (message, infoType, title, timeout) {
        this.notify.config.position = 'top-center';
        if (infoType == 'success') {
            this.notify.success((/** @type {?} */ ({ title: title, msg: message, timeout: timeout })));
        }
        else if (infoType == 'info') {
            this.notify.info((/** @type {?} */ ({ title: title, msg: message, timeout: timeout })));
        }
        else if (infoType == 'warning') {
            this.notify.warning((/** @type {?} */ ({ title: title, msg: message, timeout: timeout })));
        }
        else if (infoType == 'error') {
            this.notify.error((/** @type {?} */ ({ title: title, msg: message, timeout: timeout })));
        }
    };
    /**
     * @return {?}
     */
    UbccParamDataUtils.prototype.newGuid = /**
     * @return {?}
     */
    function () {
        return (this.s4() + this.s4() + "-" + this.s4() + "-" + this.s4() + "-" + this.s4() + "-" + this.s4() + this.s4() + this.s4());
    };
    /**
     * @return {?}
     */
    UbccParamDataUtils.prototype.s4 = /**
     * @return {?}
     */
    function () {
        return (((1 + Math.random()) * 0x10000) | 0).toString(16).substring(1);
    };
    UbccParamDataUtils.decorators = [
        { type: Injectable, args: [{
                    providedIn: 'root'
                },] }
    ];
    /** @nocollapse */
    UbccParamDataUtils.ctorParameters = function () { return [
        { type: MessagerService },
        { type: NotifyService }
    ]; };
    /** @nocollapse */ UbccParamDataUtils.ngInjectableDef = i0.defineInjectable({ factory: function UbccParamDataUtils_Factory() { return new UbccParamDataUtils(i0.inject(i1.MessagerService), i0.inject(i2.NotifyService)); }, token: UbccParamDataUtils, providedIn: "root" });
    return UbccParamDataUtils;
}());
export { UbccParamDataUtils };
if (false) {
    /**
     * @type {?}
     * @private
     */
    UbccParamDataUtils.prototype.messagerService;
    /**
     * @type {?}
     * @private
     */
    UbccParamDataUtils.prototype.notify;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicGFyYW0tZGF0YS11dGlscy5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0Bnc3AtY21wL3ViY2MtcGFyYW0tZGF0YS11aS8iLCJzb3VyY2VzIjpbImxpYi91dGlscy9wYXJhbS1kYXRhLXV0aWxzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsT0FBTyxFQUFFLFVBQVUsRUFBZSxNQUFNLGVBQWUsQ0FBQztBQUN4RCxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFDdEQsT0FBTyxFQUFFLGFBQWEsRUFBaUIsTUFBTSxtQkFBbUIsQ0FBQztBQUNqRSxPQUFPLEVBQWEsYUFBYSxFQUFrQixNQUFNLDJCQUEyQixDQUFDO0FBQ3JGLE9BQU8sRUFBRSxzQkFBc0IsRUFBb0Isb0JBQW9CLEVBQUUsTUFBTSx3QkFBd0IsQ0FBQzs7OztBQUV4RztJQUtJLDRCQUFvQixlQUErQixFQUFTLE1BQW9CO1FBQTVELG9CQUFlLEdBQWYsZUFBZSxDQUFnQjtRQUFTLFdBQU0sR0FBTixNQUFNLENBQWM7SUFBRSxDQUFDOzs7OztJQUc1RSx1Q0FBVTs7OztJQUFqQixVQUFrQixRQUFrQjtRQUNoQyxJQUFHLENBQUMsUUFBUSxFQUFDO1lBQ1QsT0FBTyxLQUFLLENBQUM7U0FDaEI7UUFDRCxJQUFHLElBQUksQ0FBQyxZQUFZLENBQUMsUUFBUSxDQUFDLEVBQUM7O2dCQUN2QixXQUFXLEdBQUMsSUFBSSxDQUFDLHdCQUF3QixDQUFDLFFBQVEsQ0FBQztZQUN2RCxPQUFPLElBQUksQ0FBQyxhQUFhLENBQUMsV0FBVyxDQUFDLENBQUM7U0FDMUM7YUFDRztZQUNBLE9BQU8sSUFBSSxDQUFDLGFBQWEsQ0FBQyxRQUFRLENBQUMsQ0FBQztTQUN2QztJQUNMLENBQUM7Ozs7O0lBRU0sMENBQWE7Ozs7SUFBcEIsVUFBcUIsUUFBa0I7O1lBQy9CLElBQUksR0FBQyxRQUFRLENBQUMsT0FBTyxFQUFFO1FBQzNCLElBQUcsQ0FBQyxJQUFJLEVBQUM7WUFDTCxP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QkFDckI7Ozs7Z0JBUFEsZUFBZTtnQkFDZixhQUFhOzs7NkJBRnRCO0NBNElDLEFBdElELElBc0lDO1NBbklZLGtCQUFrQjs7Ozs7O0lBRWYsNkNBQXVDOzs7OztJQUFDLG9DQUE0QiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEluamVjdGFibGUsIFRlbXBsYXRlUmVmIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IE1lc3NhZ2VyU2VydmljZSB9IGZyb20gJ0BmYXJyaXMvdWktbWVzc2FnZXInO1xyXG5pbXBvcnQgeyBOb3RpZnlTZXJ2aWNlLCBOb3RpZnlPcHRpb25zIH0gZnJvbSAnQGZhcnJpcy91aS1ub3RpZnknO1xyXG5pbXBvcnQgeyBJRGF0YVR5cGUsIERhdGFUeXBlQ29uc3QsIENvbGxlY3Rpb25UeXBlIH0gZnJvbSAnQGVjcC1jYWYvY29tbW9uLXN0cnVjdHVyZSc7XHJcbmltcG9ydCB7IERhdGFUeXBlRXh0ZW5zaW9uQ29uc3QsIFN0cnVjdHVyZVR5cGVSZWYsIFN0cnVjdHVyZVR5cGVSZWZFbnVtIH0gZnJvbSAnQGdzcC1jbXAvdWJjYy1wYXJhbS12byc7XHJcblxyXG5ASW5qZWN0YWJsZSh7XHJcbiAgICBwcm92aWRlZEluOiAncm9vdCdcclxufSlcclxuZXhwb3J0IGNsYXNzIFViY2NQYXJhbURhdGFVdGlscyB7XHJcblxyXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSBtZXNzYWdlclNlcnZpY2U6TWVzc2FnZXJTZXJ2aWNlLHByaXZhdGUgbm90aWZ5Ok5vdGlmeVNlcnZpY2Upe31cclxuXHJcblxyXG4gICAgcHVibGljIGlzSGVscFR5cGUoZGF0YVR5cGU6SURhdGFUeXBlKXtcclxuICAgICAgICBpZighZGF0YVR5cGUpe1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmKHRoaXMuaXNDb2xsZWN0aW9uKGRhdGFUeXBlKSl7XHJcbiAgICAgICAgICAgIGxldCBlbGVtZW50VHlwZT10aGlzLmdldENvbGxlY3Rpb25FbGVtZW50VHlwZShkYXRhVHlwZSk7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmlzSGVscFR5cGVSZWYoZWxlbWVudFR5cGUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNle1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5pc0hlbHBUeXBlUmVmKGRhdGFUeXBlKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGlzSGVscFR5cGVSZWYoZGF0YVR5cGU6SURhdGFUeXBlKXtcclxuICAgICAgICBsZXQga2luZD1kYXRhVHlwZS5nZXRLaW5kKCk7XHJcbiAgICAgICAgaWYoIWtpbmQpe1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmKGtpbmQ9PT1EYXRhVHlwZUV4dGVuc2lvbkNvbnN0LlVCQ0NfU1RSVUNUVVJFX1RZUEVfUkVGKXtcclxuICAgICAgICAgICAgbGV0IHJlZlR5cGU9ZGF0YVR5cGUgYXMgU3RydWN0dXJlVHlwZVJlZjtcclxuICAgICAgICAgICAgaWYocmVmVHlwZS50eXBlPT09U3RydWN0dXJlVHlwZVJlZkVudW0uSEVMUCl7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNle1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2V7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gcHJpdmF0ZSBnZXRIZWxwRGF0YShkYXRhOmFueSxwYXJhbURhdGFJdGVtOmFueSl7XHJcbiAgICAvLyAgICAgaWYoIWRhdGEuZGF0YVZhbHVlKXtcclxuICAgIC8vICAgICAgICAgcmV0dXJuO1xyXG4gICAgLy8gICAgIH1cclxuICAgIC8vICAgICBpZiAoZGF0YS5kYXRhVmFsdWVUZXh0KSB7XHJcbiAgICAvLyAgICAgICAgIHBhcmFtRGF0YUl0ZW0udmFsdWVUZXh0ID0gZGF0YS5kYXRhVmFsdWVUZXh0O1xyXG4gICAgLy8gICAgIH1cclxuICAgIC8vICAgICBlbHNlIHtcclxuICAgIC8vICAgICAgICAgbGV0IGRhdGFJZCA9IGRhdGEuZGF0YVZhbHVlLnNwbGl0KCcsJyk7XHJcbiAgICAvLyAgICAgICAgIGxldCBoZWxwSWQ9dGhpcy5nZXRIZWxwSWQocGFyYW1EYXRhSXRlbS5wYXJhbWV0ZXJUeXBlKTtcclxuICAgIC8vICAgICAgICAgdGhpcy5odHRwLmdldEhlbHBEYXRhKGhlbHBJZCwgZGF0YUlkKS5zdWJzY3JpYmUoXHJcbiAgICAvLyAgICAgICAgICAgICAoaGVscERhdGFJdGVtczogQXJyYXk8SGVscERhdGFJdGVtPikgPT4ge1xyXG4gICAgLy8gICAgICAgICAgICAgICAgIGlmICghaGVscERhdGFJdGVtcykge1xyXG4gICAgLy8gICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAvLyAgICAgICAgICAgICAgICAgfVxyXG4gICAgLy8gICAgICAgICAgICAgICAgIGxldCB0ZXh0cz1bXTtcclxuICAgIC8vICAgICAgICAgICAgICAgICBoZWxwRGF0YUl0ZW1zLm1hcChoZWxwRGF0YUl0ZW0gPT4gdGV4dHMucHVzaChoZWxwRGF0YUl0ZW0udGV4dCkpO1xyXG4gICAgLy8gICAgICAgICAgICAgICAgIHBhcmFtRGF0YUl0ZW0udmFsdWVUZXh0PXRleHRzLmpvaW4oJywnKTtcclxuICAgIC8vICAgICAgICAgICAgIH1cclxuICAgIC8vICAgICAgICAgKTtcclxuICAgIC8vICAgICB9XHJcbiAgICAvLyB9XHJcblxyXG4gICAgLy8gcHJpdmF0ZSBnZXRIZWxwSWQoZGF0YVR5cGU6SURhdGFUeXBlKXtcclxuICAgIC8vICAgICBpZih0aGlzLmlzQ29sbGVjdGlvbihkYXRhVHlwZSkpe1xyXG4gICAgLy8gICAgICAgICBsZXQgcmVmVHlwZT10aGlzLmdldENvbGxlY3Rpb25FbGVtZW50VHlwZShkYXRhVHlwZSkgYXMgU3RydWN0dXJlVHlwZVJlZjtcclxuICAgIC8vICAgICAgICAgcmV0dXJuIHJlZlR5cGUmJnJlZlR5cGUucmVmSWQ/cmVmVHlwZS5yZWZJZDpudWxsO1xyXG4gICAgLy8gICAgIH1cclxuICAgIC8vICAgICBlbHNle1xyXG4gICAgLy8gICAgICAgICBsZXQgcmVmVHlwZT1kYXRhVHlwZSBhcyBTdHJ1Y3R1cmVUeXBlUmVmO1xyXG4gICAgLy8gICAgICAgICByZXR1cm4gcmVmVHlwZSYmcmVmVHlwZS5yZWZJZD9yZWZUeXBlLnJlZklkOm51bGw7XHJcbiAgICAvLyAgICAgfVxyXG4gICAgLy8gfVxyXG5cclxuICAgIHB1YmxpYyBnZXRDb2xsZWN0aW9uRWxlbWVudFR5cGUoZGF0YVR5cGU6IElEYXRhVHlwZSkge1xyXG4gICAgICAgIGxldCBraW5kID0gZGF0YVR5cGUuZ2V0S2luZCgpO1xyXG4gICAgICAgIHN3aXRjaCAoa2luZCkge1xyXG4gICAgICAgICAgICBjYXNlIERhdGFUeXBlQ29uc3QuREVGQVVMVF9DT0xMRUNUSU9OOlxyXG4gICAgICAgICAgICAgICAgbGV0IGVsZW1lbnRUeXBlID0gKGRhdGFUeXBlIGFzIENvbGxlY3Rpb25UeXBlKS5lbGVtZW50VHlwZTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmdldENvbGxlY3Rpb25FbGVtZW50VHlwZShlbGVtZW50VHlwZSk7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZGF0YVR5cGU7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBpc0NvbGxlY3Rpb24oZGF0YVR5cGU6SURhdGFUeXBlKSB7XHJcbiAgICAgICAgaWYoIWRhdGFUeXBlKXtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoZGF0YVR5cGUuZ2V0S2luZCgpID09PSBEYXRhVHlwZUNvbnN0LkRFRkFVTFRfQ09MTEVDVElPTikge1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGdldE1vZGFsQ29uZmlnKGJ0blJlZjogVGVtcGxhdGVSZWY8YW55Pikge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHRpdGxlOiAn5Y+C5pWw6YWN572uJyxcclxuICAgICAgICAgICAgd2lkdGg6IDY1MCxcclxuICAgICAgICAgICAgaGVpZ2h0OiA1NjAsXHJcbiAgICAgICAgICAgIHJlc2l6YWJsZTp0cnVlLFxyXG4gICAgICAgICAgICBzaG93QnV0dG9uczogdHJ1ZSxcclxuICAgICAgICAgICAgc2hvd01heEJ1dHRvbjogZmFsc2UsXHJcbiAgICAgICAgICAgIGVuYWJsZVNjcm9sbDogZmFsc2UsXHJcbiAgICAgICAgICAgIGJ1dHRvbnM6IGJ0blJlZlxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHNob3dJbmZvKG1lc3NhZ2U6IHN0cmluZywgaW5mb1R5cGU6IHN0cmluZywgdGl0bGU6IHN0cmluZywgdGltZW91dDogbnVtYmVyKSB7XHJcbiAgICAgICAgdGhpcy5ub3RpZnkuY29uZmlnLnBvc2l0aW9uID0gJ3RvcC1jZW50ZXInO1xyXG4gICAgICAgIGlmIChpbmZvVHlwZSA9PSAnc3VjY2VzcycpIHtcclxuICAgICAgICAgICAgdGhpcy5ub3RpZnkuc3VjY2Vzcyg8Tm90aWZ5T3B0aW9ucz57IHRpdGxlOiB0aXRsZSwgbXNnOiBtZXNzYWdlLCB0aW1lb3V0OiB0aW1lb3V0IH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChpbmZvVHlwZSA9PSAnaW5mbycpIHtcclxuICAgICAgICAgICAgdGhpcy5ub3RpZnkuaW5mbyg8Tm90aWZ5T3B0aW9ucz57IHRpdGxlOiB0aXRsZSwgbXNnOiBtZXNzYWdlLCB0aW1lb3V0OiB0aW1lb3V0IH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChpbmZvVHlwZSA9PSAnd2FybmluZycpIHtcclxuICAgICAgICAgICAgdGhpcy5ub3RpZnkud2FybmluZyg8Tm90aWZ5T3B0aW9ucz57IHRpdGxlOiB0aXRsZSwgbXNnOiBtZXNzYWdlLCB0aW1lb3V0OiB0aW1lb3V0IH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChpbmZvVHlwZSA9PSAnZXJyb3InKSB7XHJcbiAgICAgICAgICAgIHRoaXMubm90aWZ5LmVycm9yKDxOb3RpZnlPcHRpb25zPnsgdGl0bGU6IHRpdGxlLCBtc2c6IG1lc3NhZ2UsIHRpbWVvdXQ6IHRpbWVvdXQgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG5ld0d1aWQoKSB7XHJcbiAgICAgICAgcmV0dXJuICh0aGlzLnM0KCkgKyB0aGlzLnM0KCkgKyBcIi1cIiArIHRoaXMuczQoKSArIFwiLVwiICsgdGhpcy5zNCgpICsgXCItXCIgKyB0aGlzLnM0KCkgKyBcIi1cIiArIHRoaXMuczQoKSArIHRoaXMuczQoKSArIHRoaXMuczQoKSk7XHJcbiAgICB9XHJcblxyXG4gICAgczQoKSB7XHJcbiAgICAgICAgcmV0dXJuICgoKDEgKyBNYXRoLnJhbmRvbSgpKSAqIDB4MTAwMDApIHwgMCkudG9TdHJpbmcoMTYpLnN1YnN0cmluZygxKTtcclxuICAgIH1cclxuXHJcbn0iXX0=