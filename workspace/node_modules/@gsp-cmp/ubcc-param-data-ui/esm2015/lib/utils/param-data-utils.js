/**
 * @fileoverview added by tsickle
 * Generated from: lib/utils/param-data-utils.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Injectable } from '@angular/core';
import { MessagerService } from '@farris/ui-messager';
import { NotifyService } from '@farris/ui-notify';
import { DataTypeConst } from '@ecp-caf/common-structure';
import { DataTypeExtensionConst, StructureTypeRefEnum } from '@gsp-cmp/ubcc-param-vo';
import * as i0 from "@angular/core";
import * as i1 from "@farris/ui-messager";
import * as i2 from "@farris/ui-notify";
export class UbccParamDataUtils {
    /**
     * @param {?} messagerService
     * @param {?} notify
     */
    constructor(messagerService, notify) {
        this.messagerService = messagerService;
        this.notify = notify;
    }
    /**
     * @param {?} dataType
     * @return {?}
     */
    isHelpType(dataType) {
        if (!dataType) {
            return false;
        }
        if (this.isCollection(dataType)) {
            /** @type {?} */
            let elementType = this.getCollectionElementType(dataType);
            return this.isHelpTypeRef(elementType);
        }
        else {
            return this.isHelpTypeRef(dataType);
        }
    }
    /**
     * @param {?} dataType
     * @return {?}
     */
    isHelpTypeRef(dataType) {
        /** @type {?} */
        let kind = dataType.getKind();
        if (!kind) {
            return false;
        }
        if (kind === DataTypeExtensionConst.UBCC_STRUCTURE_TYPE_REF) {
            /** @type {?} */
            let refType = (/** @type {?} */ (dataType));
            if (refType.type === StructureTypeRefEnum.HELP) {
                return true;
            }
            else {
                return false;
            }
        }
        else {
            return false;
        }
    }
    // private getHelpData(data:any,paramDataItem:any){
    //     if(!data.dataValue){
    //         return;
    //     }
    //     if (data.dataValueText) {
    //         paramDataItem.valueText = data.dataValueText;
    //     }
    //     else {
    //         let dataId = data.dataValue.split(',');
    //         let helpId=this.getHelpId(paramDataItem.parameterType);
    //         this.http.getHelpData(helpId, dataId).subscribe(
    //             (helpDataItems: Array<HelpDataItem>) => {
    //                 if (!helpDataItems) {
    //                     return;
    //                 }
    //                 let texts=[];
    //                 helpDataItems.map(helpDataItem => texts.push(helpDataItem.text));
    //                 paramDataItem.valueText=texts.join(',');
    //             }
    //         );
    //     }
    // }
    // private getHelpId(dataType:IDataType){
    //     if(this.isCollection(dataType)){
    //         let refType=this.getCollectionElementType(dataType) as StructureTypeRef;
    //         return refType&&refType.refId?refType.refId:null;
    //     }
    //     else{
    //         let refType=dataType as StructureTypeRef;
    //         return refType&&refType.refId?refType.refId:null;
    //     }
    // }
    /**
     * @param {?} dataType
     * @return {?}
     */
    getCollectionElementType(dataType) {
        /** @type {?} */
        let kind = dataType.getKind();
        switch (kind) {
            case DataTypeConst.DEFAULT_COLLECTION:
                /** @type {?} */
                let elementType = ((/** @type {?} */ (dataType))).elementType;
                return this.getCollectionElementType(elementType);
            default:
                return dataType;
        }
    }
    /**
     * @param {?} dataType
     * @return {?}
     */
    isCollection(dataType) {
        if (!dataType) {
            return false;
        }
        if (dataType.getKind() === DataTypeConst.DEFAULT_COLLECTION) {
            return true;
        }
        else {
            return false;
        }
    }
    /**
     * @param {?} btnRef
     * @return {?}
     */
    getModalConfig(btnRef) {
        return {
            title: '参数配置',
            width: 650,
            height: 560,
            resizable: true,
            showButtons: true,
            showMaxButton: false,
            enableScroll: false,
            buttons: btnRef
        };
    }
    /**
     * @param {?} message
     * @param {?} infoType
     * @param {?} title
     * @param {?} timeout
     * @return {?}
     */
    showInfo(message, infoType, title, timeout) {
        this.notify.config.position = 'top-center';
        if (infoType == 'success') {
            this.notify.success((/** @type {?} */ ({ title: title, msg: message, timeout: timeout })));
        }
        else if (infoType == 'info') {
            this.notify.info((/** @type {?} */ ({ title: title, msg: message, timeout: timeout })));
        }
        else if (infoType == 'warning') {
            this.notify.warning((/** @type {?} */ ({ title: title, msg: message, timeout: timeout })));
        }
        else if (infoType == 'error') {
            this.notify.error((/** @type {?} */ ({ title: title, msg: message, timeout: timeout })));
        }
    }
    /**
     * @return {?}
     */
    newGuid() {
        return (this.s4() + this.s4() + "-" + this.s4() + "-" + this.s4() + "-" + this.s4() + "-" + this.s4() + this.s4() + this.s4());
    }
    /**
     * @return {?}
     */
    s4() {
        return (((1 + Math.random()) * 0x10000) | 0).toString(16).substring(1);
    }
}
UbccParamDataUtils.decorators = [
    { type: Injectable, args: [{
                providedIn: 'root'
            },] }
];
/** @nocollapse */
UbccParamDataUtils.ctorParameters = () => [
    { type: MessagerService },
    { type: NotifyService }
];
/** @nocollapse */ UbccParamDataUtils.ngInjectableDef = i0.defineInjectable({ factory: function UbccParamDataUtils_Factory() { return new UbccParamDataUtils(i0.inject(i1.MessagerService), i0.inject(i2.NotifyService)); }, token: UbccParamDataUtils, providedIn: "root" });
if (false) {
    /**
     * @type {?}
     * @private
     */
    UbccParamDataUtils.prototype.messagerService;
    /**
     * @type {?}
     * @private
     */
    UbccParamDataUtils.prototype.notify;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicGFyYW0tZGF0YS11dGlscy5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0Bnc3AtY21wL3ViY2MtcGFyYW0tZGF0YS11aS8iLCJzb3VyY2VzIjpbImxpYi91dGlscy9wYXJhbS1kYXRhLXV0aWxzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsT0FBTyxFQUFFLFVBQVUsRUFBZSxNQUFNLGVBQWUsQ0FBQztBQUN4RCxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFDdEQsT0FBTyxFQUFFLGFBQWEsRUFBaUIsTUFBTSxtQkFBbUIsQ0FBQztBQUNqRSxPQUFPLEVBQWEsYUFBYSxFQUFrQixNQUFNLDJCQUEyQixDQUFDO0FBQ3JGLE9BQU8sRUFBRSxzQkFBc0IsRUFBb0Isb0JBQW9CLEVBQUUsTUFBTSx3QkFBd0IsQ0FBQzs7OztBQUt4RyxNQUFNLE9BQU8sa0JBQWtCOzs7OztJQUUzQixZQUFvQixlQUErQixFQUFTLE1BQW9CO1FBQTVELG9CQUFlLEdBQWYsZUFBZSxDQUFnQjtRQUFTLFdBQU0sR0FBTixNQUFNLENBQWM7SUFBRSxDQUFDOzs7OztJQUc1RSxVQUFVLENBQUMsUUFBa0I7UUFDaEMsSUFBRyxDQUFDLFFBQVEsRUFBQztZQUNULE9BQU8sS0FBSyxDQUFDO1NBQ2hCO1FBQ0QsSUFBRyxJQUFJLENBQUMsWUFBWSxDQUFDLFFBQVEsQ0FBQyxFQUFDOztnQkFDdkIsV0FBVyxHQUFDLElBQUksQ0FBQyx3QkFBd0IsQ0FBQyxRQUFRLENBQUM7WUFDdkQsT0FBTyxJQUFJLENBQUMsYUFBYSxDQUFDLFdBQVcsQ0FBQyxDQUFDO1NBQzFDO2FBQ0c7WUFDQSxPQUFPLElBQUksQ0FBQyxhQUFhLENBQUMsUUFBUSxDQUFDLENBQUM7U0FDdkM7SUFDTCxDQUFDOzs7OztJQUVNLGFBQWEsQ0FBQyxRQUFrQjs7WUFDL0IsSUFBSSxHQUFDLFFBQVEsQ0FBQyxPQUFPLEVBQUU7UUFDM0IsSUFBRyxDQUFDLElBQUksRUFBQztZQUNMLE9B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R0FBRyxHQUFHLEdBQUcsSUFBSSxDQUFDLEVBQUUsRUFBRSxHQUFHLEdBQUcsR0FBRyxJQUFJLENBQUMsRUFBRSxFQUFFLEdBQUcsR0FBRyxHQUFHLElBQUksQ0FBQyxFQUFFLEVBQUUsR0FBRyxHQUFHLEdBQUcsSUFBSSxDQUFDLEVBQUUsRUFBRSxHQUFHLElBQUksQ0FBQyxFQUFFLEVBQUUsR0FBRyxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQztJQUNuSSxDQUFDOzs7O0lBRUQsRUFBRTtRQUNFLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQyxNQUFNLEVBQUUsQ0FBQyxHQUFHLE9BQU8sQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxFQUFFLENBQUMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDM0UsQ0FBQzs7O1lBcElKLFVBQVUsU0FBQztnQkFDUixVQUFVLEVBQUUsTUFBTTthQUNyQjs7OztZQVBRLGVBQWU7WUFDZixhQUFhOzs7Ozs7OztJQVNOLDZDQUF1Qzs7Ozs7SUFBQyxvQ0FBNEIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJbmplY3RhYmxlLCBUZW1wbGF0ZVJlZiB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBNZXNzYWdlclNlcnZpY2UgfSBmcm9tICdAZmFycmlzL3VpLW1lc3NhZ2VyJztcclxuaW1wb3J0IHsgTm90aWZ5U2VydmljZSwgTm90aWZ5T3B0aW9ucyB9IGZyb20gJ0BmYXJyaXMvdWktbm90aWZ5JztcclxuaW1wb3J0IHsgSURhdGFUeXBlLCBEYXRhVHlwZUNvbnN0LCBDb2xsZWN0aW9uVHlwZSB9IGZyb20gJ0BlY3AtY2FmL2NvbW1vbi1zdHJ1Y3R1cmUnO1xyXG5pbXBvcnQgeyBEYXRhVHlwZUV4dGVuc2lvbkNvbnN0LCBTdHJ1Y3R1cmVUeXBlUmVmLCBTdHJ1Y3R1cmVUeXBlUmVmRW51bSB9IGZyb20gJ0Bnc3AtY21wL3ViY2MtcGFyYW0tdm8nO1xyXG5cclxuQEluamVjdGFibGUoe1xyXG4gICAgcHJvdmlkZWRJbjogJ3Jvb3QnXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBVYmNjUGFyYW1EYXRhVXRpbHMge1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgbWVzc2FnZXJTZXJ2aWNlOk1lc3NhZ2VyU2VydmljZSxwcml2YXRlIG5vdGlmeTpOb3RpZnlTZXJ2aWNlKXt9XHJcblxyXG5cclxuICAgIHB1YmxpYyBpc0hlbHBUeXBlKGRhdGFUeXBlOklEYXRhVHlwZSl7XHJcbiAgICAgICAgaWYoIWRhdGFUeXBlKXtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZih0aGlzLmlzQ29sbGVjdGlvbihkYXRhVHlwZSkpe1xyXG4gICAgICAgICAgICBsZXQgZWxlbWVudFR5cGU9dGhpcy5nZXRDb2xsZWN0aW9uRWxlbWVudFR5cGUoZGF0YVR5cGUpO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5pc0hlbHBUeXBlUmVmKGVsZW1lbnRUeXBlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZXtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuaXNIZWxwVHlwZVJlZihkYXRhVHlwZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBpc0hlbHBUeXBlUmVmKGRhdGFUeXBlOklEYXRhVHlwZSl7XHJcbiAgICAgICAgbGV0IGtpbmQ9ZGF0YVR5cGUuZ2V0S2luZCgpO1xyXG4gICAgICAgIGlmKCFraW5kKXtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZihraW5kPT09RGF0YVR5cGVFeHRlbnNpb25Db25zdC5VQkNDX1NUUlVDVFVSRV9UWVBFX1JFRil7XHJcbiAgICAgICAgICAgIGxldCByZWZUeXBlPWRhdGFUeXBlIGFzIFN0cnVjdHVyZVR5cGVSZWY7XHJcbiAgICAgICAgICAgIGlmKHJlZlR5cGUudHlwZT09PVN0cnVjdHVyZVR5cGVSZWZFbnVtLkhFTFApe1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZXtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNle1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIHByaXZhdGUgZ2V0SGVscERhdGEoZGF0YTphbnkscGFyYW1EYXRhSXRlbTphbnkpe1xyXG4gICAgLy8gICAgIGlmKCFkYXRhLmRhdGFWYWx1ZSl7XHJcbiAgICAvLyAgICAgICAgIHJldHVybjtcclxuICAgIC8vICAgICB9XHJcbiAgICAvLyAgICAgaWYgKGRhdGEuZGF0YVZhbHVlVGV4dCkge1xyXG4gICAgLy8gICAgICAgICBwYXJhbURhdGFJdGVtLnZhbHVlVGV4dCA9IGRhdGEuZGF0YVZhbHVlVGV4dDtcclxuICAgIC8vICAgICB9XHJcbiAgICAvLyAgICAgZWxzZSB7XHJcbiAgICAvLyAgICAgICAgIGxldCBkYXRhSWQgPSBkYXRhLmRhdGFWYWx1ZS5zcGxpdCgnLCcpO1xyXG4gICAgLy8gICAgICAgICBsZXQgaGVscElkPXRoaXMuZ2V0SGVscElkKHBhcmFtRGF0YUl0ZW0ucGFyYW1ldGVyVHlwZSk7XHJcbiAgICAvLyAgICAgICAgIHRoaXMuaHR0cC5nZXRIZWxwRGF0YShoZWxwSWQsIGRhdGFJZCkuc3Vic2NyaWJlKFxyXG4gICAgLy8gICAgICAgICAgICAgKGhlbHBEYXRhSXRlbXM6IEFycmF5PEhlbHBEYXRhSXRlbT4pID0+IHtcclxuICAgIC8vICAgICAgICAgICAgICAgICBpZiAoIWhlbHBEYXRhSXRlbXMpIHtcclxuICAgIC8vICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgLy8gICAgICAgICAgICAgICAgIH1cclxuICAgIC8vICAgICAgICAgICAgICAgICBsZXQgdGV4dHM9W107XHJcbiAgICAvLyAgICAgICAgICAgICAgICAgaGVscERhdGFJdGVtcy5tYXAoaGVscERhdGFJdGVtID0+IHRleHRzLnB1c2goaGVscERhdGFJdGVtLnRleHQpKTtcclxuICAgIC8vICAgICAgICAgICAgICAgICBwYXJhbURhdGFJdGVtLnZhbHVlVGV4dD10ZXh0cy5qb2luKCcsJyk7XHJcbiAgICAvLyAgICAgICAgICAgICB9XHJcbiAgICAvLyAgICAgICAgICk7XHJcbiAgICAvLyAgICAgfVxyXG4gICAgLy8gfVxyXG5cclxuICAgIC8vIHByaXZhdGUgZ2V0SGVscElkKGRhdGFUeXBlOklEYXRhVHlwZSl7XHJcbiAgICAvLyAgICAgaWYodGhpcy5pc0NvbGxlY3Rpb24oZGF0YVR5cGUpKXtcclxuICAgIC8vICAgICAgICAgbGV0IHJlZlR5cGU9dGhpcy5nZXRDb2xsZWN0aW9uRWxlbWVudFR5cGUoZGF0YVR5cGUpIGFzIFN0cnVjdHVyZVR5cGVSZWY7XHJcbiAgICAvLyAgICAgICAgIHJldHVybiByZWZUeXBlJiZyZWZUeXBlLnJlZklkP3JlZlR5cGUucmVmSWQ6bnVsbDtcclxuICAgIC8vICAgICB9XHJcbiAgICAvLyAgICAgZWxzZXtcclxuICAgIC8vICAgICAgICAgbGV0IHJlZlR5cGU9ZGF0YVR5cGUgYXMgU3RydWN0dXJlVHlwZVJlZjtcclxuICAgIC8vICAgICAgICAgcmV0dXJuIHJlZlR5cGUmJnJlZlR5cGUucmVmSWQ/cmVmVHlwZS5yZWZJZDpudWxsO1xyXG4gICAgLy8gICAgIH1cclxuICAgIC8vIH1cclxuXHJcbiAgICBwdWJsaWMgZ2V0Q29sbGVjdGlvbkVsZW1lbnRUeXBlKGRhdGFUeXBlOiBJRGF0YVR5cGUpIHtcclxuICAgICAgICBsZXQga2luZCA9IGRhdGFUeXBlLmdldEtpbmQoKTtcclxuICAgICAgICBzd2l0Y2ggKGtpbmQpIHtcclxuICAgICAgICAgICAgY2FzZSBEYXRhVHlwZUNvbnN0LkRFRkFVTFRfQ09MTEVDVElPTjpcclxuICAgICAgICAgICAgICAgIGxldCBlbGVtZW50VHlwZSA9IChkYXRhVHlwZSBhcyBDb2xsZWN0aW9uVHlwZSkuZWxlbWVudFR5cGU7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRDb2xsZWN0aW9uRWxlbWVudFR5cGUoZWxlbWVudFR5cGUpO1xyXG4gICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRhdGFUeXBlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgaXNDb2xsZWN0aW9uKGRhdGFUeXBlOklEYXRhVHlwZSkge1xyXG4gICAgICAgIGlmKCFkYXRhVHlwZSl7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGRhdGFUeXBlLmdldEtpbmQoKSA9PT0gRGF0YVR5cGVDb25zdC5ERUZBVUxUX0NPTExFQ1RJT04pIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBnZXRNb2RhbENvbmZpZyhidG5SZWY6IFRlbXBsYXRlUmVmPGFueT4pIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICB0aXRsZTogJ+WPguaVsOmFjee9ricsXHJcbiAgICAgICAgICAgIHdpZHRoOiA2NTAsXHJcbiAgICAgICAgICAgIGhlaWdodDogNTYwLFxyXG4gICAgICAgICAgICByZXNpemFibGU6dHJ1ZSxcclxuICAgICAgICAgICAgc2hvd0J1dHRvbnM6IHRydWUsXHJcbiAgICAgICAgICAgIHNob3dNYXhCdXR0b246IGZhbHNlLFxyXG4gICAgICAgICAgICBlbmFibGVTY3JvbGw6IGZhbHNlLFxyXG4gICAgICAgICAgICBidXR0b25zOiBidG5SZWZcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBzaG93SW5mbyhtZXNzYWdlOiBzdHJpbmcsIGluZm9UeXBlOiBzdHJpbmcsIHRpdGxlOiBzdHJpbmcsIHRpbWVvdXQ6IG51bWJlcikge1xyXG4gICAgICAgIHRoaXMubm90aWZ5LmNvbmZpZy5wb3NpdGlvbiA9ICd0b3AtY2VudGVyJztcclxuICAgICAgICBpZiAoaW5mb1R5cGUgPT0gJ3N1Y2Nlc3MnKSB7XHJcbiAgICAgICAgICAgIHRoaXMubm90aWZ5LnN1Y2Nlc3MoPE5vdGlmeU9wdGlvbnM+eyB0aXRsZTogdGl0bGUsIG1zZzogbWVzc2FnZSwgdGltZW91dDogdGltZW91dCB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoaW5mb1R5cGUgPT0gJ2luZm8nKSB7XHJcbiAgICAgICAgICAgIHRoaXMubm90aWZ5LmluZm8oPE5vdGlmeU9wdGlvbnM+eyB0aXRsZTogdGl0bGUsIG1zZzogbWVzc2FnZSwgdGltZW91dDogdGltZW91dCB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoaW5mb1R5cGUgPT0gJ3dhcm5pbmcnKSB7XHJcbiAgICAgICAgICAgIHRoaXMubm90aWZ5Lndhcm5pbmcoPE5vdGlmeU9wdGlvbnM+eyB0aXRsZTogdGl0bGUsIG1zZzogbWVzc2FnZSwgdGltZW91dDogdGltZW91dCB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoaW5mb1R5cGUgPT0gJ2Vycm9yJykge1xyXG4gICAgICAgICAgICB0aGlzLm5vdGlmeS5lcnJvcig8Tm90aWZ5T3B0aW9ucz57IHRpdGxlOiB0aXRsZSwgbXNnOiBtZXNzYWdlLCB0aW1lb3V0OiB0aW1lb3V0IH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBuZXdHdWlkKCkge1xyXG4gICAgICAgIHJldHVybiAodGhpcy5zNCgpICsgdGhpcy5zNCgpICsgXCItXCIgKyB0aGlzLnM0KCkgKyBcIi1cIiArIHRoaXMuczQoKSArIFwiLVwiICsgdGhpcy5zNCgpICsgXCItXCIgKyB0aGlzLnM0KCkgKyB0aGlzLnM0KCkgKyB0aGlzLnM0KCkpO1xyXG4gICAgfVxyXG5cclxuICAgIHM0KCkge1xyXG4gICAgICAgIHJldHVybiAoKCgxICsgTWF0aC5yYW5kb20oKSkgKiAweDEwMDAwKSB8IDApLnRvU3RyaW5nKDE2KS5zdWJzdHJpbmcoMSk7XHJcbiAgICB9XHJcblxyXG59Il19