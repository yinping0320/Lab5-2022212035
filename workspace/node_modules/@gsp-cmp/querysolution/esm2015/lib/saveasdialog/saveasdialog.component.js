/**
 * @fileoverview added by tsickle
 * Generated from: lib/saveasdialog/saveasdialog.component.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Output, EventEmitter, ViewChild, HostBinding, ViewEncapsulation, Input } from '@angular/core';
import { NotifyService } from '@farris/ui-notify';
import { QuerySolutionVo, QuerySolutionExtendVo, SolutionService } from '@farris/component-querycondition';
import { LocaleService } from '@farris/ui-locale';
import { DialogComponent } from '@farris/ui-dialog';
import { cloneDeep } from 'lodash-es';
export class SaveAsDialogComponent {
    /**
     * @param {?} notify
     * @param {?} solutionService
     * @param {?} localeService
     */
    constructor(notify, solutionService, localeService) {
        this.notify = notify;
        this.solutionService = solutionService;
        this.localeService = localeService;
        this.cls = 'saveasdialog';
        this.cancelEmitter = new EventEmitter();
        this.confirmEmitter = new EventEmitter();
        this.getAuthority = new EventEmitter();
        //@Input属性，旧代码未设置，故保留
        this.querySolution = new QuerySolutionVo();
        // 标记code中是否有异常
        this.codeError = false;
        // code最长是100个字符，不论中英文
        this.codeMaxLength = 100;
        // 方案类型：用户个人、全局公共、组织公共
        this.solutionType = [{
                value: 'private',
                name: this.localeService.getValue("extendQuerySolution.private.setAsPrivate")
            },
            {
                value: 'public',
                name: this.localeService.getValue("extendQuerySolution.public.setAsPublic")
            },
            {
                value: 'org',
                name: this.localeService.getValue("extendQuerySolution.org.setAsOrgPublic")
            }];
        // 当前已选方案类型
        this.radioGroupValue = 'private';
        // 是否已分配功能权限，未分配时值为true
        this.authorityError = false;
        // 是否已分配数据权限，未分配时值为true 
        this.noDataAuthority = false;
        // 分配的组织数据权限
        this.dataPermissionIds = [];
        // 组织选择组件的返回值
        this.selectedOrgIds = [];
        this.isDefault = false;
        this.languages = [
            { code: 'zh-cn', name: '中文简体', default: true },
            { code: 'en', name: 'English' },
            { code: 'zh-CHT', name: '中文繁体' }
        ];
    }
    /**
     * @param {?} e
     * @return {?}
     */
    set hideOrgselector(e) {
        //隐藏组织方案
        if (e) {
            this.solutionType = this.solutionType.filter((/**
             * @param {?} val
             * @return {?}
             */
            val => val.value !== 'org'));
        }
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        this.pRadioGroupValue = this.radioGroupValue;
        this.placeholder = this.localeService.getValue('extendQuerySolution.org.placeholder');
        //兼容旧版设计器
        this.currentLang = ((/** @type {?} */ (window))).gspframeworkService ? ((/** @type {?} */ (window))).gspframeworkService.rtf.language.getLanguageCode() : 'zh-cn';
    }
    /**
     * @return {?}
     */
    show() {
        this.dialog.show();
    }
    /**
     * @return {?}
     */
    cancel() {
        // this.cancelEmitter.emit(true);
        this.solutionCodeObj = null;
        this.dialog.close();
    }
    /**
     * @return {?}
     */
    confirm() {
        if (this.solutionCodeObj) {
            this.codeChangeHandler(this.solutionCodeObj['zh-cn']);
            this.codeChangeHandler(this.solutionCodeObj['en']);
            this.codeChangeHandler(this.solutionCodeObj['zh-CHT']);
            if (this.codeError) {
                return;
            }
            this.querySolution.code_chs = this.solutionCodeObj['zh-cn'];
            this.querySolution.code_en = this.solutionCodeObj['en'];
            this.querySolution.code_cht = this.solutionCodeObj['zh-CHT'];
        }
        // 如果有错误返回
        // if (!this.querySolution.code) {
        //   this.solutionService.showInfo(this.localeService.getValue('querySolution.saveAsDialog.pleaseInput'), 'info', '', 1500);
        //   return;
        // }
        if (this.currentLang == 'zh-CHS') {
            if (!this.querySolution.code_chs) {
                this.solutionService.showInfo(this.localeService.getValue('querySolution.saveAsDialog.pleaseInput'), 'info', '', 1500);
                return;
            }
            this.querySolution.code = this.querySolution.code_chs;
        }
        else if (this.currentLang == 'en') {
            if (!this.querySolution.code_en) {
                this.solutionService.showInfo(this.localeService.getValue('querySolution.saveAsDialog.pleaseInput'), 'info', '', 1500);
                return;
            }
            this.querySolution.code = this.querySolution.code_en;
        }
        else if (this.currentLang == 'zh-CHT') {
            if (!this.querySolution.code_cht) {
                this.solutionService.showInfo(this.localeService.getValue('querySolution.saveAsDialog.pleaseInput'), 'info', '', 1500);
                return;
            }
            this.querySolution.code = this.querySolution.code_cht;
        }
        if (this.authorityError && this.radioGroupValue != 'private') {
            this.solutionService.showInfo(this.localeService.getValue('extendQuerySolution.auth.createError'), 'warning', '', 1500);
            return;
        }
        this.querySolution.type = this.radioGroupValue;
        this.querySolution.isDefault = this.radioGroupValue == 'private' ? this.isDefault : false;
        if (this.radioGroupValue == 'org') {
            if (this.selectedOrgIds.length) {
                this.querySolution.extendInfo = this.selectedOrgIds.map((/**
                 * @param {?} id
                 * @return {?}
                 */
                id => {
                    /** @type {?} */
                    let info = new QuerySolutionExtendVo();
                    info['id'] = this.solutionService.getGuid(),
                        info['relatedId'] = this.querySolution.id;
                    info['orgId'] = id;
                    return info;
                }));
            }
            else {
                this.solutionService.showInfo(this.localeService.getValue('extendQuerySolution.auth.noSelectedOrg'), 'info', '', 1500);
                return;
            }
        }
        /** @type {?} */
        let obj = new Object();
        obj['querySolution'] = cloneDeep(this.querySolution);
        this.confirmEmitter.emit(obj);
        this.solutionCodeObj = null;
        this.dialog.close();
    }
    /**
     * @param {?} checkStatus
     * @return {?}
     */
    setDefault(checkStatus) {
        //this.querySolution.isDefault = checkStatus;
        this.isDefault = checkStatus;
    }
    // 变化时检测
    /**
     * @param {?} result
     * @return {?}
     */
    codeChangeHandler(result) {
        if (result && result.length > this.codeMaxLength) {
            this.codeError = true;
        }
        else {
            this.codeError = false;
        }
    }
    // 切换方案类型：个人/公共/组织公共，需要判断权限
    /**
     * @param {?} e
     * @return {?}
     */
    changeSolutionType(e) {
        this.querySolution.type = e;
        this.querySolution.isDefault = e == 'private' ? this.isDefault : false;
        this.getAuthority.emit(e);
    }
    // 获取组织选择组件的返回值（1、弹窗内点确定；2、文本框内移除单个）
    /**
     * @param {?} e
     * @return {?}
     */
    getSelectedId(e) {
        this.selectedOrgIds = ((/** @type {?} */ (e.selections))).map((/**
         * @param {?} org
         * @return {?}
         */
        org => org.orgId));
    }
    // 清空文本框
    /**
     * @return {?}
     */
    clearAllOrgs() {
        this.selectedOrgIds = [];
    }
}
SaveAsDialogComponent.decorators = [
    { type: Component, args: [{
                selector: 'app-saveasdialog',
                template: "<farris-dialog #dialog [buttons]=\"saveasbuttonRef\" [width]=\"550\" [height]=\"310\" [title]=\"title\">\r\n  <div class=\"qs-save-as-input\">\r\n    <div class=\"farris-input-wrap\">\r\n      <!-- <input class=\"form-control\"  placeholder=\"{{'querySolution.saveAsDialog.placeholder' | locale}}\"\r\n        [(ngModel)]=\"querySolution.code\" (ngModelChange)=\"codeChangeHandler($event)\" /> -->\r\n      <language-textbox [editable]=\"true\" [languages]=\"languages\" [panelWidth]=\"530\" [(ngModel)]=\"solutionCodeObj\"></language-textbox>\r\n        <div class=\"farris-feedback\" [class.f-state-invalid]=\"codeError\">\r\n            <span class=\"f-feedback-message ng-star-inserted\">\u540D\u79F0\u957F\u5EA6\u4E0D\u5E94\u8D85\u8FC7100</span>\r\n        </div>\r\n    </div>\r\n    <div class=\"custom-control custom-checkbox qs-save-as-check\">\r\n      <farris-radiogroup [(ngModel)]=\"radioGroupValue\" [data]=\"solutionType\" [horizontal]=\"true\"\r\n        (changeValue)=\"changeSolutionType($event)\">\r\n      </farris-radiogroup>\r\n    </div>\r\n    <div class=\"custom-control custom-checkbox qs-save-as-check\" *ngIf=\"radioGroupValue == 'private'\">\r\n      <input class=\"custom-control-input\" type=\"checkbox\" id=\"defaultSolution\" (change)=\"setDefault($event.target.checked)\"\r\n        [(ngModel)]=\"isDefault\" />\r\n      <label class=\"custom-control-label\" id=\"defaultSolution\"\r\n        (click)=\"setDefault(!isDefault)\">{{'querySolution.saveAsDialog.setAsDefault' | locale}}</label>\r\n    </div>\r\n    <div class=\"custom-control custom-checkbox qs-save-as-check\" *ngIf=\"radioGroupValue == 'org' && !noDataAuthority\">\r\n      <farris-organization-selector\r\n        [primaryField]=\"'orgId'\" [displayField]=\"'name'\" [absOrgType]=\"'System_organization'\" [placeholder]=\"placeholder\"\r\n        [layer]=\"1\" [multiSelect]=\"true\" [showTabIds]=\"'organization'\" [enableHierarchicalLoading]=\"true\"\r\n        [cascadeCheck]=\"true\" [cascadeDown]=\"true\" [cascadeUp]=\"false\" [orgIds]=\"selectedOrgIds\"\r\n        [dataPermission]=\"true\" [dataPermissionIds]=\"dataPermissionIds\" (selectionsChange)=\"getSelectedId($event)\"\r\n        (inputClear)=\"clearAllOrgs()\" (tagRemoved)=\"getSelectedId($event)\"\r\n        ></farris-organization-selector>\r\n    </div>  \r\n  </div>\r\n</farris-dialog>\r\n<ng-template #saveasbuttonRef>\r\n  <div class=\"qs-save-as-btn\">\r\n    <button class=\"btn btn-primary\" [disabled]=\"codeError\"  (click)=\"confirm()\">{{'querySolution.saveAsDialog.confirm' | locale}}</button>\r\n    <button class=\"btn btn-secondary\" (click)=\"cancel()\">{{'querySolution.saveAsDialog.cancel' | locale}}</button>\r\n  </div>\r\n</ng-template>\r\n",
                encapsulation: ViewEncapsulation.None,
                styles: [".qs-save-as-btn .btn{float:right;margin-left:10px;font-size:14px;line-height:26px}.qs-save-as-btn .btn-secondary{min-width:70px}.qs-save-as-input{width:100%;line-height:20px;font-size:14px;padding:20px 10px}.qs-save-as-check{margin:10px auto}"]
            }] }
];
/** @nocollapse */
SaveAsDialogComponent.ctorParameters = () => [
    { type: NotifyService },
    { type: SolutionService },
    { type: LocaleService }
];
SaveAsDialogComponent.propDecorators = {
    cls: [{ type: HostBinding, args: ['class',] }],
    cancelEmitter: [{ type: Output }],
    confirmEmitter: [{ type: Output }],
    getAuthority: [{ type: Output }],
    hideOrgselector: [{ type: Input }],
    dialog: [{ type: ViewChild, args: ['dialog',] }]
};
if (false) {
    /** @type {?} */
    SaveAsDialogComponent.prototype.cls;
    /** @type {?} */
    SaveAsDialogComponent.prototype.cancelEmitter;
    /** @type {?} */
    SaveAsDialogComponent.prototype.confirmEmitter;
    /** @type {?} */
    SaveAsDialogComponent.prototype.getAuthority;
    /** @type {?} */
    SaveAsDialogComponent.prototype.querySolution;
    /** @type {?} */
    SaveAsDialogComponent.prototype.title;
    /** @type {?} */
    SaveAsDialogComponent.prototype.defaultQuerySolution;
    /** @type {?} */
    SaveAsDialogComponent.prototype.dialog;
    /** @type {?} */
    SaveAsDialogComponent.prototype.codeError;
    /** @type {?} */
    SaveAsDialogComponent.prototype.codeMaxLength;
    /** @type {?} */
    SaveAsDialogComponent.prototype.solutionType;
    /** @type {?} */
    SaveAsDialogComponent.prototype.radioGroupValue;
    /** @type {?} */
    SaveAsDialogComponent.prototype.pRadioGroupValue;
    /** @type {?} */
    SaveAsDialogComponent.prototype.authorityError;
    /** @type {?} */
    SaveAsDialogComponent.prototype.noDataAuthority;
    /** @type {?} */
    SaveAsDialogComponent.prototype.dataPermissionIds;
    /** @type {?} */
    SaveAsDialogComponent.prototype.selectedOrgIds;
    /** @type {?} */
    SaveAsDialogComponent.prototype.placeholder;
    /** @type {?} */
    SaveAsDialogComponent.prototype.isDefault;
    /**
     * @type {?}
     * @private
     */
    SaveAsDialogComponent.prototype.currentLang;
    /** @type {?} */
    SaveAsDialogComponent.prototype.languages;
    /** @type {?} */
    SaveAsDialogComponent.prototype.solutionCodeObj;
    /**
     * @type {?}
     * @private
     */
    SaveAsDialogComponent.prototype.notify;
    /**
     * @type {?}
     * @private
     */
    SaveAsDialogComponent.prototype.solutionService;
    /**
     * @type {?}
     * @private
     */
    SaveAsDialogComponent.prototype.localeService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2F2ZWFzZGlhbG9nLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0Bnc3AtY21wL3F1ZXJ5c29sdXRpb24vIiwic291cmNlcyI6WyJsaWIvc2F2ZWFzZGlhbG9nL3NhdmVhc2RpYWxvZy5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFVLE1BQU0sRUFBRSxZQUFZLEVBQUUsU0FBUyxFQUFlLFdBQVcsRUFBRSxpQkFBaUIsRUFBYyxLQUFLLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDbkosT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLG1CQUFtQixDQUFDO0FBQ2xELE9BQU8sRUFBRSxlQUFlLEVBQUUscUJBQXFCLEVBQUUsZUFBZSxFQUFFLE1BQU0sa0NBQWtDLENBQUM7QUFDM0csT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLG1CQUFtQixDQUFDO0FBQ2xELE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQztBQUNwRCxPQUFPLEVBQUUsU0FBUyxFQUFFLE1BQU0sV0FBVyxDQUFDO0FBT3RDLE1BQU0sT0FBTyxxQkFBcUI7Ozs7OztJQTZEaEMsWUFBb0IsTUFBcUIsRUFBVSxlQUFnQyxFQUFVLGFBQTRCO1FBQXJHLFdBQU0sR0FBTixNQUFNLENBQWU7UUFBVSxvQkFBZSxHQUFmLGVBQWUsQ0FBaUI7UUFBVSxrQkFBYSxHQUFiLGFBQWEsQ0FBZTtRQTNEbkcsUUFBRyxHQUFHLGNBQWMsQ0FBQztRQUNqQyxrQkFBYSxHQUFzQixJQUFJLFlBQVksRUFBTyxDQUFDO1FBQzNELG1CQUFjLEdBQXNCLElBQUksWUFBWSxFQUFPLENBQUM7UUFDNUQsaUJBQVksR0FBc0IsSUFBSSxZQUFZLEVBQU8sQ0FBQzs7UUFRcEUsa0JBQWEsR0FBb0IsSUFBSSxlQUFlLEVBQUUsQ0FBQzs7UUFRdkQsY0FBUyxHQUFHLEtBQUssQ0FBQzs7UUFFbEIsa0JBQWEsR0FBRyxHQUFHLENBQUM7O1FB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O0lBR0QsYUFBYSxDQUFDLENBQU07UUFDbEIsSUFBSSxDQUFDLGNBQWMsR0FBRyxDQUFDLG1CQUFBLENBQUMsQ0FBQyxVQUFVLEVBQWMsQ0FBQyxDQUFDLEdBQUc7Ozs7UUFBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsQ0FBQyxLQUFLLEVBQUMsQ0FBQztJQUMzRSxDQUFDOzs7OztJQUdELFlBQVk7UUFDVixJQUFJLENBQUMsY0FBYyxHQUFHLEVBQUUsQ0FBQztJQUMzQixDQUFDOzs7WUF0TEYsU0FBUyxTQUFDO2dCQUNULFFBQVEsRUFBRSxrQkFBa0I7Z0JBQzVCLHlyRkFBNEM7Z0JBRTVDLGFBQWEsRUFBRSxpQkFBaUIsQ0FBQyxJQUFJOzthQUN0Qzs7OztZQVZRLGFBQWE7WUFDMkIsZUFBZTtZQUN2RCxhQUFhOzs7a0JBV25CLFdBQVcsU0FBQyxPQUFPOzRCQUNuQixNQUFNOzZCQUNOLE1BQU07MkJBQ04sTUFBTTs4QkFDTixLQUFLO3FCQWFMLFNBQVMsU0FBQyxRQUFROzs7O0lBakJuQixvQ0FBMkM7O0lBQzNDLDhDQUFxRTs7SUFDckUsK0NBQXNFOztJQUN0RSw2Q0FBb0U7O0lBUXBFLDhDQUF1RDs7SUFFdkQsc0NBQWM7O0lBRWQscURBQXNDOztJQUV0Qyx1Q0FBNkM7O0lBRTdDLDBDQUFrQjs7SUFFbEIsOENBQW9COztJQUVwQiw2Q0FXRzs7SUFFSCxnREFBb0M7O0lBQ3BDLGlEQUF5Qjs7SUFFekIsK0NBQXVCOztJQUV2QixnREFBd0I7O0lBRXhCLGtEQUFpQzs7SUFFakMsK0NBQThCOztJQUM5Qiw0Q0FBb0I7O0lBRXBCLDBDQUFrQjs7Ozs7SUFFbEIsNENBQTRCOztJQUU1QiwwQ0FJRTs7SUFDRixnREFBcUI7Ozs7O0lBRVQsdUNBQTZCOzs7OztJQUFFLGdEQUF3Qzs7Ozs7SUFBRSw4Q0FBb0MiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIE9uSW5pdCwgT3V0cHV0LCBFdmVudEVtaXR0ZXIsIFZpZXdDaGlsZCwgVGVtcGxhdGVSZWYsIEhvc3RCaW5kaW5nLCBWaWV3RW5jYXBzdWxhdGlvbiwgRWxlbWVudFJlZiwgSW5wdXQgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgTm90aWZ5U2VydmljZSB9IGZyb20gJ0BmYXJyaXMvdWktbm90aWZ5JztcclxuaW1wb3J0IHsgUXVlcnlTb2x1dGlvblZvLCBRdWVyeVNvbHV0aW9uRXh0ZW5kVm8sIFNvbHV0aW9uU2VydmljZSB9IGZyb20gJ0BmYXJyaXMvY29tcG9uZW50LXF1ZXJ5Y29uZGl0aW9uJztcclxuaW1wb3J0IHsgTG9jYWxlU2VydmljZSB9IGZyb20gJ0BmYXJyaXMvdWktbG9jYWxlJztcclxuaW1wb3J0IHsgRGlhbG9nQ29tcG9uZW50IH0gZnJvbSAnQGZhcnJpcy91aS1kaWFsb2cnO1xyXG5pbXBvcnQgeyBjbG9uZURlZXAgfSBmcm9tICdsb2Rhc2gtZXMnO1xyXG5AQ29tcG9uZW50KHtcclxuICBzZWxlY3RvcjogJ2FwcC1zYXZlYXNkaWFsb2cnLFxyXG4gIHRlbXBsYXRlVXJsOiAnLi9zYXZlYXNkaWFsb2cuY29tcG9uZW50Lmh0bWwnLFxyXG4gIHN0eWxlVXJsczogWycuL3NhdmVhc2RpYWxvZy5jb21wb25lbnQuY3NzJ10sXHJcbiAgZW5jYXBzdWxhdGlvbjogVmlld0VuY2Fwc3VsYXRpb24uTm9uZVxyXG59KVxyXG5leHBvcnQgY2xhc3MgU2F2ZUFzRGlhbG9nQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0IHtcclxuXHJcbiAgQEhvc3RCaW5kaW5nKCdjbGFzcycpIGNscyA9ICdzYXZlYXNkaWFsb2cnO1xyXG4gIEBPdXRwdXQoKSBjYW5jZWxFbWl0dGVyOiBFdmVudEVtaXR0ZXI8YW55PiA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xyXG4gIEBPdXRwdXQoKSBjb25maXJtRW1pdHRlcjogRXZlbnRFbWl0dGVyPGFueT4gPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcclxuICBAT3V0cHV0KCkgZ2V0QXV0aG9yaXR5OiBFdmVudEVtaXR0ZXI8YW55PiA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xyXG4gIEBJbnB1dCgpIHNldCBoaWRlT3Jnc2VsZWN0b3IoZSkge1xyXG4gICAgLy/pmpDol4/nu4Tnu4fmlrnmoYhcclxuICAgIGlmKGUpIHtcclxuICAgICAgdGhpcy5zb2x1dGlvblR5cGUgPSB0aGlzLnNvbHV0aW9uVHlwZS5maWx0ZXIodmFsID0+IHZhbC52YWx1ZSAhPT0gJ29yZycpXHJcbiAgICB9XHJcbiAgfVxyXG4gIC8vQElucHV05bGe5oCn77yM5pen5Luj56CB5pyq6K6+572u77yM5pWF5L+d55WZXHJcbiAgcXVlcnlTb2x1dGlvbjogUXVlcnlTb2x1dGlvblZvID0gbmV3IFF1ZXJ5U29sdXRpb25WbygpO1xyXG4gIC8v5paw5aKeQElucHV05bGe5oCnXHJcbiAgdGl0bGU6IHN0cmluZztcclxuICAvL+WGhemDqOWxnuaAp1xyXG4gIGRlZmF1bHRRdWVyeVNvbHV0aW9uOiBRdWVyeVNvbHV0aW9uVm87XHJcblxyXG4gIEBWaWV3Q2hpbGQoJ2RpYWxvZycpIGRpYWxvZzogRGlhbG9nQ29tcG9uZW50O1xyXG4gIC8vIOagh+iusGNvZGXkuK3mmK/lkKbmnInlvILluLhcclxuICBjb2RlRXJyb3IgPSBmYWxzZTtcclxuICAvLyBjb2Rl5pyA6ZW/5pivMTAw5Liq5a2X56ym77yM5LiN6K665Lit6Iux5paHXHJcbiAgY29kZU1heExlbmd0aCA9IDEwMDtcclxuICAvLyDmlrnmoYjnsbvlnovvvJrnlKjmiLfkuKrkurrjgIHlhajlsYDlhazlhbHjgIHnu4Tnu4flhazlhbFcclxuICBzb2x1dGlvblR5cGUgPSBbe1xyXG4gICAgdmFsdWU6ICdwcml2YXRlJyxcclxuICAgIG5hbWU6IHRoaXMubG9jYWxlU2VydmljZS5nZXRWYWx1ZShcImV4dGVuZFF1ZXJ5U29sdXRpb24ucHJpdmF0ZS5zZXRBc1ByaXZhdGVcIilcclxuICB9LFxyXG4gIHtcclxuICAgIHZhbHVlOiAncHVibGljJyxcclxuICAgIG5hbWU6IHRoaXMubG9jYWxlU2VydmljZS5nZXRWYWx1ZShcImV4dGVuZFF1ZXJ5U29sdXRpb24ucHVibGljLnNldEFzUHVibGljXCIpXHJcbiAgfSxcclxuICB7XHJcbiAgICB2YWx1ZTogJ29yZycsXHJcbiAgICBuYW1lOiB0aGlzLmxvY2FsZVNlcnZpY2UuZ2V0VmFsdWUoXCJleHRlbmRRdWVyeVNvbHV0aW9uLm9yZy5zZXRBc09yZ1B1YmxpY1wiKVxyXG4gIH1dO1xyXG4gIC8vIOW9k+WJjeW3sumAieaWueahiOexu+Wei1xyXG4gIHJhZGlvR3JvdXBWYWx1ZTogc3RyaW5nID0gJ3ByaXZhdGUnO1xyXG4gIHBSYWRpb0dyb3VwVmFsdWU6IHN0cmluZztcclxuICAvLyDmmK/lkKblt7LliIbphY3lip/og73mnYPpmZDvvIzmnKrliIbphY3ml7blgLzkuLp0cnVlXHJcbiAgYXV0aG9yaXR5RXJyb3IgPSBmYWxzZTtcclxuICAvLyDmmK/lkKblt7LliIbphY3mlbDmja7mnYPpmZDvvIzmnKrliIbphY3ml7blgLzkuLp0cnVlIFxyXG4gIG5vRGF0YUF1dGhvcml0eSA9IGZhbHNlO1xyXG4gIC8vIOWIhumFjeeahOe7hOe7h+aVsOaNruadg+mZkFxyXG4gIGRhdGFQZXJtaXNzaW9uSWRzOiBzdHJpbmdbXSA9IFtdO1xyXG4gIC8vIOe7hOe7h+mAieaLqee7hOS7tueahOi/lOWbnuWAvFxyXG4gIHNlbGVjdGVkT3JnSWRzOiBzdHJpbmdbXSA9IFtdO1xyXG4gIHBsYWNlaG9sZGVyOiBzdHJpbmc7XHJcblxyXG4gIGlzRGVmYXVsdCA9IGZhbHNlO1xyXG5cclxuICBwcml2YXRlIGN1cnJlbnRMYW5nOiBzdHJpbmc7XHJcblxyXG4gIGxhbmd1YWdlcyA9IFtcclxuICAgIHsgY29kZTogJ3poLWNuJywgbmFtZTogJ+S4reaWh+eugOS9kycsIGRlZmF1bHQ6IHRydWUgfSxcclxuICAgIHsgY29kZTogJ2VuJywgbmFtZTogJ0VuZ2xpc2gnIH0sXHJcbiAgICB7IGNvZGU6ICd6aC1DSFQnLCBuYW1lOiAn5Lit5paH57mB5L2TJyB9XHJcbiAgXTtcclxuICBzb2x1dGlvbkNvZGVPYmo6IGFueTtcclxuXHJcbiAgY29uc3RydWN0b3IocHJpdmF0ZSBub3RpZnk6IE5vdGlmeVNlcnZpY2UsIHByaXZhdGUgc29sdXRpb25TZXJ2aWNlOiBTb2x1dGlvblNlcnZpY2UsIHByaXZhdGUgbG9jYWxlU2VydmljZTogTG9jYWxlU2VydmljZSkgeyB9XHJcblxyXG5cclxuICBuZ09uSW5pdCgpIHtcclxuICAgIHRoaXMucFJhZGlvR3JvdXBWYWx1ZSA9IHRoaXMucmFkaW9Hcm91cFZhbHVlO1xyXG4gICAgdGhpcy5wbGFjZWhvbGRlciA9IHRoaXMubG9jYWxlU2VydmljZS5nZXRWYWx1ZSgnZXh0ZW5kUXVlcnlTb2x1dGlvbi5vcmcucGxhY2Vob2xkZXInKTtcclxuICAgIC8v5YW85a655pen54mI6K6+6K6h5ZmoXHJcbiAgICB0aGlzLmN1cnJlbnRMYW5nID0gKHdpbmRvdyBhcyBhbnkpLmdzcGZyYW1ld29ya1NlcnZpY2UgPyAod2luZG93IGFzIGFueSkuZ3NwZnJhbWV3b3JrU2VydmljZS5ydGYubGFuZ3VhZ2UuZ2V0TGFuZ3VhZ2VDb2RlKCkgOiAnemgtY24nO1xyXG4gIH1cclxuXHJcbiAgc2hvdygpIHtcclxuICAgIHRoaXMuZGlhbG9nLnNob3coKTtcclxuICB9XHJcblxyXG4gIGNhbmNlbCgpIHtcclxuICAgIC8vIHRoaXMuY2FuY2VsRW1pdHRlci5lbWl0KHRydWUpO1xyXG4gICAgdGhpcy5zb2x1dGlvbkNvZGVPYmogPSBudWxsO1xyXG4gICAgdGhpcy5kaWFsb2cuY2xvc2UoKTtcclxuICB9XHJcblxyXG4gIGNvbmZpcm0oKSB7XHJcbiAgICBpZiAodGhpcy5zb2x1dGlvbkNvZGVPYmopIHtcclxuICAgICAgdGhpcy5jb2RlQ2hhbmdlSGFuZGxlcih0aGlzLnNvbHV0aW9uQ29kZU9ialsnemgtY24nXSk7XHJcbiAgICAgIHRoaXMuY29kZUNoYW5nZUhhbmRsZXIodGhpcy5zb2x1dGlvbkNvZGVPYmpbJ2VuJ10pO1xyXG4gICAgICB0aGlzLmNvZGVDaGFuZ2VIYW5kbGVyKHRoaXMuc29sdXRpb25Db2RlT2JqWyd6aC1DSFQnXSk7XHJcbiAgICAgIGlmICh0aGlzLmNvZGVFcnJvcikge1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG4gICAgICB0aGlzLnF1ZXJ5U29sdXRpb24uY29kZV9jaHMgPSB0aGlzLnNvbHV0aW9uQ29kZU9ialsnemgtY24nXTtcclxuICAgICAgdGhpcy5xdWVyeVNvbHV0aW9uLmNvZGVfZW4gPSB0aGlzLnNvbHV0aW9uQ29kZU9ialsnZW4nXTtcclxuICAgICAgdGhpcy5xdWVyeVNvbHV0aW9uLmNvZGVfY2h0ID0gdGhpcy5zb2x1dGlvbkNvZGVPYmpbJ3poLUNIVCddO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIOWmguaenOaciemUmeivr+i/lOWbnlxyXG5cclxuICAgIC8vIGlmICghdGhpcy5xdWVyeVNvbHV0aW9uLmNvZGUpIHtcclxuICAgIC8vICAgdGhpcy5zb2x1dGlvblNlcnZpY2Uuc2hvd0luZm8odGhpcy5sb2NhbGVTZXJ2aWNlLmdldFZhbHVlKCdxdWVyeVNvbHV0aW9uLnNhdmVBc0RpYWxvZy5wbGVhc2VJbnB1dCcpLCAnaW5mbycsICcnLCAxNTAwKTtcclxuICAgIC8vICAgcmV0dXJuO1xyXG4gICAgLy8gfVxyXG5cclxuICAgIGlmICh0aGlzLmN1cnJlbnRMYW5nID09ICd6aC1DSFMnKSB7XHJcbiAgICAgIGlmICghdGhpcy5xdWVyeVNvbHV0aW9uLmNvZGVfY2hzKSB7XHJcbiAgICAgICAgdGhpcy5zb2x1dGlvblNlcnZpY2Uuc2hvd0luZm8odGhpcy5sb2NhbGVTZXJ2aWNlLmdldFZhbHVlKCdxdWVyeVNvbHV0aW9uLnNhdmVBc0RpYWxvZy5wbGVhc2VJbnB1dCcpLCAnaW5mbycsICcnLCAxNTAwKTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuICAgICAgdGhpcy5xdWVyeVNvbHV0aW9uLmNvZGUgPSB0aGlzLnF1ZXJ5U29sdXRpb24uY29kZV9jaHM7XHJcbiAgICB9IGVsc2UgaWYgKHRoaXMuY3VycmVudExhbmcgPT0gJ2VuJykge1xyXG4gICAgICBpZiAoIXRoaXMucXVlcnlTb2x1dGlvbi5jb2RlX2VuKSB7XHJcbiAgICAgICAgdGhpcy5zb2x1dGlvblNlcnZpY2Uuc2hvd0luZm8odGhpcy5sb2NhbGVTZXJ2aWNlLmdldFZhbHVlKCdxdWVyeVNvbHV0aW9uLnNhdmVBc0RpYWxvZy5wbGVhc2VJbnB1dCcpLCAnaW5mbycsICcnLCAxNTAwKTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuICAgICAgdGhpcy5xdWVyeVNvbHV0aW9uLmNvZGUgPSB0aGlzLnF1ZXJ5U29sdXRpb24uY29kZV9lbjtcclxuICAgIH0gZWxzZSBpZiAodGhpcy5jdXJyZW50TGFuZyA9PSAnemgtQ0hUJykge1xyXG4gICAgICBpZiAoIXRoaXMucXVlcnlTb2x1dGlvbi5jb2RlX2NodCkge1xyXG4gICAgICAgIHRoaXMuc29sdXRpb25TZXJ2aWNlLnNob3dJbmZvKHRoaXMubG9jYWxlU2VydmljZS5nZXRWYWx1ZSgncXVlcnlTb2x1dGlvbi5zYXZlQXNEaWFsb2cucGxlYXNlSW5wdXQnKSwgJ2luZm8nLCAnJywgMTUwMCk7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcbiAgICAgIHRoaXMucXVlcnlTb2x1dGlvbi5jb2RlID0gdGhpcy5xdWVyeVNvbHV0aW9uLmNvZGVfY2h0O1xyXG4gICAgfVxyXG4gICAgaWYgKHRoaXMuYXV0aG9yaXR5RXJyb3IgJiYgdGhpcy5yYWRpb0dyb3VwVmFsdWUgIT0gJ3ByaXZhdGUnKSB7XHJcbiAgICAgIHRoaXMuc29sdXRpb25TZXJ2aWNlLnNob3dJbmZvKHRoaXMubG9jYWxlU2VydmljZS5nZXRWYWx1ZSgnZXh0ZW5kUXVlcnlTb2x1dGlvbi5hdXRoLmNyZWF0ZUVycm9yJyksICd3YXJuaW5nJywgJycsIDE1MDApO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICB0aGlzLnF1ZXJ5U29sdXRpb24udHlwZSA9IHRoaXMucmFkaW9Hcm91cFZhbHVlO1xyXG4gICAgdGhpcy5xdWVyeVNvbHV0aW9uLmlzRGVmYXVsdCA9IHRoaXMucmFkaW9Hcm91cFZhbHVlID09ICdwcml2YXRlJyA/IHRoaXMuaXNEZWZhdWx0IDogZmFsc2U7XHJcbiAgICBpZiAodGhpcy5yYWRpb0dyb3VwVmFsdWUgPT0gJ29yZycpIHtcclxuICAgICAgaWYgKHRoaXMuc2VsZWN0ZWRPcmdJZHMubGVuZ3RoKSB7XHJcbiAgICAgICAgdGhpcy5xdWVyeVNvbHV0aW9uLmV4dGVuZEluZm8gPSB0aGlzLnNlbGVjdGVkT3JnSWRzLm1hcChpZCA9PiB7XHJcbiAgICAgICAgICBsZXQgaW5mbyA9IG5ldyBRdWVyeVNvbHV0aW9uRXh0ZW5kVm8oKTtcclxuICAgICAgICAgIGluZm9bJ2lkJ10gPSB0aGlzLnNvbHV0aW9uU2VydmljZS5nZXRHdWlkKCksXHJcbiAgICAgICAgICAgIGluZm9bJ3JlbGF0ZWRJZCddID0gdGhpcy5xdWVyeVNvbHV0aW9uLmlkO1xyXG4gICAgICAgICAgaW5mb1snb3JnSWQnXSA9IGlkO1xyXG4gICAgICAgICAgcmV0dXJuIGluZm87XHJcbiAgICAgICAgfSlcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICB0aGlzLnNvbHV0aW9uU2VydmljZS5zaG93SW5mbyh0aGlzLmxvY2FsZVNlcnZpY2UuZ2V0VmFsdWUoJ2V4dGVuZFF1ZXJ5U29sdXRpb24uYXV0aC5ub1NlbGVjdGVkT3JnJyksICdpbmZvJywgJycsIDE1MDApO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgbGV0IG9iaiA9IG5ldyBPYmplY3QoKTtcclxuICAgIG9ialsncXVlcnlTb2x1dGlvbiddID0gY2xvbmVEZWVwKHRoaXMucXVlcnlTb2x1dGlvbik7XHJcbiAgICB0aGlzLmNvbmZpcm1FbWl0dGVyLmVtaXQob2JqKTtcclxuICAgIHRoaXMuc29sdXRpb25Db2RlT2JqID0gbnVsbDtcclxuICAgIHRoaXMuZGlhbG9nLmNsb3NlKCk7XHJcbiAgfVxyXG5cclxuICBzZXREZWZhdWx0KGNoZWNrU3RhdHVzOiBib29sZWFuKSB7XHJcbiAgICAvL3RoaXMucXVlcnlTb2x1dGlvbi5pc0RlZmF1bHQgPSBjaGVja1N0YXR1cztcclxuICAgIHRoaXMuaXNEZWZhdWx0ID0gY2hlY2tTdGF0dXM7XHJcbiAgfVxyXG5cclxuICAvLyDlj5jljJbml7bmo4DmtYtcclxuICBjb2RlQ2hhbmdlSGFuZGxlcihyZXN1bHQ6IHN0cmluZykge1xyXG4gICAgaWYgKHJlc3VsdCAmJiByZXN1bHQubGVuZ3RoID4gdGhpcy5jb2RlTWF4TGVuZ3RoKSB7XHJcbiAgICAgIHRoaXMuY29kZUVycm9yID0gdHJ1ZTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuY29kZUVycm9yID0gZmFsc2U7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyDliIfmjaLmlrnmoYjnsbvlnovvvJrkuKrkurov5YWs5YWxL+e7hOe7h+WFrOWFse+8jOmcgOimgeWIpOaWreadg+mZkFxyXG4gIGNoYW5nZVNvbHV0aW9uVHlwZShlOiBhbnkpIHtcclxuICAgIHRoaXMucXVlcnlTb2x1dGlvbi50eXBlID0gZTtcclxuICAgIHRoaXMucXVlcnlTb2x1dGlvbi5pc0RlZmF1bHQgPSBlID09ICdwcml2YXRlJyA/IHRoaXMuaXNEZWZhdWx0IDogZmFsc2U7XHJcbiAgICB0aGlzLmdldEF1dGhvcml0eS5lbWl0KGUpO1xyXG4gIH1cclxuXHJcbiAgLy8g6I635Y+W57uE57uH6YCJ5oup57uE5Lu255qE6L+U5Zue5YC877yIMeOAgeW8ueeql+WGheeCueehruWumu+8mzLjgIHmlofmnKzmoYblhoXnp7vpmaTljZXkuKrvvIlcclxuICBnZXRTZWxlY3RlZElkKGU6IGFueSkge1xyXG4gICAgdGhpcy5zZWxlY3RlZE9yZ0lkcyA9IChlLnNlbGVjdGlvbnMgYXMgQXJyYXk8YW55PikubWFwKG9yZyA9PiBvcmcub3JnSWQpO1xyXG4gIH1cclxuXHJcbiAgLy8g5riF56m65paH5pys5qGGXHJcbiAgY2xlYXJBbGxPcmdzKCkge1xyXG4gICAgdGhpcy5zZWxlY3RlZE9yZ0lkcyA9IFtdO1xyXG4gIH1cclxufVxyXG4iXX0=