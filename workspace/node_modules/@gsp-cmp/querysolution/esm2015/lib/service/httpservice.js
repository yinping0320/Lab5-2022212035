/**
 * @fileoverview added by tsickle
 * Generated from: lib/service/httpservice.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Injectable } from '@angular/core';
import { HttpClient, HttpHeaders } from '@angular/common/http';
import { QuerySolutionVoConvertor } from '@farris/component-querycondition';
import { BasePathService } from '@farris/rtf';
export class HttpService {
    /**
     * @param {?} http
     */
    constructor(http) {
        this.http = http;
        this.histroyUrl = "/api/runtime/sys/v1.0/querysolution/previousQuery";
        this.url = '/api/runtime/sys/v1.0/querysolution';
        this.histroyUrl = BasePathService.convertPath(this.histroyUrl);
        this.url = BasePathService.convertPath(this.url);
    }
    /**
     * 新增查询方案
     * @param {?} querySolution 查询方案实体
     * @param {?} sessionId
     * @return {?}
     */
    create(querySolution, sessionId) {
        /** @type {?} */
        let headers = new HttpHeaders({
            'Content-Type': 'application/json',
            'sessionid': sessionId
        });
        /** @type {?} */
        const options = {
            headers: headers,
            sessionid: sessionId
        };
        /** @type {?} */
        let convertor = new QuerySolutionVoConvertor();
        /** @type {?} */
        let body = convertor.convertJObject(querySolution);
        return this.http.post(this.url, body, options);
    }
    /**
     * 根据表单ID查询当前表单当前登录用户的查询方案列表
     * @param {?} formId 表单ID
     * @param {?} sessionId
     * @return {?}
     */
    query(formId, sessionId) {
        /** @type {?} */
        let headers = new HttpHeaders({
            'Content-Type': 'application/json',
            'sessionid': sessionId
        });
        /** @type {?} */
        const options = {
            headers: headers,
        };
        /** @type {?} */
        let belongId = formId;
        // let url = `http://localhost:5100/api/dev/main/v1.0/querysolution/bybelongid/${belongId}`;
        /** @type {?} */
        let url = `${this.url}/belongId/${belongId}`;
        return this.http.get(url, options);
    }
    /**
     * 更新
     * @param {?} querySolution 查询方案实体
     * @param {?} sessionId
     * @return {?}
     */
    update(querySolution, sessionId) {
        /** @type {?} */
        let headers = new HttpHeaders({
            'Content-Type': 'application/json',
            'sessionid': sessionId
        });
        /** @type {?} */
        const options = {
            headers: headers
        };
        /** @type {?} */
        let convertor = new QuerySolutionVoConvertor();
        /** @type {?} */
        let body = convertor.convertJObject(querySolution);
        return this.http.put(this.url, body, options);
    }
    /**
         * 删除
         * @unused
         * @param idArray 删除的解决方案ID列表
         */
    // delete(idArray: Array<string>, sessionId: string) {
    //     if (!idArray || idArray.length <= 0) {
    //         return;
    //     }
    //     let headers = new HttpHeaders({
    //         'Content-Type': 'application/json',
    //         'sessionid': sessionId
    //     });
    //     const options = {
    //         headers: headers,
    //         sessionid: sessionId
    //     };
    //     let ids = '';
    //     idArray.forEach(id => {
    //         ids = ids + "#" + id;
    //     });
    //     let url = `/api/dev/main/v1.0/querysolution/${encodeURIComponent(ids)}`;
    //     return this.http.delete(url, options);
    // }
    /**
     * 批量更新
     * @param {?} body
     * @param {?} sessionId
     * @return {?}
     */
    batchUpdate(body, sessionId) {
        /** @type {?} */
        let headers = new HttpHeaders({
            'Content-Type': 'application/json',
            'sessionid': sessionId
        });
        /** @type {?} */
        const options = {
            headers: headers,
            sessionid: sessionId
        };
        /** @type {?} */
        let url = `${this.url}/batch`;
        return this.http.put(url, body, options);
    }
    /**
         * 获取默认查询方案ID
         * @unused
         * @param formId
         */
    // getDefaultQuerySolution(formId: string, sessionId: string): Observable<any> {
    //     let headers = new HttpHeaders({
    //         'Content-Type': 'text/plain',
    //         'sessionid': sessionId
    //     });
    //     let belongId = formId;
    //     // let url = `http://localhost:5100/api/dev/main/v1.0/querysolution/defaultSolution/bybelongid/${belongId}`;
    //     let url = `/api/dev/main/v1.0/querysolution/defaultSolution/bybelongid/${belongId}`;
    //     return this.http.get(url, { headers: headers, responseType: 'text' });
    // }
    /**
     * 是否支持
     * @return {?}
     */
    supportLS() {
        if (window.hasOwnProperty("localStorage")) {
            return true;
        }
        return false;
    }
    /**
     * 设置保存时候，属性从小写变成大写
     * @param {?} key
     * @param {?} value
     * @return {?}
     */
    setLS(key, value) {
        /** @type {?} */
        let conditionsStr = '[]';
        if (value) {
            if (typeof value == 'string') {
                conditionsStr = value;
            }
            else {
                /** @type {?} */
                const convertor = new QuerySolutionVoConvertor();
                conditionsStr = JSON.stringify(convertor.formatConvertJObject(value));
            }
        }
        if (key && this.supportLS) {
            localStorage.setItem(key, conditionsStr);
        }
    }
    /**
     * 获取时，属性从大写变成小写
     * @param {?} key
     * @return {?}
     */
    getLS(key) {
        /** @type {?} */
        let result = new Array();
        if (key && this.supportLS) {
            /** @type {?} */
            var v = localStorage.getItem(key);
            if (v != undefined || v !== null) {
                result = JSON.parse(v);
            }
        }
        if (result.length > 0) {
            /** @type {?} */
            const convertor = new QuerySolutionVoConvertor();
            return convertor.formatFromJobject(result);
        }
        return result;
    }
    /**
     * 更新
     * @param {?} querySolution 查询方案实体
     * @param {?} sessionId
     * @return {?}
     */
    saveHistroy(querySolution, sessionId) {
        /** @type {?} */
        let headers = new HttpHeaders({
            "Content-Type": "application/json",
            sessionid: sessionId
        });
        /** @type {?} */
        const options = {
            headers: headers
        };
        /** @type {?} */
        let convertor = new QuerySolutionVoConvertor();
        /** @type {?} */
        let body = convertor.convertJObject(querySolution);
        return this.http.put(this.histroyUrl, body, options);
    }
    // 获取当前用户是否有权限配置公共类型筛选方案，包含全局公共、组织公共
    // 返回结果：（1）是否有权限新增、修改、删除公共类型筛选方案；（2）可为哪些组织设置组织公共筛选方案
    /**
     * @param {?} type
     * @param {?} sessionId
     * @return {?}
     */
    getAuth(type, sessionId) {
        /** @type {?} */
        let headers = new HttpHeaders({
            "Content-Type": "application/json",
            sessionid: sessionId
        });
        /** @type {?} */
        const options = {
            headers: headers
        };
        /** @type {?} */
        let url = `${this.url}/componentType/${type}`;
        return this.http.get(url, options);
    }
}
HttpService.decorators = [
    { type: Injectable }
];
/** @nocollapse */
HttpService.ctorParameters = () => [
    { type: HttpClient }
];
if (false) {
    /**
     * @type {?}
     * @private
     */
    HttpService.prototype.histroyUrl;
    /** @type {?} */
    HttpService.prototype.url;
    /**
     * @type {?}
     * @private
     */
    HttpService.prototype.http;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaHR0cHNlcnZpY2UuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZ3NwLWNtcC9xdWVyeXNvbHV0aW9uLyIsInNvdXJjZXMiOlsibGliL3NlcnZpY2UvaHR0cHNlcnZpY2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQzNDLE9BQU8sRUFBRSxVQUFVLEVBQUUsV0FBVyxFQUFFLE1BQU0sc0JBQXNCLENBQUM7QUFFL0QsT0FBTyxFQUFtQix3QkFBd0IsRUFBa0IsTUFBTSxrQ0FBa0MsQ0FBQztBQUM3RyxPQUFPLEVBQUMsZUFBZSxFQUFFLE1BQU0sYUFBYSxDQUFDO0FBRTdDLE1BQU0sT0FBTyxXQUFXOzs7O0lBRXBCLFlBQW9CLElBQWdCO1FBQWhCLFNBQUksR0FBSixJQUFJLENBQVk7UUFJNUIsZUFBVSxHQUFXLG1EQUFtRCxDQUFDO1FBQ2pGLFFBQUcsR0FBVyxxQ0FBcUMsQ0FBQztRQUpoRCxJQUFJLENBQUMsVUFBVSxHQUFHLGVBQWUsQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFBO1FBQzlELElBQUksQ0FBQyxHQUFHLEdBQUcsZUFBZSxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUE7SUFDcEQsQ0FBQzs7Ozs7OztJQU9ELE1BQU0sQ0FBQyxhQUE4QixFQUFFLFNBQWlCOztZQUNoRCxPQUFPLEdBQUcsSUFBSSxXQUFXLENBQUM7WUFDMUIsY0FBYyxFQUFFLGtCQUFrQjtZQUNsQyxXQUFXLEVBQUUsU0FBUztTQUN6QixDQUFDOztjQUNJLE9BQU8sR0FBRztZQUNaLE9BQU8sRUFBRSxPQUFPO1lBQ2hCLFNBQVMsRUFBRSxTQUFTO1NBQ3ZCOztZQUNHLFNBQVMsR0FBRyxJQUFJLHdCQUF3QixFQUFFOztZQUMxQyxJQUFJLEdBQUcsU0FBUyxDQUFDLGNBQWMsQ0FBQyxhQUFhLENBQUM7UUFDbEQsT0FBTyxJQUFJLENBQUMsSUFB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MEJBQW9EOzs7OztJQUx4QywyQkFBd0IiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJbmplY3RhYmxlIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IEh0dHBDbGllbnQsIEh0dHBIZWFkZXJzIH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uL2h0dHAnO1xyXG5pbXBvcnQgeyBPYnNlcnZhYmxlIH0gZnJvbSAncnhqcyc7XHJcbmltcG9ydCB7IFF1ZXJ5U29sdXRpb25WbywgUXVlcnlTb2x1dGlvblZvQ29udmVydG9yLCBRdWVyeUNvbmRpdGlvbiB9IGZyb20gJ0BmYXJyaXMvY29tcG9uZW50LXF1ZXJ5Y29uZGl0aW9uJztcclxuaW1wb3J0IHtCYXNlUGF0aFNlcnZpY2UgfSBmcm9tICdAZmFycmlzL3J0Zic7XHJcbkBJbmplY3RhYmxlKClcclxuZXhwb3J0IGNsYXNzIEh0dHBTZXJ2aWNlIHtcclxuXHJcbiAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIGh0dHA6IEh0dHBDbGllbnQpIHsgXHJcbiAgICAgICAgdGhpcy5oaXN0cm95VXJsID0gQmFzZVBhdGhTZXJ2aWNlLmNvbnZlcnRQYXRoKHRoaXMuaGlzdHJveVVybClcclxuICAgICAgICB0aGlzLnVybCA9IEJhc2VQYXRoU2VydmljZS5jb252ZXJ0UGF0aCh0aGlzLnVybClcclxuICAgIH1cclxuICAgIHByaXZhdGUgaGlzdHJveVVybDogc3RyaW5nID0gXCIvYXBpL3J1bnRpbWUvc3lzL3YxLjAvcXVlcnlzb2x1dGlvbi9wcmV2aW91c1F1ZXJ5XCI7XHJcbiAgICB1cmw6IHN0cmluZyA9ICcvYXBpL3J1bnRpbWUvc3lzL3YxLjAvcXVlcnlzb2x1dGlvbic7XHJcbiAgICAvKipcclxuICAgICAqIOaWsOWinuafpeivouaWueahiFxyXG4gICAgICogQHBhcmFtIHF1ZXJ5U29sdXRpb24g5p+l6K+i5pa55qGI5a6e5L2TXHJcbiAgICAgKi9cclxuICAgIGNyZWF0ZShxdWVyeVNvbHV0aW9uOiBRdWVyeVNvbHV0aW9uVm8sIHNlc3Npb25JZDogc3RyaW5nKTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgICAgICBsZXQgaGVhZGVycyA9IG5ldyBIdHRwSGVhZGVycyh7XHJcbiAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXHJcbiAgICAgICAgICAgICdzZXNzaW9uaWQnOiBzZXNzaW9uSWRcclxuICAgICAgICB9KTtcclxuICAgICAgICBjb25zdCBvcHRpb25zID0ge1xyXG4gICAgICAgICAgICBoZWFkZXJzOiBoZWFkZXJzLFxyXG4gICAgICAgICAgICBzZXNzaW9uaWQ6IHNlc3Npb25JZFxyXG4gICAgICAgIH07XHJcbiAgICAgICAgbGV0IGNvbnZlcnRvciA9IG5ldyBRdWVyeVNvbHV0aW9uVm9Db252ZXJ0b3IoKTtcclxuICAgICAgICBsZXQgYm9keSA9IGNvbnZlcnRvci5jb252ZXJ0Sk9iamVjdChxdWVyeVNvbHV0aW9uKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5odHRwLnBvc3QodGhpcy51cmwsIGJvZHksIG9wdGlvbnMpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5qC55o2u6KGo5Y2VSUTmn6Xor6LlvZPliY3ooajljZXlvZPliY3nmbvlvZXnlKjmiLfnmoTmn6Xor6LmlrnmoYjliJfooahcclxuICAgICAqIEBwYXJhbSBmb3JtSWQg6KGo5Y2VSURcclxuICAgICAqL1xyXG4gICAgcXVlcnkoZm9ybUlkOiBzdHJpbmcsIHNlc3Npb25JZDogc3RyaW5nKTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgICAgICBsZXQgaGVhZGVycyA9IG5ldyBIdHRwSGVhZGVycyh7XHJcbiAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXHJcbiAgICAgICAgICAgICdzZXNzaW9uaWQnOiBzZXNzaW9uSWRcclxuICAgICAgICB9KTtcclxuICAgICAgICBjb25zdCBvcHRpb25zID0ge1xyXG4gICAgICAgICAgICBoZWFkZXJzOiBoZWFkZXJzLFxyXG4gICAgICAgIH07XHJcbiAgICAgICAgbGV0IGJlbG9uZ0lkID0gZm9ybUlkO1xyXG4gICAgICAgIC8vIGxldCB1cmwgPSBgaHR0cDovL2xvY2FsaG9zdDo1MTAwL2FwaS9kZXYvbWFpbi92MS4wL3F1ZXJ5c29sdXRpb24vYnliZWxvbmdpZC8ke2JlbG9uZ0lkfWA7XHJcbiAgICAgICAgbGV0IHVybCA9IGAke3RoaXMudXJsfS9iZWxvbmdJZC8ke2JlbG9uZ0lkfWA7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaHR0cC5nZXQodXJsLCBvcHRpb25zKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOabtOaWsFxyXG4gICAgICogQHBhcmFtIHF1ZXJ5U29sdXRpb24g5p+l6K+i5pa55qGI5a6e5L2TXHJcbiAgICAgKi9cclxuICAgIHVwZGF0ZShxdWVyeVNvbHV0aW9uOiBRdWVyeVNvbHV0aW9uVm8sIHNlc3Npb25JZDogc3RyaW5nKSB7XHJcbiAgICAgICAgbGV0IGhlYWRlcnMgPSBuZXcgSHR0cEhlYWRlcnMoe1xyXG4gICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxyXG4gICAgICAgICAgICAnc2Vzc2lvbmlkJzogc2Vzc2lvbklkXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY29uc3Qgb3B0aW9ucyA9IHtcclxuICAgICAgICAgICAgaGVhZGVyczogaGVhZGVyc1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgbGV0IGNvbnZlcnRvciA9IG5ldyBRdWVyeVNvbHV0aW9uVm9Db252ZXJ0b3IoKTtcclxuICAgICAgICBsZXQgYm9keSA9IGNvbnZlcnRvci5jb252ZXJ0Sk9iamVjdChxdWVyeVNvbHV0aW9uKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5odHRwLnB1dCh0aGlzLnVybCwgYm9keSwgb3B0aW9ucyk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDliKDpmaRcclxuICAgICAqIEB1bnVzZWRcclxuICAgICAqIEBwYXJhbSBpZEFycmF5IOWIoOmZpOeahOino+WGs+aWueahiElE5YiX6KGoXHJcbiAgICAgKi9cclxuICAgIC8vIGRlbGV0ZShpZEFycmF5OiBBcnJheTxzdHJpbmc+LCBzZXNzaW9uSWQ6IHN0cmluZykge1xyXG4gICAgLy8gICAgIGlmICghaWRBcnJheSB8fCBpZEFycmF5Lmxlbmd0aCA8PSAwKSB7XHJcbiAgICAvLyAgICAgICAgIHJldHVybjtcclxuICAgIC8vICAgICB9XHJcbiAgICAvLyAgICAgbGV0IGhlYWRlcnMgPSBuZXcgSHR0cEhlYWRlcnMoe1xyXG4gICAgLy8gICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxyXG4gICAgLy8gICAgICAgICAnc2Vzc2lvbmlkJzogc2Vzc2lvbklkXHJcbiAgICAvLyAgICAgfSk7XHJcbiAgICAvLyAgICAgY29uc3Qgb3B0aW9ucyA9IHtcclxuICAgIC8vICAgICAgICAgaGVhZGVyczogaGVhZGVycyxcclxuICAgIC8vICAgICAgICAgc2Vzc2lvbmlkOiBzZXNzaW9uSWRcclxuICAgIC8vICAgICB9O1xyXG4gICAgLy8gICAgIGxldCBpZHMgPSAnJztcclxuICAgIC8vICAgICBpZEFycmF5LmZvckVhY2goaWQgPT4ge1xyXG4gICAgLy8gICAgICAgICBpZHMgPSBpZHMgKyBcIiNcIiArIGlkO1xyXG4gICAgLy8gICAgIH0pO1xyXG4gICAgLy8gICAgIGxldCB1cmwgPSBgL2FwaS9kZXYvbWFpbi92MS4wL3F1ZXJ5c29sdXRpb24vJHtlbmNvZGVVUklDb21wb25lbnQoaWRzKX1gO1xyXG4gICAgLy8gICAgIHJldHVybiB0aGlzLmh0dHAuZGVsZXRlKHVybCwgb3B0aW9ucyk7XHJcbiAgICAvLyB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDmibnph4/mm7TmlrBcclxuICAgICAqIEBwYXJhbSBvYmplY3QgOiAne2RlZmF1bHRJZCwgYmVsb25nSWQsIGRlbGV0ZWRJZHN9J1xyXG4gICAgICovXHJcbiAgICBiYXRjaFVwZGF0ZShib2R5OiBhbnksIHNlc3Npb25JZDogc3RyaW5nKTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgICAgICBsZXQgaGVhZGVycyA9IG5ldyBIdHRwSGVhZGVycyh7XHJcbiAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXHJcbiAgICAgICAgICAgICdzZXNzaW9uaWQnOiBzZXNzaW9uSWRcclxuICAgICAgICB9KTtcclxuICAgICAgICBjb25zdCBvcHRpb25zID0ge1xyXG4gICAgICAgICAgICBoZWFkZXJzOiBoZWFkZXJzLFxyXG4gICAgICAgICAgICBzZXNzaW9uaWQ6IHNlc3Npb25JZFxyXG4gICAgICAgIH07XHJcbiAgICAgICAgbGV0IHVybCA9IGAke3RoaXMudXJsfS9iYXRjaGA7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaHR0cC5wdXQodXJsLCBib2R5LCBvcHRpb25zKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOiOt+WPlum7mOiupOafpeivouaWueahiElEXHJcbiAgICAgKiBAdW51c2VkXHJcbiAgICAgKiBAcGFyYW0gZm9ybUlkXHJcbiAgICAgKi9cclxuICAgIC8vIGdldERlZmF1bHRRdWVyeVNvbHV0aW9uKGZvcm1JZDogc3RyaW5nLCBzZXNzaW9uSWQ6IHN0cmluZyk6IE9ic2VydmFibGU8YW55PiB7XHJcbiAgICAvLyAgICAgbGV0IGhlYWRlcnMgPSBuZXcgSHR0cEhlYWRlcnMoe1xyXG4gICAgLy8gICAgICAgICAnQ29udGVudC1UeXBlJzogJ3RleHQvcGxhaW4nLFxyXG4gICAgLy8gICAgICAgICAnc2Vzc2lvbmlkJzogc2Vzc2lvbklkXHJcbiAgICAvLyAgICAgfSk7XHJcbiAgICAvLyAgICAgbGV0IGJlbG9uZ0lkID0gZm9ybUlkO1xyXG4gICAgLy8gICAgIC8vIGxldCB1cmwgPSBgaHR0cDovL2xvY2FsaG9zdDo1MTAwL2FwaS9kZXYvbWFpbi92MS4wL3F1ZXJ5c29sdXRpb24vZGVmYXVsdFNvbHV0aW9uL2J5YmVsb25naWQvJHtiZWxvbmdJZH1gO1xyXG4gICAgLy8gICAgIGxldCB1cmwgPSBgL2FwaS9kZXYvbWFpbi92MS4wL3F1ZXJ5c29sdXRpb24vZGVmYXVsdFNvbHV0aW9uL2J5YmVsb25naWQvJHtiZWxvbmdJZH1gO1xyXG4gICAgLy8gICAgIHJldHVybiB0aGlzLmh0dHAuZ2V0KHVybCwgeyBoZWFkZXJzOiBoZWFkZXJzLCByZXNwb25zZVR5cGU6ICd0ZXh0JyB9KTtcclxuICAgIC8vIH1cclxuICAgIC8qKlxyXG4gICAgICAgICog5piv5ZCm5pSv5oyBXHJcbiAgICAgICAgKi9cclxuICAgIHN1cHBvcnRMUygpIHtcclxuICAgICAgICBpZih3aW5kb3cuaGFzT3duUHJvcGVydHkoXCJsb2NhbFN0b3JhZ2VcIikpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICog6K6+572u5L+d5a2Y5pe25YCZ77yM5bGe5oCn5LuO5bCP5YaZ5Y+Y5oiQ5aSn5YaZXHJcbiAgICAgKiBAcGFyYW0ga2V5IFxyXG4gICAgICogQHBhcmFtIHZhbHVlIFxyXG4gICAgICovXHJcbiAgICBzZXRMUyhrZXksIHZhbHVlOiBhbnkpIHtcclxuICAgICAgICBsZXQgY29uZGl0aW9uc1N0ciA9ICdbXSc7XHJcbiAgICAgICAgaWYodmFsdWUpIHtcclxuICAgICAgICAgICAgaWYoIHR5cGVvZiB2YWx1ZSA9PSAnc3RyaW5nJykge1xyXG4gICAgICAgICAgICAgICAgY29uZGl0aW9uc1N0ciA9IHZhbHVlO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgY29udmVydG9yID0gbmV3IFF1ZXJ5U29sdXRpb25Wb0NvbnZlcnRvcigpO1xyXG4gICAgICAgICAgICAgICAgY29uZGl0aW9uc1N0ciA9IEpTT04uc3RyaW5naWZ5KGNvbnZlcnRvci5mb3JtYXRDb252ZXJ0Sk9iamVjdCh2YWx1ZSkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmKGtleSAmJiB0aGlzLnN1cHBvcnRMUykge1xyXG4gICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShrZXksIGNvbmRpdGlvbnNTdHIpO1xyXG4gICAgICAgIH0gXHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIOiOt+WPluaXtu+8jOWxnuaAp+S7juWkp+WGmeWPmOaIkOWwj+WGmVxyXG4gICAgICogQHBhcmFtIGtleSBcclxuICAgICAqL1xyXG4gICAgZ2V0TFMoa2V5KTogQXJyYXk8UXVlcnlDb25kaXRpb24+IHtcclxuICAgICAgICBsZXQgcmVzdWx0ID0gbmV3IEFycmF5PFF1ZXJ5Q29uZGl0aW9uPigpO1xyXG4gICAgICAgIGlmKGtleSAmJiB0aGlzLnN1cHBvcnRMUykge1xyXG4gICAgICAgICAgICB2YXIgdiA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKGtleSk7XHJcbiAgICAgICAgICAgIGlmICh2ICE9IHVuZGVmaW5lZCB8fCB2ICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBKU09OLnBhcnNlKHYpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmKHJlc3VsdC5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNvbnZlcnRvciA9IG5ldyBRdWVyeVNvbHV0aW9uVm9Db252ZXJ0b3IoKTtcclxuICAgICAgICAgICAgcmV0dXJuIGNvbnZlcnRvci5mb3JtYXRGcm9tSm9iamVjdChyZXN1bHQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5pu05pawXHJcbiAgICAgKiBAcGFyYW0gcXVlcnlTb2x1dGlvbiDmn6Xor6LmlrnmoYjlrp7kvZNcclxuICAgICAqL1xyXG4gICAgc2F2ZUhpc3Ryb3kocXVlcnlTb2x1dGlvbjogUXVlcnlTb2x1dGlvblZvLCBzZXNzaW9uSWQ6IHN0cmluZykge1xyXG4gICAgICAgIGxldCBoZWFkZXJzID0gbmV3IEh0dHBIZWFkZXJzKHtcclxuICAgICAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgICAgICAgICAgIHNlc3Npb25pZDogc2Vzc2lvbklkXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY29uc3Qgb3B0aW9ucyA9IHtcclxuICAgICAgICAgICAgaGVhZGVyczogaGVhZGVyc1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgbGV0IGNvbnZlcnRvciA9IG5ldyBRdWVyeVNvbHV0aW9uVm9Db252ZXJ0b3IoKTtcclxuICAgICAgICBsZXQgYm9keSA9IGNvbnZlcnRvci5jb252ZXJ0Sk9iamVjdChxdWVyeVNvbHV0aW9uKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5odHRwLnB1dCh0aGlzLmhpc3Ryb3lVcmwsIGJvZHksIG9wdGlvbnMpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIOiOt+WPluW9k+WJjeeUqOaIt+aYr+WQpuacieadg+mZkOmFjee9ruWFrOWFseexu+Wei+etm+mAieaWueahiO+8jOWMheWQq+WFqOWxgOWFrOWFseOAgee7hOe7h+WFrOWFsVxyXG4gICAgLy8g6L+U5Zue57uT5p6c77ya77yIMe+8ieaYr+WQpuacieadg+mZkOaWsOWinuOAgeS/ruaUueOAgeWIoOmZpOWFrOWFseexu+Wei+etm+mAieaWueahiO+8m++8iDLvvInlj6/kuLrlk6rkupvnu4Tnu4forr7nva7nu4Tnu4flhazlhbHnrZvpgInmlrnmoYhcclxuICAgIGdldEF1dGgodHlwZTogc3RyaW5nLCBzZXNzaW9uSWQ6IHN0cmluZykge1xyXG4gICAgICAgIGxldCBoZWFkZXJzID0gbmV3IEh0dHBIZWFkZXJzKHtcclxuICAgICAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgICAgICAgICAgIHNlc3Npb25pZDogc2Vzc2lvbklkXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY29uc3Qgb3B0aW9ucyA9IHtcclxuICAgICAgICAgICAgaGVhZGVyczogaGVhZGVyc1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgbGV0IHVybCA9IGAke3RoaXMudXJsfS9jb21wb25lbnRUeXBlLyR7dHlwZX1gO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmh0dHAuZ2V0KHVybCwgb3B0aW9ucyk7XHJcbiAgICB9XHJcbn1cclxuIl19