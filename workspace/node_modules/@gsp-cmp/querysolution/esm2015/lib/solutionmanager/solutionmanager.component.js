/**
 * @fileoverview added by tsickle
 * Generated from: lib/solutionmanager/solutionmanager.component.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, ViewChild, TemplateRef, Output, EventEmitter } from '@angular/core';
import { FormBuilder } from '@angular/forms';
import { EditService } from '../service/edit.service';
import { NotifyService } from '@farris/ui-notify';
import { LocaleService } from '@farris/ui-locale';
import { DialogComponent } from '@farris/ui-dialog';
import { DatagridComponent } from '@farris/ui-datagrid';
import { cloneDeep } from 'lodash-es';
export class SolutionManangerComponent {
    /**
     * @param {?} formBuilder
     * @param {?} editService
     * @param {?} notify
     * @param {?} localeService
     */
    constructor(formBuilder, editService, notify, localeService) {
        this.formBuilder = formBuilder;
        this.editService = editService;
        this.notify = notify;
        this.localeService = localeService;
        this.cancelEmitter = new EventEmitter();
        this.confirmEmitter = new EventEmitter();
        // @Input()
        // currentDefaultQuerySolutionId: string;
        // @Input()
        this.querySolutions = new Array();
        this.deletedQuerySolutionIds = new Array();
        this.authorityError = false;
        this.propertyFieldFormatter = (/**
         * @param {?} value
         * @param {?} data
         * @return {?}
         */
        (value, data) => {
            if (data['type'] == 'public') {
                return this.localeService.getValue("extendQuerySolution.public.property");
            }
            else if (data['type'] == 'org') {
                return this.localeService.getValue("extendQuerySolution.org.property");
            }
            else {
                return this.localeService.getValue("extendQuerySolution.private.property");
            }
        });
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        this.columns = [
            { field: 'code', width: 272, title: this.localeService.getValue('querySolution.manageDialog.name') },
            { field: 'property', width: 110, title: this.localeService.getValue('querySolution.manageDialog.property'), formatter: this.propertyFieldFormatter, halign: 'center', align: 'center' },
            { field: 'isDefault', width: 70, title: this.localeService.getValue('querySolution.manageDialog.default'), template: this.checkCell, halign: 'center', align: 'center' },
            { width: 70, title: this.localeService.getValue('querySolution.manageDialog.operation'), template: this.optCell, halign: 'center', align: 'center' }
        ];
        this.title = this.localeService.getValue('querySolution.container.manage');
    }
    /**
     * @param {?} querySolutions
     * @return {?}
     */
    show(querySolutions) {
        if (querySolutions) {
            this.listData = this.findSolutionsWithoutSys(querySolutions);
            this.querySolutions = querySolutions;
        }
        this.checkedSolution = this.querySolutions.find((/**
         * @param {?} vo
         * @return {?}
         */
        vo => vo.isDefault));
        this.deletedQuerySolutionIds = [];
        // this.checkedSolution = undefined;
        this.dialog.show();
    }
    /**
     * @param {?} value
     * @return {?}
     */
    getSolutionProperty(value) {
        return value ? this.localeService.getValue("querySolution.manageDialog.system") : this.localeService.getValue("querySolution.manageDialog.personal");
    }
    /**
     * @param {?} querySolutions
     * @return {?}
     */
    findSolutionsWithoutSys(querySolutions) {
        /** @type {?} */
        const result = [];
        querySolutions.forEach((/**
         * @param {?} qs
         * @return {?}
         */
        qs => {
            if (!qs.isSystem)
                result.push(qs);
        }));
        return result;
    }
    /**
     * @param {?} dataItem
     * @return {?}
     */
    delelteSolution(dataItem) {
        if (this.authorityError && (dataItem.type == 'public' || dataItem.type == 'org')) {
            this.notify.config.position = 'top-center';
            this.notify.warning((/** @type {?} */ ({ title: '', msg: this.localeService.getValue("extendQuerySolution.auth.deleteError"), timeout: 1500 })));
            return;
        }
        this.deletedQuerySolutionIds.push(dataItem.id);
        if (this.checkedSolution && dataItem.id == this.checkedSolution.id) {
            this.checkedSolution = null;
        }
        //当checkedSolution不存在，直接删除
        for (let i = 0; i < this.querySolutions.length; i++) {
            if (dataItem.id == this.querySolutions[i].id) {
                this.querySolutions.splice(i, 1);
                break;
            }
        }
        this.listData = this.findSolutionsWithoutSys(this.querySolutions);
    }
    /**
     * @param {?} checked
     * @param {?} dataItem
     * @return {?}
     */
    setDefault(checked, dataItem) {
        if (checked) { //if checked，设置当前vo为默认，其他设为非默认
            this.checkedSolution = dataItem;
            //key point！
            // this.currentDefaultQuerySolutionId = dataItem.id;
            this.querySolutions = this.querySolutions.map((/**
             * @param {?} vo
             * @return {?}
             */
            vo => {
                if (vo.id == dataItem.id) {
                    vo.isDefault = true;
                }
                else {
                    vo.isDefault = false;
                }
                return vo;
            }));
        }
        else { //if unchecked, 设置当前vo为非默认，其余vo不变; 没有checkedSolution时
            if (dataItem.id == this.checkedSolution.id) {
                this.checkedSolution = null;
                // this.currentDefaultQuerySolutionId = '';
                this.querySolutions = this.querySolutions.map((/**
                 * @param {?} vo
                 * @return {?}
                 */
                vo => {
                    if (vo.id == dataItem.id) {
                        vo.isDefault = false;
                    }
                    return vo;
                }));
            }
        }
        this.listData = this.findSolutionsWithoutSys(this.querySolutions);
        this.list.refresh();
    }
    /**
     * @return {?}
     */
    cancel() {
        this.dialog.close();
    }
    /**
     * @return {?}
     */
    confirm() {
        /** @type {?} */
        let obj = new Object();
        obj['deletedQuerySolutionIds'] = this.deletedQuerySolutionIds;
        obj['newDefaultQuerySolution'] = cloneDeep(this.checkedSolution);
        obj['updatedQuerySolutionVos'] = cloneDeep(this.querySolutions);
        // obj['currentDefaultQuerySolutionId'] = this.currentDefaultQuerySolutionId;
        if (this.deletedQuerySolutionIds.length > 0 || this.checkedSolution && this.checkedSolution.id) {
            obj['validator'] = true;
        }
        else {
            obj['validator'] = false;
        }
        this.confirmEmitter.emit(obj);
        this.dialog.close();
    }
}
SolutionManangerComponent.decorators = [
    { type: Component, args: [{
                selector: 'app-solutionmanager',
                template: "<farris-dialog #dialog [buttons]=\"manangerbuttonRef\" [width]=\"550\" [height]=\"570\" [title]=\"title\">\r\n    <div class=\"solutionmanager-inner\">\r\n        <farris-datagrid #list [columns]=\"columns\" [data]=\"listData\" [pagination]=\"false\" [fit]=\"true\"></farris-datagrid>\r\n    </div>\r\n    <ng-template #optCell let-ctx>\r\n        <span class=\"f-icon f-icon-yxs_delete solutionmanager-grid-delete\" (click)=\"delelteSolution(ctx.rowData)\"></span>\r\n     </ng-template>\r\n     <ng-template #checkCell let-ctx>\r\n        <div class=\"custom-control custom-radio f-checkradio-single\" style=\"padding-top: 3px;\">\r\n            <input class=\"custom-control-input\" id=\"radio-{{ctx.rowData.id}}\" type=\"radio\"\r\n                [disabled]=\"ctx.rowData.type == 'public' || ctx.rowData.type == 'org'\"\r\n                (click)=\"setDefault($event.target.checked, ctx.rowData)\" [checked]=\"ctx.rowData.isDefault\"/>\r\n            <label class=\"custom-control-label\" for=\"radio-{{ctx.rowData.id}}\"></label>\r\n        </div>\r\n     </ng-template>\r\n</farris-dialog>\r\n<ng-template #manangerbuttonRef>\r\n    <button class=\"btn btn-primary\" (click)=\"confirm()\">{{'querySolution.manageDialog.confirm' | locale}}</button>\r\n    <button class=\"btn btn-secondary\" (click)=\"cancel()\">{{'querySolution.manageDialog.cancel' | locale}}</button>\r\n</ng-template>",
                providers: [EditService],
                styles: [""]
            }] }
];
/** @nocollapse */
SolutionManangerComponent.ctorParameters = () => [
    { type: FormBuilder },
    { type: EditService },
    { type: NotifyService },
    { type: LocaleService }
];
SolutionManangerComponent.propDecorators = {
    cancelEmitter: [{ type: Output }],
    confirmEmitter: [{ type: Output }],
    dialog: [{ type: ViewChild, args: ['dialog',] }],
    optCell: [{ type: ViewChild, args: ['optCell',] }],
    checkCell: [{ type: ViewChild, args: ['checkCell',] }],
    list: [{ type: ViewChild, args: ['list',] }]
};
if (false) {
    /** @type {?} */
    SolutionManangerComponent.prototype.cancelEmitter;
    /** @type {?} */
    SolutionManangerComponent.prototype.confirmEmitter;
    /** @type {?} */
    SolutionManangerComponent.prototype.querySolutions;
    /** @type {?} */
    SolutionManangerComponent.prototype.deletedQuerySolutionIds;
    /** @type {?} */
    SolutionManangerComponent.prototype.checkedSolution;
    /** @type {?} */
    SolutionManangerComponent.prototype.listData;
    /** @type {?} */
    SolutionManangerComponent.prototype.dialog;
    /** @type {?} */
    SolutionManangerComponent.prototype.optCell;
    /** @type {?} */
    SolutionManangerComponent.prototype.checkCell;
    /** @type {?} */
    SolutionManangerComponent.prototype.list;
    /** @type {?} */
    SolutionManangerComponent.prototype.columns;
    /** @type {?} */
    SolutionManangerComponent.prototype.title;
    /** @type {?} */
    SolutionManangerComponent.prototype.authorityError;
    /** @type {?} */
    SolutionManangerComponent.prototype.propertyFieldFormatter;
    /**
     * @type {?}
     * @private
     */
    SolutionManangerComponent.prototype.formBuilder;
    /**
     * @type {?}
     * @private
     */
    SolutionManangerComponent.prototype.editService;
    /**
     * @type {?}
     * @private
     */
    SolutionManangerComponent.prototype.notify;
    /**
     * @type {?}
     * @private
     */
    SolutionManangerComponent.prototype.localeService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic29sdXRpb25tYW5hZ2VyLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0Bnc3AtY21wL3F1ZXJ5c29sdXRpb24vIiwic291cmNlcyI6WyJsaWIvc29sdXRpb25tYW5hZ2VyL3NvbHV0aW9ubWFuYWdlci5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFVLFNBQVMsRUFBRSxXQUFXLEVBQUUsTUFBTSxFQUFFLFlBQVksRUFBUSxNQUFNLGVBQWUsQ0FBQztBQUN0RyxPQUFPLEVBQWEsV0FBVyxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFDeEQsT0FBTyxFQUFFLFdBQVcsRUFBRSxNQUFNLHlCQUF5QixDQUFDO0FBQ3RELE9BQU8sRUFBRSxhQUFhLEVBQWlCLE1BQU0sbUJBQW1CLENBQUM7QUFFakUsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLG1CQUFtQixDQUFDO0FBQ2xELE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQztBQUNwRCxPQUFPLEVBQUUsaUJBQWlCLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUN4RCxPQUFPLEVBQUUsU0FBUyxFQUFFLE1BQU0sV0FBVyxDQUFDO0FBT3RDLE1BQU0sT0FBTyx5QkFBeUI7Ozs7Ozs7SUF1QmxDLFlBQW9CLFdBQXdCLEVBQVUsV0FBd0IsRUFBVSxNQUFxQixFQUFVLGFBQTRCO1FBQS9ILGdCQUFXLEdBQVgsV0FBVyxDQUFhO1FBQVUsZ0JBQVcsR0FBWCxXQUFXLENBQWE7UUFBVSxXQUFNLEdBQU4sTUFBTSxDQUFlO1FBQVUsa0JBQWEsR0FBYixhQUFhLENBQWU7UUFyQnpJLGtCQUFhLEdBQXNCLElBQUksWUFBWSxFQUFPLENBQUM7UUFDM0QsbUJBQWMsR0FBc0IsSUFBSSxZQUFZLEVBQU8sQ0FBQzs7OztRQUt0RSxtQkFBYyxHQUEyQixJQUFJLEtBQUssRUFBbUIsQ0FBQztRQUV0RSw0QkFBdUIsR0FBa0IsSUFBSSxLQUFL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LFNBQVMsU0FBQyxXQUFXO21CQUNyQixTQUFTLFNBQUMsTUFBTTs7OztJQWhCakIsa0RBQXFFOztJQUNyRSxtREFBc0U7O0lBS3RFLG1EQUFzRTs7SUFFdEUsNERBQTZEOztJQUM3RCxvREFBaUM7O0lBQ2pDLDZDQUE0Qjs7SUFFNUIsMkNBQTZDOztJQUU3Qyw0Q0FBZ0Q7O0lBQ2hELDhDQUFvRDs7SUFDcEQseUNBQTJDOztJQUMzQyw0Q0FBb0I7O0lBQ3BCLDBDQUFjOztJQUNkLG1EQUF1Qjs7SUFnQ3ZCLDJEQVNDOzs7OztJQXZDVyxnREFBZ0M7Ozs7O0lBQUUsZ0RBQWdDOzs7OztJQUFFLDJDQUE2Qjs7Ozs7SUFBRSxrREFBb0MiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIE9uSW5pdCwgVmlld0NoaWxkLCBUZW1wbGF0ZVJlZiwgT3V0cHV0LCBFdmVudEVtaXR0ZXIsIElucHV0fSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgRm9ybUdyb3VwLCBGb3JtQnVpbGRlciB9IGZyb20gJ0Bhbmd1bGFyL2Zvcm1zJztcclxuaW1wb3J0IHsgRWRpdFNlcnZpY2UgfSBmcm9tICcuLi9zZXJ2aWNlL2VkaXQuc2VydmljZSc7XHJcbmltcG9ydCB7IE5vdGlmeVNlcnZpY2UsIE5vdGlmeU9wdGlvbnMgfSBmcm9tICdAZmFycmlzL3VpLW5vdGlmeSc7XHJcbmltcG9ydCB7IFF1ZXJ5U29sdXRpb25WbyB9IGZyb20gJ0BmYXJyaXMvY29tcG9uZW50LXF1ZXJ5Y29uZGl0aW9uJztcclxuaW1wb3J0IHsgTG9jYWxlU2VydmljZSB9IGZyb20gJ0BmYXJyaXMvdWktbG9jYWxlJztcclxuaW1wb3J0IHsgRGlhbG9nQ29tcG9uZW50IH0gZnJvbSAnQGZhcnJpcy91aS1kaWFsb2cnO1xyXG5pbXBvcnQgeyBEYXRhZ3JpZENvbXBvbmVudCB9IGZyb20gJ0BmYXJyaXMvdWktZGF0YWdyaWQnO1xyXG5pbXBvcnQgeyBjbG9uZURlZXAgfSBmcm9tICdsb2Rhc2gtZXMnO1xyXG5AQ29tcG9uZW50KHtcclxuICAgIHNlbGVjdG9yOiAnYXBwLXNvbHV0aW9ubWFuYWdlcicsXHJcbiAgICB0ZW1wbGF0ZVVybDogJy4vc29sdXRpb25tYW5hZ2VyLmNvbXBvbmVudC5odG1sJyxcclxuICAgIHN0eWxlVXJsczogWycuL3NvbHV0aW9ubWFuYWdlci5jb21wb25lbnQuY3NzJ10sXHJcbiAgICBwcm92aWRlcnM6IFtFZGl0U2VydmljZV1cclxufSlcclxuZXhwb3J0IGNsYXNzIFNvbHV0aW9uTWFuYW5nZXJDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQge1xyXG5cclxuICAgIEBPdXRwdXQoKSBjYW5jZWxFbWl0dGVyOiBFdmVudEVtaXR0ZXI8YW55PiA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xyXG4gICAgQE91dHB1dCgpIGNvbmZpcm1FbWl0dGVyOiBFdmVudEVtaXR0ZXI8YW55PiA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xyXG4gICAgXHJcbiAgICAvLyBASW5wdXQoKVxyXG4gICAgLy8gY3VycmVudERlZmF1bHRRdWVyeVNvbHV0aW9uSWQ6IHN0cmluZztcclxuICAgIC8vIEBJbnB1dCgpXHJcbiAgICBxdWVyeVNvbHV0aW9uczogQXJyYXk8UXVlcnlTb2x1dGlvblZvPiA9IG5ldyBBcnJheTxRdWVyeVNvbHV0aW9uVm8+KCk7XHJcblxyXG4gICAgZGVsZXRlZFF1ZXJ5U29sdXRpb25JZHM6IEFycmF5PFN0cmluZz4gPSBuZXcgQXJyYXk8U3RyaW5nPigpO1xyXG4gICAgY2hlY2tlZFNvbHV0aW9uOiBRdWVyeVNvbHV0aW9uVm87XHJcbiAgICBsaXN0RGF0YTogUXVlcnlTb2x1dGlvblZvW107XHJcblxyXG4gICAgQFZpZXdDaGlsZCgnZGlhbG9nJykgZGlhbG9nOiBEaWFsb2dDb21wb25lbnQ7XHJcbiAgICAvLyDojrflj5blrprkuYnnmoTljZXlhYPmoLzmqKHmnb9cclxuICAgIEBWaWV3Q2hpbGQoJ29wdENlbGwnKSBvcHRDZWxsOiBUZW1wbGF0ZVJlZjxhbnk+O1xyXG4gICAgQFZpZXdDaGlsZCgnY2hlY2tDZWxsJykgY2hlY2tDZWxsOiBUZW1wbGF0ZVJlZjxhbnk+O1xyXG4gICAgQFZpZXdDaGlsZCgnbGlzdCcpIGxpc3Q6IERhdGFncmlkQ29tcG9uZW50O1xyXG4gICAgY29sdW1uczogQXJyYXk8YW55PjtcclxuICAgIHRpdGxlOiBzdHJpbmc7XHJcbiAgICBhdXRob3JpdHlFcnJvciA9IGZhbHNlO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgZm9ybUJ1aWxkZXI6IEZvcm1CdWlsZGVyLCBwcml2YXRlIGVkaXRTZXJ2aWNlOiBFZGl0U2VydmljZSwgcHJpdmF0ZSBub3RpZnk6IE5vdGlmeVNlcnZpY2UsIHByaXZhdGUgbG9jYWxlU2VydmljZTogTG9jYWxlU2VydmljZSkgeyB9XHJcblxyXG5cclxuICAgIG5nT25Jbml0KCk6IHZvaWQge1xyXG5cclxuICAgICAgICB0aGlzLmNvbHVtbnMgPSBbXHJcbiAgICAgICAgICAgIHsgZmllbGQ6ICdjb2RlJywgd2lkdGg6IDI3MiwgdGl0bGU6IHRoaXMubG9jYWxlU2VydmljZS5nZXRWYWx1ZSgncXVlcnlTb2x1dGlvbi5tYW5hZ2VEaWFsb2cubmFtZScpfSxcclxuICAgICAgICAgICAgeyBmaWVsZDogJ3Byb3BlcnR5Jywgd2lkdGg6IDExMCwgdGl0bGU6IHRoaXMubG9jYWxlU2VydmljZS5nZXRWYWx1ZSgncXVlcnlTb2x1dGlvbi5tYW5hZ2VEaWFsb2cucHJvcGVydHknKSwgZm9ybWF0dGVyOiB0aGlzLnByb3BlcnR5RmllbGRGb3JtYXR0ZXIsIGhhbGlnbjogJ2NlbnRlcicsIGFsaWduOiAnY2VudGVyJ30sXHJcbiAgICAgICAgICAgIHsgZmllbGQ6ICdpc0RlZmF1bHQnLCB3aWR0aDogNzAsIHRpdGxlOiB0aGlzLmxvY2FsZVNlcnZpY2UuZ2V0VmFsdWUoJ3F1ZXJ5U29sdXRpb24ubWFuYWdlRGlhbG9nLmRlZmF1bHQnKSwgdGVtcGxhdGU6IHRoaXMuY2hlY2tDZWxsLCBoYWxpZ246ICdjZW50ZXInLCBhbGlnbjogJ2NlbnRlcid9LFxyXG4gICAgICAgICAgICB7IHdpZHRoOiA3MCwgdGl0bGU6IHRoaXMubG9jYWxlU2VydmljZS5nZXRWYWx1ZSgncXVlcnlTb2x1dGlvbi5tYW5hZ2VEaWFsb2cub3BlcmF0aW9uJyksIHRlbXBsYXRlOiB0aGlzLm9wdENlbGwsIGhhbGlnbjogJ2NlbnRlcicsIGFsaWduOiAnY2VudGVyJ31cclxuICAgICAgICBdO1xyXG4gICAgICAgIHRoaXMudGl0bGUgPSB0aGlzLmxvY2FsZVNlcnZpY2UuZ2V0VmFsdWUoJ3F1ZXJ5U29sdXRpb24uY29udGFpbmVyLm1hbmFnZScpO1xyXG4gICAgfVxyXG5cclxuICAgIHNob3cocXVlcnlTb2x1dGlvbnM6IFF1ZXJ5U29sdXRpb25Wb1tdKSB7XHJcbiAgICAgICAgaWYocXVlcnlTb2x1dGlvbnMpe1xyXG4gICAgICAgICAgICB0aGlzLmxpc3REYXRhID0gdGhpcy5maW5kU29sdXRpb25zV2l0aG91dFN5cyhxdWVyeVNvbHV0aW9ucyk7XHJcbiAgICAgICAgICAgIHRoaXMucXVlcnlTb2x1dGlvbnMgPSBxdWVyeVNvbHV0aW9ucztcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5jaGVja2VkU29sdXRpb24gPSB0aGlzLnF1ZXJ5U29sdXRpb25zLmZpbmQodm8gPT4gdm8uaXNEZWZhdWx0KTtcclxuXHJcbiAgICAgICAgdGhpcy5kZWxldGVkUXVlcnlTb2x1dGlvbklkcyA9IFtdO1xyXG4gICAgICAgIC8vIHRoaXMuY2hlY2tlZFNvbHV0aW9uID0gdW5kZWZpbmVkO1xyXG4gICAgICAgIHRoaXMuZGlhbG9nLnNob3coKTtcclxuICAgIH1cclxuXHJcbiAgICBnZXRTb2x1dGlvblByb3BlcnR5KHZhbHVlOiBib29sZWFuKSB7XHJcbiAgICAgICAgcmV0dXJuIHZhbHVlID8gdGhpcy5sb2NhbGVTZXJ2aWNlLmdldFZhbHVlKFwicXVlcnlTb2x1dGlvbi5tYW5hZ2VEaWFsb2cuc3lzdGVtXCIpIDogdGhpcy5sb2NhbGVTZXJ2aWNlLmdldFZhbHVlKFwicXVlcnlTb2x1dGlvbi5tYW5hZ2VEaWFsb2cucGVyc29uYWxcIik7XHJcbiAgICB9XHJcblxyXG4gICAgcHJvcGVydHlGaWVsZEZvcm1hdHRlciA9ICh2YWx1ZSwgZGF0YSkgPT4ge1xyXG4gICAgICAgIGlmKGRhdGFbJ3R5cGUnXSA9PSAncHVibGljJykge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5sb2NhbGVTZXJ2aWNlLmdldFZhbHVlKFwiZXh0ZW5kUXVlcnlTb2x1dGlvbi5wdWJsaWMucHJvcGVydHlcIik7XHJcbiAgICAgICAgfSBlbHNlIGlmKGRhdGFbJ3R5cGUnXSA9PSAnb3JnJykge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5sb2NhbGVTZXJ2aWNlLmdldFZhbHVlKFwiZXh0ZW5kUXVlcnlTb2x1dGlvbi5vcmcucHJvcGVydHlcIik7XHJcbiAgICAgICAgfSBcclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMubG9jYWxlU2VydmljZS5nZXRWYWx1ZShcImV4dGVuZFF1ZXJ5U29sdXRpb24ucHJpdmF0ZS5wcm9wZXJ0eVwiKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZmluZFNvbHV0aW9uc1dpdGhvdXRTeXMocXVlcnlTb2x1dGlvbnM6IFF1ZXJ5U29sdXRpb25Wb1tdKTogUXVlcnlTb2x1dGlvblZvW117XHJcbiAgICAgICAgY29uc3QgcmVzdWx0OiBRdWVyeVNvbHV0aW9uVm9bXSA9IFtdO1xyXG4gICAgICAgIHF1ZXJ5U29sdXRpb25zLmZvckVhY2gocXMgPT4ge1xyXG4gICAgICAgICAgICBpZighcXMuaXNTeXN0ZW0pXHJcbiAgICAgICAgICAgICAgICByZXN1bHQucHVzaChxcyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH1cclxuXHJcbiAgICBkZWxlbHRlU29sdXRpb24oZGF0YUl0ZW06IFF1ZXJ5U29sdXRpb25Wbykge1xyXG4gICAgICAgIGlmKHRoaXMuYXV0aG9yaXR5RXJyb3IgJiYgKGRhdGFJdGVtLnR5cGUgPT0gJ3B1YmxpYycgfHwgZGF0YUl0ZW0udHlwZSA9PSAnb3JnJykpIHtcclxuICAgICAgICAgICAgdGhpcy5ub3RpZnkuY29uZmlnLnBvc2l0aW9uID0gJ3RvcC1jZW50ZXInO1xyXG4gICAgICAgICAgICB0aGlzLm5vdGlmeS53YXJuaW5nKDxOb3RpZnlPcHRpb25zPnsgdGl0bGU6ICcnLCBtc2c6IHRoaXMubG9jYWxlU2VydmljZS5nZXRWYWx1ZShcImV4dGVuZFF1ZXJ5U29sdXRpb24uYXV0aC5kZWxldGVFcnJvclwiKSwgdGltZW91dDogMTUwMCB9KTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmRlbGV0ZWRRdWVyeVNvbHV0aW9uSWRzLnB1c2goZGF0YUl0ZW0uaWQpO1xyXG4gICAgICAgIGlmICh0aGlzLmNoZWNrZWRTb2x1dGlvbiAmJiBkYXRhSXRlbS5pZCA9PSB0aGlzLmNoZWNrZWRTb2x1dGlvbi5pZCkge1xyXG4gICAgICAgICAgICB0aGlzLmNoZWNrZWRTb2x1dGlvbiA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8v5b2TY2hlY2tlZFNvbHV0aW9u5LiN5a2Y5Zyo77yM55u05o6l5Yig6ZmkXHJcbiAgICAgICAgZm9yKGxldCBpID0gMDsgaSA8IHRoaXMucXVlcnlTb2x1dGlvbnMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgaWYoZGF0YUl0ZW0uaWQgPT0gdGhpcy5xdWVyeVNvbHV0aW9uc1tpXS5pZCl7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnF1ZXJ5U29sdXRpb25zLnNwbGljZShpLCAxKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMubGlzdERhdGEgPSB0aGlzLmZpbmRTb2x1dGlvbnNXaXRob3V0U3lzKHRoaXMucXVlcnlTb2x1dGlvbnMpO1xyXG4gICAgfVxyXG5cclxuICAgIHNldERlZmF1bHQoY2hlY2tlZDogYm9vbGVhbiwgZGF0YUl0ZW06IFF1ZXJ5U29sdXRpb25Wbykge1xyXG4gICAgICAgIGlmIChjaGVja2VkKSB7Ly9pZiBjaGVja2Vk77yM6K6+572u5b2T5YmNdm/kuLrpu5jorqTvvIzlhbbku5borr7kuLrpnZ7pu5jorqRcclxuICAgICAgICAgICAgdGhpcy5jaGVja2VkU29sdXRpb24gPSBkYXRhSXRlbTtcclxuICAgICAgICAgICAgLy9rZXkgcG9pbnTvvIFcclxuICAgICAgICAgICAgLy8gdGhpcy5jdXJyZW50RGVmYXVsdFF1ZXJ5U29sdXRpb25JZCA9IGRhdGFJdGVtLmlkO1xyXG4gICAgICAgICAgICB0aGlzLnF1ZXJ5U29sdXRpb25zID0gdGhpcy5xdWVyeVNvbHV0aW9ucy5tYXAodm8gPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYodm8uaWQgPT0gZGF0YUl0ZW0uaWQpIHtcclxuICAgICAgICAgICAgICAgICAgICB2by5pc0RlZmF1bHQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB2by5pc0RlZmF1bHQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiB2bztcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Ugey8vaWYgdW5jaGVja2VkLCDorr7nva7lvZPliY12b+S4uumdnum7mOiupO+8jOWFtuS9mXZv5LiN5Y+YOyDmsqHmnIljaGVja2VkU29sdXRpb27ml7ZcclxuICAgICAgICAgICAgaWYgKGRhdGFJdGVtLmlkID09IHRoaXMuY2hlY2tlZFNvbHV0aW9uLmlkKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNoZWNrZWRTb2x1dGlvbiA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAvLyB0aGlzLmN1cnJlbnREZWZhdWx0UXVlcnlTb2x1dGlvbklkID0gJyc7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnF1ZXJ5U29sdXRpb25zID0gdGhpcy5xdWVyeVNvbHV0aW9ucy5tYXAodm8gPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKHZvLmlkID09IGRhdGFJdGVtLmlkKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdm8uaXNEZWZhdWx0ID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB2bztcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMubGlzdERhdGEgPSB0aGlzLmZpbmRTb2x1dGlvbnNXaXRob3V0U3lzKHRoaXMucXVlcnlTb2x1dGlvbnMpO1xyXG4gICAgICAgIHRoaXMubGlzdC5yZWZyZXNoKCk7XHJcbiAgICB9XHJcblxyXG4gICAgY2FuY2VsKCkge1xyXG4gICAgICAgIHRoaXMuZGlhbG9nLmNsb3NlKCk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uZmlybSgpIHtcclxuICAgICAgICBsZXQgb2JqID0gbmV3IE9iamVjdCgpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIG9ialsnZGVsZXRlZFF1ZXJ5U29sdXRpb25JZHMnXSA9IHRoaXMuZGVsZXRlZFF1ZXJ5U29sdXRpb25JZHM7XHJcbiAgICAgICAgb2JqWyduZXdEZWZhdWx0UXVlcnlTb2x1dGlvbiddID0gY2xvbmVEZWVwKHRoaXMuY2hlY2tlZFNvbHV0aW9uKTtcclxuICAgICAgICBvYmpbJ3VwZGF0ZWRRdWVyeVNvbHV0aW9uVm9zJ10gPSBjbG9uZURlZXAodGhpcy5xdWVyeVNvbHV0aW9ucyk7XHJcbiAgICAgICAgLy8gb2JqWydjdXJyZW50RGVmYXVsdFF1ZXJ5U29sdXRpb25JZCddID0gdGhpcy5jdXJyZW50RGVmYXVsdFF1ZXJ5U29sdXRpb25JZDtcclxuXHJcbiAgICAgICAgaWYodGhpcy5kZWxldGVkUXVlcnlTb2x1dGlvbklkcy5sZW5ndGggPiAwIHx8IHRoaXMuY2hlY2tlZFNvbHV0aW9uICYmIHRoaXMuY2hlY2tlZFNvbHV0aW9uLmlkKSB7XHJcbiAgICAgICAgICAgIG9ialsndmFsaWRhdG9yJ10gPSB0cnVlO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIG9ialsndmFsaWRhdG9yJ10gPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5jb25maXJtRW1pdHRlci5lbWl0KG9iaik7XHJcbiAgICAgICAgdGhpcy5kaWFsb2cuY2xvc2UoKTtcclxuICAgIH1cclxufVxyXG4iXX0=