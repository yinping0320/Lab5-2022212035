/**
 * @fileoverview added by tsickle
 * Generated from: lib/service/httpservice.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Injectable } from '@angular/core';
import { HttpClient, HttpHeaders } from '@angular/common/http';
import { QuerySolutionVoConvertor } from '@farris/component-querycondition';
import { BasePathService } from '@farris/rtf';
var HttpService = /** @class */ (function () {
    function HttpService(http) {
        this.http = http;
        this.histroyUrl = "/api/runtime/sys/v1.0/querysolution/previousQuery";
        this.url = '/api/runtime/sys/v1.0/querysolution';
        this.histroyUrl = BasePathService.convertPath(this.histroyUrl);
        this.url = BasePathService.convertPath(this.url);
    }
    /**
     * 新增查询方案
     * @param querySolution 查询方案实体
     */
    /**
     * 新增查询方案
     * @param {?} querySolution 查询方案实体
     * @param {?} sessionId
     * @return {?}
     */
    HttpService.prototype.create = /**
     * 新增查询方案
     * @param {?} querySolution 查询方案实体
     * @param {?} sessionId
     * @return {?}
     */
    function (querySolution, sessionId) {
        /** @type {?} */
        var headers = new HttpHeaders({
            'Content-Type': 'application/json',
            'sessionid': sessionId
        });
        /** @type {?} */
        var options = {
            headers: headers,
            sessionid: sessionId
        };
        /** @type {?} */
        var convertor = new QuerySolutionVoConvertor();
        /** @type {?} */
        var body = convertor.convertJObject(querySolution);
        return this.http.post(this.url, body, options);
    };
    /**
     * 根据表单ID查询当前表单当前登录用户的查询方案列表
     * @param formId 表单ID
     */
    /**
     * 根据表单ID查询当前表单当前登录用户的查询方案列表
     * @param {?} formId 表单ID
     * @param {?} sessionId
     * @return {?}
     */
    HttpService.prototype.query = /**
     * 根据表单ID查询当前表单当前登录用户的查询方案列表
     * @param {?} formId 表单ID
     * @param {?} sessionId
     * @return {?}
     */
    function (formId, sessionId) {
        /** @type {?} */
        var headers = new HttpHeaders({
            'Content-Type': 'application/json',
            'sessionid': sessionId
        });
        /** @type {?} */
        var options = {
            headers: headers,
        };
        /** @type {?} */
        var belongId = formId;
        // let url = `http://localhost:5100/api/dev/main/v1.0/querysolution/bybelongid/${belongId}`;
        /** @type {?} */
        var url = this.url + "/belongId/" + belongId;
        return this.http.get(url, options);
    };
    /**
     * 更新
     * @param querySolution 查询方案实体
     */
    /**
     * 更新
     * @param {?} querySolution 查询方案实体
     * @param {?} sessionId
     * @return {?}
     */
    HttpService.prototype.update = /**
     * 更新
     * @param {?} querySolution 查询方案实体
     * @param {?} sessionId
     * @return {?}
     */
    function (querySolution, sessionId) {
        /** @type {?} */
        var headers = new HttpHeaders({
            'Content-Type': 'application/json',
            'sessionid': sessionId
        });
        /** @type {?} */
        var options = {
            headers: headers
        };
        /** @type {?} */
        var convertor = new QuerySolutionVoConvertor();
        /** @type {?} */
        var body = convertor.convertJObject(querySolution);
        return this.http.put(this.url, body, options);
    };
    /**
     * 删除
     * @unused
     * @param idArray 删除的解决方案ID列表
     */
    // delete(idArray: Array<string>, sessionId: string) {
    //     if (!idArray || idArray.length <= 0) {
    //         return;
    //     }
    //     let headers = new HttpHeaders({
    //         'Content-Type': 'application/json',
    //         'sessionid': sessionId
    //     });
    //     const options = {
    //         headers: headers,
    //         sessionid: sessionId
    //     };
    //     let ids = '';
    //     idArray.forEach(id => {
    //         ids = ids + "#" + id;
    //     });
    //     let url = `/api/dev/main/v1.0/querysolution/${encodeURIComponent(ids)}`;
    //     return this.http.delete(url, options);
    // }
    /**
     * 批量更新
     * @param object : '{defaultId, belongId, deletedIds}'
     */
    /**
         * 删除
         * @unused
         * @param idArray 删除的解决方案ID列表
         */
    // delete(idArray: Array<string>, sessionId: string) {
    //     if (!idArray || idArray.length <= 0) {
    //         return;
    //     }
    //     let headers = new HttpHeaders({
    //         'Content-Type': 'application/json',
    //         'sessionid': sessionId
    //     });
    //     const options = {
    //         headers: headers,
    //         sessionid: sessionId
    //     };
    //     let ids = '';
    //     idArray.forEach(id => {
    //         ids = ids + "#" + id;
    //     });
    //     let url = `/api/dev/main/v1.0/querysolution/${encodeURIComponent(ids)}`;
    //     return this.http.delete(url, options);
    // }
    /**
     * 批量更新
     * @param {?} body
     * @param {?} sessionId
     * @return {?}
     */
    HttpService.prototype.batchUpdate = /**
         * 删除
         * @unused
         * @param idArray 删除的解决方案ID列表
         */
    // delete(idArray: Array<string>, sessionId: string) {
    //     if (!idArray || idArray.length <= 0) {
    //         return;
    //     }
    //     let headers = new HttpHeaders({
    //         'Content-Type': 'application/json',
    //         'sessionid': sessionId
    //     });
    //     const options = {
    //         headers: headers,
    //         sessionid: sessionId
    //     };
    //     let ids = '';
    //     idArray.forEach(id => {
    //         ids = ids + "#" + id;
    //     });
    //     let url = `/api/dev/main/v1.0/querysolution/${encodeURIComponent(ids)}`;
    //     return this.http.delete(url, options);
    // }
    /**
     * 批量更新
     * @param {?} body
     * @param {?} sessionId
     * @return {?}
     */
    function (body, sessionId) {
        /** @type {?} */
        var headers = new HttpHeaders({
            'Content-Type': 'application/json',
            'sessionid': sessionId
        });
        /** @type {?} */
        var options = {
            headers: headers,
            sessionid: sessionId
        };
        /** @type {?} */
        var url = this.url + "/batch";
        return this.http.put(url, body, options);
    };
    /**
     * 获取默认查询方案ID
     * @unused
     * @param formId
     */
    // getDefaultQuerySolution(formId: string, sessionId: string): Observable<any> {
    //     let headers = new HttpHeaders({
    //         'Content-Type': 'text/plain',
    //         'sessionid': sessionId
    //     });
    //     let belongId = formId;
    //     // let url = `http://localhost:5100/api/dev/main/v1.0/querysolution/defaultSolution/bybelongid/${belongId}`;
    //     let url = `/api/dev/main/v1.0/querysolution/defaultSolution/bybelongid/${belongId}`;
    //     return this.http.get(url, { headers: headers, responseType: 'text' });
    // }
    /**
        * 是否支持
        */
    /**
         * 获取默认查询方案ID
         * @unused
         * @param formId
         */
    // getDefaultQuerySolution(formId: string, sessionId: string): Observable<any> {
    //     let headers = new HttpHeaders({
    //         'Content-Type': 'text/plain',
    //         'sessionid': sessionId
    //     });
    //     let belongId = formId;
    //     // let url = `http://localhost:5100/api/dev/main/v1.0/querysolution/defaultSolution/bybelongid/${belongId}`;
    //     let url = `/api/dev/main/v1.0/querysolution/defaultSolution/bybelongid/${belongId}`;
    //     return this.http.get(url, { headers: headers, responseType: 'text' });
    // }
    /**
     * 是否支持
     * @return {?}
     */
    HttpService.prototype.supportLS = /**
         * 获取默认查询方案ID
         * @unused
         * @param formId
         */
    // getDefaultQuerySolution(formId: string, sessionId: string): Observable<any> {
    //     let headers = new HttpHeaders({
    //         'Content-Type': 'text/plain',
    //         'sessionid': sessionId
    //     });
    //     let belongId = formId;
    //     // let url = `http://localhost:5100/api/dev/main/v1.0/querysolution/defaultSolution/bybelongid/${belongId}`;
    //     let url = `/api/dev/main/v1.0/querysolution/defaultSolution/bybelongid/${belongId}`;
    //     return this.http.get(url, { headers: headers, responseType: 'text' });
    // }
    /**
     * 是否支持
     * @return {?}
     */
    function () {
        if (window.hasOwnProperty("localStorage")) {
            return true;
        }
        return false;
    };
    /**
     * 设置保存时候，属性从小写变成大写
     * @param key
     * @param value
     */
    /**
     * 设置保存时候，属性从小写变成大写
     * @param {?} key
     * @param {?} value
     * @return {?}
     */
    HttpService.prototype.setLS = /**
     * 设置保存时候，属性从小写变成大写
     * @param {?} key
     * @param {?} value
     * @return {?}
     */
    function (key, value) {
        /** @type {?} */
        var conditionsStr = '[]';
        if (value) {
            if (typeof value == 'string') {
                conditionsStr = value;
            }
            else {
                /** @type {?} */
                var convertor = new QuerySolutionVoConvertor();
                conditionsStr = JSON.stringify(convertor.formatConvertJObject(value));
            }
        }
        if (key && this.supportLS) {
            localStorage.setItem(key, conditionsStr);
        }
    };
    /**
     * 获取时，属性从大写变成小写
     * @param key
     */
    /**
     * 获取时，属性从大写变成小写
     * @param {?} key
     * @return {?}
     */
    HttpService.prototype.getLS = /**
     * 获取时，属性从大写变成小写
     * @param {?} key
     * @return {?}
     */
    function (key) {
        /** @type {?} */
        var result = new Array();
        if (key && this.supportLS) {
            /** @type {?} */
            var v = localStorage.getItem(key);
            if (v != undefined || v !== null) {
                result = JSON.parse(v);
            }
        }
        if (result.length > 0) {
            /** @type {?} */
            var convertor = new QuerySolutionVoConvertor();
            return convertor.formatFromJobject(result);
        }
        return result;
    };
    /**
     * 更新
     * @param querySolution 查询方案实体
     */
    /**
     * 更新
     * @param {?} querySolution 查询方案实体
     * @param {?} sessionId
     * @return {?}
     */
    HttpService.prototype.saveHistroy = /**
     * 更新
     * @param {?} querySolution 查询方案实体
     * @param {?} sessionId
     * @return {?}
     */
    function (querySolution, sessionId) {
        /** @type {?} */
        var headers = new HttpHeaders({
            "Content-Type": "application/json",
            sessionid: sessionId
        });
        /** @type {?} */
        var options = {
            headers: headers
        };
        /** @type {?} */
        var convertor = new QuerySolutionVoConvertor();
        /** @type {?} */
        var body = convertor.convertJObject(querySolution);
        return this.http.put(this.histroyUrl, body, options);
    };
    // 获取当前用户是否有权限配置公共类型筛选方案，包含全局公共、组织公共
    // 返回结果：（1）是否有权限新增、修改、删除公共类型筛选方案；（2）可为哪些组织设置组织公共筛选方案
    // 获取当前用户是否有权限配置公共类型筛选方案，包含全局公共、组织公共
    // 返回结果：（1）是否有权限新增、修改、删除公共类型筛选方案；（2）可为哪些组织设置组织公共筛选方案
    /**
     * @param {?} type
     * @param {?} sessionId
     * @return {?}
     */
    HttpService.prototype.getAuth = 
    // 获取当前用户是否有权限配置公共类型筛选方案，包含全局公共、组织公共
    // 返回结果：（1）是否有权限新增、修改、删除公共类型筛选方案；（2）可为哪些组织设置组织公共筛选方案
    /**
     * @param {?} type
     * @param {?} sessionId
     * @return {?}
     */
    function (type, sessionId) {
        /** @type {?} */
        var headers = new HttpHeaders({
            "Content-Type": "application/json",
            sessionid: sessionId
        });
        /** @type {?} */
        var options = {
            headers: headers
        };
        /** @type {?} */
        var url = this.url + "/componentType/" + type;
        return this.http.get(url, options);
    };
    HttpService.decorators = [
        { type: Injectable }
    ];
    /** @nocollapse */
    HttpService.ctorParameters = function () { return [
        { type: HttpClient }
    ]; };
    return HttpService;
}());
export { HttpService };
if (false) {
    /**
     * @type {?}
     * @private
     */
    HttpService.prototype.histroyUrl;
    /** @type {?} */
    HttpService.prototype.url;
    /**
     * @type {?}
     * @private
     */
    HttpService.prototype.http;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaHR0cHNlcnZpY2UuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZ3NwLWNtcC9xdWVyeXNvbHV0aW9uLyIsInNvdXJjZXMiOlsibGliL3NlcnZpY2UvaHR0cHNlcnZpY2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQzNDLE9BQU8sRUFBRSxVQUFVLEVBQUUsV0FBVyxFQUFFLE1BQU0sc0JBQXNCLENBQUM7QUFFL0QsT0FBTyxFQUFtQix3QkFBd0IsRUFBa0IsTUFBTSxrQ0FBa0MsQ0FBQztBQUM3RyxPQUFPLEVBQUMsZUFBZSxFQUFFLE1BQU0sYUFBYSxDQUFDO0FBQzdDO0lBR0kscUJBQW9CLElBQWdCO1FBQWhCLFNBQUksR0FBSixJQUFJLENBQVk7UUFJNUIsZUFBVSxHQUFXLG1EQUFtRCxDQUFDO1FBQ2pGLFFBQUcsR0FBVyxxQ0FBcUMsQ0FBQztRQUpoRCxJQUFJLENBQUMsVUFBVSxHQUFHLGVBQWUsQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFBO1FBQzlELElBQUksQ0FBQyxHQUFHLEdBQUcsZUFBZSxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUE7SUFDcEQsQ0FBQztJQUdEOzs7T0FHRzs7Ozs7OztJQUNILDRCQUFNOzs7Ozs7SUFBTixVQUFPLGFBQThCLEVBQUUsU0FBaUI7O1lBQ2hELE9BQU8sR0FBRyxJQUFJLFdBQVcsQ0FBQztZQUMxQixjQUFjLEVBQUUsa0JBQWtCO1lBQ2xDLFdBQVcsRUFBRSxTQUFTO1NBQ3pCLENBQUM7O1lBQ0ksT0FBTyxHQUFHO1lBQ1osT0FBTyxFQUFFLE9BQU87WUFDaEIsU0FBUyxFQUFFLFNBQVM7U0FDdkI7O1lBQ0csU0FBUyxHQUFHLElBQUksd0JBQXdCLEVBQUU7O1lBQzFDLElBQUksR0FBRyxTQUFTLENBQUMsY0FBYyxDQUFDLGFBQWEsQ0FBQztRQUNsRCxPQUFPLElBQUksQ0FB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OztZQUNJLE9BQU8sR0FBRztZQUNaLE9BQU8sRUFBRSxPQUFPO1NBQ25COztZQUNHLFNBQVMsR0FBRyxJQUFJLHdCQUF3QixFQUFFOztZQUMxQyxJQUFJLEdBQUcsU0FBUyxDQUFDLGNBQWMsQ0FBQyxhQUFhLENBQUM7UUFDbEQsT0FBTyxJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsVUFBVSxFQUFFLElBQUksRUFBRSxPQUFPLENBQUMsQ0FBQztJQUN6RCxDQUFDO0lBRUQsb0NBQW9DO0lBQ3BDLG9EQUFvRDs7Ozs7Ozs7SUFDcEQsNkJBQU87Ozs7Ozs7O0lBQVAsVUFBUSxJQUFZLEVBQUUsU0FBaUI7O1lBQy9CLE9BQU8sR0FBRyxJQUFJLFdBQVcsQ0FBQztZQUMxQixjQUFjLEVBQUUsa0JBQWtCO1lBQ2xDLFNBQVMsRUFBRSxTQUFTO1NBQ3ZCLENBQUM7O1lBQ0ksT0FBTyxHQUFHO1lBQ1osT0FBTyxFQUFFLE9BQU87U0FDbkI7O1lBQ0csR0FBRyxHQUFNLElBQUksQ0FBQyxHQUFHLHVCQUFrQixJQUFNO1FBQzdDLE9BQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsR0FBRyxFQUFFLE9BQU8sQ0FBQyxDQUFDO0lBQ3ZDLENBQUM7O2dCQXBNSixVQUFVOzs7O2dCQUpGLFVBQVU7O0lBeU1uQixrQkFBQztDQUFBLEFBck1ELElBcU1DO1NBcE1ZLFdBQVc7Ozs7OztJQU1wQixpQ0FBaUY7O0lBQ2pGLDBCQUFvRDs7Ozs7SUFMeEMsMkJBQXdCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSW5qZWN0YWJsZSB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBIdHRwQ2xpZW50LCBIdHRwSGVhZGVycyB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbi9odHRwJztcclxuaW1wb3J0IHsgT2JzZXJ2YWJsZSB9IGZyb20gJ3J4anMnO1xyXG5pbXBvcnQgeyBRdWVyeVNvbHV0aW9uVm8sIFF1ZXJ5U29sdXRpb25Wb0NvbnZlcnRvciwgUXVlcnlDb25kaXRpb24gfSBmcm9tICdAZmFycmlzL2NvbXBvbmVudC1xdWVyeWNvbmRpdGlvbic7XHJcbmltcG9ydCB7QmFzZVBhdGhTZXJ2aWNlIH0gZnJvbSAnQGZhcnJpcy9ydGYnO1xyXG5ASW5qZWN0YWJsZSgpXHJcbmV4cG9ydCBjbGFzcyBIdHRwU2VydmljZSB7XHJcblxyXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSBodHRwOiBIdHRwQ2xpZW50KSB7IFxyXG4gICAgICAgIHRoaXMuaGlzdHJveVVybCA9IEJhc2VQYXRoU2VydmljZS5jb252ZXJ0UGF0aCh0aGlzLmhpc3Ryb3lVcmwpXHJcbiAgICAgICAgdGhpcy51cmwgPSBCYXNlUGF0aFNlcnZpY2UuY29udmVydFBhdGgodGhpcy51cmwpXHJcbiAgICB9XHJcbiAgICBwcml2YXRlIGhpc3Ryb3lVcmw6IHN0cmluZyA9IFwiL2FwaS9ydW50aW1lL3N5cy92MS4wL3F1ZXJ5c29sdXRpb24vcHJldmlvdXNRdWVyeVwiO1xyXG4gICAgdXJsOiBzdHJpbmcgPSAnL2FwaS9ydW50aW1lL3N5cy92MS4wL3F1ZXJ5c29sdXRpb24nO1xyXG4gICAgLyoqXHJcbiAgICAgKiDmlrDlop7mn6Xor6LmlrnmoYhcclxuICAgICAqIEBwYXJhbSBxdWVyeVNvbHV0aW9uIOafpeivouaWueahiOWunuS9k1xyXG4gICAgICovXHJcbiAgICBjcmVhdGUocXVlcnlTb2x1dGlvbjogUXVlcnlTb2x1dGlvblZvLCBzZXNzaW9uSWQ6IHN0cmluZyk6IE9ic2VydmFibGU8YW55PiB7XHJcbiAgICAgICAgbGV0IGhlYWRlcnMgPSBuZXcgSHR0cEhlYWRlcnMoe1xyXG4gICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxyXG4gICAgICAgICAgICAnc2Vzc2lvbmlkJzogc2Vzc2lvbklkXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY29uc3Qgb3B0aW9ucyA9IHtcclxuICAgICAgICAgICAgaGVhZGVyczogaGVhZGVycyxcclxuICAgICAgICAgICAgc2Vzc2lvbmlkOiBzZXNzaW9uSWRcclxuICAgICAgICB9O1xyXG4gICAgICAgIGxldCBjb252ZXJ0b3IgPSBuZXcgUXVlcnlTb2x1dGlvblZvQ29udmVydG9yKCk7XHJcbiAgICAgICAgbGV0IGJvZHkgPSBjb252ZXJ0b3IuY29udmVydEpPYmplY3QocXVlcnlTb2x1dGlvbik7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaHR0cC5wb3N0KHRoaXMudXJsLCBib2R5LCBvcHRpb25zKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOagueaNruihqOWNlUlE5p+l6K+i5b2T5YmN6KGo5Y2V5b2T5YmN55m75b2V55So5oi355qE5p+l6K+i5pa55qGI5YiX6KGoXHJcbiAgICAgKiBAcGFyYW0gZm9ybUlkIOihqOWNlUlEXHJcbiAgICAgKi9cclxuICAgIHF1ZXJ5KGZvcm1JZDogc3RyaW5nLCBzZXNzaW9uSWQ6IHN0cmluZyk6IE9ic2VydmFibGU8YW55PiB7XHJcbiAgICAgICAgbGV0IGhlYWRlcnMgPSBuZXcgSHR0cEhlYWRlcnMoe1xyXG4gICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxyXG4gICAgICAgICAgICAnc2Vzc2lvbmlkJzogc2Vzc2lvbklkXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY29uc3Qgb3B0aW9ucyA9IHtcclxuICAgICAgICAgICAgaGVhZGVyczogaGVhZGVycyxcclxuICAgICAgICB9O1xyXG4gICAgICAgIGxldCBiZWxvbmdJZCA9IGZvcm1JZDtcclxuICAgICAgICAvLyBsZXQgdXJsID0gYGh0dHA6Ly9sb2NhbGhvc3Q6NTEwMC9hcGkvZGV2L21haW4vdjEuMC9xdWVyeXNvbHV0aW9uL2J5YmVsb25naWQvJHtiZWxvbmdJZH1gO1xyXG4gICAgICAgIGxldCB1cmwgPSBgJHt0aGlzLnVybH0vYmVsb25nSWQvJHtiZWxvbmdJZH1gO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmh0dHAuZ2V0KHVybCwgb3B0aW9ucyk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDmm7TmlrBcclxuICAgICAqIEBwYXJhbSBxdWVyeVNvbHV0aW9uIOafpeivouaWueahiOWunuS9k1xyXG4gICAgICovXHJcbiAgICB1cGRhdGUocXVlcnlTb2x1dGlvbjogUXVlcnlTb2x1dGlvblZvLCBzZXNzaW9uSWQ6IHN0cmluZykge1xyXG4gICAgICAgIGxldCBoZWFkZXJzID0gbmV3IEh0dHBIZWFkZXJzKHtcclxuICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcclxuICAgICAgICAgICAgJ3Nlc3Npb25pZCc6IHNlc3Npb25JZFxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGNvbnN0IG9wdGlvbnMgPSB7XHJcbiAgICAgICAgICAgIGhlYWRlcnM6IGhlYWRlcnNcclxuICAgICAgICB9O1xyXG4gICAgICAgIGxldCBjb252ZXJ0b3IgPSBuZXcgUXVlcnlTb2x1dGlvblZvQ29udmVydG9yKCk7XHJcbiAgICAgICAgbGV0IGJvZHkgPSBjb252ZXJ0b3IuY29udmVydEpPYmplY3QocXVlcnlTb2x1dGlvbik7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaHR0cC5wdXQodGhpcy51cmwsIGJvZHksIG9wdGlvbnMpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5Yig6ZmkXHJcbiAgICAgKiBAdW51c2VkXHJcbiAgICAgKiBAcGFyYW0gaWRBcnJheSDliKDpmaTnmoTop6PlhrPmlrnmoYhJROWIl+ihqFxyXG4gICAgICovXHJcbiAgICAvLyBkZWxldGUoaWRBcnJheTogQXJyYXk8c3RyaW5nPiwgc2Vzc2lvbklkOiBzdHJpbmcpIHtcclxuICAgIC8vICAgICBpZiAoIWlkQXJyYXkgfHwgaWRBcnJheS5sZW5ndGggPD0gMCkge1xyXG4gICAgLy8gICAgICAgICByZXR1cm47XHJcbiAgICAvLyAgICAgfVxyXG4gICAgLy8gICAgIGxldCBoZWFkZXJzID0gbmV3IEh0dHBIZWFkZXJzKHtcclxuICAgIC8vICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcclxuICAgIC8vICAgICAgICAgJ3Nlc3Npb25pZCc6IHNlc3Npb25JZFxyXG4gICAgLy8gICAgIH0pO1xyXG4gICAgLy8gICAgIGNvbnN0IG9wdGlvbnMgPSB7XHJcbiAgICAvLyAgICAgICAgIGhlYWRlcnM6IGhlYWRlcnMsXHJcbiAgICAvLyAgICAgICAgIHNlc3Npb25pZDogc2Vzc2lvbklkXHJcbiAgICAvLyAgICAgfTtcclxuICAgIC8vICAgICBsZXQgaWRzID0gJyc7XHJcbiAgICAvLyAgICAgaWRBcnJheS5mb3JFYWNoKGlkID0+IHtcclxuICAgIC8vICAgICAgICAgaWRzID0gaWRzICsgXCIjXCIgKyBpZDtcclxuICAgIC8vICAgICB9KTtcclxuICAgIC8vICAgICBsZXQgdXJsID0gYC9hcGkvZGV2L21haW4vdjEuMC9xdWVyeXNvbHV0aW9uLyR7ZW5jb2RlVVJJQ29tcG9uZW50KGlkcyl9YDtcclxuICAgIC8vICAgICByZXR1cm4gdGhpcy5odHRwLmRlbGV0ZSh1cmwsIG9wdGlvbnMpO1xyXG4gICAgLy8gfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5om56YeP5pu05pawXHJcbiAgICAgKiBAcGFyYW0gb2JqZWN0IDogJ3tkZWZhdWx0SWQsIGJlbG9uZ0lkLCBkZWxldGVkSWRzfSdcclxuICAgICAqL1xyXG4gICAgYmF0Y2hVcGRhdGUoYm9keTogYW55LCBzZXNzaW9uSWQ6IHN0cmluZyk6IE9ic2VydmFibGU8YW55PiB7XHJcbiAgICAgICAgbGV0IGhlYWRlcnMgPSBuZXcgSHR0cEhlYWRlcnMoe1xyXG4gICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxyXG4gICAgICAgICAgICAnc2Vzc2lvbmlkJzogc2Vzc2lvbklkXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY29uc3Qgb3B0aW9ucyA9IHtcclxuICAgICAgICAgICAgaGVhZGVyczogaGVhZGVycyxcclxuICAgICAgICAgICAgc2Vzc2lvbmlkOiBzZXNzaW9uSWRcclxuICAgICAgICB9O1xyXG4gICAgICAgIGxldCB1cmwgPSBgJHt0aGlzLnVybH0vYmF0Y2hgO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmh0dHAucHV0KHVybCwgYm9keSwgb3B0aW9ucyk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDojrflj5bpu5jorqTmn6Xor6LmlrnmoYhJRFxyXG4gICAgICogQHVudXNlZFxyXG4gICAgICogQHBhcmFtIGZvcm1JZFxyXG4gICAgICovXHJcbiAgICAvLyBnZXREZWZhdWx0UXVlcnlTb2x1dGlvbihmb3JtSWQ6IHN0cmluZywgc2Vzc2lvbklkOiBzdHJpbmcpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgLy8gICAgIGxldCBoZWFkZXJzID0gbmV3IEh0dHBIZWFkZXJzKHtcclxuICAgIC8vICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICd0ZXh0L3BsYWluJyxcclxuICAgIC8vICAgICAgICAgJ3Nlc3Npb25pZCc6IHNlc3Npb25JZFxyXG4gICAgLy8gICAgIH0pO1xyXG4gICAgLy8gICAgIGxldCBiZWxvbmdJZCA9IGZvcm1JZDtcclxuICAgIC8vICAgICAvLyBsZXQgdXJsID0gYGh0dHA6Ly9sb2NhbGhvc3Q6NTEwMC9hcGkvZGV2L21haW4vdjEuMC9xdWVyeXNvbHV0aW9uL2RlZmF1bHRTb2x1dGlvbi9ieWJlbG9uZ2lkLyR7YmVsb25nSWR9YDtcclxuICAgIC8vICAgICBsZXQgdXJsID0gYC9hcGkvZGV2L21haW4vdjEuMC9xdWVyeXNvbHV0aW9uL2RlZmF1bHRTb2x1dGlvbi9ieWJlbG9uZ2lkLyR7YmVsb25nSWR9YDtcclxuICAgIC8vICAgICByZXR1cm4gdGhpcy5odHRwLmdldCh1cmwsIHsgaGVhZGVyczogaGVhZGVycywgcmVzcG9uc2VUeXBlOiAndGV4dCcgfSk7XHJcbiAgICAvLyB9XHJcbiAgICAvKipcclxuICAgICAgICAqIOaYr+WQpuaUr+aMgVxyXG4gICAgICAgICovXHJcbiAgICBzdXBwb3J0TFMoKSB7XHJcbiAgICAgICAgaWYod2luZG93Lmhhc093blByb3BlcnR5KFwibG9jYWxTdG9yYWdlXCIpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIOiuvue9ruS/neWtmOaXtuWAme+8jOWxnuaAp+S7juWwj+WGmeWPmOaIkOWkp+WGmVxyXG4gICAgICogQHBhcmFtIGtleSBcclxuICAgICAqIEBwYXJhbSB2YWx1ZSBcclxuICAgICAqL1xyXG4gICAgc2V0TFMoa2V5LCB2YWx1ZTogYW55KSB7XHJcbiAgICAgICAgbGV0IGNvbmRpdGlvbnNTdHIgPSAnW10nO1xyXG4gICAgICAgIGlmKHZhbHVlKSB7XHJcbiAgICAgICAgICAgIGlmKCB0eXBlb2YgdmFsdWUgPT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgICAgICAgIGNvbmRpdGlvbnNTdHIgPSB2YWx1ZTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGNvbnZlcnRvciA9IG5ldyBRdWVyeVNvbHV0aW9uVm9Db252ZXJ0b3IoKTtcclxuICAgICAgICAgICAgICAgIGNvbmRpdGlvbnNTdHIgPSBKU09OLnN0cmluZ2lmeShjb252ZXJ0b3IuZm9ybWF0Q29udmVydEpPYmplY3QodmFsdWUpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgIFxyXG4gICAgICAgIH1cclxuICAgICAgICBpZihrZXkgJiYgdGhpcy5zdXBwb3J0TFMpIHtcclxuICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oa2V5LCBjb25kaXRpb25zU3RyKTtcclxuICAgICAgICB9IFxyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiDojrflj5bml7bvvIzlsZ7mgKfku47lpKflhpnlj5jmiJDlsI/lhplcclxuICAgICAqIEBwYXJhbSBrZXkgXHJcbiAgICAgKi9cclxuICAgIGdldExTKGtleSk6IEFycmF5PFF1ZXJ5Q29uZGl0aW9uPiB7XHJcbiAgICAgICAgbGV0IHJlc3VsdCA9IG5ldyBBcnJheTxRdWVyeUNvbmRpdGlvbj4oKTtcclxuICAgICAgICBpZihrZXkgJiYgdGhpcy5zdXBwb3J0TFMpIHtcclxuICAgICAgICAgICAgdmFyIHYgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShrZXkpO1xyXG4gICAgICAgICAgICBpZiAodiAhPSB1bmRlZmluZWQgfHwgdiAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gSlNPTi5wYXJzZSh2KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZihyZXN1bHQubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICBjb25zdCBjb252ZXJ0b3IgPSBuZXcgUXVlcnlTb2x1dGlvblZvQ29udmVydG9yKCk7XHJcbiAgICAgICAgICAgIHJldHVybiBjb252ZXJ0b3IuZm9ybWF0RnJvbUpvYmplY3QocmVzdWx0KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOabtOaWsFxyXG4gICAgICogQHBhcmFtIHF1ZXJ5U29sdXRpb24g5p+l6K+i5pa55qGI5a6e5L2TXHJcbiAgICAgKi9cclxuICAgIHNhdmVIaXN0cm95KHF1ZXJ5U29sdXRpb246IFF1ZXJ5U29sdXRpb25Wbywgc2Vzc2lvbklkOiBzdHJpbmcpIHtcclxuICAgICAgICBsZXQgaGVhZGVycyA9IG5ldyBIdHRwSGVhZGVycyh7XHJcbiAgICAgICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG4gICAgICAgICAgICBzZXNzaW9uaWQ6IHNlc3Npb25JZFxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGNvbnN0IG9wdGlvbnMgPSB7XHJcbiAgICAgICAgICAgIGhlYWRlcnM6IGhlYWRlcnNcclxuICAgICAgICB9O1xyXG4gICAgICAgIGxldCBjb252ZXJ0b3IgPSBuZXcgUXVlcnlTb2x1dGlvblZvQ29udmVydG9yKCk7XHJcbiAgICAgICAgbGV0IGJvZHkgPSBjb252ZXJ0b3IuY29udmVydEpPYmplY3QocXVlcnlTb2x1dGlvbik7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaHR0cC5wdXQodGhpcy5oaXN0cm95VXJsLCBib2R5LCBvcHRpb25zKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyDojrflj5blvZPliY3nlKjmiLfmmK/lkKbmnInmnYPpmZDphY3nva7lhazlhbHnsbvlnovnrZvpgInmlrnmoYjvvIzljIXlkKvlhajlsYDlhazlhbHjgIHnu4Tnu4flhazlhbFcclxuICAgIC8vIOi/lOWbnue7k+aenO+8mu+8iDHvvInmmK/lkKbmnInmnYPpmZDmlrDlop7jgIHkv67mlLnjgIHliKDpmaTlhazlhbHnsbvlnovnrZvpgInmlrnmoYjvvJvvvIgy77yJ5Y+v5Li65ZOq5Lqb57uE57uH6K6+572u57uE57uH5YWs5YWx562b6YCJ5pa55qGIXHJcbiAgICBnZXRBdXRoKHR5cGU6IHN0cmluZywgc2Vzc2lvbklkOiBzdHJpbmcpIHtcclxuICAgICAgICBsZXQgaGVhZGVycyA9IG5ldyBIdHRwSGVhZGVycyh7XHJcbiAgICAgICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG4gICAgICAgICAgICBzZXNzaW9uaWQ6IHNlc3Npb25JZFxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGNvbnN0IG9wdGlvbnMgPSB7XHJcbiAgICAgICAgICAgIGhlYWRlcnM6IGhlYWRlcnNcclxuICAgICAgICB9O1xyXG4gICAgICAgIGxldCB1cmwgPSBgJHt0aGlzLnVybH0vY29tcG9uZW50VHlwZS8ke3R5cGV9YDtcclxuICAgICAgICByZXR1cm4gdGhpcy5odHRwLmdldCh1cmwsIG9wdGlvbnMpO1xyXG4gICAgfVxyXG59XHJcbiJdfQ==