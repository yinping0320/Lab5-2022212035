/**
 * @fileoverview added by tsickle
 * Generated from: lib/solutionmanager/solutionmanager.component.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, ViewChild, TemplateRef, Output, EventEmitter } from '@angular/core';
import { FormBuilder } from '@angular/forms';
import { EditService } from '../service/edit.service';
import { NotifyService } from '@farris/ui-notify';
import { LocaleService } from '@farris/ui-locale';
import { DialogComponent } from '@farris/ui-dialog';
import { DatagridComponent } from '@farris/ui-datagrid';
import { cloneDeep } from 'lodash-es';
var SolutionManangerComponent = /** @class */ (function () {
    function SolutionManangerComponent(formBuilder, editService, notify, localeService) {
        var _this = this;
        this.formBuilder = formBuilder;
        this.editService = editService;
        this.notify = notify;
        this.localeService = localeService;
        this.cancelEmitter = new EventEmitter();
        this.confirmEmitter = new EventEmitter();
        // @Input()
        // currentDefaultQuerySolutionId: string;
        // @Input()
        this.querySolutions = new Array();
        this.deletedQuerySolutionIds = new Array();
        this.authorityError = false;
        this.propertyFieldFormatter = (/**
         * @param {?} value
         * @param {?} data
         * @return {?}
         */
        function (value, data) {
            if (data['type'] == 'public') {
                return _this.localeService.getValue("extendQuerySolution.public.property");
            }
            else if (data['type'] == 'org') {
                return _this.localeService.getValue("extendQuerySolution.org.property");
            }
            else {
                return _this.localeService.getValue("extendQuerySolution.private.property");
            }
        });
    }
    /**
     * @return {?}
     */
    SolutionManangerComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        this.columns = [
            { field: 'code', width: 272, title: this.localeService.getValue('querySolution.manageDialog.name') },
            { field: 'property', width: 110, title: this.localeService.getValue('querySolution.manageDialog.property'), formatter: this.propertyFieldFormatter, halign: 'center', align: 'center' },
            { field: 'isDefault', width: 70, title: this.localeService.getValue('querySolution.manageDialog.default'), template: this.checkCell, halign: 'center', align: 'center' },
            { width: 70, title: this.localeService.getValue('querySolution.manageDialog.operation'), template: this.optCell, halign: 'center', align: 'center' }
        ];
        this.title = this.localeService.getValue('querySolution.container.manage');
    };
    /**
     * @param {?} querySolutions
     * @return {?}
     */
    SolutionManangerComponent.prototype.show = /**
     * @param {?} querySolutions
     * @return {?}
     */
    function (querySolutions) {
        if (querySolutions) {
            this.listData = this.findSolutionsWithoutSys(querySolutions);
            this.querySolutions = querySolutions;
        }
        this.checkedSolution = this.querySolutions.find((/**
         * @param {?} vo
         * @return {?}
         */
        function (vo) { return vo.isDefault; }));
        this.deletedQuerySolutionIds = [];
        // this.checkedSolution = undefined;
        this.dialog.show();
    };
    /**
     * @param {?} value
     * @return {?}
     */
    SolutionManangerComponent.prototype.getSolutionProperty = /**
     * @param {?} value
     * @return {?}
     */
    function (value) {
        return value ? this.localeService.getValue("querySolution.manageDialog.system") : this.localeService.getValue("querySolution.manageDialog.personal");
    };
    /**
     * @param {?} querySolutions
     * @return {?}
     */
    SolutionManangerComponent.prototype.findSolutionsWithoutSys = /**
     * @param {?} querySolutions
     * @return {?}
     */
    function (querySolutions) {
        /** @type {?} */
        var result = [];
        querySolutions.forEach((/**
         * @param {?} qs
         * @return {?}
         */
        function (qs) {
            if (!qs.isSystem)
                result.push(qs);
        }));
        return result;
    };
    /**
     * @param {?} dataItem
     * @return {?}
     */
    SolutionManangerComponent.prototype.delelteSolution = /**
     * @param {?} dataItem
     * @return {?}
     */
    function (dataItem) {
        if (this.authorityError && (dataItem.type == 'public' || dataItem.type == 'org')) {
            this.notify.config.position = 'top-center';
            this.notify.warning((/** @type {?} */ ({ title: '', msg: this.localeService.getValue("extendQuerySolution.auth.deleteError"), timeout: 1500 })));
            return;
        }
        this.deletedQuerySolutionIds.push(dataItem.id);
        if (this.checkedSolution && dataItem.id == this.checkedSolution.id) {
            this.checkedSolution = null;
        }
        //当checkedSolution不存在，直接删除
        for (var i = 0; i < this.querySolutions.length; i++) {
            if (dataItem.id == this.querySolutions[i].id) {
                this.querySolutions.splice(i, 1);
                break;
            }
        }
        this.listData = this.findSolutionsWithoutSys(this.querySolutions);
    };
    /**
     * @param {?} checked
     * @param {?} dataItem
     * @return {?}
     */
    SolutionManangerComponent.prototype.setDefault = /**
     * @param {?} checked
     * @param {?} dataItem
     * @return {?}
     */
    function (checked, dataItem) {
        if (checked) { //if checked，设置当前vo为默认，其他设为非默认
            this.checkedSolution = dataItem;
            //key point！
            // this.currentDefaultQuerySolutionId = dataItem.id;
            this.querySolutions = this.querySolutions.map((/**
             * @param {?} vo
             * @return {?}
             */
            function (vo) {
                if (vo.id == dataItem.id) {
                    vo.isDefault = true;
                }
                else {
                    vo.isDefault = false;
                }
                return vo;
            }));
        }
        else { //if unchecked, 设置当前vo为非默认，其余vo不变; 没有checkedSolution时
            if (dataItem.id == this.checkedSolution.id) {
                this.checkedSolution = null;
                // this.currentDefaultQuerySolutionId = '';
                this.querySolutions = this.querySolutions.map((/**
                 * @param {?} vo
                 * @return {?}
                 */
                function (vo) {
                    if (vo.id == dataItem.id) {
                        vo.isDefault = false;
                    }
                    return vo;
                }));
            }
        }
        this.listData = this.findSolutionsWithoutSys(this.querySolutions);
        this.list.refresh();
    };
    /**
     * @return {?}
     */
    SolutionManangerComponent.prototype.cancel = /**
     * @return {?}
     */
    function () {
        this.dialog.close();
    };
    /**
     * @return {?}
     */
    SolutionManangerComponent.prototype.confirm = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var obj = new Object();
        obj['deletedQuerySolutionIds'] = this.deletedQuerySolutionIds;
        obj['newDefaultQuerySolution'] = cloneDeep(this.checkedSolution);
        obj['updatedQuerySolutionVos'] = cloneDeep(this.querySolutions);
        // obj['currentDefaultQuerySolutionId'] = this.currentDefaultQuerySolutionId;
        if (this.deletedQuerySolutionIds.length > 0 || this.checkedSolution && this.checkedSolution.id) {
            obj['validator'] = true;
        }
        else {
            obj['validator'] = false;
        }
        this.confirmEmitter.emit(obj);
        this.dialog.close();
    };
    SolutionManangerComponent.decorators = [
        { type: Component, args: [{
                    selector: 'app-solutionmanager',
                    template: "<farris-dialog #dialog [buttons]=\"manangerbuttonRef\" [width]=\"550\" [height]=\"570\" [title]=\"title\">\r\n    <div class=\"solutionmanager-inner\">\r\n        <farris-datagrid #list [columns]=\"columns\" [data]=\"listData\" [pagination]=\"false\" [fit]=\"true\"></farris-datagrid>\r\n    </div>\r\n    <ng-template #optCell let-ctx>\r\n        <span class=\"f-icon f-icon-yxs_delete solutionmanager-grid-delete\" (click)=\"delelteSolution(ctx.rowData)\"></span>\r\n     </ng-template>\r\n     <ng-template #checkCell let-ctx>\r\n        <div class=\"custom-control custom-radio f-checkradio-single\" style=\"padding-top: 3px;\">\r\n            <input class=\"custom-control-input\" id=\"radio-{{ctx.rowData.id}}\" type=\"radio\"\r\n                [disabled]=\"ctx.rowData.type == 'public' || ctx.rowData.type == 'org'\"\r\n                (click)=\"setDefault($event.target.checked, ctx.rowData)\" [checked]=\"ctx.rowData.isDefault\"/>\r\n            <label class=\"custom-control-label\" for=\"radio-{{ctx.rowData.id}}\"></label>\r\n        </div>\r\n     </ng-template>\r\n</farris-dialog>\r\n<ng-template #manangerbuttonRef>\r\n    <button class=\"btn btn-primary\" (click)=\"confirm()\">{{'querySolution.manageDialog.confirm' | locale}}</button>\r\n    <button class=\"btn btn-secondary\" (click)=\"cancel()\">{{'querySolution.manageDialog.cancel' | locale}}</button>\r\n</ng-template>",
                    providers: [EditService],
                    styles: [""]
                }] }
    ];
    /** @nocollapse */
    SolutionManangerComponent.ctorParameters = function () { return [
        { type: FormBuilder },
        { type: EditService },
        { type: NotifyService },
        { type: LocaleService }
    ]; };
    SolutionManangerComponent.propDecorators = {
        cancelEmitter: [{ type: Output }],
        confirmEmitter: [{ type: Output }],
        dialog: [{ type: ViewChild, args: ['dialog',] }],
        optCell: [{ type: ViewChild, args: ['optCell',] }],
        checkCell: [{ type: ViewChild, args: ['checkCell',] }],
        list: [{ type: ViewChild, args: ['list',] }]
    };
    return SolutionManangerComponent;
}());
export { SolutionManangerComponent };
if (false) {
    /** @type {?} */
    SolutionManangerComponent.prototype.cancelEmitter;
    /** @type {?} */
    SolutionManangerComponent.prototype.confirmEmitter;
    /** @type {?} */
    SolutionManangerComponent.prototype.querySolutions;
    /** @type {?} */
    SolutionManangerComponent.prototype.deletedQuerySolutionIds;
    /** @type {?} */
    SolutionManangerComponent.prototype.checkedSolution;
    /** @type {?} */
    SolutionManangerComponent.prototype.listData;
    /** @type {?} */
    SolutionManangerComponent.prototype.dialog;
    /** @type {?} */
    SolutionManangerComponent.prototype.optCell;
    /** @type {?} */
    SolutionManangerComponent.prototype.checkCell;
    /** @type {?} */
    SolutionManangerComponent.prototype.list;
    /** @type {?} */
    SolutionManangerComponent.prototype.columns;
    /** @type {?} */
    SolutionManangerComponent.prototype.title;
    /** @type {?} */
    SolutionManangerComponent.prototype.authorityError;
    /** @type {?} */
    SolutionManangerComponent.prototype.propertyFieldFormatter;
    /**
     * @type {?}
     * @private
     */
    SolutionManangerComponent.prototype.formBuilder;
    /**
     * @type {?}
     * @private
     */
    SolutionManangerComponent.prototype.editService;
    /**
     * @type {?}
     * @private
     */
    SolutionManangerComponent.prototype.notify;
    /**
     * @type {?}
     * @private
     */
    SolutionManangerComponent.prototype.localeService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic29sdXRpb25tYW5hZ2VyLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0Bnc3AtY21wL3F1ZXJ5c29sdXRpb24vIiwic291cmNlcyI6WyJsaWIvc29sdXRpb25tYW5hZ2VyL3NvbHV0aW9ubWFuYWdlci5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFVLFNBQVMsRUFBRSxXQUFXLEVBQUUsTUFBTSxFQUFFLFlBQVksRUFBUSxNQUFNLGVBQWUsQ0FBQztBQUN0RyxPQUFPLEVBQWEsV0FBVyxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFDeEQsT0FBTyxFQUFFLFdBQVcsRUFBRSxNQUFNLHlCQUF5QixDQUFDO0FBQ3RELE9BQU8sRUFBRSxhQUFhLEVBQWlCLE1BQU0sbUJBQW1CLENBQUM7QUFFakUsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLG1CQUFtQixDQUFDO0FBQ2xELE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQztBQUNwRCxPQUFPLEVBQUUsaUJBQWlCLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUN4RCxPQUFPLEVBQUUsU0FBUyxFQUFFLE1BQU0sV0FBVyxDQUFDO0FBQ3RDO0lBNkJJLG1DQUFvQixXQUF3QixFQUFVLFdBQXdCLEVBQVUsTUFBcUIsRUFBVSxhQUE0QjtRQUFuSixpQkFBd0o7UUFBcEksZ0JBQVcsR0FBWCxXQUFXLENBQWE7UUFBVSxnQkFBVyxHQUFYLFdBQVcsQ0FBYTtRQUFVLFdBQU0sR0FBTixNQUFNLENBQWU7UUFBVSxrQkFBYSxHQUFiLGFBQWEsQ0FBZTtRQXJCekksa0JBQWEsR0FBc0IsSUFBSSxZQUFZLEVBQU8sQ0FBQztRQUMzRCxtQkFBYyxHQUFzQixJQUFJLFlBQVksRUFBTyxDQUFDOzs7O1FBS3RFLG1CQUFjLEdBQTJCLElBQUksS0FBSyxFQUFtQixDQUFDO1FBRXRFLDRCQUF1QixHQUFrQixJQUFJLEtBQUssRUFBVSxDQUFD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QUFNO3lCQVdOLFNBQVMsU0FBQyxRQUFROzBCQUVsQixTQUFTLFNBQUMsU0FBUzs0QkFDbkIsU0FBUyxTQUFDLFdBQVc7dUJBQ3JCLFNBQVMsU0FBQyxNQUFNOztJQTZIckIsZ0NBQUM7Q0FBQSxBQXJKRCxJQXFKQztTQS9JWSx5QkFBeUI7OztJQUVsQyxrREFBcUU7O0lBQ3JFLG1EQUFzRTs7SUFLdEUsbURBQXNFOztJQUV0RSw0REFBNkQ7O0lBQzdELG9EQUFpQzs7SUFDakMsNkNBQTRCOztJQUU1QiwyQ0FBNkM7O0lBRTdDLDRDQUFnRDs7SUFDaEQsOENBQW9EOztJQUNwRCx5Q0FBMkM7O0lBQzNDLDRDQUFvQjs7SUFDcEIsMENBQWM7O0lBQ2QsbURBQXVCOztJQWdDdkIsMkRBU0M7Ozs7O0lBdkNXLGdEQUFnQzs7Ozs7SUFBRSxnREFBZ0M7Ozs7O0lBQUUsMkNBQTZCOzs7OztJQUFFLGtEQUFvQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCwgT25Jbml0LCBWaWV3Q2hpbGQsIFRlbXBsYXRlUmVmLCBPdXRwdXQsIEV2ZW50RW1pdHRlciwgSW5wdXR9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBGb3JtR3JvdXAsIEZvcm1CdWlsZGVyIH0gZnJvbSAnQGFuZ3VsYXIvZm9ybXMnO1xyXG5pbXBvcnQgeyBFZGl0U2VydmljZSB9IGZyb20gJy4uL3NlcnZpY2UvZWRpdC5zZXJ2aWNlJztcclxuaW1wb3J0IHsgTm90aWZ5U2VydmljZSwgTm90aWZ5T3B0aW9ucyB9IGZyb20gJ0BmYXJyaXMvdWktbm90aWZ5JztcclxuaW1wb3J0IHsgUXVlcnlTb2x1dGlvblZvIH0gZnJvbSAnQGZhcnJpcy9jb21wb25lbnQtcXVlcnljb25kaXRpb24nO1xyXG5pbXBvcnQgeyBMb2NhbGVTZXJ2aWNlIH0gZnJvbSAnQGZhcnJpcy91aS1sb2NhbGUnO1xyXG5pbXBvcnQgeyBEaWFsb2dDb21wb25lbnQgfSBmcm9tICdAZmFycmlzL3VpLWRpYWxvZyc7XHJcbmltcG9ydCB7IERhdGFncmlkQ29tcG9uZW50IH0gZnJvbSAnQGZhcnJpcy91aS1kYXRhZ3JpZCc7XHJcbmltcG9ydCB7IGNsb25lRGVlcCB9IGZyb20gJ2xvZGFzaC1lcyc7XHJcbkBDb21wb25lbnQoe1xyXG4gICAgc2VsZWN0b3I6ICdhcHAtc29sdXRpb25tYW5hZ2VyJyxcclxuICAgIHRlbXBsYXRlVXJsOiAnLi9zb2x1dGlvbm1hbmFnZXIuY29tcG9uZW50Lmh0bWwnLFxyXG4gICAgc3R5bGVVcmxzOiBbJy4vc29sdXRpb25tYW5hZ2VyLmNvbXBvbmVudC5jc3MnXSxcclxuICAgIHByb3ZpZGVyczogW0VkaXRTZXJ2aWNlXVxyXG59KVxyXG5leHBvcnQgY2xhc3MgU29sdXRpb25NYW5hbmdlckNvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCB7XHJcblxyXG4gICAgQE91dHB1dCgpIGNhbmNlbEVtaXR0ZXI6IEV2ZW50RW1pdHRlcjxhbnk+ID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XHJcbiAgICBAT3V0cHV0KCkgY29uZmlybUVtaXR0ZXI6IEV2ZW50RW1pdHRlcjxhbnk+ID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XHJcbiAgICBcclxuICAgIC8vIEBJbnB1dCgpXHJcbiAgICAvLyBjdXJyZW50RGVmYXVsdFF1ZXJ5U29sdXRpb25JZDogc3RyaW5nO1xyXG4gICAgLy8gQElucHV0KClcclxuICAgIHF1ZXJ5U29sdXRpb25zOiBBcnJheTxRdWVyeVNvbHV0aW9uVm8+ID0gbmV3IEFycmF5PFF1ZXJ5U29sdXRpb25Wbz4oKTtcclxuXHJcbiAgICBkZWxldGVkUXVlcnlTb2x1dGlvbklkczogQXJyYXk8U3RyaW5nPiA9IG5ldyBBcnJheTxTdHJpbmc+KCk7XHJcbiAgICBjaGVja2VkU29sdXRpb246IFF1ZXJ5U29sdXRpb25WbztcclxuICAgIGxpc3REYXRhOiBRdWVyeVNvbHV0aW9uVm9bXTtcclxuXHJcbiAgICBAVmlld0NoaWxkKCdkaWFsb2cnKSBkaWFsb2c6IERpYWxvZ0NvbXBvbmVudDtcclxuICAgIC8vIOiOt+WPluWumuS5ieeahOWNleWFg+agvOaooeadv1xyXG4gICAgQFZpZXdDaGlsZCgnb3B0Q2VsbCcpIG9wdENlbGw6IFRlbXBsYXRlUmVmPGFueT47XHJcbiAgICBAVmlld0NoaWxkKCdjaGVja0NlbGwnKSBjaGVja0NlbGw6IFRlbXBsYXRlUmVmPGFueT47XHJcbiAgICBAVmlld0NoaWxkKCdsaXN0JykgbGlzdDogRGF0YWdyaWRDb21wb25lbnQ7XHJcbiAgICBjb2x1bW5zOiBBcnJheTxhbnk+O1xyXG4gICAgdGl0bGU6IHN0cmluZztcclxuICAgIGF1dGhvcml0eUVycm9yID0gZmFsc2U7XHJcblxyXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSBmb3JtQnVpbGRlcjogRm9ybUJ1aWxkZXIsIHByaXZhdGUgZWRpdFNlcnZpY2U6IEVkaXRTZXJ2aWNlLCBwcml2YXRlIG5vdGlmeTogTm90aWZ5U2VydmljZSwgcHJpdmF0ZSBsb2NhbGVTZXJ2aWNlOiBMb2NhbGVTZXJ2aWNlKSB7IH1cclxuXHJcblxyXG4gICAgbmdPbkluaXQoKTogdm9pZCB7XHJcblxyXG4gICAgICAgIHRoaXMuY29sdW1ucyA9IFtcclxuICAgICAgICAgICAgeyBmaWVsZDogJ2NvZGUnLCB3aWR0aDogMjcyLCB0aXRsZTogdGhpcy5sb2NhbGVTZXJ2aWNlLmdldFZhbHVlKCdxdWVyeVNvbHV0aW9uLm1hbmFnZURpYWxvZy5uYW1lJyl9LFxyXG4gICAgICAgICAgICB7IGZpZWxkOiAncHJvcGVydHknLCB3aWR0aDogMTEwLCB0aXRsZTogdGhpcy5sb2NhbGVTZXJ2aWNlLmdldFZhbHVlKCdxdWVyeVNvbHV0aW9uLm1hbmFnZURpYWxvZy5wcm9wZXJ0eScpLCBmb3JtYXR0ZXI6IHRoaXMucHJvcGVydHlGaWVsZEZvcm1hdHRlciwgaGFsaWduOiAnY2VudGVyJywgYWxpZ246ICdjZW50ZXInfSxcclxuICAgICAgICAgICAgeyBmaWVsZDogJ2lzRGVmYXVsdCcsIHdpZHRoOiA3MCwgdGl0bGU6IHRoaXMubG9jYWxlU2VydmljZS5nZXRWYWx1ZSgncXVlcnlTb2x1dGlvbi5tYW5hZ2VEaWFsb2cuZGVmYXVsdCcpLCB0ZW1wbGF0ZTogdGhpcy5jaGVja0NlbGwsIGhhbGlnbjogJ2NlbnRlcicsIGFsaWduOiAnY2VudGVyJ30sXHJcbiAgICAgICAgICAgIHsgd2lkdGg6IDcwLCB0aXRsZTogdGhpcy5sb2NhbGVTZXJ2aWNlLmdldFZhbHVlKCdxdWVyeVNvbHV0aW9uLm1hbmFnZURpYWxvZy5vcGVyYXRpb24nKSwgdGVtcGxhdGU6IHRoaXMub3B0Q2VsbCwgaGFsaWduOiAnY2VudGVyJywgYWxpZ246ICdjZW50ZXInfVxyXG4gICAgICAgIF07XHJcbiAgICAgICAgdGhpcy50aXRsZSA9IHRoaXMubG9jYWxlU2VydmljZS5nZXRWYWx1ZSgncXVlcnlTb2x1dGlvbi5jb250YWluZXIubWFuYWdlJyk7XHJcbiAgICB9XHJcblxyXG4gICAgc2hvdyhxdWVyeVNvbHV0aW9uczogUXVlcnlTb2x1dGlvblZvW10pIHtcclxuICAgICAgICBpZihxdWVyeVNvbHV0aW9ucyl7XHJcbiAgICAgICAgICAgIHRoaXMubGlzdERhdGEgPSB0aGlzLmZpbmRTb2x1dGlvbnNXaXRob3V0U3lzKHF1ZXJ5U29sdXRpb25zKTtcclxuICAgICAgICAgICAgdGhpcy5xdWVyeVNvbHV0aW9ucyA9IHF1ZXJ5U29sdXRpb25zO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmNoZWNrZWRTb2x1dGlvbiA9IHRoaXMucXVlcnlTb2x1dGlvbnMuZmluZCh2byA9PiB2by5pc0RlZmF1bHQpO1xyXG5cclxuICAgICAgICB0aGlzLmRlbGV0ZWRRdWVyeVNvbHV0aW9uSWRzID0gW107XHJcbiAgICAgICAgLy8gdGhpcy5jaGVja2VkU29sdXRpb24gPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgdGhpcy5kaWFsb2cuc2hvdygpO1xyXG4gICAgfVxyXG5cclxuICAgIGdldFNvbHV0aW9uUHJvcGVydHkodmFsdWU6IGJvb2xlYW4pIHtcclxuICAgICAgICByZXR1cm4gdmFsdWUgPyB0aGlzLmxvY2FsZVNlcnZpY2UuZ2V0VmFsdWUoXCJxdWVyeVNvbHV0aW9uLm1hbmFnZURpYWxvZy5zeXN0ZW1cIikgOiB0aGlzLmxvY2FsZVNlcnZpY2UuZ2V0VmFsdWUoXCJxdWVyeVNvbHV0aW9uLm1hbmFnZURpYWxvZy5wZXJzb25hbFwiKTtcclxuICAgIH1cclxuXHJcbiAgICBwcm9wZXJ0eUZpZWxkRm9ybWF0dGVyID0gKHZhbHVlLCBkYXRhKSA9PiB7XHJcbiAgICAgICAgaWYoZGF0YVsndHlwZSddID09ICdwdWJsaWMnKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmxvY2FsZVNlcnZpY2UuZ2V0VmFsdWUoXCJleHRlbmRRdWVyeVNvbHV0aW9uLnB1YmxpYy5wcm9wZXJ0eVwiKTtcclxuICAgICAgICB9IGVsc2UgaWYoZGF0YVsndHlwZSddID09ICdvcmcnKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmxvY2FsZVNlcnZpY2UuZ2V0VmFsdWUoXCJleHRlbmRRdWVyeVNvbHV0aW9uLm9yZy5wcm9wZXJ0eVwiKTtcclxuICAgICAgICB9IFxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5sb2NhbGVTZXJ2aWNlLmdldFZhbHVlKFwiZXh0ZW5kUXVlcnlTb2x1dGlvbi5wcml2YXRlLnByb3BlcnR5XCIpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBmaW5kU29sdXRpb25zV2l0aG91dFN5cyhxdWVyeVNvbHV0aW9uczogUXVlcnlTb2x1dGlvblZvW10pOiBRdWVyeVNvbHV0aW9uVm9bXXtcclxuICAgICAgICBjb25zdCByZXN1bHQ6IFF1ZXJ5U29sdXRpb25Wb1tdID0gW107XHJcbiAgICAgICAgcXVlcnlTb2x1dGlvbnMuZm9yRWFjaChxcyA9PiB7XHJcbiAgICAgICAgICAgIGlmKCFxcy5pc1N5c3RlbSlcclxuICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKHFzKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfVxyXG5cclxuICAgIGRlbGVsdGVTb2x1dGlvbihkYXRhSXRlbTogUXVlcnlTb2x1dGlvblZvKSB7XHJcbiAgICAgICAgaWYodGhpcy5hdXRob3JpdHlFcnJvciAmJiAoZGF0YUl0ZW0udHlwZSA9PSAncHVibGljJyB8fCBkYXRhSXRlbS50eXBlID09ICdvcmcnKSkge1xyXG4gICAgICAgICAgICB0aGlzLm5vdGlmeS5jb25maWcucG9zaXRpb24gPSAndG9wLWNlbnRlcic7XHJcbiAgICAgICAgICAgIHRoaXMubm90aWZ5Lndhcm5pbmcoPE5vdGlmeU9wdGlvbnM+eyB0aXRsZTogJycsIG1zZzogdGhpcy5sb2NhbGVTZXJ2aWNlLmdldFZhbHVlKFwiZXh0ZW5kUXVlcnlTb2x1dGlvbi5hdXRoLmRlbGV0ZUVycm9yXCIpLCB0aW1lb3V0OiAxNTAwIH0pO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuZGVsZXRlZFF1ZXJ5U29sdXRpb25JZHMucHVzaChkYXRhSXRlbS5pZCk7XHJcbiAgICAgICAgaWYgKHRoaXMuY2hlY2tlZFNvbHV0aW9uICYmIGRhdGFJdGVtLmlkID09IHRoaXMuY2hlY2tlZFNvbHV0aW9uLmlkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2hlY2tlZFNvbHV0aW9uID0gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy/lvZNjaGVja2VkU29sdXRpb27kuI3lrZjlnKjvvIznm7TmjqXliKDpmaRcclxuICAgICAgICBmb3IobGV0IGkgPSAwOyBpIDwgdGhpcy5xdWVyeVNvbHV0aW9ucy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBpZihkYXRhSXRlbS5pZCA9PSB0aGlzLnF1ZXJ5U29sdXRpb25zW2ldLmlkKXtcclxuICAgICAgICAgICAgICAgIHRoaXMucXVlcnlTb2x1dGlvbnMuc3BsaWNlKGksIDEpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5saXN0RGF0YSA9IHRoaXMuZmluZFNvbHV0aW9uc1dpdGhvdXRTeXModGhpcy5xdWVyeVNvbHV0aW9ucyk7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0RGVmYXVsdChjaGVja2VkOiBib29sZWFuLCBkYXRhSXRlbTogUXVlcnlTb2x1dGlvblZvKSB7XHJcbiAgICAgICAgaWYgKGNoZWNrZWQpIHsvL2lmIGNoZWNrZWTvvIzorr7nva7lvZPliY12b+S4uum7mOiupO+8jOWFtuS7luiuvuS4uumdnum7mOiupFxyXG4gICAgICAgICAgICB0aGlzLmNoZWNrZWRTb2x1dGlvbiA9IGRhdGFJdGVtO1xyXG4gICAgICAgICAgICAvL2tleSBwb2ludO+8gVxyXG4gICAgICAgICAgICAvLyB0aGlzLmN1cnJlbnREZWZhdWx0UXVlcnlTb2x1dGlvbklkID0gZGF0YUl0ZW0uaWQ7XHJcbiAgICAgICAgICAgIHRoaXMucXVlcnlTb2x1dGlvbnMgPSB0aGlzLnF1ZXJ5U29sdXRpb25zLm1hcCh2byA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZih2by5pZCA9PSBkYXRhSXRlbS5pZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZvLmlzRGVmYXVsdCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHZvLmlzRGVmYXVsdCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHZvO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7Ly9pZiB1bmNoZWNrZWQsIOiuvue9ruW9k+WJjXZv5Li66Z2e6buY6K6k77yM5YW25L2Zdm/kuI3lj5g7IOayoeaciWNoZWNrZWRTb2x1dGlvbuaXtlxyXG4gICAgICAgICAgICBpZiAoZGF0YUl0ZW0uaWQgPT0gdGhpcy5jaGVja2VkU29sdXRpb24uaWQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2hlY2tlZFNvbHV0aW9uID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIC8vIHRoaXMuY3VycmVudERlZmF1bHRRdWVyeVNvbHV0aW9uSWQgPSAnJztcclxuICAgICAgICAgICAgICAgIHRoaXMucXVlcnlTb2x1dGlvbnMgPSB0aGlzLnF1ZXJ5U29sdXRpb25zLm1hcCh2byA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYodm8uaWQgPT0gZGF0YUl0ZW0uaWQpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2by5pc0RlZmF1bHQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHZvO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5saXN0RGF0YSA9IHRoaXMuZmluZFNvbHV0aW9uc1dpdGhvdXRTeXModGhpcy5xdWVyeVNvbHV0aW9ucyk7XHJcbiAgICAgICAgdGhpcy5saXN0LnJlZnJlc2goKTtcclxuICAgIH1cclxuXHJcbiAgICBjYW5jZWwoKSB7XHJcbiAgICAgICAgdGhpcy5kaWFsb2cuY2xvc2UoKTtcclxuICAgIH1cclxuXHJcbiAgICBjb25maXJtKCkge1xyXG4gICAgICAgIGxldCBvYmogPSBuZXcgT2JqZWN0KCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgb2JqWydkZWxldGVkUXVlcnlTb2x1dGlvbklkcyddID0gdGhpcy5kZWxldGVkUXVlcnlTb2x1dGlvbklkcztcclxuICAgICAgICBvYmpbJ25ld0RlZmF1bHRRdWVyeVNvbHV0aW9uJ10gPSBjbG9uZURlZXAodGhpcy5jaGVja2VkU29sdXRpb24pO1xyXG4gICAgICAgIG9ialsndXBkYXRlZFF1ZXJ5U29sdXRpb25Wb3MnXSA9IGNsb25lRGVlcCh0aGlzLnF1ZXJ5U29sdXRpb25zKTtcclxuICAgICAgICAvLyBvYmpbJ2N1cnJlbnREZWZhdWx0UXVlcnlTb2x1dGlvbklkJ10gPSB0aGlzLmN1cnJlbnREZWZhdWx0UXVlcnlTb2x1dGlvbklkO1xyXG5cclxuICAgICAgICBpZih0aGlzLmRlbGV0ZWRRdWVyeVNvbHV0aW9uSWRzLmxlbmd0aCA+IDAgfHwgdGhpcy5jaGVja2VkU29sdXRpb24gJiYgdGhpcy5jaGVja2VkU29sdXRpb24uaWQpIHtcclxuICAgICAgICAgICAgb2JqWyd2YWxpZGF0b3InXSA9IHRydWU7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgb2JqWyd2YWxpZGF0b3InXSA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmNvbmZpcm1FbWl0dGVyLmVtaXQob2JqKTtcclxuICAgICAgICB0aGlzLmRpYWxvZy5jbG9zZSgpO1xyXG4gICAgfVxyXG59XHJcbiJdfQ==