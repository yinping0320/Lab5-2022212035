{"version":3,"file":"gsp-cmp-coderule-selector.umd.js.map","sources":["ng://@gsp-cmp/coderule-selector/lib/service/code-rule-select.service.ts","ng://@gsp-cmp/coderule-selector/lib/model/code-rule-invoke-info.ts","ng://@gsp-cmp/coderule-selector/lib/components/select-code-rule/select-code-rule.component.ts","ng://@gsp-cmp/coderule-selector/lib/model/code-rule-base-info.ts","ng://@gsp-cmp/coderule-selector/lib/components/code-rule-list/code-rule-list.component.ts","ng://@gsp-cmp/coderule-selector/lib/code-rule-select.module.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\r\nimport { Observable } from 'rxjs/Observable';\r\nimport { HttpHeaders, HttpClient } from '@angular/common/http';\r\nimport { CodeRuleBaseInfo } from '../model/code-rule-base-info';\r\n\r\n@Injectable()\r\nexport class CodeRuleSelectService {\r\n\r\n  constructor(private http: HttpClient) {\r\n  }\r\n\r\n  public serviceUnit: string;\r\n  public sessionId: string;\r\n  private QUERY_URL: string = \"/api/runtime/bcc/v1.0/code-rule-data\"\r\n\r\n  codeRule: CodeRuleBaseInfo;\r\n\r\n  metadatas = [];\r\n\r\n  addMetadataRT(metadata) {\r\n    this.metadatas.push(metadata);\r\n  }\r\n\r\n  clearData() {\r\n    this.metadatas = [];\r\n    this.codeRule = null;\r\n  }\r\n\r\n  // 根据类型获取Cloud Server下所有的元数据\r\n  getCodeRuleList(): Observable<any> {\r\n    let headers:HttpHeaders = new HttpHeaders();\r\n    headers.append(\"sessionId\", this.sessionId);\r\n    return this.http.get(`${this.QUERY_URL}?serviceUnit=${this.serviceUnit}`, { headers: headers });\r\n  }\r\n\r\n\r\n\r\n}\r\n","export class CodeRuleInvokeInfo{\r\n    id:string;\r\n    code:string;\r\n    name:string\r\n    serviceUnit:string;\r\n    byMetadata:boolean\r\n}","// tslint:disable-next-line:max-line-length\r\nimport { Component, ViewChild, Input, OnChanges, Output, EventEmitter, SimpleChanges, ComponentFactoryResolver, Injector } from '@angular/core';\r\nimport { CodeRuleSelectService } from '../../service/code-rule-select.service';\r\nimport { CodeRuleInvokeInfo } from '../../model/code-rule-invoke-info';\r\n\r\n@Component({\r\n  // tslint:disable-next-line:component-selector\r\n  selector: 'app-select-metadatart',\r\n  templateUrl: './select-code-rule.component.html',\r\n  styleUrls: ['./select-code-rule.component.css']\r\n})\r\nexport class SelectCodeRuleComponent implements OnChanges {\r\n  @Input() set serviceUnit(value: string) {\r\n    this.codeRuleSvc.serviceUnit = value;\r\n  }\r\n  @Input() set sessionId(value: string) {\r\n    this.codeRuleSvc.sessionId = value;\r\n  }\r\n  @Output() selectorClosed: EventEmitter<any>;\r\n  @Output() codeRuleSelected = new EventEmitter<CodeRuleInvokeInfo>();\r\n\r\n  constructor(private codeRuleSvc: CodeRuleSelectService,\r\n    private resolver: ComponentFactoryResolver, private injector: Injector) {\r\n    this.selectorClosed = new EventEmitter<any>();\r\n  }\r\n\r\n  ngOnChanges(changes: SimpleChanges): void {\r\n\r\n  }\r\n\r\n  /**\r\n   * 点击确认，确认编号规则\r\n   */\r\n  confirmCodeRule() {\r\n    const codeRuleInfo = this.codeRuleSvc.codeRule;\r\n    if (!codeRuleInfo) {\r\n      alert(\"当前未选中任何数据！\");\r\n      return;\r\n    }\r\n    const invokeInfo: CodeRuleInvokeInfo = new CodeRuleInvokeInfo();\r\n    invokeInfo.id = codeRuleInfo.id;\r\n    invokeInfo.code = codeRuleInfo.code;\r\n    invokeInfo.name = codeRuleInfo.name;\r\n    invokeInfo.serviceUnit = codeRuleInfo.serviceUnit;\r\n    invokeInfo.byMetadata = codeRuleInfo.origin == \"元数据\" ? true : false;\r\n    this.codeRuleSelected.emit(invokeInfo);\r\n    this.closeSelector();\r\n    // 清空缓存\r\n    this.codeRuleSvc.clearData();\r\n  }\r\n\r\n  /**\r\n   * 点击取消，关闭选择器\r\n   */\r\n  closeSelector(): void {\r\n    this.selectorClosed.emit();\r\n  }\r\n\r\n}\r\n","export class CodeRuleBaseInfo{\r\n    id:string;\r\n    code:string;\r\n    name:string;\r\n    serviceUnit:string;\r\n    origin:string;\r\n\r\n    init(obj:Object){\r\n        this.id=obj[\"id\"];\r\n        this.code=obj[\"code\"];\r\n        this.name=obj[\"name\"];\r\n        this.serviceUnit=obj[\"serviceUnit\"];\r\n        this.origin=obj[\"origin\"];\r\n    }\r\n}","import { Component, Input, OnInit } from '@angular/core';\r\nimport { process, State } from '@progress/kendo-data-query';\r\nimport { GridDataResult, DataStateChangeEvent,SelectableSettings} from '@progress/kendo-angular-grid';\r\nimport { CodeRuleBaseInfo } from '../../model/code-rule-base-info';\r\nimport { CodeRuleSelectService } from '../../service/code-rule-select.service';\r\n\r\n\r\n@Component({\r\n  // tslint:disable-next-line:component-selector\r\n  selector: 'app-coderule-list',\r\n  templateUrl: './code-rule-list.component.html',\r\n  styleUrls: ['./code-rule-list.component.css']\r\n})\r\nexport class CodeRuleListComponent implements OnInit {\r\n\r\n  constructor(private codeRuleSvc: CodeRuleSelectService) { }\r\n\r\n  data: CodeRuleBaseInfo[]=new Array<CodeRuleBaseInfo>();\r\n  clear() {\r\n    this.data = [];\r\n  }\r\n\r\n  // tslint:disable-next-line:member-ordering\r\n  public state: State = {\r\n    skip: 0,\r\n    take: 9999,\r\n    // Initial filter descriptor\r\n    filter: {\r\n      logic: 'and',\r\n      filters: []\r\n    }\r\n  };\r\n\r\n  // tslint:disable-next-line:member-ordering\r\n  public gridData: GridDataResult;\r\n  public dataStateChange(state: DataStateChangeEvent): void {\r\n    this.state = state;\r\n    this.gridData = process(this.data, this.state);\r\n  }\r\n\r\n  // tslint:disable-next-line:member-ordering\r\n  selectableSetting: SelectableSettings = { mode: 'single', checkboxOnly: false };\r\n\r\n\r\n  ngOnInit() {\r\n    this.codeRuleSvc.getCodeRuleList().subscribe(datas => {\r\n      if (datas && datas.length > 0) {\r\n        datas.forEach(obj => {\r\n          let baseInfo = new CodeRuleBaseInfo();\r\n          baseInfo.init(obj);\r\n          this.data.push(baseInfo);\r\n        })\r\n        this.gridData = process(this.data, this.state);\r\n      }\r\n    });\r\n  }\r\n\r\n  // 选中编号规则后的事件处理\r\n  onSelectionChange(event) {\r\n    if (event.selectedRows.length > 0) {\r\n      this.codeRuleSvc.codeRule = null;\r\n      this.codeRuleSvc.codeRule = event.selectedRows[0].dataItem;\r\n    }\r\n  }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { TreeViewModule } from '@progress/kendo-angular-treeview';\r\nimport { GridModule } from '@progress/kendo-angular-grid';\r\n// import { FarrisDialogModule } from '@farris/ui-dialog';\r\nimport { SelectCodeRuleComponent } from './components/select-code-rule/select-code-rule.component';\r\nimport { CodeRuleListComponent } from './components/code-rule-list/code-rule-list.component';\r\nimport { CodeRuleSelectService } from './service/code-rule-select.service';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    TreeViewModule,\r\n    GridModule,\r\n    // FarrisDialogModule\r\n  ],\r\n  exports: [\r\n    SelectCodeRuleComponent\r\n  ],\r\n  providers: [CodeRuleSelectService], // 服务提供者\r\n  declarations: [SelectCodeRuleComponent, CodeRuleListComponent],\r\n  entryComponents: [SelectCodeRuleComponent]\r\n})\r\nexport class CodeRuleSelectModule {\r\n  constructor() {\r\n  }\r\n}\r\n"],"names":["http","HttpHeaders","Injectable","HttpClient","EventEmitter","Component","ComponentFactoryResolver","Injector","Input","Output","process","NgModule","CommonModule","FormsModule","TreeViewModule","GridModule"],"mappings":"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"}
