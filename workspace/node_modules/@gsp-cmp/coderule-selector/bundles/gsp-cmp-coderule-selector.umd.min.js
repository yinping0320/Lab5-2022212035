!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/common"),require("@angular/forms"),require("@progress/kendo-angular-treeview"),require("@progress/kendo-angular-grid"),require("@angular/common/http"),require("@angular/core"),require("@progress/kendo-data-query")):"function"==typeof define&&define.amd?define("@gsp-cmp/coderule-selector",["exports","@angular/common","@angular/forms","@progress/kendo-angular-treeview","@progress/kendo-angular-grid","@angular/common/http","@angular/core","@progress/kendo-data-query"],t):t((e["gsp-cmp"]=e["gsp-cmp"]||{},e["gsp-cmp"]["coderule-selector"]={}),e.ng.common,e.ng.forms,e.kendoAngularTreeview,e.kendoAngularGrid,e.ng.common.http,e.ng.core,e.kendoDataQuery)}(this,function(e,t,o,r,n,i,s,a){"use strict";var c=(l.prototype.addMetadataRT=function(e){this.metadatas.push(e)},l.prototype.clearData=function(){this.metadatas=[],this.codeRule=null},l.prototype.getCodeRuleList=function(){var e=new i.HttpHeaders;return e.append("sessionId",this.sessionId),this.http.get(this.QUERY_URL+"?serviceUnit="+this.serviceUnit,{headers:e})},l.decorators=[{type:s.Injectable}],l.ctorParameters=function(){return[{type:i.HttpClient}]},l);function l(e){this.http=e,this.QUERY_URL="/api/runtime/bcc/v1.0/code-rule-data",this.metadatas=[]}var d=function b(){},u=(Object.defineProperty(p.prototype,"serviceUnit",{set:function(e){this.codeRuleSvc.serviceUnit=e},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"sessionId",{set:function(e){this.codeRuleSvc.sessionId=e},enumerable:!0,configurable:!0}),p.prototype.ngOnChanges=function(e){},p.prototype.confirmCodeRule=function(){var e=this.codeRuleSvc.codeRule;if(e){var t=new d;t.id=e.id,t.code=e.code,t.name=e.name,t.serviceUnit=e.serviceUnit,t.byMetadata="元数据"==e.origin,this.codeRuleSelected.emit(t),this.closeSelector(),this.codeRuleSvc.clearData()}else alert("当前未选中任何数据！")},p.prototype.closeSelector=function(){this.selectorClosed.emit()},p.decorators=[{type:s.Component,args:[{selector:"app-select-metadatart",template:'<div class="modal-body">\r\n    <div class="templateBlock">\r\n        <app-coderule-list ></app-coderule-list>\r\n    </div>\r\n</div>\r\n<div class="modal-footer">\r\n    <button type="button" class="btn btn-default btn-primary" (click)="confirmCodeRule()">确定</button>\r\n    <button type="button" class="btn btn-default" (click)="closeSelector()">取消</button>\r\n</div>',styles:[".templateBlock{display:flex}.infoBlock{width:100%;min-width:400px}.infoBlock label{width:50px}"]}]}],p.ctorParameters=function(){return[{type:c},{type:s.ComponentFactoryResolver},{type:s.Injector}]},p.propDecorators={serviceUnit:[{type:s.Input}],sessionId:[{type:s.Input}],selectorClosed:[{type:s.Output}],codeRuleSelected:[{type:s.Output}]},p);function p(e,t,o){this.codeRuleSvc=e,this.resolver=t,this.injector=o,this.codeRuleSelected=new s.EventEmitter,this.selectorClosed=new s.EventEmitter}var h=(g.prototype.init=function(e){this.id=e.id,this.code=e.code,this.name=e.name,this.serviceUnit=e.serviceUnit,this.origin=e.origin},g);function g(){}var m=(f.prototype.clear=function(){this.data=[]},f.prototype.dataStateChange=function(e){this.state=e,this.gridData=a.process(this.data,this.state)},f.prototype.ngOnInit=function(){var o=this;this.codeRuleSvc.getCodeRuleList().subscribe(function(e){e&&0<e.length&&(e.forEach(function(e){var t=new h;t.init(e),o.data.push(t)}),o.gridData=a.process(o.data,o.state))})},f.prototype.onSelectionChange=function(e){0<e.selectedRows.length&&(this.codeRuleSvc.codeRule=null,this.codeRuleSvc.codeRule=e.selectedRows[0].dataItem)},f.decorators=[{type:s.Component,args:[{selector:"app-coderule-list",template:'<div class="templateInfo">\r\n  <div class="templateSelector">\r\n    <kendo-grid [data]="gridData" [height]="449" [selectable]="selectableSetting"\r\n      (selectionChange)=onSelectionChange($event) [pageSize]="state.take" [skip]="state.skip" [sort]="state.sort"\r\n      [filter]="state.filter" [sortable]="true" [pageable]="false" [filterable]="true" [resizable]="true"\r\n      (dataStateChange)=dataStateChange($event)>\r\n      <kendo-grid-column field="code" title="编号" width="210">\r\n      </kendo-grid-column>\r\n      <kendo-grid-column field="name" title="名称" width="200">\r\n      </kendo-grid-column>\r\n      <kendo-grid-column field="serviceUnit" title="服务单元" width="200">\r\n      </kendo-grid-column>\r\n    </kendo-grid>\r\n  </div>\r\n</div>',styles:[".templateSelector{width:100%;height:450px;border:.5px solid #ddd}.templateDescription{width:200px;height:450px;border:.5px solid #ddd}.templateInfo{display:flex}"]}]}],f.ctorParameters=function(){return[{type:c}]},f);function f(e){this.codeRuleSvc=e,this.data=new Array,this.state={skip:0,take:9999,filter:{logic:"and",filters:[]}},this.selectableSetting={mode:"single",checkboxOnly:!1}}var v=(y.decorators=[{type:s.NgModule,args:[{imports:[t.CommonModule,o.FormsModule,r.TreeViewModule,n.GridModule],exports:[u],providers:[c],declarations:[u,m],entryComponents:[u]}]}],y.ctorParameters=function(){return[]},y);function y(){}e.CodeRuleSelectModule=v,e.SelectCodeRuleComponent=u,e.CodeRuleInvokeInfo=d,e.CodeRuleSelectService=c,e.ɵa=m,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=gsp-cmp-coderule-selector.umd.min.js.map