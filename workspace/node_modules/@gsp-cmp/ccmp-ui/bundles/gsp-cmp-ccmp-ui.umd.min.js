!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@gsp-cmp/common-component"),require("@angular/common"),require("@progress/kendo-angular-buttons"),require("@progress/kendo-angular-grid"),require("@farris/ui-dialog"),require("@farris/ui-messager"),require("@farris/ui-notify"),require("@angular/core"),require("@farris/ui-modal"),require("@angular/common/http"),require("rxjs/operators")):"function"==typeof define&&define.amd?define("@gsp-cmp/ccmp-ui",["exports","@gsp-cmp/common-component","@angular/common","@progress/kendo-angular-buttons","@progress/kendo-angular-grid","@farris/ui-dialog","@farris/ui-messager","@farris/ui-notify","@angular/core","@farris/ui-modal","@angular/common/http","rxjs/operators"],t):t((e["gsp-cmp"]=e["gsp-cmp"]||{},e["gsp-cmp"]["ccmp-ui"]={}),e.commonComponent,e.ng.common,e.kendoAngularButtons,e.kendoAngularGrid,e.uiDialog,e.i1,e.i2,e.ng.core,e.i2$1,e.ng.common.http,e.rxjs.operators)}(this,function(e,n,t,o,i,r,s,a,c,p,l,m){"use strict";var u=(d.prototype.getModalConfig=function(e,t){return{title:t&&t.title?t.title:"操作列表",width:t&&t.width?t.width:450,height:t&&t.height?t.width:500,resizable:!t||!t.resizable||t.resizable,showButtons:!0,showMaxButton:!1,enableScroll:!1,buttons:e}},d.prototype.showObseleteDialog=function(e){this.messagerService.show("warning","通用构件"+e.code+"已过时！\n                    升级步骤：\n                    1. 重新定义通用构件元数据;\n                    2. 开发新版本构件代码。\n                    请参考GSPCloud开发文档->高级开发->构件开发->通用构件开发",{safeHtml:!1})},d.prototype.showInfo=function(e,t,o,n){this.notify.config.position="top-center","success"==t?this.notify.success({title:o,msg:e,timeout:n}):"info"==t?this.notify.info({title:o,msg:e,timeout:n}):"warning"==t?this.notify.warning({title:o,msg:e,timeout:n}):"error"==t&&this.notify.error({title:o,msg:e,timeout:n})},d.decorators=[{type:c.Injectable,args:[{providedIn:"root"}]}],d.ctorParameters=function(){return[{type:s.MessagerService},{type:a.NotifyService}]},d.ngInjectableDef=c.defineInjectable({factory:function(){return new d(c.inject(s.MessagerService),c.inject(a.NotifyService))},token:d,providedIn:"root"}),d);function d(e,t){this.messagerService=e,this.notify=t}var f=(h.prototype.convertorToObject=function(e){var t=new n.GspComponentConvertor,o=new Object;return t.convertToObject(o,e,new n.DefaultGspComponentSerializeContext),o},h.prototype.initFromObject=function(e){var t=new n.GspComponentConvertor,o=new n.GspComponent;return t.initFromObject(o,e,new n.DefaultGspComponentSerializeContext),o},h);function h(){}var g=(v.prototype.init=function(e){if(this.id=e.id,this.obselete=e.obselete,this.code=e.code,this.name=e.name,this.nameSpace=e.nameSpace,this.fileName=e.fileName,this.type=e.type,this.bizobjectID=e.bizobjectID,this.language=e.language,e.metadata){var t=new f;this.metadata=t.initFromObject(e.metadata)}},v);function v(){}var y=(Object.defineProperty(b.prototype,"componentInfo",{set:function(e){this._componentInfo=e,this.metadata=e.metadata;var t=new f;this.metadata=t.initFromObject(t.convertorToObject(e.metadata)),this.metadata.operations=new Array},enumerable:!0,configurable:!0}),b.prototype.ngOnInit=function(){this._componentInfo=this._componentInfo||new g},b.prototype.confirm=function(){this._componentInfo.metadata&&this._componentInfo.metadata.operations||!(this._componentInfo.metadata.operations.length<=0)?!this.metadata.operations||this.metadata.operations.length<=0?this.utils.showInfo("请选择构件操作","info","",1500):(this.dialog&&this.dialog.close(),this.confirmEmitter.emit(this.metadata)):this.utils.showInfo("没有可选的构件操作","info","",1500)},b.prototype.close=function(){this.dialog&&this.dialog.close(),this.closeEmitter.emit()},b.prototype.cellClickHandler=function(e){this.selectedOpUris=[e.dataItem.uri],this.metadata.operations=[e.dataItem]},b.decorators=[{type:c.Component,args:[{selector:"common-component-selector",template:'<div class="d-flex" style="position: absolute;top: 0;bottom: 0;left: 0;right: 0;min-width: 300px;">\n    <kendo-grid class="f-utils-flex-column" style="flex:1 1 auto;padding: 0px 8px 0px 8px;" [data]="_componentInfo?.metadata?.operations"\n        [selectable]="{enabled: true, checkboxOnly: false,mode:\'single\' }" [kendoGridSelectBy]="\'uri\'" (cellClick)="cellClickHandler($event)"\n        [rowSelected]="isRowSelected">\n        <kendo-grid-column field="code" title="操作编号"></kendo-grid-column>\n        <kendo-grid-column field="name" title="操作名称"></kendo-grid-column>\n        \x3c!-- <kendo-grid-column width="100" title="参数信息">\n            <ng-template kendoGridCellTemplate let-dataItem>\n                <span style="float:left;font-size: 14px;color: #1890ff;cursor: pointer;" (click)="view(dataItem)">查看<span\n                        class="f-icon f-accordion-collapse"></span></span>\n            </ng-template>\n        </kendo-grid-column> --\x3e\n    </kendo-grid>\n</div>\n\n<ng-template #btnRef>\n    <div style="width: 100%;line-height: 50px; text-align: center;min-width: 140px;">\n        <button class="btn btn-secondary" (click)="close()" style="float:right;margin-right: 5px">取消</button>\n        <button class="btn btn-primary" (click)=confirm() style="float:right;margin-right: 5px">确定</button>\n    </div>\n</ng-template>',styles:[""]}]}],b.ctorParameters=function(){return[{type:u},{type:p.BsModalService},{type:c.ComponentFactoryResolver},{type:c.Injector}]},b.propDecorators={componentInfo:[{type:c.Input}],btnRef:[{type:c.ViewChild,args:["btnRef"]}],confirmEmitter:[{type:c.Output}],closeEmitter:[{type:c.Output}]},b);function b(e,t,o,n){var i=this;this.utils=e,this.modalService=t,this.resolver=o,this.injector=n,this.selectedOpUris=[],this.isRowSelected=function(e){return 0<=i.selectedOpUris.indexOf(e.dataItem.uri)},this.confirmEmitter=new c.EventEmitter,this.closeEmitter=new c.EventEmitter}var w=(C.prototype.openSelector=function(e,t,o){var n=this;return this.getComponentInfo(e,t).pipe(m.map(function(e){return e.obselete?(n.util.showObseleteDialog(e),{confirmEvent:new c.EventEmitter,closeEvent:new c.EventEmitter}):n.create(e,o)}))},C.prototype.getComponentInfo=function(e,t){var o=new l.HttpHeaders;o.set("sessionId",t);var n="/api/runtime/sys/v1.0/common-component/component-info/"+e;return this.http.get(n,{headers:o}).pipe(m.map(function(e){if(e){var t=new g;return t.init(e),t}}))},C.prototype.create=function(e,t){var o=this.resolver.resolveComponentFactory(y).create(this.injector);o.instance.componentInfo=e;var n=this.util.getModalConfig(o.instance.btnRef,t),i=this.modalService.show(o,n);return o.instance.dialog=i,{confirmEvent:o.instance.confirmEmitter,closeEvent:o.instance.closeEmitter}},C.decorators=[{type:c.Injectable,args:[{providedIn:"root"}]}],C.ctorParameters=function(){return[{type:c.ComponentFactoryResolver},{type:c.Injector},{type:u},{type:p.BsModalService},{type:l.HttpClient}]},C.ngInjectableDef=c.defineInjectable({factory:function(){return new C(c.inject(c.ComponentFactoryResolver),c.inject(c.INJECTOR),c.inject(u),c.inject(p.BsModalService),c.inject(l.HttpClient))},token:C,providedIn:"root"}),C);function C(e,t,o,n,i){this.resolver=e,this.injector=t,this.util=o,this.modalService=n,this.http=i}var I=(j.prototype.openSelector=function(e,t,o){var n=this;return this.getComponentInfo(e,t).pipe(m.map(function(e){return e.obselete?(n.util.showObseleteDialog(e),{confirmEvent:new c.EventEmitter,closeEvent:new c.EventEmitter}):n.create(e,o)}))},j.prototype.getComponentInfo=function(e,t){var o=new l.HttpHeaders;o.set("sessionId",t);var n="/api/dev/main/v1.0/common-component/component-info/"+e;return this.http.get(n,{headers:o}).pipe(m.map(function(e){if(e){var t=new g;return t.init(e),t}}))},j.prototype.create=function(e,t){var o=this.resolver.resolveComponentFactory(y).create(this.injector);o.instance.componentInfo=e;var n=this.util.getModalConfig(o.instance.btnRef,t),i=this.modalService.show(o,n);return o.instance.dialog=i,{confirmEvent:o.instance.confirmEmitter,closeEvent:o.instance.closeEmitter}},j.decorators=[{type:c.Injectable,args:[{providedIn:"root"}]}],j.ctorParameters=function(){return[{type:c.ComponentFactoryResolver},{type:c.Injector},{type:u},{type:p.BsModalService},{type:l.HttpClient}]},j.ngInjectableDef=c.defineInjectable({factory:function(){return new j(c.inject(c.ComponentFactoryResolver),c.inject(c.INJECTOR),c.inject(u),c.inject(p.BsModalService),c.inject(l.HttpClient))},token:j,providedIn:"root"}),j);function j(e,t,o,n,i){this.resolver=e,this.injector=t,this.util=o,this.modalService=n,this.http=i}var E=(S.decorators=[{type:c.NgModule,args:[{declarations:[y],imports:[a.NotifyModule,t.CommonModule,o.ButtonsModule,i.GridModule,l.HttpClientModule,p.ModalModule.forRoot(),r.FarrisDialogModule,s.MessagerModule.forRoot()],entryComponents:[y],providers:[w,I,u],exports:[y]}]}],S);function S(){}function x(){}e.CommonComponentUiModule=E,e.CommonComponentSelectorComponent=y,e.CommonComponentUiRTService=w,e.CommonComponentUiDTService=I,e.SelectorResult=x,e.ɵa=u,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=gsp-cmp-ccmp-ui.umd.min.js.map