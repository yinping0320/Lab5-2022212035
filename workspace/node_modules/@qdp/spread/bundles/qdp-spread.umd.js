(function (global, factory) {
    typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, require('@farris/ui-notify'), require('@gsp-svc/cloudprint'), require('rxjs/operators'), require('@farris/ui-messager'), require('@qdp/localize'), require('lodash-es'), require('@farris/command-services'), require('@ecp-caf/caf-common'), require('rxjs'), require('@angular/core'), require('@angular/common'), require('@farris/ui-loading'), require('@angular/forms'), require('@farris/ui-input-group'), require('@farris/ui-dropdown'), require('@qdp/common'), require('@farris/ui-combo-list')) :
    typeof define === 'function' && define.amd ? define('@qdp/spread', ['exports', '@farris/ui-notify', '@gsp-svc/cloudprint', 'rxjs/operators', '@farris/ui-messager', '@qdp/localize', 'lodash-es', '@farris/command-services', '@ecp-caf/caf-common', 'rxjs', '@angular/core', '@angular/common', '@farris/ui-loading', '@angular/forms', '@farris/ui-input-group', '@farris/ui-dropdown', '@qdp/common', '@farris/ui-combo-list'], factory) :
    (factory((global.qdp = global.qdp || {}, global.qdp.spread = {}),global.uiNotify,global.cloudprint,global.rxjs.operators,global.uiMessager,global.localize,global.lodashEs,global.commandServices,global.cafCommon,global.rxjs,global.ng.core,global.ng.common,global.uiLoading,global.ng.forms,global.uiInputGroup,global.uiDropdown,global.common$1,global.uiComboList));
}(this, (function (exports,uiNotify,cloudprint,operators,uiMessager,localize,lodashEs,commandServices,cafCommon,rxjs,core,common,uiLoading,forms,uiInputGroup,uiDropdown,common$1,uiComboList) { 'use strict';

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
     */
    var ServicesUtils = /** @class */ (function () {
        function ServicesUtils() {
        }
        /**
         * @param {?} key
         * @param {?} value
         * @return {?}
         */
        ServicesUtils.setServices = /**
         * @param {?} key
         * @param {?} value
         * @return {?}
         */
            function (key, value) {
                ServicesUtils.ServicesMap.set(key, value);
            };
        /**
         * @param {?} key
         * @return {?}
         */
        ServicesUtils.getServices = /**
         * @param {?} key
         * @return {?}
         */
            function (key) {
                return ServicesUtils.ServicesMap.get(key);
            };
        ServicesUtils.ServicesMap = new Map();
        return ServicesUtils;
    }());

    /*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */
    /* global Reflect, Promise */
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b)
                if (b.hasOwnProperty(p))
                    d[p] = b[p]; };
        return extendStatics(d, b);
    };
    function __extends(d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    }
    function __read(o, n) {
        var m = typeof Symbol === "function" && o[Symbol.iterator];
        if (!m)
            return o;
        var i = m.call(o), r, ar = [], e;
        try {
            while ((n === void 0 || n-- > 0) && !(r = i.next()).done)
                ar.push(r.value);
        }
        catch (error) {
            e = { error: error };
        }
        finally {
            try {
                if (r && !r.done && (m = i["return"]))
                    m.call(i);
            }
            finally {
                if (e)
                    throw e.error;
            }
        }
        return ar;
    }
    function __spread() {
        for (var ar = [], i = 0; i < arguments.length; i++)
            ar = ar.concat(__read(arguments[i]));
        return ar;
    }

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
     */
    var ParameterUtils = /** @class */ (function () {
        function ParameterUtils(_queryId, _funcInfoCache, _serviceCache) {
            this.queryId = _queryId;
            this.funcInfoCache = _funcInfoCache;
            this.cache = _serviceCache.cacheService;
        }
        /**
         * 创建参数
         * @param option 参数配置项
         * { queryId: 查询ID, controlType: 查询类型：list  treelist  crosstab, schemaId: 方案ID, qoManagerCode: 查询对象编号, extendCond: 扩展条件, pageIndex: 页索引, pageSize: 分页大小, filterCondition: 结果过滤条件, printIntegration: 打印配置, excelExportName: 导出Excel文件名 }
         * @returns
         */
        /**
         * 创建参数
         * @param {?} option 参数配置项
         * { queryId: 查询ID, controlType: 查询类型：list  treelist  crosstab, schemaId: 方案ID, qoManagerCode: 查询对象编号, extendCond: 扩展条件, pageIndex: 页索引, pageSize: 分页大小, filterCondition: 结果过滤条件, printIntegration: 打印配置, excelExportName: 导出Excel文件名 }
         * @return {?}
         */
        ParameterUtils.prototype.createParameters = /**
         * 创建参数
         * @param {?} option 参数配置项
         * { queryId: 查询ID, controlType: 查询类型：list  treelist  crosstab, schemaId: 方案ID, qoManagerCode: 查询对象编号, extendCond: 扩展条件, pageIndex: 页索引, pageSize: 分页大小, filterCondition: 结果过滤条件, printIntegration: 打印配置, excelExportName: 导出Excel文件名 }
         * @return {?}
         */
            function (option) {
                /** @type {?} */
                var tabId = this.bindCloseTabEvent();
                /** @type {?} */
                var entityData;
                if (this.cache.get(tabId)) {
                    entityData = JSON.stringify(this.cache.get(tabId));
                }
                else if (this.cache.get(option.queryId)) {
                    entityData = JSON.stringify(this.cache.get(option.queryId));
                }
                else {
                    entityData = JSON.stringify({ 'id': 'undefined_null' });
                }
                /** @type {?} */
                var params = {
                    entityData: entityData,
                    extendCond: this.cache.get(tabId + 'extendCond') ? this.cache.get(tabId + 'extendCond') : option.extendCond,
                    pageIndex: option.pageIndex ? option.pageIndex : 0,
                    pageSize: option.pageSize ? option.pageSize : 0,
                    schemaId: option.schemaId && option.schemaId !== 'prefab' ? option.schemaId : '1',
                    filterCond: option.filterCondition ? option.filterCondition : (this.cache.get(tabId + 'filtercondition') ? this.cache.get(tabId + 'filtercondition') : ''),
                    qoManagerCode: option.qoManagerCode ? option.qoManagerCode : '',
                    voCode: option.voId ? option.voId : '',
                };
                try {
                    /** @type {?} */
                    var parameterEntityData = JSON.parse(entityData);
                    if (parameterEntityData.hasOwnProperty('@filterExpressionString@')) {
                        /** @type {?} */
                        var filterExpression = params && params.filterCond ? JSON.parse(params.filterCond) : null;
                        if (!filterExpression) {
                            params.filterCond = parameterEntityData['@filterExpressionString@'];
                        }
                        else {
                            /** @type {?} */
                            var advanceFilterExpression = JSON.parse(parameterEntityData['@filterExpressionString@']);
                            advanceFilterExpression.expressItems = advanceFilterExpression.expressItems.concat(filterExpression.expressItems);
                            params.filterCond = JSON.stringify(advanceFilterExpression);
                        }
                    }
                }
                catch (e) {
                }
                if (option.controlType) {
                    params['controlType'] = option.controlType;
                }
                if (option.excelExportName) {
                    params['excelExportName'] = option.excelExportName;
                }
                if (option.printIntegration) {
                    params['printIntegration'] = option.printIntegration ? JSON.stringify(option.printIntegration) : '';
                }
                if (option.multiSheets) {
                    params['multiSheets'] = option.multiSheets && option.multiSheets.length ? option.multiSheets.join(",") : '';
                }
                if (option.curSheet) {
                    params['curSheet'] = option.curSheet;
                }
                if (option.multiSheetsSchemaIds) {
                    params['multiSheetsSchemaIds'] = option.multiSheetsSchemaIds ? JSON.stringify(option.multiSheetsSchemaIds) : '';
                }
                if (option.groupType) {
                    params['groupType'] = option.groupType ? option.groupType : '';
                }
                if (option.queryId) {
                    params['queryId'] = option.queryId ? option.queryId : '';
                }
                if (common$1.RtfServices.getMenuParameter('enableQOExtends')) {
                    params['enableQOExtends'] = common$1.RtfServices.getMenuParameter('enableQOExtends');
                    params['qoId'] = ServicesUtils.getServices(common$1.RtfServices.getTabId(this.queryId) + 'qoId');
                }
                return params;
            };
        /**
         * 绑定功能菜单关闭事件
         */
        /**
         * 绑定功能菜单关闭事件
         * @return {?}
         */
        ParameterUtils.prototype.bindCloseTabEvent = /**
         * 绑定功能菜单关闭事件
         * @return {?}
         */
            function () {
                try {
                    /** @type {?} */
                    var tab_1 = gspframeworkService.rtf.session.getCommonVariable();
                    gspframeworkService.rtf.frmEvent.eventListener('beforeFuncCloseEvent', this.clearParametersCache.bind(this), tab_1);
                    /** @type {?} */
                    var index = this.funcInfoCache.funcIds.findIndex(( /**
                     * @param {?} el
                     * @return {?}
                     */function (el) { return el === tab_1.tabId; }));
                    if (index < 0) {
                        this.funcInfoCache.funcIds.push(tab_1.tabId);
                    }
                    return tab_1.tabId + common$1.RtfServices.getInSuiteFrmUUID();
                }
                catch (e) {
                }
            };
        /**
         * 清除查询缓存
         */
        /**
         * 清除查询缓存
         * @return {?}
         */
        ParameterUtils.prototype.clearParametersCache = /**
         * 清除查询缓存
         * @return {?}
         */
            function () {
                /** @type {?} */
                var tabId = arguments[0].tabId;
                if (this.queryId) {
                    this.cache.set(this.queryId, '');
                }
                this.cache.set(tabId, '');
                this.cache.set(tabId + 'renderMode', '');
                /** @type {?} */
                var index = this.funcInfoCache.funcIds.findIndex(( /**
                 * @param {?} el
                 * @return {?}
                 */function (el) { return el === tabId; }));
                if (index >= 0) {
                    this.funcInfoCache.funcIds.splice(index, 1);
                    index = this.funcInfoCache.firstLoadCache.findIndex(( /**
                     * @param {?} el
                     * @return {?}
                     */function (el) { return el === tabId; }));
                    if (index >= 0) {
                        this.funcInfoCache.firstLoadCache.splice(index, 1);
                    }
                    gspframeworkService.rtf.func.close(arguments[0]);
                }
            };
        return ParameterUtils;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
     */
    var RenderExtendsUtils = /** @class */ (function () {
        function RenderExtendsUtils(_queryId) {
            this.init(_queryId);
        }
        /**
         * @private
         * @param {?} _queryId
         * @return {?}
         */
        RenderExtendsUtils.prototype.init = /**
         * @private
         * @param {?} _queryId
         * @return {?}
         */
            function (_queryId) {
                this.dataRenderExtendService = ServicesUtils.getServices('dataRenderExtendService' + _queryId);
                this.renderExtends = ServicesUtils.getServices('renderExtends' + _queryId);
            };
        /**
       * 执行查询扩展
       */
        /**
         * 执行查询扩展
         * @param {?} extendCode
         * @param {?} extendName
         * @param {?} extendData
         * @param {?} control
         * @return {?}
         */
        RenderExtendsUtils.prototype.runRenderExtends = /**
         * 执行查询扩展
         * @param {?} extendCode
         * @param {?} extendName
         * @param {?} extendData
         * @param {?} control
         * @return {?}
         */
            function (extendCode, extendName, extendData, control) {
                /** @type {?} */
                var $event = this.createRenderExtendParams({
                    eventCode: extendCode,
                    // 'beforeQueryData',
                    eventName: extendName,
                    // this.localizeService.getValue('spread.message.extend.query.before'),
                    data: extendData,
                    // params,
                    spread: control,
                    // obj.spread
                    control: control // obj.spread
                });
                if (extendCode === 'beforeQueryData') {
                    if (this.dataRenderExtendService && this.dataRenderExtendService.beforeQueryData) {
                        this.dataRenderExtendService.beforeQueryData($event);
                    }
                    else {
                        if (this.renderExtends && this.renderExtends.beforeQueryData) {
                            this.renderExtends.beforeQueryData($event);
                        }
                    }
                }
                else if (extendCode === 'beforeLoadData') {
                    if (this.dataRenderExtendService && this.dataRenderExtendService.beforeLoadData) {
                        this.dataRenderExtendService.beforeLoadData($event);
                    }
                    else {
                        if (this.renderExtends && this.renderExtends.beforeQueryData) {
                            this.renderExtends.beforeLoadData($event);
                        }
                    }
                }
                else if (extendCode === 'afterLoadData') {
                    if (this.dataRenderExtendService && this.dataRenderExtendService.afterLoadData) {
                        this.dataRenderExtendService.afterLoadData($event);
                    }
                    else {
                        if (this.renderExtends && this.renderExtends.beforeQueryData) {
                            this.renderExtends.afterLoadData($event);
                        }
                    }
                }
                return $event['data'];
            };
        /**
         * @param {?} obj
         * @return {?}
         */
        RenderExtendsUtils.prototype.createRenderExtendParams = /**
         * @param {?} obj
         * @return {?}
         */
            function (obj) {
                return {
                    eventCode: obj.eventCode,
                    eventName: obj.eventName,
                    data: obj.data,
                    control: obj.control,
                    spread: obj.spread || undefined
                };
            };
        return RenderExtendsUtils;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
     */
    var SchemaUtils = /** @class */ (function () {
        function SchemaUtils(_serviceCache) {
            this.init(_serviceCache);
        }
        /**
         * @private
         * @param {?} _serviceCache
         * @return {?}
         */
        SchemaUtils.prototype.init = /**
         * @private
         * @param {?} _serviceCache
         * @return {?}
         */
            function (_serviceCache) {
                this.schemaManager = _serviceCache.schemaManagerService;
                this.cacheService = _serviceCache.cacheService;
            };
        /**
         * 获取格式方案信息
         * @param option 参数配置项
         * { schemaId: 方案ID, schemaValue: 格式方案（交叉表時快速設置時使用）, controlType: 查询类型：list  treelist  crosstab, queryId: 查询ID, queryRelativeUrl：eapi基础uri, groupType: 方案分组标识 }
         * @returns 方案列表
         */
        /**
         * 获取格式方案信息
         * @param {?} option 参数配置项
         * { schemaId: 方案ID, schemaValue: 格式方案（交叉表時快速設置時使用）, controlType: 查询类型：list  treelist  crosstab, queryId: 查询ID, queryRelativeUrl：eapi基础uri, groupType: 方案分组标识 }
         * @return {?} 方案列表
         */
        SchemaUtils.prototype.getSchemaInfo = /**
         * 获取格式方案信息
         * @param {?} option 参数配置项
         * { schemaId: 方案ID, schemaValue: 格式方案（交叉表時快速設置時使用）, controlType: 查询类型：list  treelist  crosstab, queryId: 查询ID, queryRelativeUrl：eapi基础uri, groupType: 方案分组标识 }
         * @return {?} 方案列表
         */
            function (option) {
                /** @type {?} */
                var self = this;
                option.schemaId = option.schemaId === 'prefab' || option.schemaId === '1'
                    ? '1'
                    : option.schemaValue && option.schemaValue.id && option.controlType === 'crosstab'
                        ? option.schemaValue.id
                        : option.schemaId;
                if (!option.schemaId) {
                    return self.getDefaultSchemaInfo(option);
                }
                else {
                    /** @type {?} */
                    var organizationId = this.cacheService.get(common$1.RtfServices.getTabId(option.queryId) + 'organizationId') || '';
                    /** @type {?} */
                    var result$ = this.schemaManager.getSchema(option.schemaId, option.queryId, option.queryRelativeUrl, option.groupType, organizationId, option.fromCache);
                    return result$.pipe(operators.switchMap(( /**
                     * @param {?} schemaValue
                     * @return {?}
                     */function (schemaValue) {
                        if (schemaValue && schemaValue['id']) {
                            return rxjs.of(schemaValue);
                        }
                    })));
                }
            };
        /**
         * 获取默认格式方案
         * @param option 参数配置项
         * { queryId：查询ID, queryRelativeUrl：eapi基础uri, groupType: 方案分组标识 }
         * @returns 默认格式方案
         */
        /**
         * 获取默认格式方案
         * @param {?} option 参数配置项
         * { queryId：查询ID, queryRelativeUrl：eapi基础uri, groupType: 方案分组标识 }
         * @return {?} 默认格式方案
         */
        SchemaUtils.prototype.getDefaultSchemaInfo = /**
         * 获取默认格式方案
         * @param {?} option 参数配置项
         * { queryId：查询ID, queryRelativeUrl：eapi基础uri, groupType: 方案分组标识 }
         * @return {?} 默认格式方案
         */
            function (option) {
                /** @type {?} */
                var organizationId = this.cacheService.get(common$1.RtfServices.getTabId(option.queryId) + 'organizationId') || '';
                return this.schemaManager.getDefaultSchema(option.queryId, option.queryRelativeUrl, option.groupType, organizationId);
            };
        return SchemaUtils;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
     */
    var SpreadStyleUtils = /** @class */ (function () {
        function SpreadStyleUtils(_queryId, _controlType, _jointsearchInfoList, _serviceCache) {
            this.dataStyleArray = [];
            this.dataRowHeightArray = [];
            this.dataColInfoArray = [];
            this.footerStyleArray = [];
            this.footerRowHeightArray = [];
            this.footerSpansArray = [];
            this.footerDataArray = [];
            this.hyperLinkQuery = {};
            this.autoFitColumnIndex = 0;
            this.valueHeaderRowCount = 0; // 值维度数量
            // 值维度数量
            this.valueHeaderRowArray = [];
            this.rowHeadersColumnCount = 0; // 行标题列数
            // 行标题列数
            this.rowHeaderRowArray = [];
            this.joinParam = {};
            this.queryId = _queryId;
            this.type = _controlType;
            this.jointsearchInfoList = _jointsearchInfoList;
            this.cache = _serviceCache.cacheService;
            this.loadService = _serviceCache.loadingService;
            this.msgService = _serviceCache.msgService;
            this.localizeService = _serviceCache.localizeService;
            this.schemaManager = _serviceCache.schemaManagerService;
            this.formErrorService = _serviceCache.formErrorService;
            this.lcpService = _serviceCache.lcpService;
        }
        /**
         * @param {?} schema
         * @param {?} sheet
         * @return {?}
         */
        SpreadStyleUtils.prototype.setAutoFitColumn = /**
         * @param {?} schema
         * @param {?} sheet
         * @return {?}
         */
            function (schema, sheet) {
                var _this = this;
                if (schema && schema.schemaValue && schema.schemaValue.columnOption && schema.schemaValue.columnOption.colList && schema.schemaValue.columnOption.colList.length) {
                    this.autoFitColumnIndex = 0;
                    schema.schemaValue.columnOption.colList.forEach(( /**
                     * @param {?} col
                     * @return {?}
                     */function (col) {
                        _this.recursionAutoFitColumn(col, null, sheet);
                    }));
                }
            };
        /**
         * @private
         * @param {?} column
         * @param {?} childList
         * @param {?} sheet
         * @return {?}
         */
        SpreadStyleUtils.prototype.recursionAutoFitColumn = /**
         * @private
         * @param {?} column
         * @param {?} childList
         * @param {?} sheet
         * @return {?}
         */
            function (column, childList, sheet) {
                var _this = this;
                if (column) {
                    if (column.childList && column.childList.length) {
                        this.recursionAutoFitColumn(null, column.childList, sheet);
                    }
                    else {
                        if (column.autoFit) {
                            sheet.autoFitColumn(this.autoFitColumnIndex);
                        }
                        this.autoFitColumnIndex += 1;
                    }
                }
                else {
                    childList.forEach(( /**
                     * @param {?} col
                     * @return {?}
                     */function (col) {
                        if (col.childList && col.childList.length) {
                            _this.recursionAutoFitColumn(null, col.childList, sheet);
                        }
                        else {
                            if (col.autoFit) {
                                sheet.autoFitColumn(_this.autoFitColumnIndex);
                            }
                            _this.autoFitColumnIndex += 1;
                        }
                    }));
                }
            };
        /**
         * @param {?} sheet
         * @return {?}
         */
        SpreadStyleUtils.prototype.cacheStyle = /**
         * @param {?} sheet
         * @return {?}
         */
            function (sheet) {
                this.dataStyleArray = [];
                this.dataRowHeightArray = [];
                this.dataColInfoArray = [];
                this.footerStyleArray = [];
                this.footerRowHeightArray = [];
                this.footerSpansArray = [];
                this.footerDataArray = [];
                // 缓存区域样式信息
                for (var r = 0; r < sheet.getRowCount(); r++) {
                    /** @type {?} */
                    var columnStyleArray = new Array();
                    /** @type {?} */
                    var dataArray = new Array();
                    for (var c = 0; c < sheet.getColumnCount(); c++) {
                        if (r === 0) {
                            /** @type {?} */
                            var formatter = '';
                            if (sheet.getFormatter(r, c, GC.Spread.Sheets.SheetArea.viewport)) {
                                formatter = sheet.getFormatter(r, c, GC.Spread.Sheets.SheetArea.viewport);
                            }
                            /** @type {?} */
                            var colHeaderCount = sheet.getRowCount(GC.Spread.Sheets.SheetArea.colHeader);
                            /** @type {?} */
                            var colInfo = {
                                name: sheet.getCell(r, c, GC.Spread.Sheets.SheetArea.viewport).value(),
                                size: sheet.getColumnWidth(c, GC.Spread.Sheets.SheetArea.viewport),
                                visible: sheet.getColumnVisible(c, GC.Spread.Sheets.SheetArea.viewport),
                                resizable: sheet.getColumnResizable(c, GC.Spread.Sheets.SheetArea.viewport),
                                formatter: formatter.indexOf('&') >= 0 ? new MyNumFormatter(formatter) : formatter,
                                displayName: sheet.getCell((colHeaderCount - 1), c, GC.Spread.Sheets.SheetArea.colHeader).value()
                            };
                            this.dataColInfoArray.push(colInfo);
                        }
                        /** @type {?} */
                        var style = sheet.getStyle(r, c, GC.Spread.Sheets.SheetArea.viewport);
                        if (style == null) {
                            style = new GC.Spread.Sheets.Style();
                            style.locked = true;
                        }
                        else {
                            style.locked = true;
                        }
                        if (style && style.formatter && style.formatter.indexOf('&') >= 0) {
                            style.formatter = new MyNumFormatter(style.formatter);
                        }
                        columnStyleArray.push(style);
                        /** @type {?} */
                        var text = sheet.getValue(r, c, GC.Spread.Sheets.SheetArea.viewport)
                            || sheet.getText(r, c, GC.Spread.Sheets.SheetArea.viewport)
                            || '';
                        dataArray.push(text);
                    }
                    if (r === 0) {
                        this.dataRowHeightArray.push(sheet.getRowHeight(r));
                        this.dataStyleArray.push(columnStyleArray);
                    }
                    else {
                        this.footerRowHeightArray.push(sheet.getRowHeight(r));
                        this.footerStyleArray.push(columnStyleArray);
                        this.footerDataArray.push(dataArray);
                    }
                }
                // 缓存span
                /** @type {?} */
                var spans = sheet.getSpans();
                if (spans && spans.length) {
                    // tslint:disable-next-line:prefer-for-of
                    for (var i = 0; i < spans.length; i++) {
                        if (spans[i].row > 0) {
                            this.footerSpansArray.push(spans[i]);
                        }
                    }
                }
                sheet.deleteRows(1, sheet.getRowCount() - 1);
            };
        /**
         * @param {?} sheet
         * @param {?} schema
         * @param {?=} showZero
         * @return {?}
         */
        SpreadStyleUtils.prototype.applyStyle = /**
         * @param {?} sheet
         * @param {?} schema
         * @param {?=} showZero
         * @return {?}
         */
            function (sheet, schema, showZero) {
                var _this = this;
                /** @type {?} */
                var rowCount = sheet.getRowCount();
                /** @type {?} */
                var colCount = sheet.getColumnCount();
                /** @type {?} */
                var footerCount = this.footerRowHeightArray.length;
                sheet.addRows(rowCount, footerCount);
                /** @type {?} */
                var index = 0;
                /** @type {?} */
                var groupFieldCache = [];
                /** @type {?} */
                var groupFieldValueCache = [];
                /** @type {?} */
                var groupRowCache = [];
                /** @type {?} */
                var groupTreeLevel = {};
                /** @type {?} */
                var columns = sheet.toJSON().columns;
                this.getGroupField(groupFieldCache, schema);
                /** @type {?} */
                var formatFieldCache = [];
                this.getFormatField(formatFieldCache, schema);
                this.getIsRedColumns(formatFieldCache, schema);
                /** @type {?} */
                var isRedColumns = {
                    colIndex: 0,
                    isRedColumns: []
                };
                this.getIsRedColumns(schema, isRedColumns);
                /** @type {?} */
                var sheetColumns = sheet.toJSON().columns;
                var _loop_1 = function (r) {
                    if (formatFieldCache && formatFieldCache.length && r < rowCount) {
                        formatFieldCache.forEach(( /**
                         * @param {?} item
                         * @return {?}
                         */function (item) {
                            /** @type {?} */
                            var dataItem = sheet.getDataItem(r);
                            /** @type {?} */
                            var precision = dataItem[item.formatField] - 0;
                            /** @type {?} */
                            var numberFormat = item.formatter && (item.formatter.indexOf('#,###') >= 0 || item.formatter.indexOf('#,##0') >= 0) ? '#,##0.' : '0.';
                            if (_this.isNumber(precision)) {
                                for (var p = 0; p < precision; p++) {
                                    numberFormat += '0';
                                }
                            }
                            /** @type {?} */
                            var formatColIndex = sheetColumns.findIndex(( /**
                             * @param {?} el
                             * @return {?}
                             */function (el) { return el.name == item.sourceField; }));
                            if (formatColIndex >= 0 && numberFormat != '0.' && numberFormat != '#,##0.') {
                                sheet.getCell(r, formatColIndex).formatter(numberFormat);
                            }
                        }));
                    }
                    var _loop_2 = function (c) {
                        if (r === 0 && !sheet.getColumnVisible(index)) {
                            index += 1;
                        }
                        if (r >= rowCount) {
                            if (c === 0) {
                                sheet.setStyle(r, c, this_1.footerStyleArray[r - rowCount][c]);
                                if (this_1.footerDataArray && this_1.footerDataArray.length) {
                                    sheet.setValue(r, c, this_1.footerDataArray[r - rowCount][c]);
                                }
                                sheet.setRowHeight(r, this_1.footerRowHeightArray[r - rowCount]);
                                if (this_1.footerSpansArray && this_1.footerSpansArray.length) {
                                    sheet.addSpan(r, this_1.footerSpansArray[0].col, this_1.footerSpansArray[0].rowCount, this_1.footerSpansArray[0].colCount);
                                }
                            }
                        }
                        else {
                            /** @type {?} */
                            var formatter = sheet.getFormatter(r, c, GC.Spread.Sheets.SheetArea.viewport);
                            if (formatter && formatter.indexOf && formatter.indexOf('/') >= 0 && formatter.indexOf(';') >= 0) {
                                /** @type {?} */
                                var cellValue = this_1.logicFormat(formatter, sheet.getValue(r, c));
                                sheet.setText(r, c, cellValue);
                            }
                            if (formatter && typeof formatter === 'string' && (formatter.indexOf('yy') >= 0 || formatter.indexOf('MM') >= 0 || formatter.indexOf('dd') >= 0 || formatter.indexOf('HH') >= 0 || formatter.indexOf('mm') >= 0 || formatter.indexOf('ss') >= 0)) {
                                if (sheet.getDataItem(r).hasOwnProperty("qdp_data_flag")) {
                                    sheet.setFormatter(r, c, '');
                                }
                            }
                            if (isRedColumns.isRedColumns.findIndex(( /**
                             * @param {?} el
                             * @return {?}
                             */function (el) { return el.colIndex == c; })) >= 0 && this_1.isNumber(sheet.getCell(r, c).value()) && (sheet.getCell(r, c).value() - 0 < 0)) {
                                sheet.getCell(r, c).foreColor('red');
                            }
                            if (!showZero) {
                                if (!showZero && columns && columns.length) {
                                    if (columns[c].name === 'treeLevel' || columns[c].name === 'isDetail') {
                                        return "continue";
                                    }
                                    if (sheet.getCell(r, c).value() === 0 || sheet.getCell(r, c).value() == '0') {
                                        sheet.getCell(r, c).value('');
                                    }
                                }
                            }
                        }
                    };
                    for (var c = 0; c < colCount; c++) {
                        _loop_2(c);
                    }
                    if (r < rowCount) {
                        // 设置行高
                        sheet.setRowHeight(r, this_1.dataRowHeightArray[0]);
                        if (this_1.type === 'treelist') {
                            /** @type {?} */
                            var level = sheet.getDataItem(r)['treeLevel'];
                            /** @type {?} */
                            var isDetail = sheet.getDataItem(r)['isDetail'];
                            sheet.setCellType(r, index, new TreeCellType(null, false, level, isDetail));
                            sheet.getStyle(r, index).hAlign = 0;
                            sheet.getStyle(r, index).textIndent = level + 2;
                            for (var i = 0; i <= level; i++) {
                                sheet.rowOutlines.group(r, 1);
                            }
                        }
                        else if (this_1.type === 'list' && groupFieldCache.length) {
                            /** @type {?} */
                            var filterCondition = {};
                            if (groupRowCache.findIndex(( /**
                             * @param {?} x
                             * @return {?}
                             */function (x) { return x === r; })) >= 0) {
                                return "continue";
                            }
                            for (var c = 0; c < colCount; c++) {
                                if (sheet.getDataItem(r).hasOwnProperty("qdp_data_flag") && (sheet.getDataItem(r)["qdp_data_flag"] + '') === (4 + '')) {
                                    if (sheet.getFormatter(r, c) && (sheet.getFormatter(r, c).toString().indexOf('y') >= 0 || sheet.getFormatter(r, c).toString().indexOf('d') >= 0 || sheet.getFormatter(r, c).toString().indexOf('M') >= 0)) {
                                        sheet.setFormatter(r, c, '');
                                    }
                                }
                            }
                            /** @type {?} */
                            var addRowsCache = [];
                            var _loop_3 = function (i) {
                                /** @type {?} */
                                var addRowIndex = r + addRowsCache.length;
                                // const groupField = groupFieldCache[i];
                                /** @type {?} */
                                var fieldIndex = this_1.dataColInfoArray.findIndex(( /**
                                 * @param {?} x
                                 * @return {?}
                                 */function (x) { return x.name === groupFieldCache[i]; }));
                                filterCondition = {};
                                for (var f = 0; f <= i; f++) {
                                    filterCondition[groupFieldCache[f]] = sheet.getDataItem(addRowIndex)[groupFieldCache[f]];
                                }
                                /** @type {?} */
                                var filterResult = lodashEs.filter(groupFieldValueCache, filterCondition);
                                if ((!filterResult || !filterResult.length) && !sheet.getDataItem(addRowIndex).hasOwnProperty("qdp_data_flag")) {
                                    // const groupFieldValue = {};
                                    // groupFieldValue[groupField] = filterCondition[groupField];
                                    groupFieldValueCache.push(filterCondition);
                                    /** @type {?} */
                                    var style = this_1.dataStyleArray[0][fieldIndex];
                                    style.hAlign = 0;
                                    style.cellType = null;
                                    style.backColor = '#F4F7FA';
                                    sheet.addRows(addRowIndex, 1);
                                    sheet.setRowHeight(addRowIndex, this_1.dataRowHeightArray[0]);
                                    sheet.setStyle(addRowIndex, index, style);
                                    sheet.getCell(addRowIndex, index).value(filterCondition[groupFieldCache[i]]);
                                    sheet.addSpan(addRowIndex, index, 1, (colCount - index));
                                    sheet.getCell(addRowIndex, index).textIndent((i + 1) * 2);
                                    groupTreeLevel[addRowIndex + ''] = { treeLevel: i, isDetail: 0 };
                                    if (i === (groupFieldCache.length - 1)) {
                                        groupTreeLevel[(addRowIndex + 1) + ''] = { treeLevel: groupFieldCache.length, isDetail: 1 };
                                    }
                                    rowCount += 1;
                                    addRowsCache.push(i);
                                    groupRowCache.push(addRowIndex);
                                }
                                else {
                                    if (sheet.getDataItem(addRowIndex).hasOwnProperty("qdp_data_flag") && (sheet.getDataItem(addRowIndex)["qdp_data_flag"] + '') === (3 + '')) {
                                        return "continue";
                                    }
                                    if (i === (groupFieldCache.length - 1)) {
                                        groupTreeLevel[(addRowIndex + 1) + ''] = { treeLevel: groupFieldCache.length, isDetail: 1 };
                                    }
                                }
                            };
                            for (var i = 0; i < groupFieldCache.length; i++) {
                                _loop_3(i);
                            }
                        }
                    }
                };
                var this_1 = this;
                for (var r = 0; r < (rowCount + footerCount); r++) {
                    _loop_1(r);
                }
                for (var r = 0; r < rowCount; r++) {
                    if (!groupTreeLevel.hasOwnProperty(r)) {
                        break;
                    }
                    for (var t = 0; t <= groupTreeLevel[r + ''].treeLevel; t++) {
                        sheet.rowOutlines.group(r, 1);
                    }
                    sheet.setCellType(r, index, new TreeCellType(null, false, groupTreeLevel[r + ''].treeLevel, groupTreeLevel[r + ''].isDetail));
                }
                if (this.type !== 'crosstab' && this.getShowFilterRow(schema)) {
                    this.filterRow(sheet);
                }
            };
        /**
         * @param {?} groupColCache
         * @param {?} schema
         * @return {?}
         */
        SpreadStyleUtils.prototype.getGroupField = /**
         * @param {?} groupColCache
         * @param {?} schema
         * @return {?}
         */
            function (groupColCache, schema) {
                var _this = this;
                if (schema && schema.schemaValue && schema.schemaValue.columnOption && schema.schemaValue.columnOption.colList && schema.schemaValue.columnOption.colList.length) {
                    this.autoFitColumnIndex = 0;
                    schema.schemaValue.columnOption.colList.forEach(( /**
                     * @param {?} col
                     * @return {?}
                     */function (col) {
                        _this.recursionGetGroupColumn(groupColCache, col, null);
                    }));
                }
            };
        /**
         * @param {?} schema
         * @param {?} params
         * @return {?}
         */
        SpreadStyleUtils.prototype.getIsRedColumns = /**
         * @param {?} schema
         * @param {?} params
         * @return {?}
         */
            function (schema, params) {
                var _this = this;
                if (schema && schema.schemaValue && schema.schemaValue.columnOption && schema.schemaValue.columnOption.colList && schema.schemaValue.columnOption.colList.length) {
                    schema.schemaValue.columnOption.colList.forEach(( /**
                     * @param {?} col
                     * @return {?}
                     */function (col) {
                        _this.recursiveIsRedColumn(col, null, params);
                    }));
                }
            };
        /**
         * @param {?} fieldCache
         * @param {?} schema
         * @return {?}
         */
        SpreadStyleUtils.prototype.getFormatField = /**
         * @param {?} fieldCache
         * @param {?} schema
         * @return {?}
         */
            function (fieldCache, schema) {
                var _this = this;
                if (schema && schema.schemaValue && schema.schemaValue.columnOption && schema.schemaValue.columnOption.colList && schema.schemaValue.columnOption.colList.length) {
                    this.autoFitColumnIndex = 0;
                    schema.schemaValue.columnOption.colList.forEach(( /**
                     * @param {?} col
                     * @return {?}
                     */function (col) {
                        _this.recursionGetFormatColumn(fieldCache, col, null);
                    }));
                }
            };
        /**
         * @param {?} schema
         * @return {?}
         */
        SpreadStyleUtils.prototype.getShowHeaderSort = /**
         * @param {?} schema
         * @return {?}
         */
            function (schema) {
                try {
                    if (schema && schema.schemaValue && schema.schemaValue.otherOption && schema.schemaValue.otherOption.showHeaderSort != null && schema.schemaValue.otherOption.showHeaderSort != undefined) {
                        return schema.schemaValue.otherOption.showHeaderSort;
                    }
                    return true;
                }
                catch (e) {
                    return true;
                }
            };
        /**
         * @param {?} schema
         * @return {?}
         */
        SpreadStyleUtils.prototype.getShowFilterRow = /**
         * @param {?} schema
         * @return {?}
         */
            function (schema) {
                try {
                    if (schema && schema.schemaValue && schema.schemaValue.otherOption && schema.schemaValue.otherOption.showFilterRow != null && schema.schemaValue.otherOption.showFilterRow != undefined) {
                        return schema.schemaValue.otherOption.showFilterRow;
                    }
                    return true;
                }
                catch (e) {
                    return true;
                }
            };
        /**
         * @param {?} schema
         * @return {?}
         */
        SpreadStyleUtils.prototype.getMergeCell = /**
         * @param {?} schema
         * @return {?}
         */
            function (schema) {
                try {
                    if (schema && schema.schemaValue && schema.schemaValue.otherOption && schema.schemaValue.otherOption.mergeCell != null && schema.schemaValue.otherOption.mergeCell != undefined) {
                        return schema.schemaValue.otherOption.mergeCell;
                    }
                    return false;
                }
                catch (e) {
                    return false;
                }
            };
        /**
         * @private
         * @param {?} fieldCache
         * @param {?} column
         * @param {?} childList
         * @return {?}
         */
        SpreadStyleUtils.prototype.recursionGetFormatColumn = /**
         * @private
         * @param {?} fieldCache
         * @param {?} column
         * @param {?} childList
         * @return {?}
         */
            function (fieldCache, column, childList) {
                var _this = this;
                if (column) {
                    if (column.childList && column.childList.length) {
                        this.recursionGetFormatColumn(fieldCache, null, column.childList);
                    }
                    else {
                        if (column.formatType == 1 && column.formatField) {
                            fieldCache.push({ sourceField: column.bindField, formatField: column.formatField, formatter: column.formattor });
                        }
                    }
                }
                else {
                    childList.forEach(( /**
                     * @param {?} col
                     * @return {?}
                     */function (col) {
                        if (col.childList && col.childList.length) {
                            _this.recursionGetFormatColumn(fieldCache, null, col.childList);
                        }
                        else {
                            if (col.formatType == 1 && col.formatField) {
                                fieldCache.push({ sourceField: col.bindField, formatField: col.formatField, formatter: col.formattor });
                            }
                        }
                    }));
                }
            };
        /**
         * @private
         * @param {?} groupColCache
         * @param {?} column
         * @param {?} childList
         * @return {?}
         */
        SpreadStyleUtils.prototype.recursionGetGroupColumn = /**
         * @private
         * @param {?} groupColCache
         * @param {?} column
         * @param {?} childList
         * @return {?}
         */
            function (groupColCache, column, childList) {
                var _this = this;
                if (column) {
                    if (column.childList && column.childList.length) {
                        this.recursionGetGroupColumn(groupColCache, null, column.childList);
                    }
                    else {
                        if (column.isGroup) {
                            groupColCache.push(column.bindField);
                        }
                    }
                }
                else {
                    childList.forEach(( /**
                     * @param {?} col
                     * @return {?}
                     */function (col) {
                        if (col.childList && col.childList.length) {
                            _this.recursionGetGroupColumn(groupColCache, null, col.childList);
                        }
                        else {
                            if (col.isGroup) {
                                groupColCache.push(col.bindField);
                            }
                        }
                    }));
                }
            };
        /**
         * @param {?} formattor
         * @param {?} cellValue
         * @return {?}
         */
        SpreadStyleUtils.prototype.logicFormat = /**
         * @param {?} formattor
         * @param {?} cellValue
         * @return {?}
         */
            function (formattor, cellValue) {
                /** @type {?} */
                var str = formattor.split(';');
                /** @type {?} */
                var real = str[0].split('/');
                /** @type {?} */
                var disp = str[1].split('/');
                for (var i = 0; i < real.length; i++) {
                    // tslint:disable-next-line:triple-equals
                    if (real[i] == (cellValue + '')) {
                        cellValue = disp[i];
                        break;
                    }
                }
                return cellValue;
            };
        /**
         * @param {?} sheet
         * @return {?}
         */
        SpreadStyleUtils.prototype.filterRow = /**
         * @param {?} sheet
         * @return {?}
         */
            function (sheet) {
                sheet.addRows(0, 1);
                for (var i = 0; i < sheet.getRowCount(); i++) {
                    sheet.getCell(i, 0, GC.Spread.Sheets.SheetArea.rowHeader).value(i == 0 ? '' : i);
                }
                sheet.setRowHeight(0, this.dataRowHeightArray[0]);
                for (var i = 0; i < sheet.getColumnCount(); i++) {
                    /** @type {?} */
                    var s = new GC.Spread.Sheets.Style();
                    s.fromJSON(this.dataStyleArray[0][i].toJSON());
                    s.locked = false;
                    s.formatter = '@';
                    sheet.setStyle(0, i, s);
                    sheet.setCellType(0, i, new FilterCellType(sheet));
                }
                /** @type {?} */
                var filter = new GC.Spread.Sheets.Filter.HideRowFilter(new GC.Spread.Sheets.Range(1, 0, sheet.getRowCount(), sheet.getColumnCount()));
                sheet.rowFilter(filter);
                filter.filterButtonVisible(false);
            };
        /**
         * @param {?} spread
         * @param {?} sheet
         * @return {?}
         */
        SpreadStyleUtils.prototype.linkField = /**
         * @param {?} spread
         * @param {?} sheet
         * @return {?}
         */
            function (spread, sheet) {
                try {
                    /** @type {?} */
                    var self_1 = this;
                    /** @type {?} */
                    var rowCount = sheet.getRowCount();
                    /** @type {?} */
                    var colCount = sheet.getColumnCount();
                    // const footerCount = this.footerRowHeightArray.length;
                    for (var r = 1; r < (rowCount); r++) {
                        /** @type {?} */
                        var dataItem = sheet.getDataItem(r);
                        if (dataItem.hasOwnProperty('dynamicPropSet') && dataItem.dynamicPropSet.hasOwnProperty('qdp_data_flag')) {
                            continue;
                        }
                        for (var c = 0; c < colCount; c++) {
                            /** @type {?} */
                            var joinSearch = JSON.parse(this.jointsearchInfoList['joinSearch']);
                            // tslint:disable-next-line:prefer-for-of
                            for (var i = 0; i < joinSearch.length; i++) {
                                /** @type {?} */
                                var el = joinSearch[i];
                                if (el.jointserachdisplaystyle === 2) {
                                    if (el.linkfield === this.dataColInfoArray[c].name) {
                                        if (!this.hyperLinkQuery[this.queryId]) {
                                            this.hyperLinkQuery[this.queryId] = {};
                                        }
                                        this.hyperLinkQuery[this.queryId][c + ''] = el;
                                        /** @type {?} */
                                        var h1 = new GC.Spread.Sheets.CellTypes.HyperLink();
                                        h1.text(h1.format(sheet.getCell(r, c).value(), this.dataColInfoArray[c].formatter));
                                        h1.activeOnClick(true);
                                        h1.onClickAction(( /**
                                         * @return {?}
                                         */function () {
                                            spread.commandManager().execute({
                                                cmd: 'dropdownquery',
                                                self: self_1
                                            });
                                        }));
                                        sheet.setCellType(r, c, h1, GC.Spread.Sheets.SheetArea.viewport);
                                    }
                                }
                            }
                        }
                    }
                    spread.commandManager().register('dropdownquery', {
                        canUndo: true,
                        execute: ( /**
                         * @param {?} context
                         * @param {?} options
                         * @param {?} isUndo
                         * @return {?}
                         */function (context, options, isUndo) {
                            /** @type {?} */
                            var row = context.getActiveSheet().getActiveRowIndex();
                            /** @type {?} */
                            var col = context.getActiveSheet().getActiveColumnIndex();
                            var _loop_4 = function (key) {
                                if (key === (col + '')) {
                                    /** @type {?} */
                                    var el_1 = options.self.hyperLinkQuery[options.self.queryId][key];
                                    /** @type {?} */
                                    var entityParam_1 = { 'id': 'null' };
                                    /** @type {?} */
                                    var paramMap_1 = new Map();
                                    /** @type {?} */
                                    var searchparas = JSON.parse(options.self.jointsearchInfoList['jointparam']).filter(( /**
                                     * @param {?} x
                                     * @return {?}
                                     */function (x) { return x.functionid === el_1['id']; }));
                                    /** @type {?} */
                                    var joinParam = options.self.cache.get(common$1.RtfServices.getTabId(options.self.queryId) + 'joinSearch');
                                    /** @type {?} */
                                    var dataItem = { 'id': 'null' };
                                    if (joinParam.controlType === 'crosstab') { // 交叉表
                                        var _loop_5 = function (i) {
                                            /** @type {?} */
                                            var value_1 = context.getActiveSheet().getValue(row, i, GC.Spread.Sheets.SheetArea.viewport);
                                            /** @type {?} */
                                            var name_1 = context.getActiveSheet().getValue(joinParam.colHeaderRowInfo.start, i, GC.Spread.Sheets.SheetArea.colHeader);
                                            /** @type {?} */
                                            var colInfo_1 = joinParam.colInfos.find(( /**
                                             * @param {?} x
                                             * @return {?}
                                             */function (x) { return x.dimension === 1 && x.name === name_1; })).bindField;
                                            dataItem[colInfo_1] = value_1;
                                        };
                                        // 获取行标题的数据
                                        for (var i = joinParam.rowHeaderColInfo.start; i < joinParam.rowHeaderColInfo.end; i++) {
                                            _loop_5(i);
                                        }
                                        // 获取列标题的数据
                                        for (var i = joinParam.colHeaderRowInfo.start; i < joinParam.colHeaderRowInfo.end; i++) {
                                            /** @type {?} */
                                            var value_2 = context.getActiveSheet().getValue(i, col, GC.Spread.Sheets.SheetArea.colHeader);
                                            /** @type {?} */
                                            var colInfo_2 = joinParam.colInfos.filter(( /**
                                             * @param {?} x
                                             * @return {?}
                                             */function (x) { return x.dimension === 2; }))[i - joinParam.colHeaderRowInfo.start].bindField;
                                            dataItem[colInfo_2] = value_2;
                                        }
                                        // 获取值标题的数据
                                        /** @type {?} */
                                        var value = context.getActiveSheet().getValue(row, col, GC.Spread.Sheets.SheetArea.viewport);
                                        /** @type {?} */
                                        var name_2 = context.getActiveSheet().getValue(joinParam.colHeaderRowInfo.end, col, GC.Spread.Sheets.SheetArea.colHeader);
                                        /** @type {?} */
                                        var colInfo = joinParam.colInfos.find(( /**
                                         * @param {?} x
                                         * @return {?}
                                         */function (x) { return x.dimension === 3 && x.name === name_2; }));
                                        if (colInfo) {
                                            colInfo = colInfo.bindField;
                                            dataItem[colInfo] = value;
                                        }
                                    }
                                    else {
                                        dataItem = context.getActiveSheet().getDataItem(row);
                                    }
                                    /** @type {?} */
                                    var currentSelectedItem_1 = dataItem;
                                    if (searchparas.length > 0) {
                                        searchparas.forEach(( /**
                                         * @param {?} value
                                         * @return {?}
                                         */function (value) {
                                            if (value.paravaluetype) { // 表达式
                                                if (value.paravalue.indexOf('getParameter(') >= 0) {
                                                    /** @type {?} */
                                                    var parameterKey = value.paravalue.replace(/'/g, '').replace(/"/g, '').replace(/getParameter\(/g, '').replace(/\)/g, '');
                                                    options.self.getQueryParameters(entityParam_1, paramMap_1, parameterKey, value.para);
                                                }
                                                else {
                                                    entityParam_1[value.para] = currentSelectedItem_1[value.paravalue];
                                                    paramMap_1.set(value.para, currentSelectedItem_1[value.paravalue]);
                                                }
                                            }
                                            else {
                                                entityParam_1[value.para] = value.paravalue;
                                                paramMap_1.set(value.para, value.paravalue);
                                            }
                                        }));
                                    }
                                    else {
                                        entityParam_1 = currentSelectedItem_1;
                                    }
                                    /** @type {?} */
                                    var op = {
                                        ParentSessionId: options.self.cache.get('session'),
                                        EntityParam: entityParam_1
                                    };
                                    /** @type {?} */
                                    var tabId = '';
                                    if (el_1.searchtype === 'func') {
                                        // 联查前
                                        /** @type {?} */
                                        var openMenuoptions = {
                                            'appType': 'menu',
                                            'funcId': el_1.functioncode,
                                            'tabId': common$1.EventBus.guid(),
                                            'appId': '',
                                            'appEntrance': '',
                                            'entityParams': op.entityParam,
                                            'queryStringParams': paramMap_1,
                                            'isNewTab': true
                                        };
                                        tabId = common$1.RtfServices.getFuncId(openMenuoptions);
                                        options.self.cache.set(tabId ? tabId : options.self.queryId, op.EntityParam);
                                        /** @type {?} */
                                        var menuSwitchControl = Object.assign({}, openMenuoptions['entityParams'], common$1.RtfServices.getMenuSwitchControlParameter(tabId));
                                        openMenuoptions['entityParams'] = menuSwitchControl;
                                        // 卡片塞进去params
                                        gspframeworkService.rtf.func.openMenu(openMenuoptions);
                                    }
                                    else if (el_1.searchtype === 'app') {
                                        /** @type {?} */
                                        var appOption = {
                                            appType: 'app',
                                            appId: el_1.functioncode,
                                            appEntrance: el_1.appEntrance,
                                            funcId: '',
                                            isReload: true,
                                            tabId: common$1.EventBus.guid(),
                                            entityParams: op.entityParam,
                                            queryStringParams: paramMap_1
                                        };
                                        tabId = common$1.RtfServices.getFuncId(appOption);
                                        options.self.cache.set(tabId ? tabId : options.queryId, op.EntityParam);
                                        /** @type {?} */
                                        var menuSwitchControl = Object.assign({}, appOption['entityParams'], common$1.RtfServices.getMenuSwitchControlParameter(tabId));
                                        appOption['entityParams'] = menuSwitchControl;
                                        gspframeworkService.rtf.func.openMenu(appOption);
                                    }
                                }
                            };
                            for (var key in options.self.hyperLinkQuery[options.self.queryId]) {
                                _loop_4(key);
                            }
                        })
                    }, null, false, false, false, false);
                }
                catch (e) { }
            };
        /**
         * @param {?} spread
         * @param {?} sheet
         * @param {?} extObj
         * @return {?}
         */
        SpreadStyleUtils.prototype.inSuiteLinkField = /**
         * @param {?} spread
         * @param {?} sheet
         * @param {?} extObj
         * @return {?}
         */
            function (spread, sheet, extObj) {
                try {
                    /** @type {?} */
                    var self_2 = this;
                    /** @type {?} */
                    var data_1 = null;
                    try {
                        if (this.lcpService.inSuiteDropDownInfo && typeof this.lcpService.inSuiteDropDownInfo == 'string') {
                            data_1 = JSON.parse(this.lcpService.inSuiteDropDownInfo);
                        }
                    }
                    catch (e) {
                        throw e;
                    }
                    /** @type {?} */
                    var rowCount = sheet.getRowCount();
                    /** @type {?} */
                    var colCount = sheet.getColumnCount();
                    /** @type {?} */
                    var rowDropDown = true;
                    /** @type {?} */
                    var cacheRowDropDown = [];
                    /** @type {?} */
                    var cacheCellDropDown = {};
                    // 解析相关数据
                    var clickEvents_1 = data_1.click_events, eventData_1 = data_1.event_data, dcEvent_1 = data_1.double_click_event, dcEventParams_1 = data_1.double_click_event_params, rcEventIds_1 = data_1.rc_event_ids;
                    if (dcEvent_1 && !("{}" == JSON.stringify(dcEvent_1)) && dcEventParams_1 && !("{}" == JSON.stringify(dcEventParams_1))) {
                        rowDropDown = true;
                        for (var key in dcEventParams_1) {
                            cacheRowDropDown.push(key);
                        }
                    }
                    else if (eventData_1 && !("{}" == JSON.stringify(eventData_1))) {
                        rowDropDown = false;
                        for (var key in eventData_1) {
                            if (eventData_1[key]) {
                                /** @type {?} */
                                var cellIndex = [];
                                cacheCellDropDown[key] = cellIndex;
                                for (var key1 in eventData_1[key]) {
                                    cacheCellDropDown[key].push(key1);
                                }
                            }
                        }
                    }
                    for (var r = 1; r < (rowCount); r++) {
                        /** @type {?} */
                        var dataItem = sheet.getDataItem(r);
                        if (dataItem.hasOwnProperty('dynamicPropSet') && dataItem.dynamicPropSet.hasOwnProperty('qdp_data_flag')) {
                            continue;
                        }
                        for (var c = 0; c < colCount; c++) {
                            if (rowDropDown) {
                                for (var i = 0; i < cacheRowDropDown.length; i++) {
                                    if (r == (cacheRowDropDown[i] - 0)) {
                                        /** @type {?} */
                                        var h1 = new GC.Spread.Sheets.CellTypes.HyperLink();
                                        /** @type {?} */
                                        var formatter = sheet.getFormatter(r, c);
                                        h1.text(h1.format(sheet.getCell(r, c).value(), formatter));
                                        h1.activeOnClick(true);
                                        h1.onClickAction(( /**
                                         * @return {?}
                                         */function () {
                                            spread.commandManager().execute({
                                                cmd: 'dropdownquery',
                                                self: self_2
                                            });
                                        }));
                                        sheet.setCellType(r, c, h1, GC.Spread.Sheets.SheetArea.viewport);
                                    }
                                }
                            }
                            else {
                                for (var key in cacheCellDropDown) {
                                    if ((r + '') === key) {
                                        for (var i = 0; i < cacheCellDropDown[key].length; i++) {
                                            /** @type {?} */
                                            var h1 = new GC.Spread.Sheets.CellTypes.HyperLink();
                                            /** @type {?} */
                                            var formatter = sheet.getFormatter(r, cacheCellDropDown[key][i]);
                                            h1.text(h1.format(sheet.getCell(r, cacheCellDropDown[key][i]).value(), formatter));
                                            h1.activeOnClick(true);
                                            h1.onClickAction(( /**
                                             * @return {?}
                                             */function () {
                                                spread.commandManager().execute({
                                                    cmd: 'dropdownquery',
                                                    self: self_2
                                                });
                                            }));
                                            sheet.setCellType(r, cacheCellDropDown[key][i], h1, GC.Spread.Sheets.SheetArea.viewport);
                                        }
                                    }
                                }
                            }
                        }
                    }
                    spread.commandManager().register('dropdownquery', {
                        canUndo: true,
                        execute: ( /**
                         * @param {?} context
                         * @param {?} options
                         * @param {?} isUndo
                         * @return {?}
                         */function (context, options, isUndo) {
                            /** @type {?} */
                            var row = context.getActiveSheet().getActiveRowIndex();
                            /** @type {?} */
                            var col = context.getActiveSheet().getActiveColumnIndex();
                            // 双击事件的逻辑
                            /** @type {?} */
                            var event;
                            /** @type {?} */
                            var params;
                            // 行点击数据
                            if (dcEvent_1 && !("{}" == JSON.stringify(dcEvent_1)) && dcEventParams_1 && !("{}" == JSON.stringify(dcEventParams_1))) {
                                event = dcEvent_1;
                                // args.row为行序号，下同
                                params = dcEventParams_1[row];
                                // 如果eventData数据不为空，并且对应行的数据也不为空
                                // 单元格数据
                            }
                            else if (eventData_1 && !("{}" == JSON.stringify(eventData_1)) && eventData_1[row] && !("{}" == JSON.stringify(eventData_1[row]))) {
                                /** @type {?} */
                                var thisEventId = void 0;
                                // 如果对应行包含-1，则取-1中的数据, 否则取对应列号的数据
                                // args.col为列序号
                                /** @type {?} */
                                var thisEventData = eventData_1[row][-1] || eventData_1[row][col];
                                if (thisEventData && !("{}" == JSON.stringify(thisEventData))) {
                                    if (!rcEventIds_1 && rcEventIds_1.length) {
                                        /** @type {?} */
                                        var obj = {};
                                        var _loop_6 = function (key) {
                                            if (rcEventIds_1.findIndex(( /**
                                             * @param {?} el
                                             * @return {?}
                                             */function (el) { return el == key; })) < 0) {
                                                obj[key] = thisEventData[key];
                                            }
                                        };
                                        for (var key in thisEventData) {
                                            _loop_6(key);
                                        }
                                        thisEventData = obj;
                                    }
                                    /** @type {?} */
                                    var index = 0;
                                    for (var key in thisEventData) {
                                        if (index == 0) {
                                            thisEventId = key;
                                        }
                                        else {
                                            break;
                                        }
                                        index++;
                                    }
                                    params = thisEventData[thisEventId];
                                }
                                // 根据event id获取event
                                if (thisEventId != null && thisEventId != undefined) {
                                    event = clickEvents_1[thisEventId] && !("{}" == JSON.stringify(clickEvents_1[thisEventId])) ? clickEvents_1[thisEventId].event : {};
                                }
                            }
                            /** @type {?} */
                            var message;
                            if (!("{}" == JSON.stringify(event)) && !("{}" == JSON.stringify(params))) {
                                // 返回数据
                                message = { type: 'cellAction', event: event, params: params, defaults: data_1.defaults };
                            }
                            if (message) {
                                try {
                                    extObj.inSuiteWindow().postMessage(message, location.origin);
                                }
                                catch (e) {
                                    console.log(e);
                                }
                            }
                        })
                    }, null, false, false, false, false);
                }
                catch (e) { }
            };
        /**
         * @private
         * @param {?} entityParam
         * @param {?} paramMap
         * @param {?} parameterKey
         * @param {?} key
         * @return {?}
         */
        SpreadStyleUtils.prototype.getQueryParameters = /**
         * @private
         * @param {?} entityParam
         * @param {?} paramMap
         * @param {?} parameterKey
         * @param {?} key
         * @return {?}
         */
            function (entityParam, paramMap, parameterKey, key) {
                try {
                    /** @type {?} */
                    var tab = gspframeworkService.rtf.session.getCommonVariable();
                    if (tab && tab.tabId) {
                        /** @type {?} */
                        var tid = tab.tabId + common$1.RtfServices.getInSuiteFrmUUID();
                        if (this.cache.get(tid) && this.cache.get(tid)[parameterKey]) {
                            entityParam[key] = this.cache.get(tid)[parameterKey];
                            paramMap.set(key, this.cache.get(tid)[parameterKey]);
                        }
                    }
                }
                catch (e) {
                }
            };
        /**
         * @param {?} spread
         * @param {?} queryId
         * @return {?}
         */
        SpreadStyleUtils.prototype.bindSelectChanged = /**
         * @param {?} spread
         * @param {?} queryId
         * @return {?}
         */
            function (spread, queryId) {
                /** @type {?} */
                var self = this;
                spread.bind(GC.Spread.Sheets.Events.SelectionChanging, ( /**
                 * @param {?} e
                 * @param {?} args
                 * @return {?}
                 */function (e, args) {
                    /** @type {?} */
                    var tempData = {};
                    /** @type {?} */
                    var selection = args.newSelections.pop();
                    /** @type {?} */
                    var sheetArea = args.sheetArea === 0 ? 'sheetCorner' : args.sheetArea === 1 ? 'columnHeader' : args.sheetArea === 2 ? 'rowHeader' : 'viewPort';
                    if (selection) {
                        tempData['SpreadEvent'] = GC.Spread.Sheets.Events.SelectionChanging;
                        tempData['sheetArea'] = sheetArea;
                        tempData['row'] = selection.row;
                        tempData['column'] = selection.col;
                        tempData['rowCount'] = selection.rowCount;
                        tempData['colCount'] = selection.colCount;
                        this.selectChanging = tempData;
                    }
                }));
                spread.bind(GC.Spread.Sheets.Events.CellClick, ( /**
                 * @param {?} e
                 * @param {?} args
                 * @return {?}
                 */function (e, args) {
                    // 联动参数
                    /** @type {?} */
                    var linkageParams = {};
                    for (var rowIndex = 0; rowIndex < this.selectChanging.rowCount; rowIndex++) {
                        if (self.joinParam.controlType !== 'crosstab') {
                            /** @type {?} */
                            var dataItem = args.sheet.getDataItem(rowIndex + this.selectChanging.row);
                            linkageParams = dataItem;
                        }
                        else {
                            if (this.selectChanging.column === -1) {
                                this.selectChanging.colCount = this.selectChanging.colCount + 1;
                            }
                            var _loop_7 = function (colIndex) {
                                /** @type {?} */
                                var dataItem = {};
                                if (self.joinParam.controlType === 'crosstab') { // 交叉表
                                    if (args.sheetArea === 1) {
                                        this_2.selectChanging.row = 0;
                                    }
                                    if (colIndex + this_2.selectChanging.column < self.joinParam.rowHeaderColInfo.end) {
                                        return "continue";
                                    }
                                    var _loop_8 = function (i) {
                                        /** @type {?} */
                                        var value_3 = args.sheet.getValue(rowIndex + this_2.selectChanging.row, i, GC.Spread.Sheets.SheetArea.viewport);
                                        /** @type {?} */
                                        var name_3 = args.sheet.getValue(self.joinParam.colHeaderRowInfo.start, i, GC.Spread.Sheets.SheetArea.colHeader);
                                        /** @type {?} */
                                        var colInfo_3 = self.joinParam.colInfos.find(( /**
                                         * @param {?} x
                                         * @return {?}
                                         */function (x) { return x.dimension === 1 && x.name === name_3; })).bindField;
                                        dataItem[colInfo_3] = value_3;
                                    };
                                    // 获取行标题的数据
                                    for (var i = self.joinParam.rowHeaderColInfo.start; i < self.joinParam.rowHeaderColInfo.end; i++) {
                                        _loop_8(i);
                                    }
                                    // 获取列标题的数据
                                    for (var i = self.joinParam.colHeaderRowInfo.start; i < self.joinParam.colHeaderRowInfo.end; i++) {
                                        /** @type {?} */
                                        var value_4 = args.sheet.getValue(i, colIndex + this_2.selectChanging.column, GC.Spread.Sheets.SheetArea.colHeader);
                                        /** @type {?} */
                                        var colInfo_4 = self.joinParam.colInfos.filter(( /**
                                         * @param {?} x
                                         * @return {?}
                                         */function (x) { return x.dimension === 2; }))[i - self.joinParam.colHeaderRowInfo.start].bindField;
                                        dataItem[colInfo_4] = value_4;
                                    }
                                    // 获取值标题的数据
                                    /** @type {?} */
                                    var value = args.sheet.getValue(rowIndex + this_2.selectChanging.row, colIndex + this_2.selectChanging.column, GC.Spread.Sheets.SheetArea.viewport);
                                    /** @type {?} */
                                    var name_4 = args.sheet.getValue(self.joinParam.colHeaderRowInfo.end, colIndex + this_2.selectChanging.column, GC.Spread.Sheets.SheetArea.colHeader);
                                    /** @type {?} */
                                    var colInfo = self.joinParam.colInfos.find(( /**
                                     * @param {?} x
                                     * @return {?}
                                     */function (x) { return x.dimension === 3 && x.name === name_4; })).bindField;
                                    dataItem[colInfo] = value;
                                }
                                linkageParams = dataItem;
                            };
                            var this_2 = this;
                            for (var colIndex = 0; colIndex < this.selectChanging.colCount; colIndex++) {
                                _loop_7(colIndex);
                            }
                        }
                    }
                    // spread 联动事件
                    common$1.EventBus.dispatch(queryId + '_spread_change', linkageParams);
                }));
            };
        /**
         * @param {?} sheet
         * @param {?} schema
         * @param {?} qdpView
         * @return {?}
         */
        SpreadStyleUtils.prototype.setSortCellType = /**
         * @param {?} sheet
         * @param {?} schema
         * @param {?} qdpView
         * @return {?}
         */
            function (sheet, schema, qdpView) {
                /** @type {?} */
                var self = this;
                /** @type {?} */
                var header = sheet.getRowCount(GC.Spread.Sheets.SheetArea.colHeader);
                for (var i = 0; i < sheet.getColumnCount(); i++) {
                    /** @type {?} */
                    var span = sheet.getSpan(header - 1, i, GC.Spread.Sheets.SheetArea.colHeader);
                    if (span && span.rowCount > 1) {
                        sheet.setCellType(header - span.rowCount, i, new SortCellType(self.columnSort.bind(self), schema, qdpView), GC.Spread.Sheets.SheetArea.colHeader);
                    }
                    else {
                        sheet.setCellType(header - 1, i, new SortCellType(self.columnSort.bind(self), schema, qdpView), GC.Spread.Sheets.SheetArea.colHeader);
                    }
                }
            };
        /**
         * @param {?} sheet
         * @param {?} schema
         * @return {?}
         */
        SpreadStyleUtils.prototype.mergeCell = /**
         * @param {?} sheet
         * @param {?} schema
         * @return {?}
         */
            function (sheet, schema) {
                if (!this.getMergeCell(schema)) {
                    return;
                }
                /** @type {?} */
                var groupFieldCache1 = [];
                this.getGroupField(groupFieldCache1, schema);
                if (groupFieldCache1.length) {
                    return;
                }
                /** @type {?} */
                var columnCount = sheet.getColumnCount();
                /** @type {?} */
                var rowCount = sheet.getRowCount();
                /** @type {?} */
                var beginRowIndex = 0;
                if (this.getShowFilterRow(schema)) {
                    beginRowIndex = 1;
                }
                // 检查参数
                if (columnCount < 1 || (rowCount - beginRowIndex) < 1) {
                    return;
                }
                /** @type {?} */
                var rowSpans = {};
                /** @type {?} */
                var curCellValues = '';
                /** @type {?} */
                var currentName = '';
                /** @type {?} */
                var key = '';
                for (var row = beginRowIndex; row < rowCount; row++) {
                    if (sheet.getDataItem(row).hasOwnProperty("qdp_data_flag") &&
                        ((sheet.getDataItem(row)["qdp_data_flag"] + '') === (4 + '')
                            || (sheet.getDataItem(row)["qdp_data_flag"] + '') === (3 + '')
                            || (sheet.getDataItem(row)["qdp_data_flag"] + '') === (2 + '')
                            || (sheet.getDataItem(row)["qdp_data_flag"] + '') === (1 + ''))) {
                        continue;
                    }
                    for (var col = 0; col < columnCount; col++) {
                        currentName = sheet.getCell(row, col).value();
                        if (col == 0) {
                            key = currentName;
                            if (rowSpans.hasOwnProperty(key)) {
                                rowSpans[key].rowCount = row - rowSpans[key].row + 1;
                            }
                            else {
                                rowSpans[key] = { 'row': row, 'rowCount': 1, 'col': col, 'colCount': 1 };
                            }
                        }
                        else {
                            curCellValues = '';
                            for (var i = 0; i <= col; i++) {
                                curCellValues += sheet.getCell(row, i).value();
                                curCellValues += "_&_";
                            }
                            if (rowSpans.hasOwnProperty(curCellValues)) {
                                rowSpans[curCellValues].rowCount = row - rowSpans[curCellValues].row + 1;
                            }
                            else {
                                rowSpans[curCellValues] = { 'row': row, 'rowCount': 1, 'col': col, 'colCount': 1 };
                            }
                        }
                    }
                }
                for (var k in rowSpans) {
                    if ((rowSpans[k].rowCount == 1 && rowSpans[k].colCount == 1) == false) {
                        sheet.addSpan(rowSpans[k].row, rowSpans[k].col, rowSpans[k].rowCount, rowSpans[k].colCount);
                    }
                }
            };
        /**
         * @private
         * @param {?} index
         * @param {?} sheet
         * @param {?} schema
         * @param {?} qdpView
         * @return {?}
         */
        SpreadStyleUtils.prototype.columnSort = /**
         * @private
         * @param {?} index
         * @param {?} sheet
         * @param {?} schema
         * @param {?} qdpView
         * @return {?}
         */
            function (index, sheet, schema, qdpView) {
                var _this = this;
                /** @type {?} */
                var loading = this.loadService.show({ container: 'body' });
                try {
                    /** @type {?} */
                    var header = sheet.getRowCount(GC.Spread.Sheets.SheetArea.colHeader);
                    if (schema && schema.schemaValue && schema.schemaValue.columnOption && schema.schemaValue.columnOption.colList && schema.schemaValue.columnOption.colList.length) {
                        /** @type {?} */
                        var cell = null;
                        /** @type {?} */
                        var span = sheet.getSpan(header - 1, index, GC.Spread.Sheets.SheetArea.colHeader);
                        if (span && span.rowCount > 1) {
                            cell = sheet.getCell(header - span.rowCount, index, GC.Spread.Sheets.SheetArea.colHeader);
                        }
                        else {
                            cell = sheet.getCell(header - 1, index, GC.Spread.Sheets.SheetArea.colHeader);
                        }
                        if (schema && schema.isPrefab === 1) {
                            loading.close();
                            cell.tag(0);
                            sheet.invalidateLayout();
                            sheet.repaint();
                            this.msgService.info(this.localizeService.getValue('spread.message.validate.sort'));
                            return;
                        }
                        if (schema.isProtected === 1 || schema.isProtected === '1') {
                            loading.close();
                            cell.tag(0);
                            sheet.invalidateLayout();
                            sheet.repaint();
                            this.msgService.info(this.localizeService.getValue('ideCmp.schemaManager.message.validate.isProtected'));
                            return;
                        }
                        /** @type {?} */
                        var colList = schema.schemaValue.columnOption.colList;
                        /** @type {?} */
                        var params = {
                            index: index,
                            cell: cell,
                            colIndex: 0,
                            sortInfo: { sortIndex: 0, bindField: '' },
                            isText: []
                        };
                        // tslint:disable-next-line:prefer-for-of
                        for (var i = 0; i < colList.length; i++) {
                            this.recursiveColumnSortIndex(colList[i], null, params);
                        }
                        // tslint:disable-next-line:prefer-for-of
                        for (var i = 0; i < colList.length; i++) {
                            this.recursiveColumnSort(colList[i], null, params);
                        }
                        if (params.isText.length) {
                            loading.close();
                            cell.tag(0);
                            sheet.invalidateLayout();
                            sheet.repaint();
                            this.msgService.warning(params.isText[0] + ' ' + this.localizeService.getValue('ideCmp.schemaManager.message.validate.textColumnSort'));
                            return;
                        }
                        /** @type {?} */
                        var newSchema_1 = JSON.parse(JSON.stringify(schema));
                        newSchema_1.schemaValue.columnOption.colList = colList;
                        newSchema_1.schemaValue = JSON.stringify(newSchema_1.schemaValue);
                        this.schemaManager.saveSchema({ schema: JSON.stringify(newSchema_1), groupType: qdpView.groupType }, '').subscribe(( /**
                         * @param {?} data
                         * @return {?}
                         */function (data) {
                            loading.close();
                            qdpView.initSpread(qdpView.queryId, newSchema_1.id, qdpView.controlType, qdpView.qoManagerCode, qdpView.pageIndex, qdpView.queryRelativeUrl, qdpView.conditionExpression, qdpView.groupType, qdpView.voId, true);
                        }), ( /**
                         * @param {?} error
                         * @return {?}
                         */function (error) {
                            loading.close();
                            _this.formErrorService.exception(error.Message, error);
                        }));
                    }
                    else {
                        loading.close();
                        this.msgService.info(this.localizeService.getValue('spread.message.validate.sort'));
                        return;
                    }
                }
                catch (e) {
                    loading.close();
                }
            };
        /**
         * @private
         * @param {?} col
         * @param {?} colList
         * @param {?} params
         * @return {?}
         */
        SpreadStyleUtils.prototype.recursiveColumnSortIndex = /**
         * @private
         * @param {?} col
         * @param {?} colList
         * @param {?} params
         * @return {?}
         */
            function (col, colList, params) {
                if (colList == null) {
                    if (col.childList && col.childList.length) {
                        this.recursiveColumnSortIndex(null, col.childList, params);
                    }
                    else {
                        if (col.sort !== 0 && col['sortIndex'] != null && col['sortIndex'] !== undefined && col.sortIndex > params.sortInfo.sortIndex) {
                            params.sortInfo.sortIndex = col['sortIndex'];
                            params.sortInfo.bindField = col.bindField;
                        }
                    }
                }
                else {
                    // tslint:disable-next-line:prefer-for-of
                    for (var i = 0; i < colList.length; i++) {
                        if (colList[i].childList && colList[i].childList.length) {
                            this.recursiveColumnSortIndex(null, colList[i].childList, params);
                        }
                        else {
                            if (colList[i].sort !== 0 && colList[i]['sortIndex'] != null && colList[i]['sortIndex'] !== undefined && colList[i].sortIndex > params.sortInfo.sortIndex) {
                                params.sortInfo.sortIndex = colList[i]['sortIndex'];
                                params.sortInfo.bindField = colList[i].bindField;
                            }
                        }
                    }
                }
            };
        /**
         * @private
         * @param {?} col
         * @param {?} colList
         * @param {?} params
         * @return {?}
         */
        SpreadStyleUtils.prototype.recursiveColumnSort = /**
         * @private
         * @param {?} col
         * @param {?} colList
         * @param {?} params
         * @return {?}
         */
            function (col, colList, params) {
                if (colList == null) {
                    if (col.childList && col.childList.length) {
                        this.recursiveColumnSort(null, col.childList, params);
                    }
                    else {
                        if (params.colIndex === params.index) {
                            if (col.type && col.type.toLowerCase() === 'text') {
                                params.isText.push(col.bindField);
                            }
                            else {
                                switch (params.cell.tag()) {
                                    case 0:
                                        col.sort = 0;
                                        col['sortIndex'] = 0;
                                        break;
                                    case 1:
                                        col.sort = 1;
                                        col['sortIndex'] = col['sortIndex'] !== null && col['sortIndex'] !== undefined && col['sortIndex'] > 0 ? col['sortIndex'] : col.bindField === params.sortInfo.bindField ? params.sortInfo.sortIndex : params.sortInfo.sortIndex + 1;
                                        break;
                                    case 2:
                                        col.sort = 2;
                                        col['sortIndex'] = col['sortIndex'] !== null && col['sortIndex'] !== undefined && col['sortIndex'] > 0 ? col['sortIndex'] : col.bindField === params.sortInfo.bindField ? params.sortInfo.sortIndex : params.sortInfo.sortIndex + 1;
                                        break;
                                }
                            }
                        }
                        params.colIndex++;
                    }
                }
                else {
                    // tslint:disable-next-line:prefer-for-of
                    for (var i = 0; i < colList.length; i++) {
                        if (colList[i].childList && colList[i].childList.length) {
                            this.recursiveColumnSort(null, colList[i].childList, params);
                        }
                        else {
                            if (params.colIndex === params.index) {
                                if (colList[i].type && colList[i].type.toLowerCase() === 'text') {
                                    params.isText.push(colList[i].bindField);
                                }
                                else {
                                    switch (params.cell.tag()) {
                                        case 0:
                                            colList[i].sort = 0;
                                            colList[i]['sortIndex'] = 0;
                                            break;
                                        case 1:
                                            colList[i].sort = 1;
                                            colList[i]['sortIndex'] = colList[i]['sortIndex'] !== null && colList[i]['sortIndex'] !== undefined && colList[i]['sortIndex'] > 0 ? colList[i]['sortIndex'] : colList[i].bindField === params.sortInfo.bindField ? params.sortInfo.sortIndex : params.sortInfo.sortIndex + 1;
                                            break;
                                        case 2:
                                            colList[i].sort = 2;
                                            colList[i]['sortIndex'] = colList[i]['sortIndex'] !== null && colList[i]['sortIndex'] !== undefined && colList[i]['sortIndex'] > 0 ? colList[i]['sortIndex'] : colList[i].bindField === params.sortInfo.bindField ? params.sortInfo.sortIndex : params.sortInfo.sortIndex + 1;
                                            break;
                                    }
                                }
                            }
                            params.colIndex++;
                        }
                    }
                }
            };
        /**
         * @private
         * @param {?} col
         * @param {?} colList
         * @param {?} params
         * @return {?}
         */
        SpreadStyleUtils.prototype.recursiveIsRedColumn = /**
         * @private
         * @param {?} col
         * @param {?} colList
         * @param {?} params
         * @return {?}
         */
            function (col, colList, params) {
                if (colList == null) {
                    if (col.childList && col.childList.length) {
                        this.recursiveIsRedColumn(null, col.childList, params);
                    }
                    else {
                        if (col.isRed) {
                            params.isRedColumns.push({
                                colIndex: params.colIndex
                            });
                        }
                        params.colIndex++;
                    }
                }
                else {
                    // tslint:disable-next-line:prefer-for-of
                    for (var i = 0; i < colList.length; i++) {
                        if (colList[i].childList && colList[i].childList.length) {
                            this.recursiveIsRedColumn(null, colList[i].childList, params);
                        }
                        else {
                            if (colList[i].isRed) {
                                params.isRedColumns.push({
                                    colIndex: params.colIndex
                                });
                            }
                            params.colIndex++;
                        }
                    }
                }
            };
        /**
         * @private
         * @param {?} val
         * @return {?}
         */
        SpreadStyleUtils.prototype.isNumber = /**
         * @private
         * @param {?} val
         * @return {?}
         */
            function (val) {
                if (parseFloat(val).toString() == "NaN") {
                    return false;
                }
                else {
                    return true;
                }
            };
        return SpreadStyleUtils;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
     */
    var BaseRender = /** @class */ (function () {
        function BaseRender(_queryId, _controlType, _jointsearchInfoList, _funcInfoCache, _serviceCache) {
            this.utils = new Map();
            this.autoFitColumnIndex = 0;
            this.isSchemaSelectChanged = false;
            this.tabId = common$1.RtfServices.getTabId(_queryId);
            this.queryId = _queryId;
            this.type = _controlType;
            this.funcInfoCache = _funcInfoCache;
            this.serviceCache = _serviceCache;
            this.baseRenderInit(_queryId, _controlType, _jointsearchInfoList, _funcInfoCache);
        }
        /**
         * @private
         * @param {?} _queryId
         * @param {?} _controlType
         * @param {?=} _jointsearchInfoList
         * @param {?=} _funcInfoCache
         * @return {?}
         */
        BaseRender.prototype.baseRenderInit = /**
         * @private
         * @param {?} _queryId
         * @param {?} _controlType
         * @param {?=} _jointsearchInfoList
         * @param {?=} _funcInfoCache
         * @return {?}
         */
            function (_queryId, _controlType, _jointsearchInfoList, _funcInfoCache) {
                /** @type {?} */
                var parameterUtils = new ParameterUtils(_queryId, _funcInfoCache, this.serviceCache);
                /** @type {?} */
                var schemaUtils = new SchemaUtils(this.serviceCache);
                /** @type {?} */
                var spreadStyleUtils = new SpreadStyleUtils(_queryId, _controlType, _jointsearchInfoList, this.serviceCache);
                /** @type {?} */
                var renderExtendsUtils = new RenderExtendsUtils(_queryId);
                this.msgService = this.serviceCache.msgService;
                this.cache = this.serviceCache.cacheService;
                this.lcpService = this.serviceCache.lcpService;
                this.loadService = this.serviceCache.loadService;
                this.localizeService = this.serviceCache.localizeService;
                this.schemaManager = this.serviceCache.schemaManagerService;
                this.formErrorService = this.serviceCache.formErrorService;
                this.queryId = _queryId;
                this.utils.set('parameter', parameterUtils);
                this.utils.set('schema', schemaUtils);
                this.utils.set('spreadStyle', spreadStyleUtils);
                this.utils.set('renderExtends', renderExtendsUtils);
                this.utils.set('queryId', _queryId);
            };
        /**
         * @param {?} params
         * @param {?} queryRelativeUrl
         * @return {?}
         */
        BaseRender.prototype.getData = /**
         * @param {?} params
         * @param {?} queryRelativeUrl
         * @return {?}
         */
            function (params, queryRelativeUrl) {
                this.cache.set(this.queryId + 'param', params);
                return this.lcpService.getData(params, queryRelativeUrl);
            };
        /**
         * @param {?} data
         * @param {?} value
         * @return {?}
         */
        BaseRender.prototype.changeData = /**
         * @param {?} data
         * @param {?} value
         * @return {?}
         */
            function (data, value) {
                if (data && data.data && data.dynamicCols && value) {
                    if (value.schemaValue.columnOption && value.schemaValue.columnOption.colList && value.schemaValue.columnOption.colList.length) {
                        /** @type {?} */
                        var columns_1 = value.schemaValue.columnOption.colList.filter(( /**
                         * @param {?} x
                         * @return {?}
                         */function (x) { return x.type === 'enum'; }));
                        if (columns_1 && columns_1.length > 0) {
                            data.data.forEach(( /**
                             * @param {?} x
                             * @return {?}
                             */function (x) {
                                columns_1.forEach(( /**
                                 * @param {?} y
                                 * @return {?}
                                 */function (y) {
                                    /** @type {?} */
                                    var orginValue = x[y.bindField];
                                    /** @type {?} */
                                    var showValue = orginValue;
                                    if (data.resultEnumItems) {
                                        /** @type {?} */
                                        var resultEnumItem = data.resultEnumItems.find(( /**
                                         * @param {?} resultEnumItem
                                         * @return {?}
                                         */function (resultEnumItem) { return resultEnumItem.enumName === y.bindField; }));
                                        if (resultEnumItem) {
                                            /** @type {?} */
                                            var findShowValue = resultEnumItem.resultEnumInfoList.find(( /**
                                             * @param {?} resultEnum
                                             * @return {?}
                                             */function (resultEnum) { return resultEnum.key === orginValue; }));
                                            if (findShowValue) {
                                                showValue = y.showType === '0' ? findShowValue.key : y.showType === '1' ? findShowValue.code : findShowValue.name;
                                            }
                                        }
                                    }
                                    x[y.bindField] = showValue;
                                }));
                            }));
                        }
                    }
                }
            };
        /**
         * 二开人员自定义格式方案处理
         */
        /**
         * 二开人员自定义格式方案处理
         * @param {?} data
         * @param {?} obj
         * @return {?}
         */
        BaseRender.prototype.operateCustomFormatSchema = /**
         * 二开人员自定义格式方案处理
         * @param {?} data
         * @param {?} obj
         * @return {?}
         */
            function (data, obj) {
                if (data.customFormatScheme) {
                    obj.customFormatScheme = data.customFormatScheme;
                    this.schemaManager.customSchema[obj.groupType ? obj.groupType : obj.queryId] = data.customFormatScheme;
                    /** @type {?} */
                    var customSchema = null;
                    if (obj.schemaId === '1') {
                        customSchema = this.schemaManager.mergeCustomSchema(obj.groupType ? obj.groupType : obj.queryId, obj.queryId);
                    }
                    if (customSchema && customSchema.schemaValue) {
                        ServicesUtils.setServices(common$1.RtfServices.getTabId(obj.queryId) + 'customScheme', JSON.stringify(customSchema.schemaValue));
                    }
                }
            };
        /**
         * 处理分页信息
         */
        /**
         * 处理分页信息
         * @param {?} obj
         * @param {?} params
         * @return {?}
         */
        BaseRender.prototype.operatePagination = /**
         * 处理分页信息
         * @param {?} obj
         * @param {?} params
         * @return {?}
         */
            function (obj, params) {
                /** @type {?} */
                var self = this;
                if (obj.controlType === 'list') {
                    /** @type {?} */
                    var pageSize = 0;
                    if (obj.schemaId !== '1' && self.schemaManager.schemaList && self.schemaManager.schemaList[obj.schemaId]) {
                        if (typeof self.schemaManager.schemaList[obj.schemaId].schemaValue === "string") {
                            self.schemaManager.schemaList[obj.schemaId].schemaValue = JSON.parse(self.schemaManager.schemaList[obj.schemaId].schemaValue);
                        }
                        if (self.schemaManager.schemaList[obj.schemaId].schemaValue.otherOption.loadDataType !== 0) {
                            pageSize = self.schemaManager.schemaList[obj.schemaId].schemaValue.otherOption.pageSize;
                        }
                    }
                    else {
                        if (obj.schemaId === '1' && self.schemaManager.preSchema && self.schemaManager.preSchema.schemaValue.otherOption.loadDataType !== 0) {
                            pageSize = self.schemaManager.preSchema.schemaValue.otherOption.pageSize;
                        }
                    }
                    if (pageSize !== 0) {
                        params['pageSize'] = pageSize;
                        params['pageIndex'] = !obj.pageIndex ? 1 : obj.pageIndex;
                    }
                }
            };
        /**
         * @param {?} sheet
         * @param {?} data
         * @return {?}
         */
        BaseRender.prototype.titleVariablesReplace = /**
         * @param {?} sheet
         * @param {?} data
         * @return {?}
         */
            function (sheet, data) {
                /** @type {?} */
                var colCount = sheet.getColumnCount(GC.Spread.Sheets.SheetArea.colHeader);
                /** @type {?} */
                var rowCount = sheet.getRowCount(GC.Spread.Sheets.SheetArea.colHeader);
                if (data && data.variables) {
                    for (var r = 0; r < rowCount; r++) {
                        for (var c = 0; c < colCount; c++) {
                            sheet.setValue(r, c, this.variablesReplace(sheet.getValue(r, c, GC.Spread.Sheets.SheetArea.colHeader), data), GC.Spread.Sheets.SheetArea.colHeader);
                        }
                    }
                }
            };
        /**
         * @param {?} sheet
         * @param {?} data
         * @return {?}
         */
        BaseRender.prototype.footerVariablesReplace = /**
         * @param {?} sheet
         * @param {?} data
         * @return {?}
         */
            function (sheet, data) {
                /** @type {?} */
                var rowCount = sheet.getRowCount();
                /** @type {?} */
                var colCount = sheet.getColumnCount();
                if (this.utils.get('spreadStyle').footerDataArray && this.utils.get('spreadStyle').footerDataArray.length) {
                    for (var r = 0; r < this.utils.get('spreadStyle').footerDataArray.length; r++) {
                        for (var c = 0; c < colCount; c++) {
                            sheet.setValue(r + (rowCount - this.utils.get('spreadStyle').footerDataArray.length), c, this.variablesReplace(this.utils.get('spreadStyle').footerDataArray[r][c], data));
                        }
                    }
                }
            };
        /**
         * @private
         * @param {?} cellValue
         * @param {?} data
         * @return {?}
         */
        BaseRender.prototype.variablesReplace = /**
         * @private
         * @param {?} cellValue
         * @param {?} data
         * @return {?}
         */
            function (cellValue, data) {
                if (data && data.variables) {
                    Object.keys(data.variables).forEach(( /**
                     * @param {?} key
                     * @return {?}
                     */function (key) {
                        /** @type {?} */
                        var reg = new RegExp(key, 'g');
                        if (cellValue) {
                            cellValue = cellValue.replace(reg, data.variables[key]);
                        }
                    }));
                }
                return cellValue;
            };
        /**
         * @param {?} spread
         * @param {?} errmsg
         * @return {?}
         */
        BaseRender.prototype.errorHandle = /**
         * @param {?} spread
         * @param {?} errmsg
         * @return {?}
         */
            function (spread, errmsg) {
                if (spread.getActiveSheet()) {
                    spread.removeSheet(0);
                }
                spread.options.tabStripVisible = false;
                this.msgService.warning(errmsg);
                return;
            };
        return BaseRender;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
     */
    var CrosstabRender = /** @class */ (function (_super) {
        __extends(CrosstabRender, _super);
        function CrosstabRender(_queryId, _controlType, _jointsearchInfoList, _funcInfoCache, _serviceCache) {
            var _this = _super.call(this, _queryId, _controlType, _jointsearchInfoList, _funcInfoCache, _serviceCache) || this;
            _this.crosstabInit();
            return _this;
        }
        /**
         * @private
         * @return {?}
         */
        CrosstabRender.prototype.crosstabInit = /**
         * @private
         * @return {?}
         */
            function () {
            };
        /**
         * 渲染
         * @param obj 参数配置项
         */
        /**
         * 渲染
         * @param {?} obj 参数配置项
         * @return {?}
         */
        CrosstabRender.prototype.render = /**
         * 渲染
         * @param {?} obj 参数配置项
         * @return {?}
         */
            function (obj) {
                var _this = this;
                /** @type {?} */
                var self = this;
                this.queryId = obj.queryId;
                obj.schemaId = obj.schemaId === 'prefab' ? '1' : obj.schemaId;
                this.utils.get('schema').getSchemaInfo(obj).subscribe(( /**
                 * @param {?} schemaValue
                 * @return {?}
                 */function (schemaValue) {
                    if (schemaValue) {
                        obj['schemaId'] = schemaValue.id;
                        obj['schemaValue'] = schemaValue;
                        // this.currentSchemaValueChanger.next(schemaValue);
                        common$1.EventBus.dispatch('schemaValueChanged', schemaValue);
                        /** @type {?} */
                        var delay = schemaValue.schemaValue.otherOption.delay;
                        /** @type {?} */
                        var interval_1 = schemaValue.schemaValue.otherOption.interval;
                        /** @type {?} */
                        var index = self.funcInfoCache.firstLoadCache.findIndex(( /**
                         * @param {?} el
                         * @return {?}
                         */function (el) { return el === _this.tabId; }));
                        /** @type {?} */
                        var firstLoad = schemaValue.schemaValue.otherOption.firstLoad;
                        if (index < 0 && _this.isSchemaSelectChanged === false) {
                            if (firstLoad === false) {
                                self.funcInfoCache.firstLoadCache.push(_this.tabId);
                                obj.loading.close();
                                if (obj.spread.getActiveSheet()) {
                                    obj.spread.getActiveSheet().deleteRows(0, obj.spread.getActiveSheet().getRowCount());
                                    obj.spread.getActiveSheet().options.colHeaderVisible = false;
                                    obj.spread.invalidateLayout();
                                    obj.spread.repaint();
                                }
                                return;
                            }
                        }
                        if (!delay) {
                            delay = 0;
                        }
                        setTimeout(( /**
                         * @return {?}
                         */function () {
                            _this.getRenderDataForCrosstab.call(_this, Object.assign({}, obj));
                            if (interval_1 > 0) {
                                setInterval(( /**
                                 * @return {?}
                                 */function () {
                                    _this.getRenderDataForCrosstab.call(_this, Object.assign({}, obj));
                                }), interval_1 * 1000);
                            }
                        }), delay * 1000);
                    }
                    else {
                        obj['schemaId'] = '1';
                        _this.getRenderDataForCrosstab.call(_this, Object.assign({}, obj));
                    }
                }));
            };
        /**
         * @private
         * @param {?} obj
         * @return {?}
         */
        CrosstabRender.prototype.getRenderDataForCrosstab = /**
         * @private
         * @param {?} obj
         * @return {?}
         */
            function (obj) {
                var _this = this;
                /** @type {?} */
                var self = this;
                obj.schemaId = obj.schemaId ? obj.schemaId : (obj.schemaValue && obj.schemaValue.id ? obj.schemaValue.id : '1');
                if (!obj.formData) {
                    /** @type {?} */
                    var params_1 = this.utils.get('parameter').createParameters(Object.assign({}, obj, { pageIndex: 0, pageSize: 0 }));
                    params_1['queryId'] = obj.queryId ? obj.queryId : '';
                    // 查询数据前事件
                    params_1 = this.utils.get('renderExtends').runRenderExtends('beforeQueryData', this.localizeService.getValue('spread.message.extend.query.before'), params_1, obj.spread);
                    try {
                        this.cache.set(self.tabId, JSON.parse(params_1['entityData']));
                        this.cache.set(self.tabId + 'extendCond', params_1['extendCond']);
                    }
                    catch (e) { }
                    self.lcpService.getCol(params_1, obj.queryRelativeUrl).subscribe(( /**
                     * @param {?} resultData
                     * @return {?}
                     */function (resultData) {
                        /** @type {?} */
                        var dynamicColumns = (resultData && resultData.dynamicCols) || [];
                        self.initJoinParams(obj, dynamicColumns);
                        self.schemaManager.setColInfo(dynamicColumns);
                        if (obj.schemaId === '1' || !obj.schemaId) {
                            obj.loading.close();
                            return self.errorHandle(obj.spread, _this.localizeService.getValue('spread.message.validate.schemaInfo'));
                        }
                        self.lcpService.getCrosstabTemplate(params_1, obj.queryRelativeUrl).subscribe(( /**
                         * @param {?} template
                         * @return {?}
                         */function (template) {
                            if (!template || !template.sheets || !template.sheets.sheet1 || !template.sheets.sheet1.data || !template.sheets.sheet1.data.dataTable || !template.sheets.sheet1.data.dataTable['0']) {
                                obj.loading.close();
                                return self.errorHandle(obj.spread, _this.localizeService.getValue('spread.message.validate.nodata'));
                            }
                            self.renderCrossTable(Object.assign({}, obj, { template: template }));
                            /** @type {?} */
                            var event = common$1.RtfServices.getMenuSwitchControlEvent();
                            if (event && typeof event === 'object') {
                                event.next('ok');
                            }
                            obj.loading.close();
                            _this.utils.get('spreadStyle').bindSelectChanged(obj.spread, obj.queryId);
                        }), ( /**
                         * @param {?} error
                         * @return {?}
                         */function (error) {
                            self.formErrorService.exception(error.Message, error);
                            obj.loading.close();
                        }));
                    }), ( /**
                     * @param {?} error
                     * @return {?}
                     */function (error) {
                        self.formErrorService.exception(error.Message, error);
                        obj.loading.close();
                    }));
                    this.cache.set('schema_schemaid' + obj.queryId, obj.schemaId);
                }
            };
        /**
         * @private
         * @param {?} obj
         * @return {?}
         */
        CrosstabRender.prototype.renderCrossTable = /**
         * @private
         * @param {?} obj
         * @return {?}
         */
            function (obj) {
                obj.spread.suspendEvent();
                obj.spread.suspendPaint();
                if (obj.template) {
                    obj.spread.fromJSON(obj.template);
                    obj.spread.getActiveSheet().rowOutlines.direction(GC.Spread.Sheets.Outlines.OutlineDirection.backward);
                    /** @type {?} */
                    var row = obj.spread.getActiveSheet().getRowCount();
                    for (var i = 0; i < row; i++) {
                        /** @type {?} */
                        var cellType = obj.spread.getActiveSheet().getCellType(i, 0);
                        if (cellType && cellType.typeName === 'TreeCellType') {
                            /** @type {?} */
                            var level = cellType.level;
                            for (var r = 0; r <= level; r++) {
                                obj.spread.getActiveSheet().rowOutlines.group(i, 1);
                            }
                        }
                    }
                }
                /** @type {?} */
                var sheet = obj.spread.getActiveSheet();
                if (sheet) {
                    this.titleVariablesReplace(sheet, obj.data);
                    sheet.clearSelection();
                }
                // 页面渲染后事件
                this.utils.get('renderExtends').runRenderExtends('afterLoadData', this.localizeService.getValue('spread.message.extend.dataLoading.after'), obj.data, obj.spread);
                obj.spread.resumePaint();
                obj.spread.resumeEvent();
                // 增加当前单元格联查参数缓存
                this.utils.get('spreadStyle').joinParam['controlType'] = obj.controlType;
                this.cache.set(this.tabId + 'joinSearch', this.utils.get('spreadStyle').joinParam);
            };
        /**
         * @private
         * @param {?} obj
         * @param {?} dynamicColumns
         * @return {?}
         */
        CrosstabRender.prototype.initJoinParams = /**
         * @private
         * @param {?} obj
         * @param {?} dynamicColumns
         * @return {?}
         */
            function (obj, dynamicColumns) {
                var _this = this;
                this.utils.get('spreadStyle').joinParam = {
                    controlType: obj.controlType,
                    rowHeaderColInfo: { start: 0, end: 0 },
                    // 行标题起始位置信息（行号）
                    colHeaderRowInfo: { start: 0, end: 0 },
                    // 列标题信息起始位置信息（列号)
                    valueColCount: 0,
                    // 行标题信息起始位置信息（列号)
                    colInfos: dynamicColumns,
                };
                /** @type {?} */
                var columnHeaderRowCount = this.utils.get('spreadStyle').rowHeadersColumnCount = this.utils.get('spreadStyle').valueHeaderRowCount = 0;
                /** @type {?} */
                var titleCount = 0;
                if (obj.schemaId !== '1') {
                    titleCount += obj.schemaValue.schemaValue.titleOption.title ? 1 : 0;
                    titleCount += obj.schemaValue.schemaValue.titleOption.subTitles.length;
                    obj.schemaValue.schemaValue.columnOption.colList.forEach(( /**
                     * @param {?} data
                     * @return {?}
                     */function (data) {
                        if (data.dimension && data.dimension !== 0) {
                            if (data.dimension === 1) {
                                _this.utils.get('spreadStyle').rowHeadersColumnCount++;
                            }
                            else if (data.dimension === 2) {
                                columnHeaderRowCount++;
                            }
                            else if (data.dimension === 3) {
                                _this.utils.get('spreadStyle').valueHeaderRowCount++;
                            }
                        }
                    }));
                    this.utils.get('spreadStyle').joinParam['controlType'] = obj.controlType;
                    this.utils.get('spreadStyle').joinParam['rowHeaderColInfo'] = { start: 0, end: this.utils.get('spreadStyle').rowHeadersColumnCount }; // 行标题起始位置信息（行号）
                    this.utils.get('spreadStyle').joinParam['colHeaderRowInfo'] = { start: titleCount, end: titleCount + columnHeaderRowCount }; // 列标题信息起始位置信息（列号)
                    this.utils.get('spreadStyle').joinParam['valueColCount'] = this.utils.get('spreadStyle').valueHeaderRowCount; // 行标题信息起始位置信息（列号)
                    this.utils.get('spreadStyle').joinParam['colInfos'] = obj.schemaValue.schemaValue.columnOption.colList; // 列信息
                }
                this.cache.set(this.tabId + 'joinSearch', this.utils.get('spreadStyle').joinParam);
            };
        return CrosstabRender;
    }(BaseRender));

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
     */
    var ListTreeRender = /** @class */ (function (_super) {
        __extends(ListTreeRender, _super);
        function ListTreeRender(_queryId, _controlType, _jointsearchInfoList, _funcInfoCache, _serviceCache) {
            var _this = _super.call(this, _queryId, _controlType, _jointsearchInfoList, _funcInfoCache, _serviceCache) || this;
            _this.listRenderInit(_queryId, _controlType);
            return _this;
        }
        /**
         * @param {?} _queryId
         * @param {?} _controlType
         * @return {?}
         */
        ListTreeRender.prototype.listRenderInit = /**
         * @param {?} _queryId
         * @param {?} _controlType
         * @return {?}
         */
            function (_queryId, _controlType) {
                this.type = _controlType;
                this.queryId = _queryId;
            };
        /**
         * 渲染
         * @param obj 参数配置项
         */
        /**
         * 渲染
         * @param {?} obj 参数配置项
         * @return {?}
         */
        ListTreeRender.prototype.render = /**
         * 渲染
         * @param {?} obj 参数配置项
         * @return {?}
         */
            function (obj) {
                var _this = this;
                /** @type {?} */
                var self = this;
                this.queryId = obj.queryId;
                this.type = obj.controlType;
                obj.schemaId = obj.schemaId === 'prefab' ? '1' : obj.schemaId;
                this.utils.get('schema').getSchemaInfo(obj).subscribe(( /**
                 * @param {?} schemaValue
                 * @return {?}
                 */function (schemaValue) {
                    if (schemaValue) {
                        obj['schemaId'] = schemaValue.id;
                        obj['schemaValue'] = schemaValue;
                        // this.currentSchemaValueChanger.next(schemaValue);
                        common$1.EventBus.dispatch('schemaValueChanged', schemaValue);
                        /** @type {?} */
                        var delay = schemaValue.schemaValue.otherOption.delay;
                        /** @type {?} */
                        var interval_1 = schemaValue.schemaValue.otherOption.interval;
                        /** @type {?} */
                        var funcId_1 = common$1.RtfServices.getTabId(obj.queryId);
                        /** @type {?} */
                        var index = self.funcInfoCache.firstLoadCache.findIndex(( /**
                         * @param {?} el
                         * @return {?}
                         */function (el) { return el === funcId_1; }));
                        /** @type {?} */
                        var firstLoad = schemaValue.schemaValue.otherOption.firstLoad;
                        if (index < 0 && _this.isSchemaSelectChanged === false) {
                            if (firstLoad === false) {
                                self.funcInfoCache.firstLoadCache.push(funcId_1);
                                obj.loading.close();
                                if (obj.spread.getActiveSheet()) {
                                    obj.spread.getActiveSheet().deleteRows(0, obj.spread.getActiveSheet().getRowCount());
                                    obj.spread.getActiveSheet().options.colHeaderVisible = false;
                                    obj.spread.invalidateLayout();
                                    obj.spread.repaint();
                                    self.serviceCache.lcpService.pageInfoChange.next({
                                        pageCount: 1,
                                        pageIndex: 1,
                                        pageSize: schemaValue.schemaValue.otherOption.pageSize || 20,
                                        totalCount: 1
                                    });
                                }
                                return;
                            }
                        }
                        if (!delay) {
                            delay = 0;
                        }
                        setTimeout(( /**
                         * @return {?}
                         */function () {
                            _this.getRenderDataForList.call(_this, Object.assign({}, obj));
                            if (interval_1 > 0) {
                                setInterval(( /**
                                 * @return {?}
                                 */function () {
                                    _this.getRenderDataForList.call(_this, Object.assign({}, obj));
                                }), interval_1 * 1000);
                            }
                        }), delay * 1000);
                    }
                    else {
                        obj['schemaId'] = '1';
                        _this.getRenderDataForList.call(_this, Object.assign({}, obj));
                    }
                }));
            };
        /**
         * @private
         * @param {?} obj
         * @return {?}
         */
        ListTreeRender.prototype.getRenderDataForList = /**
         * @private
         * @param {?} obj
         * @return {?}
         */
            function (obj) {
                var _this = this;
                /** @type {?} */
                var self = this;
                obj.schemaId = obj.schemaId ? obj.schemaId : (obj.schemaValue && obj.schemaValue.id ? obj.schemaValue.id : '1');
                if (!obj.formData) {
                    /** @type {?} */
                    var params_1 = this.utils.get('parameter').createParameters(Object.assign({}, obj, { pageIndex: 0, pageSize: 0 }));
                    params_1['queryId'] = obj.queryId ? obj.queryId : '';
                    self.operatePagination(obj, params_1);
                    // 查询数据前事件
                    params_1 = this.utils.get('renderExtends').runRenderExtends('beforeQueryData', this.localizeService.getValue('spread.message.extend.query.before'), params_1, obj.spread);
                    try {
                        /** @type {?} */
                        var tab = common$1.RtfServices.getTabId(obj.queryId);
                        this.cache.set(tab, JSON.parse(params_1['entityData']));
                        this.cache.set(tab + 'extendCond', params_1['extendCond']);
                    }
                    catch (e) { }
                    self.getData(params_1, obj.queryRelativeUrl).subscribe(( /**
                     * @param {?} data
                     * @return {?}
                     */function (data) {
                        data = data || { data: [], dynamicCols: [] };
                        if (obj.schemaId !== '1' || (data && data.dynamicCols && data.dynamicCols.length)) {
                            self.schemaManager.dynamicCols[obj.groupType ? obj.groupType : obj.queryId] = data.dynamicCols || [];
                            self.schemaManager.dynamicCols[obj.schemaId] = data.dynamicCols || [];
                            self.schemaManager.operateDynamicColsForSchema(obj.schemaValue, obj.groupType ? obj.groupType : obj.queryId, obj.schemaId);
                            self.schemaManager.schemaInfoChange.next({ schemaList: self.schemaManager.schemaInfo, isDefaultSchema: self.schemaManager.isDefaultSchema && self.schemaManager.isDefaultSchema[obj.queryId] ? self.schemaManager.isDefaultSchema[obj.queryId] : null, preSchema: self.schemaManager.preSchema });
                        }
                        if (!obj.schemaValue || obj.schemaId == '1') {
                            self.operateCustomFormatSchema(data, obj);
                        }
                        // 数据加载前事件
                        _this.utils.get('renderExtends').runRenderExtends('beforeLoadData', self.localizeService.getValue('spread.message.extend.dataLoading.before'), data, obj.spread);
                        self.lcpService.getCol(params_1, obj.queryRelativeUrl).subscribe(( /**
                         * @param {?} resultData
                         * @return {?}
                         */function (resultData) {
                            if (obj.schemaId === '1') {
                                if (!data.dynamicCols.length) {
                                    data.dynamicCols = resultData.dynamicCols || [];
                                }
                            }
                            obj.frozenCols = (resultData && resultData.dynamicCols) || [];
                            obj['data'] = data;
                            self.getListRenderTemplate(obj);
                            // { schemaId: _schemaId, queryId, data, queryRelativeUrl, spread, schemaValue, pageIndex, controlType, loading }
                        }));
                    }), ( /**
                     * @param {?} error
                     * @return {?}
                     */function (error) {
                        self.formErrorService.exception(error.Message, error);
                        obj.loading.close();
                    }));
                    this.cache.set('schema_schemaid' + obj.queryId, obj.schemaId);
                    // EventBus.dispatch('schema_schemaid', _schemaId);
                }
                else {
                    obj['data'] = obj.formData;
                    obj['frozenCols'] = obj.formData.dynamicCols;
                    self.getListRenderTemplate(obj);
                    // { schemaId: _schemaId, queryId, formData, queryRelativeUrl, spread, schemaValue, pageIndex, controlType, loading }
                }
            };
        /**
         * @private
         * @param {?} obj
         * @return {?}
         */
        ListTreeRender.prototype.getListRenderTemplate = /**
         * @private
         * @param {?} obj
         * @return {?}
         */
            function (obj) {
                /** @type {?} */
                var self = this;
                self.schemaManager.getSpreadTemplate(obj.schemaId, obj.queryId, obj.data && obj.data.dynamicCols ? obj.data.dynamicCols : [], obj.queryRelativeUrl, obj.customFormatScheme, obj.frozenCols, obj.groupType).subscribe(( /**
                 * @param {?} template
                 * @return {?}
                 */function (template) {
                    template = template.returnValue ? JSON.parse(template.returnValue) : template;
                    self.renderList.call(self, Object.assign({}, obj, { template: template }));
                    self.utils.get('spreadStyle').bindSelectChanged(obj.spread, obj.queryId);
                    /** @type {?} */
                    var event = common$1.RtfServices.getMenuSwitchControlEvent();
                    if (event && typeof event === 'object') {
                        event.next('ok');
                    }
                    common$1.EventBus.dispatch(self.queryId + 'spread_init', {});
                    obj.loading.close();
                }), ( /**
                 * @param {?} error
                 * @return {?}
                 */function (error) {
                    self.formErrorService.exception(error.Message, error);
                    obj.loading.close();
                }));
            };
        /**
         * @param {?} obj
         * @return {?}
         */
        ListTreeRender.prototype.renderList = /**
         * @param {?} obj
         * @return {?}
         */
            function (obj) {
                /** @type {?} */
                var self = this;
                this.type = obj.controlType;
                obj.spread.suspendEvent();
                obj.spread.suspendPaint();
                obj.spread.fromJSON(obj.template);
                /** @type {?} */
                var sheet = obj.spread.getActiveSheet();
                // 储粮需求，多sheet页
                if (obj.curSheet && obj.multiSheets.length) {
                    sheet.name(obj.curSheet);
                    for (var i = 0; i < obj.multiSheets.length; i++) {
                        if (obj.curSheet !== obj.multiSheets[i]) {
                            obj.spread.addSheet(i, new GC.Spread.Sheets.Worksheet(obj.multiSheets[i]));
                            obj.spread.sheets[i].deleteRows(0, obj.spread.sheets[i].getRowCount());
                            obj.spread.sheets[i].deleteColumns(0, obj.spread.sheets[i].getColumnCount());
                        }
                    }
                    obj.spread.setActiveSheet(obj.curSheet);
                    obj.spread.options.tabStripVisible = true;
                    obj.spread.options.tabEditable = false;
                }
                // 储粮需求，多sheet页
                this.utils.get('spreadStyle').cacheStyle(sheet);
                /** @type {?} */
                var showZero = true;
                if (obj.schemaValue && obj.schemaValue.schemaValue && obj.schemaValue.schemaValue.otherOption) {
                    if (obj.schemaValue.schemaValue.otherOption.showZero != null && obj.schemaValue.schemaValue.otherOption.showZero !== undefined) {
                        showZero = obj.schemaValue.schemaValue.otherOption.showZero;
                    }
                }
                if (obj.data && obj.data.data && obj.data.data.length) {
                    obj.data.data.forEach(( /**
                     * @param {?} item
                     * @return {?}
                     */function (item) {
                        if (item.dynamicPropSet) {
                            for (var key in item.dynamicPropSet) {
                                item[key] = item.dynamicPropSet[key];
                            }
                        }
                    }));
                    // 修改枚举字段显示
                    self.changeData(obj.data, obj.schemaValue);
                    sheet.setDataSource(obj.data.data);
                    sheet.bindColumns(this.utils.get('spreadStyle').dataColInfoArray);
                    sheet.options.isProtected = true;
                    sheet.options.protectionOptions = {
                        allowSelectLockedCells: true,
                        allowSelectUnlockedCells: true,
                        allowFilter: true,
                        allowSort: true,
                        allowResizeRows: true,
                        allowResizeColumns: true,
                        allowEditObjects: false
                    };
                    obj.spread.options.allowCopyPasteExcelStyle = true;
                    obj.spread.options.allowExtendPasteRange = true;
                    obj.spread.options.copyPasteHeaderOptions = GC.Spread.Sheets.CopyPasteHeaderOptions.allHeaders;
                    sheet.rowOutlines.direction(GC.Spread.Sheets.Outlines.OutlineDirection.backward);
                    try {
                        if (!obj.schemaValue && obj.customFormatScheme) {
                            if (typeof obj.customFormatScheme == 'string') {
                                obj.schemaValue = {};
                                obj.schemaValue['schemaValue'] = JSON.parse(obj.customFormatScheme);
                            }
                        }
                    }
                    catch (e) { }
                    this.utils.get('spreadStyle').applyStyle(sheet, obj.schemaValue, showZero);
                    this.utils.get('spreadStyle').linkField(obj.spread, sheet);
                    try {
                        /** @type {?} */
                        var extObj = gspframeworkService.rtf.extendMethod.getExtObj();
                        if (extObj) {
                            this.utils.get('spreadStyle').inSuiteLinkField(obj.spread, sheet, extObj);
                        }
                    }
                    catch (e) {
                    }
                    this.footerVariablesReplace(sheet, obj.data);
                }
                else {
                    this.footerVariablesReplace(sheet, obj.data);
                    sheet.deleteRows(0, 1);
                }
                this.titleVariablesReplace(sheet, obj.data);
                this.utils.get('spreadStyle').setAutoFitColumn(obj.schemaValue, sheet);
                if (this.utils.get('spreadStyle').getShowHeaderSort(obj.schemaValue)) {
                    this.utils.get('spreadStyle').setSortCellType(sheet, obj.schemaValue, obj.qdpView);
                }
                if (obj.controlType == 'list') {
                    this.utils.get('spreadStyle').mergeCell(sheet, obj.schemaValue);
                }
                sheet.clearSelection();
                // 页面渲染后事件
                this.utils.get('renderExtends').runRenderExtends('afterLoadData', this.localizeService.getValue('spread.message.extend.dataLoading.after'), obj.data, obj.spread);
                obj.spread.resumePaint();
                obj.spread.resumeEvent();
                // 增加当前单元格联查参数缓存
                this.utils.get('spreadStyle').joinParam['controlType'] = this.type;
                this.cache.set(common$1.RtfServices.getTabId(obj.queryId) + 'joinSearch', this.utils.get('spreadStyle').joinParam);
            };
        return ListTreeRender;
    }(BaseRender));

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
     */
    var RenderService = /** @class */ (function () {
        function RenderService(schemaManager, lcpService, cache, loadService, msgService, dataRenderExtendService, injector) {
            this.schemaManager = schemaManager;
            this.lcpService = lcpService;
            this.cache = cache;
            this.loadService = loadService;
            this.msgService = msgService;
            this.dataRenderExtendService = dataRenderExtendService;
            this.injector = injector;
            this.serviceCache = {};
            this.columnCount = 0;
            this.operations = {};
            this.funcInfoCache = {
                funcIds: [],
                firstLoadCache: []
            };
            /** @type {?} */
            var self = this;
            if (this.injector) {
                this.localizeService = this.injector.get(localize.LocalizeService);
                this.formErrorService = this.injector.get(commandServices.FormErrorService);
                this.cloudprintService = this.injector.get(cloudprint.CloudprintService);
                this.notifyService = this.injector.get(uiNotify.NotifyService);
                this.setService();
                self.schemaManager.operationChange.subscribe(( /**
                 * @param {?} value
                 * @return {?}
                 */function (value) {
                    if (value) {
                        self.operations = value;
                    }
                }));
                self.setSecurityLevel();
            }
        }
        /**
         * @private
         * @return {?}
         */
        RenderService.prototype.setService = /**
         * @private
         * @return {?}
         */
            function () {
                /** @type {?} */
                var tabId = common$1.RtfServices.getTabId() || 'default';
                this.serviceCache[tabId] = {
                    'formErrorService': this.formErrorService,
                    'cloudprintService': this.cloudprintService,
                    'schemaManagerService': this.schemaManager,
                    'lcpService': this.lcpService,
                    'cacheService': this.cache,
                    'loadingService': this.loadService,
                    'msgService': this.msgService,
                    'localizeService': this.localizeService,
                    'notifyService': this.notifyService
                };
            };
        /**
         * @private
         * @return {?}
         */
        RenderService.prototype.getService = /**
         * @private
         * @return {?}
         */
            function () {
                /** @type {?} */
                var tabId = common$1.RtfServices.getTabId() || 'default';
                return this.serviceCache[tabId];
            };
        /**
         * @private
         * @return {?}
         */
        RenderService.prototype.setSecurityLevel = /**
         * @private
         * @return {?}
         */
            function () {
                var _this = this;
                this.lcpService.variablesChange.subscribe(( /**
                 * @param {?} data
                 * @return {?}
                 */function (data) {
                    if (data && data.hasOwnProperty('securityLevel') && data['securityLevel']) {
                        _this.cache.set(common$1.RtfServices.getTabId() + 'securityLevel', data['securityLevel']);
                    }
                }));
            };
        /**
         * @private
         * @return {?}
         */
        RenderService.prototype.getSecurityLevel = /**
         * @private
         * @return {?}
         */
            function () {
                if (this.cache.get(common$1.RtfServices.getTabId() + 'securityLevel')) {
                    return this.cache.get(common$1.RtfServices.getTabId() + 'securityLevel');
                }
                else {
                    return '';
                }
            };
        /**
         * @param {?} option
         * @return {?}
         */
        RenderService.prototype.render = /**
         * @param {?} option
         * @return {?}
         */
            function (option) {
                if (!option.loading) {
                    option.loading = this.loadService.show({ container: 'body' });
                }
                this.spread = option.spread ? option.spread : null;
                this.renderObject = this.getRender(option);
                this.renderObject.render(option);
            };
        /**
         * @private
         * @param {?} obj
         * @return {?}
         */
        RenderService.prototype.getRender = /**
         * @private
         * @param {?} obj
         * @return {?}
         */
            function (obj) {
                this.setService();
                ServicesUtils.setServices('dataRenderExtendService' + obj.queryId, this.dataRenderExtendService);
                /** @type {?} */
                var render;
                switch (obj.controlType) {
                    case 'crosstab':
                        render = new CrosstabRender(obj.queryId, obj.controlType, obj.jointsearchInfoList, this.funcInfoCache, this.getService());
                        break;
                    default:
                        render = new ListTreeRender(obj.queryId, obj.controlType, obj.jointsearchInfoList, this.funcInfoCache, this.getService());
                        break;
                }
                render.isSchemaSelectChanged = obj.isSchemaSelectChanged ? obj.isSchemaSelectChanged : false;
                return render;
            };
        /**
         * @param {?} renderOption
         * @return {?}
         */
        RenderService.prototype.exportData = /**
         * @param {?} renderOption
         * @return {?}
         */
            function (renderOption) {
                var _this = this;
                // exportData(queryId: any, schemaId: any, controlType: any, pageIndex?: number, qoManagerCode?: any, queryRelativeUrl?: any, filterCondition?: any, groupType?: any, voId?: any, totalCount?: any, exportType?: any) {
                /** @type {?} */
                var loading = this.loadService.show({ container: 'body' });
                this.renderObject.utils.get('schema').getSchemaInfo({ schemaId: renderOption.schemaValue, queryId: renderOption.queryId, queryRelativeUrl: renderOption.queryRelativeUrl, groupType: renderOption.groupType }).subscribe(( /**
                 * @param {?} value
                 * @return {?}
                 */function (value) {
                    renderOption.schemaId = renderOption.schemaId ? renderOption.schemaId : (value && value.id ? value.id : '1');
                    /** @type {?} */
                    var schemaName = value && value.schemaValue && value.schemaValue.titleOption && value.schemaValue.titleOption.title
                        ? value.schemaValue.titleOption.title
                        : value && value.schemaName
                            ? value.schemaName
                            : '';
                    if (common$1.RtfServices.getFuncName()) {
                        schemaName = common$1.RtfServices.getFuncName() + '-' + schemaName;
                    }
                    renderOption.excelExportName = schemaName;
                    /** @type {?} */
                    var params = _this.renderObject.utils.get('parameter').createParameters(renderOption);
                    params['exportType'] = renderOption.exportType ? renderOption.exportType : '';
                    /** @type {?} */
                    var isCustomShema = false;
                    /** @type {?} */
                    var customSchema = null;
                    if (params['schemaId'] === '1') {
                        if (ServicesUtils.getServices(common$1.RtfServices.getTabId(renderOption.queryId) + 'customScheme')) {
                            isCustomShema = true;
                            params.customSchema = ServicesUtils.getServices(common$1.RtfServices.getTabId(renderOption.queryId) + 'customScheme');
                            customSchema = JSON.parse(params.customSchema);
                            if (!params.excelExportName) {
                                params.excelExportName = customSchema && customSchema.titleOption && customSchema.titleOption.title
                                    ? customSchema.titleOption.title : 'export';
                            }
                        }
                        else {
                            _this.msgService.warning(_this.localizeService.getValue('spread.message.export'));
                            loading.close();
                            return;
                        }
                    }
                    if (_this.operations['QdpQueryExport'] === false) {
                        _this.msgService.warning(_this.localizeService.getValue('spread.message.validate.qdpQueryExport'));
                        loading.close();
                        return;
                    }
                    try {
                        if (renderOption.controlType === 'treelist' && _this.spread) {
                            /** @type {?} */
                            var expandNodes = '';
                            if (value && value.schemaValue && value.schemaValue.otherOption && value.schemaValue.otherOption.treeInfoType !== 2) {
                                /** @type {?} */
                                var pathField = value.schemaValue.otherOption.treeInfoType === 0 ? value.schemaValue.otherOption.pathField : value.schemaValue.otherOption.idField;
                                if (pathField) {
                                    for (var i = 0; i < _this.spread.getActiveSheet().getRowCount(); i++) {
                                        if (_this.spread.getActiveSheet().rowOutlines.isCollapsed(i)) {
                                            expandNodes += ',' + _this.spread.getActiveSheet().getDataItem(i)[pathField];
                                        }
                                    }
                                    params['expandNodes'] = expandNodes.substring(1);
                                }
                            }
                        }
                    }
                    catch (e) {
                    }
                    _this.columnCount = 0;
                    if (!isCustomShema) {
                        _this.calculationColumnCount(value.schemaValue.columnOption.colList);
                    }
                    else {
                        if (customSchema && customSchema.columnOption && customSchema.columnOption.colList) {
                            _this.calculationColumnCount(customSchema.columnOption.colList);
                        }
                    }
                    _this.lcpService.loading = loading;
                    if (_this.getSecurityLevel()) {
                        params.excelExportName += '_' + _this.getSecurityLevel();
                    }
                    if ((_this.columnCount * renderOption.totalCount) < 100000) {
                        _this.lcpService.exportData(params, renderOption.queryRelativeUrl);
                        loading.close();
                    }
                    else {
                        _this.lcpService.aysnExportData(params, renderOption.queryRelativeUrl);
                        loading.close();
                        _this.msgService.warning(_this.localizeService.getValue('spread.message.aysnExport'));
                    }
                }));
            };
        /**
         * @private
         * @param {?} colList
         * @return {?}
         */
        RenderService.prototype.calculationColumnCount = /**
         * @private
         * @param {?} colList
         * @return {?}
         */
            function (colList) {
                var _this = this;
                try {
                    colList.forEach(( /**
                     * @param {?} item
                     * @return {?}
                     */function (item) {
                        if (item.childList && item.childList.length) {
                            _this.calculationColumnCount(item.childList);
                        }
                        else {
                            _this.columnCount += 1;
                        }
                    }));
                }
                catch (e) {
                    this.columnCount = 0;
                }
            };
        /**
         * @param {?} queryId
         * @param {?} schemaId
         * @param {?} controlType
         * @param {?=} qoManagerCode
         * @param {?=} queryRelativeUrl
         * @param {?=} filterCondition
         * @param {?=} groupType
         * @param {?=} voId
         * @return {?}
         */
        RenderService.prototype.clearCache = /**
         * @param {?} queryId
         * @param {?} schemaId
         * @param {?} controlType
         * @param {?=} qoManagerCode
         * @param {?=} queryRelativeUrl
         * @param {?=} filterCondition
         * @param {?=} groupType
         * @param {?=} voId
         * @return {?}
         */
            function (queryId, schemaId, controlType, qoManagerCode, queryRelativeUrl, filterCondition, groupType, voId) {
                var _this = this;
                this.renderObject.utils.get('schema').getSchemaInfo({ schemaId: schemaId, queryId: queryId, queryRelativeUrl: queryRelativeUrl, groupType: groupType }).subscribe(( /**
                 * @param {?} value
                 * @return {?}
                 */function (value) {
                    schemaId = schemaId ? schemaId : (value && value.id ? value.id : '1');
                    /** @type {?} */
                    var schemaName = value && value.schemaValue && value.schemaValue.titleOption && value.schemaValue.titleOption.title
                        ? value.schemaValue.titleOption.title
                        : value && value.schemaName
                            ? value.schemaName
                            : '';
                    /** @type {?} */
                    var params = _this.renderObject.utils.get('parameter').createParameters({
                        queryId: queryId,
                        controlType: controlType,
                        schemaId: schemaId,
                        qoManagerCode: qoManagerCode,
                        pageIndex: 0,
                        pageSize: 0,
                        excelExportName: schemaName,
                        filterCondition: filterCondition,
                        voId: voId
                    });
                    if (ServicesUtils.getServices(common$1.RtfServices.getTabId(queryId) + 'customScheme')) {
                        params.customSchema = ServicesUtils.getServices(common$1.RtfServices.getTabId(queryId) + 'customScheme');
                    }
                    _this.lcpService.clearCache(params).subscribe(( /**
                     * @param {?} data
                     * @return {?}
                     */function (data) {
                        if (data) {
                            _this.notifyService['success'](( /** @type {?} */({
                                title: _this.localizeService.getValue('ideCmp.schemaManager.message.info.title'), msg: _this.localizeService.getValue('spread.message.clearCache'), timeout: 3000
                            })));
                        }
                    }));
                }));
            };
        /**
         * @param {?} renderOption
         * @return {?}
         */
        RenderService.prototype.pdfExportEvent = /**
         * @param {?} renderOption
         * @return {?}
         */
            function (renderOption) {
                var _this = this;
                // pdfExportEvent(queryId: any, schemaId: any, controlType: any, qoManagerCode?: any, printIntegration?: any, queryRelativeUrl?: any, filterCondition?: any, groupType?: any, pageIndex?: any, voId?: any) {
                /** @type {?} */
                var loading = this.loadService.show({ container: 'body' });
                try {
                    this.renderObject.utils.get('schema').getSchemaInfo({ schemaId: renderOption.schemaValue, queryId: renderOption.queryId, queryRelativeUrl: renderOption.queryRelativeUrl, groupType: renderOption.groupType }).subscribe(( /**
                     * @param {?} value
                     * @return {?}
                     */function (value) {
                        renderOption.schemaId = renderOption.schemaId ? renderOption.schemaId : (value && value.id ? value.id : '1');
                        /** @type {?} */
                        var schemaName = value && value.schemaValue && value.schemaValue.titleOption && value.schemaValue.titleOption.title
                            ? value.schemaValue.titleOption.title
                            : value && value.schemaName
                                ? value.schemaName
                                : '';
                        if (common$1.RtfServices.getFuncName()) {
                            schemaName = common$1.RtfServices.getFuncName() + '-' + schemaName;
                        }
                        renderOption.excelExportName = schemaName;
                        /** @type {?} */
                        var params = _this.renderObject.utils.get('parameter').createParameters(renderOption);
                        if (params['schemaId'] === '1') {
                            if (ServicesUtils.getServices(common$1.RtfServices.getTabId(renderOption.queryId) + 'customScheme')) {
                                params.customSchema = ServicesUtils.getServices(common$1.RtfServices.getTabId(renderOption.queryId) + 'customScheme');
                                /** @type {?} */
                                var customSchema = JSON.parse(params.customSchema);
                                if (!params.excelExportName) {
                                    params.excelExportName = customSchema && customSchema.titleOption && customSchema.titleOption.title
                                        ? customSchema.titleOption.title : 'export';
                                }
                            }
                            else {
                                _this.msgService.warning(_this.localizeService.getValue('spread.message.print'));
                                loading.close();
                                return;
                            }
                        }
                        if (_this.operations['QdpQueryPrint'] === false) {
                            _this.msgService.warning(_this.localizeService.getValue('spread.message.validate.qdpQueryPrint'));
                            loading.close();
                            return;
                        }
                        if (_this.getSecurityLevel()) {
                            params.excelExportName += '_' + _this.getSecurityLevel();
                        }
                        _this.lcpService.pdfExportEvent(params, renderOption.queryRelativeUrl);
                        loading.close();
                    }));
                }
                catch (e) {
                    loading.close();
                    // console.log(e);
                }
            };
        /**
         * @param {?} renderOption
         * @return {?}
         */
        RenderService.prototype.printPreView = /**
         * @param {?} renderOption
         * @return {?}
         */
            function (renderOption) {
                var _this = this;
                // printPreView(queryId: any, schemaId: any, controlType: any, qoManagerCode?: any, printIntegration?: any, queryRelativeUrl?: any, filterCondition?: any, groupType?: any, pageIndex?: any, voId?: any) {
                this.renderObject.utils.get('schema').getSchemaInfo({ schemaId: renderOption.schemaValue, queryId: renderOption.queryId, queryRelativeUrl: renderOption.queryRelativeUrl, groupType: renderOption.groupType }).subscribe(( /**
                 * @param {?} value
                 * @return {?}
                 */function (value) {
                    renderOption.schemaId = renderOption.schemaId ? renderOption.schemaId : (value && value.id ? value.id : '1');
                    /** @type {?} */
                    var schemaName = value && value.schemaValue && value.schemaValue.titleOption && value.schemaValue.titleOption.title
                        ? value.schemaValue.titleOption.title
                        : value && value.schemaName
                            ? value.schemaName
                            : '';
                    renderOption.excelExportName = schemaName;
                    /** @type {?} */
                    var params = _this.renderObject.utils.get('parameter').createParameters(renderOption);
                    if (params['schemaId'] === '1') {
                        if (ServicesUtils.getServices(common$1.RtfServices.getTabId(renderOption.queryId) + 'customScheme')) {
                            params.customSchema = ServicesUtils.getServices(common$1.RtfServices.getTabId(renderOption.queryId) + 'customScheme');
                            /** @type {?} */
                            var customSchema = JSON.parse(params.customSchema);
                            if (!params.excelExportName) {
                                params.excelExportName = customSchema && customSchema.titleOption && customSchema.titleOption.title
                                    ? customSchema.titleOption.title : 'export';
                            }
                        }
                        else {
                            _this.msgService.warning(_this.localizeService.getValue('spread.message.preview'));
                            return;
                        }
                    }
                    if (_this.getSecurityLevel()) {
                        params.excelExportName += '_' + _this.getSecurityLevel();
                    }
                    _this.lcpService.cloudprintService = _this.cloudprintService;
                    _this.lcpService.printPreView(params, renderOption.queryRelativeUrl);
                }));
            };
        /**
         * @param {?=} queryId
         * @return {?}
         */
        RenderService.prototype.clearFirstLoadCache = /**
         * @param {?=} queryId
         * @return {?}
         */
            function (queryId) {
                /** @type {?} */
                var funcId = common$1.RtfServices.getTabId(queryId);
                /** @type {?} */
                var index = this.funcInfoCache.firstLoadCache.findIndex(( /**
                 * @param {?} el
                 * @return {?}
                 */function (el) { return el === funcId; }));
                if (index >= 0) {
                    this.funcInfoCache.firstLoadCache.splice(index, 1);
                }
            };
        RenderService.decorators = [
            { type: core.Injectable }
        ];
        /** @nocollapse */
        RenderService.ctorParameters = function () {
            return [
                { type: common$1.SchemaManagerService },
                { type: common$1.LcpService },
                { type: cafCommon.CacheService },
                { type: uiLoading.LoadingService },
                { type: uiMessager.MessagerService },
                { type: common$1.DataRenderExtendService, decorators: [{ type: core.Optional }] },
                { type: core.Injector, decorators: [{ type: core.Optional }] }
            ];
        };
        return RenderService;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
     */
    var DimensionSettingComponent = /** @class */ (function () {
        function DimensionSettingComponent(injector) {
            this.injector = injector;
            this.isCompare = false;
            // 值维度  
            this.searchText = '';
            this.groupIcon = '<span class="k-icon k-i-search"></span>';
            this.lists = [];
            this.listsCache = [];
            this.models = {
                selected: null,
                lists: this.lists
            };
            if (this.injector) {
                this.localizeService = this.injector.get(localize.LocalizeService);
                this.renderService = this.injector.get(RenderService);
                this.msgService = this.injector.get(uiMessager.MessagerService);
                this.formErrorService = this.injector.get(commandServices.FormErrorService);
                this.schemaManagerService = this.injector.get(common$1.SchemaManagerService);
            }
            this.initLists();
        }
        /**
         * @return {?}
         */
        DimensionSettingComponent.prototype.ngOnInit = /**
         * @return {?}
         */
            function () {
                /** @type {?} */
                var eventId = common$1.RtfServices.getTabId(this.queryId);
                common$1.EventBus.register('schemaValueChanged', this.handleSchemaValueChanged.bind(this), eventId + 'dimensionSetting');
            };
        /**
         * @return {?}
         */
        DimensionSettingComponent.prototype.ngOnDestroy = /**
         * @return {?}
         */
            function () { };
        /**
         * @private
         * @return {?}
         */
        DimensionSettingComponent.prototype.initLists = /**
         * @private
         * @return {?}
         */
            function () {
                this.lists = [];
                for (var i = 0; i < 4; i++) {
                    this.lists.push({
                        name: this.localizeService.getValue('spread.crossTable.dimensionName')[i],
                        value: []
                    });
                }
            };
        /**
         * 初始化交叉表维度设置
         */
        /**
         * 初始化交叉表维度设置
         * @return {?}
         */
        DimensionSettingComponent.prototype.initCrosstab = /**
         * 初始化交叉表维度设置
         * @return {?}
         */
            function () {
                // this.renderService.renderObject.currentSchemaValueChanger.subscribe((schemaValue: any) => {
                // });
            };
        /**
         * @private
         * @param {?} schemaValue
         * @return {?}
         */
        DimensionSettingComponent.prototype.handleSchemaValueChanged = /**
         * @private
         * @param {?} schemaValue
         * @return {?}
         */
            function (schemaValue) {
                var _this = this;
                if (schemaValue) {
                    if (schemaValue.id === 1 || schemaValue.id === '1')
                        return;
                    this.schemaValue = schemaValue;
                    if (this.controlType === 'crosstab') {
                        this.colList = schemaValue.schemaValue.columnOption.colList;
                        if (this.colList) {
                            this.zero = this.colList.filter(( /**
                             * @param {?} x
                             * @return {?}
                             */function (x) { return x.dimension === 0; }));
                            this.rowDimension = this.colList.filter(( /**
                             * @param {?} x
                             * @return {?}
                             */function (x) { return x.dimension === 1; }));
                            this.colDimension = this.colList.filter(( /**
                             * @param {?} x
                             * @return {?}
                             */function (x) { return x.dimension === 2; }));
                            this.valDimension = this.colList.filter(( /**
                             * @param {?} x
                             * @return {?}
                             */function (x) { return x.dimension === 3; }));
                            setTimeout(( /**
                             * @return {?}
                             */function () {
                                _this.lists[0].value = _this.zero;
                                _this.listsCache = _this.zero;
                                _this.lists[1].value = _this.rowDimension;
                                _this.lists[2].value = _this.colDimension;
                                _this.lists[3].value = _this.valDimension;
                            }));
                        }
                    }
                }
            };
        /**
         * @param {?} index
         * @param {?} list
         * @return {?}
         */
        DimensionSettingComponent.prototype.moved = /**
         * @param {?} index
         * @param {?} list
         * @return {?}
         */
            function (index, list) {
                var _this = this;
                list.splice(index, 1);
                this.selectedDimesion();
                if (this.schemaValue) {
                    if (this.schemaValue.isProtected === 1 || this.schemaValue.isProtected === '1') {
                        this.msgService.info(this.localizeService.getValue('ideCmp.schemaManager.message.validate.isProtected'));
                        return;
                    }
                    this.schemaValue.schemaValue = JSON.stringify(this.schemaValue.schemaValue);
                    this.schemaManagerService.saveSchema({ 'schema': JSON.stringify(this.schemaValue) }, this.queryRelativeUrl).subscribe(( /**
                     * @return {?}
                     */function () {
                        _this.renderService.render({ queryId: _this.queryId, spread: _this.spread, controlType: _this.controlType, qoManagerCode: _this.qoManagerCode, queryRelativeUrl: _this.queryRelativeUrl, schemaValue: _this.schemaValue, filterCondition: _this.conditionExpression, groupType: _this.groupType, voId: _this.voId, jointsearchInfoList: _this.jointsearchInfoList, fromCache: true, qdpView: _this.qdpView });
                        _this.schemaValue.schemaValue = typeof _this.schemaValue.schemaValue === 'string' ? JSON.parse(_this.schemaValue.schemaValue) : _this.schemaValue.schemaValue;
                    }), ( /**
                     * @param {?} error
                     * @return {?}
                     */function (error) {
                        _this.formErrorService.exception(error.Message, error);
                    }));
                }
            };
        /**
         * @private
         * @param {?} columns
         * @return {?}
         */
        DimensionSettingComponent.prototype.crosstabColumnValidate = /**
         * @private
         * @param {?} columns
         * @return {?}
         */
            function (columns) {
                /** @type {?} */
                var flag = false;
                if (this.controlType === 'crosstab') {
                    // tslint:disable-next-line:prefer-for-of
                    for (var i = 0; i < columns.length; i++) {
                        if (columns[i].groupAggre !== 4 && columns[i].totalAggre !== 4) {
                            if (!'int,integer,float,double,decimal,number'.includes(columns[i].type ? columns[i].type.toLowerCase() : '')) {
                                flag = true;
                                break;
                            }
                        }
                    }
                }
                return flag;
            };
        /**
         * @return {?}
         */
        DimensionSettingComponent.prototype.selectedDimesion = /**
         * @return {?}
         */
            function () {
                this.colList = [];
                if (this.lists[0]) {
                    this.lists[0].value.forEach(( /**
                     * @param {?} value
                     * @return {?}
                     */function (value) {
                        value.dimension = 0;
                        value.isGroup = false;
                        value.groupAggre = 0;
                    }));
                    this.colList = this.lists[0].value;
                }
                if (this.lists[1]) {
                    this.lists[1].value.forEach(( /**
                     * @param {?} value
                     * @return {?}
                     */function (value) {
                        value.dimension = 1;
                        value.isGroup = true;
                        value.groupAggre = 0;
                    }));
                    if (this.colList.length === 0) {
                        this.colList = this.lists[1].value;
                    }
                    else {
                        this.colList = this.colList.concat(this.lists[1].value);
                    }
                }
                if (this.lists[2]) {
                    this.lists[2].value.forEach(( /**
                     * @param {?} value
                     * @return {?}
                     */function (value) {
                        value.dimension = 2;
                        value.isGroup = true;
                        value.groupAggre = 0;
                    }));
                    if (this.colList.length === 0) {
                        this.colList = this.lists[2].value;
                    }
                    else {
                        this.colList = this.colList.concat(this.lists[2].value);
                    }
                }
                if (this.lists[3]) {
                    this.lists[3].value.forEach(( /**
                     * @param {?} value
                     * @return {?}
                     */function (value) {
                        value.dimension = 3;
                        value.isGroup = false;
                        value.groupAggre = 1;
                    }));
                    if (this.colList.length === 0) {
                        this.colList = this.lists[3].value;
                    }
                    else {
                        this.colList = this.colList.concat(this.lists[3].value);
                    }
                }
                if (this.colList.length > 0) {
                    try {
                        this.isCompare = common$1.JSONUtils.Compare({ schema: this.schemaValue.schemaValue.columnOption.colList }, { schema: this.colList });
                    }
                    catch (e) { }
                    this.schemaValue.schemaValue.columnOption.colList = this.colList;
                }
            };
        /**
         * @param {?} val
         * @return {?}
         */
        DimensionSettingComponent.prototype.dimensionSearchValueOnChange = /**
         * @param {?} val
         * @return {?}
         */
            function (val) {
                if (val) {
                    /** @type {?} */
                    var searchCols = this.listsCache.find(( /**
                     * @param {?} item
                     * @return {?}
                     */function (item) { return item.name.indexOf(val) >= 0; }));
                    this.lists[0].value = __spread(searchCols);
                }
                else {
                    this.lists[0].value = __spread(this.listsCache);
                }
            };
        /**
         * @param {?} $event
         * @return {?}
         */
        DimensionSettingComponent.prototype.dndListChange0 = /**
         * @param {?} $event
         * @return {?}
         */
            function ($event) {
                if (this.lists && this.lists.length) {
                    this.lists[0].value = $event;
                }
            };
        /**
         * @param {?} $event
         * @return {?}
         */
        DimensionSettingComponent.prototype.dndListChange1 = /**
         * @param {?} $event
         * @return {?}
         */
            function ($event) {
                if (this.lists && this.lists.length) {
                    this.lists[1].value = $event;
                }
            };
        /**
         * @param {?} $event
         * @return {?}
         */
        DimensionSettingComponent.prototype.dndListChange2 = /**
         * @param {?} $event
         * @return {?}
         */
            function ($event) {
                if (this.lists && this.lists.length) {
                    this.lists[2].value = $event;
                }
            };
        /**
         * @param {?} $event
         * @return {?}
         */
        DimensionSettingComponent.prototype.dndListChange3 = /**
         * @param {?} $event
         * @return {?}
         */
            function ($event) {
                if (this.crosstabColumnValidate($event)) {
                    for (var i = 0; i < $event.length; i++) {
                        /** @type {?} */
                        var dimensionIndex = $event[i].dimension - 0;
                        if (dimensionIndex !== 3) {
                            this.lists[dimensionIndex].value = __spread(this.lists[dimensionIndex].value, [$event.splice(i, 1)[0]]);
                        }
                    }
                    this.msgService.warning(this.localizeService.getValue('ideCmp.schemaManager.message.validate.crosstabValueDimension'));
                    return;
                }
                if (this.lists && this.lists.length) {
                    this.lists[3].value = $event;
                }
            };
        DimensionSettingComponent.decorators = [
            { type: core.Component, args: [{
                        selector: 'dimension-setting',
                        template: "<div class=\"container f-utils-fill-flex-column h-100\">\r\n  <div class=\"simpleDemo f-utils-fill-flex-row\">\r\n    <div class=\"col-md-6 f-utils-flex-column p-1\">\r\n      <div class=\"card f-utils-fill-flex-column\">\r\n        <div class=\"card-body f-utils-fill-flex-column p-0\">\r\n          <div class=\"cardTitle mb-2 pt-2\">\r\n            <span id=\"unselected\" class=\"f-icon pt-1 pr-2 pl-2\" role=\"presentation\">\r\n              <img src=\"data:image/svg+xml;charset=utf-8;base64,PHN2ZyB3aWR0aD0nMTZweCcgaGVpZ2h0PScxNnB4JyB2aWV3Qm94PScwIDAgMTYgMTYnIHZlcnNpb249JzEuMScgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB4bWxuczp4bGluaz0naHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayc+PHRpdGxlPuW+hemAieWtl+autTwvdGl0bGU+PGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+PGcgaWQ9J+mhtemdoi0xJyBzdHJva2U9J25vbmUnIHN0cm9rZS13aWR0aD0nMScgZmlsbD0nbm9uZScgZmlsbC1ydWxlPSdldmVub2RkJyBvcGFjaXR5PScwLjQ1OTU0MjQxMSc+PGcgaWQ9JzHjgIHmn6Xor6JVSeiuvuiuoScgdHJhbnNmb3JtPSd0cmFuc2xhdGUoLTkzMi4wMDAwMDAsIC0xNTEuMDAwMDAwKScgZmlsbD0nIzAwMDAwMCcgZmlsbC1ydWxlPSdub256ZXJvJz48ZyBpZD0n57yW57uELTI2JyB0cmFuc2Zvcm09J3RyYW5zbGF0ZSg4OTguMDAwMDAwLCA3NS4wMDAwMDApJz48ZyBpZD0n57yW57uELTI0JyB0cmFuc2Zvcm09J3RyYW5zbGF0ZSgyMC4wMDAwMDAsIDY1LjAwMDAwMCknPjxnIGlkPSfnvJbnu4QtMjEnIHRyYW5zZm9ybT0ndHJhbnNsYXRlKDEuMDAwMDAwLCAxLjAwMDAwMCknPjxnIGlkPSdzaG91Y2FuZy0yJyB0cmFuc2Zvcm09J3RyYW5zbGF0ZSgxMy4wMDAwMDAsIDEwLjAwMDAwMCknPjxwYXRoIGQ9J00xMS41NjA5NDkyLDE0LjQ3MjcxODMgQzExLjM2NDAzMzIsMTQuNDcyNzE4MyAxMS4xNDI4MzU5LDE0LjQxNjE4MzYgMTAuOTM3NTI1NCwxNC4zMTM1NjI1IEw4LjAwNzc1MTk1LDEyLjg0ODE4MzYgTDUuMDU5ODM1OTQsMTQuMzExMTgzNiBDNC44NzMxNDY0OCwxNC40MTA1NzgxIDQuNjU5NDQxNDEsMTQuNDYyODczIDQuNDQxNTI1MzksMTQuNDYyODczIEM0LjE1ODM1ODQyLDE0LjQ2MzkxNTcgMy44ODI0MTU1NCwxNC4zNzM1NDU4IDMuNjU0NzIyNjYsMTQuMjA1MTk5MiBDMy4yNDIxNDY0OCwxMy44OTU4MDQ3IDMuMDMwNzM4MjgsMTMuMzU5NTkzNyAzLjEyODMyODEyLDEyLjg3MTQ5NDEgTDMuNzMxMjQ0MTQsOS43NDM4ODg2NyBMMS40MjAzMjgxMiw3LjU4OTc4OTA2IEMxLjA2MzM4MzQyLDcuMjI4MTM2ODYgMC45MjY0MjQ0NTgsNi43MDM1NjQzOCAxLjA2MTAxNzU4LDYuMjEzNTc4MTIgTDEuMDY1NjM4NjcsNi4xOTc2OTE0MSBDMS4yMzM2Mzg2Nyw1LjY5NDE4MzU5IDEuNjUwNDEyMTEsNS4zNDEzODA4NiAyLjE1NTc1MTk1LDUuMjczNjkxNDEgTDUuMzY2NDQxNDEsNC42ODk5MDIzNCBMNi44MDc1MjUzOSwxLjc2MzA0MTAyIEM3LjAzOTAxNzU4LDEuMjk5NjMyODEgNy41MDk4NDk2MSwxLjAwMTg1OTM3IDguMDA3NzUxOTUsMS4wMDE4NTkzNyBDOC41MjcxNDY0OCwxLjAwMTg1OTM3IDkuMDEwMTQ2NDgsMS4zMTA4NDM3NSA5LjIxMjY1NDMsMS43NzE0NDkyMiBMMTAuNjQ5MTMwOSw0LjY4OTAyNzM0IEwxMy44NjAzMTI1LDUuMjUwNDQ5MjIgQzE0LjM2OTg3NDcsNS4zMjQzMDAwMyAxNC43ODg3MTU0LDUuNjkwMjA3NjIgMTQuOTMwMzI4MSw2LjE4NTIzNjMzIEMxNS4wODg4NDQ4LDYuNjcxNzczNDkgMTQuOTU5MzY4Miw3LjIwNjExMjA4IDE0LjU5NTcyMjcsNy41NjYxMjMwNSBMMTQuNTg3ODIwMyw3LjU3NDAzOTA2IEwxMi4yODM0MjU4LDkuNzQ0MDM5MDYgTDEyLjg2NTgyMDMsMTIuODc3MjIyNyBDMTIuOTU5NjA5NCwxMy4zNzg0MzM2IDEyLjc2MDMyODEsMTMuODg0MzIwMyAxMi4zNDU0NDE0LDE0LjE5OTc0NDEgQzEyLjEyMzMxODEsMTQuMzc4NjAyMiAxMS44NDYxMjE3LDE0LjQ3NTA0MTMgMTEuNTYwOTQ5MiwxNC40NzI3MTgzIEwxMS41NjA5NDkyLDE0LjQ3MjcxODMgWiBNOC4wMDg4MDQ2OSwxMS43NDY1MDM5IEwxMS4wODYyNzU0LDEzLjI4NTQ2NDggQzExLjE3NjcxNDgsMTMuMzMxMTAxNiAxMS4yODA4ODA5LDEzLjM1OTY2MjEgMTEuMzUyMDU2NiwxMy4zNTk2NjIxIEMxMS40NjE4MjgxLDEzLjM1OTY2MjEgMTEuNTYzNzUyLDEzLjMyNTkxOTkgMTEuNjM4NDQxNCwxMy4yNjM1NDg4IEwxMS42NTI1MDk4LDEzLjI1MjA2NDUgQzExLjgyNzM3MywxMy4xMjA3NDYxIDExLjkxMjU0ODgsMTIuOTEyNDI3NyAxMS44NzQzMzU5LDEyLjcwODEwMTYgTDExLjI1NDgzNTksOS4zNzE5NzI2NiBMMTMuNzA0NDk0MSw3LjA2NTE4NTU1IEMxMy44NTQ3NzU0LDYuOTEyNzMwNDcgMTMuOTA2MjIyNyw2LjY5NDQwNDMgMTMuODM5NDM1NSw2LjQ5MzU2NDQ1IEwxMy44MzI4NzMsNi40NzI1MDk3NyBDMTMuNzc4OTIxMiw2LjI3ODAxNzY2IDEzLjYxNDIyNjEsNi4xMzQ0MTAzMyAxMy40MTQxOTkyLDYuMTA3NDQzMzYgTDEzLjQwMDE5OTIsNi4xMDUyODMyIEwxMC4wMTA4MDQ3LDUuNTEyNjYyMTEgTDguNDg1NDg4MjgsMi40MTQxOTE0MSBDOC40MTEyMDg5OCwyLjI0MTA3ODEyIDguMjEwNDUxMTcsMi4xMTU0MzM1OSA4LjAwNzQ1MTE3LDIuMTE1NDMzNTkgQzcuODA4MDE5NTMsMi4xMTU0MzM1OSA3LjYxNzMzNzg5LDIuMjQwMjQ0MTQgNy41MjA2Nzc3MywyLjQzMzA4NTk0IEw2LjAwNTA1NDY5LDUuNTExMzM1OTQgTDIuNTk3NzIyNjYsNi4xMzAyODkwNiBDMi4zOTA4MTI1LDYuMTU2MjUxOTUgMi4yMzAwMTc1OCw2LjI5MzczNjMzIDIuMTU1ODIwMzEsNi41MDgwNzAzMSBDMi4xMDMxMDE1Niw2LjcwNDAwMTk1IDIuMTY1NDcyNjYsNi45Mzk4OTY0OCAyLjMwOTUzMzIsNy4wODcxMTUyMyBMNC43NjE4NTc0Miw5LjM3MjM5NjQ4IEw0LjExODI2NzU4LDEyLjcxMDM1NzQgQzQuMDc5NjMwODYsMTIuOTAzMjY3NiA0LjE3MDk3MjY2LDEzLjEyNTUxNzYgNC4zNDAwOTM3NSwxMy4yNTI1MDIgQzQuNDI0ODU5MzcsMTMuMzE2MjEyOSA0LjUzNDY5OTIyLDEzLjM1MTM0OTYgNC42NDk4NDM3NSwxMy4zNTEzNDk2IEM0LjczODYwMTU2LDEzLjM1MTM0OTYgNC44MjM4MDQ2OSwxMy4zMzA2MjMgNC44OTcxNjc5NywxMy4yOTExMzg3IEw0LjkwNzcyMjY2LDEzLjI4NDk4NjMgTDguMDA4ODA0NjksMTEuNzQ2NTAzOSBaJyBpZD0n5b2i54q2Jz48L3BhdGg+PC9nPjwvZz48L2c+PC9nPjwvZz48L2c+PC9zdmc+\" style=\"width: 15px; height: 15px; display: block;\" />\r\n            </span>\r\n            <span class=\"pl-3 dimensionTitle\">{{lists && lists.length ? lists[0].name : ''}}</span>\r\n          </div>\r\n          <input-group [groupText]=\"groupIcon\" class=\"m-1\" [(value)]=\"searchText\"\r\n            (valueChange)=\"dimensionSearchValueOnChange($event)\"></input-group>\r\n          <ul id=\"unselectFieldList\" class=\"f-utils-overflow-xhya f-utils-fill pb-1\" [dndList]=\"lists && lists.length ? lists[0].value : []\"  (dndListChange)=\"dndListChange0($event)\">\r\n            <li *ngFor=\"let item of (lists && lists.length ? lists[0].value : []); let i = index;\" [dndDraggable]=\"item\"\r\n              (dndMoved)=\"moved(i, lists[0].value)\" dndEffectAllowed=\"move\" (dndSelected)=\"models.selected = item\"\r\n              [ngClass]=\"{'selected': models.selected === item}\">\r\n              <span class=\"unselectFieldFront mr-2\" *ngIf=\"'int,float,double,decimal,number'.includes(item.type)==false\">Abc</span>\r\n              <span class=\"unselectFieldFront mr-2\" *ngIf=\"'int,float,double,decimal,number'.includes(item.type)==true\">123</span>\r\n              <span class=\"unselectField\">{{item.name}}</span>\r\n            </li>\r\n          </ul>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=\"col-md-6 f-utils-flex-column p-1\">\r\n      <div class=\"card f-utils-fill-flex-column\">\r\n        <div class=\"card-body  f-utils-fill-flex-column p-0\">\r\n          <div class=\"cardTitle mb-2 pt-2\">\r\n            <span id=\"valuefield\" class=\"f-icon pt-1 pr-2 pl-2\" role=\"presentation\">\r\n              <img src=\"data:image/svg+xml;charset=utf-8;base64,PHN2ZyB3aWR0aD0nMTZweCcgaGVpZ2h0PScxNnB4JyB2aWV3Qm94PScwIDAgMTYgMTYnIHZlcnNpb249JzEuMScgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB4bWxuczp4bGluaz0naHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayc+PHRpdGxlPuWAvOe7tOW6pjwvdGl0bGU+PGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+PGcgaWQ9J+mhtemdoi0xJyBzdHJva2U9J25vbmUnIHN0cm9rZS13aWR0aD0nMScgZmlsbD0nbm9uZScgZmlsbC1ydWxlPSdldmVub2RkJyBvcGFjaXR5PScwLjQ1OTU0MjQxMSc+PGcgaWQ9JzHjgIHmn6Xor6JVSeiuvuiuoScgdHJhbnNmb3JtPSd0cmFuc2xhdGUoLTExNTEuMDAwMDAwLCAtMTUyLjAwMDAwMCknIGZpbGw9JyMwMDAwMDAnIGZpbGwtcnVsZT0nbm9uemVybyc+PGcgaWQ9J+e8lue7hC0yNicgdHJhbnNmb3JtPSd0cmFuc2xhdGUoODk4LjAwMDAwMCwgNzUuMDAwMDAwKSc+PGcgaWQ9J+e8lue7hC0zMicgdHJhbnNmb3JtPSd0cmFuc2xhdGUoMjM5LjAwMDAwMCwgNjUuMDAwMDAwKSc+PGcgaWQ9J+e8lue7hC0zMSc+PGcgaWQ9J+e8lue7hC0yMeWkh+S7vScgdHJhbnNmb3JtPSd0cmFuc2xhdGUoMS4wMDAwMDAsIDEuMDAwMDAwKSc+PGcgaWQ9J3dlaWR1JyB0cmFuc2Zvcm09J3RyYW5zbGF0ZSgxMy4wMDAwMDAsIDExLjAwMDAwMCknPjxwYXRoIGQ9J00xMS41NSw0Ljk4NCBDMTIuMTMsNC42NTQgMTIuNjI0LDUuNTI0IDEyLjA0NCw1Ljg1MyBMOS4wMDIsNy42MiBDOS4wMDQsNy42MzYgOS4wMTIsNy42NSA5LjAxMiw3LjY2NiBMOS4wMTIsMTEuNjk4IEM5LjAxMiwxMS45NzQxNDI0IDguNzg4MTQyMzcsMTIuMTk4IDguNTEyLDEyLjE5OCBDOC4yMzU4NTc2MywxMi4xOTggOC4wMTIsMTEuOTc0MTQyNCA4LjAxMiwxMS42OTggTDguMDEyLDcuNjg3IEw0LjkwNiw1LjkwOSBDNC4zMjYsNS41NzkgNC44MjEsNC43MDkgNS40MDEsNS4wMzkgTDguNDQ5LDYuNzg1IEwxMS41NSw0Ljk4NCBaIE0xNC4yNTQsMy4xMzIgQzE0LjcxNywzLjQwNCAxNC45OTk5OTk1LDMuOSAxNC45OTk5OTk1LDQuNDM2IEwxNC45OTk5OTk1LDEwLjY0OSBDMTQuOTk5OTk5NSwxMS4xOTIgMTQuNzEsMTEuNjkzIDE0LjIzOCwxMS45NjIgTDkuMjM4LDE0LjgwNSBDOC43OCwxNS4wNjUgOC4yMTksMTUuMDY1IDcuNzYyLDE0LjgwNSBMMi43NjIsMTEuOTYyIEMyLjI5MDQ2NDQ2LDExLjY5MzEwOTEgMS45OTk1MzgxNSwxMS4xOTE4MTQ4IDEuOTk5OTk5NDUsMTAuNjQ5IEwxLjk5OTk5OTQ1LDQuNDM2IEMxLjk5OTk5OTQ1LDMuOSAyLjI4MywzLjQwNCAyLjc0NSwzLjEzMiBMNy43NDMsMC4yMDUgQzguMjA5MzUxMzMsLTAuMDY3ODY4Mjc5OSA4Ljc4NjY0ODY3LC0wLjA2Nzg2ODI3OTkgOS4yNTMsMC4yMDUgTDE0LjI1NSwzLjEzMiBMMTQuMjU0LDMuMTMyIFogTTEzLjk5OTk5OTgsMTAuNjUgTDEzLjk5OTk5OTgsNC40MzYgQzE0LjAwMDU2MDQsNC4yNTc0ODA4NiAxMy45MDYwODU2LDQuMDkyMTQ5OTUgMTMuNzUyLDQuMDAyIEw4Ljc0OCwxLjA3NCBDOC41OTI3MTAyMywwLjk4Mjg5MTQzOCA4LjQwMDI4OTc3LDAuOTgyODkxNDM4IDguMjQ1LDEuMDc0IEwzLjI0OCw0LjAwMiBDMy4wOTQyMTQ3Niw0LjA5MjQ0Njk2IDIuOTk5ODQ3OTUsNC4yNTc1ODg4OCAyLjk5OTk5OTgyLDQuNDM2IEwyLjk5OTk5OTgyLDEwLjY0OSBDMi45OTk5OTk4MiwxMC44Mjk5Njc1IDMuMDk2OTYxOTUsMTAuOTk3MDY1IDMuMjU0LDExLjA4NyBMOC4yNTQsMTMuOTMgQzguNDA2LDE0LjAxNiA4LjU5NCwxNC4wMTYgOC43NDYsMTMuOTMgTDEzLjc0NiwxMS4wODcgQzEzLjkwMzMzMzIsMTAuOTk3MzYyMSAxNC4wMDAzNDM3LDEwLjgzMDA3NjEgMTMuOTk5OTk5OCwxMC42NDkgTDEzLjk5OTk5OTgsMTAuNjUgWicgaWQ9J+W9oueKtic+PC9wYXRoPjwvZz48L2c+PC9nPjwvZz48L2c+PC9nPjwvZz48L3N2Zz4=\" style=\"width: 15px; height: 15px; display: block;\" />\r\n            </span>\r\n            <span class=\"pl-3 dimensionTitle\">{{lists && lists.length ? lists[3].name : ''}}</span>\r\n          </div>\r\n          <div id=\"valuefieldimg\" *ngIf=\"lists && lists.length ? (lists[3]?.value?.length < 1) : true\"\r\n            class=\"f-utils-absolute-all f-utils-flex-column justify-content-center align-items-center\"\r\n            role=\"presentation\" style=\"align-items: center; top: 36px; z-index: 10;\">\r\n            <img src=\"data:image/svg+xml;charset=utf-8;base64,PHN2ZyB3aWR0aD0nNTBweCcgaGVpZ2h0PSc1MHB4JyB2aWV3Qm94PScwIDAgNTAgNTAnIHZlcnNpb249JzEuMScgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB4bWxuczp4bGluaz0naHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayc+PHRpdGxlPuWIl+e7tOW6puWbvjwvdGl0bGU+PGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+PGRlZnM+PHJlY3QgaWQ9J3BhdGgtMScgeD0nMjYnIHk9JzMxJyB3aWR0aD0nMjQnIGhlaWdodD0nMTgnIHJ4PScwLjUnPjwvcmVjdD48ZmlsdGVyIHg9Jy02LjIlJyB5PSctOC4zJScgd2lkdGg9JzExMi41JScgaGVpZ2h0PScxMTYuNyUnIGZpbHRlclVuaXRzPSdvYmplY3RCb3VuZGluZ0JveCcgaWQ9J2ZpbHRlci0yJz48ZmVPZmZzZXQgZHg9JzAnIGR5PScwJyBpbj0nU291cmNlQWxwaGEnIHJlc3VsdD0nc2hhZG93T2Zmc2V0T3V0ZXIxJz48L2ZlT2Zmc2V0PjxmZUdhdXNzaWFuQmx1ciBzdGREZXZpYXRpb249JzAuNScgaW49J3NoYWRvd09mZnNldE91dGVyMScgcmVzdWx0PSdzaGFkb3dCbHVyT3V0ZXIxJz48L2ZlR2F1c3NpYW5CbHVyPjxmZUNvbXBvc2l0ZSBpbj0nc2hhZG93Qmx1ck91dGVyMScgaW4yPSdTb3VyY2VBbHBoYScgb3BlcmF0b3I9J291dCcgcmVzdWx0PSdzaGFkb3dCbHVyT3V0ZXIxJz48L2ZlQ29tcG9zaXRlPjxmZUNvbG9yTWF0cml4IHZhbHVlcz0nMCAwIDAgMCAwLjExNDg0Mzc1IDAgMCAwIDAgMC41MTU4ODE4MTcgMCAwIDAgMCAxIDAgMCAwIDAuNzI2NDgwNTUxIDAnIHR5cGU9J21hdHJpeCcgaW49J3NoYWRvd0JsdXJPdXRlcjEnPjwvZmVDb2xvck1hdHJpeD48L2ZpbHRlcj48bGluZWFyR3JhZGllbnQgeDE9JzUwJScgeTE9JzEwMCUnIHgyPSc1MCUnIHkyPScwJScgaWQ9J2xpbmVhckdyYWRpZW50LTMnPjxzdG9wIHN0b3AtY29sb3I9JyNEQUVCRkYnIHN0b3Atb3BhY2l0eT0nMC4yMDMwNDMwNTEnIG9mZnNldD0nMCUnPjwvc3RvcD48c3RvcCBzdG9wLWNvbG9yPScjQjNEMkZGJyBzdG9wLW9wYWNpdHk9JzAuNDczMDM4NjgnIG9mZnNldD0nMTAwJSc+PC9zdG9wPjwvbGluZWFyR3JhZGllbnQ+PC9kZWZzPjxnIGlkPSfpobXpnaItMScgc3Ryb2tlPSdub25lJyBzdHJva2Utd2lkdGg9JzEnIGZpbGw9J25vbmUnIGZpbGwtcnVsZT0nZXZlbm9kZCc+PGcgaWQ9JzHjgIHmn6Xor6JVSeiuvuiuoScgdHJhbnNmb3JtPSd0cmFuc2xhdGUoLTEyMTQuMDAwMDAwLCAtNTY1LjAwMDAwMCknPjxnIGlkPSfnvJbnu4QtMjYnIHRyYW5zZm9ybT0ndHJhbnNsYXRlKDg5OC4wMDAwMDAsIDc1LjAwMDAwMCknPjxnIGlkPSfnvJbnu4QtMzAnIHRyYW5zZm9ybT0ndHJhbnNsYXRlKDIzOS4wMDAwMDAsIDM3NS4wMDAwMDApJz48ZyBpZD0n57yW57uELTM05aSH5Lu9JyB0cmFuc2Zvcm09J3RyYW5zbGF0ZSg0MC4wMDAwMDAsIDExNS4wMDAwMDApJz48ZyBpZD0n57yW57uELTMzJyB0cmFuc2Zvcm09J3RyYW5zbGF0ZSgzNy4wMDAwMDAsIDAuMDAwMDAwKSc+PGcgaWQ9J+e8lue7hC01Jz48cmVjdCBpZD0n55+p5b2i5aSH5Lu9LTMnIGZpbGw9JyNCM0QyRkYnIG9wYWNpdHk9JzAuMjQzODYxNjA3JyB4PScyNicgeT0nMTAnIHdpZHRoPScyNCcgaGVpZ2h0PScxOCcgcng9JzAuNSc+PC9yZWN0PjxnIGlkPSfnn6nlvaLlpIfku70tNicgb3BhY2l0eT0nMC41OTYxMjE2NTInPjx1c2UgZmlsbD0nYmxhY2snIGZpbGwtb3BhY2l0eT0nMScgZmlsdGVyPSd1cmwoI2ZpbHRlci0yKScgeGxpbms6aHJlZj0nI3BhdGgtMSc+PC91c2U+PHJlY3Qgc3Ryb2tlLW9wYWNpdHk9JzAuMjIzNDQ4NDI3JyBzdHJva2U9JyMwMDUxQjknIHN0cm9rZS13aWR0aD0nMScgc3Ryb2tlLWxpbmVqb2luPSdzcXVhcmUnIGZpbGw9JyM3QkIyRjgnIGZpbGwtcnVsZT0nZXZlbm9kZCcgeD0nMjYuNScgeT0nMzEuNScgd2lkdGg9JzIzJyBoZWlnaHQ9JzE3JyByeD0nMC41Jz48L3JlY3Q+PC9nPjxyZWN0IGlkPSfnn6nlvaLlpIfku70tMTInIGZpbGw9JyNCM0QyRkYnIG9wYWNpdHk9JzAuMjQzODYxNjA3JyB4PScwJyB5PScxMCcgd2lkdGg9JzI0JyBoZWlnaHQ9JzE4JyByeD0nMC41Jz48L3JlY3Q+PHJlY3QgaWQ9J+efqeW9ouWkh+S7vS0xNCcgZmlsbD0nI0IzRDJGRicgb3BhY2l0eT0nMC4yNDM4NjE2MDcnIHg9JzAnIHk9JzEnIHdpZHRoPSc1MCcgaGVpZ2h0PSc2JyByeD0nMC41Jz48L3JlY3Q+PHJlY3QgaWQ9J+efqeW9ouWkh+S7vS0xOCcgZmlsbD0ndXJsKCNsaW5lYXJHcmFkaWVudC0zKScgeD0nMCcgeT0nMzEnIHdpZHRoPScyNCcgaGVpZ2h0PScxOCcgcng9JzAuNSc+PC9yZWN0PjwvZz48L2c+PC9nPjwvZz48L2c+PC9nPjwvZz48L3N2Zz4=\" style=\"width: 50px;height: 56px;display: block;\">\r\n            <span class=\"imgFont\">{{localizeService?.getValue('spread.crossTable.valueDimensionTitle')}}</span>\r\n          </div>\r\n          <ul class=\"f-utils-overflow-xhya f-utils-fill pb-1\" style=\"z-index: 20\" [dndList]=\"lists && lists.length ? lists[3].value : []\" (dndListChange)=\"dndListChange3($event)\">\r\n            <li *ngFor=\"let item of (lists && lists.length ? lists[3].value : []); let i = index;\" [dndDraggable]=\"item\" class=\"mb-1 p-1\"\r\n              (dndMoved)=\"moved(i, lists[3].value)\" dndEffectAllowed=\"move\" (dndSelected)=\"models.selected = item\"\r\n              [ngClass]=\"{'selected': models.selected === item}\">\r\n              {{item.name}}\r\n            </li>\r\n          </ul>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n  <div class=\"simpleDemo f-utils-fill-flex-row\">\r\n    <div class=\"col-md-6 f-utils-flex-column p-1\">\r\n      <div class=\"card f-utils-fill-flex-column\">\r\n        <div class=\"card-body  f-utils-fill-flex-column p-0\">\r\n          <div class=\"cardTitle mb-2 pt-2\">\r\n            <span id=\"rowfield\" class=\"f-icon pt-1 pr-2 pl-2\" role=\"presentation\">\r\n              <img src=\"data:image/svg+xml;charset=utf-8;base64,PHN2ZyB3aWR0aD0nMTZweCcgaGVpZ2h0PScxNnB4JyB2aWV3Qm94PScwIDAgMTYgMTYnIHZlcnNpb249JzEuMScgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB4bWxuczp4bGluaz0naHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayc+PHRpdGxlPuihjOe7tOW6pjwvdGl0bGU+PGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+PGcgaWQ9J+mhtemdoi0xJyBzdHJva2U9J25vbmUnIHN0cm9rZS13aWR0aD0nMScgZmlsbD0nbm9uZScgZmlsbC1ydWxlPSdldmVub2RkJz48ZyBpZD0nMeOAgeafpeivolVJ6K6+6K6hJyB0cmFuc2Zvcm09J3RyYW5zbGF0ZSgtOTMxLjAwMDAwMCwgLTQ2MC4wMDAwMDApJyBzdHJva2U9JyM5Nzk3OTcnPjxnIGlkPSfnvJbnu4QtMjYnIHRyYW5zZm9ybT0ndHJhbnNsYXRlKDg5OC4wMDAwMDAsIDc1LjAwMDAwMCknPjxnIGlkPSfnvJbnu4QtMjknIHRyYW5zZm9ybT0ndHJhbnNsYXRlKDIwLjAwMDAwMCwgMzc1LjAwMDAwMCknPjxnIGlkPSfnvJbnu4QtMjHlpIfku70tMicgdHJhbnNmb3JtPSd0cmFuc2xhdGUoMS4wMDAwMDAsIDAuMDAwMDAwKSc+PGcgaWQ9J+e8lue7hC0yMicgdHJhbnNmb3JtPSd0cmFuc2xhdGUoMTIuMDAwMDAwLCAxMC4wMDAwMDApJz48cmVjdCBpZD0n55+p5b2iJyB4PScxLjUnIHk9JzIuNScgd2lkdGg9JzQuMjUnIGhlaWdodD0nNC4yNScgcng9JzEnPjwvcmVjdD48cmVjdCBpZD0n55+p5b2iJyBmaWxsPScjRDhEOEQ4JyB4PSc4LjUnIHk9JzMuMzc1JyB3aWR0aD0nNScgaGVpZ2h0PScxJz48L3JlY3Q+PHJlY3QgaWQ9J+efqeW9ouWkh+S7vS0xMicgZmlsbD0nI0Q4RDhEOCcgeD0nOC41JyB5PScxMC4zNzUnIHdpZHRoPSc1JyBoZWlnaHQ9JzEnPjwvcmVjdD48cmVjdCBpZD0n55+p5b2i5aSH5Lu9LTcnIGZpbGw9JyNEOEQ4RDgnIHg9JzguNScgeT0nNicgd2lkdGg9JzUnIGhlaWdodD0nMSc+PC9yZWN0PjxyZWN0IGlkPSfnn6nlvaLlpIfku70tMTMnIGZpbGw9JyNEOEQ4RDgnIHg9JzguNScgeT0nMTMnIHdpZHRoPSc1JyBoZWlnaHQ9JzEnPjwvcmVjdD48cmVjdCBpZD0n55+p5b2i5aSH5Lu9LTYnIHg9JzEuNScgeT0nOS41JyB3aWR0aD0nNC4yNScgaGVpZ2h0PSc0LjI1JyByeD0nMSc+PC9yZWN0PjwvZz48L2c+PC9nPjwvZz48L2c+PC9nPjwvc3ZnPg==\" style=\"width: 15px; height: 15px; display: block;\" />\r\n            </span>\r\n            <span class=\"pl-3 dimensionTitle\">{{lists && lists.length ? lists[1].name : ''}}</span>\r\n          </div>\r\n          <div id=\"rowfieldimg\" *ngIf=\"lists && lists.length ? (lists[1]?.value?.length < 1) : true\"\r\n            class=\"f-utils-absolute-all f-utils-flex-column justify-content-center align-items-center\"\r\n            role=\"presentation\" style=\"align-items: center; top: 36px; z-index: 10;\">\r\n            <img src=\"data:image/svg+xml;charset=utf-8;base64,PHN2ZyB3aWR0aD0nNTBweCcgaGVpZ2h0PSc1MHB4JyB2aWV3Qm94PScwIDAgNTAgNTAnIHZlcnNpb249JzEuMScgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB4bWxuczp4bGluaz0naHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayc+PHRpdGxlPuWIl+e7tOW6puWbvjwvdGl0bGU+PGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+PGRlZnM+PHJlY3QgaWQ9J3BhdGgtMScgeD0nMjYnIHk9JzMxJyB3aWR0aD0nMjQnIGhlaWdodD0nMTgnIHJ4PScwLjUnPjwvcmVjdD48ZmlsdGVyIHg9Jy02LjIlJyB5PSctOC4zJScgd2lkdGg9JzExMi41JScgaGVpZ2h0PScxMTYuNyUnIGZpbHRlclVuaXRzPSdvYmplY3RCb3VuZGluZ0JveCcgaWQ9J2ZpbHRlci0yJz48ZmVPZmZzZXQgZHg9JzAnIGR5PScwJyBpbj0nU291cmNlQWxwaGEnIHJlc3VsdD0nc2hhZG93T2Zmc2V0T3V0ZXIxJz48L2ZlT2Zmc2V0PjxmZUdhdXNzaWFuQmx1ciBzdGREZXZpYXRpb249JzAuNScgaW49J3NoYWRvd09mZnNldE91dGVyMScgcmVzdWx0PSdzaGFkb3dCbHVyT3V0ZXIxJz48L2ZlR2F1c3NpYW5CbHVyPjxmZUNvbXBvc2l0ZSBpbj0nc2hhZG93Qmx1ck91dGVyMScgaW4yPSdTb3VyY2VBbHBoYScgb3BlcmF0b3I9J291dCcgcmVzdWx0PSdzaGFkb3dCbHVyT3V0ZXIxJz48L2ZlQ29tcG9zaXRlPjxmZUNvbG9yTWF0cml4IHZhbHVlcz0nMCAwIDAgMCAwLjExNDg0Mzc1IDAgMCAwIDAgMC41MTU4ODE4MTcgMCAwIDAgMCAxIDAgMCAwIDAuNzI2NDgwNTUxIDAnIHR5cGU9J21hdHJpeCcgaW49J3NoYWRvd0JsdXJPdXRlcjEnPjwvZmVDb2xvck1hdHJpeD48L2ZpbHRlcj48bGluZWFyR3JhZGllbnQgeDE9JzUwJScgeTE9JzEwMCUnIHgyPSc1MCUnIHkyPScwJScgaWQ9J2xpbmVhckdyYWRpZW50LTMnPjxzdG9wIHN0b3AtY29sb3I9JyNEQUVCRkYnIHN0b3Atb3BhY2l0eT0nMC4yMDMwNDMwNTEnIG9mZnNldD0nMCUnPjwvc3RvcD48c3RvcCBzdG9wLWNvbG9yPScjQjNEMkZGJyBzdG9wLW9wYWNpdHk9JzAuNDczMDM4NjgnIG9mZnNldD0nMTAwJSc+PC9zdG9wPjwvbGluZWFyR3JhZGllbnQ+PC9kZWZzPjxnIGlkPSfpobXpnaItMScgc3Ryb2tlPSdub25lJyBzdHJva2Utd2lkdGg9JzEnIGZpbGw9J25vbmUnIGZpbGwtcnVsZT0nZXZlbm9kZCc+PGcgaWQ9JzHjgIHmn6Xor6JVSeiuvuiuoScgdHJhbnNmb3JtPSd0cmFuc2xhdGUoLTEyMTQuMDAwMDAwLCAtNTY1LjAwMDAwMCknPjxnIGlkPSfnvJbnu4QtMjYnIHRyYW5zZm9ybT0ndHJhbnNsYXRlKDg5OC4wMDAwMDAsIDc1LjAwMDAwMCknPjxnIGlkPSfnvJbnu4QtMzAnIHRyYW5zZm9ybT0ndHJhbnNsYXRlKDIzOS4wMDAwMDAsIDM3NS4wMDAwMDApJz48ZyBpZD0n57yW57uELTM05aSH5Lu9JyB0cmFuc2Zvcm09J3RyYW5zbGF0ZSg0MC4wMDAwMDAsIDExNS4wMDAwMDApJz48ZyBpZD0n57yW57uELTMzJyB0cmFuc2Zvcm09J3RyYW5zbGF0ZSgzNy4wMDAwMDAsIDAuMDAwMDAwKSc+PGcgaWQ9J+e8lue7hC01Jz48cmVjdCBpZD0n55+p5b2i5aSH5Lu9LTMnIGZpbGw9JyNCM0QyRkYnIG9wYWNpdHk9JzAuMjQzODYxNjA3JyB4PScyNicgeT0nMTAnIHdpZHRoPScyNCcgaGVpZ2h0PScxOCcgcng9JzAuNSc+PC9yZWN0PjxnIGlkPSfnn6nlvaLlpIfku70tNicgb3BhY2l0eT0nMC41OTYxMjE2NTInPjx1c2UgZmlsbD0nYmxhY2snIGZpbGwtb3BhY2l0eT0nMScgZmlsdGVyPSd1cmwoI2ZpbHRlci0yKScgeGxpbms6aHJlZj0nI3BhdGgtMSc+PC91c2U+PHJlY3Qgc3Ryb2tlLW9wYWNpdHk9JzAuMjIzNDQ4NDI3JyBzdHJva2U9JyMwMDUxQjknIHN0cm9rZS13aWR0aD0nMScgc3Ryb2tlLWxpbmVqb2luPSdzcXVhcmUnIGZpbGw9JyM3QkIyRjgnIGZpbGwtcnVsZT0nZXZlbm9kZCcgeD0nMjYuNScgeT0nMzEuNScgd2lkdGg9JzIzJyBoZWlnaHQ9JzE3JyByeD0nMC41Jz48L3JlY3Q+PC9nPjxyZWN0IGlkPSfnn6nlvaLlpIfku70tMTInIGZpbGw9JyNCM0QyRkYnIG9wYWNpdHk9JzAuMjQzODYxNjA3JyB4PScwJyB5PScxMCcgd2lkdGg9JzI0JyBoZWlnaHQ9JzE4JyByeD0nMC41Jz48L3JlY3Q+PHJlY3QgaWQ9J+efqeW9ouWkh+S7vS0xNCcgZmlsbD0nI0IzRDJGRicgb3BhY2l0eT0nMC4yNDM4NjE2MDcnIHg9JzAnIHk9JzEnIHdpZHRoPSc1MCcgaGVpZ2h0PSc2JyByeD0nMC41Jz48L3JlY3Q+PHJlY3QgaWQ9J+efqeW9ouWkh+S7vS0xOCcgZmlsbD0ndXJsKCNsaW5lYXJHcmFkaWVudC0zKScgeD0nMCcgeT0nMzEnIHdpZHRoPScyNCcgaGVpZ2h0PScxOCcgcng9JzAuNSc+PC9yZWN0PjwvZz48L2c+PC9nPjwvZz48L2c+PC9nPjwvZz48L3N2Zz4=\" style=\"width: 50px;height: 56px;display: block;\">\r\n            <span class=\"imgFont\">{{localizeService?.getValue('spread.crossTable.rowDimensionTitle')}}</span>\r\n          </div>\r\n          <ul class=\"f-utils-overflow-xhya f-utils-fill pb-1\" style=\"z-index: 20\" [dndList]=\"lists && lists.length ? lists[1].value : []\" (dndListChange)=\"dndListChange1($event)\">\r\n            <li *ngFor=\"let item of (lists && lists.length ? lists[1].value : []); let i = index;\" [dndDraggable]=\"item\" class=\"mb-1 p-1\"\r\n              (dndMoved)=\"moved(i, lists[1].value)\" dndEffectAllowed=\"move\" (dndSelected)=\"models.selected = item\"\r\n              [ngClass]=\"{'selected': models.selected === item}\">\r\n              {{item.name}}\r\n            </li>\r\n          </ul>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=\"col-md-6 f-utils-flex-column p-1\">\r\n      <div class=\"card f-utils-fill-flex-column\">\r\n        <div class=\"card-body f-utils-fill-flex-column p-0\">\r\n          <div class=\"cardTitle mb-2 pt-2\">\r\n            <span id=\"colfield\" class=\"f-icon pt-1 pr-2 pl-2\" role=\"presentation\">\r\n              <img src=\"data:image/svg+xml;charset=utf-8;base64,PHN2ZyB3aWR0aD0nMTdweCcgaGVpZ2h0PScxN3B4JyB2aWV3Qm94PScwIDAgMTcgMTcnIHZlcnNpb249JzEuMScgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB4bWxuczp4bGluaz0naHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayc+PHRpdGxlPuWIl+e7tOW6pjwvdGl0bGU+PGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+PGcgaWQ9J+mhtemdoi0xJyBzdHJva2U9J25vbmUnIHN0cm9rZS13aWR0aD0nMScgZmlsbD0nbm9uZScgZmlsbC1ydWxlPSdldmVub2RkJz48ZyBpZD0nMeOAgeafpeivolVJ6K6+6K6hJyB0cmFuc2Zvcm09J3RyYW5zbGF0ZSgtMTE1MC4wMDAwMDAsIC00NjAuMDAwMDAwKScgc3Ryb2tlPScjOTc5Nzk3Jz48ZyBpZD0n57yW57uELTI2JyB0cmFuc2Zvcm09J3RyYW5zbGF0ZSg4OTguMDAwMDAwLCA3NS4wMDAwMDApJz48ZyBpZD0n57yW57uELTMwJyB0cmFuc2Zvcm09J3RyYW5zbGF0ZSgyMzkuMDAwMDAwLCAzNzUuMDAwMDAwKSc+PGcgaWQ9J+e8lue7hC0yMeWkh+S7vS0zJyB0cmFuc2Zvcm09J3RyYW5zbGF0ZSgxLjAwMDAwMCwgMC4wMDAwMDApJz48ZyBpZD0n57yW57uELTIyJyB0cmFuc2Zvcm09J3RyYW5zbGF0ZSgyMC4xMjUwMDAsIDE4LjEyNTAwMCkgcm90YXRlKDkwLjAwMDAwMCkgdHJhbnNsYXRlKC0yMC4xMjUwMDAsIC0xOC4xMjUwMDApIHRyYW5zbGF0ZSgxMi4xMjUwMDAsIDEwLjEyNTAwMCknPjxyZWN0IGlkPSfnn6nlvaInIHg9JzEuNScgeT0nMi41JyB3aWR0aD0nNC4yNScgaGVpZ2h0PSc0LjI1JyByeD0nMSc+PC9yZWN0PjxyZWN0IGlkPSfnn6nlvaInIGZpbGw9JyNEOEQ4RDgnIHg9JzguNScgeT0nMy4zNzUnIHdpZHRoPSc1JyBoZWlnaHQ9JzEnPjwvcmVjdD48cmVjdCBpZD0n55+p5b2i5aSH5Lu9LTEyJyBmaWxsPScjRDhEOEQ4JyB4PSc4LjUnIHk9JzEwLjM3NScgd2lkdGg9JzUnIGhlaWdodD0nMSc+PC9yZWN0PjxyZWN0IGlkPSfnn6nlvaLlpIfku70tNycgZmlsbD0nI0Q4RDhEOCcgeD0nOC41JyB5PSc2JyB3aWR0aD0nNScgaGVpZ2h0PScxJz48L3JlY3Q+PHJlY3QgaWQ9J+efqeW9ouWkh+S7vS0xMycgZmlsbD0nI0Q4RDhEOCcgeD0nOC41JyB5PScxMycgd2lkdGg9JzUnIGhlaWdodD0nMSc+PC9yZWN0PjxyZWN0IGlkPSfnn6nlvaLlpIfku70tNicgeD0nMS41JyB5PSc5LjUnIHdpZHRoPSc0LjI1JyBoZWlnaHQ9JzQuMjUnIHJ4PScxJz48L3JlY3Q+PC9nPjwvZz48L2c+PC9nPjwvZz48L2c+PC9zdmc+\" style=\"width: 15px; height: 15px; display: block;\" />\r\n            </span>\r\n            <span class=\"pl-3 dimensionTitle\">{{lists && lists.length ? lists[2].name : ''}}</span>\r\n          </div>\r\n          <div id=\"colfieldimg\" *ngIf=\"lists && lists.length ? (lists[2]?.value?.length < 1) : true\"\r\n            class=\"f-utils-absolute-all f-utils-flex-column justify-content-center align-items-center\"\r\n            role=\"presentation\" style=\"align-items: center; top: 36px; z-index: 10;\">\r\n            <img src=\"data:image/svg+xml;charset=utf-8;base64,PHN2ZyB3aWR0aD0nNTBweCcgaGVpZ2h0PSc1MHB4JyB2aWV3Qm94PScwIDAgNTAgNTAnIHZlcnNpb249JzEuMScgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB4bWxuczp4bGluaz0naHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayc+PHRpdGxlPuWIl+e7tOW6puWbvjwvdGl0bGU+PGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+PGRlZnM+PHJlY3QgaWQ9J3BhdGgtMScgeD0nMjYnIHk9JzMxJyB3aWR0aD0nMjQnIGhlaWdodD0nMTgnIHJ4PScwLjUnPjwvcmVjdD48ZmlsdGVyIHg9Jy02LjIlJyB5PSctOC4zJScgd2lkdGg9JzExMi41JScgaGVpZ2h0PScxMTYuNyUnIGZpbHRlclVuaXRzPSdvYmplY3RCb3VuZGluZ0JveCcgaWQ9J2ZpbHRlci0yJz48ZmVPZmZzZXQgZHg9JzAnIGR5PScwJyBpbj0nU291cmNlQWxwaGEnIHJlc3VsdD0nc2hhZG93T2Zmc2V0T3V0ZXIxJz48L2ZlT2Zmc2V0PjxmZUdhdXNzaWFuQmx1ciBzdGREZXZpYXRpb249JzAuNScgaW49J3NoYWRvd09mZnNldE91dGVyMScgcmVzdWx0PSdzaGFkb3dCbHVyT3V0ZXIxJz48L2ZlR2F1c3NpYW5CbHVyPjxmZUNvbXBvc2l0ZSBpbj0nc2hhZG93Qmx1ck91dGVyMScgaW4yPSdTb3VyY2VBbHBoYScgb3BlcmF0b3I9J291dCcgcmVzdWx0PSdzaGFkb3dCbHVyT3V0ZXIxJz48L2ZlQ29tcG9zaXRlPjxmZUNvbG9yTWF0cml4IHZhbHVlcz0nMCAwIDAgMCAwLjExNDg0Mzc1IDAgMCAwIDAgMC41MTU4ODE4MTcgMCAwIDAgMCAxIDAgMCAwIDAuNzI2NDgwNTUxIDAnIHR5cGU9J21hdHJpeCcgaW49J3NoYWRvd0JsdXJPdXRlcjEnPjwvZmVDb2xvck1hdHJpeD48L2ZpbHRlcj48bGluZWFyR3JhZGllbnQgeDE9JzUwJScgeTE9JzEwMCUnIHgyPSc1MCUnIHkyPScwJScgaWQ9J2xpbmVhckdyYWRpZW50LTMnPjxzdG9wIHN0b3AtY29sb3I9JyNEQUVCRkYnIHN0b3Atb3BhY2l0eT0nMC4yMDMwNDMwNTEnIG9mZnNldD0nMCUnPjwvc3RvcD48c3RvcCBzdG9wLWNvbG9yPScjQjNEMkZGJyBzdG9wLW9wYWNpdHk9JzAuNDczMDM4NjgnIG9mZnNldD0nMTAwJSc+PC9zdG9wPjwvbGluZWFyR3JhZGllbnQ+PC9kZWZzPjxnIGlkPSfpobXpnaItMScgc3Ryb2tlPSdub25lJyBzdHJva2Utd2lkdGg9JzEnIGZpbGw9J25vbmUnIGZpbGwtcnVsZT0nZXZlbm9kZCc+PGcgaWQ9JzHjgIHmn6Xor6JVSeiuvuiuoScgdHJhbnNmb3JtPSd0cmFuc2xhdGUoLTEyMTQuMDAwMDAwLCAtNTY1LjAwMDAwMCknPjxnIGlkPSfnvJbnu4QtMjYnIHRyYW5zZm9ybT0ndHJhbnNsYXRlKDg5OC4wMDAwMDAsIDc1LjAwMDAwMCknPjxnIGlkPSfnvJbnu4QtMzAnIHRyYW5zZm9ybT0ndHJhbnNsYXRlKDIzOS4wMDAwMDAsIDM3NS4wMDAwMDApJz48ZyBpZD0n57yW57uELTM05aSH5Lu9JyB0cmFuc2Zvcm09J3RyYW5zbGF0ZSg0MC4wMDAwMDAsIDExNS4wMDAwMDApJz48ZyBpZD0n57yW57uELTMzJyB0cmFuc2Zvcm09J3RyYW5zbGF0ZSgzNy4wMDAwMDAsIDAuMDAwMDAwKSc+PGcgaWQ9J+e8lue7hC01Jz48cmVjdCBpZD0n55+p5b2i5aSH5Lu9LTMnIGZpbGw9JyNCM0QyRkYnIG9wYWNpdHk9JzAuMjQzODYxNjA3JyB4PScyNicgeT0nMTAnIHdpZHRoPScyNCcgaGVpZ2h0PScxOCcgcng9JzAuNSc+PC9yZWN0PjxnIGlkPSfnn6nlvaLlpIfku70tNicgb3BhY2l0eT0nMC41OTYxMjE2NTInPjx1c2UgZmlsbD0nYmxhY2snIGZpbGwtb3BhY2l0eT0nMScgZmlsdGVyPSd1cmwoI2ZpbHRlci0yKScgeGxpbms6aHJlZj0nI3BhdGgtMSc+PC91c2U+PHJlY3Qgc3Ryb2tlLW9wYWNpdHk9JzAuMjIzNDQ4NDI3JyBzdHJva2U9JyMwMDUxQjknIHN0cm9rZS13aWR0aD0nMScgc3Ryb2tlLWxpbmVqb2luPSdzcXVhcmUnIGZpbGw9JyM3QkIyRjgnIGZpbGwtcnVsZT0nZXZlbm9kZCcgeD0nMjYuNScgeT0nMzEuNScgd2lkdGg9JzIzJyBoZWlnaHQ9JzE3JyByeD0nMC41Jz48L3JlY3Q+PC9nPjxyZWN0IGlkPSfnn6nlvaLlpIfku70tMTInIGZpbGw9JyNCM0QyRkYnIG9wYWNpdHk9JzAuMjQzODYxNjA3JyB4PScwJyB5PScxMCcgd2lkdGg9JzI0JyBoZWlnaHQ9JzE4JyByeD0nMC41Jz48L3JlY3Q+PHJlY3QgaWQ9J+efqeW9ouWkh+S7vS0xNCcgZmlsbD0nI0IzRDJGRicgb3BhY2l0eT0nMC4yNDM4NjE2MDcnIHg9JzAnIHk9JzEnIHdpZHRoPSc1MCcgaGVpZ2h0PSc2JyByeD0nMC41Jz48L3JlY3Q+PHJlY3QgaWQ9J+efqeW9ouWkh+S7vS0xOCcgZmlsbD0ndXJsKCNsaW5lYXJHcmFkaWVudC0zKScgeD0nMCcgeT0nMzEnIHdpZHRoPScyNCcgaGVpZ2h0PScxOCcgcng9JzAuNSc+PC9yZWN0PjwvZz48L2c+PC9nPjwvZz48L2c+PC9nPjwvZz48L3N2Zz4=\" style=\"width: 50px;height: 56px;display: block;\">\r\n            <span class=\"imgFont\">{{localizeService?.getValue('spread.crossTable.colDimensionTitle')}}</span>\r\n          </div>\r\n          <ul class=\"f-utils-overflow-xhya f-utils-fill pb-1\" style=\"z-index: 20\" [dndList]=\"lists && lists.length ? lists[2].value : []\"  (dndListChange)=\"dndListChange2($event)\">\r\n            <li *ngFor=\"let item of (lists && lists.length ? lists[2].value : []); let i = index;\" [dndDraggable]=\"item\" class=\"mb-1 p-1\"\r\n              (dndMoved)=\"moved(i, lists[2].value)\" dndEffectAllowed=\"move\" (dndSelected)=\"models.selected = item\"\r\n              [ngClass]=\"{'selected': models.selected === item}\">\r\n              {{item.name}}\r\n            </li>\r\n          </ul>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>",
                        styles: [".simpleDemo ul{min-height:42px;padding:0}.card-title,.demo-header{text-align:center}.title{margin:20px 0}.simpleDemo ul .dndDraggingSource{display:none}.simpleDemo ul .dndPlaceholder{background:rgba(56,143,255,.06);border:1px dashed #388fff;box-shadow:0 0 4px 0 rgba(13,95,201,.22);margin:.25rem!important;padding:.25rem!important}.simpleDemo ul li{background:rgba(235,244,254,.84);border:1px solid #388fff;box-shadow:0 0 10px 0 rgba(63,113,177,.22);border-radius:3px;height:28px;font-family:PingFangSC-Regular;font-size:13px;color:#388fff;margin:.25rem!important;padding:.25rem!important}#unselectFieldList li{border:none;background-color:rgba(0,0,0,0);box-shadow:0 0 #000;border-radius:3px;height:28px;margin:.25rem!important;padding:.25rem!important}#unselectFieldList li:hover{background:#f4f5f9}#unselectFieldList .dndPlaceholder{background:rgba(56,143,255,.06);border:1px dashed #388fff;box-shadow:0 0 4px 0 rgba(13,95,201,.22);margin:.25rem!important;padding:.25rem!important}.unselectField{font-family:PingFangSC-Regular;font-size:13px;color:rgba(0,0,0,.85)}.unselectFieldFront{font-family:PingFangSC-Medium;font-size:13px;color:#b4bccc}.simpleDemo ul li.selected{background-color:#dff0d8;color:#3c763d}.current-model{background-color:#f5f5f5;border:1px solid #ccc;border-radius:4px;padding:18px 22px}.slicer{height:220px;position:relative}.headerMenu{position:fixed;display:none;top:0;left:0}.cardTitle{background:#f5f7fa;border-radius:3px 3px 0 0;height:36px}.dimensionTitle{font-family:PingFangSC-Medium;font-size:14px;color:rgba(0,0,0,.65);line-height:20px}.imgFont{font-family:PingFangSC-Regular;font-size:13px;color:#b4bccc}"]
                    }] }
        ];
        /** @nocollapse */
        DimensionSettingComponent.ctorParameters = function () {
            return [
                { type: core.Injector }
            ];
        };
        DimensionSettingComponent.propDecorators = {
            controlType: [{ type: core.Input }],
            queryRelativeUrl: [{ type: core.Input }],
            queryId: [{ type: core.Input }],
            qoManagerCode: [{ type: core.Input }],
            qoId: [{ type: core.Input }],
            voId: [{ type: core.Input }],
            groupType: [{ type: core.Input }],
            spread: [{ type: core.Input }],
            conditionExpression: [{ type: core.Input }],
            jointsearchInfoList: [{ type: core.Input }],
            qdpView: [{ type: core.Input }]
        };
        return DimensionSettingComponent;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
     */
    var ColumnsSettingComponent = /** @class */ (function () {
        function ColumnsSettingComponent(injector) {
            this.injector = injector;
            this.hideColCache = []; // 隐藏列
            // 隐藏列
            this.showColCache = []; // 显示列
            // 显示列
            this.groupColCache = []; // 分组列
            // 分组列
            this.allColCache = []; // 全部列
            // 全部列
            this.searchText = '';
            this.isCompare = false;
            this.groupIcon = '<span class="k-icon k-i-search"></span>';
            this.lists = [];
            this.listsCache = [];
            this.multiSheetsSchemaIds = {};
            this.models = {
                selected: null,
                lists: this.lists
            };
            this.formInline = true;
            this.isOrNotPaging = true;
            // formatTypeData: any = [
            //   { name: '请选择', value: 0 },
            //   { name: '数字', value: 1 },
            //   { name: '日期', value: 2 },
            //   { name: '逻辑', value: 3 }
            // ];
            // formatTypeSelectValue: any = this.formatTypeData[0].value;
            // formatText = '';
            this.aggreData = [
                { name: '请选择', value: 0 },
                { name: '合计', value: 1 },
                { name: '最小值', value: 2 },
                { name: '最大值', value: 3 },
                { name: '计数', value: 4 },
                { name: '平均值', value: 5 }
            ];
            this.pageSelectValue = this.aggreData[0].value;
            this.pageText = '';
            this.colIsGroup = false;
            this.groupSelectValue = this.aggreData[0].value;
            this.groupSubSelectValue = this.aggreData[0].value;
            this.groupText = '';
            this.totalSelectValue = this.aggreData[0].value;
            this.totalText = '';
            this.currentColIndex = 0;
            this.enumType = [
                { name: '索引', value: '0' },
                { name: '编号', value: '1' },
                { name: '名称', value: '2' }
            ];
            if (this.injector) {
                this.localizeService = this.injector.get(localize.LocalizeService);
                this.renderService = this.injector.get(RenderService);
                this.msgService = this.injector.get(uiMessager.MessagerService);
                this.formErrorService = this.injector.get(commandServices.FormErrorService);
                this.schemaManagerService = this.injector.get(common$1.SchemaManagerService);
                this.localId = this.injector.get(core.LOCALE_ID) || localize.DEFAULT_LANGUAGE;
                this.formInline = this.localId.toLowerCase() === localize.DEFAULT_LANGUAGE;
                this.aggreData = this.localizeService.getValue('ideCmp.schemaManager.columnOption.aggregateData');
                this.enumType = this.localizeService.getValue('ideCmp.schemaManager.columnOption.enumType');
            }
            this.initLists();
        }
        /**
         * @return {?}
         */
        ColumnsSettingComponent.prototype.ngOnInit = /**
         * @return {?}
         */
            function () {
                /** @type {?} */
                var eventId = common$1.RtfServices.getTabId(this.queryId);
                common$1.EventBus.register('pagingModeChanges', this.handlePagingModeChanged.bind(this), eventId + 'columnsSetting');
                common$1.EventBus.register('schemaValueChanged', this.handleSchemaValueChanged.bind(this), eventId + 'columnsSetting');
            };
        /**
         * @return {?}
         */
        ColumnsSettingComponent.prototype.ngOnDestroy = /**
         * @return {?}
         */
            function () { };
        /**
         * @private
         * @return {?}
         */
        ColumnsSettingComponent.prototype.initLists = /**
         * @private
         * @return {?}
         */
            function () {
                this.lists = [];
                for (var i = 0; i < 3; i++) {
                    this.lists.push({
                        name: this.localizeService.getValue('spread.crossTable.columnSetting')[i],
                        value: []
                    });
                }
            };
        /**
         * 初始化交叉表维度设置
         */
        /**
         * 初始化交叉表维度设置
         * @return {?}
         */
        ColumnsSettingComponent.prototype.initCrosstab = /**
         * 初始化交叉表维度设置
         * @return {?}
         */
            function () {
                // this.renderService.renderObject.currentSchemaValueChanger.subscribe((schemaValue: any) => {
                // });
            };
        /**
         * @private
         * @param {?} schemaValue
         * @return {?}
         */
        ColumnsSettingComponent.prototype.handleSchemaValueChanged = /**
         * @private
         * @param {?} schemaValue
         * @return {?}
         */
            function (schemaValue) {
                var _this = this;
                if (schemaValue) {
                    this.schemaValue = schemaValue;
                    if (schemaValue.id === 1 || schemaValue.id === '1') {
                        this.lists[0].value = [];
                        this.listsCache = [];
                        this.lists[1].value = [];
                        this.lists[2].value = [];
                        return;
                    }
                    if (this.controlType !== 'crosstab') {
                        this.colList = schemaValue.schemaValue.columnOption.colList;
                        if (this.colList) {
                            this.hideColCache = []; // 隐藏列
                            this.showColCache = []; // 显示列
                            this.groupColCache = []; // 分组列
                            this.allColCache = []; // 全部列
                            for (var i = 0; i < this.colList.length; i++) {
                                this.getSubColumns(this.colList[i], null, '');
                            }
                            setTimeout(( /**
                             * @return {?}
                             */function () {
                                _this.lists[0].value = _this.hideColCache;
                                _this.listsCache = _this.hideColCache;
                                _this.lists[1].value = _this.showColCache;
                                _this.lists[2].value = _this.groupColCache;
                            }));
                        }
                    }
                }
            };
        /**
         * @private
         * @param {?} col
         * @param {?} colList
         * @param {?} pid
         * @return {?}
         */
        ColumnsSettingComponent.prototype.getSubColumns = /**
         * @private
         * @param {?} col
         * @param {?} colList
         * @param {?} pid
         * @return {?}
         */
            function (col, colList, pid) {
                if (col) {
                    col['id'] = common$1.EventBus.guid();
                    col['pid'] = pid;
                    /** @type {?} */
                    var pcol = JSON.parse(JSON.stringify(col));
                    pcol.childList = [];
                    this.allColCache.push(pcol);
                    if (col.childList && col.childList.length) {
                        this.getSubColumns(null, col.childList, col['id']);
                    }
                    else {
                        if (col.isGroup) {
                            this.groupColCache.push(col);
                        }
                        else if (col.visible) {
                            this.showColCache.push(col);
                        }
                        else {
                            this.hideColCache.push(col);
                        }
                    }
                }
                else {
                    for (var i = 0; i < colList.length; i++) {
                        colList[i]['id'] = common$1.EventBus.guid();
                        colList[i]['pid'] = pid;
                        /** @type {?} */
                        var pcol = JSON.parse(JSON.stringify(colList[i]));
                        pcol.childList = [];
                        this.allColCache.push(pcol);
                        if (colList[i].childList && colList[i].childList.length) {
                            this.getSubColumns(null, colList[i].childList, colList[i]['id']);
                        }
                        else {
                            if (colList[i].isGroup) {
                                this.groupColCache.push(colList[i]);
                            }
                            else if (colList[i].visible) {
                                this.showColCache.push(colList[i]);
                            }
                            else {
                                this.hideColCache.push(colList[i]);
                            }
                        }
                    }
                }
            };
        /**
         * @param {?} index
         * @param {?} list
         * @return {?}
         */
        ColumnsSettingComponent.prototype.moved = /**
         * @param {?} index
         * @param {?} list
         * @return {?}
         */
            function (index, list) {
                var _this = this;
                list.splice(index, 1);
                this.selectedDimesion();
                if (this.schemaValue) {
                    if (this.schemaValue.isProtected === 1 || this.schemaValue.isProtected === '1') {
                        this.msgService.info(this.localizeService.getValue('ideCmp.schemaManager.message.validate.isProtected'));
                        return;
                    }
                    this.schemaValue.schemaValue = JSON.stringify(this.schemaValue.schemaValue);
                    this.schemaManagerService.saveSchema({ 'schema': JSON.stringify(this.schemaValue) }, this.queryRelativeUrl).subscribe(( /**
                     * @return {?}
                     */function () {
                        _this.renderService.render({ multiSheetsSchemaIds: _this.multiSheetsSchemaIds, curSheet: _this.curSheet, multiSheets: _this.multiSheets, schemaId: _this.schemaValue.id, queryId: _this.queryId, spread: _this.spread, controlType: _this.controlType, qoManagerCode: _this.qoManagerCode, queryRelativeUrl: _this.queryRelativeUrl, schemaValue: _this.schemaValue, filterCondition: _this.conditionExpression, groupType: _this.groupType, voId: _this.voId, jointsearchInfoList: _this.jointsearchInfoList, fromCache: true, qdpView: _this.qdpView });
                        _this.schemaValue.schemaValue = typeof _this.schemaValue.schemaValue === 'string' ? JSON.parse(_this.schemaValue.schemaValue) : _this.schemaValue.schemaValue;
                    }), ( /**
                     * @param {?} error
                     * @return {?}
                     */function (error) {
                        _this.formErrorService.exception(error.Message, error);
                    }));
                }
            };
        /**
         * @return {?}
         */
        ColumnsSettingComponent.prototype.selectedDimesion = /**
         * @return {?}
         */
            function () {
                this.colList = [];
                if (this.lists[0]) {
                    this.lists[0].value.forEach(( /**
                     * @param {?} value
                     * @return {?}
                     */function (value) {
                        value.isGroup = false;
                        value.visible = false;
                    }));
                    this.colList = this.lists[0].value;
                }
                if (this.lists[1]) {
                    this.lists[1].value.forEach(( /**
                     * @param {?} value
                     * @return {?}
                     */function (value) {
                        value.isGroup = false;
                        value.visible = true;
                    }));
                    if (this.colList.length === 0) {
                        this.colList = this.lists[1].value;
                    }
                    else {
                        this.colList = this.colList.concat(this.lists[1].value);
                    }
                }
                if (this.lists[2]) {
                    this.lists[2].value.forEach(( /**
                     * @param {?} value
                     * @return {?}
                     */function (value) {
                        value.isGroup = true;
                        value.visible = false;
                    }));
                    if (this.colList.length === 0) {
                        this.colList = this.lists[2].value;
                    }
                    else {
                        this.colList = this.colList.concat(this.lists[2].value);
                    }
                }
                if (this.colList.length > 0) {
                    for (var i = 0; i < this.colList.length; i++) {
                        if (this.colList[i].isGroup)
                            continue;
                        /** @type {?} */
                        var filterCondition = { pid: this.colList[i]['pid'] };
                        if (i == 0 && this.colList.length > 1) {
                            if (this.colList.length > 2) {
                                if (this.colList[i]['pid'] && this.colList[i + 2]['pid'] && this.colList[i]['pid'] == this.colList[i + 2]['pid']) {
                                    this.colList[i]['pid'] = this.colList[i + 2]['pid'];
                                }
                            }
                            else {
                                if (this.colList[i]['pid'] && this.colList[i]['pid'] != this.colList[i + 1]['pid'] && lodashEs.filter(this.colList, filterCondition) && lodashEs.filter(this.colList, filterCondition).length > 1) {
                                    this.colList[i]['pid'] = '';
                                }
                            }
                        }
                        else if (i == (this.colList.length - 1) && this.colList.length > 1) {
                            if (this.colList[i]['pid'] && this.colList[i]['pid'] != this.colList[i - 1]['pid'] && lodashEs.filter(this.colList, filterCondition) && lodashEs.filter(this.colList, filterCondition).length > 1) {
                                this.colList[i]['pid'] = '';
                            }
                        }
                        else if (i > 0 && i < (this.colList.length - 1)) {
                            if (this.colList[i - 1]['pid'] && this.colList[i + 1]['pid'] && this.colList[i - 1]['pid'] == this.colList[i + 1]['pid']) {
                                this.colList[i]['pid'] = this.colList[i - 1]['pid'];
                            }
                        }
                    }
                    for (var i = 0; i < this.colList.length; i++) {
                        this.recursiveFindParent(this.colList, i, this.colList[i]['pid']);
                    }
                    /** @type {?} */
                    var objCache = {};
                    for (var i = 0; i < this.colList.length; i++) {
                        objCache[this.colList[i]['id']] = this.colList[i];
                    }
                    /** @type {?} */
                    var result = [];
                    for (var key in objCache) {
                        /** @type {?} */
                        var parent_1 = objCache[objCache[key]['pid']];
                        if (!parent_1) {
                            result.push(objCache[key]);
                        }
                        else {
                            parent_1['childList'].push(objCache[key]);
                        }
                    }
                    if (this.colList.length > 0) {
                        try {
                            this.isCompare = common$1.JSONUtils.Compare({ schema: this.schemaValue.schemaValue.columnOption.colList }, { schema: result });
                        }
                        catch (e) { }
                        this.schemaValue.schemaValue.columnOption.colList = result;
                        // this.schemaValue.schemaValue.columnOption.colList = this.colList;
                    }
                }
            };
        /**
         * @private
         * @param {?} colList
         * @param {?} index
         * @param {?} pid
         * @return {?}
         */
        ColumnsSettingComponent.prototype.recursiveFindParent = /**
         * @private
         * @param {?} colList
         * @param {?} index
         * @param {?} pid
         * @return {?}
         */
            function (colList, index, pid) {
                var _this = this;
                /** @type {?} */
                var colIndex = this.allColCache.findIndex(( /**
                 * @param {?} x
                 * @return {?}
                 */function (x) { return x.id == pid; }));
                if (colIndex >= 0 && this.colList.findIndex(( /**
                 * @param {?} x
                 * @return {?}
                 */function (x) { return x.id === _this.allColCache[colIndex].id; })) < 0) {
                    this.colList.splice(index, 0, this.allColCache[colIndex]);
                    if (this.allColCache[colIndex]['pid']) {
                        this.recursiveFindParent(colList, index, this.allColCache[colIndex]['pid']);
                    }
                }
            };
        /**
         * @param {?} val
         * @return {?}
         */
        ColumnsSettingComponent.prototype.dimensionSearchValueOnChange = /**
         * @param {?} val
         * @return {?}
         */
            function (val) {
                if (val) {
                    /** @type {?} */
                    var searchCols = this.listsCache.find(( /**
                     * @param {?} item
                     * @return {?}
                     */function (item) { return item.name.indexOf(val) >= 0; }));
                    this.lists[0].value = __spread(searchCols);
                }
                else {
                    this.lists[0].value = __spread(this.listsCache);
                }
            };
        /**
         * @param {?} $event
         * @return {?}
         */
        ColumnsSettingComponent.prototype.dndListChange0 = /**
         * @param {?} $event
         * @return {?}
         */
            function ($event) {
                if (this.lists && this.lists.length) {
                    this.lists[0].value = $event;
                }
            };
        /**
         * @param {?} $event
         * @return {?}
         */
        ColumnsSettingComponent.prototype.dndListChange1 = /**
         * @param {?} $event
         * @return {?}
         */
            function ($event) {
                if (this.lists && this.lists.length) {
                    this.lists[1].value = $event;
                }
            };
        /**
         * @param {?} $event
         * @return {?}
         */
        ColumnsSettingComponent.prototype.dndListChange2 = /**
         * @param {?} $event
         * @return {?}
         */
            function ($event) {
                if (this.lists && this.lists.length) {
                    this.lists[2].value = $event;
                }
            };
        /**
         * @param {?} $event
         * @return {?}
         */
        ColumnsSettingComponent.prototype.dndListChange3 = /**
         * @param {?} $event
         * @return {?}
         */
            function ($event) {
                if (this.lists && this.lists.length) {
                    this.lists[3].value = $event;
                }
            };
        /**
         * @private
         * @param {?} pagingMode
         * @return {?}
         */
        ColumnsSettingComponent.prototype.handlePagingModeChanged = /**
         * @private
         * @param {?} pagingMode
         * @return {?}
         */
            function (pagingMode) {
                this.isOrNotPaging = pagingMode.value === 1;
            };
        ColumnsSettingComponent.decorators = [
            { type: core.Component, args: [{
                        selector: 'columns-setting',
                        template: "<div class=\"container f-utils-fill-flex-column h-100\">\r\n  <div class=\"simpleDemo f-utils-fill-flex-row\">\r\n    <div class=\"col-md-6 f-utils-flex-column p-1\">\r\n      <div class=\"card f-utils-fill-flex-column\">\r\n        <div class=\"card-body f-utils-fill-flex-column p-0\">\r\n          <div class=\"cardTitle mb-2 pt-2\">\r\n            <span id=\"unselected\" class=\"f-icon pt-1 pr-2 pl-2\" role=\"presentation\">\r\n              <img\r\n                src=\"data:image/svg+xml;charset=utf-8;base64,PHN2ZyB3aWR0aD0nMTZweCcgaGVpZ2h0PScxNnB4JyB2aWV3Qm94PScwIDAgMTYgMTYnIHZlcnNpb249JzEuMScgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB4bWxuczp4bGluaz0naHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayc+PHRpdGxlPuW+hemAieWtl+autTwvdGl0bGU+PGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+PGcgaWQ9J+mhtemdoi0xJyBzdHJva2U9J25vbmUnIHN0cm9rZS13aWR0aD0nMScgZmlsbD0nbm9uZScgZmlsbC1ydWxlPSdldmVub2RkJyBvcGFjaXR5PScwLjQ1OTU0MjQxMSc+PGcgaWQ9JzHjgIHmn6Xor6JVSeiuvuiuoScgdHJhbnNmb3JtPSd0cmFuc2xhdGUoLTkzMi4wMDAwMDAsIC0xNTEuMDAwMDAwKScgZmlsbD0nIzAwMDAwMCcgZmlsbC1ydWxlPSdub256ZXJvJz48ZyBpZD0n57yW57uELTI2JyB0cmFuc2Zvcm09J3RyYW5zbGF0ZSg4OTguMDAwMDAwLCA3NS4wMDAwMDApJz48ZyBpZD0n57yW57uELTI0JyB0cmFuc2Zvcm09J3RyYW5zbGF0ZSgyMC4wMDAwMDAsIDY1LjAwMDAwMCknPjxnIGlkPSfnvJbnu4QtMjEnIHRyYW5zZm9ybT0ndHJhbnNsYXRlKDEuMDAwMDAwLCAxLjAwMDAwMCknPjxnIGlkPSdzaG91Y2FuZy0yJyB0cmFuc2Zvcm09J3RyYW5zbGF0ZSgxMy4wMDAwMDAsIDEwLjAwMDAwMCknPjxwYXRoIGQ9J00xMS41NjA5NDkyLDE0LjQ3MjcxODMgQzExLjM2NDAzMzIsMTQuNDcyNzE4MyAxMS4xNDI4MzU5LDE0LjQxNjE4MzYgMTAuOTM3NTI1NCwxNC4zMTM1NjI1IEw4LjAwNzc1MTk1LDEyLjg0ODE4MzYgTDUuMDU5ODM1OTQsMTQuMzExMTgzNiBDNC44NzMxNDY0OCwxNC40MTA1NzgxIDQuNjU5NDQxNDEsMTQuNDYyODczIDQuNDQxNTI1MzksMTQuNDYyODczIEM0LjE1ODM1ODQyLDE0LjQ2MzkxNTcgMy44ODI0MTU1NCwxNC4zNzM1NDU4IDMuNjU0NzIyNjYsMTQuMjA1MTk5MiBDMy4yNDIxNDY0OCwxMy44OTU4MDQ3IDMuMDMwNzM4MjgsMTMuMzU5NTkzNyAzLjEyODMyODEyLDEyLjg3MTQ5NDEgTDMuNzMxMjQ0MTQsOS43NDM4ODg2NyBMMS40MjAzMjgxMiw3LjU4OTc4OTA2IEMxLjA2MzM4MzQyLDcuMjI4MTM2ODYgMC45MjY0MjQ0NTgsNi43MDM1NjQzOCAxLjA2MTAxNzU4LDYuMjEzNTc4MTIgTDEuMDY1NjM4NjcsNi4xOTc2OTE0MSBDMS4yMzM2Mzg2Nyw1LjY5NDE4MzU5IDEuNjUwNDEyMTEsNS4zNDEzODA4NiAyLjE1NTc1MTk1LDUuMjczNjkxNDEgTDUuMzY2NDQxNDEsNC42ODk5MDIzNCBMNi44MDc1MjUzOSwxLjc2MzA0MTAyIEM3LjAzOTAxNzU4LDEuMjk5NjMyODEgNy41MDk4NDk2MSwxLjAwMTg1OTM3IDguMDA3NzUxOTUsMS4wMDE4NTkzNyBDOC41MjcxNDY0OCwxLjAwMTg1OTM3IDkuMDEwMTQ2NDgsMS4zMTA4NDM3NSA5LjIxMjY1NDMsMS43NzE0NDkyMiBMMTAuNjQ5MTMwOSw0LjY4OTAyNzM0IEwxMy44NjAzMTI1LDUuMjUwNDQ5MjIgQzE0LjM2OTg3NDcsNS4zMjQzMDAwMyAxNC43ODg3MTU0LDUuNjkwMjA3NjIgMTQuOTMwMzI4MSw2LjE4NTIzNjMzIEMxNS4wODg4NDQ4LDYuNjcxNzczNDkgMTQuOTU5MzY4Miw3LjIwNjExMjA4IDE0LjU5NTcyMjcsNy41NjYxMjMwNSBMMTQuNTg3ODIwMyw3LjU3NDAzOTA2IEwxMi4yODM0MjU4LDkuNzQ0MDM5MDYgTDEyLjg2NTgyMDMsMTIuODc3MjIyNyBDMTIuOTU5NjA5NCwxMy4zNzg0MzM2IDEyLjc2MDMyODEsMTMuODg0MzIwMyAxMi4zNDU0NDE0LDE0LjE5OTc0NDEgQzEyLjEyMzMxODEsMTQuMzc4NjAyMiAxMS44NDYxMjE3LDE0LjQ3NTA0MTMgMTEuNTYwOTQ5MiwxNC40NzI3MTgzIEwxMS41NjA5NDkyLDE0LjQ3MjcxODMgWiBNOC4wMDg4MDQ2OSwxMS43NDY1MDM5IEwxMS4wODYyNzU0LDEzLjI4NTQ2NDggQzExLjE3NjcxNDgsMTMuMzMxMTAxNiAxMS4yODA4ODA5LDEzLjM1OTY2MjEgMTEuMzUyMDU2NiwxMy4zNTk2NjIxIEMxMS40NjE4MjgxLDEzLjM1OTY2MjEgMTEuNTYzNzUyLDEzLjMyNTkxOTkgMTEuNjM4NDQxNCwxMy4yNjM1NDg4IEwxMS42NTI1MDk4LDEzLjI1MjA2NDUgQzExLjgyNzM3MywxMy4xMjA3NDYxIDExLjkxMjU0ODgsMTIuOTEyNDI3NyAxMS44NzQzMzU5LDEyLjcwODEwMTYgTDExLjI1NDgzNTksOS4zNzE5NzI2NiBMMTMuNzA0NDk0MSw3LjA2NTE4NTU1IEMxMy44NTQ3NzU0LDYuOTEyNzMwNDcgMTMuOTA2MjIyNyw2LjY5NDQwNDMgMTMuODM5NDM1NSw2LjQ5MzU2NDQ1IEwxMy44MzI4NzMsNi40NzI1MDk3NyBDMTMuNzc4OTIxMiw2LjI3ODAxNzY2IDEzLjYxNDIyNjEsNi4xMzQ0MTAzMyAxMy40MTQxOTkyLDYuMTA3NDQzMzYgTDEzLjQwMDE5OTIsNi4xMDUyODMyIEwxMC4wMTA4MDQ3LDUuNTEyNjYyMTEgTDguNDg1NDg4MjgsMi40MTQxOTE0MSBDOC40MTEyMDg5OCwyLjI0MTA3ODEyIDguMjEwNDUxMTcsMi4xMTU0MzM1OSA4LjAwNzQ1MTE3LDIuMTE1NDMzNTkgQzcuODA4MDE5NTMsMi4xMTU0MzM1OSA3LjYxNzMzNzg5LDIuMjQwMjQ0MTQgNy41MjA2Nzc3MywyLjQzMzA4NTk0IEw2LjAwNTA1NDY5LDUuNTExMzM1OTQgTDIuNTk3NzIyNjYsNi4xMzAyODkwNiBDMi4zOTA4MTI1LDYuMTU2MjUxOTUgMi4yMzAwMTc1OCw2LjI5MzczNjMzIDIuMTU1ODIwMzEsNi41MDgwNzAzMSBDMi4xMDMxMDE1Niw2LjcwNDAwMTk1IDIuMTY1NDcyNjYsNi45Mzk4OTY0OCAyLjMwOTUzMzIsNy4wODcxMTUyMyBMNC43NjE4NTc0Miw5LjM3MjM5NjQ4IEw0LjExODI2NzU4LDEyLjcxMDM1NzQgQzQuMDc5NjMwODYsMTIuOTAzMjY3NiA0LjE3MDk3MjY2LDEzLjEyNTUxNzYgNC4zNDAwOTM3NSwxMy4yNTI1MDIgQzQuNDI0ODU5MzcsMTMuMzE2MjEyOSA0LjUzNDY5OTIyLDEzLjM1MTM0OTYgNC42NDk4NDM3NSwxMy4zNTEzNDk2IEM0LjczODYwMTU2LDEzLjM1MTM0OTYgNC44MjM4MDQ2OSwxMy4zMzA2MjMgNC44OTcxNjc5NywxMy4yOTExMzg3IEw0LjkwNzcyMjY2LDEzLjI4NDk4NjMgTDguMDA4ODA0NjksMTEuNzQ2NTAzOSBaJyBpZD0n5b2i54q2Jz48L3BhdGg+PC9nPjwvZz48L2c+PC9nPjwvZz48L2c+PC9zdmc+\"\r\n                style=\"width: 15px; height: 15px; display: block;\" />\r\n            </span>\r\n            <span class=\"pl-3 dimensionTitle\">{{lists && lists.length ? lists[0].name : ''}}</span>\r\n          </div>\r\n          <input-group [groupText]=\"groupIcon\" class=\"m-1\" [(value)]=\"searchText\"\r\n            (valueChange)=\"dimensionSearchValueOnChange($event)\"></input-group>\r\n          <ul id=\"unselectFieldList\" class=\"f-utils-overflow-xhya f-utils-fill pb-1\"\r\n            [dndList]=\"lists && lists.length ? lists[0].value : []\" (dndListChange)=\"dndListChange0($event)\">\r\n            <li *ngFor=\"let item of (lists && lists.length ? lists[0].value : []); let i = index;\" [dndDraggable]=\"item\"\r\n              (dndMoved)=\"moved(i, lists[0].value)\" dndEffectAllowed=\"move\" (dndSelected)=\"models.selected = item\"\r\n              [ngClass]=\"{'selected': models.selected === item}\">\r\n              <span class=\"unselectFieldFront mr-2\"\r\n                *ngIf=\"'int,float,double,decimal,number'.includes(item.type)==false\">Abc</span>\r\n              <span class=\"unselectFieldFront mr-2\"\r\n                *ngIf=\"'int,float,double,decimal,number'.includes(item.type)==true\">123</span>\r\n              <span class=\"unselectField\">{{item.name}}</span>\r\n            </li>\r\n          </ul>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=\"col-md-6 f-utils-flex-column p-1\">\r\n      <div class=\"card f-utils-fill-flex-column\">\r\n        <div class=\"card-body  f-utils-fill-flex-column p-0\">\r\n          <div class=\"cardTitle mb-2 pt-2\">\r\n            <span id=\"rowfield\" class=\"f-icon pt-1 pr-2 pl-2\" role=\"presentation\">\r\n              <img\r\n                src=\"data:image/svg+xml;charset=utf-8;base64,PHN2ZyB3aWR0aD0nMTZweCcgaGVpZ2h0PScxNnB4JyB2aWV3Qm94PScwIDAgMTYgMTYnIHZlcnNpb249JzEuMScgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB4bWxuczp4bGluaz0naHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayc+PHRpdGxlPuihjOe7tOW6pjwvdGl0bGU+PGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+PGcgaWQ9J+mhtemdoi0xJyBzdHJva2U9J25vbmUnIHN0cm9rZS13aWR0aD0nMScgZmlsbD0nbm9uZScgZmlsbC1ydWxlPSdldmVub2RkJz48ZyBpZD0nMeOAgeafpeivolVJ6K6+6K6hJyB0cmFuc2Zvcm09J3RyYW5zbGF0ZSgtOTMxLjAwMDAwMCwgLTQ2MC4wMDAwMDApJyBzdHJva2U9JyM5Nzk3OTcnPjxnIGlkPSfnvJbnu4QtMjYnIHRyYW5zZm9ybT0ndHJhbnNsYXRlKDg5OC4wMDAwMDAsIDc1LjAwMDAwMCknPjxnIGlkPSfnvJbnu4QtMjknIHRyYW5zZm9ybT0ndHJhbnNsYXRlKDIwLjAwMDAwMCwgMzc1LjAwMDAwMCknPjxnIGlkPSfnvJbnu4QtMjHlpIfku70tMicgdHJhbnNmb3JtPSd0cmFuc2xhdGUoMS4wMDAwMDAsIDAuMDAwMDAwKSc+PGcgaWQ9J+e8lue7hC0yMicgdHJhbnNmb3JtPSd0cmFuc2xhdGUoMTIuMDAwMDAwLCAxMC4wMDAwMDApJz48cmVjdCBpZD0n55+p5b2iJyB4PScxLjUnIHk9JzIuNScgd2lkdGg9JzQuMjUnIGhlaWdodD0nNC4yNScgcng9JzEnPjwvcmVjdD48cmVjdCBpZD0n55+p5b2iJyBmaWxsPScjRDhEOEQ4JyB4PSc4LjUnIHk9JzMuMzc1JyB3aWR0aD0nNScgaGVpZ2h0PScxJz48L3JlY3Q+PHJlY3QgaWQ9J+efqeW9ouWkh+S7vS0xMicgZmlsbD0nI0Q4RDhEOCcgeD0nOC41JyB5PScxMC4zNzUnIHdpZHRoPSc1JyBoZWlnaHQ9JzEnPjwvcmVjdD48cmVjdCBpZD0n55+p5b2i5aSH5Lu9LTcnIGZpbGw9JyNEOEQ4RDgnIHg9JzguNScgeT0nNicgd2lkdGg9JzUnIGhlaWdodD0nMSc+PC9yZWN0PjxyZWN0IGlkPSfnn6nlvaLlpIfku70tMTMnIGZpbGw9JyNEOEQ4RDgnIHg9JzguNScgeT0nMTMnIHdpZHRoPSc1JyBoZWlnaHQ9JzEnPjwvcmVjdD48cmVjdCBpZD0n55+p5b2i5aSH5Lu9LTYnIHg9JzEuNScgeT0nOS41JyB3aWR0aD0nNC4yNScgaGVpZ2h0PSc0LjI1JyByeD0nMSc+PC9yZWN0PjwvZz48L2c+PC9nPjwvZz48L2c+PC9nPjwvc3ZnPg==\"\r\n                style=\"width: 15px; height: 15px; display: block;\" />\r\n            </span>\r\n            <span class=\"pl-3 dimensionTitle\">{{lists && lists.length ? lists[1].name : ''}}</span>\r\n          </div>\r\n          <div id=\"rowfieldimg\" *ngIf=\"lists && lists.length ? (lists[1]?.value?.length < 1) : true\"\r\n            class=\"f-utils-absolute-all f-utils-flex-column justify-content-center align-items-center\"\r\n            role=\"presentation\" style=\"align-items: center; top: 36px; z-index: 10;\">\r\n            <img\r\n              src=\"data:image/svg+xml;charset=utf-8;base64,PHN2ZyB3aWR0aD0nNTBweCcgaGVpZ2h0PSc1MHB4JyB2aWV3Qm94PScwIDAgNTAgNTAnIHZlcnNpb249JzEuMScgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB4bWxuczp4bGluaz0naHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayc+PHRpdGxlPuWIl+e7tOW6puWbvjwvdGl0bGU+PGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+PGRlZnM+PHJlY3QgaWQ9J3BhdGgtMScgeD0nMjYnIHk9JzMxJyB3aWR0aD0nMjQnIGhlaWdodD0nMTgnIHJ4PScwLjUnPjwvcmVjdD48ZmlsdGVyIHg9Jy02LjIlJyB5PSctOC4zJScgd2lkdGg9JzExMi41JScgaGVpZ2h0PScxMTYuNyUnIGZpbHRlclVuaXRzPSdvYmplY3RCb3VuZGluZ0JveCcgaWQ9J2ZpbHRlci0yJz48ZmVPZmZzZXQgZHg9JzAnIGR5PScwJyBpbj0nU291cmNlQWxwaGEnIHJlc3VsdD0nc2hhZG93T2Zmc2V0T3V0ZXIxJz48L2ZlT2Zmc2V0PjxmZUdhdXNzaWFuQmx1ciBzdGREZXZpYXRpb249JzAuNScgaW49J3NoYWRvd09mZnNldE91dGVyMScgcmVzdWx0PSdzaGFkb3dCbHVyT3V0ZXIxJz48L2ZlR2F1c3NpYW5CbHVyPjxmZUNvbXBvc2l0ZSBpbj0nc2hhZG93Qmx1ck91dGVyMScgaW4yPSdTb3VyY2VBbHBoYScgb3BlcmF0b3I9J291dCcgcmVzdWx0PSdzaGFkb3dCbHVyT3V0ZXIxJz48L2ZlQ29tcG9zaXRlPjxmZUNvbG9yTWF0cml4IHZhbHVlcz0nMCAwIDAgMCAwLjExNDg0Mzc1IDAgMCAwIDAgMC41MTU4ODE4MTcgMCAwIDAgMCAxIDAgMCAwIDAuNzI2NDgwNTUxIDAnIHR5cGU9J21hdHJpeCcgaW49J3NoYWRvd0JsdXJPdXRlcjEnPjwvZmVDb2xvck1hdHJpeD48L2ZpbHRlcj48bGluZWFyR3JhZGllbnQgeDE9JzUwJScgeTE9JzEwMCUnIHgyPSc1MCUnIHkyPScwJScgaWQ9J2xpbmVhckdyYWRpZW50LTMnPjxzdG9wIHN0b3AtY29sb3I9JyNEQUVCRkYnIHN0b3Atb3BhY2l0eT0nMC4yMDMwNDMwNTEnIG9mZnNldD0nMCUnPjwvc3RvcD48c3RvcCBzdG9wLWNvbG9yPScjQjNEMkZGJyBzdG9wLW9wYWNpdHk9JzAuNDczMDM4NjgnIG9mZnNldD0nMTAwJSc+PC9zdG9wPjwvbGluZWFyR3JhZGllbnQ+PC9kZWZzPjxnIGlkPSfpobXpnaItMScgc3Ryb2tlPSdub25lJyBzdHJva2Utd2lkdGg9JzEnIGZpbGw9J25vbmUnIGZpbGwtcnVsZT0nZXZlbm9kZCc+PGcgaWQ9JzHjgIHmn6Xor6JVSeiuvuiuoScgdHJhbnNmb3JtPSd0cmFuc2xhdGUoLTEyMTQuMDAwMDAwLCAtNTY1LjAwMDAwMCknPjxnIGlkPSfnvJbnu4QtMjYnIHRyYW5zZm9ybT0ndHJhbnNsYXRlKDg5OC4wMDAwMDAsIDc1LjAwMDAwMCknPjxnIGlkPSfnvJbnu4QtMzAnIHRyYW5zZm9ybT0ndHJhbnNsYXRlKDIzOS4wMDAwMDAsIDM3NS4wMDAwMDApJz48ZyBpZD0n57yW57uELTM05aSH5Lu9JyB0cmFuc2Zvcm09J3RyYW5zbGF0ZSg0MC4wMDAwMDAsIDExNS4wMDAwMDApJz48ZyBpZD0n57yW57uELTMzJyB0cmFuc2Zvcm09J3RyYW5zbGF0ZSgzNy4wMDAwMDAsIDAuMDAwMDAwKSc+PGcgaWQ9J+e8lue7hC01Jz48cmVjdCBpZD0n55+p5b2i5aSH5Lu9LTMnIGZpbGw9JyNCM0QyRkYnIG9wYWNpdHk9JzAuMjQzODYxNjA3JyB4PScyNicgeT0nMTAnIHdpZHRoPScyNCcgaGVpZ2h0PScxOCcgcng9JzAuNSc+PC9yZWN0PjxnIGlkPSfnn6nlvaLlpIfku70tNicgb3BhY2l0eT0nMC41OTYxMjE2NTInPjx1c2UgZmlsbD0nYmxhY2snIGZpbGwtb3BhY2l0eT0nMScgZmlsdGVyPSd1cmwoI2ZpbHRlci0yKScgeGxpbms6aHJlZj0nI3BhdGgtMSc+PC91c2U+PHJlY3Qgc3Ryb2tlLW9wYWNpdHk9JzAuMjIzNDQ4NDI3JyBzdHJva2U9JyMwMDUxQjknIHN0cm9rZS13aWR0aD0nMScgc3Ryb2tlLWxpbmVqb2luPSdzcXVhcmUnIGZpbGw9JyM3QkIyRjgnIGZpbGwtcnVsZT0nZXZlbm9kZCcgeD0nMjYuNScgeT0nMzEuNScgd2lkdGg9JzIzJyBoZWlnaHQ9JzE3JyByeD0nMC41Jz48L3JlY3Q+PC9nPjxyZWN0IGlkPSfnn6nlvaLlpIfku70tMTInIGZpbGw9JyNCM0QyRkYnIG9wYWNpdHk9JzAuMjQzODYxNjA3JyB4PScwJyB5PScxMCcgd2lkdGg9JzI0JyBoZWlnaHQ9JzE4JyByeD0nMC41Jz48L3JlY3Q+PHJlY3QgaWQ9J+efqeW9ouWkh+S7vS0xNCcgZmlsbD0nI0IzRDJGRicgb3BhY2l0eT0nMC4yNDM4NjE2MDcnIHg9JzAnIHk9JzEnIHdpZHRoPSc1MCcgaGVpZ2h0PSc2JyByeD0nMC41Jz48L3JlY3Q+PHJlY3QgaWQ9J+efqeW9ouWkh+S7vS0xOCcgZmlsbD0ndXJsKCNsaW5lYXJHcmFkaWVudC0zKScgeD0nMCcgeT0nMzEnIHdpZHRoPScyNCcgaGVpZ2h0PScxOCcgcng9JzAuNSc+PC9yZWN0PjwvZz48L2c+PC9nPjwvZz48L2c+PC9nPjwvZz48L3N2Zz4=\"\r\n              style=\"width: 50px;height: 56px;display: block;\">\r\n            <!-- <span class=\"imgFont\">{{localizeService?.getValue('spread.crossTable.rowDimensionTitle')}}</span> -->\r\n          </div>\r\n          <ul class=\"f-utils-overflow-xhya f-utils-fill pb-1\" style=\"z-index: 20\"\r\n            [dndList]=\"lists && lists.length ? lists[1].value : []\" (dndListChange)=\"dndListChange1($event)\">\r\n            <li *ngFor=\"let item of (lists && lists.length ? lists[1].value : []); let i = index;\" [dndDraggable]=\"item\"\r\n              class=\"mb-1 p-1\" (dndMoved)=\"moved(i, lists[1].value)\" dndEffectAllowed=\"move\"\r\n              (dndSelected)=\"models.selected = item\" [ngClass]=\"{'selected': models.selected === item}\">\r\n              {{item.name}}\r\n              <!-- <div class=\"btn-group mr-3\" fDropdown>\r\n                <button class=\"btn btn-link dropdown-toggle\" fDropdownToggle type=\"button\">\r\n                  {{item.name}}\r\n                </button>\r\n                <div class=\"dropdown-menu\" fDropdownMenu>\r\n                  <div class=\"flex-fill farris-split-section farris-overflow-hidden\">\r\n                    <div class=\"farris-form farris-card-content-bg\">\r\n                      <div class=\"col-12 col-md-12 col-lg-12\"\r\n                        *ngIf=\"(controlType!='crosstab' && controlType!='treelist' && isOrNotPaging)\">\r\n                        <div class=\"farris-group-wrap\" [class.form-inline]=\"formInline\"\r\n                          [class.farris-form-inline]=\"formInline\">\r\n                          <div class=\"form-group farris-form-group\">\r\n                            <label class=\"col-form-label\" for=\"colPageText\">\r\n                              <span\r\n                                class=\"farris-label-text\">{{localizeService.getValue('ideCmp.schemaManager.columnOption.pageTotal')}}:</span>\r\n                            </label>\r\n                            <div class=\"farris-input-wrap\">\r\n                              <input-group [(ngModel)]=\"pageText\" id=\"colPageText\"></input-group>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                      <div class=\"col-12 col-md-12 col-lg-12\"\r\n                        *ngIf=\"(controlType!='crosstab' && controlType!='treelist' && isOrNotPaging)\">\r\n                        <div class=\"farris-group-wrap\" [class.form-inline]=\"formInline\"\r\n                          [class.farris-form-inline]=\"formInline\">\r\n                          <div class=\"form-group farris-form-group\">\r\n                            <label class=\"col-form-label\" for=\"colPageAggre\">\r\n                              <span\r\n                                class=\"farris-label-text\">{{localizeService.getValue('ideCmp.schemaManager.columnOption.pageTotalType')}}:</span>\r\n                            </label>\r\n                            <div class=\"farris-input-wrap\">\r\n                              <farris-combo-list id=\"colPageAggre\" [(ngModel)]=\"pageSelectValue\" [data]=\"aggreData\"\r\n                                [textField]=\"'name'\" [idField]=\"'value'\" [enableClear]=\"false\"></farris-combo-list>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                      <div class=\"col-12 col-md-12 col-lg-12\"\r\n                        *ngIf=\"(controlType!='crosstab' && controlType!='treelist')\">\r\n                        <div class=\"farris-group-wrap\" [class.form-inline]=\"formInline\"\r\n                          [class.farris-form-inline]=\"formInline\">\r\n                          <div class=\"form-group farris-form-group\">\r\n                            <label class=\"col-form-label\" for=\"colGroupText\">\r\n                              <span\r\n                                class=\"farris-label-text\">{{localizeService.getValue('ideCmp.schemaManager.columnOption.groupTotal')}}:</span>\r\n                            </label>\r\n                            <div class=\"farris-input-wrap\">\r\n                              <input-group [(ngModel)]=\"groupText\" id=\"colGroupText\"></input-group>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                      <div class=\"col-12 col-md-12 col-lg-12\"\r\n                        *ngIf=\"(controlType!='crosstab' && controlType!='treelist')\">\r\n                        <div class=\"farris-group-wrap\" [class.form-inline]=\"formInline\"\r\n                          [class.farris-form-inline]=\"formInline\">\r\n                          <div class=\"form-group farris-form-group\">\r\n                            <label class=\"col-form-label\" for=\"colGroupAggre\">\r\n                              <span\r\n                                class=\"farris-label-text\">{{localizeService.getValue('ideCmp.schemaManager.columnOption.groupSubTotalType')}}:</span>\r\n                            </label>\r\n                            <div class=\"farris-input-wrap\">\r\n                              <farris-combo-list id=\"colGroupAggre\" [disabled]=\"colIsGroup\"\r\n                                [(ngModel)]=\"groupSubSelectValue\" [data]=\"aggreData\" [textField]=\"'name'\"\r\n                                [idField]=\"'value'\" [enableClear]=\"false\">\r\n                              </farris-combo-list>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                      <div class=\"col-12 col-md-12 col-lg-12\"\r\n                        *ngIf=\"(controlType!='crosstab' && controlType!='treelist')\">\r\n                        <div class=\"farris-group-wrap\" [class.form-inline]=\"formInline\"\r\n                          [class.farris-form-inline]=\"formInline\">\r\n                          <div class=\"form-group farris-form-group\">\r\n                            <label class=\"col-form-label\" for=\"colGroupAggre\">\r\n                              <span\r\n                                class=\"farris-label-text\">{{localizeService.getValue('ideCmp.schemaManager.columnOption.groupTotalType')}}:</span>\r\n                            </label>\r\n                            <div class=\"farris-input-wrap\">\r\n                              <farris-combo-list id=\"colGroupAggre\" [disabled]=\"colIsGroup\"\r\n                                [(ngModel)]=\"groupSelectValue\" [data]=\"aggreData\" [textField]=\"'name'\"\r\n                                [idField]=\"'value'\" [enableClear]=\"false\">\r\n                              </farris-combo-list>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                      <div class=\"col-12 col-md-12 col-lg-12\"\r\n                        *ngIf=\"(controlType!='crosstab' && !isOrNotPaging)\">\r\n                        <div class=\"farris-group-wrap\" [class.form-inline]=\"formInline\"\r\n                          [class.farris-form-inline]=\"formInline\">\r\n                          <div class=\"form-group farris-form-group\">\r\n                            <label class=\"col-form-label\" for=\"colTotalText\">\r\n                              <span\r\n                                class=\"farris-label-text\">{{localizeService.getValue('ideCmp.schemaManager.columnOption.aggregateTotal')}}:</span>\r\n                            </label>\r\n                            <div class=\"farris-input-wrap\">\r\n                              <input-group [(ngModel)]=\"totalText\" id=\"colTotalText\"></input-group>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                      <div class=\"col-12 col-md-12 col-lg-12\"\r\n                        *ngIf=\"(controlType!='crosstab' && !isOrNotPaging)\">\r\n                        <div class=\"farris-group-wrap\" [class.form-inline]=\"formInline\"\r\n                          [class.farris-form-inline]=\"formInline\">\r\n                          <div class=\"form-group farris-form-group\">\r\n                            <label class=\"col-form-label\" for=\"colTotalAggre\">\r\n                              <span\r\n                                class=\"farris-label-text\">{{localizeService.getValue('ideCmp.schemaManager.columnOption.totalType')}}:</span>\r\n                            </label>\r\n                            <div class=\"farris-input-wrap\">\r\n                              <farris-combo-list id=\"colTotalAggre\" [(ngModel)]=\"totalSelectValue\" [data]=\"aggreData\"\r\n                                [textField]=\"'name'\" [idField]=\"'value'\" [enableClear]=\"false\"></farris-combo-list>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div> -->\r\n            </li>\r\n          </ul>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n  <div class=\"simpleDemo f-utils-fill-flex-row\" *ngIf=\"controlType=='list'\">\r\n    <div class=\"col-md-6 f-utils-flex-column p-1\">\r\n      <div class=\"card f-utils-fill-flex-column\">\r\n        <div class=\"card-body f-utils-fill-flex-column p-0\">\r\n          <div class=\"cardTitle mb-2 pt-2\">\r\n            <span id=\"colfield\" class=\"f-icon pt-1 pr-2 pl-2\" role=\"presentation\">\r\n              <img\r\n                src=\"data:image/svg+xml;charset=utf-8;base64,PHN2ZyB3aWR0aD0nMTdweCcgaGVpZ2h0PScxN3B4JyB2aWV3Qm94PScwIDAgMTcgMTcnIHZlcnNpb249JzEuMScgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB4bWxuczp4bGluaz0naHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayc+PHRpdGxlPuWIl+e7tOW6pjwvdGl0bGU+PGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+PGcgaWQ9J+mhtemdoi0xJyBzdHJva2U9J25vbmUnIHN0cm9rZS13aWR0aD0nMScgZmlsbD0nbm9uZScgZmlsbC1ydWxlPSdldmVub2RkJz48ZyBpZD0nMeOAgeafpeivolVJ6K6+6K6hJyB0cmFuc2Zvcm09J3RyYW5zbGF0ZSgtMTE1MC4wMDAwMDAsIC00NjAuMDAwMDAwKScgc3Ryb2tlPScjOTc5Nzk3Jz48ZyBpZD0n57yW57uELTI2JyB0cmFuc2Zvcm09J3RyYW5zbGF0ZSg4OTguMDAwMDAwLCA3NS4wMDAwMDApJz48ZyBpZD0n57yW57uELTMwJyB0cmFuc2Zvcm09J3RyYW5zbGF0ZSgyMzkuMDAwMDAwLCAzNzUuMDAwMDAwKSc+PGcgaWQ9J+e8lue7hC0yMeWkh+S7vS0zJyB0cmFuc2Zvcm09J3RyYW5zbGF0ZSgxLjAwMDAwMCwgMC4wMDAwMDApJz48ZyBpZD0n57yW57uELTIyJyB0cmFuc2Zvcm09J3RyYW5zbGF0ZSgyMC4xMjUwMDAsIDE4LjEyNTAwMCkgcm90YXRlKDkwLjAwMDAwMCkgdHJhbnNsYXRlKC0yMC4xMjUwMDAsIC0xOC4xMjUwMDApIHRyYW5zbGF0ZSgxMi4xMjUwMDAsIDEwLjEyNTAwMCknPjxyZWN0IGlkPSfnn6nlvaInIHg9JzEuNScgeT0nMi41JyB3aWR0aD0nNC4yNScgaGVpZ2h0PSc0LjI1JyByeD0nMSc+PC9yZWN0PjxyZWN0IGlkPSfnn6nlvaInIGZpbGw9JyNEOEQ4RDgnIHg9JzguNScgeT0nMy4zNzUnIHdpZHRoPSc1JyBoZWlnaHQ9JzEnPjwvcmVjdD48cmVjdCBpZD0n55+p5b2i5aSH5Lu9LTEyJyBmaWxsPScjRDhEOEQ4JyB4PSc4LjUnIHk9JzEwLjM3NScgd2lkdGg9JzUnIGhlaWdodD0nMSc+PC9yZWN0PjxyZWN0IGlkPSfnn6nlvaLlpIfku70tNycgZmlsbD0nI0Q4RDhEOCcgeD0nOC41JyB5PSc2JyB3aWR0aD0nNScgaGVpZ2h0PScxJz48L3JlY3Q+PHJlY3QgaWQ9J+efqeW9ouWkh+S7vS0xMycgZmlsbD0nI0Q4RDhEOCcgeD0nOC41JyB5PScxMycgd2lkdGg9JzUnIGhlaWdodD0nMSc+PC9yZWN0PjxyZWN0IGlkPSfnn6nlvaLlpIfku70tNicgeD0nMS41JyB5PSc5LjUnIHdpZHRoPSc0LjI1JyBoZWlnaHQ9JzQuMjUnIHJ4PScxJz48L3JlY3Q+PC9nPjwvZz48L2c+PC9nPjwvZz48L2c+PC9zdmc+\"\r\n                style=\"width: 15px; height: 15px; display: block;\" />\r\n            </span>\r\n            <span class=\"pl-3 dimensionTitle\">{{lists && lists.length ? lists[2].name : ''}}</span>\r\n          </div>\r\n          <div id=\"colfieldimg\" *ngIf=\"lists && lists.length ? (lists[2]?.value?.length < 1) : true\"\r\n            class=\"f-utils-absolute-all f-utils-flex-column justify-content-center align-items-center\"\r\n            role=\"presentation\" style=\"align-items: center; top: 36px; z-index: 10;\">\r\n            <img\r\n              src=\"data:image/svg+xml;charset=utf-8;base64,PHN2ZyB3aWR0aD0nNTBweCcgaGVpZ2h0PSc1MHB4JyB2aWV3Qm94PScwIDAgNTAgNTAnIHZlcnNpb249JzEuMScgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB4bWxuczp4bGluaz0naHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayc+PHRpdGxlPuWIl+e7tOW6puWbvjwvdGl0bGU+PGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+PGRlZnM+PHJlY3QgaWQ9J3BhdGgtMScgeD0nMjYnIHk9JzMxJyB3aWR0aD0nMjQnIGhlaWdodD0nMTgnIHJ4PScwLjUnPjwvcmVjdD48ZmlsdGVyIHg9Jy02LjIlJyB5PSctOC4zJScgd2lkdGg9JzExMi41JScgaGVpZ2h0PScxMTYuNyUnIGZpbHRlclVuaXRzPSdvYmplY3RCb3VuZGluZ0JveCcgaWQ9J2ZpbHRlci0yJz48ZmVPZmZzZXQgZHg9JzAnIGR5PScwJyBpbj0nU291cmNlQWxwaGEnIHJlc3VsdD0nc2hhZG93T2Zmc2V0T3V0ZXIxJz48L2ZlT2Zmc2V0PjxmZUdhdXNzaWFuQmx1ciBzdGREZXZpYXRpb249JzAuNScgaW49J3NoYWRvd09mZnNldE91dGVyMScgcmVzdWx0PSdzaGFkb3dCbHVyT3V0ZXIxJz48L2ZlR2F1c3NpYW5CbHVyPjxmZUNvbXBvc2l0ZSBpbj0nc2hhZG93Qmx1ck91dGVyMScgaW4yPSdTb3VyY2VBbHBoYScgb3BlcmF0b3I9J291dCcgcmVzdWx0PSdzaGFkb3dCbHVyT3V0ZXIxJz48L2ZlQ29tcG9zaXRlPjxmZUNvbG9yTWF0cml4IHZhbHVlcz0nMCAwIDAgMCAwLjExNDg0Mzc1IDAgMCAwIDAgMC41MTU4ODE4MTcgMCAwIDAgMCAxIDAgMCAwIDAuNzI2NDgwNTUxIDAnIHR5cGU9J21hdHJpeCcgaW49J3NoYWRvd0JsdXJPdXRlcjEnPjwvZmVDb2xvck1hdHJpeD48L2ZpbHRlcj48bGluZWFyR3JhZGllbnQgeDE9JzUwJScgeTE9JzEwMCUnIHgyPSc1MCUnIHkyPScwJScgaWQ9J2xpbmVhckdyYWRpZW50LTMnPjxzdG9wIHN0b3AtY29sb3I9JyNEQUVCRkYnIHN0b3Atb3BhY2l0eT0nMC4yMDMwNDMwNTEnIG9mZnNldD0nMCUnPjwvc3RvcD48c3RvcCBzdG9wLWNvbG9yPScjQjNEMkZGJyBzdG9wLW9wYWNpdHk9JzAuNDczMDM4NjgnIG9mZnNldD0nMTAwJSc+PC9zdG9wPjwvbGluZWFyR3JhZGllbnQ+PC9kZWZzPjxnIGlkPSfpobXpnaItMScgc3Ryb2tlPSdub25lJyBzdHJva2Utd2lkdGg9JzEnIGZpbGw9J25vbmUnIGZpbGwtcnVsZT0nZXZlbm9kZCc+PGcgaWQ9JzHjgIHmn6Xor6JVSeiuvuiuoScgdHJhbnNmb3JtPSd0cmFuc2xhdGUoLTEyMTQuMDAwMDAwLCAtNTY1LjAwMDAwMCknPjxnIGlkPSfnvJbnu4QtMjYnIHRyYW5zZm9ybT0ndHJhbnNsYXRlKDg5OC4wMDAwMDAsIDc1LjAwMDAwMCknPjxnIGlkPSfnvJbnu4QtMzAnIHRyYW5zZm9ybT0ndHJhbnNsYXRlKDIzOS4wMDAwMDAsIDM3NS4wMDAwMDApJz48ZyBpZD0n57yW57uELTM05aSH5Lu9JyB0cmFuc2Zvcm09J3RyYW5zbGF0ZSg0MC4wMDAwMDAsIDExNS4wMDAwMDApJz48ZyBpZD0n57yW57uELTMzJyB0cmFuc2Zvcm09J3RyYW5zbGF0ZSgzNy4wMDAwMDAsIDAuMDAwMDAwKSc+PGcgaWQ9J+e8lue7hC01Jz48cmVjdCBpZD0n55+p5b2i5aSH5Lu9LTMnIGZpbGw9JyNCM0QyRkYnIG9wYWNpdHk9JzAuMjQzODYxNjA3JyB4PScyNicgeT0nMTAnIHdpZHRoPScyNCcgaGVpZ2h0PScxOCcgcng9JzAuNSc+PC9yZWN0PjxnIGlkPSfnn6nlvaLlpIfku70tNicgb3BhY2l0eT0nMC41OTYxMjE2NTInPjx1c2UgZmlsbD0nYmxhY2snIGZpbGwtb3BhY2l0eT0nMScgZmlsdGVyPSd1cmwoI2ZpbHRlci0yKScgeGxpbms6aHJlZj0nI3BhdGgtMSc+PC91c2U+PHJlY3Qgc3Ryb2tlLW9wYWNpdHk9JzAuMjIzNDQ4NDI3JyBzdHJva2U9JyMwMDUxQjknIHN0cm9rZS13aWR0aD0nMScgc3Ryb2tlLWxpbmVqb2luPSdzcXVhcmUnIGZpbGw9JyM3QkIyRjgnIGZpbGwtcnVsZT0nZXZlbm9kZCcgeD0nMjYuNScgeT0nMzEuNScgd2lkdGg9JzIzJyBoZWlnaHQ9JzE3JyByeD0nMC41Jz48L3JlY3Q+PC9nPjxyZWN0IGlkPSfnn6nlvaLlpIfku70tMTInIGZpbGw9JyNCM0QyRkYnIG9wYWNpdHk9JzAuMjQzODYxNjA3JyB4PScwJyB5PScxMCcgd2lkdGg9JzI0JyBoZWlnaHQ9JzE4JyByeD0nMC41Jz48L3JlY3Q+PHJlY3QgaWQ9J+efqeW9ouWkh+S7vS0xNCcgZmlsbD0nI0IzRDJGRicgb3BhY2l0eT0nMC4yNDM4NjE2MDcnIHg9JzAnIHk9JzEnIHdpZHRoPSc1MCcgaGVpZ2h0PSc2JyByeD0nMC41Jz48L3JlY3Q+PHJlY3QgaWQ9J+efqeW9ouWkh+S7vS0xOCcgZmlsbD0ndXJsKCNsaW5lYXJHcmFkaWVudC0zKScgeD0nMCcgeT0nMzEnIHdpZHRoPScyNCcgaGVpZ2h0PScxOCcgcng9JzAuNSc+PC9yZWN0PjwvZz48L2c+PC9nPjwvZz48L2c+PC9nPjwvZz48L3N2Zz4=\"\r\n              style=\"width: 50px;height: 56px;display: block;\">\r\n            <!-- <span class=\"imgFont\">{{localizeService?.getValue('spread.crossTable.colDimensionTitle')}}</span> -->\r\n          </div>\r\n          <ul class=\"f-utils-overflow-xhya f-utils-fill pb-1\" style=\"z-index: 20\"\r\n            [dndList]=\"lists && lists.length ? lists[2].value : []\" (dndListChange)=\"dndListChange2($event)\">\r\n            <li *ngFor=\"let item of (lists && lists.length ? lists[2].value : []); let i = index;\" [dndDraggable]=\"item\"\r\n              class=\"mb-1 p-1\" (dndMoved)=\"moved(i, lists[2].value)\" dndEffectAllowed=\"move\"\r\n              (dndSelected)=\"models.selected = item\" [ngClass]=\"{'selected': models.selected === item}\">\r\n              {{item.name}}\r\n            </li>\r\n          </ul>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n",
                        styles: [".simpleDemo ul{min-height:42px;padding:0}.card-title,.demo-header{text-align:center}.title{margin:20px 0}.simpleDemo ul .dndDraggingSource{display:none}.simpleDemo ul .dndPlaceholder{background:rgba(56,143,255,.06);border:1px dashed #388fff;box-shadow:0 0 4px 0 rgba(13,95,201,.22);margin:.25rem!important;padding:.25rem!important}.simpleDemo ul li{background:rgba(235,244,254,.84);border:1px solid #388fff;box-shadow:0 0 10px 0 rgba(63,113,177,.22);border-radius:3px;height:28px;font-family:PingFangSC-Regular;font-size:13px;color:#388fff;margin:.25rem!important;padding:.25rem!important}#unselectFieldList li{border:none;background-color:rgba(0,0,0,0);box-shadow:0 0 #000;border-radius:3px;height:28px;margin:.25rem!important;padding:.25rem!important}#unselectFieldList li:hover{background:#f4f5f9}#unselectFieldList .dndPlaceholder{background:rgba(56,143,255,.06);border:1px dashed #388fff;box-shadow:0 0 4px 0 rgba(13,95,201,.22);margin:.25rem!important;padding:.25rem!important}.unselectField{font-family:PingFangSC-Regular;font-size:13px;color:rgba(0,0,0,.85)}.unselectFieldFront{font-family:PingFangSC-Medium;font-size:13px;color:#b4bccc}.simpleDemo ul li.selected{background-color:#dff0d8;color:#3c763d}.current-model{background-color:#f5f5f5;border:1px solid #ccc;border-radius:4px;padding:18px 22px}.slicer{height:220px;position:relative}.headerMenu{position:fixed;display:none;top:0;left:0}.cardTitle{background:#f5f7fa;border-radius:3px 3px 0 0;height:36px}.dimensionTitle{font-family:PingFangSC-Medium;font-size:14px;color:rgba(0,0,0,.65);line-height:20px}.imgFont{font-family:PingFangSC-Regular;font-size:13px;color:#b4bccc}"]
                    }] }
        ];
        /** @nocollapse */
        ColumnsSettingComponent.ctorParameters = function () {
            return [
                { type: core.Injector }
            ];
        };
        ColumnsSettingComponent.propDecorators = {
            controlType: [{ type: core.Input }],
            queryRelativeUrl: [{ type: core.Input }],
            queryId: [{ type: core.Input }],
            qoManagerCode: [{ type: core.Input }],
            qoId: [{ type: core.Input }],
            voId: [{ type: core.Input }],
            groupType: [{ type: core.Input }],
            spread: [{ type: core.Input }],
            conditionExpression: [{ type: core.Input }],
            jointsearchInfoList: [{ type: core.Input }],
            qdpView: [{ type: core.Input }]
        };
        return ColumnsSettingComponent;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
     */
    var QdpViewComponent = /** @class */ (function () {
        function QdpViewComponent(elRef, renderService, renderer, filterService, injector) {
            this.renderService = renderService;
            this.renderer = renderer;
            this.filterService = filterService;
            this.injector = injector;
            this.aggreData = [
                { name: '请选择', value: 0 },
                { name: '合计', value: 1 },
                { name: '最小值', value: 2 },
                { name: '最大值', value: 3 },
                { name: '计数', value: 4 },
                { name: '平均值', value: 5 }
            ];
            this.groupSelectValue = this.aggreData[0].value;
            this.groupText = '';
            this.colIsGroup = false;
            this.formInline = true;
            this.currentColIndex = 0;
            this.isInitQdpView = true; // 是否初始化qdpViewComponent
            // 是否初始化qdpViewComponent
            this.isShowDimension = true;
            this.cls = true;
            this.isOpen = false;
            this.headerMenuTop = 0;
            this.headerMenuLeft = 0;
            this.headerMenuDisplay = 'none';
            this.colIsGroupId = 'colIsGroup' + common$1.EventBus.guid();
            this.style = {
                width: '800px',
                height: '600px'
            };
            // indicate all options
            this.isCommonQdpViewComponent = false;
            this.sheetChanged = new rxjs.Subject(); //切换sheet监听事件
            //切换sheet监听事件
            this.multiSheetsSchemaIds = {};
            // 来源数据
            this.searchText = '';
            this.groupIcon = '<span class="k-icon k-i-search"></span>';
            this.conditionExpression = null;
            this.elRef = elRef;
            if (this.injector) {
                this.localizeService = this.injector.get(localize.LocalizeService);
                this.msgService = this.injector.get(uiMessager.MessagerService);
                this.localId = this.injector.get(core.LOCALE_ID) || localize.DEFAULT_LANGUAGE;
                this.formInline = this.localId.toLowerCase() === localize.DEFAULT_LANGUAGE;
                this.loadService = this.injector.get(uiLoading.LoadingService);
                this.lcpService = this.injector.get(common$1.LcpService);
                this.jointSearchManagerService = this.injector.get(common$1.JointSearchManagerService);
                this.schemaManager = this.injector.get(common$1.SchemaManagerService);
                this.dataRenderExtendService = this.injector.get(common$1.DataRenderExtendService);
                this.formErrorService = this.injector.get(commandServices.FormErrorService);
                this.aggreData = this.localizeService.getValue('ideCmp.schemaManager.columnOption.aggregateData');
                this.cache = this.injector.get(cafCommon.CacheService);
            }
        }
        /**
         * @private
         * @return {?}
         */
        QdpViewComponent.prototype.setServices = /**
         * @private
         * @return {?}
         */
            function () {
                ServicesUtils.setServices('renderExtends' + this.queryId, this.dataRenderExtendService);
            };
        /**
         * @return {?}
         */
        QdpViewComponent.prototype.ngOnInit = /**
         * @return {?}
         */
            function () {
                this.loading = this.loadService.show({ container: 'body' });
                this.setServices();
                // 交叉表结果页监听事件
                if (this.controlType === 'crosstab') {
                    this.docClickSubscription = this.renderer.listen('document', 'click', this.onDocumentClick.bind(this));
                }
                this.tabId = common$1.RtfServices.getTabId(this.queryId);
                // 缓存结果页对象，给工具栏使用
                common$1.QDPCacheUtil.setCache(this.tabId + this.queryId + this.controlType + 'qdpview', this);
                ServicesUtils.setServices(this.tabId + 'qoId', this.qoId);
            };
        /**
         * @return {?}
         */
        QdpViewComponent.prototype.ngAfterViewInit = /**
         * @return {?}
         */
            function () {
                var _this = this;
                try {
                    // 通过配置中心，获取spreadjs控件序列号
                    this.lcpService.formErrorService = this.formErrorService;
                    this.lcpService.getSpreadLicense().subscribe(( /**
                     * @param {?} data
                     * @return {?}
                     */function (data) {
                        if (data) {
                            GC.Spread.Sheets.LicenseKey = data;
                        }
                        _this.afterView();
                    }));
                }
                catch (e) {
                    this.loading.close();
                }
                this.setMultiSheetsVarible();
            };
        /**
         * @private
         * @return {?}
         */
        QdpViewComponent.prototype.setMultiSheetsVarible = /**
         * @private
         * @return {?}
         */
            function () {
                if (this.columnsSettingComponent) {
                    this.columnsSettingComponent.multiSheets = this.multiSheets;
                    this.columnsSettingComponent.curSheet = this.curSheet;
                    this.columnsSettingComponent.multiSheetsSchemaIds = this.multiSheetsSchemaIds;
                }
            };
        /**
         * @return {?}
         */
        QdpViewComponent.prototype.afterView = /**
         * @return {?}
         */
            function () {
                /** @type {?} */
                var elRef = this.elRef;
                /** @type {?} */
                var dom = ( /** @type {?} */(elRef.nativeElement));
                /** @type {?} */
                var hostElement = dom.querySelector('#sheet');
                if (this.licenseKey) {
                    GC.Spread.Sheets.LicenseKey = this.licenseKey;
                }
                this.spread = new GC.Spread.Sheets.Workbook(hostElement, { sheetCount: 0 });
                this.setSpreadOptions();
                // this.bindCustomEvent(this.spread);
                /** @type {?} */
                var eventId = this.tabId;
                common$1.EventBus.register('schemaValueChanged', this.handleSchemaValueChanged.bind(this), eventId + 'qdpViewComponent');
                if (this.templateType !== 'qdpAdvancedTemplate' && this.isInitQdpView) {
                    this.initQdpView();
                }
                else {
                    this.loading.close();
                }
            };
        /**
         * @private
         * @param {?} schemaValue
         * @return {?}
         */
        QdpViewComponent.prototype.handleSchemaValueChanged = /**
         * @private
         * @param {?} schemaValue
         * @return {?}
         */
            function (schemaValue) {
                this.schemaValue = schemaValue;
                if (this.curSheet && this.multiSheets.length && schemaValue && schemaValue.id) {
                    this.multiSheetsSchemaIds[this.curSheet] = schemaValue.id;
                    this.setMultiSheetsVarible();
                }
            };
        /**
         * @return {?}
         */
        QdpViewComponent.prototype.initQdpView = /**
         * @return {?}
         */
            function () {
                var _this = this;
                /** @type {?} */
                var self = this;
                if (!this.loading) {
                    this.loading = this.loadService.show({ container: 'body' });
                }
                this.jointSearchManagerService.getjointsearch('form' + 'ff3ea474-cc65-23b0-cdb1-73c9146cea3b', this.queryId, '').subscribe(( /**
                 * @param {?} jointsearchList
                 * @return {?}
                 */function (jointsearchList) {
                    _this.filterService.getFilter(_this.qoManagerCode ? _this.qoManagerCode : _this.queryId, _this.queryId, _this.queryRelativeUrl, 1, _this.groupType).subscribe(( /**
                     * @param {?} data
                     * @return {?}
                     */function (data) {
                        self.conditionExpression = null;
                        self.jointsearchInfoList = jointsearchList;
                        if (data && data.filter) {
                            self.conditionExpression = JSON.stringify(data.filter);
                        }
                        /** @type {?} */
                        var renderOption = Object.assign({ multiSheetsSchemaIds: self.multiSheetsSchemaIds, curSheet: self.curSheet, multiSheets: self.multiSheets }, { queryId: self.queryId, controlType: self.controlType, qoManagerCode: self.qoManagerCode, pageIndex: 0, queryRelativeUrl: self.queryRelativeUrl, filterCondition: self.conditionExpression, groupType: self.groupType, voId: self.voId, jointsearchInfoList: self.jointsearchInfoList, loading: _this.loading });
                        _this.qdpViewRender(renderOption);
                    }));
                }));
            };
        /**
         * @private
         * @param {?} spread
         * @return {?}
         */
        QdpViewComponent.prototype.bindCustomEvent = /**
         * @private
         * @param {?} spread
         * @return {?}
         */
            function (spread) {
                // const customEventNameSpace = '.ng';
                // const events = [];
                // events.forEach((event) => {
                //   spread.bind(event + customEventNameSpace, (event: any, data: any) => {
                //     const eventType = event.type;
                //     const camelCaseEvent = eventType[0].toLowerCase() + eventType.substr(1);
                //     this[camelCaseEvent].emit(data);
                //   });
                // });
            };
        /**
         * @return {?}
         */
        QdpViewComponent.prototype.setSpreadOptions = /**
         * @return {?}
         */
            function () {
                /** @type {?} */
                var self = this;
                /** @type {?} */
                var spread = this.spread;
                if (!this.spread) {
                    return;
                }
                spread.suspendEvent();
                spread.suspendPaint();
                this.spread.fromJSON(null);
                /** @type {?} */
                var options = this.spreadOptions;
                if (options) {
                    options.forEach(( /**
                     * @param {?} option
                     * @return {?}
                     */function (option) {
                        if (option.name === 'name') {
                            spread.name = option.value;
                        }
                        else {
                            spread.options[option.name] = option.value;
                        }
                    }));
                }
                spread.unbind(GC.Spread.Sheets.Events.ActiveSheetChanged);
                spread.bind(GC.Spread.Sheets.Events.ActiveSheetChanged, ( /**
                 * @param {?} e
                 * @param {?} args
                 * @return {?}
                 */function (e, args) {
                    self.curSheet = args.newSheet.name();
                    self.setGroup(self.curSheet);
                    self.setMultiSheetsVarible();
                    self.initQdpView();
                }));
                spread.resumePaint();
                spread.resumeEvent();
            };
        /**
         * 方法已废弃，建议替换为initQDPView方法
         * 初始化查询结果页控件
         */
        /**
         * 方法已废弃，建议替换为initQDPView方法
         * 初始化查询结果页控件
         * @param {?} queryId
         * @param {?} schemaId
         * @param {?=} controlType
         * @param {?=} qoManagerCode
         * @param {?=} pageIndex
         * @param {?=} queryRelativeUrl
         * @param {?=} filterCondition
         * @param {?=} groupType
         * @param {?=} voId
         * @param {?=} fromCache
         * @param {?=} isSchemaSelectChanged
         * @return {?}
         */
        QdpViewComponent.prototype.initSpread = /**
         * 方法已废弃，建议替换为initQDPView方法
         * 初始化查询结果页控件
         * @param {?} queryId
         * @param {?} schemaId
         * @param {?=} controlType
         * @param {?=} qoManagerCode
         * @param {?=} pageIndex
         * @param {?=} queryRelativeUrl
         * @param {?=} filterCondition
         * @param {?=} groupType
         * @param {?=} voId
         * @param {?=} fromCache
         * @param {?=} isSchemaSelectChanged
         * @return {?}
         */
            function (queryId, schemaId, controlType, qoManagerCode, pageIndex, queryRelativeUrl, filterCondition, groupType, voId, fromCache, isSchemaSelectChanged) {
                if (this.curSheet && this.multiSheets.length) {
                    this.multiSheetsSchemaIds[this.curSheet] = schemaId;
                    this.setMultiSheetsVarible();
                }
                this.qdpViewRender(Object.assign({ multiSheetsSchemaIds: this.multiSheetsSchemaIds, curSheet: this.curSheet, multiSheets: this.multiSheets }, { schemaId: schemaId, queryId: queryId, spread: this.spread, controlType: controlType, qoManagerCode: qoManagerCode, pageIndex: pageIndex, queryRelativeUrl: queryRelativeUrl, filterCondition: filterCondition, formData: this.formData, groupType: groupType, voId: voId, qdpView: this, fromCache: fromCache, isSchemaSelectChanged: isSchemaSelectChanged, jointsearchInfoList: this.jointsearchInfoList }));
            };
        /**
         * 初始化查询结果控件
         */
        /**
         * 初始化查询结果控件
         * @param {?} option
         * @return {?}
         */
        QdpViewComponent.prototype.qdpViewRender = /**
         * 初始化查询结果控件
         * @param {?} option
         * @return {?}
         */
            function (option) {
                if (!option.loading) {
                    option.loading = this.loadService.show({ container: 'body' });
                }
                option.voId = !option.voId ? this.voId : option.voId;
                option.groupType = !option.groupType ? this.groupType : option.groupType;
                option.fromCache = option.fromCache ? option.fromCache : false;
                if (option.filterCondition) {
                    this.conditionExpression = option.filterCondition;
                }
                /** @type {?} */
                var renderOption = Object.assign({}, option, { formData: this.formData, spread: this.spread, qdpView: this });
                this.renderService.render(renderOption);
                common$1.EventBus.register(this.queryId + 'spread_init', this.registeSpreadColumnWidthChangedEvent.bind(this), this.queryId);
            };
        /**
         * 方法已废弃，建议替换为export方法
         * 导出Excel
         */
        /**
         * 方法已废弃，建议替换为export方法
         * 导出Excel
         * @param {?} queryId
         * @param {?} id
         * @param {?=} type
         * @param {?=} pageIndex
         * @param {?=} qoManagerCode
         * @param {?=} queryRelativeUrl
         * @param {?=} filterCondition
         * @param {?=} groupType
         * @param {?=} voId
         * @param {?=} totalCount
         * @param {?=} exportType
         * @return {?}
         */
        QdpViewComponent.prototype.exportExcel = /**
         * 方法已废弃，建议替换为export方法
         * 导出Excel
         * @param {?} queryId
         * @param {?} id
         * @param {?=} type
         * @param {?=} pageIndex
         * @param {?=} qoManagerCode
         * @param {?=} queryRelativeUrl
         * @param {?=} filterCondition
         * @param {?=} groupType
         * @param {?=} voId
         * @param {?=} totalCount
         * @param {?=} exportType
         * @return {?}
         */
            function (queryId, id, type, pageIndex, qoManagerCode, queryRelativeUrl, filterCondition, groupType, voId, totalCount, exportType) {
                this.export(Object.assign({ multiSheetsSchemaIds: this.multiSheetsSchemaIds, curSheet: this.curSheet, multiSheets: this.multiSheets }, { queryId: queryId, schemaId: id, controlType: type, pageIndex: pageIndex, qoManagerCode: qoManagerCode, queryRelativeUrl: queryRelativeUrl, filterCondition: filterCondition, groupType: groupType, voId: voId, totalCount: totalCount, exportType: exportType }));
            };
        /**
         * 导出Excel
         * @param opiton 渲染配置项
         */
        /**
         * 导出Excel
         * @param {?} option
         * @return {?}
         */
        QdpViewComponent.prototype.export = /**
         * 导出Excel
         * @param {?} option
         * @return {?}
         */
            function (option) {
                if (this.controlType === 'crosstab') {
                    option.totalCount = this.spread.getActiveSheet().getRowCount();
                }
                option.voId = this.voId ? this.voId : option.voId;
                option.queryId = this.queryId ? this.queryId : option.queryId;
                option.groupType = this.groupType ? this.groupType : option.groupType;
                option.qoManagerCode = this.qoManagerCode ? this.qoManagerCode : option.qoManagerCode;
                this.renderService.exportData(option);
                // this.renderService.exportData(option.queryId, option.schemaId, option.controlType, option.pageIndex, option.qoManagerCode, option.queryRelativeUrl, option.filterCondition, option.groupType, option.voId, option.totalCount || 1, option.exportType);
            };
        /**
         * 方法已废弃，建议替换为print方法
         * 打印PDF
         */
        /**
         * 方法已废弃，建议替换为print方法
         * 打印PDF
         * @param {?} queryId
         * @param {?} id
         * @param {?=} type
         * @param {?=} qoManagerCode
         * @param {?=} printIntegration
         * @param {?=} queryRelativeUrl
         * @param {?=} filterCondition
         * @param {?=} pageIndex
         * @param {?=} groupType
         * @param {?=} voId
         * @return {?}
         */
        QdpViewComponent.prototype.pdfExportEvent = /**
         * 方法已废弃，建议替换为print方法
         * 打印PDF
         * @param {?} queryId
         * @param {?} id
         * @param {?=} type
         * @param {?=} qoManagerCode
         * @param {?=} printIntegration
         * @param {?=} queryRelativeUrl
         * @param {?=} filterCondition
         * @param {?=} pageIndex
         * @param {?=} groupType
         * @param {?=} voId
         * @return {?}
         */
            function (queryId, id, type, qoManagerCode, printIntegration, queryRelativeUrl, filterCondition, pageIndex, groupType, voId) {
                this.print(Object.assign({ multiSheetsSchemaIds: this.multiSheetsSchemaIds, curSheet: this.curSheet, multiSheets: this.multiSheets }, { queryId: queryId, schemaId: id, controlType: type, pageIndex: pageIndex, qoManagerCode: qoManagerCode, queryRelativeUrl: queryRelativeUrl, printIntegration: printIntegration, filterCondition: filterCondition, groupType: groupType, voId: voId }));
            };
        /**
         * 打印
         * @param option 渲染配置项
         */
        /**
         * 打印
         * @param {?} option 渲染配置项
         * @return {?}
         */
        QdpViewComponent.prototype.print = /**
         * 打印
         * @param {?} option 渲染配置项
         * @return {?}
         */
            function (option) {
                option.voId = this.voId ? this.voId : option.voId;
                option.queryId = this.queryId ? this.queryId : option.queryId;
                option.groupType = this.groupType ? this.groupType : option.groupType;
                option.qoManagerCode = this.qoManagerCode ? this.qoManagerCode : option.qoManagerCode;
                this.renderService.pdfExportEvent(option);
                // this.renderService.pdfExportEvent(option.queryId, option.schemaId, option.controlType, option.qoManagerCode, option.printIntegration, option.queryRelativeUrl, option.filterCondition, option.groupType, option.pageIndex, option.voId);
            };
        /**
         * 方法已废弃，建议替换为printPreview(option: RenderOption)方法
         * 打印预览
         */
        /**
         * 方法已废弃，建议替换为printPreview(option: RenderOption)方法
         * 打印预览
         * @param {?} queryId
         * @param {?} id
         * @param {?=} type
         * @param {?=} qoManagerCode
         * @param {?=} printIntegration
         * @param {?=} queryRelativeUrl
         * @param {?=} filterCondition
         * @param {?=} pageIndex
         * @param {?=} groupType
         * @param {?=} voId
         * @return {?}
         */
        QdpViewComponent.prototype.printPreView = /**
         * 方法已废弃，建议替换为printPreview(option: RenderOption)方法
         * 打印预览
         * @param {?} queryId
         * @param {?} id
         * @param {?=} type
         * @param {?=} qoManagerCode
         * @param {?=} printIntegration
         * @param {?=} queryRelativeUrl
         * @param {?=} filterCondition
         * @param {?=} pageIndex
         * @param {?=} groupType
         * @param {?=} voId
         * @return {?}
         */
            function (queryId, id, type, qoManagerCode, printIntegration, queryRelativeUrl, filterCondition, pageIndex, groupType, voId) {
                /** @type {?} */
                var _voId = this.voId ? this.voId : voId;
                /** @type {?} */
                var _queryId = this.queryId ? this.queryId : queryId;
                /** @type {?} */
                var _groupType = this.groupType ? this.groupType : groupType;
                /** @type {?} */
                var _qoManagerCode = this.qoManagerCode ? this.qoManagerCode : qoManagerCode;
                this.renderService.printPreView(Object.assign({ multiSheetsSchemaIds: this.multiSheetsSchemaIds, curSheet: this.curSheet, multiSheets: this.multiSheets }, { queryId: _queryId, schemaId: id, controlType: type, qoManagerCode: _qoManagerCode, printIntegration: printIntegration, queryRelativeUrl: queryRelativeUrl, filterCondition: filterCondition, groupType: _groupType, pageIndex: pageIndex, voId: _voId }));
                // this.renderService.printPreView(queryId, id, type, qoManagerCode, printIntegration, queryRelativeUrl, filterCondition, groupType ? groupType : this.groupType, pageIndex, voId ? voId : this.voId);
            };
        /**
         * 打印预览
         * @param option 渲染配置项
         */
        /**
         * 打印预览
         * @param {?} option 渲染配置项
         * @return {?}
         */
        QdpViewComponent.prototype.printPreview = /**
         * 打印预览
         * @param {?} option 渲染配置项
         * @return {?}
         */
            function (option) {
                option.groupType = this.groupType ? this.groupType : option.groupType;
                option.voId = this.voId ? this.voId : option.voId;
                this.renderService.printPreView(option);
                // this.renderService.printPreView(option.queryId, option.schemaId, option.controlType, option.qoManagerCode, option.printIntegration, option.queryRelativeUrl, option.filterCondition, option.groupType, option.pageIndex, option.voId);
            };
        /**
         * @param {?} changes
         * @return {?}
         */
        QdpViewComponent.prototype.ngOnChanges = /**
         * @param {?} changes
         * @return {?}
         */
            function (changes) {
                /** @type {?} */
                var options = [];
                for (var changeName in changes) {
                    /** @type {?} */
                    var newValue = changes[changeName].currentValue;
                    if (newValue !== null && newValue !== void 0) {
                        this.tabId = common$1.RtfServices.getTabId(this.queryId);
                        switch (changeName) {
                            case 'hostStyle':
                                this.style = newValue;
                                if (this.spread) {
                                    this.spread.refresh();
                                }
                                break;
                            case 'hostClass':
                                break;
                            case 'name':
                                this.spread.name = newValue;
                                break;
                            case 'formData':
                                newValue.dynamicCols.forEach(( /**
                                 * @param {?} col
                                 * @return {?}
                                 */function (col) {
                                    col.name = col.title;
                                    col.bindField = col.field;
                                    col.colWidth = 150;
                                    col.align = 0;
                                    col.visible = true;
                                    col.isFixed = false;
                                    col.formatType = 0;
                                    col.formattor = '';
                                    col.sort = 0;
                                    col.pageAggreText = null;
                                    col.pageAggre = 0;
                                    col.isGroup = false;
                                    col.groupAggreText = '';
                                    col.groupAggre = 0;
                                    col.totalAggreText = '';
                                    col.totalAggre = 0;
                                    col.level = 1;
                                    col.childList = [];
                                    col.dimension = 0;
                                    col.rowColor = null;
                                }));
                                this.formData = newValue;
                                this.ngOnDestroy();
                                this.afterView();
                                break;
                            case 'groupType':
                                this.groupType = newValue;
                                break;
                            case 'queryId':
                                this.queryId = newValue;
                                common$1.QDPCacheUtil.setCache(this.tabId + this.queryId + this.controlType + 'qdpview', this);
                                break;
                            case 'controlType':
                                this.controlType = newValue;
                                break;
                            case 'qoId':
                                this.qoId = newValue;
                                ServicesUtils.setServices(this.tabId + 'qoId', this.qoId);
                                break;
                            case 'qoManagerCode':
                            case 'voId':
                            case 'queryRelativeUrl':
                            case 'templateType':
                                break;
                            case 'multiSheets':
                                this.multiSheets = newValue;
                                this.setGroup(this.multiSheets[0]);
                                break;
                            case 'licenseKey':
                                if (newValue) {
                                    GC.Spread.Sheets.LicenseKey = newValue;
                                }
                                break;
                            case 'isCommonQdpViewComponent':
                                this.isCommonQdpViewComponent = newValue;
                                if (this.isCommonQdpViewComponent) ;
                                break;
                            default:
                                options.push({ name: changeName, value: newValue });
                        }
                    }
                }
                this.spreadOptions = options;
                this.setSpreadOptions();
            };
        /**
         * @return {?}
         */
        QdpViewComponent.prototype.ngOnDestroy = /**
         * @return {?}
         */
            function () {
                if (this.spread) {
                    this.spread.destroy();
                }
            };
        /**
         * @param {?} event
         * @return {?}
         */
        QdpViewComponent.prototype.onResized = /**
         * @param {?} event
         * @return {?}
         */
            function (event) {
                this.style.height = event.newHeight + 'px';
                this.style.width = event.newWidth + 'px';
            };
        /**
         * @return {?}
         */
        QdpViewComponent.prototype.toggle = /**
         * @return {?}
         */
            function () {
                var _this = this;
                /** @type {?} */
                var isCompare = false;
                if (this.isOpen) {
                    if (this.controlType === 'crosstab') {
                        this.dimensionSettingComponent.isCompare = false;
                        this.dimensionSettingComponent.selectedDimesion();
                        isCompare = this.dimensionSettingComponent.isCompare;
                    }
                    else {
                        this.columnsSettingComponent.isCompare = false;
                        this.columnsSettingComponent.selectedDimesion();
                        isCompare = this.columnsSettingComponent.isCompare;
                    }
                    if (this.schemaValue && this.schemaValue.isPrefab !== 1 && !isCompare) {
                        this.schemaValue.schemaValue = this.controlType === 'crosstab' ? JSON.stringify(this.dimensionSettingComponent.schemaValue.schemaValue) : JSON.stringify(this.columnsSettingComponent.schemaValue.schemaValue);
                        this.schemaManager.saveSchema({ 'schema': JSON.stringify(this.schemaValue), groupType: this.groupType }, '').subscribe(( /**
                         * @return {?}
                         */function () { }), ( /**
                         * @param {?} error
                         * @return {?}
                         */function (error) {
                            _this.formErrorService.exception(error.Message, error);
                        }));
                        this.schemaValue.schemaValue = JSON.parse(this.schemaValue.schemaValue);
                    }
                }
                this.isOpen = !this.isOpen;
            };
        /**
         * @param {?} sheetName
         * @return {?}
         */
        QdpViewComponent.prototype.setGroup = /**
         * @param {?} sheetName
         * @return {?}
         */
            function (sheetName) {
                this.curSheet = sheetName;
                if (this.groupType) {
                    for (var i = 0; i < this.multiSheets.length; i++) {
                        this.groupType = this.groupType.replace(this.multiSheets[i], "");
                    }
                    this.groupType += sheetName;
                }
                else {
                    this.groupType = sheetName;
                }
                this.sheetChanged.next(this.groupType);
            };
        /**
         * @private
         * @param {?} e
         * @return {?}
         */
        QdpViewComponent.prototype.onDocumentClick = /**
         * @private
         * @param {?} e
         * @return {?}
         */
            function (e) {
                if (e.target.tagName === 'CANVAS') {
                    this.isOpen = false;
                }
            };
        /**
         * @param {?} pageIndex
         * @param {?} pageSize
         * @return {?}
         */
        QdpViewComponent.prototype.handleCrosstabPageChange = /**
         * @param {?} pageIndex
         * @param {?} pageSize
         * @return {?}
         */
            function (pageIndex, pageSize) {
                this.sheet = this.spread.getActiveSheet();
                for (var i = 0; i < this.sheet.getRowCount(); i++) {
                    if (i >= (pageIndex - 1) * pageSize && i < pageIndex * pageSize) {
                        this.sheet.setRowVisible(i, true, GC.Spread.Sheets.SheetArea.viewport);
                        this.sheet.showRow(i, GC.Spread.Sheets.VerticalPosition.bottom);
                    }
                    else {
                        this.sheet.setRowVisible(i, false, GC.Spread.Sheets.SheetArea.viewport);
                    }
                }
            };
        /**
         * @param {?} $event
         * @return {?}
         */
        QdpViewComponent.prototype.handleContextMenu = /**
         * @param {?} $event
         * @return {?}
         */
            function ($event) {
                if ('list' === this.controlType.toLowerCase()) {
                    /** @type {?} */
                    var x = 0;
                    /** @type {?} */
                    var y = 0;
                    /** @type {?} */
                    var qdpviewNative = this.sheetEl.nativeElement;
                    while (qdpviewNative) {
                        x += qdpviewNative.offsetLeft;
                        y += qdpviewNative.offsetTop;
                        qdpviewNative = qdpviewNative.offsetParent;
                    }
                    /** @type {?} */
                    var activeSheet = this.spread.getActiveSheet();
                    /** @type {?} */
                    var colHeader = GC.Spread.Sheets.SheetArea.colHeader;
                    /** @type {?} */
                    var target = activeSheet.hitTest($event.clientX - x, $event.clientY - y);
                    if (target.hitTestType !== colHeader || target.col === undefined || target.row === undefined) {
                        return false;
                    }
                    /** @type {?} */
                    var headerRowCount = activeSheet.getRowCount(colHeader);
                    /** @type {?} */
                    var span = activeSheet.getSpan(target.row, target.col, colHeader);
                    // 判断多级表头的情况下，只处理最子集表头
                    if (span && (target.row + span.rowCount) < headerRowCount) {
                        return false;
                    }
                    this.currentColIndex = target.col;
                    this.initColGroupAggre(this.currentColIndex);
                    this.headerMenuDisplay = 'block';
                    this.headerMenuTop = $event.clientY;
                    this.headerMenuLeft = $event.clientX;
                }
                return false;
            };
        /**
         * @return {?}
         */
        QdpViewComponent.prototype.handleIsGroupClick = /**
         * @return {?}
         */
            function () {
                if (this.colIsGroup) {
                    this.groupSelectValue = this.aggreData[0].value;
                    this.groupText = '';
                }
            };
        /**
         * @return {?}
         */
        QdpViewComponent.prototype.handleSaveClick = /**
         * @return {?}
         */
            function () {
                var _this = this;
                /** @type {?} */
                var self = this;
                try {
                    if (this.schemaValue && this.schemaValue.schemaValue && this.schemaValue.schemaValue.columnOption && this.schemaValue.schemaValue.columnOption.colList) {
                        if (this.schemaValue && this.schemaValue.isPrefab === 1) {
                            this.msgService.info(this.localizeService.getValue('spread.message.validate.sort'));
                            return;
                        }
                        /** @type {?} */
                        var colList = JSON.parse(JSON.stringify(this.schemaValue.schemaValue.columnOption.colList));
                        /** @type {?} */
                        var params = { index: this.currentColIndex, colIndex: 0, type: 'edit' };
                        // tslint:disable-next-line:prefer-for-of
                        for (var i = 0; i < colList.length; i++) {
                            this.recursiveColumnSort(colList[i], null, params);
                        }
                        this.schemaValue.schemaValue.columnOption.colList = colList;
                        this.schemaValue.schemaValue = JSON.stringify(this.schemaValue.schemaValue);
                        this.schemaManager.saveSchema({ schema: JSON.stringify(this.schemaValue), groupType: this.groupType }, '').subscribe(( /**
                         * @param {?} data
                         * @return {?}
                         */function (data) {
                            self.initQdpView();
                            self.currentColIndex = 0;
                            self.headerMenuDisplay = 'none';
                        }), ( /**
                         * @param {?} error
                         * @return {?}
                         */function (error) {
                            _this.formErrorService.exception(error.Message, error);
                        }));
                    }
                }
                catch (e) {
                    self.currentColIndex = 0;
                }
            };
        /**
         * @return {?}
         */
        QdpViewComponent.prototype.handleClearSort = /**
         * @return {?}
         */
            function () {
                var _this = this;
                /** @type {?} */
                var self = this;
                try {
                    if (this.schemaValue && this.schemaValue.schemaValue && this.schemaValue.schemaValue.columnOption && this.schemaValue.schemaValue.columnOption.colList && this.schemaValue.schemaValue.columnOption.colList.length) {
                        if (this.schemaValue && this.schemaValue.isPrefab === 1) {
                            this.msgService.info(this.localizeService.getValue('spread.message.validate.sort'));
                            return;
                        }
                        /** @type {?} */
                        var colList = JSON.parse(JSON.stringify(this.schemaValue.schemaValue.columnOption.colList));
                        // tslint:disable-next-line:prefer-for-of
                        for (var i = 0; i < colList.length; i++) {
                            this.recursiveClearColumnSort(colList[i], null);
                        }
                        this.schemaValue.schemaValue.columnOption.colList = colList;
                        this.schemaValue.schemaValue = JSON.stringify(this.schemaValue.schemaValue);
                        this.schemaManager.saveSchema({ schema: JSON.stringify(this.schemaValue), groupType: this.groupType }, '').subscribe(( /**
                         * @param {?} data
                         * @return {?}
                         */function (data) {
                            /** @type {?} */
                            var renderOption = Object.assign({ multiSheetsSchemaIds: _this.multiSheetsSchemaIds, curSheet: _this.curSheet, multiSheets: _this.multiSheets }, { schemaId: _this.schemaValue.id, queryId: self.queryId, controlType: self.controlType, qoManagerCode: self.qoManagerCode, pageIndex: 0, queryRelativeUrl: self.queryRelativeUrl, filterCondition: self.conditionExpression, groupType: self.groupType, voId: self.voId, jointsearchInfoList: self.jointsearchInfoList });
                            self.qdpViewRender(renderOption);
                            self.currentColIndex = 0;
                            self.headerMenuDisplay = 'none';
                        }), ( /**
                         * @param {?} error
                         * @return {?}
                         */function (error) {
                            _this.formErrorService.exception(error.Message, error);
                        }));
                    }
                }
                catch (e) {
                    self.currentColIndex = 0;
                }
            };
        // @HostListener('click')
        // @HostListener('click')
        /**
         * @param {?} $event
         * @return {?}
         */
        QdpViewComponent.prototype.handleBlur =
            // @HostListener('click')
            /**
             * @param {?} $event
             * @return {?}
             */
            function ($event) {
                this.headerMenuDisplay = 'none';
            };
        /**
         * @private
         * @param {?} index
         * @return {?}
         */
        QdpViewComponent.prototype.initColGroupAggre = /**
         * @private
         * @param {?} index
         * @return {?}
         */
            function (index) {
                if (this.schemaValue && this.schemaValue.schemaValue && this.schemaValue.schemaValue.columnOption
                    && this.schemaValue.schemaValue.columnOption.colList && this.schemaValue.schemaValue.columnOption.colList.length > index) {
                    /** @type {?} */
                    var params = { index: this.currentColIndex, colIndex: 0, type: 'init' };
                    // tslint:disable-next-line:prefer-for-of
                    for (var i = 0; i < this.schemaValue.schemaValue.columnOption.colList.length; i++) {
                        this.recursiveColumnSort(this.schemaValue.schemaValue.columnOption.colList[i], null, params);
                    }
                }
            };
        /**
         * @private
         * @param {?} col
         * @param {?} colList
         * @param {?} params
         * @return {?}
         */
        QdpViewComponent.prototype.recursiveColumnSort = /**
         * @private
         * @param {?} col
         * @param {?} colList
         * @param {?} params
         * @return {?}
         */
            function (col, colList, params) {
                if (colList == null) {
                    if (col.childList && col.childList.length) {
                        this.recursiveColumnSort(null, col.childList, params);
                    }
                    else {
                        if (params.colIndex === params.index) {
                            if (params.type === 'init') {
                                this.colIsGroup = col.isGroup;
                                this.groupText = col.groupAggreText || '';
                                this.groupSelectValue = col.groupAggre;
                            }
                            else if (params.type === 'edit') {
                                col.isGroup = this.colIsGroup;
                                col.groupAggreText = this.groupText || '';
                                col.groupAggre = this.groupSelectValue;
                            }
                        }
                        params.colIndex++;
                    }
                }
                else {
                    // tslint:disable-next-line:prefer-for-of
                    for (var i = 0; i < colList.length; i++) {
                        if (colList[i].childList && colList[i].childList.length) {
                            this.recursiveColumnSort(null, colList[i].childList, params);
                        }
                        else {
                            if (params.colIndex === params.index) {
                                if (params.type === 'init') {
                                    this.colIsGroup = colList[i].isGroup;
                                    this.groupText = colList[i].groupAggreText || '';
                                    this.groupSelectValue = colList[i].groupAggre;
                                }
                                else if (params.type === 'edit') {
                                    colList[i].isGroup = this.colIsGroup;
                                    colList[i].groupAggreText = this.groupText || '';
                                    colList[i].groupAggre = this.groupSelectValue;
                                }
                            }
                            params.colIndex++;
                        }
                    }
                }
            };
        /**
         * @private
         * @param {?} col
         * @param {?} colList
         * @return {?}
         */
        QdpViewComponent.prototype.recursiveClearColumnSort = /**
         * @private
         * @param {?} col
         * @param {?} colList
         * @return {?}
         */
            function (col, colList) {
                if (colList == null) {
                    if (col.childList && col.childList.length) {
                        this.recursiveClearColumnSort(null, col.childList);
                    }
                    else {
                        col['sort'] = 0;
                        col['sortIndex'] = 0;
                    }
                }
                else {
                    // tslint:disable-next-line:prefer-for-of
                    for (var i = 0; i < colList.length; i++) {
                        if (colList[i].childList && colList[i].childList.length) {
                            this.recursiveClearColumnSort(null, colList[i].childList);
                        }
                        else {
                            colList[i]['sort'] = 0;
                            colList[i]['sortIndex'] = 0;
                        }
                    }
                }
            };
        /**
         * @private
         * @return {?}
         */
        QdpViewComponent.prototype.registeSpreadColumnWidthChangedEvent = /**
         * @private
         * @return {?}
         */
            function () {
                /** @type {?} */
                var self = this;
                this.sheet = this.spread.getActiveSheet();
                self.sheet.bind(GC.Spread.Sheets.Events.ColumnWidthChanged, ( /**
                 * @param {?} sender
                 * @param {?} info
                 * @return {?}
                 */function (sender, info) {
                    /** @type {?} */
                    var index = info.colList[0];
                    /** @type {?} */
                    var colW = info.sheet.getColumnWidth(info.colList[0]);
                    if (self.schemaValue && self.schemaValue.schemaValue && self.schemaValue.schemaValue.columnOption
                        && self.schemaValue.schemaValue.columnOption.colList && self.schemaValue.schemaValue.columnOption.colList.length) {
                        if (self.schemaValue && self.schemaValue.isPrefab === 1) {
                            self.msgService.info(self.localizeService.getValue('spread.message.validate.sort'));
                            return;
                        }
                        /** @type {?} */
                        var colList = JSON.parse(JSON.stringify(self.schemaValue.schemaValue.columnOption.colList));
                        /** @type {?} */
                        var params = { index: index, colIndex: 0, colWidth: colW };
                        // tslint:disable-next-line:prefer-for-of
                        for (var i = 0; i < colList.length; i++) {
                            self.recursiveColumnWidthChanged(colList[i], null, params);
                        }
                        self.schemaValue.schemaValue.columnOption.colList = colList;
                        self.schemaValue.schemaValue = JSON.stringify(self.schemaValue.schemaValue);
                        self.schemaManager.saveSchema({ schema: JSON.stringify(self.schemaValue), groupType: this.groupType }, '').subscribe(( /**
                         * @param {?} data
                         * @return {?}
                         */function (data) {
                            self.schemaValue.schemaValue = JSON.parse(self.schemaValue.schemaValue);
                        }), ( /**
                         * @param {?} error
                         * @return {?}
                         */function (error) {
                            self.formErrorService.exception(error.Message, error);
                        }));
                    }
                }));
            };
        /**
         * @private
         * @param {?} col
         * @param {?} colList
         * @param {?} params
         * @return {?}
         */
        QdpViewComponent.prototype.recursiveColumnWidthChanged = /**
         * @private
         * @param {?} col
         * @param {?} colList
         * @param {?} params
         * @return {?}
         */
            function (col, colList, params) {
                if (colList == null) {
                    if (col.childList && col.childList.length) {
                        this.recursiveColumnWidthChanged(null, col.childList, params);
                    }
                    else {
                        if (params.colIndex === params.index) {
                            col.colWidth = params.colWidth;
                        }
                        params.colIndex++;
                    }
                }
                else {
                    // tslint:disable-next-line:prefer-for-of
                    for (var i = 0; i < colList.length; i++) {
                        if (colList[i].childList && colList[i].childList.length) {
                            this.recursiveColumnWidthChanged(null, colList[i].childList, params);
                        }
                        else {
                            if (params.colIndex === params.index) {
                                colList[i].colWidth = params.colWidth;
                            }
                            params.colIndex++;
                        }
                    }
                }
            };
        QdpViewComponent.decorators = [
            { type: core.Component, args: [{
                        selector: 'qdp-view',
                        template: "<div *ngIf=\"isShowDimension\" #crosstab class=\"f-cmp-sidebar f-sidebar-slide  f-sidebar-pos-right\"\r\n  [ngClass]=\"{'f-sidebar-show': isOpen, 'f-sidebar-collapse': !isOpen }\">\r\n  <div class=\"f-sidebar-main\">\r\n    <div class=\"f-sidebar-header-ctr ng-star-inserted border mb-2\">\r\n      <h5 class=\"f-sidebar-header-title\">{{localizeService.getValue('spread.crossTable.dimensionManager')}}</h5>\r\n      <span id=\"dimensionClose\" (click)=\"toggle()\">\r\n        <img src=\"data:image/svg+xml;charset=utf-8;base64,PHN2ZyB3aWR0aD0nMTRweCcgaGVpZ2h0PScxNHB4JyB2aWV3Qm94PScwIDAgMTQgMTQnIHZlcnNpb249JzEuMScgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB4bWxuczp4bGluaz0naHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayc+PHRpdGxlPuW9oueKtue7k+WQiDwvdGl0bGU+PGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+PGcgaWQ9J+mhtemdoi0xJyBzdHJva2U9J25vbmUnIHN0cm9rZS13aWR0aD0nMScgZmlsbD0nbm9uZScgZmlsbC1ydWxlPSdldmVub2RkJyBzdHJva2UtbGluZWNhcD0ncm91bmQnPjxnIGlkPScwMi3mn6Xor6JVSeiuvuiuoScgdHJhbnNmb3JtPSd0cmFuc2xhdGUoLTEzMjUuMDAwMDAwLCAtOTUuMDAwMDAwKScgc3Ryb2tlPScjMkQyRjMzJyBzdHJva2Utd2lkdGg9JzEuNCc+PGcgaWQ9J+e8lue7hC0yNicgdHJhbnNmb3JtPSd0cmFuc2xhdGUoODk4LjAwMDAwMCwgNzUuMDAwMDAwKSc+PGcgaWQ9J+e8lue7hC0yNScgdHJhbnNmb3JtPSd0cmFuc2xhdGUoNDIwLjAwMDAwMCwgMTMuMDAwMDAwKSc+PHBhdGggZD0nTTE0LDE0IEw4LDggTDE0LDE0IEw4LDIwIEwxNCwxNCBaIE0xNCwxNCBMMjAsMjAgTDE0LDE0IEwyMCw4IEwxNCwxNCBaJyBpZD0n5b2i54q257uT5ZCIJz48L3BhdGg+PC9nPjwvZz48L2c+PC9nPjwvc3ZnPg==\" style=\"width: 16px; height: 16px; display: block;\" />\r\n      </span>\r\n    </div>\r\n    <div class=\"container f-utils-fill-flex-column\">\r\n      <dimension-setting class=\"h-100\"  *ngIf=\"controlType=='crosstab'\"\r\n        [controlType]=\"controlType\" \r\n        [queryRelativeUrl]=\"queryRelativeUrl\"\r\n        [qoManagerCode]=\"qoManagerCode\"\r\n        [queryId]=\"queryId\"\r\n        [qoId]=\"qoId\"\r\n        [voId]=\"voId\"\r\n        [groupType]=\"groupType\"\r\n        [spread]=\"spread\"\r\n        [conditionExpression]=\"conditionExpression\"\r\n        [jointsearchInfoList]=\"jointsearchInfoList\"\r\n        [qdpView]=\"this\"\r\n      ></dimension-setting>\r\n      <columns-setting class=\"h-100\"  *ngIf=\"controlType!='crosstab'\"\r\n        [controlType]=\"controlType\" \r\n        [queryRelativeUrl]=\"queryRelativeUrl\"\r\n        [qoManagerCode]=\"qoManagerCode\"\r\n        [queryId]=\"queryId\"\r\n        [qoId]=\"qoId\"\r\n        [voId]=\"voId\"\r\n        [groupType]=\"groupType\"\r\n        [spread]=\"spread\"\r\n        [conditionExpression]=\"conditionExpression\"\r\n        [jointsearchInfoList]=\"jointsearchInfoList\"\r\n        [qdpView]=\"this\"\r\n      ></columns-setting>\r\n    </div>\r\n  </div>\r\n  <div class=\"f-sidebar-entry-ctr\">\r\n    <div class=\"f-sidebar-entry-icon ng-star-inserted\"><span class=\"f-icon f-sidebar-entry\" (click)=\"toggle()\"></span>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<div #sheet id='sheet' [ngStyle]=\"style\" [ngClass]=\"hostClass\" class=\"flex-fill qdp-overflow-hidden ml-3 mr-3 border\"\r\n  (resized)=\"onResized($event)\" (contextmenu)=\"handleContextMenu($event)\" (click)=\"handleBlur($event)\">\r\n</div>\r\n\r\n<div class=\"dropdown-menu headerMenu\" *ngIf=\"controlType!='crosstab' && controlType!='charts'\"\r\n  [style.left.px]=\"headerMenuLeft\" [style.top.px]=\"headerMenuTop\" [style.display]=\"headerMenuDisplay\">\r\n  <div class=\"flex-fill farris-split-section farris-overflow-hidden\">\r\n    <div class=\"farris-form farris-card-content-bg\">\r\n      <div class=\"col-12 col-md-12 col-lg-12\">\r\n        <div class=\"farris-group-wrap\" [class.form-inline]=\"formInline\" [class.farris-form-inline]=\"formInline\">\r\n          <div class=\"form-group farris-form-group\">\r\n            <label class=\"col-form-label\" for=\"{{colIsGroupId}}\">\r\n              <span\r\n                class=\"farris-label-text\">{{localizeService.getValue('ideCmp.schemaManager.columnOption.group')}}:</span>\r\n            </label>\r\n            <div class=\"farris-input-wrap farris-checkradio-hor\">\r\n              <div class=\"custom-control custom-checkbox mb-0\">\r\n                <input type=\"checkbox\" [(ngModel)]=\"colIsGroup\" class=\"custom-control-input\" id=\"{{colIsGroupId}}\"\r\n                  checked=\"\">\r\n                <label class=\"custom-control-label\" for=\"{{colIsGroupId}}\" (click)=\"handleIsGroupClick()\"></label>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div class=\"col-12 col-md-12 col-lg-12\">\r\n        <div class=\"farris-group-wrap\" [class.form-inline]=\"formInline\" [class.farris-form-inline]=\"formInline\">\r\n          <div class=\"form-group farris-form-group\">\r\n            <label class=\"col-form-label\" for=\"colGroupText\">\r\n              <span\r\n                class=\"farris-label-text\">{{localizeService.getValue('ideCmp.schemaManager.columnOption.groupTotal')}}:</span>\r\n            </label>\r\n            <div class=\"farris-input-wrap\">\r\n              <input-group [(ngModel)]=\"groupText\" id=\"colGroupText\"></input-group>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div class=\"col-12 col-md-12 col-lg-12\">\r\n        <div class=\"farris-group-wrap\" [class.form-inline]=\"formInline\" [class.farris-form-inline]=\"formInline\">\r\n          <div class=\"form-group farris-form-group\">\r\n            <label class=\"col-form-label\" for=\"colGroupAggre\">\r\n              <span\r\n                class=\"farris-label-text\">{{localizeService.getValue('ideCmp.schemaManager.columnOption.totalType')}}:</span>\r\n            </label>\r\n            <div class=\"farris-input-wrap\">\r\n              <farris-combo-list id=\"colGroupAggre\" [disabled]=\"colIsGroup\" [(ngModel)]=\"groupSelectValue\"\r\n                [data]=\"aggreData\" [textField]=\"'name'\" [idField]=\"'value'\" [enableClear]=\"false\"></farris-combo-list>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div class=\"col-12 col-md-12 col-lg-12\">\r\n        <button class=\"btn btn-primary mr-1\" id=\"button-edit\" (click)=\"handleSaveClick()\">\r\n          {{localizeService.getValue('ideCmp.schemaManager.btnSave')}}</button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n",
                        styles: [".qdp-overflow-hidden{overflow:hidden!important}.simpleDemo ul{min-height:42px;padding:0}.card-title,.demo-header{text-align:center}.title{margin:20px 0}.simpleDemo ul .dndDraggingSource{display:none}.simpleDemo ul .dndPlaceholder{background:rgba(56,143,255,.06);border:1px dashed #388fff;box-shadow:0 0 4px 0 rgba(13,95,201,.22);margin:.25rem!important;padding:.25rem!important}.simpleDemo ul li{background:rgba(235,244,254,.84);border:1px solid #388fff;box-shadow:0 0 10px 0 rgba(63,113,177,.22);border-radius:3px;height:28px;font-family:PingFangSC-Regular;font-size:13px;color:#388fff;margin:.25rem!important;padding:.25rem!important}#unselectFieldList li{border:none;background-color:rgba(0,0,0,0);box-shadow:0 0 #000;border-radius:3px;height:28px;margin:.25rem!important;padding:.25rem!important}#unselectFieldList li:hover{background:#f4f5f9}#unselectFieldList .dndPlaceholder{background:rgba(56,143,255,.06);border:1px dashed #388fff;box-shadow:0 0 4px 0 rgba(13,95,201,.22);margin:.25rem!important;padding:.25rem!important}.unselectField{font-family:PingFangSC-Regular;font-size:13px;color:rgba(0,0,0,.85)}.unselectFieldFront{font-family:PingFangSC-Medium;font-size:13px;color:#b4bccc}.simpleDemo ul li.selected{background-color:#dff0d8;color:#3c763d}.current-model{background-color:#f5f5f5;border:1px solid #ccc;border-radius:4px;padding:18px 22px}.slicer{height:220px;position:relative}.headerMenu{position:fixed;display:none;top:0;left:0}.cardTitle{background:#f5f7fa;border-radius:3px 3px 0 0;height:36px}.dimensionTitle{font-family:PingFangSC-Medium;font-size:14px;color:rgba(0,0,0,.65);line-height:20px}.imgFont{font-family:PingFangSC-Regular;font-size:13px;color:#b4bccc}"]
                    }] }
        ];
        /** @nocollapse */
        QdpViewComponent.ctorParameters = function () {
            return [
                { type: core.ElementRef, decorators: [{ type: core.Inject, args: [core.ElementRef,] }] },
                { type: RenderService },
                { type: core.Renderer2 },
                { type: common$1.FilterManagerService },
                { type: core.Injector, decorators: [{ type: core.Optional }] }
            ];
        };
        QdpViewComponent.propDecorators = {
            sheetEl: [{ type: core.ViewChild, args: ['sheet', { read: core.ElementRef },] }],
            dimensionSettingComponent: [{ type: core.ViewChild, args: [DimensionSettingComponent,] }],
            columnsSettingComponent: [{ type: core.ViewChild, args: [ColumnsSettingComponent,] }],
            isInitQdpView: [{ type: core.Input }],
            isShowDimension: [{ type: core.Input }],
            cls: [{ type: core.HostBinding, args: ['class.f-utils-fill-flex-column',] }],
            isCommonQdpViewComponent: [{ type: core.Input }],
            allowUserDragDrop: [{ type: core.Input }],
            allowUserDragFill: [{ type: core.Input }],
            allowUserZoom: [{ type: core.Input }],
            allowUserResize: [{ type: core.Input }],
            showHorizontalScrollbar: [{ type: core.Input }],
            showVerticalScrollbar: [{ type: core.Input }],
            tabStripVisible: [{ type: core.Input }],
            allowUndo: [{ type: core.Input }],
            allowSheetReorder: [{ type: core.Input }],
            allowCopyPasteExcelStyle: [{ type: core.Input }],
            allowExtendPasteRange: [{ type: core.Input }],
            copyPasteHeaderOptions: [{ type: core.Input }],
            showDragFillSmartTag: [{ type: core.Input }],
            scrollbarShowMax: [{ type: core.Input }],
            scrollbarMaxAlign: [{ type: core.Input }],
            tabEditable: [{ type: core.Input }],
            newTabVisible: [{ type: core.Input }],
            tabNavigationVisible: [{ type: core.Input }],
            backColor: [{ type: core.Input }],
            backgroundImage: [{ type: core.Input }],
            backgroundImageLayout: [{ type: core.Input }],
            grayAreaBackColor: [{ type: core.Input }],
            showResizeTip: [{ type: core.Input }],
            showDragDropTip: [{ type: core.Input }],
            showDragFillTip: [{ type: core.Input }],
            showScrollTip: [{ type: core.Input }],
            highlightInvalidData: [{ type: core.Input }],
            useTouchLayout: [{ type: core.Input }],
            hideSelection: [{ type: core.Input }],
            allowUserEditFormula: [{ type: core.Input }],
            enableFormulaTextbox: [{ type: core.Input }],
            autoFitType: [{ type: core.Input }],
            referenceStyle: [{ type: core.Input }],
            hostStyle: [{ type: core.Input }],
            hostClass: [{ type: core.Input }],
            name: [{ type: core.Input }],
            queryId: [{ type: core.Input }],
            controlType: [{ type: core.Input }],
            licenseKey: [{ type: core.Input }],
            qoManagerCode: [{ type: core.Input }],
            queryRelativeUrl: [{ type: core.Input }],
            qoId: [{ type: core.Input }],
            voId: [{ type: core.Input }],
            groupType: [{ type: core.Input }],
            templateType: [{ type: core.Input }],
            multiSheets: [{ type: core.Input }],
            formData: [{ type: core.Input }]
        };
        return QdpViewComponent;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
     */
    var SpreadModule = /** @class */ (function () {
        function SpreadModule() {
        }
        /**
         * @return {?}
         */
        SpreadModule.forRoot = /**
         * @return {?}
         */
            function () {
                return {
                    ngModule: SpreadModule,
                    providers: [
                        RenderService
                    ]
                };
            };
        SpreadModule.decorators = [
            { type: core.NgModule, args: [{
                        imports: [
                            common.CommonModule,
                            uiLoading.LoadingModule.forRoot({
                                message: 'Loading...'
                            }),
                            common$1.DndListModule,
                            forms.FormsModule,
                            forms.ReactiveFormsModule,
                            uiComboList.ComboListModule,
                            uiInputGroup.InputGroupModule,
                            uiDropdown.FDropdownDirectiveTypeModule,
                        ],
                        declarations: [
                            QdpViewComponent,
                            ColumnsSettingComponent,
                            DimensionSettingComponent,
                            DimensionSettingComponent
                        ],
                        exports: [
                            QdpViewComponent,
                            ColumnsSettingComponent,
                        ]
                    },] }
        ];
        return SpreadModule;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
     */

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
     */

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
     */

    exports.QdpViewComponent = QdpViewComponent;
    exports.ColumnsSettingComponent = ColumnsSettingComponent;
    exports.DimensionSettingComponent = DimensionSettingComponent;
    exports.RenderService = RenderService;
    exports.ServicesUtils = ServicesUtils;
    exports.ParameterUtils = ParameterUtils;
    exports.RenderExtendsUtils = RenderExtendsUtils;
    exports.SchemaUtils = SchemaUtils;
    exports.SpreadStyleUtils = SpreadStyleUtils;
    exports.SpreadModule = SpreadModule;

    Object.defineProperty(exports, '__esModule', { value: true });

})));

//# sourceMappingURL=qdp-spread.umd.js.map