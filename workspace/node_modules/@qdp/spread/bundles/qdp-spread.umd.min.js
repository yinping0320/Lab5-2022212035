!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@farris/ui-notify"),require("@gsp-svc/cloudprint"),require("rxjs/operators"),require("@farris/ui-messager"),require("@qdp/localize"),require("lodash-es"),require("@farris/command-services"),require("@ecp-caf/caf-common"),require("rxjs"),require("@angular/core"),require("@angular/common"),require("@farris/ui-loading"),require("@angular/forms"),require("@farris/ui-input-group"),require("@farris/ui-dropdown"),require("@qdp/common"),require("@farris/ui-combo-list")):"function"==typeof define&&define.amd?define("@qdp/spread",["exports","@farris/ui-notify","@gsp-svc/cloudprint","rxjs/operators","@farris/ui-messager","@qdp/localize","lodash-es","@farris/command-services","@ecp-caf/caf-common","rxjs","@angular/core","@angular/common","@farris/ui-loading","@angular/forms","@farris/ui-input-group","@farris/ui-dropdown","@qdp/common","@farris/ui-combo-list"],t):t((e.qdp=e.qdp||{},e.qdp.spread={}),e.uiNotify,e.cloudprint,e.rxjs.operators,e.uiMessager,e.localize,e.lodashEs,e.commandServices,e.cafCommon,e.rxjs,e.ng.core,e.ng.common,e.uiLoading,e.ng.forms,e.uiInputGroup,e.uiDropdown,e.common$1,e.uiComboList)}(this,function(e,o,c,i,a,d,w,u,r,l,h,t,p,n,s,g,b,m){"use strict";var y=function(){function i(){}return i.setServices=function(e,t){i.ServicesMap.set(e,t)},i.getServices=function(e){return i.ServicesMap.get(e)},i.ServicesMap=new Map,i}(),M=function(e,t){return(M=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)};function S(e,t){function i(){this.constructor=e}M(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}function f(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var n,s,a=i.call(e),r=[];try{for(;(void 0===t||0<t--)&&!(n=a.next()).done;)r.push(n.value)}catch(l){s={error:l}}finally{try{n&&!n.done&&(i=a["return"])&&i.call(a)}finally{if(s)throw s.error}}return r}function v(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(f(arguments[t]));return e}var I=function(){function e(e,t,i){this.queryId=e,this.funcInfoCache=t,this.cache=i.cacheService}return e.prototype.createParameters=function(e){var t,i=this.bindCloseTabEvent(),n={entityData:t=this.cache.get(i)?JSON.stringify(this.cache.get(i)):this.cache.get(e.queryId)?JSON.stringify(this.cache.get(e.queryId)):JSON.stringify({id:"undefined_null"}),extendCond:this.cache.get(i+"extendCond")?this.cache.get(i+"extendCond"):e.extendCond,pageIndex:e.pageIndex?e.pageIndex:0,pageSize:e.pageSize?e.pageSize:0,schemaId:e.schemaId&&"prefab"!==e.schemaId?e.schemaId:"1",filterCond:e.filterCondition?e.filterCondition:this.cache.get(i+"filtercondition")?this.cache.get(i+"filtercondition"):"",qoManagerCode:e.qoManagerCode?e.qoManagerCode:"",voCode:e.voId?e.voId:""};try{var s=JSON.parse(t);if(s.hasOwnProperty("@filterExpressionString@")){var a=n&&n.filterCond?JSON.parse(n.filterCond):null;if(a){var r=JSON.parse(s["@filterExpressionString@"]);r.expressItems=r.expressItems.concat(a.expressItems),n.filterCond=JSON.stringify(r)}else n.filterCond=s["@filterExpressionString@"]}}catch(l){}return e.controlType&&(n.controlType=e.controlType),e.excelExportName&&(n.excelExportName=e.excelExportName),e.printIntegration&&(n.printIntegration=e.printIntegration?JSON.stringify(e.printIntegration):""),e.multiSheets&&(n.multiSheets=e.multiSheets&&e.multiSheets.length?e.multiSheets.join(","):""),e.curSheet&&(n.curSheet=e.curSheet),e.multiSheetsSchemaIds&&(n.multiSheetsSchemaIds=e.multiSheetsSchemaIds?JSON.stringify(e.multiSheetsSchemaIds):""),e.groupType&&(n.groupType=e.groupType?e.groupType:""),e.queryId&&(n.queryId=e.queryId?e.queryId:""),b.RtfServices.getMenuParameter("enableQOExtends")&&(n.enableQOExtends=b.RtfServices.getMenuParameter("enableQOExtends"),n.qoId=y.getServices(b.RtfServices.getTabId(this.queryId)+"qoId")),n},e.prototype.bindCloseTabEvent=function(){try{var t=gspframeworkService.rtf.session.getCommonVariable();return gspframeworkService.rtf.frmEvent.eventListener("beforeFuncCloseEvent",this.clearParametersCache.bind(this),t),this.funcInfoCache.funcIds.findIndex(function(e){return e===t.tabId})<0&&this.funcInfoCache.funcIds.push(t.tabId),t.tabId+b.RtfServices.getInSuiteFrmUUID()}catch(e){}},e.prototype.clearParametersCache=function(){var t=arguments[0].tabId;this.queryId&&this.cache.set(this.queryId,""),this.cache.set(t,""),this.cache.set(t+"renderMode","");var e=this.funcInfoCache.funcIds.findIndex(function(e){return e===t});0<=e&&(this.funcInfoCache.funcIds.splice(e,1),0<=(e=this.funcInfoCache.firstLoadCache.findIndex(function(e){return e===t}))&&this.funcInfoCache.firstLoadCache.splice(e,1),gspframeworkService.rtf.func.close(arguments[0]))},e}(),D=function(){function e(e){this.init(e)}return e.prototype.init=function(e){this.dataRenderExtendService=y.getServices("dataRenderExtendService"+e),this.renderExtends=y.getServices("renderExtends"+e)},e.prototype.runRenderExtends=function(e,t,i,n){var s=this.createRenderExtendParams({eventCode:e,eventName:t,data:i,spread:n,control:n});return"beforeQueryData"===e?this.dataRenderExtendService&&this.dataRenderExtendService.beforeQueryData?this.dataRenderExtendService.beforeQueryData(s):this.renderExtends&&this.renderExtends.beforeQueryData&&this.renderExtends.beforeQueryData(s):"beforeLoadData"===e?this.dataRenderExtendService&&this.dataRenderExtendService.beforeLoadData?this.dataRenderExtendService.beforeLoadData(s):this.renderExtends&&this.renderExtends.beforeQueryData&&this.renderExtends.beforeLoadData(s):"afterLoadData"===e&&(this.dataRenderExtendService&&this.dataRenderExtendService.afterLoadData?this.dataRenderExtendService.afterLoadData(s):this.renderExtends&&this.renderExtends.beforeQueryData&&this.renderExtends.afterLoadData(s)),s.data},e.prototype.createRenderExtendParams=function(e){return{eventCode:e.eventCode,eventName:e.eventName,data:e.data,control:e.control,spread:e.spread||undefined}},e}(),C=function(){function e(e){this.init(e)}return e.prototype.init=function(e){this.schemaManager=e.schemaManagerService,this.cacheService=e.cacheService},e.prototype.getSchemaInfo=function(e){if(e.schemaId="prefab"===e.schemaId||"1"===e.schemaId?"1":e.schemaValue&&e.schemaValue.id&&"crosstab"===e.controlType?e.schemaValue.id:e.schemaId,e.schemaId){var t=this.cacheService.get(b.RtfServices.getTabId(e.queryId)+"organizationId")||"";return this.schemaManager.getSchema(e.schemaId,e.queryId,e.queryRelativeUrl,e.groupType,t,e.fromCache).pipe(i.switchMap(function(e){if(e&&e.id)return l.of(e)}))}return this.getDefaultSchemaInfo(e)},e.prototype.getDefaultSchemaInfo=function(e){var t=this.cacheService.get(b.RtfServices.getTabId(e.queryId)+"organizationId")||"";return this.schemaManager.getDefaultSchema(e.queryId,e.queryRelativeUrl,e.groupType,t)},e}(),x=function(){function e(e,t,i,n){this.dataStyleArray=[],this.dataRowHeightArray=[],this.dataColInfoArray=[],this.footerStyleArray=[],this.footerRowHeightArray=[],this.footerSpansArray=[],this.footerDataArray=[],this.hyperLinkQuery={},this.autoFitColumnIndex=0,this.valueHeaderRowCount=0,this.valueHeaderRowArray=[],this.rowHeadersColumnCount=0,this.rowHeaderRowArray=[],this.joinParam={},this.queryId=e,this.type=t,this.jointsearchInfoList=i,this.cache=n.cacheService,this.loadService=n.loadingService,this.msgService=n.msgService,this.localizeService=n.localizeService,this.schemaManager=n.schemaManagerService,this.formErrorService=n.formErrorService,this.lcpService=n.lcpService}return e.prototype.setAutoFitColumn=function(e,t){var i=this;e&&e.schemaValue&&e.schemaValue.columnOption&&e.schemaValue.columnOption.colList&&e.schemaValue.columnOption.colList.length&&(this.autoFitColumnIndex=0,e.schemaValue.columnOption.colList.forEach(function(e){i.recursionAutoFitColumn(e,null,t)}))},e.prototype.recursionAutoFitColumn=function(e,t,i){var n=this;e?e.childList&&e.childList.length?this.recursionAutoFitColumn(null,e.childList,i):(e.autoFit&&i.autoFitColumn(this.autoFitColumnIndex),this.autoFitColumnIndex+=1):t.forEach(function(e){e.childList&&e.childList.length?n.recursionAutoFitColumn(null,e.childList,i):(e.autoFit&&i.autoFitColumn(n.autoFitColumnIndex),n.autoFitColumnIndex+=1)})},e.prototype.cacheStyle=function(e){this.dataStyleArray=[],this.dataRowHeightArray=[],this.dataColInfoArray=[],this.footerStyleArray=[],this.footerRowHeightArray=[],this.footerSpansArray=[],this.footerDataArray=[];for(var t=0;t<e.getRowCount();t++){for(var i=new Array,n=new Array,s=0;s<e.getColumnCount();s++){if(0===t){var a="";e.getFormatter(t,s,GC.Spread.Sheets.SheetArea.viewport)&&(a=e.getFormatter(t,s,GC.Spread.Sheets.SheetArea.viewport));var r=e.getRowCount(GC.Spread.Sheets.SheetArea.colHeader),l={name:e.getCell(t,s,GC.Spread.Sheets.SheetArea.viewport).value(),size:e.getColumnWidth(s,GC.Spread.Sheets.SheetArea.viewport),visible:e.getColumnVisible(s,GC.Spread.Sheets.SheetArea.viewport),resizable:e.getColumnResizable(s,GC.Spread.Sheets.SheetArea.viewport),formatter:0<=a.indexOf("&")?new MyNumFormatter(a):a,displayName:e.getCell(r-1,s,GC.Spread.Sheets.SheetArea.colHeader).value()};this.dataColInfoArray.push(l)}var o=e.getStyle(t,s,GC.Spread.Sheets.SheetArea.viewport);null==o?(o=new GC.Spread.Sheets.Style).locked=!0:o.locked=!0,o&&o.formatter&&0<=o.formatter.indexOf("&")&&(o.formatter=new MyNumFormatter(o.formatter)),i.push(o);var c=e.getValue(t,s,GC.Spread.Sheets.SheetArea.viewport)||e.getText(t,s,GC.Spread.Sheets.SheetArea.viewport)||"";n.push(c)}0===t?(this.dataRowHeightArray.push(e.getRowHeight(t)),this.dataStyleArray.push(i)):(this.footerRowHeightArray.push(e.getRowHeight(t)),this.footerStyleArray.push(i),this.footerDataArray.push(n))}var d=e.getSpans();if(d&&d.length)for(var u=0;u<d.length;u++)0<d[u].row&&this.footerSpansArray.push(d[u]);e.deleteRows(1,e.getRowCount()-1)},e.prototype.applyStyle=function(c,e,d){var u=this,h=c.getRowCount(),p=c.getColumnCount(),t=this.footerRowHeightArray.length;c.addRows(h,t);var g=0,m=[],y=[],M=[],S={},f=c.toJSON().columns;this.getGroupField(m,e);var v=[];this.getFormatField(v,e),this.getIsRedColumns(v,e);var I={colIndex:0,isRedColumns:[]};this.getIsRedColumns(e,I);for(var D=c.toJSON().columns,i=function(r){v&&v.length&&r<h&&v.forEach(function(t){var e=c.getDataItem(r)[t.formatField]-0,i=t.formatter&&(0<=t.formatter.indexOf("#,###")||0<=t.formatter.indexOf("#,##0"))?"#,##0.":"0.";if(u.isNumber(e))for(var n=0;n<e;n++)i+="0";var s=D.findIndex(function(e){return e.name==t.sourceField});0<=s&&"0."!=i&&"#,##0."!=i&&c.getCell(r,s).formatter(i)});for(var e=function(t){if(0!==r||c.getColumnVisible(g)||(g+=1),h<=r)0===t&&(c.setStyle(r,t,C.footerStyleArray[r-h][t]),C.footerDataArray&&C.footerDataArray.length&&c.setValue(r,t,C.footerDataArray[r-h][t]),c.setRowHeight(r,C.footerRowHeightArray[r-h]),C.footerSpansArray&&C.footerSpansArray.length&&c.addSpan(r,C.footerSpansArray[0].col,C.footerSpansArray[0].rowCount,C.footerSpansArray[0].colCount));else{var e=c.getFormatter(r,t,GC.Spread.Sheets.SheetArea.viewport);if(e&&e.indexOf&&0<=e.indexOf("/")&&0<=e.indexOf(";")){var i=C.logicFormat(e,c.getValue(r,t));c.setText(r,t,i)}if(e&&"string"==typeof e&&(0<=e.indexOf("yy")||0<=e.indexOf("MM")||0<=e.indexOf("dd")||0<=e.indexOf("HH")||0<=e.indexOf("mm")||0<=e.indexOf("ss"))&&c.getDataItem(r).hasOwnProperty("qdp_data_flag")&&c.setFormatter(r,t,""),0<=I.isRedColumns.findIndex(function(e){return e.colIndex==t})&&C.isNumber(c.getCell(r,t).value())&&c.getCell(r,t).value()-0<0&&c.getCell(r,t).foreColor("red"),!d&&!d&&f&&f.length){if("treeLevel"===f[t].name||"isDetail"===f[t].name)return"continue";0!==c.getCell(r,t).value()&&"0"!=c.getCell(r,t).value()||c.getCell(r,t).value("")}}},t=0;t<p;t++)e(t);if(r<h)if(c.setRowHeight(r,C.dataRowHeightArray[0]),"treelist"===C.type){var i=c.getDataItem(r).treeLevel,n=c.getDataItem(r).isDetail;c.setCellType(r,g,new TreeCellType(null,!1,i,n)),c.getStyle(r,g).hAlign=0,c.getStyle(r,g).textIndent=i+2;for(var s=0;s<=i;s++)c.rowOutlines.group(r,1)}else if("list"===C.type&&m.length){var l={};if(0<=M.findIndex(function(e){return e===r}))return"continue";for(t=0;t<p;t++)c.getDataItem(r).hasOwnProperty("qdp_data_flag")&&c.getDataItem(r).qdp_data_flag+""=="4"&&c.getFormatter(r,t)&&(0<=c.getFormatter(r,t).toString().indexOf("y")||0<=c.getFormatter(r,t).toString().indexOf("d")||0<=c.getFormatter(r,t).toString().indexOf("M"))&&c.setFormatter(r,t,"");var o=[],a=function(t){var e=r+o.length,i=C.dataColInfoArray.findIndex(function(e){return e.name===m[t]});l={};for(var n=0;n<=t;n++)l[m[n]]=c.getDataItem(e)[m[n]];var s=w.filter(y,l);if(s&&s.length||c.getDataItem(e).hasOwnProperty("qdp_data_flag")){if(c.getDataItem(e).hasOwnProperty("qdp_data_flag")&&c.getDataItem(e).qdp_data_flag+""=="3")return"continue";t===m.length-1&&(S[e+1+""]={treeLevel:m.length,isDetail:1})}else{y.push(l);var a=C.dataStyleArray[0][i];a.hAlign=0,a.cellType=null,a.backColor="#F4F7FA",c.addRows(e,1),c.setRowHeight(e,C.dataRowHeightArray[0]),c.setStyle(e,g,a),c.getCell(e,g).value(l[m[t]]),c.addSpan(e,g,1,p-g),c.getCell(e,g).textIndent(2*(t+1)),S[e+""]={treeLevel:t,isDetail:0},t===m.length-1&&(S[e+1+""]={treeLevel:m.length,isDetail:1}),h+=1,o.push(t),M.push(e)}};for(s=0;s<m.length;s++)a(s)}},C=this,n=0;n<h+t;n++)i(n);for(n=0;n<h&&S.hasOwnProperty(n);n++){for(var s=0;s<=S[n+""].treeLevel;s++)c.rowOutlines.group(n,1);c.setCellType(n,g,new TreeCellType(null,!1,S[n+""].treeLevel,S[n+""].isDetail))}"crosstab"!==this.type&&this.getShowFilterRow(e)&&this.filterRow(c)},e.prototype.getGroupField=function(t,e){var i=this;e&&e.schemaValue&&e.schemaValue.columnOption&&e.schemaValue.columnOption.colList&&e.schemaValue.columnOption.colList.length&&(this.autoFitColumnIndex=0,e.schemaValue.columnOption.colList.forEach(function(e){i.recursionGetGroupColumn(t,e,null)}))},e.prototype.getIsRedColumns=function(e,t){var i=this;e&&e.schemaValue&&e.schemaValue.columnOption&&e.schemaValue.columnOption.colList&&e.schemaValue.columnOption.colList.length&&e.schemaValue.columnOption.colList.forEach(function(e){i.recursiveIsRedColumn(e,null,t)})},e.prototype.getFormatField=function(t,e){var i=this;e&&e.schemaValue&&e.schemaValue.columnOption&&e.schemaValue.columnOption.colList&&e.schemaValue.columnOption.colList.length&&(this.autoFitColumnIndex=0,e.schemaValue.columnOption.colList.forEach(function(e){i.recursionGetFormatColumn(t,e,null)}))},e.prototype.getShowHeaderSort=function(e){try{return!(e&&e.schemaValue&&e.schemaValue.otherOption&&null!=e.schemaValue.otherOption.showHeaderSort&&e.schemaValue.otherOption.showHeaderSort!=undefined)||e.schemaValue.otherOption.showHeaderSort}catch(t){return!0}},e.prototype.getShowFilterRow=function(e){try{return!(e&&e.schemaValue&&e.schemaValue.otherOption&&null!=e.schemaValue.otherOption.showFilterRow&&e.schemaValue.otherOption.showFilterRow!=undefined)||e.schemaValue.otherOption.showFilterRow}catch(t){return!0}},e.prototype.getMergeCell=function(e){try{return!!(e&&e.schemaValue&&e.schemaValue.otherOption&&null!=e.schemaValue.otherOption.mergeCell&&e.schemaValue.otherOption.mergeCell!=undefined)&&e.schemaValue.otherOption.mergeCell}catch(t){return!1}},e.prototype.recursionGetFormatColumn=function(t,e,i){var n=this;e?e.childList&&e.childList.length?this.recursionGetFormatColumn(t,null,e.childList):1==e.formatType&&e.formatField&&t.push({sourceField:e.bindField,formatField:e.formatField,formatter:e.formattor}):i.forEach(function(e){e.childList&&e.childList.length?n.recursionGetFormatColumn(t,null,e.childList):1==e.formatType&&e.formatField&&t.push({sourceField:e.bindField,formatField:e.formatField,formatter:e.formattor})})},e.prototype.recursionGetGroupColumn=function(t,e,i){var n=this;e?e.childList&&e.childList.length?this.recursionGetGroupColumn(t,null,e.childList):e.isGroup&&t.push(e.bindField):i.forEach(function(e){e.childList&&e.childList.length?n.recursionGetGroupColumn(t,null,e.childList):e.isGroup&&t.push(e.bindField)})},e.prototype.logicFormat=function(e,t){for(var i=e.split(";"),n=i[0].split("/"),s=i[1].split("/"),a=0;a<n.length;a++)if(n[a]==t+""){t=s[a];break}return t},e.prototype.filterRow=function(e){e.addRows(0,1);for(var t=0;t<e.getRowCount();t++)e.getCell(t,0,GC.Spread.Sheets.SheetArea.rowHeader).value(0==t?"":t);e.setRowHeight(0,this.dataRowHeightArray[0]);for(t=0;t<e.getColumnCount();t++){var i=new GC.Spread.Sheets.Style;i.fromJSON(this.dataStyleArray[0][t].toJSON()),i.locked=!1,i.formatter="@",e.setStyle(0,t,i),e.setCellType(0,t,new FilterCellType(e))}var n=new GC.Spread.Sheets.Filter.HideRowFilter(new GC.Spread.Sheets.Range(1,0,e.getRowCount(),e.getColumnCount()));e.rowFilter(n),n.filterButtonVisible(!1)},e.prototype.linkField=function(e,t){try{for(var i=this,n=t.getRowCount(),s=t.getColumnCount(),a=1;a<n;a++){var r=t.getDataItem(a);if(!r.hasOwnProperty("dynamicPropSet")||!r.dynamicPropSet.hasOwnProperty("qdp_data_flag"))for(var l=0;l<s;l++)for(var o=JSON.parse(this.jointsearchInfoList.joinSearch),c=0;c<o.length;c++){var d=o[c];if(2===d.jointserachdisplaystyle&&d.linkfield===this.dataColInfoArray[l].name){this.hyperLinkQuery[this.queryId]||(this.hyperLinkQuery[this.queryId]={}),this.hyperLinkQuery[this.queryId][l+""]=d;var u=new GC.Spread.Sheets.CellTypes.HyperLink;u.text(u.format(t.getCell(a,l).value(),this.dataColInfoArray[l].formatter)),u.activeOnClick(!0),u.onClickAction(function(){e.commandManager().execute({cmd:"dropdownquery",self:i})}),t.setCellType(a,l,u,GC.Spread.Sheets.SheetArea.viewport)}}}e.commandManager().register("dropdownquery",{canUndo:!0,execute:function(v,I,e){function t(e){if(e===C+""){var t=I.self.hyperLinkQuery[I.self.queryId][e],i={id:"null"},n=new Map,s=JSON.parse(I.self.jointsearchInfoList.jointparam).filter(function(e){return e.functionid===t.id}),a=I.self.cache.get(b.RtfServices.getTabId(I.self.queryId)+"joinSearch"),r={id:"null"};if("crosstab"===a.controlType){for(var l=function(e){var t=v.getActiveSheet().getValue(D,e,GC.Spread.Sheets.SheetArea.viewport),i=v.getActiveSheet().getValue(a.colHeaderRowInfo.start,e,GC.Spread.Sheets.SheetArea.colHeader),n=a.colInfos.find(function(e){return 1===e.dimension&&e.name===i}).bindField;r[n]=t},o=a.rowHeaderColInfo.start;o<a.rowHeaderColInfo.end;o++)l(o);for(o=a.colHeaderRowInfo.start;o<a.colHeaderRowInfo.end;o++){var c=v.getActiveSheet().getValue(o,C,GC.Spread.Sheets.SheetArea.colHeader),d=a.colInfos.filter(function(e){return 2===e.dimension})[o-a.colHeaderRowInfo.start].bindField;r[d]=c}var u=v.getActiveSheet().getValue(D,C,GC.Spread.Sheets.SheetArea.viewport),h=v.getActiveSheet().getValue(a.colHeaderRowInfo.end,C,GC.Spread.Sheets.SheetArea.colHeader),p=a.colInfos.find(function(e){return 3===e.dimension&&e.name===h});p&&(p=p.bindField,r[p]=u)}else r=v.getActiveSheet().getDataItem(D);var g=r;0<s.length?s.forEach(function(e){if(e.paravaluetype)if(0<=e.paravalue.indexOf("getParameter(")){var t=e.paravalue.replace(/'/g,"").replace(/"/g,"").replace(/getParameter\(/g,"").replace(/\)/g,"");I.self.getQueryParameters(i,n,t,e.para)}else i[e.para]=g[e.paravalue],n.set(e.para,g[e.paravalue]);else i[e.para]=e.paravalue,n.set(e.para,e.paravalue)}):i=g;var m={ParentSessionId:I.self.cache.get("session"),EntityParam:i},y="";if("func"===t.searchtype){var M={appType:"menu",funcId:t.functioncode,tabId:b.EventBus.guid(),appId:"",appEntrance:"",entityParams:m.entityParam,queryStringParams:n,isNewTab:!0};y=b.RtfServices.getFuncId(M),I.self.cache.set(y||I.self.queryId,m.EntityParam);var S=Object.assign({},M.entityParams,b.RtfServices.getMenuSwitchControlParameter(y));M.entityParams=S,gspframeworkService.rtf.func.openMenu(M)}else if("app"===t.searchtype){var f={appType:"app",appId:t.functioncode,appEntrance:t.appEntrance,funcId:"",isReload:!0,tabId:b.EventBus.guid(),entityParams:m.entityParam,queryStringParams:n};y=b.RtfServices.getFuncId(f),I.self.cache.set(y||I.queryId,m.EntityParam);S=Object.assign({},f.entityParams,b.RtfServices.getMenuSwitchControlParameter(y));f.entityParams=S,gspframeworkService.rtf.func.openMenu(f)}}}var D=v.getActiveSheet().getActiveRowIndex(),C=v.getActiveSheet().getActiveColumnIndex();for(var i in I.self.hyperLinkQuery[I.self.queryId])t(i)}},null,!1,!1,!1,!1)}catch(h){}},e.prototype.inSuiteLinkField=function(e,t,g){try{var i=this,m=null;try{this.lcpService.inSuiteDropDownInfo&&"string"==typeof this.lcpService.inSuiteDropDownInfo&&(m=JSON.parse(this.lcpService.inSuiteDropDownInfo))}catch(C){throw C}var n=t.getRowCount(),s=t.getColumnCount(),a=!0,r=[],l={},y=m.click_events,M=m.event_data,S=m.double_click_event,f=m.double_click_event_params,v=m.rc_event_ids;if(S&&"{}"!=JSON.stringify(S)&&f&&"{}"!=JSON.stringify(f))for(var o in a=!0,f)r.push(o);else if(M&&"{}"!=JSON.stringify(M))for(var o in a=!1,M)if(M[o]){for(var c in l[o]=[],M[o])l[o].push(c)}for(var d=1;d<n;d++){var u=t.getDataItem(d);if(!u.hasOwnProperty("dynamicPropSet")||!u.dynamicPropSet.hasOwnProperty("qdp_data_flag"))for(var h=0;h<s;h++)if(a){for(var p=0;p<r.length;p++)if(d==r[p]-0){var I=new GC.Spread.Sheets.CellTypes.HyperLink,D=t.getFormatter(d,h);I.text(I.format(t.getCell(d,h).value(),D)),I.activeOnClick(!0),I.onClickAction(function(){e.commandManager().execute({cmd:"dropdownquery",self:i})}),t.setCellType(d,h,I,GC.Spread.Sheets.SheetArea.viewport)}}else for(var o in l)if(d+""===o)for(p=0;p<l[o].length;p++){I=new GC.Spread.Sheets.CellTypes.HyperLink,D=t.getFormatter(d,l[o][p]);I.text(I.format(t.getCell(d,l[o][p]).value(),D)),I.activeOnClick(!0),I.onClickAction(function(){e.commandManager().execute({cmd:"dropdownquery",self:i})}),t.setCellType(d,l[o][p],I,GC.Spread.Sheets.SheetArea.viewport)}}e.commandManager().register("dropdownquery",{canUndo:!0,execute:function(e,t,i){var n,s,a,r=e.getActiveSheet().getActiveRowIndex(),l=e.getActiveSheet().getActiveColumnIndex();if(S&&"{}"!=JSON.stringify(S)&&f&&"{}"!=JSON.stringify(f))n=S,s=f[r];else if(M&&"{}"!=JSON.stringify(M)&&M[r]&&"{}"!=JSON.stringify(M[r])){var o=void 0,c=M[r][-1]||M[r][l];if(c&&"{}"!=JSON.stringify(c)){if(!v&&v.length){var d={},u=function(t){v.findIndex(function(e){return e==t})<0&&(d[t]=c[t])};for(var h in c)u(h);c=d}var p=0;for(var h in c){if(0!=p)break;o=h,p++}s=c[o]}null!=o&&o!=undefined&&(n=y[o]&&"{}"!=JSON.stringify(y[o])?y[o].event:{})}if("{}"!=JSON.stringify(n)&&"{}"!=JSON.stringify(s)&&(a={type:"cellAction",event:n,params:s,defaults:m.defaults}),a)try{g.inSuiteWindow().postMessage(a,location.origin)}catch(C){console.log(C)}}},null,!1,!1,!1,!1)}catch(C){}},e.prototype.getQueryParameters=function(e,t,i,n){try{var s=gspframeworkService.rtf.session.getCommonVariable();if(s&&s.tabId){var a=s.tabId+b.RtfServices.getInSuiteFrmUUID();this.cache.get(a)&&this.cache.get(a)[i]&&(e[n]=this.cache.get(a)[i],t.set(n,this.cache.get(a)[i]))}}catch(r){}},e.prototype.bindSelectChanged=function(e,s){var p=this;e.bind(GC.Spread.Sheets.Events.SelectionChanging,function(e,t){var i={},n=t.newSelections.pop(),s=0===t.sheetArea?"sheetCorner":1===t.sheetArea?"columnHeader":2===t.sheetArea?"rowHeader":"viewPort";n&&(i.SpreadEvent=GC.Spread.Sheets.Events.SelectionChanging,i.sheetArea=s,i.row=n.row,i.column=n.col,i.rowCount=n.rowCount,i.colCount=n.colCount,this.selectChanging=i)}),e.bind(GC.Spread.Sheets.Events.CellClick,function(e,c){for(var d={},u=0;u<this.selectChanging.rowCount;u++)if("crosstab"!==p.joinParam.controlType){var t=c.sheet.getDataItem(u+this.selectChanging.row);d=t}else{-1===this.selectChanging.column&&(this.selectChanging.colCount=this.selectChanging.colCount+1);for(var i=function(e){var s={};if("crosstab"===p.joinParam.controlType){if(1===c.sheetArea&&(h.selectChanging.row=0),e+h.selectChanging.column<p.joinParam.rowHeaderColInfo.end)return"continue";for(var t=function(e){var t=c.sheet.getValue(u+h.selectChanging.row,e,GC.Spread.Sheets.SheetArea.viewport),i=c.sheet.getValue(p.joinParam.colHeaderRowInfo.start,e,GC.Spread.Sheets.SheetArea.colHeader),n=p.joinParam.colInfos.find(function(e){return 1===e.dimension&&e.name===i}).bindField;s[n]=t},i=p.joinParam.rowHeaderColInfo.start;i<p.joinParam.rowHeaderColInfo.end;i++)t(i);for(i=p.joinParam.colHeaderRowInfo.start;i<p.joinParam.colHeaderRowInfo.end;i++){var n=c.sheet.getValue(i,e+h.selectChanging.column,GC.Spread.Sheets.SheetArea.colHeader),a=p.joinParam.colInfos.filter(function(e){return 2===e.dimension})[i-p.joinParam.colHeaderRowInfo.start].bindField;s[a]=n}var r=c.sheet.getValue(u+h.selectChanging.row,e+h.selectChanging.column,GC.Spread.Sheets.SheetArea.viewport),l=c.sheet.getValue(p.joinParam.colHeaderRowInfo.end,e+h.selectChanging.column,GC.Spread.Sheets.SheetArea.colHeader),o=p.joinParam.colInfos.find(function(e){return 3===e.dimension&&e.name===l}).bindField;s[o]=r}d=s},h=this,n=0;n<this.selectChanging.colCount;n++)i(n)}b.EventBus.dispatch(s+"_spread_change",d)})},e.prototype.setSortCellType=function(e,t,i){for(var n=e.getRowCount(GC.Spread.Sheets.SheetArea.colHeader),s=0;s<e.getColumnCount();s++){var a=e.getSpan(n-1,s,GC.Spread.Sheets.SheetArea.colHeader);a&&1<a.rowCount?e.setCellType(n-a.rowCount,s,new SortCellType(this.columnSort.bind(this),t,i),GC.Spread.Sheets.SheetArea.colHeader):e.setCellType(n-1,s,new SortCellType(this.columnSort.bind(this),t,i),GC.Spread.Sheets.SheetArea.colHeader)}},e.prototype.mergeCell=function(e,t){if(this.getMergeCell(t)){var i=[];if(this.getGroupField(i,t),!i.length){var n=e.getColumnCount(),s=e.getRowCount(),a=0;if(this.getShowFilterRow(t)&&(a=1),!(n<1||s-a<1)){for(var r={},l="",o="",c="",d=a;d<s;d++)if(!e.getDataItem(d).hasOwnProperty("qdp_data_flag")||e.getDataItem(d).qdp_data_flag+""!="4"&&e.getDataItem(d).qdp_data_flag+""!="3"&&e.getDataItem(d).qdp_data_flag+""!="2"&&e.getDataItem(d).qdp_data_flag+""!="1")for(var u=0;u<n;u++)if(o=e.getCell(d,u).value(),0==u)c=o,r.hasOwnProperty(c)?r[c].rowCount=d-r[c].row+1:r[c]={row:d,rowCount:1,col:u,colCount:1};else{l="";for(var h=0;h<=u;h++)l+=e.getCell(d,h).value(),l+="_&_";r.hasOwnProperty(l)?r[l].rowCount=d-r[l].row+1:r[l]={row:d,rowCount:1,col:u,colCount:1}}for(var p in r)0==(1==r[p].rowCount&&1==r[p].colCount)&&e.addSpan(r[p].row,r[p].col,r[p].rowCount,r[p].colCount)}}}},e.prototype.columnSort=function(e,t,i,n){var s=this,a=this.loadService.show({container:"body"});try{var r=t.getRowCount(GC.Spread.Sheets.SheetArea.colHeader);if(!(i&&i.schemaValue&&i.schemaValue.columnOption&&i.schemaValue.columnOption.colList&&i.schemaValue.columnOption.colList.length))return a.close(),void this.msgService.info(this.localizeService.getValue("spread.message.validate.sort"));var l=null,o=t.getSpan(r-1,e,GC.Spread.Sheets.SheetArea.colHeader);if(l=o&&1<o.rowCount?t.getCell(r-o.rowCount,e,GC.Spread.Sheets.SheetArea.colHeader):t.getCell(r-1,e,GC.Spread.Sheets.SheetArea.colHeader),i&&1===i.isPrefab)return a.close(),l.tag(0),t.invalidateLayout(),t.repaint(),void this.msgService.info(this.localizeService.getValue("spread.message.validate.sort"));if(1===i.isProtected||"1"===i.isProtected)return a.close(),l.tag(0),t.invalidateLayout(),t.repaint(),void this.msgService.info(this.localizeService.getValue("ideCmp.schemaManager.message.validate.isProtected"));for(var c=i.schemaValue.columnOption.colList,d={index:e,cell:l,colIndex:0,sortInfo:{sortIndex:0,bindField:""},isText:[]},u=0;u<c.length;u++)this.recursiveColumnSortIndex(c[u],null,d);for(u=0;u<c.length;u++)this.recursiveColumnSort(c[u],null,d);if(d.isText.length)return a.close(),l.tag(0),t.invalidateLayout(),t.repaint(),void this.msgService.warning(d.isText[0]+" "+this.localizeService.getValue("ideCmp.schemaManager.message.validate.textColumnSort"));var h=JSON.parse(JSON.stringify(i));h.schemaValue.columnOption.colList=c,h.schemaValue=JSON.stringify(h.schemaValue),this.schemaManager.saveSchema({schema:JSON.stringify(h),groupType:n.groupType},"").subscribe(function(e){a.close(),n.initSpread(n.queryId,h.id,n.controlType,n.qoManagerCode,n.pageIndex,n.queryRelativeUrl,n.conditionExpression,n.groupType,n.voId,!0)},function(e){a.close(),s.formErrorService.exception(e.Message,e)})}catch(p){a.close()}},e.prototype.recursiveColumnSortIndex=function(e,t,i){if(null==t)e.childList&&e.childList.length?this.recursiveColumnSortIndex(null,e.childList,i):0!==e.sort&&null!=e.sortIndex&&e.sortIndex!==undefined&&e.sortIndex>i.sortInfo.sortIndex&&(i.sortInfo.sortIndex=e.sortIndex,i.sortInfo.bindField=e.bindField);else for(var n=0;n<t.length;n++)t[n].childList&&t[n].childList.length?this.recursiveColumnSortIndex(null,t[n].childList,i):0!==t[n].sort&&null!=t[n].sortIndex&&t[n].sortIndex!==undefined&&t[n].sortIndex>i.sortInfo.sortIndex&&(i.sortInfo.sortIndex=t[n].sortIndex,i.sortInfo.bindField=t[n].bindField)},e.prototype.recursiveColumnSort=function(e,t,i){if(null==t)if(e.childList&&e.childList.length)this.recursiveColumnSort(null,e.childList,i);else{if(i.colIndex===i.index)if(e.type&&"text"===e.type.toLowerCase())i.isText.push(e.bindField);else switch(i.cell.tag()){case 0:e.sort=0,e.sortIndex=0;break;case 1:e.sort=1,e.sortIndex=null!==e.sortIndex&&e.sortIndex!==undefined&&0<e.sortIndex?e.sortIndex:e.bindField===i.sortInfo.bindField?i.sortInfo.sortIndex:i.sortInfo.sortIndex+1;break;case 2:e.sort=2,e.sortIndex=null!==e.sortIndex&&e.sortIndex!==undefined&&0<e.sortIndex?e.sortIndex:e.bindField===i.sortInfo.bindField?i.sortInfo.sortIndex:i.sortInfo.sortIndex+1}i.colIndex++}else for(var n=0;n<t.length;n++)if(t[n].childList&&t[n].childList.length)this.recursiveColumnSort(null,t[n].childList,i);else{if(i.colIndex===i.index)if(t[n].type&&"text"===t[n].type.toLowerCase())i.isText.push(t[n].bindField);else switch(i.cell.tag()){case 0:t[n].sort=0,t[n].sortIndex=0;break;case 1:t[n].sort=1,t[n].sortIndex=null!==t[n].sortIndex&&t[n].sortIndex!==undefined&&0<t[n].sortIndex?t[n].sortIndex:t[n].bindField===i.sortInfo.bindField?i.sortInfo.sortIndex:i.sortInfo.sortIndex+1;break;case 2:t[n].sort=2,t[n].sortIndex=null!==t[n].sortIndex&&t[n].sortIndex!==undefined&&0<t[n].sortIndex?t[n].sortIndex:t[n].bindField===i.sortInfo.bindField?i.sortInfo.sortIndex:i.sortInfo.sortIndex+1}i.colIndex++}},e.prototype.recursiveIsRedColumn=function(e,t,i){if(null==t)e.childList&&e.childList.length?this.recursiveIsRedColumn(null,e.childList,i):(e.isRed&&i.isRedColumns.push({colIndex:i.colIndex}),i.colIndex++);else for(var n=0;n<t.length;n++)t[n].childList&&t[n].childList.length?this.recursiveIsRedColumn(null,t[n].childList,i):(t[n].isRed&&i.isRedColumns.push({colIndex:i.colIndex}),i.colIndex++)},e.prototype.isNumber=function(e){return"NaN"!=parseFloat(e).toString()},e}(),N=function(){function e(e,t,i,n,s){this.utils=new Map,this.autoFitColumnIndex=0,this.isSchemaSelectChanged=!1,this.tabId=b.RtfServices.getTabId(e),this.queryId=e,this.type=t,this.funcInfoCache=n,this.serviceCache=s,this.baseRenderInit(e,t,i,n)}return e.prototype.baseRenderInit=function(e,t,i,n){var s=new I(e,n,this.serviceCache),a=new C(this.serviceCache),r=new x(e,t,i,this.serviceCache),l=new D(e);this.msgService=this.serviceCache.msgService,this.cache=this.serviceCache.cacheService,this.lcpService=this.serviceCache.lcpService,this.loadService=this.serviceCache.loadService,this.localizeService=this.serviceCache.localizeService,this.schemaManager=this.serviceCache.schemaManagerService,this.formErrorService=this.serviceCache.formErrorService,this.queryId=e,this.utils.set("parameter",s),this.utils.set("schema",a),this.utils.set("spreadStyle",r),this.utils.set("renderExtends",l),this.utils.set("queryId",e)},e.prototype.getData=function(e,t){return this.cache.set(this.queryId+"param",e),this.lcpService.getData(e,t)},e.prototype.changeData=function(r,e){if(r&&r.data&&r.dynamicCols&&e&&e.schemaValue.columnOption&&e.schemaValue.columnOption.colList&&e.schemaValue.columnOption.colList.length){var t=e.schemaValue.columnOption.colList.filter(function(e){return"enum"===e.type});t&&0<t.length&&r.data.forEach(function(a){t.forEach(function(t){var i=a[t.bindField],e=i;if(r.resultEnumItems){var n=r.resultEnumItems.find(function(e){return e.enumName===t.bindField});if(n){var s=n.resultEnumInfoList.find(function(e){return e.key===i});s&&(e="0"===t.showType?s.key:"1"===t.showType?s.code:s.name)}}a[t.bindField]=e})})}},e.prototype.operateCustomFormatSchema=function(e,t){if(e.customFormatScheme){t.customFormatScheme=e.customFormatScheme,this.schemaManager.customSchema[t.groupType?t.groupType:t.queryId]=e.customFormatScheme;var i=null;"1"===t.schemaId&&(i=this.schemaManager.mergeCustomSchema(t.groupType?t.groupType:t.queryId,t.queryId)),i&&i.schemaValue&&y.setServices(b.RtfServices.getTabId(t.queryId)+"customScheme",JSON.stringify(i.schemaValue))}},e.prototype.operatePagination=function(e,t){var i=this;if("list"===e.controlType){var n=0;"1"!==e.schemaId&&i.schemaManager.schemaList&&i.schemaManager.schemaList[e.schemaId]?("string"==typeof i.schemaManager.schemaList[e.schemaId].schemaValue&&(i.schemaManager.schemaList[e.schemaId].schemaValue=JSON.parse(i.schemaManager.schemaList[e.schemaId].schemaValue)),0!==i.schemaManager.schemaList[e.schemaId].schemaValue.otherOption.loadDataType&&(n=i.schemaManager.schemaList[e.schemaId].schemaValue.otherOption.pageSize)):"1"===e.schemaId&&i.schemaManager.preSchema&&0!==i.schemaManager.preSchema.schemaValue.otherOption.loadDataType&&(n=i.schemaManager.preSchema.schemaValue.otherOption.pageSize),0!==n&&(t.pageSize=n,t.pageIndex=e.pageIndex?e.pageIndex:1)}},e.prototype.titleVariablesReplace=function(e,t){var i=e.getColumnCount(GC.Spread.Sheets.SheetArea.colHeader),n=e.getRowCount(GC.Spread.Sheets.SheetArea.colHeader);if(t&&t.variables)for(var s=0;s<n;s++)for(var a=0;a<i;a++)e.setValue(s,a,this.variablesReplace(e.getValue(s,a,GC.Spread.Sheets.SheetArea.colHeader),t),GC.Spread.Sheets.SheetArea.colHeader)},e.prototype.footerVariablesReplace=function(e,t){var i=e.getRowCount(),n=e.getColumnCount();if(this.utils.get("spreadStyle").footerDataArray&&this.utils.get("spreadStyle").footerDataArray.length)for(var s=0;s<this.utils.get("spreadStyle").footerDataArray.length;s++)for(var a=0;a<n;a++)e.setValue(s+(i-this.utils.get("spreadStyle").footerDataArray.length),a,this.variablesReplace(this.utils.get("spreadStyle").footerDataArray[s][a],t))},e.prototype.variablesReplace=function(i,n){return n&&n.variables&&Object.keys(n.variables).forEach(function(e){var t=new RegExp(e,"g");i&&(i=i.replace(t,n.variables[e]))}),i},e.prototype.errorHandle=function(e,t){e.getActiveSheet()&&e.removeSheet(0),e.options.tabStripVisible=!1,this.msgService.warning(t)},e}(),T=function(r){function e(e,t,i,n,s){var a=r.call(this,e,t,i,n,s)||this;return a.crosstabInit(),a}return S(e,r),e.prototype.crosstabInit=function(){},e.prototype.render=function(a){var r=this,l=this;this.queryId=a.queryId,a.schemaId="prefab"===a.schemaId?"1":a.schemaId,this.utils.get("schema").getSchemaInfo(a).subscribe(function(e){if(e){a.schemaId=e.id,a.schemaValue=e,b.EventBus.dispatch("schemaValueChanged",e);var t=e.schemaValue.otherOption.delay,i=e.schemaValue.otherOption.interval,n=l.funcInfoCache.firstLoadCache.findIndex(function(e){return e===r.tabId}),s=e.schemaValue.otherOption.firstLoad;if(n<0&&!1===r.isSchemaSelectChanged&&!1===s)return l.funcInfoCache.firstLoadCache.push(r.tabId),a.loading.close(),void(a.spread.getActiveSheet()&&(a.spread.getActiveSheet().deleteRows(0,a.spread.getActiveSheet().getRowCount()),a.spread.getActiveSheet().options.colHeaderVisible=!1,a.spread.invalidateLayout(),a.spread.repaint()));t||(t=0),setTimeout(function(){r.getRenderDataForCrosstab.call(r,Object.assign({},a)),0<i&&setInterval(function(){r.getRenderDataForCrosstab.call(r,Object.assign({},a))},1e3*i)},1e3*t)}else a.schemaId="1",r.getRenderDataForCrosstab.call(r,Object.assign({},a))})},e.prototype.getRenderDataForCrosstab=function(i){var n=this,s=this;if(i.schemaId=i.schemaId?i.schemaId:i.schemaValue&&i.schemaValue.id?i.schemaValue.id:"1",!i.formData){var a=this.utils.get("parameter").createParameters(Object.assign({},i,{pageIndex:0,pageSize:0}));a.queryId=i.queryId?i.queryId:"",a=this.utils.get("renderExtends").runRenderExtends("beforeQueryData",this.localizeService.getValue("spread.message.extend.query.before"),a,i.spread);try{this.cache.set(s.tabId,JSON.parse(a.entityData)),this.cache.set(s.tabId+"extendCond",a.extendCond)}catch(e){}s.lcpService.getCol(a,i.queryRelativeUrl).subscribe(function(e){var t=e&&e.dynamicCols||[];if(s.initJoinParams(i,t),s.schemaManager.setColInfo(t),"1"===i.schemaId||!i.schemaId)return i.loading.close(),s.errorHandle(i.spread,n.localizeService.getValue("spread.message.validate.schemaInfo"));s.lcpService.getCrosstabTemplate(a,i.queryRelativeUrl).subscribe(function(e){if(!(e&&e.sheets&&e.sheets.sheet1&&e.sheets.sheet1.data&&e.sheets.sheet1.data.dataTable&&e.sheets.sheet1.data.dataTable[0]))return i.loading.close(),s.errorHandle(i.spread,n.localizeService.getValue("spread.message.validate.nodata"));s.renderCrossTable(Object.assign({},i,{template:e}));var t=b.RtfServices.getMenuSwitchControlEvent();t&&"object"==typeof t&&t.next("ok"),i.loading.close(),n.utils.get("spreadStyle").bindSelectChanged(i.spread,i.queryId)},function(e){s.formErrorService.exception(e.Message,e),i.loading.close()})},function(e){s.formErrorService.exception(e.Message,e),i.loading.close()}),this.cache.set("schema_schemaid"+i.queryId,i.schemaId)}},e.prototype.renderCrossTable=function(e){if(e.spread.suspendEvent(),e.spread.suspendPaint(),e.template){e.spread.fromJSON(e.template),e.spread.getActiveSheet().rowOutlines.direction(GC.Spread.Sheets.Outlines.OutlineDirection.backward);for(var t=e.spread.getActiveSheet().getRowCount(),i=0;i<t;i++){var n=e.spread.getActiveSheet().getCellType(i,0);if(n&&"TreeCellType"===n.typeName)for(var s=n.level,a=0;a<=s;a++)e.spread.getActiveSheet().rowOutlines.group(i,1)}}var r=e.spread.getActiveSheet();r&&(this.titleVariablesReplace(r,e.data),r.clearSelection()),this.utils.get("renderExtends").runRenderExtends("afterLoadData",this.localizeService.getValue("spread.message.extend.dataLoading.after"),e.data,e.spread),e.spread.resumePaint(),e.spread.resumeEvent(),this.utils.get("spreadStyle").joinParam.controlType=e.controlType,this.cache.set(this.tabId+"joinSearch",this.utils.get("spreadStyle").joinParam)},e.prototype.initJoinParams=function(e,t){var i=this;this.utils.get("spreadStyle").joinParam={controlType:e.controlType,rowHeaderColInfo:{start:0,end:0},colHeaderRowInfo:{start:0,end:0},valueColCount:0,colInfos:t};var n=this.utils.get("spreadStyle").rowHeadersColumnCount=this.utils.get("spreadStyle").valueHeaderRowCount=0,s=0;"1"!==e.schemaId&&(s+=e.schemaValue.schemaValue.titleOption.title?1:0,s+=e.schemaValue.schemaValue.titleOption.subTitles.length,e.schemaValue.schemaValue.columnOption.colList.forEach(function(e){e.dimension&&0!==e.dimension&&(1===e.dimension?i.utils.get("spreadStyle").rowHeadersColumnCount++:2===e.dimension?n++:3===e.dimension&&i.utils.get("spreadStyle").valueHeaderRowCount++)}),this.utils.get("spreadStyle").joinParam.controlType=e.controlType,this.utils.get("spreadStyle").joinParam.rowHeaderColInfo={start:0,end:this.utils.get("spreadStyle").rowHeadersColumnCount},this.utils.get("spreadStyle").joinParam.colHeaderRowInfo={start:s,end:s+n},this.utils.get("spreadStyle").joinParam.valueColCount=this.utils.get("spreadStyle").valueHeaderRowCount,this.utils.get("spreadStyle").joinParam.colInfos=e.schemaValue.schemaValue.columnOption.colList),this.cache.set(this.tabId+"joinSearch",this.utils.get("spreadStyle").joinParam)},e}(N),z=function(r){function e(e,t,i,n,s){var a=r.call(this,e,t,i,n,s)||this;return a.listRenderInit(e,t),a}return S(e,r),e.prototype.listRenderInit=function(e,t){this.type=t,this.queryId=e},e.prototype.render=function(r){var l=this,o=this;this.queryId=r.queryId,this.type=r.controlType,r.schemaId="prefab"===r.schemaId?"1":r.schemaId,this.utils.get("schema").getSchemaInfo(r).subscribe(function(e){if(e){r.schemaId=e.id,r.schemaValue=e,b.EventBus.dispatch("schemaValueChanged",e);var t=e.schemaValue.otherOption.delay,i=e.schemaValue.otherOption.interval,n=b.RtfServices.getTabId(r.queryId),s=o.funcInfoCache.firstLoadCache.findIndex(function(e){return e===n}),a=e.schemaValue.otherOption.firstLoad;if(s<0&&!1===l.isSchemaSelectChanged&&!1===a)return o.funcInfoCache.firstLoadCache.push(n),r.loading.close(),void(r.spread.getActiveSheet()&&(r.spread.getActiveSheet().deleteRows(0,r.spread.getActiveSheet().getRowCount()),r.spread.getActiveSheet().options.colHeaderVisible=!1,r.spread.invalidateLayout(),r.spread.repaint(),o.serviceCache.lcpService.pageInfoChange.next({pageCount:1,pageIndex:1,pageSize:e.schemaValue.otherOption.pageSize||20,totalCount:1})));t||(t=0),setTimeout(function(){l.getRenderDataForList.call(l,Object.assign({},r)),0<i&&setInterval(function(){l.getRenderDataForList.call(l,Object.assign({},r))},1e3*i)},1e3*t)}else r.schemaId="1",l.getRenderDataForList.call(l,Object.assign({},r))})},e.prototype.getRenderDataForList=function(i){var e=this,n=this;if(i.schemaId=i.schemaId?i.schemaId:i.schemaValue&&i.schemaValue.id?i.schemaValue.id:"1",i.formData)i.data=i.formData,i.frozenCols=i.formData.dynamicCols,n.getListRenderTemplate(i);else{var s=this.utils.get("parameter").createParameters(Object.assign({},i,{pageIndex:0,pageSize:0}));s.queryId=i.queryId?i.queryId:"",n.operatePagination(i,s),s=this.utils.get("renderExtends").runRenderExtends("beforeQueryData",this.localizeService.getValue("spread.message.extend.query.before"),s,i.spread);try{var t=b.RtfServices.getTabId(i.queryId);this.cache.set(t,JSON.parse(s.entityData)),this.cache.set(t+"extendCond",s.extendCond)}catch(a){}n.getData(s,i.queryRelativeUrl).subscribe(function(t){t=t||{data:[],dynamicCols:[]},("1"!==i.schemaId||t&&t.dynamicCols&&t.dynamicCols.length)&&(n.schemaManager.dynamicCols[i.groupType?i.groupType:i.queryId]=t.dynamicCols||[],n.schemaManager.dynamicCols[i.schemaId]=t.dynamicCols||[],n.schemaManager.operateDynamicColsForSchema(i.schemaValue,i.groupType?i.groupType:i.queryId,i.schemaId),n.schemaManager.schemaInfoChange.next({schemaList:n.schemaManager.schemaInfo,isDefaultSchema:n.schemaManager.isDefaultSchema&&n.schemaManager.isDefaultSchema[i.queryId]?n.schemaManager.isDefaultSchema[i.queryId]:null,preSchema:n.schemaManager.preSchema})),i.schemaValue&&"1"!=i.schemaId||n.operateCustomFormatSchema(t,i),e.utils.get("renderExtends").runRenderExtends("beforeLoadData",n.localizeService.getValue("spread.message.extend.dataLoading.before"),t,i.spread),n.lcpService.getCol(s,i.queryRelativeUrl).subscribe(function(e){"1"===i.schemaId&&(t.dynamicCols.length||(t.dynamicCols=e.dynamicCols||[])),i.frozenCols=e&&e.dynamicCols||[],i.data=t,n.getListRenderTemplate(i)})},function(e){n.formErrorService.exception(e.Message,e),i.loading.close()}),this.cache.set("schema_schemaid"+i.queryId,i.schemaId)}},e.prototype.getListRenderTemplate=function(i){var n=this;n.schemaManager.getSpreadTemplate(i.schemaId,i.queryId,i.data&&i.data.dynamicCols?i.data.dynamicCols:[],i.queryRelativeUrl,i.customFormatScheme,i.frozenCols,i.groupType).subscribe(function(e){e=e.returnValue?JSON.parse(e.returnValue):e,n.renderList.call(n,Object.assign({},i,{template:e})),n.utils.get("spreadStyle").bindSelectChanged(i.spread,i.queryId);var t=b.RtfServices.getMenuSwitchControlEvent();t&&"object"==typeof t&&t.next("ok"),b.EventBus.dispatch(n.queryId+"spread_init",{}),i.loading.close()},function(e){n.formErrorService.exception(e.Message,e),i.loading.close()})},e.prototype.renderList=function(e){this.type=e.controlType,e.spread.suspendEvent(),e.spread.suspendPaint(),e.spread.fromJSON(e.template);var t=e.spread.getActiveSheet();if(e.curSheet&&e.multiSheets.length){t.name(e.curSheet);for(var i=0;i<e.multiSheets.length;i++)e.curSheet!==e.multiSheets[i]&&(e.spread.addSheet(i,new GC.Spread.Sheets.Worksheet(e.multiSheets[i])),e.spread.sheets[i].deleteRows(0,e.spread.sheets[i].getRowCount()),e.spread.sheets[i].deleteColumns(0,e.spread.sheets[i].getColumnCount()));e.spread.setActiveSheet(e.curSheet),e.spread.options.tabStripVisible=!0,e.spread.options.tabEditable=!1}this.utils.get("spreadStyle").cacheStyle(t);var n=!0;if(e.schemaValue&&e.schemaValue.schemaValue&&e.schemaValue.schemaValue.otherOption&&null!=e.schemaValue.schemaValue.otherOption.showZero&&e.schemaValue.schemaValue.otherOption.showZero!==undefined&&(n=e.schemaValue.schemaValue.otherOption.showZero),e.data&&e.data.data&&e.data.data.length){e.data.data.forEach(function(e){if(e.dynamicPropSet)for(var t in e.dynamicPropSet)e[t]=e.dynamicPropSet[t]}),this.changeData(e.data,e.schemaValue),t.setDataSource(e.data.data),t.bindColumns(this.utils.get("spreadStyle").dataColInfoArray),t.options.isProtected=!0,t.options.protectionOptions={allowSelectLockedCells:!0,allowSelectUnlockedCells:!0,allowFilter:!0,allowSort:!0,allowResizeRows:!0,allowResizeColumns:!0,allowEditObjects:!1},e.spread.options.allowCopyPasteExcelStyle=!0,e.spread.options.allowExtendPasteRange=!0,e.spread.options.copyPasteHeaderOptions=GC.Spread.Sheets.CopyPasteHeaderOptions.allHeaders,t.rowOutlines.direction(GC.Spread.Sheets.Outlines.OutlineDirection.backward);try{!e.schemaValue&&e.customFormatScheme&&"string"==typeof e.customFormatScheme&&(e.schemaValue={},e.schemaValue.schemaValue=JSON.parse(e.customFormatScheme))}catch(a){}this.utils.get("spreadStyle").applyStyle(t,e.schemaValue,n),this.utils.get("spreadStyle").linkField(e.spread,t);try{var s=gspframeworkService.rtf.extendMethod.getExtObj();s&&this.utils.get("spreadStyle").inSuiteLinkField(e.spread,t,s)}catch(a){}this.footerVariablesReplace(t,e.data)}else this.footerVariablesReplace(t,e.data),t.deleteRows(0,1);this.titleVariablesReplace(t,e.data),this.utils.get("spreadStyle").setAutoFitColumn(e.schemaValue,t),this.utils.get("spreadStyle").getShowHeaderSort(e.schemaValue)&&this.utils.get("spreadStyle").setSortCellType(t,e.schemaValue,e.qdpView),"list"==e.controlType&&this.utils.get("spreadStyle").mergeCell(t,e.schemaValue),t.clearSelection(),this.utils.get("renderExtends").runRenderExtends("afterLoadData",this.localizeService.getValue("spread.message.extend.dataLoading.after"),e.data,e.spread),e.spread.resumePaint(),e.spread.resumeEvent(),this.utils.get("spreadStyle").joinParam.controlType=this.type,this.cache.set(b.RtfServices.getTabId(e.queryId)+"joinSearch",this.utils.get("spreadStyle").joinParam)},e}(N),L=function(){function e(e,t,i,n,s,a,r){this.schemaManager=e,this.lcpService=t,this.cache=i,this.loadService=n,this.msgService=s,this.dataRenderExtendService=a,this.injector=r,this.serviceCache={},this.columnCount=0,this.operations={},this.funcInfoCache={funcIds:[],firstLoadCache:[]};var l=this;this.injector&&(this.localizeService=this.injector.get(d.LocalizeService),this.formErrorService=this.injector.get(u.FormErrorService),this.cloudprintService=this.injector.get(c.CloudprintService),this.notifyService=this.injector.get(o.NotifyService),this.setService(),l.schemaManager.operationChange.subscribe(function(e){e&&(l.operations=e)}),l.setSecurityLevel())}return e.prototype.setService=function(){var e=b.RtfServices.getTabId()||"default";this.serviceCache[e]={formErrorService:this.formErrorService,cloudprintService:this.cloudprintService,schemaManagerService:this.schemaManager,lcpService:this.lcpService,cacheService:this.cache,loadingService:this.loadService,msgService:this.msgService,localizeService:this.localizeService,notifyService:this.notifyService}},e.prototype.getService=function(){var e=b.RtfServices.getTabId()||"default";return this.serviceCache[e]},e.prototype.setSecurityLevel=function(){var t=this;this.lcpService.variablesChange.subscribe(function(e){e&&e.hasOwnProperty("securityLevel")&&e.securityLevel&&t.cache.set(b.RtfServices.getTabId()+"securityLevel",e.securityLevel)})},e.prototype.getSecurityLevel=function(){return this.cache.get(b.RtfServices.getTabId()+"securityLevel")?this.cache.get(b.RtfServices.getTabId()+"securityLevel"):""},e.prototype.render=function(e){e.loading||(e.loading=this.loadService.show({container:"body"})),this.spread=e.spread?e.spread:null,this.renderObject=this.getRender(e),this.renderObject.render(e)},e.prototype.getRender=function(e){var t;switch(this.setService(),y.setServices("dataRenderExtendService"+e.queryId,this.dataRenderExtendService),e.controlType){case"crosstab":t=new T(e.queryId,e.controlType,e.jointsearchInfoList,this.funcInfoCache,this.getService());break;default:t=new z(e.queryId,e.controlType,e.jointsearchInfoList,this.funcInfoCache,this.getService())}return t.isSchemaSelectChanged=!!e.isSchemaSelectChanged&&e.isSchemaSelectChanged,t},e.prototype.exportData=function(c){var d=this,u=this.loadService.show({container:"body"});this.renderObject.utils.get("schema").getSchemaInfo({schemaId:c.schemaValue,queryId:c.queryId,queryRelativeUrl:c.queryRelativeUrl,groupType:c.groupType}).subscribe(function(e){c.schemaId=c.schemaId?c.schemaId:e&&e.id?e.id:"1";var t=e&&e.schemaValue&&e.schemaValue.titleOption&&e.schemaValue.titleOption.title?e.schemaValue.titleOption.title:e&&e.schemaName?e.schemaName:"";b.RtfServices.getFuncName()&&(t=b.RtfServices.getFuncName()+"-"+t),c.excelExportName=t;var i=d.renderObject.utils.get("parameter").createParameters(c);i.exportType=c.exportType?c.exportType:"";var n=!1,s=null;if("1"===i.schemaId){if(!y.getServices(b.RtfServices.getTabId(c.queryId)+"customScheme"))return d.msgService.warning(d.localizeService.getValue("spread.message.export")),void u.close();n=!0,i.customSchema=y.getServices(b.RtfServices.getTabId(c.queryId)+"customScheme"),s=JSON.parse(i.customSchema),i.excelExportName||(i.excelExportName=s&&s.titleOption&&s.titleOption.title?s.titleOption.title:"export")}if(!1===d.operations.QdpQueryExport)return d.msgService.warning(d.localizeService.getValue("spread.message.validate.qdpQueryExport")),void u.close();try{if("treelist"===c.controlType&&d.spread){var a="";if(e&&e.schemaValue&&e.schemaValue.otherOption&&2!==e.schemaValue.otherOption.treeInfoType){var r=0===e.schemaValue.otherOption.treeInfoType?e.schemaValue.otherOption.pathField:e.schemaValue.otherOption.idField;if(r){for(var l=0;l<d.spread.getActiveSheet().getRowCount();l++)d.spread.getActiveSheet().rowOutlines.isCollapsed(l)&&(a+=","+d.spread.getActiveSheet().getDataItem(l)[r]);i.expandNodes=a.substring(1)}}}}catch(o){}d.columnCount=0,n?s&&s.columnOption&&s.columnOption.colList&&d.calculationColumnCount(s.columnOption.colList):d.calculationColumnCount(e.schemaValue.columnOption.colList),d.lcpService.loading=u,d.getSecurityLevel()&&(i.excelExportName+="_"+d.getSecurityLevel()),d.columnCount*c.totalCount<1e5?(d.lcpService.exportData(i,c.queryRelativeUrl),u.close()):(d.lcpService.aysnExportData(i,c.queryRelativeUrl),u.close(),d.msgService.warning(d.localizeService.getValue("spread.message.aysnExport")))})},e.prototype.calculationColumnCount=function(e){var t=this;try{e.forEach(function(e){e.childList&&e.childList.length?t.calculationColumnCount(e.childList):t.columnCount+=1})}catch(i){this.columnCount=0}},e.prototype.clearCache=function(n,s,a,r,e,l,t,o){var c=this;this.renderObject.utils.get("schema").getSchemaInfo({schemaId:s,queryId:n,queryRelativeUrl:e,groupType:t}).subscribe(function(e){s=s||(e&&e.id?e.id:"1");var t=e&&e.schemaValue&&e.schemaValue.titleOption&&e.schemaValue.titleOption.title?e.schemaValue.titleOption.title:e&&e.schemaName?e.schemaName:"",i=c.renderObject.utils.get("parameter").createParameters({queryId:n,controlType:a,schemaId:s,qoManagerCode:r,pageIndex:0,pageSize:0,excelExportName:t,filterCondition:l,voId:o});y.getServices(b.RtfServices.getTabId(n)+"customScheme")&&(i.customSchema=y.getServices(b.RtfServices.getTabId(n)+"customScheme")),c.lcpService.clearCache(i).subscribe(function(e){e&&c.notifyService.success({title:c.localizeService.getValue("ideCmp.schemaManager.message.info.title"),msg:c.localizeService.getValue("spread.message.clearCache"),timeout:3e3})})})},e.prototype.pdfExportEvent=function(s){var a=this,r=this.loadService.show({container:"body"});try{this.renderObject.utils.get("schema").getSchemaInfo({schemaId:s.schemaValue,queryId:s.queryId,queryRelativeUrl:s.queryRelativeUrl,groupType:s.groupType}).subscribe(function(e){s.schemaId=s.schemaId?s.schemaId:e&&e.id?e.id:"1";var t=e&&e.schemaValue&&e.schemaValue.titleOption&&e.schemaValue.titleOption.title?e.schemaValue.titleOption.title:e&&e.schemaName?e.schemaName:"";b.RtfServices.getFuncName()&&(t=b.RtfServices.getFuncName()+"-"+t),s.excelExportName=t;var i=a.renderObject.utils.get("parameter").createParameters(s);if("1"===i.schemaId){if(!y.getServices(b.RtfServices.getTabId(s.queryId)+"customScheme"))return a.msgService.warning(a.localizeService.getValue("spread.message.print")),void r.close();i.customSchema=y.getServices(b.RtfServices.getTabId(s.queryId)+"customScheme");var n=JSON.parse(i.customSchema);i.excelExportName||(i.excelExportName=n&&n.titleOption&&n.titleOption.title?n.titleOption.title:"export")}if(!1===a.operations.QdpQueryPrint)return a.msgService.warning(a.localizeService.getValue("spread.message.validate.qdpQueryPrint")),void r.close();a.getSecurityLevel()&&(i.excelExportName+="_"+a.getSecurityLevel()),a.lcpService.pdfExportEvent(i,s.queryRelativeUrl),r.close()})}catch(e){r.close()}},e.prototype.printPreView=function(s){var a=this;this.renderObject.utils.get("schema").getSchemaInfo({schemaId:s.schemaValue,queryId:s.queryId,queryRelativeUrl:s.queryRelativeUrl,groupType:s.groupType}).subscribe(function(e){s.schemaId=s.schemaId?s.schemaId:e&&e.id?e.id:"1";var t=e&&e.schemaValue&&e.schemaValue.titleOption&&e.schemaValue.titleOption.title?e.schemaValue.titleOption.title:e&&e.schemaName?e.schemaName:"";s.excelExportName=t;var i=a.renderObject.utils.get("parameter").createParameters(s);if("1"===i.schemaId){if(!y.getServices(b.RtfServices.getTabId(s.queryId)+"customScheme"))return void a.msgService.warning(a.localizeService.getValue("spread.message.preview"));i.customSchema=y.getServices(b.RtfServices.getTabId(s.queryId)+"customScheme");var n=JSON.parse(i.customSchema);i.excelExportName||(i.excelExportName=n&&n.titleOption&&n.titleOption.title?n.titleOption.title:"export")}a.getSecurityLevel()&&(i.excelExportName+="_"+a.getSecurityLevel()),a.lcpService.cloudprintService=a.cloudprintService,a.lcpService.printPreView(i,s.queryRelativeUrl)})},e.prototype.clearFirstLoadCache=function(e){var t=b.RtfServices.getTabId(e),i=this.funcInfoCache.firstLoadCache.findIndex(function(e){return e===t});0<=i&&this.funcInfoCache.firstLoadCache.splice(i,1)},e.decorators=[{type:h.Injectable}],e.ctorParameters=function(){return[{type:b.SchemaManagerService},{type:b.LcpService},{type:r.CacheService},{type:p.LoadingService},{type:a.MessagerService},{type:b.DataRenderExtendService,decorators:[{type:h.Optional}]},{type:h.Injector,decorators:[{type:h.Optional}]}]},e}(),j=function(){function e(e){this.injector=e,this.isCompare=!1,this.searchText="",this.groupIcon='<span class="k-icon k-i-search"></span>',this.lists=[],this.listsCache=[],this.models={selected:null,lists:this.lists},this.injector&&(this.localizeService=this.injector.get(d.LocalizeService),this.renderService=this.injector.get(L),this.msgService=this.injector.get(a.MessagerService),this.formErrorService=this.injector.get(u.FormErrorService),this.schemaManagerService=this.injector.get(b.SchemaManagerService)),this.initLists()}return e.prototype.ngOnInit=function(){var e=b.RtfServices.getTabId(this.queryId);b.EventBus.register("schemaValueChanged",this.handleSchemaValueChanged.bind(this),e+"dimensionSetting")},e.prototype.ngOnDestroy=function(){},e.prototype.initLists=function(){this.lists=[];for(var e=0;e<4;e++)this.lists.push({name:this.localizeService.getValue("spread.crossTable.dimensionName")[e],value:[]})},e.prototype.initCrosstab=function(){},e.prototype.handleSchemaValueChanged=function(e){var t=this;if(e){if(1===e.id||"1"===e.id)return;this.schemaValue=e,"crosstab"===this.controlType&&(this.colList=e.schemaValue.columnOption.colList,this.colList&&(this.zero=this.colList.filter(function(e){return 0===e.dimension}),this.rowDimension=this.colList.filter(function(e){return 1===e.dimension}),this.colDimension=this.colList.filter(function(e){return 2===e.dimension}),this.valDimension=this.colList.filter(function(e){return 3===e.dimension}),setTimeout(function(){t.lists[0].value=t.zero,t.listsCache=t.zero,t.lists[1].value=t.rowDimension,t.lists[2].value=t.colDimension,t.lists[3].value=t.valDimension})))}},e.prototype.moved=function(e,t){var i=this;if(t.splice(e,1),this.selectedDimesion(),this.schemaValue){if(1===this.schemaValue.isProtected||"1"===this.schemaValue.isProtected)return void this.msgService.info(this.localizeService.getValue("ideCmp.schemaManager.message.validate.isProtected"));this.schemaValue.schemaValue=JSON.stringify(this.schemaValue.schemaValue),this.schemaManagerService.saveSchema({schema:JSON.stringify(this.schemaValue)},this.queryRelativeUrl).subscribe(function(){i.renderService.render({queryId:i.queryId,spread:i.spread,controlType:i.controlType,qoManagerCode:i.qoManagerCode,queryRelativeUrl:i.queryRelativeUrl,schemaValue:i.schemaValue,filterCondition:i.conditionExpression,groupType:i.groupType,voId:i.voId,jointsearchInfoList:i.jointsearchInfoList,fromCache:!0,qdpView:i.qdpView}),i.schemaValue.schemaValue="string"==typeof i.schemaValue.schemaValue?JSON.parse(i.schemaValue.schemaValue):i.schemaValue.schemaValue},function(e){i.formErrorService.exception(e.Message,e)})}},e.prototype.crosstabColumnValidate=function(e){var t=!1;if("crosstab"===this.controlType)for(var i=0;i<e.length;i++)if(4!==e[i].groupAggre&&4!==e[i].totalAggre&&!"int,integer,float,double,decimal,number".includes(e[i].type?e[i].type.toLowerCase():"")){t=!0;break}return t},e.prototype.selectedDimesion=function(){if(this.colList=[],this.lists[0]&&(this.lists[0].value.forEach(function(e){e.dimension=0,e.isGroup=!1,e.groupAggre=0}),this.colList=this.lists[0].value),this.lists[1]&&(this.lists[1].value.forEach(function(e){e.dimension=1,e.isGroup=!0,e.groupAggre=0}),0===this.colList.length?this.colList=this.lists[1].value:this.colList=this.colList.concat(this.lists[1].value)),this.lists[2]&&(this.lists[2].value.forEach(function(e){e.dimension=2,e.isGroup=!0,e.groupAggre=0}),0===this.colList.length?this.colList=this.lists[2].value:this.colList=this.colList.concat(this.lists[2].value)),this.lists[3]&&(this.lists[3].value.forEach(function(e){e.dimension=3,e.isGroup=!1,e.groupAggre=1}),0===this.colList.length?this.colList=this.lists[3].value:this.colList=this.colList.concat(this.lists[3].value)),0<this.colList.length){try{this.isCompare=b.JSONUtils.Compare({schema:this.schemaValue.schemaValue.columnOption.colList},{schema:this.colList})}catch(e){}this.schemaValue.schemaValue.columnOption.colList=this.colList}},e.prototype.dimensionSearchValueOnChange=function(t){if(t){var e=this.listsCache.find(function(e){return 0<=e.name.indexOf(t)});this.lists[0].value=v(e)}else this.lists[0].value=v(this.listsCache)},e.prototype.dndListChange0=function(e){this.lists&&this.lists.length&&(this.lists[0].value=e)},e.prototype.dndListChange1=function(e){this.lists&&this.lists.length&&(this.lists[1].value=e)},e.prototype.dndListChange2=function(e){this.lists&&this.lists.length&&(this.lists[2].value=e)},e.prototype.dndListChange3=function(e){if(this.crosstabColumnValidate(e)){for(var t=0;t<e.length;t++){var i=e[t].dimension-0;3!=i&&(this.lists[i].value=v(this.lists[i].value,[e.splice(t,1)[0]]))}this.msgService.warning(this.localizeService.getValue("ideCmp.schemaManager.message.validate.crosstabValueDimension"))}else this.lists&&this.lists.length&&(this.lists[3].value=e)},e.decorators=[{type:h.Component,args:[{selector:"dimension-setting",template:'<div class="container f-utils-fill-flex-column h-100">\r\n  <div class="simpleDemo f-utils-fill-flex-row">\r\n    <div class="col-md-6 f-utils-flex-column p-1">\r\n      <div class="card f-utils-fill-flex-column">\r\n        <div class="card-body f-utils-fill-flex-column p-0">\r\n          <div class="cardTitle mb-2 pt-2">\r\n            <span id="unselected" class="f-icon pt-1 pr-2 pl-2" role="presentation">\r\n              <img src="data:image/svg+xml;charset=utf-8;base64,PHN2ZyB3aWR0aD0nMTZweCcgaGVpZ2h0PScxNnB4JyB2aWV3Qm94PScwIDAgMTYgMTYnIHZlcnNpb249JzEuMScgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB4bWxuczp4bGluaz0naHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayc+PHRpdGxlPuW+hemAieWtl+autTwvdGl0bGU+PGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+PGcgaWQ9J+mhtemdoi0xJyBzdHJva2U9J25vbmUnIHN0cm9rZS13aWR0aD0nMScgZmlsbD0nbm9uZScgZmlsbC1ydWxlPSdldmVub2RkJyBvcGFjaXR5PScwLjQ1OTU0MjQxMSc+PGcgaWQ9JzHjgIHmn6Xor6JVSeiuvuiuoScgdHJhbnNmb3JtPSd0cmFuc2xhdGUoLTkzMi4wMDAwMDAsIC0xNTEuMDAwMDAwKScgZmlsbD0nIzAwMDAwMCcgZmlsbC1ydWxlPSdub256ZXJvJz48ZyBpZD0n57yW57uELTI2JyB0cmFuc2Zvcm09J3RyYW5zbGF0ZSg4OTguMDAwMDAwLCA3NS4wMDAwMDApJz48ZyBpZD0n57yW57uELTI0JyB0cmFuc2Zvcm09J3RyYW5zbGF0ZSgyMC4wMDAwMDAsIDY1LjAwMDAwMCknPjxnIGlkPSfnvJbnu4QtMjEnIHRyYW5zZm9ybT0ndHJhbnNsYXRlKDEuMDAwMDAwLCAxLjAwMDAwMCknPjxnIGlkPSdzaG91Y2FuZy0yJyB0cmFuc2Zvcm09J3RyYW5zbGF0ZSgxMy4wMDAwMDAsIDEwLjAwMDAwMCknPjxwYXRoIGQ9J00xMS41NjA5NDkyLDE0LjQ3MjcxODMgQzExLjM2NDAzMzIsMTQuNDcyNzE4MyAxMS4xNDI4MzU5LDE0LjQxNjE4MzYgMTAuOTM3NTI1NCwxNC4zMTM1NjI1IEw4LjAwNzc1MTk1LDEyLjg0ODE4MzYgTDUuMDU5ODM1OTQsMTQuMzExMTgzNiBDNC44NzMxNDY0OCwxNC40MTA1NzgxIDQuNjU5NDQxNDEsMTQuNDYyODczIDQuNDQxNTI1MzksMTQuNDYyODczIEM0LjE1ODM1ODQyLDE0LjQ2MzkxNTcgMy44ODI0MTU1NCwxNC4zNzM1NDU4IDMuNjU0NzIyNjYsMTQuMjA1MTk5MiBDMy4yNDIxNDY0OCwxMy44OTU4MDQ3IDMuMDMwNzM4MjgsMTMuMzU5NTkzNyAzLjEyODMyODEyLDEyLjg3MTQ5NDEgTDMuNzMxMjQ0MTQsOS43NDM4ODg2NyBMMS40MjAzMjgxMiw3LjU4OTc4OTA2IEMxLjA2MzM4MzQyLDcuMjI4MTM2ODYgMC45MjY0MjQ0NTgsNi43MDM1NjQzOCAxLjA2MTAxNzU4LDYuMjEzNTc4MTIgTDEuMDY1NjM4NjcsNi4xOTc2OTE0MSBDMS4yMzM2Mzg2Nyw1LjY5NDE4MzU5IDEuNjUwNDEyMTEsNS4zNDEzODA4NiAyLjE1NTc1MTk1LDUuMjczNjkxNDEgTDUuMzY2NDQxNDEsNC42ODk5MDIzNCBMNi44MDc1MjUzOSwxLjc2MzA0MTAyIEM3LjAzOTAxNzU4LDEuMjk5NjMyODEgNy41MDk4NDk2MSwxLjAwMTg1OTM3IDguMDA3NzUxOTUsMS4wMDE4NTkzNyBDOC41MjcxNDY0OCwxLjAwMTg1OTM3IDkuMDEwMTQ2NDgsMS4zMTA4NDM3NSA5LjIxMjY1NDMsMS43NzE0NDkyMiBMMTAuNjQ5MTMwOSw0LjY4OTAyNzM0IEwxMy44NjAzMTI1LDUuMjUwNDQ5MjIgQzE0LjM2OTg3NDcsNS4zMjQzMDAwMyAxNC43ODg3MTU0LDUuNjkwMjA3NjIgMTQuOTMwMzI4MSw2LjE4NTIzNjMzIEMxNS4wODg4NDQ4LDYuNjcxNzczNDkgMTQuOTU5MzY4Miw3LjIwNjExMjA4IDE0LjU5NTcyMjcsNy41NjYxMjMwNSBMMTQuNTg3ODIwMyw3LjU3NDAzOTA2IEwxMi4yODM0MjU4LDkuNzQ0MDM5MDYgTDEyLjg2NTgyMDMsMTIuODc3MjIyNyBDMTIuOTU5NjA5NCwxMy4zNzg0MzM2IDEyLjc2MDMyODEsMTMuODg0MzIwMyAxMi4zNDU0NDE0LDE0LjE5OTc0NDEgQzEyLjEyMzMxODEsMTQuMzc4NjAyMiAxMS44NDYxMjE3LDE0LjQ3NTA0MTMgMTEuNTYwOTQ5MiwxNC40NzI3MTgzIEwxMS41NjA5NDkyLDE0LjQ3MjcxODMgWiBNOC4wMDg4MDQ2OSwxMS43NDY1MDM5IEwxMS4wODYyNzU0LDEzLjI4NTQ2NDggQzExLjE3NjcxNDgsMTMuMzMxMTAxNiAxMS4yODA4ODA5LDEzLjM1OTY2MjEgMTEuMzUyMDU2NiwxMy4zNTk2NjIxIEMxMS40NjE4MjgxLDEzLjM1OTY2MjEgMTEuNTYzNzUyLDEzLjMyNTkxOTkgMTEuNjM4NDQxNCwxMy4yNjM1NDg4IEwxMS42NTI1MDk4LDEzLjI1MjA2NDUgQzExLjgyNzM3MywxMy4xMjA3NDYxIDExLjkxMjU0ODgsMTIuOTEyNDI3NyAxMS44NzQzMzU5LDEyLjcwODEwMTYgTDExLjI1NDgzNTksOS4zNzE5NzI2NiBMMTMuNzA0NDk0MSw3LjA2NTE4NTU1IEMxMy44NTQ3NzU0LDYuOTEyNzMwNDcgMTMuOTA2MjIyNyw2LjY5NDQwNDMgMTMuODM5NDM1NSw2LjQ5MzU2NDQ1IEwxMy44MzI4NzMsNi40NzI1MDk3NyBDMTMuNzc4OTIxMiw2LjI3ODAxNzY2IDEzLjYxNDIyNjEsNi4xMzQ0MTAzMyAxMy40MTQxOTkyLDYuMTA3NDQzMzYgTDEzLjQwMDE5OTIsNi4xMDUyODMyIEwxMC4wMTA4MDQ3LDUuNTEyNjYyMTEgTDguNDg1NDg4MjgsMi40MTQxOTE0MSBDOC40MTEyMDg5OCwyLjI0MTA3ODEyIDguMjEwNDUxMTcsMi4xMTU0MzM1OSA4LjAwNzQ1MTE3LDIuMTE1NDMzNTkgQzcuODA4MDE5NTMsMi4xMTU0MzM1OSA3LjYxNzMzNzg5LDIuMjQwMjQ0MTQgNy41MjA2Nzc3MywyLjQzMzA4NTk0IEw2LjAwNTA1NDY5LDUuNTExMzM1OTQgTDIuNTk3NzIyNjYsNi4xMzAyODkwNiBDMi4zOTA4MTI1LDYuMTU2MjUxOTUgMi4yMzAwMTc1OCw2LjI5MzczNjMzIDIuMTU1ODIwMzEsNi41MDgwNzAzMSBDMi4xMDMxMDE1Niw2LjcwNDAwMTk1IDIuMTY1NDcyNjYsNi45Mzk4OTY0OCAyLjMwOTUzMzIsNy4wODcxMTUyMyBMNC43NjE4NTc0Miw5LjM3MjM5NjQ4IEw0LjExODI2NzU4LDEyLjcxMDM1NzQgQzQuMDc5NjMwODYsMTIuOTAzMjY3NiA0LjE3MDk3MjY2LDEzLjEyNTUxNzYgNC4zNDAwOTM3NSwxMy4yNTI1MDIgQzQuNDI0ODU5MzcsMTMuMzE2MjEyOSA0LjUzNDY5OTIyLDEzLjM1MTM0OTYgNC42NDk4NDM3NSwxMy4zNTEzNDk2IEM0LjczODYwMTU2LDEzLjM1MTM0OTYgNC44MjM4MDQ2OSwxMy4zMzA2MjMgNC44OTcxNjc5NywxMy4yOTExMzg3IEw0LjkwNzcyMjY2LDEzLjI4NDk4NjMgTDguMDA4ODA0NjksMTEuNzQ2NTAzOSBaJyBpZD0n5b2i54q2Jz48L3BhdGg+PC9nPjwvZz48L2c+PC9nPjwvZz48L2c+PC9zdmc+" style="width: 15px; height: 15px; display: block;" />\r\n            </span>\r\n            <span class="pl-3 dimensionTitle">{{lists && lists.length ? lists[0].name : \'\'}}</span>\r\n          </div>\r\n          <input-group [groupText]="groupIcon" class="m-1" [(value)]="searchText"\r\n            (valueChange)="dimensionSearchValueOnChange($event)"></input-group>\r\n          <ul id="unselectFieldList" class="f-utils-overflow-xhya f-utils-fill pb-1" [dndList]="lists && lists.length ? lists[0].value : []"  (dndListChange)="dndListChange0($event)">\r\n            <li *ngFor="let item of (lists && lists.length ? lists[0].value : []); let i = index;" [dndDraggable]="item"\r\n              (dndMoved)="moved(i, lists[0].value)" dndEffectAllowed="move" (dndSelected)="models.selected = item"\r\n              [ngClass]="{\'selected\': models.selected === item}">\r\n              <span class="unselectFieldFront mr-2" *ngIf="\'int,float,double,decimal,number\'.includes(item.type)==false">Abc</span>\r\n              <span class="unselectFieldFront mr-2" *ngIf="\'int,float,double,decimal,number\'.includes(item.type)==true">123</span>\r\n              <span class="unselectField">{{item.name}}</span>\r\n            </li>\r\n          </ul>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class="col-md-6 f-utils-flex-column p-1">\r\n      <div class="card f-utils-fill-flex-column">\r\n        <div class="card-body  f-utils-fill-flex-column p-0">\r\n          <div class="cardTitle mb-2 pt-2">\r\n            <span id="valuefield" class="f-icon pt-1 pr-2 pl-2" role="presentation">\r\n              <img src="data:image/svg+xml;charset=utf-8;base64,PHN2ZyB3aWR0aD0nMTZweCcgaGVpZ2h0PScxNnB4JyB2aWV3Qm94PScwIDAgMTYgMTYnIHZlcnNpb249JzEuMScgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB4bWxuczp4bGluaz0naHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayc+PHRpdGxlPuWAvOe7tOW6pjwvdGl0bGU+PGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+PGcgaWQ9J+mhtemdoi0xJyBzdHJva2U9J25vbmUnIHN0cm9rZS13aWR0aD0nMScgZmlsbD0nbm9uZScgZmlsbC1ydWxlPSdldmVub2RkJyBvcGFjaXR5PScwLjQ1OTU0MjQxMSc+PGcgaWQ9JzHjgIHmn6Xor6JVSeiuvuiuoScgdHJhbnNmb3JtPSd0cmFuc2xhdGUoLTExNTEuMDAwMDAwLCAtMTUyLjAwMDAwMCknIGZpbGw9JyMwMDAwMDAnIGZpbGwtcnVsZT0nbm9uemVybyc+PGcgaWQ9J+e8lue7hC0yNicgdHJhbnNmb3JtPSd0cmFuc2xhdGUoODk4LjAwMDAwMCwgNzUuMDAwMDAwKSc+PGcgaWQ9J+e8lue7hC0zMicgdHJhbnNmb3JtPSd0cmFuc2xhdGUoMjM5LjAwMDAwMCwgNjUuMDAwMDAwKSc+PGcgaWQ9J+e8lue7hC0zMSc+PGcgaWQ9J+e8lue7hC0yMeWkh+S7vScgdHJhbnNmb3JtPSd0cmFuc2xhdGUoMS4wMDAwMDAsIDEuMDAwMDAwKSc+PGcgaWQ9J3dlaWR1JyB0cmFuc2Zvcm09J3RyYW5zbGF0ZSgxMy4wMDAwMDAsIDExLjAwMDAwMCknPjxwYXRoIGQ9J00xMS41NSw0Ljk4NCBDMTIuMTMsNC42NTQgMTIuNjI0LDUuNTI0IDEyLjA0NCw1Ljg1MyBMOS4wMDIsNy42MiBDOS4wMDQsNy42MzYgOS4wMTIsNy42NSA5LjAxMiw3LjY2NiBMOS4wMTIsMTEuNjk4IEM5LjAxMiwxMS45NzQxNDI0IDguNzg4MTQyMzcsMTIuMTk4IDguNTEyLDEyLjE5OCBDOC4yMzU4NTc2MywxMi4xOTggOC4wMTIsMTEuOTc0MTQyNCA4LjAxMiwxMS42OTggTDguMDEyLDcuNjg3IEw0LjkwNiw1LjkwOSBDNC4zMjYsNS41NzkgNC44MjEsNC43MDkgNS40MDEsNS4wMzkgTDguNDQ5LDYuNzg1IEwxMS41NSw0Ljk4NCBaIE0xNC4yNTQsMy4xMzIgQzE0LjcxNywzLjQwNCAxNC45OTk5OTk1LDMuOSAxNC45OTk5OTk1LDQuNDM2IEwxNC45OTk5OTk1LDEwLjY0OSBDMTQuOTk5OTk5NSwxMS4xOTIgMTQuNzEsMTEuNjkzIDE0LjIzOCwxMS45NjIgTDkuMjM4LDE0LjgwNSBDOC43OCwxNS4wNjUgOC4yMTksMTUuMDY1IDcuNzYyLDE0LjgwNSBMMi43NjIsMTEuOTYyIEMyLjI5MDQ2NDQ2LDExLjY5MzEwOTEgMS45OTk1MzgxNSwxMS4xOTE4MTQ4IDEuOTk5OTk5NDUsMTAuNjQ5IEwxLjk5OTk5OTQ1LDQuNDM2IEMxLjk5OTk5OTQ1LDMuOSAyLjI4MywzLjQwNCAyLjc0NSwzLjEzMiBMNy43NDMsMC4yMDUgQzguMjA5MzUxMzMsLTAuMDY3ODY4Mjc5OSA4Ljc4NjY0ODY3LC0wLjA2Nzg2ODI3OTkgOS4yNTMsMC4yMDUgTDE0LjI1NSwzLjEzMiBMMTQuMjU0LDMuMTMyIFogTTEzLjk5OTk5OTgsMTAuNjUgTDEzLjk5OTk5OTgsNC40MzYgQzE0LjAwMDU2MDQsNC4yNTc0ODA4NiAxMy45MDYwODU2LDQuMDkyMTQ5OTUgMTMuNzUyLDQuMDAyIEw4Ljc0OCwxLjA3NCBDOC41OTI3MTAyMywwLjk4Mjg5MTQzOCA4LjQwMDI4OTc3LDAuOTgyODkxNDM4IDguMjQ1LDEuMDc0IEwzLjI0OCw0LjAwMiBDMy4wOTQyMTQ3Niw0LjA5MjQ0Njk2IDIuOTk5ODQ3OTUsNC4yNTc1ODg4OCAyLjk5OTk5OTgyLDQuNDM2IEwyLjk5OTk5OTgyLDEwLjY0OSBDMi45OTk5OTk4MiwxMC44Mjk5Njc1IDMuMDk2OTYxOTUsMTAuOTk3MDY1IDMuMjU0LDExLjA4NyBMOC4yNTQsMTMuOTMgQzguNDA2LDE0LjAxNiA4LjU5NCwxNC4wMTYgOC43NDYsMTMuOTMgTDEzLjc0NiwxMS4wODcgQzEzLjkwMzMzMzIsMTAuOTk3MzYyMSAxNC4wMDAzNDM3LDEwLjgzMDA3NjEgMTMuOTk5OTk5OCwxMC42NDkgTDEzLjk5OTk5OTgsMTAuNjUgWicgaWQ9J+W9oueKtic+PC9wYXRoPjwvZz48L2c+PC9nPjwvZz48L2c+PC9nPjwvZz48L3N2Zz4=" style="width: 15px; height: 15px; display: block;" />\r\n            </span>\r\n            <span class="pl-3 dimensionTitle">{{lists && lists.length ? lists[3].name : \'\'}}</span>\r\n          </div>\r\n          <div id="valuefieldimg" *ngIf="lists && lists.length ? (lists[3]?.value?.length < 1) : true"\r\n            class="f-utils-absolute-all f-utils-flex-column justify-content-center align-items-center"\r\n            role="presentation" style="align-items: center; top: 36px; z-index: 10;">\r\n            <img src="data:image/svg+xml;charset=utf-8;base64,PHN2ZyB3aWR0aD0nNTBweCcgaGVpZ2h0PSc1MHB4JyB2aWV3Qm94PScwIDAgNTAgNTAnIHZlcnNpb249JzEuMScgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB4bWxuczp4bGluaz0naHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayc+PHRpdGxlPuWIl+e7tOW6puWbvjwvdGl0bGU+PGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+PGRlZnM+PHJlY3QgaWQ9J3BhdGgtMScgeD0nMjYnIHk9JzMxJyB3aWR0aD0nMjQnIGhlaWdodD0nMTgnIHJ4PScwLjUnPjwvcmVjdD48ZmlsdGVyIHg9Jy02LjIlJyB5PSctOC4zJScgd2lkdGg9JzExMi41JScgaGVpZ2h0PScxMTYuNyUnIGZpbHRlclVuaXRzPSdvYmplY3RCb3VuZGluZ0JveCcgaWQ9J2ZpbHRlci0yJz48ZmVPZmZzZXQgZHg9JzAnIGR5PScwJyBpbj0nU291cmNlQWxwaGEnIHJlc3VsdD0nc2hhZG93T2Zmc2V0T3V0ZXIxJz48L2ZlT2Zmc2V0PjxmZUdhdXNzaWFuQmx1ciBzdGREZXZpYXRpb249JzAuNScgaW49J3NoYWRvd09mZnNldE91dGVyMScgcmVzdWx0PSdzaGFkb3dCbHVyT3V0ZXIxJz48L2ZlR2F1c3NpYW5CbHVyPjxmZUNvbXBvc2l0ZSBpbj0nc2hhZG93Qmx1ck91dGVyMScgaW4yPSdTb3VyY2VBbHBoYScgb3BlcmF0b3I9J291dCcgcmVzdWx0PSdzaGFkb3dCbHVyT3V0ZXIxJz48L2ZlQ29tcG9zaXRlPjxmZUNvbG9yTWF0cml4IHZhbHVlcz0nMCAwIDAgMCAwLjExNDg0Mzc1IDAgMCAwIDAgMC41MTU4ODE4MTcgMCAwIDAgMCAxIDAgMCAwIDAuNzI2NDgwNTUxIDAnIHR5cGU9J21hdHJpeCcgaW49J3NoYWRvd0JsdXJPdXRlcjEnPjwvZmVDb2xvck1hdHJpeD48L2ZpbHRlcj48bGluZWFyR3JhZGllbnQgeDE9JzUwJScgeTE9JzEwMCUnIHgyPSc1MCUnIHkyPScwJScgaWQ9J2xpbmVhckdyYWRpZW50LTMnPjxzdG9wIHN0b3AtY29sb3I9JyNEQUVCRkYnIHN0b3Atb3BhY2l0eT0nMC4yMDMwNDMwNTEnIG9mZnNldD0nMCUnPjwvc3RvcD48c3RvcCBzdG9wLWNvbG9yPScjQjNEMkZGJyBzdG9wLW9wYWNpdHk9JzAuNDczMDM4NjgnIG9mZnNldD0nMTAwJSc+PC9zdG9wPjwvbGluZWFyR3JhZGllbnQ+PC9kZWZzPjxnIGlkPSfpobXpnaItMScgc3Ryb2tlPSdub25lJyBzdHJva2Utd2lkdGg9JzEnIGZpbGw9J25vbmUnIGZpbGwtcnVsZT0nZXZlbm9kZCc+PGcgaWQ9JzHjgIHmn6Xor6JVSeiuvuiuoScgdHJhbnNmb3JtPSd0cmFuc2xhdGUoLTEyMTQuMDAwMDAwLCAtNTY1LjAwMDAwMCknPjxnIGlkPSfnvJbnu4QtMjYnIHRyYW5zZm9ybT0ndHJhbnNsYXRlKDg5OC4wMDAwMDAsIDc1LjAwMDAwMCknPjxnIGlkPSfnvJbnu4QtMzAnIHRyYW5zZm9ybT0ndHJhbnNsYXRlKDIzOS4wMDAwMDAsIDM3NS4wMDAwMDApJz48ZyBpZD0n57yW57uELTM05aSH5Lu9JyB0cmFuc2Zvcm09J3RyYW5zbGF0ZSg0MC4wMDAwMDAsIDExNS4wMDAwMDApJz48ZyBpZD0n57yW57uELTMzJyB0cmFuc2Zvcm09J3RyYW5zbGF0ZSgzNy4wMDAwMDAsIDAuMDAwMDAwKSc+PGcgaWQ9J+e8lue7hC01Jz48cmVjdCBpZD0n55+p5b2i5aSH5Lu9LTMnIGZpbGw9JyNCM0QyRkYnIG9wYWNpdHk9JzAuMjQzODYxNjA3JyB4PScyNicgeT0nMTAnIHdpZHRoPScyNCcgaGVpZ2h0PScxOCcgcng9JzAuNSc+PC9yZWN0PjxnIGlkPSfnn6nlvaLlpIfku70tNicgb3BhY2l0eT0nMC41OTYxMjE2NTInPjx1c2UgZmlsbD0nYmxhY2snIGZpbGwtb3BhY2l0eT0nMScgZmlsdGVyPSd1cmwoI2ZpbHRlci0yKScgeGxpbms6aHJlZj0nI3BhdGgtMSc+PC91c2U+PHJlY3Qgc3Ryb2tlLW9wYWNpdHk9JzAuMjIzNDQ4NDI3JyBzdHJva2U9JyMwMDUxQjknIHN0cm9rZS13aWR0aD0nMScgc3Ryb2tlLWxpbmVqb2luPSdzcXVhcmUnIGZpbGw9JyM3QkIyRjgnIGZpbGwtcnVsZT0nZXZlbm9kZCcgeD0nMjYuNScgeT0nMzEuNScgd2lkdGg9JzIzJyBoZWlnaHQ9JzE3JyByeD0nMC41Jz48L3JlY3Q+PC9nPjxyZWN0IGlkPSfnn6nlvaLlpIfku70tMTInIGZpbGw9JyNCM0QyRkYnIG9wYWNpdHk9JzAuMjQzODYxNjA3JyB4PScwJyB5PScxMCcgd2lkdGg9JzI0JyBoZWlnaHQ9JzE4JyByeD0nMC41Jz48L3JlY3Q+PHJlY3QgaWQ9J+efqeW9ouWkh+S7vS0xNCcgZmlsbD0nI0IzRDJGRicgb3BhY2l0eT0nMC4yNDM4NjE2MDcnIHg9JzAnIHk9JzEnIHdpZHRoPSc1MCcgaGVpZ2h0PSc2JyByeD0nMC41Jz48L3JlY3Q+PHJlY3QgaWQ9J+efqeW9ouWkh+S7vS0xOCcgZmlsbD0ndXJsKCNsaW5lYXJHcmFkaWVudC0zKScgeD0nMCcgeT0nMzEnIHdpZHRoPScyNCcgaGVpZ2h0PScxOCcgcng9JzAuNSc+PC9yZWN0PjwvZz48L2c+PC9nPjwvZz48L2c+PC9nPjwvZz48L3N2Zz4=" style="width: 50px;height: 56px;display: block;">\r\n            <span class="imgFont">{{localizeService?.getValue(\'spread.crossTable.valueDimensionTitle\')}}</span>\r\n          </div>\r\n          <ul class="f-utils-overflow-xhya f-utils-fill pb-1" style="z-index: 20" [dndList]="lists && lists.length ? lists[3].value : []" (dndListChange)="dndListChange3($event)">\r\n            <li *ngFor="let item of (lists && lists.length ? lists[3].value : []); let i = index;" [dndDraggable]="item" class="mb-1 p-1"\r\n              (dndMoved)="moved(i, lists[3].value)" dndEffectAllowed="move" (dndSelected)="models.selected = item"\r\n              [ngClass]="{\'selected\': models.selected === item}">\r\n              {{item.name}}\r\n            </li>\r\n          </ul>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n  <div class="simpleDemo f-utils-fill-flex-row">\r\n    <div class="col-md-6 f-utils-flex-column p-1">\r\n      <div class="card f-utils-fill-flex-column">\r\n        <div class="card-body  f-utils-fill-flex-column p-0">\r\n          <div class="cardTitle mb-2 pt-2">\r\n            <span id="rowfield" class="f-icon pt-1 pr-2 pl-2" role="presentation">\r\n              <img src="data:image/svg+xml;charset=utf-8;base64,PHN2ZyB3aWR0aD0nMTZweCcgaGVpZ2h0PScxNnB4JyB2aWV3Qm94PScwIDAgMTYgMTYnIHZlcnNpb249JzEuMScgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB4bWxuczp4bGluaz0naHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayc+PHRpdGxlPuihjOe7tOW6pjwvdGl0bGU+PGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+PGcgaWQ9J+mhtemdoi0xJyBzdHJva2U9J25vbmUnIHN0cm9rZS13aWR0aD0nMScgZmlsbD0nbm9uZScgZmlsbC1ydWxlPSdldmVub2RkJz48ZyBpZD0nMeOAgeafpeivolVJ6K6+6K6hJyB0cmFuc2Zvcm09J3RyYW5zbGF0ZSgtOTMxLjAwMDAwMCwgLTQ2MC4wMDAwMDApJyBzdHJva2U9JyM5Nzk3OTcnPjxnIGlkPSfnvJbnu4QtMjYnIHRyYW5zZm9ybT0ndHJhbnNsYXRlKDg5OC4wMDAwMDAsIDc1LjAwMDAwMCknPjxnIGlkPSfnvJbnu4QtMjknIHRyYW5zZm9ybT0ndHJhbnNsYXRlKDIwLjAwMDAwMCwgMzc1LjAwMDAwMCknPjxnIGlkPSfnvJbnu4QtMjHlpIfku70tMicgdHJhbnNmb3JtPSd0cmFuc2xhdGUoMS4wMDAwMDAsIDAuMDAwMDAwKSc+PGcgaWQ9J+e8lue7hC0yMicgdHJhbnNmb3JtPSd0cmFuc2xhdGUoMTIuMDAwMDAwLCAxMC4wMDAwMDApJz48cmVjdCBpZD0n55+p5b2iJyB4PScxLjUnIHk9JzIuNScgd2lkdGg9JzQuMjUnIGhlaWdodD0nNC4yNScgcng9JzEnPjwvcmVjdD48cmVjdCBpZD0n55+p5b2iJyBmaWxsPScjRDhEOEQ4JyB4PSc4LjUnIHk9JzMuMzc1JyB3aWR0aD0nNScgaGVpZ2h0PScxJz48L3JlY3Q+PHJlY3QgaWQ9J+efqeW9ouWkh+S7vS0xMicgZmlsbD0nI0Q4RDhEOCcgeD0nOC41JyB5PScxMC4zNzUnIHdpZHRoPSc1JyBoZWlnaHQ9JzEnPjwvcmVjdD48cmVjdCBpZD0n55+p5b2i5aSH5Lu9LTcnIGZpbGw9JyNEOEQ4RDgnIHg9JzguNScgeT0nNicgd2lkdGg9JzUnIGhlaWdodD0nMSc+PC9yZWN0PjxyZWN0IGlkPSfnn6nlvaLlpIfku70tMTMnIGZpbGw9JyNEOEQ4RDgnIHg9JzguNScgeT0nMTMnIHdpZHRoPSc1JyBoZWlnaHQ9JzEnPjwvcmVjdD48cmVjdCBpZD0n55+p5b2i5aSH5Lu9LTYnIHg9JzEuNScgeT0nOS41JyB3aWR0aD0nNC4yNScgaGVpZ2h0PSc0LjI1JyByeD0nMSc+PC9yZWN0PjwvZz48L2c+PC9nPjwvZz48L2c+PC9nPjwvc3ZnPg==" style="width: 15px; height: 15px; display: block;" />\r\n            </span>\r\n            <span class="pl-3 dimensionTitle">{{lists && lists.length ? lists[1].name : \'\'}}</span>\r\n          </div>\r\n          <div id="rowfieldimg" *ngIf="lists && lists.length ? (lists[1]?.value?.length < 1) : true"\r\n            class="f-utils-absolute-all f-utils-flex-column justify-content-center align-items-center"\r\n            role="presentation" style="align-items: center; top: 36px; z-index: 10;">\r\n            <img src="data:image/svg+xml;charset=utf-8;base64,PHN2ZyB3aWR0aD0nNTBweCcgaGVpZ2h0PSc1MHB4JyB2aWV3Qm94PScwIDAgNTAgNTAnIHZlcnNpb249JzEuMScgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB4bWxuczp4bGluaz0naHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayc+PHRpdGxlPuWIl+e7tOW6puWbvjwvdGl0bGU+PGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+PGRlZnM+PHJlY3QgaWQ9J3BhdGgtMScgeD0nMjYnIHk9JzMxJyB3aWR0aD0nMjQnIGhlaWdodD0nMTgnIHJ4PScwLjUnPjwvcmVjdD48ZmlsdGVyIHg9Jy02LjIlJyB5PSctOC4zJScgd2lkdGg9JzExMi41JScgaGVpZ2h0PScxMTYuNyUnIGZpbHRlclVuaXRzPSdvYmplY3RCb3VuZGluZ0JveCcgaWQ9J2ZpbHRlci0yJz48ZmVPZmZzZXQgZHg9JzAnIGR5PScwJyBpbj0nU291cmNlQWxwaGEnIHJlc3VsdD0nc2hhZG93T2Zmc2V0T3V0ZXIxJz48L2ZlT2Zmc2V0PjxmZUdhdXNzaWFuQmx1ciBzdGREZXZpYXRpb249JzAuNScgaW49J3NoYWRvd09mZnNldE91dGVyMScgcmVzdWx0PSdzaGFkb3dCbHVyT3V0ZXIxJz48L2ZlR2F1c3NpYW5CbHVyPjxmZUNvbXBvc2l0ZSBpbj0nc2hhZG93Qmx1ck91dGVyMScgaW4yPSdTb3VyY2VBbHBoYScgb3BlcmF0b3I9J291dCcgcmVzdWx0PSdzaGFkb3dCbHVyT3V0ZXIxJz48L2ZlQ29tcG9zaXRlPjxmZUNvbG9yTWF0cml4IHZhbHVlcz0nMCAwIDAgMCAwLjExNDg0Mzc1IDAgMCAwIDAgMC41MTU4ODE4MTcgMCAwIDAgMCAxIDAgMCAwIDAuNzI2NDgwNTUxIDAnIHR5cGU9J21hdHJpeCcgaW49J3NoYWRvd0JsdXJPdXRlcjEnPjwvZmVDb2xvck1hdHJpeD48L2ZpbHRlcj48bGluZWFyR3JhZGllbnQgeDE9JzUwJScgeTE9JzEwMCUnIHgyPSc1MCUnIHkyPScwJScgaWQ9J2xpbmVhckdyYWRpZW50LTMnPjxzdG9wIHN0b3AtY29sb3I9JyNEQUVCRkYnIHN0b3Atb3BhY2l0eT0nMC4yMDMwNDMwNTEnIG9mZnNldD0nMCUnPjwvc3RvcD48c3RvcCBzdG9wLWNvbG9yPScjQjNEMkZGJyBzdG9wLW9wYWNpdHk9JzAuNDczMDM4NjgnIG9mZnNldD0nMTAwJSc+PC9zdG9wPjwvbGluZWFyR3JhZGllbnQ+PC9kZWZzPjxnIGlkPSfpobXpnaItMScgc3Ryb2tlPSdub25lJyBzdHJva2Utd2lkdGg9JzEnIGZpbGw9J25vbmUnIGZpbGwtcnVsZT0nZXZlbm9kZCc+PGcgaWQ9JzHjgIHmn6Xor6JVSeiuvuiuoScgdHJhbnNmb3JtPSd0cmFuc2xhdGUoLTEyMTQuMDAwMDAwLCAtNTY1LjAwMDAwMCknPjxnIGlkPSfnvJbnu4QtMjYnIHRyYW5zZm9ybT0ndHJhbnNsYXRlKDg5OC4wMDAwMDAsIDc1LjAwMDAwMCknPjxnIGlkPSfnvJbnu4QtMzAnIHRyYW5zZm9ybT0ndHJhbnNsYXRlKDIzOS4wMDAwMDAsIDM3NS4wMDAwMDApJz48ZyBpZD0n57yW57uELTM05aSH5Lu9JyB0cmFuc2Zvcm09J3RyYW5zbGF0ZSg0MC4wMDAwMDAsIDExNS4wMDAwMDApJz48ZyBpZD0n57yW57uELTMzJyB0cmFuc2Zvcm09J3RyYW5zbGF0ZSgzNy4wMDAwMDAsIDAuMDAwMDAwKSc+PGcgaWQ9J+e8lue7hC01Jz48cmVjdCBpZD0n55+p5b2i5aSH5Lu9LTMnIGZpbGw9JyNCM0QyRkYnIG9wYWNpdHk9JzAuMjQzODYxNjA3JyB4PScyNicgeT0nMTAnIHdpZHRoPScyNCcgaGVpZ2h0PScxOCcgcng9JzAuNSc+PC9yZWN0PjxnIGlkPSfnn6nlvaLlpIfku70tNicgb3BhY2l0eT0nMC41OTYxMjE2NTInPjx1c2UgZmlsbD0nYmxhY2snIGZpbGwtb3BhY2l0eT0nMScgZmlsdGVyPSd1cmwoI2ZpbHRlci0yKScgeGxpbms6aHJlZj0nI3BhdGgtMSc+PC91c2U+PHJlY3Qgc3Ryb2tlLW9wYWNpdHk9JzAuMjIzNDQ4NDI3JyBzdHJva2U9JyMwMDUxQjknIHN0cm9rZS13aWR0aD0nMScgc3Ryb2tlLWxpbmVqb2luPSdzcXVhcmUnIGZpbGw9JyM3QkIyRjgnIGZpbGwtcnVsZT0nZXZlbm9kZCcgeD0nMjYuNScgeT0nMzEuNScgd2lkdGg9JzIzJyBoZWlnaHQ9JzE3JyByeD0nMC41Jz48L3JlY3Q+PC9nPjxyZWN0IGlkPSfnn6nlvaLlpIfku70tMTInIGZpbGw9JyNCM0QyRkYnIG9wYWNpdHk9JzAuMjQzODYxNjA3JyB4PScwJyB5PScxMCcgd2lkdGg9JzI0JyBoZWlnaHQ9JzE4JyByeD0nMC41Jz48L3JlY3Q+PHJlY3QgaWQ9J+efqeW9ouWkh+S7vS0xNCcgZmlsbD0nI0IzRDJGRicgb3BhY2l0eT0nMC4yNDM4NjE2MDcnIHg9JzAnIHk9JzEnIHdpZHRoPSc1MCcgaGVpZ2h0PSc2JyByeD0nMC41Jz48L3JlY3Q+PHJlY3QgaWQ9J+efqeW9ouWkh+S7vS0xOCcgZmlsbD0ndXJsKCNsaW5lYXJHcmFkaWVudC0zKScgeD0nMCcgeT0nMzEnIHdpZHRoPScyNCcgaGVpZ2h0PScxOCcgcng9JzAuNSc+PC9yZWN0PjwvZz48L2c+PC9nPjwvZz48L2c+PC9nPjwvZz48L3N2Zz4=" style="width: 50px;height: 56px;display: block;">\r\n            <span class="imgFont">{{localizeService?.getValue(\'spread.crossTable.rowDimensionTitle\')}}</span>\r\n          </div>\r\n          <ul class="f-utils-overflow-xhya f-utils-fill pb-1" style="z-index: 20" [dndList]="lists && lists.length ? lists[1].value : []" (dndListChange)="dndListChange1($event)">\r\n            <li *ngFor="let item of (lists && lists.length ? lists[1].value : []); let i = index;" [dndDraggable]="item" class="mb-1 p-1"\r\n              (dndMoved)="moved(i, lists[1].value)" dndEffectAllowed="move" (dndSelected)="models.selected = item"\r\n              [ngClass]="{\'selected\': models.selected === item}">\r\n              {{item.name}}\r\n            </li>\r\n          </ul>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class="col-md-6 f-utils-flex-column p-1">\r\n      <div class="card f-utils-fill-flex-column">\r\n        <div class="card-body f-utils-fill-flex-column p-0">\r\n          <div class="cardTitle mb-2 pt-2">\r\n            <span id="colfield" class="f-icon pt-1 pr-2 pl-2" role="presentation">\r\n              <img src="data:image/svg+xml;charset=utf-8;base64,PHN2ZyB3aWR0aD0nMTdweCcgaGVpZ2h0PScxN3B4JyB2aWV3Qm94PScwIDAgMTcgMTcnIHZlcnNpb249JzEuMScgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB4bWxuczp4bGluaz0naHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayc+PHRpdGxlPuWIl+e7tOW6pjwvdGl0bGU+PGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+PGcgaWQ9J+mhtemdoi0xJyBzdHJva2U9J25vbmUnIHN0cm9rZS13aWR0aD0nMScgZmlsbD0nbm9uZScgZmlsbC1ydWxlPSdldmVub2RkJz48ZyBpZD0nMeOAgeafpeivolVJ6K6+6K6hJyB0cmFuc2Zvcm09J3RyYW5zbGF0ZSgtMTE1MC4wMDAwMDAsIC00NjAuMDAwMDAwKScgc3Ryb2tlPScjOTc5Nzk3Jz48ZyBpZD0n57yW57uELTI2JyB0cmFuc2Zvcm09J3RyYW5zbGF0ZSg4OTguMDAwMDAwLCA3NS4wMDAwMDApJz48ZyBpZD0n57yW57uELTMwJyB0cmFuc2Zvcm09J3RyYW5zbGF0ZSgyMzkuMDAwMDAwLCAzNzUuMDAwMDAwKSc+PGcgaWQ9J+e8lue7hC0yMeWkh+S7vS0zJyB0cmFuc2Zvcm09J3RyYW5zbGF0ZSgxLjAwMDAwMCwgMC4wMDAwMDApJz48ZyBpZD0n57yW57uELTIyJyB0cmFuc2Zvcm09J3RyYW5zbGF0ZSgyMC4xMjUwMDAsIDE4LjEyNTAwMCkgcm90YXRlKDkwLjAwMDAwMCkgdHJhbnNsYXRlKC0yMC4xMjUwMDAsIC0xOC4xMjUwMDApIHRyYW5zbGF0ZSgxMi4xMjUwMDAsIDEwLjEyNTAwMCknPjxyZWN0IGlkPSfnn6nlvaInIHg9JzEuNScgeT0nMi41JyB3aWR0aD0nNC4yNScgaGVpZ2h0PSc0LjI1JyByeD0nMSc+PC9yZWN0PjxyZWN0IGlkPSfnn6nlvaInIGZpbGw9JyNEOEQ4RDgnIHg9JzguNScgeT0nMy4zNzUnIHdpZHRoPSc1JyBoZWlnaHQ9JzEnPjwvcmVjdD48cmVjdCBpZD0n55+p5b2i5aSH5Lu9LTEyJyBmaWxsPScjRDhEOEQ4JyB4PSc4LjUnIHk9JzEwLjM3NScgd2lkdGg9JzUnIGhlaWdodD0nMSc+PC9yZWN0PjxyZWN0IGlkPSfnn6nlvaLlpIfku70tNycgZmlsbD0nI0Q4RDhEOCcgeD0nOC41JyB5PSc2JyB3aWR0aD0nNScgaGVpZ2h0PScxJz48L3JlY3Q+PHJlY3QgaWQ9J+efqeW9ouWkh+S7vS0xMycgZmlsbD0nI0Q4RDhEOCcgeD0nOC41JyB5PScxMycgd2lkdGg9JzUnIGhlaWdodD0nMSc+PC9yZWN0PjxyZWN0IGlkPSfnn6nlvaLlpIfku70tNicgeD0nMS41JyB5PSc5LjUnIHdpZHRoPSc0LjI1JyBoZWlnaHQ9JzQuMjUnIHJ4PScxJz48L3JlY3Q+PC9nPjwvZz48L2c+PC9nPjwvZz48L2c+PC9zdmc+" style="width: 15px; height: 15px; display: block;" />\r\n            </span>\r\n            <span class="pl-3 dimensionTitle">{{lists && lists.length ? lists[2].name : \'\'}}</span>\r\n          </div>\r\n          <div id="colfieldimg" *ngIf="lists && lists.length ? (lists[2]?.value?.length < 1) : true"\r\n            class="f-utils-absolute-all f-utils-flex-column justify-content-center align-items-center"\r\n            role="presentation" style="align-items: center; top: 36px; z-index: 10;">\r\n            <img src="data:image/svg+xml;charset=utf-8;base64,PHN2ZyB3aWR0aD0nNTBweCcgaGVpZ2h0PSc1MHB4JyB2aWV3Qm94PScwIDAgNTAgNTAnIHZlcnNpb249JzEuMScgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB4bWxuczp4bGluaz0naHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayc+PHRpdGxlPuWIl+e7tOW6puWbvjwvdGl0bGU+PGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+PGRlZnM+PHJlY3QgaWQ9J3BhdGgtMScgeD0nMjYnIHk9JzMxJyB3aWR0aD0nMjQnIGhlaWdodD0nMTgnIHJ4PScwLjUnPjwvcmVjdD48ZmlsdGVyIHg9Jy02LjIlJyB5PSctOC4zJScgd2lkdGg9JzExMi41JScgaGVpZ2h0PScxMTYuNyUnIGZpbHRlclVuaXRzPSdvYmplY3RCb3VuZGluZ0JveCcgaWQ9J2ZpbHRlci0yJz48ZmVPZmZzZXQgZHg9JzAnIGR5PScwJyBpbj0nU291cmNlQWxwaGEnIHJlc3VsdD0nc2hhZG93T2Zmc2V0T3V0ZXIxJz48L2ZlT2Zmc2V0PjxmZUdhdXNzaWFuQmx1ciBzdGREZXZpYXRpb249JzAuNScgaW49J3NoYWRvd09mZnNldE91dGVyMScgcmVzdWx0PSdzaGFkb3dCbHVyT3V0ZXIxJz48L2ZlR2F1c3NpYW5CbHVyPjxmZUNvbXBvc2l0ZSBpbj0nc2hhZG93Qmx1ck91dGVyMScgaW4yPSdTb3VyY2VBbHBoYScgb3BlcmF0b3I9J291dCcgcmVzdWx0PSdzaGFkb3dCbHVyT3V0ZXIxJz48L2ZlQ29tcG9zaXRlPjxmZUNvbG9yTWF0cml4IHZhbHVlcz0nMCAwIDAgMCAwLjExNDg0Mzc1IDAgMCAwIDAgMC41MTU4ODE4MTcgMCAwIDAgMCAxIDAgMCAwIDAuNzI2NDgwNTUxIDAnIHR5cGU9J21hdHJpeCcgaW49J3NoYWRvd0JsdXJPdXRlcjEnPjwvZmVDb2xvck1hdHJpeD48L2ZpbHRlcj48bGluZWFyR3JhZGllbnQgeDE9JzUwJScgeTE9JzEwMCUnIHgyPSc1MCUnIHkyPScwJScgaWQ9J2xpbmVhckdyYWRpZW50LTMnPjxzdG9wIHN0b3AtY29sb3I9JyNEQUVCRkYnIHN0b3Atb3BhY2l0eT0nMC4yMDMwNDMwNTEnIG9mZnNldD0nMCUnPjwvc3RvcD48c3RvcCBzdG9wLWNvbG9yPScjQjNEMkZGJyBzdG9wLW9wYWNpdHk9JzAuNDczMDM4NjgnIG9mZnNldD0nMTAwJSc+PC9zdG9wPjwvbGluZWFyR3JhZGllbnQ+PC9kZWZzPjxnIGlkPSfpobXpnaItMScgc3Ryb2tlPSdub25lJyBzdHJva2Utd2lkdGg9JzEnIGZpbGw9J25vbmUnIGZpbGwtcnVsZT0nZXZlbm9kZCc+PGcgaWQ9JzHjgIHmn6Xor6JVSeiuvuiuoScgdHJhbnNmb3JtPSd0cmFuc2xhdGUoLTEyMTQuMDAwMDAwLCAtNTY1LjAwMDAwMCknPjxnIGlkPSfnvJbnu4QtMjYnIHRyYW5zZm9ybT0ndHJhbnNsYXRlKDg5OC4wMDAwMDAsIDc1LjAwMDAwMCknPjxnIGlkPSfnvJbnu4QtMzAnIHRyYW5zZm9ybT0ndHJhbnNsYXRlKDIzOS4wMDAwMDAsIDM3NS4wMDAwMDApJz48ZyBpZD0n57yW57uELTM05aSH5Lu9JyB0cmFuc2Zvcm09J3RyYW5zbGF0ZSg0MC4wMDAwMDAsIDExNS4wMDAwMDApJz48ZyBpZD0n57yW57uELTMzJyB0cmFuc2Zvcm09J3RyYW5zbGF0ZSgzNy4wMDAwMDAsIDAuMDAwMDAwKSc+PGcgaWQ9J+e8lue7hC01Jz48cmVjdCBpZD0n55+p5b2i5aSH5Lu9LTMnIGZpbGw9JyNCM0QyRkYnIG9wYWNpdHk9JzAuMjQzODYxNjA3JyB4PScyNicgeT0nMTAnIHdpZHRoPScyNCcgaGVpZ2h0PScxOCcgcng9JzAuNSc+PC9yZWN0PjxnIGlkPSfnn6nlvaLlpIfku70tNicgb3BhY2l0eT0nMC41OTYxMjE2NTInPjx1c2UgZmlsbD0nYmxhY2snIGZpbGwtb3BhY2l0eT0nMScgZmlsdGVyPSd1cmwoI2ZpbHRlci0yKScgeGxpbms6aHJlZj0nI3BhdGgtMSc+PC91c2U+PHJlY3Qgc3Ryb2tlLW9wYWNpdHk9JzAuMjIzNDQ4NDI3JyBzdHJva2U9JyMwMDUxQjknIHN0cm9rZS13aWR0aD0nMScgc3Ryb2tlLWxpbmVqb2luPSdzcXVhcmUnIGZpbGw9JyM3QkIyRjgnIGZpbGwtcnVsZT0nZXZlbm9kZCcgeD0nMjYuNScgeT0nMzEuNScgd2lkdGg9JzIzJyBoZWlnaHQ9JzE3JyByeD0nMC41Jz48L3JlY3Q+PC9nPjxyZWN0IGlkPSfnn6nlvaLlpIfku70tMTInIGZpbGw9JyNCM0QyRkYnIG9wYWNpdHk9JzAuMjQzODYxNjA3JyB4PScwJyB5PScxMCcgd2lkdGg9JzI0JyBoZWlnaHQ9JzE4JyByeD0nMC41Jz48L3JlY3Q+PHJlY3QgaWQ9J+efqeW9ouWkh+S7vS0xNCcgZmlsbD0nI0IzRDJGRicgb3BhY2l0eT0nMC4yNDM4NjE2MDcnIHg9JzAnIHk9JzEnIHdpZHRoPSc1MCcgaGVpZ2h0PSc2JyByeD0nMC41Jz48L3JlY3Q+PHJlY3QgaWQ9J+efqeW9ouWkh+S7vS0xOCcgZmlsbD0ndXJsKCNsaW5lYXJHcmFkaWVudC0zKScgeD0nMCcgeT0nMzEnIHdpZHRoPScyNCcgaGVpZ2h0PScxOCcgcng9JzAuNSc+PC9yZWN0PjwvZz48L2c+PC9nPjwvZz48L2c+PC9nPjwvZz48L3N2Zz4=" style="width: 50px;height: 56px;display: block;">\r\n            <span class="imgFont">{{localizeService?.getValue(\'spread.crossTable.colDimensionTitle\')}}</span>\r\n          </div>\r\n          <ul class="f-utils-overflow-xhya f-utils-fill pb-1" style="z-index: 20" [dndList]="lists && lists.length ? lists[2].value : []"  (dndListChange)="dndListChange2($event)">\r\n            <li *ngFor="let item of (lists && lists.length ? lists[2].value : []); let i = index;" [dndDraggable]="item" class="mb-1 p-1"\r\n              (dndMoved)="moved(i, lists[2].value)" dndEffectAllowed="move" (dndSelected)="models.selected = item"\r\n              [ngClass]="{\'selected\': models.selected === item}">\r\n              {{item.name}}\r\n            </li>\r\n          </ul>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>',styles:[".simpleDemo ul{min-height:42px;padding:0}.card-title,.demo-header{text-align:center}.title{margin:20px 0}.simpleDemo ul .dndDraggingSource{display:none}.simpleDemo ul .dndPlaceholder{background:rgba(56,143,255,.06);border:1px dashed #388fff;box-shadow:0 0 4px 0 rgba(13,95,201,.22);margin:.25rem!important;padding:.25rem!important}.simpleDemo ul li{background:rgba(235,244,254,.84);border:1px solid #388fff;box-shadow:0 0 10px 0 rgba(63,113,177,.22);border-radius:3px;height:28px;font-family:PingFangSC-Regular;font-size:13px;color:#388fff;margin:.25rem!important;padding:.25rem!important}#unselectFieldList li{border:none;background-color:rgba(0,0,0,0);box-shadow:0 0 #000;border-radius:3px;height:28px;margin:.25rem!important;padding:.25rem!important}#unselectFieldList li:hover{background:#f4f5f9}#unselectFieldList .dndPlaceholder{background:rgba(56,143,255,.06);border:1px dashed #388fff;box-shadow:0 0 4px 0 rgba(13,95,201,.22);margin:.25rem!important;padding:.25rem!important}.unselectField{font-family:PingFangSC-Regular;font-size:13px;color:rgba(0,0,0,.85)}.unselectFieldFront{font-family:PingFangSC-Medium;font-size:13px;color:#b4bccc}.simpleDemo ul li.selected{background-color:#dff0d8;color:#3c763d}.current-model{background-color:#f5f5f5;border:1px solid #ccc;border-radius:4px;padding:18px 22px}.slicer{height:220px;position:relative}.headerMenu{position:fixed;display:none;top:0;left:0}.cardTitle{background:#f5f7fa;border-radius:3px 3px 0 0;height:36px}.dimensionTitle{font-family:PingFangSC-Medium;font-size:14px;color:rgba(0,0,0,.65);line-height:20px}.imgFont{font-family:PingFangSC-Regular;font-size:13px;color:#b4bccc}"]}]}],e.ctorParameters=function(){return[{type:h.Injector}]},e.propDecorators={controlType:[{type:h.Input}],queryRelativeUrl:[{type:h.Input}],queryId:[{type:h.Input}],qoManagerCode:[{type:h.Input}],qoId:[{type:h.Input}],voId:[{type:h.Input}],groupType:[{type:h.Input}],spread:[{type:h.Input}],conditionExpression:[{type:h.Input}],jointsearchInfoList:[{type:h.Input}],qdpView:[{type:h.Input}]},e}(),J=function(){function e(e){this.injector=e,this.hideColCache=[],this.showColCache=[],this.groupColCache=[],this.allColCache=[],this.searchText="",this.isCompare=!1,this.groupIcon='<span class="k-icon k-i-search"></span>',this.lists=[],this.listsCache=[],this.multiSheetsSchemaIds={},this.models={selected:null,lists:this.lists},this.formInline=!0,this.isOrNotPaging=!0,this.aggreData=[{name:"请选择",value:0},{name:"合计",value:1},{name:"最小值",value:2},{name:"最大值",value:3},{name:"计数",value:4},{name:"平均值",value:5}],this.pageSelectValue=this.aggreData[0].value,this.pageText="",this.colIsGroup=!1,this.groupSelectValue=this.aggreData[0].value,this.groupSubSelectValue=this.aggreData[0].value,this.groupText="",this.totalSelectValue=this.aggreData[0].value,this.totalText="",this.currentColIndex=0,this.enumType=[{name:"索引",value:"0"},{name:"编号",value:"1"},{name:"名称",value:"2"}],this.injector&&(this.localizeService=this.injector.get(d.LocalizeService),this.renderService=this.injector.get(L),this.msgService=this.injector.get(a.MessagerService),this.formErrorService=this.injector.get(u.FormErrorService),this.schemaManagerService=this.injector.get(b.SchemaManagerService),this.localId=this.injector.get(h.LOCALE_ID)||d.DEFAULT_LANGUAGE,this.formInline=this.localId.toLowerCase()===d.DEFAULT_LANGUAGE,this.aggreData=this.localizeService.getValue("ideCmp.schemaManager.columnOption.aggregateData"),this.enumType=this.localizeService.getValue("ideCmp.schemaManager.columnOption.enumType")),this.initLists()}return e.prototype.ngOnInit=function(){var e=b.RtfServices.getTabId(this.queryId);b.EventBus.register("pagingModeChanges",this.handlePagingModeChanged.bind(this),e+"columnsSetting"),b.EventBus.register("schemaValueChanged",this.handleSchemaValueChanged.bind(this),e+"columnsSetting")},e.prototype.ngOnDestroy=function(){},e.prototype.initLists=function(){this.lists=[];for(var e=0;e<3;e++)this.lists.push({name:this.localizeService.getValue("spread.crossTable.columnSetting")[e],value:[]})},e.prototype.initCrosstab=function(){},e.prototype.handleSchemaValueChanged=function(e){var t=this;if(e){if(1===(this.schemaValue=e).id||"1"===e.id)return this.lists[0].value=[],this.listsCache=[],this.lists[1].value=[],void(this.lists[2].value=[]);if("crosstab"!==this.controlType&&(this.colList=e.schemaValue.columnOption.colList,this.colList)){this.hideColCache=[],this.showColCache=[],this.groupColCache=[],this.allColCache=[];for(var i=0;i<this.colList.length;i++)this.getSubColumns(this.colList[i],null,"");setTimeout(function(){t.lists[0].value=t.hideColCache,t.listsCache=t.hideColCache,t.lists[1].value=t.showColCache,t.lists[2].value=t.groupColCache})}}},e.prototype.getSubColumns=function(e,t,i){if(e)e.id=b.EventBus.guid(),e.pid=i,(s=JSON.parse(JSON.stringify(e))).childList=[],this.allColCache.push(s),e.childList&&e.childList.length?this.getSubColumns(null,e.childList,e.id):e.isGroup?this.groupColCache.push(e):e.visible?this.showColCache.push(e):this.hideColCache.push(e);else for(var n=0;n<t.length;n++){var s;t[n].id=b.EventBus.guid(),t[n].pid=i,(s=JSON.parse(JSON.stringify(t[n]))).childList=[],this.allColCache.push(s),t[n].childList&&t[n].childList.length?this.getSubColumns(null,t[n].childList,t[n].id):t[n].isGroup?this.groupColCache.push(t[n]):t[n].visible?this.showColCache.push(t[n]):this.hideColCache.push(t[n])}},e.prototype.moved=function(e,t){var i=this;if(t.splice(e,1),this.selectedDimesion(),this.schemaValue){if(1===this.schemaValue.isProtected||"1"===this.schemaValue.isProtected)return void this.msgService.info(this.localizeService.getValue("ideCmp.schemaManager.message.validate.isProtected"));this.schemaValue.schemaValue=JSON.stringify(this.schemaValue.schemaValue),this.schemaManagerService.saveSchema({schema:JSON.stringify(this.schemaValue)},this.queryRelativeUrl).subscribe(function(){i.renderService.render({multiSheetsSchemaIds:i.multiSheetsSchemaIds,curSheet:i.curSheet,multiSheets:i.multiSheets,schemaId:i.schemaValue.id,queryId:i.queryId,spread:i.spread,controlType:i.controlType,qoManagerCode:i.qoManagerCode,queryRelativeUrl:i.queryRelativeUrl,schemaValue:i.schemaValue,filterCondition:i.conditionExpression,groupType:i.groupType,voId:i.voId,jointsearchInfoList:i.jointsearchInfoList,fromCache:!0,qdpView:i.qdpView}),i.schemaValue.schemaValue="string"==typeof i.schemaValue.schemaValue?JSON.parse(i.schemaValue.schemaValue):i.schemaValue.schemaValue},function(e){i.formErrorService.exception(e.Message,e)})}},e.prototype.selectedDimesion=function(){if(this.colList=[],this.lists[0]&&(this.lists[0].value.forEach(function(e){e.isGroup=!1,e.visible=!1}),this.colList=this.lists[0].value),this.lists[1]&&(this.lists[1].value.forEach(function(e){e.isGroup=!1,e.visible=!0}),0===this.colList.length?this.colList=this.lists[1].value:this.colList=this.colList.concat(this.lists[1].value)),this.lists[2]&&(this.lists[2].value.forEach(function(e){e.isGroup=!0,e.visible=!1}),0===this.colList.length?this.colList=this.lists[2].value:this.colList=this.colList.concat(this.lists[2].value)),0<this.colList.length){for(var e=0;e<this.colList.length;e++)if(!this.colList[e].isGroup){var t={pid:this.colList[e].pid};0==e&&1<this.colList.length?2<this.colList.length?this.colList[e].pid&&this.colList[e+2].pid&&this.colList[e].pid==this.colList[e+2].pid&&(this.colList[e].pid=this.colList[e+2].pid):this.colList[e].pid&&this.colList[e].pid!=this.colList[e+1].pid&&w.filter(this.colList,t)&&1<w.filter(this.colList,t).length&&(this.colList[e].pid=""):e==this.colList.length-1&&1<this.colList.length?this.colList[e].pid&&this.colList[e].pid!=this.colList[e-1].pid&&w.filter(this.colList,t)&&1<w.filter(this.colList,t).length&&(this.colList[e].pid=""):0<e&&e<this.colList.length-1&&this.colList[e-1].pid&&this.colList[e+1].pid&&this.colList[e-1].pid==this.colList[e+1].pid&&(this.colList[e].pid=this.colList[e-1].pid)}for(e=0;e<this.colList.length;e++)this.recursiveFindParent(this.colList,e,this.colList[e].pid);var i={};for(e=0;e<this.colList.length;e++)i[this.colList[e].id]=this.colList[e];var n=[];for(var s in i){var a=i[i[s].pid];a?a.childList.push(i[s]):n.push(i[s])}if(0<this.colList.length){try{this.isCompare=b.JSONUtils.Compare({schema:this.schemaValue.schemaValue.columnOption.colList},{schema:n})}catch(r){}this.schemaValue.schemaValue.columnOption.colList=n}}},e.prototype.recursiveFindParent=function(e,t,i){var n=this,s=this.allColCache.findIndex(function(e){return e.id==i});0<=s&&this.colList.findIndex(function(e){return e.id===n.allColCache[s].id})<0&&(this.colList.splice(t,0,this.allColCache[s]),this.allColCache[s].pid&&this.recursiveFindParent(e,t,this.allColCache[s].pid))},e.prototype.dimensionSearchValueOnChange=function(t){if(t){var e=this.listsCache.find(function(e){return 0<=e.name.indexOf(t)});this.lists[0].value=v(e)}else this.lists[0].value=v(this.listsCache)},e.prototype.dndListChange0=function(e){this.lists&&this.lists.length&&(this.lists[0].value=e)},e.prototype.dndListChange1=function(e){this.lists&&this.lists.length&&(this.lists[1].value=e)},e.prototype.dndListChange2=function(e){this.lists&&this.lists.length&&(this.lists[2].value=e)},e.prototype.dndListChange3=function(e){this.lists&&this.lists.length&&(this.lists[3].value=e)},e.prototype.handlePagingModeChanged=function(e){this.isOrNotPaging=1===e.value},e.decorators=[{type:h.Component,args:[{selector:"columns-setting",template:'<div class="container f-utils-fill-flex-column h-100">\r\n  <div class="simpleDemo f-utils-fill-flex-row">\r\n    <div class="col-md-6 f-utils-flex-column p-1">\r\n      <div class="card f-utils-fill-flex-column">\r\n        <div class="card-body f-utils-fill-flex-column p-0">\r\n          <div class="cardTitle mb-2 pt-2">\r\n            <span id="unselected" class="f-icon pt-1 pr-2 pl-2" role="presentation">\r\n              <img\r\n                src="data:image/svg+xml;charset=utf-8;base64,PHN2ZyB3aWR0aD0nMTZweCcgaGVpZ2h0PScxNnB4JyB2aWV3Qm94PScwIDAgMTYgMTYnIHZlcnNpb249JzEuMScgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB4bWxuczp4bGluaz0naHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayc+PHRpdGxlPuW+hemAieWtl+autTwvdGl0bGU+PGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+PGcgaWQ9J+mhtemdoi0xJyBzdHJva2U9J25vbmUnIHN0cm9rZS13aWR0aD0nMScgZmlsbD0nbm9uZScgZmlsbC1ydWxlPSdldmVub2RkJyBvcGFjaXR5PScwLjQ1OTU0MjQxMSc+PGcgaWQ9JzHjgIHmn6Xor6JVSeiuvuiuoScgdHJhbnNmb3JtPSd0cmFuc2xhdGUoLTkzMi4wMDAwMDAsIC0xNTEuMDAwMDAwKScgZmlsbD0nIzAwMDAwMCcgZmlsbC1ydWxlPSdub256ZXJvJz48ZyBpZD0n57yW57uELTI2JyB0cmFuc2Zvcm09J3RyYW5zbGF0ZSg4OTguMDAwMDAwLCA3NS4wMDAwMDApJz48ZyBpZD0n57yW57uELTI0JyB0cmFuc2Zvcm09J3RyYW5zbGF0ZSgyMC4wMDAwMDAsIDY1LjAwMDAwMCknPjxnIGlkPSfnvJbnu4QtMjEnIHRyYW5zZm9ybT0ndHJhbnNsYXRlKDEuMDAwMDAwLCAxLjAwMDAwMCknPjxnIGlkPSdzaG91Y2FuZy0yJyB0cmFuc2Zvcm09J3RyYW5zbGF0ZSgxMy4wMDAwMDAsIDEwLjAwMDAwMCknPjxwYXRoIGQ9J00xMS41NjA5NDkyLDE0LjQ3MjcxODMgQzExLjM2NDAzMzIsMTQuNDcyNzE4MyAxMS4xNDI4MzU5LDE0LjQxNjE4MzYgMTAuOTM3NTI1NCwxNC4zMTM1NjI1IEw4LjAwNzc1MTk1LDEyLjg0ODE4MzYgTDUuMDU5ODM1OTQsMTQuMzExMTgzNiBDNC44NzMxNDY0OCwxNC40MTA1NzgxIDQuNjU5NDQxNDEsMTQuNDYyODczIDQuNDQxNTI1MzksMTQuNDYyODczIEM0LjE1ODM1ODQyLDE0LjQ2MzkxNTcgMy44ODI0MTU1NCwxNC4zNzM1NDU4IDMuNjU0NzIyNjYsMTQuMjA1MTk5MiBDMy4yNDIxNDY0OCwxMy44OTU4MDQ3IDMuMDMwNzM4MjgsMTMuMzU5NTkzNyAzLjEyODMyODEyLDEyLjg3MTQ5NDEgTDMuNzMxMjQ0MTQsOS43NDM4ODg2NyBMMS40MjAzMjgxMiw3LjU4OTc4OTA2IEMxLjA2MzM4MzQyLDcuMjI4MTM2ODYgMC45MjY0MjQ0NTgsNi43MDM1NjQzOCAxLjA2MTAxNzU4LDYuMjEzNTc4MTIgTDEuMDY1NjM4NjcsNi4xOTc2OTE0MSBDMS4yMzM2Mzg2Nyw1LjY5NDE4MzU5IDEuNjUwNDEyMTEsNS4zNDEzODA4NiAyLjE1NTc1MTk1LDUuMjczNjkxNDEgTDUuMzY2NDQxNDEsNC42ODk5MDIzNCBMNi44MDc1MjUzOSwxLjc2MzA0MTAyIEM3LjAzOTAxNzU4LDEuMjk5NjMyODEgNy41MDk4NDk2MSwxLjAwMTg1OTM3IDguMDA3NzUxOTUsMS4wMDE4NTkzNyBDOC41MjcxNDY0OCwxLjAwMTg1OTM3IDkuMDEwMTQ2NDgsMS4zMTA4NDM3NSA5LjIxMjY1NDMsMS43NzE0NDkyMiBMMTAuNjQ5MTMwOSw0LjY4OTAyNzM0IEwxMy44NjAzMTI1LDUuMjUwNDQ5MjIgQzE0LjM2OTg3NDcsNS4zMjQzMDAwMyAxNC43ODg3MTU0LDUuNjkwMjA3NjIgMTQuOTMwMzI4MSw2LjE4NTIzNjMzIEMxNS4wODg4NDQ4LDYuNjcxNzczNDkgMTQuOTU5MzY4Miw3LjIwNjExMjA4IDE0LjU5NTcyMjcsNy41NjYxMjMwNSBMMTQuNTg3ODIwMyw3LjU3NDAzOTA2IEwxMi4yODM0MjU4LDkuNzQ0MDM5MDYgTDEyLjg2NTgyMDMsMTIuODc3MjIyNyBDMTIuOTU5NjA5NCwxMy4zNzg0MzM2IDEyLjc2MDMyODEsMTMuODg0MzIwMyAxMi4zNDU0NDE0LDE0LjE5OTc0NDEgQzEyLjEyMzMxODEsMTQuMzc4NjAyMiAxMS44NDYxMjE3LDE0LjQ3NTA0MTMgMTEuNTYwOTQ5MiwxNC40NzI3MTgzIEwxMS41NjA5NDkyLDE0LjQ3MjcxODMgWiBNOC4wMDg4MDQ2OSwxMS43NDY1MDM5IEwxMS4wODYyNzU0LDEzLjI4NTQ2NDggQzExLjE3NjcxNDgsMTMuMzMxMTAxNiAxMS4yODA4ODA5LDEzLjM1OTY2MjEgMTEuMzUyMDU2NiwxMy4zNTk2NjIxIEMxMS40NjE4MjgxLDEzLjM1OTY2MjEgMTEuNTYzNzUyLDEzLjMyNTkxOTkgMTEuNjM4NDQxNCwxMy4yNjM1NDg4IEwxMS42NTI1MDk4LDEzLjI1MjA2NDUgQzExLjgyNzM3MywxMy4xMjA3NDYxIDExLjkxMjU0ODgsMTIuOTEyNDI3NyAxMS44NzQzMzU5LDEyLjcwODEwMTYgTDExLjI1NDgzNTksOS4zNzE5NzI2NiBMMTMuNzA0NDk0MSw3LjA2NTE4NTU1IEMxMy44NTQ3NzU0LDYuOTEyNzMwNDcgMTMuOTA2MjIyNyw2LjY5NDQwNDMgMTMuODM5NDM1NSw2LjQ5MzU2NDQ1IEwxMy44MzI4NzMsNi40NzI1MDk3NyBDMTMuNzc4OTIxMiw2LjI3ODAxNzY2IDEzLjYxNDIyNjEsNi4xMzQ0MTAzMyAxMy40MTQxOTkyLDYuMTA3NDQzMzYgTDEzLjQwMDE5OTIsNi4xMDUyODMyIEwxMC4wMTA4MDQ3LDUuNTEyNjYyMTEgTDguNDg1NDg4MjgsMi40MTQxOTE0MSBDOC40MTEyMDg5OCwyLjI0MTA3ODEyIDguMjEwNDUxMTcsMi4xMTU0MzM1OSA4LjAwNzQ1MTE3LDIuMTE1NDMzNTkgQzcuODA4MDE5NTMsMi4xMTU0MzM1OSA3LjYxNzMzNzg5LDIuMjQwMjQ0MTQgNy41MjA2Nzc3MywyLjQzMzA4NTk0IEw2LjAwNTA1NDY5LDUuNTExMzM1OTQgTDIuNTk3NzIyNjYsNi4xMzAyODkwNiBDMi4zOTA4MTI1LDYuMTU2MjUxOTUgMi4yMzAwMTc1OCw2LjI5MzczNjMzIDIuMTU1ODIwMzEsNi41MDgwNzAzMSBDMi4xMDMxMDE1Niw2LjcwNDAwMTk1IDIuMTY1NDcyNjYsNi45Mzk4OTY0OCAyLjMwOTUzMzIsNy4wODcxMTUyMyBMNC43NjE4NTc0Miw5LjM3MjM5NjQ4IEw0LjExODI2NzU4LDEyLjcxMDM1NzQgQzQuMDc5NjMwODYsMTIuOTAzMjY3NiA0LjE3MDk3MjY2LDEzLjEyNTUxNzYgNC4zNDAwOTM3NSwxMy4yNTI1MDIgQzQuNDI0ODU5MzcsMTMuMzE2MjEyOSA0LjUzNDY5OTIyLDEzLjM1MTM0OTYgNC42NDk4NDM3NSwxMy4zNTEzNDk2IEM0LjczODYwMTU2LDEzLjM1MTM0OTYgNC44MjM4MDQ2OSwxMy4zMzA2MjMgNC44OTcxNjc5NywxMy4yOTExMzg3IEw0LjkwNzcyMjY2LDEzLjI4NDk4NjMgTDguMDA4ODA0NjksMTEuNzQ2NTAzOSBaJyBpZD0n5b2i54q2Jz48L3BhdGg+PC9nPjwvZz48L2c+PC9nPjwvZz48L2c+PC9zdmc+"\r\n                style="width: 15px; height: 15px; display: block;" />\r\n            </span>\r\n            <span class="pl-3 dimensionTitle">{{lists && lists.length ? lists[0].name : \'\'}}</span>\r\n          </div>\r\n          <input-group [groupText]="groupIcon" class="m-1" [(value)]="searchText"\r\n            (valueChange)="dimensionSearchValueOnChange($event)"></input-group>\r\n          <ul id="unselectFieldList" class="f-utils-overflow-xhya f-utils-fill pb-1"\r\n            [dndList]="lists && lists.length ? lists[0].value : []" (dndListChange)="dndListChange0($event)">\r\n            <li *ngFor="let item of (lists && lists.length ? lists[0].value : []); let i = index;" [dndDraggable]="item"\r\n              (dndMoved)="moved(i, lists[0].value)" dndEffectAllowed="move" (dndSelected)="models.selected = item"\r\n              [ngClass]="{\'selected\': models.selected === item}">\r\n              <span class="unselectFieldFront mr-2"\r\n                *ngIf="\'int,float,double,decimal,number\'.includes(item.type)==false">Abc</span>\r\n              <span class="unselectFieldFront mr-2"\r\n                *ngIf="\'int,float,double,decimal,number\'.includes(item.type)==true">123</span>\r\n              <span class="unselectField">{{item.name}}</span>\r\n            </li>\r\n          </ul>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class="col-md-6 f-utils-flex-column p-1">\r\n      <div class="card f-utils-fill-flex-column">\r\n        <div class="card-body  f-utils-fill-flex-column p-0">\r\n          <div class="cardTitle mb-2 pt-2">\r\n            <span id="rowfield" class="f-icon pt-1 pr-2 pl-2" role="presentation">\r\n              <img\r\n                src="data:image/svg+xml;charset=utf-8;base64,PHN2ZyB3aWR0aD0nMTZweCcgaGVpZ2h0PScxNnB4JyB2aWV3Qm94PScwIDAgMTYgMTYnIHZlcnNpb249JzEuMScgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB4bWxuczp4bGluaz0naHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayc+PHRpdGxlPuihjOe7tOW6pjwvdGl0bGU+PGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+PGcgaWQ9J+mhtemdoi0xJyBzdHJva2U9J25vbmUnIHN0cm9rZS13aWR0aD0nMScgZmlsbD0nbm9uZScgZmlsbC1ydWxlPSdldmVub2RkJz48ZyBpZD0nMeOAgeafpeivolVJ6K6+6K6hJyB0cmFuc2Zvcm09J3RyYW5zbGF0ZSgtOTMxLjAwMDAwMCwgLTQ2MC4wMDAwMDApJyBzdHJva2U9JyM5Nzk3OTcnPjxnIGlkPSfnvJbnu4QtMjYnIHRyYW5zZm9ybT0ndHJhbnNsYXRlKDg5OC4wMDAwMDAsIDc1LjAwMDAwMCknPjxnIGlkPSfnvJbnu4QtMjknIHRyYW5zZm9ybT0ndHJhbnNsYXRlKDIwLjAwMDAwMCwgMzc1LjAwMDAwMCknPjxnIGlkPSfnvJbnu4QtMjHlpIfku70tMicgdHJhbnNmb3JtPSd0cmFuc2xhdGUoMS4wMDAwMDAsIDAuMDAwMDAwKSc+PGcgaWQ9J+e8lue7hC0yMicgdHJhbnNmb3JtPSd0cmFuc2xhdGUoMTIuMDAwMDAwLCAxMC4wMDAwMDApJz48cmVjdCBpZD0n55+p5b2iJyB4PScxLjUnIHk9JzIuNScgd2lkdGg9JzQuMjUnIGhlaWdodD0nNC4yNScgcng9JzEnPjwvcmVjdD48cmVjdCBpZD0n55+p5b2iJyBmaWxsPScjRDhEOEQ4JyB4PSc4LjUnIHk9JzMuMzc1JyB3aWR0aD0nNScgaGVpZ2h0PScxJz48L3JlY3Q+PHJlY3QgaWQ9J+efqeW9ouWkh+S7vS0xMicgZmlsbD0nI0Q4RDhEOCcgeD0nOC41JyB5PScxMC4zNzUnIHdpZHRoPSc1JyBoZWlnaHQ9JzEnPjwvcmVjdD48cmVjdCBpZD0n55+p5b2i5aSH5Lu9LTcnIGZpbGw9JyNEOEQ4RDgnIHg9JzguNScgeT0nNicgd2lkdGg9JzUnIGhlaWdodD0nMSc+PC9yZWN0PjxyZWN0IGlkPSfnn6nlvaLlpIfku70tMTMnIGZpbGw9JyNEOEQ4RDgnIHg9JzguNScgeT0nMTMnIHdpZHRoPSc1JyBoZWlnaHQ9JzEnPjwvcmVjdD48cmVjdCBpZD0n55+p5b2i5aSH5Lu9LTYnIHg9JzEuNScgeT0nOS41JyB3aWR0aD0nNC4yNScgaGVpZ2h0PSc0LjI1JyByeD0nMSc+PC9yZWN0PjwvZz48L2c+PC9nPjwvZz48L2c+PC9nPjwvc3ZnPg=="\r\n                style="width: 15px; height: 15px; display: block;" />\r\n            </span>\r\n            <span class="pl-3 dimensionTitle">{{lists && lists.length ? lists[1].name : \'\'}}</span>\r\n          </div>\r\n          <div id="rowfieldimg" *ngIf="lists && lists.length ? (lists[1]?.value?.length < 1) : true"\r\n            class="f-utils-absolute-all f-utils-flex-column justify-content-center align-items-center"\r\n            role="presentation" style="align-items: center; top: 36px; z-index: 10;">\r\n            <img\r\n              src="data:image/svg+xml;charset=utf-8;base64,PHN2ZyB3aWR0aD0nNTBweCcgaGVpZ2h0PSc1MHB4JyB2aWV3Qm94PScwIDAgNTAgNTAnIHZlcnNpb249JzEuMScgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB4bWxuczp4bGluaz0naHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayc+PHRpdGxlPuWIl+e7tOW6puWbvjwvdGl0bGU+PGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+PGRlZnM+PHJlY3QgaWQ9J3BhdGgtMScgeD0nMjYnIHk9JzMxJyB3aWR0aD0nMjQnIGhlaWdodD0nMTgnIHJ4PScwLjUnPjwvcmVjdD48ZmlsdGVyIHg9Jy02LjIlJyB5PSctOC4zJScgd2lkdGg9JzExMi41JScgaGVpZ2h0PScxMTYuNyUnIGZpbHRlclVuaXRzPSdvYmplY3RCb3VuZGluZ0JveCcgaWQ9J2ZpbHRlci0yJz48ZmVPZmZzZXQgZHg9JzAnIGR5PScwJyBpbj0nU291cmNlQWxwaGEnIHJlc3VsdD0nc2hhZG93T2Zmc2V0T3V0ZXIxJz48L2ZlT2Zmc2V0PjxmZUdhdXNzaWFuQmx1ciBzdGREZXZpYXRpb249JzAuNScgaW49J3NoYWRvd09mZnNldE91dGVyMScgcmVzdWx0PSdzaGFkb3dCbHVyT3V0ZXIxJz48L2ZlR2F1c3NpYW5CbHVyPjxmZUNvbXBvc2l0ZSBpbj0nc2hhZG93Qmx1ck91dGVyMScgaW4yPSdTb3VyY2VBbHBoYScgb3BlcmF0b3I9J291dCcgcmVzdWx0PSdzaGFkb3dCbHVyT3V0ZXIxJz48L2ZlQ29tcG9zaXRlPjxmZUNvbG9yTWF0cml4IHZhbHVlcz0nMCAwIDAgMCAwLjExNDg0Mzc1IDAgMCAwIDAgMC41MTU4ODE4MTcgMCAwIDAgMCAxIDAgMCAwIDAuNzI2NDgwNTUxIDAnIHR5cGU9J21hdHJpeCcgaW49J3NoYWRvd0JsdXJPdXRlcjEnPjwvZmVDb2xvck1hdHJpeD48L2ZpbHRlcj48bGluZWFyR3JhZGllbnQgeDE9JzUwJScgeTE9JzEwMCUnIHgyPSc1MCUnIHkyPScwJScgaWQ9J2xpbmVhckdyYWRpZW50LTMnPjxzdG9wIHN0b3AtY29sb3I9JyNEQUVCRkYnIHN0b3Atb3BhY2l0eT0nMC4yMDMwNDMwNTEnIG9mZnNldD0nMCUnPjwvc3RvcD48c3RvcCBzdG9wLWNvbG9yPScjQjNEMkZGJyBzdG9wLW9wYWNpdHk9JzAuNDczMDM4NjgnIG9mZnNldD0nMTAwJSc+PC9zdG9wPjwvbGluZWFyR3JhZGllbnQ+PC9kZWZzPjxnIGlkPSfpobXpnaItMScgc3Ryb2tlPSdub25lJyBzdHJva2Utd2lkdGg9JzEnIGZpbGw9J25vbmUnIGZpbGwtcnVsZT0nZXZlbm9kZCc+PGcgaWQ9JzHjgIHmn6Xor6JVSeiuvuiuoScgdHJhbnNmb3JtPSd0cmFuc2xhdGUoLTEyMTQuMDAwMDAwLCAtNTY1LjAwMDAwMCknPjxnIGlkPSfnvJbnu4QtMjYnIHRyYW5zZm9ybT0ndHJhbnNsYXRlKDg5OC4wMDAwMDAsIDc1LjAwMDAwMCknPjxnIGlkPSfnvJbnu4QtMzAnIHRyYW5zZm9ybT0ndHJhbnNsYXRlKDIzOS4wMDAwMDAsIDM3NS4wMDAwMDApJz48ZyBpZD0n57yW57uELTM05aSH5Lu9JyB0cmFuc2Zvcm09J3RyYW5zbGF0ZSg0MC4wMDAwMDAsIDExNS4wMDAwMDApJz48ZyBpZD0n57yW57uELTMzJyB0cmFuc2Zvcm09J3RyYW5zbGF0ZSgzNy4wMDAwMDAsIDAuMDAwMDAwKSc+PGcgaWQ9J+e8lue7hC01Jz48cmVjdCBpZD0n55+p5b2i5aSH5Lu9LTMnIGZpbGw9JyNCM0QyRkYnIG9wYWNpdHk9JzAuMjQzODYxNjA3JyB4PScyNicgeT0nMTAnIHdpZHRoPScyNCcgaGVpZ2h0PScxOCcgcng9JzAuNSc+PC9yZWN0PjxnIGlkPSfnn6nlvaLlpIfku70tNicgb3BhY2l0eT0nMC41OTYxMjE2NTInPjx1c2UgZmlsbD0nYmxhY2snIGZpbGwtb3BhY2l0eT0nMScgZmlsdGVyPSd1cmwoI2ZpbHRlci0yKScgeGxpbms6aHJlZj0nI3BhdGgtMSc+PC91c2U+PHJlY3Qgc3Ryb2tlLW9wYWNpdHk9JzAuMjIzNDQ4NDI3JyBzdHJva2U9JyMwMDUxQjknIHN0cm9rZS13aWR0aD0nMScgc3Ryb2tlLWxpbmVqb2luPSdzcXVhcmUnIGZpbGw9JyM3QkIyRjgnIGZpbGwtcnVsZT0nZXZlbm9kZCcgeD0nMjYuNScgeT0nMzEuNScgd2lkdGg9JzIzJyBoZWlnaHQ9JzE3JyByeD0nMC41Jz48L3JlY3Q+PC9nPjxyZWN0IGlkPSfnn6nlvaLlpIfku70tMTInIGZpbGw9JyNCM0QyRkYnIG9wYWNpdHk9JzAuMjQzODYxNjA3JyB4PScwJyB5PScxMCcgd2lkdGg9JzI0JyBoZWlnaHQ9JzE4JyByeD0nMC41Jz48L3JlY3Q+PHJlY3QgaWQ9J+efqeW9ouWkh+S7vS0xNCcgZmlsbD0nI0IzRDJGRicgb3BhY2l0eT0nMC4yNDM4NjE2MDcnIHg9JzAnIHk9JzEnIHdpZHRoPSc1MCcgaGVpZ2h0PSc2JyByeD0nMC41Jz48L3JlY3Q+PHJlY3QgaWQ9J+efqeW9ouWkh+S7vS0xOCcgZmlsbD0ndXJsKCNsaW5lYXJHcmFkaWVudC0zKScgeD0nMCcgeT0nMzEnIHdpZHRoPScyNCcgaGVpZ2h0PScxOCcgcng9JzAuNSc+PC9yZWN0PjwvZz48L2c+PC9nPjwvZz48L2c+PC9nPjwvZz48L3N2Zz4="\r\n              style="width: 50px;height: 56px;display: block;">\r\n            \x3c!-- <span class="imgFont">{{localizeService?.getValue(\'spread.crossTable.rowDimensionTitle\')}}</span> --\x3e\r\n          </div>\r\n          <ul class="f-utils-overflow-xhya f-utils-fill pb-1" style="z-index: 20"\r\n            [dndList]="lists && lists.length ? lists[1].value : []" (dndListChange)="dndListChange1($event)">\r\n            <li *ngFor="let item of (lists && lists.length ? lists[1].value : []); let i = index;" [dndDraggable]="item"\r\n              class="mb-1 p-1" (dndMoved)="moved(i, lists[1].value)" dndEffectAllowed="move"\r\n              (dndSelected)="models.selected = item" [ngClass]="{\'selected\': models.selected === item}">\r\n              {{item.name}}\r\n              \x3c!-- <div class="btn-group mr-3" fDropdown>\r\n                <button class="btn btn-link dropdown-toggle" fDropdownToggle type="button">\r\n                  {{item.name}}\r\n                </button>\r\n                <div class="dropdown-menu" fDropdownMenu>\r\n                  <div class="flex-fill farris-split-section farris-overflow-hidden">\r\n                    <div class="farris-form farris-card-content-bg">\r\n                      <div class="col-12 col-md-12 col-lg-12"\r\n                        *ngIf="(controlType!=\'crosstab\' && controlType!=\'treelist\' && isOrNotPaging)">\r\n                        <div class="farris-group-wrap" [class.form-inline]="formInline"\r\n                          [class.farris-form-inline]="formInline">\r\n                          <div class="form-group farris-form-group">\r\n                            <label class="col-form-label" for="colPageText">\r\n                              <span\r\n                                class="farris-label-text">{{localizeService.getValue(\'ideCmp.schemaManager.columnOption.pageTotal\')}}:</span>\r\n                            </label>\r\n                            <div class="farris-input-wrap">\r\n                              <input-group [(ngModel)]="pageText" id="colPageText"></input-group>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                      <div class="col-12 col-md-12 col-lg-12"\r\n                        *ngIf="(controlType!=\'crosstab\' && controlType!=\'treelist\' && isOrNotPaging)">\r\n                        <div class="farris-group-wrap" [class.form-inline]="formInline"\r\n                          [class.farris-form-inline]="formInline">\r\n                          <div class="form-group farris-form-group">\r\n                            <label class="col-form-label" for="colPageAggre">\r\n                              <span\r\n                                class="farris-label-text">{{localizeService.getValue(\'ideCmp.schemaManager.columnOption.pageTotalType\')}}:</span>\r\n                            </label>\r\n                            <div class="farris-input-wrap">\r\n                              <farris-combo-list id="colPageAggre" [(ngModel)]="pageSelectValue" [data]="aggreData"\r\n                                [textField]="\'name\'" [idField]="\'value\'" [enableClear]="false"></farris-combo-list>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                      <div class="col-12 col-md-12 col-lg-12"\r\n                        *ngIf="(controlType!=\'crosstab\' && controlType!=\'treelist\')">\r\n                        <div class="farris-group-wrap" [class.form-inline]="formInline"\r\n                          [class.farris-form-inline]="formInline">\r\n                          <div class="form-group farris-form-group">\r\n                            <label class="col-form-label" for="colGroupText">\r\n                              <span\r\n                                class="farris-label-text">{{localizeService.getValue(\'ideCmp.schemaManager.columnOption.groupTotal\')}}:</span>\r\n                            </label>\r\n                            <div class="farris-input-wrap">\r\n                              <input-group [(ngModel)]="groupText" id="colGroupText"></input-group>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                      <div class="col-12 col-md-12 col-lg-12"\r\n                        *ngIf="(controlType!=\'crosstab\' && controlType!=\'treelist\')">\r\n                        <div class="farris-group-wrap" [class.form-inline]="formInline"\r\n                          [class.farris-form-inline]="formInline">\r\n                          <div class="form-group farris-form-group">\r\n                            <label class="col-form-label" for="colGroupAggre">\r\n                              <span\r\n                                class="farris-label-text">{{localizeService.getValue(\'ideCmp.schemaManager.columnOption.groupSubTotalType\')}}:</span>\r\n                            </label>\r\n                            <div class="farris-input-wrap">\r\n                              <farris-combo-list id="colGroupAggre" [disabled]="colIsGroup"\r\n                                [(ngModel)]="groupSubSelectValue" [data]="aggreData" [textField]="\'name\'"\r\n                                [idField]="\'value\'" [enableClear]="false">\r\n                              </farris-combo-list>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                      <div class="col-12 col-md-12 col-lg-12"\r\n                        *ngIf="(controlType!=\'crosstab\' && controlType!=\'treelist\')">\r\n                        <div class="farris-group-wrap" [class.form-inline]="formInline"\r\n                          [class.farris-form-inline]="formInline">\r\n                          <div class="form-group farris-form-group">\r\n                            <label class="col-form-label" for="colGroupAggre">\r\n                              <span\r\n                                class="farris-label-text">{{localizeService.getValue(\'ideCmp.schemaManager.columnOption.groupTotalType\')}}:</span>\r\n                            </label>\r\n                            <div class="farris-input-wrap">\r\n                              <farris-combo-list id="colGroupAggre" [disabled]="colIsGroup"\r\n                                [(ngModel)]="groupSelectValue" [data]="aggreData" [textField]="\'name\'"\r\n                                [idField]="\'value\'" [enableClear]="false">\r\n                              </farris-combo-list>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                      <div class="col-12 col-md-12 col-lg-12"\r\n                        *ngIf="(controlType!=\'crosstab\' && !isOrNotPaging)">\r\n                        <div class="farris-group-wrap" [class.form-inline]="formInline"\r\n                          [class.farris-form-inline]="formInline">\r\n                          <div class="form-group farris-form-group">\r\n                            <label class="col-form-label" for="colTotalText">\r\n                              <span\r\n                                class="farris-label-text">{{localizeService.getValue(\'ideCmp.schemaManager.columnOption.aggregateTotal\')}}:</span>\r\n                            </label>\r\n                            <div class="farris-input-wrap">\r\n                              <input-group [(ngModel)]="totalText" id="colTotalText"></input-group>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                      <div class="col-12 col-md-12 col-lg-12"\r\n                        *ngIf="(controlType!=\'crosstab\' && !isOrNotPaging)">\r\n                        <div class="farris-group-wrap" [class.form-inline]="formInline"\r\n                          [class.farris-form-inline]="formInline">\r\n                          <div class="form-group farris-form-group">\r\n                            <label class="col-form-label" for="colTotalAggre">\r\n                              <span\r\n                                class="farris-label-text">{{localizeService.getValue(\'ideCmp.schemaManager.columnOption.totalType\')}}:</span>\r\n                            </label>\r\n                            <div class="farris-input-wrap">\r\n                              <farris-combo-list id="colTotalAggre" [(ngModel)]="totalSelectValue" [data]="aggreData"\r\n                                [textField]="\'name\'" [idField]="\'value\'" [enableClear]="false"></farris-combo-list>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div> --\x3e\r\n            </li>\r\n          </ul>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n  <div class="simpleDemo f-utils-fill-flex-row" *ngIf="controlType==\'list\'">\r\n    <div class="col-md-6 f-utils-flex-column p-1">\r\n      <div class="card f-utils-fill-flex-column">\r\n        <div class="card-body f-utils-fill-flex-column p-0">\r\n          <div class="cardTitle mb-2 pt-2">\r\n            <span id="colfield" class="f-icon pt-1 pr-2 pl-2" role="presentation">\r\n              <img\r\n                src="data:image/svg+xml;charset=utf-8;base64,PHN2ZyB3aWR0aD0nMTdweCcgaGVpZ2h0PScxN3B4JyB2aWV3Qm94PScwIDAgMTcgMTcnIHZlcnNpb249JzEuMScgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB4bWxuczp4bGluaz0naHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayc+PHRpdGxlPuWIl+e7tOW6pjwvdGl0bGU+PGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+PGcgaWQ9J+mhtemdoi0xJyBzdHJva2U9J25vbmUnIHN0cm9rZS13aWR0aD0nMScgZmlsbD0nbm9uZScgZmlsbC1ydWxlPSdldmVub2RkJz48ZyBpZD0nMeOAgeafpeivolVJ6K6+6K6hJyB0cmFuc2Zvcm09J3RyYW5zbGF0ZSgtMTE1MC4wMDAwMDAsIC00NjAuMDAwMDAwKScgc3Ryb2tlPScjOTc5Nzk3Jz48ZyBpZD0n57yW57uELTI2JyB0cmFuc2Zvcm09J3RyYW5zbGF0ZSg4OTguMDAwMDAwLCA3NS4wMDAwMDApJz48ZyBpZD0n57yW57uELTMwJyB0cmFuc2Zvcm09J3RyYW5zbGF0ZSgyMzkuMDAwMDAwLCAzNzUuMDAwMDAwKSc+PGcgaWQ9J+e8lue7hC0yMeWkh+S7vS0zJyB0cmFuc2Zvcm09J3RyYW5zbGF0ZSgxLjAwMDAwMCwgMC4wMDAwMDApJz48ZyBpZD0n57yW57uELTIyJyB0cmFuc2Zvcm09J3RyYW5zbGF0ZSgyMC4xMjUwMDAsIDE4LjEyNTAwMCkgcm90YXRlKDkwLjAwMDAwMCkgdHJhbnNsYXRlKC0yMC4xMjUwMDAsIC0xOC4xMjUwMDApIHRyYW5zbGF0ZSgxMi4xMjUwMDAsIDEwLjEyNTAwMCknPjxyZWN0IGlkPSfnn6nlvaInIHg9JzEuNScgeT0nMi41JyB3aWR0aD0nNC4yNScgaGVpZ2h0PSc0LjI1JyByeD0nMSc+PC9yZWN0PjxyZWN0IGlkPSfnn6nlvaInIGZpbGw9JyNEOEQ4RDgnIHg9JzguNScgeT0nMy4zNzUnIHdpZHRoPSc1JyBoZWlnaHQ9JzEnPjwvcmVjdD48cmVjdCBpZD0n55+p5b2i5aSH5Lu9LTEyJyBmaWxsPScjRDhEOEQ4JyB4PSc4LjUnIHk9JzEwLjM3NScgd2lkdGg9JzUnIGhlaWdodD0nMSc+PC9yZWN0PjxyZWN0IGlkPSfnn6nlvaLlpIfku70tNycgZmlsbD0nI0Q4RDhEOCcgeD0nOC41JyB5PSc2JyB3aWR0aD0nNScgaGVpZ2h0PScxJz48L3JlY3Q+PHJlY3QgaWQ9J+efqeW9ouWkh+S7vS0xMycgZmlsbD0nI0Q4RDhEOCcgeD0nOC41JyB5PScxMycgd2lkdGg9JzUnIGhlaWdodD0nMSc+PC9yZWN0PjxyZWN0IGlkPSfnn6nlvaLlpIfku70tNicgeD0nMS41JyB5PSc5LjUnIHdpZHRoPSc0LjI1JyBoZWlnaHQ9JzQuMjUnIHJ4PScxJz48L3JlY3Q+PC9nPjwvZz48L2c+PC9nPjwvZz48L2c+PC9zdmc+"\r\n                style="width: 15px; height: 15px; display: block;" />\r\n            </span>\r\n            <span class="pl-3 dimensionTitle">{{lists && lists.length ? lists[2].name : \'\'}}</span>\r\n          </div>\r\n          <div id="colfieldimg" *ngIf="lists && lists.length ? (lists[2]?.value?.length < 1) : true"\r\n            class="f-utils-absolute-all f-utils-flex-column justify-content-center align-items-center"\r\n            role="presentation" style="align-items: center; top: 36px; z-index: 10;">\r\n            <img\r\n              src="data:image/svg+xml;charset=utf-8;base64,PHN2ZyB3aWR0aD0nNTBweCcgaGVpZ2h0PSc1MHB4JyB2aWV3Qm94PScwIDAgNTAgNTAnIHZlcnNpb249JzEuMScgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB4bWxuczp4bGluaz0naHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayc+PHRpdGxlPuWIl+e7tOW6puWbvjwvdGl0bGU+PGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+PGRlZnM+PHJlY3QgaWQ9J3BhdGgtMScgeD0nMjYnIHk9JzMxJyB3aWR0aD0nMjQnIGhlaWdodD0nMTgnIHJ4PScwLjUnPjwvcmVjdD48ZmlsdGVyIHg9Jy02LjIlJyB5PSctOC4zJScgd2lkdGg9JzExMi41JScgaGVpZ2h0PScxMTYuNyUnIGZpbHRlclVuaXRzPSdvYmplY3RCb3VuZGluZ0JveCcgaWQ9J2ZpbHRlci0yJz48ZmVPZmZzZXQgZHg9JzAnIGR5PScwJyBpbj0nU291cmNlQWxwaGEnIHJlc3VsdD0nc2hhZG93T2Zmc2V0T3V0ZXIxJz48L2ZlT2Zmc2V0PjxmZUdhdXNzaWFuQmx1ciBzdGREZXZpYXRpb249JzAuNScgaW49J3NoYWRvd09mZnNldE91dGVyMScgcmVzdWx0PSdzaGFkb3dCbHVyT3V0ZXIxJz48L2ZlR2F1c3NpYW5CbHVyPjxmZUNvbXBvc2l0ZSBpbj0nc2hhZG93Qmx1ck91dGVyMScgaW4yPSdTb3VyY2VBbHBoYScgb3BlcmF0b3I9J291dCcgcmVzdWx0PSdzaGFkb3dCbHVyT3V0ZXIxJz48L2ZlQ29tcG9zaXRlPjxmZUNvbG9yTWF0cml4IHZhbHVlcz0nMCAwIDAgMCAwLjExNDg0Mzc1IDAgMCAwIDAgMC41MTU4ODE4MTcgMCAwIDAgMCAxIDAgMCAwIDAuNzI2NDgwNTUxIDAnIHR5cGU9J21hdHJpeCcgaW49J3NoYWRvd0JsdXJPdXRlcjEnPjwvZmVDb2xvck1hdHJpeD48L2ZpbHRlcj48bGluZWFyR3JhZGllbnQgeDE9JzUwJScgeTE9JzEwMCUnIHgyPSc1MCUnIHkyPScwJScgaWQ9J2xpbmVhckdyYWRpZW50LTMnPjxzdG9wIHN0b3AtY29sb3I9JyNEQUVCRkYnIHN0b3Atb3BhY2l0eT0nMC4yMDMwNDMwNTEnIG9mZnNldD0nMCUnPjwvc3RvcD48c3RvcCBzdG9wLWNvbG9yPScjQjNEMkZGJyBzdG9wLW9wYWNpdHk9JzAuNDczMDM4NjgnIG9mZnNldD0nMTAwJSc+PC9zdG9wPjwvbGluZWFyR3JhZGllbnQ+PC9kZWZzPjxnIGlkPSfpobXpnaItMScgc3Ryb2tlPSdub25lJyBzdHJva2Utd2lkdGg9JzEnIGZpbGw9J25vbmUnIGZpbGwtcnVsZT0nZXZlbm9kZCc+PGcgaWQ9JzHjgIHmn6Xor6JVSeiuvuiuoScgdHJhbnNmb3JtPSd0cmFuc2xhdGUoLTEyMTQuMDAwMDAwLCAtNTY1LjAwMDAwMCknPjxnIGlkPSfnvJbnu4QtMjYnIHRyYW5zZm9ybT0ndHJhbnNsYXRlKDg5OC4wMDAwMDAsIDc1LjAwMDAwMCknPjxnIGlkPSfnvJbnu4QtMzAnIHRyYW5zZm9ybT0ndHJhbnNsYXRlKDIzOS4wMDAwMDAsIDM3NS4wMDAwMDApJz48ZyBpZD0n57yW57uELTM05aSH5Lu9JyB0cmFuc2Zvcm09J3RyYW5zbGF0ZSg0MC4wMDAwMDAsIDExNS4wMDAwMDApJz48ZyBpZD0n57yW57uELTMzJyB0cmFuc2Zvcm09J3RyYW5zbGF0ZSgzNy4wMDAwMDAsIDAuMDAwMDAwKSc+PGcgaWQ9J+e8lue7hC01Jz48cmVjdCBpZD0n55+p5b2i5aSH5Lu9LTMnIGZpbGw9JyNCM0QyRkYnIG9wYWNpdHk9JzAuMjQzODYxNjA3JyB4PScyNicgeT0nMTAnIHdpZHRoPScyNCcgaGVpZ2h0PScxOCcgcng9JzAuNSc+PC9yZWN0PjxnIGlkPSfnn6nlvaLlpIfku70tNicgb3BhY2l0eT0nMC41OTYxMjE2NTInPjx1c2UgZmlsbD0nYmxhY2snIGZpbGwtb3BhY2l0eT0nMScgZmlsdGVyPSd1cmwoI2ZpbHRlci0yKScgeGxpbms6aHJlZj0nI3BhdGgtMSc+PC91c2U+PHJlY3Qgc3Ryb2tlLW9wYWNpdHk9JzAuMjIzNDQ4NDI3JyBzdHJva2U9JyMwMDUxQjknIHN0cm9rZS13aWR0aD0nMScgc3Ryb2tlLWxpbmVqb2luPSdzcXVhcmUnIGZpbGw9JyM3QkIyRjgnIGZpbGwtcnVsZT0nZXZlbm9kZCcgeD0nMjYuNScgeT0nMzEuNScgd2lkdGg9JzIzJyBoZWlnaHQ9JzE3JyByeD0nMC41Jz48L3JlY3Q+PC9nPjxyZWN0IGlkPSfnn6nlvaLlpIfku70tMTInIGZpbGw9JyNCM0QyRkYnIG9wYWNpdHk9JzAuMjQzODYxNjA3JyB4PScwJyB5PScxMCcgd2lkdGg9JzI0JyBoZWlnaHQ9JzE4JyByeD0nMC41Jz48L3JlY3Q+PHJlY3QgaWQ9J+efqeW9ouWkh+S7vS0xNCcgZmlsbD0nI0IzRDJGRicgb3BhY2l0eT0nMC4yNDM4NjE2MDcnIHg9JzAnIHk9JzEnIHdpZHRoPSc1MCcgaGVpZ2h0PSc2JyByeD0nMC41Jz48L3JlY3Q+PHJlY3QgaWQ9J+efqeW9ouWkh+S7vS0xOCcgZmlsbD0ndXJsKCNsaW5lYXJHcmFkaWVudC0zKScgeD0nMCcgeT0nMzEnIHdpZHRoPScyNCcgaGVpZ2h0PScxOCcgcng9JzAuNSc+PC9yZWN0PjwvZz48L2c+PC9nPjwvZz48L2c+PC9nPjwvZz48L3N2Zz4="\r\n              style="width: 50px;height: 56px;display: block;">\r\n            \x3c!-- <span class="imgFont">{{localizeService?.getValue(\'spread.crossTable.colDimensionTitle\')}}</span> --\x3e\r\n          </div>\r\n          <ul class="f-utils-overflow-xhya f-utils-fill pb-1" style="z-index: 20"\r\n            [dndList]="lists && lists.length ? lists[2].value : []" (dndListChange)="dndListChange2($event)">\r\n            <li *ngFor="let item of (lists && lists.length ? lists[2].value : []); let i = index;" [dndDraggable]="item"\r\n              class="mb-1 p-1" (dndMoved)="moved(i, lists[2].value)" dndEffectAllowed="move"\r\n              (dndSelected)="models.selected = item" [ngClass]="{\'selected\': models.selected === item}">\r\n              {{item.name}}\r\n            </li>\r\n          </ul>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n',styles:[".simpleDemo ul{min-height:42px;padding:0}.card-title,.demo-header{text-align:center}.title{margin:20px 0}.simpleDemo ul .dndDraggingSource{display:none}.simpleDemo ul .dndPlaceholder{background:rgba(56,143,255,.06);border:1px dashed #388fff;box-shadow:0 0 4px 0 rgba(13,95,201,.22);margin:.25rem!important;padding:.25rem!important}.simpleDemo ul li{background:rgba(235,244,254,.84);border:1px solid #388fff;box-shadow:0 0 10px 0 rgba(63,113,177,.22);border-radius:3px;height:28px;font-family:PingFangSC-Regular;font-size:13px;color:#388fff;margin:.25rem!important;padding:.25rem!important}#unselectFieldList li{border:none;background-color:rgba(0,0,0,0);box-shadow:0 0 #000;border-radius:3px;height:28px;margin:.25rem!important;padding:.25rem!important}#unselectFieldList li:hover{background:#f4f5f9}#unselectFieldList .dndPlaceholder{background:rgba(56,143,255,.06);border:1px dashed #388fff;box-shadow:0 0 4px 0 rgba(13,95,201,.22);margin:.25rem!important;padding:.25rem!important}.unselectField{font-family:PingFangSC-Regular;font-size:13px;color:rgba(0,0,0,.85)}.unselectFieldFront{font-family:PingFangSC-Medium;font-size:13px;color:#b4bccc}.simpleDemo ul li.selected{background-color:#dff0d8;color:#3c763d}.current-model{background-color:#f5f5f5;border:1px solid #ccc;border-radius:4px;padding:18px 22px}.slicer{height:220px;position:relative}.headerMenu{position:fixed;display:none;top:0;left:0}.cardTitle{background:#f5f7fa;border-radius:3px 3px 0 0;height:36px}.dimensionTitle{font-family:PingFangSC-Medium;font-size:14px;color:rgba(0,0,0,.65);line-height:20px}.imgFont{font-family:PingFangSC-Regular;font-size:13px;color:#b4bccc}"]}]}],e.ctorParameters=function(){return[{type:h.Injector}]},e.propDecorators={controlType:[{type:h.Input}],queryRelativeUrl:[{type:h.Input}],queryId:[{type:h.Input}],qoManagerCode:[{type:h.Input}],qoId:[{type:h.Input}],voId:[{type:h.Input}],groupType:[{type:h.Input}],spread:[{type:h.Input}],conditionExpression:[{type:h.Input}],jointsearchInfoList:[{type:h.Input}],qdpView:[{type:h.Input}]},e}(),A=function(){function e(e,t,i,n,s){this.renderService=t,this.renderer=i,this.filterService=n,this.injector=s,this.aggreData=[{name:"请选择",value:0},{name:"合计",value:1},{name:"最小值",value:2},{name:"最大值",value:3},{name:"计数",value:4},{name:"平均值",value:5}],this.groupSelectValue=this.aggreData[0].value,this.groupText="",this.colIsGroup=!1,this.formInline=!0,this.currentColIndex=0,this.isInitQdpView=!0,this.isShowDimension=!0,this.cls=!0,this.isOpen=!1,this.headerMenuTop=0,this.headerMenuLeft=0,this.headerMenuDisplay="none",this.colIsGroupId="colIsGroup"+b.EventBus.guid(),this.style={width:"800px",height:"600px"},this.isCommonQdpViewComponent=!1,this.sheetChanged=new l.Subject,this.multiSheetsSchemaIds={},this.searchText="",this.groupIcon='<span class="k-icon k-i-search"></span>',this.conditionExpression=null,this.elRef=e,this.injector&&(this.localizeService=this.injector.get(d.LocalizeService),this.msgService=this.injector.get(a.MessagerService),this.localId=this.injector.get(h.LOCALE_ID)||d.DEFAULT_LANGUAGE,this.formInline=this.localId.toLowerCase()===d.DEFAULT_LANGUAGE,this.loadService=this.injector.get(p.LoadingService),this.lcpService=this.injector.get(b.LcpService),this.jointSearchManagerService=this.injector.get(b.JointSearchManagerService),this.schemaManager=this.injector.get(b.SchemaManagerService),this.dataRenderExtendService=this.injector.get(b.DataRenderExtendService),this.formErrorService=this.injector.get(u.FormErrorService),this.aggreData=this.localizeService.getValue("ideCmp.schemaManager.columnOption.aggregateData"),this.cache=this.injector.get(r.CacheService))}return e.prototype.setServices=function(){y.setServices("renderExtends"+this.queryId,this.dataRenderExtendService)},e.prototype.ngOnInit=function(){this.loading=this.loadService.show({container:"body"}),this.setServices(),"crosstab"===this.controlType&&(this.docClickSubscription=this.renderer.listen("document","click",this.onDocumentClick.bind(this))),this.tabId=b.RtfServices.getTabId(this.queryId),b.QDPCacheUtil.setCache(this.tabId+this.queryId+this.controlType+"qdpview",this),y.setServices(this.tabId+"qoId",this.qoId)},e.prototype.ngAfterViewInit=function(){var t=this;try{this.lcpService.formErrorService=this.formErrorService,this.lcpService.getSpreadLicense().subscribe(function(e){e&&(GC.Spread.Sheets.LicenseKey=e),t.afterView()})}catch(e){this.loading.close()}this.setMultiSheetsVarible()},e.prototype.setMultiSheetsVarible=function(){this.columnsSettingComponent&&(this.columnsSettingComponent.multiSheets=this.multiSheets,this.columnsSettingComponent.curSheet=this.curSheet,this.columnsSettingComponent.multiSheetsSchemaIds=this.multiSheetsSchemaIds)},e.prototype.afterView=function(){var e=this.elRef.nativeElement.querySelector("#sheet");this.licenseKey&&(GC.Spread.Sheets.LicenseKey=this.licenseKey),this.spread=new GC.Spread.Sheets.Workbook(e,{sheetCount:0}),this.setSpreadOptions();var t=this.tabId;b.EventBus.register("schemaValueChanged",this.handleSchemaValueChanged.bind(this),t+"qdpViewComponent"),"qdpAdvancedTemplate"!==this.templateType&&this.isInitQdpView?this.initQdpView():this.loading.close()},e.prototype.handleSchemaValueChanged=function(e){this.schemaValue=e,this.curSheet&&this.multiSheets.length&&e&&e.id&&(this.multiSheetsSchemaIds[this.curSheet]=e.id,this.setMultiSheetsVarible())},e.prototype.initQdpView=function(){var n=this,s=this;this.loading||(this.loading=this.loadService.show({container:"body"})),this.jointSearchManagerService.getjointsearch("formff3ea474-cc65-23b0-cdb1-73c9146cea3b",this.queryId,"").subscribe(function(i){n.filterService.getFilter(n.qoManagerCode?n.qoManagerCode:n.queryId,n.queryId,n.queryRelativeUrl,1,n.groupType).subscribe(function(e){s.conditionExpression=null,s.jointsearchInfoList=i,e&&e.filter&&(s.conditionExpression=JSON.stringify(e.filter));var t=Object.assign({multiSheetsSchemaIds:s.multiSheetsSchemaIds,curSheet:s.curSheet,multiSheets:s.multiSheets},{queryId:s.queryId,controlType:s.controlType,qoManagerCode:s.qoManagerCode,pageIndex:0,queryRelativeUrl:s.queryRelativeUrl,filterCondition:s.conditionExpression,groupType:s.groupType,voId:s.voId,jointsearchInfoList:s.jointsearchInfoList,loading:n.loading});n.qdpViewRender(t)})})},e.prototype.bindCustomEvent=function(e){},e.prototype.setSpreadOptions=function(){var i=this,t=this.spread;if(this.spread){t.suspendEvent(),t.suspendPaint(),this.spread.fromJSON(null);var e=this.spreadOptions;e&&e.forEach(function(e){"name"===e.name?t.name=e.value:t.options[e.name]=e.value}),t.unbind(GC.Spread.Sheets.Events.ActiveSheetChanged),t.bind(GC.Spread.Sheets.Events.ActiveSheetChanged,function(e,t){i.curSheet=t.newSheet.name(),i.setGroup(i.curSheet),i.setMultiSheetsVarible(),i.initQdpView()}),t.resumePaint(),t.resumeEvent()}},e.prototype.initSpread=function(e,t,i,n,s,a,r,l,o,c,d){this.curSheet&&this.multiSheets.length&&(this.multiSheetsSchemaIds[this.curSheet]=t,this.setMultiSheetsVarible()),this.qdpViewRender(Object.assign({multiSheetsSchemaIds:this.multiSheetsSchemaIds,curSheet:this.curSheet,multiSheets:this.multiSheets},{schemaId:t,queryId:e,spread:this.spread,controlType:i,qoManagerCode:n,pageIndex:s,queryRelativeUrl:a,filterCondition:r,formData:this.formData,groupType:l,voId:o,qdpView:this,fromCache:c,isSchemaSelectChanged:d,jointsearchInfoList:this.jointsearchInfoList}))},e.prototype.qdpViewRender=function(e){e.loading||(e.loading=this.loadService.show({container:"body"})),e.voId=e.voId?e.voId:this.voId,e.groupType=e.groupType?e.groupType:this.groupType,e.fromCache=!!e.fromCache&&e.fromCache,e.filterCondition&&(this.conditionExpression=e.filterCondition);var t=Object.assign({},e,{formData:this.formData,spread:this.spread,qdpView:this});this.renderService.render(t),b.EventBus.register(this.queryId+"spread_init",this.registeSpreadColumnWidthChangedEvent.bind(this),this.queryId)},e.prototype.exportExcel=function(e,t,i,n,s,a,r,l,o,c,d){this["export"](Object.assign({multiSheetsSchemaIds:this.multiSheetsSchemaIds,curSheet:this.curSheet,multiSheets:this.multiSheets},{queryId:e,schemaId:t,controlType:i,pageIndex:n,qoManagerCode:s,queryRelativeUrl:a,filterCondition:r,groupType:l,voId:o,totalCount:c,exportType:d}))},e.prototype["export"]=function(e){"crosstab"===this.controlType&&(e.totalCount=this.spread.getActiveSheet().getRowCount()),e.voId=this.voId?this.voId:e.voId,e.queryId=this.queryId?this.queryId:e.queryId,e.groupType=this.groupType?this.groupType:e.groupType,e.qoManagerCode=this.qoManagerCode?this.qoManagerCode:e.qoManagerCode,this.renderService.exportData(e)},e.prototype.pdfExportEvent=function(e,t,i,n,s,a,r,l,o,c){this.print(Object.assign({multiSheetsSchemaIds:this.multiSheetsSchemaIds,curSheet:this.curSheet,multiSheets:this.multiSheets},{queryId:e,schemaId:t,controlType:i,pageIndex:l,qoManagerCode:n,queryRelativeUrl:a,printIntegration:s,filterCondition:r,groupType:o,voId:c}))},e.prototype.print=function(e){e.voId=this.voId?this.voId:e.voId,e.queryId=this.queryId?this.queryId:e.queryId,e.groupType=this.groupType?this.groupType:e.groupType,e.qoManagerCode=this.qoManagerCode?this.qoManagerCode:e.qoManagerCode,this.renderService.pdfExportEvent(e)},e.prototype.printPreView=function(e,t,i,n,s,a,r,l,o,c){var d=this.voId?this.voId:c,u=this.queryId?this.queryId:e,h=this.groupType?this.groupType:o,p=this.qoManagerCode?this.qoManagerCode:n;this.renderService.printPreView(Object.assign({multiSheetsSchemaIds:this.multiSheetsSchemaIds,curSheet:this.curSheet,multiSheets:this.multiSheets},{queryId:u,schemaId:t,controlType:i,qoManagerCode:p,printIntegration:s,queryRelativeUrl:a,filterCondition:r,groupType:h,pageIndex:l,voId:d}))},e.prototype.printPreview=function(e){e.groupType=this.groupType?this.groupType:e.groupType,e.voId=this.voId?this.voId:e.voId,this.renderService.printPreView(e)},e.prototype.ngOnChanges=function(e){var t=[];for(var i in e){var n=e[i].currentValue;if(null!=n)switch(this.tabId=b.RtfServices.getTabId(this.queryId),i){case"hostStyle":this.style=n,this.spread&&this.spread.refresh();break;case"hostClass":break;case"name":this.spread.name=n;break;case"formData":n.dynamicCols.forEach(function(e){e.name=e.title,e.bindField=e.field,e.colWidth=150,e.align=0,e.visible=!0,e.isFixed=!1,e.formatType=0,e.formattor="",e.sort=0,e.pageAggreText=null,e.pageAggre=0,e.isGroup=!1,e.groupAggreText="",e.groupAggre=0,e.totalAggreText="",e.totalAggre=0,e.level=1,e.childList=[],e.dimension=0,e.rowColor=null}),this.formData=n,this.ngOnDestroy(),this.afterView();break;case"groupType":this.groupType=n;break;case"queryId":this.queryId=n,b.QDPCacheUtil.setCache(this.tabId+this.queryId+this.controlType+"qdpview",this);break;case"controlType":this.controlType=n;break;case"qoId":this.qoId=n,y.setServices(this.tabId+"qoId",this.qoId);break;case"qoManagerCode":case"voId":case"queryRelativeUrl":case"templateType":break;case"multiSheets":this.multiSheets=n,this.setGroup(this.multiSheets[0]);break;case"licenseKey":n&&(GC.Spread.Sheets.LicenseKey=n);break;case"isCommonQdpViewComponent":this.isCommonQdpViewComponent=n,this.isCommonQdpViewComponent;break;default:t.push({name:i,value:n})}}this.spreadOptions=t,this.setSpreadOptions()},e.prototype.ngOnDestroy=function(){this.spread&&this.spread.destroy()},e.prototype.onResized=function(e){this.style.height=e.newHeight+"px",this.style.width=e.newWidth+"px"},e.prototype.toggle=function(){var t=this,e=!1;this.isOpen&&(e="crosstab"===this.controlType?(this.dimensionSettingComponent.isCompare=!1,this.dimensionSettingComponent.selectedDimesion(),this.dimensionSettingComponent.isCompare):(this.columnsSettingComponent.isCompare=!1,this.columnsSettingComponent.selectedDimesion(),this.columnsSettingComponent.isCompare),this.schemaValue&&1!==this.schemaValue.isPrefab&&!e&&(this.schemaValue.schemaValue="crosstab"===this.controlType?JSON.stringify(this.dimensionSettingComponent.schemaValue.schemaValue):JSON.stringify(this.columnsSettingComponent.schemaValue.schemaValue),this.schemaManager.saveSchema({schema:JSON.stringify(this.schemaValue),groupType:this.groupType},"").subscribe(function(){},function(e){t.formErrorService.exception(e.Message,e)}),this.schemaValue.schemaValue=JSON.parse(this.schemaValue.schemaValue))),this.isOpen=!this.isOpen},e.prototype.setGroup=function(e){if(this.curSheet=e,this.groupType){for(var t=0;t<this.multiSheets.length;t++)this.groupType=this.groupType.replace(this.multiSheets[t],"");this.groupType+=e}else this.groupType=e;this.sheetChanged.next(this.groupType)},e.prototype.onDocumentClick=function(e){"CANVAS"===e.target.tagName&&(this.isOpen=!1)},e.prototype.handleCrosstabPageChange=function(e,t){this.sheet=this.spread.getActiveSheet();for(var i=0;i<this.sheet.getRowCount();i++)(e-1)*t<=i&&i<e*t?(this.sheet.setRowVisible(i,!0,GC.Spread.Sheets.SheetArea.viewport),this.sheet.showRow(i,GC.Spread.Sheets.VerticalPosition.bottom)):this.sheet.setRowVisible(i,!1,GC.Spread.Sheets.SheetArea.viewport)},e.prototype.handleContextMenu=function(e){if("list"===this.controlType.toLowerCase()){for(var t=0,i=0,n=this.sheetEl.nativeElement;n;)t+=n.offsetLeft,i+=n.offsetTop,n=n.offsetParent;var s=this.spread.getActiveSheet(),a=GC.Spread.Sheets.SheetArea.colHeader,r=s.hitTest(e.clientX-t,e.clientY-i);if(r.hitTestType!==a||r.col===undefined||r.row===undefined)return!1;var l=s.getRowCount(a),o=s.getSpan(r.row,r.col,a);if(o&&r.row+o.rowCount<l)return!1;this.currentColIndex=r.col,this.initColGroupAggre(this.currentColIndex),this.headerMenuDisplay="block",this.headerMenuTop=e.clientY,this.headerMenuLeft=e.clientX}return!1},e.prototype.handleIsGroupClick=function(){this.colIsGroup&&(this.groupSelectValue=this.aggreData[0].value,this.groupText="")},e.prototype.handleSaveClick=function(){var t=this,i=this;try{if(this.schemaValue&&this.schemaValue.schemaValue&&this.schemaValue.schemaValue.columnOption&&this.schemaValue.schemaValue.columnOption.colList){if(this.schemaValue&&1===this.schemaValue.isPrefab)return void this.msgService.info(this.localizeService.getValue("spread.message.validate.sort"));for(var e=JSON.parse(JSON.stringify(this.schemaValue.schemaValue.columnOption.colList)),n={index:this.currentColIndex,colIndex:0,type:"edit"},s=0;s<e.length;s++)this.recursiveColumnSort(e[s],null,n);this.schemaValue.schemaValue.columnOption.colList=e,this.schemaValue.schemaValue=JSON.stringify(this.schemaValue.schemaValue),this.schemaManager.saveSchema({schema:JSON.stringify(this.schemaValue),groupType:this.groupType},"").subscribe(function(e){i.initQdpView(),i.currentColIndex=0,i.headerMenuDisplay="none"},function(e){t.formErrorService.exception(e.Message,e)})}}catch(a){i.currentColIndex=0}},e.prototype.handleClearSort=function(){var i=this,n=this;try{if(this.schemaValue&&this.schemaValue.schemaValue&&this.schemaValue.schemaValue.columnOption&&this.schemaValue.schemaValue.columnOption.colList&&this.schemaValue.schemaValue.columnOption.colList.length){if(this.schemaValue&&1===this.schemaValue.isPrefab)return void this.msgService.info(this.localizeService.getValue("spread.message.validate.sort"));for(var e=JSON.parse(JSON.stringify(this.schemaValue.schemaValue.columnOption.colList)),t=0;t<e.length;t++)this.recursiveClearColumnSort(e[t],null);this.schemaValue.schemaValue.columnOption.colList=e,this.schemaValue.schemaValue=JSON.stringify(this.schemaValue.schemaValue),this.schemaManager.saveSchema({schema:JSON.stringify(this.schemaValue),groupType:this.groupType},"").subscribe(function(e){var t=Object.assign({multiSheetsSchemaIds:i.multiSheetsSchemaIds,curSheet:i.curSheet,multiSheets:i.multiSheets},{schemaId:i.schemaValue.id,queryId:n.queryId,controlType:n.controlType,qoManagerCode:n.qoManagerCode,pageIndex:0,queryRelativeUrl:n.queryRelativeUrl,filterCondition:n.conditionExpression,groupType:n.groupType,voId:n.voId,jointsearchInfoList:n.jointsearchInfoList});n.qdpViewRender(t),n.currentColIndex=0,n.headerMenuDisplay="none"},function(e){i.formErrorService.exception(e.Message,e)})}}catch(s){n.currentColIndex=0}},e.prototype.handleBlur=function(e){this.headerMenuDisplay="none"},e.prototype.initColGroupAggre=function(e){if(this.schemaValue&&this.schemaValue.schemaValue&&this.schemaValue.schemaValue.columnOption&&this.schemaValue.schemaValue.columnOption.colList&&this.schemaValue.schemaValue.columnOption.colList.length>e)for(var t={index:this.currentColIndex,colIndex:0,type:"init"},i=0;i<this.schemaValue.schemaValue.columnOption.colList.length;i++)this.recursiveColumnSort(this.schemaValue.schemaValue.columnOption.colList[i],null,t)},e.prototype.recursiveColumnSort=function(e,t,i){if(null==t)e.childList&&e.childList.length?this.recursiveColumnSort(null,e.childList,i):(i.colIndex===i.index&&("init"===i.type?(this.colIsGroup=e.isGroup,this.groupText=e.groupAggreText||"",this.groupSelectValue=e.groupAggre):"edit"===i.type&&(e.isGroup=this.colIsGroup,e.groupAggreText=this.groupText||"",e.groupAggre=this.groupSelectValue)),i.colIndex++);else for(var n=0;n<t.length;n++)t[n].childList&&t[n].childList.length?this.recursiveColumnSort(null,t[n].childList,i):(i.colIndex===i.index&&("init"===i.type?(this.colIsGroup=t[n].isGroup,this.groupText=t[n].groupAggreText||"",this.groupSelectValue=t[n].groupAggre):"edit"===i.type&&(t[n].isGroup=this.colIsGroup,t[n].groupAggreText=this.groupText||"",t[n].groupAggre=this.groupSelectValue)),i.colIndex++)},e.prototype.recursiveClearColumnSort=function(e,t){if(null==t)e.childList&&e.childList.length?this.recursiveClearColumnSort(null,e.childList):(e.sort=0,e.sortIndex=0);else for(var i=0;i<t.length;i++)t[i].childList&&t[i].childList.length?this.recursiveClearColumnSort(null,t[i].childList):(t[i].sort=0,t[i].sortIndex=0)},e.prototype.registeSpreadColumnWidthChangedEvent=function(){var l=this;this.sheet=this.spread.getActiveSheet(),l.sheet.bind(GC.Spread.Sheets.Events.ColumnWidthChanged,function(e,t){var i=t.colList[0],n=t.sheet.getColumnWidth(t.colList[0]);if(l.schemaValue&&l.schemaValue.schemaValue&&l.schemaValue.schemaValue.columnOption&&l.schemaValue.schemaValue.columnOption.colList&&l.schemaValue.schemaValue.columnOption.colList.length){if(l.schemaValue&&1===l.schemaValue.isPrefab)return void l.msgService.info(l.localizeService.getValue("spread.message.validate.sort"));for(var s=JSON.parse(JSON.stringify(l.schemaValue.schemaValue.columnOption.colList)),a={index:i,colIndex:0,colWidth:n},r=0;r<s.length;r++)l.recursiveColumnWidthChanged(s[r],null,a);l.schemaValue.schemaValue.columnOption.colList=s,l.schemaValue.schemaValue=JSON.stringify(l.schemaValue.schemaValue),l.schemaManager.saveSchema({schema:JSON.stringify(l.schemaValue),groupType:this.groupType},"").subscribe(function(e){l.schemaValue.schemaValue=JSON.parse(l.schemaValue.schemaValue)},function(e){l.formErrorService.exception(e.Message,e)})}})},e.prototype.recursiveColumnWidthChanged=function(e,t,i){if(null==t)e.childList&&e.childList.length?this.recursiveColumnWidthChanged(null,e.childList,i):(i.colIndex===i.index&&(e.colWidth=i.colWidth),i.colIndex++);else for(var n=0;n<t.length;n++)t[n].childList&&t[n].childList.length?this.recursiveColumnWidthChanged(null,t[n].childList,i):(i.colIndex===i.index&&(t[n].colWidth=i.colWidth),i.colIndex++)},e.decorators=[{type:h.Component,args:[{selector:"qdp-view",template:'<div *ngIf="isShowDimension" #crosstab class="f-cmp-sidebar f-sidebar-slide  f-sidebar-pos-right"\r\n  [ngClass]="{\'f-sidebar-show\': isOpen, \'f-sidebar-collapse\': !isOpen }">\r\n  <div class="f-sidebar-main">\r\n    <div class="f-sidebar-header-ctr ng-star-inserted border mb-2">\r\n      <h5 class="f-sidebar-header-title">{{localizeService.getValue(\'spread.crossTable.dimensionManager\')}}</h5>\r\n      <span id="dimensionClose" (click)="toggle()">\r\n        <img src="data:image/svg+xml;charset=utf-8;base64,PHN2ZyB3aWR0aD0nMTRweCcgaGVpZ2h0PScxNHB4JyB2aWV3Qm94PScwIDAgMTQgMTQnIHZlcnNpb249JzEuMScgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB4bWxuczp4bGluaz0naHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayc+PHRpdGxlPuW9oueKtue7k+WQiDwvdGl0bGU+PGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+PGcgaWQ9J+mhtemdoi0xJyBzdHJva2U9J25vbmUnIHN0cm9rZS13aWR0aD0nMScgZmlsbD0nbm9uZScgZmlsbC1ydWxlPSdldmVub2RkJyBzdHJva2UtbGluZWNhcD0ncm91bmQnPjxnIGlkPScwMi3mn6Xor6JVSeiuvuiuoScgdHJhbnNmb3JtPSd0cmFuc2xhdGUoLTEzMjUuMDAwMDAwLCAtOTUuMDAwMDAwKScgc3Ryb2tlPScjMkQyRjMzJyBzdHJva2Utd2lkdGg9JzEuNCc+PGcgaWQ9J+e8lue7hC0yNicgdHJhbnNmb3JtPSd0cmFuc2xhdGUoODk4LjAwMDAwMCwgNzUuMDAwMDAwKSc+PGcgaWQ9J+e8lue7hC0yNScgdHJhbnNmb3JtPSd0cmFuc2xhdGUoNDIwLjAwMDAwMCwgMTMuMDAwMDAwKSc+PHBhdGggZD0nTTE0LDE0IEw4LDggTDE0LDE0IEw4LDIwIEwxNCwxNCBaIE0xNCwxNCBMMjAsMjAgTDE0LDE0IEwyMCw4IEwxNCwxNCBaJyBpZD0n5b2i54q257uT5ZCIJz48L3BhdGg+PC9nPjwvZz48L2c+PC9nPjwvc3ZnPg==" style="width: 16px; height: 16px; display: block;" />\r\n      </span>\r\n    </div>\r\n    <div class="container f-utils-fill-flex-column">\r\n      <dimension-setting class="h-100"  *ngIf="controlType==\'crosstab\'"\r\n        [controlType]="controlType" \r\n        [queryRelativeUrl]="queryRelativeUrl"\r\n        [qoManagerCode]="qoManagerCode"\r\n        [queryId]="queryId"\r\n        [qoId]="qoId"\r\n        [voId]="voId"\r\n        [groupType]="groupType"\r\n        [spread]="spread"\r\n        [conditionExpression]="conditionExpression"\r\n        [jointsearchInfoList]="jointsearchInfoList"\r\n        [qdpView]="this"\r\n      ></dimension-setting>\r\n      <columns-setting class="h-100"  *ngIf="controlType!=\'crosstab\'"\r\n        [controlType]="controlType" \r\n        [queryRelativeUrl]="queryRelativeUrl"\r\n        [qoManagerCode]="qoManagerCode"\r\n        [queryId]="queryId"\r\n        [qoId]="qoId"\r\n        [voId]="voId"\r\n        [groupType]="groupType"\r\n        [spread]="spread"\r\n        [conditionExpression]="conditionExpression"\r\n        [jointsearchInfoList]="jointsearchInfoList"\r\n        [qdpView]="this"\r\n      ></columns-setting>\r\n    </div>\r\n  </div>\r\n  <div class="f-sidebar-entry-ctr">\r\n    <div class="f-sidebar-entry-icon ng-star-inserted"><span class="f-icon f-sidebar-entry" (click)="toggle()"></span>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<div #sheet id=\'sheet\' [ngStyle]="style" [ngClass]="hostClass" class="flex-fill qdp-overflow-hidden ml-3 mr-3 border"\r\n  (resized)="onResized($event)" (contextmenu)="handleContextMenu($event)" (click)="handleBlur($event)">\r\n</div>\r\n\r\n<div class="dropdown-menu headerMenu" *ngIf="controlType!=\'crosstab\' && controlType!=\'charts\'"\r\n  [style.left.px]="headerMenuLeft" [style.top.px]="headerMenuTop" [style.display]="headerMenuDisplay">\r\n  <div class="flex-fill farris-split-section farris-overflow-hidden">\r\n    <div class="farris-form farris-card-content-bg">\r\n      <div class="col-12 col-md-12 col-lg-12">\r\n        <div class="farris-group-wrap" [class.form-inline]="formInline" [class.farris-form-inline]="formInline">\r\n          <div class="form-group farris-form-group">\r\n            <label class="col-form-label" for="{{colIsGroupId}}">\r\n              <span\r\n                class="farris-label-text">{{localizeService.getValue(\'ideCmp.schemaManager.columnOption.group\')}}:</span>\r\n            </label>\r\n            <div class="farris-input-wrap farris-checkradio-hor">\r\n              <div class="custom-control custom-checkbox mb-0">\r\n                <input type="checkbox" [(ngModel)]="colIsGroup" class="custom-control-input" id="{{colIsGroupId}}"\r\n                  checked="">\r\n                <label class="custom-control-label" for="{{colIsGroupId}}" (click)="handleIsGroupClick()"></label>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div class="col-12 col-md-12 col-lg-12">\r\n        <div class="farris-group-wrap" [class.form-inline]="formInline" [class.farris-form-inline]="formInline">\r\n          <div class="form-group farris-form-group">\r\n            <label class="col-form-label" for="colGroupText">\r\n              <span\r\n                class="farris-label-text">{{localizeService.getValue(\'ideCmp.schemaManager.columnOption.groupTotal\')}}:</span>\r\n            </label>\r\n            <div class="farris-input-wrap">\r\n              <input-group [(ngModel)]="groupText" id="colGroupText"></input-group>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div class="col-12 col-md-12 col-lg-12">\r\n        <div class="farris-group-wrap" [class.form-inline]="formInline" [class.farris-form-inline]="formInline">\r\n          <div class="form-group farris-form-group">\r\n            <label class="col-form-label" for="colGroupAggre">\r\n              <span\r\n                class="farris-label-text">{{localizeService.getValue(\'ideCmp.schemaManager.columnOption.totalType\')}}:</span>\r\n            </label>\r\n            <div class="farris-input-wrap">\r\n              <farris-combo-list id="colGroupAggre" [disabled]="colIsGroup" [(ngModel)]="groupSelectValue"\r\n                [data]="aggreData" [textField]="\'name\'" [idField]="\'value\'" [enableClear]="false"></farris-combo-list>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div class="col-12 col-md-12 col-lg-12">\r\n        <button class="btn btn-primary mr-1" id="button-edit" (click)="handleSaveClick()">\r\n          {{localizeService.getValue(\'ideCmp.schemaManager.btnSave\')}}</button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n',styles:[".qdp-overflow-hidden{overflow:hidden!important}.simpleDemo ul{min-height:42px;padding:0}.card-title,.demo-header{text-align:center}.title{margin:20px 0}.simpleDemo ul .dndDraggingSource{display:none}.simpleDemo ul .dndPlaceholder{background:rgba(56,143,255,.06);border:1px dashed #388fff;box-shadow:0 0 4px 0 rgba(13,95,201,.22);margin:.25rem!important;padding:.25rem!important}.simpleDemo ul li{background:rgba(235,244,254,.84);border:1px solid #388fff;box-shadow:0 0 10px 0 rgba(63,113,177,.22);border-radius:3px;height:28px;font-family:PingFangSC-Regular;font-size:13px;color:#388fff;margin:.25rem!important;padding:.25rem!important}#unselectFieldList li{border:none;background-color:rgba(0,0,0,0);box-shadow:0 0 #000;border-radius:3px;height:28px;margin:.25rem!important;padding:.25rem!important}#unselectFieldList li:hover{background:#f4f5f9}#unselectFieldList .dndPlaceholder{background:rgba(56,143,255,.06);border:1px dashed #388fff;box-shadow:0 0 4px 0 rgba(13,95,201,.22);margin:.25rem!important;padding:.25rem!important}.unselectField{font-family:PingFangSC-Regular;font-size:13px;color:rgba(0,0,0,.85)}.unselectFieldFront{font-family:PingFangSC-Medium;font-size:13px;color:#b4bccc}.simpleDemo ul li.selected{background-color:#dff0d8;color:#3c763d}.current-model{background-color:#f5f5f5;border:1px solid #ccc;border-radius:4px;padding:18px 22px}.slicer{height:220px;position:relative}.headerMenu{position:fixed;display:none;top:0;left:0}.cardTitle{background:#f5f7fa;border-radius:3px 3px 0 0;height:36px}.dimensionTitle{font-family:PingFangSC-Medium;font-size:14px;color:rgba(0,0,0,.65);line-height:20px}.imgFont{font-family:PingFangSC-Regular;font-size:13px;color:#b4bccc}"]}]}],e.ctorParameters=function(){return[{type:h.ElementRef,decorators:[{type:h.Inject,args:[h.ElementRef]}]},{type:L},{type:h.Renderer2},{type:b.FilterManagerService},{type:h.Injector,decorators:[{type:h.Optional}]}]},e.propDecorators={sheetEl:[{type:h.ViewChild,args:["sheet",{read:h.ElementRef}]}],dimensionSettingComponent:[{type:h.ViewChild,args:[j]}],columnsSettingComponent:[{type:h.ViewChild,args:[J]}],isInitQdpView:[{type:h.Input}],isShowDimension:[{type:h.Input}],cls:[{type:h.HostBinding,args:["class.f-utils-fill-flex-column"]}],isCommonQdpViewComponent:[{type:h.Input}],allowUserDragDrop:[{type:h.Input}],allowUserDragFill:[{type:h.Input}],allowUserZoom:[{type:h.Input}],allowUserResize:[{type:h.Input}],showHorizontalScrollbar:[{type:h.Input}],showVerticalScrollbar:[{type:h.Input}],tabStripVisible:[{type:h.Input}],allowUndo:[{type:h.Input}],allowSheetReorder:[{type:h.Input}],allowCopyPasteExcelStyle:[{type:h.Input}],allowExtendPasteRange:[{type:h.Input}],copyPasteHeaderOptions:[{type:h.Input}],showDragFillSmartTag:[{type:h.Input}],scrollbarShowMax:[{type:h.Input}],scrollbarMaxAlign:[{type:h.Input}],tabEditable:[{type:h.Input}],newTabVisible:[{type:h.Input}],tabNavigationVisible:[{type:h.Input}],backColor:[{type:h.Input}],backgroundImage:[{type:h.Input}],backgroundImageLayout:[{type:h.Input}],grayAreaBackColor:[{type:h.Input}],showResizeTip:[{type:h.Input}],showDragDropTip:[{type:h.Input}],showDragFillTip:[{type:h.Input}],showScrollTip:[{type:h.Input}],highlightInvalidData:[{type:h.Input}],useTouchLayout:[{type:h.Input}],hideSelection:[{type:h.Input}],allowUserEditFormula:[{type:h.Input}],enableFormulaTextbox:[{type:h.Input}],autoFitType:[{type:h.Input}],referenceStyle:[{type:h.Input}],hostStyle:[{type:h.Input}],hostClass:[{type:h.Input}],name:[{type:h.Input}],queryId:[{type:h.Input}],controlType:[{type:h.Input}],licenseKey:[{type:h.Input}],qoManagerCode:[{type:h.Input}],queryRelativeUrl:[{type:h.Input}],qoId:[{type:h.Input}],voId:[{type:h.Input}],groupType:[{type:h.Input}],templateType:[{type:h.Input}],multiSheets:[{type:h.Input}],formData:[{type:h.Input}]},e}(),P=function(){function e(){}return e.forRoot=function(){return{ngModule:e,providers:[L]}},e.decorators=[{type:h.NgModule,args:[{imports:[t.CommonModule,p.LoadingModule.forRoot({message:"Loading..."}),b.DndListModule,n.FormsModule,n.ReactiveFormsModule,m.ComboListModule,s.InputGroupModule,g.FDropdownDirectiveTypeModule],declarations:[A,J,j,j],exports:[A,J]}]}],e}();e.QdpViewComponent=A,e.ColumnsSettingComponent=J,e.DimensionSettingComponent=j,e.RenderService=L,e.ServicesUtils=y,e.ParameterUtils=I,e.RenderExtendsUtils=D,e.SchemaUtils=C,e.SpreadStyleUtils=x,e.SpreadModule=P,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=qdp-spread.umd.min.js.map