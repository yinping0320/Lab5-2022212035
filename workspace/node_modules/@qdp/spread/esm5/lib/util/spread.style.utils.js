/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { EventBus, RtfServices } from "@qdp/common";
import { filter } from 'lodash-es';
var SpreadStyleUtils = /** @class */ (function () {
    function SpreadStyleUtils(_queryId, _controlType, _jointsearchInfoList, _serviceCache) {
        this.dataStyleArray = [];
        this.dataRowHeightArray = [];
        this.dataColInfoArray = [];
        this.footerStyleArray = [];
        this.footerRowHeightArray = [];
        this.footerSpansArray = [];
        this.footerDataArray = [];
        this.hyperLinkQuery = {};
        this.autoFitColumnIndex = 0;
        this.valueHeaderRowCount = 0; // 值维度数量
        // 值维度数量
        this.valueHeaderRowArray = [];
        this.rowHeadersColumnCount = 0; // 行标题列数
        // 行标题列数
        this.rowHeaderRowArray = [];
        this.joinParam = {};
        this.queryId = _queryId;
        this.type = _controlType;
        this.jointsearchInfoList = _jointsearchInfoList;
        this.cache = _serviceCache.cacheService;
        this.loadService = _serviceCache.loadingService;
        this.msgService = _serviceCache.msgService;
        this.localizeService = _serviceCache.localizeService;
        this.schemaManager = _serviceCache.schemaManagerService;
        this.formErrorService = _serviceCache.formErrorService;
        this.lcpService = _serviceCache.lcpService;
    }
    /**
     * @param {?} schema
     * @param {?} sheet
     * @return {?}
     */
    SpreadStyleUtils.prototype.setAutoFitColumn = /**
     * @param {?} schema
     * @param {?} sheet
     * @return {?}
     */
    function (schema, sheet) {
        var _this = this;
        if (schema && schema.schemaValue && schema.schemaValue.columnOption && schema.schemaValue.columnOption.colList && schema.schemaValue.columnOption.colList.length) {
            this.autoFitColumnIndex = 0;
            schema.schemaValue.columnOption.colList.forEach((/**
             * @param {?} col
             * @return {?}
             */
            function (col) {
                _this.recursionAutoFitColumn(col, null, sheet);
            }));
        }
    };
    /**
     * @private
     * @param {?} column
     * @param {?} childList
     * @param {?} sheet
     * @return {?}
     */
    SpreadStyleUtils.prototype.recursionAutoFitColumn = /**
     * @private
     * @param {?} column
     * @param {?} childList
     * @param {?} sheet
     * @return {?}
     */
    function (column, childList, sheet) {
        var _this = this;
        if (column) {
            if (column.childList && column.childList.length) {
                this.recursionAutoFitColumn(null, column.childList, sheet);
            }
            else {
                if (column.autoFit) {
                    sheet.autoFitColumn(this.autoFitColumnIndex);
                }
                this.autoFitColumnIndex += 1;
            }
        }
        else {
            childList.forEach((/**
             * @param {?} col
             * @return {?}
             */
            function (col) {
                if (col.childList && col.childList.length) {
                    _this.recursionAutoFitColumn(null, col.childList, sheet);
                }
                else {
                    if (col.autoFit) {
                        sheet.autoFitColumn(_this.autoFitColumnIndex);
                    }
                    _this.autoFitColumnIndex += 1;
                }
            }));
        }
    };
    /**
     * @param {?} sheet
     * @return {?}
     */
    SpreadStyleUtils.prototype.cacheStyle = /**
     * @param {?} sheet
     * @return {?}
     */
    function (sheet) {
        this.dataStyleArray = [];
        this.dataRowHeightArray = [];
        this.dataColInfoArray = [];
        this.footerStyleArray = [];
        this.footerRowHeightArray = [];
        this.footerSpansArray = [];
        this.footerDataArray = [];
        // 缓存区域样式信息
        for (var r = 0; r < sheet.getRowCount(); r++) {
            /** @type {?} */
            var columnStyleArray = new Array();
            /** @type {?} */
            var dataArray = new Array();
            for (var c = 0; c < sheet.getColumnCount(); c++) {
                if (r === 0) {
                    /** @type {?} */
                    var formatter = '';
                    if (sheet.getFormatter(r, c, GC.Spread.Sheets.SheetArea.viewport)) {
                        formatter = sheet.getFormatter(r, c, GC.Spread.Sheets.SheetArea.viewport);
                    }
                    /** @type {?} */
                    var colHeaderCount = sheet.getRowCount(GC.Spread.Sheets.SheetArea.colHeader);
                    /** @type {?} */
                    var colInfo = {
                        name: sheet.getCell(r, c, GC.Spread.Sheets.SheetArea.viewport).value(),
                        size: sheet.getColumnWidth(c, GC.Spread.Sheets.SheetArea.viewport),
                        visible: sheet.getColumnVisible(c, GC.Spread.Sheets.SheetArea.viewport),
                        resizable: sheet.getColumnResizable(c, GC.Spread.Sheets.SheetArea.viewport),
                        formatter: formatter.indexOf('&') >= 0 ? new MyNumFormatter(formatter) : formatter,
                        displayName: sheet.getCell((colHeaderCount - 1), c, GC.Spread.Sheets.SheetArea.colHeader).value()
                    };
                    this.dataColInfoArray.push(colInfo);
                }
                /** @type {?} */
                var style = sheet.getStyle(r, c, GC.Spread.Sheets.SheetArea.viewport);
                if (style == null) {
                    style = new GC.Spread.Sheets.Style();
                    style.locked = true;
                }
                else {
                    style.locked = true;
                }
                if (style && style.formatter && style.formatter.indexOf('&') >= 0) {
                    style.formatter = new MyNumFormatter(style.formatter);
                }
                columnStyleArray.push(style);
                /** @type {?} */
                var text = sheet.getValue(r, c, GC.Spread.Sheets.SheetArea.viewport)
                    || sheet.getText(r, c, GC.Spread.Sheets.SheetArea.viewport)
                    || '';
                dataArray.push(text);
            }
            if (r === 0) {
                this.dataRowHeightArray.push(sheet.getRowHeight(r));
                this.dataStyleArray.push(columnStyleArray);
            }
            else {
                this.footerRowHeightArray.push(sheet.getRowHeight(r));
                this.footerStyleArray.push(columnStyleArray);
                this.footerDataArray.push(dataArray);
            }
        }
        // 缓存span
        /** @type {?} */
        var spans = sheet.getSpans();
        if (spans && spans.length) {
            // tslint:disable-next-line:prefer-for-of
            for (var i = 0; i < spans.length; i++) {
                if (spans[i].row > 0) {
                    this.footerSpansArray.push(spans[i]);
                }
            }
        }
        sheet.deleteRows(1, sheet.getRowCount() - 1);
    };
    /**
     * @param {?} sheet
     * @param {?} schema
     * @param {?=} showZero
     * @return {?}
     */
    SpreadStyleUtils.prototype.applyStyle = /**
     * @param {?} sheet
     * @param {?} schema
     * @param {?=} showZero
     * @return {?}
     */
    function (sheet, schema, showZero) {
        var _this = this;
        /** @type {?} */
        var rowCount = sheet.getRowCount();
        /** @type {?} */
        var colCount = sheet.getColumnCount();
        /** @type {?} */
        var footerCount = this.footerRowHeightArray.length;
        sheet.addRows(rowCount, footerCount);
        /** @type {?} */
        var index = 0;
        /** @type {?} */
        var groupFieldCache = [];
        /** @type {?} */
        var groupFieldValueCache = [];
        /** @type {?} */
        var groupRowCache = [];
        /** @type {?} */
        var groupTreeLevel = {};
        /** @type {?} */
        var columns = sheet.toJSON().columns;
        this.getGroupField(groupFieldCache, schema);
        /** @type {?} */
        var formatFieldCache = [];
        this.getFormatField(formatFieldCache, schema);
        this.getIsRedColumns(formatFieldCache, schema);
        /** @type {?} */
        var isRedColumns = {
            colIndex: 0,
            isRedColumns: []
        };
        this.getIsRedColumns(schema, isRedColumns);
        /** @type {?} */
        var sheetColumns = sheet.toJSON().columns;
        var _loop_1 = function (r) {
            if (formatFieldCache && formatFieldCache.length && r < rowCount) {
                formatFieldCache.forEach((/**
                 * @param {?} item
                 * @return {?}
                 */
                function (item) {
                    /** @type {?} */
                    var dataItem = sheet.getDataItem(r);
                    /** @type {?} */
                    var precision = dataItem[item.formatField] - 0;
                    /** @type {?} */
                    var numberFormat = item.formatter && (item.formatter.indexOf('#,###') >= 0 || item.formatter.indexOf('#,##0') >= 0) ? '#,##0.' : '0.';
                    if (_this.isNumber(precision)) {
                        for (var p = 0; p < precision; p++) {
                            numberFormat += '0';
                        }
                    }
                    /** @type {?} */
                    var formatColIndex = sheetColumns.findIndex((/**
                     * @param {?} el
                     * @return {?}
                     */
                    function (el) { return el.name == item.sourceField; }));
                    if (formatColIndex >= 0 && numberFormat != '0.' && numberFormat != '#,##0.') {
                        sheet.getCell(r, formatColIndex).formatter(numberFormat);
                    }
                }));
            }
            var _loop_2 = function (c) {
                if (r === 0 && !sheet.getColumnVisible(index)) {
                    index += 1;
                }
                if (r >= rowCount) {
                    if (c === 0) {
                        sheet.setStyle(r, c, this_1.footerStyleArray[r - rowCount][c]);
                        if (this_1.footerDataArray && this_1.footerDataArray.length) {
                            sheet.setValue(r, c, this_1.footerDataArray[r - rowCount][c]);
                        }
                        sheet.setRowHeight(r, this_1.footerRowHeightArray[r - rowCount]);
                        if (this_1.footerSpansArray && this_1.footerSpansArray.length) {
                            sheet.addSpan(r, this_1.footerSpansArray[0].col, this_1.footerSpansArray[0].rowCount, this_1.footerSpansArray[0].colCount);
                        }
                    }
                }
                else {
                    /** @type {?} */
                    var formatter = sheet.getFormatter(r, c, GC.Spread.Sheets.SheetArea.viewport);
                    if (formatter && formatter.indexOf && formatter.indexOf('/') >= 0 && formatter.indexOf(';') >= 0) {
                        /** @type {?} */
                        var cellValue = this_1.logicFormat(formatter, sheet.getValue(r, c));
                        sheet.setText(r, c, cellValue);
                    }
                    if (formatter && typeof formatter === 'string' && (formatter.indexOf('yy') >= 0 || formatter.indexOf('MM') >= 0 || formatter.indexOf('dd') >= 0 || formatter.indexOf('HH') >= 0 || formatter.indexOf('mm') >= 0 || formatter.indexOf('ss') >= 0)) {
                        if (sheet.getDataItem(r).hasOwnProperty("qdp_data_flag")) {
                            sheet.setFormatter(r, c, '');
                        }
                    }
                    if (isRedColumns.isRedColumns.findIndex((/**
                     * @param {?} el
                     * @return {?}
                     */
                    function (el) { return el.colIndex == c; })) >= 0 && this_1.isNumber(sheet.getCell(r, c).value()) && (sheet.getCell(r, c).value() - 0 < 0)) {
                        sheet.getCell(r, c).foreColor('red');
                    }
                    if (!showZero) {
                        if (!showZero && columns && columns.length) {
                            if (columns[c].name === 'treeLevel' || columns[c].name === 'isDetail') {
                                return "continue";
                            }
                            if (sheet.getCell(r, c).value() === 0 || sheet.getCell(r, c).value() == '0') {
                                sheet.getCell(r, c).value('');
                            }
                        }
                    }
                }
            };
            for (var c = 0; c < colCount; c++) {
                _loop_2(c);
            }
            if (r < rowCount) {
                // 设置行高
                sheet.setRowHeight(r, this_1.dataRowHeightArray[0]);
                if (this_1.type === 'treelist') {
                    /** @type {?} */
                    var level = sheet.getDataItem(r)['treeLevel'];
                    /** @type {?} */
                    var isDetail = sheet.getDataItem(r)['isDetail'];
                    sheet.setCellType(r, index, new TreeCellType(null, false, level, isDetail));
                    sheet.getStyle(r, index).hAlign = 0;
                    sheet.getStyle(r, index).textIndent = level + 2;
                    for (var i = 0; i <= level; i++) {
                        sheet.rowOutlines.group(r, 1);
                    }
                }
                else if (this_1.type === 'list' && groupFieldCache.length) {
                    /** @type {?} */
                    var filterCondition = {};
                    if (groupRowCache.findIndex((/**
                     * @param {?} x
                     * @return {?}
                     */
                    function (x) { return x === r; })) >= 0) {
                        return "continue";
                    }
                    for (var c = 0; c < colCount; c++) {
                        if (sheet.getDataItem(r).hasOwnProperty("qdp_data_flag") && (sheet.getDataItem(r)["qdp_data_flag"] + '') === (4 + '')) {
                            if (sheet.getFormatter(r, c) && (sheet.getFormatter(r, c).toString().indexOf('y') >= 0 || sheet.getFormatter(r, c).toString().indexOf('d') >= 0 || sheet.getFormatter(r, c).toString().indexOf('M') >= 0)) {
                                sheet.setFormatter(r, c, '');
                            }
                        }
                    }
                    /** @type {?} */
                    var addRowsCache = [];
                    var _loop_3 = function (i) {
                        /** @type {?} */
                        var addRowIndex = r + addRowsCache.length;
                        // const groupField = groupFieldCache[i];
                        /** @type {?} */
                        var fieldIndex = this_1.dataColInfoArray.findIndex((/**
                         * @param {?} x
                         * @return {?}
                         */
                        function (x) { return x.name === groupFieldCache[i]; }));
                        filterCondition = {};
                        for (var f = 0; f <= i; f++) {
                            filterCondition[groupFieldCache[f]] = sheet.getDataItem(addRowIndex)[groupFieldCache[f]];
                        }
                        /** @type {?} */
                        var filterResult = filter(groupFieldValueCache, filterCondition);
                        if ((!filterResult || !filterResult.length) && !sheet.getDataItem(addRowIndex).hasOwnProperty("qdp_data_flag")) {
                            // const groupFieldValue = {};
                            // groupFieldValue[groupField] = filterCondition[groupField];
                            groupFieldValueCache.push(filterCondition);
                            /** @type {?} */
                            var style = this_1.dataStyleArray[0][fieldIndex];
                            style.hAlign = 0;
                            style.cellType = null;
                            style.backColor = '#F4F7FA';
                            sheet.addRows(addRowIndex, 1);
                            sheet.setRowHeight(addRowIndex, this_1.dataRowHeightArray[0]);
                            sheet.setStyle(addRowIndex, index, style);
                            sheet.getCell(addRowIndex, index).value(filterCondition[groupFieldCache[i]]);
                            sheet.addSpan(addRowIndex, index, 1, (colCount - index));
                            sheet.getCell(addRowIndex, index).textIndent((i + 1) * 2);
                            groupTreeLevel[addRowIndex + ''] = { treeLevel: i, isDetail: 0 };
                            if (i === (groupFieldCache.length - 1)) {
                                groupTreeLevel[(addRowIndex + 1) + ''] = { treeLevel: groupFieldCache.length, isDetail: 1 };
                            }
                            rowCount += 1;
                            addRowsCache.push(i);
                            groupRowCache.push(addRowIndex);
                        }
                        else {
                            if (sheet.getDataItem(addRowIndex).hasOwnProperty("qdp_data_flag") && (sheet.getDataItem(addRowIndex)["qdp_data_flag"] + '') === (3 + '')) {
                                return "continue";
                            }
                            if (i === (groupFieldCache.length - 1)) {
                                groupTreeLevel[(addRowIndex + 1) + ''] = { treeLevel: groupFieldCache.length, isDetail: 1 };
                            }
                        }
                    };
                    for (var i = 0; i < groupFieldCache.length; i++) {
                        _loop_3(i);
                    }
                }
            }
        };
        var this_1 = this;
        for (var r = 0; r < (rowCount + footerCount); r++) {
            _loop_1(r);
        }
        for (var r = 0; r < rowCount; r++) {
            if (!groupTreeLevel.hasOwnProperty(r)) {
                break;
            }
            for (var t = 0; t <= groupTreeLevel[r + ''].treeLevel; t++) {
                sheet.rowOutlines.group(r, 1);
            }
            sheet.setCellType(r, index, new TreeCellType(null, false, groupTreeLevel[r + ''].treeLevel, groupTreeLevel[r + ''].isDetail));
        }
        if (this.type !== 'crosstab' && this.getShowFilterRow(schema)) {
            this.filterRow(sheet);
        }
    };
    /**
     * @param {?} groupColCache
     * @param {?} schema
     * @return {?}
     */
    SpreadStyleUtils.prototype.getGroupField = /**
     * @param {?} groupColCache
     * @param {?} schema
     * @return {?}
     */
    function (groupColCache, schema) {
        var _this = this;
        if (schema && schema.schemaValue && schema.schemaValue.columnOption && schema.schemaValue.columnOption.colList && schema.schemaValue.columnOption.colList.length) {
            this.autoFitColumnIndex = 0;
            schema.schemaValue.columnOption.colList.forEach((/**
             * @param {?} col
             * @return {?}
             */
            function (col) {
                _this.recursionGetGroupColumn(groupColCache, col, null);
            }));
        }
    };
    /**
     * @param {?} schema
     * @param {?} params
     * @return {?}
     */
    SpreadStyleUtils.prototype.getIsRedColumns = /**
     * @param {?} schema
     * @param {?} params
     * @return {?}
     */
    function (schema, params) {
        var _this = this;
        if (schema && schema.schemaValue && schema.schemaValue.columnOption && schema.schemaValue.columnOption.colList && schema.schemaValue.columnOption.colList.length) {
            schema.schemaValue.columnOption.colList.forEach((/**
             * @param {?} col
             * @return {?}
             */
            function (col) {
                _this.recursiveIsRedColumn(col, null, params);
            }));
        }
    };
    /**
     * @param {?} fieldCache
     * @param {?} schema
     * @return {?}
     */
    SpreadStyleUtils.prototype.getFormatField = /**
     * @param {?} fieldCache
     * @param {?} schema
     * @return {?}
     */
    function (fieldCache, schema) {
        var _this = this;
        if (schema && schema.schemaValue && schema.schemaValue.columnOption && schema.schemaValue.columnOption.colList && schema.schemaValue.columnOption.colList.length) {
            this.autoFitColumnIndex = 0;
            schema.schemaValue.columnOption.colList.forEach((/**
             * @param {?} col
             * @return {?}
             */
            function (col) {
                _this.recursionGetFormatColumn(fieldCache, col, null);
            }));
        }
    };
    /**
     * @param {?} schema
     * @return {?}
     */
    SpreadStyleUtils.prototype.getShowHeaderSort = /**
     * @param {?} schema
     * @return {?}
     */
    function (schema) {
        try {
            if (schema && schema.schemaValue && schema.schemaValue.otherOption && schema.schemaValue.otherOption.showHeaderSort != null && schema.schemaValue.otherOption.showHeaderSort != undefined) {
                return schema.schemaValue.otherOption.showHeaderSort;
            }
            return true;
        }
        catch (e) {
            return true;
        }
    };
    /**
     * @param {?} schema
     * @return {?}
     */
    SpreadStyleUtils.prototype.getShowFilterRow = /**
     * @param {?} schema
     * @return {?}
     */
    function (schema) {
        try {
            if (schema && schema.schemaValue && schema.schemaValue.otherOption && schema.schemaValue.otherOption.showFilterRow != null && schema.schemaValue.otherOption.showFilterRow != undefined) {
                return schema.schemaValue.otherOption.showFilterRow;
            }
            return true;
        }
        catch (e) {
            return true;
        }
    };
    /**
     * @param {?} schema
     * @return {?}
     */
    SpreadStyleUtils.prototype.getMergeCell = /**
     * @param {?} schema
     * @return {?}
     */
    function (schema) {
        try {
            if (schema && schema.schemaValue && schema.schemaValue.otherOption && schema.schemaValue.otherOption.mergeCell != null && schema.schemaValue.otherOption.mergeCell != undefined) {
                return schema.schemaValue.otherOption.mergeCell;
            }
            return false;
        }
        catch (e) {
            return false;
        }
    };
    /**
     * @private
     * @param {?} fieldCache
     * @param {?} column
     * @param {?} childList
     * @return {?}
     */
    SpreadStyleUtils.prototype.recursionGetFormatColumn = /**
     * @private
     * @param {?} fieldCache
     * @param {?} column
     * @param {?} childList
     * @return {?}
     */
    function (fieldCache, column, childList) {
        var _this = this;
        if (column) {
            if (column.childList && column.childList.length) {
                this.recursionGetFormatColumn(fieldCache, null, column.childList);
            }
            else {
                if (column.formatType == 1 && column.formatField) {
                    fieldCache.push({ sourceField: column.bindField, formatField: column.formatField, formatter: column.formattor });
                }
            }
        }
        else {
            childList.forEach((/**
             * @param {?} col
             * @return {?}
             */
            function (col) {
                if (col.childList && col.childList.length) {
                    _this.recursionGetFormatColumn(fieldCache, null, col.childList);
                }
                else {
                    if (col.formatType == 1 && col.formatField) {
                        fieldCache.push({ sourceField: col.bindField, formatField: col.formatField, formatter: col.formattor });
                    }
                }
            }));
        }
    };
    /**
     * @private
     * @param {?} groupColCache
     * @param {?} column
     * @param {?} childList
     * @return {?}
     */
    SpreadStyleUtils.prototype.recursionGetGroupColumn = /**
     * @private
     * @param {?} groupColCache
     * @param {?} column
     * @param {?} childList
     * @return {?}
     */
    function (groupColCache, column, childList) {
        var _this = this;
        if (column) {
            if (column.childList && column.childList.length) {
                this.recursionGetGroupColumn(groupColCache, null, column.childList);
            }
            else {
                if (column.isGroup) {
                    groupColCache.push(column.bindField);
                }
            }
        }
        else {
            childList.forEach((/**
             * @param {?} col
             * @return {?}
             */
            function (col) {
                if (col.childList && col.childList.length) {
                    _this.recursionGetGroupColumn(groupColCache, null, col.childList);
                }
                else {
                    if (col.isGroup) {
                        groupColCache.push(col.bindField);
                    }
                }
            }));
        }
    };
    /**
     * @param {?} formattor
     * @param {?} cellValue
     * @return {?}
     */
    SpreadStyleUtils.prototype.logicFormat = /**
     * @param {?} formattor
     * @param {?} cellValue
     * @return {?}
     */
    function (formattor, cellValue) {
        /** @type {?} */
        var str = formattor.split(';');
        /** @type {?} */
        var real = str[0].split('/');
        /** @type {?} */
        var disp = str[1].split('/');
        for (var i = 0; i < real.length; i++) {
            // tslint:disable-next-line:triple-equals
            if (real[i] == (cellValue + '')) {
                cellValue = disp[i];
                break;
            }
        }
        return cellValue;
    };
    /**
     * @param {?} sheet
     * @return {?}
     */
    SpreadStyleUtils.prototype.filterRow = /**
     * @param {?} sheet
     * @return {?}
     */
    function (sheet) {
        sheet.addRows(0, 1);
        for (var i = 0; i < sheet.getRowCount(); i++) {
            sheet.getCell(i, 0, GC.Spread.Sheets.SheetArea.rowHeader).value(i == 0 ? '' : i);
        }
        sheet.setRowHeight(0, this.dataRowHeightArray[0]);
        for (var i = 0; i < sheet.getColumnCount(); i++) {
            /** @type {?} */
            var s = new GC.Spread.Sheets.Style();
            s.fromJSON(this.dataStyleArray[0][i].toJSON());
            s.locked = false;
            s.formatter = '@';
            sheet.setStyle(0, i, s);
            sheet.setCellType(0, i, new FilterCellType(sheet));
        }
        /** @type {?} */
        var filter = new GC.Spread.Sheets.Filter.HideRowFilter(new GC.Spread.Sheets.Range(1, 0, sheet.getRowCount(), sheet.getColumnCount()));
        sheet.rowFilter(filter);
        filter.filterButtonVisible(false);
    };
    /**
     * @param {?} spread
     * @param {?} sheet
     * @return {?}
     */
    SpreadStyleUtils.prototype.linkField = /**
     * @param {?} spread
     * @param {?} sheet
     * @return {?}
     */
    function (spread, sheet) {
        try {
            /** @type {?} */
            var self_1 = this;
            /** @type {?} */
            var rowCount = sheet.getRowCount();
            /** @type {?} */
            var colCount = sheet.getColumnCount();
            // const footerCount = this.footerRowHeightArray.length;
            for (var r = 1; r < (rowCount); r++) {
                /** @type {?} */
                var dataItem = sheet.getDataItem(r);
                if (dataItem.hasOwnProperty('dynamicPropSet') && dataItem.dynamicPropSet.hasOwnProperty('qdp_data_flag')) {
                    continue;
                }
                for (var c = 0; c < colCount; c++) {
                    /** @type {?} */
                    var joinSearch = JSON.parse(this.jointsearchInfoList['joinSearch']);
                    // tslint:disable-next-line:prefer-for-of
                    for (var i = 0; i < joinSearch.length; i++) {
                        /** @type {?} */
                        var el = joinSearch[i];
                        if (el.jointserachdisplaystyle === 2) {
                            if (el.linkfield === this.dataColInfoArray[c].name) {
                                if (!this.hyperLinkQuery[this.queryId]) {
                                    this.hyperLinkQuery[this.queryId] = {};
                                }
                                this.hyperLinkQuery[this.queryId][c + ''] = el;
                                /** @type {?} */
                                var h1 = new GC.Spread.Sheets.CellTypes.HyperLink();
                                h1.text(h1.format(sheet.getCell(r, c).value(), this.dataColInfoArray[c].formatter));
                                h1.activeOnClick(true);
                                h1.onClickAction((/**
                                 * @return {?}
                                 */
                                function () {
                                    spread.commandManager().execute({
                                        cmd: 'dropdownquery',
                                        self: self_1
                                    });
                                }));
                                sheet.setCellType(r, c, h1, GC.Spread.Sheets.SheetArea.viewport);
                            }
                        }
                    }
                }
            }
            spread.commandManager().register('dropdownquery', {
                canUndo: true,
                execute: (/**
                 * @param {?} context
                 * @param {?} options
                 * @param {?} isUndo
                 * @return {?}
                 */
                function (context, options, isUndo) {
                    /** @type {?} */
                    var row = context.getActiveSheet().getActiveRowIndex();
                    /** @type {?} */
                    var col = context.getActiveSheet().getActiveColumnIndex();
                    var _loop_4 = function (key) {
                        if (key === (col + '')) {
                            /** @type {?} */
                            var el_1 = options.self.hyperLinkQuery[options.self.queryId][key];
                            /** @type {?} */
                            var entityParam_1 = { 'id': 'null' };
                            /** @type {?} */
                            var paramMap_1 = new Map();
                            /** @type {?} */
                            var searchparas = JSON.parse(options.self.jointsearchInfoList['jointparam']).filter((/**
                             * @param {?} x
                             * @return {?}
                             */
                            function (x) { return x.functionid === el_1['id']; }));
                            /** @type {?} */
                            var joinParam = options.self.cache.get(RtfServices.getTabId(options.self.queryId) + 'joinSearch');
                            /** @type {?} */
                            var dataItem = { 'id': 'null' };
                            if (joinParam.controlType === 'crosstab') { // 交叉表
                                var _loop_5 = function (i) {
                                    /** @type {?} */
                                    var value_1 = context.getActiveSheet().getValue(row, i, GC.Spread.Sheets.SheetArea.viewport);
                                    /** @type {?} */
                                    var name_1 = context.getActiveSheet().getValue(joinParam.colHeaderRowInfo.start, i, GC.Spread.Sheets.SheetArea.colHeader);
                                    /** @type {?} */
                                    var colInfo_1 = joinParam.colInfos.find((/**
                                     * @param {?} x
                                     * @return {?}
                                     */
                                    function (x) { return x.dimension === 1 && x.name === name_1; })).bindField;
                                    dataItem[colInfo_1] = value_1;
                                };
                                // 获取行标题的数据
                                for (var i = joinParam.rowHeaderColInfo.start; i < joinParam.rowHeaderColInfo.end; i++) {
                                    _loop_5(i);
                                }
                                // 获取列标题的数据
                                for (var i = joinParam.colHeaderRowInfo.start; i < joinParam.colHeaderRowInfo.end; i++) {
                                    /** @type {?} */
                                    var value_2 = context.getActiveSheet().getValue(i, col, GC.Spread.Sheets.SheetArea.colHeader);
                                    /** @type {?} */
                                    var colInfo_2 = joinParam.colInfos.filter((/**
                                     * @param {?} x
                                     * @return {?}
                                     */
                                    function (x) { return x.dimension === 2; }))[i - joinParam.colHeaderRowInfo.start].bindField;
                                    dataItem[colInfo_2] = value_2;
                                }
                                // 获取值标题的数据
                                /** @type {?} */
                                var value = context.getActiveSheet().getValue(row, col, GC.Spread.Sheets.SheetArea.viewport);
                                /** @type {?} */
                                var name_2 = context.getActiveSheet().getValue(joinParam.colHeaderRowInfo.end, col, GC.Spread.Sheets.SheetArea.colHeader);
                                /** @type {?} */
                                var colInfo = joinParam.colInfos.find((/**
                                 * @param {?} x
                                 * @return {?}
                                 */
                                function (x) { return x.dimension === 3 && x.name === name_2; }));
                                if (colInfo) {
                                    colInfo = colInfo.bindField;
                                    dataItem[colInfo] = value;
                                }
                            }
                            else {
                                dataItem = context.getActiveSheet().getDataItem(row);
                            }
                            /** @type {?} */
                            var currentSelectedItem_1 = dataItem;
                            if (searchparas.length > 0) {
                                searchparas.forEach((/**
                                 * @param {?} value
                                 * @return {?}
                                 */
                                function (value) {
                                    if (value.paravaluetype) { // 表达式
                                        if (value.paravalue.indexOf('getParameter(') >= 0) {
                                            /** @type {?} */
                                            var parameterKey = value.paravalue.replace(/'/g, '').replace(/"/g, '').replace(/getParameter\(/g, '').replace(/\)/g, '');
                                            options.self.getQueryParameters(entityParam_1, paramMap_1, parameterKey, value.para);
                                        }
                                        else {
                                            entityParam_1[value.para] = currentSelectedItem_1[value.paravalue];
                                            paramMap_1.set(value.para, currentSelectedItem_1[value.paravalue]);
                                        }
                                    }
                                    else {
                                        entityParam_1[value.para] = value.paravalue;
                                        paramMap_1.set(value.para, value.paravalue);
                                    }
                                }));
                            }
                            else {
                                entityParam_1 = currentSelectedItem_1;
                            }
                            /** @type {?} */
                            var op = {
                                ParentSessionId: options.self.cache.get('session'),
                                EntityParam: entityParam_1
                            };
                            /** @type {?} */
                            var tabId = '';
                            if (el_1.searchtype === 'func') {
                                // 联查前
                                /** @type {?} */
                                var openMenuoptions = {
                                    'appType': 'menu',
                                    'funcId': el_1.functioncode,
                                    'tabId': EventBus.guid(),
                                    'appId': '',
                                    'appEntrance': '',
                                    'entityParams': op.entityParam,
                                    'queryStringParams': paramMap_1,
                                    'isNewTab': true
                                };
                                tabId = RtfServices.getFuncId(openMenuoptions);
                                options.self.cache.set(tabId ? tabId : options.self.queryId, op.EntityParam);
                                /** @type {?} */
                                var menuSwitchControl = Object.assign({}, openMenuoptions['entityParams'], RtfServices.getMenuSwitchControlParameter(tabId));
                                openMenuoptions['entityParams'] = menuSwitchControl;
                                // 卡片塞进去params
                                gspframeworkService.rtf.func.openMenu(openMenuoptions);
                            }
                            else if (el_1.searchtype === 'app') {
                                /** @type {?} */
                                var appOption = {
                                    appType: 'app',
                                    appId: el_1.functioncode,
                                    appEntrance: el_1.appEntrance,
                                    funcId: '',
                                    isReload: true,
                                    tabId: EventBus.guid(),
                                    entityParams: op.entityParam,
                                    queryStringParams: paramMap_1
                                };
                                tabId = RtfServices.getFuncId(appOption);
                                options.self.cache.set(tabId ? tabId : options.queryId, op.EntityParam);
                                /** @type {?} */
                                var menuSwitchControl = Object.assign({}, appOption['entityParams'], RtfServices.getMenuSwitchControlParameter(tabId));
                                appOption['entityParams'] = menuSwitchControl;
                                gspframeworkService.rtf.func.openMenu(appOption);
                            }
                        }
                    };
                    for (var key in options.self.hyperLinkQuery[options.self.queryId]) {
                        _loop_4(key);
                    }
                })
            }, null, false, false, false, false);
        }
        catch (e) { }
    };
    /**
     * @param {?} spread
     * @param {?} sheet
     * @param {?} extObj
     * @return {?}
     */
    SpreadStyleUtils.prototype.inSuiteLinkField = /**
     * @param {?} spread
     * @param {?} sheet
     * @param {?} extObj
     * @return {?}
     */
    function (spread, sheet, extObj) {
        try {
            /** @type {?} */
            var self_2 = this;
            /** @type {?} */
            var data_1 = null;
            try {
                if (this.lcpService.inSuiteDropDownInfo && typeof this.lcpService.inSuiteDropDownInfo == 'string') {
                    data_1 = JSON.parse(this.lcpService.inSuiteDropDownInfo);
                }
            }
            catch (e) {
                throw e;
            }
            /** @type {?} */
            var rowCount = sheet.getRowCount();
            /** @type {?} */
            var colCount = sheet.getColumnCount();
            /** @type {?} */
            var rowDropDown = true;
            /** @type {?} */
            var cacheRowDropDown = [];
            /** @type {?} */
            var cacheCellDropDown = {};
            // 解析相关数据
            var clickEvents_1 = data_1.click_events, eventData_1 = data_1.event_data, dcEvent_1 = data_1.double_click_event, dcEventParams_1 = data_1.double_click_event_params, rcEventIds_1 = data_1.rc_event_ids;
            if (dcEvent_1 && !("{}" == JSON.stringify(dcEvent_1)) && dcEventParams_1 && !("{}" == JSON.stringify(dcEventParams_1))) {
                rowDropDown = true;
                for (var key in dcEventParams_1) {
                    cacheRowDropDown.push(key);
                }
            }
            else if (eventData_1 && !("{}" == JSON.stringify(eventData_1))) {
                rowDropDown = false;
                for (var key in eventData_1) {
                    if (eventData_1[key]) {
                        /** @type {?} */
                        var cellIndex = [];
                        cacheCellDropDown[key] = cellIndex;
                        for (var key1 in eventData_1[key]) {
                            cacheCellDropDown[key].push(key1);
                        }
                    }
                }
            }
            for (var r = 1; r < (rowCount); r++) {
                /** @type {?} */
                var dataItem = sheet.getDataItem(r);
                if (dataItem.hasOwnProperty('dynamicPropSet') && dataItem.dynamicPropSet.hasOwnProperty('qdp_data_flag')) {
                    continue;
                }
                for (var c = 0; c < colCount; c++) {
                    if (rowDropDown) {
                        for (var i = 0; i < cacheRowDropDown.length; i++) {
                            if (r == (cacheRowDropDown[i] - 0)) {
                                /** @type {?} */
                                var h1 = new GC.Spread.Sheets.CellTypes.HyperLink();
                                /** @type {?} */
                                var formatter = sheet.getFormatter(r, c);
                                h1.text(h1.format(sheet.getCell(r, c).value(), formatter));
                                h1.activeOnClick(true);
                                h1.onClickAction((/**
                                 * @return {?}
                                 */
                                function () {
                                    spread.commandManager().execute({
                                        cmd: 'dropdownquery',
                                        self: self_2
                                    });
                                }));
                                sheet.setCellType(r, c, h1, GC.Spread.Sheets.SheetArea.viewport);
                            }
                        }
                    }
                    else {
                        for (var key in cacheCellDropDown) {
                            if ((r + '') === key) {
                                for (var i = 0; i < cacheCellDropDown[key].length; i++) {
                                    /** @type {?} */
                                    var h1 = new GC.Spread.Sheets.CellTypes.HyperLink();
                                    /** @type {?} */
                                    var formatter = sheet.getFormatter(r, cacheCellDropDown[key][i]);
                                    h1.text(h1.format(sheet.getCell(r, cacheCellDropDown[key][i]).value(), formatter));
                                    h1.activeOnClick(true);
                                    h1.onClickAction((/**
                                     * @return {?}
                                     */
                                    function () {
                                        spread.commandManager().execute({
                                            cmd: 'dropdownquery',
                                            self: self_2
                                        });
                                    }));
                                    sheet.setCellType(r, cacheCellDropDown[key][i], h1, GC.Spread.Sheets.SheetArea.viewport);
                                }
                            }
                        }
                    }
                }
            }
            spread.commandManager().register('dropdownquery', {
                canUndo: true,
                execute: (/**
                 * @param {?} context
                 * @param {?} options
                 * @param {?} isUndo
                 * @return {?}
                 */
                function (context, options, isUndo) {
                    /** @type {?} */
                    var row = context.getActiveSheet().getActiveRowIndex();
                    /** @type {?} */
                    var col = context.getActiveSheet().getActiveColumnIndex();
                    // 双击事件的逻辑
                    /** @type {?} */
                    var event;
                    /** @type {?} */
                    var params;
                    // 行点击数据
                    if (dcEvent_1 && !("{}" == JSON.stringify(dcEvent_1)) && dcEventParams_1 && !("{}" == JSON.stringify(dcEventParams_1))) {
                        event = dcEvent_1;
                        // args.row为行序号，下同
                        params = dcEventParams_1[row];
                        // 如果eventData数据不为空，并且对应行的数据也不为空
                        // 单元格数据
                    }
                    else if (eventData_1 && !("{}" == JSON.stringify(eventData_1)) && eventData_1[row] && !("{}" == JSON.stringify(eventData_1[row]))) {
                        /** @type {?} */
                        var thisEventId = void 0;
                        // 如果对应行包含-1，则取-1中的数据, 否则取对应列号的数据
                        // args.col为列序号
                        /** @type {?} */
                        var thisEventData = eventData_1[row][-1] || eventData_1[row][col];
                        if (thisEventData && !("{}" == JSON.stringify(thisEventData))) {
                            if (!rcEventIds_1 && rcEventIds_1.length) {
                                /** @type {?} */
                                var obj = {};
                                var _loop_6 = function (key) {
                                    if (rcEventIds_1.findIndex((/**
                                     * @param {?} el
                                     * @return {?}
                                     */
                                    function (el) { return el == key; })) < 0) {
                                        obj[key] = thisEventData[key];
                                    }
                                };
                                for (var key in thisEventData) {
                                    _loop_6(key);
                                }
                                thisEventData = obj;
                            }
                            /** @type {?} */
                            var index = 0;
                            for (var key in thisEventData) {
                                if (index == 0) {
                                    thisEventId = key;
                                }
                                else {
                                    break;
                                }
                                index++;
                            }
                            params = thisEventData[thisEventId];
                        }
                        // 根据event id获取event
                        if (thisEventId != null && thisEventId != undefined) {
                            event = clickEvents_1[thisEventId] && !("{}" == JSON.stringify(clickEvents_1[thisEventId])) ? clickEvents_1[thisEventId].event : {};
                        }
                    }
                    /** @type {?} */
                    var message;
                    if (!("{}" == JSON.stringify(event)) && !("{}" == JSON.stringify(params))) {
                        // 返回数据
                        message = { type: 'cellAction', event: event, params: params, defaults: data_1.defaults };
                    }
                    if (message) {
                        try {
                            extObj.inSuiteWindow().postMessage(message, location.origin);
                        }
                        catch (e) {
                            console.log(e);
                        }
                    }
                })
            }, null, false, false, false, false);
        }
        catch (e) { }
    };
    /**
     * @private
     * @param {?} entityParam
     * @param {?} paramMap
     * @param {?} parameterKey
     * @param {?} key
     * @return {?}
     */
    SpreadStyleUtils.prototype.getQueryParameters = /**
     * @private
     * @param {?} entityParam
     * @param {?} paramMap
     * @param {?} parameterKey
     * @param {?} key
     * @return {?}
     */
    function (entityParam, paramMap, parameterKey, key) {
        try {
            /** @type {?} */
            var tab = gspframeworkService.rtf.session.getCommonVariable();
            if (tab && tab.tabId) {
                /** @type {?} */
                var tid = tab.tabId + RtfServices.getInSuiteFrmUUID();
                if (this.cache.get(tid) && this.cache.get(tid)[parameterKey]) {
                    entityParam[key] = this.cache.get(tid)[parameterKey];
                    paramMap.set(key, this.cache.get(tid)[parameterKey]);
                }
            }
        }
        catch (e) {
        }
    };
    /**
     * @param {?} spread
     * @param {?} queryId
     * @return {?}
     */
    SpreadStyleUtils.prototype.bindSelectChanged = /**
     * @param {?} spread
     * @param {?} queryId
     * @return {?}
     */
    function (spread, queryId) {
        /** @type {?} */
        var self = this;
        spread.bind(GC.Spread.Sheets.Events.SelectionChanging, (/**
         * @param {?} e
         * @param {?} args
         * @return {?}
         */
        function (e, args) {
            /** @type {?} */
            var tempData = {};
            /** @type {?} */
            var selection = args.newSelections.pop();
            /** @type {?} */
            var sheetArea = args.sheetArea === 0 ? 'sheetCorner' : args.sheetArea === 1 ? 'columnHeader' : args.sheetArea === 2 ? 'rowHeader' : 'viewPort';
            if (selection) {
                tempData['SpreadEvent'] = GC.Spread.Sheets.Events.SelectionChanging;
                tempData['sheetArea'] = sheetArea;
                tempData['row'] = selection.row;
                tempData['column'] = selection.col;
                tempData['rowCount'] = selection.rowCount;
                tempData['colCount'] = selection.colCount;
                this.selectChanging = tempData;
            }
        }));
        spread.bind(GC.Spread.Sheets.Events.CellClick, (/**
         * @param {?} e
         * @param {?} args
         * @return {?}
         */
        function (e, args) {
            // 解析当前选中的数据
            /** @type {?} */
            var dataItems = [];
            // 联动参数
            /** @type {?} */
            var linkageParams = {};
            for (var rowIndex = 0; rowIndex < this.selectChanging.rowCount; rowIndex++) {
                if (self.joinParam.controlType !== 'crosstab') {
                    /** @type {?} */
                    var dataItem = args.sheet.getDataItem(rowIndex + this.selectChanging.row);
                    linkageParams = dataItem;
                    dataItems.push(dataItem);
                }
                else {
                    if (this.selectChanging.column === -1) {
                        this.selectChanging.colCount = this.selectChanging.colCount + 1;
                    }
                    var _loop_7 = function (colIndex) {
                        /** @type {?} */
                        var dataItem = {};
                        if (self.joinParam.controlType === 'crosstab') { // 交叉表
                            if (args.sheetArea === 1) {
                                this_2.selectChanging.row = 0;
                            }
                            if (colIndex + this_2.selectChanging.column < self.joinParam.rowHeaderColInfo.end) {
                                return "continue";
                            }
                            var _loop_8 = function (i) {
                                /** @type {?} */
                                var value_3 = args.sheet.getValue(rowIndex + this_2.selectChanging.row, i, GC.Spread.Sheets.SheetArea.viewport);
                                /** @type {?} */
                                var name_3 = args.sheet.getValue(self.joinParam.colHeaderRowInfo.start, i, GC.Spread.Sheets.SheetArea.colHeader);
                                /** @type {?} */
                                var colInfo_3 = self.joinParam.colInfos.find((/**
                                 * @param {?} x
                                 * @return {?}
                                 */
                                function (x) { return x.dimension === 1 && x.name === name_3; })).bindField;
                                dataItem[colInfo_3] = value_3;
                            };
                            // 获取行标题的数据
                            for (var i = self.joinParam.rowHeaderColInfo.start; i < self.joinParam.rowHeaderColInfo.end; i++) {
                                _loop_8(i);
                            }
                            // 获取列标题的数据
                            for (var i = self.joinParam.colHeaderRowInfo.start; i < self.joinParam.colHeaderRowInfo.end; i++) {
                                /** @type {?} */
                                var value_4 = args.sheet.getValue(i, colIndex + this_2.selectChanging.column, GC.Spread.Sheets.SheetArea.colHeader);
                                /** @type {?} */
                                var colInfo_4 = self.joinParam.colInfos.filter((/**
                                 * @param {?} x
                                 * @return {?}
                                 */
                                function (x) { return x.dimension === 2; }))[i - self.joinParam.colHeaderRowInfo.start].bindField;
                                dataItem[colInfo_4] = value_4;
                            }
                            // 获取值标题的数据
                            /** @type {?} */
                            var value = args.sheet.getValue(rowIndex + this_2.selectChanging.row, colIndex + this_2.selectChanging.column, GC.Spread.Sheets.SheetArea.viewport);
                            /** @type {?} */
                            var name_4 = args.sheet.getValue(self.joinParam.colHeaderRowInfo.end, colIndex + this_2.selectChanging.column, GC.Spread.Sheets.SheetArea.colHeader);
                            /** @type {?} */
                            var colInfo = self.joinParam.colInfos.find((/**
                             * @param {?} x
                             * @return {?}
                             */
                            function (x) { return x.dimension === 3 && x.name === name_4; })).bindField;
                            dataItem[colInfo] = value;
                        }
                        linkageParams = dataItem;
                        dataItems.push(dataItem);
                    };
                    var this_2 = this;
                    for (var colIndex = 0; colIndex < this.selectChanging.colCount; colIndex++) {
                        _loop_7(colIndex);
                    }
                }
            }
            // spread 联动事件
            EventBus.dispatch(queryId + '_spread_change', linkageParams);
        }));
    };
    /**
     * @param {?} sheet
     * @param {?} schema
     * @param {?} qdpView
     * @return {?}
     */
    SpreadStyleUtils.prototype.setSortCellType = /**
     * @param {?} sheet
     * @param {?} schema
     * @param {?} qdpView
     * @return {?}
     */
    function (sheet, schema, qdpView) {
        /** @type {?} */
        var self = this;
        /** @type {?} */
        var header = sheet.getRowCount(GC.Spread.Sheets.SheetArea.colHeader);
        for (var i = 0; i < sheet.getColumnCount(); i++) {
            /** @type {?} */
            var span = sheet.getSpan(header - 1, i, GC.Spread.Sheets.SheetArea.colHeader);
            if (span && span.rowCount > 1) {
                sheet.setCellType(header - span.rowCount, i, new SortCellType(self.columnSort.bind(self), schema, qdpView), GC.Spread.Sheets.SheetArea.colHeader);
            }
            else {
                sheet.setCellType(header - 1, i, new SortCellType(self.columnSort.bind(self), schema, qdpView), GC.Spread.Sheets.SheetArea.colHeader);
            }
        }
    };
    /**
     * @param {?} sheet
     * @param {?} schema
     * @return {?}
     */
    SpreadStyleUtils.prototype.mergeCell = /**
     * @param {?} sheet
     * @param {?} schema
     * @return {?}
     */
    function (sheet, schema) {
        if (!this.getMergeCell(schema)) {
            return;
        }
        /** @type {?} */
        var groupFieldCache1 = [];
        this.getGroupField(groupFieldCache1, schema);
        if (groupFieldCache1.length) {
            return;
        }
        /** @type {?} */
        var columnCount = sheet.getColumnCount();
        /** @type {?} */
        var rowCount = sheet.getRowCount();
        /** @type {?} */
        var beginRowIndex = 0;
        if (this.getShowFilterRow(schema)) {
            beginRowIndex = 1;
        }
        // 检查参数
        if (columnCount < 1 || (rowCount - beginRowIndex) < 1) {
            return;
        }
        /** @type {?} */
        var rowSpans = {};
        /** @type {?} */
        var curCellValues = '';
        /** @type {?} */
        var currentName = '';
        /** @type {?} */
        var key = '';
        for (var row = beginRowIndex; row < rowCount; row++) {
            if (sheet.getDataItem(row).hasOwnProperty("qdp_data_flag") &&
                ((sheet.getDataItem(row)["qdp_data_flag"] + '') === (4 + '')
                    || (sheet.getDataItem(row)["qdp_data_flag"] + '') === (3 + '')
                    || (sheet.getDataItem(row)["qdp_data_flag"] + '') === (2 + '')
                    || (sheet.getDataItem(row)["qdp_data_flag"] + '') === (1 + ''))) {
                continue;
            }
            for (var col = 0; col < columnCount; col++) {
                currentName = sheet.getCell(row, col).value();
                if (col == 0) {
                    key = currentName;
                    if (rowSpans.hasOwnProperty(key)) {
                        rowSpans[key].rowCount = row - rowSpans[key].row + 1;
                    }
                    else {
                        rowSpans[key] = { 'row': row, 'rowCount': 1, 'col': col, 'colCount': 1 };
                    }
                }
                else {
                    curCellValues = '';
                    for (var i = 0; i <= col; i++) {
                        curCellValues += sheet.getCell(row, i).value();
                        curCellValues += "_&_";
                    }
                    if (rowSpans.hasOwnProperty(curCellValues)) {
                        rowSpans[curCellValues].rowCount = row - rowSpans[curCellValues].row + 1;
                    }
                    else {
                        rowSpans[curCellValues] = { 'row': row, 'rowCount': 1, 'col': col, 'colCount': 1 };
                    }
                }
            }
        }
        for (var k in rowSpans) {
            if ((rowSpans[k].rowCount == 1 && rowSpans[k].colCount == 1) == false) {
                sheet.addSpan(rowSpans[k].row, rowSpans[k].col, rowSpans[k].rowCount, rowSpans[k].colCount);
            }
        }
    };
    /**
     * @private
     * @param {?} index
     * @param {?} sheet
     * @param {?} schema
     * @param {?} qdpView
     * @return {?}
     */
    SpreadStyleUtils.prototype.columnSort = /**
     * @private
     * @param {?} index
     * @param {?} sheet
     * @param {?} schema
     * @param {?} qdpView
     * @return {?}
     */
    function (index, sheet, schema, qdpView) {
        var _this = this;
        /** @type {?} */
        var loading = this.loadService.show({ container: 'body' });
        try {
            /** @type {?} */
            var header = sheet.getRowCount(GC.Spread.Sheets.SheetArea.colHeader);
            if (schema && schema.schemaValue && schema.schemaValue.columnOption && schema.schemaValue.columnOption.colList && schema.schemaValue.columnOption.colList.length) {
                /** @type {?} */
                var cell = null;
                /** @type {?} */
                var span = sheet.getSpan(header - 1, index, GC.Spread.Sheets.SheetArea.colHeader);
                if (span && span.rowCount > 1) {
                    cell = sheet.getCell(header - span.rowCount, index, GC.Spread.Sheets.SheetArea.colHeader);
                }
                else {
                    cell = sheet.getCell(header - 1, index, GC.Spread.Sheets.SheetArea.colHeader);
                }
                if (schema && schema.isPrefab === 1) {
                    loading.close();
                    cell.tag(0);
                    sheet.invalidateLayout();
                    sheet.repaint();
                    this.msgService.info(this.localizeService.getValue('spread.message.validate.sort'));
                    return;
                }
                if (schema.isProtected === 1 || schema.isProtected === '1') {
                    loading.close();
                    cell.tag(0);
                    sheet.invalidateLayout();
                    sheet.repaint();
                    this.msgService.info(this.localizeService.getValue('ideCmp.schemaManager.message.validate.isProtected'));
                    return;
                }
                /** @type {?} */
                var colList = schema.schemaValue.columnOption.colList;
                /** @type {?} */
                var params = {
                    index: index,
                    cell: cell,
                    colIndex: 0,
                    sortInfo: { sortIndex: 0, bindField: '' },
                    isText: []
                };
                // tslint:disable-next-line:prefer-for-of
                for (var i = 0; i < colList.length; i++) {
                    this.recursiveColumnSortIndex(colList[i], null, params);
                }
                // tslint:disable-next-line:prefer-for-of
                for (var i = 0; i < colList.length; i++) {
                    this.recursiveColumnSort(colList[i], null, params);
                }
                if (params.isText.length) {
                    loading.close();
                    cell.tag(0);
                    sheet.invalidateLayout();
                    sheet.repaint();
                    this.msgService.warning(params.isText[0] + ' ' + this.localizeService.getValue('ideCmp.schemaManager.message.validate.textColumnSort'));
                    return;
                }
                /** @type {?} */
                var newSchema_1 = JSON.parse(JSON.stringify(schema));
                newSchema_1.schemaValue.columnOption.colList = colList;
                newSchema_1.schemaValue = JSON.stringify(newSchema_1.schemaValue);
                this.schemaManager.saveSchema({ schema: JSON.stringify(newSchema_1), groupType: qdpView.groupType }, '').subscribe((/**
                 * @param {?} data
                 * @return {?}
                 */
                function (data) {
                    loading.close();
                    qdpView.initSpread(qdpView.queryId, newSchema_1.id, qdpView.controlType, qdpView.qoManagerCode, qdpView.pageIndex, qdpView.queryRelativeUrl, qdpView.conditionExpression, qdpView.groupType, qdpView.voId, true);
                }), (/**
                 * @param {?} error
                 * @return {?}
                 */
                function (error) {
                    loading.close();
                    _this.formErrorService.exception(error.Message, error);
                }));
            }
            else {
                loading.close();
                this.msgService.info(this.localizeService.getValue('spread.message.validate.sort'));
                return;
            }
        }
        catch (e) {
            loading.close();
        }
    };
    /**
     * @private
     * @param {?} col
     * @param {?} colList
     * @param {?} params
     * @return {?}
     */
    SpreadStyleUtils.prototype.recursiveColumnSortIndex = /**
     * @private
     * @param {?} col
     * @param {?} colList
     * @param {?} params
     * @return {?}
     */
    function (col, colList, params) {
        if (colList == null) {
            if (col.childList && col.childList.length) {
                this.recursiveColumnSortIndex(null, col.childList, params);
            }
            else {
                if (col.sort !== 0 && col['sortIndex'] != null && col['sortIndex'] !== undefined && col.sortIndex > params.sortInfo.sortIndex) {
                    params.sortInfo.sortIndex = col['sortIndex'];
                    params.sortInfo.bindField = col.bindField;
                }
            }
        }
        else {
            // tslint:disable-next-line:prefer-for-of
            for (var i = 0; i < colList.length; i++) {
                if (colList[i].childList && colList[i].childList.length) {
                    this.recursiveColumnSortIndex(null, colList[i].childList, params);
                }
                else {
                    if (colList[i].sort !== 0 && colList[i]['sortIndex'] != null && colList[i]['sortIndex'] !== undefined && colList[i].sortIndex > params.sortInfo.sortIndex) {
                        params.sortInfo.sortIndex = colList[i]['sortIndex'];
                        params.sortInfo.bindField = colList[i].bindField;
                    }
                }
            }
        }
    };
    /**
     * @private
     * @param {?} col
     * @param {?} colList
     * @param {?} params
     * @return {?}
     */
    SpreadStyleUtils.prototype.recursiveColumnSort = /**
     * @private
     * @param {?} col
     * @param {?} colList
     * @param {?} params
     * @return {?}
     */
    function (col, colList, params) {
        if (colList == null) {
            if (col.childList && col.childList.length) {
                this.recursiveColumnSort(null, col.childList, params);
            }
            else {
                if (params.colIndex === params.index) {
                    if (col.type && col.type.toLowerCase() === 'text') {
                        params.isText.push(col.bindField);
                    }
                    else {
                        switch (params.cell.tag()) {
                            case 0:
                                col.sort = 0;
                                col['sortIndex'] = 0;
                                break;
                            case 1:
                                col.sort = 1;
                                col['sortIndex'] = col['sortIndex'] !== null && col['sortIndex'] !== undefined && col['sortIndex'] > 0 ? col['sortIndex'] : col.bindField === params.sortInfo.bindField ? params.sortInfo.sortIndex : params.sortInfo.sortIndex + 1;
                                break;
                            case 2:
                                col.sort = 2;
                                col['sortIndex'] = col['sortIndex'] !== null && col['sortIndex'] !== undefined && col['sortIndex'] > 0 ? col['sortIndex'] : col.bindField === params.sortInfo.bindField ? params.sortInfo.sortIndex : params.sortInfo.sortIndex + 1;
                                break;
                        }
                    }
                }
                params.colIndex++;
            }
        }
        else {
            // tslint:disable-next-line:prefer-for-of
            for (var i = 0; i < colList.length; i++) {
                if (colList[i].childList && colList[i].childList.length) {
                    this.recursiveColumnSort(null, colList[i].childList, params);
                }
                else {
                    if (params.colIndex === params.index) {
                        if (colList[i].type && colList[i].type.toLowerCase() === 'text') {
                            params.isText.push(colList[i].bindField);
                        }
                        else {
                            switch (params.cell.tag()) {
                                case 0:
                                    colList[i].sort = 0;
                                    colList[i]['sortIndex'] = 0;
                                    break;
                                case 1:
                                    colList[i].sort = 1;
                                    colList[i]['sortIndex'] = colList[i]['sortIndex'] !== null && colList[i]['sortIndex'] !== undefined && colList[i]['sortIndex'] > 0 ? colList[i]['sortIndex'] : colList[i].bindField === params.sortInfo.bindField ? params.sortInfo.sortIndex : params.sortInfo.sortIndex + 1;
                                    break;
                                case 2:
                                    colList[i].sort = 2;
                                    colList[i]['sortIndex'] = colList[i]['sortIndex'] !== null && colList[i]['sortIndex'] !== undefined && colList[i]['sortIndex'] > 0 ? colList[i]['sortIndex'] : colList[i].bindField === params.sortInfo.bindField ? params.sortInfo.sortIndex : params.sortInfo.sortIndex + 1;
                                    break;
                            }
                        }
                    }
                    params.colIndex++;
                }
            }
        }
    };
    /**
     * @private
     * @param {?} col
     * @param {?} colList
     * @param {?} params
     * @return {?}
     */
    SpreadStyleUtils.prototype.recursiveIsRedColumn = /**
     * @private
     * @param {?} col
     * @param {?} colList
     * @param {?} params
     * @return {?}
     */
    function (col, colList, params) {
        if (colList == null) {
            if (col.childList && col.childList.length) {
                this.recursiveIsRedColumn(null, col.childList, params);
            }
            else {
                if (col.isRed) {
                    params.isRedColumns.push({
                        colIndex: params.colIndex
                    });
                }
                params.colIndex++;
            }
        }
        else {
            // tslint:disable-next-line:prefer-for-of
            for (var i = 0; i < colList.length; i++) {
                if (colList[i].childList && colList[i].childList.length) {
                    this.recursiveIsRedColumn(null, colList[i].childList, params);
                }
                else {
                    if (colList[i].isRed) {
                        params.isRedColumns.push({
                            colIndex: params.colIndex
                        });
                    }
                    params.colIndex++;
                }
            }
        }
    };
    /**
     * @private
     * @param {?} val
     * @return {?}
     */
    SpreadStyleUtils.prototype.isNumber = /**
     * @private
     * @param {?} val
     * @return {?}
     */
    function (val) {
        if (parseFloat(val).toString() == "NaN") {
            return false;
        }
        else {
            return true;
        }
    };
    return SpreadStyleUtils;
}());
export { SpreadStyleUtils };
if (false) {
    /** @type {?} */
    SpreadStyleUtils.prototype.dataStyleArray;
    /** @type {?} */
    SpreadStyleUtils.prototype.dataRowHeightArray;
    /** @type {?} */
    SpreadStyleUtils.prototype.dataColInfoArray;
    /** @type {?} */
    SpreadStyleUtils.prototype.footerStyleArray;
    /** @type {?} */
    SpreadStyleUtils.prototype.footerRowHeightArray;
    /** @type {?} */
    SpreadStyleUtils.prototype.footerSpansArray;
    /** @type {?} */
    SpreadStyleUtils.prototype.footerDataArray;
    /** @type {?} */
    SpreadStyleUtils.prototype.hyperLinkQuery;
    /**
     * @type {?}
     * @private
     */
    SpreadStyleUtils.prototype.autoFitColumnIndex;
    /** @type {?} */
    SpreadStyleUtils.prototype.type;
    /** @type {?} */
    SpreadStyleUtils.prototype.queryId;
    /** @type {?} */
    SpreadStyleUtils.prototype.valueHeaderRowCount;
    /** @type {?} */
    SpreadStyleUtils.prototype.valueHeaderRowArray;
    /** @type {?} */
    SpreadStyleUtils.prototype.rowHeadersColumnCount;
    /** @type {?} */
    SpreadStyleUtils.prototype.rowHeaderRowArray;
    /** @type {?} */
    SpreadStyleUtils.prototype.rowHeaderInfo;
    /** @type {?} */
    SpreadStyleUtils.prototype.valInfo;
    /** @type {?} */
    SpreadStyleUtils.prototype.joinParam;
    /** @type {?} */
    SpreadStyleUtils.prototype.jointsearchInfoList;
    /** @type {?} */
    SpreadStyleUtils.prototype.cache;
    /** @type {?} */
    SpreadStyleUtils.prototype.loadService;
    /** @type {?} */
    SpreadStyleUtils.prototype.msgService;
    /** @type {?} */
    SpreadStyleUtils.prototype.localizeService;
    /** @type {?} */
    SpreadStyleUtils.prototype.schemaManager;
    /** @type {?} */
    SpreadStyleUtils.prototype.formErrorService;
    /** @type {?} */
    SpreadStyleUtils.prototype.lcpService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3ByZWFkLnN0eWxlLnV0aWxzLmpzIiwic291cmNlUm9vdCI6Im5nOi8vQHFkcC9zcHJlYWQvIiwic291cmNlcyI6WyJsaWIvdXRpbC9zcHJlYWQuc3R5bGUudXRpbHMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUNBLE9BQU8sRUFBRSxRQUFRLEVBQUUsV0FBVyxFQUFjLE1BQU0sYUFBYSxDQUFDO0FBQ2hFLE9BQU8sRUFBRSxNQUFNLEVBQUUsTUFBTSxXQUFXLENBQUM7QUFTbkM7SUE0QkksMEJBQVksUUFBYSxFQUFFLFlBQWlCLEVBQUUsb0JBQTBCLEVBQUUsYUFBbUI7UUEzQjdGLG1CQUFjLEdBQVUsRUFBRSxDQUFDO1FBQzNCLHVCQUFrQixHQUFVLEVBQUUsQ0FBQztRQUMvQixxQkFBZ0IsR0FBVSxFQUFFLENBQUM7UUFDN0IscUJBQWdCLEdBQVUsRUFBRSxDQUFDO1FBQzdCLHlCQUFvQixHQUFVLEVBQUUsQ0FBQztRQUNqQyxxQkFBZ0IsR0FBVSxFQUFFLENBQUM7UUFDN0Isb0JBQWUsR0FBVSxFQUFFLENBQUM7UUFDNUIsbUJBQWMsR0FBUSxFQUFFLENBQUM7UUFDakIsdUJBQWtCLEdBQUcsQ0FBQyxDQUFDO1FBRy9CLHdCQUFtQixHQUFHLENBQUMsQ0FBQyxDQUFDLFFBQVE7O1FBQ2pDLHdCQUFtQixHQUFhLEVBQUUsQ0FBQztRQUNuQywwQkFBcUIsR0FBRyxDQUFDLENBQUMsQ0FBQyxRQUFROztRQUNuQyxzQkFBaUIsR0FBYSxFQUFFLENBQUM7UUFHakMsY0FBUyxHQUFRLEVBQUUsQ0FBQztRQVdoQixJQUFJLENBQUMsT0FBTyxHQUFHLFFBQVEsQ0FBQztRQUN4QixJQUFJLENBQUMsSUFBSSxHQUFHLFlBQVksQ0FBQztRQUN6QixJQUFJLENBQUMsbUJBQW1CLEdBQUcsb0JBQW9CLENBQUM7UUFDaEQsSUFBSSxDQUFDLEtBQUssR0FBRyxhQUFhLENBQUMsWUFBWSxDQUFDO1FBQ3hDLElBQUksQ0FBQyxXQUFXLEdBQUcsYUFBYSxDQUFD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LFVBQWlCLEdBQUc7UUFDaEIsSUFBSSxVQUFVLENBQUMsR0FBRyxDQUFDLENBQUMsUUFBUSxFQUFFLElBQUksS0FBSyxFQUFFO1lBQ3JDLE9BQU8sS0FBSyxDQUFDO1NBQ2hCO2FBQU07WUFDSCxPQUFPLElBQUksQ0FBQztTQUNmO0lBQ0wsQ0FBQztJQUNMLHVCQUFDO0FBQUQsQ0FBQyxBQTFqQ0QsSUEwakNDOzs7O0lBempDRywwQ0FBMkI7O0lBQzNCLDhDQUErQjs7SUFDL0IsNENBQTZCOztJQUM3Qiw0Q0FBNkI7O0lBQzdCLGdEQUFpQzs7SUFDakMsNENBQTZCOztJQUM3QiwyQ0FBNEI7O0lBQzVCLDBDQUF5Qjs7Ozs7SUFDekIsOENBQStCOztJQUMvQixnQ0FBVTs7SUFDVixtQ0FBYTs7SUFDYiwrQ0FBd0I7O0lBQ3hCLCtDQUFtQzs7SUFDbkMsaURBQTBCOztJQUMxQiw2Q0FBaUM7O0lBQ2pDLHlDQUFtQjs7SUFDbkIsbUNBQWE7O0lBQ2IscUNBQW9COztJQUNwQiwrQ0FBeUI7O0lBQ3pCLGlDQUFXOztJQUNYLHVDQUFpQjs7SUFDakIsc0NBQWdCOztJQUNoQiwyQ0FBcUI7O0lBQ3JCLHlDQUFtQjs7SUFDbkIsNENBQW1DOztJQUNuQyxzQ0FBZ0IiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBGb3JtRXJyb3JTZXJ2aWNlIH0gZnJvbSBcIkBmYXJyaXMvY29tbWFuZC1zZXJ2aWNlc1wiO1xyXG5pbXBvcnQgeyBFdmVudEJ1cywgUnRmU2VydmljZXMsIExjcFNlcnZpY2UgfSBmcm9tIFwiQHFkcC9jb21tb25cIjtcclxuaW1wb3J0IHsgZmlsdGVyIH0gZnJvbSAnbG9kYXNoLWVzJztcclxuXHJcbmRlY2xhcmUgdmFyIEdDOiBhbnk7XHJcbmRlY2xhcmUgdmFyIFRyZWVDZWxsVHlwZTogYW55O1xyXG5kZWNsYXJlIHZhciBNeU51bUZvcm1hdHRlcjogYW55O1xyXG5kZWNsYXJlIHZhciBGaWx0ZXJDZWxsVHlwZTogYW55O1xyXG5kZWNsYXJlIHZhciBTb3J0Q2VsbFR5cGU6IGFueTtcclxuZGVjbGFyZSB2YXIgZ3NwZnJhbWV3b3JrU2VydmljZTogYW55O1xyXG5cclxuZXhwb3J0IGNsYXNzIFNwcmVhZFN0eWxlVXRpbHMge1xyXG4gICAgZGF0YVN0eWxlQXJyYXk6IGFueVtdID0gW107XHJcbiAgICBkYXRhUm93SGVpZ2h0QXJyYXk6IGFueVtdID0gW107XHJcbiAgICBkYXRhQ29sSW5mb0FycmF5OiBhbnlbXSA9IFtdO1xyXG4gICAgZm9vdGVyU3R5bGVBcnJheTogYW55W10gPSBbXTtcclxuICAgIGZvb3RlclJvd0hlaWdodEFycmF5OiBhbnlbXSA9IFtdO1xyXG4gICAgZm9vdGVyU3BhbnNBcnJheTogYW55W10gPSBbXTtcclxuICAgIGZvb3RlckRhdGFBcnJheTogYW55W10gPSBbXTtcclxuICAgIGh5cGVyTGlua1F1ZXJ5OiBhbnkgPSB7fTtcclxuICAgIHByaXZhdGUgYXV0b0ZpdENvbHVtbkluZGV4ID0gMDtcclxuICAgIHR5cGU6IGFueTtcclxuICAgIHF1ZXJ5SWQ6IGFueTtcclxuICAgIHZhbHVlSGVhZGVyUm93Q291bnQgPSAwOyAvLyDlgLznu7TluqbmlbDph49cclxuICAgIHZhbHVlSGVhZGVyUm93QXJyYXk6IG51bWJlcltdID0gW107XHJcbiAgICByb3dIZWFkZXJzQ29sdW1uQ291bnQgPSAwOyAvLyDooYzmoIfpopjliJfmlbBcclxuICAgIHJvd0hlYWRlclJvd0FycmF5OiBudW1iZXJbXSA9IFtdO1xyXG4gICAgcm93SGVhZGVySW5mbzogYW55O1xyXG4gICAgdmFsSW5mbzogYW55O1xyXG4gICAgam9pblBhcmFtOiBhbnkgPSB7fTtcclxuICAgIGpvaW50c2VhcmNoSW5mb0xpc3Q6IGFueTtcclxuICAgIGNhY2hlOiBhbnk7XHJcbiAgICBsb2FkU2VydmljZTogYW55O1xyXG4gICAgbXNnU2VydmljZTogYW55O1xyXG4gICAgbG9jYWxpemVTZXJ2aWNlOiBhbnk7XHJcbiAgICBzY2hlbWFNYW5hZ2VyOiBhbnk7XHJcbiAgICBmb3JtRXJyb3JTZXJ2aWNlOiBGb3JtRXJyb3JTZXJ2aWNlO1xyXG4gICAgbGNwU2VydmljZTogYW55O1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKF9xdWVyeUlkOiBhbnksIF9jb250cm9sVHlwZTogYW55LCBfam9pbnRzZWFyY2hJbmZvTGlzdD86IGFueSwgX3NlcnZpY2VDYWNoZT86IGFueSkge1xyXG4gICAgICAgIHRoaXMucXVlcnlJZCA9IF9xdWVyeUlkO1xyXG4gICAgICAgIHRoaXMudHlwZSA9IF9jb250cm9sVHlwZTtcclxuICAgICAgICB0aGlzLmpvaW50c2VhcmNoSW5mb0xpc3QgPSBfam9pbnRzZWFyY2hJbmZvTGlzdDtcclxuICAgICAgICB0aGlzLmNhY2hlID0gX3NlcnZpY2VDYWNoZS5jYWNoZVNlcnZpY2U7XHJcbiAgICAgICAgdGhpcy5sb2FkU2VydmljZSA9IF9zZXJ2aWNlQ2FjaGUubG9hZGluZ1NlcnZpY2U7XHJcbiAgICAgICAgdGhpcy5tc2dTZXJ2aWNlID0gX3NlcnZpY2VDYWNoZS5tc2dTZXJ2aWNlO1xyXG4gICAgICAgIHRoaXMubG9jYWxpemVTZXJ2aWNlID0gX3NlcnZpY2VDYWNoZS5sb2NhbGl6ZVNlcnZpY2U7XHJcbiAgICAgICAgdGhpcy5zY2hlbWFNYW5hZ2VyID0gX3NlcnZpY2VDYWNoZS5zY2hlbWFNYW5hZ2VyU2VydmljZTtcclxuICAgICAgICB0aGlzLmZvcm1FcnJvclNlcnZpY2UgPSBfc2VydmljZUNhY2hlLmZvcm1FcnJvclNlcnZpY2U7XHJcbiAgICAgICAgdGhpcy5sY3BTZXJ2aWNlID0gX3NlcnZpY2VDYWNoZS5sY3BTZXJ2aWNlO1xyXG4gICAgfVxyXG5cclxuICAgIHNldEF1dG9GaXRDb2x1bW4oc2NoZW1hOiBhbnksIHNoZWV0OiBhbnkpIHtcclxuICAgICAgICBpZiAoc2NoZW1hICYmIHNjaGVtYS5zY2hlbWFWYWx1ZSAmJiBzY2hlbWEuc2NoZW1hVmFsdWUuY29sdW1uT3B0aW9uICYmIHNjaGVtYS5zY2hlbWFWYWx1ZS5jb2x1bW5PcHRpb24uY29sTGlzdCAmJiBzY2hlbWEuc2NoZW1hVmFsdWUuY29sdW1uT3B0aW9uLmNvbExpc3QubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYXV0b0ZpdENvbHVtbkluZGV4ID0gMDtcclxuICAgICAgICAgICAgc2NoZW1hLnNjaGVtYVZhbHVlLmNvbHVtbk9wdGlvbi5jb2xMaXN0LmZvckVhY2goKGNvbDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJlY3Vyc2lvbkF1dG9GaXRDb2x1bW4oY29sLCBudWxsLCBzaGVldCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHJlY3Vyc2lvbkF1dG9GaXRDb2x1bW4oY29sdW1uOiBhbnksIGNoaWxkTGlzdDogYW55W10sIHNoZWV0OiBhbnkpIHtcclxuICAgICAgICBpZiAoY29sdW1uKSB7XHJcbiAgICAgICAgICAgIGlmIChjb2x1bW4uY2hpbGRMaXN0ICYmIGNvbHVtbi5jaGlsZExpc3QubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJlY3Vyc2lvbkF1dG9GaXRDb2x1bW4obnVsbCwgY29sdW1uLmNoaWxkTGlzdCwgc2hlZXQpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaWYgKGNvbHVtbi5hdXRvRml0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2hlZXQuYXV0b0ZpdENvbHVtbih0aGlzLmF1dG9GaXRDb2x1bW5JbmRleCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLmF1dG9GaXRDb2x1bW5JbmRleCArPSAxO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgY2hpbGRMaXN0LmZvckVhY2goKGNvbDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoY29sLmNoaWxkTGlzdCAmJiBjb2wuY2hpbGRMaXN0Lmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVjdXJzaW9uQXV0b0ZpdENvbHVtbihudWxsLCBjb2wuY2hpbGRMaXN0LCBzaGVldCk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChjb2wuYXV0b0ZpdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzaGVldC5hdXRvRml0Q29sdW1uKHRoaXMuYXV0b0ZpdENvbHVtbkluZGV4KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hdXRvRml0Q29sdW1uSW5kZXggKz0gMTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGNhY2hlU3R5bGUoc2hlZXQ6IGFueSkge1xyXG4gICAgICAgIHRoaXMuZGF0YVN0eWxlQXJyYXkgPSBbXTtcclxuICAgICAgICB0aGlzLmRhdGFSb3dIZWlnaHRBcnJheSA9IFtdO1xyXG4gICAgICAgIHRoaXMuZGF0YUNvbEluZm9BcnJheSA9IFtdO1xyXG4gICAgICAgIHRoaXMuZm9vdGVyU3R5bGVBcnJheSA9IFtdO1xyXG4gICAgICAgIHRoaXMuZm9vdGVyUm93SGVpZ2h0QXJyYXkgPSBbXTtcclxuICAgICAgICB0aGlzLmZvb3RlclNwYW5zQXJyYXkgPSBbXTtcclxuICAgICAgICB0aGlzLmZvb3RlckRhdGFBcnJheSA9IFtdO1xyXG5cclxuICAgICAgICAvLyDnvJPlrZjljLrln5/moLflvI/kv6Hmga9cclxuICAgICAgICBmb3IgKGxldCByID0gMDsgciA8IHNoZWV0LmdldFJvd0NvdW50KCk7IHIrKykge1xyXG4gICAgICAgICAgICBjb25zdCBjb2x1bW5TdHlsZUFycmF5ID0gbmV3IEFycmF5KCk7XHJcbiAgICAgICAgICAgIGNvbnN0IGRhdGFBcnJheSA9IG5ldyBBcnJheSgpO1xyXG4gICAgICAgICAgICBmb3IgKGxldCBjID0gMDsgYyA8IHNoZWV0LmdldENvbHVtbkNvdW50KCk7IGMrKykge1xyXG4gICAgICAgICAgICAgICAgaWYgKHIgPT09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgZm9ybWF0dGVyID0gJyc7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNoZWV0LmdldEZvcm1hdHRlcihyLCBjLCBHQy5TcHJlYWQuU2hlZXRzLlNoZWV0QXJlYS52aWV3cG9ydCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9ybWF0dGVyID0gc2hlZXQuZ2V0Rm9ybWF0dGVyKHIsIGMsIEdDLlNwcmVhZC5TaGVldHMuU2hlZXRBcmVhLnZpZXdwb3J0KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY29sSGVhZGVyQ291bnQgPSBzaGVldC5nZXRSb3dDb3VudChHQy5TcHJlYWQuU2hlZXRzLlNoZWV0QXJlYS5jb2xIZWFkZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvbEluZm86IGFueSA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogc2hlZXQuZ2V0Q2VsbChyLCBjLCBHQy5TcHJlYWQuU2hlZXRzLlNoZWV0QXJlYS52aWV3cG9ydCkudmFsdWUoKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZTogc2hlZXQuZ2V0Q29sdW1uV2lkdGgoYywgR0MuU3ByZWFkLlNoZWV0cy5TaGVldEFyZWEudmlld3BvcnQpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB2aXNpYmxlOiBzaGVldC5nZXRDb2x1bW5WaXNpYmxlKGMsIEdDLlNwcmVhZC5TaGVldHMuU2hlZXRBcmVhLnZpZXdwb3J0KSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzaXphYmxlOiBzaGVldC5nZXRDb2x1bW5SZXNpemFibGUoYywgR0MuU3ByZWFkLlNoZWV0cy5TaGVldEFyZWEudmlld3BvcnQpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3JtYXR0ZXI6IGZvcm1hdHRlci5pbmRleE9mKCcmJykgPj0gMCA/IG5ldyBNeU51bUZvcm1hdHRlcihmb3JtYXR0ZXIpIDogZm9ybWF0dGVyLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkaXNwbGF5TmFtZTogc2hlZXQuZ2V0Q2VsbCgoY29sSGVhZGVyQ291bnQgLSAxKSwgYywgR0MuU3ByZWFkLlNoZWV0cy5TaGVldEFyZWEuY29sSGVhZGVyKS52YWx1ZSgpXHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmRhdGFDb2xJbmZvQXJyYXkucHVzaChjb2xJbmZvKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGxldCBzdHlsZSA9IHNoZWV0LmdldFN0eWxlKHIsIGMsIEdDLlNwcmVhZC5TaGVldHMuU2hlZXRBcmVhLnZpZXdwb3J0KTtcclxuICAgICAgICAgICAgICAgIGlmIChzdHlsZSA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3R5bGUgPSBuZXcgR0MuU3ByZWFkLlNoZWV0cy5TdHlsZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHN0eWxlLmxvY2tlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHN0eWxlLmxvY2tlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoc3R5bGUgJiYgc3R5bGUuZm9ybWF0dGVyICYmIHN0eWxlLmZvcm1hdHRlci5pbmRleE9mKCcmJykgPj0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHN0eWxlLmZvcm1hdHRlciA9IG5ldyBNeU51bUZvcm1hdHRlcihzdHlsZS5mb3JtYXR0ZXIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29sdW1uU3R5bGVBcnJheS5wdXNoKHN0eWxlKTtcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ZXh0ID0gc2hlZXQuZ2V0VmFsdWUociwgYywgR0MuU3ByZWFkLlNoZWV0cy5TaGVldEFyZWEudmlld3BvcnQpXHJcbiAgICAgICAgICAgICAgICAgICAgfHwgc2hlZXQuZ2V0VGV4dChyLCBjLCBHQy5TcHJlYWQuU2hlZXRzLlNoZWV0QXJlYS52aWV3cG9ydClcclxuICAgICAgICAgICAgICAgICAgICB8fCAnJztcclxuICAgICAgICAgICAgICAgIGRhdGFBcnJheS5wdXNoKHRleHQpO1xyXG5cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAociA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kYXRhUm93SGVpZ2h0QXJyYXkucHVzaChzaGVldC5nZXRSb3dIZWlnaHQocikpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kYXRhU3R5bGVBcnJheS5wdXNoKGNvbHVtblN0eWxlQXJyYXkpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5mb290ZXJSb3dIZWlnaHRBcnJheS5wdXNoKHNoZWV0LmdldFJvd0hlaWdodChyKSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmZvb3RlclN0eWxlQXJyYXkucHVzaChjb2x1bW5TdHlsZUFycmF5KTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZm9vdGVyRGF0YUFycmF5LnB1c2goZGF0YUFycmF5KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8g57yT5a2Yc3BhblxyXG4gICAgICAgIGNvbnN0IHNwYW5zID0gc2hlZXQuZ2V0U3BhbnMoKTtcclxuICAgICAgICBpZiAoc3BhbnMgJiYgc3BhbnMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpwcmVmZXItZm9yLW9mXHJcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc3BhbnMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGlmIChzcGFuc1tpXS5yb3cgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5mb290ZXJTcGFuc0FycmF5LnB1c2goc3BhbnNbaV0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHNoZWV0LmRlbGV0ZVJvd3MoMSwgc2hlZXQuZ2V0Um93Q291bnQoKSAtIDEpO1xyXG4gICAgfVxyXG5cclxuICAgIGFwcGx5U3R5bGUoc2hlZXQ6IGFueSwgc2NoZW1hOiBhbnksIHNob3daZXJvPzogYm9vbGVhbikge1xyXG4gICAgICAgIGxldCByb3dDb3VudCA9IHNoZWV0LmdldFJvd0NvdW50KCk7XHJcbiAgICAgICAgY29uc3QgY29sQ291bnQgPSBzaGVldC5nZXRDb2x1bW5Db3VudCgpO1xyXG4gICAgICAgIGNvbnN0IGZvb3RlckNvdW50ID0gdGhpcy5mb290ZXJSb3dIZWlnaHRBcnJheS5sZW5ndGg7XHJcbiAgICAgICAgc2hlZXQuYWRkUm93cyhyb3dDb3VudCwgZm9vdGVyQ291bnQpO1xyXG4gICAgICAgIGxldCBpbmRleCA9IDA7XHJcbiAgICAgICAgY29uc3QgZ3JvdXBGaWVsZENhY2hlID0gW107XHJcbiAgICAgICAgY29uc3QgZ3JvdXBGaWVsZFZhbHVlQ2FjaGUgPSBbXTtcclxuICAgICAgICBjb25zdCBncm91cFJvd0NhY2hlID0gW107XHJcbiAgICAgICAgY29uc3QgZ3JvdXBUcmVlTGV2ZWwgPSB7fTtcclxuICAgICAgICBjb25zdCBjb2x1bW5zID0gc2hlZXQudG9KU09OKCkuY29sdW1ucztcclxuICAgICAgICB0aGlzLmdldEdyb3VwRmllbGQoZ3JvdXBGaWVsZENhY2hlLCBzY2hlbWEpO1xyXG4gICAgICAgIGNvbnN0IGZvcm1hdEZpZWxkQ2FjaGUgPSBbXTtcclxuICAgICAgICB0aGlzLmdldEZvcm1hdEZpZWxkKGZvcm1hdEZpZWxkQ2FjaGUsIHNjaGVtYSk7XHJcbiAgICAgICAgdGhpcy5nZXRJc1JlZENvbHVtbnMoZm9ybWF0RmllbGRDYWNoZSwgc2NoZW1hKTtcclxuICAgICAgICBjb25zdCBpc1JlZENvbHVtbnMgPSB7XHJcbiAgICAgICAgICAgIGNvbEluZGV4OiAwLFxyXG4gICAgICAgICAgICBpc1JlZENvbHVtbnM6IFtdXHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLmdldElzUmVkQ29sdW1ucyhzY2hlbWEsIGlzUmVkQ29sdW1ucyk7XHJcbiAgICAgICAgY29uc3Qgc2hlZXRDb2x1bW5zID0gc2hlZXQudG9KU09OKCkuY29sdW1ucztcclxuICAgICAgICBmb3IgKGxldCByID0gMDsgciA8IChyb3dDb3VudCArIGZvb3RlckNvdW50KTsgcisrKSB7XHJcbiAgICAgICAgICAgIGlmIChmb3JtYXRGaWVsZENhY2hlICYmIGZvcm1hdEZpZWxkQ2FjaGUubGVuZ3RoICYmIHIgPCByb3dDb3VudCkge1xyXG4gICAgICAgICAgICAgICAgZm9ybWF0RmllbGRDYWNoZS5mb3JFYWNoKChpdGVtOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBkYXRhSXRlbSA9IHNoZWV0LmdldERhdGFJdGVtKHIpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHByZWNpc2lvbiA9IGRhdGFJdGVtW2l0ZW0uZm9ybWF0RmllbGRdIC0gMDtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgbnVtYmVyRm9ybWF0ID0gaXRlbS5mb3JtYXR0ZXIgJiYgKGl0ZW0uZm9ybWF0dGVyLmluZGV4T2YoJyMsIyMjJykgPj0gMCB8fCBpdGVtLmZvcm1hdHRlci5pbmRleE9mKCcjLCMjMCcpID49IDApID8gJyMsIyMwLicgOiAnMC4nO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmlzTnVtYmVyKHByZWNpc2lvbikpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgcCA9IDA7IHAgPCBwcmVjaXNpb247IHArKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbnVtYmVyRm9ybWF0ICs9ICcwJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBmb3JtYXRDb2xJbmRleCA9IHNoZWV0Q29sdW1ucy5maW5kSW5kZXgoKGVsOiBhbnkpID0+IGVsLm5hbWUgPT0gaXRlbS5zb3VyY2VGaWVsZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGZvcm1hdENvbEluZGV4ID49IDAgJiYgbnVtYmVyRm9ybWF0ICE9ICcwLicgJiYgbnVtYmVyRm9ybWF0ICE9ICcjLCMjMC4nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNoZWV0LmdldENlbGwociwgZm9ybWF0Q29sSW5kZXgpLmZvcm1hdHRlcihudW1iZXJGb3JtYXQpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBmb3IgKGxldCBjID0gMDsgYyA8IGNvbENvdW50OyBjKyspIHtcclxuICAgICAgICAgICAgICAgIGlmIChyID09PSAwICYmICFzaGVldC5nZXRDb2x1bW5WaXNpYmxlKGluZGV4KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGluZGV4ICs9IDE7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAociA+PSByb3dDb3VudCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChjID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNoZWV0LnNldFN0eWxlKHIsIGMsIHRoaXMuZm9vdGVyU3R5bGVBcnJheVtyIC0gcm93Q291bnRdW2NdKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuZm9vdGVyRGF0YUFycmF5ICYmIHRoaXMuZm9vdGVyRGF0YUFycmF5Lmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hlZXQuc2V0VmFsdWUociwgYywgdGhpcy5mb290ZXJEYXRhQXJyYXlbciAtIHJvd0NvdW50XVtjXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgc2hlZXQuc2V0Um93SGVpZ2h0KHIsIHRoaXMuZm9vdGVyUm93SGVpZ2h0QXJyYXlbciAtIHJvd0NvdW50XSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmZvb3RlclNwYW5zQXJyYXkgJiYgdGhpcy5mb290ZXJTcGFuc0FycmF5Lmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hlZXQuYWRkU3BhbihyLCB0aGlzLmZvb3RlclNwYW5zQXJyYXlbMF0uY29sLCB0aGlzLmZvb3RlclNwYW5zQXJyYXlbMF0ucm93Q291bnQsIHRoaXMuZm9vdGVyU3BhbnNBcnJheVswXS5jb2xDb3VudCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGZvcm1hdHRlciA9IHNoZWV0LmdldEZvcm1hdHRlcihyLCBjLCBHQy5TcHJlYWQuU2hlZXRzLlNoZWV0QXJlYS52aWV3cG9ydCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGZvcm1hdHRlciAmJiBmb3JtYXR0ZXIuaW5kZXhPZiAmJiBmb3JtYXR0ZXIuaW5kZXhPZignLycpID49IDAgJiYgZm9ybWF0dGVyLmluZGV4T2YoJzsnKSA+PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNlbGxWYWx1ZSA9IHRoaXMubG9naWNGb3JtYXQoZm9ybWF0dGVyLCBzaGVldC5nZXRWYWx1ZShyLCBjKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNoZWV0LnNldFRleHQociwgYywgY2VsbFZhbHVlKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGZvcm1hdHRlciAmJiB0eXBlb2YgZm9ybWF0dGVyID09PSAnc3RyaW5nJyAmJiAoZm9ybWF0dGVyLmluZGV4T2YoJ3l5JykgPj0gMCB8fCBmb3JtYXR0ZXIuaW5kZXhPZignTU0nKSA+PSAwIHx8IGZvcm1hdHRlci5pbmRleE9mKCdkZCcpID49IDAgfHwgZm9ybWF0dGVyLmluZGV4T2YoJ0hIJykgPj0gMCB8fCBmb3JtYXR0ZXIuaW5kZXhPZignbW0nKSA+PSAwIHx8IGZvcm1hdHRlci5pbmRleE9mKCdzcycpID49IDApKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzaGVldC5nZXREYXRhSXRlbShyKS5oYXNPd25Qcm9wZXJ0eShcInFkcF9kYXRhX2ZsYWdcIikpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNoZWV0LnNldEZvcm1hdHRlcihyLCBjLCAnJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzUmVkQ29sdW1ucy5pc1JlZENvbHVtbnMuZmluZEluZGV4KGVsID0+IGVsLmNvbEluZGV4ID09IGMpID49IDAgJiYgdGhpcy5pc051bWJlcihzaGVldC5nZXRDZWxsKHIsIGMpLnZhbHVlKCkpICYmIChzaGVldC5nZXRDZWxsKHIsIGMpLnZhbHVlKCkgLSAwIDwgMCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2hlZXQuZ2V0Q2VsbChyLCBjKS5mb3JlQ29sb3IoJ3JlZCcpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAoIXNob3daZXJvKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghc2hvd1plcm8gJiYgY29sdW1ucyAmJiBjb2x1bW5zLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbHVtbnNbY10ubmFtZSA9PT0gJ3RyZWVMZXZlbCcgfHwgY29sdW1uc1tjXS5uYW1lID09PSAnaXNEZXRhaWwnKSB7IGNvbnRpbnVlOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2hlZXQuZ2V0Q2VsbChyLCBjKS52YWx1ZSgpID09PSAwIHx8IHNoZWV0LmdldENlbGwociwgYykudmFsdWUoKSA9PSAnMCcpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaGVldC5nZXRDZWxsKHIsIGMpLnZhbHVlKCcnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAociA8IHJvd0NvdW50KSB7XHJcbiAgICAgICAgICAgICAgICAvLyDorr7nva7ooYzpq5hcclxuICAgICAgICAgICAgICAgIHNoZWV0LnNldFJvd0hlaWdodChyLCB0aGlzLmRhdGFSb3dIZWlnaHRBcnJheVswXSk7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy50eXBlID09PSAndHJlZWxpc3QnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbGV2ZWwgPSBzaGVldC5nZXREYXRhSXRlbShyKVsndHJlZUxldmVsJ107XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaXNEZXRhaWwgPSBzaGVldC5nZXREYXRhSXRlbShyKVsnaXNEZXRhaWwnXTtcclxuICAgICAgICAgICAgICAgICAgICBzaGVldC5zZXRDZWxsVHlwZShyLCBpbmRleCwgbmV3IFRyZWVDZWxsVHlwZShudWxsLCBmYWxzZSwgbGV2ZWwsIGlzRGV0YWlsKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgc2hlZXQuZ2V0U3R5bGUociwgaW5kZXgpLmhBbGlnbiA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgc2hlZXQuZ2V0U3R5bGUociwgaW5kZXgpLnRleHRJbmRlbnQgPSBsZXZlbCArIDI7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPD0gbGV2ZWw7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzaGVldC5yb3dPdXRsaW5lcy5ncm91cChyLCAxKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMudHlwZSA9PT0gJ2xpc3QnICYmIGdyb3VwRmllbGRDYWNoZS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgZmlsdGVyQ29uZGl0aW9uOiBhbnkgPSB7fTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZ3JvdXBSb3dDYWNoZS5maW5kSW5kZXgoeCA9PiB4ID09PSByKSA+PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBjID0gMDsgYyA8IGNvbENvdW50OyBjKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNoZWV0LmdldERhdGFJdGVtKHIpLmhhc093blByb3BlcnR5KFwicWRwX2RhdGFfZmxhZ1wiKSAmJiAoc2hlZXQuZ2V0RGF0YUl0ZW0ocilbXCJxZHBfZGF0YV9mbGFnXCJdICsgJycpID09PSAoNCArICcnKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNoZWV0LmdldEZvcm1hdHRlcihyLCBjKSAmJiAoc2hlZXQuZ2V0Rm9ybWF0dGVyKHIsIGMpLnRvU3RyaW5nKCkuaW5kZXhPZigneScpID49IDAgfHwgc2hlZXQuZ2V0Rm9ybWF0dGVyKHIsIGMpLnRvU3RyaW5nKCkuaW5kZXhPZignZCcpID49IDAgfHwgc2hlZXQuZ2V0Rm9ybWF0dGVyKHIsIGMpLnRvU3RyaW5nKCkuaW5kZXhPZignTScpID49IDApKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hlZXQuc2V0Rm9ybWF0dGVyKHIsIGMsICcnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBhZGRSb3dzQ2FjaGUgPSBbXTtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGdyb3VwRmllbGRDYWNoZS5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBhZGRSb3dJbmRleCA9IHIgKyBhZGRSb3dzQ2FjaGUubGVuZ3RoO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zdCBncm91cEZpZWxkID0gZ3JvdXBGaWVsZENhY2hlW2ldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWVsZEluZGV4ID0gdGhpcy5kYXRhQ29sSW5mb0FycmF5LmZpbmRJbmRleCh4ID0+IHgubmFtZSA9PT0gZ3JvdXBGaWVsZENhY2hlW2ldKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZmlsdGVyQ29uZGl0aW9uID0ge307XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGYgPSAwOyBmIDw9IGk7IGYrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsdGVyQ29uZGl0aW9uW2dyb3VwRmllbGRDYWNoZVtmXV0gPSBzaGVldC5nZXREYXRhSXRlbShhZGRSb3dJbmRleClbZ3JvdXBGaWVsZENhY2hlW2ZdXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWx0ZXJSZXN1bHQgPSBmaWx0ZXIoZ3JvdXBGaWVsZFZhbHVlQ2FjaGUsIGZpbHRlckNvbmRpdGlvbik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgoIWZpbHRlclJlc3VsdCB8fCAhZmlsdGVyUmVzdWx0Lmxlbmd0aCkgJiYgIXNoZWV0LmdldERhdGFJdGVtKGFkZFJvd0luZGV4KS5oYXNPd25Qcm9wZXJ0eShcInFkcF9kYXRhX2ZsYWdcIikpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbnN0IGdyb3VwRmllbGRWYWx1ZSA9IHt9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gZ3JvdXBGaWVsZFZhbHVlW2dyb3VwRmllbGRdID0gZmlsdGVyQ29uZGl0aW9uW2dyb3VwRmllbGRdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZ3JvdXBGaWVsZFZhbHVlQ2FjaGUucHVzaChmaWx0ZXJDb25kaXRpb24pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3R5bGUgPSB0aGlzLmRhdGFTdHlsZUFycmF5WzBdW2ZpZWxkSW5kZXhdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGUuaEFsaWduID0gMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlLmNlbGxUeXBlID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlLmJhY2tDb2xvciA9ICcjRjRGN0ZBJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNoZWV0LmFkZFJvd3MoYWRkUm93SW5kZXgsIDEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hlZXQuc2V0Um93SGVpZ2h0KGFkZFJvd0luZGV4LCB0aGlzLmRhdGFSb3dIZWlnaHRBcnJheVswXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaGVldC5zZXRTdHlsZShhZGRSb3dJbmRleCwgaW5kZXgsIHN0eWxlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNoZWV0LmdldENlbGwoYWRkUm93SW5kZXgsIGluZGV4KS52YWx1ZShmaWx0ZXJDb25kaXRpb25bZ3JvdXBGaWVsZENhY2hlW2ldXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaGVldC5hZGRTcGFuKGFkZFJvd0luZGV4LCBpbmRleCwgMSwgKGNvbENvdW50IC0gaW5kZXgpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNoZWV0LmdldENlbGwoYWRkUm93SW5kZXgsIGluZGV4KS50ZXh0SW5kZW50KChpICsgMSkgKiAyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdyb3VwVHJlZUxldmVsW2FkZFJvd0luZGV4ICsgJyddID0geyB0cmVlTGV2ZWw6IGksIGlzRGV0YWlsOiAwIH07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaSA9PT0gKGdyb3VwRmllbGRDYWNoZS5sZW5ndGggLSAxKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdyb3VwVHJlZUxldmVsWyhhZGRSb3dJbmRleCArIDEpICsgJyddID0geyB0cmVlTGV2ZWw6IGdyb3VwRmllbGRDYWNoZS5sZW5ndGgsIGlzRGV0YWlsOiAxIH07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3dDb3VudCArPSAxO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRkUm93c0NhY2hlLnB1c2goaSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBncm91cFJvd0NhY2hlLnB1c2goYWRkUm93SW5kZXgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNoZWV0LmdldERhdGFJdGVtKGFkZFJvd0luZGV4KS5oYXNPd25Qcm9wZXJ0eShcInFkcF9kYXRhX2ZsYWdcIikgJiYgKHNoZWV0LmdldERhdGFJdGVtKGFkZFJvd0luZGV4KVtcInFkcF9kYXRhX2ZsYWdcIl0gKyAnJykgPT09ICgzICsgJycpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaSA9PT0gKGdyb3VwRmllbGRDYWNoZS5sZW5ndGggLSAxKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdyb3VwVHJlZUxldmVsWyhhZGRSb3dJbmRleCArIDEpICsgJyddID0geyB0cmVlTGV2ZWw6IGdyb3VwRmllbGRDYWNoZS5sZW5ndGgsIGlzRGV0YWlsOiAxIH07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZm9yIChsZXQgciA9IDA7IHIgPCByb3dDb3VudDsgcisrKSB7XHJcbiAgICAgICAgICAgIGlmICghZ3JvdXBUcmVlTGV2ZWwuaGFzT3duUHJvcGVydHkocikpIHtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGZvciAobGV0IHQgPSAwOyB0IDw9IGdyb3VwVHJlZUxldmVsW3IgKyAnJ10udHJlZUxldmVsOyB0KyspIHtcclxuICAgICAgICAgICAgICAgIHNoZWV0LnJvd091dGxpbmVzLmdyb3VwKHIsIDEpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHNoZWV0LnNldENlbGxUeXBlKHIsIGluZGV4LCBuZXcgVHJlZUNlbGxUeXBlKG51bGwsIGZhbHNlLCBncm91cFRyZWVMZXZlbFtyICsgJyddLnRyZWVMZXZlbCwgZ3JvdXBUcmVlTGV2ZWxbciArICcnXS5pc0RldGFpbCkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy50eXBlICE9PSAnY3Jvc3N0YWInICYmIHRoaXMuZ2V0U2hvd0ZpbHRlclJvdyhzY2hlbWEpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZmlsdGVyUm93KHNoZWV0KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0R3JvdXBGaWVsZChncm91cENvbENhY2hlOiBhbnksIHNjaGVtYTogYW55KSB7XHJcbiAgICAgICAgaWYgKHNjaGVtYSAmJiBzY2hlbWEuc2NoZW1hVmFsdWUgJiYgc2NoZW1hLnNjaGVtYVZhbHVlLmNvbHVtbk9wdGlvbiAmJiBzY2hlbWEuc2NoZW1hVmFsdWUuY29sdW1uT3B0aW9uLmNvbExpc3QgJiYgc2NoZW1hLnNjaGVtYVZhbHVlLmNvbHVtbk9wdGlvbi5jb2xMaXN0Lmxlbmd0aCkge1xyXG4gICAgICAgICAgICB0aGlzLmF1dG9GaXRDb2x1bW5JbmRleCA9IDA7XHJcbiAgICAgICAgICAgIHNjaGVtYS5zY2hlbWFWYWx1ZS5jb2x1bW5PcHRpb24uY29sTGlzdC5mb3JFYWNoKChjb2w6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5yZWN1cnNpb25HZXRHcm91cENvbHVtbihncm91cENvbENhY2hlLCBjb2wsIG51bGwpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0SXNSZWRDb2x1bW5zKHNjaGVtYTogYW55LCBwYXJhbXM6IGFueSkge1xyXG4gICAgICAgIGlmIChzY2hlbWEgJiYgc2NoZW1hLnNjaGVtYVZhbHVlICYmIHNjaGVtYS5zY2hlbWFWYWx1ZS5jb2x1bW5PcHRpb24gJiYgc2NoZW1hLnNjaGVtYVZhbHVlLmNvbHVtbk9wdGlvbi5jb2xMaXN0ICYmIHNjaGVtYS5zY2hlbWFWYWx1ZS5jb2x1bW5PcHRpb24uY29sTGlzdC5sZW5ndGgpIHtcclxuICAgICAgICAgICAgc2NoZW1hLnNjaGVtYVZhbHVlLmNvbHVtbk9wdGlvbi5jb2xMaXN0LmZvckVhY2goKGNvbDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJlY3Vyc2l2ZUlzUmVkQ29sdW1uKGNvbCwgbnVsbCwgcGFyYW1zKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGdldEZvcm1hdEZpZWxkKGZpZWxkQ2FjaGU6IGFueSwgc2NoZW1hOiBhbnkpIHtcclxuICAgICAgICBpZiAoc2NoZW1hICYmIHNjaGVtYS5zY2hlbWFWYWx1ZSAmJiBzY2hlbWEuc2NoZW1hVmFsdWUuY29sdW1uT3B0aW9uICYmIHNjaGVtYS5zY2hlbWFWYWx1ZS5jb2x1bW5PcHRpb24uY29sTGlzdCAmJiBzY2hlbWEuc2NoZW1hVmFsdWUuY29sdW1uT3B0aW9uLmNvbExpc3QubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYXV0b0ZpdENvbHVtbkluZGV4ID0gMDtcclxuICAgICAgICAgICAgc2NoZW1hLnNjaGVtYVZhbHVlLmNvbHVtbk9wdGlvbi5jb2xMaXN0LmZvckVhY2goKGNvbDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJlY3Vyc2lvbkdldEZvcm1hdENvbHVtbihmaWVsZENhY2hlLCBjb2wsIG51bGwpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0U2hvd0hlYWRlclNvcnQoc2NoZW1hOiBhbnkpIHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBpZiAoc2NoZW1hICYmIHNjaGVtYS5zY2hlbWFWYWx1ZSAmJiBzY2hlbWEuc2NoZW1hVmFsdWUub3RoZXJPcHRpb24gJiYgc2NoZW1hLnNjaGVtYVZhbHVlLm90aGVyT3B0aW9uLnNob3dIZWFkZXJTb3J0ICE9IG51bGwgJiYgc2NoZW1hLnNjaGVtYVZhbHVlLm90aGVyT3B0aW9uLnNob3dIZWFkZXJTb3J0ICE9IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHNjaGVtYS5zY2hlbWFWYWx1ZS5vdGhlck9wdGlvbi5zaG93SGVhZGVyU29ydDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBnZXRTaG93RmlsdGVyUm93KHNjaGVtYTogYW55KSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgaWYgKHNjaGVtYSAmJiBzY2hlbWEuc2NoZW1hVmFsdWUgJiYgc2NoZW1hLnNjaGVtYVZhbHVlLm90aGVyT3B0aW9uICYmIHNjaGVtYS5zY2hlbWFWYWx1ZS5vdGhlck9wdGlvbi5zaG93RmlsdGVyUm93ICE9IG51bGwgJiYgc2NoZW1hLnNjaGVtYVZhbHVlLm90aGVyT3B0aW9uLnNob3dGaWx0ZXJSb3cgIT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gc2NoZW1hLnNjaGVtYVZhbHVlLm90aGVyT3B0aW9uLnNob3dGaWx0ZXJSb3c7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0TWVyZ2VDZWxsKHNjaGVtYTogYW55KSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgaWYgKHNjaGVtYSAmJiBzY2hlbWEuc2NoZW1hVmFsdWUgJiYgc2NoZW1hLnNjaGVtYVZhbHVlLm90aGVyT3B0aW9uICYmIHNjaGVtYS5zY2hlbWFWYWx1ZS5vdGhlck9wdGlvbi5tZXJnZUNlbGwgIT0gbnVsbCAmJiBzY2hlbWEuc2NoZW1hVmFsdWUub3RoZXJPcHRpb24ubWVyZ2VDZWxsICE9IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHNjaGVtYS5zY2hlbWFWYWx1ZS5vdGhlck9wdGlvbi5tZXJnZUNlbGw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHJlY3Vyc2lvbkdldEZvcm1hdENvbHVtbihmaWVsZENhY2hlOiBhbnksIGNvbHVtbjogYW55LCBjaGlsZExpc3Q6IGFueVtdKSB7XHJcbiAgICAgICAgaWYgKGNvbHVtbikge1xyXG4gICAgICAgICAgICBpZiAoY29sdW1uLmNoaWxkTGlzdCAmJiBjb2x1bW4uY2hpbGRMaXN0Lmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5yZWN1cnNpb25HZXRGb3JtYXRDb2x1bW4oZmllbGRDYWNoZSwgbnVsbCwgY29sdW1uLmNoaWxkTGlzdCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoY29sdW1uLmZvcm1hdFR5cGUgPT0gMSAmJiBjb2x1bW4uZm9ybWF0RmllbGQpIHtcclxuICAgICAgICAgICAgICAgICAgICBmaWVsZENhY2hlLnB1c2goeyBzb3VyY2VGaWVsZDogY29sdW1uLmJpbmRGaWVsZCwgZm9ybWF0RmllbGQ6IGNvbHVtbi5mb3JtYXRGaWVsZCwgZm9ybWF0dGVyOiBjb2x1bW4uZm9ybWF0dG9yIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgY2hpbGRMaXN0LmZvckVhY2goKGNvbDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoY29sLmNoaWxkTGlzdCAmJiBjb2wuY2hpbGRMaXN0Lmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVjdXJzaW9uR2V0Rm9ybWF0Q29sdW1uKGZpZWxkQ2FjaGUsIG51bGwsIGNvbC5jaGlsZExpc3QpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoY29sLmZvcm1hdFR5cGUgPT0gMSAmJiBjb2wuZm9ybWF0RmllbGQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZmllbGRDYWNoZS5wdXNoKHsgc291cmNlRmllbGQ6IGNvbC5iaW5kRmllbGQsIGZvcm1hdEZpZWxkOiBjb2wuZm9ybWF0RmllbGQsIGZvcm1hdHRlcjogY29sLmZvcm1hdHRvciB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHJlY3Vyc2lvbkdldEdyb3VwQ29sdW1uKGdyb3VwQ29sQ2FjaGU6IGFueSwgY29sdW1uOiBhbnksIGNoaWxkTGlzdDogYW55W10pIHtcclxuICAgICAgICBpZiAoY29sdW1uKSB7XHJcbiAgICAgICAgICAgIGlmIChjb2x1bW4uY2hpbGRMaXN0ICYmIGNvbHVtbi5jaGlsZExpc3QubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJlY3Vyc2lvbkdldEdyb3VwQ29sdW1uKGdyb3VwQ29sQ2FjaGUsIG51bGwsIGNvbHVtbi5jaGlsZExpc3QpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaWYgKGNvbHVtbi5pc0dyb3VwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZ3JvdXBDb2xDYWNoZS5wdXNoKGNvbHVtbi5iaW5kRmllbGQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgY2hpbGRMaXN0LmZvckVhY2goKGNvbDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoY29sLmNoaWxkTGlzdCAmJiBjb2wuY2hpbGRMaXN0Lmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVjdXJzaW9uR2V0R3JvdXBDb2x1bW4oZ3JvdXBDb2xDYWNoZSwgbnVsbCwgY29sLmNoaWxkTGlzdCk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChjb2wuaXNHcm91cCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBncm91cENvbENhY2hlLnB1c2goY29sLmJpbmRGaWVsZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgbG9naWNGb3JtYXQoZm9ybWF0dG9yOiBhbnksIGNlbGxWYWx1ZTogYW55KSB7XHJcbiAgICAgICAgY29uc3Qgc3RyID0gZm9ybWF0dG9yLnNwbGl0KCc7Jyk7XHJcbiAgICAgICAgY29uc3QgcmVhbCA9IHN0clswXS5zcGxpdCgnLycpO1xyXG4gICAgICAgIGNvbnN0IGRpc3AgPSBzdHJbMV0uc3BsaXQoJy8nKTtcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHJlYWwubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOnRyaXBsZS1lcXVhbHNcclxuICAgICAgICAgICAgaWYgKHJlYWxbaV0gPT0gKGNlbGxWYWx1ZSArICcnKSkge1xyXG4gICAgICAgICAgICAgICAgY2VsbFZhbHVlID0gZGlzcFtpXTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBjZWxsVmFsdWU7XHJcbiAgICB9XHJcblxyXG4gICAgZmlsdGVyUm93KHNoZWV0OiBhbnkpIHtcclxuICAgICAgICBzaGVldC5hZGRSb3dzKDAsIDEpO1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2hlZXQuZ2V0Um93Q291bnQoKTsgaSsrKSB7XHJcbiAgICAgICAgICAgIHNoZWV0LmdldENlbGwoaSwgMCwgR0MuU3ByZWFkLlNoZWV0cy5TaGVldEFyZWEucm93SGVhZGVyKS52YWx1ZShpID09IDAgPyAnJyA6IGkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBzaGVldC5zZXRSb3dIZWlnaHQoMCwgdGhpcy5kYXRhUm93SGVpZ2h0QXJyYXlbMF0pO1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2hlZXQuZ2V0Q29sdW1uQ291bnQoKTsgaSsrKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHMgPSBuZXcgR0MuU3ByZWFkLlNoZWV0cy5TdHlsZSgpO1xyXG4gICAgICAgICAgICBzLmZyb21KU09OKHRoaXMuZGF0YVN0eWxlQXJyYXlbMF1baV0udG9KU09OKCkpO1xyXG4gICAgICAgICAgICBzLmxvY2tlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICBzLmZvcm1hdHRlciA9ICdAJztcclxuICAgICAgICAgICAgc2hlZXQuc2V0U3R5bGUoMCwgaSwgcyk7XHJcbiAgICAgICAgICAgIHNoZWV0LnNldENlbGxUeXBlKDAsIGksIG5ldyBGaWx0ZXJDZWxsVHlwZShzaGVldCkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBmaWx0ZXIgPSBuZXcgR0MuU3ByZWFkLlNoZWV0cy5GaWx0ZXIuSGlkZVJvd0ZpbHRlcihuZXcgR0MuU3ByZWFkLlNoZWV0cy5SYW5nZSgxLCAwLCBzaGVldC5nZXRSb3dDb3VudCgpLCBzaGVldC5nZXRDb2x1bW5Db3VudCgpKSk7XHJcbiAgICAgICAgc2hlZXQucm93RmlsdGVyKGZpbHRlcik7XHJcbiAgICAgICAgZmlsdGVyLmZpbHRlckJ1dHRvblZpc2libGUoZmFsc2UpO1xyXG4gICAgfVxyXG5cclxuICAgIGxpbmtGaWVsZChzcHJlYWQ6IGFueSwgc2hlZXQ6IGFueSkge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xyXG4gICAgICAgICAgICBjb25zdCByb3dDb3VudCA9IHNoZWV0LmdldFJvd0NvdW50KCk7XHJcbiAgICAgICAgICAgIGNvbnN0IGNvbENvdW50ID0gc2hlZXQuZ2V0Q29sdW1uQ291bnQoKTtcclxuICAgICAgICAgICAgLy8gY29uc3QgZm9vdGVyQ291bnQgPSB0aGlzLmZvb3RlclJvd0hlaWdodEFycmF5Lmxlbmd0aDtcclxuICAgICAgICAgICAgZm9yIChsZXQgciA9IDE7IHIgPCAocm93Q291bnQpOyByKyspIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGRhdGFJdGVtID0gc2hlZXQuZ2V0RGF0YUl0ZW0ocik7XHJcbiAgICAgICAgICAgICAgICBpZiAoZGF0YUl0ZW0uaGFzT3duUHJvcGVydHkoJ2R5bmFtaWNQcm9wU2V0JykgJiYgZGF0YUl0ZW0uZHluYW1pY1Byb3BTZXQuaGFzT3duUHJvcGVydHkoJ3FkcF9kYXRhX2ZsYWcnKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgYyA9IDA7IGMgPCBjb2xDb3VudDsgYysrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgam9pblNlYXJjaCA9IEpTT04ucGFyc2UodGhpcy5qb2ludHNlYXJjaEluZm9MaXN0Wydqb2luU2VhcmNoJ10pO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpwcmVmZXItZm9yLW9mXHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBqb2luU2VhcmNoLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGVsID0gam9pblNlYXJjaFtpXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVsLmpvaW50c2VyYWNoZGlzcGxheXN0eWxlID09PSAyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZWwubGlua2ZpZWxkID09PSB0aGlzLmRhdGFDb2xJbmZvQXJyYXlbY10ubmFtZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5oeXBlckxpbmtRdWVyeVt0aGlzLnF1ZXJ5SWRdKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaHlwZXJMaW5rUXVlcnlbdGhpcy5xdWVyeUlkXSA9IHt9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmh5cGVyTGlua1F1ZXJ5W3RoaXMucXVlcnlJZF1bYyArICcnXSA9IGVsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGgxID0gbmV3IEdDLlNwcmVhZC5TaGVldHMuQ2VsbFR5cGVzLkh5cGVyTGluaygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGgxLnRleHQoaDEuZm9ybWF0KHNoZWV0LmdldENlbGwociwgYykudmFsdWUoKSwgdGhpcy5kYXRhQ29sSW5mb0FycmF5W2NdLmZvcm1hdHRlcikpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGgxLmFjdGl2ZU9uQ2xpY2sodHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaDEub25DbGlja0FjdGlvbihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNwcmVhZC5jb21tYW5kTWFuYWdlcigpLmV4ZWN1dGUoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY21kOiAnZHJvcGRvd25xdWVyeScsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmOiBzZWxmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNoZWV0LnNldENlbGxUeXBlKHIsIGMsIGgxLCBHQy5TcHJlYWQuU2hlZXRzLlNoZWV0QXJlYS52aWV3cG9ydCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgc3ByZWFkLmNvbW1hbmRNYW5hZ2VyKCkucmVnaXN0ZXIoJ2Ryb3Bkb3ducXVlcnknLCB7XHJcbiAgICAgICAgICAgICAgICBjYW5VbmRvOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgZXhlY3V0ZTogZnVuY3Rpb24gKGNvbnRleHQsIG9wdGlvbnMsIGlzVW5kbykge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHJvdyA9IGNvbnRleHQuZ2V0QWN0aXZlU2hlZXQoKS5nZXRBY3RpdmVSb3dJbmRleCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvbCA9IGNvbnRleHQuZ2V0QWN0aXZlU2hlZXQoKS5nZXRBY3RpdmVDb2x1bW5JbmRleCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3Qga2V5IGluIG9wdGlvbnMuc2VsZi5oeXBlckxpbmtRdWVyeVtvcHRpb25zLnNlbGYucXVlcnlJZF0pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGtleSA9PT0gKGNvbCArICcnKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZWwgPSBvcHRpb25zLnNlbGYuaHlwZXJMaW5rUXVlcnlbb3B0aW9ucy5zZWxmLnF1ZXJ5SWRdW2tleV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgZW50aXR5UGFyYW0gPSB7ICdpZCc6ICdudWxsJyB9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcGFyYW1NYXAgPSBuZXcgTWFwPHN0cmluZywgc3RyaW5nPigpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2VhcmNocGFyYXMgPSBKU09OLnBhcnNlKG9wdGlvbnMuc2VsZi5qb2ludHNlYXJjaEluZm9MaXN0Wydqb2ludHBhcmFtJ10pLmZpbHRlcih4ID0+IHguZnVuY3Rpb25pZCA9PT0gZWxbJ2lkJ10pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgam9pblBhcmFtID0gb3B0aW9ucy5zZWxmLmNhY2hlLmdldChSdGZTZXJ2aWNlcy5nZXRUYWJJZChvcHRpb25zLnNlbGYucXVlcnlJZCkgKyAnam9pblNlYXJjaCcpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGRhdGFJdGVtID0geyAnaWQnOiAnbnVsbCcgfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChqb2luUGFyYW0uY29udHJvbFR5cGUgPT09ICdjcm9zc3RhYicpIHsgLy8g5Lqk5Y+J6KGoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g6I635Y+W6KGM5qCH6aKY55qE5pWw5o2uXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IGpvaW5QYXJhbS5yb3dIZWFkZXJDb2xJbmZvLnN0YXJ0OyBpIDwgam9pblBhcmFtLnJvd0hlYWRlckNvbEluZm8uZW5kOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdmFsdWUgPSBjb250ZXh0LmdldEFjdGl2ZVNoZWV0KCkuZ2V0VmFsdWUocm93LCBpLCBHQy5TcHJlYWQuU2hlZXRzLlNoZWV0QXJlYS52aWV3cG9ydCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5hbWUgPSBjb250ZXh0LmdldEFjdGl2ZVNoZWV0KCkuZ2V0VmFsdWUoam9pblBhcmFtLmNvbEhlYWRlclJvd0luZm8uc3RhcnQsIGksIEdDLlNwcmVhZC5TaGVldHMuU2hlZXRBcmVhLmNvbEhlYWRlcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvbEluZm8gPSBqb2luUGFyYW0uY29sSW5mb3MuZmluZCgoeDogYW55KSA9PiB4LmRpbWVuc2lvbiA9PT0gMSAmJiB4Lm5hbWUgPT09IG5hbWUpLmJpbmRGaWVsZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YUl0ZW1bY29sSW5mb10gPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g6I635Y+W5YiX5qCH6aKY55qE5pWw5o2uXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IGpvaW5QYXJhbS5jb2xIZWFkZXJSb3dJbmZvLnN0YXJ0OyBpIDwgam9pblBhcmFtLmNvbEhlYWRlclJvd0luZm8uZW5kOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdmFsdWUgPSBjb250ZXh0LmdldEFjdGl2ZVNoZWV0KCkuZ2V0VmFsdWUoaSwgY29sLCBHQy5TcHJlYWQuU2hlZXRzLlNoZWV0QXJlYS5jb2xIZWFkZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjb2xJbmZvID0gam9pblBhcmFtLmNvbEluZm9zLmZpbHRlcigoeDogYW55KSA9PiB4LmRpbWVuc2lvbiA9PT0gMilbaSAtIGpvaW5QYXJhbS5jb2xIZWFkZXJSb3dJbmZvLnN0YXJ0XS5iaW5kRmllbGQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFJdGVtW2NvbEluZm9dID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOiOt+WPluWAvOagh+mimOeahOaVsOaNrlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gY29udGV4dC5nZXRBY3RpdmVTaGVldCgpLmdldFZhbHVlKHJvdywgY29sLCBHQy5TcHJlYWQuU2hlZXRzLlNoZWV0QXJlYS52aWV3cG9ydCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbmFtZSA9IGNvbnRleHQuZ2V0QWN0aXZlU2hlZXQoKS5nZXRWYWx1ZShqb2luUGFyYW0uY29sSGVhZGVyUm93SW5mby5lbmQsIGNvbCwgR0MuU3ByZWFkLlNoZWV0cy5TaGVldEFyZWEuY29sSGVhZGVyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgY29sSW5mbyA9IGpvaW5QYXJhbS5jb2xJbmZvcy5maW5kKCh4OiBhbnkpID0+IHguZGltZW5zaW9uID09PSAzICYmIHgubmFtZSA9PT0gbmFtZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbEluZm8pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sSW5mbyA9IGNvbEluZm8uYmluZEZpZWxkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhSXRlbVtjb2xJbmZvXSA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YUl0ZW0gPSBjb250ZXh0LmdldEFjdGl2ZVNoZWV0KCkuZ2V0RGF0YUl0ZW0ocm93KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjdXJyZW50U2VsZWN0ZWRJdGVtID0gZGF0YUl0ZW07IC8vIOW9k+WJjemAieS4reaVsOaNrlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNlYXJjaHBhcmFzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWFyY2hwYXJhcy5mb3JFYWNoKHZhbHVlID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlLnBhcmF2YWx1ZXR5cGUpIHsvLyDooajovr7lvI9cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZS5wYXJhdmFsdWUuaW5kZXhPZignZ2V0UGFyYW1ldGVyKCcpID49IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwYXJhbWV0ZXJLZXkgPSB2YWx1ZS5wYXJhdmFsdWUucmVwbGFjZSgvJy9nLCAnJykucmVwbGFjZSgvXCIvZywgJycpLnJlcGxhY2UoL2dldFBhcmFtZXRlclxcKC9nLCAnJykucmVwbGFjZSgvXFwpL2csICcnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLnNlbGYuZ2V0UXVlcnlQYXJhbWV0ZXJzKGVudGl0eVBhcmFtLCBwYXJhbU1hcCwgcGFyYW1ldGVyS2V5LCB2YWx1ZS5wYXJhKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW50aXR5UGFyYW1bdmFsdWUucGFyYV0gPSBjdXJyZW50U2VsZWN0ZWRJdGVtW3ZhbHVlLnBhcmF2YWx1ZV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1NYXAuc2V0KHZhbHVlLnBhcmEsIGN1cnJlbnRTZWxlY3RlZEl0ZW1bdmFsdWUucGFyYXZhbHVlXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbnRpdHlQYXJhbVt2YWx1ZS5wYXJhXSA9IHZhbHVlLnBhcmF2YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtTWFwLnNldCh2YWx1ZS5wYXJhLCB2YWx1ZS5wYXJhdmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVudGl0eVBhcmFtID0gY3VycmVudFNlbGVjdGVkSXRlbTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG9wOiBhbnkgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUGFyZW50U2Vzc2lvbklkOiBvcHRpb25zLnNlbGYuY2FjaGUuZ2V0KCdzZXNzaW9uJyksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRW50aXR5UGFyYW06IGVudGl0eVBhcmFtXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHRhYklkID0gJyc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZWwuc2VhcmNodHlwZSA9PT0gJ2Z1bmMnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g6IGU5p+l5YmNXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgb3Blbk1lbnVvcHRpb25zID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnYXBwVHlwZSc6ICdtZW51JyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2Z1bmNJZCc6IGVsLmZ1bmN0aW9uY29kZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3RhYklkJzogRXZlbnRCdXMuZ3VpZCgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnYXBwSWQnOiAnJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2FwcEVudHJhbmNlJzogJycsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdlbnRpdHlQYXJhbXMnOiBvcC5lbnRpdHlQYXJhbSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3F1ZXJ5U3RyaW5nUGFyYW1zJzogcGFyYW1NYXAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdpc05ld1RhYic6IHRydWVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhYklkID0gUnRmU2VydmljZXMuZ2V0RnVuY0lkKG9wZW5NZW51b3B0aW9ucyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5zZWxmLmNhY2hlLnNldCh0YWJJZCA/IHRhYklkIDogb3B0aW9ucy5zZWxmLnF1ZXJ5SWQsIG9wLkVudGl0eVBhcmFtKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBtZW51U3dpdGNoQ29udHJvbCA9IE9iamVjdC5hc3NpZ24oe30sIG9wZW5NZW51b3B0aW9uc1snZW50aXR5UGFyYW1zJ10sIFJ0ZlNlcnZpY2VzLmdldE1lbnVTd2l0Y2hDb250cm9sUGFyYW1ldGVyKHRhYklkKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3Blbk1lbnVvcHRpb25zWydlbnRpdHlQYXJhbXMnXSA9IG1lbnVTd2l0Y2hDb250cm9sO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOWNoeeJh+Whnui/m+WOu3BhcmFtc1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdzcGZyYW1ld29ya1NlcnZpY2UucnRmLmZ1bmMub3Blbk1lbnUob3Blbk1lbnVvcHRpb25zKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZWwuc2VhcmNodHlwZSA9PT0gJ2FwcCcpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBhcHBPcHRpb24gPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFwcFR5cGU6ICdhcHAnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcHBJZDogZWwuZnVuY3Rpb25jb2RlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcHBFbnRyYW5jZTogZWwuYXBwRW50cmFuY2UsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmNJZDogJycsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzUmVsb2FkOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWJJZDogRXZlbnRCdXMuZ3VpZCgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbnRpdHlQYXJhbXM6IG9wLmVudGl0eVBhcmFtLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBxdWVyeVN0cmluZ1BhcmFtczogcGFyYW1NYXBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhYklkID0gUnRmU2VydmljZXMuZ2V0RnVuY0lkKGFwcE9wdGlvbik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5zZWxmLmNhY2hlLnNldCh0YWJJZCA/IHRhYklkIDogb3B0aW9ucy5xdWVyeUlkLCBvcC5FbnRpdHlQYXJhbSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbWVudVN3aXRjaENvbnRyb2wgPSBPYmplY3QuYXNzaWduKHt9LCBhcHBPcHRpb25bJ2VudGl0eVBhcmFtcyddLCBSdGZTZXJ2aWNlcy5nZXRNZW51U3dpdGNoQ29udHJvbFBhcmFtZXRlcih0YWJJZCkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFwcE9wdGlvblsnZW50aXR5UGFyYW1zJ10gPSBtZW51U3dpdGNoQ29udHJvbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnc3BmcmFtZXdvcmtTZXJ2aWNlLnJ0Zi5mdW5jLm9wZW5NZW51KGFwcE9wdGlvbik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sIG51bGwsIGZhbHNlLCBmYWxzZSwgZmFsc2UsIGZhbHNlKTtcclxuICAgICAgICB9IGNhdGNoIChlKSB7IH1cclxuICAgIH1cclxuXHJcbiAgICBpblN1aXRlTGlua0ZpZWxkKHNwcmVhZDogYW55LCBzaGVldDogYW55LCBleHRPYmo6IGFueSkge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xyXG4gICAgICAgICAgICBsZXQgZGF0YSA9IG51bGw7XHJcbiAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5sY3BTZXJ2aWNlLmluU3VpdGVEcm9wRG93bkluZm8gJiYgdHlwZW9mIHRoaXMubGNwU2VydmljZS5pblN1aXRlRHJvcERvd25JbmZvID09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YSA9IEpTT04ucGFyc2UodGhpcy5sY3BTZXJ2aWNlLmluU3VpdGVEcm9wRG93bkluZm8pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgICAgICB0aHJvdyBlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvbnN0IHJvd0NvdW50ID0gc2hlZXQuZ2V0Um93Q291bnQoKTtcclxuICAgICAgICAgICAgY29uc3QgY29sQ291bnQgPSBzaGVldC5nZXRDb2x1bW5Db3VudCgpO1xyXG4gICAgICAgICAgICBsZXQgcm93RHJvcERvd24gPSB0cnVlO1xyXG4gICAgICAgICAgICBjb25zdCBjYWNoZVJvd0Ryb3BEb3duID0gW107XHJcbiAgICAgICAgICAgIGNvbnN0IGNhY2hlQ2VsbERyb3BEb3duID0ge307XHJcbiAgICAgICAgICAgIC8vIOino+aekOebuOWFs+aVsOaNrlxyXG4gICAgICAgICAgICBjb25zdCB7XHJcbiAgICAgICAgICAgICAgICBjbGlja19ldmVudHM6IGNsaWNrRXZlbnRzLFxyXG4gICAgICAgICAgICAgICAgZXZlbnRfZGF0YTogZXZlbnREYXRhLFxyXG4gICAgICAgICAgICAgICAgZG91YmxlX2NsaWNrX2V2ZW50OiBkY0V2ZW50LFxyXG4gICAgICAgICAgICAgICAgZG91YmxlX2NsaWNrX2V2ZW50X3BhcmFtczogZGNFdmVudFBhcmFtcyxcclxuICAgICAgICAgICAgICAgIHJjX2V2ZW50X2lkczogcmNFdmVudElkc1xyXG4gICAgICAgICAgICB9ID0gZGF0YVxyXG4gICAgICAgICAgICBpZiAoZGNFdmVudCAmJiAhKFwie31cIiA9PSBKU09OLnN0cmluZ2lmeShkY0V2ZW50KSkgJiYgZGNFdmVudFBhcmFtcyAmJiAhKFwie31cIiA9PSBKU09OLnN0cmluZ2lmeShkY0V2ZW50UGFyYW1zKSkpIHtcclxuICAgICAgICAgICAgICAgIHJvd0Ryb3BEb3duID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIGZvciAobGV0IGtleSBpbiBkY0V2ZW50UGFyYW1zKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FjaGVSb3dEcm9wRG93bi5wdXNoKGtleSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZXZlbnREYXRhICYmICEoXCJ7fVwiID09IEpTT04uc3RyaW5naWZ5KGV2ZW50RGF0YSkpKSB7XHJcbiAgICAgICAgICAgICAgICByb3dEcm9wRG93biA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgZm9yIChsZXQga2V5IGluIGV2ZW50RGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChldmVudERhdGFba2V5XSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjZWxsSW5kZXggPSBbXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FjaGVDZWxsRHJvcERvd25ba2V5XSA9IGNlbGxJbmRleDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQga2V5MSBpbiBldmVudERhdGFba2V5XSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FjaGVDZWxsRHJvcERvd25ba2V5XS5wdXNoKGtleTEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGZvciAobGV0IHIgPSAxOyByIDwgKHJvd0NvdW50KTsgcisrKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBkYXRhSXRlbSA9IHNoZWV0LmdldERhdGFJdGVtKHIpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGRhdGFJdGVtLmhhc093blByb3BlcnR5KCdkeW5hbWljUHJvcFNldCcpICYmIGRhdGFJdGVtLmR5bmFtaWNQcm9wU2V0Lmhhc093blByb3BlcnR5KCdxZHBfZGF0YV9mbGFnJykpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGZvciAobGV0IGMgPSAwOyBjIDwgY29sQ291bnQ7IGMrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChyb3dEcm9wRG93bikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNhY2hlUm93RHJvcERvd24ubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyID09IChjYWNoZVJvd0Ryb3BEb3duW2ldIC0gMCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBoMSA9IG5ldyBHQy5TcHJlYWQuU2hlZXRzLkNlbGxUeXBlcy5IeXBlckxpbmsoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBmb3JtYXR0ZXIgPSBzaGVldC5nZXRGb3JtYXR0ZXIociwgYyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaDEudGV4dChoMS5mb3JtYXQoc2hlZXQuZ2V0Q2VsbChyLCBjKS52YWx1ZSgpLCBmb3JtYXR0ZXIpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoMS5hY3RpdmVPbkNsaWNrKHRydWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGgxLm9uQ2xpY2tBY3Rpb24oZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcHJlYWQuY29tbWFuZE1hbmFnZXIoKS5leGVjdXRlKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNtZDogJ2Ryb3Bkb3ducXVlcnknLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZjogc2VsZlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaGVldC5zZXRDZWxsVHlwZShyLCBjLCBoMSwgR0MuU3ByZWFkLlNoZWV0cy5TaGVldEFyZWEudmlld3BvcnQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQga2V5IGluIGNhY2hlQ2VsbERyb3BEb3duKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoKHIgKyAnJykgPT09IGtleSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY2FjaGVDZWxsRHJvcERvd25ba2V5XS5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBoMSA9IG5ldyBHQy5TcHJlYWQuU2hlZXRzLkNlbGxUeXBlcy5IeXBlckxpbmsoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZm9ybWF0dGVyID0gc2hlZXQuZ2V0Rm9ybWF0dGVyKHIsIGNhY2hlQ2VsbERyb3BEb3duW2tleV1baV0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoMS50ZXh0KGgxLmZvcm1hdChzaGVldC5nZXRDZWxsKHIsIGNhY2hlQ2VsbERyb3BEb3duW2tleV1baV0pLnZhbHVlKCksIGZvcm1hdHRlcikpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoMS5hY3RpdmVPbkNsaWNrKHRydWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoMS5vbkNsaWNrQWN0aW9uKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNwcmVhZC5jb21tYW5kTWFuYWdlcigpLmV4ZWN1dGUoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNtZDogJ2Ryb3Bkb3ducXVlcnknLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGY6IHNlbGZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hlZXQuc2V0Q2VsbFR5cGUociwgY2FjaGVDZWxsRHJvcERvd25ba2V5XVtpXSwgaDEsIEdDLlNwcmVhZC5TaGVldHMuU2hlZXRBcmVhLnZpZXdwb3J0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgc3ByZWFkLmNvbW1hbmRNYW5hZ2VyKCkucmVnaXN0ZXIoJ2Ryb3Bkb3ducXVlcnknLCB7XHJcbiAgICAgICAgICAgICAgICBjYW5VbmRvOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgZXhlY3V0ZTogZnVuY3Rpb24gKGNvbnRleHQsIG9wdGlvbnMsIGlzVW5kbykge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHJvdyA9IGNvbnRleHQuZ2V0QWN0aXZlU2hlZXQoKS5nZXRBY3RpdmVSb3dJbmRleCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvbCA9IGNvbnRleHQuZ2V0QWN0aXZlU2hlZXQoKS5nZXRBY3RpdmVDb2x1bW5JbmRleCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIOWPjOWHu+S6i+S7tueahOmAu+i+kVxyXG4gICAgICAgICAgICAgICAgICAgIGxldCBldmVudCwgcGFyYW1zO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIOihjOeCueWHu+aVsOaNrlxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChkY0V2ZW50ICYmICEoXCJ7fVwiID09IEpTT04uc3RyaW5naWZ5KGRjRXZlbnQpKSAmJiBkY0V2ZW50UGFyYW1zICYmICEoXCJ7fVwiID09IEpTT04uc3RyaW5naWZ5KGRjRXZlbnRQYXJhbXMpKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBldmVudCA9IGRjRXZlbnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFyZ3Mucm935Li66KGM5bqP5Y+377yM5LiL5ZCMXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtcyA9IGRjRXZlbnRQYXJhbXNbcm93XTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8g5aaC5p6cZXZlbnREYXRh5pWw5o2u5LiN5Li656m677yM5bm25LiU5a+55bqU6KGM55qE5pWw5o2u5Lmf5LiN5Li656m6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOWNleWFg+agvOaVsOaNrlxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZXZlbnREYXRhICYmICEoXCJ7fVwiID09IEpTT04uc3RyaW5naWZ5KGV2ZW50RGF0YSkpICYmIGV2ZW50RGF0YVtyb3ddICYmICEoXCJ7fVwiID09IEpTT04uc3RyaW5naWZ5KGV2ZW50RGF0YVtyb3ddKSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHRoaXNFdmVudElkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDlpoLmnpzlr7nlupTooYzljIXlkKstMe+8jOWImeWPli0x5Lit55qE5pWw5o2uLCDlkKbliJnlj5blr7nlupTliJflj7fnmoTmlbDmja5cclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gYXJncy5jb2zkuLrliJfluo/lj7dcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHRoaXNFdmVudERhdGEgPSBldmVudERhdGFbcm93XVstMV0gfHwgZXZlbnREYXRhW3Jvd11bY29sXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXNFdmVudERhdGEgJiYgIShcInt9XCIgPT0gSlNPTi5zdHJpbmdpZnkodGhpc0V2ZW50RGF0YSkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXJjRXZlbnRJZHMgJiYgcmNFdmVudElkcy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBvYmogPSB7fTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBrZXkgaW4gdGhpc0V2ZW50RGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmNFdmVudElkcy5maW5kSW5kZXgoKGVsOiBhbnkpID0+IGVsID09IGtleSkgPCAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmpba2V5XSA9IHRoaXNFdmVudERhdGFba2V5XTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzRXZlbnREYXRhID0gb2JqO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGluZGV4ID0gMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGtleSBpbiB0aGlzRXZlbnREYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGluZGV4ID09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0V2ZW50SWQgPSBrZXk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZGV4Kys7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJhbXMgPSB0aGlzRXZlbnREYXRhW3RoaXNFdmVudElkXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8g5qC55o2uZXZlbnQgaWTojrflj5ZldmVudFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpc0V2ZW50SWQgIT0gbnVsbCAmJiB0aGlzRXZlbnRJZCAhPSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50ID0gY2xpY2tFdmVudHNbdGhpc0V2ZW50SWRdICYmICEoXCJ7fVwiID09IEpTT04uc3RyaW5naWZ5KGNsaWNrRXZlbnRzW3RoaXNFdmVudElkXSkpID8gY2xpY2tFdmVudHNbdGhpc0V2ZW50SWRdLmV2ZW50IDoge307XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IG1lc3NhZ2U7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEoXCJ7fVwiID09IEpTT04uc3RyaW5naWZ5KGV2ZW50KSkgJiYgIShcInt9XCIgPT0gSlNPTi5zdHJpbmdpZnkocGFyYW1zKSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8g6L+U5Zue5pWw5o2uXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2UgPSB7IHR5cGU6ICdjZWxsQWN0aW9uJywgZXZlbnQsIHBhcmFtcywgZGVmYXVsdHM6IGRhdGEuZGVmYXVsdHMgfTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG1lc3NhZ2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4dE9iai5pblN1aXRlV2luZG93KCkucG9zdE1lc3NhZ2UobWVzc2FnZSwgbG9jYXRpb24ub3JpZ2luKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSwgbnVsbCwgZmFsc2UsIGZhbHNlLCBmYWxzZSwgZmFsc2UpO1xyXG4gICAgICAgIH0gY2F0Y2ggKGUpIHsgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgZ2V0UXVlcnlQYXJhbWV0ZXJzKGVudGl0eVBhcmFtOiBhbnksIHBhcmFtTWFwOiBhbnksIHBhcmFtZXRlcktleTogYW55LCBrZXk6IGFueSkge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHRhYiA9IGdzcGZyYW1ld29ya1NlcnZpY2UucnRmLnNlc3Npb24uZ2V0Q29tbW9uVmFyaWFibGUoKTtcclxuICAgICAgICAgICAgaWYgKHRhYiAmJiB0YWIudGFiSWQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHRpZCA9IHRhYi50YWJJZCArIFJ0ZlNlcnZpY2VzLmdldEluU3VpdGVGcm1VVUlEKCk7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5jYWNoZS5nZXQodGlkKSAmJiB0aGlzLmNhY2hlLmdldCh0aWQpW3BhcmFtZXRlcktleV0pIHtcclxuICAgICAgICAgICAgICAgICAgICBlbnRpdHlQYXJhbVtrZXldID0gdGhpcy5jYWNoZS5nZXQodGlkKVtwYXJhbWV0ZXJLZXldO1xyXG4gICAgICAgICAgICAgICAgICAgIHBhcmFtTWFwLnNldChrZXksIHRoaXMuY2FjaGUuZ2V0KHRpZClbcGFyYW1ldGVyS2V5XSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGJpbmRTZWxlY3RDaGFuZ2VkKHNwcmVhZDogYW55LCBxdWVyeUlkOiBhbnkpIHtcclxuICAgICAgICBjb25zdCBzZWxmID0gdGhpcztcclxuICAgICAgICBzcHJlYWQuYmluZChHQy5TcHJlYWQuU2hlZXRzLkV2ZW50cy5TZWxlY3Rpb25DaGFuZ2luZywgZnVuY3Rpb24gKGU6IGFueSwgYXJnczogYW55KSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHRlbXBEYXRhID0ge307XHJcbiAgICAgICAgICAgIGNvbnN0IHNlbGVjdGlvbiA9IGFyZ3MubmV3U2VsZWN0aW9ucy5wb3AoKTtcclxuICAgICAgICAgICAgY29uc3Qgc2hlZXRBcmVhID0gYXJncy5zaGVldEFyZWEgPT09IDAgPyAnc2hlZXRDb3JuZXInIDogYXJncy5zaGVldEFyZWEgPT09IDEgPyAnY29sdW1uSGVhZGVyJyA6IGFyZ3Muc2hlZXRBcmVhID09PSAyID8gJ3Jvd0hlYWRlcicgOiAndmlld1BvcnQnO1xyXG4gICAgICAgICAgICBpZiAoc2VsZWN0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICB0ZW1wRGF0YVsnU3ByZWFkRXZlbnQnXSA9IEdDLlNwcmVhZC5TaGVldHMuRXZlbnRzLlNlbGVjdGlvbkNoYW5naW5nO1xyXG4gICAgICAgICAgICAgICAgdGVtcERhdGFbJ3NoZWV0QXJlYSddID0gc2hlZXRBcmVhO1xyXG4gICAgICAgICAgICAgICAgdGVtcERhdGFbJ3JvdyddID0gc2VsZWN0aW9uLnJvdztcclxuICAgICAgICAgICAgICAgIHRlbXBEYXRhWydjb2x1bW4nXSA9IHNlbGVjdGlvbi5jb2w7XHJcbiAgICAgICAgICAgICAgICB0ZW1wRGF0YVsncm93Q291bnQnXSA9IHNlbGVjdGlvbi5yb3dDb3VudDtcclxuICAgICAgICAgICAgICAgIHRlbXBEYXRhWydjb2xDb3VudCddID0gc2VsZWN0aW9uLmNvbENvdW50O1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RDaGFuZ2luZyA9IHRlbXBEYXRhO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgc3ByZWFkLmJpbmQoR0MuU3ByZWFkLlNoZWV0cy5FdmVudHMuQ2VsbENsaWNrLCBmdW5jdGlvbiAoZTogYW55LCBhcmdzOiBhbnkpIHtcclxuICAgICAgICAgICAgLy8g6Kej5p6Q5b2T5YmN6YCJ5Lit55qE5pWw5o2uXHJcbiAgICAgICAgICAgIGNvbnN0IGRhdGFJdGVtcyA9IFtdO1xyXG4gICAgICAgICAgICAvLyDogZTliqjlj4LmlbBcclxuICAgICAgICAgICAgbGV0IGxpbmthZ2VQYXJhbXMgPSB7fTtcclxuICAgICAgICAgICAgZm9yIChsZXQgcm93SW5kZXggPSAwOyByb3dJbmRleCA8IHRoaXMuc2VsZWN0Q2hhbmdpbmcucm93Q291bnQ7IHJvd0luZGV4KyspIHtcclxuICAgICAgICAgICAgICAgIGlmIChzZWxmLmpvaW5QYXJhbS5jb250cm9sVHlwZSAhPT0gJ2Nyb3NzdGFiJykge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGRhdGFJdGVtID0gYXJncy5zaGVldC5nZXREYXRhSXRlbShyb3dJbmRleCArIHRoaXMuc2VsZWN0Q2hhbmdpbmcucm93KTtcclxuICAgICAgICAgICAgICAgICAgICBsaW5rYWdlUGFyYW1zID0gZGF0YUl0ZW07XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YUl0ZW1zLnB1c2goZGF0YUl0ZW0pO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5zZWxlY3RDaGFuZ2luZy5jb2x1bW4gPT09IC0xKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0Q2hhbmdpbmcuY29sQ291bnQgPSB0aGlzLnNlbGVjdENoYW5naW5nLmNvbENvdW50ICsgMTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgY29sSW5kZXggPSAwOyBjb2xJbmRleCA8IHRoaXMuc2VsZWN0Q2hhbmdpbmcuY29sQ291bnQ7IGNvbEluZGV4KyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZGF0YUl0ZW0gPSB7fTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGYuam9pblBhcmFtLmNvbnRyb2xUeXBlID09PSAnY3Jvc3N0YWInKSB7IC8vIOS6pOWPieihqFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFyZ3Muc2hlZXRBcmVhID09PSAxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RDaGFuZ2luZy5yb3cgPSAwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbEluZGV4ICsgdGhpcy5zZWxlY3RDaGFuZ2luZy5jb2x1bW4gPCBzZWxmLmpvaW5QYXJhbS5yb3dIZWFkZXJDb2xJbmZvLmVuZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g6I635Y+W6KGM5qCH6aKY55qE5pWw5o2uXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gc2VsZi5qb2luUGFyYW0ucm93SGVhZGVyQ29sSW5mby5zdGFydDsgaSA8IHNlbGYuam9pblBhcmFtLnJvd0hlYWRlckNvbEluZm8uZW5kOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZSA9IGFyZ3Muc2hlZXQuZ2V0VmFsdWUocm93SW5kZXggKyB0aGlzLnNlbGVjdENoYW5naW5nLnJvdywgaSwgR0MuU3ByZWFkLlNoZWV0cy5TaGVldEFyZWEudmlld3BvcnQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5hbWUgPSBhcmdzLnNoZWV0LmdldFZhbHVlKHNlbGYuam9pblBhcmFtLmNvbEhlYWRlclJvd0luZm8uc3RhcnQsIGksIEdDLlNwcmVhZC5TaGVldHMuU2hlZXRBcmVhLmNvbEhlYWRlcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY29sSW5mbyA9IHNlbGYuam9pblBhcmFtLmNvbEluZm9zLmZpbmQoKHg6IGFueSkgPT4geC5kaW1lbnNpb24gPT09IDEgJiYgeC5uYW1lID09PSBuYW1lKS5iaW5kRmllbGQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YUl0ZW1bY29sSW5mb10gPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOiOt+WPluWIl+agh+mimOeahOaVsOaNrlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IHNlbGYuam9pblBhcmFtLmNvbEhlYWRlclJvd0luZm8uc3RhcnQ7IGkgPCBzZWxmLmpvaW5QYXJhbS5jb2xIZWFkZXJSb3dJbmZvLmVuZDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdmFsdWUgPSBhcmdzLnNoZWV0LmdldFZhbHVlKGksIGNvbEluZGV4ICsgdGhpcy5zZWxlY3RDaGFuZ2luZy5jb2x1bW4sIEdDLlNwcmVhZC5TaGVldHMuU2hlZXRBcmVhLmNvbEhlYWRlcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY29sSW5mbyA9IHNlbGYuam9pblBhcmFtLmNvbEluZm9zLmZpbHRlcigoeDogYW55KSA9PiB4LmRpbWVuc2lvbiA9PT0gMilbaSAtIHNlbGYuam9pblBhcmFtLmNvbEhlYWRlclJvd0luZm8uc3RhcnRdLmJpbmRGaWVsZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhSXRlbVtjb2xJbmZvXSA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g6I635Y+W5YC85qCH6aKY55qE5pWw5o2uXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZSA9IGFyZ3Muc2hlZXQuZ2V0VmFsdWUocm93SW5kZXggKyB0aGlzLnNlbGVjdENoYW5naW5nLnJvdywgY29sSW5kZXggKyB0aGlzLnNlbGVjdENoYW5naW5nLmNvbHVtbiwgR0MuU3ByZWFkLlNoZWV0cy5TaGVldEFyZWEudmlld3BvcnQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbmFtZSA9IGFyZ3Muc2hlZXQuZ2V0VmFsdWUoc2VsZi5qb2luUGFyYW0uY29sSGVhZGVyUm93SW5mby5lbmQsIGNvbEluZGV4ICsgdGhpcy5zZWxlY3RDaGFuZ2luZy5jb2x1bW4sIEdDLlNwcmVhZC5TaGVldHMuU2hlZXRBcmVhLmNvbEhlYWRlcik7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY29sSW5mbyA9IHNlbGYuam9pblBhcmFtLmNvbEluZm9zLmZpbmQoKHg6IGFueSkgPT4geC5kaW1lbnNpb24gPT09IDMgJiYgeC5uYW1lID09PSBuYW1lKS5iaW5kRmllbGQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhSXRlbVtjb2xJbmZvXSA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpbmthZ2VQYXJhbXMgPSBkYXRhSXRlbTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YUl0ZW1zLnB1c2goZGF0YUl0ZW0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyBzcHJlYWQg6IGU5Yqo5LqL5Lu2XHJcbiAgICAgICAgICAgIEV2ZW50QnVzLmRpc3BhdGNoKHF1ZXJ5SWQgKyAnX3NwcmVhZF9jaGFuZ2UnLCBsaW5rYWdlUGFyYW1zKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBzZXRTb3J0Q2VsbFR5cGUoc2hlZXQ6IGFueSwgc2NoZW1hOiBhbnksIHFkcFZpZXc6IGFueSkge1xyXG4gICAgICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIGNvbnN0IGhlYWRlciA9IHNoZWV0LmdldFJvd0NvdW50KEdDLlNwcmVhZC5TaGVldHMuU2hlZXRBcmVhLmNvbEhlYWRlcik7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaGVldC5nZXRDb2x1bW5Db3VudCgpOyBpKyspIHtcclxuICAgICAgICAgICAgY29uc3Qgc3BhbiA9IHNoZWV0LmdldFNwYW4oaGVhZGVyIC0gMSwgaSwgR0MuU3ByZWFkLlNoZWV0cy5TaGVldEFyZWEuY29sSGVhZGVyKTtcclxuICAgICAgICAgICAgaWYgKHNwYW4gJiYgc3Bhbi5yb3dDb3VudCA+IDEpIHtcclxuICAgICAgICAgICAgICAgIHNoZWV0LnNldENlbGxUeXBlKGhlYWRlciAtIHNwYW4ucm93Q291bnQsIGksIG5ldyBTb3J0Q2VsbFR5cGUoc2VsZi5jb2x1bW5Tb3J0LmJpbmQoc2VsZiksIHNjaGVtYSwgcWRwVmlldyksIEdDLlNwcmVhZC5TaGVldHMuU2hlZXRBcmVhLmNvbEhlYWRlcik7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBzaGVldC5zZXRDZWxsVHlwZShoZWFkZXIgLSAxLCBpLCBuZXcgU29ydENlbGxUeXBlKHNlbGYuY29sdW1uU29ydC5iaW5kKHNlbGYpLCBzY2hlbWEsIHFkcFZpZXcpLCBHQy5TcHJlYWQuU2hlZXRzLlNoZWV0QXJlYS5jb2xIZWFkZXIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG1lcmdlQ2VsbChzaGVldDogYW55LCBzY2hlbWE6IGFueSkge1xyXG4gICAgICAgIGlmICghdGhpcy5nZXRNZXJnZUNlbGwoc2NoZW1hKSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IGdyb3VwRmllbGRDYWNoZTEgPSBbXTtcclxuICAgICAgICB0aGlzLmdldEdyb3VwRmllbGQoZ3JvdXBGaWVsZENhY2hlMSwgc2NoZW1hKTtcclxuICAgICAgICBpZiAoZ3JvdXBGaWVsZENhY2hlMS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBjb2x1bW5Db3VudCA9IHNoZWV0LmdldENvbHVtbkNvdW50KCk7XHJcbiAgICAgICAgY29uc3Qgcm93Q291bnQgPSBzaGVldC5nZXRSb3dDb3VudCgpO1xyXG4gICAgICAgIGxldCBiZWdpblJvd0luZGV4ID0gMDtcclxuICAgICAgICBpZiAodGhpcy5nZXRTaG93RmlsdGVyUm93KHNjaGVtYSkpIHtcclxuICAgICAgICAgICAgYmVnaW5Sb3dJbmRleCA9IDE7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIOajgOafpeWPguaVsFxyXG4gICAgICAgIGlmIChjb2x1bW5Db3VudCA8IDEgfHwgKHJvd0NvdW50IC0gYmVnaW5Sb3dJbmRleCkgPCAxKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3Qgcm93U3BhbnMgPSB7fTtcclxuICAgICAgICBsZXQgY3VyQ2VsbFZhbHVlcyA9ICcnO1xyXG4gICAgICAgIGxldCBjdXJyZW50TmFtZSA9ICcnO1xyXG4gICAgICAgIGxldCBrZXkgPSAnJztcclxuICAgICAgICBmb3IgKGxldCByb3cgPSBiZWdpblJvd0luZGV4OyByb3cgPCByb3dDb3VudDsgcm93KyspIHtcclxuICAgICAgICAgICAgaWYgKHNoZWV0LmdldERhdGFJdGVtKHJvdykuaGFzT3duUHJvcGVydHkoXCJxZHBfZGF0YV9mbGFnXCIpICYmXHJcbiAgICAgICAgICAgICAgICAoXHJcbiAgICAgICAgICAgICAgICAgICAgKHNoZWV0LmdldERhdGFJdGVtKHJvdylbXCJxZHBfZGF0YV9mbGFnXCJdICsgJycpID09PSAoNCArICcnKVxyXG4gICAgICAgICAgICAgICAgICAgIHx8IChzaGVldC5nZXREYXRhSXRlbShyb3cpW1wicWRwX2RhdGFfZmxhZ1wiXSArICcnKSA9PT0gKDMgKyAnJylcclxuICAgICAgICAgICAgICAgICAgICB8fCAoc2hlZXQuZ2V0RGF0YUl0ZW0ocm93KVtcInFkcF9kYXRhX2ZsYWdcIl0gKyAnJykgPT09ICgyICsgJycpXHJcbiAgICAgICAgICAgICAgICAgICAgfHwgKHNoZWV0LmdldERhdGFJdGVtKHJvdylbXCJxZHBfZGF0YV9mbGFnXCJdICsgJycpID09PSAoMSArICcnKVxyXG4gICAgICAgICAgICAgICAgKSkge1xyXG4gICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZm9yIChsZXQgY29sID0gMDsgY29sIDwgY29sdW1uQ291bnQ7IGNvbCsrKSB7XHJcbiAgICAgICAgICAgICAgICBjdXJyZW50TmFtZSA9IHNoZWV0LmdldENlbGwocm93LCBjb2wpLnZhbHVlKCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoY29sID09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICBrZXkgPSBjdXJyZW50TmFtZTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAocm93U3BhbnMuaGFzT3duUHJvcGVydHkoa2V5KSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByb3dTcGFuc1trZXldLnJvd0NvdW50ID0gcm93IC0gcm93U3BhbnNba2V5XS5yb3cgKyAxO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJvd1NwYW5zW2tleV0gPSB7ICdyb3cnOiByb3csICdyb3dDb3VudCc6IDEsICdjb2wnOiBjb2wsICdjb2xDb3VudCc6IDEgfTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGN1ckNlbGxWYWx1ZXMgPSAnJztcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8PSBjb2w7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJDZWxsVmFsdWVzICs9IHNoZWV0LmdldENlbGwocm93LCBpKS52YWx1ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJDZWxsVmFsdWVzICs9IFwiXyZfXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChyb3dTcGFucy5oYXNPd25Qcm9wZXJ0eShjdXJDZWxsVmFsdWVzKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByb3dTcGFuc1tjdXJDZWxsVmFsdWVzXS5yb3dDb3VudCA9IHJvdyAtIHJvd1NwYW5zW2N1ckNlbGxWYWx1ZXNdLnJvdyArIDE7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcm93U3BhbnNbY3VyQ2VsbFZhbHVlc10gPSB7ICdyb3cnOiByb3csICdyb3dDb3VudCc6IDEsICdjb2wnOiBjb2wsICdjb2xDb3VudCc6IDEgfTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZvciAobGV0IGsgaW4gcm93U3BhbnMpIHtcclxuICAgICAgICAgICAgaWYgKChyb3dTcGFuc1trXS5yb3dDb3VudCA9PSAxICYmIHJvd1NwYW5zW2tdLmNvbENvdW50ID09IDEpID09IGZhbHNlKSB7XHJcbiAgICAgICAgICAgICAgICBzaGVldC5hZGRTcGFuKHJvd1NwYW5zW2tdLnJvdywgcm93U3BhbnNba10uY29sLCByb3dTcGFuc1trXS5yb3dDb3VudCwgcm93U3BhbnNba10uY29sQ291bnQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgY29sdW1uU29ydChpbmRleDogYW55LCBzaGVldDogYW55LCBzY2hlbWE6IGFueSwgcWRwVmlldzogYW55KSB7XHJcbiAgICAgICAgY29uc3QgbG9hZGluZyA9IHRoaXMubG9hZFNlcnZpY2Uuc2hvdyh7IGNvbnRhaW5lcjogJ2JvZHknIH0pO1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGhlYWRlciA9IHNoZWV0LmdldFJvd0NvdW50KEdDLlNwcmVhZC5TaGVldHMuU2hlZXRBcmVhLmNvbEhlYWRlcik7XHJcbiAgICAgICAgICAgIGlmIChzY2hlbWEgJiYgc2NoZW1hLnNjaGVtYVZhbHVlICYmIHNjaGVtYS5zY2hlbWFWYWx1ZS5jb2x1bW5PcHRpb24gJiYgc2NoZW1hLnNjaGVtYVZhbHVlLmNvbHVtbk9wdGlvbi5jb2xMaXN0ICYmIHNjaGVtYS5zY2hlbWFWYWx1ZS5jb2x1bW5PcHRpb24uY29sTGlzdC5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIGxldCBjZWxsID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHNwYW4gPSBzaGVldC5nZXRTcGFuKGhlYWRlciAtIDEsIGluZGV4LCBHQy5TcHJlYWQuU2hlZXRzLlNoZWV0QXJlYS5jb2xIZWFkZXIpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHNwYW4gJiYgc3Bhbi5yb3dDb3VudCA+IDEpIHtcclxuICAgICAgICAgICAgICAgICAgICBjZWxsID0gc2hlZXQuZ2V0Q2VsbChoZWFkZXIgLSBzcGFuLnJvd0NvdW50LCBpbmRleCwgR0MuU3ByZWFkLlNoZWV0cy5TaGVldEFyZWEuY29sSGVhZGVyKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2VsbCA9IHNoZWV0LmdldENlbGwoaGVhZGVyIC0gMSwgaW5kZXgsIEdDLlNwcmVhZC5TaGVldHMuU2hlZXRBcmVhLmNvbEhlYWRlcik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoc2NoZW1hICYmIHNjaGVtYS5pc1ByZWZhYiA9PT0gMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGxvYWRpbmcuY2xvc2UoKTtcclxuICAgICAgICAgICAgICAgICAgICBjZWxsLnRhZygwKTtcclxuICAgICAgICAgICAgICAgICAgICBzaGVldC5pbnZhbGlkYXRlTGF5b3V0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgc2hlZXQucmVwYWludCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMubXNnU2VydmljZS5pbmZvKHRoaXMubG9jYWxpemVTZXJ2aWNlLmdldFZhbHVlKCdzcHJlYWQubWVzc2FnZS52YWxpZGF0ZS5zb3J0JykpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChzY2hlbWEuaXNQcm90ZWN0ZWQgPT09IDEgfHwgc2NoZW1hLmlzUHJvdGVjdGVkID09PSAnMScpIHtcclxuICAgICAgICAgICAgICAgICAgICBsb2FkaW5nLmNsb3NlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgY2VsbC50YWcoMCk7XHJcbiAgICAgICAgICAgICAgICAgICAgc2hlZXQuaW52YWxpZGF0ZUxheW91dCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHNoZWV0LnJlcGFpbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm1zZ1NlcnZpY2UuaW5mbyh0aGlzLmxvY2FsaXplU2VydmljZS5nZXRWYWx1ZSgnaWRlQ21wLnNjaGVtYU1hbmFnZXIubWVzc2FnZS52YWxpZGF0ZS5pc1Byb3RlY3RlZCcpKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCBjb2xMaXN0ID0gc2NoZW1hLnNjaGVtYVZhbHVlLmNvbHVtbk9wdGlvbi5jb2xMaXN0O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcGFyYW1zID0ge1xyXG4gICAgICAgICAgICAgICAgICAgIGluZGV4OiBpbmRleCxcclxuICAgICAgICAgICAgICAgICAgICBjZWxsOiBjZWxsLFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbEluZGV4OiAwLFxyXG4gICAgICAgICAgICAgICAgICAgIHNvcnRJbmZvOiB7IHNvcnRJbmRleDogMCwgYmluZEZpZWxkOiAnJyB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGlzVGV4dDogW11cclxuICAgICAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOnByZWZlci1mb3Itb2ZcclxuICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY29sTGlzdC5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVjdXJzaXZlQ29sdW1uU29ydEluZGV4KGNvbExpc3RbaV0sIG51bGwsIHBhcmFtcyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6cHJlZmVyLWZvci1vZlxyXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb2xMaXN0Lmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZWN1cnNpdmVDb2x1bW5Tb3J0KGNvbExpc3RbaV0sIG51bGwsIHBhcmFtcyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAocGFyYW1zLmlzVGV4dC5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICBsb2FkaW5nLmNsb3NlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgY2VsbC50YWcoMCk7XHJcbiAgICAgICAgICAgICAgICAgICAgc2hlZXQuaW52YWxpZGF0ZUxheW91dCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHNoZWV0LnJlcGFpbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm1zZ1NlcnZpY2Uud2FybmluZyhwYXJhbXMuaXNUZXh0WzBdICsgJyAnICsgdGhpcy5sb2NhbGl6ZVNlcnZpY2UuZ2V0VmFsdWUoJ2lkZUNtcC5zY2hlbWFNYW5hZ2VyLm1lc3NhZ2UudmFsaWRhdGUudGV4dENvbHVtblNvcnQnKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgbmV3U2NoZW1hID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShzY2hlbWEpKTtcclxuICAgICAgICAgICAgICAgIG5ld1NjaGVtYS5zY2hlbWFWYWx1ZS5jb2x1bW5PcHRpb24uY29sTGlzdCA9IGNvbExpc3Q7XHJcbiAgICAgICAgICAgICAgICBuZXdTY2hlbWEuc2NoZW1hVmFsdWUgPSBKU09OLnN0cmluZ2lmeShuZXdTY2hlbWEuc2NoZW1hVmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zY2hlbWFNYW5hZ2VyLnNhdmVTY2hlbWEoeyBzY2hlbWE6IEpTT04uc3RyaW5naWZ5KG5ld1NjaGVtYSksIGdyb3VwVHlwZTogcWRwVmlldy5ncm91cFR5cGUgfSwgJycpLnN1YnNjcmliZShkYXRhID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBsb2FkaW5nLmNsb3NlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgcWRwVmlldy5pbml0U3ByZWFkKHFkcFZpZXcucXVlcnlJZCwgbmV3U2NoZW1hLmlkLCBxZHBWaWV3LmNvbnRyb2xUeXBlLCBxZHBWaWV3LnFvTWFuYWdlckNvZGUsIHFkcFZpZXcucGFnZUluZGV4LCBxZHBWaWV3LnF1ZXJ5UmVsYXRpdmVVcmwsIHFkcFZpZXcuY29uZGl0aW9uRXhwcmVzc2lvbiwgcWRwVmlldy5ncm91cFR5cGUsIHFkcFZpZXcudm9JZCwgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICB9LCAoZXJyb3I6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGxvYWRpbmcuY2xvc2UoKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmZvcm1FcnJvclNlcnZpY2UuZXhjZXB0aW9uKGVycm9yLk1lc3NhZ2UsIGVycm9yKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgbG9hZGluZy5jbG9zZSgpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5tc2dTZXJ2aWNlLmluZm8odGhpcy5sb2NhbGl6ZVNlcnZpY2UuZ2V0VmFsdWUoJ3NwcmVhZC5tZXNzYWdlLnZhbGlkYXRlLnNvcnQnKSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgIGxvYWRpbmcuY2xvc2UoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSByZWN1cnNpdmVDb2x1bW5Tb3J0SW5kZXgoY29sLCBjb2xMaXN0LCBwYXJhbXMpIHtcclxuICAgICAgICBpZiAoY29sTGlzdCA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIGlmIChjb2wuY2hpbGRMaXN0ICYmIGNvbC5jaGlsZExpc3QubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJlY3Vyc2l2ZUNvbHVtblNvcnRJbmRleChudWxsLCBjb2wuY2hpbGRMaXN0LCBwYXJhbXMpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaWYgKGNvbC5zb3J0ICE9PSAwICYmIGNvbFsnc29ydEluZGV4J10gIT0gbnVsbCAmJiBjb2xbJ3NvcnRJbmRleCddICE9PSB1bmRlZmluZWQgJiYgY29sLnNvcnRJbmRleCA+IHBhcmFtcy5zb3J0SW5mby5zb3J0SW5kZXgpIHtcclxuICAgICAgICAgICAgICAgICAgICBwYXJhbXMuc29ydEluZm8uc29ydEluZGV4ID0gY29sWydzb3J0SW5kZXgnXTtcclxuICAgICAgICAgICAgICAgICAgICBwYXJhbXMuc29ydEluZm8uYmluZEZpZWxkID0gY29sLmJpbmRGaWVsZDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpwcmVmZXItZm9yLW9mXHJcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY29sTGlzdC5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgaWYgKGNvbExpc3RbaV0uY2hpbGRMaXN0ICYmIGNvbExpc3RbaV0uY2hpbGRMaXN0Lmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVjdXJzaXZlQ29sdW1uU29ydEluZGV4KG51bGwsIGNvbExpc3RbaV0uY2hpbGRMaXN0LCBwYXJhbXMpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoY29sTGlzdFtpXS5zb3J0ICE9PSAwICYmIGNvbExpc3RbaV1bJ3NvcnRJbmRleCddICE9IG51bGwgJiYgY29sTGlzdFtpXVsnc29ydEluZGV4J10gIT09IHVuZGVmaW5lZCAmJiBjb2xMaXN0W2ldLnNvcnRJbmRleCA+IHBhcmFtcy5zb3J0SW5mby5zb3J0SW5kZXgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1zLnNvcnRJbmZvLnNvcnRJbmRleCA9IGNvbExpc3RbaV1bJ3NvcnRJbmRleCddO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwYXJhbXMuc29ydEluZm8uYmluZEZpZWxkID0gY29sTGlzdFtpXS5iaW5kRmllbGQ7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgcmVjdXJzaXZlQ29sdW1uU29ydChjb2wsIGNvbExpc3QsIHBhcmFtcykge1xyXG4gICAgICAgIGlmIChjb2xMaXN0ID09IG51bGwpIHtcclxuICAgICAgICAgICAgaWYgKGNvbC5jaGlsZExpc3QgJiYgY29sLmNoaWxkTGlzdC5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucmVjdXJzaXZlQ29sdW1uU29ydChudWxsLCBjb2wuY2hpbGRMaXN0LCBwYXJhbXMpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaWYgKHBhcmFtcy5jb2xJbmRleCA9PT0gcGFyYW1zLmluZGV4KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbC50eXBlICYmIGNvbC50eXBlLnRvTG93ZXJDYXNlKCkgPT09ICd0ZXh0Jykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwYXJhbXMuaXNUZXh0LnB1c2goY29sLmJpbmRGaWVsZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChwYXJhbXMuY2VsbC50YWcoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbC5zb3J0ID0gMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xbJ3NvcnRJbmRleCddID0gMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2wuc29ydCA9IDE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sWydzb3J0SW5kZXgnXSA9IGNvbFsnc29ydEluZGV4J10gIT09IG51bGwgJiYgY29sWydzb3J0SW5kZXgnXSAhPT0gdW5kZWZpbmVkICYmIGNvbFsnc29ydEluZGV4J10gPiAwID8gY29sWydzb3J0SW5kZXgnXSA6IGNvbC5iaW5kRmllbGQgPT09IHBhcmFtcy5zb3J0SW5mby5iaW5kRmllbGQgPyBwYXJhbXMuc29ydEluZm8uc29ydEluZGV4IDogcGFyYW1zLnNvcnRJbmZvLnNvcnRJbmRleCArIDE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sLnNvcnQgPSAyO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbFsnc29ydEluZGV4J10gPSBjb2xbJ3NvcnRJbmRleCddICE9PSBudWxsICYmIGNvbFsnc29ydEluZGV4J10gIT09IHVuZGVmaW5lZCAmJiBjb2xbJ3NvcnRJbmRleCddID4gMCA/IGNvbFsnc29ydEluZGV4J10gOiBjb2wuYmluZEZpZWxkID09PSBwYXJhbXMuc29ydEluZm8uYmluZEZpZWxkID8gcGFyYW1zLnNvcnRJbmZvLnNvcnRJbmRleCA6IHBhcmFtcy5zb3J0SW5mby5zb3J0SW5kZXggKyAxO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcGFyYW1zLmNvbEluZGV4Kys7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6cHJlZmVyLWZvci1vZlxyXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvbExpc3QubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGlmIChjb2xMaXN0W2ldLmNoaWxkTGlzdCAmJiBjb2xMaXN0W2ldLmNoaWxkTGlzdC5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlY3Vyc2l2ZUNvbHVtblNvcnQobnVsbCwgY29sTGlzdFtpXS5jaGlsZExpc3QsIHBhcmFtcyk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChwYXJhbXMuY29sSW5kZXggPT09IHBhcmFtcy5pbmRleCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29sTGlzdFtpXS50eXBlICYmIGNvbExpc3RbaV0udHlwZS50b0xvd2VyQ2FzZSgpID09PSAndGV4dCcpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtcy5pc1RleHQucHVzaChjb2xMaXN0W2ldLmJpbmRGaWVsZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKHBhcmFtcy5jZWxsLnRhZygpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xMaXN0W2ldLnNvcnQgPSAwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xMaXN0W2ldWydzb3J0SW5kZXgnXSA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sTGlzdFtpXS5zb3J0ID0gMTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sTGlzdFtpXVsnc29ydEluZGV4J10gPSBjb2xMaXN0W2ldWydzb3J0SW5kZXgnXSAhPT0gbnVsbCAmJiBjb2xMaXN0W2ldWydzb3J0SW5kZXgnXSAhPT0gdW5kZWZpbmVkICYmIGNvbExpc3RbaV1bJ3NvcnRJbmRleCddID4gMCA/IGNvbExpc3RbaV1bJ3NvcnRJbmRleCddIDogY29sTGlzdFtpXS5iaW5kRmllbGQgPT09IHBhcmFtcy5zb3J0SW5mby5iaW5kRmllbGQgPyBwYXJhbXMuc29ydEluZm8uc29ydEluZGV4IDogcGFyYW1zLnNvcnRJbmZvLnNvcnRJbmRleCArIDE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sTGlzdFtpXS5zb3J0ID0gMjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sTGlzdFtpXVsnc29ydEluZGV4J10gPSBjb2xMaXN0W2ldWydzb3J0SW5kZXgnXSAhPT0gbnVsbCAmJiBjb2xMaXN0W2ldWydzb3J0SW5kZXgnXSAhPT0gdW5kZWZpbmVkICYmIGNvbExpc3RbaV1bJ3NvcnRJbmRleCddID4gMCA/IGNvbExpc3RbaV1bJ3NvcnRJbmRleCddIDogY29sTGlzdFtpXS5iaW5kRmllbGQgPT09IHBhcmFtcy5zb3J0SW5mby5iaW5kRmllbGQgPyBwYXJhbXMuc29ydEluZm8uc29ydEluZGV4IDogcGFyYW1zLnNvcnRJbmZvLnNvcnRJbmRleCArIDE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHBhcmFtcy5jb2xJbmRleCsrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgcmVjdXJzaXZlSXNSZWRDb2x1bW4oY29sLCBjb2xMaXN0LCBwYXJhbXMpIHtcclxuICAgICAgICBpZiAoY29sTGlzdCA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIGlmIChjb2wuY2hpbGRMaXN0ICYmIGNvbC5jaGlsZExpc3QubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJlY3Vyc2l2ZUlzUmVkQ29sdW1uKG51bGwsIGNvbC5jaGlsZExpc3QsIHBhcmFtcyk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoY29sLmlzUmVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcGFyYW1zLmlzUmVkQ29sdW1ucy5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29sSW5kZXg6IHBhcmFtcy5jb2xJbmRleFxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcGFyYW1zLmNvbEluZGV4Kys7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6cHJlZmVyLWZvci1vZlxyXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvbExpc3QubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGlmIChjb2xMaXN0W2ldLmNoaWxkTGlzdCAmJiBjb2xMaXN0W2ldLmNoaWxkTGlzdC5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlY3Vyc2l2ZUlzUmVkQ29sdW1uKG51bGwsIGNvbExpc3RbaV0uY2hpbGRMaXN0LCBwYXJhbXMpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoY29sTGlzdFtpXS5pc1JlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwYXJhbXMuaXNSZWRDb2x1bW5zLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sSW5kZXg6IHBhcmFtcy5jb2xJbmRleFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgcGFyYW1zLmNvbEluZGV4Kys7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBpc051bWJlcih2YWwpIHtcclxuICAgICAgICBpZiAocGFyc2VGbG9hdCh2YWwpLnRvU3RyaW5nKCkgPT0gXCJOYU5cIikge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59Il19