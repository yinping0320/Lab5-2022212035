/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { EventBus, RtfServices } from "@qdp/common";
import { filter } from 'lodash-es';
export class SpreadStyleUtils {
    /**
     * @param {?} _queryId
     * @param {?} _controlType
     * @param {?=} _jointsearchInfoList
     * @param {?=} _serviceCache
     */
    constructor(_queryId, _controlType, _jointsearchInfoList, _serviceCache) {
        this.dataStyleArray = [];
        this.dataRowHeightArray = [];
        this.dataColInfoArray = [];
        this.footerStyleArray = [];
        this.footerRowHeightArray = [];
        this.footerSpansArray = [];
        this.footerDataArray = [];
        this.hyperLinkQuery = {};
        this.autoFitColumnIndex = 0;
        this.valueHeaderRowCount = 0; // 值维度数量
        // 值维度数量
        this.valueHeaderRowArray = [];
        this.rowHeadersColumnCount = 0; // 行标题列数
        // 行标题列数
        this.rowHeaderRowArray = [];
        this.joinParam = {};
        this.queryId = _queryId;
        this.type = _controlType;
        this.jointsearchInfoList = _jointsearchInfoList;
        this.cache = _serviceCache.cacheService;
        this.loadService = _serviceCache.loadingService;
        this.msgService = _serviceCache.msgService;
        this.localizeService = _serviceCache.localizeService;
        this.schemaManager = _serviceCache.schemaManagerService;
        this.formErrorService = _serviceCache.formErrorService;
        this.lcpService = _serviceCache.lcpService;
    }
    /**
     * @param {?} schema
     * @param {?} sheet
     * @return {?}
     */
    setAutoFitColumn(schema, sheet) {
        if (schema && schema.schemaValue && schema.schemaValue.columnOption && schema.schemaValue.columnOption.colList && schema.schemaValue.columnOption.colList.length) {
            this.autoFitColumnIndex = 0;
            schema.schemaValue.columnOption.colList.forEach((/**
             * @param {?} col
             * @return {?}
             */
            (col) => {
                this.recursionAutoFitColumn(col, null, sheet);
            }));
        }
    }
    /**
     * @private
     * @param {?} column
     * @param {?} childList
     * @param {?} sheet
     * @return {?}
     */
    recursionAutoFitColumn(column, childList, sheet) {
        if (column) {
            if (column.childList && column.childList.length) {
                this.recursionAutoFitColumn(null, column.childList, sheet);
            }
            else {
                if (column.autoFit) {
                    sheet.autoFitColumn(this.autoFitColumnIndex);
                }
                this.autoFitColumnIndex += 1;
            }
        }
        else {
            childList.forEach((/**
             * @param {?} col
             * @return {?}
             */
            (col) => {
                if (col.childList && col.childList.length) {
                    this.recursionAutoFitColumn(null, col.childList, sheet);
                }
                else {
                    if (col.autoFit) {
                        sheet.autoFitColumn(this.autoFitColumnIndex);
                    }
                    this.autoFitColumnIndex += 1;
                }
            }));
        }
    }
    /**
     * @param {?} sheet
     * @return {?}
     */
    cacheStyle(sheet) {
        this.dataStyleArray = [];
        this.dataRowHeightArray = [];
        this.dataColInfoArray = [];
        this.footerStyleArray = [];
        this.footerRowHeightArray = [];
        this.footerSpansArray = [];
        this.footerDataArray = [];
        // 缓存区域样式信息
        for (let r = 0; r < sheet.getRowCount(); r++) {
            /** @type {?} */
            const columnStyleArray = new Array();
            /** @type {?} */
            const dataArray = new Array();
            for (let c = 0; c < sheet.getColumnCount(); c++) {
                if (r === 0) {
                    /** @type {?} */
                    let formatter = '';
                    if (sheet.getFormatter(r, c, GC.Spread.Sheets.SheetArea.viewport)) {
                        formatter = sheet.getFormatter(r, c, GC.Spread.Sheets.SheetArea.viewport);
                    }
                    /** @type {?} */
                    const colHeaderCount = sheet.getRowCount(GC.Spread.Sheets.SheetArea.colHeader);
                    /** @type {?} */
                    const colInfo = {
                        name: sheet.getCell(r, c, GC.Spread.Sheets.SheetArea.viewport).value(),
                        size: sheet.getColumnWidth(c, GC.Spread.Sheets.SheetArea.viewport),
                        visible: sheet.getColumnVisible(c, GC.Spread.Sheets.SheetArea.viewport),
                        resizable: sheet.getColumnResizable(c, GC.Spread.Sheets.SheetArea.viewport),
                        formatter: formatter.indexOf('&') >= 0 ? new MyNumFormatter(formatter) : formatter,
                        displayName: sheet.getCell((colHeaderCount - 1), c, GC.Spread.Sheets.SheetArea.colHeader).value()
                    };
                    this.dataColInfoArray.push(colInfo);
                }
                /** @type {?} */
                let style = sheet.getStyle(r, c, GC.Spread.Sheets.SheetArea.viewport);
                if (style == null) {
                    style = new GC.Spread.Sheets.Style();
                    style.locked = true;
                }
                else {
                    style.locked = true;
                }
                if (style && style.formatter && style.formatter.indexOf('&') >= 0) {
                    style.formatter = new MyNumFormatter(style.formatter);
                }
                columnStyleArray.push(style);
                /** @type {?} */
                const text = sheet.getValue(r, c, GC.Spread.Sheets.SheetArea.viewport)
                    || sheet.getText(r, c, GC.Spread.Sheets.SheetArea.viewport)
                    || '';
                dataArray.push(text);
            }
            if (r === 0) {
                this.dataRowHeightArray.push(sheet.getRowHeight(r));
                this.dataStyleArray.push(columnStyleArray);
            }
            else {
                this.footerRowHeightArray.push(sheet.getRowHeight(r));
                this.footerStyleArray.push(columnStyleArray);
                this.footerDataArray.push(dataArray);
            }
        }
        // 缓存span
        /** @type {?} */
        const spans = sheet.getSpans();
        if (spans && spans.length) {
            // tslint:disable-next-line:prefer-for-of
            for (let i = 0; i < spans.length; i++) {
                if (spans[i].row > 0) {
                    this.footerSpansArray.push(spans[i]);
                }
            }
        }
        sheet.deleteRows(1, sheet.getRowCount() - 1);
    }
    /**
     * @param {?} sheet
     * @param {?} schema
     * @param {?=} showZero
     * @return {?}
     */
    applyStyle(sheet, schema, showZero) {
        /** @type {?} */
        let rowCount = sheet.getRowCount();
        /** @type {?} */
        const colCount = sheet.getColumnCount();
        /** @type {?} */
        const footerCount = this.footerRowHeightArray.length;
        sheet.addRows(rowCount, footerCount);
        /** @type {?} */
        let index = 0;
        /** @type {?} */
        const groupFieldCache = [];
        /** @type {?} */
        const groupFieldValueCache = [];
        /** @type {?} */
        const groupRowCache = [];
        /** @type {?} */
        const groupTreeLevel = {};
        /** @type {?} */
        const columns = sheet.toJSON().columns;
        this.getGroupField(groupFieldCache, schema);
        /** @type {?} */
        const formatFieldCache = [];
        this.getFormatField(formatFieldCache, schema);
        this.getIsRedColumns(formatFieldCache, schema);
        /** @type {?} */
        const isRedColumns = {
            colIndex: 0,
            isRedColumns: []
        };
        this.getIsRedColumns(schema, isRedColumns);
        /** @type {?} */
        const sheetColumns = sheet.toJSON().columns;
        for (let r = 0; r < (rowCount + footerCount); r++) {
            if (formatFieldCache && formatFieldCache.length && r < rowCount) {
                formatFieldCache.forEach((/**
                 * @param {?} item
                 * @return {?}
                 */
                (item) => {
                    /** @type {?} */
                    const dataItem = sheet.getDataItem(r);
                    /** @type {?} */
                    const precision = dataItem[item.formatField] - 0;
                    /** @type {?} */
                    let numberFormat = item.formatter && (item.formatter.indexOf('#,###') >= 0 || item.formatter.indexOf('#,##0') >= 0) ? '#,##0.' : '0.';
                    if (this.isNumber(precision)) {
                        for (let p = 0; p < precision; p++) {
                            numberFormat += '0';
                        }
                    }
                    /** @type {?} */
                    const formatColIndex = sheetColumns.findIndex((/**
                     * @param {?} el
                     * @return {?}
                     */
                    (el) => el.name == item.sourceField));
                    if (formatColIndex >= 0 && numberFormat != '0.' && numberFormat != '#,##0.') {
                        sheet.getCell(r, formatColIndex).formatter(numberFormat);
                    }
                }));
            }
            for (let c = 0; c < colCount; c++) {
                if (r === 0 && !sheet.getColumnVisible(index)) {
                    index += 1;
                }
                if (r >= rowCount) {
                    if (c === 0) {
                        sheet.setStyle(r, c, this.footerStyleArray[r - rowCount][c]);
                        if (this.footerDataArray && this.footerDataArray.length) {
                            sheet.setValue(r, c, this.footerDataArray[r - rowCount][c]);
                        }
                        sheet.setRowHeight(r, this.footerRowHeightArray[r - rowCount]);
                        if (this.footerSpansArray && this.footerSpansArray.length) {
                            sheet.addSpan(r, this.footerSpansArray[0].col, this.footerSpansArray[0].rowCount, this.footerSpansArray[0].colCount);
                        }
                    }
                }
                else {
                    /** @type {?} */
                    const formatter = sheet.getFormatter(r, c, GC.Spread.Sheets.SheetArea.viewport);
                    if (formatter && formatter.indexOf && formatter.indexOf('/') >= 0 && formatter.indexOf(';') >= 0) {
                        /** @type {?} */
                        const cellValue = this.logicFormat(formatter, sheet.getValue(r, c));
                        sheet.setText(r, c, cellValue);
                    }
                    if (formatter && typeof formatter === 'string' && (formatter.indexOf('yy') >= 0 || formatter.indexOf('MM') >= 0 || formatter.indexOf('dd') >= 0 || formatter.indexOf('HH') >= 0 || formatter.indexOf('mm') >= 0 || formatter.indexOf('ss') >= 0)) {
                        if (sheet.getDataItem(r).hasOwnProperty("qdp_data_flag")) {
                            sheet.setFormatter(r, c, '');
                        }
                    }
                    if (isRedColumns.isRedColumns.findIndex((/**
                     * @param {?} el
                     * @return {?}
                     */
                    el => el.colIndex == c)) >= 0 && this.isNumber(sheet.getCell(r, c).value()) && (sheet.getCell(r, c).value() - 0 < 0)) {
                        sheet.getCell(r, c).foreColor('red');
                    }
                    if (!showZero) {
                        if (!showZero && columns && columns.length) {
                            if (columns[c].name === 'treeLevel' || columns[c].name === 'isDetail') {
                                continue;
                            }
                            if (sheet.getCell(r, c).value() === 0 || sheet.getCell(r, c).value() == '0') {
                                sheet.getCell(r, c).value('');
                            }
                        }
                    }
                }
            }
            if (r < rowCount) {
                // 设置行高
                sheet.setRowHeight(r, this.dataRowHeightArray[0]);
                if (this.type === 'treelist') {
                    /** @type {?} */
                    const level = sheet.getDataItem(r)['treeLevel'];
                    /** @type {?} */
                    const isDetail = sheet.getDataItem(r)['isDetail'];
                    sheet.setCellType(r, index, new TreeCellType(null, false, level, isDetail));
                    sheet.getStyle(r, index).hAlign = 0;
                    sheet.getStyle(r, index).textIndent = level + 2;
                    for (let i = 0; i <= level; i++) {
                        sheet.rowOutlines.group(r, 1);
                    }
                }
                else if (this.type === 'list' && groupFieldCache.length) {
                    /** @type {?} */
                    let filterCondition = {};
                    if (groupRowCache.findIndex((/**
                     * @param {?} x
                     * @return {?}
                     */
                    x => x === r)) >= 0) {
                        continue;
                    }
                    for (let c = 0; c < colCount; c++) {
                        if (sheet.getDataItem(r).hasOwnProperty("qdp_data_flag") && (sheet.getDataItem(r)["qdp_data_flag"] + '') === (4 + '')) {
                            if (sheet.getFormatter(r, c) && (sheet.getFormatter(r, c).toString().indexOf('y') >= 0 || sheet.getFormatter(r, c).toString().indexOf('d') >= 0 || sheet.getFormatter(r, c).toString().indexOf('M') >= 0)) {
                                sheet.setFormatter(r, c, '');
                            }
                        }
                    }
                    /** @type {?} */
                    const addRowsCache = [];
                    for (let i = 0; i < groupFieldCache.length; i++) {
                        /** @type {?} */
                        const addRowIndex = r + addRowsCache.length;
                        // const groupField = groupFieldCache[i];
                        /** @type {?} */
                        const fieldIndex = this.dataColInfoArray.findIndex((/**
                         * @param {?} x
                         * @return {?}
                         */
                        x => x.name === groupFieldCache[i]));
                        filterCondition = {};
                        for (let f = 0; f <= i; f++) {
                            filterCondition[groupFieldCache[f]] = sheet.getDataItem(addRowIndex)[groupFieldCache[f]];
                        }
                        /** @type {?} */
                        const filterResult = filter(groupFieldValueCache, filterCondition);
                        if ((!filterResult || !filterResult.length) && !sheet.getDataItem(addRowIndex).hasOwnProperty("qdp_data_flag")) {
                            // const groupFieldValue = {};
                            // groupFieldValue[groupField] = filterCondition[groupField];
                            groupFieldValueCache.push(filterCondition);
                            /** @type {?} */
                            const style = this.dataStyleArray[0][fieldIndex];
                            style.hAlign = 0;
                            style.cellType = null;
                            style.backColor = '#F4F7FA';
                            sheet.addRows(addRowIndex, 1);
                            sheet.setRowHeight(addRowIndex, this.dataRowHeightArray[0]);
                            sheet.setStyle(addRowIndex, index, style);
                            sheet.getCell(addRowIndex, index).value(filterCondition[groupFieldCache[i]]);
                            sheet.addSpan(addRowIndex, index, 1, (colCount - index));
                            sheet.getCell(addRowIndex, index).textIndent((i + 1) * 2);
                            groupTreeLevel[addRowIndex + ''] = { treeLevel: i, isDetail: 0 };
                            if (i === (groupFieldCache.length - 1)) {
                                groupTreeLevel[(addRowIndex + 1) + ''] = { treeLevel: groupFieldCache.length, isDetail: 1 };
                            }
                            rowCount += 1;
                            addRowsCache.push(i);
                            groupRowCache.push(addRowIndex);
                        }
                        else {
                            if (sheet.getDataItem(addRowIndex).hasOwnProperty("qdp_data_flag") && (sheet.getDataItem(addRowIndex)["qdp_data_flag"] + '') === (3 + '')) {
                                continue;
                            }
                            if (i === (groupFieldCache.length - 1)) {
                                groupTreeLevel[(addRowIndex + 1) + ''] = { treeLevel: groupFieldCache.length, isDetail: 1 };
                            }
                        }
                    }
                }
            }
        }
        for (let r = 0; r < rowCount; r++) {
            if (!groupTreeLevel.hasOwnProperty(r)) {
                break;
            }
            for (let t = 0; t <= groupTreeLevel[r + ''].treeLevel; t++) {
                sheet.rowOutlines.group(r, 1);
            }
            sheet.setCellType(r, index, new TreeCellType(null, false, groupTreeLevel[r + ''].treeLevel, groupTreeLevel[r + ''].isDetail));
        }
        if (this.type !== 'crosstab' && this.getShowFilterRow(schema)) {
            this.filterRow(sheet);
        }
    }
    /**
     * @param {?} groupColCache
     * @param {?} schema
     * @return {?}
     */
    getGroupField(groupColCache, schema) {
        if (schema && schema.schemaValue && schema.schemaValue.columnOption && schema.schemaValue.columnOption.colList && schema.schemaValue.columnOption.colList.length) {
            this.autoFitColumnIndex = 0;
            schema.schemaValue.columnOption.colList.forEach((/**
             * @param {?} col
             * @return {?}
             */
            (col) => {
                this.recursionGetGroupColumn(groupColCache, col, null);
            }));
        }
    }
    /**
     * @param {?} schema
     * @param {?} params
     * @return {?}
     */
    getIsRedColumns(schema, params) {
        if (schema && schema.schemaValue && schema.schemaValue.columnOption && schema.schemaValue.columnOption.colList && schema.schemaValue.columnOption.colList.length) {
            schema.schemaValue.columnOption.colList.forEach((/**
             * @param {?} col
             * @return {?}
             */
            (col) => {
                this.recursiveIsRedColumn(col, null, params);
            }));
        }
    }
    /**
     * @param {?} fieldCache
     * @param {?} schema
     * @return {?}
     */
    getFormatField(fieldCache, schema) {
        if (schema && schema.schemaValue && schema.schemaValue.columnOption && schema.schemaValue.columnOption.colList && schema.schemaValue.columnOption.colList.length) {
            this.autoFitColumnIndex = 0;
            schema.schemaValue.columnOption.colList.forEach((/**
             * @param {?} col
             * @return {?}
             */
            (col) => {
                this.recursionGetFormatColumn(fieldCache, col, null);
            }));
        }
    }
    /**
     * @param {?} schema
     * @return {?}
     */
    getShowHeaderSort(schema) {
        try {
            if (schema && schema.schemaValue && schema.schemaValue.otherOption && schema.schemaValue.otherOption.showHeaderSort != null && schema.schemaValue.otherOption.showHeaderSort != undefined) {
                return schema.schemaValue.otherOption.showHeaderSort;
            }
            return true;
        }
        catch (e) {
            return true;
        }
    }
    /**
     * @param {?} schema
     * @return {?}
     */
    getShowFilterRow(schema) {
        try {
            if (schema && schema.schemaValue && schema.schemaValue.otherOption && schema.schemaValue.otherOption.showFilterRow != null && schema.schemaValue.otherOption.showFilterRow != undefined) {
                return schema.schemaValue.otherOption.showFilterRow;
            }
            return true;
        }
        catch (e) {
            return true;
        }
    }
    /**
     * @param {?} schema
     * @return {?}
     */
    getMergeCell(schema) {
        try {
            if (schema && schema.schemaValue && schema.schemaValue.otherOption && schema.schemaValue.otherOption.mergeCell != null && schema.schemaValue.otherOption.mergeCell != undefined) {
                return schema.schemaValue.otherOption.mergeCell;
            }
            return false;
        }
        catch (e) {
            return false;
        }
    }
    /**
     * @private
     * @param {?} fieldCache
     * @param {?} column
     * @param {?} childList
     * @return {?}
     */
    recursionGetFormatColumn(fieldCache, column, childList) {
        if (column) {
            if (column.childList && column.childList.length) {
                this.recursionGetFormatColumn(fieldCache, null, column.childList);
            }
            else {
                if (column.formatType == 1 && column.formatField) {
                    fieldCache.push({ sourceField: column.bindField, formatField: column.formatField, formatter: column.formattor });
                }
            }
        }
        else {
            childList.forEach((/**
             * @param {?} col
             * @return {?}
             */
            (col) => {
                if (col.childList && col.childList.length) {
                    this.recursionGetFormatColumn(fieldCache, null, col.childList);
                }
                else {
                    if (col.formatType == 1 && col.formatField) {
                        fieldCache.push({ sourceField: col.bindField, formatField: col.formatField, formatter: col.formattor });
                    }
                }
            }));
        }
    }
    /**
     * @private
     * @param {?} groupColCache
     * @param {?} column
     * @param {?} childList
     * @return {?}
     */
    recursionGetGroupColumn(groupColCache, column, childList) {
        if (column) {
            if (column.childList && column.childList.length) {
                this.recursionGetGroupColumn(groupColCache, null, column.childList);
            }
            else {
                if (column.isGroup) {
                    groupColCache.push(column.bindField);
                }
            }
        }
        else {
            childList.forEach((/**
             * @param {?} col
             * @return {?}
             */
            (col) => {
                if (col.childList && col.childList.length) {
                    this.recursionGetGroupColumn(groupColCache, null, col.childList);
                }
                else {
                    if (col.isGroup) {
                        groupColCache.push(col.bindField);
                    }
                }
            }));
        }
    }
    /**
     * @param {?} formattor
     * @param {?} cellValue
     * @return {?}
     */
    logicFormat(formattor, cellValue) {
        /** @type {?} */
        const str = formattor.split(';');
        /** @type {?} */
        const real = str[0].split('/');
        /** @type {?} */
        const disp = str[1].split('/');
        for (let i = 0; i < real.length; i++) {
            // tslint:disable-next-line:triple-equals
            if (real[i] == (cellValue + '')) {
                cellValue = disp[i];
                break;
            }
        }
        return cellValue;
    }
    /**
     * @param {?} sheet
     * @return {?}
     */
    filterRow(sheet) {
        sheet.addRows(0, 1);
        for (let i = 0; i < sheet.getRowCount(); i++) {
            sheet.getCell(i, 0, GC.Spread.Sheets.SheetArea.rowHeader).value(i == 0 ? '' : i);
        }
        sheet.setRowHeight(0, this.dataRowHeightArray[0]);
        for (let i = 0; i < sheet.getColumnCount(); i++) {
            /** @type {?} */
            const s = new GC.Spread.Sheets.Style();
            s.fromJSON(this.dataStyleArray[0][i].toJSON());
            s.locked = false;
            s.formatter = '@';
            sheet.setStyle(0, i, s);
            sheet.setCellType(0, i, new FilterCellType(sheet));
        }
        /** @type {?} */
        const filter = new GC.Spread.Sheets.Filter.HideRowFilter(new GC.Spread.Sheets.Range(1, 0, sheet.getRowCount(), sheet.getColumnCount()));
        sheet.rowFilter(filter);
        filter.filterButtonVisible(false);
    }
    /**
     * @param {?} spread
     * @param {?} sheet
     * @return {?}
     */
    linkField(spread, sheet) {
        try {
            /** @type {?} */
            const self = this;
            /** @type {?} */
            const rowCount = sheet.getRowCount();
            /** @type {?} */
            const colCount = sheet.getColumnCount();
            // const footerCount = this.footerRowHeightArray.length;
            for (let r = 1; r < (rowCount); r++) {
                /** @type {?} */
                const dataItem = sheet.getDataItem(r);
                if (dataItem.hasOwnProperty('dynamicPropSet') && dataItem.dynamicPropSet.hasOwnProperty('qdp_data_flag')) {
                    continue;
                }
                for (let c = 0; c < colCount; c++) {
                    /** @type {?} */
                    const joinSearch = JSON.parse(this.jointsearchInfoList['joinSearch']);
                    // tslint:disable-next-line:prefer-for-of
                    for (let i = 0; i < joinSearch.length; i++) {
                        /** @type {?} */
                        const el = joinSearch[i];
                        if (el.jointserachdisplaystyle === 2) {
                            if (el.linkfield === this.dataColInfoArray[c].name) {
                                if (!this.hyperLinkQuery[this.queryId]) {
                                    this.hyperLinkQuery[this.queryId] = {};
                                }
                                this.hyperLinkQuery[this.queryId][c + ''] = el;
                                /** @type {?} */
                                const h1 = new GC.Spread.Sheets.CellTypes.HyperLink();
                                h1.text(h1.format(sheet.getCell(r, c).value(), this.dataColInfoArray[c].formatter));
                                h1.activeOnClick(true);
                                h1.onClickAction((/**
                                 * @return {?}
                                 */
                                function () {
                                    spread.commandManager().execute({
                                        cmd: 'dropdownquery',
                                        self: self
                                    });
                                }));
                                sheet.setCellType(r, c, h1, GC.Spread.Sheets.SheetArea.viewport);
                            }
                        }
                    }
                }
            }
            spread.commandManager().register('dropdownquery', {
                canUndo: true,
                execute: (/**
                 * @param {?} context
                 * @param {?} options
                 * @param {?} isUndo
                 * @return {?}
                 */
                function (context, options, isUndo) {
                    /** @type {?} */
                    const row = context.getActiveSheet().getActiveRowIndex();
                    /** @type {?} */
                    const col = context.getActiveSheet().getActiveColumnIndex();
                    for (const key in options.self.hyperLinkQuery[options.self.queryId]) {
                        if (key === (col + '')) {
                            /** @type {?} */
                            const el = options.self.hyperLinkQuery[options.self.queryId][key];
                            /** @type {?} */
                            let entityParam = { 'id': 'null' };
                            /** @type {?} */
                            const paramMap = new Map();
                            /** @type {?} */
                            const searchparas = JSON.parse(options.self.jointsearchInfoList['jointparam']).filter((/**
                             * @param {?} x
                             * @return {?}
                             */
                            x => x.functionid === el['id']));
                            /** @type {?} */
                            const joinParam = options.self.cache.get(RtfServices.getTabId(options.self.queryId) + 'joinSearch');
                            /** @type {?} */
                            let dataItem = { 'id': 'null' };
                            if (joinParam.controlType === 'crosstab') { // 交叉表
                                // 获取行标题的数据
                                for (let i = joinParam.rowHeaderColInfo.start; i < joinParam.rowHeaderColInfo.end; i++) {
                                    /** @type {?} */
                                    const value = context.getActiveSheet().getValue(row, i, GC.Spread.Sheets.SheetArea.viewport);
                                    /** @type {?} */
                                    const name = context.getActiveSheet().getValue(joinParam.colHeaderRowInfo.start, i, GC.Spread.Sheets.SheetArea.colHeader);
                                    /** @type {?} */
                                    const colInfo = joinParam.colInfos.find((/**
                                     * @param {?} x
                                     * @return {?}
                                     */
                                    (x) => x.dimension === 1 && x.name === name)).bindField;
                                    dataItem[colInfo] = value;
                                }
                                // 获取列标题的数据
                                for (let i = joinParam.colHeaderRowInfo.start; i < joinParam.colHeaderRowInfo.end; i++) {
                                    /** @type {?} */
                                    const value = context.getActiveSheet().getValue(i, col, GC.Spread.Sheets.SheetArea.colHeader);
                                    /** @type {?} */
                                    const colInfo = joinParam.colInfos.filter((/**
                                     * @param {?} x
                                     * @return {?}
                                     */
                                    (x) => x.dimension === 2))[i - joinParam.colHeaderRowInfo.start].bindField;
                                    dataItem[colInfo] = value;
                                }
                                // 获取值标题的数据
                                /** @type {?} */
                                const value = context.getActiveSheet().getValue(row, col, GC.Spread.Sheets.SheetArea.viewport);
                                /** @type {?} */
                                const name = context.getActiveSheet().getValue(joinParam.colHeaderRowInfo.end, col, GC.Spread.Sheets.SheetArea.colHeader);
                                /** @type {?} */
                                let colInfo = joinParam.colInfos.find((/**
                                 * @param {?} x
                                 * @return {?}
                                 */
                                (x) => x.dimension === 3 && x.name === name));
                                if (colInfo) {
                                    colInfo = colInfo.bindField;
                                    dataItem[colInfo] = value;
                                }
                            }
                            else {
                                dataItem = context.getActiveSheet().getDataItem(row);
                            }
                            /** @type {?} */
                            const currentSelectedItem = dataItem;
                            if (searchparas.length > 0) {
                                searchparas.forEach((/**
                                 * @param {?} value
                                 * @return {?}
                                 */
                                value => {
                                    if (value.paravaluetype) { // 表达式
                                        if (value.paravalue.indexOf('getParameter(') >= 0) {
                                            /** @type {?} */
                                            const parameterKey = value.paravalue.replace(/'/g, '').replace(/"/g, '').replace(/getParameter\(/g, '').replace(/\)/g, '');
                                            options.self.getQueryParameters(entityParam, paramMap, parameterKey, value.para);
                                        }
                                        else {
                                            entityParam[value.para] = currentSelectedItem[value.paravalue];
                                            paramMap.set(value.para, currentSelectedItem[value.paravalue]);
                                        }
                                    }
                                    else {
                                        entityParam[value.para] = value.paravalue;
                                        paramMap.set(value.para, value.paravalue);
                                    }
                                }));
                            }
                            else {
                                entityParam = currentSelectedItem;
                            }
                            /** @type {?} */
                            const op = {
                                ParentSessionId: options.self.cache.get('session'),
                                EntityParam: entityParam
                            };
                            /** @type {?} */
                            let tabId = '';
                            if (el.searchtype === 'func') {
                                // 联查前
                                /** @type {?} */
                                const openMenuoptions = {
                                    'appType': 'menu',
                                    'funcId': el.functioncode,
                                    'tabId': EventBus.guid(),
                                    'appId': '',
                                    'appEntrance': '',
                                    'entityParams': op.entityParam,
                                    'queryStringParams': paramMap,
                                    'isNewTab': true
                                };
                                tabId = RtfServices.getFuncId(openMenuoptions);
                                options.self.cache.set(tabId ? tabId : options.self.queryId, op.EntityParam);
                                /** @type {?} */
                                const menuSwitchControl = Object.assign({}, openMenuoptions['entityParams'], RtfServices.getMenuSwitchControlParameter(tabId));
                                openMenuoptions['entityParams'] = menuSwitchControl;
                                // 卡片塞进去params
                                gspframeworkService.rtf.func.openMenu(openMenuoptions);
                            }
                            else if (el.searchtype === 'app') {
                                /** @type {?} */
                                const appOption = {
                                    appType: 'app',
                                    appId: el.functioncode,
                                    appEntrance: el.appEntrance,
                                    funcId: '',
                                    isReload: true,
                                    tabId: EventBus.guid(),
                                    entityParams: op.entityParam,
                                    queryStringParams: paramMap
                                };
                                tabId = RtfServices.getFuncId(appOption);
                                options.self.cache.set(tabId ? tabId : options.queryId, op.EntityParam);
                                /** @type {?} */
                                const menuSwitchControl = Object.assign({}, appOption['entityParams'], RtfServices.getMenuSwitchControlParameter(tabId));
                                appOption['entityParams'] = menuSwitchControl;
                                gspframeworkService.rtf.func.openMenu(appOption);
                            }
                        }
                    }
                })
            }, null, false, false, false, false);
        }
        catch (e) { }
    }
    /**
     * @param {?} spread
     * @param {?} sheet
     * @param {?} extObj
     * @return {?}
     */
    inSuiteLinkField(spread, sheet, extObj) {
        try {
            /** @type {?} */
            const self = this;
            /** @type {?} */
            let data = null;
            try {
                if (this.lcpService.inSuiteDropDownInfo && typeof this.lcpService.inSuiteDropDownInfo == 'string') {
                    data = JSON.parse(this.lcpService.inSuiteDropDownInfo);
                }
            }
            catch (e) {
                throw e;
            }
            /** @type {?} */
            const rowCount = sheet.getRowCount();
            /** @type {?} */
            const colCount = sheet.getColumnCount();
            /** @type {?} */
            let rowDropDown = true;
            /** @type {?} */
            const cacheRowDropDown = [];
            /** @type {?} */
            const cacheCellDropDown = {};
            // 解析相关数据
            const { click_events: clickEvents, event_data: eventData, double_click_event: dcEvent, double_click_event_params: dcEventParams, rc_event_ids: rcEventIds } = data;
            if (dcEvent && !("{}" == JSON.stringify(dcEvent)) && dcEventParams && !("{}" == JSON.stringify(dcEventParams))) {
                rowDropDown = true;
                for (let key in dcEventParams) {
                    cacheRowDropDown.push(key);
                }
            }
            else if (eventData && !("{}" == JSON.stringify(eventData))) {
                rowDropDown = false;
                for (let key in eventData) {
                    if (eventData[key]) {
                        /** @type {?} */
                        const cellIndex = [];
                        cacheCellDropDown[key] = cellIndex;
                        for (let key1 in eventData[key]) {
                            cacheCellDropDown[key].push(key1);
                        }
                    }
                }
            }
            for (let r = 1; r < (rowCount); r++) {
                /** @type {?} */
                const dataItem = sheet.getDataItem(r);
                if (dataItem.hasOwnProperty('dynamicPropSet') && dataItem.dynamicPropSet.hasOwnProperty('qdp_data_flag')) {
                    continue;
                }
                for (let c = 0; c < colCount; c++) {
                    if (rowDropDown) {
                        for (let i = 0; i < cacheRowDropDown.length; i++) {
                            if (r == (cacheRowDropDown[i] - 0)) {
                                /** @type {?} */
                                const h1 = new GC.Spread.Sheets.CellTypes.HyperLink();
                                /** @type {?} */
                                const formatter = sheet.getFormatter(r, c);
                                h1.text(h1.format(sheet.getCell(r, c).value(), formatter));
                                h1.activeOnClick(true);
                                h1.onClickAction((/**
                                 * @return {?}
                                 */
                                function () {
                                    spread.commandManager().execute({
                                        cmd: 'dropdownquery',
                                        self: self
                                    });
                                }));
                                sheet.setCellType(r, c, h1, GC.Spread.Sheets.SheetArea.viewport);
                            }
                        }
                    }
                    else {
                        for (let key in cacheCellDropDown) {
                            if ((r + '') === key) {
                                for (let i = 0; i < cacheCellDropDown[key].length; i++) {
                                    /** @type {?} */
                                    const h1 = new GC.Spread.Sheets.CellTypes.HyperLink();
                                    /** @type {?} */
                                    const formatter = sheet.getFormatter(r, cacheCellDropDown[key][i]);
                                    h1.text(h1.format(sheet.getCell(r, cacheCellDropDown[key][i]).value(), formatter));
                                    h1.activeOnClick(true);
                                    h1.onClickAction((/**
                                     * @return {?}
                                     */
                                    function () {
                                        spread.commandManager().execute({
                                            cmd: 'dropdownquery',
                                            self: self
                                        });
                                    }));
                                    sheet.setCellType(r, cacheCellDropDown[key][i], h1, GC.Spread.Sheets.SheetArea.viewport);
                                }
                            }
                        }
                    }
                }
            }
            spread.commandManager().register('dropdownquery', {
                canUndo: true,
                execute: (/**
                 * @param {?} context
                 * @param {?} options
                 * @param {?} isUndo
                 * @return {?}
                 */
                function (context, options, isUndo) {
                    /** @type {?} */
                    const row = context.getActiveSheet().getActiveRowIndex();
                    /** @type {?} */
                    const col = context.getActiveSheet().getActiveColumnIndex();
                    // 双击事件的逻辑
                    /** @type {?} */
                    let event;
                    /** @type {?} */
                    let params;
                    // 行点击数据
                    if (dcEvent && !("{}" == JSON.stringify(dcEvent)) && dcEventParams && !("{}" == JSON.stringify(dcEventParams))) {
                        event = dcEvent;
                        // args.row为行序号，下同
                        params = dcEventParams[row];
                        // 如果eventData数据不为空，并且对应行的数据也不为空
                        // 单元格数据
                    }
                    else if (eventData && !("{}" == JSON.stringify(eventData)) && eventData[row] && !("{}" == JSON.stringify(eventData[row]))) {
                        /** @type {?} */
                        let thisEventId;
                        // 如果对应行包含-1，则取-1中的数据, 否则取对应列号的数据
                        // args.col为列序号
                        /** @type {?} */
                        let thisEventData = eventData[row][-1] || eventData[row][col];
                        if (thisEventData && !("{}" == JSON.stringify(thisEventData))) {
                            if (!rcEventIds && rcEventIds.length) {
                                /** @type {?} */
                                const obj = {};
                                for (let key in thisEventData) {
                                    if (rcEventIds.findIndex((/**
                                     * @param {?} el
                                     * @return {?}
                                     */
                                    (el) => el == key)) < 0) {
                                        obj[key] = thisEventData[key];
                                    }
                                }
                                thisEventData = obj;
                            }
                            /** @type {?} */
                            let index = 0;
                            for (let key in thisEventData) {
                                if (index == 0) {
                                    thisEventId = key;
                                }
                                else {
                                    break;
                                }
                                index++;
                            }
                            params = thisEventData[thisEventId];
                        }
                        // 根据event id获取event
                        if (thisEventId != null && thisEventId != undefined) {
                            event = clickEvents[thisEventId] && !("{}" == JSON.stringify(clickEvents[thisEventId])) ? clickEvents[thisEventId].event : {};
                        }
                    }
                    /** @type {?} */
                    let message;
                    if (!("{}" == JSON.stringify(event)) && !("{}" == JSON.stringify(params))) {
                        // 返回数据
                        message = { type: 'cellAction', event, params, defaults: data.defaults };
                    }
                    if (message) {
                        try {
                            extObj.inSuiteWindow().postMessage(message, location.origin);
                        }
                        catch (e) {
                            console.log(e);
                        }
                    }
                })
            }, null, false, false, false, false);
        }
        catch (e) { }
    }
    /**
     * @private
     * @param {?} entityParam
     * @param {?} paramMap
     * @param {?} parameterKey
     * @param {?} key
     * @return {?}
     */
    getQueryParameters(entityParam, paramMap, parameterKey, key) {
        try {
            /** @type {?} */
            const tab = gspframeworkService.rtf.session.getCommonVariable();
            if (tab && tab.tabId) {
                /** @type {?} */
                const tid = tab.tabId + RtfServices.getInSuiteFrmUUID();
                if (this.cache.get(tid) && this.cache.get(tid)[parameterKey]) {
                    entityParam[key] = this.cache.get(tid)[parameterKey];
                    paramMap.set(key, this.cache.get(tid)[parameterKey]);
                }
            }
        }
        catch (e) {
        }
    }
    /**
     * @param {?} spread
     * @param {?} queryId
     * @return {?}
     */
    bindSelectChanged(spread, queryId) {
        /** @type {?} */
        const self = this;
        spread.bind(GC.Spread.Sheets.Events.SelectionChanging, (/**
         * @param {?} e
         * @param {?} args
         * @return {?}
         */
        function (e, args) {
            /** @type {?} */
            const tempData = {};
            /** @type {?} */
            const selection = args.newSelections.pop();
            /** @type {?} */
            const sheetArea = args.sheetArea === 0 ? 'sheetCorner' : args.sheetArea === 1 ? 'columnHeader' : args.sheetArea === 2 ? 'rowHeader' : 'viewPort';
            if (selection) {
                tempData['SpreadEvent'] = GC.Spread.Sheets.Events.SelectionChanging;
                tempData['sheetArea'] = sheetArea;
                tempData['row'] = selection.row;
                tempData['column'] = selection.col;
                tempData['rowCount'] = selection.rowCount;
                tempData['colCount'] = selection.colCount;
                this.selectChanging = tempData;
            }
        }));
        spread.bind(GC.Spread.Sheets.Events.CellClick, (/**
         * @param {?} e
         * @param {?} args
         * @return {?}
         */
        function (e, args) {
            // 解析当前选中的数据
            /** @type {?} */
            const dataItems = [];
            // 联动参数
            /** @type {?} */
            let linkageParams = {};
            for (let rowIndex = 0; rowIndex < this.selectChanging.rowCount; rowIndex++) {
                if (self.joinParam.controlType !== 'crosstab') {
                    /** @type {?} */
                    const dataItem = args.sheet.getDataItem(rowIndex + this.selectChanging.row);
                    linkageParams = dataItem;
                    dataItems.push(dataItem);
                }
                else {
                    if (this.selectChanging.column === -1) {
                        this.selectChanging.colCount = this.selectChanging.colCount + 1;
                    }
                    for (let colIndex = 0; colIndex < this.selectChanging.colCount; colIndex++) {
                        /** @type {?} */
                        const dataItem = {};
                        if (self.joinParam.controlType === 'crosstab') { // 交叉表
                            if (args.sheetArea === 1) {
                                this.selectChanging.row = 0;
                            }
                            if (colIndex + this.selectChanging.column < self.joinParam.rowHeaderColInfo.end) {
                                continue;
                            }
                            // 获取行标题的数据
                            for (let i = self.joinParam.rowHeaderColInfo.start; i < self.joinParam.rowHeaderColInfo.end; i++) {
                                /** @type {?} */
                                const value = args.sheet.getValue(rowIndex + this.selectChanging.row, i, GC.Spread.Sheets.SheetArea.viewport);
                                /** @type {?} */
                                const name = args.sheet.getValue(self.joinParam.colHeaderRowInfo.start, i, GC.Spread.Sheets.SheetArea.colHeader);
                                /** @type {?} */
                                const colInfo = self.joinParam.colInfos.find((/**
                                 * @param {?} x
                                 * @return {?}
                                 */
                                (x) => x.dimension === 1 && x.name === name)).bindField;
                                dataItem[colInfo] = value;
                            }
                            // 获取列标题的数据
                            for (let i = self.joinParam.colHeaderRowInfo.start; i < self.joinParam.colHeaderRowInfo.end; i++) {
                                /** @type {?} */
                                const value = args.sheet.getValue(i, colIndex + this.selectChanging.column, GC.Spread.Sheets.SheetArea.colHeader);
                                /** @type {?} */
                                const colInfo = self.joinParam.colInfos.filter((/**
                                 * @param {?} x
                                 * @return {?}
                                 */
                                (x) => x.dimension === 2))[i - self.joinParam.colHeaderRowInfo.start].bindField;
                                dataItem[colInfo] = value;
                            }
                            // 获取值标题的数据
                            /** @type {?} */
                            const value = args.sheet.getValue(rowIndex + this.selectChanging.row, colIndex + this.selectChanging.column, GC.Spread.Sheets.SheetArea.viewport);
                            /** @type {?} */
                            const name = args.sheet.getValue(self.joinParam.colHeaderRowInfo.end, colIndex + this.selectChanging.column, GC.Spread.Sheets.SheetArea.colHeader);
                            /** @type {?} */
                            const colInfo = self.joinParam.colInfos.find((/**
                             * @param {?} x
                             * @return {?}
                             */
                            (x) => x.dimension === 3 && x.name === name)).bindField;
                            dataItem[colInfo] = value;
                        }
                        linkageParams = dataItem;
                        dataItems.push(dataItem);
                    }
                }
            }
            // spread 联动事件
            EventBus.dispatch(queryId + '_spread_change', linkageParams);
        }));
    }
    /**
     * @param {?} sheet
     * @param {?} schema
     * @param {?} qdpView
     * @return {?}
     */
    setSortCellType(sheet, schema, qdpView) {
        /** @type {?} */
        const self = this;
        /** @type {?} */
        const header = sheet.getRowCount(GC.Spread.Sheets.SheetArea.colHeader);
        for (let i = 0; i < sheet.getColumnCount(); i++) {
            /** @type {?} */
            const span = sheet.getSpan(header - 1, i, GC.Spread.Sheets.SheetArea.colHeader);
            if (span && span.rowCount > 1) {
                sheet.setCellType(header - span.rowCount, i, new SortCellType(self.columnSort.bind(self), schema, qdpView), GC.Spread.Sheets.SheetArea.colHeader);
            }
            else {
                sheet.setCellType(header - 1, i, new SortCellType(self.columnSort.bind(self), schema, qdpView), GC.Spread.Sheets.SheetArea.colHeader);
            }
        }
    }
    /**
     * @param {?} sheet
     * @param {?} schema
     * @return {?}
     */
    mergeCell(sheet, schema) {
        if (!this.getMergeCell(schema)) {
            return;
        }
        /** @type {?} */
        const groupFieldCache1 = [];
        this.getGroupField(groupFieldCache1, schema);
        if (groupFieldCache1.length) {
            return;
        }
        /** @type {?} */
        const columnCount = sheet.getColumnCount();
        /** @type {?} */
        const rowCount = sheet.getRowCount();
        /** @type {?} */
        let beginRowIndex = 0;
        if (this.getShowFilterRow(schema)) {
            beginRowIndex = 1;
        }
        // 检查参数
        if (columnCount < 1 || (rowCount - beginRowIndex) < 1) {
            return;
        }
        /** @type {?} */
        const rowSpans = {};
        /** @type {?} */
        let curCellValues = '';
        /** @type {?} */
        let currentName = '';
        /** @type {?} */
        let key = '';
        for (let row = beginRowIndex; row < rowCount; row++) {
            if (sheet.getDataItem(row).hasOwnProperty("qdp_data_flag") &&
                ((sheet.getDataItem(row)["qdp_data_flag"] + '') === (4 + '')
                    || (sheet.getDataItem(row)["qdp_data_flag"] + '') === (3 + '')
                    || (sheet.getDataItem(row)["qdp_data_flag"] + '') === (2 + '')
                    || (sheet.getDataItem(row)["qdp_data_flag"] + '') === (1 + ''))) {
                continue;
            }
            for (let col = 0; col < columnCount; col++) {
                currentName = sheet.getCell(row, col).value();
                if (col == 0) {
                    key = currentName;
                    if (rowSpans.hasOwnProperty(key)) {
                        rowSpans[key].rowCount = row - rowSpans[key].row + 1;
                    }
                    else {
                        rowSpans[key] = { 'row': row, 'rowCount': 1, 'col': col, 'colCount': 1 };
                    }
                }
                else {
                    curCellValues = '';
                    for (let i = 0; i <= col; i++) {
                        curCellValues += sheet.getCell(row, i).value();
                        curCellValues += "_&_";
                    }
                    if (rowSpans.hasOwnProperty(curCellValues)) {
                        rowSpans[curCellValues].rowCount = row - rowSpans[curCellValues].row + 1;
                    }
                    else {
                        rowSpans[curCellValues] = { 'row': row, 'rowCount': 1, 'col': col, 'colCount': 1 };
                    }
                }
            }
        }
        for (let k in rowSpans) {
            if ((rowSpans[k].rowCount == 1 && rowSpans[k].colCount == 1) == false) {
                sheet.addSpan(rowSpans[k].row, rowSpans[k].col, rowSpans[k].rowCount, rowSpans[k].colCount);
            }
        }
    }
    /**
     * @private
     * @param {?} index
     * @param {?} sheet
     * @param {?} schema
     * @param {?} qdpView
     * @return {?}
     */
    columnSort(index, sheet, schema, qdpView) {
        /** @type {?} */
        const loading = this.loadService.show({ container: 'body' });
        try {
            /** @type {?} */
            const header = sheet.getRowCount(GC.Spread.Sheets.SheetArea.colHeader);
            if (schema && schema.schemaValue && schema.schemaValue.columnOption && schema.schemaValue.columnOption.colList && schema.schemaValue.columnOption.colList.length) {
                /** @type {?} */
                let cell = null;
                /** @type {?} */
                const span = sheet.getSpan(header - 1, index, GC.Spread.Sheets.SheetArea.colHeader);
                if (span && span.rowCount > 1) {
                    cell = sheet.getCell(header - span.rowCount, index, GC.Spread.Sheets.SheetArea.colHeader);
                }
                else {
                    cell = sheet.getCell(header - 1, index, GC.Spread.Sheets.SheetArea.colHeader);
                }
                if (schema && schema.isPrefab === 1) {
                    loading.close();
                    cell.tag(0);
                    sheet.invalidateLayout();
                    sheet.repaint();
                    this.msgService.info(this.localizeService.getValue('spread.message.validate.sort'));
                    return;
                }
                if (schema.isProtected === 1 || schema.isProtected === '1') {
                    loading.close();
                    cell.tag(0);
                    sheet.invalidateLayout();
                    sheet.repaint();
                    this.msgService.info(this.localizeService.getValue('ideCmp.schemaManager.message.validate.isProtected'));
                    return;
                }
                /** @type {?} */
                const colList = schema.schemaValue.columnOption.colList;
                /** @type {?} */
                const params = {
                    index: index,
                    cell: cell,
                    colIndex: 0,
                    sortInfo: { sortIndex: 0, bindField: '' },
                    isText: []
                };
                // tslint:disable-next-line:prefer-for-of
                for (let i = 0; i < colList.length; i++) {
                    this.recursiveColumnSortIndex(colList[i], null, params);
                }
                // tslint:disable-next-line:prefer-for-of
                for (let i = 0; i < colList.length; i++) {
                    this.recursiveColumnSort(colList[i], null, params);
                }
                if (params.isText.length) {
                    loading.close();
                    cell.tag(0);
                    sheet.invalidateLayout();
                    sheet.repaint();
                    this.msgService.warning(params.isText[0] + ' ' + this.localizeService.getValue('ideCmp.schemaManager.message.validate.textColumnSort'));
                    return;
                }
                /** @type {?} */
                const newSchema = JSON.parse(JSON.stringify(schema));
                newSchema.schemaValue.columnOption.colList = colList;
                newSchema.schemaValue = JSON.stringify(newSchema.schemaValue);
                this.schemaManager.saveSchema({ schema: JSON.stringify(newSchema), groupType: qdpView.groupType }, '').subscribe((/**
                 * @param {?} data
                 * @return {?}
                 */
                data => {
                    loading.close();
                    qdpView.initSpread(qdpView.queryId, newSchema.id, qdpView.controlType, qdpView.qoManagerCode, qdpView.pageIndex, qdpView.queryRelativeUrl, qdpView.conditionExpression, qdpView.groupType, qdpView.voId, true);
                }), (/**
                 * @param {?} error
                 * @return {?}
                 */
                (error) => {
                    loading.close();
                    this.formErrorService.exception(error.Message, error);
                }));
            }
            else {
                loading.close();
                this.msgService.info(this.localizeService.getValue('spread.message.validate.sort'));
                return;
            }
        }
        catch (e) {
            loading.close();
        }
    }
    /**
     * @private
     * @param {?} col
     * @param {?} colList
     * @param {?} params
     * @return {?}
     */
    recursiveColumnSortIndex(col, colList, params) {
        if (colList == null) {
            if (col.childList && col.childList.length) {
                this.recursiveColumnSortIndex(null, col.childList, params);
            }
            else {
                if (col.sort !== 0 && col['sortIndex'] != null && col['sortIndex'] !== undefined && col.sortIndex > params.sortInfo.sortIndex) {
                    params.sortInfo.sortIndex = col['sortIndex'];
                    params.sortInfo.bindField = col.bindField;
                }
            }
        }
        else {
            // tslint:disable-next-line:prefer-for-of
            for (let i = 0; i < colList.length; i++) {
                if (colList[i].childList && colList[i].childList.length) {
                    this.recursiveColumnSortIndex(null, colList[i].childList, params);
                }
                else {
                    if (colList[i].sort !== 0 && colList[i]['sortIndex'] != null && colList[i]['sortIndex'] !== undefined && colList[i].sortIndex > params.sortInfo.sortIndex) {
                        params.sortInfo.sortIndex = colList[i]['sortIndex'];
                        params.sortInfo.bindField = colList[i].bindField;
                    }
                }
            }
        }
    }
    /**
     * @private
     * @param {?} col
     * @param {?} colList
     * @param {?} params
     * @return {?}
     */
    recursiveColumnSort(col, colList, params) {
        if (colList == null) {
            if (col.childList && col.childList.length) {
                this.recursiveColumnSort(null, col.childList, params);
            }
            else {
                if (params.colIndex === params.index) {
                    if (col.type && col.type.toLowerCase() === 'text') {
                        params.isText.push(col.bindField);
                    }
                    else {
                        switch (params.cell.tag()) {
                            case 0:
                                col.sort = 0;
                                col['sortIndex'] = 0;
                                break;
                            case 1:
                                col.sort = 1;
                                col['sortIndex'] = col['sortIndex'] !== null && col['sortIndex'] !== undefined && col['sortIndex'] > 0 ? col['sortIndex'] : col.bindField === params.sortInfo.bindField ? params.sortInfo.sortIndex : params.sortInfo.sortIndex + 1;
                                break;
                            case 2:
                                col.sort = 2;
                                col['sortIndex'] = col['sortIndex'] !== null && col['sortIndex'] !== undefined && col['sortIndex'] > 0 ? col['sortIndex'] : col.bindField === params.sortInfo.bindField ? params.sortInfo.sortIndex : params.sortInfo.sortIndex + 1;
                                break;
                        }
                    }
                }
                params.colIndex++;
            }
        }
        else {
            // tslint:disable-next-line:prefer-for-of
            for (let i = 0; i < colList.length; i++) {
                if (colList[i].childList && colList[i].childList.length) {
                    this.recursiveColumnSort(null, colList[i].childList, params);
                }
                else {
                    if (params.colIndex === params.index) {
                        if (colList[i].type && colList[i].type.toLowerCase() === 'text') {
                            params.isText.push(colList[i].bindField);
                        }
                        else {
                            switch (params.cell.tag()) {
                                case 0:
                                    colList[i].sort = 0;
                                    colList[i]['sortIndex'] = 0;
                                    break;
                                case 1:
                                    colList[i].sort = 1;
                                    colList[i]['sortIndex'] = colList[i]['sortIndex'] !== null && colList[i]['sortIndex'] !== undefined && colList[i]['sortIndex'] > 0 ? colList[i]['sortIndex'] : colList[i].bindField === params.sortInfo.bindField ? params.sortInfo.sortIndex : params.sortInfo.sortIndex + 1;
                                    break;
                                case 2:
                                    colList[i].sort = 2;
                                    colList[i]['sortIndex'] = colList[i]['sortIndex'] !== null && colList[i]['sortIndex'] !== undefined && colList[i]['sortIndex'] > 0 ? colList[i]['sortIndex'] : colList[i].bindField === params.sortInfo.bindField ? params.sortInfo.sortIndex : params.sortInfo.sortIndex + 1;
                                    break;
                            }
                        }
                    }
                    params.colIndex++;
                }
            }
        }
    }
    /**
     * @private
     * @param {?} col
     * @param {?} colList
     * @param {?} params
     * @return {?}
     */
    recursiveIsRedColumn(col, colList, params) {
        if (colList == null) {
            if (col.childList && col.childList.length) {
                this.recursiveIsRedColumn(null, col.childList, params);
            }
            else {
                if (col.isRed) {
                    params.isRedColumns.push({
                        colIndex: params.colIndex
                    });
                }
                params.colIndex++;
            }
        }
        else {
            // tslint:disable-next-line:prefer-for-of
            for (let i = 0; i < colList.length; i++) {
                if (colList[i].childList && colList[i].childList.length) {
                    this.recursiveIsRedColumn(null, colList[i].childList, params);
                }
                else {
                    if (colList[i].isRed) {
                        params.isRedColumns.push({
                            colIndex: params.colIndex
                        });
                    }
                    params.colIndex++;
                }
            }
        }
    }
    /**
     * @private
     * @param {?} val
     * @return {?}
     */
    isNumber(val) {
        if (parseFloat(val).toString() == "NaN") {
            return false;
        }
        else {
            return true;
        }
    }
}
if (false) {
    /** @type {?} */
    SpreadStyleUtils.prototype.dataStyleArray;
    /** @type {?} */
    SpreadStyleUtils.prototype.dataRowHeightArray;
    /** @type {?} */
    SpreadStyleUtils.prototype.dataColInfoArray;
    /** @type {?} */
    SpreadStyleUtils.prototype.footerStyleArray;
    /** @type {?} */
    SpreadStyleUtils.prototype.footerRowHeightArray;
    /** @type {?} */
    SpreadStyleUtils.prototype.footerSpansArray;
    /** @type {?} */
    SpreadStyleUtils.prototype.footerDataArray;
    /** @type {?} */
    SpreadStyleUtils.prototype.hyperLinkQuery;
    /**
     * @type {?}
     * @private
     */
    SpreadStyleUtils.prototype.autoFitColumnIndex;
    /** @type {?} */
    SpreadStyleUtils.prototype.type;
    /** @type {?} */
    SpreadStyleUtils.prototype.queryId;
    /** @type {?} */
    SpreadStyleUtils.prototype.valueHeaderRowCount;
    /** @type {?} */
    SpreadStyleUtils.prototype.valueHeaderRowArray;
    /** @type {?} */
    SpreadStyleUtils.prototype.rowHeadersColumnCount;
    /** @type {?} */
    SpreadStyleUtils.prototype.rowHeaderRowArray;
    /** @type {?} */
    SpreadStyleUtils.prototype.rowHeaderInfo;
    /** @type {?} */
    SpreadStyleUtils.prototype.valInfo;
    /** @type {?} */
    SpreadStyleUtils.prototype.joinParam;
    /** @type {?} */
    SpreadStyleUtils.prototype.jointsearchInfoList;
    /** @type {?} */
    SpreadStyleUtils.prototype.cache;
    /** @type {?} */
    SpreadStyleUtils.prototype.loadService;
    /** @type {?} */
    SpreadStyleUtils.prototype.msgService;
    /** @type {?} */
    SpreadStyleUtils.prototype.localizeService;
    /** @type {?} */
    SpreadStyleUtils.prototype.schemaManager;
    /** @type {?} */
    SpreadStyleUtils.prototype.formErrorService;
    /** @type {?} */
    SpreadStyleUtils.prototype.lcpService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3ByZWFkLnN0eWxlLnV0aWxzLmpzIiwic291cmNlUm9vdCI6Im5nOi8vQHFkcC9zcHJlYWQvIiwic291cmNlcyI6WyJsaWIvdXRpbC9zcHJlYWQuc3R5bGUudXRpbHMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUNBLE9BQU8sRUFBRSxRQUFRLEVBQUUsV0FBVyxFQUFjLE1BQU0sYUFBYSxDQUFDO0FBQ2hFLE9BQU8sRUFBRSxNQUFNLEVBQUUsTUFBTSxXQUFXLENBQUM7QUFTbkMsTUFBTSxPQUFPLGdCQUFnQjs7Ozs7OztJQTRCekIsWUFBWSxRQUFhLEVBQUUsWUFBaUIsRUFBRSxvQkFBMEIsRUFBRSxhQUFtQjtRQTNCN0YsbUJBQWMsR0FBVSxFQUFFLENBQUM7UUFDM0IsdUJBQWtCLEdBQVUsRUFBRSxDQUFDO1FBQy9CLHFCQUFnQixHQUFVLEVBQUUsQ0FBQztRQUM3QixxQkFBZ0IsR0FBVSxFQUFFLENBQUM7UUFDN0IseUJBQW9CLEdBQVUsRUFBRSxDQUFDO1FBQ2pDLHFCQUFnQixHQUFVLEVBQUUsQ0FBQztRQUM3QixvQkFBZSxHQUFVLEVBQUUsQ0FBQztRQUM1QixtQkFBYyxHQUFRLEVBQUUsQ0FBQztRQUNqQix1QkFBa0IsR0FBRyxDQUFDLENBQUM7UUFHL0Isd0JBQW1CLEdBQUcsQ0FBQyxDQUFDLENBQUMsUUFBUTs7UUFDakMsd0JBQW1CLEdBQWEsRUFBRSxDQUFDO1FBQ25DLDBCQUFxQixHQUFHLENBQUMsQ0FBQyxDQUFDLFFBQVE7O1FBQ25DLHNCQUFpQixHQUFhLEVBQUUsQ0FBQztRQUdqQyxjQUFTLEdBQVEsRUFBRSxDQUFDO1FBV2hCLElBQUksQ0FBQyxPQUFPLEdBQUcsUUFBUSxDQUFDO1FBQ3hCLElBQUksQ0FBQyxJQUFJLEdBQUcsWUFBWSxDQUFDO1FBQ3pCLElBQUksQ0FBQyxtQkFBbUIsR0FBRyxvQkFBb0IsQ0FBQztRQUNoRCxJQUFJLENBQUMsS0FBSyxHQUFHLGFBQWEsQ0FBQyxZQUFZLENBQUM7UUFDeEMsSUFBSSxDQUFDLFdBQVcsR0FBRyxhQUFhLENBQUMsY0FBYyxDQUFDO1FBQ2hELElBQUksQ0FBQyxVQUFVLEdBQUcsYUFBYSxDQUFDLFVBQVUsQ0FBQztRQUMzQyxJQUFJLENBQUMsZUFBZSxHQUFHLGFBQWEsQ0FBQyxlQUFlLENBQUM7UUFDckQsSUFBSSxDQUFDLGFBQWEsR0FBRyxhQUFhLENBQUMsb0JBQW9CLENBQUM7UUFDeEQsSUFBSSxDQUFDLGdCQUFnQixHQUFHLGFBQWEsQ0FBQyxnQkFBZ0IsQ0FBQztRQUN2RCxJQUFJLENBQUMsVUFBVSxHQUFHLGFBQWEsQ0FBQyxVQUFVLENBQUM7SUFDL0MsQ0FBQzs7Ozs7O0lBRUQsZ0JBQWdCLENBQUMsTUFBVyxFQUFFLEtBQVU7UUFDcEMsSUFBSSxNQUFNLElBQUksTUFBTSxDQUFDLFdBQVcsSUFBSSxNQUFNLENBQUMsV0FBVyxDQUFDLFlBQVksSUFBSSxNQUFNLENBQUMsV0FBVyxDQUFDLFlBQVksQ0FBQyxPQUFPLElBQUksTUFBTSxDQUFDLFdBQVcsQ0FBQyxZQUFZLENBQUMsT0FBTyxDQUFDLE1BQU0sRUFBRTtZQUM5SixJQUFJLENBQUMsa0JBQWtCLEdBQUcsQ0FBQyxDQUFDO1lBQzVCLE1BQU0sQ0FBQyxXQUFXLENBQUMsWUFBWSxDQUFDLE9BQU8sQ0FBQyxPQUFPOzs7O1lBQUMsQ0FBQyxHQUFRLEVBQUUsRUFBRTtnQkFDekQsSUFBSSxDQUFDLHNCQUFzQixDQUFDLEdBQUcsRUFBRSxJQUFJLEVBQUUsS0FBSyxDQUFDLENBQUM7WUFDbEQsQ0FBQyxFQUFDLENBQUM7U0FDTjtJQUNMLENBQUM7Ozs7Ozs7O0lBRU8sc0JBQXNCLENBQUMsTUFBVyxFQUFFLFNBQWdCLEVBQUUsS0FBVTtRQUNwRSxJQUFJLE1BQU0sRUFBRTtZQUNSLElBQUksTUFBTSxDQUFDLFNBQVMsSUFBSSxNQUFNLENBQUMsU0FBUyxDQUFDLE1BQU0sRUFBRTtnQkFDN0MsSUFBSSxDQUFDLHNCQUFzQixDQUFDLElBQUksRUFBRSxNQUFNLENBQUMsU0FBUyxFQUFFLEtBQUssQ0FBQyxDQUFDO2FBQzlEO2lCQUFNO2dCQUNILElBQUksTUFBTSxDQUFDLE9BQU8sRUFBRTtvQkFDaEIsS0FBSyxDQUFDLGFBQWEsQ0FBQyxJQUFJLENBQUMsa0JBQWtCLENBQUMsQ0FBQztpQkFDaEQ7Z0JBQ0QsSUFBSSxDQUFDLGtCQUFrQixJQUFJLENBQUMsQ0FBQzthQUNoQztTQUNKO2FBQU07WUFDSCxTQUFTLENBQUMsT0FBTzs7OztZQUFDLENBQUMsR0FBUSxFQUFFLEVBQUU7Z0JBQzNCLElBQUksR0FBRyxDQUFDLFNBQVMsSUFBSSxHQUFHLENBQUMsU0FBUyxDQUFDLE1BQU0sRUFBRTtvQkFDdkMsSUFBSSxDQUFDLHNCQUFzQixDQUFDLElBQUksRUFBRSxHQUFHLENBQUMsU0FBUyxFQUFFLEtBQUssQ0FBQyxDQUFDO2lCQUMzRDtxQkFBTTtvQkFDSCxJQUFJLEdBQUcsQ0FBQyxPQUFPLEVBQUU7d0JBQ2IsS0FBSyxDQUFDLGFBQWEsQ0FBQyxJQUFJLENBQUMsa0JBQWtCLENBQUMsQ0FBQztxQkFDaEQ7b0JBQ0QsSUFBSSxDQUFDLGtCQUFrQixJQUFJLENBQUMsQ0FBQztpQkFDaEM7WUFDTCxDQUFDLEVBQUMsQ0FBQztTQUNOO0lBQ0wsQ0FBQzs7Ozs7SUFFRCxVQUFVLENBQUMsS0FBVTtRQUNqQixJQUFJLENBQUMsY0FBYyxHQUFHLEVBQUUsQ0FBQztRQUN6QixJQUFJLENBQUMsa0JBQWtCLEdBQUcsRUFBRSxDQUFDO1FBQzdCLElBQUksQ0FBQyxnQkFBZ0IsR0FBRyxFQUFFLENBQUM7UUFDM0IsSUFBSSxDQUFDLGdCQUFnQixHQUFHLEVBQUUsQ0FBQztRQUMzQixJQUFJLENBQUMsb0JBQW9CLEdBQUcsRUFBRSxDQUFDO1FBQy9CLElBQUksQ0FBQyxnQkFBZ0IsR0FBRyxFQUFFLENBQUM7UUFDM0IsSUFBSSxDQUFDLGVBQWUsR0FBRyxFQUFFLENBQUM7UUFFMUIsV0FBVztRQUNYLEtBQUssSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxLQUFLLENBQUMsV0FBVyxFQUFFLEVBQUUsQ0FBQyxFQUFFLEVBQUU7O2tCQUNwQyxnQkFBZ0IsR0FBRyxJQUFJLEtBQUssRUFBRTs7a0JBQzlCLFNBQVMsR0FBRyxJQUFJLEtBQUssRUFBRTtZQUM3QixLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsS0FBSyxDQUFDLGNBQWMsRUFBRSxFQUFFLENBQUMsRUFBRSxFQUFFO2dCQUM3QyxJQUFJLENBQUMsS0FBSyxDQUFDLEVBQUU7O3dCQUNMLFNBQVMsR0FBRyxFQUFFO29CQUNsQixJQUFJLEtBQUssQ0FBQyxZQUFZLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxFQUFFLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxTQUFTLENBQUMsUUFBUSxDQUFDLEVBQUU7d0JBQy9ELFNBQVMsR0FBRyxLQUFLLENBQUMsWUFBWSxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsRUFBRSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsU0FBUyxDQUFDLFFBQVEsQ0FBQyxDQUFDO3FCQUM3RTs7MEJBQ0ssY0FBYyxHQUFHLEtBQUssQ0FBQyxXQUFXLENBQUMsRUFBRSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsU0FBUyxDQUFDLFNBQVMsQ0FBQzs7MEJBQ3hFLE9BQU8sR0FBUTt3QkFDakIsSUFBSSxFQUFFLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxFQUFFLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxTQUFTLENBQUMsUUFBUSxDQUFDLENBQUMsS0FBSyxFQUFFO3dCQUN0RSxJQUFJLEVBQUUsS0FBSyxDQUFDLGNBQWMsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsU0FBUyxDQUFDLFFBQVEsQ0FBQzt3QkFDbEUsT0FBTyxFQUFFLEtBQUssQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsU0FBUyxDQUFDLFFBQVEsQ0FBQzt3QkFDdkUsU0FBUyxFQUFFLEtBQUssQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsU0FBUyxDQUFDLFFBQVEsQ0FBQzt3QkFDM0UsU0FBUyxFQUFFLFNBQVMsQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLGNBQWMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLENBQUMsU0FBUzt3QkFDbEYsV0FBVyxFQUFFLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQyxjQUFjLEdBQUcsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLFNBQVMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxLQUFLLEVBQUU7cUJBQ3BHO29CQUNELElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUM7aUJBQ3ZDOztvQkFDRyxLQUFLLEdBQUcsS0FBSyxDQUFDLFFBQVEsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLFNBQVMsQ0FBQyxRQUFRLENBQUM7Z0JBQ3JFLElBQUksS0FBSyxJQUFJLElBQUksRUFBRTtvQkFDZixLQUFLLEdBQUcsSUFBSSxFQUFFLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxLQUFLLEVBQUUsQ0FBQztvQkFDckMsS0FBSyxDQUFDLE1BQU0sR0FBRyxJQUFJLENBQUM7aUJBQ3ZCO3FCQUFNO29CQUNILEtBQUssQ0FBQyxNQUFNLEdBQUcsSUFBSSxDQUFDO2lCQUN2QjtnQkFDRCxJQUFJLEtBQUssSUFBSSxLQUFLLENBQUMsU0FBUyxJQUFJLEtBQUssQ0FBQyxTQUFTLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsRUFBRTtvQkFDL0QsS0FBSyxDQUFDLFNBQVMsR0FBRyxJQUFJLGNBQWMsQ0FBQyxLQUFLLENBQUMsU0FBUyxDQUFDLENBQUM7aUJBQ3pEO2dCQUNELGdCQUFnQixDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQzs7c0JBRXZCLElBQUksR0FBRyxLQUFLLENBQUMsUUFBUSxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsRUFBRSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsU0FBUyxDQUFDLFFBQVEsQ0FBQzt1QkFDL0QsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLFNBQVMsQ0FBQyxRQUFRLENBQUM7dUJBQ3hELEVBQUU7Z0JBQ1QsU0FBUyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQzthQUV4QjtZQUNELElBQUksQ0FBQyxLQUFLLENBQUMsRUFBRTtnQkFDVCxJQUFJLENBQUMsa0JBQWtCLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztnQkFDcEQsSUFBSSxDQUFDLGNBQWMsQ0FBQyxJQUFJLENBQUMsZ0JBQWdCLENBQUMsQ0FBQzthQUM5QztpQkFBTTtnQkFDSCxJQUFJLENBQUMsb0JBQW9CLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztnQkFDdEQsSUFBSSxDQUFDLGdCQUFnQixDQUFDLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO2dCQUM3QyxJQUFJLENBQUMsZUFBZSxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsQ0FBQzthQUN4QztTQUNKOzs7Y0FHSyxLQUFLLEdBQUcsS0FBSyxDQUFDLFFBQVEsRUFBRTtRQUM5QixJQUFJLEtBQUssSUFBSSxLQUFLLENBQUMsTUFBTSxFQUFFO1lBQ3ZCLHlDQUF5QztZQUN6QyxLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsS0FBSyxDQUFDLE1BQU0sRUFBRSxDQUFDLEVBQUUsRUFBRTtnQkFDbkMsSUFBSSxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxHQUFHLENBQUMsRUFBRTtvQkFDbEIsSUFBSSxDQUFDLGdCQUFnQixDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztpQkFDeEM7YUFDSjtTQUNKO1FBQ0QsS0FBSyxDQUFDLFVBQVUsQ0FBQyxDQUFDLEVBQUUsS0FBSyxDQUFDLFdBQVcsRUFBRSxHQUFHLENBQUMsQ0FBQyxDQUFDO0lBQ2pELENBQUM7Ozs7Ozs7SUFFRCxVQUFVLENBQUMsS0FBVSxFQUFFLE1BQVcsRUFBRSxRQUFrQjs7WUFDOUMsUUFBUSxHQUFHLEtBQUssQ0FBQyxXQUFXLEVBQUU7O2NBQzVCLFFBQVEsR0FBRyxLQUFLLENBQUMsY0FBYyxFQUFFOztjQUNqQyxXQUFXLEdBQUcsSUFBSSxDQUFDLG9CQUFvQixDQUFDLE1BQU07UUFDcEQsS0FBSyxDQUFDLE9BQU8sQ0FBQyxRQUFRLEVBQUUsV0FBVyxDQUFDLENBQUM7O1lBQ2pDLEtBQUssR0FBRyxDQUFDOztjQUNQLGVBQWUsR0FBRyxFQUFFOztjQUNwQixvQkFBb0IsR0FBRyxFQUFFOztjQUN6QixhQUFhLEdBQUcsRUFBRTs7Y0FDbEIsY0FBYyxHQUFHLEVBQUU7O2NBQ25CLE9BQU8sR0FBRyxLQUFLLENBQUMsTUFBTSxFQUFFLENBQUMsT0FBTztRQUN0QyxJQUFJLENBQUMsYUFBYSxDQUFDLGVBQWUsRUFBRSxNQUFNLENBQUMsQ0FBQzs7Y0FDdEMsZ0JBQWdCLEdBQUcsRUFBRTtRQUMzQixJQUFJLENBQUMsY0FBYyxDQUFDLGdCQUFnQixFQUFFLE1BQU0sQ0FBQyxDQUFDO1FBQzlDLElBQUksQ0FBQyxlQUFlLENBQUMsZ0JBQWdCLEVBQUUsTUFBTSxDQUFDLENBQUM7O2NBQ3pDLFlBQVksR0FBRztZQUNqQixRQUFRLEVBQUUsQ0FBQztZQUNYLFlBQVksRUFBRSxFQUFFO1NBQ25CO1FBQ0QsSUFBSSxDQUFDLGVBQWUsQ0FBQyxNQUFNLEVBQUUsWUFBWSxDQUFDLENBQUM7O2NBQ3JDLFlBQVksR0FBRyxLQUFLLENBQUMsTUFBTSxFQUFFLENBQUMsT0FBTztRQUMzQyxLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsQ0FBQyxRQUFRLEdBQUcsV0FBVyxDQUFDLEVBQUUsQ0FBQyxFQUFFLEVBQUU7WUFDL0MsSUFBSSxnQkFBZ0IsSUFBSSxnQkFBZ0IsQ0FBQyxNQUFNLElBQUksQ0FBQyxHQUFHLFFBQVEsRUFBRTtnQkFDN0QsZ0JBQWdCLENBQUMsT0FBTzs7OztnQkFBQyxDQUFDLElBQVMsRUFBRSxFQUFFOzswQkFDN0IsUUFBUSxHQUFHLEtBQUssQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDOzswQkFDL0IsU0FBUyxHQUFHLFFBQVEsQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLEdBQUcsQ0FBQzs7d0JBQzVDLFlBQVksR0FBRyxJQUFJLENBQUMsU0FBUyxJQUFJLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxJQUFJLElBQUksQ0FBQyxTQUFTLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLElBQUk7b0JBQ3JJLElBQUksSUFBSSxDQUFDLFFBQVEsQ0FBQyxTQUFTLENBQUMsRUFBRTt3QkFDMUIsS0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLFNBQVMsRUFBRSxDQUFDLEVBQUUsRUFBRTs0QkFDaEMsWUFBWSxJQUFJLEdBQUcsQ0FBQzt5QkFDdkI7cUJBQ0o7OzBCQUNLLGNBQWMsR0FBRyxZQUFZLENBQUMsU0FBUzs7OztvQkFBQyxDQUFDLEVBQU8sRUFBRSxFQUFFLENBQUMsRUFBRSxDQUFDLElBQUksSUFBSSxJQUFJLENBQUMsV0FBVyxFQUFDO29CQUN2RixJQUFJLGNBQWMsSUFBSSxDQUFDLElBQUksWUFBWSxJQUFJLElBQUksSUFBSSxZQUFZLElBQUksUUFBUSxFQUFFO3dCQUN6RSxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUMsRUFBRSxjQUFjLENBQUMsQ0FBQyxTQUFTLENBQUMsWUFBWSxDQUFDLENBQUM7cUJBQzVEO2dCQUNMLENBQUMsRUFBQyxDQUFDO2FBQ047WUFFRCxLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsUUFBUSxFQUFFLENBQUMsRUFBRSxFQUFFO2dCQUMvQixJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsZ0JBQWdCLENBQUMsS0FBSyxDQUFDLEVBQUU7b0JBQzNDLEtBQUssSUFBSSxDQUFDLENBQUM7aUJBQ2Q7Z0JBQ0QsSUFBSSxDQUFDLElBQUksUUFBUSxFQUFFO29CQUNmLElBQUksQ0FBQyxLQUFLLENBQUMsRUFBRTt3QkFDVCxLQUFLLENBQUMsUUFBUSxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsSUFBSSxDQUFDLGdCQUFnQixDQUFDLENBQUMsR0FBRyxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO3dCQUM3RCxJQUFJLElBQUksQ0FBQyxlQUFlLElBQUksSUFBSSxDQUFDLGVBQWUsQ0FBQyxNQUFNLEVBQUU7NEJBQ3JELEtBQUssQ0FBQyxRQUFRLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxJQUFJLENBQUMsZUFBZSxDQUFDLENBQUMsR0FBRyxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO3lCQUMvRDt3QkFDRCxLQUFLLENBQUMsWUFBWSxDQUFDLENBQUMsRUFBRSxJQUFJLENBQUMsb0JBQW9CLENBQUMsQ0FBQyxHQUFHLFFBQVEsQ0FBQyxDQUFDLENBQUM7d0JBQy9ELElBQUksSUFBSSxDQUFDLGdCQUFnQixJQUFJLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxNQUFNLEVBQUU7NEJBQ3ZELEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQyxFQUFFLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLEVBQUUsSUFBSSxDQUFDLGdCQUFnQixDQUFDLENBQUMsQ0FBQyxDQUFDLFFBQVEsRUFBRSxJQUFJLENBQUMsZ0JBQWdCLENBQUMsQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDLENBQUM7eUJBQ3hIO3FCQUNKO2lCQUNKO3FCQUFNOzswQkFDRyxTQUFTLEdBQUcsS0FBSyxDQUFDLFlBQVksQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLFNBQVMsQ0FBQyxRQUFRLENBQUM7b0JBQy9FLElBQUksU0FBUyxJQUFJLFNBQVMsQ0FBQyxPQUFPLElBQUksU0FBUyxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLElBQUksU0FBUyxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLEVBQUU7OzhCQUN4RixTQUFTLEdBQUcsSUFBSSxDQUFDLFdBQVcsQ0FBQyxTQUFTLEVBQUUsS0FBSyxDQUFDLFFBQVEsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7d0JBQ25FLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxTQUFTLENBQUMsQ0FBQztxQkFDbEM7b0JBQ0QsSUFBSSxTQUFTLElBQUksT0FBTyxTQUFTLEtBQUssUUFBUSxJQUFJLENBQUMsU0FBUyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksU0FBUyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksU0FBUyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksU0FBUyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksU0FBUyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksU0FBUyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsRUFBRTt3QkFDOU8sSUFBSSxLQUFLLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQyxDQUFDLGNBQWMsQ0FBQyxlQUFlLENBQUMsRUFBRTs0QkFDdEQsS0FBSyxDQUFDLFlBQVksQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDO3lCQUNoQztxQkFDSjtvQkFDRCxJQUFJLFlBQVksQ0FBQyxZQUFZLENBQUMsU0FBUzs7OztvQkFBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxRQUFRLElBQUksQ0FBQyxFQUFDLElBQUksQ0FBQyxJQUFJLElBQUksQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsS0FBSyxFQUFFLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLEtBQUssRUFBRSxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUMsRUFBRTt3QkFDekosS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDLEtBQUssQ0FBQyxDQUFDO3FCQUN4QztvQkFDRCxJQUFJLENBQUMsUUFBUSxFQUFFO3dCQUNYLElBQUksQ0FBQyxRQUFRLElBQUksT0FBTyxJQUFJLE9BQU8sQ0FBQyxNQUFNLEVBQUU7NEJBQ3hDLElBQUksT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksS0FBSyxXQUFXLElBQUksT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksS0FBSyxVQUFVLEVBQUU7Z0NBQUUsU0FBUzs2QkFBRTs0QkFDcEYsSUFBSSxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxLQUFLLEVBQUUsS0FBSyxDQUFDLElBQUksS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsS0FBSyxFQUFFLElBQUksR0FBRyxFQUFFO2dDQUN6RSxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsRUFBRSxDQUFDLENBQUM7NkJBQ2pDO3lCQUNKO3FCQUNKO2lCQUNKO2FBQ0o7WUFDRCxJQUFJLENBQUMsR0FBRyxRQUFRLEVBQUU7Z0JBQ2QsT0FBTztnQkFDUCxLQUFLLENBQUMsWUFBWSxDQUFDLENBQUMsRUFBRSxJQUFJLENBQUMsa0JBQWtCLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztnQkFDbEQsSUFBSSxJQUFJLENBQUMsSUFBSSxLQUFLLFVBQVUsRUFBRTs7MEJBQ3BCLEtBQUssR0FBRyxLQUFLLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQyxDQUFDLFdBQVcsQ0FBQzs7MEJBQ3pDLFFBQVEsR0FBRyxLQUFLLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQyxDQUFDLFVBQVUsQ0FBQztvQkFDakQsS0FBSyxDQUFDLFdBQVcsQ0FBQyxDQUFDLEVBQUUsS0FBSyxFQUFFLElBQUksWUFBWSxDQUFDLElBQUksRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFFLFFBQVEsQ0FBQyxDQUFDLENBQUM7b0JBQzVFLEtBQUssQ0FBQyxRQUFRLENBQUMsQ0FBQyxFQUFFLEtBQUssQ0FBQyxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUM7b0JBQ3BDLEtBQUssQ0FBQyxRQUFRLENBQUMsQ0FBQyxFQUFFLEtBQUssQ0FBQyxDQUFDLFVBQVUsR0FBRyxLQUFLLEdBQUcsQ0FBQyxDQUFDO29CQUNoRCxLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLElBQUksS0FBSyxFQUFFLENBQUMsRUFBRSxFQUFFO3dCQUM3QixLQUFLLENBQUMsV0FBVyxDQUFDLEtBQUssQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7cUJBQ2pDO2lCQUNKO3FCQUFNLElBQUksSUFBSSxDQUFDLElBQUksS0FBSyxNQUFNLElBQUksZUFBZSxDQUFDLE1BQU0sRUFBRTs7d0JBQ25ELGVBQWUsR0FBUSxFQUFFO29CQUM3QixJQUFJLGFBQWEsQ0FBQyxTQUFTOzs7O29CQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxLQUFLLENBQUMsRUFBQyxJQUFJLENBQUMsRUFBRTt3QkFDNUMsU0FBUztxQkFDWjtvQkFDRCxLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsUUFBUSxFQUFFLENBQUMsRUFBRSxFQUFFO3dCQUMvQixJQUFJLEtBQUssQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDLENBQUMsY0FBYyxDQUFDLGVBQWUsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxlQUFlLENBQUMsR0FBRyxFQUFFLENBQUMsS0FBSyxDQUFDLENBQUMsR0FBRyxFQUFFLENBQUMsRUFBRTs0QkFDbkgsSUFBSSxLQUFLLENBQUMsWUFBWSxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxZQUFZLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLFFBQVEsRUFBRSxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLElBQUksS0FBSyxDQUFDLFlBQVksQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsUUFBUSxFQUFFLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsSUFBSSxLQUFLLENBQUMsWUFBWSxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxRQUFRLEVBQUUsQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxDQUFDLEVBQUU7Z0NBQ3ZNLEtBQUssQ0FBQyxZQUFZLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQzs2QkFDaEM7eUJBQ0o7cUJBQ0o7OzBCQUNLLFlBQVksR0FBRyxFQUFFO29CQUN2QixLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsZUFBZSxDQUFDLE1BQU0sRUFBRSxDQUFDLEVBQUUsRUFBRTs7OEJBQ3ZDLFdBQVcsR0FBRyxDQUFDLEdBQUcsWUFBWSxDQUFDLE1BQU07Ozs4QkFFckMsVUFBVSxHQUFHLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxTQUFTOzs7O3dCQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLElBQUksS0FBSyxlQUFlLENBQUMsQ0FBQyxDQUFDLEVBQUM7d0JBQ3RGLGVBQWUsR0FBRyxFQUFFLENBQUM7d0JBQ3JCLEtBQUssSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxFQUFFLEVBQUU7NEJBQ3pCLGVBQWUsQ0FBQyxlQUFlLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxLQUFLLENBQUMsV0FBVyxDQUFDLFdBQVcsQ0FBQyxDQUFDLGVBQWUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO3lCQUM1Rjs7OEJBQ0ssWUFBWSxHQUFHLE1BQU0sQ0FBQyxvQkFBb0IsRUFBRSxlQUFlLENBQUM7d0JBQ2xFLElBQUksQ0FBQyxDQUFDLFlBQVksSUFBSSxDQUFDLFlBQVksQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxXQUFXLENBQUMsV0FBVyxDQUFDLENBQUMsY0FBYyxDQUFDLGVBQWUsQ0FBQyxFQUFFOzRCQUM1Ryw4QkFBOEI7NEJBQzlCLDZEQUE2RDs0QkFDN0Qsb0JBQW9CLENBQUMsSUFBSSxDQUFDLGVBQWUsQ0FBQyxDQUFDOztrQ0FDckMsS0FBSyxHQUFHLElBQUksQ0FBQyxjQUFjLENBQUMsQ0FBQyxDQUFDLENBQUMsVUFBVSxDQUFDOzRCQUNoRCxLQUFLLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQzs0QkFDakIsS0FBSyxDQUFDLFFBQVEsR0FBRyxJQUFJLENBQUM7NEJBQ3RCLEtBQUssQ0FBQyxTQUFTLEdBQUcsU0FBUyxDQUFDOzRCQUM1QixLQUFLLENBQUMsT0FBTyxDQUFDLFdBQVcsRUFBRSxDQUFDLENBQUMsQ0FBQzs0QkFDOUIsS0FBSyxDQUFDLFlBQVksQ0FBQyxXQUFXLEVBQUUsSUFBSSxDQUFDLGtCQUFrQixDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7NEJBQzVELEtBQUssQ0FBQyxRQUFRLENBQUMsV0FBVyxFQUFFLEtBQUssRUFBRSxLQUFLLENBQUMsQ0FBQzs0QkFDMUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxXQUFXLEVBQUUsS0FBSyxDQUFDLENBQUMsS0FBSyxDQUFDLGVBQWUsQ0FBQyxlQUFlLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDOzRCQUM3RSxLQUFLLENBQUMsT0FBTyxDQUFDLFdBQVcsRUFBRSxLQUFLLEVBQUUsQ0FBQyxFQUFFLENBQUMsUUFBUSxHQUFHLEtBQUssQ0FBQyxDQUFDLENBQUM7NEJBQ3pELEtBQUssQ0FBQyxPQUFPLENBQUMsV0FBVyxFQUFFLEtBQUssQ0FBQyxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQzs0QkFDMUQsY0FBYyxDQUFDLFdBQVcsR0FBRyxFQUFFLENBQUMsR0FBRyxFQUFFLFNBQVMsRUFBRSxDQUFDLEVBQUUsUUFBUSxFQUFFLENBQUMsRUFBRSxDQUFDOzRCQUNqRSxJQUFJLENBQUMsS0FBSyxDQUFDLGVBQWUsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDLEVBQUU7Z0NBQ3BDLGNBQWMsQ0FBQyxDQUFDLFdBQVcsR0FBRyxDQUFDLENBQUMsR0FBRyxFQUFFLENBQUMsR0FBRyxFQUFFLFNBQVMsRUFBRSxlQUFlLENBQUMsTUFBTSxFQUFFLFFBQVEsRUFBRSxDQUFDLEVBQUUsQ0FBQzs2QkFDL0Y7NEJBQ0QsUUFBUSxJQUFJLENBQUMsQ0FBQzs0QkFDZCxZQUFZLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDOzRCQUNyQixhQUFhLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxDQUFDO3lCQUNuQzs2QkFBTTs0QkFDSCxJQUFJLEtBQUssQ0FBQyxXQUFXLENBQUMsV0FBVyxDQUFDLENBQUMsY0FBYyxDQUFDLGVBQWUsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLFdBQVcsQ0FBQyxXQUFXLENBQUMsQ0FBQyxlQUFlLENBQUMsR0FBRyxFQUFFLENBQUMsS0FBSyxDQUFDLENBQUMsR0FBRyxFQUFFLENBQUMsRUFBRTtnQ0FDdkksU0FBUzs2QkFDWjs0QkFDRCxJQUFJLENBQUMsS0FBSyxDQUFDLGVBQWUsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDLEVBQUU7Z0NBQ3BDLGNBQWMsQ0FBQyxDQUFDLFdBQVcsR0FBRyxDQUFDLENBQUMsR0FBRyxFQUFFLENBQUMsR0FBRyxFQUFFLFNBQVMsRUFBRSxlQUFlLENBQUMsTUFBTSxFQUFFLFFBQVEsRUFBRSxDQUFDLEVBQUUsQ0FBQzs2QkFDL0Y7eUJBQ0o7cUJBQ0o7aUJBQ0o7YUFDSjtTQUNKO1FBQ0QsS0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLFFBQVEsRUFBRSxDQUFDLEVBQUUsRUFBRTtZQUMvQixJQUFJLENBQUMsY0FBYyxDQUFDLGNBQWMsQ0FBQyxDQUFDLENBQUMsRUFBRTtnQkFDbkMsTUFBTTthQUNUO1lBQ0QsS0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxJQUFJLGNBQWMsQ0FBQyxDQUFDLEdBQUcsRUFBRSxDQUFDLENBQUMsU0FBUyxFQUFFLENBQUMsRUFBRSxFQUFFO2dCQUN4RCxLQUFLLENBQUMsV0FBVyxDQUFDLEtBQUssQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7YUFDakM7WUFDRCxLQUFLLENBQUMsV0FBVyxDQUFDLENBQUMsRUFBRSxLQUFLLEVBQUUsSUFBSSxZQUFZLENBQUMsSUFBSSxFQUFFLEtBQUssRUFBRSxjQUFjLENBQUMsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxDQUFDLFNBQVMsRUFBRSxjQUFjLENBQUMsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUM7U0FDakk7UUFDRCxJQUFJLElBQUksQ0FBQyxJQUFJLEtBQUssVUFBVSxJQUFJLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxNQUFNLENBQUMsRUFBRTtZQUMzRCxJQUFJLENBQUMsU0FBUyxDQUFDLEtBQUssQ0FBQyxDQUFDO1NBQ3pCO0lBQ0wsQ0FBQzs7Ozs7O0lBRUQsYUFBYSxDQUFDLGFBQWtCLEVBQUUsTUFBVztRQUN6QyxJQUFJLE1BQU0sSUFBSSxNQUFNLENBQUMsV0FBVyxJQUFJLE1BQU0sQ0FBQyxXQUFXLENBQUMsWUFBWSxJQUFJLE1BQU0sQ0FBQyxXQUFXLENBQUMsWUFBWSxDQUFDLE9BQU8sSUFBSSxNQUFNLENBQUMsV0FBVyxDQUFDLFlBQVksQ0FBQyxPQUFPLENBQUMsTUFBTSxFQUFFO1lBQzlKLElBQUksQ0FBQyxrQkFBa0IsR0FBRyxDQUFDLENBQUM7WUFDNUIsTUFBTSxDQUFDLFdBQVcsQ0FBQyxZQUFZLENBQUMsT0FBTyxDQUFDLE9BQU87Ozs7WUFBQyxDQUFDLEdBQVEsRUFBRSxFQUFFO2dCQUN6RCxJQUFJLENBQUMsdUJBQXVCLENBQUMsYUFBYSxFQUFFLEdBQUcsRUFBRSxJQUFJLENBQUMsQ0FBQztZQUMzRCxDQUFDLEVBQUMsQ0FBQztTQUNOO0lBQ0wsQ0FBQzs7Ozs7O0lBRUQsZUFBZSxDQUFDLE1BQVcsRUFBRSxNQUFXO1FBQ3BDLElBQUksTUFBTSxJQUFJLE1BQU0sQ0FBQyxXQUFXLElBQUksTUFBTSxDQUFDLFdBQVcsQ0FBQyxZQUFZLElBQUksTUFBTSxDQUFDLFdBQVcsQ0FBQyxZQUFZLENBQUMsT0FBTyxJQUFJLE1BQU0sQ0FBQyxXQUFXLENBQUMsWUFBWSxDQUFDLE9BQU8sQ0FBQyxNQUFNLEVBQUU7WUFDOUosTUFBTSxDQUFDLFdBQVcsQ0FBQyxZQUFZLENBQUMsT0FBTyxDQUFDLE9BQU87Ozs7WUFBQyxDQUFDLEdBQVEsRUFBRSxFQUFFO2dCQUN6RCxJQUFJLENBQUMsb0JBQW9CLENBQUMsR0FBRyxFQUFFLElBQUksRUFBRSxNQUFNLENBQUMsQ0FBQztZQUNqRCxDQUFDLEVBQUMsQ0FBQztTQUNOO0lBQ0wsQ0FBQzs7Ozs7O0lBRUQsY0FBYyxDQUFDLFVBQWUsRUFBRSxNQUFXO1FBQ3ZDLElBQUksTUFBTSxJQUFJLE1BQU0sQ0FBQyxXQUFXLElBQUksTUFBTSxDQUFDLFdBQVcsQ0FBQyxZQUFZLElBQUksTUFBTSxDQUFDLFdBQVcsQ0FBQyxZQUFZLENBQUMsT0FBTyxJQUFJLE1BQU0sQ0FBQyxXQUFXLENBQUMsWUFBWSxDQUFDLE9BQU8sQ0FBQyxNQUFNLEVBQUU7WUFDOUosSUFBSSxDQUFDLGtCQUFrQixHQUFHLENBQUMsQ0FBQztZQUM1QixNQUFNLENBQUMsV0FBVyxDQUFDLFlBQVksQ0FBQyxPQUFPLENBQUMsT0FBTzs7OztZQUFDLENBQUMsR0FBUSxFQUFFLEVBQUU7Z0JBQ3pELElBQUksQ0FBQyx3QkFBd0IsQ0FBQyxVQUFVLEVBQUUsR0FBRyxFQUFFLElBQUksQ0FBQyxDQUFDO1lBQ3pELENBQUMsRUFBQyxDQUFDO1NBQ047SUFDTCxDQUFDOzs7OztJQUVELGlCQUFpQixDQUFDLE1BQVc7UUFDekIsSUFBSTtZQUNBLElBQUksTUFBTSxJQUFJLE1BQU0sQ0FBQyxXQUFXLElBQUksTUFBTSxDQUFDLFdBQVcsQ0FBQyxXQUFXLElBQUksTUFBTSxDQUFDLFdBQVcsQ0FBQyxXQUFXLENBQUMsY0FBYyxJQUFJLElBQUksSUFBSSxNQUFNLENBQUMsV0FBVyxDQUFDLFdBQVcsQ0FBQyxjQUFjLElBQUksU0FBUyxFQUFFO2dCQUN2TCxPQUFPLE1BQU0sQ0FBQyxXQUFXLENBQUMsV0FBVyxDQUFDLGNBQWMsQ0FBQzthQUN4RDtZQUNELE9BQU8sSUFBSSxDQUFDO1NBQ2Y7UUFBQyxPQUFPLENBQUMsRUFBRTtZQUNSLE9BQU8sSUFBSSxDQUFDO1NBQ2Y7SUFDTCxDQUFDOzs7OztJQUVELGdCQUFnQixDQUFDLE1BQVc7UUFDeEIsSUFBSTtZQUNBLElBQUksTUFBTSxJQUFJLE1BQU0sQ0FBQyxXQUFXLElBQUksTUFBTSxDQUFDLFdBQVcsQ0FBQyxXQUFXLElBQUksTUFBTSxDQUFDLFdBQVcsQ0FBQyxXQUFXLENBQUMsYUFBYSxJQUFJLElBQUksSUFBSSxNQUFNLENBQUMsV0FBVyxDQUFDLFdBQVcsQ0FBQyxhQUFhLElBQUksU0FBUyxFQUFFO2dCQUNyTCxPQUFPLE1BQU0sQ0FBQyxXQUFXLENBQUMsV0FBVyxDQUFDLGFBQWEsQ0FBQzthQUN2RDtZQUNELE9BQU8sSUFBSSxDQUFDO1NBQ2Y7UUFBQyxPQUFPLENBQUMsRUFBRTtZQUNSLE9BQU8sSUFBSSxDQUFDO1NBQ2Y7SUFDTCxDQUFDOzs7OztJQUVELFlBQVksQ0FBQyxNQUFXO1FBQ3BCLElBQUk7WUFDQSxJQUFJLE1BQU0sSUFBSSxNQUFNLENBQUMsV0FBVyxJQUFJLE1BQU0sQ0FBQyxXQUFXLENBQUMsV0FBVyxJQUFJLE1BQU0sQ0FBQyxXQUFXLENBQUMsV0FBVyxDQUFDLFNBQVMsSUFBSSxJQUFJLElBQUksTUFBTSxDQUFDLFdBQVcsQ0FBQyxXQUFXLENBQUMsU0FBUyxJQUFJLFNBQVMsRUFBRTtnQkFDN0ssT0FBTyxNQUFNLENBQUMsV0FBVyxDQUFDLFdBQVcsQ0FBQyxTQUFTLENBQUM7YUFDbkQ7WUFDRCxPQUFPLEtBQUssQ0FBQztTQUNoQjtRQUFDLE9BQU8sQ0FBQyxFQUFFO1lBQ1IsT0FBTyxLQUFLLENBQUM7U0FDaEI7SUFDTCxDQUFDOzs7Ozs7OztJQUVPLHdCQUF3QixDQUFDLFVBQWUsRUFBRSxNQUFXLEVBQUUsU0FBZ0I7UUFDM0UsSUFBSSxNQUFNLEVBQUU7WUFDUixJQUFJLE1BQU0sQ0FBQyxTQUFTLElBQUksTUFBTSxDQUFDLFNBQVMsQ0FBQyxNQUFNLEVBQUU7Z0JBQzdDLElBQUksQ0FBQyx3QkFBd0IsQ0FBQyxVQUFVLEVBQUUsSUFBSSxFQUFFLE1BQU0sQ0FBQyxTQUFTLENBQUMsQ0FBQzthQUNyRTtpQkFBTTtnQkFDSCxJQUFJLE1BQU0sQ0FBQyxVQUFVLElBQUksQ0FBQyxJQUFJLE1BQU0sQ0FBQyxXQUFXLEVBQUU7b0JBQzlDLFVBQVUsQ0FBQyxJQUFJLENBQUMsRUFBRSxXQUFXLEVBQUUsTUFBTSxDQUFDLFNBQVMsRUFBRSxXQUFXLEVBQUUsTUFBTSxDQUFDLFdBQVcsRUFBRSxTQUFTLEVBQUUsTUFBTSxDQUFDLFNBQVMsRUFBRSxDQUFDLENBQUM7aUJBQ3BIO2FBQ0o7U0FDSjthQUFNO1lBQ0gsU0FBUyxDQUFDLE9BQU87Ozs7WUFBQyxDQUFDLEdBQVEsRUFBRSxFQUFFO2dCQUMzQixJQUFJLEdBQUcsQ0FBQyxTQUFTLElBQUksR0FBRyxDQUFDLFNBQVMsQ0FBQyxNQUFNLEVBQUU7b0JBQ3ZDLElBQUksQ0FBQyx3QkFBd0IsQ0FBQyxVQUFVLEVBQUUsSUFBSSxFQUFFLEdBQUcsQ0FBQyxTQUFTLENBQUMsQ0FBQztpQkFDbEU7cUJBQU07b0JBQ0gsSUFBSSxHQUFHLENBQUMsVUFBVSxJQUFJLENBQUMsSUFBSSxHQUFHLENBQUMsV0FBVyxFQUFFO3dCQUN4QyxVQUFVLENBQUMsSUFBSSxDQUFDLEVBQUUsV0FBVyxFQUFFLEdBQUcsQ0FBQyxTQUFTLEVBQUUsV0FBVyxFQUFFLEdBQUcsQ0FBQyxXQUFXLEVBQUUsU0FBUyxFQUFFLEdBQUcsQ0FBQyxTQUFTLEVBQUUsQ0FBQyxDQUFDO3FCQUMzRztpQkFDSjtZQUNMLENBQUMsRUFBQyxDQUFDO1NBQ047SUFDTCxDQUFDOzs7Ozs7OztJQUVPLHVCQUF1QixDQUFDLGFBQWtCLEVBQUUsTUFBVyxFQUFFLFNBQWdCO1FBQzdFLElBQUksTUFBTSxFQUFFO1lBQ1IsSUFBSSxNQUFNLENBQUMsU0FBUyxJQUFJLE1BQU0sQ0FBQyxTQUFTLENBQUMsTUFBTSxFQUFFO2dCQUM3QyxJQUFJLENBQUMsdUJBQXVCLENBQUMsYUFBYSxFQUFFLElBQUksRUFBRSxNQUFNLENBQUMsU0FBUyxDQUFDLENBQUM7YUFDdkU7aUJBQU07Z0JBQ0gsSUFBSSxNQUFNLENBQUMsT0FBTyxFQUFFO29CQUNoQixhQUFhLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxTQUFTLENBQUMsQ0FBQztpQkFDeEM7YUFDSjtTQUNKO2FBQU07WUFDSCxTQUFTLENBQUMsT0FBTzs7OztZQUFDLENBQUMsR0FBUSxFQUFFLEVBQUU7Z0JBQzNCLElBQUksR0FBRyxDQUFDLFNBQVMsSUFBSSxHQUFHLENBQUMsU0FBUyxDQUFDLE1BQU0sRUFBRTtvQkFDdkMsSUFBSSxDQUFDLHVCQUF1QixDQUFDLGFBQWEsRUFBRSxJQUFJLEVBQUUsR0FBRyxDQUFDLFNBQVMsQ0FBQyxDQUFDO2lCQUNwRTtxQkFBTTtvQkFDSCxJQUFJLEdBQUcsQ0FBQyxPQUFPLEVBQUU7d0JBQ2IsYUFBYSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsU0FBUyxDQUFDLENBQUM7cUJBQ3JDO2lCQUNKO1lBQ0wsQ0FBQyxFQUFDLENBQUM7U0FDTjtJQUNMLENBQUM7Ozs7OztJQUVELFdBQVcsQ0FBQyxTQUFjLEVBQUUsU0FBYzs7Y0FDaEMsR0FBRyxHQUFHLFNBQVMsQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDOztjQUMxQixJQUFJLEdBQUcsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUM7O2NBQ3hCLElBQUksR0FBRyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQztRQUM5QixLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsSUFBSSxDQUFDLE1BQU0sRUFBRSxDQUFDLEVBQUUsRUFBRTtZQUNsQyx5Q0FBeUM7WUFDekMsSUFBSSxJQUFJLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxTQUFTLEdBQUcsRUFBRSxDQUFDLEVBQUU7Z0JBQzdCLFNBQVMsR0FBRyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7Z0JBQ3BCLE1BQU07YUFDVDtTQUNKO1FBQ0QsT0FBTyxTQUFTLENBQUM7SUFDckIsQ0FBQzs7Ozs7SUFFRCxTQUFTLENBQUMsS0FBVTtRQUNoQixLQUFLLENBQUMsT0FBTyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQztRQUNwQixLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsS0FBSyxDQUFDLFdBQVcsRUFBRSxFQUFFLENBQUMsRUFBRSxFQUFFO1lBQzFDLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxFQUFFLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxTQUFTLENBQUMsU0FBUyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7U0FDcEY7UUFDRCxLQUFLLENBQUMsWUFBWSxDQUFDLENBQUMsRUFBRSxJQUFJLENBQUMsa0JBQWtCLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNsRCxLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsS0FBSyxDQUFDLGNBQWMsRUFBRSxFQUFFLENBQUMsRUFBRSxFQUFFOztrQkFDdkMsQ0FBQyxHQUFHLElBQUksRUFBRSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsS0FBSyxFQUFFO1lBQ3RDLENBQUMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLGNBQWMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxDQUFDO1lBQy9DLENBQUMsQ0FBQyxNQUFNLEdBQUcsS0FBSyxDQUFDO1lBQ2pCLENBQUMsQ0FBQyxTQUFTLEdBQUcsR0FBRyxDQUFDO1lBQ2xCLEtBQUssQ0FBQyxRQUFRLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQztZQUN4QixLQUFLLENBQUMsV0FBVyxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsSUFBSSxjQUFjLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQztTQUN0RDs7Y0FDSyxNQUFNLEdBQUcsSUFBSSxFQUFFLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsYUFBYSxDQUFDLElBQUksRUFBRSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsS0FBSyxDQUFDLFdBQVcsRUFBRSxFQUFFLEtBQUssQ0FBQyxjQUFjLEVBQUUsQ0FBQyxDQUFDO1FBQ3ZJLEtBQUssQ0FBQyxTQUFTLENBQUMsTUFBTSxDQUFDLENBQUM7UUFDeEIsTUFBTSxDQUFDLG1CQUFtQixDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQ3RDLENBQUM7Ozs7OztJQUVELFNBQVMsQ0FBQyxNQUFXLEVBQUUsS0FBVTtRQUM3QixJQUFJOztrQkFDTSxJQUFJLEdBQUcsSUFBSTs7a0JBQ1gsUUFBUSxHQUFHLEtBQUssQ0FBQyxXQUFXLEVBQUU7O2tCQUM5QixRQUFRLEdBQUcsS0FBSyxDQUFDLGNBQWMsRUFBRTtZQUN2Qyx3REFBd0Q7WUFDeEQsS0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLENBQUMsUUFBUSxDQUFDLEVBQUUsQ0FBQyxFQUFFLEVBQUU7O3NCQUMzQixRQUFRLEdBQUcsS0FBSyxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUM7Z0JBQ3JDLElBQUksUUFBUSxDQUFDLGNBQWMsQ0FBQyxnQkFBZ0IsQ0FBQyxJQUFJLFFBQVEsQ0FBQyxjQUFjLENBQUMsY0FBYyxDQUFDLGVBQWUsQ0FBQyxFQUFFO29CQUN0RyxTQUFTO2lCQUNaO2dCQUNELEtBQUssSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxRQUFRLEVBQUUsQ0FBQyxFQUFFLEVBQUU7OzBCQUN6QixVQUFVLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsbUJBQW1CLENBQUMsWUFBWSxDQUFDLENBQUM7b0JBQ3JFLHlDQUF5QztvQkFDekMsS0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLFVBQVUsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxFQUFFLEVBQUU7OzhCQUNsQyxFQUFFLEdBQUcsVUFBVSxDQUFDLENBQUMsQ0FBQzt3QkFDeEIsSUFBSSxFQUFFLENBQUMsdUJBQXVCLEtBQUssQ0FBQyxFQUFFOzRCQUNsQyxJQUFJLEVBQUUsQ0FBQyxTQUFTLEtBQUssSUFBSSxDQUFDLGdCQUFnQixDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksRUFBRTtnQ0FDaEQsSUFBSSxDQUFDLElBQUksQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxFQUFFO29DQUNwQyxJQUFJLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsR0FBRyxFQUFFLENBQUM7aUNBQzFDO2dDQUNELElBQUksQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsR0FBRyxFQUFFLENBQUMsR0FBRyxFQUFFLENBQUM7O3NDQUN6QyxFQUFFLEdBQUcsSUFBSSxFQUFFLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxTQUFTLENBQUMsU0FBUyxFQUFFO2dDQUNyRCxFQUFFLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsS0FBSyxFQUFFLEVBQUUsSUFBSSxDQUFDLGdCQUFnQixDQUFDLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUM7Z0NBQ3BGLEVBQUUsQ0FBQyxhQUFhLENBQUMsSUFBSSxDQUFDLENBQUM7Z0NBQ3ZCLEVBQUUsQ0FBQyxhQUFhOzs7Z0NBQUM7b0NBQ2IsTUFBTSxDQUFDLGNBQWMsRUFBRSxDQUFDLE9BQU8sQ0FBQzt3Q0FDNUIsR0FBRyxFQUFFLGVBQWU7d0NBQ3BCLElBQUksRUFBRSxJQUFJO3FDQUNiLENBQUMsQ0FBQztnQ0FDUCxDQUFDLEVBQUMsQ0FBQztnQ0FDSCxLQUFLLENBQUMsV0FBVyxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsRUFBRSxFQUFFLEVBQUUsQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLFNBQVMsQ0FBQyxRQUFRLENBQUMsQ0FBQzs2QkFDcEU7eUJBQ0o7cUJBQ0o7aUJBQ0o7YUFDSjtZQUNELE1BQU0sQ0FBQyxjQUFjLEVBQUUsQ0FBQyxRQUFRLENBQUMsZUFBZSxFQUFFO2dCQUM5QyxPQUFPLEVBQUUsSUFBSTtnQkFDYixPQUFPOzs7Ozs7Z0JBQUUsVUFBVSxPQUFPLEVBQUUsT0FBTyxFQUFFLE1BQU07OzBCQUNqQyxHQUFHLEdBQUcsT0FBTyxDQUFDLGNBQWMsRUFBRSxDQUFDLGlCQUFpQixFQUFFOzswQkFDbEQsR0FBRyxHQUFHLE9BQU8sQ0FBQyxjQUFjLEVBQUUsQ0FBQyxvQkFBb0IsRUFBRTtvQkFDM0QsS0FBSyxNQUFNLEdBQUcsSUFBSSxPQUFPLENBQUMsSUFBSSxDQUFDLGNBQWMsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxFQUFFO3dCQUNqRSxJQUFJLEdBQUcsS0FBSyxDQUFDLEdBQUcsR0FBRyxFQUFFLENBQUMsRUFBRTs7a0NBQ2QsRUFBRSxHQUFHLE9BQU8sQ0FBQyxJQUFJLENBQUMsY0FBYyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUMsR0FBRyxDQUFDOztnQ0FDN0QsV0FBVyxHQUFHLEVBQUUsSUFBSSxFQUFFLE1BQU0sRUFBRTs7a0NBQzVCLFFBQVEsR0FBRyxJQUFJLEdBQUcsRUFBa0I7O2tDQUNwQyxXQUFXLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLG1CQUFtQixDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUMsTUFBTTs7Ozs0QkFBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxVQUFVLEtBQUssRUFBRSxDQUFDLElBQUksQ0FBQyxFQUFDOztrQ0FDL0csU0FBUyxHQUFHLE9BQU8sQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxXQUFXLENBQUMsUUFBUSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLEdBQUcsWUFBWSxDQUFDOztnQ0FDL0YsUUFBUSxHQUFHLEVBQUUsSUFBSSxFQUFFLE1BQU0sRUFBRTs0QkFDL0IsSUFBSSxTQUFTLENBQUMsV0FBVyxLQUFLLFVBQVUsRUFBRSxFQUFFLE1BQU07Z0NBQzlDLFdBQVc7Z0NBQ1gsS0FBSyxJQUFJLENBQUMsR0FBRyxTQUFTLENBQUMsZ0JBQWdCLENBQUMsS0FBSyxFQUFFLENBQUMsR0FBRyxTQUFTLENBQUMsZ0JBQWdCLENBQUMsR0FBRyxFQUFFLENBQUMsRUFBRSxFQUFFOzswQ0FDOUUsS0FBSyxHQUFHLE9BQU8sQ0FBQyxjQUFjLEVBQUUsQ0FBQyxRQUFRLENBQUMsR0FBRyxFQUFFLENBQUMsRUFBRSxFQUFFLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxTQUFTLENBQUMsUUFBUSxDQUFDOzswQ0FDdEYsSUFBSSxHQUFHLE9BQU8sQ0FBQyxjQUFjLEVBQUUsQ0FBQyxRQUFRLENBQUMsU0FBUyxDQUFDLGdCQUFnQixDQUFDLEtBQUssRUFBRSxDQUFDLEVBQUUsRUFBRSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsU0FBUyxDQUFDLFNBQVMsQ0FBQzs7MENBQ25ILE9BQU8sR0FBRyxTQUFTLENBQUMsUUFBUSxDQUFDLElBQUk7Ozs7b0NBQUMsQ0FBQyxDQUFNLEVBQUUsRUFBRSxDQUFDLENBQUMsQ0FBQyxTQUFTLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLEtBQUssSUFBSSxFQUFDLENBQUMsU0FBUztvQ0FDbkcsUUFBUSxDQUFDLE9BQU8sQ0FBQyxHQUFHLEtBQUssQ0FBQztpQ0FDN0I7Z0NBQ0QsV0FBVztnQ0FDWCxLQUFLLElBQUksQ0FBQyxHQUFHLFNBQVMsQ0FBQyxnQkFBZ0IsQ0FBQyxLQUFLLEVBQUUsQ0FBQyxHQUFHLFNBQVMsQ0FBQyxnQkFBZ0IsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxFQUFFLEVBQUU7OzBDQUM5RSxLQUFLLEdBQUcsT0FBTyxDQUFDLGNBQWMsRUFBRSxDQUFDLFFBQVEsQ0FBQyxDQUFDLEVBQUUsR0FBRyxFQUFFLEVBQUUsQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLFNBQVMsQ0FBQyxTQUFTLENBQUM7OzBDQUN2RixPQUFPLEdBQUcsU0FBUyxDQUFDLFFBQVEsQ0FBQyxNQUFNOzs7O29DQUFDLENBQUMsQ0FBTSxFQUFFLEVBQUUsQ0FBQyxDQUFDLENBQUMsU0FBUyxLQUFLLENBQUMsRUFBQyxDQUFDLENBQUMsR0FBRyxTQUFTLENBQUMsZ0JBQWdCLENBQUMsS0FBSyxDQUFDLENBQUMsU0FBUztvQ0FDeEgsUUFBUSxDQUFDLE9BQU8sQ0FBQyxHQUFHLEtBQUssQ0FBQztpQ0FDN0I7OztzQ0FFSyxLQUFLLEdBQUcsT0FBTyxDQUFDLGNBQWMsRUFBRSxDQUFDLFFBQVEsQ0FBQyxHQUFHLEVBQUUsR0FBRyxFQUFFLEVBQUUsQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLFNBQVMsQ0FBQyxRQUFRLENBQUM7O3NDQUN4RixJQUFJLEdBQUcsT0FBTyxDQUFDLGNBQWMsRUFBRSxDQUFDLFFBQVEsQ0FBQyxTQUFTLENBQUMsZ0JBQWdCLENBQUMsR0FBRyxFQUFFLEdBQUcsRUFBRSxFQUFFLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxTQUFTLENBQUMsU0FBUyxDQUFDOztvQ0FDckgsT0FBTyxHQUFHLFNBQVMsQ0FBQyxRQUFRLENBQUMsSUFBSTs7OztnQ0FBQyxDQUFDLENBQU0sRUFBRSxFQUFFLENBQUMsQ0FBQyxDQUFDLFNBQVMsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDLElBQUksS0FBSyxJQUFJLEVBQUM7Z0NBQ3ZGLElBQUksT0FBTyxFQUFFO29DQUNULE9BQU8sR0FBRyxPQUFPLENBQUMsU0FBUyxDQUFDO29DQUM1QixRQUFRLENBQUMsT0FBTyxDQUFDLEdBQUcsS0FBSyxDQUFDO2lDQUM3Qjs2QkFDSjtpQ0FBTTtnQ0FDSCxRQUFRLEdBQUcsT0FBTyxDQUFDLGNBQWMsRUFBRSxDQUFDLFdBQVcsQ0FBQyxHQUFHLENBQUMsQ0FBQzs2QkFDeEQ7O2tDQUVLLG1CQUFtQixHQUFHLFFBQVE7NEJBQ3BDLElBQUksV0FBVyxDQUFDLE1BQU0sR0FBRyxDQUFDLEVBQUU7Z0NBQ3hCLFdBQVcsQ0FBQyxPQUFPOzs7O2dDQUFDLEtBQUssQ0FBQyxFQUFFO29DQUN4QixJQUFJLEtBQUssQ0FBQyxhQUFhLEVBQUUsRUFBQyxNQUFNO3dDQUM1QixJQUFJLEtBQUssQ0FBQyxTQUFTLENBQUMsT0FBTyxDQUFDLGVBQWUsQ0FBQyxJQUFJLENBQUMsRUFBRTs7a0RBQ3pDLFlBQVksR0FBRyxLQUFLLENBQUMsU0FBUyxDQUFDLE9BQU8sQ0FBQyxJQUFJLEVBQUUsRUFBRSxDQUFDLENBQUMsT0FBTyxDQUFDLElBQUksRUFBRSxFQUFFLENBQUMsQ0FBQyxPQUFPLENBQUMsaUJBQWlCLEVBQUUsRUFBRSxDQUFDLENBQUMsT0FBTyxDQUFDLEtBQUssRUFBRSxFQUFFLENBQUM7NENBQzFILE9BQU8sQ0FBQyxJQUFJLENBQUMsa0JBQWtCLENBQUMsV0FBVyxFQUFFLFFBQVEsRUFBRSxZQUFZLEVBQUUsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDO3lDQUNwRjs2Q0FBTTs0Q0FDSCxXQUFXLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxHQUFHLG1CQUFtQixDQUFDLEtBQUssQ0FBQyxTQUFTLENBQUMsQ0FBQzs0Q0FDL0QsUUFBUSxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsSUFBSSxFQUFFLG1CQUFtQixDQUFDLEtBQUssQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDO3lDQUNsRTtxQ0FDSjt5Q0FBTTt3Q0FDSCxXQUFXLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxHQUFHLEtBQUssQ0FBQyxTQUFTLENBQUM7d0NBQzFDLFFBQVEsQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLElBQUksRUFBRSxLQUFLLENBQUMsU0FBUyxDQUFDLENBQUM7cUNBQzdDO2dDQUNMLENBQUMsRUFBQyxDQUFDOzZCQUNOO2lDQUFNO2dDQUNILFdBQVcsR0FBRyxtQkFBbUIsQ0FBQzs2QkFDckM7O2tDQUNLLEVBQUUsR0FBUTtnQ0FDWixlQUFlLEVBQUUsT0FBTyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLFNBQVMsQ0FBQztnQ0FDbEQsV0FBVyxFQUFFLFdBQVc7NkJBQzNCOztnQ0FDRyxLQUFLLEdBQUcsRUFBRTs0QkFDZCxJQUFJLEVBQUUsQ0FBQyxVQUFVLEtBQUssTUFBTSxFQUFFOzs7c0NBRXBCLGVBQWUsR0FBRztvQ0FDcEIsU0FBUyxFQUFFLE1BQU07b0NBQ2pCLFFBQVEsRUFBRSxFQUFFLENBQUMsWUFBWTtvQ0FDekIsT0FBTyxFQUFFLFFBQVEsQ0FBQyxJQUFJLEVBQUU7b0NBQ3hCLE9BQU8sRUFBRSxFQUFFO29DQUNYLGFBQWEsRUFBRSxFQUFFO29DQUNqQixjQUFjLEVBQUUsRUFBRSxDQUFDLFdBQVc7b0NBQzlCLG1CQUFtQixFQUFFLFFBQVE7b0NBQzdCLFVBQVUsRUFBRSxJQUFJO2lDQUNuQjtnQ0FDRCxLQUFLLEdBQUcsV0FBVyxDQUFDLFNBQVMsQ0FBQyxlQUFlLENBQUMsQ0FBQztnQ0FDL0MsT0FBTyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRSxFQUFFLENBQUMsV0FBVyxDQUFDLENBQUM7O3NDQUN2RSxpQkFBaUIsR0FBRyxNQUFNLENBQUMsTUFBTSxDQUFDLEVBQUUsRUFBRSxlQUFlLENBQUMsY0FBYyxDQUFDLEVBQUUsV0FBVyxDQUFDLDZCQUE2QixDQUFDLEtBQUssQ0FBQyxDQUFDO2dDQUM5SCxlQUFlLENBQUMsY0FBYyxDQUFDLEdBQUcsaUJBQWlCLENBQUM7Z0NBQ3BELGNBQWM7Z0NBQ2QsbUJBQW1CLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsZUFBZSxDQUFDLENBQUM7NkJBQzFEO2lDQUFNLElBQUksRUFBRSxDQUFDLFVBQVUsS0FBSyxLQUFLLEVBQUU7O3NDQUMxQixTQUFTLEdBQUc7b0NBQ2QsT0FBTyxFQUFFLEtBQUs7b0NBQ2QsS0FBSyxFQUFFLEVBQUUsQ0FBQyxZQUFZO29DQUN0QixXQUFXLEVBQUUsRUFBRSxDQUFDLFdBQVc7b0NBQzNCLE1BQU0sRUFBRSxFQUFFO29DQUNWLFFBQVEsRUFBRSxJQUFJO29DQUNkLEtBQUssRUFBRSxRQUFRLENBQUMsSUFBSSxFQUFFO29DQUN0QixZQUFZLEVBQUUsRUFBRSxDQUFDLFdBQVc7b0NBQzVCLGlCQUFpQixFQUFFLFFBQVE7aUNBQzlCO2dDQUNELEtBQUssR0FBRyxXQUFXLENBQUMsU0FBUyxDQUFDLFNBQVMsQ0FBQyxDQUFDO2dDQUN6QyxPQUFPLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxPQUFPLEVBQUUsRUFBRSxDQUFDLFdBQVcsQ0FBQyxDQUFDOztzQ0FDbEUsaUJBQWlCLEdBQUcsTUFBTSxDQUFDLE1BQU0sQ0FBQyxFQUFFLEVBQUUsU0FBUyxDQUFDLGNBQWMsQ0FBQyxFQUFFLFdBQVcsQ0FBQyw2QkFBNkIsQ0FBQyxLQUFLLENBQUMsQ0FBQztnQ0FDeEgsU0FBUyxDQUFDLGNBQWMsQ0FBQyxHQUFHLGlCQUFpQixDQUFDO2dDQUM5QyxtQkFBbUIsQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxTQUFTLENBQUMsQ0FBQzs2QkFDcEQ7eUJBQ0o7cUJBQ0o7Z0JBQ0wsQ0FBQyxDQUFBO2FBQ0osRUFBRSxJQUFJLEVBQUUsS0FBSyxFQUFFLEtBQUssRUFBRSxLQUFLLEVBQUUsS0FBSyxDQUFDLENBQUM7U0FDeEM7UUFBQyxPQUFPLENBQUMsRUFBRSxHQUFHO0lBQ25CLENBQUM7Ozs7Ozs7SUFFRCxnQkFBZ0IsQ0FBQyxNQUFXLEVBQUUsS0FBVSxFQUFFLE1BQVc7UUFDakQsSUFBSTs7a0JBQ00sSUFBSSxHQUFHLElBQUk7O2dCQUNiLElBQUksR0FBRyxJQUFJO1lBQ2YsSUFBSTtnQkFDQSxJQUFJLElBQUksQ0FBQyxVQUFVLENBQUMsbUJBQW1CLElBQUksT0FBTyxJQUFJLENBQUMsVUFBVSxDQUFDLG1CQUFtQixJQUFJLFFBQVEsRUFBRTtvQkFDL0YsSUFBSSxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDO2lCQUMxRDthQUNKO1lBQUMsT0FBTyxDQUFDLEVBQUU7Z0JBQ1IsTUFBTSxDQUFDLENBQUM7YUFDWDs7a0JBQ0ssUUFBUSxHQUFHLEtBQUssQ0FBQyxXQUFXLEVBQUU7O2tCQUM5QixRQUFRLEdBQUcsS0FBSyxDQUFDLGNBQWMsRUFBRTs7Z0JBQ25DLFdBQVcsR0FBRyxJQUFJOztrQkFDaEIsZ0JBQWdCLEdBQUcsRUFBRTs7a0JBQ3JCLGlCQUFpQixHQUFHLEVBQUU7O2tCQUV0QixFQUNGLFlBQVksRUFBRSxXQUFXLEVBQ3pCLFVBQVUsRUFBRSxTQUFTLEVBQ3JCLGtCQUFrQixFQUFFLE9BQU8sRUFDM0IseUJBQXlCLEVBQUUsYUFBYSxFQUN4QyxZQUFZLEVBQUUsVUFBVSxFQUMzQixHQUFHLElBQUk7WUFDUixJQUFJLE9BQU8sSUFBSSxDQUFDLENBQUMsSUFBSSxJQUFJLElBQUksQ0FBQyxTQUFTLENBQUMsT0FBTyxDQUFDLENBQUMsSUFBSSxhQUFhLElBQUksQ0FBQyxDQUFDLElBQUksSUFBSSxJQUFJLENBQUMsU0FBUyxDQUFDLGFBQWEsQ0FBQyxDQUFDLEVBQUU7Z0JBQzVHLFdBQVcsR0FBRyxJQUFJLENBQUM7Z0JBQ25CLEtBQUssSUFBSSxHQUFHLElBQUksYUFBYSxFQUFFO29CQUMzQixnQkFBZ0IsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUM7aUJBQzlCO2FBQ0o7aUJBQU0sSUFBSSxTQUFTLElBQUksQ0FBQyxDQUFDLElBQUksSUFBSSxJQUFJLENBQUMsU0FBUyxDQUFDLFNBQVMsQ0FBQyxDQUFDLEVBQUU7Z0JBQzFELFdBQVcsR0FBRyxLQUFLLENBQUM7Z0JBQ3BCLEtBQUssSUFBSSxHQUFHLElBQUksU0FBUyxFQUFFO29CQUN2QixJQUFJLFNBQVMsQ0FBQyxHQUFHLENBQUMsRUFBRTs7OEJBQ1YsU0FBUyxHQUFHLEVBQUU7d0JBQ3BCLGlCQUFpQixDQUFDLEdBQUcsQ0FBQyxHQUFHLFNBQVMsQ0FBQzt3QkFDbkMsS0FBSyxJQUFJLElBQUksSUFBSSxTQUFTLENBQUMsR0FBRyxDQUFDLEVBQUU7NEJBQzdCLGlCQUFpQixDQUFDLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQzt5QkFDckM7cUJBQ0o7aUJBQ0o7YUFDSjtZQUNELEtBQUssSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxDQUFDLFFBQVEsQ0FBQyxFQUFFLENBQUMsRUFBRSxFQUFFOztzQkFDM0IsUUFBUSxHQUFHLEtBQUssQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDO2dCQUNyQyxJQUFJLFFBQVEsQ0FBQyxjQUFjLENBQUMsZ0JBQWdCLENBQUMsSUFBSSxRQUFRLENBQUMsY0FBYyxDQUFDLGNBQWMsQ0FBQyxlQUFlLENBQUMsRUFBRTtvQkFDdEcsU0FBUztpQkFDWjtnQkFDRCxLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsUUFBUSxFQUFFLENBQUMsRUFBRSxFQUFFO29CQUMvQixJQUFJLFdBQVcsRUFBRTt3QkFDYixLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsZ0JBQWdCLENBQUMsTUFBTSxFQUFFLENBQUMsRUFBRSxFQUFFOzRCQUM5QyxJQUFJLENBQUMsSUFBSSxDQUFDLGdCQUFnQixDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxFQUFFOztzQ0FDMUIsRUFBRSxHQUFHLElBQUksRUFBRSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsU0FBUyxDQUFDLFNBQVMsRUFBRTs7c0NBQy9DLFNBQVMsR0FBRyxLQUFLLENBQUMsWUFBWSxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUM7Z0NBQzFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxLQUFLLEVBQUUsRUFBRSxTQUFTLENBQUMsQ0FBQyxDQUFDO2dDQUMzRCxFQUFFLENBQUMsYUFBYSxDQUFDLElBQUksQ0FBQyxDQUFDO2dDQUN2QixFQUFFLENBQUMsYUFBYTs7O2dDQUFDO29DQUNiLE1BQU0sQ0FBQyxjQUFjLEVBQUUsQ0FBQyxPQUFPLENBQUM7d0NBQzVCLEdBQUcsRUFBRSxlQUFlO3dDQUNwQixJQUFJLEVBQUUsSUFBSTtxQ0FDYixDQUFDLENBQUM7Z0NBQ1AsQ0FBQyxFQUFDLENBQUM7Z0NBQ0gsS0FBSyxDQUFDLFdBQVcsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLEVBQUUsRUFBRSxFQUFFLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxTQUFTLENBQUMsUUFBUSxDQUFDLENBQUM7NkJBQ3BFO3lCQUNKO3FCQUNKO3lCQUFNO3dCQUNILEtBQUssSUFBSSxHQUFHLElBQUksaUJBQWlCLEVBQUU7NEJBQy9CLElBQUksQ0FBQyxDQUFDLEdBQUcsRUFBRSxDQUFDLEtBQUssR0FBRyxFQUFFO2dDQUNsQixLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsaUJBQWlCLENBQUMsR0FBRyxDQUFDLENBQUMsTUFBTSxFQUFFLENBQUMsRUFBRSxFQUFFOzswQ0FDOUMsRUFBRSxHQUFHLElBQUksRUFBRSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsU0FBUyxDQUFDLFNBQVMsRUFBRTs7MENBQy9DLFNBQVMsR0FBRyxLQUFLLENBQUMsWUFBWSxDQUFDLENBQUMsRUFBRSxpQkFBaUIsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztvQ0FDbEUsRUFBRSxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQyxFQUFFLGlCQUFpQixDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxFQUFFLEVBQUUsU0FBUyxDQUFDLENBQUMsQ0FBQztvQ0FDbkYsRUFBRSxDQUFDLGFBQWEsQ0FBQyxJQUFJLENBQUMsQ0FBQztvQ0FDdkIsRUFBRSxDQUFDLGFBQWE7OztvQ0FBQzt3Q0FDYixNQUFNLENBQUMsY0FBYyxFQUFFLENBQUMsT0FBTyxDQUFDOzRDQUM1QixHQUFHLEVBQUUsZUFBZTs0Q0FDcEIsSUFBSSxFQUFFLElBQUk7eUNBQ2IsQ0FBQyxDQUFDO29DQUNQLENBQUMsRUFBQyxDQUFDO29DQUNILEtBQUssQ0FBQyxXQUFXLENBQUMsQ0FBQyxFQUFFLGlCQUFpQixDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLEVBQUUsRUFBRSxFQUFFLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxTQUFTLENBQUMsUUFBUSxDQUFDLENBQUM7aUNBQzVGOzZCQUNKO3lCQUNKO3FCQUNKO2lCQUNKO2FBQ0o7WUFDRCxNQUFNLENBQUMsY0FBYyxFQUFFLENBQUMsUUFBUSxDQUFDLGVBQWUsRUFBRTtnQkFDOUMsT0FBTyxFQUFFLElBQUk7Z0JBQ2IsT0FBTzs7Ozs7O2dCQUFFLFVBQVUsT0FBTyxFQUFFLE9BQU8sRUFBRSxNQUFNOzswQkFDakMsR0FBRyxHQUFHLE9BQU8sQ0FBQyxjQUFjLEVBQUUsQ0FBQyxpQkFBaUIsRUFBRTs7MEJBQ2xELEdBQUcsR0FBRyxPQUFPLENBQUMsY0FBYyxFQUFFLENBQUMsb0JBQW9CLEVBQUU7Ozt3QkFFdkQsS0FBSzs7d0JBQUUsTUFBTTtvQkFDakIsUUFBUTtvQkFDUixJQUFJLE9BQU8sSUFBSSxDQUFDLENBQUMsSUFBSSxJQUFJLElBQUksQ0FBQyxTQUFTLENBQUMsT0FBTyxDQUFDLENBQUMsSUFBSSxhQUFhLElBQUksQ0FBQyxDQUFDLElBQUksSUFBSSxJQUFJLENBQUMsU0FBUyxDQUFDLGFBQWEsQ0FBQyxDQUFDLEVBQUU7d0JBQzVHLEtBQUssR0FBRyxPQUFPLENBQUM7d0JBQ2hCLGtCQUFrQjt3QkFDbEIsTUFBTSxHQUFHLGFBQWEsQ0FBQyxHQUFHLENBQUMsQ0FBQzt3QkFDNUIsZ0NBQWdDO3dCQUNoQyxRQUFRO3FCQUNYO3lCQUFNLElBQUksU0FBUyxJQUFJLENBQUMsQ0FBQyxJQUFJLElBQUksSUFBSSxDQUFDLFNBQVMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxJQUFJLFNBQVMsQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxJQUFJLElBQUksQ0FBQyxTQUFTLENBQUMsU0FBUyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsRUFBRTs7NEJBQ3JILFdBQVc7Ozs7NEJBR1gsYUFBYSxHQUFHLFNBQVMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLFNBQVMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLENBQUM7d0JBQzdELElBQUksYUFBYSxJQUFJLENBQUMsQ0FBQyxJQUFJLElBQUksSUFBSSxDQUFDLFNBQVMsQ0FBQyxhQUFhLENBQUMsQ0FBQyxFQUFFOzRCQUMzRCxJQUFJLENBQUMsVUFBVSxJQUFJLFVBQVUsQ0FBQyxNQUFNLEVBQUU7O3NDQUM1QixHQUFHLEdBQUcsRUFBRTtnQ0FDZCxLQUFLLElBQUksR0FBRyxJQUFJLGFBQWEsRUFBRTtvQ0FDM0IsSUFBSSxVQUFVLENBQUMsU0FBUzs7OztvQ0FBQyxDQUFDLEVBQU8sRUFBRSxFQUFFLENBQUMsRUFBRSxJQUFJLEdBQUcsRUFBQyxHQUFHLENBQUMsRUFBRTt3Q0FDbEQsR0FBRyxDQUFDLEdBQUcsQ0FBQyxHQUFHLGFBQWEsQ0FBQyxHQUFHLENBQUMsQ0FBQztxQ0FDakM7aUNBQ0o7Z0NBQ0QsYUFBYSxHQUFHLEdBQUcsQ0FBQzs2QkFDdkI7O2dDQUNHLEtBQUssR0FBRyxDQUFDOzRCQUNiLEtBQUssSUFBSSxHQUFHLElBQUksYUFBYSxFQUFFO2dDQUMzQixJQUFJLEtBQUssSUFBSSxDQUFDLEVBQUU7b0NBQ1osV0FBVyxHQUFHLEdBQUcsQ0FBQztpQ0FDckI7cUNBQU07b0NBQ0gsTUFBTTtpQ0FDVDtnQ0FDRCxLQUFLLEVBQUUsQ0FBQzs2QkFDWDs0QkFDRCxNQUFNLEdBQUcsYUFBYSxDQUFDLFdBQVcsQ0FBQyxDQUFDO3lCQUN2Qzt3QkFFRCxvQkFBb0I7d0JBQ3BCLElBQUksV0FBVyxJQUFJLElBQUksSUFBSSxXQUFXLElBQUksU0FBUyxFQUFFOzRCQUNqRCxLQUFLLEdBQUcsV0FBVyxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLElBQUksSUFBSSxDQUFDLFNBQVMsQ0FBQyxXQUFXLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxXQUFXLENBQUMsV0FBVyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUM7eUJBQ2pJO3FCQUNKOzt3QkFDRyxPQUFPO29CQUNYLElBQUksQ0FBQyxDQUFDLElBQUksSUFBSSxJQUFJLENBQUMsU0FBUyxDQUFDLEtBQUssQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLElBQUksSUFBSSxJQUFJLENBQUMsU0FBUyxDQUFDLE1BQU0sQ0FBQyxDQUFDLEVBQUU7d0JBQ3ZFLE9BQU87d0JBQ1AsT0FBTyxHQUFHLEVBQUUsSUFBSSxFQUFFLFlBQVksRUFBRSxLQUFLLEVBQUUsTUFBTSxFQUFFLFFBQVEsRUFBRSxJQUFJLENBQUMsUUFBUSxFQUFFLENBQUM7cUJBQzVFO29CQUNELElBQUksT0FBTyxFQUFFO3dCQUNULElBQUk7NEJBQ0EsTUFBTSxDQUFDLGFBQWEsRUFBRSxDQUFDLFdBQVcsQ0FBQyxPQUFPLEVBQUUsUUFBUSxDQUFDLE1BQU0sQ0FBQyxDQUFBO3lCQUMvRDt3QkFBQyxPQUFPLENBQUMsRUFBRTs0QkFDUixPQUFPLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDO3lCQUNsQjtxQkFDSjtnQkFDTCxDQUFDLENBQUE7YUFDSixFQUFFLElBQUksRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFFLEtBQUssRUFBRSxLQUFLLENBQUMsQ0FBQztTQUN4QztRQUFDLE9BQU8sQ0FBQyxFQUFFLEdBQUc7SUFDbkIsQ0FBQzs7Ozs7Ozs7O0lBRU8sa0JBQWtCLENBQUMsV0FBZ0IsRUFBRSxRQUFhLEVBQUUsWUFBaUIsRUFBRSxHQUFRO1FBQ25GLElBQUk7O2tCQUNNLEdBQUcsR0FBRyxtQkFBbUIsQ0FBQyxHQUFHLENBQUMsT0FBTyxDQUFDLGlCQUFpQixFQUFFO1lBQy9ELElBQUksR0FBRyxJQUFJLEdBQUcsQ0FBQyxLQUFLLEVBQUU7O3NCQUNaLEdBQUcsR0FBRyxHQUFHLENBQUMsS0FBSyxHQUFHLFdBQVcsQ0FBQyxpQkFBaUIsRUFBRTtnQkFDdkQsSUFBSSxJQUFJLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsSUFBSSxJQUFJLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQyxZQUFZLENBQUMsRUFBRTtvQkFDMUQsV0FBVyxDQUFDLEdBQUcsQ0FBQyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDLFlBQVksQ0FBQyxDQUFDO29CQUNyRCxRQUFRLENBQUMsR0FBRyxDQUFDLEdBQUcsRUFBRSxJQUFJLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDO2lCQUN4RDthQUNKO1NBQ0o7UUFBQyxPQUFPLENBQUMsRUFBRTtTQUNYO0lBQ0wsQ0FBQzs7Ozs7O0lBRUQsaUJBQWlCLENBQUMsTUFBVyxFQUFFLE9BQVk7O2NBQ2pDLElBQUksR0FBRyxJQUFJO1FBQ2pCLE1BQU0sQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLGlCQUFpQjs7Ozs7UUFBRSxVQUFVLENBQU0sRUFBRSxJQUFTOztrQkFDeEUsUUFBUSxHQUFHLEVBQUU7O2tCQUNiLFNBQVMsR0FBRyxJQUFJLENBQUMsYUFBYSxDQUFDLEdBQUcsRUFBRTs7a0JBQ3BDLFNBQVMsR0FBRyxJQUFJLENBQUMsU0FBUyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsYUFBYSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsU0FBUyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsY0FBYyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsU0FBUyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQyxVQUFVO1lBQ2hKLElBQUksU0FBUyxFQUFFO2dCQUNYLFFBQVEsQ0FBQyxhQUFhLENBQUMsR0FBRyxFQUFFLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsaUJBQWlCLENBQUM7Z0JBQ3BFLFFBQVEsQ0FBQyxXQUFXLENBQUMsR0FBRyxTQUFTLENBQUM7Z0JBQ2xDLFFBQVEsQ0FBQyxLQUFLLENBQUMsR0FBRyxTQUFTLENBQUMsR0FBRyxDQUFDO2dCQUNoQyxRQUFRLENBQUMsUUFBUSxDQUFDLEdBQUcsU0FBUyxDQUFDLEdBQUcsQ0FBQztnQkFDbkMsUUFBUSxDQUFDLFVBQVUsQ0FBQyxHQUFHLFNBQVMsQ0FBQyxRQUFRLENBQUM7Z0JBQzFDLFFBQVEsQ0FBQyxVQUFVLENBQUMsR0FBRyxTQUFTLENBQUMsUUFBUSxDQUFDO2dCQUMxQyxJQUFJLENBQUMsY0FBYyxHQUFHLFFBQVEsQ0FBQzthQUNsQztRQUNMLENBQUMsRUFBQyxDQUFDO1FBQ0gsTUFBTSxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsU0FBUzs7Ozs7UUFBRSxVQUFVLENBQU0sRUFBRSxJQUFTOzs7a0JBRWhFLFNBQVMsR0FBRyxFQUFFOzs7Z0JBRWhCLGFBQWEsR0FBRyxFQUFFO1lBQ3RCLEtBQUssSUFBSSxRQUFRLEdBQUcsQ0FBQyxFQUFFLFFBQVEsR0FBRyxJQUFJLENBQUMsY0FBYyxDQUFDLFFBQVEsRUFBRSxRQUFRLEVBQUUsRUFBRTtnQkFDeEUsSUFBSSxJQUFJLENBQUMsU0FBUyxDQUFDLFdBQVcsS0FBSyxVQUFVLEVBQUU7OzBCQUNyQyxRQUFRLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxXQUFXLENBQUMsUUFBUSxHQUFHLElBQUksQ0FBQyxjQUFjLENBQUMsR0FBRyxDQUFDO29CQUMzRSxhQUFhLEdBQUcsUUFBUSxDQUFDO29CQUN6QixTQUFTLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDO2lCQUM1QjtxQkFBTTtvQkFDSCxJQUFJLElBQUksQ0FBQyxjQUFjLENBQUMsTUFBTSxLQUFLLENBQUMsQ0FBQyxFQUFFO3dCQUNuQyxJQUFJLENBQUMsY0FBYyxDQUFDLFFBQVEsR0FBRyxJQUFJLENBQUMsY0FBYyxDQUFDLFFBQVEsR0FBRyxDQUFDLENBQUM7cUJBQ25FO29CQUNELEtBQUssSUFBSSxRQUFRLEdBQUcsQ0FBQyxFQUFFLFFBQVEsR0FBRyxJQUFJLENBQUMsY0FBYyxDQUFDLFFBQVEsRUFBRSxRQUFRLEVBQUUsRUFBRTs7OEJBQ2xFLFFBQVEsR0FBRyxFQUFFO3dCQUNuQixJQUFJLElBQUksQ0FBQyxTQUFTLENBQUMsV0FBVyxLQUFLLFVBQVUsRUFBRSxFQUFFLE1BQU07NEJBQ25ELElBQUksSUFBSSxDQUFDLFNBQVMsS0FBSyxDQUFDLEVBQUU7Z0NBQ3RCLElBQUksQ0FBQyxjQUFjLENBQUMsR0FBRyxHQUFHLENBQUMsQ0FBQzs2QkFDL0I7NEJBQ0QsSUFBSSxRQUFRLEdBQUcsSUFBSSxDQUFDLGNBQWMsQ0FBQyxNQUFNLEdBQUcsSUFBSSxDQUFDLFNBQVMsQ0FBQyxnQkFBZ0IsQ0FBQyxHQUFHLEVBQUU7Z0NBQzdFLFNBQVM7NkJBQ1o7NEJBQ0QsV0FBVzs0QkFDWCxLQUFLLElBQUksQ0FBQyxHQUFHLElBQUksQ0FBQyxTQUFTLENBQUMsZ0JBQWdCLENBQUMsS0FBSyxFQUFFLENBQUMsR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDLGdCQUFnQixDQUFDLEdBQUcsRUFBRSxDQUFDLEVBQUUsRUFBRTs7c0NBQ3hGLEtBQUssR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLFFBQVEsQ0FBQyxRQUFRLEdBQUcsSUFBSSxDQUFDLGNBQWMsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLFNBQVMsQ0FBQyxRQUFRLENBQUM7O3NDQUN2RyxJQUFJLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxnQkFBZ0IsQ0FBQyxLQUFLLEVBQUUsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLFNBQVMsQ0FBQyxTQUFTLENBQUM7O3NDQUMxRyxPQUFPLEdBQUcsSUFBSSxDQUFDLFNBQVMsQ0FBQyxRQUFRLENBQUMsSUFBSTs7OztnQ0FBQyxDQUFDLENBQU0sRUFBRSxFQUFFLENBQUMsQ0FBQyxDQUFDLFNBQVMsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDLElBQUksS0FBSyxJQUFJLEVBQUMsQ0FBQyxTQUFTO2dDQUN4RyxRQUFRLENBQUMsT0FBTyxDQUFDLEdBQUcsS0FBSyxDQUFDOzZCQUM3Qjs0QkFDRCxXQUFXOzRCQUNYLEtBQUssSUFBSSxDQUFDLEdBQUcsSUFBSSxDQUFDLFNBQVMsQ0FBQyxnQkFBZ0IsQ0FBQyxLQUFLLEVBQUUsQ0FBQyxHQUFHLElBQUksQ0FBQyxTQUFTLENBQUMsZ0JBQWdCLENBQUMsR0FBRyxFQUFFLENBQUMsRUFBRSxFQUFFOztzQ0FDeEYsS0FBSyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsUUFBUSxDQUFDLENBQUMsRUFBRSxRQUFRLEdBQUcsSUFBSSxDQUFDLGNBQWMsQ0FBQyxNQUFNLEVBQUUsRUFBRSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsU0FBUyxDQUFDLFNBQVMsQ0FBQzs7c0NBQzNHLE9BQU8sR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDLFFBQVEsQ0FBQyxNQUFNOzs7O2dDQUFDLENBQUMsQ0FBTSxFQUFFLEVBQUUsQ0FBQyxDQUFDLENBQUMsU0FBUyxLQUFLLENBQUMsRUFBQyxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDLGdCQUFnQixDQUFDLEtBQUssQ0FBQyxDQUFDLFNBQVM7Z0NBQ2xJLFFBQVEsQ0FBQyxPQUFPLENBQUMsR0FBRyxLQUFLLENBQUM7NkJBQzdCOzs7a0NBRUssS0FBSyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsUUFBUSxDQUFDLFFBQVEsR0FBRyxJQUFJLENBQUMsY0FBYyxDQUFDLEdBQUcsRUFBRSxRQUFRLEdBQUcsSUFBSSxDQUFDLGNBQWMsQ0FBQyxNQUFNLEVBQUUsRUFBRSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsU0FBUyxDQUFDLFFBQVEsQ0FBQzs7a0NBQzNJLElBQUksR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLGdCQUFnQixDQUFDLEdBQUcsRUFBRSxRQUFRLEdBQUcsSUFBSSxDQUFDLGNBQWMsQ0FBQyxNQUFNLEVBQUUsRUFBRSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsU0FBUyxDQUFDLFNBQVMsQ0FBQzs7a0NBRTVJLE9BQU8sR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDLFFBQVEsQ0FBQyxJQUFJOzs7OzRCQUFDLENBQUMsQ0FBTSxFQUFFLEVBQUUsQ0FBQyxDQUFDLENBQUMsU0FBUyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxLQUFLLElBQUksRUFBQyxDQUFDLFNBQVM7NEJBQ3hHLFFBQVEsQ0FBQyxPQUFPLENBQUMsR0FBRyxLQUFLLENBQUM7eUJBQzdCO3dCQUNELGFBQWEsR0FBRyxRQUFRLENBQUM7d0JBQ3pCLFNBQVMsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUM7cUJBQzVCO2lCQUNKO2FBQ0o7WUFDRCxjQUFjO1lBQ2QsUUFBUSxDQUFDLFFBQVEsQ0FBQyxPQUFPLEdBQUcsZ0JBQWdCLEVBQUUsYUFBYSxDQUFDLENBQUM7UUFDakUsQ0FBQyxFQUFDLENBQUM7SUFDUCxDQUFDOzs7Ozs7O0lBRUQsZUFBZSxDQUFDLEtBQVUsRUFBRSxNQUFXLEVBQUUsT0FBWTs7Y0FDM0MsSUFBSSxHQUFHLElBQUk7O2NBQ1gsTUFBTSxHQUFHLEtBQUssQ0FBQyxXQUFXLENBQUMsRUFBRSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsU0FBUyxDQUFDLFNBQVMsQ0FBQztRQUN0RSxLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsS0FBSyxDQUFDLGNBQWMsRUFBRSxFQUFFLENBQUMsRUFBRSxFQUFFOztrQkFDdkMsSUFBSSxHQUFHLEtBQUssQ0FBQyxPQUFPLENBQUMsTUFBTSxHQUFHLENBQUMsRUFBRSxDQUFDLEVBQUUsRUFBRSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsU0FBUyxDQUFDLFNBQVMsQ0FBQztZQUMvRSxJQUFJLElBQUksSUFBSSxJQUFJLENBQUMsUUFBUSxHQUFHLENBQUMsRUFBRTtnQkFDM0IsS0FBSyxDQUFDLFdBQVcsQ0FBQyxNQUFNLEdBQUcsSUFBSSxDQUFDLFFBQVEsRUFBRSxDQUFDLEVBQUUsSUFBSSxZQUFZLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEVBQUUsTUFBTSxFQUFFLE9BQU8sQ0FBQyxFQUFFLEVBQUUsQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLFNBQVMsQ0FBQyxTQUFTLENBQUMsQ0FBQzthQUNySjtpQkFBTTtnQkFDSCxLQUFLLENBQUMsV0FBVyxDQUFDLE1BQU0sR0FBRyxDQUFDLEVBQUUsQ0FBQyxFQUFFLElBQUksWUFBWSxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxFQUFFLE1BQU0sRUFBRSxPQUFPLENBQUMsRUFBRSxFQUFFLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxTQUFTLENBQUMsU0FBUyxDQUFDLENBQUM7YUFDekk7U0FDSjtJQUNMLENBQUM7Ozs7OztJQUVELFNBQVMsQ0FBQyxLQUFVLEVBQUUsTUFBVztRQUM3QixJQUFJLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQyxNQUFNLENBQUMsRUFBRTtZQUM1QixPQUFPO1NBQ1Y7O2NBQ0ssZ0JBQWdCLEdBQUcsRUFBRTtRQUMzQixJQUFJLENBQUMsYUFBYSxDQUFDLGdCQUFnQixFQUFFLE1BQU0sQ0FBQyxDQUFDO1FBQzdDLElBQUksZ0JBQWdCLENBQUMsTUFBTSxFQUFFO1lBQ3pCLE9BQU87U0FDVjs7Y0FDSyxXQUFXLEdBQUcsS0FBSyxDQUFDLGNBQWMsRUFBRTs7Y0FDcEMsUUFBUSxHQUFHLEtBQUssQ0FBQyxXQUFXLEVBQUU7O1lBQ2hDLGFBQWEsR0FBRyxDQUFDO1FBQ3JCLElBQUksSUFBSSxDQUFDLGdCQUFnQixDQUFDLE1BQU0sQ0FBQyxFQUFFO1lBQy9CLGFBQWEsR0FBRyxDQUFDLENBQUM7U0FDckI7UUFDRCxPQUFPO1FBQ1AsSUFBSSxXQUFXLEdBQUcsQ0FBQyxJQUFJLENBQUMsUUFBUSxHQUFHLGFBQWEsQ0FBQyxHQUFHLENBQUMsRUFBRTtZQUNuRCxPQUFPO1NBQ1Y7O2NBQ0ssUUFBUSxHQUFHLEVBQUU7O1lBQ2YsYUFBYSxHQUFHLEVBQUU7O1lBQ2xCLFdBQVcsR0FBRyxFQUFFOztZQUNoQixHQUFHLEdBQUcsRUFBRTtRQUNaLEtBQUssSUFBSSxHQUFHLEdBQUcsYUFBYSxFQUFFLEdBQUcsR0FBRyxRQUFRLEVBQUUsR0FBRyxFQUFFLEVBQUU7WUFDakQsSUFBSSxLQUFLLENBQUMsV0FBVyxDQUFDLEdBQUcsQ0FBQyxDQUFDLGNBQWMsQ0FBQyxlQUFlLENBQUM7Z0JBQ3RELENBQ0ksQ0FBQyxLQUFLLENBQUMsV0FBVyxDQUFDLEdBQUcsQ0FBQyxDQUFDLGVBQWUsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxLQUFLLENBQUMsQ0FBQyxHQUFHLEVBQUUsQ0FBQzt1QkFDeEQsQ0FBQyxLQUFLLENBQUMsV0FBVyxDQUFDLEdBQUcsQ0FBQyxDQUFDLGVBQWUsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxLQUFLLENBQUMsQ0FBQyxHQUFHLEVBQUUsQ0FBQzt1QkFDM0QsQ0FBQyxLQUFLLENBQUMsV0FBVyxDQUFDLEdBQUcsQ0FBQyxDQUFDLGVBQWUsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxLQUFLLENBQUMsQ0FBQyxHQUFHLEVBQUUsQ0FBQzt1QkFDM0QsQ0FBQyxLQUFLLENBQUMsV0FBVyxDQUFDLEdBQUcsQ0FBQyxDQUFDLGVBQWUsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxLQUFLLENBQUMsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxDQUNqRSxFQUFFO2dCQUNILFNBQVM7YUFDWjtZQUNELEtBQUssSUFBSSxHQUFHLEdBQUcsQ0FBQyxFQUFFLEdBQUcsR0FBRyxXQUFXLEVBQUUsR0FBRyxFQUFFLEVBQUU7Z0JBQ3hDLFdBQVcsR0FBRyxLQUFLLENBQUMsT0FBTyxDQUFDLEdBQUcsRUFBRSxHQUFHLENBQUMsQ0FBQyxLQUFLLEVBQUUsQ0FBQztnQkFDOUMsSUFBSSxHQUFHLElBQUksQ0FBQyxFQUFFO29CQUNWLEdBQUcsR0FBRyxXQUFXLENBQUM7b0JBQ2xCLElBQUksUUFBUSxDQUFDLGNBQWMsQ0FBQyxHQUFHLENBQUMsRUFBRTt3QkFDOUIsUUFBUSxDQUFDLEdBQUcsQ0FBQyxDQUFDLFFBQVEsR0FBRyxHQUFHLEdBQUcsUUFBUSxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsR0FBRyxDQUFDLENBQUM7cUJBQ3hEO3lCQUFNO3dCQUNILFFBQVEsQ0FBQyxHQUFHLENBQUMsR0FBRyxFQUFFLEtBQUssRUFBRSxHQUFHLEVBQUUsVUFBVSxFQUFFLENBQUMsRUFBRSxLQUFLLEVBQUUsR0FBRyxFQUFFLFVBQVUsRUFBRSxDQUFDLEVBQUUsQ0FBQztxQkFDNUU7aUJBQ0o7cUJBQU07b0JBQ0gsYUFBYSxHQUFHLEVBQUUsQ0FBQztvQkFDbkIsS0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxJQUFJLEdBQUcsRUFBRSxDQUFDLEVBQUUsRUFBRTt3QkFDM0IsYUFBYSxJQUFJLEtBQUssQ0FBQyxPQUFPLENBQUMsR0FBRyxFQUFFLENBQUMsQ0FBQyxDQUFDLEtBQUssRUFBRSxDQUFDO3dCQUMvQyxhQUFhLElBQUksS0FBSyxDQUFDO3FCQUMxQjtvQkFDRCxJQUFJLFFBQVEsQ0FBQyxjQUFjLENBQUMsYUFBYSxDQUFDLEVBQUU7d0JBQ3hDLFFBQVEsQ0FBQyxhQUFhLENBQUMsQ0FBQyxRQUFRLEdBQUcsR0FBRyxHQUFHLFFBQVEsQ0FBQyxhQUFhLENBQUMsQ0FBQyxHQUFHLEdBQUcsQ0FBQyxDQUFDO3FCQUM1RTt5QkFBTTt3QkFDSCxRQUFRLENBQUMsYUFBYSxDQUFDLEdBQUcsRUFBRSxLQUFLLEVBQUUsR0FBRyxFQUFFLFVBQVUsRUFBRSxDQUFDLEVBQUUsS0FBSyxFQUFFLEdBQUcsRUFBRSxVQUFVLEVBQUUsQ0FBQyxFQUFFLENBQUM7cUJBQ3RGO2lCQUNKO2FBQ0o7U0FDSjtRQUVELEtBQUssSUFBSSxDQUFDLElBQUksUUFBUSxFQUFFO1lBQ3BCLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUMsUUFBUSxJQUFJLENBQUMsSUFBSSxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUMsUUFBUSxJQUFJLENBQUMsQ0FBQyxJQUFJLEtBQUssRUFBRTtnQkFDbkUsS0FBSyxDQUFDLE9BQU8sQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxFQUFFLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLEVBQUUsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDLFFBQVEsRUFBRSxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDLENBQUM7YUFDL0Y7U0FDSjtJQUNMLENBQUM7Ozs7Ozs7OztJQUVPLFVBQVUsQ0FBQyxLQUFVLEVBQUUsS0FBVSxFQUFFLE1BQVcsRUFBRSxPQUFZOztjQUMxRCxPQUFPLEdBQUcsSUFBSSxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsRUFBRSxTQUFTLEVBQUUsTUFBTSxFQUFFLENBQUM7UUFDNUQsSUFBSTs7a0JBQ00sTUFBTSxHQUFHLEtBQUssQ0FBQyxXQUFXLENBQUMsRUFBRSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsU0FBUyxDQUFDLFNBQVMsQ0FBQztZQUN0RSxJQUFJLE1BQU0sSUFBSSxNQUFNLENBQUMsV0FBVyxJQUFJLE1BQU0sQ0FBQyxXQUFXLENBQUMsWUFBWSxJQUFJLE1BQU0sQ0FBQyxXQUFXLENBQUMsWUFBWSxDQUFDLE9BQU8sSUFBSSxNQUFNLENBQUMsV0FBVyxDQUFDLFlBQVksQ0FBQyxPQUFPLENBQUMsTUFBTSxFQUFFOztvQkFDMUosSUFBSSxHQUFHLElBQUk7O3NCQUNULElBQUksR0FBRyxLQUFLLENBQUMsT0FBTyxDQUFDLE1BQU0sR0FBRyxDQUFDLEVBQUUsS0FBSyxFQUFFLEVBQUUsQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLFNBQVMsQ0FBQyxTQUFTLENBQUM7Z0JBQ25GLElBQUksSUFBSSxJQUFJLElBQUksQ0FBQyxRQUFRLEdBQUcsQ0FBQyxFQUFFO29CQUMzQixJQUFJLEdBQUcsS0FBSyxDQUFDLE9BQU8sQ0FBQyxNQUFNLEdBQUcsSUFBSSxDQUFDLFFBQVEsRUFBRSxLQUFLLEVBQUUsRUFBRSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsU0FBUyxDQUFDLFNBQVMsQ0FBQyxDQUFDO2lCQUM3RjtxQkFBTTtvQkFDSCxJQUFJLEdBQUcsS0FBSyxDQUFDLE9BQU8sQ0FBQyxNQUFNLEdBQUcsQ0FBQyxFQUFFLEtBQUssRUFBRSxFQUFFLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxTQUFTLENBQUMsU0FBUyxDQUFDLENBQUM7aUJBQ2pGO2dCQUNELElBQUksTUFBTSxJQUFJLE1BQU0sQ0FBQyxRQUFRLEtBQUssQ0FBQyxFQUFFO29CQUNqQyxPQUFPLENBQUMsS0FBSyxFQUFFLENBQUM7b0JBQ2hCLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUM7b0JBQ1osS0FBSyxDQUFDLGdCQUFnQixFQUFFLENBQUM7b0JBQ3pCLEtBQUssQ0FBQyxPQUFPLEVBQUUsQ0FBQztvQkFDaEIsSUFBSSxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLGVBQWUsQ0FBQyxRQUFRLENBQUMsOEJBQThCLENBQUMsQ0FBQyxDQUFDO29CQUNwRixPQUFPO2lCQUNWO2dCQUNELElBQUksTUFBTSxDQUFDLFdBQVcsS0FBSyxDQUFDLElBQUksTUFBTSxDQUFDLFdBQVcsS0FBSyxHQUFHLEVBQUU7b0JBQ3hELE9BQU8sQ0FBQyxLQUFLLEVBQUUsQ0FBQztvQkFDaEIsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQztvQkFDWixLQUFLLENBQUMsZ0JBQWdCLEVBQUUsQ0FBQztvQkFDekIsS0FBSyxDQUFDLE9BQU8sRUFBRSxDQUFDO29CQUNoQixJQUFJLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsZUFBZSxDQUFDLFFBQVEsQ0FBQyxtREFBbUQsQ0FBQyxDQUFDLENBQUM7b0JBQ3pHLE9BQU87aUJBQ1Y7O3NCQUNLLE9BQU8sR0FBRyxNQUFNLENBQUMsV0FBVyxDQUFDLFlBQVksQ0FBQyxPQUFPOztzQkFDakQsTUFBTSxHQUFHO29CQUNYLEtBQUssRUFBRSxLQUFLO29CQUNaLElBQUksRUFBRSxJQUFJO29CQUNWLFFBQVEsRUFBRSxDQUFDO29CQUNYLFFBQVEsRUFBRSxFQUFFLFNBQVMsRUFBRSxDQUFDLEVBQUUsU0FBUyxFQUFFLEVBQUUsRUFBRTtvQkFDekMsTUFBTSxFQUFFLEVBQUU7aUJBQ2I7Z0JBRUQseUNBQXlDO2dCQUN6QyxLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsT0FBTyxDQUFDLE1BQU0sRUFBRSxDQUFDLEVBQUUsRUFBRTtvQkFDckMsSUFBSSxDQUFDLHdCQUF3QixDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsRUFBRSxJQUFJLEVBQUUsTUFBTSxDQUFDLENBQUM7aUJBQzNEO2dCQUNELHlDQUF5QztnQkFDekMsS0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLE9BQU8sQ0FBQyxNQUFNLEVBQUUsQ0FBQyxFQUFFLEVBQUU7b0JBQ3JDLElBQUksQ0FBQyxtQkFBbUIsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLEVBQUUsSUFBSSxFQUFFLE1BQU0sQ0FBQyxDQUFDO2lCQUN0RDtnQkFDRCxJQUFJLE1BQU0sQ0FBQyxNQUFNLENBQUMsTUFBTSxFQUFFO29CQUN0QixPQUFPLENBQUMsS0FBSyxFQUFFLENBQUM7b0JBQ2hCLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUM7b0JBQ1osS0FBSyxDQUFDLGdCQUFnQixFQUFFLENBQUM7b0JBQ3pCLEtBQUssQ0FBQyxPQUFPLEVBQUUsQ0FBQztvQkFDaEIsSUFBSSxDQUFDLFVBQVUsQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsR0FBRyxHQUFHLEdBQUcsSUFBSSxDQUFDLGVBQWUsQ0FBQyxRQUFRLENBQUMsc0RBQXNELENBQUMsQ0FBQyxDQUFDO29CQUN4SSxPQUFPO2lCQUNWOztzQkFDSyxTQUFTLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLE1BQU0sQ0FBQyxDQUFDO2dCQUNwRCxTQUFTLENBQUMsV0FBVyxDQUFDLFlBQVksQ0FBQyxPQUFPLEdBQUcsT0FBTyxDQUFDO2dCQUNyRCxTQUFTLENBQUMsV0FBVyxHQUFHLElBQUksQ0FBQyxTQUFTLENBQUMsU0FBUyxDQUFDLFdBQVcsQ0FBQyxDQUFDO2dCQUM5RCxJQUFJLENBQUMsYUFBYSxDQUFDLFVBQVUsQ0FBQyxFQUFFLE1BQU0sRUFBRSxJQUFJLENBQUMsU0FBUyxDQUFDLFNBQVMsQ0FBQyxFQUFFLFNBQVMsRUFBRSxPQUFPLENBQUMsU0FBUyxFQUFFLEVBQUUsRUFBRSxDQUFDLENBQUMsU0FBUzs7OztnQkFBQyxJQUFJLENBQUMsRUFBRTtvQkFDcEgsT0FBTyxDQUFDLEtBQUssRUFBRSxDQUFDO29CQUNoQixPQUFPLENBQUMsVUFBVSxDQUFDLE9BQU8sQ0FBQyxPQUFPLEVBQUUsU0FBUyxDQUFDLEVBQUUsRUFBRSxPQUFPLENBQUMsV0FBVyxFQUFFLE9BQU8sQ0FBQyxhQUFhLEVBQUUsT0FBTyxDQUFDLFNBQVMsRUFBRSxPQUFPLENBQUMsZ0JBQWdCLEVBQUUsT0FBTyxDQUFDLG1CQUFtQixFQUFFLE9BQU8sQ0FBQyxTQUFTLEVBQUUsT0FBTyxDQUFDLElBQUksRUFBRSxJQUFJLENBQUMsQ0FBQztnQkFDbk4sQ0FBQzs7OztnQkFBRSxDQUFDLEtBQVUsRUFBRSxFQUFFO29CQUNkLE9BQU8sQ0FBQyxLQUFLLEVBQUUsQ0FBQztvQkFDaEIsSUFBSSxDQUFDLGdCQUFnQixDQUFDLFNBQVMsQ0FBQyxLQUFLLENBQUMsT0FBTyxFQUFFLEtBQUssQ0FBQyxDQUFDO2dCQUMxRCxDQUFDLEVBQUMsQ0FBQzthQUNOO2lCQUFNO2dCQUNILE9BQU8sQ0FBQyxLQUFLLEVBQUUsQ0FBQztnQkFDaEIsSUFBSSxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLGVBQWUsQ0FBQyxRQUFRLENBQUMsOEJBQThCLENBQUMsQ0FBQyxDQUFDO2dCQUNwRixPQUFPO2FBQ1Y7U0FDSjtRQUFDLE9BQU8sQ0FBQyxFQUFFO1lBQ1IsT0FBTyxDQUFDLEtBQUssRUFBRSxDQUFDO1NBQ25CO0lBQ0wsQ0FBQzs7Ozs7Ozs7SUFFTyx3QkFBd0IsQ0FBQyxHQUFHLEVBQUUsT0FBTyxFQUFFLE1BQU07UUFDakQsSUFBSSxPQUFPLElBQUksSUFBSSxFQUFFO1lBQ2pCLElBQUksR0FBRyxDQUFDLFNBQVMsSUFBSSxHQUFHLENBQUMsU0FBUyxDQUFDLE1BQU0sRUFBRTtnQkFDdkMsSUFBSSxDQUFDLHdCQUF3QixDQUFDLElBQUksRUFBRSxHQUFHLENBQUMsU0FBUyxFQUFFLE1BQU0sQ0FBQyxDQUFDO2FBQzlEO2lCQUFNO2dCQUNILElBQUksR0FBRyxDQUFDLElBQUksS0FBSyxDQUFDLElBQUksR0FBRyxDQUFDLFdBQVcsQ0FBQyxJQUFJLElBQUksSUFBSSxHQUFHLENBQUMsV0FBVyxDQUFDLEtBQUssU0FBUyxJQUFJLEdBQUcsQ0FBQyxTQUFTLEdBQUcsTUFBTSxDQUFDLFFBQVEsQ0FBQyxTQUFTLEVBQUU7b0JBQzNILE1BQU0sQ0FBQyxRQUFRLENBQUMsU0FBUyxHQUFHLEdBQUcsQ0FBQyxXQUFXLENBQUMsQ0FBQztvQkFDN0MsTUFBTSxDQUFDLFFBQVEsQ0FBQyxTQUFTLEdBQUcsR0FBRyxDQUFDLFNBQVMsQ0FBQztpQkFDN0M7YUFDSjtTQUNKO2FBQU07WUFDSCx5Q0FBeUM7WUFDekMsS0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLE9BQU8sQ0FBQyxNQUFNLEVBQUUsQ0FBQyxFQUFFLEVBQUU7Z0JBQ3JDLElBQUksT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLFNBQVMsSUFBSSxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDLE1BQU0sRUFBRTtvQkFDckQsSUFBSSxDQUFDLHdCQUF3QixDQUFDLElBQUksRUFBRSxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUMsU0FBUyxFQUFFLE1BQU0sQ0FBQyxDQUFDO2lCQUNyRTtxQkFBTTtvQkFDSCxJQUFJLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLEtBQUssQ0FBQyxJQUFJLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxXQUFXLENBQUMsSUFBSSxJQUFJLElBQUksT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxLQUFLLFNBQVMsSUFBSSxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUMsU0FBUyxHQUFHLE1BQU0sQ0FBQyxRQUFRLENBQUMsU0FBUyxFQUFFO3dCQUN2SixNQUFNLENBQUMsUUFBUSxDQUFDLFNBQVMsR0FBRyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUMsV0FBVyxDQUFDLENBQUM7d0JBQ3BELE1BQU0sQ0FBQyxRQUFRLENBQUMsU0FBUyxHQUFHLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUM7cUJBQ3BEO2lCQUNKO2FBQ0o7U0FDSjtJQUNMLENBQUM7Ozs7Ozs7O0lBRU8sbUJBQW1CLENBQUMsR0FBRyxFQUFFLE9BQU8sRUFBRSxNQUFNO1FBQzVDLElBQUksT0FBTyxJQUFJLElBQUksRUFBRTtZQUNqQixJQUFJLEdBQUcsQ0FBQyxTQUFTLElBQUksR0FBRyxDQUFDLFNBQVMsQ0FBQyxNQUFNLEVBQUU7Z0JBQ3ZDLElBQUksQ0FBQyxtQkFBbUIsQ0FBQyxJQUFJLEVBQUUsR0FBRyxDQUFDLFNBQVMsRUFBRSxNQUFNLENBQUMsQ0FBQzthQUN6RDtpQkFBTTtnQkFDSCxJQUFJLE1BQU0sQ0FBQyxRQUFRLEtBQUssTUFBTSxDQUFDLEtBQUssRUFBRTtvQkFDbEMsSUFBSSxHQUFHLENBQUMsSUFBSSxJQUFJLEdBQUcsQ0FBQyxJQUFJLENBQUMsV0FBVyxFQUFFLEtBQUssTUFBTSxFQUFFO3dCQUMvQyxNQUFNLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsU0FBUyxDQUFDLENBQUM7cUJBQ3JDO3lCQUFNO3dCQUNILFFBQVEsTUFBTSxDQUFDLElBQUksQ0FBQyxHQUFHLEVBQUUsRUFBRTs0QkFDdkIsS0FBSyxDQUFDO2dDQUNGLEdBQUcsQ0FBQyxJQUFJLEdBQUcsQ0FBQyxDQUFDO2dDQUNiLEdBQUcsQ0FBQyxXQUFXLENBQUMsR0FBRyxDQUFDLENBQUM7Z0NBQ3JCLE1BQU07NEJBQ1YsS0FBSyxDQUFDO2dDQUNGLEdBQUcsQ0FBQyxJQUFJLEdBQUcsQ0FBQyxDQUFDO2dDQUNiLEdBQUcsQ0FBQyxXQUFXLENBQUMsR0FBRyxHQUFHLENBQUMsV0FBVyxDQUFDLEtBQUssSUFBSSxJQUFJLEdBQUcsQ0FBQyxXQUFXLENBQUMsS0FBSyxTQUFTLElBQUksR0FBRyxDQUFDLFdBQVcsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsU0FBUyxLQUFLLE1BQU0sQ0FBQyxRQUFRLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxTQUFTLEdBQUcsQ0FBQyxDQUFDO2dDQUNwTyxNQUFNOzRCQUNWLEtBQUssQ0FBQztnQ0FDRixHQUFHLENBQUMsSUFBSSxHQUFHLENBQUMsQ0FBQztnQ0FDYixHQUFHLENBQUMsV0FBVyxDQUFDLEdBQUcsR0FBRyxDQUFDLFdBQVcsQ0FBQyxLQUFLLElBQUksSUFBSSxHQUFHLENBQUMsV0FBVyxDQUFDLEtBQUssU0FBUyxJQUFJLEdBQUcsQ0FBQyxXQUFXLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLFNBQVMsS0FBSyxNQUFNLENBQUMsUUFBUSxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsU0FBUyxHQUFHLENBQUMsQ0FBQztnQ0FDcE8sTUFBTTt5QkFDYjtxQkFDSjtpQkFDSjtnQkFDRCxNQUFNLENBQUMsUUFBUSxFQUFFLENBQUM7YUFDckI7U0FDSjthQUFNO1lBQ0gseUNBQXlDO1lBQ3pDLEtBQUssSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxPQUFPLENBQUMsTUFBTSxFQUFFLENBQUMsRUFBRSxFQUFFO2dCQUNyQyxJQUFJLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxTQUFTLElBQUksT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxNQUFNLEVBQUU7b0JBQ3JELElBQUksQ0FBQyxtQkFBbUIsQ0FBQyxJQUFJLEVBQUUsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLFNBQVMsRUFBRSxNQUFNLENBQUMsQ0FBQztpQkFDaEU7cUJBQU07b0JBQ0gsSUFBSSxNQUFNLENBQUMsUUFBUSxLQUFLLE1BQU0sQ0FBQyxLQUFLLEVBQUU7d0JBQ2xDLElBQUksT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksSUFBSSxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLFdBQVcsRUFBRSxLQUFLLE1BQU0sRUFBRTs0QkFDN0QsTUFBTSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxDQUFDO3lCQUM1Qzs2QkFBTTs0QkFDSCxRQUFRLE1BQU0sQ0FBQyxJQUFJLENBQUMsR0FBRyxFQUFFLEVBQUU7Z0NBQ3ZCLEtBQUssQ0FBQztvQ0FDRixPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxHQUFHLENBQUMsQ0FBQztvQ0FDcEIsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxHQUFHLENBQUMsQ0FBQztvQ0FDNUIsTUFBTTtnQ0FDVixLQUFLLENBQUM7b0NBQ0YsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksR0FBRyxDQUFDLENBQUM7b0NBQ3BCLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxXQUFXLENBQUMsR0FBRyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUMsV0FBVyxDQUFDLEtBQUssSUFBSSxJQUFJLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxXQUFXLENBQUMsS0FBSyxTQUFTLElBQUksT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUMsU0FBUyxLQUFLLE1BQU0sQ0FBQyxRQUFRLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxTQUFTLEdBQUcsQ0FBQyxDQUFDO29DQUM5USxNQUFNO2dDQUNWLEtBQUssQ0FBQztvQ0FDRixPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxHQUFHLENBQUMsQ0FBQztvQ0FDcEIsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxHQUFHLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxXQUFXLENBQUMsS0FBSyxJQUFJLElBQUksT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxLQUFLLFNBQVMsSUFBSSxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUMsV0FBVyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxTQUFTLEtBQUssTUFBTSxDQUFDLFFBQVEsQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLFNBQVMsR0FBRyxDQUFDLENBQUM7b0NBQzlRLE1BQU07NkJBQ2I7eUJBQ0o7cUJBQ0o7b0JBQ0QsTUFBTSxDQUFDLFFBQVEsRUFBRSxDQUFDO2lCQUNyQjthQUNKO1NBQ0o7SUFDTCxDQUFDOzs7Ozs7OztJQUVPLG9CQUFvQixDQUFDLEdBQUcsRUFBRSxPQUFPLEVBQUUsTUFBTTtRQUM3QyxJQUFJLE9BQU8sSUFBSSxJQUFJLEVBQUU7WUFDakIsSUFBSSxHQUFHLENBQUMsU0FBUyxJQUFJLEdBQUcsQ0FBQyxTQUFTLENBQUMsTUFBTSxFQUFFO2dCQUN2QyxJQUFJLENBQUMsb0JBQW9CLENBQUMsSUFBSSxFQUFFLEdBQUcsQ0FBQyxTQUFTLEVBQUUsTUFBTSxDQUFDLENBQUM7YUFDMUQ7aUJBQU07Z0JBQ0gsSUFBSSxHQUFHLENBQUMsS0FBSyxFQUFFO29CQUNYLE1BQU0sQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDO3dCQUNyQixRQUFRLEVBQUUsTUFBTSxDQUFDLFFBQVE7cUJBQzVCLENBQUMsQ0FBQztpQkFDTjtnQkFDRCxNQUFNLENBQUMsUUFBUSxFQUFFLENBQUM7YUFDckI7U0FDSjthQUFNO1lBQ0gseUNBQXlDO1lBQ3pDLEtBQUssSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxPQUFPLENBQUMsTUFBTSxFQUFFLENBQUMsRUFBRSxFQUFFO2dCQUNyQyxJQUFJLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxTQUFTLElBQUksT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxNQUFNLEVBQUU7b0JBQ3JELElBQUksQ0FBQyxvQkFBb0IsQ0FBQyxJQUFJLEVBQUUsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLFNBQVMsRUFBRSxNQUFNLENBQUMsQ0FBQztpQkFDakU7cUJBQU07b0JBQ0gsSUFBSSxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxFQUFFO3dCQUNsQixNQUFNLENBQUMsWUFBWSxDQUFDLElBQUksQ0FBQzs0QkFDckIsUUFBUSxFQUFFLE1BQU0sQ0FBQyxRQUFRO3lCQUM1QixDQUFDLENBQUM7cUJBQ047b0JBQ0QsTUFBTSxDQUFDLFFBQVEsRUFBRSxDQUFDO2lCQUNyQjthQUNKO1NBQ0o7SUFDTCxDQUFDOzs7Ozs7SUFFTyxRQUFRLENBQUMsR0FBRztRQUNoQixJQUFJLFVBQVUsQ0FBQyxHQUFHLENBQUMsQ0FBQyxRQUFRLEVBQUUsSUFBSSxLQUFLLEVBQUU7WUFDckMsT0FBTyxLQUFLLENBQUM7U0FDaEI7YUFBTTtZQUNILE9BQU8sSUFBSSxDQUFDO1NBQ2Y7SUFDTCxDQUFDO0NBQ0o7OztJQXpqQ0csMENBQTJCOztJQUMzQiw4Q0FBK0I7O0lBQy9CLDRDQUE2Qjs7SUFDN0IsNENBQTZCOztJQUM3QixnREFBaUM7O0lBQ2pDLDRDQUE2Qjs7SUFDN0IsMkNBQTRCOztJQUM1QiwwQ0FBeUI7Ozs7O0lBQ3pCLDhDQUErQjs7SUFDL0IsZ0NBQVU7O0lBQ1YsbUNBQWE7O0lBQ2IsK0NBQXdCOztJQUN4QiwrQ0FBbUM7O0lBQ25DLGlEQUEwQjs7SUFDMUIsNkNBQWlDOztJQUNqQyx5Q0FBbUI7O0lBQ25CLG1DQUFhOztJQUNiLHFDQUFvQjs7SUFDcEIsK0NBQXlCOztJQUN6QixpQ0FBVzs7SUFDWCx1Q0FBaUI7O0lBQ2pCLHNDQUFnQjs7SUFDaEIsMkNBQXFCOztJQUNyQix5Q0FBbUI7O0lBQ25CLDRDQUFtQzs7SUFDbkMsc0NBQWdCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgRm9ybUVycm9yU2VydmljZSB9IGZyb20gXCJAZmFycmlzL2NvbW1hbmQtc2VydmljZXNcIjtcclxuaW1wb3J0IHsgRXZlbnRCdXMsIFJ0ZlNlcnZpY2VzLCBMY3BTZXJ2aWNlIH0gZnJvbSBcIkBxZHAvY29tbW9uXCI7XHJcbmltcG9ydCB7IGZpbHRlciB9IGZyb20gJ2xvZGFzaC1lcyc7XHJcblxyXG5kZWNsYXJlIHZhciBHQzogYW55O1xyXG5kZWNsYXJlIHZhciBUcmVlQ2VsbFR5cGU6IGFueTtcclxuZGVjbGFyZSB2YXIgTXlOdW1Gb3JtYXR0ZXI6IGFueTtcclxuZGVjbGFyZSB2YXIgRmlsdGVyQ2VsbFR5cGU6IGFueTtcclxuZGVjbGFyZSB2YXIgU29ydENlbGxUeXBlOiBhbnk7XHJcbmRlY2xhcmUgdmFyIGdzcGZyYW1ld29ya1NlcnZpY2U6IGFueTtcclxuXHJcbmV4cG9ydCBjbGFzcyBTcHJlYWRTdHlsZVV0aWxzIHtcclxuICAgIGRhdGFTdHlsZUFycmF5OiBhbnlbXSA9IFtdO1xyXG4gICAgZGF0YVJvd0hlaWdodEFycmF5OiBhbnlbXSA9IFtdO1xyXG4gICAgZGF0YUNvbEluZm9BcnJheTogYW55W10gPSBbXTtcclxuICAgIGZvb3RlclN0eWxlQXJyYXk6IGFueVtdID0gW107XHJcbiAgICBmb290ZXJSb3dIZWlnaHRBcnJheTogYW55W10gPSBbXTtcclxuICAgIGZvb3RlclNwYW5zQXJyYXk6IGFueVtdID0gW107XHJcbiAgICBmb290ZXJEYXRhQXJyYXk6IGFueVtdID0gW107XHJcbiAgICBoeXBlckxpbmtRdWVyeTogYW55ID0ge307XHJcbiAgICBwcml2YXRlIGF1dG9GaXRDb2x1bW5JbmRleCA9IDA7XHJcbiAgICB0eXBlOiBhbnk7XHJcbiAgICBxdWVyeUlkOiBhbnk7XHJcbiAgICB2YWx1ZUhlYWRlclJvd0NvdW50ID0gMDsgLy8g5YC857u05bqm5pWw6YePXHJcbiAgICB2YWx1ZUhlYWRlclJvd0FycmF5OiBudW1iZXJbXSA9IFtdO1xyXG4gICAgcm93SGVhZGVyc0NvbHVtbkNvdW50ID0gMDsgLy8g6KGM5qCH6aKY5YiX5pWwXHJcbiAgICByb3dIZWFkZXJSb3dBcnJheTogbnVtYmVyW10gPSBbXTtcclxuICAgIHJvd0hlYWRlckluZm86IGFueTtcclxuICAgIHZhbEluZm86IGFueTtcclxuICAgIGpvaW5QYXJhbTogYW55ID0ge307XHJcbiAgICBqb2ludHNlYXJjaEluZm9MaXN0OiBhbnk7XHJcbiAgICBjYWNoZTogYW55O1xyXG4gICAgbG9hZFNlcnZpY2U6IGFueTtcclxuICAgIG1zZ1NlcnZpY2U6IGFueTtcclxuICAgIGxvY2FsaXplU2VydmljZTogYW55O1xyXG4gICAgc2NoZW1hTWFuYWdlcjogYW55O1xyXG4gICAgZm9ybUVycm9yU2VydmljZTogRm9ybUVycm9yU2VydmljZTtcclxuICAgIGxjcFNlcnZpY2U6IGFueTtcclxuXHJcbiAgICBjb25zdHJ1Y3RvcihfcXVlcnlJZDogYW55LCBfY29udHJvbFR5cGU6IGFueSwgX2pvaW50c2VhcmNoSW5mb0xpc3Q/OiBhbnksIF9zZXJ2aWNlQ2FjaGU/OiBhbnkpIHtcclxuICAgICAgICB0aGlzLnF1ZXJ5SWQgPSBfcXVlcnlJZDtcclxuICAgICAgICB0aGlzLnR5cGUgPSBfY29udHJvbFR5cGU7XHJcbiAgICAgICAgdGhpcy5qb2ludHNlYXJjaEluZm9MaXN0ID0gX2pvaW50c2VhcmNoSW5mb0xpc3Q7XHJcbiAgICAgICAgdGhpcy5jYWNoZSA9IF9zZXJ2aWNlQ2FjaGUuY2FjaGVTZXJ2aWNlO1xyXG4gICAgICAgIHRoaXMubG9hZFNlcnZpY2UgPSBfc2VydmljZUNhY2hlLmxvYWRpbmdTZXJ2aWNlO1xyXG4gICAgICAgIHRoaXMubXNnU2VydmljZSA9IF9zZXJ2aWNlQ2FjaGUubXNnU2VydmljZTtcclxuICAgICAgICB0aGlzLmxvY2FsaXplU2VydmljZSA9IF9zZXJ2aWNlQ2FjaGUubG9jYWxpemVTZXJ2aWNlO1xyXG4gICAgICAgIHRoaXMuc2NoZW1hTWFuYWdlciA9IF9zZXJ2aWNlQ2FjaGUuc2NoZW1hTWFuYWdlclNlcnZpY2U7XHJcbiAgICAgICAgdGhpcy5mb3JtRXJyb3JTZXJ2aWNlID0gX3NlcnZpY2VDYWNoZS5mb3JtRXJyb3JTZXJ2aWNlO1xyXG4gICAgICAgIHRoaXMubGNwU2VydmljZSA9IF9zZXJ2aWNlQ2FjaGUubGNwU2VydmljZTtcclxuICAgIH1cclxuXHJcbiAgICBzZXRBdXRvRml0Q29sdW1uKHNjaGVtYTogYW55LCBzaGVldDogYW55KSB7XHJcbiAgICAgICAgaWYgKHNjaGVtYSAmJiBzY2hlbWEuc2NoZW1hVmFsdWUgJiYgc2NoZW1hLnNjaGVtYVZhbHVlLmNvbHVtbk9wdGlvbiAmJiBzY2hlbWEuc2NoZW1hVmFsdWUuY29sdW1uT3B0aW9uLmNvbExpc3QgJiYgc2NoZW1hLnNjaGVtYVZhbHVlLmNvbHVtbk9wdGlvbi5jb2xMaXN0Lmxlbmd0aCkge1xyXG4gICAgICAgICAgICB0aGlzLmF1dG9GaXRDb2x1bW5JbmRleCA9IDA7XHJcbiAgICAgICAgICAgIHNjaGVtYS5zY2hlbWFWYWx1ZS5jb2x1bW5PcHRpb24uY29sTGlzdC5mb3JFYWNoKChjb2w6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5yZWN1cnNpb25BdXRvRml0Q29sdW1uKGNvbCwgbnVsbCwgc2hlZXQpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSByZWN1cnNpb25BdXRvRml0Q29sdW1uKGNvbHVtbjogYW55LCBjaGlsZExpc3Q6IGFueVtdLCBzaGVldDogYW55KSB7XHJcbiAgICAgICAgaWYgKGNvbHVtbikge1xyXG4gICAgICAgICAgICBpZiAoY29sdW1uLmNoaWxkTGlzdCAmJiBjb2x1bW4uY2hpbGRMaXN0Lmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5yZWN1cnNpb25BdXRvRml0Q29sdW1uKG51bGwsIGNvbHVtbi5jaGlsZExpc3QsIHNoZWV0KTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGlmIChjb2x1bW4uYXV0b0ZpdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNoZWV0LmF1dG9GaXRDb2x1bW4odGhpcy5hdXRvRml0Q29sdW1uSW5kZXgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGhpcy5hdXRvRml0Q29sdW1uSW5kZXggKz0gMTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGNoaWxkTGlzdC5mb3JFYWNoKChjb2w6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKGNvbC5jaGlsZExpc3QgJiYgY29sLmNoaWxkTGlzdC5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlY3Vyc2lvbkF1dG9GaXRDb2x1bW4obnVsbCwgY29sLmNoaWxkTGlzdCwgc2hlZXQpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoY29sLmF1dG9GaXQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2hlZXQuYXV0b0ZpdENvbHVtbih0aGlzLmF1dG9GaXRDb2x1bW5JbmRleCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYXV0b0ZpdENvbHVtbkluZGV4ICs9IDE7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBjYWNoZVN0eWxlKHNoZWV0OiBhbnkpIHtcclxuICAgICAgICB0aGlzLmRhdGFTdHlsZUFycmF5ID0gW107XHJcbiAgICAgICAgdGhpcy5kYXRhUm93SGVpZ2h0QXJyYXkgPSBbXTtcclxuICAgICAgICB0aGlzLmRhdGFDb2xJbmZvQXJyYXkgPSBbXTtcclxuICAgICAgICB0aGlzLmZvb3RlclN0eWxlQXJyYXkgPSBbXTtcclxuICAgICAgICB0aGlzLmZvb3RlclJvd0hlaWdodEFycmF5ID0gW107XHJcbiAgICAgICAgdGhpcy5mb290ZXJTcGFuc0FycmF5ID0gW107XHJcbiAgICAgICAgdGhpcy5mb290ZXJEYXRhQXJyYXkgPSBbXTtcclxuXHJcbiAgICAgICAgLy8g57yT5a2Y5Yy65Z+f5qC35byP5L+h5oGvXHJcbiAgICAgICAgZm9yIChsZXQgciA9IDA7IHIgPCBzaGVldC5nZXRSb3dDb3VudCgpOyByKyspIHtcclxuICAgICAgICAgICAgY29uc3QgY29sdW1uU3R5bGVBcnJheSA9IG5ldyBBcnJheSgpO1xyXG4gICAgICAgICAgICBjb25zdCBkYXRhQXJyYXkgPSBuZXcgQXJyYXkoKTtcclxuICAgICAgICAgICAgZm9yIChsZXQgYyA9IDA7IGMgPCBzaGVldC5nZXRDb2x1bW5Db3VudCgpOyBjKyspIHtcclxuICAgICAgICAgICAgICAgIGlmIChyID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGZvcm1hdHRlciA9ICcnO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChzaGVldC5nZXRGb3JtYXR0ZXIociwgYywgR0MuU3ByZWFkLlNoZWV0cy5TaGVldEFyZWEudmlld3BvcnQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvcm1hdHRlciA9IHNoZWV0LmdldEZvcm1hdHRlcihyLCBjLCBHQy5TcHJlYWQuU2hlZXRzLlNoZWV0QXJlYS52aWV3cG9ydCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvbEhlYWRlckNvdW50ID0gc2hlZXQuZ2V0Um93Q291bnQoR0MuU3ByZWFkLlNoZWV0cy5TaGVldEFyZWEuY29sSGVhZGVyKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBjb2xJbmZvOiBhbnkgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IHNoZWV0LmdldENlbGwociwgYywgR0MuU3ByZWFkLlNoZWV0cy5TaGVldEFyZWEudmlld3BvcnQpLnZhbHVlKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNpemU6IHNoZWV0LmdldENvbHVtbldpZHRoKGMsIEdDLlNwcmVhZC5TaGVldHMuU2hlZXRBcmVhLnZpZXdwb3J0KSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmlzaWJsZTogc2hlZXQuZ2V0Q29sdW1uVmlzaWJsZShjLCBHQy5TcHJlYWQuU2hlZXRzLlNoZWV0QXJlYS52aWV3cG9ydCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc2l6YWJsZTogc2hlZXQuZ2V0Q29sdW1uUmVzaXphYmxlKGMsIEdDLlNwcmVhZC5TaGVldHMuU2hlZXRBcmVhLnZpZXdwb3J0KSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9ybWF0dGVyOiBmb3JtYXR0ZXIuaW5kZXhPZignJicpID49IDAgPyBuZXcgTXlOdW1Gb3JtYXR0ZXIoZm9ybWF0dGVyKSA6IGZvcm1hdHRlcixcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGxheU5hbWU6IHNoZWV0LmdldENlbGwoKGNvbEhlYWRlckNvdW50IC0gMSksIGMsIEdDLlNwcmVhZC5TaGVldHMuU2hlZXRBcmVhLmNvbEhlYWRlcikudmFsdWUoKVxyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kYXRhQ29sSW5mb0FycmF5LnB1c2goY29sSW5mbyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBsZXQgc3R5bGUgPSBzaGVldC5nZXRTdHlsZShyLCBjLCBHQy5TcHJlYWQuU2hlZXRzLlNoZWV0QXJlYS52aWV3cG9ydCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoc3R5bGUgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHN0eWxlID0gbmV3IEdDLlNwcmVhZC5TaGVldHMuU3R5bGUoKTtcclxuICAgICAgICAgICAgICAgICAgICBzdHlsZS5sb2NrZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBzdHlsZS5sb2NrZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHN0eWxlICYmIHN0eWxlLmZvcm1hdHRlciAmJiBzdHlsZS5mb3JtYXR0ZXIuaW5kZXhPZignJicpID49IDApIHtcclxuICAgICAgICAgICAgICAgICAgICBzdHlsZS5mb3JtYXR0ZXIgPSBuZXcgTXlOdW1Gb3JtYXR0ZXIoc3R5bGUuZm9ybWF0dGVyKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbHVtblN0eWxlQXJyYXkucHVzaChzdHlsZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgY29uc3QgdGV4dCA9IHNoZWV0LmdldFZhbHVlKHIsIGMsIEdDLlNwcmVhZC5TaGVldHMuU2hlZXRBcmVhLnZpZXdwb3J0KVxyXG4gICAgICAgICAgICAgICAgICAgIHx8IHNoZWV0LmdldFRleHQociwgYywgR0MuU3ByZWFkLlNoZWV0cy5TaGVldEFyZWEudmlld3BvcnQpXHJcbiAgICAgICAgICAgICAgICAgICAgfHwgJyc7XHJcbiAgICAgICAgICAgICAgICBkYXRhQXJyYXkucHVzaCh0ZXh0KTtcclxuXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHIgPT09IDApIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZGF0YVJvd0hlaWdodEFycmF5LnB1c2goc2hlZXQuZ2V0Um93SGVpZ2h0KHIpKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZGF0YVN0eWxlQXJyYXkucHVzaChjb2x1bW5TdHlsZUFycmF5KTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZm9vdGVyUm93SGVpZ2h0QXJyYXkucHVzaChzaGVldC5nZXRSb3dIZWlnaHQocikpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5mb290ZXJTdHlsZUFycmF5LnB1c2goY29sdW1uU3R5bGVBcnJheSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmZvb3RlckRhdGFBcnJheS5wdXNoKGRhdGFBcnJheSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIOe8k+WtmHNwYW5cclxuICAgICAgICBjb25zdCBzcGFucyA9IHNoZWV0LmdldFNwYW5zKCk7XHJcbiAgICAgICAgaWYgKHNwYW5zICYmIHNwYW5zLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6cHJlZmVyLWZvci1vZlxyXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNwYW5zLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoc3BhbnNbaV0ucm93ID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZm9vdGVyU3BhbnNBcnJheS5wdXNoKHNwYW5zW2ldKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBzaGVldC5kZWxldGVSb3dzKDEsIHNoZWV0LmdldFJvd0NvdW50KCkgLSAxKTtcclxuICAgIH1cclxuXHJcbiAgICBhcHBseVN0eWxlKHNoZWV0OiBhbnksIHNjaGVtYTogYW55LCBzaG93WmVybz86IGJvb2xlYW4pIHtcclxuICAgICAgICBsZXQgcm93Q291bnQgPSBzaGVldC5nZXRSb3dDb3VudCgpO1xyXG4gICAgICAgIGNvbnN0IGNvbENvdW50ID0gc2hlZXQuZ2V0Q29sdW1uQ291bnQoKTtcclxuICAgICAgICBjb25zdCBmb290ZXJDb3VudCA9IHRoaXMuZm9vdGVyUm93SGVpZ2h0QXJyYXkubGVuZ3RoO1xyXG4gICAgICAgIHNoZWV0LmFkZFJvd3Mocm93Q291bnQsIGZvb3RlckNvdW50KTtcclxuICAgICAgICBsZXQgaW5kZXggPSAwO1xyXG4gICAgICAgIGNvbnN0IGdyb3VwRmllbGRDYWNoZSA9IFtdO1xyXG4gICAgICAgIGNvbnN0IGdyb3VwRmllbGRWYWx1ZUNhY2hlID0gW107XHJcbiAgICAgICAgY29uc3QgZ3JvdXBSb3dDYWNoZSA9IFtdO1xyXG4gICAgICAgIGNvbnN0IGdyb3VwVHJlZUxldmVsID0ge307XHJcbiAgICAgICAgY29uc3QgY29sdW1ucyA9IHNoZWV0LnRvSlNPTigpLmNvbHVtbnM7XHJcbiAgICAgICAgdGhpcy5nZXRHcm91cEZpZWxkKGdyb3VwRmllbGRDYWNoZSwgc2NoZW1hKTtcclxuICAgICAgICBjb25zdCBmb3JtYXRGaWVsZENhY2hlID0gW107XHJcbiAgICAgICAgdGhpcy5nZXRGb3JtYXRGaWVsZChmb3JtYXRGaWVsZENhY2hlLCBzY2hlbWEpO1xyXG4gICAgICAgIHRoaXMuZ2V0SXNSZWRDb2x1bW5zKGZvcm1hdEZpZWxkQ2FjaGUsIHNjaGVtYSk7XHJcbiAgICAgICAgY29uc3QgaXNSZWRDb2x1bW5zID0ge1xyXG4gICAgICAgICAgICBjb2xJbmRleDogMCxcclxuICAgICAgICAgICAgaXNSZWRDb2x1bW5zOiBbXVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5nZXRJc1JlZENvbHVtbnMoc2NoZW1hLCBpc1JlZENvbHVtbnMpO1xyXG4gICAgICAgIGNvbnN0IHNoZWV0Q29sdW1ucyA9IHNoZWV0LnRvSlNPTigpLmNvbHVtbnM7XHJcbiAgICAgICAgZm9yIChsZXQgciA9IDA7IHIgPCAocm93Q291bnQgKyBmb290ZXJDb3VudCk7IHIrKykge1xyXG4gICAgICAgICAgICBpZiAoZm9ybWF0RmllbGRDYWNoZSAmJiBmb3JtYXRGaWVsZENhY2hlLmxlbmd0aCAmJiByIDwgcm93Q291bnQpIHtcclxuICAgICAgICAgICAgICAgIGZvcm1hdEZpZWxkQ2FjaGUuZm9yRWFjaCgoaXRlbTogYW55KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZGF0YUl0ZW0gPSBzaGVldC5nZXREYXRhSXRlbShyKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBwcmVjaXNpb24gPSBkYXRhSXRlbVtpdGVtLmZvcm1hdEZpZWxkXSAtIDA7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IG51bWJlckZvcm1hdCA9IGl0ZW0uZm9ybWF0dGVyICYmIChpdGVtLmZvcm1hdHRlci5pbmRleE9mKCcjLCMjIycpID49IDAgfHwgaXRlbS5mb3JtYXR0ZXIuaW5kZXhPZignIywjIzAnKSA+PSAwKSA/ICcjLCMjMC4nIDogJzAuJztcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5pc051bWJlcihwcmVjaXNpb24pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IHAgPSAwOyBwIDwgcHJlY2lzaW9uOyBwKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG51bWJlckZvcm1hdCArPSAnMCc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZm9ybWF0Q29sSW5kZXggPSBzaGVldENvbHVtbnMuZmluZEluZGV4KChlbDogYW55KSA9PiBlbC5uYW1lID09IGl0ZW0uc291cmNlRmllbGQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChmb3JtYXRDb2xJbmRleCA+PSAwICYmIG51bWJlckZvcm1hdCAhPSAnMC4nICYmIG51bWJlckZvcm1hdCAhPSAnIywjIzAuJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzaGVldC5nZXRDZWxsKHIsIGZvcm1hdENvbEluZGV4KS5mb3JtYXR0ZXIobnVtYmVyRm9ybWF0KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZm9yIChsZXQgYyA9IDA7IGMgPCBjb2xDb3VudDsgYysrKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAociA9PT0gMCAmJiAhc2hlZXQuZ2V0Q29sdW1uVmlzaWJsZShpbmRleCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBpbmRleCArPSAxO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHIgPj0gcm93Q291bnQpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoYyA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzaGVldC5zZXRTdHlsZShyLCBjLCB0aGlzLmZvb3RlclN0eWxlQXJyYXlbciAtIHJvd0NvdW50XVtjXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmZvb3RlckRhdGFBcnJheSAmJiB0aGlzLmZvb3RlckRhdGFBcnJheS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNoZWV0LnNldFZhbHVlKHIsIGMsIHRoaXMuZm9vdGVyRGF0YUFycmF5W3IgLSByb3dDb3VudF1bY10pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNoZWV0LnNldFJvd0hlaWdodChyLCB0aGlzLmZvb3RlclJvd0hlaWdodEFycmF5W3IgLSByb3dDb3VudF0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5mb290ZXJTcGFuc0FycmF5ICYmIHRoaXMuZm9vdGVyU3BhbnNBcnJheS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNoZWV0LmFkZFNwYW4ociwgdGhpcy5mb290ZXJTcGFuc0FycmF5WzBdLmNvbCwgdGhpcy5mb290ZXJTcGFuc0FycmF5WzBdLnJvd0NvdW50LCB0aGlzLmZvb3RlclNwYW5zQXJyYXlbMF0uY29sQ291bnQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBmb3JtYXR0ZXIgPSBzaGVldC5nZXRGb3JtYXR0ZXIociwgYywgR0MuU3ByZWFkLlNoZWV0cy5TaGVldEFyZWEudmlld3BvcnQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChmb3JtYXR0ZXIgJiYgZm9ybWF0dGVyLmluZGV4T2YgJiYgZm9ybWF0dGVyLmluZGV4T2YoJy8nKSA+PSAwICYmIGZvcm1hdHRlci5pbmRleE9mKCc7JykgPj0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjZWxsVmFsdWUgPSB0aGlzLmxvZ2ljRm9ybWF0KGZvcm1hdHRlciwgc2hlZXQuZ2V0VmFsdWUociwgYykpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzaGVldC5zZXRUZXh0KHIsIGMsIGNlbGxWYWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChmb3JtYXR0ZXIgJiYgdHlwZW9mIGZvcm1hdHRlciA9PT0gJ3N0cmluZycgJiYgKGZvcm1hdHRlci5pbmRleE9mKCd5eScpID49IDAgfHwgZm9ybWF0dGVyLmluZGV4T2YoJ01NJykgPj0gMCB8fCBmb3JtYXR0ZXIuaW5kZXhPZignZGQnKSA+PSAwIHx8IGZvcm1hdHRlci5pbmRleE9mKCdISCcpID49IDAgfHwgZm9ybWF0dGVyLmluZGV4T2YoJ21tJykgPj0gMCB8fCBmb3JtYXR0ZXIuaW5kZXhPZignc3MnKSA+PSAwKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2hlZXQuZ2V0RGF0YUl0ZW0ocikuaGFzT3duUHJvcGVydHkoXCJxZHBfZGF0YV9mbGFnXCIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaGVldC5zZXRGb3JtYXR0ZXIociwgYywgJycpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpc1JlZENvbHVtbnMuaXNSZWRDb2x1bW5zLmZpbmRJbmRleChlbCA9PiBlbC5jb2xJbmRleCA9PSBjKSA+PSAwICYmIHRoaXMuaXNOdW1iZXIoc2hlZXQuZ2V0Q2VsbChyLCBjKS52YWx1ZSgpKSAmJiAoc2hlZXQuZ2V0Q2VsbChyLCBjKS52YWx1ZSgpIC0gMCA8IDApKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNoZWV0LmdldENlbGwociwgYykuZm9yZUNvbG9yKCdyZWQnKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFzaG93WmVybykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXNob3daZXJvICYmIGNvbHVtbnMgJiYgY29sdW1ucy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb2x1bW5zW2NdLm5hbWUgPT09ICd0cmVlTGV2ZWwnIHx8IGNvbHVtbnNbY10ubmFtZSA9PT0gJ2lzRGV0YWlsJykgeyBjb250aW51ZTsgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNoZWV0LmdldENlbGwociwgYykudmFsdWUoKSA9PT0gMCB8fCBzaGVldC5nZXRDZWxsKHIsIGMpLnZhbHVlKCkgPT0gJzAnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hlZXQuZ2V0Q2VsbChyLCBjKS52YWx1ZSgnJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHIgPCByb3dDb3VudCkge1xyXG4gICAgICAgICAgICAgICAgLy8g6K6+572u6KGM6auYXHJcbiAgICAgICAgICAgICAgICBzaGVldC5zZXRSb3dIZWlnaHQociwgdGhpcy5kYXRhUm93SGVpZ2h0QXJyYXlbMF0pO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMudHlwZSA9PT0gJ3RyZWVsaXN0Jykge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGxldmVsID0gc2hlZXQuZ2V0RGF0YUl0ZW0ocilbJ3RyZWVMZXZlbCddO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGlzRGV0YWlsID0gc2hlZXQuZ2V0RGF0YUl0ZW0ocilbJ2lzRGV0YWlsJ107XHJcbiAgICAgICAgICAgICAgICAgICAgc2hlZXQuc2V0Q2VsbFR5cGUociwgaW5kZXgsIG5ldyBUcmVlQ2VsbFR5cGUobnVsbCwgZmFsc2UsIGxldmVsLCBpc0RldGFpbCkpO1xyXG4gICAgICAgICAgICAgICAgICAgIHNoZWV0LmdldFN0eWxlKHIsIGluZGV4KS5oQWxpZ24gPSAwO1xyXG4gICAgICAgICAgICAgICAgICAgIHNoZWV0LmdldFN0eWxlKHIsIGluZGV4KS50ZXh0SW5kZW50ID0gbGV2ZWwgKyAyO1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDw9IGxldmVsOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2hlZXQucm93T3V0bGluZXMuZ3JvdXAociwgMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLnR5cGUgPT09ICdsaXN0JyAmJiBncm91cEZpZWxkQ2FjaGUubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGZpbHRlckNvbmRpdGlvbjogYW55ID0ge307XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGdyb3VwUm93Q2FjaGUuZmluZEluZGV4KHggPT4geCA9PT0gcikgPj0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgYyA9IDA7IGMgPCBjb2xDb3VudDsgYysrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzaGVldC5nZXREYXRhSXRlbShyKS5oYXNPd25Qcm9wZXJ0eShcInFkcF9kYXRhX2ZsYWdcIikgJiYgKHNoZWV0LmdldERhdGFJdGVtKHIpW1wicWRwX2RhdGFfZmxhZ1wiXSArICcnKSA9PT0gKDQgKyAnJykpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzaGVldC5nZXRGb3JtYXR0ZXIociwgYykgJiYgKHNoZWV0LmdldEZvcm1hdHRlcihyLCBjKS50b1N0cmluZygpLmluZGV4T2YoJ3knKSA+PSAwIHx8IHNoZWV0LmdldEZvcm1hdHRlcihyLCBjKS50b1N0cmluZygpLmluZGV4T2YoJ2QnKSA+PSAwIHx8IHNoZWV0LmdldEZvcm1hdHRlcihyLCBjKS50b1N0cmluZygpLmluZGV4T2YoJ00nKSA+PSAwKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNoZWV0LnNldEZvcm1hdHRlcihyLCBjLCAnJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgYWRkUm93c0NhY2hlID0gW107XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBncm91cEZpZWxkQ2FjaGUubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYWRkUm93SW5kZXggPSByICsgYWRkUm93c0NhY2hlLmxlbmd0aDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29uc3QgZ3JvdXBGaWVsZCA9IGdyb3VwRmllbGRDYWNoZVtpXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZmllbGRJbmRleCA9IHRoaXMuZGF0YUNvbEluZm9BcnJheS5maW5kSW5kZXgoeCA9PiB4Lm5hbWUgPT09IGdyb3VwRmllbGRDYWNoZVtpXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpbHRlckNvbmRpdGlvbiA9IHt9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBmID0gMDsgZiA8PSBpOyBmKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbHRlckNvbmRpdGlvbltncm91cEZpZWxkQ2FjaGVbZl1dID0gc2hlZXQuZ2V0RGF0YUl0ZW0oYWRkUm93SW5kZXgpW2dyb3VwRmllbGRDYWNoZVtmXV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZmlsdGVyUmVzdWx0ID0gZmlsdGVyKGdyb3VwRmllbGRWYWx1ZUNhY2hlLCBmaWx0ZXJDb25kaXRpb24pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoKCFmaWx0ZXJSZXN1bHQgfHwgIWZpbHRlclJlc3VsdC5sZW5ndGgpICYmICFzaGVldC5nZXREYXRhSXRlbShhZGRSb3dJbmRleCkuaGFzT3duUHJvcGVydHkoXCJxZHBfZGF0YV9mbGFnXCIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zdCBncm91cEZpZWxkVmFsdWUgPSB7fTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGdyb3VwRmllbGRWYWx1ZVtncm91cEZpZWxkXSA9IGZpbHRlckNvbmRpdGlvbltncm91cEZpZWxkXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdyb3VwRmllbGRWYWx1ZUNhY2hlLnB1c2goZmlsdGVyQ29uZGl0aW9uKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHN0eWxlID0gdGhpcy5kYXRhU3R5bGVBcnJheVswXVtmaWVsZEluZGV4XTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlLmhBbGlnbiA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZS5jZWxsVHlwZSA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZS5iYWNrQ29sb3IgPSAnI0Y0RjdGQSc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaGVldC5hZGRSb3dzKGFkZFJvd0luZGV4LCAxKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNoZWV0LnNldFJvd0hlaWdodChhZGRSb3dJbmRleCwgdGhpcy5kYXRhUm93SGVpZ2h0QXJyYXlbMF0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hlZXQuc2V0U3R5bGUoYWRkUm93SW5kZXgsIGluZGV4LCBzdHlsZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaGVldC5nZXRDZWxsKGFkZFJvd0luZGV4LCBpbmRleCkudmFsdWUoZmlsdGVyQ29uZGl0aW9uW2dyb3VwRmllbGRDYWNoZVtpXV0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hlZXQuYWRkU3BhbihhZGRSb3dJbmRleCwgaW5kZXgsIDEsIChjb2xDb3VudCAtIGluZGV4KSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaGVldC5nZXRDZWxsKGFkZFJvd0luZGV4LCBpbmRleCkudGV4dEluZGVudCgoaSArIDEpICogMik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBncm91cFRyZWVMZXZlbFthZGRSb3dJbmRleCArICcnXSA9IHsgdHJlZUxldmVsOiBpLCBpc0RldGFpbDogMCB9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGkgPT09IChncm91cEZpZWxkQ2FjaGUubGVuZ3RoIC0gMSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBncm91cFRyZWVMZXZlbFsoYWRkUm93SW5kZXggKyAxKSArICcnXSA9IHsgdHJlZUxldmVsOiBncm91cEZpZWxkQ2FjaGUubGVuZ3RoLCBpc0RldGFpbDogMSB9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcm93Q291bnQgKz0gMTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZFJvd3NDYWNoZS5wdXNoKGkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZ3JvdXBSb3dDYWNoZS5wdXNoKGFkZFJvd0luZGV4KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzaGVldC5nZXREYXRhSXRlbShhZGRSb3dJbmRleCkuaGFzT3duUHJvcGVydHkoXCJxZHBfZGF0YV9mbGFnXCIpICYmIChzaGVldC5nZXREYXRhSXRlbShhZGRSb3dJbmRleClbXCJxZHBfZGF0YV9mbGFnXCJdICsgJycpID09PSAoMyArICcnKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGkgPT09IChncm91cEZpZWxkQ2FjaGUubGVuZ3RoIC0gMSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBncm91cFRyZWVMZXZlbFsoYWRkUm93SW5kZXggKyAxKSArICcnXSA9IHsgdHJlZUxldmVsOiBncm91cEZpZWxkQ2FjaGUubGVuZ3RoLCBpc0RldGFpbDogMSB9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZvciAobGV0IHIgPSAwOyByIDwgcm93Q291bnQ7IHIrKykge1xyXG4gICAgICAgICAgICBpZiAoIWdyb3VwVHJlZUxldmVsLmhhc093blByb3BlcnR5KHIpKSB7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBmb3IgKGxldCB0ID0gMDsgdCA8PSBncm91cFRyZWVMZXZlbFtyICsgJyddLnRyZWVMZXZlbDsgdCsrKSB7XHJcbiAgICAgICAgICAgICAgICBzaGVldC5yb3dPdXRsaW5lcy5ncm91cChyLCAxKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBzaGVldC5zZXRDZWxsVHlwZShyLCBpbmRleCwgbmV3IFRyZWVDZWxsVHlwZShudWxsLCBmYWxzZSwgZ3JvdXBUcmVlTGV2ZWxbciArICcnXS50cmVlTGV2ZWwsIGdyb3VwVHJlZUxldmVsW3IgKyAnJ10uaXNEZXRhaWwpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMudHlwZSAhPT0gJ2Nyb3NzdGFiJyAmJiB0aGlzLmdldFNob3dGaWx0ZXJSb3coc2NoZW1hKSkge1xyXG4gICAgICAgICAgICB0aGlzLmZpbHRlclJvdyhzaGVldCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGdldEdyb3VwRmllbGQoZ3JvdXBDb2xDYWNoZTogYW55LCBzY2hlbWE6IGFueSkge1xyXG4gICAgICAgIGlmIChzY2hlbWEgJiYgc2NoZW1hLnNjaGVtYVZhbHVlICYmIHNjaGVtYS5zY2hlbWFWYWx1ZS5jb2x1bW5PcHRpb24gJiYgc2NoZW1hLnNjaGVtYVZhbHVlLmNvbHVtbk9wdGlvbi5jb2xMaXN0ICYmIHNjaGVtYS5zY2hlbWFWYWx1ZS5jb2x1bW5PcHRpb24uY29sTGlzdC5sZW5ndGgpIHtcclxuICAgICAgICAgICAgdGhpcy5hdXRvRml0Q29sdW1uSW5kZXggPSAwO1xyXG4gICAgICAgICAgICBzY2hlbWEuc2NoZW1hVmFsdWUuY29sdW1uT3B0aW9uLmNvbExpc3QuZm9yRWFjaCgoY29sOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMucmVjdXJzaW9uR2V0R3JvdXBDb2x1bW4oZ3JvdXBDb2xDYWNoZSwgY29sLCBudWxsKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGdldElzUmVkQ29sdW1ucyhzY2hlbWE6IGFueSwgcGFyYW1zOiBhbnkpIHtcclxuICAgICAgICBpZiAoc2NoZW1hICYmIHNjaGVtYS5zY2hlbWFWYWx1ZSAmJiBzY2hlbWEuc2NoZW1hVmFsdWUuY29sdW1uT3B0aW9uICYmIHNjaGVtYS5zY2hlbWFWYWx1ZS5jb2x1bW5PcHRpb24uY29sTGlzdCAmJiBzY2hlbWEuc2NoZW1hVmFsdWUuY29sdW1uT3B0aW9uLmNvbExpc3QubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIHNjaGVtYS5zY2hlbWFWYWx1ZS5jb2x1bW5PcHRpb24uY29sTGlzdC5mb3JFYWNoKChjb2w6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5yZWN1cnNpdmVJc1JlZENvbHVtbihjb2wsIG51bGwsIHBhcmFtcyk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBnZXRGb3JtYXRGaWVsZChmaWVsZENhY2hlOiBhbnksIHNjaGVtYTogYW55KSB7XHJcbiAgICAgICAgaWYgKHNjaGVtYSAmJiBzY2hlbWEuc2NoZW1hVmFsdWUgJiYgc2NoZW1hLnNjaGVtYVZhbHVlLmNvbHVtbk9wdGlvbiAmJiBzY2hlbWEuc2NoZW1hVmFsdWUuY29sdW1uT3B0aW9uLmNvbExpc3QgJiYgc2NoZW1hLnNjaGVtYVZhbHVlLmNvbHVtbk9wdGlvbi5jb2xMaXN0Lmxlbmd0aCkge1xyXG4gICAgICAgICAgICB0aGlzLmF1dG9GaXRDb2x1bW5JbmRleCA9IDA7XHJcbiAgICAgICAgICAgIHNjaGVtYS5zY2hlbWFWYWx1ZS5jb2x1bW5PcHRpb24uY29sTGlzdC5mb3JFYWNoKChjb2w6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5yZWN1cnNpb25HZXRGb3JtYXRDb2x1bW4oZmllbGRDYWNoZSwgY29sLCBudWxsKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGdldFNob3dIZWFkZXJTb3J0KHNjaGVtYTogYW55KSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgaWYgKHNjaGVtYSAmJiBzY2hlbWEuc2NoZW1hVmFsdWUgJiYgc2NoZW1hLnNjaGVtYVZhbHVlLm90aGVyT3B0aW9uICYmIHNjaGVtYS5zY2hlbWFWYWx1ZS5vdGhlck9wdGlvbi5zaG93SGVhZGVyU29ydCAhPSBudWxsICYmIHNjaGVtYS5zY2hlbWFWYWx1ZS5vdGhlck9wdGlvbi5zaG93SGVhZGVyU29ydCAhPSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBzY2hlbWEuc2NoZW1hVmFsdWUub3RoZXJPcHRpb24uc2hvd0hlYWRlclNvcnQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0U2hvd0ZpbHRlclJvdyhzY2hlbWE6IGFueSkge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGlmIChzY2hlbWEgJiYgc2NoZW1hLnNjaGVtYVZhbHVlICYmIHNjaGVtYS5zY2hlbWFWYWx1ZS5vdGhlck9wdGlvbiAmJiBzY2hlbWEuc2NoZW1hVmFsdWUub3RoZXJPcHRpb24uc2hvd0ZpbHRlclJvdyAhPSBudWxsICYmIHNjaGVtYS5zY2hlbWFWYWx1ZS5vdGhlck9wdGlvbi5zaG93RmlsdGVyUm93ICE9IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHNjaGVtYS5zY2hlbWFWYWx1ZS5vdGhlck9wdGlvbi5zaG93RmlsdGVyUm93O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGdldE1lcmdlQ2VsbChzY2hlbWE6IGFueSkge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGlmIChzY2hlbWEgJiYgc2NoZW1hLnNjaGVtYVZhbHVlICYmIHNjaGVtYS5zY2hlbWFWYWx1ZS5vdGhlck9wdGlvbiAmJiBzY2hlbWEuc2NoZW1hVmFsdWUub3RoZXJPcHRpb24ubWVyZ2VDZWxsICE9IG51bGwgJiYgc2NoZW1hLnNjaGVtYVZhbHVlLm90aGVyT3B0aW9uLm1lcmdlQ2VsbCAhPSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBzY2hlbWEuc2NoZW1hVmFsdWUub3RoZXJPcHRpb24ubWVyZ2VDZWxsO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSByZWN1cnNpb25HZXRGb3JtYXRDb2x1bW4oZmllbGRDYWNoZTogYW55LCBjb2x1bW46IGFueSwgY2hpbGRMaXN0OiBhbnlbXSkge1xyXG4gICAgICAgIGlmIChjb2x1bW4pIHtcclxuICAgICAgICAgICAgaWYgKGNvbHVtbi5jaGlsZExpc3QgJiYgY29sdW1uLmNoaWxkTGlzdC5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucmVjdXJzaW9uR2V0Rm9ybWF0Q29sdW1uKGZpZWxkQ2FjaGUsIG51bGwsIGNvbHVtbi5jaGlsZExpc3QpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaWYgKGNvbHVtbi5mb3JtYXRUeXBlID09IDEgJiYgY29sdW1uLmZvcm1hdEZpZWxkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZmllbGRDYWNoZS5wdXNoKHsgc291cmNlRmllbGQ6IGNvbHVtbi5iaW5kRmllbGQsIGZvcm1hdEZpZWxkOiBjb2x1bW4uZm9ybWF0RmllbGQsIGZvcm1hdHRlcjogY29sdW1uLmZvcm1hdHRvciB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGNoaWxkTGlzdC5mb3JFYWNoKChjb2w6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKGNvbC5jaGlsZExpc3QgJiYgY29sLmNoaWxkTGlzdC5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlY3Vyc2lvbkdldEZvcm1hdENvbHVtbihmaWVsZENhY2hlLCBudWxsLCBjb2wuY2hpbGRMaXN0KTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbC5mb3JtYXRUeXBlID09IDEgJiYgY29sLmZvcm1hdEZpZWxkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpZWxkQ2FjaGUucHVzaCh7IHNvdXJjZUZpZWxkOiBjb2wuYmluZEZpZWxkLCBmb3JtYXRGaWVsZDogY29sLmZvcm1hdEZpZWxkLCBmb3JtYXR0ZXI6IGNvbC5mb3JtYXR0b3IgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSByZWN1cnNpb25HZXRHcm91cENvbHVtbihncm91cENvbENhY2hlOiBhbnksIGNvbHVtbjogYW55LCBjaGlsZExpc3Q6IGFueVtdKSB7XHJcbiAgICAgICAgaWYgKGNvbHVtbikge1xyXG4gICAgICAgICAgICBpZiAoY29sdW1uLmNoaWxkTGlzdCAmJiBjb2x1bW4uY2hpbGRMaXN0Lmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5yZWN1cnNpb25HZXRHcm91cENvbHVtbihncm91cENvbENhY2hlLCBudWxsLCBjb2x1bW4uY2hpbGRMaXN0KTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGlmIChjb2x1bW4uaXNHcm91cCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGdyb3VwQ29sQ2FjaGUucHVzaChjb2x1bW4uYmluZEZpZWxkKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGNoaWxkTGlzdC5mb3JFYWNoKChjb2w6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKGNvbC5jaGlsZExpc3QgJiYgY29sLmNoaWxkTGlzdC5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlY3Vyc2lvbkdldEdyb3VwQ29sdW1uKGdyb3VwQ29sQ2FjaGUsIG51bGwsIGNvbC5jaGlsZExpc3QpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoY29sLmlzR3JvdXApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZ3JvdXBDb2xDYWNoZS5wdXNoKGNvbC5iaW5kRmllbGQpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGxvZ2ljRm9ybWF0KGZvcm1hdHRvcjogYW55LCBjZWxsVmFsdWU6IGFueSkge1xyXG4gICAgICAgIGNvbnN0IHN0ciA9IGZvcm1hdHRvci5zcGxpdCgnOycpO1xyXG4gICAgICAgIGNvbnN0IHJlYWwgPSBzdHJbMF0uc3BsaXQoJy8nKTtcclxuICAgICAgICBjb25zdCBkaXNwID0gc3RyWzFdLnNwbGl0KCcvJyk7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCByZWFsLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTp0cmlwbGUtZXF1YWxzXHJcbiAgICAgICAgICAgIGlmIChyZWFsW2ldID09IChjZWxsVmFsdWUgKyAnJykpIHtcclxuICAgICAgICAgICAgICAgIGNlbGxWYWx1ZSA9IGRpc3BbaV07XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gY2VsbFZhbHVlO1xyXG4gICAgfVxyXG5cclxuICAgIGZpbHRlclJvdyhzaGVldDogYW55KSB7XHJcbiAgICAgICAgc2hlZXQuYWRkUm93cygwLCAxKTtcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNoZWV0LmdldFJvd0NvdW50KCk7IGkrKykge1xyXG4gICAgICAgICAgICBzaGVldC5nZXRDZWxsKGksIDAsIEdDLlNwcmVhZC5TaGVldHMuU2hlZXRBcmVhLnJvd0hlYWRlcikudmFsdWUoaSA9PSAwID8gJycgOiBpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgc2hlZXQuc2V0Um93SGVpZ2h0KDAsIHRoaXMuZGF0YVJvd0hlaWdodEFycmF5WzBdKTtcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNoZWV0LmdldENvbHVtbkNvdW50KCk7IGkrKykge1xyXG4gICAgICAgICAgICBjb25zdCBzID0gbmV3IEdDLlNwcmVhZC5TaGVldHMuU3R5bGUoKTtcclxuICAgICAgICAgICAgcy5mcm9tSlNPTih0aGlzLmRhdGFTdHlsZUFycmF5WzBdW2ldLnRvSlNPTigpKTtcclxuICAgICAgICAgICAgcy5sb2NrZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgcy5mb3JtYXR0ZXIgPSAnQCc7XHJcbiAgICAgICAgICAgIHNoZWV0LnNldFN0eWxlKDAsIGksIHMpO1xyXG4gICAgICAgICAgICBzaGVldC5zZXRDZWxsVHlwZSgwLCBpLCBuZXcgRmlsdGVyQ2VsbFR5cGUoc2hlZXQpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgZmlsdGVyID0gbmV3IEdDLlNwcmVhZC5TaGVldHMuRmlsdGVyLkhpZGVSb3dGaWx0ZXIobmV3IEdDLlNwcmVhZC5TaGVldHMuUmFuZ2UoMSwgMCwgc2hlZXQuZ2V0Um93Q291bnQoKSwgc2hlZXQuZ2V0Q29sdW1uQ291bnQoKSkpO1xyXG4gICAgICAgIHNoZWV0LnJvd0ZpbHRlcihmaWx0ZXIpO1xyXG4gICAgICAgIGZpbHRlci5maWx0ZXJCdXR0b25WaXNpYmxlKGZhbHNlKTtcclxuICAgIH1cclxuXHJcbiAgICBsaW5rRmllbGQoc3ByZWFkOiBhbnksIHNoZWV0OiBhbnkpIHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBjb25zdCBzZWxmID0gdGhpcztcclxuICAgICAgICAgICAgY29uc3Qgcm93Q291bnQgPSBzaGVldC5nZXRSb3dDb3VudCgpO1xyXG4gICAgICAgICAgICBjb25zdCBjb2xDb3VudCA9IHNoZWV0LmdldENvbHVtbkNvdW50KCk7XHJcbiAgICAgICAgICAgIC8vIGNvbnN0IGZvb3RlckNvdW50ID0gdGhpcy5mb290ZXJSb3dIZWlnaHRBcnJheS5sZW5ndGg7XHJcbiAgICAgICAgICAgIGZvciAobGV0IHIgPSAxOyByIDwgKHJvd0NvdW50KTsgcisrKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBkYXRhSXRlbSA9IHNoZWV0LmdldERhdGFJdGVtKHIpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGRhdGFJdGVtLmhhc093blByb3BlcnR5KCdkeW5hbWljUHJvcFNldCcpICYmIGRhdGFJdGVtLmR5bmFtaWNQcm9wU2V0Lmhhc093blByb3BlcnR5KCdxZHBfZGF0YV9mbGFnJykpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGZvciAobGV0IGMgPSAwOyBjIDwgY29sQ291bnQ7IGMrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGpvaW5TZWFyY2ggPSBKU09OLnBhcnNlKHRoaXMuam9pbnRzZWFyY2hJbmZvTGlzdFsnam9pblNlYXJjaCddKTtcclxuICAgICAgICAgICAgICAgICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6cHJlZmVyLWZvci1vZlxyXG4gICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgam9pblNlYXJjaC5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlbCA9IGpvaW5TZWFyY2hbaV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlbC5qb2ludHNlcmFjaGRpc3BsYXlzdHlsZSA9PT0gMikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVsLmxpbmtmaWVsZCA9PT0gdGhpcy5kYXRhQ29sSW5mb0FycmF5W2NdLm5hbWUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuaHlwZXJMaW5rUXVlcnlbdGhpcy5xdWVyeUlkXSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmh5cGVyTGlua1F1ZXJ5W3RoaXMucXVlcnlJZF0gPSB7fTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5oeXBlckxpbmtRdWVyeVt0aGlzLnF1ZXJ5SWRdW2MgKyAnJ10gPSBlbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBoMSA9IG5ldyBHQy5TcHJlYWQuU2hlZXRzLkNlbGxUeXBlcy5IeXBlckxpbmsoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoMS50ZXh0KGgxLmZvcm1hdChzaGVldC5nZXRDZWxsKHIsIGMpLnZhbHVlKCksIHRoaXMuZGF0YUNvbEluZm9BcnJheVtjXS5mb3JtYXR0ZXIpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoMS5hY3RpdmVPbkNsaWNrKHRydWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGgxLm9uQ2xpY2tBY3Rpb24oZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcHJlYWQuY29tbWFuZE1hbmFnZXIoKS5leGVjdXRlKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNtZDogJ2Ryb3Bkb3ducXVlcnknLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZjogc2VsZlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaGVldC5zZXRDZWxsVHlwZShyLCBjLCBoMSwgR0MuU3ByZWFkLlNoZWV0cy5TaGVldEFyZWEudmlld3BvcnQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHNwcmVhZC5jb21tYW5kTWFuYWdlcigpLnJlZ2lzdGVyKCdkcm9wZG93bnF1ZXJ5Jywge1xyXG4gICAgICAgICAgICAgICAgY2FuVW5kbzogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIGV4ZWN1dGU6IGZ1bmN0aW9uIChjb250ZXh0LCBvcHRpb25zLCBpc1VuZG8pIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCByb3cgPSBjb250ZXh0LmdldEFjdGl2ZVNoZWV0KCkuZ2V0QWN0aXZlUm93SW5kZXgoKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBjb2wgPSBjb250ZXh0LmdldEFjdGl2ZVNoZWV0KCkuZ2V0QWN0aXZlQ29sdW1uSW5kZXgoKTtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGtleSBpbiBvcHRpb25zLnNlbGYuaHlwZXJMaW5rUXVlcnlbb3B0aW9ucy5zZWxmLnF1ZXJ5SWRdKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChrZXkgPT09IChjb2wgKyAnJykpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGVsID0gb3B0aW9ucy5zZWxmLmh5cGVyTGlua1F1ZXJ5W29wdGlvbnMuc2VsZi5xdWVyeUlkXVtrZXldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGVudGl0eVBhcmFtID0geyAnaWQnOiAnbnVsbCcgfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHBhcmFtTWFwID0gbmV3IE1hcDxzdHJpbmcsIHN0cmluZz4oKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHNlYXJjaHBhcmFzID0gSlNPTi5wYXJzZShvcHRpb25zLnNlbGYuam9pbnRzZWFyY2hJbmZvTGlzdFsnam9pbnRwYXJhbSddKS5maWx0ZXIoeCA9PiB4LmZ1bmN0aW9uaWQgPT09IGVsWydpZCddKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGpvaW5QYXJhbSA9IG9wdGlvbnMuc2VsZi5jYWNoZS5nZXQoUnRmU2VydmljZXMuZ2V0VGFiSWQob3B0aW9ucy5zZWxmLnF1ZXJ5SWQpICsgJ2pvaW5TZWFyY2gnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBkYXRhSXRlbSA9IHsgJ2lkJzogJ251bGwnIH07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoam9pblBhcmFtLmNvbnRyb2xUeXBlID09PSAnY3Jvc3N0YWInKSB7IC8vIOS6pOWPieihqFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOiOt+WPluihjOagh+mimOeahOaVsOaNrlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSBqb2luUGFyYW0ucm93SGVhZGVyQ29sSW5mby5zdGFydDsgaSA8IGpvaW5QYXJhbS5yb3dIZWFkZXJDb2xJbmZvLmVuZDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gY29udGV4dC5nZXRBY3RpdmVTaGVldCgpLmdldFZhbHVlKHJvdywgaSwgR0MuU3ByZWFkLlNoZWV0cy5TaGVldEFyZWEudmlld3BvcnQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBuYW1lID0gY29udGV4dC5nZXRBY3RpdmVTaGVldCgpLmdldFZhbHVlKGpvaW5QYXJhbS5jb2xIZWFkZXJSb3dJbmZvLnN0YXJ0LCBpLCBHQy5TcHJlYWQuU2hlZXRzLlNoZWV0QXJlYS5jb2xIZWFkZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjb2xJbmZvID0gam9pblBhcmFtLmNvbEluZm9zLmZpbmQoKHg6IGFueSkgPT4geC5kaW1lbnNpb24gPT09IDEgJiYgeC5uYW1lID09PSBuYW1lKS5iaW5kRmllbGQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFJdGVtW2NvbEluZm9dID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOiOt+WPluWIl+agh+mimOeahOaVsOaNrlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSBqb2luUGFyYW0uY29sSGVhZGVyUm93SW5mby5zdGFydDsgaSA8IGpvaW5QYXJhbS5jb2xIZWFkZXJSb3dJbmZvLmVuZDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gY29udGV4dC5nZXRBY3RpdmVTaGVldCgpLmdldFZhbHVlKGksIGNvbCwgR0MuU3ByZWFkLlNoZWV0cy5TaGVldEFyZWEuY29sSGVhZGVyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY29sSW5mbyA9IGpvaW5QYXJhbS5jb2xJbmZvcy5maWx0ZXIoKHg6IGFueSkgPT4geC5kaW1lbnNpb24gPT09IDIpW2kgLSBqb2luUGFyYW0uY29sSGVhZGVyUm93SW5mby5zdGFydF0uYmluZEZpZWxkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhSXRlbVtjb2xJbmZvXSA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDojrflj5blgLzmoIfpopjnmoTmlbDmja5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZSA9IGNvbnRleHQuZ2V0QWN0aXZlU2hlZXQoKS5nZXRWYWx1ZShyb3csIGNvbCwgR0MuU3ByZWFkLlNoZWV0cy5TaGVldEFyZWEudmlld3BvcnQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5hbWUgPSBjb250ZXh0LmdldEFjdGl2ZVNoZWV0KCkuZ2V0VmFsdWUoam9pblBhcmFtLmNvbEhlYWRlclJvd0luZm8uZW5kLCBjb2wsIEdDLlNwcmVhZC5TaGVldHMuU2hlZXRBcmVhLmNvbEhlYWRlcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGNvbEluZm8gPSBqb2luUGFyYW0uY29sSW5mb3MuZmluZCgoeDogYW55KSA9PiB4LmRpbWVuc2lvbiA9PT0gMyAmJiB4Lm5hbWUgPT09IG5hbWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb2xJbmZvKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbEluZm8gPSBjb2xJbmZvLmJpbmRGaWVsZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YUl0ZW1bY29sSW5mb10gPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFJdGVtID0gY29udGV4dC5nZXRBY3RpdmVTaGVldCgpLmdldERhdGFJdGVtKHJvdyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY3VycmVudFNlbGVjdGVkSXRlbSA9IGRhdGFJdGVtOyAvLyDlvZPliY3pgInkuK3mlbDmja5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzZWFyY2hwYXJhcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VhcmNocGFyYXMuZm9yRWFjaCh2YWx1ZSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZS5wYXJhdmFsdWV0eXBlKSB7Ly8g6KGo6L6+5byPXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodmFsdWUucGFyYXZhbHVlLmluZGV4T2YoJ2dldFBhcmFtZXRlcignKSA+PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcGFyYW1ldGVyS2V5ID0gdmFsdWUucGFyYXZhbHVlLnJlcGxhY2UoLycvZywgJycpLnJlcGxhY2UoL1wiL2csICcnKS5yZXBsYWNlKC9nZXRQYXJhbWV0ZXJcXCgvZywgJycpLnJlcGxhY2UoL1xcKS9nLCAnJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5zZWxmLmdldFF1ZXJ5UGFyYW1ldGVycyhlbnRpdHlQYXJhbSwgcGFyYW1NYXAsIHBhcmFtZXRlcktleSwgdmFsdWUucGFyYSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVudGl0eVBhcmFtW3ZhbHVlLnBhcmFdID0gY3VycmVudFNlbGVjdGVkSXRlbVt2YWx1ZS5wYXJhdmFsdWVdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtTWFwLnNldCh2YWx1ZS5wYXJhLCBjdXJyZW50U2VsZWN0ZWRJdGVtW3ZhbHVlLnBhcmF2YWx1ZV0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW50aXR5UGFyYW1bdmFsdWUucGFyYV0gPSB2YWx1ZS5wYXJhdmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJhbU1hcC5zZXQodmFsdWUucGFyYSwgdmFsdWUucGFyYXZhbHVlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbnRpdHlQYXJhbSA9IGN1cnJlbnRTZWxlY3RlZEl0ZW07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBvcDogYW55ID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFBhcmVudFNlc3Npb25JZDogb3B0aW9ucy5zZWxmLmNhY2hlLmdldCgnc2Vzc2lvbicpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEVudGl0eVBhcmFtOiBlbnRpdHlQYXJhbVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCB0YWJJZCA9ICcnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVsLnNlYXJjaHR5cGUgPT09ICdmdW5jJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOiBlOafpeWJjVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG9wZW5NZW51b3B0aW9ucyA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2FwcFR5cGUnOiAnbWVudScsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdmdW5jSWQnOiBlbC5mdW5jdGlvbmNvZGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICd0YWJJZCc6IEV2ZW50QnVzLmd1aWQoKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2FwcElkJzogJycsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdhcHBFbnRyYW5jZSc6ICcnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZW50aXR5UGFyYW1zJzogb3AuZW50aXR5UGFyYW0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdxdWVyeVN0cmluZ1BhcmFtcyc6IHBhcmFtTWFwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnaXNOZXdUYWInOiB0cnVlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWJJZCA9IFJ0ZlNlcnZpY2VzLmdldEZ1bmNJZChvcGVuTWVudW9wdGlvbnMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuc2VsZi5jYWNoZS5zZXQodGFiSWQgPyB0YWJJZCA6IG9wdGlvbnMuc2VsZi5xdWVyeUlkLCBvcC5FbnRpdHlQYXJhbSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbWVudVN3aXRjaENvbnRyb2wgPSBPYmplY3QuYXNzaWduKHt9LCBvcGVuTWVudW9wdGlvbnNbJ2VudGl0eVBhcmFtcyddLCBSdGZTZXJ2aWNlcy5nZXRNZW51U3dpdGNoQ29udHJvbFBhcmFtZXRlcih0YWJJZCkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wZW5NZW51b3B0aW9uc1snZW50aXR5UGFyYW1zJ10gPSBtZW51U3dpdGNoQ29udHJvbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDljaHniYfloZ7ov5vljrtwYXJhbXNcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnc3BmcmFtZXdvcmtTZXJ2aWNlLnJ0Zi5mdW5jLm9wZW5NZW51KG9wZW5NZW51b3B0aW9ucyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGVsLnNlYXJjaHR5cGUgPT09ICdhcHAnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYXBwT3B0aW9uID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcHBUeXBlOiAnYXBwJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXBwSWQ6IGVsLmZ1bmN0aW9uY29kZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXBwRW50cmFuY2U6IGVsLmFwcEVudHJhbmNlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jSWQ6ICcnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc1JlbG9hZDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFiSWQ6IEV2ZW50QnVzLmd1aWQoKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW50aXR5UGFyYW1zOiBvcC5lbnRpdHlQYXJhbSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVlcnlTdHJpbmdQYXJhbXM6IHBhcmFtTWFwXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWJJZCA9IFJ0ZlNlcnZpY2VzLmdldEZ1bmNJZChhcHBPcHRpb24pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuc2VsZi5jYWNoZS5zZXQodGFiSWQgPyB0YWJJZCA6IG9wdGlvbnMucXVlcnlJZCwgb3AuRW50aXR5UGFyYW0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG1lbnVTd2l0Y2hDb250cm9sID0gT2JqZWN0LmFzc2lnbih7fSwgYXBwT3B0aW9uWydlbnRpdHlQYXJhbXMnXSwgUnRmU2VydmljZXMuZ2V0TWVudVN3aXRjaENvbnRyb2xQYXJhbWV0ZXIodGFiSWQpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcHBPcHRpb25bJ2VudGl0eVBhcmFtcyddID0gbWVudVN3aXRjaENvbnRyb2w7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ3NwZnJhbWV3b3JrU2VydmljZS5ydGYuZnVuYy5vcGVuTWVudShhcHBPcHRpb24pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LCBudWxsLCBmYWxzZSwgZmFsc2UsIGZhbHNlLCBmYWxzZSk7XHJcbiAgICAgICAgfSBjYXRjaCAoZSkgeyB9XHJcbiAgICB9XHJcblxyXG4gICAgaW5TdWl0ZUxpbmtGaWVsZChzcHJlYWQ6IGFueSwgc2hlZXQ6IGFueSwgZXh0T2JqOiBhbnkpIHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBjb25zdCBzZWxmID0gdGhpcztcclxuICAgICAgICAgICAgbGV0IGRhdGEgPSBudWxsO1xyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMubGNwU2VydmljZS5pblN1aXRlRHJvcERvd25JbmZvICYmIHR5cGVvZiB0aGlzLmxjcFNlcnZpY2UuaW5TdWl0ZURyb3BEb3duSW5mbyA9PSAnc3RyaW5nJykge1xyXG4gICAgICAgICAgICAgICAgICAgIGRhdGEgPSBKU09OLnBhcnNlKHRoaXMubGNwU2VydmljZS5pblN1aXRlRHJvcERvd25JbmZvKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICAgICAgdGhyb3cgZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjb25zdCByb3dDb3VudCA9IHNoZWV0LmdldFJvd0NvdW50KCk7XHJcbiAgICAgICAgICAgIGNvbnN0IGNvbENvdW50ID0gc2hlZXQuZ2V0Q29sdW1uQ291bnQoKTtcclxuICAgICAgICAgICAgbGV0IHJvd0Ryb3BEb3duID0gdHJ1ZTtcclxuICAgICAgICAgICAgY29uc3QgY2FjaGVSb3dEcm9wRG93biA9IFtdO1xyXG4gICAgICAgICAgICBjb25zdCBjYWNoZUNlbGxEcm9wRG93biA9IHt9O1xyXG4gICAgICAgICAgICAvLyDop6PmnpDnm7jlhbPmlbDmja5cclxuICAgICAgICAgICAgY29uc3Qge1xyXG4gICAgICAgICAgICAgICAgY2xpY2tfZXZlbnRzOiBjbGlja0V2ZW50cyxcclxuICAgICAgICAgICAgICAgIGV2ZW50X2RhdGE6IGV2ZW50RGF0YSxcclxuICAgICAgICAgICAgICAgIGRvdWJsZV9jbGlja19ldmVudDogZGNFdmVudCxcclxuICAgICAgICAgICAgICAgIGRvdWJsZV9jbGlja19ldmVudF9wYXJhbXM6IGRjRXZlbnRQYXJhbXMsXHJcbiAgICAgICAgICAgICAgICByY19ldmVudF9pZHM6IHJjRXZlbnRJZHNcclxuICAgICAgICAgICAgfSA9IGRhdGFcclxuICAgICAgICAgICAgaWYgKGRjRXZlbnQgJiYgIShcInt9XCIgPT0gSlNPTi5zdHJpbmdpZnkoZGNFdmVudCkpICYmIGRjRXZlbnRQYXJhbXMgJiYgIShcInt9XCIgPT0gSlNPTi5zdHJpbmdpZnkoZGNFdmVudFBhcmFtcykpKSB7XHJcbiAgICAgICAgICAgICAgICByb3dEcm9wRG93biA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBrZXkgaW4gZGNFdmVudFBhcmFtcykge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhY2hlUm93RHJvcERvd24ucHVzaChrZXkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGV2ZW50RGF0YSAmJiAhKFwie31cIiA9PSBKU09OLnN0cmluZ2lmeShldmVudERhdGEpKSkge1xyXG4gICAgICAgICAgICAgICAgcm93RHJvcERvd24gPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIGZvciAobGV0IGtleSBpbiBldmVudERhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZXZlbnREYXRhW2tleV0pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY2VsbEluZGV4ID0gW107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhY2hlQ2VsbERyb3BEb3duW2tleV0gPSBjZWxsSW5kZXg7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGtleTEgaW4gZXZlbnREYXRhW2tleV0pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhY2hlQ2VsbERyb3BEb3duW2tleV0ucHVzaChrZXkxKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBmb3IgKGxldCByID0gMTsgciA8IChyb3dDb3VudCk7IHIrKykge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZGF0YUl0ZW0gPSBzaGVldC5nZXREYXRhSXRlbShyKTtcclxuICAgICAgICAgICAgICAgIGlmIChkYXRhSXRlbS5oYXNPd25Qcm9wZXJ0eSgnZHluYW1pY1Byb3BTZXQnKSAmJiBkYXRhSXRlbS5keW5hbWljUHJvcFNldC5oYXNPd25Qcm9wZXJ0eSgncWRwX2RhdGFfZmxhZycpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBjID0gMDsgYyA8IGNvbENvdW50OyBjKyspIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAocm93RHJvcERvd24pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjYWNoZVJvd0Ryb3BEb3duLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAociA9PSAoY2FjaGVSb3dEcm9wRG93bltpXSAtIDApKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaDEgPSBuZXcgR0MuU3ByZWFkLlNoZWV0cy5DZWxsVHlwZXMuSHlwZXJMaW5rKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZm9ybWF0dGVyID0gc2hlZXQuZ2V0Rm9ybWF0dGVyKHIsIGMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGgxLnRleHQoaDEuZm9ybWF0KHNoZWV0LmdldENlbGwociwgYykudmFsdWUoKSwgZm9ybWF0dGVyKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaDEuYWN0aXZlT25DbGljayh0cnVlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoMS5vbkNsaWNrQWN0aW9uKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3ByZWFkLmNvbW1hbmRNYW5hZ2VyKCkuZXhlY3V0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbWQ6ICdkcm9wZG93bnF1ZXJ5JyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGY6IHNlbGZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hlZXQuc2V0Q2VsbFR5cGUociwgYywgaDEsIEdDLlNwcmVhZC5TaGVldHMuU2hlZXRBcmVhLnZpZXdwb3J0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGtleSBpbiBjYWNoZUNlbGxEcm9wRG93bikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKChyICsgJycpID09PSBrZXkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNhY2hlQ2VsbERyb3BEb3duW2tleV0ubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaDEgPSBuZXcgR0MuU3ByZWFkLlNoZWV0cy5DZWxsVHlwZXMuSHlwZXJMaW5rKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGZvcm1hdHRlciA9IHNoZWV0LmdldEZvcm1hdHRlcihyLCBjYWNoZUNlbGxEcm9wRG93bltrZXldW2ldKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaDEudGV4dChoMS5mb3JtYXQoc2hlZXQuZ2V0Q2VsbChyLCBjYWNoZUNlbGxEcm9wRG93bltrZXldW2ldKS52YWx1ZSgpLCBmb3JtYXR0ZXIpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaDEuYWN0aXZlT25DbGljayh0cnVlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaDEub25DbGlja0FjdGlvbihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcHJlYWQuY29tbWFuZE1hbmFnZXIoKS5leGVjdXRlKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbWQ6ICdkcm9wZG93bnF1ZXJ5JyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmOiBzZWxmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNoZWV0LnNldENlbGxUeXBlKHIsIGNhY2hlQ2VsbERyb3BEb3duW2tleV1baV0sIGgxLCBHQy5TcHJlYWQuU2hlZXRzLlNoZWV0QXJlYS52aWV3cG9ydCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHNwcmVhZC5jb21tYW5kTWFuYWdlcigpLnJlZ2lzdGVyKCdkcm9wZG93bnF1ZXJ5Jywge1xyXG4gICAgICAgICAgICAgICAgY2FuVW5kbzogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIGV4ZWN1dGU6IGZ1bmN0aW9uIChjb250ZXh0LCBvcHRpb25zLCBpc1VuZG8pIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCByb3cgPSBjb250ZXh0LmdldEFjdGl2ZVNoZWV0KCkuZ2V0QWN0aXZlUm93SW5kZXgoKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBjb2wgPSBjb250ZXh0LmdldEFjdGl2ZVNoZWV0KCkuZ2V0QWN0aXZlQ29sdW1uSW5kZXgoKTtcclxuICAgICAgICAgICAgICAgICAgICAvLyDlj4zlh7vkuovku7bnmoTpgLvovpFcclxuICAgICAgICAgICAgICAgICAgICBsZXQgZXZlbnQsIHBhcmFtcztcclxuICAgICAgICAgICAgICAgICAgICAvLyDooYzngrnlh7vmlbDmja5cclxuICAgICAgICAgICAgICAgICAgICBpZiAoZGNFdmVudCAmJiAhKFwie31cIiA9PSBKU09OLnN0cmluZ2lmeShkY0V2ZW50KSkgJiYgZGNFdmVudFBhcmFtcyAmJiAhKFwie31cIiA9PSBKU09OLnN0cmluZ2lmeShkY0V2ZW50UGFyYW1zKSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQgPSBkY0V2ZW50O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBhcmdzLnJvd+S4uuihjOW6j+WPt++8jOS4i+WQjFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwYXJhbXMgPSBkY0V2ZW50UGFyYW1zW3Jvd107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOWmguaenGV2ZW50RGF0YeaVsOaNruS4jeS4uuepuu+8jOW5tuS4lOWvueW6lOihjOeahOaVsOaNruS5n+S4jeS4uuepulxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDljZXlhYPmoLzmlbDmja5cclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGV2ZW50RGF0YSAmJiAhKFwie31cIiA9PSBKU09OLnN0cmluZ2lmeShldmVudERhdGEpKSAmJiBldmVudERhdGFbcm93XSAmJiAhKFwie31cIiA9PSBKU09OLnN0cmluZ2lmeShldmVudERhdGFbcm93XSkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCB0aGlzRXZlbnRJZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8g5aaC5p6c5a+55bqU6KGM5YyF5ZCrLTHvvIzliJnlj5YtMeS4reeahOaVsOaNriwg5ZCm5YiZ5Y+W5a+55bqU5YiX5Y+355qE5pWw5o2uXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFyZ3MuY29s5Li65YiX5bqP5Y+3XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCB0aGlzRXZlbnREYXRhID0gZXZlbnREYXRhW3Jvd11bLTFdIHx8IGV2ZW50RGF0YVtyb3ddW2NvbF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzRXZlbnREYXRhICYmICEoXCJ7fVwiID09IEpTT04uc3RyaW5naWZ5KHRoaXNFdmVudERhdGEpKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFyY0V2ZW50SWRzICYmIHJjRXZlbnRJZHMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgb2JqID0ge307XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQga2V5IGluIHRoaXNFdmVudERhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJjRXZlbnRJZHMuZmluZEluZGV4KChlbDogYW55KSA9PiBlbCA9PSBrZXkpIDwgMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqW2tleV0gPSB0aGlzRXZlbnREYXRhW2tleV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0V2ZW50RGF0YSA9IG9iajtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBpbmRleCA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBrZXkgaW4gdGhpc0V2ZW50RGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbmRleCA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNFdmVudElkID0ga2V5O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmRleCsrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1zID0gdGhpc0V2ZW50RGF0YVt0aGlzRXZlbnRJZF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOagueaNrmV2ZW50IGlk6I635Y+WZXZlbnRcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXNFdmVudElkICE9IG51bGwgJiYgdGhpc0V2ZW50SWQgIT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmVudCA9IGNsaWNrRXZlbnRzW3RoaXNFdmVudElkXSAmJiAhKFwie31cIiA9PSBKU09OLnN0cmluZ2lmeShjbGlja0V2ZW50c1t0aGlzRXZlbnRJZF0pKSA/IGNsaWNrRXZlbnRzW3RoaXNFdmVudElkXS5ldmVudCA6IHt9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGxldCBtZXNzYWdlO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghKFwie31cIiA9PSBKU09OLnN0cmluZ2lmeShldmVudCkpICYmICEoXCJ7fVwiID09IEpTT04uc3RyaW5naWZ5KHBhcmFtcykpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOi/lOWbnuaVsOaNrlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlID0geyB0eXBlOiAnY2VsbEFjdGlvbicsIGV2ZW50LCBwYXJhbXMsIGRlZmF1bHRzOiBkYXRhLmRlZmF1bHRzIH07XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChtZXNzYWdlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHRPYmouaW5TdWl0ZVdpbmRvdygpLnBvc3RNZXNzYWdlKG1lc3NhZ2UsIGxvY2F0aW9uLm9yaWdpbilcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sIG51bGwsIGZhbHNlLCBmYWxzZSwgZmFsc2UsIGZhbHNlKTtcclxuICAgICAgICB9IGNhdGNoIChlKSB7IH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGdldFF1ZXJ5UGFyYW1ldGVycyhlbnRpdHlQYXJhbTogYW55LCBwYXJhbU1hcDogYW55LCBwYXJhbWV0ZXJLZXk6IGFueSwga2V5OiBhbnkpIHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBjb25zdCB0YWIgPSBnc3BmcmFtZXdvcmtTZXJ2aWNlLnJ0Zi5zZXNzaW9uLmdldENvbW1vblZhcmlhYmxlKCk7XHJcbiAgICAgICAgICAgIGlmICh0YWIgJiYgdGFiLnRhYklkKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0aWQgPSB0YWIudGFiSWQgKyBSdGZTZXJ2aWNlcy5nZXRJblN1aXRlRnJtVVVJRCgpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuY2FjaGUuZ2V0KHRpZCkgJiYgdGhpcy5jYWNoZS5nZXQodGlkKVtwYXJhbWV0ZXJLZXldKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZW50aXR5UGFyYW1ba2V5XSA9IHRoaXMuY2FjaGUuZ2V0KHRpZClbcGFyYW1ldGVyS2V5XTtcclxuICAgICAgICAgICAgICAgICAgICBwYXJhbU1hcC5zZXQoa2V5LCB0aGlzLmNhY2hlLmdldCh0aWQpW3BhcmFtZXRlcktleV0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBiaW5kU2VsZWN0Q2hhbmdlZChzcHJlYWQ6IGFueSwgcXVlcnlJZDogYW55KSB7XHJcbiAgICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgc3ByZWFkLmJpbmQoR0MuU3ByZWFkLlNoZWV0cy5FdmVudHMuU2VsZWN0aW9uQ2hhbmdpbmcsIGZ1bmN0aW9uIChlOiBhbnksIGFyZ3M6IGFueSkge1xyXG4gICAgICAgICAgICBjb25zdCB0ZW1wRGF0YSA9IHt9O1xyXG4gICAgICAgICAgICBjb25zdCBzZWxlY3Rpb24gPSBhcmdzLm5ld1NlbGVjdGlvbnMucG9wKCk7XHJcbiAgICAgICAgICAgIGNvbnN0IHNoZWV0QXJlYSA9IGFyZ3Muc2hlZXRBcmVhID09PSAwID8gJ3NoZWV0Q29ybmVyJyA6IGFyZ3Muc2hlZXRBcmVhID09PSAxID8gJ2NvbHVtbkhlYWRlcicgOiBhcmdzLnNoZWV0QXJlYSA9PT0gMiA/ICdyb3dIZWFkZXInIDogJ3ZpZXdQb3J0JztcclxuICAgICAgICAgICAgaWYgKHNlbGVjdGlvbikge1xyXG4gICAgICAgICAgICAgICAgdGVtcERhdGFbJ1NwcmVhZEV2ZW50J10gPSBHQy5TcHJlYWQuU2hlZXRzLkV2ZW50cy5TZWxlY3Rpb25DaGFuZ2luZztcclxuICAgICAgICAgICAgICAgIHRlbXBEYXRhWydzaGVldEFyZWEnXSA9IHNoZWV0QXJlYTtcclxuICAgICAgICAgICAgICAgIHRlbXBEYXRhWydyb3cnXSA9IHNlbGVjdGlvbi5yb3c7XHJcbiAgICAgICAgICAgICAgICB0ZW1wRGF0YVsnY29sdW1uJ10gPSBzZWxlY3Rpb24uY29sO1xyXG4gICAgICAgICAgICAgICAgdGVtcERhdGFbJ3Jvd0NvdW50J10gPSBzZWxlY3Rpb24ucm93Q291bnQ7XHJcbiAgICAgICAgICAgICAgICB0ZW1wRGF0YVsnY29sQ291bnQnXSA9IHNlbGVjdGlvbi5jb2xDb3VudDtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0Q2hhbmdpbmcgPSB0ZW1wRGF0YTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHNwcmVhZC5iaW5kKEdDLlNwcmVhZC5TaGVldHMuRXZlbnRzLkNlbGxDbGljaywgZnVuY3Rpb24gKGU6IGFueSwgYXJnczogYW55KSB7XHJcbiAgICAgICAgICAgIC8vIOino+aekOW9k+WJjemAieS4reeahOaVsOaNrlxyXG4gICAgICAgICAgICBjb25zdCBkYXRhSXRlbXMgPSBbXTtcclxuICAgICAgICAgICAgLy8g6IGU5Yqo5Y+C5pWwXHJcbiAgICAgICAgICAgIGxldCBsaW5rYWdlUGFyYW1zID0ge307XHJcbiAgICAgICAgICAgIGZvciAobGV0IHJvd0luZGV4ID0gMDsgcm93SW5kZXggPCB0aGlzLnNlbGVjdENoYW5naW5nLnJvd0NvdW50OyByb3dJbmRleCsrKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoc2VsZi5qb2luUGFyYW0uY29udHJvbFR5cGUgIT09ICdjcm9zc3RhYicpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBkYXRhSXRlbSA9IGFyZ3Muc2hlZXQuZ2V0RGF0YUl0ZW0ocm93SW5kZXggKyB0aGlzLnNlbGVjdENoYW5naW5nLnJvdyk7XHJcbiAgICAgICAgICAgICAgICAgICAgbGlua2FnZVBhcmFtcyA9IGRhdGFJdGVtO1xyXG4gICAgICAgICAgICAgICAgICAgIGRhdGFJdGVtcy5wdXNoKGRhdGFJdGVtKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuc2VsZWN0Q2hhbmdpbmcuY29sdW1uID09PSAtMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdENoYW5naW5nLmNvbENvdW50ID0gdGhpcy5zZWxlY3RDaGFuZ2luZy5jb2xDb3VudCArIDE7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGNvbEluZGV4ID0gMDsgY29sSW5kZXggPCB0aGlzLnNlbGVjdENoYW5naW5nLmNvbENvdW50OyBjb2xJbmRleCsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGRhdGFJdGVtID0ge307XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzZWxmLmpvaW5QYXJhbS5jb250cm9sVHlwZSA9PT0gJ2Nyb3NzdGFiJykgeyAvLyDkuqTlj4nooahcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhcmdzLnNoZWV0QXJlYSA9PT0gMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0Q2hhbmdpbmcucm93ID0gMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb2xJbmRleCArIHRoaXMuc2VsZWN0Q2hhbmdpbmcuY29sdW1uIDwgc2VsZi5qb2luUGFyYW0ucm93SGVhZGVyQ29sSW5mby5lbmQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOiOt+WPluihjOagh+mimOeahOaVsOaNrlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IHNlbGYuam9pblBhcmFtLnJvd0hlYWRlckNvbEluZm8uc3RhcnQ7IGkgPCBzZWxmLmpvaW5QYXJhbS5yb3dIZWFkZXJDb2xJbmZvLmVuZDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdmFsdWUgPSBhcmdzLnNoZWV0LmdldFZhbHVlKHJvd0luZGV4ICsgdGhpcy5zZWxlY3RDaGFuZ2luZy5yb3csIGksIEdDLlNwcmVhZC5TaGVldHMuU2hlZXRBcmVhLnZpZXdwb3J0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBuYW1lID0gYXJncy5zaGVldC5nZXRWYWx1ZShzZWxmLmpvaW5QYXJhbS5jb2xIZWFkZXJSb3dJbmZvLnN0YXJ0LCBpLCBHQy5TcHJlYWQuU2hlZXRzLlNoZWV0QXJlYS5jb2xIZWFkZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvbEluZm8gPSBzZWxmLmpvaW5QYXJhbS5jb2xJbmZvcy5maW5kKCh4OiBhbnkpID0+IHguZGltZW5zaW9uID09PSAxICYmIHgubmFtZSA9PT0gbmFtZSkuYmluZEZpZWxkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFJdGVtW2NvbEluZm9dID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDojrflj5bliJfmoIfpopjnmoTmlbDmja5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSBzZWxmLmpvaW5QYXJhbS5jb2xIZWFkZXJSb3dJbmZvLnN0YXJ0OyBpIDwgc2VsZi5qb2luUGFyYW0uY29sSGVhZGVyUm93SW5mby5lbmQ7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gYXJncy5zaGVldC5nZXRWYWx1ZShpLCBjb2xJbmRleCArIHRoaXMuc2VsZWN0Q2hhbmdpbmcuY29sdW1uLCBHQy5TcHJlYWQuU2hlZXRzLlNoZWV0QXJlYS5jb2xIZWFkZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvbEluZm8gPSBzZWxmLmpvaW5QYXJhbS5jb2xJbmZvcy5maWx0ZXIoKHg6IGFueSkgPT4geC5kaW1lbnNpb24gPT09IDIpW2kgLSBzZWxmLmpvaW5QYXJhbS5jb2xIZWFkZXJSb3dJbmZvLnN0YXJ0XS5iaW5kRmllbGQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YUl0ZW1bY29sSW5mb10gPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOiOt+WPluWAvOagh+mimOeahOaVsOaNrlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdmFsdWUgPSBhcmdzLnNoZWV0LmdldFZhbHVlKHJvd0luZGV4ICsgdGhpcy5zZWxlY3RDaGFuZ2luZy5yb3csIGNvbEluZGV4ICsgdGhpcy5zZWxlY3RDaGFuZ2luZy5jb2x1bW4sIEdDLlNwcmVhZC5TaGVldHMuU2hlZXRBcmVhLnZpZXdwb3J0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5hbWUgPSBhcmdzLnNoZWV0LmdldFZhbHVlKHNlbGYuam9pblBhcmFtLmNvbEhlYWRlclJvd0luZm8uZW5kLCBjb2xJbmRleCArIHRoaXMuc2VsZWN0Q2hhbmdpbmcuY29sdW1uLCBHQy5TcHJlYWQuU2hlZXRzLlNoZWV0QXJlYS5jb2xIZWFkZXIpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvbEluZm8gPSBzZWxmLmpvaW5QYXJhbS5jb2xJbmZvcy5maW5kKCh4OiBhbnkpID0+IHguZGltZW5zaW9uID09PSAzICYmIHgubmFtZSA9PT0gbmFtZSkuYmluZEZpZWxkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YUl0ZW1bY29sSW5mb10gPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsaW5rYWdlUGFyYW1zID0gZGF0YUl0ZW07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFJdGVtcy5wdXNoKGRhdGFJdGVtKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gc3ByZWFkIOiBlOWKqOS6i+S7tlxyXG4gICAgICAgICAgICBFdmVudEJ1cy5kaXNwYXRjaChxdWVyeUlkICsgJ19zcHJlYWRfY2hhbmdlJywgbGlua2FnZVBhcmFtcyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0U29ydENlbGxUeXBlKHNoZWV0OiBhbnksIHNjaGVtYTogYW55LCBxZHBWaWV3OiBhbnkpIHtcclxuICAgICAgICBjb25zdCBzZWxmID0gdGhpcztcclxuICAgICAgICBjb25zdCBoZWFkZXIgPSBzaGVldC5nZXRSb3dDb3VudChHQy5TcHJlYWQuU2hlZXRzLlNoZWV0QXJlYS5jb2xIZWFkZXIpO1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2hlZXQuZ2V0Q29sdW1uQ291bnQoKTsgaSsrKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHNwYW4gPSBzaGVldC5nZXRTcGFuKGhlYWRlciAtIDEsIGksIEdDLlNwcmVhZC5TaGVldHMuU2hlZXRBcmVhLmNvbEhlYWRlcik7XHJcbiAgICAgICAgICAgIGlmIChzcGFuICYmIHNwYW4ucm93Q291bnQgPiAxKSB7XHJcbiAgICAgICAgICAgICAgICBzaGVldC5zZXRDZWxsVHlwZShoZWFkZXIgLSBzcGFuLnJvd0NvdW50LCBpLCBuZXcgU29ydENlbGxUeXBlKHNlbGYuY29sdW1uU29ydC5iaW5kKHNlbGYpLCBzY2hlbWEsIHFkcFZpZXcpLCBHQy5TcHJlYWQuU2hlZXRzLlNoZWV0QXJlYS5jb2xIZWFkZXIpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgc2hlZXQuc2V0Q2VsbFR5cGUoaGVhZGVyIC0gMSwgaSwgbmV3IFNvcnRDZWxsVHlwZShzZWxmLmNvbHVtblNvcnQuYmluZChzZWxmKSwgc2NoZW1hLCBxZHBWaWV3KSwgR0MuU3ByZWFkLlNoZWV0cy5TaGVldEFyZWEuY29sSGVhZGVyKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBtZXJnZUNlbGwoc2hlZXQ6IGFueSwgc2NoZW1hOiBhbnkpIHtcclxuICAgICAgICBpZiAoIXRoaXMuZ2V0TWVyZ2VDZWxsKHNjaGVtYSkpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBncm91cEZpZWxkQ2FjaGUxID0gW107XHJcbiAgICAgICAgdGhpcy5nZXRHcm91cEZpZWxkKGdyb3VwRmllbGRDYWNoZTEsIHNjaGVtYSk7XHJcbiAgICAgICAgaWYgKGdyb3VwRmllbGRDYWNoZTEubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgY29sdW1uQ291bnQgPSBzaGVldC5nZXRDb2x1bW5Db3VudCgpO1xyXG4gICAgICAgIGNvbnN0IHJvd0NvdW50ID0gc2hlZXQuZ2V0Um93Q291bnQoKTtcclxuICAgICAgICBsZXQgYmVnaW5Sb3dJbmRleCA9IDA7XHJcbiAgICAgICAgaWYgKHRoaXMuZ2V0U2hvd0ZpbHRlclJvdyhzY2hlbWEpKSB7XHJcbiAgICAgICAgICAgIGJlZ2luUm93SW5kZXggPSAxO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyDmo4Dmn6Xlj4LmlbBcclxuICAgICAgICBpZiAoY29sdW1uQ291bnQgPCAxIHx8IChyb3dDb3VudCAtIGJlZ2luUm93SW5kZXgpIDwgMSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IHJvd1NwYW5zID0ge307XHJcbiAgICAgICAgbGV0IGN1ckNlbGxWYWx1ZXMgPSAnJztcclxuICAgICAgICBsZXQgY3VycmVudE5hbWUgPSAnJztcclxuICAgICAgICBsZXQga2V5ID0gJyc7XHJcbiAgICAgICAgZm9yIChsZXQgcm93ID0gYmVnaW5Sb3dJbmRleDsgcm93IDwgcm93Q291bnQ7IHJvdysrKSB7XHJcbiAgICAgICAgICAgIGlmIChzaGVldC5nZXREYXRhSXRlbShyb3cpLmhhc093blByb3BlcnR5KFwicWRwX2RhdGFfZmxhZ1wiKSAmJlxyXG4gICAgICAgICAgICAgICAgKFxyXG4gICAgICAgICAgICAgICAgICAgIChzaGVldC5nZXREYXRhSXRlbShyb3cpW1wicWRwX2RhdGFfZmxhZ1wiXSArICcnKSA9PT0gKDQgKyAnJylcclxuICAgICAgICAgICAgICAgICAgICB8fCAoc2hlZXQuZ2V0RGF0YUl0ZW0ocm93KVtcInFkcF9kYXRhX2ZsYWdcIl0gKyAnJykgPT09ICgzICsgJycpXHJcbiAgICAgICAgICAgICAgICAgICAgfHwgKHNoZWV0LmdldERhdGFJdGVtKHJvdylbXCJxZHBfZGF0YV9mbGFnXCJdICsgJycpID09PSAoMiArICcnKVxyXG4gICAgICAgICAgICAgICAgICAgIHx8IChzaGVldC5nZXREYXRhSXRlbShyb3cpW1wicWRwX2RhdGFfZmxhZ1wiXSArICcnKSA9PT0gKDEgKyAnJylcclxuICAgICAgICAgICAgICAgICkpIHtcclxuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGZvciAobGV0IGNvbCA9IDA7IGNvbCA8IGNvbHVtbkNvdW50OyBjb2wrKykge1xyXG4gICAgICAgICAgICAgICAgY3VycmVudE5hbWUgPSBzaGVldC5nZXRDZWxsKHJvdywgY29sKS52YWx1ZSgpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGNvbCA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAga2V5ID0gY3VycmVudE5hbWU7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJvd1NwYW5zLmhhc093blByb3BlcnR5KGtleSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcm93U3BhbnNba2V5XS5yb3dDb3VudCA9IHJvdyAtIHJvd1NwYW5zW2tleV0ucm93ICsgMTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByb3dTcGFuc1trZXldID0geyAncm93Jzogcm93LCAncm93Q291bnQnOiAxLCAnY29sJzogY29sLCAnY29sQ291bnQnOiAxIH07XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjdXJDZWxsVmFsdWVzID0gJyc7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPD0gY29sOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY3VyQ2VsbFZhbHVlcyArPSBzaGVldC5nZXRDZWxsKHJvdywgaSkudmFsdWUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY3VyQ2VsbFZhbHVlcyArPSBcIl8mX1wiO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAocm93U3BhbnMuaGFzT3duUHJvcGVydHkoY3VyQ2VsbFZhbHVlcykpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcm93U3BhbnNbY3VyQ2VsbFZhbHVlc10ucm93Q291bnQgPSByb3cgLSByb3dTcGFuc1tjdXJDZWxsVmFsdWVzXS5yb3cgKyAxO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJvd1NwYW5zW2N1ckNlbGxWYWx1ZXNdID0geyAncm93Jzogcm93LCAncm93Q291bnQnOiAxLCAnY29sJzogY29sLCAnY29sQ291bnQnOiAxIH07XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmb3IgKGxldCBrIGluIHJvd1NwYW5zKSB7XHJcbiAgICAgICAgICAgIGlmICgocm93U3BhbnNba10ucm93Q291bnQgPT0gMSAmJiByb3dTcGFuc1trXS5jb2xDb3VudCA9PSAxKSA9PSBmYWxzZSkge1xyXG4gICAgICAgICAgICAgICAgc2hlZXQuYWRkU3Bhbihyb3dTcGFuc1trXS5yb3csIHJvd1NwYW5zW2tdLmNvbCwgcm93U3BhbnNba10ucm93Q291bnQsIHJvd1NwYW5zW2tdLmNvbENvdW50KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGNvbHVtblNvcnQoaW5kZXg6IGFueSwgc2hlZXQ6IGFueSwgc2NoZW1hOiBhbnksIHFkcFZpZXc6IGFueSkge1xyXG4gICAgICAgIGNvbnN0IGxvYWRpbmcgPSB0aGlzLmxvYWRTZXJ2aWNlLnNob3coeyBjb250YWluZXI6ICdib2R5JyB9KTtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBjb25zdCBoZWFkZXIgPSBzaGVldC5nZXRSb3dDb3VudChHQy5TcHJlYWQuU2hlZXRzLlNoZWV0QXJlYS5jb2xIZWFkZXIpO1xyXG4gICAgICAgICAgICBpZiAoc2NoZW1hICYmIHNjaGVtYS5zY2hlbWFWYWx1ZSAmJiBzY2hlbWEuc2NoZW1hVmFsdWUuY29sdW1uT3B0aW9uICYmIHNjaGVtYS5zY2hlbWFWYWx1ZS5jb2x1bW5PcHRpb24uY29sTGlzdCAmJiBzY2hlbWEuc2NoZW1hVmFsdWUuY29sdW1uT3B0aW9uLmNvbExpc3QubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgY2VsbCA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBzcGFuID0gc2hlZXQuZ2V0U3BhbihoZWFkZXIgLSAxLCBpbmRleCwgR0MuU3ByZWFkLlNoZWV0cy5TaGVldEFyZWEuY29sSGVhZGVyKTtcclxuICAgICAgICAgICAgICAgIGlmIChzcGFuICYmIHNwYW4ucm93Q291bnQgPiAxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2VsbCA9IHNoZWV0LmdldENlbGwoaGVhZGVyIC0gc3Bhbi5yb3dDb3VudCwgaW5kZXgsIEdDLlNwcmVhZC5TaGVldHMuU2hlZXRBcmVhLmNvbEhlYWRlcik7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGNlbGwgPSBzaGVldC5nZXRDZWxsKGhlYWRlciAtIDEsIGluZGV4LCBHQy5TcHJlYWQuU2hlZXRzLlNoZWV0QXJlYS5jb2xIZWFkZXIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHNjaGVtYSAmJiBzY2hlbWEuaXNQcmVmYWIgPT09IDEpIHtcclxuICAgICAgICAgICAgICAgICAgICBsb2FkaW5nLmNsb3NlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgY2VsbC50YWcoMCk7XHJcbiAgICAgICAgICAgICAgICAgICAgc2hlZXQuaW52YWxpZGF0ZUxheW91dCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHNoZWV0LnJlcGFpbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm1zZ1NlcnZpY2UuaW5mbyh0aGlzLmxvY2FsaXplU2VydmljZS5nZXRWYWx1ZSgnc3ByZWFkLm1lc3NhZ2UudmFsaWRhdGUuc29ydCcpKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoc2NoZW1hLmlzUHJvdGVjdGVkID09PSAxIHx8IHNjaGVtYS5pc1Byb3RlY3RlZCA9PT0gJzEnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbG9hZGluZy5jbG9zZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNlbGwudGFnKDApO1xyXG4gICAgICAgICAgICAgICAgICAgIHNoZWV0LmludmFsaWRhdGVMYXlvdXQoKTtcclxuICAgICAgICAgICAgICAgICAgICBzaGVldC5yZXBhaW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5tc2dTZXJ2aWNlLmluZm8odGhpcy5sb2NhbGl6ZVNlcnZpY2UuZ2V0VmFsdWUoJ2lkZUNtcC5zY2hlbWFNYW5hZ2VyLm1lc3NhZ2UudmFsaWRhdGUuaXNQcm90ZWN0ZWQnKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgY29sTGlzdCA9IHNjaGVtYS5zY2hlbWFWYWx1ZS5jb2x1bW5PcHRpb24uY29sTGlzdDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHBhcmFtcyA9IHtcclxuICAgICAgICAgICAgICAgICAgICBpbmRleDogaW5kZXgsXHJcbiAgICAgICAgICAgICAgICAgICAgY2VsbDogY2VsbCxcclxuICAgICAgICAgICAgICAgICAgICBjb2xJbmRleDogMCxcclxuICAgICAgICAgICAgICAgICAgICBzb3J0SW5mbzogeyBzb3J0SW5kZXg6IDAsIGJpbmRGaWVsZDogJycgfSxcclxuICAgICAgICAgICAgICAgICAgICBpc1RleHQ6IFtdXHJcbiAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpwcmVmZXItZm9yLW9mXHJcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvbExpc3QubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlY3Vyc2l2ZUNvbHVtblNvcnRJbmRleChjb2xMaXN0W2ldLCBudWxsLCBwYXJhbXMpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOnByZWZlci1mb3Itb2ZcclxuICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY29sTGlzdC5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVjdXJzaXZlQ29sdW1uU29ydChjb2xMaXN0W2ldLCBudWxsLCBwYXJhbXMpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHBhcmFtcy5pc1RleHQubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbG9hZGluZy5jbG9zZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNlbGwudGFnKDApO1xyXG4gICAgICAgICAgICAgICAgICAgIHNoZWV0LmludmFsaWRhdGVMYXlvdXQoKTtcclxuICAgICAgICAgICAgICAgICAgICBzaGVldC5yZXBhaW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5tc2dTZXJ2aWNlLndhcm5pbmcocGFyYW1zLmlzVGV4dFswXSArICcgJyArIHRoaXMubG9jYWxpemVTZXJ2aWNlLmdldFZhbHVlKCdpZGVDbXAuc2NoZW1hTWFuYWdlci5tZXNzYWdlLnZhbGlkYXRlLnRleHRDb2x1bW5Tb3J0JykpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IG5ld1NjaGVtYSA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoc2NoZW1hKSk7XHJcbiAgICAgICAgICAgICAgICBuZXdTY2hlbWEuc2NoZW1hVmFsdWUuY29sdW1uT3B0aW9uLmNvbExpc3QgPSBjb2xMaXN0O1xyXG4gICAgICAgICAgICAgICAgbmV3U2NoZW1hLnNjaGVtYVZhbHVlID0gSlNPTi5zdHJpbmdpZnkobmV3U2NoZW1hLnNjaGVtYVZhbHVlKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2NoZW1hTWFuYWdlci5zYXZlU2NoZW1hKHsgc2NoZW1hOiBKU09OLnN0cmluZ2lmeShuZXdTY2hlbWEpLCBncm91cFR5cGU6IHFkcFZpZXcuZ3JvdXBUeXBlIH0sICcnKS5zdWJzY3JpYmUoZGF0YSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgbG9hZGluZy5jbG9zZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHFkcFZpZXcuaW5pdFNwcmVhZChxZHBWaWV3LnF1ZXJ5SWQsIG5ld1NjaGVtYS5pZCwgcWRwVmlldy5jb250cm9sVHlwZSwgcWRwVmlldy5xb01hbmFnZXJDb2RlLCBxZHBWaWV3LnBhZ2VJbmRleCwgcWRwVmlldy5xdWVyeVJlbGF0aXZlVXJsLCBxZHBWaWV3LmNvbmRpdGlvbkV4cHJlc3Npb24sIHFkcFZpZXcuZ3JvdXBUeXBlLCBxZHBWaWV3LnZvSWQsIHRydWUpO1xyXG4gICAgICAgICAgICAgICAgfSwgKGVycm9yOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBsb2FkaW5nLmNsb3NlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5mb3JtRXJyb3JTZXJ2aWNlLmV4Y2VwdGlvbihlcnJvci5NZXNzYWdlLCBlcnJvcik7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGxvYWRpbmcuY2xvc2UoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMubXNnU2VydmljZS5pbmZvKHRoaXMubG9jYWxpemVTZXJ2aWNlLmdldFZhbHVlKCdzcHJlYWQubWVzc2FnZS52YWxpZGF0ZS5zb3J0JykpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICBsb2FkaW5nLmNsb3NlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgcmVjdXJzaXZlQ29sdW1uU29ydEluZGV4KGNvbCwgY29sTGlzdCwgcGFyYW1zKSB7XHJcbiAgICAgICAgaWYgKGNvbExpc3QgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICBpZiAoY29sLmNoaWxkTGlzdCAmJiBjb2wuY2hpbGRMaXN0Lmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5yZWN1cnNpdmVDb2x1bW5Tb3J0SW5kZXgobnVsbCwgY29sLmNoaWxkTGlzdCwgcGFyYW1zKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGlmIChjb2wuc29ydCAhPT0gMCAmJiBjb2xbJ3NvcnRJbmRleCddICE9IG51bGwgJiYgY29sWydzb3J0SW5kZXgnXSAhPT0gdW5kZWZpbmVkICYmIGNvbC5zb3J0SW5kZXggPiBwYXJhbXMuc29ydEluZm8uc29ydEluZGV4KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcGFyYW1zLnNvcnRJbmZvLnNvcnRJbmRleCA9IGNvbFsnc29ydEluZGV4J107XHJcbiAgICAgICAgICAgICAgICAgICAgcGFyYW1zLnNvcnRJbmZvLmJpbmRGaWVsZCA9IGNvbC5iaW5kRmllbGQ7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6cHJlZmVyLWZvci1vZlxyXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvbExpc3QubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGlmIChjb2xMaXN0W2ldLmNoaWxkTGlzdCAmJiBjb2xMaXN0W2ldLmNoaWxkTGlzdC5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlY3Vyc2l2ZUNvbHVtblNvcnRJbmRleChudWxsLCBjb2xMaXN0W2ldLmNoaWxkTGlzdCwgcGFyYW1zKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbExpc3RbaV0uc29ydCAhPT0gMCAmJiBjb2xMaXN0W2ldWydzb3J0SW5kZXgnXSAhPSBudWxsICYmIGNvbExpc3RbaV1bJ3NvcnRJbmRleCddICE9PSB1bmRlZmluZWQgJiYgY29sTGlzdFtpXS5zb3J0SW5kZXggPiBwYXJhbXMuc29ydEluZm8uc29ydEluZGV4KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtcy5zb3J0SW5mby5zb3J0SW5kZXggPSBjb2xMaXN0W2ldWydzb3J0SW5kZXgnXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1zLnNvcnRJbmZvLmJpbmRGaWVsZCA9IGNvbExpc3RbaV0uYmluZEZpZWxkO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHJlY3Vyc2l2ZUNvbHVtblNvcnQoY29sLCBjb2xMaXN0LCBwYXJhbXMpIHtcclxuICAgICAgICBpZiAoY29sTGlzdCA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIGlmIChjb2wuY2hpbGRMaXN0ICYmIGNvbC5jaGlsZExpc3QubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJlY3Vyc2l2ZUNvbHVtblNvcnQobnVsbCwgY29sLmNoaWxkTGlzdCwgcGFyYW1zKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGlmIChwYXJhbXMuY29sSW5kZXggPT09IHBhcmFtcy5pbmRleCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChjb2wudHlwZSAmJiBjb2wudHlwZS50b0xvd2VyQ2FzZSgpID09PSAndGV4dCcpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1zLmlzVGV4dC5wdXNoKGNvbC5iaW5kRmllbGQpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAocGFyYW1zLmNlbGwudGFnKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2wuc29ydCA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sWydzb3J0SW5kZXgnXSA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sLnNvcnQgPSAxO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbFsnc29ydEluZGV4J10gPSBjb2xbJ3NvcnRJbmRleCddICE9PSBudWxsICYmIGNvbFsnc29ydEluZGV4J10gIT09IHVuZGVmaW5lZCAmJiBjb2xbJ3NvcnRJbmRleCddID4gMCA/IGNvbFsnc29ydEluZGV4J10gOiBjb2wuYmluZEZpZWxkID09PSBwYXJhbXMuc29ydEluZm8uYmluZEZpZWxkID8gcGFyYW1zLnNvcnRJbmZvLnNvcnRJbmRleCA6IHBhcmFtcy5zb3J0SW5mby5zb3J0SW5kZXggKyAxO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbC5zb3J0ID0gMjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xbJ3NvcnRJbmRleCddID0gY29sWydzb3J0SW5kZXgnXSAhPT0gbnVsbCAmJiBjb2xbJ3NvcnRJbmRleCddICE9PSB1bmRlZmluZWQgJiYgY29sWydzb3J0SW5kZXgnXSA+IDAgPyBjb2xbJ3NvcnRJbmRleCddIDogY29sLmJpbmRGaWVsZCA9PT0gcGFyYW1zLnNvcnRJbmZvLmJpbmRGaWVsZCA/IHBhcmFtcy5zb3J0SW5mby5zb3J0SW5kZXggOiBwYXJhbXMuc29ydEluZm8uc29ydEluZGV4ICsgMTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHBhcmFtcy5jb2xJbmRleCsrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOnByZWZlci1mb3Itb2ZcclxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb2xMaXN0Lmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoY29sTGlzdFtpXS5jaGlsZExpc3QgJiYgY29sTGlzdFtpXS5jaGlsZExpc3QubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZWN1cnNpdmVDb2x1bW5Tb3J0KG51bGwsIGNvbExpc3RbaV0uY2hpbGRMaXN0LCBwYXJhbXMpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAocGFyYW1zLmNvbEluZGV4ID09PSBwYXJhbXMuaW5kZXgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbExpc3RbaV0udHlwZSAmJiBjb2xMaXN0W2ldLnR5cGUudG9Mb3dlckNhc2UoKSA9PT0gJ3RleHQnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJhbXMuaXNUZXh0LnB1c2goY29sTGlzdFtpXS5iaW5kRmllbGQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChwYXJhbXMuY2VsbC50YWcoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sTGlzdFtpXS5zb3J0ID0gMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sTGlzdFtpXVsnc29ydEluZGV4J10gPSAwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbExpc3RbaV0uc29ydCA9IDE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbExpc3RbaV1bJ3NvcnRJbmRleCddID0gY29sTGlzdFtpXVsnc29ydEluZGV4J10gIT09IG51bGwgJiYgY29sTGlzdFtpXVsnc29ydEluZGV4J10gIT09IHVuZGVmaW5lZCAmJiBjb2xMaXN0W2ldWydzb3J0SW5kZXgnXSA+IDAgPyBjb2xMaXN0W2ldWydzb3J0SW5kZXgnXSA6IGNvbExpc3RbaV0uYmluZEZpZWxkID09PSBwYXJhbXMuc29ydEluZm8uYmluZEZpZWxkID8gcGFyYW1zLnNvcnRJbmZvLnNvcnRJbmRleCA6IHBhcmFtcy5zb3J0SW5mby5zb3J0SW5kZXggKyAxO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbExpc3RbaV0uc29ydCA9IDI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbExpc3RbaV1bJ3NvcnRJbmRleCddID0gY29sTGlzdFtpXVsnc29ydEluZGV4J10gIT09IG51bGwgJiYgY29sTGlzdFtpXVsnc29ydEluZGV4J10gIT09IHVuZGVmaW5lZCAmJiBjb2xMaXN0W2ldWydzb3J0SW5kZXgnXSA+IDAgPyBjb2xMaXN0W2ldWydzb3J0SW5kZXgnXSA6IGNvbExpc3RbaV0uYmluZEZpZWxkID09PSBwYXJhbXMuc29ydEluZm8uYmluZEZpZWxkID8gcGFyYW1zLnNvcnRJbmZvLnNvcnRJbmRleCA6IHBhcmFtcy5zb3J0SW5mby5zb3J0SW5kZXggKyAxO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBwYXJhbXMuY29sSW5kZXgrKztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHJlY3Vyc2l2ZUlzUmVkQ29sdW1uKGNvbCwgY29sTGlzdCwgcGFyYW1zKSB7XHJcbiAgICAgICAgaWYgKGNvbExpc3QgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICBpZiAoY29sLmNoaWxkTGlzdCAmJiBjb2wuY2hpbGRMaXN0Lmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5yZWN1cnNpdmVJc1JlZENvbHVtbihudWxsLCBjb2wuY2hpbGRMaXN0LCBwYXJhbXMpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaWYgKGNvbC5pc1JlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHBhcmFtcy5pc1JlZENvbHVtbnMucHVzaCh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbEluZGV4OiBwYXJhbXMuY29sSW5kZXhcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHBhcmFtcy5jb2xJbmRleCsrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOnByZWZlci1mb3Itb2ZcclxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb2xMaXN0Lmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoY29sTGlzdFtpXS5jaGlsZExpc3QgJiYgY29sTGlzdFtpXS5jaGlsZExpc3QubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZWN1cnNpdmVJc1JlZENvbHVtbihudWxsLCBjb2xMaXN0W2ldLmNoaWxkTGlzdCwgcGFyYW1zKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbExpc3RbaV0uaXNSZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1zLmlzUmVkQ29sdW1ucy5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbEluZGV4OiBwYXJhbXMuY29sSW5kZXhcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHBhcmFtcy5jb2xJbmRleCsrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgaXNOdW1iZXIodmFsKSB7XHJcbiAgICAgICAgaWYgKHBhcnNlRmxvYXQodmFsKS50b1N0cmluZygpID09IFwiTmFOXCIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufSJdfQ==