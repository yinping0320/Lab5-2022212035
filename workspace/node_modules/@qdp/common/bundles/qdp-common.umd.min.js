!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/common/http"),require("lodash-es"),require("@gsp-svc/cloudprint"),require("rxjs/operators"),require("@ecp-caf/caf-common"),require("@angular/common"),require("rxjs"),require("@angular/core")):"function"==typeof define&&define.amd?define("@qdp/common",["exports","@angular/common/http","lodash-es","@gsp-svc/cloudprint","rxjs/operators","@ecp-caf/caf-common","@angular/common","rxjs","@angular/core"],t):t((e.qdp=e.qdp||{},e.qdp.common={}),e.ng.common.http,e.lodashEs,e.cloudprint,e.rxjs.operators,e.cafCommon,e.ng.common,e.rxjs,e.ng.core)}(this,function(e,t,s,p,c,r,n,d,i){"use strict";var o=function(){function e(e){this.httpClient=e}return e.prototype.get=function(e,t,r){return this.request(e,"GET",t,r)},e.prototype.put=function(e,t,r,n){var i=this.addBody(n,t);return this.request(e,"PUT",r,i)},e.prototype.post=function(e,t,r,n){var i=this.addBody(n,t);return this.request(e,"POST",r,i)},e.prototype["delete"]=function(e,t,r){return this.request(e,"DELETE",t,r)},e.prototype.request=function(e,t,r,n){if(void 0===n&&(n={}),n=n||{},r){var i=this.buildParams(r);n.params=i}var o=t;return this.httpClient.request(o,e,n)},e.prototype.buildParams=function(e){var t={};for(var r in e)if(e.hasOwnProperty(r)&&e[r]){var n=e[r].toString();t[r]=n}return t},e.prototype.addBody=function(e,t){return e=e||{},Object.assign(e,{body:t})},e.decorators=[{type:i.Injectable}],e.ctorParameters=function(){return[{type:t.HttpClient}]},e}();function m(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}}function a(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(n=o.next()).done;)a.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(r=o["return"])&&r.call(o)}finally{if(i)throw i.error}}return a}function u(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(a(arguments[t]));return e}var l="serverHost",h="loadDataUri",f="loadDataCol",g=function(){function e(){}return e.decorators=[{type:i.Injectable,args:[{providedIn:"root"}]}],e.ngInjectableDef=i.defineInjectable({factory:function(){return new e},token:e,providedIn:"root"}),e}(),y=function(){function i(){}return i.createHeaderSessionId=function(e){var t={headers:{"Content-Type":"application/json"}};try{gspframeworkService&&gspframeworkService.rtf&&gspframeworkService.rtf.session&&gspframeworkService.rtf.session.getFormToken()?t.headers["X-CAF-Runtime-CommonVariable"]=gspframeworkService.rtf.session.getFormToken():e&&e.getCurrentSeesionId()?t.headers["X-CAF-Runtime-CommonVariable"]=e.getCurrentSeesionId():e&&e.getUserSessionId()?t.headers.SessionId=e.getUserSessionId():localStorage.getItem("sessionId")&&(t.headers.SessionId=localStorage.getItem("sessionId"))}catch(r){}return t},i.getSessionId=function(e){var t;try{gspframeworkService&&gspframeworkService.rtf&&gspframeworkService.rtf.session&&gspframeworkService.rtf.session.getFormToken()?t=gspframeworkService.rtf.session.getFormToken():e&&e.getCurrentSeesionId()?t=e.getCurrentSeesionId():e&&e.getUserSessionId()?t=e.getUserSessionId():localStorage.getItem("sessionId")&&(t=localStorage.getItem("sessionId"))}catch(r){}return t},i.getTabId=function(e){try{if(gspframeworkService&&gspframeworkService.rtf&&gspframeworkService.rtf.session){var t=gspframeworkService.rtf.session.getCommonVariable();if(gspframeworkService.rtf.extendMethod&&gspframeworkService.rtf.extendMethod.getExtObj&&gspframeworkService.rtf.extendMethod.getExtObj()&&gspframeworkService.rtf.extendMethod.getExtObj().iGIXFrmUUID){var r=gspframeworkService.rtf.extendMethod.getExtObj().iGIXFrmUUID()?gspframeworkService.rtf.extendMethod.getExtObj().iGIXFrmUUID():"";return t.tabId+r}return t.tabId}}catch(n){return e}},i.getInSuiteFrmUUID=function(){try{return gspframeworkService.rtf.extendMethod&&gspframeworkService.rtf.extendMethod.getExtObj&&gspframeworkService.rtf.extendMethod.getExtObj()&&gspframeworkService.rtf.extendMethod.getExtObj().iGIXFrmUUID&&gspframeworkService.rtf.extendMethod.getExtObj().iGIXFrmUUID()?gspframeworkService.rtf.extendMethod.getExtObj().iGIXFrmUUID():""}catch(e){return""}},i.getCommonVariable=function(){try{if(gspframeworkService&&gspframeworkService.rtf&&gspframeworkService.rtf.session)return gspframeworkService.rtf.session.getCommonVariable()}catch(e){return null}},i.getMenuParameter=function(e){try{var t=i.getCommonVariable().funcId;if(gspframeworkService&&gspframeworkService.rtf&&gspframeworkService.rtf.func){var r=null;if(gspframeworkService.rtf.func.getMenuParams(t,function(e){r=e}),r)return r.get(e)}return null}catch(n){return null}},i.getMenuSwitchControlParameter=function(e){return{menuSwitchControl:{key:e,value:new d.Subject,changeEnable:!1}}},i.getMenuSwitchControlEvent=function(){try{var e=i.getTabId();if(gspframeworkService&&gspframeworkService.rtf&&gspframeworkService.rtf.frmEvent){var t=null,r=i.getCommonVariable();return gspframeworkService.rtf.frmEvent.eventListener(e,function(e){t=e},r),t&&t.hasOwnProperty("menuSwitchControl")&&t.menuSwitchControl.key===e?t.menuSwitchControl.value:null}}catch(n){return null}},i.getFuncId=function(e){return i.getNewPageIdFunc(e)},i.getFuncName=function(){try{return gspframeworkService&&gspframeworkService.rtf&&gspframeworkService.rtf.tabs?gspframeworkService.rtf.tabs.getAll().find(function(e){return e.id==gspframeworkService.rtf.tabs.getActiveTab().funcId}).FuncName:""}catch(e){return""}},i.getFuncIdOlde=function(e){return"app"===e.appType.toLowerCase()?i.newPageIdApp(e.appId,e.appEntrance,e.tabId):i.newPageIdFunc(e.funcId,e.tabId)},i.getNewPageIdFunc=function(e){try{return gspframeworkService&&gspframeworkService.rtf&&gspframeworkService.rtf.func?gspframeworkService.rtf.func.newPageId(e):i.getFuncIdOlde(e)}catch(t){return i.getFuncIdOlde(e)}},i.newPageIdFunc=function(e,t){return t?e+"_"+t:e},i.mergeAppId=function(e,t){return e+"_"+t},i.newPageIdApp=function(e,t,r){return r?i.mergeAppId(e,t)+"_"+r:i.mergeAppId(e,t)},i.uuid="",i.isInSuite=!1,i}(),v=function(){function e(e,t,r,n){this.restService=e,this.sessionService=t,this.host=r,this.schemaRenderExtendService=n,this.uri="/api/runtime/bcc/v1.0/qdpschemamanager/",this.schemaInfoChange=new d.Subject,this.colList=new d.Subject,this.controlType=new d.Subject,this.schemaInfo={},this.schemaid=new d.Subject,this.operationChange=new d.Subject,this.dynamicCols={},this.customSchema={},this.dynamicColIndex=0,this.preSchema={id:"prefab",schemaName:"系统预制",isPrefab:1,isDefault:0,isProtected:"0",schemaValue:{titleOption:{title:"",subTitles:[]},columnOption:{maxLevel:0,colList:[]},styleOption:{Title:{fontFamily:9,size:14,fontWeight:0,fontStyle:0,textDecoration:0,fontColor:"black",rowHeight:35},SubTitle:{fontFamily:9,size:14,fontWeight:0,fontStyle:0,textDecoration:0,fontColor:"black",rowHeight:35},Header:{fontFamily:9,size:14,fontWeight:0,fontStyle:0,textDecoration:0,fontColor:"black",rowHeight:35},DataArea:{fontFamily:9,size:14,fontWeight:0,fontStyle:0,textDecoration:0,fontColor:"black",rowHeight:35},Footer:{fontFamily:9,size:14,fontWeight:0,fontStyle:0,textDecoration:0,fontColor:"black",rowHeight:35}},otherOption:{showFilterRow:!0,dataCahce:!0,level:"",isDetails:"",loadDataType:1,pageSize:20,treeInfoType:2,pathField:"",pathStep:0,idField:"",parentField:"",firstLoad:!0,showZero:!0,expand:!0,showHeaderSort:!0}}},this.isDefaultSchema=[],this.operations={};var i=this;this.getOperation().subscribe(function(e){e&&(i.operations.QdpQueryExport=e["05202284-dfc4-149c-853e-cfd35b4a02bb"],i.operations.QdpQueryPrint=e["653fe24b-d77f-d8b0-71c5-5e3d561e33ca"],i.operations.QdpModifyPublicSchema=e["d6832d96-e6f3-114e-1d53-f9e636548eb9"],i.operations.QdpPubQuery=e["cd6c2057-5ad6-90dd-54ac-771c192563e8"],i.operationChange.next(i.operations))})}return e.prototype.getSpreadTemplate=function(e,t,r,n,i,o,a){var s;r&&r.length&&(this.dynamicCols[a||t]=r,this.dynamicCols[e]=r),this.schemaList&&this.schemaList[e]&&(s=this.schemaList[e]);var c=[];return c=this.dynamicCols[a||t]?Object.assign(o,this.dynamicCols[a||t]):o,this.colList.next(c),this.analysis(s&&s.id?s.id:"1",t,r,n,i)},e.prototype.getSchema=function(r,n,e,t,i,o){var a=this;return this.schemaList&&this.schemaList[r]&&o&&!0===o?d.of(this.schemaList[r]):(t?this.getSchemaListByGroupType(n,"",i,t,e):this.getSchemaList(n,"",i,e)).pipe(c.map(function(e){if("1"===r||"prefab"===r)return Object.assign({},a.preSchema,{id:"1"});if(e&&e.schemaList&&e.schemaList[n]){if(e.schemaList[n][r])return e.schemaList[n][r];var t="";return e.isDefaultSchema&&e.isDefaultSchema.id&&e.schemaList[n][e.isDefaultSchema.id]?(t=e.isDefaultSchema.id,e.schemaList[n][t]):null}return null}))},e.prototype.getDefaultSchema=function(e,t,r,n){var i=this;return(r?this.getSchemaListByGroupType(e,"",n,r,t):this.getSchemaList(e,"",n,t)).pipe(c.map(function(){return i.isDefaultSchema[e]&&i.isDefaultSchema[e].id?i.isDefaultSchema[e]:null}))},e.prototype.getSchemaList=function(e,t,r,n){var i=this.host+this.uri+"getschemalist";return this.getSchemas(i,n,{queryId:e,userId:t,organizationId:r})},e.prototype.getSchemaListByGroupType=function(e,t,r,n,i){var o=this.host+this.uri+"getschemalistbygroup";return this.getSchemas(o,i,{queryId:e,userId:t,organizationId:r,groupType:n})},e.prototype.getSchemas=function(e,t,o){var a=this;return a.restService.get(e,o,a.createHeaderSessionId()).pipe(c.map(function(e){if(a.schemaList={},e&&e.length){a.isDefaultSchema[o.queryId]=null,e.forEach(function(e){e.schemaValue=JSON.parse(e.schemaValue),1===e.isDefault&&(a.isDefaultSchema[o.queryId]=e),a.schemaList[e.id]=e,a.operateDynamicColsForSchema.call(a,e,o.groupType?o.groupType:o.queryId)});var t="";if(a.schemaRenderExtendService&&a.schemaRenderExtendService.schemaInfoRenderBefore){var r={queryId:o.queryId,defaultSchemaId:""};r.schemalList=a.schemaList,a.schemaRenderExtendService.schemaInfoRenderBefore(r),r.defaultSchemaId&&(t=r.defaultSchemaId)}var n={schemaType:0};t&&(n.id=t),!t&&a.isDefaultSchema&&a.isDefaultSchema[o.queryId]||(s.filter(e,n)&&s.filter(e,n).length?a.isDefaultSchema[o.queryId]=s.filter(e,n)[0]:(n.schemaType=1,s.filter(e,n)&&s.filter(e,n).length?a.isDefaultSchema[o.queryId]=s.filter(e,n)[0]:(n.schemaType=2,s.filter(e,n)&&s.filter(e,n).length&&(a.isDefaultSchema[o.queryId]=s.filter(e,n)[0])))),a.schemaInfo[o.queryId]=a.schemaList;var i=JSON.parse(JSON.stringify(a.preSchema));return a.operateCustomSchema(i,o.groupType?o.groupType:o.queryId),a.operateDynamicColsForSchema.call(a,i,o.groupType?o.groupType:o.queryId,1),a.schemaInfoChange.next({schemaList:a.schemaInfo,isDefaultSchema:a.isDefaultSchema[o.queryId],preSchema:i}),{schemaList:a.schemaInfo,isDefaultSchema:a.isDefaultSchema[o.queryId],preSchema:i}}delete a.schemaInfo[o.queryId];i=JSON.parse(JSON.stringify(a.preSchema));return a.isDefaultSchema[o.queryId]=null,a.operateCustomSchema(i,o.groupType?o.groupType:o.queryId),a.operateDynamicColsForSchema.call(a,i,o.groupType?o.groupType:o.queryId,1),a.schemaInfoChange.next({schemaList:null,isDefaultSchema:null,preSchema:i}),{schemaList:null,isDefaultSchema:null,preSchema:i}}))},e.prototype.mergeCustomSchema=function(e,t){var r=this,n=JSON.parse(JSON.stringify(r.preSchema));return n=r.operateCustomSchema(n,e),r.operateDynamicColsForSchema.call(r,n,e,1),r.schemaInfoChange.next({schemaList:r.schemaInfo,isDefaultSchema:r.isDefaultSchema&&r.isDefaultSchema[t]?r.isDefaultSchema[t]:null,preSchema:n}),n},e.prototype.operateCustomSchema=function(e,t){try{if(this.customSchema&&this.customSchema[t]){var r=JSON.parse(this.customSchema[t]);return e.schemaValue.titleOption=Object.assign(e.schemaValue.titleOption,r.titleOption),e.schemaValue.columnOption=Object.assign(e.schemaValue.columnOption,r.columnOption),e.schemaValue.styleOption=Object.assign(e.schemaValue.styleOption,r.styleOption),e.schemaValue.otherOption=Object.assign(e.schemaValue.otherOption,r.otherOption),e}}catch(n){console.log(n)}},e.prototype.saveSchema=function(e,t){var r=this,n=this.host+this.uri+"saveschema",i=JSON.parse(e.schema);return this.restService.post(n,e,{},this.createHeaderSessionId()).pipe(c.switchMap(function(){return e.groupType?r.getSchemaListByGroupType(i.queryId,"",i.orgId,e.groupType,t):r.getSchemaList(i.queryId,"",i.orgId,t)}))},e.prototype.deleteSchema=function(e,t,r,n,i){var o=this,a=this.host+this.uri+"deleteschema";return this.restService["delete"](a,{id:e},this.createHeaderSessionId()).pipe(c.map(function(e){return!0!==e?d.of(!1):(o.isDefaultSchema[t]=null,(n?o.getSchemaListByGroupType(t,"",i,n,r):o.getSchemaList(t,"",i,r)).pipe(c.map(function(e){return!0})))}))},e.prototype.analysis=function(e,t,r,n,i){var o=this.host+this.uri,a={};return"1"!==e?r&&r.length?(a={id:e,dynamicCols:JSON.stringify(r),schema:i||""},this.restService.post(o+"getspreadtemplatewithdynamiccolumn",a,{},this.createHeaderSessionId())):i?this.restService.post(o+"getspreadtemplatebyid",{id:e,schema:i||""},{},this.createHeaderSessionId()):this.restService.get(o+"getspreadtemplate",{id:e},this.createHeaderSessionId()):(r=r&&r.length?r:[],a={dynamicCols:JSON.stringify(r),schema:i||""},this.restService.post(o+"getinitspreadtemplate",a,{},this.createHeaderSessionId()))},e.prototype.getOperation=function(e){var t=this.host+this.uri,r={};return r=e&&e.length?{operators:e}:{operators:["05202284-dfc4-149c-853e-cfd35b4a02bb","653fe24b-d77f-d8b0-71c5-5e3d561e33ca","d6832d96-e6f3-114e-1d53-f9e636548eb9","cd6c2057-5ad6-90dd-54ac-771c192563e8"]},this.restService.post(t+"isprincipalhasop",r,{},this.createHeaderSessionId())},e.prototype.validateOperation=function(e){return!0===this.operations.QdpModifyPublicSchema&&(0===e||"0"===e)},e.prototype.setColInfo=function(e){var t=[];e&&e.length&&(t=e),this.colList.next(t)},e.prototype.createHeaderSessionId=function(){return y.createHeaderSessionId(this.sessionService)},e.prototype.operateDynamicColsForSchema=function(e,t,r){if(this.dynamicCols&&this.dynamicCols[t]&&e&&e.id&&(1===e.isProtected||"1"===e.isProtected||1===r)){var n=1===r?this.dynamicCols[t]:this.dynamicCols[e.id],i=this.createColumns(n,e.schemaValue.columnOption.colList);e.schemaValue.columnOption.colList=i}},e.prototype.createColumns=function(e,t){var r=[];if(t&&t.length){if(r.push.apply(r,u(JSON.parse(JSON.stringify(t)))),e&&0<e.length)for(var n=0,i=0;i<e.length;i++){var o=this.getColumn(r,e[i]);o?!1===this.recursiveCompareColumn(o.childList,e[i].childList)&&(o=e[i]):n>=r.length?r.push(e[i]):r.splice(n,0,e[i]),o&&0===n?n=this.dynamicColIndex+1:n+=1}}else e&&0<e.length&&r.push.apply(r,u(e));return r},e.prototype.getColumn=function(e,t){for(var r=null,n=this.dynamicColIndex=0;n<e.length;n++)if(null!=(r=this.recursiveGetColumn(t,e[n],null)))return r;return r},e.prototype.recursiveGetColumn=function(e,t,r){if(t){if(t.bindField===e.bindField)return t;if(t.childList&&0<t.childList.length)return this.recursiveGetColumn(e,null,t.childList);this.dynamicColIndex+=1}else for(var n=0;n<r.length;n++){if(r[n].bindField===e.bindField)return r[n];if(r[n].childList&&0<r[n].childList.length)return this.recursiveGetColumn(e,null,r[n].childList);this.dynamicColIndex+=1}return null},e.prototype.recursiveCompareColumn=function(e,t){if(!e&&!t)return!0;if(!e&&t)return!1;if(e&&!t)return!1;if(e&&t){if(e.length!==t.length)return!1;if(0===e.length&&0===t.length)return!0;if(0===e.length)return!1;for(var r=0;r<e.length;r++)return e[r].bindField===t[r].bindField&&this.recursiveCompareColumn(e[r].childList,t[r].childList);return!1}return!1},e.decorators=[{type:i.Injectable}],e.ctorParameters=function(){return[{type:o},{type:r.SessionService},{type:String,decorators:[{type:i.Inject,args:[l]}]},{type:g,decorators:[{type:i.Optional}]}]},e}(),S=function(){function e(e,t,r,n,i){this.restfulService=e,this.sessionService=t,this.serverHost=r,this.loadDataUri=n,this.loadDataCol=i,this.pageInfoChange=new d.Subject,this.variablesChange=new d.Subject,this.inSuiteDropDownInfoChange=new d.Subject}return e.prototype.exportData=function(e,s){var c=this,t=this.serverHost;this.loadDataUri?t+=this.loadDataUri:t+=(s||"/api/runtime/bcc/v1.0/qdpsearch/")+"export";var r={responseType:"application/json"};Object.assign(r,this.createHeaderSessionId());var p=e.excelExportName+".xlsx";e=s?{Param:e}:e,(s?this.restfulService.put(t,e,{},r):this.restfulService.post(t,e,{},r)).toPromise().then(function(e){e=s?JSON.parse(e).returnValue:e;for(var t=atob(e),r=new ArrayBuffer(t.length),n=new Uint8Array(r),i=0;i<t.length;i++)n[i]=t.charCodeAt(i);var o=new Blob([n],{type:"application/vnd.ms-excel"});if("download"in document.createElement("a")){var a=document.createElement("a");a.download=p,a.style.display="none",a.href=URL.createObjectURL(o),document.body.appendChild(a),a.click(),URL.revokeObjectURL(a.href),document.body.removeChild(a)}else navigator.msSaveBlob(o,p);c.loading.close()},function(e){c.formErrorService.exception(e.Message,e)})},e.prototype.aysnExportData=function(e,t){var r=this,n=this.serverHost;this.loadDataUri?n+=this.loadDataUri:n+=(t||"/api/runtime/bcc/v1.0/qdpsearch/")+"export";var i={responseType:"application/json"};Object.assign(i,this.createHeaderSessionId()),e.async=1,e=t?{Param:e}:e,(t?this.restfulService.put(n,e,{},i):this.restfulService.post(n,e,{},i)).toPromise().then(function(e){e=t?JSON.parse(e).returnValue:e},function(e){r.formErrorService.exception(e.Message,e)})},e.prototype.pdfExportEvent=function(e,s){var t=this,r=this.serverHost;this.loadDataUri?r+=this.loadDataUri:r+=(s||"/api/runtime/bcc/v1.0/qdpsearch/")+"print";var n={responseType:"application/json"};Object.assign(n,this.createHeaderSessionId());var c=(e=s?{Param:e}:e).Param&&e.Param.excelExportName?e.Param.excelExportName+"":e.excelExportName+"";(s?this.restfulService.put(r,e,{},n):this.restfulService.post(r,e,{},n)).toPromise().then(function(e){e=s?JSON.parse(e).returnValue:e;for(var t=atob(e),r=new ArrayBuffer(t.length),n=new Uint8Array(r),i=0;i<t.length;i++)n[i]=t.charCodeAt(i);var o=new Blob([n],{type:"application/pdf"});if("download"in document.createElement("a")){var a=document.createElement("a");a.download=c,a.style.display="none",a.href=URL.createObjectURL(o),document.body.appendChild(a),a.click(),URL.revokeObjectURL(a.href),document.body.removeChild(a)}else navigator.msSaveBlob(o,c)},function(e){t.formErrorService.exception(e.Message,e)})},e.prototype.printPreView=function(e,s){var c=this,t=this.serverHost;this.loadDataUri?t+=this.loadDataUri:t+=(s||"/api/runtime/bcc/v1.0/qdpsearch/")+"print";var r={responseType:"application/json"};Object.assign(r,this.createHeaderSessionId());(e=s?{Param:e}:e).Param&&e.Param.excelExportName?e.Param.excelExportName:e.excelExportName;(s?this.restfulService.put(t,e,{},r):this.restfulService.post(t,e,{},r)).toPromise().then(function(e){e=s?JSON.parse(e).returnValue:e;for(var t={OutputType:p.OutputType.PRINT,FileType:p.FileType.Pdf,Path:"",DeviceId:"",printType:p.PrintType.Query,printJob:!1,printerName:"",printSetting:null},r=atob(e),n=new ArrayBuffer(r.length),i=new Uint8Array(n),o=0;o<r.length;o++)i[o]=r.charCodeAt(o);var a=new Blob([i]);c.cloudprintService.openRendedViewer("tab",a,t)},function(e){c.formErrorService.exception(e.Message,e)})},e.prototype.getData=function(e,t){var r=this,n=this.serverHost;return this.loadDataUri?n+=this.loadDataUri:n+=t?t+"querydata":"/api/runtime/bcc/v1.0/qdpsearch/query",e=t?{Param:e}:e,(t?this.restfulService.put(n,e,{},this.createHeaderSessionId()):this.restfulService.post(n,e,{},this.createHeaderSessionId())).pipe(c.map(function(e){return e&&((e=t?e.returnValue:e)&&e.pageInfo&&r.pageInfoChange.next(e.pageInfo),e&&e.variables&&r.variablesChange.next(e.variables),e&&e.dropDownOption&&(r.inSuiteDropDownInfo=e.dropDownOption,r.inSuiteDropDownInfoChange.next(e.dropDownOption))),e}))},e.prototype.getCol=function(e,t){var r=this.serverHost;return this.loadDataCol?r+=this.loadDataCol:r+=(t||"/api/runtime/bcc/v1.0/qdpsearch/")+"querycol",e=t?{Param:e}:e,(t?this.restfulService.put(r,e,{},this.createHeaderSessionId()):this.restfulService.post(r,e,{},this.createHeaderSessionId())).pipe(c.map(function(e){return e&&(e=t?e.returnValue:e),e}))},e.prototype.getCrosstabTemplate=function(e,t){var r=this.serverHost;return this.loadDataUri?r+=this.loadDataUri:r+=t?t+"getcrosstabtemplate":"/api/runtime/bcc/v1.0/qdpsearch/getcrosstabtemplate",e=t?{Param:e}:e,(t?this.restfulService.put(r,e,{},this.createHeaderSessionId()):this.restfulService.post(r,e,{},this.createHeaderSessionId())).pipe(c.map(function(e){return e&&(e=t?e&&e.returnValue?JSON.parse(e.returnValue):undefined:e),e}))},e.prototype.getSpreadLicense=function(){return this.restfulService.get("/api/runtime/bcc/v1.0/qdpschemamanager/getSpreadLicense",{},this.createHeaderSessionId()).pipe(c.map(function(e){return e.spreadjs}))},e.prototype.clearCache=function(e){var t=this.serverHost+"/api/runtime/bcc/v1.0/qdpsearch/clearcache";return this.restfulService.post(t,e,{},this.createHeaderSessionId()).pipe(c.map(function(e){return e}))},e.prototype.createHeaderSessionId=function(){return y.createHeaderSessionId(this.sessionService)},e.decorators=[{type:i.Injectable}],e.ctorParameters=function(){return[{type:o},{type:r.SessionService},{type:String,decorators:[{type:i.Inject,args:[l]},{type:i.Optional}]},{type:String,decorators:[{type:i.Inject,args:[h]},{type:i.Optional}]},{type:String,decorators:[{type:i.Inject,args:[f]},{type:i.Optional}]}]},e}(),I=function(){function e(e){this.printService=e}return e.prototype.printSingle=function(e,t){return this.printArray(e,[t])},e.prototype.printByIds=function(e,t){var r=t.split(",").filter(function(e){return e});return this.printArray(e,r)},e.prototype.printByIdsWithDimension=function(e,t,r,n,i){var o=t.split(",").filter(function(e){return e});return this.printArray(e,o,r,n,i)},e.prototype.printWithDimensionCustomDataSource=function(e,t,r,n,i,o,a){var s=t.split(",").filter(function(e){return e});return this.printArray(e,s,r,n,undefined,i,o,a)},e.prototype.printArray=function(e,t,r,n,i,o,a,s){var c=this.buildSourceOptions({dataIds:t,sourceId:e}),p=this.buildOutputOptions();return r&&(c.FirstDimensionVal=r),n&&(c.SecondDimensionVal=n),void 0!==i&&(c.billCategoryId=i),o&&(c.queryType=o),a&&(c.queryServiceId=a),s&&(c.queryParam=s),this.printService.outputBEData(c,p,"tab")},e.prototype.buildSourceOptions=function(e){return{DataIds:e&&e.dataIds||undefined,SourceId:e&&e.sourceId||undefined,FirstDimensionVal:e&&e.dim1||undefined,SecondDimensionVal:e&&e.dim2||undefined,RetrieveParam:e&&e.retrieveParam||undefined,FormatId:e&&e.formatId||undefined,billCategoryId:e&&e.billCategoryId||undefined,ServiceUnit:e&&e.serviceUnit||undefined,currentPage:e&&e.currentPage||undefined,pageRowCount:e&&e.pageRowCount||undefined,queryType:e&&e.queryType||undefined,queryServiceId:e&&e.queryServiceId||undefined,bizTypeId:e&&e.bizTypeId||undefined,queryParam:e&&e.queryParam||undefined}},e.prototype.buildOutputOptions=function(e){return{OutputType:e&&e.outputType||p.OutputType.PRINT,FileType:e&&e.fileType||p.FileType.Html5,Path:e&&e.path||undefined,DeviceId:e&&e.deviceId||undefined,printJob:e&&e.printJob||undefined,printerName:e&&e.printerName||undefined,printSetting:e&&e.printSetting||undefined,printType:e&&e.printType||p.PrintType.Form}},e}(),b=function(){function e(e,t,r){this.restService=e,this.sessionService=t,this.host=r,this.uri="/api/runtime/bcc/v1.0/qdpparasmapping/",this.parasmappingInfoChange=new d.Subject,this.parasmappingInfoList={}}return e.prototype.getParasMapping=function(t,e,r,n){return void 0===n&&(n=0),this.getParasMappingList(e,t,"","",r,n).pipe(c.map(function(e){return e&&e[t]?e[t]:null}))},e.prototype.getParasMappingList=function(e,t,r,n,i,o){var a=this;void 0===o&&(o=0);var s=this.host+this.uri+"getparasmappinglist";return this.restService.get(s,{queryId:e,datasourceId:t,userId:r,languageType:n,queryType:o},this.createHeaderSessionId()).pipe(c.map(function(e){return e&&e.length?(e.forEach(function(e){e.parasmapping=JSON.parse(e.parasmapping),a.parasmappingInfoList[e.datasourceid]=e}),a.parasmappingInfoChange.next({parasInfoList:a.parasmappingInfoList}),a.parasmappingInfoList):(a.parasmappingInfoChange.next({parasInfoList:null}),null)}))},e.prototype.saveParasMapping=function(e,t){var r=this,n=this.host+this.uri+"saveparasmapping";return this.restService.post(n,e,{},this.createHeaderSessionId()).pipe(c.map(function(){e.parasmapping=JSON.parse(e.parasmapping),Object.keys(r.parasmappingInfoList).indexOf(e.datasourceid)&&(r.parasmappingInfoList[e.datasourceid]=e)}))},e.prototype.deleteParasMapping=function(t,e,r){var n=this,i=this.host+this.uri+"deleteparasmapping";return this.restService["delete"](i,{datasourceId:t,queryId:e},this.createHeaderSessionId()).pipe(c.map(function(e){if(!0!==e)return!1;n.parasmappingInfoList[t]=null}))},e.prototype.getMetaDataInfoById=function(e){var t=this.host+"/api/runtime/lcm/v1.0/rt-metadatas/"+e;return this.restService.get(t,{},this.createHeaderSessionId()).pipe(c.map(function(e){return e||null}))},e.prototype.createHeaderSessionId=function(){return y.createHeaderSessionId(this.sessionService)},e.decorators=[{type:i.Injectable}],e.ctorParameters=function(){return[{type:o},{type:r.SessionService},{type:String,decorators:[{type:i.Inject,args:[l]}]}]},e}(),D=function(){function e(e,t,r){this.restService=e,this.sessionService=t,this.host=r,this.uri="/api/runtime/bcc/v1.0/printintegration/",this.printIntegrationInfoChange=new d.Subject,this.printIntegrationInfoList={}}return e.prototype.getPrintIntegration=function(t,r,e){return this.getPrintIntegrationList(r,t,"","",e).pipe(c.map(function(e){return e&&e[t+r]?e[t+r]:null}))},e.prototype.getPrintIntegrationList=function(t,r,e,n,i){var o=this,a=this.host+this.uri+"getprintintegrationlist";return this.restService.get(a,{queryId:t,schemaId:r,userId:e,languageType:n},this.createHeaderSessionId()).pipe(c.map(function(e){return e&&e.length?(e.forEach(function(e){e.printintegration=JSON.parse(e.printintegration),o.printIntegrationInfoList[r+t]=e}),o.printIntegrationInfoChange.next({printIntegrationInfoList:o.printIntegrationInfoList}),o.printIntegrationInfoList):(o.printIntegrationInfoChange.next({printIntegrationInfoList:null}),null)}))},e.prototype.savePrintIntegration=function(e,t){var r=this,n=this.host+this.uri+"saveprintintegration",i=e;return this.restService.post(n,i,{},this.createHeaderSessionId()).pipe(c.map(function(){e.printintegration=JSON.parse(e.printintegration),Object.keys(r.printIntegrationInfoList).indexOf(e.schemaId+e.queryId)&&(r.printIntegrationInfoList[e.schemaId+e.queryId]=e)}))},e.prototype.deletePrintIntegration=function(t,r,e){var n=this,i=this.host+this.uri+"deleteprintintegration";return this.restService["delete"](i,{schemaId:t,queryId:r},this.createHeaderSessionId()).pipe(c.map(function(e){if(!0!==e)return!1;n.printIntegrationInfoList[t+r]=null}))},e.prototype.createHeaderSessionId=function(){return y.createHeaderSessionId(this.sessionService)},e.decorators=[{type:i.Injectable}],e.ctorParameters=function(){return[{type:o},{type:r.SessionService},{type:String,decorators:[{type:i.Inject,args:[l]}]}]},e}(),C=function(){function e(e,t,r){this.restService=e,this.sessionService=t,this.host=r,this.uri="/api/runtime/bcc/v1.0/joinsearch/",this.localUri="/api/runtime/sys/v1.0/loginInfo",this.lcpUri="/api/runtime/bcc/v1.0/qdpsearch/",this.jointsearchInfoChange=new d.Subject,this.jointsearchInfoList={}}return e.prototype.getjointsearch=function(t,r,e){return this.getjointsearchList(t,r,"","",e).pipe(c.map(function(e){return e&&e[t+r]?e[t+r]:null}))},e.prototype.getVisibleJoint=function(e,f,g){var t=this.host+(f||this.lcpUri)+"visiblejoint";return this.restService.put(t,{Param:e},{},this.createHeaderSessionId()).pipe(c.map(function(r){var e,t,n,i,o=[];if(r)if(r=f?r.returnValue:r,f){var a=function(t){var e=r.find(function(e){return e.id===t.id});e&&!0===e.visible&&o.push(t)};try{for(var s=m(g),c=s.next();!c.done;c=s.next()){a(u=c.value)}}catch(l){n={error:l}}finally{try{c&&!c.done&&(i=s["return"])&&i.call(s)}finally{if(n)throw n.error}}}else try{for(var p=m(g),d=p.next();!d.done;d=p.next()){var u=d.value;null!==r[u.id]&&!0===r[u.id]&&o.push(u)}}catch(h){e={error:h}}finally{try{d&&!d.done&&(t=p["return"])&&t.call(p)}finally{if(e)throw e.error}}return o}))},e.prototype.getjointsearchList=function(e,t,r,n,i){var o=this,a=this.host+this.uri+"getjoinsearch";return this.restService.get(a,{formId:e,queryId:t,userId:r,languageType:n},this.createHeaderSessionId()).pipe(c.map(function(e){return e&&e.length?(e.forEach(function(e){o.jointsearchInfoList[e.formId+e.queryId]=e}),o.jointsearchInfoChange.next({jointsearchInfoList:o.jointsearchInfoList}),o.jointsearchInfoList):(o.jointsearchInfoChange.next({jointsearchInfoList:null}),null)}))},e.prototype.savejointsearch=function(t,e){var r=this,n=this.host+this.uri+"addjointsearch";return this.restService.post(n,t,{},this.createHeaderSessionId()).pipe(c.map(function(e){return!0===e&&(r.jointsearchInfoList[t.FormId+t.queryId]=t,!0)}))},e.prototype.deletejointsearch=function(t,r,e){var n=this,i=this.host+this.uri+"deletejointsearch";return this.restService["delete"](i,{formId:t,queryId:r},this.createHeaderSessionId()).pipe(c.map(function(e){return!0===e&&!(n.jointsearchInfoList[t+r]=null)}))},e.prototype.getLanguageList=function(){return this.restService.get(this.localUri,{infoType:"supportedLanguage"}).pipe(c.map(function(e){return e}))},e.prototype.createHeaderSessionId=function(){return y.createHeaderSessionId(this.sessionService)},e.decorators=[{type:i.Injectable}],e.ctorParameters=function(){return[{type:o},{type:r.SessionService},{type:String,decorators:[{type:i.Inject,args:[l]}]}]},e}(),w=function(){function e(){}return e.decorators=[{type:i.Injectable,args:[{providedIn:"root"}]}],e.ngInjectableDef=i.defineInjectable({factory:function(){return new e},token:e,providedIn:"root"}),e}(),_=function(){function e(){}return e.decorators=[{type:i.Injectable,args:[{providedIn:"root"}]}],e.ngInjectableDef=i.defineInjectable({factory:function(){return new e},token:e,providedIn:"root"}),e}(),O=function(){function e(e,t,r){this.restService=e,this.sessionService=t,this.host=r,this.uri="/api/runtime/bcc/v1.0/qdpfilter/",this.filterInfoChange=new d.Subject,this.isFilterQDP=new d.Subject,this.filterInfoList={}}return e.prototype.getFilter=function(e,t,r,n,i){return this.getFilterList(t,e,i,"",r,n).pipe(c.map(function(e){return e&&e[t]?e[t]:null}))},e.prototype.getFilterList=function(e,t,r,n,i,o){var a=this;void 0===o&&(o=0);var s=this.host+this.uri+"getfilterlist";return this.restService.get(s,{queryId:e,datasourceId:t,groupType:r,languageType:n,queryType:o},this.createHeaderSessionId()).pipe(c.map(function(e){return e&&e.length?(e.forEach(function(e){e.filter=JSON.parse(e.filter),a.filterInfoList[e.queryid]=e}),a.filterInfoChange.next({parasInfoList:a.filterInfoList}),a.filterInfoList):(a.filterInfoChange.next({parasInfoList:null}),null)}))},e.prototype.saveFilter=function(e,t){var r=this,n=this.host+this.uri+"savefilter";return this.restService.post(n,e,{},this.createHeaderSessionId()).pipe(c.map(function(){e.filter=JSON.parse(e.filter),Object.keys(r.filterInfoList).indexOf(e.queryid)&&(r.filterInfoList[e.queryid]=e)}))},e.prototype.deleteFilter=function(e,t,r,n){var i=this,o=this.host+this.uri+"deletefilter";return this.restService["delete"](o,{datasourceId:e,queryId:t,queryType:n},this.createHeaderSessionId()).pipe(c.map(function(e){if(!0!==e)return!1;i.filterInfoList[t]=null}))},e.prototype.createHeaderSessionId=function(){return y.createHeaderSessionId(this.sessionService)},e.decorators=[{type:i.Injectable}],e.ctorParameters=function(){return[{type:o},{type:r.SessionService},{type:String,decorators:[{type:i.Inject,args:[l]}]}]},e}(),L=function(){function e(){}return e.register=function(e,t,r){var n=this;this.handlers[e]||(this.handlers[e]={});var i=r;i||(i=this.guid()),this.handlers[e][i]=t;return function(){delete n.handlers[e][i],0===Object.keys(n.handlers[e]).length&&delete n.handlers[e]}},e.dispatch=function(t,r){var n=this;this.handlers[t]&&Object.keys(this.handlers[t]).forEach(function(e){n.handlers[t][e](r)})},e.guid=function(){function e(){return(65536*(1+Math.random())|0).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()},e.handlers={},e}(),E=function(){function s(){}return s.isObj=function(e){return e&&"object"==typeof e&&"[object object]"==Object.prototype.toString.call(e).toLowerCase()},s.isArray=function(e){return e&&"object"==typeof e&&e.constructor==Array},s.getLength=function(e){var t=0;for(var r in e)t++;return t},s.Compare=function(e,t){return!(!s.isObj(e)||!s.isObj(t))&&(s.getLength(e)==s.getLength(t)&&s.CompareObj(e,t,!0))},s.CompareObj=function(e,t,r){for(var n in e){if(!r)break;if(!t.hasOwnProperty(n)){r=!1;break}if(s.isArray(e[n])){if(!s.isArray(t[n])){r=!1;break}var i=e[n],o=t[n];if(i.length!=o.length){r=!1;break}for(var a in i){if(!r)break;r=s.CompareObj(i[a],o[a],r)}}else if(t[n]!=e[n]){r=!1;break}}return r},s}(),x=function(){function r(){}return r.setCache=function(e,t){r.CacheMap.set(e,t)},r.getCache=function(e){return r.CacheMap.get(e)},r.CacheMap=new Map,r}(),T=function(){function e(){}return e.forRoot=function(){return{ngModule:e,providers:[r.SessionService,v,o,S,b,C,D]}},e.decorators=[{type:i.NgModule,args:[{imports:[n.CommonModule],declarations:[],exports:[]}]}],e}(),j=function(){function e(){this._isDragging=!1,this._itemType="",this._removeOnDrop=!1,this.dropEndSource=new d.Subject}return e.prototype.setDraggingState=function(e){this._isDragging=e},e.prototype.getDraggingState=function(){return this._isDragging},e.prototype.setItemType=function(e){this._itemType=e.toLowerCase()},e.prototype.getItemType=function(){return this._itemType},e.prototype.setDropCallback=function(e){this._dropCallback=e},e.prototype.getDropCallback=function(){return this._dropCallback},e.prototype.setDropEffect=function(e){this._dropEffect=e},e.prototype.getDropEffect=function(){return this._dropEffect},e.prototype.setEffectAllowed=function(e){this._effectAllowed=e},e.prototype.getEffectAllowed=function(){return this._effectAllowed},e.prototype.setRemoveOnDrop=function(e){this._removeOnDrop=e},e.prototype.getRemoveOnDrop=function(){return this._removeOnDrop},e.decorators=[{type:i.Injectable}],e.ctorParameters=function(){return[]},e}(),P="application/x-dnd",k="application/json",H="Text",q=["move","copy","link"],N=function(){function e(e,t,r){this._dndService=e,this._renderer=t,this.dndType="",this.dndDragstart=new i.EventEmitter,this.dndDragend=new i.EventEmitter,this.dndSelected=new i.EventEmitter,this.dndMoved=new i.EventEmitter,this.dndCopied=new i.EventEmitter,this.dndLinked=new i.EventEmitter,this.dndCanceled=new i.EventEmitter,r&&(this._nativeElement=r.nativeElement)}return Object.defineProperty(e.prototype,"draggable",{get:function(){return!this.dndDisable},enumerable:!0,configurable:!0}),e.prototype.ngOnInit=function(){},e.prototype.onDragStart=function(e){var t=this;if(e=e.originalEvent||e,!this.draggable)return!0;this._dndService.setDraggingState(!0),this._dndService.setItemType(this.dndType);var r=P+(this._dndService.getItemType()?"-"+this._dndService.getItemType():"");this._dndService.setDropEffect("none"),this._dndService.setEffectAllowed(this.dndEffectAllowed||q[0]),e.dataTransfer.effectAllowed=this._dndService.getEffectAllowed();try{e.dataTransfer.setData(r,JSON.stringify(this.dndDraggable))}catch(o){var n={item:this.dndDraggable,type:this._dndService.getItemType()};try{e.dataTransfer.setData(k,JSON.stringify(n))}catch(o){e.dataTransfer.effectAllowed="move",e.dataTransfer.setData(H,JSON.stringify(n))}}if(this._renderer.addClass(this._nativeElement,"dndDragging"),setTimeout(function(){return t._renderer.addClass(t._nativeElement,"dndDraggingSource")},0),e._dndHandle&&e.dataTransfer.setDragImage&&e.dataTransfer.setDragImage(this._nativeElement,0,0),this.dndDragstart.emit(e),this.dndCallback){var i=this.dndCallback;this._dndService.setDropCallback(function(e){return i(e)})}e.stopPropagation()},e.prototype.onDragEnd=function(e){var t=this,r=this._dndService.getDropEffect();this[{copy:"dndCopied",link:"dndLinked",move:"dndMoved",none:"dndCanceled"}[r]].emit(e),this.dndDragend.emit({event:e,dropEffect:r}),this._dndService.setDraggingState(!1),this._dndService.setDropCallback(undefined),this._dndService.setRemoveOnDrop(!1),this._renderer.removeClass(this._nativeElement,"dndDragging"),this._renderer.removeClass(this._nativeElement,"dndDraggingSource"),e.stopPropagation(),setTimeout(function(){return t._renderer.removeClass(t._nativeElement,"dndDraggingSource")},0)},e.prototype.click=function(e){this.dndSelected.emit(e),e.stopPropagation()},e.decorators=[{type:i.Directive,args:[{selector:"[dndDraggable]"}]}],e.ctorParameters=function(){return[{type:j},{type:i.Renderer2},{type:i.ElementRef}]},e.propDecorators={dndDraggable:[{type:i.Input}],dndDisable:[{type:i.Input}],dndType:[{type:i.Input}],dndCallback:[{type:i.Input}],dndEffectAllowed:[{type:i.Input}],dndDragstart:[{type:i.Output}],dndDragend:[{type:i.Output}],dndSelected:[{type:i.Output}],dndMoved:[{type:i.Output}],dndCopied:[{type:i.Output}],dndLinked:[{type:i.Output}],dndCanceled:[{type:i.Output}],draggable:[{type:i.HostBinding,args:["draggable"]}],onDragStart:[{type:i.HostListener,args:["dragstart",["$event"]]}],onDragEnd:[{type:i.HostListener,args:["dragend",["$event"]]}],click:[{type:i.HostListener,args:["click",["$event"]]}]},e}(),F=function(){function e(e,t,r){this._el=e,this._renderer=t,this._dndService=r,this.dndDisable=!1,this.dndListChange=new i.EventEmitter,this.dndDragover=new i.EventEmitter,this.dndDrop=new i.EventEmitter,this.dndInserted=new i.EventEmitter,this._listSettings={},this._dragOverStopped=!1,this._counter=0,this._nativeElement=this._el.nativeElement}return e.prototype.ngOnInit=function(){var e=this._getPlaceholderElement();e.remove(),this._placeholderNode=e,this._listNode=this._nativeElement},e.prototype.onDragEnter=function(e){this._counter++,this._dragOverStopped=!1,e=e.originalEvent||e,this._listSettings={allowedTypes:Array.isArray(this.dndAllowedTypes)&&this.dndAllowedTypes.join("|").toLowerCase().split("|"),disabled:this.dndDisable,externalSources:this.dndExternalSources,horizontal:this.dndHorizontalList};var t=this._getMimeType(e.dataTransfer.types);if(!t||!this._isDropAllowed(this._getItemType(t)))return!0;e.preventDefault()},e.prototype.onDragOver=function(e){e=e.originalEvent||e;var t=this._getMimeType(e.dataTransfer.types),r=this._getItemType(t);if(!t||!this._isDropAllowed(r))return!0;if(this._placeholderNode.parentNode!==this._listNode&&this._renderer.appendChild(this._nativeElement,this._placeholderNode),e.target!==this._listNode){for(var n=e.target;n.parentNode!==this._listNode&&n.parentNode;)n=n.parentNode;if(n.parentNode===this._listNode&&n!==this._placeholderNode){var i=n.getBoundingClientRect(),o=void 0;o=this._listSettings.horizontal?e.clientX<i.left+i.width/2:e.clientY<i.top+i.height/2,this._listNode.insertBefore(this._placeholderNode,o?n:n.nextSibling)}}var a=t===H,s=this._getDropEffect(e,a);return"none"===s?this._stopDragover():(this.dndDragover.emit(this._getEventResponse(e,s,r)),this._dragOverStopped?this._stopDragover():(e.preventDefault(),a||(e.dataTransfer.dropEffect=s),this._renderer.addClass(this._nativeElement,"dndDragover"),e.stopPropagation(),!1))},e.prototype.onDrop=function(e){this._counter=0,e=e.originalEvent||e;var t,r=this._getMimeType(e.dataTransfer.types),n=this._getItemType(r);if(!r||!this._isDropAllowed(n))return!0;e.preventDefault();try{t=JSON.parse(e.dataTransfer.getData(r))}catch(c){return this._stopDragover()}if((r===H||r===k)&&(n=t.type||undefined,t=t.item,!this._isDropAllowed(n)))return this._stopDragover();var i=r===H,o=this._getDropEffect(e,i);if("none"===o)return this._stopDragover();var a=this._getPlaceholderIndex();if(this.dndDrop.emit(this._getEventResponse(e,o,n,a,t)),this._dragOverStopped)return this._stopDragover();if(this._dndService.setDropEffect(o),i||(e.dataTransfer.dropEffect=o),this.dndList){var s=u(this.dndList.slice(0,a),[t],this.dndList.slice(a));this.dndListChange.emit(s)}return this._dndService.setRemoveOnDrop(!0),this.dndInserted.emit(this._getEventResponse(e,o,n,a,t)),this._stopDragover(),e.stopPropagation(),!1},e.prototype.onDragLeave=function(e){this._counter--,e=e.originalEvent||e,0!==this._counter?e._dndPhShown=!0:this._stopDragover()},e.prototype.onmouseout=function(e){this._dndService.getDraggingState()&&this._stopDragover()},e.prototype._stopDrag=function(){this._dragOverStopped=!0},e.prototype._stopDragover=function(){return this._placeholderNode.remove(),this._renderer.removeClass(this._nativeElement,"dndDragover"),!0},e.prototype._getEventResponse=function(e,t,r,n,i){return{callback:this._dndService.getDropCallback(),dropEffect:t,event:e,external:!this._dndService.getDraggingState(),index:n!==undefined?n:this._getPlaceholderIndex(),item:i||undefined,stopDragover:this._stopDrag.bind(this),type:r}},e.prototype._getPlaceholderIndex=function(){return Array.prototype.indexOf.call(this._nativeElement.children,this._placeholderNode)},e.prototype._getPlaceholderElement=function(){var e=[].slice.call(this._nativeElement.children).filter(function(e){return-1<e.className.indexOf("dndPlaceholder")});return e.length||(e=this._renderer.createElement("li"),this._renderer.addClass(e,"dndPlaceholder")),e},e.prototype._getMimeType=function(e){if(!e)return H;for(var t=0;t<e.length;t++)if(e[t]===H||e[t]===k||e[t].substr(0,P.length)===P)return e[t];return null},e.prototype._getItemType=function(e){return this._dndService.getDraggingState()?this._dndService.getItemType()||undefined:e===H||e===k?null:e&&e.substr(P.length+1)||undefined},e.prototype._isDropAllowed=function(e){return!this._listSettings.disabled&&(!(!this._listSettings.externalSources&&!this._dndService.getDraggingState())&&(!this._listSettings.allowedTypes||null===e||e&&-1!==this._listSettings.allowedTypes.indexOf(e)))},e.prototype._getDropEffect=function(e,t){var r=q;return t||(r=this._filterEffects(r,e.dataTransfer.effectAllowed)),this._dndService.getDraggingState()&&(r=this._filterEffects(r,this._dndService.getEffectAllowed())),this.dndEffectAllowed&&(r=this._filterEffects(r,this.dndEffectAllowed)),r.length?e.ctrlKey&&-1!==r.indexOf("copy")?"copy":e.altKey&&-1!==r.indexOf("link")?"link":r[0]:"none"},e.prototype._filterEffects=function(e,t){return"all"===t?e:e.filter(function(e){return-1!==t.toLowerCase().indexOf(e)})},e.decorators=[{type:i.Directive,args:[{selector:"[dndList]"}]}],e.ctorParameters=function(){return[{type:i.ElementRef},{type:i.Renderer2},{type:j}]},e.propDecorators={dndDisable:[{type:i.Input}],dndAllowedTypes:[{type:i.Input}],dndExternalSources:[{type:i.Input}],dndHorizontalList:[{type:i.Input}],dndEffectAllowed:[{type:i.Input}],pureComponent:[{type:i.Input}],dndList:[{type:i.Input}],dndListChange:[{type:i.Output}],dndDragover:[{type:i.Output}],dndDrop:[{type:i.Output}],dndInserted:[{type:i.Output}],onDragEnter:[{type:i.HostListener,args:["dragenter",["$event"]]}],onDragOver:[{type:i.HostListener,args:["dragover",["$event"]]}],onDrop:[{type:i.HostListener,args:["drop",["$event"]]}],onDragLeave:[{type:i.HostListener,args:["dragleave",["$event"]]}],onmouseout:[{type:i.HostListener,args:["mouseleave",["$event"]]}]},e}(),M=function(){function e(){}return e.prototype.ngOnInit=function(){},Object.defineProperty(e.prototype,"draggable",{get:function(){return!0},enumerable:!0,configurable:!0}),e.prototype.onDragStart=function(e){(e=e.originalEvent||e)._dndHandle||(e.dataTransfer.types&&e.dataTransfer.types.length||e.preventDefault(),e.stopPropagation())},e.prototype.onDragEnd=function(e){(e=e.originalEvent||e)._dndHandle||e.stopPropagation()},e.decorators=[{type:i.Directive,args:[{selector:"[dndNodrag]"}]}],e.ctorParameters=function(){return[]},e.propDecorators={draggable:[{type:i.HostBinding,args:["draggable"]}],onDragStart:[{type:i.HostListener,args:["dragstart",["$event"]]}],onDragEnd:[{type:i.HostListener,args:["dragend",["$event"]]}]},e}(),A=function(){function e(){}return e.prototype.ngOnInit=function(){},Object.defineProperty(e.prototype,"draggable",{get:function(){return!0},enumerable:!0,configurable:!0}),e.prototype.onDragStart=function(e){(e=e.originalEvent||e)._dndHandle=!0},e.decorators=[{type:i.Directive,args:[{selector:"[dndHandle]"}]}],e.ctorParameters=function(){return[]},e.propDecorators={draggable:[{type:i.HostBinding,args:["draggable"]}],onDragStart:[{type:i.HostListener,args:["dragstart dragend",["$event"]]}]},e}(),U=[N,F,M,A],R=function(){function e(){}return e.decorators=[{type:i.NgModule,args:[{imports:[n.CommonModule],declarations:U,providers:[j],exports:U}]}],e}();e.RestfulService=o,e.SchemaManagerService=v,e.LcpService=S,e.IntegrationPrintService=I,e.ParasMappingManagerService=b,e.PrintIntegrationManagerService=D,e.JointSearchManagerService=C,e.DataRenderExtendService=w,e.JointSearchExtendService=_,e.SchemaRenderExtendService=g,e.FilterManagerService=O,e.EventBus=L,e.JSONUtils=E,e.QDPCacheUtil=x,e.RtfServices=y,e.Server_Host=l,e.Load_Data_Uri=h,e.Load_Data_Col=f,e.QdpCommonModule=T,e.DndListModule=R,e.DndDraggableDirective=N,e.DndHandleDirective=A,e.DndListDirective=F,e.DndNodragDirective=M,e.ɵa=N,e.ɵe=A,e.ɵc=F,e.ɵd=M,e.ɵb=j,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=qdp-common.umd.min.js.map