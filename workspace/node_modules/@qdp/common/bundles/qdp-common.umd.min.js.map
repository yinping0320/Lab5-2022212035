{"version":3,"sources":["ng://@qdp/common/lib/service/restful-service/restful.service.ts","node_modules/tslib/tslib.es6.js","ng://@qdp/common/lib/entitties/server.host.ts","ng://@qdp/common/lib/service/extend-service/schema-renderextend.service.ts","ng://@qdp/common/lib/service/rtfservices/rtfservices.ts","ng://@qdp/common/lib/service/schema-manager/schema-manager.service.ts","ng://@qdp/common/lib/service/lcp-service/lcp.service.ts","ng://@qdp/common/lib/service/print-service/print.service.ts","ng://@qdp/common/lib/service/paras-mapping/paras-mappingmanager.service.ts","ng://@qdp/common/lib/service/print-integration/print-integrationmanager.service.ts","ng://@qdp/common/lib/service/joint-search/joint-searchmanager.service.ts","ng://@qdp/common/lib/service/extend-service/data-renderextend.service.ts","ng://@qdp/common/lib/service/extend-service/joint-searchextend.service.ts","ng://@qdp/common/lib/service/filter/filtermanager.service.ts","ng://@qdp/common/lib/service/eventbus/eventbus.ts","ng://@qdp/common/lib/service/utils/json.util.ts","ng://@qdp/common/lib/service/utils/qdp.cache.util.ts","ng://@qdp/common/lib/common.module.ts","ng://@qdp/common/lib/dnd-list/services/dnd-draggable.service.ts","ng://@qdp/common/lib/dnd-list/dnd-constants.ts","ng://@qdp/common/lib/dnd-list/directives/dnd-draggable.directive.ts","ng://@qdp/common/lib/dnd-list/directives/dnd-list.directive.ts","ng://@qdp/common/lib/dnd-list/directives/dnd-nodrag.directive.ts","ng://@qdp/common/lib/dnd-list/directives/dnd-handle.directive.ts","ng://@qdp/common/lib/dnd-list/dnd-list.module.ts"],"names":["RestfulService","httpClient","this","prototype","get","uri","params","options","request","put","body","optionsWithBody","addBody","post","delete","method","httpParams","buildParams","methodName","parameters","key","hasOwnProperty","value","toString","Object","assign","Injectable","HttpClient","__values","o","m","Symbol","iterator","i","call","next","length","done","__read","n","r","e","ar","push","error","__spread","arguments","concat","Server_Host","Load_Data_Uri","Load_Data_Col","SchemaRenderExtendService","args","providedIn","RtfServices","createHeaderSessionId","sessionService","headers","Content-Type","gspframeworkService","rtf","session","getFormToken","getCurrentSeesionId","getUserSessionId","localStorage","getItem","getSessionId","sessionId","getTabId","queryId","tab","getCommonVariable","extendMethod","getExtObj","iGIXFrmUUID","uuid","tabId","getInSuiteFrmUUID","getMenuParameter","funcId","func","param_1","getMenuParams","res","getMenuSwitchControlParameter","menuSwitchControl","Subject","changeEnable","getMenuSwitchControlEvent","frmEvent","param_2","option","eventListener","getFuncId","getNewPageIdFunc","getFuncName","tabs","getAll","find","x","id","getActiveTab","FuncName","getFuncIdOlde","appType","toLowerCase","newPageIdApp","appId","appEntrance","newPageIdFunc","newPageId","mergeAppId","isInSuite","SchemaManagerService","restService","host","schemaRenderExtendService","schemaInfoChange","colList","controlType","schemaInfo","schemaid","operationChange","dynamicCols","customSchema","dynamicColIndex","preSchema","schemaName","isPrefab","isDefault","isProtected","schemaValue","titleOption","title","subTitles","columnOption","maxLevel","styleOption","Title","fontFamily","size","fontWeight","fontStyle","textDecoration","fontColor","rowHeight","SubTitle","Header","DataArea","Footer","otherOption","showFilterRow","dataCahce","level","isDetails","loadDataType","pageSize","treeInfoType","pathField","pathStep","idField","parentField","firstLoad","showZero","expand","showHeaderSort","isDefaultSchema","operations","self","getOperation","subscribe","getSpreadTemplate","queryRelativeUrl","scheme","frozenCols","groupType","schema","schemaList","colInfo","analysis","getSchema","organizationId","fromCache","of","getSchemaListByGroupType","getSchemaList","pipe","map","defaultSchemaId","getDefaultSchema","_this","userId","restUri","getSchemas","data","forEach","element","JSON","parse","operateDynamicColsForSchema","schemaExtendId","schemaInfoRenderBefore","$event","filterCondition","schemaType","filter","stringify","operateCustomSchema","mergeCustomSchema","console","log","saveSchema","schemaObj","switchMap","orgId","deleteSchema","param","operators","validateOperation","type","setColInfo","schemaId","dynamicColumns","dyCols","createColumns","columns","columnList","apply","index","col","c","getColumn","recursiveCompareColumn","splice","result","item","recursiveGetColumn","parentColumn","childList","firstChildList","secondChildList","bindField","SessionService","Inject","decorators","Optional","LcpService","restfulService","serverHost","loadDataUri","loadDataCol","pageInfoChange","variablesChange","inSuiteDropDownInfoChange","exportData","config","responseType","fileName","excelExportName","Param","toPromise","then","returnValue","byteString","atob","arrayBuffer","ArrayBuffer","intArray","Uint8Array","charCodeAt","blob","Blob","document","createElement","elink","download","style","display","href","URL","createObjectURL","appendChild","click","revokeObjectURL","removeChild","navigator","msSaveBlob","loading","close","formErrorService","exception","Message","aysnExportData","async","pdfExportEvent","printPreView","OutputType","PRINT","FileType","Pdf","Path","DeviceId","printType","PrintType","Query","printJob","printerName","printSetting","cloudprintService","openRendedViewer","getData","pageInfo","variables","dropDownOption","inSuiteDropDownInfo","getCol","getCrosstabTemplate","undefined","getSpreadLicense","spreadjs","clearCache","IntegrationPrintService","_printService","printService","printSingle","beMetaId","bizBillId","printArray","printByIds","ids","dataIds","split","printByIdsWithDimension","dim1","dim2","billCategoryId","printWithDimensionCustomDataSource","queryType","queryServiceId","queryParam","sourceOptions","buildSourceOptions","sourceId","outputOptions","buildOutputOptions","FirstDimensionVal","SecondDimensionVal","outputBEData","DataIds","SourceId","RetrieveParam","retrieveParam","FormatId","formatId","ServiceUnit","serviceUnit","currentPage","pageRowCount","bizTypeId","outputType","fileType","Html5","path","deviceId","Form","ParasMappingManagerService","parasmappingInfoChange","parasmappingInfoList","getParasMapping","getParasMappingList","datasourceId","languageType","parasmapping","datasourceid","parasInfoList","saveParasMapping","keys","indexOf","deleteParasMapping","getMetaDataInfoById","Id","PrintIntegrationManagerService","printIntegrationInfoChange","printIntegrationInfoList","getPrintIntegration","getPrintIntegrationList","printintegration","savePrintIntegration","integration","deletePrintIntegration","JointSearchManagerService","localUri","lcpUri","jointsearchInfoChange","jointsearchInfoList","getjointsearch","formId","getjointsearchList","getVisibleJoint","visibleJointParam","searchList","jointUri","jointSearchList","search","d","visible","searchList_2","tslib_1.__values","searchList_2_1","searchList_1","searchList_1_1","savejointsearch","jointsearch","FormId","deletejointsearch","getLanguageList","infoType","DataRenderExtendService","JointSearchExtendService","FilterManagerService","filterInfoChange","isFilterQDP","filterInfoList","getFilter","getFilterList","queryid","saveFilter","deleteFilter","EventBus","register","eventType","handler","eventId","handlers","guid","dispatch","S4","Math","random","substring","JSONUtils","isObj","object","isArray","constructor","Array","getLength","count","Compare","objA","objB","CompareObj","flag","oA","oB","k","QDPCacheUtil","setCache","CacheMap","set","getCache","Map","QdpCommonModule","forRoot","ngModule","providers","NgModule","imports","CommonModule","declarations","exports","DndDraggableService","_isDragging","_itemType","_removeOnDrop","dropEndSource","setDraggingState","state","getDraggingState","setItemType","getItemType","setDropCallback","_dropCallback","getDropCallback","setDropEffect","dropEffect","_dropEffect","getDropEffect","setEffectAllowed","effectAllowed","_effectAllowed","getEffectAllowed","setRemoveOnDrop","getRemoveOnDrop","MIME_TYPE","EDGE_MIME_TYPE","MSIE_MIME_TYPE","ALL_EFFECTS","DndDraggableDirective","_dndService","_renderer","_hostElement","dndType","dndDragstart","EventEmitter","dndDragend","dndSelected","dndMoved","dndCopied","dndLinked","dndCanceled","_nativeElement","nativeElement","defineProperty","dndDisable","ngOnInit","onDragStart","event","originalEvent","draggable","mimeType","dndEffectAllowed","dataTransfer","setData","dndDraggable","addClass","setTimeout","_dndHandle","setDragImage","emit","dndCallback","callback_1","stopPropagation","onDragEnd","copy","link","move","none","removeClass","Directive","selector","Renderer2","ElementRef","Input","Output","HostBinding","HostListener","DndListDirective","_el","dndListChange","dndDragover","dndDrop","dndInserted","_listSettings","_dragOverStopped","_counter","placeholder","_getPlaceholderElement","remove","_placeholderNode","_listNode","onDragEnter","allowedTypes","dndAllowedTypes","join","disabled","externalSources","dndExternalSources","horizontal","dndHorizontalList","_getMimeType","types","_isDropAllowed","_getItemType","preventDefault","onDragOver","itemType","parentNode","target","listItemNode","rect","getBoundingClientRect","isFirstHalf","clientX","left","width","clientY","top","height","insertBefore","nextSibling","ignoreDataTransfer","_getDropEffect","_stopDragover","_getEventResponse","onDrop","_getPlaceholderIndex","dndList","newList","slice","onDragLeave","_dndPhShown","onmouseout","_stopDrag","callback","external","stopDragover","bind","children","childNode","className","substr","effects","_filterEffects","ctrlKey","altKey","effect","DndNodragDirective","DndHandleDirective","DndListModule"],"mappings":"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","sourcesContent":["import { Injectable } from '@angular/core';\r\nimport { HttpClient, HttpParams } from '@angular/common/http';\r\nimport { Observable } from 'rxjs';\r\n\r\nexport type RestfulMethod = 'GET' | 'PUT' | 'POST' | 'DELETE';\r\n\r\n@Injectable()\r\nexport class RestfulService {\r\n  /**\r\n   * \r\n   * @param httpClient http\r\n   */\r\n  constructor(private httpClient: HttpClient) { }\r\n  /**\r\n   * GET\r\n   * @param uri \r\n   * @param params \r\n   */\r\n  get(uri: string, params?: object, options?: any): Observable<any[]> {\r\n    return this.request(uri, 'GET', params, options);\r\n  }\r\n\r\n  /**\r\n   * POST\r\n   * @param uri \r\n   * @param params \r\n   */\r\n  put(uri: string, body: any, params?: object, options?: any): Observable<any> {\r\n    const optionsWithBody = this.addBody(options, body);\r\n    return this.request(uri, 'PUT', params, optionsWithBody);\r\n  }\r\n\r\n  /**\r\n   * PUT\r\n   * @param uri \r\n   * @param params \r\n   */\r\n  post(uri: string, body: any, params?: object, options?: any): Observable<any> {\r\n    const optionsWithBody = this.addBody(options, body);\r\n    return this.request(uri, 'POST', params, optionsWithBody);\r\n  }\r\n\r\n  /**\r\n   * DELETE\r\n   * @param uri \r\n   * @param params \r\n   */\r\n  delete(uri: string, params?: object, options?: any): Observable<any> {\r\n    return this.request(uri, 'DELETE', params, options);\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param uri \r\n   * @param params \r\n   */\r\n  private request(uri: string, method: any, params: object, options: any = {}): Observable<any> {\r\n    options = options || {};\r\n    if (params) {\r\n      const httpParams = this.buildParams(params);\r\n      options.params = httpParams;\r\n    }\r\n    const methodName = method as string;\r\n    const result = this.httpClient.request(methodName, uri, options);\r\n    return result;\r\n  }\r\n\r\n  /**\r\n   * Http\r\n   * @param params \r\n   */\r\n  private buildParams(params: object): HttpParams {\r\n    const parameters: any = {};\r\n    for (const key in params) {\r\n      if (params.hasOwnProperty(key) && params[key]) {\r\n        const value = params[key].toString();\r\n        parameters[key] = value;\r\n      }\r\n    }\r\n    return parameters;\r\n  }\r\n\r\n  private addBody(options: any, body: any) {\r\n    options = options || {};\r\n    const mergedOptions = Object.assign(options, { body });\r\n    return mergedOptions;\r\n  }\r\n}\r\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) if (e.indexOf(p[i]) < 0)\r\n            t[p[i]] = s[p[i]];\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n    if (m) return m.call(o);\r\n    return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n","export const Server_Host = 'serverHost';\r\nexport const Load_Data_Uri = 'loadDataUri';\r\nexport const Load_Data_Col = 'loadDataCol';\r\n","import { Injectable } from '@angular/core';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport abstract class SchemaRenderExtendService  {\r\n  // \r\n  abstract schemaInfoRenderBefore($event: any);\r\n}\r\n","import { Subject } from \"rxjs\";\r\n\r\ndeclare var gspframeworkService: any;\r\n\r\nexport class RtfServices {\r\n  static uuid = \"\";\r\n  static isInSuite = false;\r\n\r\n  static createHeaderSessionId(sessionService?: any) {\r\n    const options = {\r\n      headers: {\r\n        'Content-Type': 'application/json'\r\n      }\r\n    };\r\n    try {\r\n      if (gspframeworkService && gspframeworkService.rtf && gspframeworkService.rtf.session && gspframeworkService.rtf.session.getFormToken()) {\r\n        options.headers['X-CAF-Runtime-CommonVariable'] = gspframeworkService.rtf.session.getFormToken();\r\n      } else if (sessionService && sessionService.getCurrentSeesionId()) {\r\n        options.headers['X-CAF-Runtime-CommonVariable'] = sessionService.getCurrentSeesionId();\r\n      } else if (sessionService && sessionService.getUserSessionId()) {\r\n        options.headers['SessionId'] = sessionService.getUserSessionId();\r\n      } else if (localStorage.getItem('sessionId')) {\r\n        options.headers['SessionId'] = localStorage.getItem('sessionId');\r\n      }\r\n    } catch (e) { }\r\n    return options;\r\n  }\r\n\r\n  static getSessionId(sessionService?: any) {\r\n    let sessionId;\r\n    try {\r\n      if (gspframeworkService && gspframeworkService.rtf && gspframeworkService.rtf.session && gspframeworkService.rtf.session.getFormToken()) {\r\n        sessionId = gspframeworkService.rtf.session.getFormToken();\r\n      } else if (sessionService && sessionService.getCurrentSeesionId()) {\r\n        sessionId = sessionService.getCurrentSeesionId();\r\n      } else if (sessionService && sessionService.getUserSessionId()) {\r\n        sessionId = sessionService.getUserSessionId();\r\n      } else if (localStorage.getItem('sessionId')) {\r\n        sessionId = localStorage.getItem('sessionId');\r\n      }\r\n    } catch (e) { }\r\n    return sessionId;\r\n  }\r\n\r\n  static getTabId(queryId?: any) {\r\n    try {\r\n\r\n      if (gspframeworkService && gspframeworkService.rtf && gspframeworkService.rtf.session) {\r\n        const tab = gspframeworkService.rtf.session.getCommonVariable();\r\n        if (gspframeworkService.rtf.extendMethod && gspframeworkService.rtf.extendMethod.getExtObj && gspframeworkService.rtf.extendMethod.getExtObj() && gspframeworkService.rtf.extendMethod.getExtObj().iGIXFrmUUID) {\r\n          const uuid = gspframeworkService.rtf.extendMethod.getExtObj().iGIXFrmUUID() ? gspframeworkService.rtf.extendMethod.getExtObj().iGIXFrmUUID() : '';\r\n          return tab.tabId + uuid;\r\n        } else {\r\n          return tab.tabId;\r\n        }\r\n      }\r\n    } catch (e) {\r\n      return queryId;\r\n    }\r\n  }\r\n\r\n  static getInSuiteFrmUUID() {\r\n    try {\r\n      if (gspframeworkService.rtf.extendMethod && gspframeworkService.rtf.extendMethod.getExtObj && gspframeworkService.rtf.extendMethod.getExtObj() && gspframeworkService.rtf.extendMethod.getExtObj().iGIXFrmUUID) {\r\n        const uuid = gspframeworkService.rtf.extendMethod.getExtObj().iGIXFrmUUID() ? gspframeworkService.rtf.extendMethod.getExtObj().iGIXFrmUUID() : '';\r\n        return uuid;\r\n      } else {\r\n        return \"\";\r\n      }\r\n    } catch (e) {\r\n      return \"\";\r\n    }\r\n  }\r\n\r\n  static getCommonVariable() {\r\n    try {\r\n      if (gspframeworkService && gspframeworkService.rtf && gspframeworkService.rtf.session) {\r\n        const tab = gspframeworkService.rtf.session.getCommonVariable();\r\n        return tab;\r\n      }\r\n    } catch (e) {\r\n      return null;\r\n    }\r\n  }\r\n\r\n  static getMenuParameter(key: string) {\r\n    try {\r\n      const funcId = RtfServices.getCommonVariable().funcId;\r\n      if (gspframeworkService && gspframeworkService.rtf && gspframeworkService.rtf.func) {\r\n        let param: Map<any, any> = null;\r\n        const callback = function (res) {\r\n          // res \r\n          param = res;\r\n        }\r\n        gspframeworkService.rtf.func.getMenuParams(funcId, callback);\r\n        if (param) {\r\n          return param.get(key);\r\n        }\r\n      }\r\n      return null;\r\n    } catch (e) {\r\n      return null;\r\n    }\r\n  }\r\n\r\n  static getMenuSwitchControlParameter(tabId: any) {\r\n    return {\r\n      menuSwitchControl: {\r\n        key: tabId,\r\n        value: new Subject<any>(),\r\n        changeEnable: false\r\n      }\r\n    }\r\n  }\r\n\r\n  static getMenuSwitchControlEvent() {\r\n    try {\r\n      const tabId = RtfServices.getTabId();\r\n      if (gspframeworkService && gspframeworkService.rtf && gspframeworkService.rtf.frmEvent) {\r\n        let param = null;\r\n        const option = RtfServices.getCommonVariable();\r\n        const callback = function (res) {\r\n          // res \r\n          param = res;\r\n        }\r\n        gspframeworkService.rtf.frmEvent.eventListener(tabId, callback, option);\r\n        if (param && param.hasOwnProperty('menuSwitchControl') && param['menuSwitchControl'].key === tabId) {\r\n          return param['menuSwitchControl'].value;\r\n        }\r\n        return null;\r\n      }\r\n    } catch (e) {\r\n      return null;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * ID\r\n   * @param option `{appId'ID', appEntrance: '', appType: 'app, menu', funcId: 'ID', tabId: 'ID'}`\r\n   */\r\n  static getFuncId(option: any) {\r\n    return RtfServices.getNewPageIdFunc(option);\r\n  }\r\n\r\n  static getFuncName() {\r\n    try {\r\n      if (gspframeworkService && gspframeworkService.rtf && gspframeworkService.rtf.tabs) {\r\n        const func = gspframeworkService.rtf.tabs.getAll().find(x => x.id == gspframeworkService.rtf.tabs.getActiveTab().funcId);\r\n        return func.FuncName;\r\n      } else {\r\n        return '';\r\n      }\r\n    } catch (e) {\r\n      return '';\r\n    }\r\n  }\r\n\r\n  private static getFuncIdOlde(option: any) {\r\n    let funcId;\r\n    if (option.appType.toLowerCase() === 'app') {\r\n      funcId = RtfServices.newPageIdApp(option.appId, option.appEntrance, option.tabId);\r\n    } else {\r\n      funcId = RtfServices.newPageIdFunc(option.funcId, option.tabId);\r\n    }\r\n    return funcId;\r\n  }\r\n\r\n  private static getNewPageIdFunc(option: any) {\r\n    try {\r\n      if (gspframeworkService && gspframeworkService.rtf && gspframeworkService.rtf.func) {\r\n        return gspframeworkService.rtf.func.newPageId(option);\r\n      } else {\r\n        return RtfServices.getFuncIdOlde(option);\r\n      }\r\n    } catch (e) {\r\n      return RtfServices.getFuncIdOlde(option);\r\n    }\r\n  }\r\n\r\n  private static newPageIdFunc(funcId, tabId) {\r\n    return tabId ? `${funcId}_${tabId}` : funcId;\r\n  }\r\n\r\n  private static mergeAppId(appId: any, appEntrance: any) {\r\n    return `${appId}_${appEntrance}`;\r\n  }\r\n\r\n  private static newPageIdApp(appId: any, appEntrance: any, tabId: any) {\r\n    return tabId ? `${RtfServices.mergeAppId(appId, appEntrance)}_${tabId}` : RtfServices.mergeAppId(appId, appEntrance);\r\n  }\r\n}\r\n","// import 'rxjs/add/operator/map';\r\nimport { Injectable, Inject, Optional } from '@angular/core';\r\nimport { Observable, Subject, of } from 'rxjs';\r\nimport { switchMap, map } from 'rxjs/operators';\r\nimport { filter } from 'lodash-es';\r\nimport { SessionService } from '@ecp-caf/caf-common';\r\nimport { RestfulService } from '../restful-service/restful.service';\r\nimport { Server_Host } from '../../entitties/server.host';\r\nimport { SchemaRenderExtendService } from '../extend-service/schema-renderextend.service';\r\nimport { RtfServices } from '../rtfservices/rtfservices';\r\n\r\n@Injectable()\r\nexport class SchemaManagerService {\r\n  private uri = '/api/runtime/bcc/v1.0/qdpschemamanager/';\r\n  schemaInfoChange = new Subject<any>();\r\n  colList = new Subject<any>();\r\n  controlType = new Subject<string>();\r\n  schemaInfo: any = {};\r\n  schemaid: any = {} = new Subject<any>();\r\n  operationChange = new Subject<any>();\r\n  dynamicCols: any = {};\r\n  customSchema: any = {};\r\n  dynamicColIndex = 0;\r\n\r\n  preSchema = {\r\n    id: 'prefab',\r\n    schemaName: '',\r\n    isPrefab: 1,\r\n    isDefault: 0,\r\n    isProtected: '0',\r\n    schemaValue: {\r\n      titleOption: {\r\n        title: '',\r\n        subTitles: []\r\n      },\r\n      columnOption: {\r\n        maxLevel: 0,\r\n        colList: []\r\n      },\r\n      styleOption: {\r\n        Title: {\r\n          fontFamily: 9,\r\n          size: 14,\r\n          fontWeight: 0,\r\n          fontStyle: 0,\r\n          textDecoration: 0,\r\n          fontColor: 'black',\r\n          rowHeight: 35\r\n        },\r\n        SubTitle: {\r\n          fontFamily: 9,\r\n          size: 14,\r\n          fontWeight: 0,\r\n          fontStyle: 0,\r\n          textDecoration: 0,\r\n          fontColor: 'black',\r\n          rowHeight: 35\r\n        },\r\n        Header: {\r\n          fontFamily: 9,\r\n          size: 14,\r\n          fontWeight: 0,\r\n          fontStyle: 0,\r\n          textDecoration: 0,\r\n          fontColor: 'black',\r\n          rowHeight: 35\r\n        },\r\n        DataArea: {\r\n          fontFamily: 9,\r\n          size: 14,\r\n          fontWeight: 0,\r\n          fontStyle: 0,\r\n          textDecoration: 0,\r\n          fontColor: 'black',\r\n          rowHeight: 35\r\n        },\r\n        Footer: {\r\n          fontFamily: 9,\r\n          size: 14,\r\n          fontWeight: 0,\r\n          fontStyle: 0,\r\n          textDecoration: 0,\r\n          fontColor: 'black',\r\n          rowHeight: 35\r\n        }\r\n      },\r\n      otherOption: {\r\n        showFilterRow: true,\r\n        dataCahce: true,\r\n        level: '',\r\n        isDetails: '',\r\n        loadDataType: 1,\r\n        pageSize: 20,\r\n        treeInfoType: 2,\r\n        pathField: '',\r\n        pathStep: 0,\r\n        idField: '',\r\n        parentField: '',\r\n        firstLoad: true,\r\n        showZero: true,\r\n        expand: true,\r\n        showHeaderSort: true\r\n      }\r\n    }\r\n  };\r\n\r\n  isDefaultSchema: any = [];\r\n\r\n  schemaList: any;\r\n\r\n  operations = {};\r\n\r\n  constructor(private restService: RestfulService, private sessionService: SessionService, @Inject(Server_Host) private host: string, @Optional() private schemaRenderExtendService: SchemaRenderExtendService) {\r\n    const self = this;\r\n    this.getOperation().subscribe((value: any) => {\r\n      if (value) {\r\n        self.operations['QdpQueryExport'] = value['05202284-dfc4-149c-853e-cfd35b4a02bb'];\r\n        self.operations['QdpQueryPrint'] = value['653fe24b-d77f-d8b0-71c5-5e3d561e33ca'];\r\n        self.operations['QdpModifyPublicSchema'] = value['d6832d96-e6f3-114e-1d53-f9e636548eb9'];\r\n        self.operations['QdpPubQuery'] = value['cd6c2057-5ad6-90dd-54ac-771c192563e8'];\r\n        self.operationChange.next(self.operations);\r\n      }\r\n      // console.log(value);\r\n    });\r\n  }\r\n\r\n  getSpreadTemplate(id: string, queryId: string, dynamicCols: any, queryRelativeUrl: any, scheme?: any, frozenCols?: any, groupType?: any): Observable<any> {\r\n    if (dynamicCols && dynamicCols.length) {\r\n      this.dynamicCols[groupType ? groupType : queryId] = dynamicCols;\r\n      this.dynamicCols[id] = dynamicCols;\r\n    }\r\n    let schema;\r\n    if (this.schemaList && this.schemaList[id]) {\r\n      schema = this.schemaList[id];\r\n    }\r\n    let colInfo: any = [];\r\n    // frozenCols\r\n    if (this.dynamicCols[groupType ? groupType : queryId]) {\r\n      colInfo = Object.assign(frozenCols, this.dynamicCols[groupType ? groupType : queryId]);\r\n    } else {\r\n      colInfo = frozenCols;\r\n    }\r\n    this.colList.next(colInfo);\r\n    return this.analysis((schema && schema.id ? schema.id : '1'), queryId, dynamicCols, queryRelativeUrl, scheme);\r\n  }\r\n  /**\r\n   * \r\n   * @param id ID\r\n   * @param queryId \r\n   */\r\n  getSchema(id: string, queryId: string, queryRelativeUrl: any, groupType?: any, organizationId?: any, fromCache?: any): Observable<any> {\r\n    const self = this;\r\n    if (this.schemaList && this.schemaList[id] && fromCache && fromCache === true) {\r\n      return of(this.schemaList[id]);\r\n    } else {\r\n      const result$ = groupType ? this.getSchemaListByGroupType(queryId, '', organizationId, groupType, queryRelativeUrl) : this.getSchemaList(queryId, '', organizationId, queryRelativeUrl);\r\n      return result$.pipe(\r\n        map(value => {\r\n          if (id === '1' || id === 'prefab') {\r\n            return Object.assign({}, self.preSchema, { id: '1' });\r\n          } else if (value && value['schemaList'] && value['schemaList'][queryId]) {\r\n            if (value['schemaList'][queryId][id]) {\r\n              return value['schemaList'][queryId][id];\r\n            } else {\r\n              let defaultSchemaId = '';\r\n              if (value.isDefaultSchema && value.isDefaultSchema.id && value['schemaList'][queryId][value.isDefaultSchema.id]) {\r\n                defaultSchemaId = value.isDefaultSchema.id;\r\n                return value['schemaList'][queryId][defaultSchemaId];\r\n              } else {\r\n                return null;\r\n              }\r\n            }\r\n          } else {\r\n            return null;\r\n          }\r\n        })\r\n      );\r\n    }\r\n  }\r\n  /**\r\n   * \r\n   */\r\n  getDefaultSchema(queryId: string, queryRelativeUrl: any, groupType?: any, organizationId?: any): Observable<any> {\r\n    const result$ = groupType ? this.getSchemaListByGroupType(queryId, '', organizationId, groupType, queryRelativeUrl) : this.getSchemaList(queryId, '', organizationId, queryRelativeUrl);\r\n    return result$.pipe(\r\n      map(() => {\r\n        if (this.isDefaultSchema[queryId] && this.isDefaultSchema[queryId].id) {\r\n          return this.isDefaultSchema[queryId];\r\n        } else {\r\n          return null;\r\n        }\r\n      })\r\n    );\r\n  }\r\n  /**\r\n   * \r\n   * @param queryId \r\n   * @param userId ID\r\n   * @param organizationId id\r\n   */\r\n  getSchemaList(queryId: string, userId: string, organizationId: string, queryRelativeUrl: any): Observable<any> {\r\n    const restUri = this.host + this.uri + 'getschemalist';\r\n    return this.getSchemas(restUri, queryRelativeUrl, { queryId, userId, organizationId });\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param queryId \r\n   * @param userId ID\r\n   * @param organizationId id\r\n   */\r\n  getSchemaListByGroupType(queryId: string, userId: string, organizationId: string, groupType: any, queryRelativeUrl: any): Observable<any> {\r\n    const restUri = this.host + this.uri + 'getschemalistbygroup';\r\n    return this.getSchemas(restUri, queryRelativeUrl, { queryId, userId, organizationId, groupType });\r\n  }\r\n\r\n  private getSchemas(uri: any, queryRelativeUrl: any, params: any) { // queryId: string, userId: string, organizationId: string, groupType: any, queryRelativeUrl: any, params: any\r\n    const self = this;\r\n    const result$ = self.restService.get(uri, params, self.createHeaderSessionId());\r\n    return result$.pipe(\r\n      map((data: any) => {\r\n        self.schemaList = {};\r\n        if (data && data.length) {\r\n          self.isDefaultSchema[params.queryId] = null;\r\n          data.forEach((element: any) => {\r\n            element.schemaValue = JSON.parse(element.schemaValue);\r\n            if (element.isDefault === 1) {\r\n              self.isDefaultSchema[params.queryId] = element;\r\n            }\r\n            self.schemaList[element.id] = element;\r\n            self.operateDynamicColsForSchema.call(self, element, params.groupType ? params.groupType : params.queryId);\r\n          });\r\n          let schemaExtendId = '';\r\n          if (self.schemaRenderExtendService && self.schemaRenderExtendService.schemaInfoRenderBefore) {\r\n            const $event: any = { queryId: params.queryId };\r\n            $event['defaultSchemaId'] = '';\r\n            $event['schemalList'] = self.schemaList;\r\n            self.schemaRenderExtendService.schemaInfoRenderBefore($event);\r\n            if ($event['defaultSchemaId']) {\r\n              schemaExtendId = $event['defaultSchemaId'];\r\n            }\r\n          }\r\n          const filterCondition: any = { schemaType: 0 };\r\n          if (schemaExtendId) {\r\n            filterCondition.id = schemaExtendId;\r\n          }\r\n          if (schemaExtendId || !self.isDefaultSchema || !self.isDefaultSchema[params.queryId]) {\r\n            if (filter(data, filterCondition) && filter(data, filterCondition).length) {\r\n              self.isDefaultSchema[params.queryId] = filter(data, filterCondition)[0];\r\n            } else {\r\n              filterCondition.schemaType = 1;\r\n              if (filter(data, filterCondition) && filter(data, filterCondition).length) {\r\n                self.isDefaultSchema[params.queryId] = filter(data, filterCondition)[0];\r\n              } else {\r\n                filterCondition.schemaType = 2;\r\n                if (filter(data, filterCondition) && filter(data, filterCondition).length) {\r\n                  self.isDefaultSchema[params.queryId] = filter(data, filterCondition)[0];\r\n                }\r\n              }\r\n            }\r\n          }\r\n          self.schemaInfo[params.queryId] = self.schemaList;\r\n          const preSchema = JSON.parse(JSON.stringify(self.preSchema));\r\n          self.operateCustomSchema(preSchema, params.groupType ? params.groupType : params.queryId);\r\n          self.operateDynamicColsForSchema.call(self, preSchema, params.groupType ? params.groupType : params.queryId, 1);\r\n          self.schemaInfoChange.next({ schemaList: self.schemaInfo, isDefaultSchema: self.isDefaultSchema[params.queryId], preSchema: preSchema });\r\n          return { schemaList: self.schemaInfo, isDefaultSchema: self.isDefaultSchema[params.queryId], preSchema: preSchema };\r\n        } else {\r\n          delete self.schemaInfo[params.queryId];\r\n          const preSchema = JSON.parse(JSON.stringify(self.preSchema));\r\n          self.isDefaultSchema[params.queryId] = null;\r\n          self.operateCustomSchema(preSchema, params.groupType ? params.groupType : params.queryId);\r\n          self.operateDynamicColsForSchema.call(self, preSchema, params.groupType ? params.groupType : params.queryId, 1);\r\n          self.schemaInfoChange.next({ schemaList: null, isDefaultSchema: null, preSchema: preSchema });\r\n          return { schemaList: null, isDefaultSchema: null, preSchema: preSchema };\r\n        }\r\n      })\r\n    );\r\n  }\r\n\r\n  public mergeCustomSchema(groupType: any, queryId?: any) {\r\n    const self = this;\r\n    let preSchema = JSON.parse(JSON.stringify(self.preSchema));\r\n    preSchema = self.operateCustomSchema(preSchema, groupType);\r\n    self.operateDynamicColsForSchema.call(self, preSchema, groupType, 1);\r\n    self.schemaInfoChange.next({ schemaList: self.schemaInfo, isDefaultSchema: self.isDefaultSchema && self.isDefaultSchema[queryId] ? self.isDefaultSchema[queryId] : null, preSchema: preSchema });\r\n    return preSchema;\r\n  }\r\n\r\n  private operateCustomSchema(preSchema: any, groupType: any) {\r\n    try {\r\n      if (this.customSchema && this.customSchema[groupType]) {\r\n        const schema = JSON.parse(this.customSchema[groupType]);\r\n        preSchema.schemaValue.titleOption = Object.assign(preSchema.schemaValue.titleOption, schema.titleOption);\r\n        preSchema.schemaValue.columnOption = Object.assign(preSchema.schemaValue.columnOption, schema.columnOption);\r\n        preSchema.schemaValue.styleOption = Object.assign(preSchema.schemaValue.styleOption, schema.styleOption);\r\n        preSchema.schemaValue.otherOption = Object.assign(preSchema.schemaValue.otherOption, schema.otherOption);\r\n        return preSchema;\r\n      }\r\n    } catch (e) {\r\n      console.log(e);\r\n    }\r\n  }\r\n  /**\r\n   * \r\n   * @param schema \r\n   */\r\n  saveSchema(schema: any, queryRelativeUrl: any): Observable<any> {\r\n    const restUri = this.host + this.uri + 'saveschema';\r\n    const schemaObj = JSON.parse(schema.schema);\r\n    const result$ = this.restService.post(restUri, schema, {}, this.createHeaderSessionId());\r\n    return result$.pipe(\r\n      switchMap(() => {\r\n        if (schema.groupType) {\r\n          return this.getSchemaListByGroupType(schemaObj.queryId, '', schemaObj.orgId, schema.groupType, queryRelativeUrl);\r\n        } else {\r\n          return this.getSchemaList(schemaObj.queryId, '', schemaObj.orgId, queryRelativeUrl);\r\n        }\r\n      })\r\n    );\r\n  }\r\n  /**\r\n   * \r\n   * @param id ID\r\n   * @param queryId \r\n   */\r\n  deleteSchema(id: string, queryId: string, queryRelativeUrl: any, groupType?: any, organizationId?: any): Observable<any> {\r\n    const restUri = this.host + this.uri + 'deleteschema';\r\n    const result$ = this.restService.delete(restUri, { id }, this.createHeaderSessionId());\r\n    return result$.pipe(\r\n      map((data: any) => {\r\n        if (data === true) {\r\n          this.isDefaultSchema[queryId] = null;\r\n          const result$1 = groupType ? this.getSchemaListByGroupType(queryId, '', organizationId, groupType, queryRelativeUrl) : this.getSchemaList(queryId, '', organizationId, queryRelativeUrl);\r\n          return result$1.pipe(\r\n            map(value => {\r\n              return true;\r\n            })\r\n          );\r\n        } else {\r\n          return of(false);\r\n        }\r\n      })\r\n    );\r\n  }\r\n  /**\r\n   * spread\r\n   * @param id ID\r\n   */\r\n  analysis(id: string, queryId: string, dynamicCols: any, queryRelativeUrl: any, scheme?: any): Observable<any> {\r\n    const restUri = this.host + this.uri;\r\n    let param = {};\r\n    if (id !== '1') {\r\n      if (dynamicCols && dynamicCols.length) {\r\n        param = { id, dynamicCols: JSON.stringify(dynamicCols), schema: !scheme ? '' : scheme };\r\n        return this.restService.post(restUri + 'getspreadtemplatewithdynamiccolumn', param, {}, this.createHeaderSessionId());\r\n      } else {\r\n        if (scheme) {\r\n          return this.restService.post(restUri + 'getspreadtemplatebyid', { id: id, schema: !scheme ? '' : scheme }, {}, this.createHeaderSessionId());\r\n        } else {\r\n          return this.restService.get(restUri + 'getspreadtemplate', { id }, this.createHeaderSessionId());\r\n        }\r\n      }\r\n    } else {\r\n      dynamicCols = dynamicCols && dynamicCols.length ? dynamicCols : [];\r\n      param = { dynamicCols: JSON.stringify(dynamicCols), schema: !scheme ? '' : scheme };\r\n      return this.restService.post(restUri + 'getinitspreadtemplate', param, {}, this.createHeaderSessionId());\r\n    }\r\n  }\r\n\r\n  getOperation(operators?: any) {\r\n    const restUri = this.host + this.uri;\r\n    let param = {};\r\n    if (!operators || !operators.length) {\r\n      param = {\r\n        operators: ['05202284-dfc4-149c-853e-cfd35b4a02bb', '653fe24b-d77f-d8b0-71c5-5e3d561e33ca', 'd6832d96-e6f3-114e-1d53-f9e636548eb9', 'cd6c2057-5ad6-90dd-54ac-771c192563e8']\r\n      };\r\n    } else {\r\n      param = {\r\n        operators: operators\r\n      };\r\n    }\r\n    return this.restService.post(restUri + 'isprincipalhasop', param, {}, this.createHeaderSessionId());\r\n  }\r\n\r\n  validateOperation(type: any) {\r\n    return this.operations['QdpModifyPublicSchema'] === true && (type === 0 || type === '0');\r\n  }\r\n\r\n  // \r\n  setColInfo(dynamicCols) {\r\n    let colInfo = [];\r\n    if (dynamicCols && dynamicCols.length) {\r\n      colInfo = dynamicCols;\r\n    }\r\n    this.colList.next(colInfo);\r\n  }\r\n\r\n  private createHeaderSessionId() {\r\n    return RtfServices.createHeaderSessionId(this.sessionService);\r\n  }\r\n\r\n  /**\r\n   * \r\n   */\r\n  operateDynamicColsForSchema(element: any, groupType: any, schemaId?: any) {\r\n    if (this.dynamicCols && this.dynamicCols[groupType]) {\r\n      if (element && element.id && (element.isProtected === 1 || element.isProtected === '1' || schemaId === 1)) {\r\n        const dynamicColumns = schemaId === 1 ? this.dynamicCols[groupType] : this.dynamicCols[element.id];\r\n        const dyCols = this.createColumns(dynamicColumns, element.schemaValue.columnOption.colList);\r\n        element.schemaValue.columnOption.colList = dyCols;\r\n      }\r\n    }\r\n  }\r\n  /**\r\n   * \r\n   */\r\n  private createColumns(colList: any, columns: any) {\r\n    const columnList = [];\r\n    if (columns && columns.length) {\r\n      columnList.push(...JSON.parse(JSON.stringify(columns)));\r\n      if (colList && colList.length > 0) {\r\n        let index = 0;\r\n        // tslint:disable-next-line:prefer-for-of\r\n        for (let col = 0; col < colList.length; col++) {\r\n          let c = this.getColumn(columnList, colList[col]);\r\n          if (c) {\r\n            if (this.recursiveCompareColumn(c['childList'], colList[col]['childList']) === false) {\r\n              c = colList[col];\r\n            }\r\n          } else {\r\n            if (index >= columnList.length) {\r\n              columnList.push(colList[col]);\r\n            } else {\r\n              columnList.splice(index, 0, colList[col]);\r\n            }\r\n          }\r\n          if (c && index === 0) {\r\n            index = this.dynamicColIndex + 1;\r\n          } else {\r\n            index += 1;\r\n          }\r\n        }\r\n      }\r\n    } else {\r\n      if (colList && colList.length > 0) {\r\n        columnList.push(...colList);\r\n      }\r\n    }\r\n    return columnList;\r\n  }\r\n  private getColumn(columns: any, col: any) {\r\n    let result = null;\r\n    this.dynamicColIndex = 0;\r\n    // tslint:disable-next-line:prefer-for-of\r\n    for (let item = 0; item < columns.length; item++) {\r\n      result = this.recursiveGetColumn(col, columns[item], null);\r\n      if (result != null) {\r\n        return result;\r\n      }\r\n    }\r\n    return result;\r\n  }\r\n  private recursiveGetColumn(col: any, parentColumn: any, childList: any) {\r\n    if (parentColumn) {\r\n      if (parentColumn['bindField'] === col['bindField']) {\r\n        return parentColumn;\r\n      }\r\n      if (parentColumn['childList'] && parentColumn['childList'].length > 0) {\r\n        return this.recursiveGetColumn(col, null, parentColumn['childList']);\r\n      } else {\r\n        this.dynamicColIndex += 1;\r\n      }\r\n    } else {\r\n      // tslint:disable-next-line:prefer-for-of\r\n      for (let item = 0; item < childList.length; item++) {\r\n        if (childList[item]['bindField'] === col['bindField']) {\r\n          return childList[item];\r\n        }\r\n        if (childList[item]['childList'] && childList[item]['childList'].length > 0) {\r\n          return this.recursiveGetColumn(col, null, childList[item]['childList']);\r\n        } else {\r\n          this.dynamicColIndex += 1;\r\n        }\r\n      }\r\n    }\r\n    return null;\r\n  }\r\n  private recursiveCompareColumn(firstChildList: any, secondChildList: any) {\r\n    if (!firstChildList && !secondChildList) {\r\n      return true;\r\n    } else if (!firstChildList && secondChildList) {\r\n      return false;\r\n    } else if (firstChildList && !secondChildList) {\r\n      return false;\r\n    } else if (firstChildList && secondChildList) {\r\n      if (firstChildList.length !== secondChildList.length) {\r\n        return false;\r\n      } else {\r\n        if (firstChildList.length === 0 && secondChildList.length === 0) {\r\n          return true;\r\n        } else if (firstChildList.length === 0) {\r\n          return false;\r\n        } else {\r\n          for (let i = 0; i < firstChildList.length; i++) {\r\n            if (firstChildList[i].bindField !== secondChildList[i].bindField) {\r\n              return false;\r\n            }\r\n            return this.recursiveCompareColumn(firstChildList[i].childList, secondChildList[i].childList);\r\n          }\r\n          return false;\r\n        }\r\n      }\r\n    }\r\n    return false;\r\n  }\r\n}\r\n","import { Injectable, Inject, Optional } from '@angular/core';\r\nimport { Server_Host, Load_Data_Uri, Load_Data_Col } from '../../entitties/server.host';\r\nimport { Observable, Subject } from 'rxjs';\r\nimport { map } from 'rxjs/operators';\r\nimport { SessionService } from '@ecp-caf/caf-common';\r\nimport { RestfulService } from '../restful-service/restful.service';\r\nimport { RtfServices } from '../rtfservices/rtfservices';\r\nimport { CloudprintService, FileType, OutputOptions, OutputType, PrintType } from '@gsp-svc/cloudprint';\r\n\r\n@Injectable()\r\nexport class LcpService {\r\n  pageInfoChange = new Subject<any>();\r\n  variablesChange = new Subject<any>();\r\n  inSuiteDropDownInfoChange = new Subject<any>();\r\n  inSuiteDropDownInfo: any;\r\n  cloudprintService: CloudprintService;\r\n  formErrorService: any;\r\n  loading: any;\r\n\r\n  constructor(\r\n    private restfulService: RestfulService,\r\n    private sessionService: SessionService,\r\n    @Inject(Server_Host) @Optional() private serverHost: string,\r\n    @Inject(Load_Data_Uri) @Optional() private loadDataUri: string,\r\n    @Inject(Load_Data_Col) @Optional() private loadDataCol: string\r\n  ) { }\r\n\r\n  exportData(params: any, queryRelativeUrl: any) {\r\n    const self = this;\r\n    let uri = this.serverHost;\r\n    if (this.loadDataUri) {\r\n      uri += this.loadDataUri;\r\n    } else {\r\n      uri += (!queryRelativeUrl ? '/api/runtime/bcc/v1.0/qdpsearch/' : queryRelativeUrl) + 'export';\r\n    }\r\n    const config = {\r\n      responseType: 'application/json' // \r\n    };\r\n    Object.assign(config, this.createHeaderSessionId());\r\n    const fileName = params.excelExportName + '.xlsx';\r\n    params = !queryRelativeUrl ? params : { 'Param': params };\r\n    const result$ = !queryRelativeUrl ? this.restfulService.post(uri, params, {}, config)\r\n      : this.restfulService.put(uri, params, {}, config);\r\n    result$.toPromise().then(data => {\r\n      data = !queryRelativeUrl ? data : JSON.parse(data).returnValue;\r\n      const byteString = atob(data); // base64 \r\n      const arrayBuffer = new ArrayBuffer(byteString.length); // \r\n      const intArray = new Uint8Array(arrayBuffer); // \r\n\r\n      for (let i = 0; i < byteString.length; i++) {\r\n        intArray[i] = byteString.charCodeAt(i);\r\n      }\r\n      const blob = new Blob([intArray], { type: 'application/vnd.ms-excel' });\r\n      if ('download' in document.createElement('a')) { // IE\r\n        const elink = document.createElement('a');\r\n        elink.download = fileName;\r\n        elink.style.display = 'none';\r\n        elink.href = URL.createObjectURL(blob);\r\n        document.body.appendChild(elink);\r\n        elink.click();\r\n        URL.revokeObjectURL(elink.href); // URL \r\n        document.body.removeChild(elink);\r\n      } else { // IE10+\r\n        navigator.msSaveBlob(blob, fileName);\r\n      }\r\n      self.loading.close();\r\n    }, error => {\r\n      self.formErrorService.exception(error.Message, error);\r\n    });\r\n  }\r\n\r\n  aysnExportData(params: any, queryRelativeUrl: any) {\r\n    const self = this;\r\n    let uri = this.serverHost;\r\n    if (this.loadDataUri) {\r\n      uri += this.loadDataUri;\r\n    } else {\r\n      uri += (!queryRelativeUrl ? '/api/runtime/bcc/v1.0/qdpsearch/' : queryRelativeUrl) + 'export';\r\n    }\r\n    const config = {\r\n      responseType: 'application/json' // \r\n    };\r\n    Object.assign(config, this.createHeaderSessionId());\r\n    params.async = 1;\r\n    params = !queryRelativeUrl ? params : { 'Param': params };\r\n    const result$ = !queryRelativeUrl ? this.restfulService.post(uri, params, {}, config)\r\n      : this.restfulService.put(uri, params, {}, config);\r\n    result$.toPromise().then(data => {\r\n      data = !queryRelativeUrl ? data : JSON.parse(data).returnValue;\r\n      if (data) {\r\n      }\r\n    }, error => {\r\n      self.formErrorService.exception(error.Message, error);\r\n    })\r\n  }\r\n\r\n  pdfExportEvent(params: any, queryRelativeUrl: any) {\r\n    const self = this;\r\n    let uri = this.serverHost;\r\n    if (this.loadDataUri) {\r\n      uri += this.loadDataUri;\r\n    } else {\r\n      uri += (!queryRelativeUrl ? '/api/runtime/bcc/v1.0/qdpsearch/' : queryRelativeUrl) + 'print';\r\n    }\r\n\r\n    const config = {\r\n      responseType: 'application/json' // \r\n    };\r\n    Object.assign(config, this.createHeaderSessionId());\r\n    params = !queryRelativeUrl ? params : { 'Param': params };\r\n    const fileName = params.Param && params.Param.excelExportName ? params.Param.excelExportName + '' : params.excelExportName + '';\r\n    const result$ = !queryRelativeUrl ? this.restfulService.post(uri, params, {}, config)\r\n      : this.restfulService.put(uri, params, {}, config);\r\n    result$.toPromise().then(data => {\r\n      data = !queryRelativeUrl ? data : JSON.parse(data).returnValue;\r\n      const byteString = atob(data); // base64 \r\n      const arrayBuffer = new ArrayBuffer(byteString.length); // \r\n      const intArray = new Uint8Array(arrayBuffer); // \r\n\r\n      for (let i = 0; i < byteString.length; i++) {\r\n        intArray[i] = byteString.charCodeAt(i);\r\n      }\r\n      const blob = new Blob([intArray], { type: 'application/pdf' });\r\n      if ('download' in document.createElement('a')) { // IE\r\n        const elink = document.createElement('a');\r\n        elink.download = fileName;\r\n        elink.style.display = 'none';\r\n        elink.href = URL.createObjectURL(blob);\r\n        document.body.appendChild(elink);\r\n        elink.click();\r\n        URL.revokeObjectURL(elink.href); // URL \r\n        document.body.removeChild(elink);\r\n      } else { // IE10+\r\n        navigator.msSaveBlob(blob, fileName);\r\n      }\r\n    }, error => {\r\n      self.formErrorService.exception(error.Message, error);\r\n    });\r\n  }\r\n\r\n  printPreView(params: any, queryRelativeUrl: any) {\r\n    const self = this;\r\n    let uri = this.serverHost;\r\n    if (this.loadDataUri) {\r\n      uri += this.loadDataUri;\r\n    } else {\r\n      uri += (!queryRelativeUrl ? '/api/runtime/bcc/v1.0/qdpsearch/' : queryRelativeUrl) + 'print';\r\n    }\r\n\r\n    const config = {\r\n      responseType: 'application/json' // \r\n    };\r\n    Object.assign(config, this.createHeaderSessionId());\r\n    params = !queryRelativeUrl ? params : { 'Param': params };\r\n    const fileName = params.Param && params.Param.excelExportName ? params.Param.excelExportName + '' : params.excelExportName + '';\r\n    const result$ = !queryRelativeUrl ? this.restfulService.post(uri, params, {}, config)\r\n      : this.restfulService.put(uri, params, {}, config);\r\n    result$.toPromise().then(data => {\r\n      data = !queryRelativeUrl ? data : JSON.parse(data).returnValue;\r\n      const options: OutputOptions = {\r\n        OutputType: OutputType.PRINT,\r\n        FileType: FileType.Pdf,\r\n        Path: '',\r\n        DeviceId: '',\r\n        printType: PrintType.Query,\r\n        printJob: false,\r\n        printerName: '',\r\n        printSetting: null\r\n      };\r\n      const byteString = atob(data); // base64 \r\n      const arrayBuffer = new ArrayBuffer(byteString.length); // \r\n      const intArray = new Uint8Array(arrayBuffer); // \r\n\r\n      for (let i = 0; i < byteString.length; i++) {\r\n        intArray[i] = byteString.charCodeAt(i);\r\n      }\r\n      const blob = new Blob([intArray]);\r\n      self.cloudprintService.openRendedViewer('tab', blob, options);\r\n    }, error => {\r\n      self.formErrorService.exception(error.Message, error);\r\n    });\r\n  }\r\n\r\n  getData(params: any, queryRelativeUrl: any): Observable<any> {\r\n    const self = this;\r\n    let uri = this.serverHost;\r\n    if (this.loadDataUri) {\r\n      uri += this.loadDataUri;\r\n    } else {\r\n      uri += !queryRelativeUrl ? '/api/runtime/bcc/v1.0/qdpsearch/query' : (queryRelativeUrl + 'querydata');\r\n    }\r\n    params = !queryRelativeUrl ? params : { 'Param': params };\r\n    const result$ = !queryRelativeUrl ? this.restfulService.post(uri, params, {}, this.createHeaderSessionId())\r\n      : this.restfulService.put(uri, params, {}, this.createHeaderSessionId());\r\n    return result$.pipe(\r\n      map((data: any) => {\r\n        if (data) {\r\n          data = !queryRelativeUrl ? data : data.returnValue;\r\n          if (data && data.pageInfo) {\r\n            self.pageInfoChange.next(data.pageInfo);\r\n          }\r\n          if (data && data.variables) {\r\n            self.variablesChange.next(data.variables);\r\n          }\r\n          if (data && data.dropDownOption) {\r\n            self.inSuiteDropDownInfo = data.dropDownOption;\r\n            self.inSuiteDropDownInfoChange.next(data.dropDownOption);\r\n          }\r\n        }\r\n        return data;\r\n      })\r\n    );\r\n  }\r\n\r\n  getCol(params: any, queryRelativeUrl: any): Observable<any> {\r\n    const self = this;\r\n    let uri = this.serverHost;\r\n    if (this.loadDataCol) {\r\n      uri += this.loadDataCol;\r\n    } else {\r\n      uri += (!queryRelativeUrl ? '/api/runtime/bcc/v1.0/qdpsearch/' : queryRelativeUrl) + 'querycol';\r\n    }\r\n    params = !queryRelativeUrl ? params : { 'Param': params };\r\n    const result$ = !queryRelativeUrl ? this.restfulService.post(uri, params, {}, this.createHeaderSessionId())\r\n      : this.restfulService.put(uri, params, {}, this.createHeaderSessionId());\r\n    return result$.pipe(\r\n      map((data: any) => {\r\n        if (data) {\r\n          data = !queryRelativeUrl ? data : data.returnValue;\r\n        }\r\n        return data;\r\n      })\r\n    );\r\n  }\r\n\r\n  getCrosstabTemplate(params: any, queryRelativeUrl: any) {\r\n    const self = this;\r\n    let uri = this.serverHost;\r\n    if (this.loadDataUri) {\r\n      uri += this.loadDataUri;\r\n    } else {\r\n      uri += !queryRelativeUrl ? '/api/runtime/bcc/v1.0/qdpsearch/getcrosstabtemplate' : (queryRelativeUrl + 'getcrosstabtemplate');\r\n    }\r\n    params = !queryRelativeUrl ? params : { 'Param': params };\r\n    const result$ = !queryRelativeUrl ? this.restfulService.post(uri, params, {}, this.createHeaderSessionId())\r\n      : this.restfulService.put(uri, params, {}, this.createHeaderSessionId());\r\n    return result$.pipe(\r\n      map((result: any) => {\r\n        if (result) {\r\n          result = !queryRelativeUrl ? result : (result && result.returnValue) ? JSON.parse(result.returnValue) : undefined;\r\n        }\r\n        return result;\r\n      })\r\n    );\r\n  }\r\n\r\n  getSpreadLicense() {\r\n    const uri = '/api/runtime/bcc/v1.0/qdpschemamanager/getSpreadLicense';\r\n    const result$ = this.restfulService.get(uri, {}, this.createHeaderSessionId());\r\n    return result$.pipe(\r\n      map((data: any) => {\r\n        return data.spreadjs;\r\n      })\r\n    );\r\n  }\r\n\r\n  clearCache(params: any) {\r\n    const self = this;\r\n    const uri = this.serverHost + '/api/runtime/bcc/v1.0/qdpsearch/clearcache';\r\n    const result$ = this.restfulService.post(uri, params, {}, this.createHeaderSessionId());\r\n    return result$.pipe(\r\n      map((result: any) => {\r\n        return result;\r\n      })\r\n    );\r\n  }\r\n\r\n  private createHeaderSessionId() {\r\n    return RtfServices.createHeaderSessionId(this.sessionService);\r\n  }\r\n}\r\n","import { CloudprintService, OutputOptions, SourceOptions, OutputType, FileType, SourceFilterOptions, PrintType } from '@gsp-svc/cloudprint';\r\n\r\n/**\r\n * \r\n * @Scope FrameComponent\r\n */\r\nexport class IntegrationPrintService {\r\n  printService: CloudprintService;\r\n  /**\r\n   * \r\n   */\r\n  constructor(_printService: CloudprintService) {\r\n    this.printService = _printService;\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param beMetaId BE\r\n   * @param bizBillId \r\n   */\r\n  public printSingle(beMetaId: string, bizBillId: string) {\r\n    return this.printArray(beMetaId, [bizBillId]);\r\n  }\r\n  /**\r\n   * idids\r\n   * @param beMetaId beId\r\n   * @param ids idids\r\n   */\r\n  public printByIds(beMetaId: string, ids: string) {\r\n    const dataIds: Array<string> = ids.split(',').filter(item => item);\r\n    return this.printArray(beMetaId, dataIds);\r\n  }\r\n  /**\r\n   * \r\n   * @param beMetaId beId\r\n   * @param ids idids\r\n   * @param dim1 1\r\n   * @param dim2 2\r\n   * @param billCategoryId Id\r\n   */\r\n  public printByIdsWithDimension(beMetaId: string, ids: string, dim1?: string, dim2?: string, billCategoryId?: string) {\r\n    const dataIds: Array<string> = ids.split(',').filter(item => item);\r\n    return this.printArray(beMetaId, dataIds, dim1, dim2, billCategoryId);\r\n  }\r\n  /**\r\n   * \r\n   * @param beMetaId beId\r\n   * @param ids idids\r\n   * @param dim1 1\r\n   * @param dim2 2\r\n   * @param billCategoryId Id\r\n   */\r\n   public printWithDimensionCustomDataSource(beMetaId: string, ids:string, dim1: string, dim2: string, queryType: string, queryServiceId: string, queryParam: any) {\r\n    const dataIds: Array<string> = ids.split(',').filter(item => item);\r\n    return this.printArray(beMetaId, dataIds, dim1, dim2, undefined, queryType, queryServiceId, queryParam);\r\n  }\r\n  /**\r\n   * \r\n   * @param beMetaId BE\r\n   * @param dataIds \r\n   * @param dim1 1\r\n   * @param dim2 2\r\n   * @param billCategoryId Id\r\n   */\r\n  public printArray(beMetaId: string, dataIds: string[], dim1?: any, dim2?: any, billCategoryId?: string, queryType?: string, queryServiceId?: string, queryParam?: any) {\r\n    const sourceOptions: any = this.buildSourceOptions({\r\n      dataIds: dataIds,\r\n      sourceId: beMetaId\r\n    });\r\n\r\n    const outputOptions: OutputOptions = this.buildOutputOptions();\r\n\r\n    if (dim1) {\r\n      sourceOptions.FirstDimensionVal = dim1;\r\n    }\r\n    if (dim2) {\r\n      sourceOptions.SecondDimensionVal = dim2;\r\n    }\r\n    if (typeof billCategoryId !== 'undefined') {\r\n      sourceOptions.billCategoryId = billCategoryId;\r\n    }\r\n    if (queryType) {\r\n      sourceOptions.queryType = queryType;\r\n    }\r\n    if (queryServiceId) {\r\n      sourceOptions.queryServiceId = queryServiceId;\r\n    }\r\n    if (queryParam) {\r\n      sourceOptions.queryParam = queryParam;\r\n    }\r\n    return this.printService.outputBEData(sourceOptions, outputOptions, 'tab');\r\n  }\r\n  /**\r\n   * SourceOptions\r\n   * @param options options\r\n   */\r\n  private buildSourceOptions(options: { dataIds: string[], sourceId: string, [prop: string]: any }): any {\r\n    const so: any = {\r\n      DataIds: options && options.dataIds || undefined,\r\n      SourceId: options && options.sourceId || undefined,\r\n      FirstDimensionVal: options && options.dim1 || undefined,\r\n      SecondDimensionVal: options && options.dim2 || undefined,\r\n      RetrieveParam: options && options.retrieveParam || undefined,\r\n      FormatId: options && options.formatId || undefined,\r\n      billCategoryId: options && options.billCategoryId || undefined,\r\n      ServiceUnit: options && options.serviceUnit || undefined,\r\n      currentPage: options && options.currentPage || undefined,\r\n      pageRowCount: options && options.pageRowCount || undefined,\r\n      queryType: options && options.queryType || undefined,\r\n      queryServiceId: options && options.queryServiceId || undefined,\r\n      bizTypeId: options && options.bizTypeId || undefined,\r\n      queryParam: options && options.queryParam || undefined\r\n    };\r\n    return so;\r\n  }\r\n  /**\r\n   * OutputOptions\r\n   * @param options options\r\n   */\r\n  private buildOutputOptions(options?: { [prop: string]: any }): OutputOptions {\r\n    const oo: OutputOptions = {\r\n      OutputType: options && options.outputType || OutputType.PRINT,\r\n      FileType: options && options.fileType || FileType.Html5,\r\n      Path: options && options.path || undefined,\r\n      DeviceId: options && options.deviceId || undefined,\r\n      printJob: options && options.printJob || undefined,\r\n      printerName: options && options.printerName || undefined,\r\n      printSetting: options && options.printSetting || undefined,\r\n      printType: options && options.printType || PrintType.Form\r\n    };\r\n    return oo;\r\n  }\r\n}\r\n","// import 'rxjs/add/operator/map';\r\nimport { Injectable, Inject } from '@angular/core';\r\nimport { map } from 'rxjs/operators';\r\nimport { Observable, Subject, of } from 'rxjs';\r\nimport { SessionService } from '@ecp-caf/caf-common';\r\nimport { RestfulService } from '../restful-service/restful.service';\r\nimport { Server_Host } from '../../entitties/server.host';\r\nimport { RtfServices } from '../rtfservices/rtfservices';\r\n\r\n@Injectable()\r\nexport class ParasMappingManagerService {\r\n  private uri = '/api/runtime/bcc/v1.0/qdpparasmapping/';\r\n  parasmappingInfoChange = new Subject<any>();\r\n\r\n  parasmappingInfoList: any = {};\r\n\r\n  constructor(private restService: RestfulService, private sessionService: SessionService, @Inject(Server_Host) private host: string) {\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param id ID\r\n   * @param queryId \r\n   */\r\n  getParasMapping(id: string, queryId: string, queryRelativeUrl: any, type: number = 0): Observable<any> {\r\n    const result$ = this.getParasMappingList(queryId, id, '', '', queryRelativeUrl, type);\r\n    return result$.pipe(\r\n      map(value => {\r\n        if (value && value[id]) {\r\n          return value[id];\r\n        } else {\r\n          return null;\r\n        }\r\n      })\r\n    );\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param queryId \r\n   * @param userId ID\r\n   * @param languageType \r\n   */\r\n  getParasMappingList(queryId: string, datasourceId: any, userId: string, languageType: string, queryRelativeUrl: any, queryType: number = 0): Observable<any> {\r\n    const restUri = this.host + this.uri + 'getparasmappinglist';\r\n    const result$ = this.restService.get(restUri, { queryId, datasourceId, userId, languageType, queryType }, this.createHeaderSessionId());\r\n    return result$.pipe(\r\n      map((data: any) => {\r\n        if (data && data.length) {\r\n          data.forEach((element: any) => {\r\n            element.parasmapping = JSON.parse(element.parasmapping);\r\n            this.parasmappingInfoList[element.datasourceid] = element;\r\n          });\r\n          this.parasmappingInfoChange.next({ parasInfoList: this.parasmappingInfoList });\r\n          return this.parasmappingInfoList;\r\n        } else {\r\n          this.parasmappingInfoChange.next({ parasInfoList: null });\r\n          return null;\r\n        }\r\n      })\r\n    );\r\n  }\r\n  /**\r\n   * \r\n   * @param parasmapping \r\n   */\r\n  saveParasMapping(parasmapping: any, queryRelativeUrl: any): Observable<any> {\r\n    const restUri = this.host + this.uri + 'saveparasmapping';\r\n    const result$ = this.restService.post(restUri, parasmapping, {}, this.createHeaderSessionId());\r\n    return result$.pipe(\r\n      map(() => {\r\n        parasmapping.parasmapping = JSON.parse(parasmapping.parasmapping);\r\n        if (Object.keys(this.parasmappingInfoList).indexOf(parasmapping.datasourceid)) {\r\n          this.parasmappingInfoList[parasmapping.datasourceid] = parasmapping;\r\n        }\r\n      })\r\n    );\r\n  }\r\n  /**\r\n   * \r\n   * @param id ID\r\n   * @param queryId \r\n   */\r\n  deleteParasMapping(datasourceid: string, queryId: string, queryRelativeUrl: any): Observable<any> {\r\n    const restUri = this.host + this.uri + 'deleteparasmapping';\r\n    const result$ = this.restService.delete(restUri, { datasourceId: datasourceid, queryId }, this.createHeaderSessionId());\r\n    return result$.pipe(\r\n      map((data: any) => {\r\n        if (data === true) {\r\n          this.parasmappingInfoList[datasourceid] = null;\r\n        } else {\r\n          return false;\r\n        }\r\n      })\r\n    );\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param Id metadataid\r\n   */\r\n  getMetaDataInfoById(Id: string): Observable<any> {\r\n    const restUri = this.host + '/api/runtime/lcm/v1.0/rt-metadatas/' + Id;\r\n    const result$ = this.restService.get(restUri, {}, this.createHeaderSessionId());\r\n\r\n    return result$.pipe(\r\n      map((data: any) => {\r\n        if (data) {\r\n          return data;\r\n        } else {\r\n          return null;\r\n        }\r\n      })\r\n    );\r\n  }\r\n\r\n  private createHeaderSessionId() {\r\n    return RtfServices.createHeaderSessionId(this.sessionService);\r\n  }\r\n}\r\n","// import 'rxjs/add/operator/map';\r\nimport { Injectable, Inject } from '@angular/core';\r\nimport { map } from 'rxjs/operators';\r\nimport { Observable, Subject, of } from 'rxjs';\r\nimport { SessionService } from '@ecp-caf/caf-common';\r\nimport { RestfulService } from '../restful-service/restful.service';\r\nimport { Server_Host } from '../../entitties/server.host';\r\nimport { RtfServices } from '../rtfservices/rtfservices';\r\n\r\n@Injectable()\r\nexport class PrintIntegrationManagerService {\r\n  private uri = '/api/runtime/bcc/v1.0/printintegration/';\r\n  printIntegrationInfoChange = new Subject<any>();\r\n\r\n  printIntegrationInfoList: any = {};\r\n\r\n  constructor(private restService: RestfulService, private sessionService: SessionService, @Inject(Server_Host) private host: string) {\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param schemaId ID\r\n   * @param queryId \r\n   */\r\n  getPrintIntegration(schemaId: string, queryId: string, queryRelativeUrl: any): Observable<any> {\r\n    const result$ = this.getPrintIntegrationList(queryId, schemaId, '', '', queryRelativeUrl);\r\n    return result$.pipe(\r\n      map(value => {\r\n        if (value && value[schemaId + queryId]) {\r\n          return value[schemaId + queryId];\r\n        } else {\r\n          return null;\r\n        }\r\n      })\r\n    );\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param queryId \r\n   * @param schemaId ID\r\n   * @param userId ID\r\n   * @param languageType \r\n   */\r\n  getPrintIntegrationList(queryId: string, schemaId: any, userId: string, languageType: string, queryRelativeUrl: any): Observable<any> {\r\n    const restUri = this.host + this.uri + 'getprintintegrationlist';\r\n    const result$ = this.restService.get(restUri, { queryId, schemaId, userId, languageType }, this.createHeaderSessionId());\r\n    return result$.pipe(\r\n      map((data: any) => {\r\n        if (data && data.length) {\r\n          data.forEach((element: any) => {\r\n            element.printintegration = JSON.parse(element.printintegration);\r\n            this.printIntegrationInfoList[schemaId + queryId] = element;\r\n          });\r\n          this.printIntegrationInfoChange.next({ printIntegrationInfoList: this.printIntegrationInfoList });\r\n          return this.printIntegrationInfoList;\r\n        } else {\r\n          this.printIntegrationInfoChange.next({ printIntegrationInfoList: null });\r\n          return null;\r\n        }\r\n      })\r\n    );\r\n  }\r\n  /**\r\n   * \r\n   * @param element \r\n   */\r\n  savePrintIntegration(element: any, queryRelativeUrl: any): Observable<any> {\r\n    const restUri = this.host + this.uri + 'saveprintintegration';\r\n    const integration = element;\r\n    const result$ = this.restService.post(restUri, integration, {}, this.createHeaderSessionId());\r\n    return result$.pipe(\r\n      map(() => {\r\n        element.printintegration = JSON.parse(element.printintegration);\r\n        if (Object.keys(this.printIntegrationInfoList).indexOf(element.schemaId + element.queryId)) {\r\n          this.printIntegrationInfoList[element.schemaId + element.queryId] = element;\r\n        }\r\n      })\r\n    );\r\n  }\r\n  /**\r\n   * \r\n   * @param schemaId ID\r\n   * @param queryId \r\n   */\r\n  deletePrintIntegration(schemaId: string, queryId: string, queryRelativeUrl: any): Observable<any> {\r\n    const restUri = this.host + this.uri + 'deleteprintintegration';\r\n    const result$ = this.restService.delete(restUri, { schemaId, queryId }, this.createHeaderSessionId());\r\n    return result$.pipe(\r\n      map((data: any) => {\r\n        if (data === true) {\r\n          this.printIntegrationInfoList[schemaId + queryId] = null;\r\n        } else {\r\n          return false;\r\n        }\r\n      })\r\n    );\r\n  }\r\n\r\n  private createHeaderSessionId() {\r\n    return RtfServices.createHeaderSessionId(this.sessionService);\r\n  }\r\n\r\n}\r\n","// import 'rxjs/add/operator/map';\r\nimport { Injectable, Inject } from '@angular/core';\r\nimport { map } from 'rxjs/operators';\r\nimport { Observable, Subject, of } from 'rxjs';\r\nimport { SessionService } from '@ecp-caf/caf-common';\r\nimport { RestfulService } from '../restful-service/restful.service';\r\nimport { Server_Host } from '../../entitties/server.host';\r\nimport { element } from '@angular/core/src/render3';\r\nimport { RtfServices } from '../rtfservices/rtfservices';\r\n\r\n@Injectable()\r\nexport class JointSearchManagerService {\r\n  private uri = '/api/runtime/bcc/v1.0/joinsearch/';\r\n  private localUri = '/api/runtime/sys/v1.0/loginInfo';\r\n  private lcpUri = '/api/runtime/bcc/v1.0/qdpsearch/';\r\n  jointsearchInfoChange = new Subject<any>();\r\n\r\n  jointsearchInfoList: any = {};\r\n\r\n  constructor(private restService: RestfulService, private sessionService: SessionService, @Inject(Server_Host) private host: string) {\r\n    // this.uri = this.host + this.uri;\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param formid ID\r\n   * @param queryId \r\n   */\r\n  getjointsearch(formId: string, queryId: string, queryRelativeUrl: any): Observable<any> {\r\n    const result$ = this.getjointsearchList(formId, queryId, '', '', queryRelativeUrl);\r\n    return result$.pipe(\r\n      map(value => {\r\n        if (value && value[formId + queryId]) {\r\n          return value[formId + queryId];\r\n        } else {\r\n          return null;\r\n        }\r\n      })\r\n    );\r\n  }\r\n\r\n  getVisibleJoint(visibleJointParam: any, queryRelativeUrl: any, searchList: any): Observable<any> {\r\n    const jointUri = this.host + (!queryRelativeUrl ? this.lcpUri : queryRelativeUrl) + 'visiblejoint';\r\n\r\n    const result$ = this.restService.put(jointUri, { 'Param': visibleJointParam}, {}, this.createHeaderSessionId());\r\n    return result$.pipe(\r\n      map((data: any) => {\r\n        const jointSearchList = [];\r\n        if (data) {\r\n          data = !queryRelativeUrl ? data : data.returnValue;\r\n          if (!queryRelativeUrl) {\r\n            for (const search of searchList) {\r\n              if (data[search.id] !== null && data[search.id] === true) {\r\n                jointSearchList.push(search);\r\n              }\r\n            }\r\n          }\r\n          else {\r\n            for (const search of searchList) {\r\n              const item = data.find(d => d.id === search.id);\r\n              if (item && item.visible === true) {\r\n                jointSearchList.push(search);\r\n              }\r\n            }\r\n          }\r\n        }\r\n\r\n        return jointSearchList;\r\n      })\r\n    );\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param queryId \r\n   * @param userId ID\r\n   * @param languageType \r\n   */\r\n  getjointsearchList(formId: any, queryId: string, userId: string, languageType: string, queryRelativeUrl: any): Observable<any> {\r\n    const restUri = this.host + this.uri + 'getjoinsearch';\r\n    const result$ = this.restService.get(restUri, { formId, queryId, userId, languageType }, this.createHeaderSessionId());\r\n    return result$.pipe(\r\n      map((data: any) => {\r\n        // this.jointsearchInfoList = {};\r\n        if (data && data.length) {\r\n          data.forEach((element: any) => {\r\n            this.jointsearchInfoList[element.formId + element.queryId] = element;\r\n          });\r\n          this.jointsearchInfoChange.next({ jointsearchInfoList: this.jointsearchInfoList });\r\n          return this.jointsearchInfoList;\r\n        } else {\r\n          this.jointsearchInfoChange.next({ jointsearchInfoList: null });\r\n          return null;\r\n        }\r\n      })\r\n    );\r\n  }\r\n  /**\r\n   * \r\n   * @param jointsearch \r\n   */\r\n  savejointsearch(jointsearch: any, queryRelativeUrl: any): Observable<any> {\r\n    const restUri = this.host + this.uri + 'addjointsearch';\r\n    const result$ = this.restService.post(restUri, jointsearch, {}, this.createHeaderSessionId());\r\n    return result$.pipe(\r\n      map((data: any) => {\r\n        if (data === true) {\r\n          this.jointsearchInfoList[jointsearch.FormId + jointsearch.queryId] = jointsearch;\r\n          return true;\r\n\r\n        } else {\r\n          return false;\r\n        }\r\n      }));\r\n  }\r\n  /**\r\n   * \r\n   * @param queryId \r\n   */\r\n  deletejointsearch(formId: any, queryId: string, queryRelativeUrl: any): Observable<any> {\r\n    const restUri = this.host + this.uri + 'deletejointsearch';\r\n    const result$ = this.restService.delete(restUri, { formId, queryId }, this.createHeaderSessionId());\r\n    return result$.pipe(\r\n      map((data: any) => {\r\n        if (data === true) {\r\n          this.jointsearchInfoList[formId + queryId] = null;\r\n          return true;\r\n        } else {\r\n          return false;\r\n        }\r\n      })\r\n    );\r\n  }\r\n\r\n  getLanguageList() {\r\n    const result$ = this.restService.get(this.localUri, { infoType: 'supportedLanguage' });\r\n    return result$.pipe(\r\n      map((data: any) => {\r\n        return data;\r\n      })\r\n    );\r\n  }\r\n\r\n  private createHeaderSessionId() {\r\n    return RtfServices.createHeaderSessionId(this.sessionService);\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport abstract class DataRenderExtendService  {\r\n  // \r\n  abstract beforeQueryData($event: any) ;\r\n  // \r\n  abstract beforeLoadData($event: any) ;\r\n  // \r\n  abstract afterLoadData($event: any) ;\r\n  // // \r\n  // abstract rowSelected($event: any) ;\r\n  // // \r\n  // abstract cellSelected($event: any) ;\r\n}\r\n","import { Injectable } from '@angular/core';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport abstract class JointSearchExtendService  {\r\n  // // \r\n  // abstract beforeJointSearchMenuShow($event: any) ;\r\n  // \r\n  abstract beforeJointSearch($event: any) ;\r\n}\r\n","// import 'rxjs/add/operator/map';\r\nimport { Injectable, Inject } from '@angular/core';\r\nimport { map } from 'rxjs/operators';\r\nimport { Observable, Subject, of } from 'rxjs';\r\nimport { SessionService } from '@ecp-caf/caf-common';\r\nimport { RestfulService } from '../restful-service/restful.service';\r\nimport { Server_Host } from '../../entitties/server.host';\r\nimport { RtfServices } from '../rtfservices/rtfservices';\r\n\r\n@Injectable()\r\nexport class FilterManagerService {\r\n  private uri = '/api/runtime/bcc/v1.0/qdpfilter/';\r\n  filterInfoChange = new Subject<any>();\r\n  isFilterQDP = new Subject(); // \r\n\r\n  filterInfoList: any = {};\r\n\r\n  constructor(private restService: RestfulService, private sessionService: SessionService, @Inject(Server_Host) private host: string) {\r\n    // this.uri = this.host + this.uri;\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param id ID\r\n   * @param queryId \r\n   */\r\n  getFilter(id: string, queryId: string, queryRelativeUrl: any, queryType: number, groupType?: any): Observable<any> {\r\n    const result$ = this.getFilterList(queryId, id, groupType, '', queryRelativeUrl, queryType);\r\n    return result$.pipe(\r\n      map(value => {\r\n        if (value && value[queryId]) {\r\n          return value[queryId];\r\n        } else {\r\n          return null;\r\n        }\r\n      })\r\n    );\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param queryId \r\n   * @param userId ID\r\n   * @param languageType \r\n   */\r\n  getFilterList(queryId: string, datasourceId: any, groupType: string, languageType: string, queryRelativeUrl: any, queryType: number = 0): Observable<any> {\r\n    const restUri = this.host + this.uri + 'getfilterlist';\r\n    const result$ = this.restService.get(restUri, { queryId, datasourceId, groupType, languageType, queryType }, this.createHeaderSessionId());\r\n    return result$.pipe(\r\n      map((data: any) => {\r\n        if (data && data.length) {\r\n          data.forEach((element: any) => {\r\n            element.filter = JSON.parse(element.filter);\r\n            this.filterInfoList[element.queryid] = element;\r\n          });\r\n          this.filterInfoChange.next({ parasInfoList: this.filterInfoList });\r\n          return this.filterInfoList;\r\n        } else {\r\n          this.filterInfoChange.next({ parasInfoList: null });\r\n          return null;\r\n        }\r\n      })\r\n    );\r\n  }\r\n  /**\r\n   * \r\n   * @param filter \r\n   */\r\n  saveFilter(filter: any, queryRelativeUrl: any): Observable<any> {\r\n    const restUri = this.host + this.uri + 'savefilter';\r\n    const result$ = this.restService.post(restUri, filter, {}, this.createHeaderSessionId());\r\n    return result$.pipe(\r\n      map(() => {\r\n        filter.filter = JSON.parse(filter.filter);\r\n        if (Object.keys(this.filterInfoList).indexOf(filter.queryid)) {\r\n          this.filterInfoList[filter.queryid] = filter;\r\n        }\r\n      })\r\n    );\r\n  }\r\n  /**\r\n   * \r\n   * @param id ID\r\n   * @param queryId \r\n   */\r\n  deleteFilter(datasourceid: string, queryId: string, queryRelativeUrl: any, queryType: number): Observable<any> {\r\n    const restUri = this.host + this.uri + 'deletefilter';\r\n    const result$ = this.restService.delete(restUri, { datasourceId: datasourceid, queryId, queryType }, this.createHeaderSessionId());\r\n    return result$.pipe(\r\n      map((data: any) => {\r\n        if (data === true) {\r\n          this.filterInfoList[queryId] = null;\r\n        } else {\r\n          return false;\r\n        }\r\n      })\r\n    );\r\n  }\r\n\r\n  private createHeaderSessionId() {\r\n    return RtfServices.createHeaderSessionId(this.sessionService);\r\n  }\r\n}\r\n","type Func = (args: any) => any;\r\n\r\nexport class EventBus {\r\n  public static handlers: any = {};\r\n\r\n  static register(eventType: string, handler: Func, eventId?: string) {\r\n    if (!this.handlers[eventType]) {\r\n      this.handlers[eventType] = {};\r\n    }\r\n\r\n    let id = eventId;\r\n    if (!id) {\r\n      id = this.guid();\r\n    } \r\n    this.handlers[eventType][id] = handler;\r\n\r\n    const unsubscribe = () => {\r\n      delete this.handlers[eventType][id];\r\n      if (Object.keys(this.handlers[eventType]).length === 0) {\r\n        delete this.handlers[eventType];\r\n      }\r\n    };\r\n\r\n    return unsubscribe;\r\n  }\r\n\r\n  static dispatch(eventType: string, args: any) {\r\n    if (this.handlers[eventType]) {\r\n      Object.keys(this.handlers[eventType]).forEach(key => {\r\n        this.handlers[eventType][key](args);\r\n      });\r\n    }\r\n  }\r\n\r\n  static guid() {\r\n    function S4() {\r\n      // tslint:disable-next-line:no-bitwise\r\n      return (((1 + Math.random()) * 0x10000) | 0).toString(16).substring(1);\r\n    }\r\n    return (S4() + S4() + '-' + S4() + '-' + S4() + '-' + S4() + '-' + S4() + S4() + S4());\r\n  }\r\n}\r\n","export class JSONUtils {\r\n    static isObj(object) {\r\n        return object && typeof (object) == 'object' && Object.prototype.toString.call(object).toLowerCase() == \"[object object]\";\r\n    }\r\n\r\n    static isArray(object) {\r\n        return object && typeof (object) == 'object' && object.constructor == Array;\r\n    }\r\n\r\n    static getLength(object) {\r\n        var count = 0;\r\n        for (var i in object) count++;\r\n        return count;\r\n    }\r\n    static Compare(objA, objB) {\r\n        if (!JSONUtils.isObj(objA) || !JSONUtils.isObj(objB)) return false; //\r\n        if (JSONUtils.getLength(objA) != JSONUtils.getLength(objB)) return false; //\r\n        return JSONUtils.CompareObj(objA, objB, true); //true\r\n    }\r\n\r\n    private static CompareObj(objA, objB, flag) {\r\n        for (var key in objA) {\r\n            if (!flag) //\r\n                break;\r\n            if (!objB.hasOwnProperty(key)) {\r\n                flag = false;\r\n                break;\r\n            }\r\n            if (!JSONUtils.isArray(objA[key])) { //,\r\n                if (objB[key] != objA[key]) {\r\n                    flag = false;\r\n                    break;\r\n                }\r\n            } else {\r\n                if (!JSONUtils.isArray(objB[key])) {\r\n                    flag = false;\r\n                    break;\r\n                }\r\n                var oA = objA[key],\r\n                    oB = objB[key];\r\n                if (oA.length != oB.length) {\r\n                    flag = false;\r\n                    break;\r\n                }\r\n                for (var k in oA) {\r\n                    if (!flag) //\r\n                        break;\r\n                    flag = JSONUtils.CompareObj(oA[k], oB[k], flag);\r\n                }\r\n            }\r\n        }\r\n        return flag;\r\n    }\r\n}","export class QDPCacheUtil {\r\n    private static CacheMap = new Map();\r\n\r\n    public static setCache(key: String, value: any) {\r\n        QDPCacheUtil.CacheMap.set(key, value);\r\n    }\r\n\r\n    public static getCache(key: String) {\r\n        return QDPCacheUtil.CacheMap.get(key);\r\n    }\r\n}","import { NgModule, ModuleWithProviders } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { SessionService } from '@ecp-caf/caf-common';\r\nimport { RestfulService } from './service/restful-service/restful.service';\r\nimport { SchemaManagerService } from './service/schema-manager/schema-manager.service';\r\nimport { LcpService } from './service/lcp-service/lcp.service';\r\nimport { ParasMappingManagerService } from './service/paras-mapping/paras-mappingmanager.service';\r\nimport { JointSearchManagerService } from './service/joint-search/joint-searchmanager.service';\r\nimport { PrintIntegrationManagerService } from './service/print-integration/print-integrationmanager.service';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n  ],\r\n  declarations: [\r\n  ],\r\n  exports: [\r\n  ]\r\n})\r\nexport class QdpCommonModule {\r\n  static forRoot(): ModuleWithProviders {\r\n    return {\r\n      ngModule: QdpCommonModule,\r\n      providers: [\r\n        SessionService,\r\n        SchemaManagerService,\r\n        RestfulService,\r\n        LcpService,\r\n        ParasMappingManagerService,\r\n        JointSearchManagerService,\r\n        PrintIntegrationManagerService\r\n      ]\r\n    };\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { Subject } from 'rxjs';\r\n\r\n@Injectable()\r\nexport class DndDraggableService {\r\n\r\n  private _isDragging = false;\r\n  private _itemType = '';\r\n  private _dropCallback: Function;\r\n  private _dropEffect: string;\r\n  private _effectAllowed: string;\r\n  private _removeOnDrop = false;\r\n\r\n  public dropEndSource = new Subject<any>();\r\n\r\n  constructor() {}\r\n\r\n  setDraggingState(state: boolean) {\r\n    this._isDragging = state;\r\n  }\r\n\r\n  getDraggingState(): boolean {\r\n    return this._isDragging;\r\n  }\r\n\r\n  setItemType(value: string): void {\r\n    this._itemType = value.toLowerCase();\r\n  }\r\n\r\n  getItemType(): string {\r\n    return this._itemType;\r\n  }\r\n\r\n  setDropCallback(value: Function): void {\r\n    this._dropCallback = value;\r\n  }\r\n\r\n  getDropCallback(): Function {\r\n    return this._dropCallback;\r\n  }\r\n\r\n  setDropEffect(dropEffect: string): void {\r\n    this._dropEffect = dropEffect;\r\n  }\r\n\r\n  getDropEffect(): string {\r\n    return this._dropEffect;\r\n  }\r\n\r\n  setEffectAllowed(effectAllowed: string): void {\r\n    this._effectAllowed = effectAllowed;\r\n  }\r\n\r\n  getEffectAllowed(): string {\r\n    return this._effectAllowed;\r\n  }\r\n\r\n  setRemoveOnDrop(value: boolean) {\r\n    this._removeOnDrop = value;\r\n  }\r\n\r\n  getRemoveOnDrop() {\r\n    return this._removeOnDrop;\r\n  }\r\n\r\n}\r\n","export const MIME_TYPE = 'application/x-dnd';\r\nexport const EDGE_MIME_TYPE = 'application/json';\r\nexport const MSIE_MIME_TYPE = 'Text';\r\nexport const ALL_EFFECTS = ['move', 'copy', 'link'];\r\n","import {\r\n  Directive, HostBinding, OnChanges, SimpleChanges, Input, OnInit,\r\n  HostListener, ElementRef, Renderer2, Output, EventEmitter\r\n} from '@angular/core';\r\nimport { DndDraggableService } from '../services/dnd-draggable.service';\r\nimport { MIME_TYPE, EDGE_MIME_TYPE, MSIE_MIME_TYPE, ALL_EFFECTS } from '../dnd-constants';\r\nimport { DndDragendEvent } from '../models/events';\r\n\r\n@Directive({\r\n  selector: '[dndDraggable]',\r\n})\r\nexport class DndDraggableDirective implements OnInit {\r\n\r\n  @Input() dndDraggable: any;\r\n  @Input() dndDisable: boolean;\r\n  @Input() dndType = '';\r\n  @Input() dndCallback: Function;\r\n  @Input() dndEffectAllowed: string;\r\n\r\n  @Output() dndDragstart = new EventEmitter<DragEvent>();\r\n  @Output() dndDragend = new EventEmitter<DndDragendEvent>();\r\n  @Output() dndSelected = new EventEmitter<Event>();\r\n\r\n  @Output() dndMoved = new EventEmitter<DragEvent>();\r\n  @Output() dndCopied = new EventEmitter<DragEvent>();\r\n  @Output() dndLinked = new EventEmitter<DragEvent>();\r\n  @Output() dndCanceled = new EventEmitter<DragEvent>();\r\n\r\n  @HostBinding('draggable')\r\n  get draggable() {\r\n    return !this.dndDisable;\r\n  }\r\n\r\n  private _nativeElement: Element;\r\n\r\n  constructor(private _dndService: DndDraggableService, private _renderer: Renderer2, _hostElement: ElementRef) {\r\n    if (_hostElement) {\r\n      this._nativeElement = _hostElement.nativeElement;\r\n    }\r\n  }\r\n\r\n  ngOnInit() {}\r\n\r\n  @HostListener('dragstart', ['$event'])\r\n  onDragStart(event) {\r\n    event = event.originalEvent || event;\r\n    if (!this.draggable) {\r\n      return true;\r\n    }\r\n    this._dndService.setDraggingState(true);\r\n    this._dndService.setItemType(this.dndType);\r\n    const mimeType = MIME_TYPE + (this._dndService.getItemType() ? ('-' + this._dndService.getItemType()) : '');\r\n    // Set the allowed drop effects. See below for special IE handling.\r\n    this._dndService.setDropEffect('none');\r\n    this._dndService.setEffectAllowed(this.dndEffectAllowed || ALL_EFFECTS[0]);\r\n\r\n    event.dataTransfer.effectAllowed = this._dndService.getEffectAllowed(); // TODO: set allowed effects\r\n    try {\r\n      event.dataTransfer.setData(mimeType, JSON.stringify(this.dndDraggable));\r\n    } catch (e) {\r\n      const data = {\r\n        item: this.dndDraggable,\r\n        type: this._dndService.getItemType()\r\n      };\r\n\r\n      try {\r\n        // Setting a custom MIME type did not work, we are probably in IE or Edge.\r\n        event.dataTransfer.setData(EDGE_MIME_TYPE, JSON.stringify(data));\r\n\r\n      } catch (e) {\r\n        // We are in Internet Explorer and can only use the Text MIME type. Also note that IE\r\n        // does not allow changing the cursor in the dragover event, therefore we have to choose\r\n        // the one we want to display now by setting effectAllowed.\r\n        event.dataTransfer.effectAllowed = 'move';\r\n        event.dataTransfer.setData(MSIE_MIME_TYPE, JSON.stringify(data));\r\n      }\r\n    }\r\n    this._renderer.addClass(this._nativeElement, 'dndDragging');\r\n    setTimeout(() => this._renderer.addClass(this._nativeElement, 'dndDraggingSource'), 0);\r\n    // Try setting a proper drag image if triggered on a dnd-handle (won't work in IE).\r\n    if (event._dndHandle && event.dataTransfer.setDragImage) {\r\n      event.dataTransfer.setDragImage(this._nativeElement, 0, 0);\r\n    }\r\n    // Emit dragstart event and prepare extra callback for dropzone.\r\n    this.dndDragstart.emit(event);\r\n\r\n    if (this.dndCallback) {\r\n      const callback = this.dndCallback;\r\n      this._dndService.setDropCallback(function (params) {\r\n        return callback(params);\r\n      });\r\n    }\r\n    event.stopPropagation();\r\n  }\r\n\r\n  @HostListener('dragend', ['$event'])\r\n  onDragEnd(event: DragEvent) {\r\n    const dropEffect = this._dndService.getDropEffect();\r\n    const cb = { copy: 'dndCopied', link: 'dndLinked', move: 'dndMoved', none: 'dndCanceled' };\r\n    this[cb[dropEffect]].emit(event);\r\n    this.dndDragend.emit({\r\n      event: event,\r\n      dropEffect: dropEffect\r\n    });\r\n\r\n    // Clean up\r\n    this._dndService.setDraggingState(false);\r\n    this._dndService.setDropCallback(undefined);\r\n    this._dndService.setRemoveOnDrop(false);\r\n    this._renderer.removeClass(this._nativeElement, 'dndDragging');\r\n    this._renderer.removeClass(this._nativeElement, 'dndDraggingSource');\r\n    event.stopPropagation();\r\n\r\n    // In IE9 it is possible that the timeout from dragstart triggers after the dragend handler.\r\n    setTimeout(() => this._renderer.removeClass(this._nativeElement, 'dndDraggingSource'), 0);\r\n  }\r\n\r\n  @HostListener('click', ['$event'])\r\n  click(event: MouseEvent) {\r\n    this.dndSelected.emit(event);\r\n    // Prevent triggering dndSelected in parent elements.\r\n    event.stopPropagation();\r\n  }\r\n\r\n}\r\n","import {\r\n   Directive,\r\n   HostBinding,\r\n   OnChanges,\r\n   Input,\r\n   HostListener,\r\n   ElementRef,\r\n   Renderer2,\r\n   OnInit,\r\n   Output,\r\n   EventEmitter\r\n} from '@angular/core';\r\nimport { DndDraggableService } from '../services/dnd-draggable.service';\r\nimport { MSIE_MIME_TYPE, EDGE_MIME_TYPE, MIME_TYPE, ALL_EFFECTS } from '../dnd-constants';\r\nimport { DndListEvent } from '../models/events';\r\n\r\n@Directive({\r\n   selector: '[dndList]',\r\n})\r\nexport class DndListDirective implements OnInit {\r\n   @Input() dndDisable = false;\r\n   @Input() dndAllowedTypes: String[];\r\n   @Input() dndExternalSources: any;\r\n   @Input() dndHorizontalList: any;\r\n   @Input() dndEffectAllowed: string;\r\n   @Input() pureComponent: boolean;\r\n   @Input() dndList: any;\r\n\r\n   @Output() dndListChange = new EventEmitter<any>();\r\n\r\n   @Output() dndDragover = new EventEmitter<DndListEvent>();\r\n   @Output() dndDrop = new EventEmitter<DndListEvent>();\r\n   @Output() dndInserted = new EventEmitter<DndListEvent>();\r\n\r\n   private _nativeElement: Element;\r\n   private _placeholderNode: Element;\r\n\r\n   private _listSettings: any = {};\r\n   private _listNode: any;\r\n   private _dragOverStopped = false;\r\n\r\n   private _counter = 0;\r\n\r\n   constructor(private _el: ElementRef, private _renderer: Renderer2, private _dndService: DndDraggableService) {\r\n      this._nativeElement = this._el.nativeElement;\r\n   }\r\n\r\n   ngOnInit(): void {\r\n      const placeholder = this._getPlaceholderElement();\r\n      placeholder.remove();\r\n      this._placeholderNode = placeholder;\r\n      this._listNode = this._nativeElement;\r\n   }\r\n\r\n   @HostListener('dragenter', ['$event'])\r\n   onDragEnter(event) {\r\n      this._counter++;\r\n      this._dragOverStopped = false;\r\n      event = event.originalEvent || event;\r\n      this._listSettings = {\r\n         allowedTypes: Array.isArray(this.dndAllowedTypes) && this.dndAllowedTypes.join('|').toLowerCase().split('|'),\r\n         disabled: this.dndDisable,\r\n         externalSources: this.dndExternalSources,\r\n         horizontal: this.dndHorizontalList\r\n      };\r\n      const mimeType = this._getMimeType(event.dataTransfer.types);\r\n      if (!mimeType || !this._isDropAllowed(this._getItemType(mimeType))) {\r\n         return true;\r\n      }\r\n      event.preventDefault();\r\n   }\r\n\r\n   @HostListener('dragover', ['$event'])\r\n   onDragOver(event) {\r\n      event = event.originalEvent || event;\r\n      // Check whether the drop is allowed and determine mime type.\r\n      const mimeType = this._getMimeType(event.dataTransfer.types);\r\n      const itemType = this._getItemType(mimeType);\r\n      if (!mimeType || !this._isDropAllowed(itemType)) {\r\n         return true;\r\n      }\r\n      // Make sure the placeholder is shown, which is especially important if the list is empty.\r\n      if (this._placeholderNode.parentNode !== this._listNode) {\r\n         this._renderer.appendChild(this._nativeElement, this._placeholderNode);\r\n      }\r\n\r\n      if (event.target !== this._listNode) {\r\n         // Try to find the node direct directly below the list node.\r\n         let listItemNode = event.target;\r\n         while (listItemNode.parentNode !== this._listNode && listItemNode.parentNode) {\r\n            listItemNode = listItemNode.parentNode;\r\n         }\r\n\r\n         if (listItemNode.parentNode === this._listNode && listItemNode !== this._placeholderNode) {\r\n            // If the mouse pointer is in the upper half of the list item element,\r\n            // we position the placeholder before the list item, otherwise after it.\r\n            const rect = listItemNode.getBoundingClientRect();\r\n            let isFirstHalf;\r\n            if (this._listSettings.horizontal) {\r\n               isFirstHalf = event.clientX < rect.left + rect.width / 2;\r\n            } else {\r\n               isFirstHalf = event.clientY < rect.top + rect.height / 2;\r\n            }\r\n            this._listNode.insertBefore(this._placeholderNode,\r\n               isFirstHalf ? listItemNode : listItemNode.nextSibling);\r\n         }\r\n      }\r\n\r\n      // In IE we set a fake effectAllowed in dragstart to get the correct cursor, we therefore\r\n      // ignore the effectAllowed passed in dataTransfer. We must also not access dataTransfer for\r\n      // drops from external sources, as that throws an exception.\r\n      const ignoreDataTransfer = mimeType === MSIE_MIME_TYPE;\r\n      const dropEffect = this._getDropEffect(event, ignoreDataTransfer);\r\n\r\n      if (dropEffect === 'none') {\r\n         return this._stopDragover();\r\n      }\r\n      // At this point we invoke the callback, which still can disallow the drop.\r\n      // We can't do this earlier because we want to pass the index of the placeholder.\r\n\r\n      this.dndDragover.emit(this._getEventResponse(event, dropEffect, itemType));\r\n      if (this._dragOverStopped) {\r\n         return this._stopDragover();\r\n      }\r\n\r\n      // Set dropEffect to modify the cursor shown by the browser, unless we're in IE, where this\r\n      // is not supported. This must be done after preventDefault in Firefox.\r\n      event.preventDefault();\r\n      if (!ignoreDataTransfer) {\r\n         event.dataTransfer.dropEffect = dropEffect;\r\n      }\r\n\r\n      this._renderer.addClass(this._nativeElement, 'dndDragover');\r\n      event.stopPropagation();\r\n      return false;\r\n   }\r\n\r\n   @HostListener('drop', ['$event'])\r\n   onDrop(event) {\r\n      this._counter = 0;\r\n      event = event.originalEvent || event;\r\n      // Check whether the drop is allowed and determine mime type.\r\n      const mimeType = this._getMimeType(event.dataTransfer.types);\r\n      let itemType = this._getItemType(mimeType);\r\n      if (!mimeType || !this._isDropAllowed(itemType)) {\r\n         return true;\r\n      }\r\n      // The default behavior in Firefox is to interpret the dropped element as URL and\r\n      // forward to it. We want to prevent that even if our drop is aborted.\r\n      event.preventDefault();\r\n\r\n      // Unserialize the data that was serialized in dragstart.\r\n      let data;\r\n      try {\r\n         data = JSON.parse(event.dataTransfer.getData(mimeType));\r\n      } catch (e) {\r\n         return this._stopDragover();\r\n      }\r\n\r\n      // Drops with invalid types from external sources might not have been filtered out yet.\r\n      if (mimeType === MSIE_MIME_TYPE || mimeType === EDGE_MIME_TYPE) {\r\n         itemType = data.type || undefined;\r\n         data = data.item;\r\n         if (!this._isDropAllowed(itemType)) {\r\n            return this._stopDragover();\r\n         }\r\n      }\r\n\r\n      // Special handling for internal IE drops, see dragover handler.\r\n      const ignoreDataTransfer = mimeType === MSIE_MIME_TYPE;\r\n      const dropEffect = this._getDropEffect(event, ignoreDataTransfer);\r\n      if (dropEffect === 'none') {\r\n         return this._stopDragover();\r\n      }\r\n      // Invoke the callback, which can transform the transferredObject and even abort the drop.\r\n      const index = this._getPlaceholderIndex();\r\n      this.dndDrop.emit(this._getEventResponse(event, dropEffect, itemType, index, data));\r\n      if (this._dragOverStopped) {\r\n         return this._stopDragover();\r\n      }\r\n\r\n      // The drop is definitely going to happen now, store the dropEffect.\r\n      this._dndService.setDropEffect(dropEffect);\r\n      if (!ignoreDataTransfer) {\r\n         event.dataTransfer.dropEffect = dropEffect;\r\n      }\r\n\r\n      if (this.dndList) {\r\n         // Creates a new array adding the object into the array position without mutate the original.\r\n         const newList = [...this.dndList.slice(0, index), data, ...this.dndList.slice(index)];\r\n         this.dndListChange.emit(newList);\r\n      }\r\n\r\n      this._dndService.setRemoveOnDrop(true);\r\n      // this._dndService.dropEndSource()\r\n\r\n      this.dndInserted.emit(this._getEventResponse(event, dropEffect, itemType, index, data));\r\n\r\n      // Clean up\r\n      this._stopDragover();\r\n      event.stopPropagation();\r\n      return false;\r\n   }\r\n\r\n   /**\r\n  * We have to remove the placeholder when the element is no longer dragged over our list. The\r\n  * problem is that the dragleave event is not only fired when the element leaves our list,\r\n  * but also when it leaves a child element. Therefore, we determine whether the mouse cursor\r\n  * is still pointing to an element inside the list or not.\r\n  */\r\n   @HostListener('dragleave', ['$event'])\r\n   onDragLeave(event) {\r\n      this._counter--;\r\n      event = event.originalEvent || event;\r\n      if (this._counter !== 0) {\r\n         // Signalize to potential parent lists that a placeholder is already shown.\r\n         event._dndPhShown = true;\r\n      } else {\r\n         this._stopDragover();\r\n      }\r\n   }\r\n\r\n   @HostListener('mouseleave', ['$event'])\r\n   onmouseout(event) {\r\n      if (this._dndService.getDraggingState()) {\r\n         this._stopDragover();\r\n      }\r\n   }\r\n\r\n   private _stopDrag() {\r\n      this._dragOverStopped = true;\r\n   }\r\n\r\n   private _stopDragover() {\r\n      this._placeholderNode.remove();\r\n      this._renderer.removeClass(this._nativeElement, 'dndDragover');\r\n      return true;\r\n   }\r\n\r\n\r\n   /**\r\n  * Create a DndListEvent instance for events response.\r\n  */\r\n   private _getEventResponse(event: DragEvent, dropEffect: string, itemType: string, index?: number, item?): DndListEvent {\r\n      return {\r\n         callback: this._dndService.getDropCallback(),\r\n         dropEffect: dropEffect,\r\n         event: event,\r\n         external: !this._dndService.getDraggingState(),\r\n         index: index !== undefined ? index : this._getPlaceholderIndex(),\r\n         item: item || undefined,\r\n         stopDragover: this._stopDrag.bind(this),\r\n         type: itemType\r\n      };\r\n   }\r\n\r\n   private _getPlaceholderIndex() {\r\n      return Array.prototype.indexOf.call(this._nativeElement.children, this._placeholderNode);\r\n   }\r\n\r\n   private _getPlaceholderElement(): Element {\r\n      let placeholder = [].slice.call(this._nativeElement.children).filter((childNode) => {\r\n         return childNode.className.indexOf('dndPlaceholder') > -1;\r\n      });\r\n      if (placeholder.length) {\r\n         return placeholder;\r\n      }\r\n      placeholder = this._renderer.createElement('li');\r\n      this._renderer.addClass(placeholder, 'dndPlaceholder');\r\n      return placeholder;\r\n   }\r\n\r\n   private _getMimeType(types) {\r\n      if (!types) {\r\n         return MSIE_MIME_TYPE; // IE 9 workaround.\r\n      }\r\n      for (let i = 0; i < types.length; i++) {\r\n         if (types[i] === MSIE_MIME_TYPE || types[i] === EDGE_MIME_TYPE ||\r\n            types[i].substr(0, MIME_TYPE.length) === MIME_TYPE) {\r\n            return types[i];\r\n         }\r\n      }\r\n      return null;\r\n   }\r\n\r\n   /**\r\n  * Determines the type of the item from the dndService, or from the mime type for items from\r\n  * external sources. Returns undefined if no item type was set and null if the item type could\r\n  * not be determined.\r\n  */\r\n   private _getItemType(mimeType) {\r\n      if (this._dndService.getDraggingState()) {\r\n         return this._dndService.getItemType() || undefined;\r\n      }\r\n      if (mimeType === MSIE_MIME_TYPE || mimeType === EDGE_MIME_TYPE) {\r\n         return null;\r\n      }\r\n      return (mimeType && mimeType.substr(MIME_TYPE.length + 1)) || undefined;\r\n   }\r\n\r\n   private _isDropAllowed(itemType) {\r\n      if (this._listSettings.disabled) {\r\n         return false;\r\n      }\r\n      if (!this._listSettings.externalSources && !this._dndService.getDraggingState()) {\r\n         return false;\r\n      }\r\n      if (!this._listSettings.allowedTypes || itemType === null) {\r\n         return true;\r\n      }\r\n      return itemType && this._listSettings.allowedTypes.indexOf(itemType) !== -1;\r\n   }\r\n\r\n   /**\r\n  * Determines which drop effect to use for the given event. In Internet Explorer we have to\r\n  * ignore the effectAllowed field on dataTransfer, since we set a fake value in dragstart.\r\n  * In those cases we rely on dndState to filter effects. Read the design doc for more details:\r\n  * https://github.com/marceljuenemann/angular-drag-and-drop-lists/wiki/Data-Transfer-Design\r\n  */\r\n   private _getDropEffect(event, ignoreDataTransfer) {\r\n      let effects = ALL_EFFECTS;\r\n      if (!ignoreDataTransfer) {\r\n         effects = this._filterEffects(effects, event.dataTransfer.effectAllowed);\r\n      }\r\n      if (this._dndService.getDraggingState()) {\r\n         effects = this._filterEffects(effects, this._dndService.getEffectAllowed());\r\n      }\r\n      if (this.dndEffectAllowed) {\r\n         effects = this._filterEffects(effects, this.dndEffectAllowed);\r\n      }\r\n      // MacOS automatically filters dataTransfer.effectAllowed depending on the modifier keys,\r\n      // therefore the following modifier keys will only affect other operating systems.\r\n      if (!effects.length) {\r\n         return 'none';\r\n      } else if (event.ctrlKey && effects.indexOf('copy') !== -1) {\r\n         return 'copy';\r\n      } else if (event.altKey && effects.indexOf('link') !== -1) {\r\n         return 'link';\r\n      } else {\r\n         return effects[0];\r\n      }\r\n   }\r\n\r\n   /**\r\n  * Filters an array of drop effects using a HTML5 effectAllowed string.\r\n  */\r\n   private _filterEffects(effects, effectAllowed) {\r\n      if (effectAllowed === 'all') {\r\n         return effects;\r\n      }\r\n      return effects.filter(function (effect) {\r\n         return effectAllowed.toLowerCase().indexOf(effect) !== -1;\r\n      });\r\n   }\r\n}\r\n","import { Directive, HostBinding, HostListener, OnInit } from '@angular/core';\r\n\r\n@Directive({\r\n  selector: '[dndNodrag]',\r\n})\r\nexport class DndNodragDirective implements OnInit {\r\n  constructor() {}\r\n\r\n  ngOnInit() {}\r\n\r\n  @HostBinding('draggable')\r\n  get draggable() {\r\n    return true;\r\n  }\r\n\r\n  @HostListener('dragstart', ['$event'])\r\n  onDragStart(event) {\r\n    event = event.originalEvent || event;\r\n    if (!event._dndHandle) {\r\n      // If a child element already reacted to dragstart and set a dataTransfer object, we will\r\n      // allow that. For example, this is the case for user selections inside of input elements.\r\n      if (!(event.dataTransfer.types && event.dataTransfer.types.length)) {\r\n        event.preventDefault();\r\n      }\r\n      event.stopPropagation();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Stop propagation of dragend events, otherwise dnd-moved might be triggered and the element\r\n   * would be removed.\r\n   */\r\n  @HostListener('dragend', ['$event'])\r\n  onDragEnd(event) {\r\n    event = event.originalEvent || event;\r\n    if (!event._dndHandle) {\r\n      event.stopPropagation();\r\n    }\r\n  }\r\n}\r\n","import { Directive, HostBinding, HostListener, OnInit } from '@angular/core';\r\n\r\n@Directive({\r\n  selector: '[dndHandle]',\r\n})\r\nexport class DndHandleDirective implements OnInit {\r\n  constructor() {}\r\n\r\n  ngOnInit() {}\r\n\r\n  @HostBinding('draggable')\r\n  get draggable() {\r\n    return true;\r\n  }\r\n\r\n  @HostListener('dragstart dragend', ['$event'])\r\n  onDragStart(event) {\r\n    event = event.originalEvent || event;\r\n    event._dndHandle = true;\r\n  }\r\n}\r\n","import { CommonModule } from '@angular/common';\r\nimport { NgModule } from '@angular/core';\r\n\r\nimport { DndDraggableDirective } from './directives/dnd-draggable.directive';\r\nimport { DndDraggableService } from './services/dnd-draggable.service';\r\nimport { DndListDirective } from './directives/dnd-list.directive';\r\nimport { DndNodragDirective } from './directives/dnd-nodrag.directive';\r\nimport { DndHandleDirective } from './directives/dnd-handle.directive';\r\n\r\nconst declarations = [\r\n  DndDraggableDirective,\r\n  DndListDirective,\r\n  DndNodragDirective,\r\n  DndHandleDirective\r\n];\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule\r\n  ],\r\n  declarations,\r\n  providers: [\r\n    DndDraggableService\r\n  ],\r\n  exports: declarations\r\n})\r\nexport class DndListModule { }\r\n"]}