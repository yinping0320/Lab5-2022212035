/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Subject } from "rxjs";
var RtfServices = /** @class */ (function () {
    function RtfServices() {
    }
    /**
     * @param {?=} sessionService
     * @return {?}
     */
    RtfServices.createHeaderSessionId = /**
     * @param {?=} sessionService
     * @return {?}
     */
    function (sessionService) {
        /** @type {?} */
        var options = {
            headers: {
                'Content-Type': 'application/json'
            }
        };
        try {
            if (gspframeworkService && gspframeworkService.rtf && gspframeworkService.rtf.session && gspframeworkService.rtf.session.getFormToken()) {
                options.headers['X-CAF-Runtime-CommonVariable'] = gspframeworkService.rtf.session.getFormToken();
            }
            else if (sessionService && sessionService.getCurrentSeesionId()) {
                options.headers['X-CAF-Runtime-CommonVariable'] = sessionService.getCurrentSeesionId();
            }
            else if (sessionService && sessionService.getUserSessionId()) {
                options.headers['SessionId'] = sessionService.getUserSessionId();
            }
            else if (localStorage.getItem('sessionId')) {
                options.headers['SessionId'] = localStorage.getItem('sessionId');
            }
        }
        catch (e) { }
        return options;
    };
    /**
     * @param {?=} sessionService
     * @return {?}
     */
    RtfServices.getSessionId = /**
     * @param {?=} sessionService
     * @return {?}
     */
    function (sessionService) {
        /** @type {?} */
        var sessionId;
        try {
            if (gspframeworkService && gspframeworkService.rtf && gspframeworkService.rtf.session && gspframeworkService.rtf.session.getFormToken()) {
                sessionId = gspframeworkService.rtf.session.getFormToken();
            }
            else if (sessionService && sessionService.getCurrentSeesionId()) {
                sessionId = sessionService.getCurrentSeesionId();
            }
            else if (sessionService && sessionService.getUserSessionId()) {
                sessionId = sessionService.getUserSessionId();
            }
            else if (localStorage.getItem('sessionId')) {
                sessionId = localStorage.getItem('sessionId');
            }
        }
        catch (e) { }
        return sessionId;
    };
    /**
     * @param {?=} queryId
     * @return {?}
     */
    RtfServices.getTabId = /**
     * @param {?=} queryId
     * @return {?}
     */
    function (queryId) {
        try {
            if (gspframeworkService && gspframeworkService.rtf && gspframeworkService.rtf.session) {
                /** @type {?} */
                var tab = gspframeworkService.rtf.session.getCommonVariable();
                if (gspframeworkService.rtf.extendMethod && gspframeworkService.rtf.extendMethod.getExtObj && gspframeworkService.rtf.extendMethod.getExtObj() && gspframeworkService.rtf.extendMethod.getExtObj().iGIXFrmUUID) {
                    /** @type {?} */
                    var uuid = gspframeworkService.rtf.extendMethod.getExtObj().iGIXFrmUUID() ? gspframeworkService.rtf.extendMethod.getExtObj().iGIXFrmUUID() : '';
                    return tab.tabId + uuid;
                }
                else {
                    return tab.tabId;
                }
            }
        }
        catch (e) {
            return queryId;
        }
    };
    /**
     * @return {?}
     */
    RtfServices.getInSuiteFrmUUID = /**
     * @return {?}
     */
    function () {
        try {
            if (gspframeworkService.rtf.extendMethod && gspframeworkService.rtf.extendMethod.getExtObj && gspframeworkService.rtf.extendMethod.getExtObj() && gspframeworkService.rtf.extendMethod.getExtObj().iGIXFrmUUID) {
                /** @type {?} */
                var uuid = gspframeworkService.rtf.extendMethod.getExtObj().iGIXFrmUUID() ? gspframeworkService.rtf.extendMethod.getExtObj().iGIXFrmUUID() : '';
                return uuid;
            }
            else {
                return "";
            }
        }
        catch (e) {
            return "";
        }
    };
    /**
     * @return {?}
     */
    RtfServices.getCommonVariable = /**
     * @return {?}
     */
    function () {
        try {
            if (gspframeworkService && gspframeworkService.rtf && gspframeworkService.rtf.session) {
                /** @type {?} */
                var tab = gspframeworkService.rtf.session.getCommonVariable();
                return tab;
            }
        }
        catch (e) {
            return null;
        }
    };
    /**
     * @param {?} key
     * @return {?}
     */
    RtfServices.getMenuParameter = /**
     * @param {?} key
     * @return {?}
     */
    function (key) {
        try {
            /** @type {?} */
            var funcId = RtfServices.getCommonVariable().funcId;
            if (gspframeworkService && gspframeworkService.rtf && gspframeworkService.rtf.func) {
                /** @type {?} */
                var param_1 = null;
                /** @type {?} */
                var callback = (/**
                 * @param {?} res
                 * @return {?}
                 */
                function (res) {
                    // 回到函数得到res 即参数
                    param_1 = res;
                });
                gspframeworkService.rtf.func.getMenuParams(funcId, callback);
                if (param_1) {
                    return param_1.get(key);
                }
            }
            return null;
        }
        catch (e) {
            return null;
        }
    };
    /**
     * @param {?} tabId
     * @return {?}
     */
    RtfServices.getMenuSwitchControlParameter = /**
     * @param {?} tabId
     * @return {?}
     */
    function (tabId) {
        return {
            menuSwitchControl: {
                key: tabId,
                value: new Subject(),
                changeEnable: false
            }
        };
    };
    /**
     * @return {?}
     */
    RtfServices.getMenuSwitchControlEvent = /**
     * @return {?}
     */
    function () {
        try {
            /** @type {?} */
            var tabId = RtfServices.getTabId();
            if (gspframeworkService && gspframeworkService.rtf && gspframeworkService.rtf.frmEvent) {
                /** @type {?} */
                var param_2 = null;
                /** @type {?} */
                var option = RtfServices.getCommonVariable();
                /** @type {?} */
                var callback = (/**
                 * @param {?} res
                 * @return {?}
                 */
                function (res) {
                    // 回到函数得到res 即参数
                    param_2 = res;
                });
                gspframeworkService.rtf.frmEvent.eventListener(tabId, callback, option);
                if (param_2 && param_2.hasOwnProperty('menuSwitchControl') && param_2['menuSwitchControl'].key === tabId) {
                    return param_2['menuSwitchControl'].value;
                }
                return null;
            }
        }
        catch (e) {
            return null;
        }
    };
    /**
     * 获取功能ID
     * @param option `{appId：'应用ID', appEntrance: '应用入口', appType: '类型：app, menu', funcId: '功能ID', tabId: '标签页ID'}`
     */
    /**
     * 获取功能ID
     * @param {?} option `{appId：'应用ID', appEntrance: '应用入口', appType: '类型：app, menu', funcId: '功能ID', tabId: '标签页ID'}`
     * @return {?}
     */
    RtfServices.getFuncId = /**
     * 获取功能ID
     * @param {?} option `{appId：'应用ID', appEntrance: '应用入口', appType: '类型：app, menu', funcId: '功能ID', tabId: '标签页ID'}`
     * @return {?}
     */
    function (option) {
        return RtfServices.getNewPageIdFunc(option);
    };
    /**
     * @return {?}
     */
    RtfServices.getFuncName = /**
     * @return {?}
     */
    function () {
        try {
            if (gspframeworkService && gspframeworkService.rtf && gspframeworkService.rtf.tabs) {
                /** @type {?} */
                var func = gspframeworkService.rtf.tabs.getAll().find((/**
                 * @param {?} x
                 * @return {?}
                 */
                function (x) { return x.id == gspframeworkService.rtf.tabs.getActiveTab().funcId; }));
                return func.FuncName;
            }
            else {
                return '';
            }
        }
        catch (e) {
            return '';
        }
    };
    /**
     * @private
     * @param {?} option
     * @return {?}
     */
    RtfServices.getFuncIdOlde = /**
     * @private
     * @param {?} option
     * @return {?}
     */
    function (option) {
        /** @type {?} */
        var funcId;
        if (option.appType.toLowerCase() === 'app') {
            funcId = RtfServices.newPageIdApp(option.appId, option.appEntrance, option.tabId);
        }
        else {
            funcId = RtfServices.newPageIdFunc(option.funcId, option.tabId);
        }
        return funcId;
    };
    /**
     * @private
     * @param {?} option
     * @return {?}
     */
    RtfServices.getNewPageIdFunc = /**
     * @private
     * @param {?} option
     * @return {?}
     */
    function (option) {
        try {
            if (gspframeworkService && gspframeworkService.rtf && gspframeworkService.rtf.func) {
                return gspframeworkService.rtf.func.newPageId(option);
            }
            else {
                return RtfServices.getFuncIdOlde(option);
            }
        }
        catch (e) {
            return RtfServices.getFuncIdOlde(option);
        }
    };
    /**
     * @private
     * @param {?} funcId
     * @param {?} tabId
     * @return {?}
     */
    RtfServices.newPageIdFunc = /**
     * @private
     * @param {?} funcId
     * @param {?} tabId
     * @return {?}
     */
    function (funcId, tabId) {
        return tabId ? funcId + "_" + tabId : funcId;
    };
    /**
     * @private
     * @param {?} appId
     * @param {?} appEntrance
     * @return {?}
     */
    RtfServices.mergeAppId = /**
     * @private
     * @param {?} appId
     * @param {?} appEntrance
     * @return {?}
     */
    function (appId, appEntrance) {
        return appId + "_" + appEntrance;
    };
    /**
     * @private
     * @param {?} appId
     * @param {?} appEntrance
     * @param {?} tabId
     * @return {?}
     */
    RtfServices.newPageIdApp = /**
     * @private
     * @param {?} appId
     * @param {?} appEntrance
     * @param {?} tabId
     * @return {?}
     */
    function (appId, appEntrance, tabId) {
        return tabId ? RtfServices.mergeAppId(appId, appEntrance) + "_" + tabId : RtfServices.mergeAppId(appId, appEntrance);
    };
    RtfServices.uuid = "";
    RtfServices.isInSuite = false;
    return RtfServices;
}());
export { RtfServices };
if (false) {
    /** @type {?} */
    RtfServices.uuid;
    /** @type {?} */
    RtfServices.isInSuite;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicnRmc2VydmljZXMuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AcWRwL2NvbW1vbi8iLCJzb3VyY2VzIjpbImxpYi9zZXJ2aWNlL3J0ZnNlcnZpY2VzL3J0ZnNlcnZpY2VzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxPQUFPLEVBQUUsT0FBTyxFQUFFLE1BQU0sTUFBTSxDQUFDO0FBSS9CO0lBQUE7SUEwTEEsQ0FBQzs7Ozs7SUF0TFEsaUNBQXFCOzs7O0lBQTVCLFVBQTZCLGNBQW9COztZQUN6QyxPQUFPLEdBQUc7WUFDZCxPQUFPLEVBQUU7Z0JBQ1AsY0FBYyxFQUFFLGtCQUFrQjthQUNuQztTQUNGO1FBQ0QsSUFBSTtZQUNGLElBQUksbUJBQW1CLElBQUksbUJBQW1CLENBQUMsR0FBRyxJQUFJLG1CQUFtQixDQUFDLEdBQUcsQ0FBQyxPQUFPLElBQUksbUJBQW1CLENBQUMsR0FBRyxDQUFDLE9BQU8sQ0FBQyxZQUFZLEVBQUUsRUFBRTtnQkFDdkksT0FBTyxDQUFDLE9BQU8sQ0FBQyw4QkFBOEIsQ0FBQyxHQUFHLG1CQUFtQixDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUMsWUFBWSxFQUFFLENBQUM7YUFDbEc7aUJBQU0sSUFBSSxjQUFjLElBQUksY0FBYyxDQUFDLG1CQUFtQixFQUFFLEVBQUU7Z0JBQ2pFLE9BQU8sQ0FBQyxPQUFPLENBQUMsOEJBQThCLENBQUMsR0FBRyxjQUFjLENBQUMsbUJBQW1CLEVBQUUsQ0FBQzthQUN4RjtpQkFBTSxJQUFJLGNBQWMsSUFBSSxjQUFjLENBQUMsZ0JBQWdCLEVBQUUsRUFBRTtnQkFDOUQsT0FBTyxDQUFDLE9BQU8sQ0FBQyxXQUFXLENBQUMsR0FBRyxjQUFjLENBQUMsZ0JBQWdCLEVBQUUsQ0FBQzthQUNsRTtpQkFBTSxJQUFJLFlBQVksQ0FBQyxPQUFPLENBQUMsV0FBVyxDQUFDLEVBQUU7Z0JBQzVDLE9BQU8sQ0FBQyxPQUFPLENBQUMsV0FBVyxDQUFDLEdBQUcsWUFBWSxDQUFDLE9BQU8sQ0FB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QUFJLENBQUMsU0FBUyxDQUFDLE1BQU0sQ0FBQyxDQUFDO2FBQ3ZEO2lCQUFNO2dCQUNMLE9BQU8sV0FBVyxDQUFDLGFBQWEsQ0FBQyxNQUFNLENBQUMsQ0FBQzthQUMxQztTQUNGO1FBQUMsT0FBTyxDQUFDLEVBQUU7WUFDVixPQUFPLFdBQVcsQ0FBQyxhQUFhLENBQUMsTUFBTSxDQUFDLENBQUM7U0FDMUM7SUFDSCxDQUFDOzs7Ozs7O0lBRWMseUJBQWE7Ozs7OztJQUE1QixVQUE2QixNQUFNLEVBQUUsS0FBSztRQUN4QyxPQUFPLEtBQUssQ0FBQyxDQUFDLENBQUksTUFBTSxTQUFJLEtBQU8sQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDO0lBQy9DLENBQUM7Ozs7Ozs7SUFFYyxzQkFBVTs7Ozs7O0lBQXpCLFVBQTBCLEtBQVUsRUFBRSxXQUFnQjtRQUNwRCxPQUFVLEtBQUssU0FBSSxXQUFhLENBQUM7SUFDbkMsQ0FBQzs7Ozs7Ozs7SUFFYyx3QkFBWTs7Ozs7OztJQUEzQixVQUE0QixLQUFVLEVBQUUsV0FBZ0IsRUFBRSxLQUFVO1FBQ2xFLE9BQU8sS0FBSyxDQUFDLENBQUMsQ0FBSSxXQUFXLENBQUMsVUFBVSxDQUFDLEtBQUssRUFBRSxXQUFXLENBQUMsU0FBSSxLQUFPLENBQUMsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxVQUFVLENBQUMsS0FBSyxFQUFFLFdBQVcsQ0FBQyxDQUFDO0lBQ3ZILENBQUM7SUF4TE0sZ0JBQUksR0FBRyxFQUFFLENBQUM7SUFDVixxQkFBUyxHQUFHLEtBQUssQ0FBQztJQXdMM0Isa0JBQUM7Q0FBQSxBQTFMRCxJQTBMQztTQTFMWSxXQUFXOzs7SUFDdEIsaUJBQWlCOztJQUNqQixzQkFBeUIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBTdWJqZWN0IH0gZnJvbSBcInJ4anNcIjtcclxuXHJcbmRlY2xhcmUgdmFyIGdzcGZyYW1ld29ya1NlcnZpY2U6IGFueTtcclxuXHJcbmV4cG9ydCBjbGFzcyBSdGZTZXJ2aWNlcyB7XHJcbiAgc3RhdGljIHV1aWQgPSBcIlwiO1xyXG4gIHN0YXRpYyBpc0luU3VpdGUgPSBmYWxzZTtcclxuXHJcbiAgc3RhdGljIGNyZWF0ZUhlYWRlclNlc3Npb25JZChzZXNzaW9uU2VydmljZT86IGFueSkge1xyXG4gICAgY29uc3Qgb3B0aW9ucyA9IHtcclxuICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcclxuICAgICAgfVxyXG4gICAgfTtcclxuICAgIHRyeSB7XHJcbiAgICAgIGlmIChnc3BmcmFtZXdvcmtTZXJ2aWNlICYmIGdzcGZyYW1ld29ya1NlcnZpY2UucnRmICYmIGdzcGZyYW1ld29ya1NlcnZpY2UucnRmLnNlc3Npb24gJiYgZ3NwZnJhbWV3b3JrU2VydmljZS5ydGYuc2Vzc2lvbi5nZXRGb3JtVG9rZW4oKSkge1xyXG4gICAgICAgIG9wdGlvbnMuaGVhZGVyc1snWC1DQUYtUnVudGltZS1Db21tb25WYXJpYWJsZSddID0gZ3NwZnJhbWV3b3JrU2VydmljZS5ydGYuc2Vzc2lvbi5nZXRGb3JtVG9rZW4oKTtcclxuICAgICAgfSBlbHNlIGlmIChzZXNzaW9uU2VydmljZSAmJiBzZXNzaW9uU2VydmljZS5nZXRDdXJyZW50U2Vlc2lvbklkKCkpIHtcclxuICAgICAgICBvcHRpb25zLmhlYWRlcnNbJ1gtQ0FGLVJ1bnRpbWUtQ29tbW9uVmFyaWFibGUnXSA9IHNlc3Npb25TZXJ2aWNlLmdldEN1cnJlbnRTZWVzaW9uSWQoKTtcclxuICAgICAgfSBlbHNlIGlmIChzZXNzaW9uU2VydmljZSAmJiBzZXNzaW9uU2VydmljZS5nZXRVc2VyU2Vzc2lvbklkKCkpIHtcclxuICAgICAgICBvcHRpb25zLmhlYWRlcnNbJ1Nlc3Npb25JZCddID0gc2Vzc2lvblNlcnZpY2UuZ2V0VXNlclNlc3Npb25JZCgpO1xyXG4gICAgICB9IGVsc2UgaWYgKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdzZXNzaW9uSWQnKSkge1xyXG4gICAgICAgIG9wdGlvbnMuaGVhZGVyc1snU2Vzc2lvbklkJ10gPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnc2Vzc2lvbklkJyk7XHJcbiAgICAgIH1cclxuICAgIH0gY2F0Y2ggKGUpIHsgfVxyXG4gICAgcmV0dXJuIG9wdGlvbnM7XHJcbiAgfVxyXG5cclxuICBzdGF0aWMgZ2V0U2Vzc2lvbklkKHNlc3Npb25TZXJ2aWNlPzogYW55KSB7XHJcbiAgICBsZXQgc2Vzc2lvbklkO1xyXG4gICAgdHJ5IHtcclxuICAgICAgaWYgKGdzcGZyYW1ld29ya1NlcnZpY2UgJiYgZ3NwZnJhbWV3b3JrU2VydmljZS5ydGYgJiYgZ3NwZnJhbWV3b3JrU2VydmljZS5ydGYuc2Vzc2lvbiAmJiBnc3BmcmFtZXdvcmtTZXJ2aWNlLnJ0Zi5zZXNzaW9uLmdldEZvcm1Ub2tlbigpKSB7XHJcbiAgICAgICAgc2Vzc2lvbklkID0gZ3NwZnJhbWV3b3JrU2VydmljZS5ydGYuc2Vzc2lvbi5nZXRGb3JtVG9rZW4oKTtcclxuICAgICAgfSBlbHNlIGlmIChzZXNzaW9uU2VydmljZSAmJiBzZXNzaW9uU2VydmljZS5nZXRDdXJyZW50U2Vlc2lvbklkKCkpIHtcclxuICAgICAgICBzZXNzaW9uSWQgPSBzZXNzaW9uU2VydmljZS5nZXRDdXJyZW50U2Vlc2lvbklkKCk7XHJcbiAgICAgIH0gZWxzZSBpZiAoc2Vzc2lvblNlcnZpY2UgJiYgc2Vzc2lvblNlcnZpY2UuZ2V0VXNlclNlc3Npb25JZCgpKSB7XHJcbiAgICAgICAgc2Vzc2lvbklkID0gc2Vzc2lvblNlcnZpY2UuZ2V0VXNlclNlc3Npb25JZCgpO1xyXG4gICAgICB9IGVsc2UgaWYgKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdzZXNzaW9uSWQnKSkge1xyXG4gICAgICAgIHNlc3Npb25JZCA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdzZXNzaW9uSWQnKTtcclxuICAgICAgfVxyXG4gICAgfSBjYXRjaCAoZSkgeyB9XHJcbiAgICByZXR1cm4gc2Vzc2lvbklkO1xyXG4gIH1cclxuXHJcbiAgc3RhdGljIGdldFRhYklkKHF1ZXJ5SWQ/OiBhbnkpIHtcclxuICAgIHRyeSB7XHJcblxyXG4gICAgICBpZiAoZ3NwZnJhbWV3b3JrU2VydmljZSAmJiBnc3BmcmFtZXdvcmtTZXJ2aWNlLnJ0ZiAmJiBnc3BmcmFtZXdvcmtTZXJ2aWNlLnJ0Zi5zZXNzaW9uKSB7XHJcbiAgICAgICAgY29uc3QgdGFiID0gZ3NwZnJhbWV3b3JrU2VydmljZS5ydGYuc2Vzc2lvbi5nZXRDb21tb25WYXJpYWJsZSgpO1xyXG4gICAgICAgIGlmIChnc3BmcmFtZXdvcmtTZXJ2aWNlLnJ0Zi5leHRlbmRNZXRob2QgJiYgZ3NwZnJhbWV3b3JrU2VydmljZS5ydGYuZXh0ZW5kTWV0aG9kLmdldEV4dE9iaiAmJiBnc3BmcmFtZXdvcmtTZXJ2aWNlLnJ0Zi5leHRlbmRNZXRob2QuZ2V0RXh0T2JqKCkgJiYgZ3NwZnJhbWV3b3JrU2VydmljZS5ydGYuZXh0ZW5kTWV0aG9kLmdldEV4dE9iaigpLmlHSVhGcm1VVUlEKSB7XHJcbiAgICAgICAgICBjb25zdCB1dWlkID0gZ3NwZnJhbWV3b3JrU2VydmljZS5ydGYuZXh0ZW5kTWV0aG9kLmdldEV4dE9iaigpLmlHSVhGcm1VVUlEKCkgPyBnc3BmcmFtZXdvcmtTZXJ2aWNlLnJ0Zi5leHRlbmRNZXRob2QuZ2V0RXh0T2JqKCkuaUdJWEZybVVVSUQoKSA6ICcnO1xyXG4gICAgICAgICAgcmV0dXJuIHRhYi50YWJJZCArIHV1aWQ7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHJldHVybiB0YWIudGFiSWQ7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgIHJldHVybiBxdWVyeUlkO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgc3RhdGljIGdldEluU3VpdGVGcm1VVUlEKCkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgaWYgKGdzcGZyYW1ld29ya1NlcnZpY2UucnRmLmV4dGVuZE1ldGhvZCAmJiBnc3BmcmFtZXdvcmtTZXJ2aWNlLnJ0Zi5leHRlbmRNZXRob2QuZ2V0RXh0T2JqICYmIGdzcGZyYW1ld29ya1NlcnZpY2UucnRmLmV4dGVuZE1ldGhvZC5nZXRFeHRPYmooKSAmJiBnc3BmcmFtZXdvcmtTZXJ2aWNlLnJ0Zi5leHRlbmRNZXRob2QuZ2V0RXh0T2JqKCkuaUdJWEZybVVVSUQpIHtcclxuICAgICAgICBjb25zdCB1dWlkID0gZ3NwZnJhbWV3b3JrU2VydmljZS5ydGYuZXh0ZW5kTWV0aG9kLmdldEV4dE9iaigpLmlHSVhGcm1VVUlEKCkgPyBnc3BmcmFtZXdvcmtTZXJ2aWNlLnJ0Zi5leHRlbmRNZXRob2QuZ2V0RXh0T2JqKCkuaUdJWEZybVVVSUQoKSA6ICcnO1xyXG4gICAgICAgIHJldHVybiB1dWlkO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHJldHVybiBcIlwiO1xyXG4gICAgICB9XHJcbiAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgIHJldHVybiBcIlwiO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgc3RhdGljIGdldENvbW1vblZhcmlhYmxlKCkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgaWYgKGdzcGZyYW1ld29ya1NlcnZpY2UgJiYgZ3NwZnJhbWV3b3JrU2VydmljZS5ydGYgJiYgZ3NwZnJhbWV3b3JrU2VydmljZS5ydGYuc2Vzc2lvbikge1xyXG4gICAgICAgIGNvbnN0IHRhYiA9IGdzcGZyYW1ld29ya1NlcnZpY2UucnRmLnNlc3Npb24uZ2V0Q29tbW9uVmFyaWFibGUoKTtcclxuICAgICAgICByZXR1cm4gdGFiO1xyXG4gICAgICB9XHJcbiAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgc3RhdGljIGdldE1lbnVQYXJhbWV0ZXIoa2V5OiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IGZ1bmNJZCA9IFJ0ZlNlcnZpY2VzLmdldENvbW1vblZhcmlhYmxlKCkuZnVuY0lkO1xyXG4gICAgICBpZiAoZ3NwZnJhbWV3b3JrU2VydmljZSAmJiBnc3BmcmFtZXdvcmtTZXJ2aWNlLnJ0ZiAmJiBnc3BmcmFtZXdvcmtTZXJ2aWNlLnJ0Zi5mdW5jKSB7XHJcbiAgICAgICAgbGV0IHBhcmFtOiBNYXA8YW55LCBhbnk+ID0gbnVsbDtcclxuICAgICAgICBjb25zdCBjYWxsYmFjayA9IGZ1bmN0aW9uIChyZXMpIHtcclxuICAgICAgICAgIC8vIOWbnuWIsOWHveaVsOW+l+WIsHJlcyDljbPlj4LmlbBcclxuICAgICAgICAgIHBhcmFtID0gcmVzO1xyXG4gICAgICAgIH1cclxuICAgICAgICBnc3BmcmFtZXdvcmtTZXJ2aWNlLnJ0Zi5mdW5jLmdldE1lbnVQYXJhbXMoZnVuY0lkLCBjYWxsYmFjayk7XHJcbiAgICAgICAgaWYgKHBhcmFtKSB7XHJcbiAgICAgICAgICByZXR1cm4gcGFyYW0uZ2V0KGtleSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHN0YXRpYyBnZXRNZW51U3dpdGNoQ29udHJvbFBhcmFtZXRlcih0YWJJZDogYW55KSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBtZW51U3dpdGNoQ29udHJvbDoge1xyXG4gICAgICAgIGtleTogdGFiSWQsXHJcbiAgICAgICAgdmFsdWU6IG5ldyBTdWJqZWN0PGFueT4oKSxcclxuICAgICAgICBjaGFuZ2VFbmFibGU6IGZhbHNlXHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIHN0YXRpYyBnZXRNZW51U3dpdGNoQ29udHJvbEV2ZW50KCkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgdGFiSWQgPSBSdGZTZXJ2aWNlcy5nZXRUYWJJZCgpO1xyXG4gICAgICBpZiAoZ3NwZnJhbWV3b3JrU2VydmljZSAmJiBnc3BmcmFtZXdvcmtTZXJ2aWNlLnJ0ZiAmJiBnc3BmcmFtZXdvcmtTZXJ2aWNlLnJ0Zi5mcm1FdmVudCkge1xyXG4gICAgICAgIGxldCBwYXJhbSA9IG51bGw7XHJcbiAgICAgICAgY29uc3Qgb3B0aW9uID0gUnRmU2VydmljZXMuZ2V0Q29tbW9uVmFyaWFibGUoKTtcclxuICAgICAgICBjb25zdCBjYWxsYmFjayA9IGZ1bmN0aW9uIChyZXMpIHtcclxuICAgICAgICAgIC8vIOWbnuWIsOWHveaVsOW+l+WIsHJlcyDljbPlj4LmlbBcclxuICAgICAgICAgIHBhcmFtID0gcmVzO1xyXG4gICAgICAgIH1cclxuICAgICAgICBnc3BmcmFtZXdvcmtTZXJ2aWNlLnJ0Zi5mcm1FdmVudC5ldmVudExpc3RlbmVyKHRhYklkLCBjYWxsYmFjaywgb3B0aW9uKTtcclxuICAgICAgICBpZiAocGFyYW0gJiYgcGFyYW0uaGFzT3duUHJvcGVydHkoJ21lbnVTd2l0Y2hDb250cm9sJykgJiYgcGFyYW1bJ21lbnVTd2l0Y2hDb250cm9sJ10ua2V5ID09PSB0YWJJZCkge1xyXG4gICAgICAgICAgcmV0dXJuIHBhcmFtWydtZW51U3dpdGNoQ29udHJvbCddLnZhbHVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgfVxyXG4gICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOiOt+WPluWKn+iDvUlEXHJcbiAgICogQHBhcmFtIG9wdGlvbiBge2FwcElk77yaJ+W6lOeUqElEJywgYXBwRW50cmFuY2U6ICflupTnlKjlhaXlj6MnLCBhcHBUeXBlOiAn57G75Z6L77yaYXBwLCBtZW51JywgZnVuY0lkOiAn5Yqf6IO9SUQnLCB0YWJJZDogJ+agh+etvumhtUlEJ31gXHJcbiAgICovXHJcbiAgc3RhdGljIGdldEZ1bmNJZChvcHRpb246IGFueSkge1xyXG4gICAgcmV0dXJuIFJ0ZlNlcnZpY2VzLmdldE5ld1BhZ2VJZEZ1bmMob3B0aW9uKTtcclxuICB9XHJcblxyXG4gIHN0YXRpYyBnZXRGdW5jTmFtZSgpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgIGlmIChnc3BmcmFtZXdvcmtTZXJ2aWNlICYmIGdzcGZyYW1ld29ya1NlcnZpY2UucnRmICYmIGdzcGZyYW1ld29ya1NlcnZpY2UucnRmLnRhYnMpIHtcclxuICAgICAgICBjb25zdCBmdW5jID0gZ3NwZnJhbWV3b3JrU2VydmljZS5ydGYudGFicy5nZXRBbGwoKS5maW5kKHggPT4geC5pZCA9PSBnc3BmcmFtZXdvcmtTZXJ2aWNlLnJ0Zi50YWJzLmdldEFjdGl2ZVRhYigpLmZ1bmNJZCk7XHJcbiAgICAgICAgcmV0dXJuIGZ1bmMuRnVuY05hbWU7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuICcnO1xyXG4gICAgICB9XHJcbiAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgIHJldHVybiAnJztcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgc3RhdGljIGdldEZ1bmNJZE9sZGUob3B0aW9uOiBhbnkpIHtcclxuICAgIGxldCBmdW5jSWQ7XHJcbiAgICBpZiAob3B0aW9uLmFwcFR5cGUudG9Mb3dlckNhc2UoKSA9PT0gJ2FwcCcpIHtcclxuICAgICAgZnVuY0lkID0gUnRmU2VydmljZXMubmV3UGFnZUlkQXBwKG9wdGlvbi5hcHBJZCwgb3B0aW9uLmFwcEVudHJhbmNlLCBvcHRpb24udGFiSWQpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgZnVuY0lkID0gUnRmU2VydmljZXMubmV3UGFnZUlkRnVuYyhvcHRpb24uZnVuY0lkLCBvcHRpb24udGFiSWQpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGZ1bmNJZDtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgc3RhdGljIGdldE5ld1BhZ2VJZEZ1bmMob3B0aW9uOiBhbnkpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgIGlmIChnc3BmcmFtZXdvcmtTZXJ2aWNlICYmIGdzcGZyYW1ld29ya1NlcnZpY2UucnRmICYmIGdzcGZyYW1ld29ya1NlcnZpY2UucnRmLmZ1bmMpIHtcclxuICAgICAgICByZXR1cm4gZ3NwZnJhbWV3b3JrU2VydmljZS5ydGYuZnVuYy5uZXdQYWdlSWQob3B0aW9uKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICByZXR1cm4gUnRmU2VydmljZXMuZ2V0RnVuY0lkT2xkZShvcHRpb24pO1xyXG4gICAgICB9XHJcbiAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgIHJldHVybiBSdGZTZXJ2aWNlcy5nZXRGdW5jSWRPbGRlKG9wdGlvbik7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHN0YXRpYyBuZXdQYWdlSWRGdW5jKGZ1bmNJZCwgdGFiSWQpIHtcclxuICAgIHJldHVybiB0YWJJZCA/IGAke2Z1bmNJZH1fJHt0YWJJZH1gIDogZnVuY0lkO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBzdGF0aWMgbWVyZ2VBcHBJZChhcHBJZDogYW55LCBhcHBFbnRyYW5jZTogYW55KSB7XHJcbiAgICByZXR1cm4gYCR7YXBwSWR9XyR7YXBwRW50cmFuY2V9YDtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgc3RhdGljIG5ld1BhZ2VJZEFwcChhcHBJZDogYW55LCBhcHBFbnRyYW5jZTogYW55LCB0YWJJZDogYW55KSB7XHJcbiAgICByZXR1cm4gdGFiSWQgPyBgJHtSdGZTZXJ2aWNlcy5tZXJnZUFwcElkKGFwcElkLCBhcHBFbnRyYW5jZSl9XyR7dGFiSWR9YCA6IFJ0ZlNlcnZpY2VzLm1lcmdlQXBwSWQoYXBwSWQsIGFwcEVudHJhbmNlKTtcclxuICB9XHJcbn1cclxuIl19