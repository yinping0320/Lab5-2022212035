/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Injectable, Inject, Optional } from '@angular/core';
import { Server_Host, Load_Data_Uri, Load_Data_Col } from '../../entitties/server.host';
import { Subject } from 'rxjs';
import { map } from 'rxjs/operators';
import { SessionService } from '@ecp-caf/caf-common';
import { RestfulService } from '../restful-service/restful.service';
import { RtfServices } from '../rtfservices/rtfservices';
import { FileType, OutputType, PrintType } from '@gsp-svc/cloudprint';
export class LcpService {
    /**
     * @param {?} restfulService
     * @param {?} sessionService
     * @param {?} serverHost
     * @param {?} loadDataUri
     * @param {?} loadDataCol
     */
    constructor(restfulService, sessionService, serverHost, loadDataUri, loadDataCol) {
        this.restfulService = restfulService;
        this.sessionService = sessionService;
        this.serverHost = serverHost;
        this.loadDataUri = loadDataUri;
        this.loadDataCol = loadDataCol;
        this.pageInfoChange = new Subject();
        this.variablesChange = new Subject();
        this.inSuiteDropDownInfoChange = new Subject();
    }
    /**
     * @param {?} params
     * @param {?} queryRelativeUrl
     * @return {?}
     */
    exportData(params, queryRelativeUrl) {
        /** @type {?} */
        const self = this;
        /** @type {?} */
        let uri = this.serverHost;
        if (this.loadDataUri) {
            uri += this.loadDataUri;
        }
        else {
            uri += (!queryRelativeUrl ? '/api/runtime/bcc/v1.0/qdpsearch/' : queryRelativeUrl) + 'export';
        }
        /** @type {?} */
        const config = {
            responseType: 'application/json' // 表明返回服务器返回的数据类型
        };
        Object.assign(config, this.createHeaderSessionId());
        /** @type {?} */
        const fileName = params.excelExportName + '.xlsx';
        params = !queryRelativeUrl ? params : { 'Param': params };
        /** @type {?} */
        const result$ = !queryRelativeUrl ? this.restfulService.post(uri, params, {}, config)
            : this.restfulService.put(uri, params, {}, config);
        result$.toPromise().then((/**
         * @param {?} data
         * @return {?}
         */
        data => {
            data = !queryRelativeUrl ? data : JSON.parse(data).returnValue;
            /** @type {?} */
            const byteString = atob(data);
            // base64 解码
            /** @type {?} */
            const arrayBuffer = new ArrayBuffer(byteString.length);
            // 创建缓冲数组
            /** @type {?} */
            const intArray = new Uint8Array(arrayBuffer);
            for (let i = 0; i < byteString.length; i++) {
                intArray[i] = byteString.charCodeAt(i);
            }
            /** @type {?} */
            const blob = new Blob([intArray], { type: 'application/vnd.ms-excel' });
            if ('download' in document.createElement('a')) { // 非IE下载
                // 非IE下载
                /** @type {?} */
                const elink = document.createElement('a');
                elink.download = fileName;
                elink.style.display = 'none';
                elink.href = URL.createObjectURL(blob);
                document.body.appendChild(elink);
                elink.click();
                URL.revokeObjectURL(elink.href); // 释放URL 对象
                document.body.removeChild(elink);
            }
            else { // IE10+下载
                navigator.msSaveBlob(blob, fileName);
            }
            self.loading.close();
        }), (/**
         * @param {?} error
         * @return {?}
         */
        error => {
            self.formErrorService.exception(error.Message, error);
        }));
    }
    /**
     * @param {?} params
     * @param {?} queryRelativeUrl
     * @return {?}
     */
    aysnExportData(params, queryRelativeUrl) {
        /** @type {?} */
        const self = this;
        /** @type {?} */
        let uri = this.serverHost;
        if (this.loadDataUri) {
            uri += this.loadDataUri;
        }
        else {
            uri += (!queryRelativeUrl ? '/api/runtime/bcc/v1.0/qdpsearch/' : queryRelativeUrl) + 'export';
        }
        /** @type {?} */
        const config = {
            responseType: 'application/json' // 表明返回服务器返回的数据类型
        };
        Object.assign(config, this.createHeaderSessionId());
        params.async = 1;
        params = !queryRelativeUrl ? params : { 'Param': params };
        /** @type {?} */
        const result$ = !queryRelativeUrl ? this.restfulService.post(uri, params, {}, config)
            : this.restfulService.put(uri, params, {}, config);
        result$.toPromise().then((/**
         * @param {?} data
         * @return {?}
         */
        data => {
            data = !queryRelativeUrl ? data : JSON.parse(data).returnValue;
            if (data) {
            }
        }), (/**
         * @param {?} error
         * @return {?}
         */
        error => {
            self.formErrorService.exception(error.Message, error);
        }));
    }
    /**
     * @param {?} params
     * @param {?} queryRelativeUrl
     * @return {?}
     */
    pdfExportEvent(params, queryRelativeUrl) {
        /** @type {?} */
        const self = this;
        /** @type {?} */
        let uri = this.serverHost;
        if (this.loadDataUri) {
            uri += this.loadDataUri;
        }
        else {
            uri += (!queryRelativeUrl ? '/api/runtime/bcc/v1.0/qdpsearch/' : queryRelativeUrl) + 'print';
        }
        /** @type {?} */
        const config = {
            responseType: 'application/json' // 表明返回服务器返回的数据类型
        };
        Object.assign(config, this.createHeaderSessionId());
        params = !queryRelativeUrl ? params : { 'Param': params };
        /** @type {?} */
        const fileName = params.Param && params.Param.excelExportName ? params.Param.excelExportName + '' : params.excelExportName + '';
        /** @type {?} */
        const result$ = !queryRelativeUrl ? this.restfulService.post(uri, params, {}, config)
            : this.restfulService.put(uri, params, {}, config);
        result$.toPromise().then((/**
         * @param {?} data
         * @return {?}
         */
        data => {
            data = !queryRelativeUrl ? data : JSON.parse(data).returnValue;
            /** @type {?} */
            const byteString = atob(data);
            // base64 解码
            /** @type {?} */
            const arrayBuffer = new ArrayBuffer(byteString.length);
            // 创建缓冲数组
            /** @type {?} */
            const intArray = new Uint8Array(arrayBuffer);
            for (let i = 0; i < byteString.length; i++) {
                intArray[i] = byteString.charCodeAt(i);
            }
            /** @type {?} */
            const blob = new Blob([intArray], { type: 'application/pdf' });
            if ('download' in document.createElement('a')) { // 非IE下载
                // 非IE下载
                /** @type {?} */
                const elink = document.createElement('a');
                elink.download = fileName;
                elink.style.display = 'none';
                elink.href = URL.createObjectURL(blob);
                document.body.appendChild(elink);
                elink.click();
                URL.revokeObjectURL(elink.href); // 释放URL 对象
                document.body.removeChild(elink);
            }
            else { // IE10+下载
                navigator.msSaveBlob(blob, fileName);
            }
        }), (/**
         * @param {?} error
         * @return {?}
         */
        error => {
            self.formErrorService.exception(error.Message, error);
        }));
    }
    /**
     * @param {?} params
     * @param {?} queryRelativeUrl
     * @return {?}
     */
    printPreView(params, queryRelativeUrl) {
        /** @type {?} */
        const self = this;
        /** @type {?} */
        let uri = this.serverHost;
        if (this.loadDataUri) {
            uri += this.loadDataUri;
        }
        else {
            uri += (!queryRelativeUrl ? '/api/runtime/bcc/v1.0/qdpsearch/' : queryRelativeUrl) + 'print';
        }
        /** @type {?} */
        const config = {
            responseType: 'application/json' // 表明返回服务器返回的数据类型
        };
        Object.assign(config, this.createHeaderSessionId());
        params = !queryRelativeUrl ? params : { 'Param': params };
        /** @type {?} */
        const fileName = params.Param && params.Param.excelExportName ? params.Param.excelExportName + '' : params.excelExportName + '';
        /** @type {?} */
        const result$ = !queryRelativeUrl ? this.restfulService.post(uri, params, {}, config)
            : this.restfulService.put(uri, params, {}, config);
        result$.toPromise().then((/**
         * @param {?} data
         * @return {?}
         */
        data => {
            data = !queryRelativeUrl ? data : JSON.parse(data).returnValue;
            /** @type {?} */
            const options = {
                OutputType: OutputType.PRINT,
                FileType: FileType.Pdf,
                Path: '',
                DeviceId: '',
                printType: PrintType.Query,
                printJob: false,
                printerName: '',
                printSetting: null
            };
            /** @type {?} */
            const byteString = atob(data);
            // base64 解码
            /** @type {?} */
            const arrayBuffer = new ArrayBuffer(byteString.length);
            // 创建缓冲数组
            /** @type {?} */
            const intArray = new Uint8Array(arrayBuffer);
            for (let i = 0; i < byteString.length; i++) {
                intArray[i] = byteString.charCodeAt(i);
            }
            /** @type {?} */
            const blob = new Blob([intArray]);
            self.cloudprintService.openRendedViewer('tab', blob, options);
        }), (/**
         * @param {?} error
         * @return {?}
         */
        error => {
            self.formErrorService.exception(error.Message, error);
        }));
    }
    /**
     * @param {?} params
     * @param {?} queryRelativeUrl
     * @return {?}
     */
    getData(params, queryRelativeUrl) {
        /** @type {?} */
        const self = this;
        /** @type {?} */
        let uri = this.serverHost;
        if (this.loadDataUri) {
            uri += this.loadDataUri;
        }
        else {
            uri += !queryRelativeUrl ? '/api/runtime/bcc/v1.0/qdpsearch/query' : (queryRelativeUrl + 'querydata');
        }
        params = !queryRelativeUrl ? params : { 'Param': params };
        /** @type {?} */
        const result$ = !queryRelativeUrl ? this.restfulService.post(uri, params, {}, this.createHeaderSessionId())
            : this.restfulService.put(uri, params, {}, this.createHeaderSessionId());
        return result$.pipe(map((/**
         * @param {?} data
         * @return {?}
         */
        (data) => {
            if (data) {
                data = !queryRelativeUrl ? data : data.returnValue;
                if (data && data.pageInfo) {
                    self.pageInfoChange.next(data.pageInfo);
                }
                if (data && data.variables) {
                    self.variablesChange.next(data.variables);
                }
                if (data && data.dropDownOption) {
                    self.inSuiteDropDownInfo = data.dropDownOption;
                    self.inSuiteDropDownInfoChange.next(data.dropDownOption);
                }
            }
            return data;
        })));
    }
    /**
     * @param {?} params
     * @param {?} queryRelativeUrl
     * @return {?}
     */
    getCol(params, queryRelativeUrl) {
        /** @type {?} */
        const self = this;
        /** @type {?} */
        let uri = this.serverHost;
        if (this.loadDataCol) {
            uri += this.loadDataCol;
        }
        else {
            uri += (!queryRelativeUrl ? '/api/runtime/bcc/v1.0/qdpsearch/' : queryRelativeUrl) + 'querycol';
        }
        params = !queryRelativeUrl ? params : { 'Param': params };
        /** @type {?} */
        const result$ = !queryRelativeUrl ? this.restfulService.post(uri, params, {}, this.createHeaderSessionId())
            : this.restfulService.put(uri, params, {}, this.createHeaderSessionId());
        return result$.pipe(map((/**
         * @param {?} data
         * @return {?}
         */
        (data) => {
            if (data) {
                data = !queryRelativeUrl ? data : data.returnValue;
            }
            return data;
        })));
    }
    /**
     * @param {?} params
     * @param {?} queryRelativeUrl
     * @return {?}
     */
    getCrosstabTemplate(params, queryRelativeUrl) {
        /** @type {?} */
        const self = this;
        /** @type {?} */
        let uri = this.serverHost;
        if (this.loadDataUri) {
            uri += this.loadDataUri;
        }
        else {
            uri += !queryRelativeUrl ? '/api/runtime/bcc/v1.0/qdpsearch/getcrosstabtemplate' : (queryRelativeUrl + 'getcrosstabtemplate');
        }
        params = !queryRelativeUrl ? params : { 'Param': params };
        /** @type {?} */
        const result$ = !queryRelativeUrl ? this.restfulService.post(uri, params, {}, this.createHeaderSessionId())
            : this.restfulService.put(uri, params, {}, this.createHeaderSessionId());
        return result$.pipe(map((/**
         * @param {?} result
         * @return {?}
         */
        (result) => {
            if (result) {
                result = !queryRelativeUrl ? result : (result && result.returnValue) ? JSON.parse(result.returnValue) : undefined;
            }
            return result;
        })));
    }
    /**
     * @return {?}
     */
    getSpreadLicense() {
        /** @type {?} */
        const uri = '/api/runtime/bcc/v1.0/qdpschemamanager/getSpreadLicense';
        /** @type {?} */
        const result$ = this.restfulService.get(uri, {}, this.createHeaderSessionId());
        return result$.pipe(map((/**
         * @param {?} data
         * @return {?}
         */
        (data) => {
            return data.spreadjs;
        })));
    }
    /**
     * @param {?} params
     * @return {?}
     */
    clearCache(params) {
        /** @type {?} */
        const self = this;
        /** @type {?} */
        const uri = this.serverHost + '/api/runtime/bcc/v1.0/qdpsearch/clearcache';
        /** @type {?} */
        const result$ = this.restfulService.post(uri, params, {}, this.createHeaderSessionId());
        return result$.pipe(map((/**
         * @param {?} result
         * @return {?}
         */
        (result) => {
            return result;
        })));
    }
    /**
     * @private
     * @return {?}
     */
    createHeaderSessionId() {
        return RtfServices.createHeaderSessionId(this.sessionService);
    }
}
LcpService.decorators = [
    { type: Injectable }
];
/** @nocollapse */
LcpService.ctorParameters = () => [
    { type: RestfulService },
    { type: SessionService },
    { type: String, decorators: [{ type: Inject, args: [Server_Host,] }, { type: Optional }] },
    { type: String, decorators: [{ type: Inject, args: [Load_Data_Uri,] }, { type: Optional }] },
    { type: String, decorators: [{ type: Inject, args: [Load_Data_Col,] }, { type: Optional }] }
];
if (false) {
    /** @type {?} */
    LcpService.prototype.pageInfoChange;
    /** @type {?} */
    LcpService.prototype.variablesChange;
    /** @type {?} */
    LcpService.prototype.inSuiteDropDownInfoChange;
    /** @type {?} */
    LcpService.prototype.inSuiteDropDownInfo;
    /** @type {?} */
    LcpService.prototype.cloudprintService;
    /** @type {?} */
    LcpService.prototype.formErrorService;
    /** @type {?} */
    LcpService.prototype.loading;
    /**
     * @type {?}
     * @private
     */
    LcpService.prototype.restfulService;
    /**
     * @type {?}
     * @private
     */
    LcpService.prototype.sessionService;
    /**
     * @type {?}
     * @private
     */
    LcpService.prototype.serverHost;
    /**
     * @type {?}
     * @private
     */
    LcpService.prototype.loadDataUri;
    /**
     * @type {?}
     * @private
     */
    LcpService.prototype.loadDataCol;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGNwLnNlcnZpY2UuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AcWRwL2NvbW1vbi8iLCJzb3VyY2VzIjpbImxpYi9zZXJ2aWNlL2xjcC1zZXJ2aWNlL2xjcC5zZXJ2aWNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sRUFBRSxRQUFRLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDN0QsT0FBTyxFQUFFLFdBQVcsRUFBRSxhQUFhLEVBQUUsYUFBYSxFQUFFLE1BQU0sNkJBQTZCLENBQUM7QUFDeEYsT0FBTyxFQUFjLE9BQU8sRUFBRSxNQUFNLE1BQU0sQ0FBQztBQUMzQyxPQUFPLEVBQUUsR0FBRyxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFDckMsT0FBTyxFQUFFLGNBQWMsRUFBRSxNQUFNLHFCQUFxQixDQUFDO0FBQ3JELE9BQU8sRUFBRSxjQUFjLEVBQUUsTUFBTSxvQ0FBb0MsQ0FBQztBQUNwRSxPQUFPLEVBQUUsV0FBVyxFQUFFLE1BQU0sNEJBQTRCLENBQUM7QUFDekQsT0FBTyxFQUFxQixRQUFRLEVBQWlCLFVBQVUsRUFBRSxTQUFTLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUd4RyxNQUFNLE9BQU8sVUFBVTs7Ozs7Ozs7SUFTckIsWUFDVSxjQUE4QixFQUM5QixjQUE4QixFQUNHLFVBQWtCLEVBQ2hCLFdBQW1CLEVBQ25CLFdBQW1CO1FBSnRELG1CQUFjLEdBQWQsY0FBYyxDQUFnQjtRQUM5QixtQkFBYyxHQUFkLGNBQWMsQ0FBZ0I7UUFDRyxlQUFVLEdBQVYsVUFBVSxDQUFRO1FBQ2hCLGdCQUFXLEdBQVgsV0FBVyxDQUFRO1FBQ25CLGdCQUFXLEdBQVgsV0FBVyxDQUFRO1FBYmhFLG1CQUFjLEdBQUcsSUFBSSxPQUFPLEVBQU8sQ0FBQztRQUNwQyxvQkFBZSxHQUFHLElBQUksT0FBTyxFQUFPLENBQUM7UUFDckMsOEJBQXlCLEdBQUcsSUFBSSxPQUFPLEVBQU8sQ0FBQztJQVkzQyxDQUFD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QUM5RCxpQ0FBOEQiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJbmplY3RhYmxlLCBJbmplY3QsIE9wdGlvbmFsIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IFNlcnZlcl9Ib3N0LCBMb2FkX0RhdGFfVXJpLCBMb2FkX0RhdGFfQ29sIH0gZnJvbSAnLi4vLi4vZW50aXR0aWVzL3NlcnZlci5ob3N0JztcclxuaW1wb3J0IHsgT2JzZXJ2YWJsZSwgU3ViamVjdCB9IGZyb20gJ3J4anMnO1xyXG5pbXBvcnQgeyBtYXAgfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XHJcbmltcG9ydCB7IFNlc3Npb25TZXJ2aWNlIH0gZnJvbSAnQGVjcC1jYWYvY2FmLWNvbW1vbic7XHJcbmltcG9ydCB7IFJlc3RmdWxTZXJ2aWNlIH0gZnJvbSAnLi4vcmVzdGZ1bC1zZXJ2aWNlL3Jlc3RmdWwuc2VydmljZSc7XHJcbmltcG9ydCB7IFJ0ZlNlcnZpY2VzIH0gZnJvbSAnLi4vcnRmc2VydmljZXMvcnRmc2VydmljZXMnO1xyXG5pbXBvcnQgeyBDbG91ZHByaW50U2VydmljZSwgRmlsZVR5cGUsIE91dHB1dE9wdGlvbnMsIE91dHB1dFR5cGUsIFByaW50VHlwZSB9IGZyb20gJ0Bnc3Atc3ZjL2Nsb3VkcHJpbnQnO1xyXG5cclxuQEluamVjdGFibGUoKVxyXG5leHBvcnQgY2xhc3MgTGNwU2VydmljZSB7XHJcbiAgcGFnZUluZm9DaGFuZ2UgPSBuZXcgU3ViamVjdDxhbnk+KCk7XHJcbiAgdmFyaWFibGVzQ2hhbmdlID0gbmV3IFN1YmplY3Q8YW55PigpO1xyXG4gIGluU3VpdGVEcm9wRG93bkluZm9DaGFuZ2UgPSBuZXcgU3ViamVjdDxhbnk+KCk7XHJcbiAgaW5TdWl0ZURyb3BEb3duSW5mbzogYW55O1xyXG4gIGNsb3VkcHJpbnRTZXJ2aWNlOiBDbG91ZHByaW50U2VydmljZTtcclxuICBmb3JtRXJyb3JTZXJ2aWNlOiBhbnk7XHJcbiAgbG9hZGluZzogYW55O1xyXG5cclxuICBjb25zdHJ1Y3RvcihcclxuICAgIHByaXZhdGUgcmVzdGZ1bFNlcnZpY2U6IFJlc3RmdWxTZXJ2aWNlLFxyXG4gICAgcHJpdmF0ZSBzZXNzaW9uU2VydmljZTogU2Vzc2lvblNlcnZpY2UsXHJcbiAgICBASW5qZWN0KFNlcnZlcl9Ib3N0KSBAT3B0aW9uYWwoKSBwcml2YXRlIHNlcnZlckhvc3Q6IHN0cmluZyxcclxuICAgIEBJbmplY3QoTG9hZF9EYXRhX1VyaSkgQE9wdGlvbmFsKCkgcHJpdmF0ZSBsb2FkRGF0YVVyaTogc3RyaW5nLFxyXG4gICAgQEluamVjdChMb2FkX0RhdGFfQ29sKSBAT3B0aW9uYWwoKSBwcml2YXRlIGxvYWREYXRhQ29sOiBzdHJpbmdcclxuICApIHsgfVxyXG5cclxuICBleHBvcnREYXRhKHBhcmFtczogYW55LCBxdWVyeVJlbGF0aXZlVXJsOiBhbnkpIHtcclxuICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xyXG4gICAgbGV0IHVyaSA9IHRoaXMuc2VydmVySG9zdDtcclxuICAgIGlmICh0aGlzLmxvYWREYXRhVXJpKSB7XHJcbiAgICAgIHVyaSArPSB0aGlzLmxvYWREYXRhVXJpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdXJpICs9ICghcXVlcnlSZWxhdGl2ZVVybCA/ICcvYXBpL3J1bnRpbWUvYmNjL3YxLjAvcWRwc2VhcmNoLycgOiBxdWVyeVJlbGF0aXZlVXJsKSArICdleHBvcnQnO1xyXG4gICAgfVxyXG4gICAgY29uc3QgY29uZmlnID0ge1xyXG4gICAgICByZXNwb25zZVR5cGU6ICdhcHBsaWNhdGlvbi9qc29uJyAvLyDooajmmI7ov5Tlm57mnI3liqHlmajov5Tlm57nmoTmlbDmja7nsbvlnotcclxuICAgIH07XHJcbiAgICBPYmplY3QuYXNzaWduKGNvbmZpZywgdGhpcy5jcmVhdGVIZWFkZXJTZXNzaW9uSWQoKSk7XHJcbiAgICBjb25zdCBmaWxlTmFtZSA9IHBhcmFtcy5leGNlbEV4cG9ydE5hbWUgKyAnLnhsc3gnO1xyXG4gICAgcGFyYW1zID0gIXF1ZXJ5UmVsYXRpdmVVcmwgPyBwYXJhbXMgOiB7ICdQYXJhbSc6IHBhcmFtcyB9O1xyXG4gICAgY29uc3QgcmVzdWx0JCA9ICFxdWVyeVJlbGF0aXZlVXJsID8gdGhpcy5yZXN0ZnVsU2VydmljZS5wb3N0KHVyaSwgcGFyYW1zLCB7fSwgY29uZmlnKVxyXG4gICAgICA6IHRoaXMucmVzdGZ1bFNlcnZpY2UucHV0KHVyaSwgcGFyYW1zLCB7fSwgY29uZmlnKTtcclxuICAgIHJlc3VsdCQudG9Qcm9taXNlKCkudGhlbihkYXRhID0+IHtcclxuICAgICAgZGF0YSA9ICFxdWVyeVJlbGF0aXZlVXJsID8gZGF0YSA6IEpTT04ucGFyc2UoZGF0YSkucmV0dXJuVmFsdWU7XHJcbiAgICAgIGNvbnN0IGJ5dGVTdHJpbmcgPSBhdG9iKGRhdGEpOyAvLyBiYXNlNjQg6Kej56CBXHJcbiAgICAgIGNvbnN0IGFycmF5QnVmZmVyID0gbmV3IEFycmF5QnVmZmVyKGJ5dGVTdHJpbmcubGVuZ3RoKTsgLy8g5Yib5bu657yT5Yay5pWw57uEXHJcbiAgICAgIGNvbnN0IGludEFycmF5ID0gbmV3IFVpbnQ4QXJyYXkoYXJyYXlCdWZmZXIpOyAvLyDliJvlu7rop4blm75cclxuXHJcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYnl0ZVN0cmluZy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIGludEFycmF5W2ldID0gYnl0ZVN0cmluZy5jaGFyQ29kZUF0KGkpO1xyXG4gICAgICB9XHJcbiAgICAgIGNvbnN0IGJsb2IgPSBuZXcgQmxvYihbaW50QXJyYXldLCB7IHR5cGU6ICdhcHBsaWNhdGlvbi92bmQubXMtZXhjZWwnIH0pO1xyXG4gICAgICBpZiAoJ2Rvd25sb2FkJyBpbiBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJykpIHsgLy8g6Z2eSUXkuIvovb1cclxuICAgICAgICBjb25zdCBlbGluayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTtcclxuICAgICAgICBlbGluay5kb3dubG9hZCA9IGZpbGVOYW1lO1xyXG4gICAgICAgIGVsaW5rLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XHJcbiAgICAgICAgZWxpbmsuaHJlZiA9IFVSTC5jcmVhdGVPYmplY3RVUkwoYmxvYik7XHJcbiAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChlbGluayk7XHJcbiAgICAgICAgZWxpbmsuY2xpY2soKTtcclxuICAgICAgICBVUkwucmV2b2tlT2JqZWN0VVJMKGVsaW5rLmhyZWYpOyAvLyDph4rmlL5VUkwg5a+56LGhXHJcbiAgICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChlbGluayk7XHJcbiAgICAgIH0gZWxzZSB7IC8vIElFMTAr5LiL6L29XHJcbiAgICAgICAgbmF2aWdhdG9yLm1zU2F2ZUJsb2IoYmxvYiwgZmlsZU5hbWUpO1xyXG4gICAgICB9XHJcbiAgICAgIHNlbGYubG9hZGluZy5jbG9zZSgpO1xyXG4gICAgfSwgZXJyb3IgPT4ge1xyXG4gICAgICBzZWxmLmZvcm1FcnJvclNlcnZpY2UuZXhjZXB0aW9uKGVycm9yLk1lc3NhZ2UsIGVycm9yKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgYXlzbkV4cG9ydERhdGEocGFyYW1zOiBhbnksIHF1ZXJ5UmVsYXRpdmVVcmw6IGFueSkge1xyXG4gICAgY29uc3Qgc2VsZiA9IHRoaXM7XHJcbiAgICBsZXQgdXJpID0gdGhpcy5zZXJ2ZXJIb3N0O1xyXG4gICAgaWYgKHRoaXMubG9hZERhdGFVcmkpIHtcclxuICAgICAgdXJpICs9IHRoaXMubG9hZERhdGFVcmk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB1cmkgKz0gKCFxdWVyeVJlbGF0aXZlVXJsID8gJy9hcGkvcnVudGltZS9iY2MvdjEuMC9xZHBzZWFyY2gvJyA6IHF1ZXJ5UmVsYXRpdmVVcmwpICsgJ2V4cG9ydCc7XHJcbiAgICB9XHJcbiAgICBjb25zdCBjb25maWcgPSB7XHJcbiAgICAgIHJlc3BvbnNlVHlwZTogJ2FwcGxpY2F0aW9uL2pzb24nIC8vIOihqOaYjui/lOWbnuacjeWKoeWZqOi/lOWbnueahOaVsOaNruexu+Wei1xyXG4gICAgfTtcclxuICAgIE9iamVjdC5hc3NpZ24oY29uZmlnLCB0aGlzLmNyZWF0ZUhlYWRlclNlc3Npb25JZCgpKTtcclxuICAgIHBhcmFtcy5hc3luYyA9IDE7XHJcbiAgICBwYXJhbXMgPSAhcXVlcnlSZWxhdGl2ZVVybCA/IHBhcmFtcyA6IHsgJ1BhcmFtJzogcGFyYW1zIH07XHJcbiAgICBjb25zdCByZXN1bHQkID0gIXF1ZXJ5UmVsYXRpdmVVcmwgPyB0aGlzLnJlc3RmdWxTZXJ2aWNlLnBvc3QodXJpLCBwYXJhbXMsIHt9LCBjb25maWcpXHJcbiAgICAgIDogdGhpcy5yZXN0ZnVsU2VydmljZS5wdXQodXJpLCBwYXJhbXMsIHt9LCBjb25maWcpO1xyXG4gICAgcmVzdWx0JC50b1Byb21pc2UoKS50aGVuKGRhdGEgPT4ge1xyXG4gICAgICBkYXRhID0gIXF1ZXJ5UmVsYXRpdmVVcmwgPyBkYXRhIDogSlNPTi5wYXJzZShkYXRhKS5yZXR1cm5WYWx1ZTtcclxuICAgICAgaWYgKGRhdGEpIHtcclxuICAgICAgfVxyXG4gICAgfSwgZXJyb3IgPT4ge1xyXG4gICAgICBzZWxmLmZvcm1FcnJvclNlcnZpY2UuZXhjZXB0aW9uKGVycm9yLk1lc3NhZ2UsIGVycm9yKTtcclxuICAgIH0pXHJcbiAgfVxyXG5cclxuICBwZGZFeHBvcnRFdmVudChwYXJhbXM6IGFueSwgcXVlcnlSZWxhdGl2ZVVybDogYW55KSB7XHJcbiAgICBjb25zdCBzZWxmID0gdGhpcztcclxuICAgIGxldCB1cmkgPSB0aGlzLnNlcnZlckhvc3Q7XHJcbiAgICBpZiAodGhpcy5sb2FkRGF0YVVyaSkge1xyXG4gICAgICB1cmkgKz0gdGhpcy5sb2FkRGF0YVVyaTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHVyaSArPSAoIXF1ZXJ5UmVsYXRpdmVVcmwgPyAnL2FwaS9ydW50aW1lL2JjYy92MS4wL3FkcHNlYXJjaC8nIDogcXVlcnlSZWxhdGl2ZVVybCkgKyAncHJpbnQnO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGNvbmZpZyA9IHtcclxuICAgICAgcmVzcG9uc2VUeXBlOiAnYXBwbGljYXRpb24vanNvbicgLy8g6KGo5piO6L+U5Zue5pyN5Yqh5Zmo6L+U5Zue55qE5pWw5o2u57G75Z6LXHJcbiAgICB9O1xyXG4gICAgT2JqZWN0LmFzc2lnbihjb25maWcsIHRoaXMuY3JlYXRlSGVhZGVyU2Vzc2lvbklkKCkpO1xyXG4gICAgcGFyYW1zID0gIXF1ZXJ5UmVsYXRpdmVVcmwgPyBwYXJhbXMgOiB7ICdQYXJhbSc6IHBhcmFtcyB9O1xyXG4gICAgY29uc3QgZmlsZU5hbWUgPSBwYXJhbXMuUGFyYW0gJiYgcGFyYW1zLlBhcmFtLmV4Y2VsRXhwb3J0TmFtZSA/IHBhcmFtcy5QYXJhbS5leGNlbEV4cG9ydE5hbWUgKyAnJyA6IHBhcmFtcy5leGNlbEV4cG9ydE5hbWUgKyAnJztcclxuICAgIGNvbnN0IHJlc3VsdCQgPSAhcXVlcnlSZWxhdGl2ZVVybCA/IHRoaXMucmVzdGZ1bFNlcnZpY2UucG9zdCh1cmksIHBhcmFtcywge30sIGNvbmZpZylcclxuICAgICAgOiB0aGlzLnJlc3RmdWxTZXJ2aWNlLnB1dCh1cmksIHBhcmFtcywge30sIGNvbmZpZyk7XHJcbiAgICByZXN1bHQkLnRvUHJvbWlzZSgpLnRoZW4oZGF0YSA9PiB7XHJcbiAgICAgIGRhdGEgPSAhcXVlcnlSZWxhdGl2ZVVybCA/IGRhdGEgOiBKU09OLnBhcnNlKGRhdGEpLnJldHVyblZhbHVlO1xyXG4gICAgICBjb25zdCBieXRlU3RyaW5nID0gYXRvYihkYXRhKTsgLy8gYmFzZTY0IOino+eggVxyXG4gICAgICBjb25zdCBhcnJheUJ1ZmZlciA9IG5ldyBBcnJheUJ1ZmZlcihieXRlU3RyaW5nLmxlbmd0aCk7IC8vIOWIm+W7uue8k+WGsuaVsOe7hFxyXG4gICAgICBjb25zdCBpbnRBcnJheSA9IG5ldyBVaW50OEFycmF5KGFycmF5QnVmZmVyKTsgLy8g5Yib5bu66KeG5Zu+XHJcblxyXG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGJ5dGVTdHJpbmcubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICBpbnRBcnJheVtpXSA9IGJ5dGVTdHJpbmcuY2hhckNvZGVBdChpKTtcclxuICAgICAgfVxyXG4gICAgICBjb25zdCBibG9iID0gbmV3IEJsb2IoW2ludEFycmF5XSwgeyB0eXBlOiAnYXBwbGljYXRpb24vcGRmJyB9KTtcclxuICAgICAgaWYgKCdkb3dubG9hZCcgaW4gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpKSB7IC8vIOmdnklF5LiL6L29XHJcbiAgICAgICAgY29uc3QgZWxpbmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XHJcbiAgICAgICAgZWxpbmsuZG93bmxvYWQgPSBmaWxlTmFtZTtcclxuICAgICAgICBlbGluay5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xyXG4gICAgICAgIGVsaW5rLmhyZWYgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKGJsb2IpO1xyXG4gICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoZWxpbmspO1xyXG4gICAgICAgIGVsaW5rLmNsaWNrKCk7XHJcbiAgICAgICAgVVJMLnJldm9rZU9iamVjdFVSTChlbGluay5ocmVmKTsgLy8g6YeK5pS+VVJMIOWvueixoVxyXG4gICAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQoZWxpbmspO1xyXG4gICAgICB9IGVsc2UgeyAvLyBJRTEwK+S4i+i9vVxyXG4gICAgICAgIG5hdmlnYXRvci5tc1NhdmVCbG9iKGJsb2IsIGZpbGVOYW1lKTtcclxuICAgICAgfVxyXG4gICAgfSwgZXJyb3IgPT4ge1xyXG4gICAgICBzZWxmLmZvcm1FcnJvclNlcnZpY2UuZXhjZXB0aW9uKGVycm9yLk1lc3NhZ2UsIGVycm9yKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgcHJpbnRQcmVWaWV3KHBhcmFtczogYW55LCBxdWVyeVJlbGF0aXZlVXJsOiBhbnkpIHtcclxuICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xyXG4gICAgbGV0IHVyaSA9IHRoaXMuc2VydmVySG9zdDtcclxuICAgIGlmICh0aGlzLmxvYWREYXRhVXJpKSB7XHJcbiAgICAgIHVyaSArPSB0aGlzLmxvYWREYXRhVXJpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdXJpICs9ICghcXVlcnlSZWxhdGl2ZVVybCA/ICcvYXBpL3J1bnRpbWUvYmNjL3YxLjAvcWRwc2VhcmNoLycgOiBxdWVyeVJlbGF0aXZlVXJsKSArICdwcmludCc7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgY29uZmlnID0ge1xyXG4gICAgICByZXNwb25zZVR5cGU6ICdhcHBsaWNhdGlvbi9qc29uJyAvLyDooajmmI7ov5Tlm57mnI3liqHlmajov5Tlm57nmoTmlbDmja7nsbvlnotcclxuICAgIH07XHJcbiAgICBPYmplY3QuYXNzaWduKGNvbmZpZywgdGhpcy5jcmVhdGVIZWFkZXJTZXNzaW9uSWQoKSk7XHJcbiAgICBwYXJhbXMgPSAhcXVlcnlSZWxhdGl2ZVVybCA/IHBhcmFtcyA6IHsgJ1BhcmFtJzogcGFyYW1zIH07XHJcbiAgICBjb25zdCBmaWxlTmFtZSA9IHBhcmFtcy5QYXJhbSAmJiBwYXJhbXMuUGFyYW0uZXhjZWxFeHBvcnROYW1lID8gcGFyYW1zLlBhcmFtLmV4Y2VsRXhwb3J0TmFtZSArICcnIDogcGFyYW1zLmV4Y2VsRXhwb3J0TmFtZSArICcnO1xyXG4gICAgY29uc3QgcmVzdWx0JCA9ICFxdWVyeVJlbGF0aXZlVXJsID8gdGhpcy5yZXN0ZnVsU2VydmljZS5wb3N0KHVyaSwgcGFyYW1zLCB7fSwgY29uZmlnKVxyXG4gICAgICA6IHRoaXMucmVzdGZ1bFNlcnZpY2UucHV0KHVyaSwgcGFyYW1zLCB7fSwgY29uZmlnKTtcclxuICAgIHJlc3VsdCQudG9Qcm9taXNlKCkudGhlbihkYXRhID0+IHtcclxuICAgICAgZGF0YSA9ICFxdWVyeVJlbGF0aXZlVXJsID8gZGF0YSA6IEpTT04ucGFyc2UoZGF0YSkucmV0dXJuVmFsdWU7XHJcbiAgICAgIGNvbnN0IG9wdGlvbnM6IE91dHB1dE9wdGlvbnMgPSB7XHJcbiAgICAgICAgT3V0cHV0VHlwZTogT3V0cHV0VHlwZS5QUklOVCxcclxuICAgICAgICBGaWxlVHlwZTogRmlsZVR5cGUuUGRmLFxyXG4gICAgICAgIFBhdGg6ICcnLFxyXG4gICAgICAgIERldmljZUlkOiAnJyxcclxuICAgICAgICBwcmludFR5cGU6IFByaW50VHlwZS5RdWVyeSxcclxuICAgICAgICBwcmludEpvYjogZmFsc2UsXHJcbiAgICAgICAgcHJpbnRlck5hbWU6ICcnLFxyXG4gICAgICAgIHByaW50U2V0dGluZzogbnVsbFxyXG4gICAgICB9O1xyXG4gICAgICBjb25zdCBieXRlU3RyaW5nID0gYXRvYihkYXRhKTsgLy8gYmFzZTY0IOino+eggVxyXG4gICAgICBjb25zdCBhcnJheUJ1ZmZlciA9IG5ldyBBcnJheUJ1ZmZlcihieXRlU3RyaW5nLmxlbmd0aCk7IC8vIOWIm+W7uue8k+WGsuaVsOe7hFxyXG4gICAgICBjb25zdCBpbnRBcnJheSA9IG5ldyBVaW50OEFycmF5KGFycmF5QnVmZmVyKTsgLy8g5Yib5bu66KeG5Zu+XHJcblxyXG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGJ5dGVTdHJpbmcubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICBpbnRBcnJheVtpXSA9IGJ5dGVTdHJpbmcuY2hhckNvZGVBdChpKTtcclxuICAgICAgfVxyXG4gICAgICBjb25zdCBibG9iID0gbmV3IEJsb2IoW2ludEFycmF5XSk7XHJcbiAgICAgIHNlbGYuY2xvdWRwcmludFNlcnZpY2Uub3BlblJlbmRlZFZpZXdlcigndGFiJywgYmxvYiwgb3B0aW9ucyk7XHJcbiAgICB9LCBlcnJvciA9PiB7XHJcbiAgICAgIHNlbGYuZm9ybUVycm9yU2VydmljZS5leGNlcHRpb24oZXJyb3IuTWVzc2FnZSwgZXJyb3IpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBnZXREYXRhKHBhcmFtczogYW55LCBxdWVyeVJlbGF0aXZlVXJsOiBhbnkpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgY29uc3Qgc2VsZiA9IHRoaXM7XHJcbiAgICBsZXQgdXJpID0gdGhpcy5zZXJ2ZXJIb3N0O1xyXG4gICAgaWYgKHRoaXMubG9hZERhdGFVcmkpIHtcclxuICAgICAgdXJpICs9IHRoaXMubG9hZERhdGFVcmk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB1cmkgKz0gIXF1ZXJ5UmVsYXRpdmVVcmwgPyAnL2FwaS9ydW50aW1lL2JjYy92MS4wL3FkcHNlYXJjaC9xdWVyeScgOiAocXVlcnlSZWxhdGl2ZVVybCArICdxdWVyeWRhdGEnKTtcclxuICAgIH1cclxuICAgIHBhcmFtcyA9ICFxdWVyeVJlbGF0aXZlVXJsID8gcGFyYW1zIDogeyAnUGFyYW0nOiBwYXJhbXMgfTtcclxuICAgIGNvbnN0IHJlc3VsdCQgPSAhcXVlcnlSZWxhdGl2ZVVybCA/IHRoaXMucmVzdGZ1bFNlcnZpY2UucG9zdCh1cmksIHBhcmFtcywge30sIHRoaXMuY3JlYXRlSGVhZGVyU2Vzc2lvbklkKCkpXHJcbiAgICAgIDogdGhpcy5yZXN0ZnVsU2VydmljZS5wdXQodXJpLCBwYXJhbXMsIHt9LCB0aGlzLmNyZWF0ZUhlYWRlclNlc3Npb25JZCgpKTtcclxuICAgIHJldHVybiByZXN1bHQkLnBpcGUoXHJcbiAgICAgIG1hcCgoZGF0YTogYW55KSA9PiB7XHJcbiAgICAgICAgaWYgKGRhdGEpIHtcclxuICAgICAgICAgIGRhdGEgPSAhcXVlcnlSZWxhdGl2ZVVybCA/IGRhdGEgOiBkYXRhLnJldHVyblZhbHVlO1xyXG4gICAgICAgICAgaWYgKGRhdGEgJiYgZGF0YS5wYWdlSW5mbykge1xyXG4gICAgICAgICAgICBzZWxmLnBhZ2VJbmZvQ2hhbmdlLm5leHQoZGF0YS5wYWdlSW5mbyk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBpZiAoZGF0YSAmJiBkYXRhLnZhcmlhYmxlcykge1xyXG4gICAgICAgICAgICBzZWxmLnZhcmlhYmxlc0NoYW5nZS5uZXh0KGRhdGEudmFyaWFibGVzKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGlmIChkYXRhICYmIGRhdGEuZHJvcERvd25PcHRpb24pIHtcclxuICAgICAgICAgICAgc2VsZi5pblN1aXRlRHJvcERvd25JbmZvID0gZGF0YS5kcm9wRG93bk9wdGlvbjtcclxuICAgICAgICAgICAgc2VsZi5pblN1aXRlRHJvcERvd25JbmZvQ2hhbmdlLm5leHQoZGF0YS5kcm9wRG93bk9wdGlvbik7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBkYXRhO1xyXG4gICAgICB9KVxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIGdldENvbChwYXJhbXM6IGFueSwgcXVlcnlSZWxhdGl2ZVVybDogYW55KTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xyXG4gICAgbGV0IHVyaSA9IHRoaXMuc2VydmVySG9zdDtcclxuICAgIGlmICh0aGlzLmxvYWREYXRhQ29sKSB7XHJcbiAgICAgIHVyaSArPSB0aGlzLmxvYWREYXRhQ29sO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdXJpICs9ICghcXVlcnlSZWxhdGl2ZVVybCA/ICcvYXBpL3J1bnRpbWUvYmNjL3YxLjAvcWRwc2VhcmNoLycgOiBxdWVyeVJlbGF0aXZlVXJsKSArICdxdWVyeWNvbCc7XHJcbiAgICB9XHJcbiAgICBwYXJhbXMgPSAhcXVlcnlSZWxhdGl2ZVVybCA/IHBhcmFtcyA6IHsgJ1BhcmFtJzogcGFyYW1zIH07XHJcbiAgICBjb25zdCByZXN1bHQkID0gIXF1ZXJ5UmVsYXRpdmVVcmwgPyB0aGlzLnJlc3RmdWxTZXJ2aWNlLnBvc3QodXJpLCBwYXJhbXMsIHt9LCB0aGlzLmNyZWF0ZUhlYWRlclNlc3Npb25JZCgpKVxyXG4gICAgICA6IHRoaXMucmVzdGZ1bFNlcnZpY2UucHV0KHVyaSwgcGFyYW1zLCB7fSwgdGhpcy5jcmVhdGVIZWFkZXJTZXNzaW9uSWQoKSk7XHJcbiAgICByZXR1cm4gcmVzdWx0JC5waXBlKFxyXG4gICAgICBtYXAoKGRhdGE6IGFueSkgPT4ge1xyXG4gICAgICAgIGlmIChkYXRhKSB7XHJcbiAgICAgICAgICBkYXRhID0gIXF1ZXJ5UmVsYXRpdmVVcmwgPyBkYXRhIDogZGF0YS5yZXR1cm5WYWx1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGRhdGE7XHJcbiAgICAgIH0pXHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgZ2V0Q3Jvc3N0YWJUZW1wbGF0ZShwYXJhbXM6IGFueSwgcXVlcnlSZWxhdGl2ZVVybDogYW55KSB7XHJcbiAgICBjb25zdCBzZWxmID0gdGhpcztcclxuICAgIGxldCB1cmkgPSB0aGlzLnNlcnZlckhvc3Q7XHJcbiAgICBpZiAodGhpcy5sb2FkRGF0YVVyaSkge1xyXG4gICAgICB1cmkgKz0gdGhpcy5sb2FkRGF0YVVyaTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHVyaSArPSAhcXVlcnlSZWxhdGl2ZVVybCA/ICcvYXBpL3J1bnRpbWUvYmNjL3YxLjAvcWRwc2VhcmNoL2dldGNyb3NzdGFidGVtcGxhdGUnIDogKHF1ZXJ5UmVsYXRpdmVVcmwgKyAnZ2V0Y3Jvc3N0YWJ0ZW1wbGF0ZScpO1xyXG4gICAgfVxyXG4gICAgcGFyYW1zID0gIXF1ZXJ5UmVsYXRpdmVVcmwgPyBwYXJhbXMgOiB7ICdQYXJhbSc6IHBhcmFtcyB9O1xyXG4gICAgY29uc3QgcmVzdWx0JCA9ICFxdWVyeVJlbGF0aXZlVXJsID8gdGhpcy5yZXN0ZnVsU2VydmljZS5wb3N0KHVyaSwgcGFyYW1zLCB7fSwgdGhpcy5jcmVhdGVIZWFkZXJTZXNzaW9uSWQoKSlcclxuICAgICAgOiB0aGlzLnJlc3RmdWxTZXJ2aWNlLnB1dCh1cmksIHBhcmFtcywge30sIHRoaXMuY3JlYXRlSGVhZGVyU2Vzc2lvbklkKCkpO1xyXG4gICAgcmV0dXJuIHJlc3VsdCQucGlwZShcclxuICAgICAgbWFwKChyZXN1bHQ6IGFueSkgPT4ge1xyXG4gICAgICAgIGlmIChyZXN1bHQpIHtcclxuICAgICAgICAgIHJlc3VsdCA9ICFxdWVyeVJlbGF0aXZlVXJsID8gcmVzdWx0IDogKHJlc3VsdCAmJiByZXN1bHQucmV0dXJuVmFsdWUpID8gSlNPTi5wYXJzZShyZXN1bHQucmV0dXJuVmFsdWUpIDogdW5kZWZpbmVkO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICB9KVxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIGdldFNwcmVhZExpY2Vuc2UoKSB7XHJcbiAgICBjb25zdCB1cmkgPSAnL2FwaS9ydW50aW1lL2JjYy92MS4wL3FkcHNjaGVtYW1hbmFnZXIvZ2V0U3ByZWFkTGljZW5zZSc7XHJcbiAgICBjb25zdCByZXN1bHQkID0gdGhpcy5yZXN0ZnVsU2VydmljZS5nZXQodXJpLCB7fSwgdGhpcy5jcmVhdGVIZWFkZXJTZXNzaW9uSWQoKSk7XHJcbiAgICByZXR1cm4gcmVzdWx0JC5waXBlKFxyXG4gICAgICBtYXAoKGRhdGE6IGFueSkgPT4ge1xyXG4gICAgICAgIHJldHVybiBkYXRhLnNwcmVhZGpzO1xyXG4gICAgICB9KVxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIGNsZWFyQ2FjaGUocGFyYW1zOiBhbnkpIHtcclxuICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xyXG4gICAgY29uc3QgdXJpID0gdGhpcy5zZXJ2ZXJIb3N0ICsgJy9hcGkvcnVudGltZS9iY2MvdjEuMC9xZHBzZWFyY2gvY2xlYXJjYWNoZSc7XHJcbiAgICBjb25zdCByZXN1bHQkID0gdGhpcy5yZXN0ZnVsU2VydmljZS5wb3N0KHVyaSwgcGFyYW1zLCB7fSwgdGhpcy5jcmVhdGVIZWFkZXJTZXNzaW9uSWQoKSk7XHJcbiAgICByZXR1cm4gcmVzdWx0JC5waXBlKFxyXG4gICAgICBtYXAoKHJlc3VsdDogYW55KSA9PiB7XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgfSlcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGNyZWF0ZUhlYWRlclNlc3Npb25JZCgpIHtcclxuICAgIHJldHVybiBSdGZTZXJ2aWNlcy5jcmVhdGVIZWFkZXJTZXNzaW9uSWQodGhpcy5zZXNzaW9uU2VydmljZSk7XHJcbiAgfVxyXG59XHJcbiJdfQ==