/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
// tslint:disable-next-line:max-line-length
import { Component, Input, Optional, ViewChild, Renderer2, ViewEncapsulation, ComponentFactoryResolver, Injector, Output, EventEmitter, TemplateRef } from '@angular/core';
import { DialogComponent } from '@farris/ui-dialog';
import { RtfAppHelpComponent } from '@gsp-sys/rtf-ui';
import { RtfAppHelpComponent as RtfApplicationHelpComponent } from '@gsp-sys/rtf-apphelp';
import { JointSearchService } from '../../service/joint-search/joint-search.service';
import { EventBus } from '@qdp/common';
import { DatagridComponent } from '@farris/ui-datagrid';
import { of } from 'rxjs';
import { findIndex } from 'lodash-es';
import { EditorTypes } from '@farris/ui-datagrid-editors';
import { LocalizeService } from '@qdp/localize';
import { ExpressionService } from '@gsp-svc/expression';
export class JointSearchComponent {
    /**
     * @param {?} renderer
     * @param {?} resolver
     * @param {?} jointSearchService
     * @param {?} injector
     */
    constructor(renderer, resolver, jointSearchService, injector) {
        this.renderer = renderer;
        this.resolver = resolver;
        this.jointSearchService = jointSearchService;
        this.injector = injector;
        this.closeModal = new EventEmitter();
        // 模态框确定后关闭，并传递参数
        this.submitModal = new EventEmitter();
        this.editorParams = {};
        // 查询ID
        this.formId = 'form' + 'ff3ea474-cc65-23b0-cdb1-73c9146cea3b'; // 当前表单ID
        this.modalConfig = {
            title: '联查映射',
            width: 900,
            height: 800,
            showButtons: true
        };
        this.functionSubDatas = []; // 数据
        // 数据
        this.functionParaDatas = [];
        this.size = {};
        this.paraColumns = [];
        this.SubColumns = [];
        this.displaystyle = [
            { 'name': '右键联查', value: 1 },
            { 'name': '超链联查', value: 2 }
        ];
        this.QueryInfoDatas = [];
        this.languages = [];
        this._currentConditionInput = null;
        this.functionParaDatasOfSub = [];
        this.handlebeforeClose = (/**
         * @return {?}
         */
        () => {
            this.dg.endRowEdit();
            this.dg1.endRowEdit();
            return of(true);
        });
        if (this.injector) {
            this.localizeService = this.injector.get(LocalizeService);
            this.language = this.localizeService.language;
            this.expressionService = this.injector.get(ExpressionService);
            this.modalConfig.title = this.localizeService.getValue('ideCmp.drillDown.drillDownName');
            this.displaystyle = this.localizeService.getValue('ideCmp.drillDown.displayStyle');
        }
    }
    /**
     * @return {?}
     */
    ngOnDestroy() {
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        this.dropDownInitForIDE();
        this.gridInit();
    }
    /**
     * @param {?} changes
     * @return {?}
     */
    ngOnChanges(changes) {
        for (const changeName in changes) {
            /** @type {?} */
            const newValue = changes[changeName].currentValue;
            if (newValue !== null && newValue !== void 0) {
                switch (changeName) {
                    case 'editorParams':
                        this.dropDownInitForIDE();
                        break;
                }
            }
        }
    }
    /**
     * @private
     * @return {?}
     */
    dropDownInitForIDE() {
        /** @type {?} */
        const self = this;
        self.formId = 'form' + 'ff3ea474-cc65-23b0-cdb1-73c9146cea3b';
        if (self.editorParams && self.editorParams.queryId) {
            self.queryId = self.editorParams.queryId;
            self.sessionId = self.editorParams.sessionId;
            self.queryRelativeUrl = self.editorParams.queryRelativeUrl;
            self.qoManagerCode = self.editorParams.qoManagerCode;
            self.domJson = self.editorParams.domJson;
            self.viewModelFields = [];
            self.getViewModelFields();
            self.jointSearchService.getLanguageList().subscribe((/**
             * @param {?} data
             * @return {?}
             */
            (data) => {
                if (data && data.length) {
                    data.forEach((/**
                     * @param {?} e
                     * @return {?}
                     */
                    (e) => {
                        self.languages.push({ code: e.code.toLowerCase(), name: e.description });
                    }));
                }
                self.jointSearchService.getjointsearch(self.formId, self.queryId, self.queryRelativeUrl).subscribe((/**
                 * @param {?} data
                 * @return {?}
                 */
                data => {
                    if (data != null) {
                        self.functionSubDatas = JSON.parse(data.joinSearch);
                        self.functionParaDatas = JSON.parse(data.jointparam);
                        // tslint:disable-next-line:prefer-for-of
                        for (let i = 0; i < self.functionSubDatas.length; i++) {
                            if (self.functionSubDatas[i].jointserachdisplaystyle === 2) {
                                self.dg.showColumn('linkfield');
                                break;
                            }
                        }
                    }
                }));
                /** @type {?} */
                const params = {};
                params['qoManagerCode'] = self.qoManagerCode;
                params['pageIndex'] = 0;
                params['schemaId'] = '';
                params['entityData'] = '';
                params['extendCond'] = '';
                self.jointSearchService.getCol(params, self.queryRelativeUrl).subscribe((/**
                 * @param {?} value
                 * @return {?}
                 */
                value => {
                    if (value && value.dynamicCols) {
                        self.dynamicCols = value.dynamicCols;
                    }
                }));
            }));
        }
    }
    /**
     * @return {?}
     */
    gridInit() {
        /** @type {?} */
        const self = this;
        /** @type {?} */
        const enumOpts = { valueField: 'value', textField: 'name', data: this.displaystyle };
        this.SubColumns = [
            { field: 'functioncode', width: 160, title: self.localizeService.getValue('ideCmp.drillDown.columnHeader')[0], template: this.functioncodeTemp },
            { field: 'functionname', width: 100, title: self.localizeService.getValue('ideCmp.drillDown.columnHeader')[1], template: this.functionNameTemp },
            // { field: 'jointsearchid', width: 100, title: self.localizeService.getValue('ideCmp.drillDown.columnHeader')[2], editor: { type: EditorTypes.TEXTBOX, options: {} } },
            {
                field: 'jointserachdisplaystyle', width: 100, title: self.localizeService.getValue('ideCmp.drillDown.columnHeader')[3],
                formatter: { type: 'enum', options: enumOpts },
                editor: { type: EditorTypes.COMBOLIST, options: {
                        data: this.displaystyle,
                        idField: 'value',
                        textField: 'name',
                        selectChange: this.selectChange.bind(this)
                    }
                }
            },
            { field: 'linkfield', width: 100, title: self.localizeService.getValue('ideCmp.drillDown.columnHeader')[6], visible: false, editor: { type: EditorTypes.TEXTBOX, options: {} } },
            {
                field: 'visibleformula', width: 100, title: self.localizeService.getValue('ideCmp.drillDown.columnHeader')[4],
                editor: {
                    type: EditorTypes.INPUTGROUP, options: {
                        groupText: '<i class="f-icon f-icon-lookup"></i>',
                        clickHandle: (/**
                         * @param {?} e
                         * @return {?}
                         */
                        (e) => {
                            this._currentConditionInput = e;
                            this.inputCondExp();
                        })
                    },
                }
            },
        ];
        this.paraColumns = [
            { field: 'para', width: 100, title: self.localizeService.getValue('ideCmp.drillDown.paramColumnHeader')[0], editor: { type: EditorTypes.TEXTBOX, options: {} } },
            { field: 'paraname', width: 100, title: self.localizeService.getValue('ideCmp.drillDown.paramColumnHeader')[1], editor: { type: EditorTypes.TEXTBOX, options: {} } },
            { field: 'paravalue', width: 100, title: self.localizeService.getValue('ideCmp.drillDown.paramColumnHeader')[2], editor: { type: EditorTypes.TEXTBOX, options: {} } },
            {
                field: 'paravaluetype', width: 100, title: self.localizeService.getValue('ideCmp.drillDown.paramColumnHeader')[3], editor: { type: EditorTypes.CHECKBOX, options: {} },
                formatter: { type: 'boolean', options: { trueText: self.localizeService.getValue('ideCmp.drillDown.enumExpress')[0], falseText: self.localizeService.getValue('ideCmp.drillDown.enumExpress')[1] } }
            },
        ];
    }
    /**
     * @private
     * @param {?} $event
     * @return {?}
     */
    selectChange($event) {
        // console.log($event);
        /** @type {?} */
        const self = this;
        if (($event.value.data.value - 0) === 2) {
            this.dg.showColumn('linkfield');
        }
        else {
            this.dg.hideColumn('linkfield');
        }
        if (this.dg.selectedRow) {
            /** @type {?} */
            const index = findIndex(this.functionSubDatas, (/**
             * @param {?} n
             * @return {?}
             */
            function (n) {
                return n.id === self.dg.selectedRow.id;
            }));
            self.functionSubDatas[index].jointserachdisplaystyle = $event.value.data.value;
            self.functionSubDatas = [...self.functionSubDatas];
        }
    }
    /**
     * @private
     * @return {?}
     */
    getViewModelFields() {
        if (this.domJson) {
            /** @type {?} */
            const component = this.domJson.module.components.find((/**
             * @param {?} x
             * @return {?}
             */
            x => x.componentType === 'Frame'));
            this.recursiveGetViewModelFields(component, null);
        }
    }
    /**
     * @private
     * @param {?} component
     * @param {?} contents
     * @return {?}
     */
    recursiveGetViewModelFields(component, contents) {
        if (component) {
            if (component.type === 'QdpFramework') {
                if (component && component.params && component.params.length) {
                    for (const field of component.params) {
                        this.viewModelFields.push(field.ParamCode);
                    }
                }
            }
            else if (component.contents && component.contents.length) {
                this.recursiveGetViewModelFields(null, component.contents);
            }
        }
        else {
            for (let i = 0; i < contents.length; i++) {
                if (contents[i].type === 'QdpFramework') {
                    if (contents[i] && contents[i].params && contents[i].params.length) {
                        for (const field of contents[i].params) {
                            this.viewModelFields.push(field.ParamCode);
                        }
                    }
                }
                else if (contents[i].contents && contents[i].contents.length) {
                    this.recursiveGetViewModelFields(null, contents[i].contents);
                }
            }
        }
    }
    /**
     * @param {?} event
     * @return {?}
     */
    onResized(event) {
        this.size.height = event.newHeight;
        this.size.width = event.newWidth;
    }
    /**
     * @return {?}
     */
    clickCancel() {
        this.closeModal.emit();
    }
    /**
     * @return {?}
     */
    clickConfirm() {
        /** @type {?} */
        const self = this;
        self.dg.endRowEdit();
        self.dg1.endRowEdit();
        if (self.functionSubDatas.length > 0) {
            self.jointSearchService.savejointsearch({ Id: EventBus.guid(), joinsearch: JSON.stringify(self.functionSubDatas), jointparam: JSON.stringify(self.functionParaDatas), queryid: self.queryId, FormId: self.formId }, this.queryRelativeUrl).subscribe();
        }
        else {
            self.jointSearchService.deletejointsearch(self.formId, self.queryId, this.queryRelativeUrl).subscribe();
            self.functionSubDatas = [];
            self.functionParaDatas = [];
            self.functionParaDatasOfSub = [];
        }
        this.selectedIndex = -1;
        this.submitModal.emit({ value: this.functionSubDatas });
    }
    /**
     * @return {?}
     */
    handleDialogShow() {
        this.farrisDialog.show();
    }
    /**
     * @return {?}
     */
    addSubHandler() {
        this.functionSubDatas.push({
            'id': EventBus.guid(),
            'queryParaID': this.queryId,
            'searchtype': '',
            'functioncode': '',
            'functionname': null,
            'appEntrance': '',
            'jointsearchid': '',
            'jointserachdisplaystyle': 1,
            'linkfield': '',
            'visibleformula': '',
            'doubleclikjoinsearch': true,
            'destinationqueryId': ''
        });
        this.dg.refresh();
    }
    /**
     * @return {?}
     */
    removeSubHandler() {
        /** @type {?} */
        const self = this;
        if (self.dg.selectedRow) {
            /** @type {?} */
            const id = self.dg.selectedRow.id;
            /** @type {?} */
            const index = findIndex(self.functionSubDatas, (/**
             * @param {?} n
             * @return {?}
             */
            function (n) {
                return n.id === id;
            }));
            self.functionSubDatas.splice(index, 1);
            self.functionSubDatas = [...self.functionSubDatas];
            if (self.functionSubDatas.length === 0) {
                self.functionParaDatas = [];
                self.functionParaDatasOfSub = [];
            }
            else {
                /** @type {?} */
                const params = [];
                // tslint:disable-next-line:prefer-for-of
                for (let i = 0; i < this.functionParaDatas.length; i++) {
                    if (self.functionParaDatas[i].functionid !== id) {
                        params.push(self.functionParaDatas[i]);
                    }
                }
                self.functionParaDatas.push(...params);
            }
            this.dg.refresh();
            this.dg1.refresh();
        }
    }
    /**
     * @param {?} type
     * @return {?}
     */
    cancelSubHandler(type) {
        this.dg.endRowEdit();
    }
    /**
     * @param {?} data
     * @return {?}
     */
    getFunctionName(data) {
        /** @type {?} */
        let local = 'zh-chs';
        if ((!gsp && !gsp.cache) && gspframeworkService) {
            local = gspframeworkService.rtf.language.getLanguageCode().toLowerCase();
        }
        if (!local) {
            local = 'zh-chs';
        }
        return data[local] ? data[local] : data;
    }
    /**
     * @return {?}
     */
    openFunc() {
        this.appHelp.showHelp(this.sessionId);
    }
    /**
     * @return {?}
     */
    openApp() {
        this.rtfappHelp.showHelp(this.sessionId);
    }
    /**
     * @param {?} $event
     * @return {?}
     */
    selectedFunc($event) {
        /** @type {?} */
        const self = this;
        if (self.dg.selectedRow) {
            /** @type {?} */
            const index = findIndex(self.functionSubDatas, (/**
             * @param {?} n
             * @return {?}
             */
            function (n) {
                return n.id === self.dg.selectedRow.id;
            }));
            self.functionSubDatas[index].functioncode = $event[0].Id;
            self.functionSubDatas[index].functionname = { 'zh-chs': $event[0].Name };
            self.functionSubDatas[index].searchtype = 'func';
            /** @type {?} */
            let staticParam = $event[0].InvokingConfig.staticParams;
            if (staticParam) {
                staticParam = JSON.parse(staticParam);
                for (const staticPara of staticParam) {
                    if (staticPara.name === 'queryId') {
                        self.functionSubDatas[index].destinationqueryId = staticPara.value;
                    }
                }
            }
            self.functionSubDatas = [...self.functionSubDatas];
        }
    }
    /**
     * @param {?} $event
     * @return {?}
     */
    selectedApp($event) {
        /** @type {?} */
        const self = this;
        if (self.dg.selectedRow) {
            /** @type {?} */
            const index = findIndex(this.functionSubDatas, (/**
             * @param {?} n
             * @return {?}
             */
            function (n) {
                return n.id === self.dg.selectedRow.id;
            }));
            self.functionSubDatas[index].functioncode = $event.selectedInvok[0].appId;
            self.functionSubDatas[index].functionname = { 'zh-chs': $event.selectedInvok[0].name };
            self.functionSubDatas[index].appEntrance = $event.selectedInvok[0].appEntrance;
            self.functionSubDatas[index].searchtype = 'app';
            /** @type {?} */
            let staticParam = $event.selectedInvok[0].staticParams;
            if (staticParam) {
                staticParam = JSON.parse(staticParam);
                for (const staticPara of staticParam) {
                    if (staticPara.name === 'queryId') {
                        self.functionSubDatas[index].destinationqueryId = staticPara.value;
                    }
                }
            }
            self.functionSubDatas = [...self.functionSubDatas];
        }
    }
    /**
     * @param {?} event
     * @return {?}
     */
    findIndex(event) {
        this.selectedIndex = event.data.id;
        this.functionParaDatasOfSub = this.functionParaDatas.filter((/**
         * @param {?} x
         * @return {?}
         */
        x => x.functionid === this.selectedIndex));
        this.dg.endRowEdit();
        this.dg1.endRowEdit();
    }
    /**
     * @param {?} event
     * @return {?}
     */
    cancelEditedPara(event) {
        this.dg1.endRowEdit();
    }
    /**
     * @return {?}
     */
    inputCondExp() {
        /** @type {?} */
        const self = this;
        if (self.dg.selectedRow) {
            /** @type {?} */
            const id = self.dg.selectedRow.id;
            /** @type {?} */
            const index = findIndex(self.functionSubDatas, (/**
             * @param {?} n
             * @return {?}
             */
            function (n) {
                return n.id === id;
            }));
            if (this.viewModelFields) {
                for (const code of this.viewModelFields) {
                    this.expressionService.addContext({
                        key: '@P_' + code,
                        name: code,
                        description: ''
                    });
                }
            }
            // 结果集列信息放进上下文
            if (this.dynamicCols) {
                this.dynamicCols.forEach((/**
                 * @param {?} element
                 * @return {?}
                 */
                element => {
                    this.expressionService.addContext({
                        key: '@R_' + element.bindField,
                        name: element.name,
                        description: ''
                    });
                }));
            }
            self.expressionService.addExpressionText(self.functionSubDatas[index].visibleformula);
            self.expressionService.buildExpression().then((/**
             * @param {?} expressStr
             * @return {?}
             */
            expressStr => {
                self.functionSubDatas[index].visibleformula = expressStr;
                // if (self.dg) {
                //   self.dg.refresh();
                //   self.dg.data = self.functionSubDatas;
                // }
                self.functionSubDatas = [...self.functionSubDatas];
                if (self._currentConditionInput) {
                    self._currentConditionInput.formControl.setValue(expressStr);
                }
            }));
        }
    }
    /**
     * @return {?}
     */
    addParaHandler() {
        /** @type {?} */
        const functionid = this.selectedIndex;
        if (functionid !== -1) {
            this.functionParaDatas.push({
                'id': EventBus.guid(),
                'functionid': functionid,
                'para': '',
                'paraname': '',
                'paravalue': '',
                'paravaluetype': false
            });
            this.functionParaDatasOfSub = this.functionParaDatas.filter((/**
             * @param {?} x
             * @return {?}
             */
            x => x.functionid === this.selectedIndex));
        }
        this.dg1.refresh();
    }
    /**
     * @return {?}
     */
    removeParaHandler() {
        /** @type {?} */
        const self = this;
        if (self.dg1.selectedRow) {
            /** @type {?} */
            const index = findIndex(self.functionParaDatas, (/**
             * @param {?} n
             * @return {?}
             */
            function (n) {
                return n.id === self.dg1.selectedRow.id;
            }));
            self.functionParaDatas.splice(index, 1);
            self.functionParaDatasOfSub = self.functionParaDatas.filter((/**
             * @param {?} x
             * @return {?}
             */
            x => x.functionid === this.selectedIndex));
            self.functionParaDatasOfSub = [...self.functionParaDatasOfSub];
        }
    }
}
JointSearchComponent.decorators = [
    { type: Component, args: [{
                selector: 'joint-search',
                template: "<div class=\"f-utils-flex-column h-100\">\r\n  <div class=\"f-utils-flex-column\" style=\" flex: 1 1 0\">\r\n    <div class=\"f-utils-fill-flex-column farris-split-section m-1 farris-overflow-hidden\">\r\n      <div class=\"farris-form farris-card-content-bg h-100\" (resized)=\"onResized($event)\">\r\n        <fieldSet style=\"height: 11% !important;\">\r\n          <button id=\"addSubFilterRow\" class=\"btn btn-primary mr-1 mb-1\" (click)=\"addSubHandler()\">{{localizeService.getValue('ideCmp.drillDown.btnAdd')}}</button>\r\n          <button id=\"addSubFilterRow\" class=\"btn btn-secondary mr-1 mb-1\" (click)=\"removeSubHandler()\">{{localizeService.getValue('ideCmp.drillDown.btnDelete')}}</button>\r\n          <button id=\"addSubFilterRow\" class=\"btn btn-secondary mr-1 mb-1\" (click)=\"cancelSubHandler($event)\">{{localizeService.getValue('ideCmp.drillDown.btnCancel')}}</button>\r\n        </fieldSet>\r\n        <div class=\"f-utils-fill\" style=\"height: 89% !important;\">\r\n          <farris-datagrid id=\"gridFunctionSub2\" [data]=\"functionSubDatas\"\r\n                           [columns]=\"SubColumns\" #dg=\"datagrid\"\r\n                           [fit]=\"true\" [editable]=\"true\" [editMode]=\"'cell'\"\r\n                           [showCheckbox]=\"false\" [fitColumns]=\"true\"\r\n                           [showLineNumber]=\"true\" [striped]=\"true\"\r\n                           [virtualized]=\"true\" [pagination]=\"false\"\r\n                           (selectChanged)=findIndex($event)>\r\n\r\n          </farris-datagrid>\r\n          <ng-template #functioncodeTemp let-ctx>\r\n            <div class=\"f-datagrid-cell-formgroup farris-group-auto\">\r\n              <input [disabled]=\"true\" type=\"text\" class=\"form-control\" name=\"name\"\r\n                     [(ngModel)]=\"ctx.rowData['functioncode']\">\r\n              <button id=\"functionSelect\" class=\"btn f-rt-btn f-btn-ml btn-secondary\" (click)=\"openFunc()\">\r\n                {{localizeService.getValue('ideCmp.drillDown.menuBtn')}}\r\n              </button>\r\n              <button id=\"appSelect\" class=\"btn f-rt-btn f-btn-ml btn-secondary\" (click)=\"openApp()\">\r\n                {{localizeService.getValue('ideCmp.drillDown.appBtn')}}\r\n              </button>\r\n              <app-rtf-app-help #appHelp (afterHelpConfirm)=\"selectedFunc($event)\" [languageCode]=\"language\"></app-rtf-app-help>\r\n              <app-rtf-application-help #rtfappHelp [initSelectKeys]=\"\" (afterHelpConfirm)=\"selectedApp($event)\" [languageCode]=\"language\"></app-rtf-application-help>\r\n            </div>\r\n          </ng-template>\r\n          <ng-template #functionNameTemp let-ctx>\r\n            <language-textbox [languages]=\"languages\" [(ngModel)]=\"ctx.rowData['functionname']\"></language-textbox>\r\n          </ng-template>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n\r\n  <div class=\"f-utils-flex-column\" style=\" flex: 1 1 0\">\r\n    <div class=\"f-utils-fill-flex-column farris-split-section m-1 farris-overflow-hidden\">\r\n      <div class=\"farris-form farris-card-content-bg h-100\" (resized)=\"onResized($event)\">\r\n        <fieldSet style=\"height: 11% !important;\">\r\n          <button id=\"addFilterRow\" class=\"btn btn-primary mr-1 mb-1\" (click)=\"addParaHandler()\">{{localizeService.getValue('ideCmp.drillDown.btnAdd')}}</button>\r\n          <button id=\"addFilterRow\" class=\"btn btn-secondary mr-1 mb-1\" (click)=\"removeParaHandler()\">{{localizeService.getValue('ideCmp.drillDown.btnDelete')}}</button>\r\n          <button id=\"addFilterRow\" class=\"btn btn-secondary mr-1 mb-1\" (click)=\"cancelEditedPara($event)\">{{localizeService.getValue('ideCmp.drillDown.btnCancel')}}</button>\r\n        </fieldSet>\r\n        <div class=\"f-utils-fill\" style=\"height: 89% !important;\">\r\n          <farris-datagrid id=\"gridFunctionPara2\" [data]=\"functionParaDatasOfSub\"\r\n                           [columns]=\"paraColumns\" #dg1=\"datagrid\"\r\n                           [fit]=\"true\"\r\n                           [editable]=\"true\" [editMode]=\"'cell'\" [showCheckbox]=\"false\" [fitColumns]=\"true\"\r\n                           [showLineNumber]=\"true\" [striped]=\"true\" [total]=\"0\" [pageSize]=\"100\"\r\n                           [virtualized]=\"true\" [pagination]=\"false\">\r\n          </farris-datagrid>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n  <ng-template #enumFooter>\r\n    <button type=\"button\" class=\"btn btn-secondary\" (click)=\"clickCancel()\">{{localizeService.getValue('ideCmp.drillDown.btnCancel')}}</button>\r\n    <button type=\"button\" class=\"btn btn-primary\" (click)=\"clickConfirm()\">{{localizeService.getValue('ideCmp.drillDown.btnOK')}}</button>\r\n  </ng-template>\r\n",
                encapsulation: ViewEncapsulation.None,
                styles: ["tr .center{text-align:center}"]
            }] }
];
/** @nocollapse */
JointSearchComponent.ctorParameters = () => [
    { type: Renderer2 },
    { type: ComponentFactoryResolver },
    { type: JointSearchService },
    { type: Injector, decorators: [{ type: Optional }] }
];
JointSearchComponent.propDecorators = {
    closeModal: [{ type: Output }],
    submitModal: [{ type: Output }],
    editorParams: [{ type: Input }],
    modalFooter: [{ type: ViewChild, args: ['enumFooter',] }],
    dg: [{ type: ViewChild, args: ['dg',] }],
    dg1: [{ type: ViewChild, args: ['dg1',] }],
    farrisDialog: [{ type: ViewChild, args: ['farrisDialog',] }],
    appHelp: [{ type: ViewChild, args: ['appHelp',] }],
    rtfappHelp: [{ type: ViewChild, args: ['rtfappHelp',] }],
    functioncodeTemp: [{ type: ViewChild, args: ['functioncodeTemp',] }],
    functionNameTemp: [{ type: ViewChild, args: ['functionNameTemp',] }]
};
if (false) {
    /** @type {?} */
    JointSearchComponent.prototype.closeModal;
    /** @type {?} */
    JointSearchComponent.prototype.submitModal;
    /** @type {?} */
    JointSearchComponent.prototype.editorParams;
    /** @type {?} */
    JointSearchComponent.prototype.queryId;
    /** @type {?} */
    JointSearchComponent.prototype.formId;
    /** @type {?} */
    JointSearchComponent.prototype.sessionId;
    /** @type {?} */
    JointSearchComponent.prototype.queryRelativeUrl;
    /** @type {?} */
    JointSearchComponent.prototype.qoManagerCode;
    /** @type {?} */
    JointSearchComponent.prototype.dynamicCols;
    /** @type {?} */
    JointSearchComponent.prototype.domJson;
    /** @type {?} */
    JointSearchComponent.prototype.viewModelFields;
    /** @type {?} */
    JointSearchComponent.prototype.modalFooter;
    /** @type {?} */
    JointSearchComponent.prototype.modalConfig;
    /** @type {?} */
    JointSearchComponent.prototype.functionSubDatas;
    /** @type {?} */
    JointSearchComponent.prototype.functionParaDatas;
    /** @type {?} */
    JointSearchComponent.prototype.size;
    /**
     * @type {?}
     * @private
     */
    JointSearchComponent.prototype.selectedIndex;
    /** @type {?} */
    JointSearchComponent.prototype.paraColumns;
    /** @type {?} */
    JointSearchComponent.prototype.SubColumns;
    /** @type {?} */
    JointSearchComponent.prototype.displaystyle;
    /** @type {?} */
    JointSearchComponent.prototype.QueryInfoDatas;
    /** @type {?} */
    JointSearchComponent.prototype.localizeService;
    /** @type {?} */
    JointSearchComponent.prototype.expressionService;
    /** @type {?} */
    JointSearchComponent.prototype.languages;
    /** @type {?} */
    JointSearchComponent.prototype.language;
    /** @type {?} */
    JointSearchComponent.prototype._currentConditionInput;
    /** @type {?} */
    JointSearchComponent.prototype.functionParaDatasOfSub;
    /** @type {?} */
    JointSearchComponent.prototype.dg;
    /** @type {?} */
    JointSearchComponent.prototype.dg1;
    /** @type {?} */
    JointSearchComponent.prototype.farrisDialog;
    /** @type {?} */
    JointSearchComponent.prototype.appHelp;
    /** @type {?} */
    JointSearchComponent.prototype.rtfappHelp;
    /** @type {?} */
    JointSearchComponent.prototype.functioncodeTemp;
    /** @type {?} */
    JointSearchComponent.prototype.functionNameTemp;
    /** @type {?} */
    JointSearchComponent.prototype.handlebeforeClose;
    /**
     * @type {?}
     * @private
     */
    JointSearchComponent.prototype.renderer;
    /**
     * @type {?}
     * @private
     */
    JointSearchComponent.prototype.resolver;
    /**
     * @type {?}
     * @private
     */
    JointSearchComponent.prototype.jointSearchService;
    /**
     * @type {?}
     * @private
     */
    JointSearchComponent.prototype.injector;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiam9pbnQtc2VhcmNoLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BxZHAvaWRlLWNtcC8iLCJzb3VyY2VzIjpbImxpYi9jb21wb25lbnQvam9pbnQtc2VhcmNoL2pvaW50LXNlYXJjaC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFDQSxPQUFPLEVBQUUsU0FBUyxFQUFxQixLQUFLLEVBQUUsUUFBUSxFQUE0QixTQUFTLEVBQUUsU0FBUyxFQUFFLGlCQUFpQixFQUFFLHdCQUF3QixFQUFFLFFBQVEsRUFBRSxNQUFNLEVBQUUsWUFBWSxFQUFFLFdBQVcsRUFBVSxNQUFNLGVBQWUsQ0FBQztBQUNoTyxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0sbUJBQW1CLENBQUM7QUFDcEQsT0FBTyxFQUFFLG1CQUFtQixFQUFFLE1BQU0saUJBQWlCLENBQUM7QUFDdEQsT0FBTyxFQUFFLG1CQUFtQixJQUFJLDJCQUEyQixFQUFFLE1BQU0sc0JBQXNCLENBQUM7QUFDMUYsT0FBTyxFQUFFLGtCQUFrQixFQUFFLE1BQU0saURBQWlELENBQUM7QUFDckYsT0FBTyxFQUFFLFFBQVEsRUFBRSxNQUFNLGFBQWEsQ0FBQztBQUN2QyxPQUFPLEVBQUUsaUJBQWlCLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUN4RCxPQUFPLEVBQWMsRUFBRSxFQUFFLE1BQU0sTUFBTSxDQUFDO0FBQ3RDLE9BQU8sRUFBRSxTQUFTLEVBQUUsTUFBTSxXQUFXLENBQUM7QUFDdEMsT0FBTyxFQUFFLFdBQVcsRUFBRSxNQUFNLDZCQUE2QixDQUFDO0FBQzFELE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDaEQsT0FBTyxFQUFFLGlCQUFpQixFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFheEQsTUFBTSxPQUFPLG9CQUFvQjs7Ozs7OztJQXFEL0IsWUFDVSxRQUFtQixFQUNuQixRQUFrQyxFQUNsQyxrQkFBc0MsRUFDMUIsUUFBa0I7UUFIOUIsYUFBUSxHQUFSLFFBQVEsQ0FBVztRQUNuQixhQUFRLEdBQVIsUUFBUSxDQUEwQjtRQUNsQyx1QkFBa0IsR0FBbEIsa0JBQWtCLENBQW9CO1FBQzFCLGFBQVEsR0FBUixRQUFRLENBQVU7UUF2RDlCLGVBQVUsR0FBRyxJQUFJLFlBQVksRUFBTyxDQUFDOztRQUVyQyxnQkFBVyxHQUFHLElBQUksWUFBWSxFQUFPLENBQUM7UUFDdkMsaUJBQVksR0FBUSxFQUFFLENBQUM7O1FBRWhDLFdBQU0sR0FBUSxNQUFNLEdBQUcsc0NBQXNDLENBQUMsQ0FBQyxTQUFTO1FBU3hFLGdCQUFXLEdBQUc7WUFDWixLQUFLLEVBQUUsTUFBTTtZQUNiLEtBQUssRUFBRSxHQUFHO1lBQ1YsTUFBTSxFQUFFLEdBQUc7WUFDWCxXQUFXLEVBQUUsSUFBSTtTQUNsQixDQUFDO1FBRUYscUJBQWdCLEdBQVEsRUFBRSxDQUFDLENBQUMsS0FBSzs7UUFDakMsc0JBQWlCLEdBQVEsRUFBRSxDQUFDO1FBQzVCLFNBQUksR0FBUSxFQUFFLENBQUM7UUFFZixnQkFBVyxHQUFRLEVBQUUsQ0FBQztRQUN0QixlQUFVLEdBQVEsRUFBRSxDQUFDO1FBQ3JCLGlCQUFZLEdBQVE7WUFDbEIsRUFBRSxNQUFNLEVBQUUsTUFBTSxFQUFFLEtBQUssRUFBRSxDQUFDLEVBQUU7WUFDNUIsRUFBRSxNQUFNLEVBQUUsTUFBTSxFQUFFLEtBQUssRUFBRSxDQUFDLEVBQUU7U0FDN0IsQ0FBQztRQUNGLG1CQUFjLEdBQVEsRUFBRSxDQUFDO1FBSXpCLGNBQVMsR0FBRyxFQUFFLENBQUM7UUFHZiwyQkFBc0IsR0FBRyxJQUFJLENBQUM7UUFFOUIsMkJBQXNCLEdBQVEsRUFBRSxDQUFDO1FBc05qQyxzQkFBaUI7OztRQUFHLEdBQW9CLEVBQUU7WUFDeEMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxVQUFVLEVBQUUsQ0FBQztZQUNyQixJQUFJLENBQUMsR0FBRyxDQUFDLFVBQVUsRUFBRSxDQUFDO1lBQ3RCLE9BQU8sRUFBRSxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ2xCLENBQUMsRUFBQTtRQXpNQyxJQUFJLElBQUksQ0FBQyxRQUFRLEVBQUU7WUFDakIsSUFBSSxDQUFDLGVBQWUsR0FBRyxJQUFJLENBQUMsUUFBUSxDQUFDLEdBQUcsQ0FBQyxlQUFlLENBQUMsQ0FBQztZQUMxRCxJQUFJLENBQUMsUUFBUSxHQUFHLElBQUksQ0FBQyxlQUFlLENBQUMsUUFBUSxDQUFDO1lBQzlDLElBQUksQ0FBQyxpQkFBaUIsR0FBRyxJQUFJLENBQUMsUUFBUSxDQUFDLEdBQUcsQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDO1lBQzlELElBQUksQ0FBQyxXQUFXLENBQUMsS0FBSyxHQUFHLElBQUksQ0FBQyxlQUFlLENBQUMsUUFBUSxDQUFDLGdDQUFnQyxDQUFDLENBQUM7WUFDekYsSUFBSSxDQUFDLFlBQVksR0FBRyxJQUFJLENBQUMsZUFBZSxDQUFDLFFBQVEsQ0FBQywrQkFBK0IsQ0FBQyxDQUFDO1NBQ3BGO0lBQ0gsQ0FBQzs7OztJQUVELFdBQVc7SUFDWCxDQUFDOzs7O0lBRUQsUUFBUTtRQUNOLElBQUksQ0FBQyxrQkFBa0IsRUFBRSxDQUFDO1FBQzFCLElBQUksQ0FBQyxRQUFRLEVBQUUsQ0FBQztJQUNsQixDQUFDOzs7OztJQUVELFdBQVcsQ0FBQyxPQUFzQjtRQUNoQyxLQUFLLE1BQU0sVUFBVSxJQUFJLE9BQU8sRUFBRTs7a0JBQzFCLFFBQVEsR0FBRyxPQUFPLENBQUMsVUFBVSxDQUFDLENBQUMsWUFBWTtZQUNqRCxJQUFJLFFBQVEsS0FBSyxJQUFJLElBQUksUUFBUSxLQUFLLEtBQUssQ0FBQyxFQUFFO2dCQUM1QyxRQUFRLFVBQVUsRUFBRTtvQkFDbEIsS0FBSyxjQUFjO3dCQUNqQixJQUFJLENBQUMsa0JBQWtCLEVBQUUsQ0FBQzt3QkFDMUIsTUFBTTtpQkFDVDthQUNGO1NBQ0Y7SUFDSCxDQUFDOzs7OztJQUVPLGtCQUFrQjs7Y0FDbEIsSUFBSSxHQUFHLElBQUk7UUFDakIsSUFBSSxDQUFDLE1BQU0sR0FBRyxNQUFNLEdBQUcsc0NBQXNDLENBQUM7UUFDOUQsSUFBSSxJQUFJLENBQUMsWUFBWSxJQUFJLElBQUksQ0FBQyxZQUFZLENBQUMsT0FBTyxFQUFFO1lBQ2xELElBQUksQ0FBQyxPQUFPLEdBQUcsSUFBSSxDQUFDLFlBQVksQ0FBQyxPQUFPLENBQUM7WUFDekMsSUFBSSxDQUFDLFNBQVMsR0FBRyxJQUFJLENBQUMsWUFBWSxDQUFDLFNBQVMsQ0FBQztZQUM3QyxJQUFJLENBQUMsZ0JBQWdCLEdBQUcsSUFBSSxDQUFDLFlBQVksQ0FBQyxnQkFBZ0IsQ0FBQztZQUMzRCxJQUFJLENBQUMsYUFBYSxHQUFHLElBQUksQ0FBQyxZQUFZLENBQUMsYUFBYSxDQUFDO1lBQ3JELElBQUksQ0FBQyxPQUFPLEdBQUcsSUFBSSxDQUFDLFlBQVksQ0FBQyxPQUFPLENBQUM7WUFDekMsSUFBSSxDQUFDLGVBQWUsR0FBRyxFQUFFLENBQUM7WUFDMUIsSUFBSSxDQUFDLGtCQUFrQixFQUFFLENBQUM7WUFFMUIsSUFBSSxDQUFDLGtCQUFrQixDQUFDLGVBQWUsRUFBRSxDQUFDLFNBQVM7Ozs7WUFBQyxDQUFDLElBQVMsRUFBRSxFQUFFO2dCQUNoRSxJQUFJLElBQUksSUFBSSxJQUFJLENBQUMsTUFBTSxFQUFFO29CQUN2QixJQUFJLENBQUMsT0FBTzs7OztvQkFBQyxDQUFDLENBQU0sRUFBRSxFQUFFO3dCQUN0QixJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxFQUFFLElBQUksRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLFdBQVcsRUFBRSxFQUFFLElBQUksRUFBRSxDQUFDLENBQUMsV0FBVyxFQUFFLENBQUMsQ0FBQztvQkFDM0UsQ0FBQyxFQUFDLENBQUM7aUJBQ0o7Z0JBQ0QsSUFBSSxDQUFDLGtCQUFrQixDQUFDLGNBQWMsQ0FBQyxJQUFJLENBQUMsTUFBTSxFQUFFLElBQUksQ0FBQyxPQUFPLEVBQUUsSUFBSSxDQUFDLGdCQUFnQixDQUFDLENBQUMsU0FBUzs7OztnQkFDaEcsSUFBSSxDQUFDLEVBQUU7b0JBQ0wsSUFBSSxJQUFJLElBQUksSUFBSSxFQUFFO3dCQUNoQixJQUFJLENBQUMsZ0JBQWdCLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUM7d0JBQ3BELElBQUksQ0FBQyxpQkFBaUIsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsQ0FBQzt3QkFDckQseUNBQXlDO3dCQUN6QyxLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsSUFBSSxDQUFDLGdCQUFnQixDQUFDLE1BQU0sRUFBRSxDQUFDLEVBQUUsRUFBRTs0QkFDckQsSUFBSSxJQUFJLENBQUMsZ0JBQWdCLENBQUMsQ0FBQyxDQUFDLENBQUMsdUJBQXVCLEtBQUssQ0FBQyxFQUFFO2dDQUMxRCxJQUFJLENBQUMsRUFBRSxDQUFDLFVBQVUsQ0FBQyxXQUFXLENBQUMsQ0FBQztnQ0FDaEMsTUFBTTs2QkFDUDt5QkFDRjtxQkFDRjtnQkFDSCxDQUFDLEVBQUMsQ0FBQzs7c0JBRUMsTUFBTSxHQUFHLEVBQUU7Z0JBQ2pCLE1BQU0sQ0FBQyxlQUFlLENBQUMsR0FBRyxJQUFJLENBQUMsYUFBYSxDQUFDO2dCQUM3QyxNQUFNLENBQUMsV0FBVyxDQUFDLEdBQUcsQ0FBQyxDQUFDO2dCQUN4QixNQUFNLENBQUMsVUFBVSxDQUFDLEdBQUcsRUFBRSxDQUFDO2dCQUN4QixNQUFNLENBQUMsWUFBWSxDQUFDLEdBQUcsRUFBRSxDQUFDO2dCQUMxQixNQUFNLENBQUMsWUFBWSxDQUFDLEdBQUcsRUFBRSxDQUFDO2dCQUMxQixJQUFJLENBQUMsa0JBQWtCLENBQUMsTUFBTSxDQUFDLE1BQU0sRUFBRSxJQUFJLENBQUMsZ0JBQWdCLENBQUMsQ0FBQyxTQUFTOzs7O2dCQUFDLEtBQUssQ0FBQyxFQUFFO29CQUM5RSxJQUFJLEtBQUssSUFBSSxLQUFLLENBQUMsV0FBVyxFQUFFO3dCQUM5QixJQUFJLENBQUMsV0FBVyxHQUFHLEtBQUssQ0FBQyxXQUFXLENBQUM7cUJBQ3RDO2dCQUNILENBQUMsRUFBQyxDQUFDO1lBQ0wsQ0FBQyxFQUFDLENBQUM7U0FDSjtJQUNILENBQUM7Ozs7SUFFRCxRQUFROztjQUNBLElBQUksR0FBRyxJQUFJOztjQUNYLFFBQVEsR0FBRyxFQUFFLFVBQVUsRUFBRSxPQUFPLEVBQUUsU0FBUyxFQUFFLE1BQU0sRUFBRSxJQUFJLEVBQUUsSUFBSSxDQUFDLFlBQVksRUFBRTtRQUNwRixJQUFJLENBQUMsVUFBVSxHQUFHO1lBQ2hCLEVBQUUsS0FBSyxFQUFFLGNBQWMsRUFBRSxLQUFLLEVBQUUsR0FBRyxFQUFFLEtBQUssRUFBRSxJQUFJLENBQUMsZUFBZSxDQUFDLFFBQVEsQ0FBQywrQkFBK0IsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLFFBQVEsRUFBRSxJQUFJLENBQUMsZ0JBQWdCLEVBQUU7WUFDaEosRUFBRSxLQUFLLEVBQUUsY0FBYyxFQUFFLEtBQUssRUFBRSxHQUFHLEVBQUUsS0FBSyxFQUFFLElBQUksQ0FBQyxlQUFlLENBQUMsUUFBUSxDQUFDLCtCQUErQixDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsUUFBUSxFQUFFLElBQUksQ0FBQyxnQkFBZ0IsRUFBRTtZQUNoSix3S0FBd0s7WUFDeEs7Z0JBQ0UsS0FBSyxFQUFFLHlCQUF5QixFQUFFLEtBQUssRUFBRSxHQUFHLEVBQUUsS0FBSyxFQUFFLElBQUksQ0FBQyxlQUFlLENBQUMsUUFBUSxDQUFDLCtCQUErQixDQUFDLENBQUMsQ0FBQyxDQUFDO2dCQUN0SCxTQUFTLEVBQUUsRUFBRSxJQUFJLEVBQUUsTUFBTSxFQUFFLE9BQU8sRUFBRSxRQUFRLEVBQUU7Z0JBQzlDLE1BQU0sRUFBRSxFQUFFLElBQUksRUFBRSxXQUFXLENBQUMsU0FBUyxFQUFFLE9BQU8sRUFBRTt3QkFDNUMsSUFBSSxFQUFFLElBQUksQ0FBQyxZQUFZO3dCQUN2QixPQUFPLEVBQUUsT0FBTzt3QkFDaEIsU0FBUyxFQUFFLE1BQU07d0JBQ2pCLFlBQVksRUFBRSxJQUFJLENBQUMsWUFBWSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUM7cUJBQzNDO2lCQUNGO2FBQ0Y7WUFDRCxFQUFFLEtBQUssRUFBRSxXQUFXLEVBQUUsS0FBSyxFQUFFLEdBQUcsRUFBRSxLQUFLLEVBQUUsSUFBSSxDQUFDLGVBQWUsQ0FBQyxRQUFRLENBQUMsK0JBQStCLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxPQUFPLEVBQUUsS0FBSyxFQUFFLE1BQU0sRUFBRSxFQUFFLElBQUksRUFBRSxXQUFXLENBQUMsT0FBTyxFQUFFLE9BQU8sRUFBRSxFQUFFLEVBQUUsRUFBRTtZQUNoTDtnQkFDRSxLQUFLLEVBQUUsZ0JBQWdCLEVBQUUsS0FBSyxFQUFFLEdBQUcsRUFBRSxLQUFLLEVBQUUsSUFBSSxDQUFDLGVBQWUsQ0FBQyxRQUFRLENBQUMsK0JBQStCLENBQUMsQ0FBQyxDQUFDLENBQUM7Z0JBQzdHLE1BQU0sRUFBRTtvQkFDTixJQUFJLEVBQUUsV0FBVyxDQUFDLFVBQVUsRUFBRSxPQUFPLEVBQUU7d0JBQ3JDLFNBQVMsRUFBRSxzQ0FBc0M7d0JBQ2pELFdBQVc7Ozs7d0JBQUUsQ0FBQyxDQUFDLEVBQUUsRUFBRTs0QkFDakIsSUFBSSxDQUFDLHNCQUFzQixHQUFHLENBQUMsQ0FBQzs0QkFDaEMsSUFBSSxDQUFDLFlBQVksRUFBRSxDQUFDO3dCQUN0QixDQUFDLENBQUE7cUJBQ0Y7aUJBQ0Y7YUFDRjtTQUNGLENBQUM7UUFDRixJQUFJLENBQUMsV0FBVyxHQUFHO1lBQ2pCLEVBQUUsS0FBSyxFQUFFLE1BQU0sRUFBRSxLQUFLLEVBQUUsR0FBRyxFQUFFLEtBQUssRUFBRSxJQUFJLENBQUMsZUFBZSxDQUFDLFFBQVEsQ0FBQyxvQ0FBb0MsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLE1BQU0sRUFBRSxFQUFFLElBQUksRUFBRSxXQUFXLENBQUMsT0FBTyxFQUFFLE9BQU8sRUFBRSxFQUFFLEVBQUUsRUFBRTtZQUNoSyxFQUFFLEtBQUssRUFBRSxVQUFVLEVBQUUsS0FBSyxFQUFFLEdBQUcsRUFBRSxLQUFLLEVBQUUsSUFBSSxDQUFDLGVBQWUsQ0FBQyxRQUFRLENBQUMsb0NBQW9DLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxNQUFNLEVBQUUsRUFBRSxJQUFJLEVBQUUsV0FBVyxDQUFDLE9BQU8sRUFBRSxPQUFPLEVBQUUsRUFBRSxFQUFFLEVBQUU7WUFDcEssRUFBRSxLQUFLLEVBQUUsV0FBVyxFQUFFLEtBQUssRUFBRSxHQUFHLEVBQUUsS0FBSyxFQUFFLElBQUksQ0FBQyxlQUFlLENBQUMsUUFBUSxDQUFDLG9DQUFvQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsTUFBTSxFQUFFLEVBQUUsSUFBSSxFQUFFLFdBQVcsQ0FBQyxPQUFPLEVBQUUsT0FBTyxFQUFFLEVBQUUsRUFBRSxFQUFFO1lBQ3JLO2dCQUNFLEtBQUssRUFBRSxlQUFlLEVBQUUsS0FBSyxFQUFFLEdBQUcsRUFBRSxLQUFLLEVBQUUsSUFBSSxDQUFDLGVBQWUsQ0FBQyxRQUFRLENBQUMsb0NBQW9DLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxNQUFNLEVBQUUsRUFBRSxJQUFJLEVBQUUsV0FBVyxDQUFDLFFBQVEsRUFBRSxPQUFPLEVBQUUsRUFBRSxFQUFFO2dCQUN0SyxTQUFTLEVBQUUsRUFBRSxJQUFJLEVBQUUsU0FBUyxFQUFFLE9BQU8sRUFBRSxFQUFFLFFBQVEsRUFBRSxJQUFJLENBQUMsZUFBZSxDQUFDLFFBQVEsQ0FBQyw4QkFBOEIsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLFNBQVMsRUFBRSxJQUFJLENBQUMsZUFBZSxDQUFDLFFBQVEsQ0FBQyw4QkFBOEIsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLEVBQUU7YUFDck07U0FDRixDQUFDO0lBQ0osQ0FBQzs7Ozs7O0lBRU8sWUFBWSxDQUFDLE1BQVc7OztjQUV4QixJQUFJLEdBQUcsSUFBSTtRQUNqQixJQUFJLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsS0FBSyxHQUFHLENBQUMsQ0FBQyxLQUFLLENBQUMsRUFBRTtZQUN2QyxJQUFJLENBQUMsRUFBRSxDQUFDLFVBQVUsQ0FBQyxXQUFXLENBQUMsQ0FBQztTQUNqQzthQUFNO1lBQ0wsSUFBSSxDQUFDLEVBQUUsQ0FBQyxVQUFVLENBQUMsV0FBVyxDQUFDLENBQUM7U0FDakM7UUFDRCxJQUFJLElBQUksQ0FBQyxFQUFFLENBQUMsV0FBVyxFQUFFOztrQkFDakIsS0FBSyxHQUFHLFNBQVMsQ0FBQyxJQUFJLENBQUMsZ0JBQWdCOzs7O1lBQUUsVUFBVSxDQUFNO2dCQUM3RCxPQUFPLENBQUMsQ0FBQyxFQUFFLEtBQUssSUFBSSxDQUFDLEVBQUUsQ0FBQyxXQUFXLENBQUMsRUFBRSxDQUFDO1lBQ3pDLENBQUMsRUFBQztZQUNGLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxLQUFLLENBQUMsQ0FBQyx1QkFBdUIsR0FBRyxNQUFNLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUM7WUFDL0UsSUFBSSxDQUFDLGdCQUFnQixHQUFHLENBQUMsR0FBRyxJQUFJLENBQUMsZ0JBQWdCLENBQUMsQ0FBQztTQUNwRDtJQUNILENBQUM7Ozs7O0lBRU8sa0JBQWtCO1FBQ3hCLElBQUksSUFBSSxDQUFDLE9BQU8sRUFBRTs7a0JBQ1YsU0FBUyxHQUFHLElBQUksQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDLFVBQVUsQ0FBQyxJQUFJOzs7O1lBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsYUFBYSxLQUFLLE9BQU8sRUFBQztZQUN2RixJQUFJLENBQUMsMkJBQTJCLENBQUMsU0FBUyxFQUFFLElBQUksQ0FBQyxDQUFDO1NBQ25EO0lBQ0gsQ0FBQzs7Ozs7OztJQUVPLDJCQUEyQixDQUFDLFNBQWMsRUFBRSxRQUFhO1FBQy9ELElBQUksU0FBUyxFQUFFO1lBQ2IsSUFBSSxTQUFTLENBQUMsSUFBSSxLQUFLLGNBQWMsRUFBRTtnQkFDckMsSUFBSSxTQUFTLElBQUksU0FBUyxDQUFDLE1BQU0sSUFBSSxTQUFTLENBQUMsTUFBTSxDQUFDLE1BQU0sRUFBRTtvQkFDNUQsS0FBSyxNQUFNLEtBQUssSUFBSSxTQUFTLENBQUMsTUFBTSxFQUFFO3dCQUNwQyxJQUFJLENBQUMsZUFBZSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsU0FBUyxDQUFDLENBQUM7cUJBQzVDO2lCQUNGO2FBQ0Y7aUJBQU0sSUFBSSxTQUFTLENBQUMsUUFBUSxJQUFJLFNBQVMsQ0FBQyxRQUFRLENBQUMsTUFBTSxFQUFFO2dCQUMxRCxJQUFJLENBQUMsMkJBQTJCLENBQUMsSUFBSSxFQUFFLFNBQVMsQ0FBQyxRQUFRLENBQUMsQ0FBQzthQUM1RDtTQUNGO2FBQU07WUFDTCxLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsUUFBUSxDQUFDLE1BQU0sRUFBRSxDQUFDLEVBQUUsRUFBRTtnQkFDeEMsSUFBSSxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxLQUFLLGNBQWMsRUFBRTtvQkFDdkMsSUFBSSxRQUFRLENBQUMsQ0FBQyxDQUFDLElBQUksUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDLE1BQU0sSUFBSSxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLE1BQU0sRUFBRTt3QkFDbEUsS0FBSyxNQUFNLEtBQUssSUFBSSxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUMsTUFBTSxFQUFFOzRCQUN0QyxJQUFJLENBQUMsZUFBZSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsU0FBUyxDQUFDLENBQUM7eUJBQzVDO3FCQUNGO2lCQUNGO3FCQUFNLElBQUksUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDLFFBQVEsSUFBSSxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDLE1BQU0sRUFBRTtvQkFDOUQsSUFBSSxDQUFDLDJCQUEyQixDQUFDLElBQUksRUFBRSxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDLENBQUM7aUJBQzlEO2FBQ0Y7U0FDRjtJQUNILENBQUM7Ozs7O0lBRUQsU0FBUyxDQUFDLEtBQVU7UUFDbEIsSUFBSSxDQUFDLElBQUksQ0FBQyxNQUFNLEdBQUcsS0FBSyxDQUFDLFNBQVMsQ0FBQztRQUNuQyxJQUFJLENBQUMsSUFBSSxDQUFDLEtBQUssR0FBRyxLQUFLLENBQUMsUUFBUSxDQUFDO0lBQ25DLENBQUM7Ozs7SUFFRCxXQUFXO1FBQ1QsSUFBSSxDQUFDLFVBQVUsQ0FBQyxJQUFJLEVBQUUsQ0FBQztJQUN6QixDQUFDOzs7O0lBRUQsWUFBWTs7Y0FDSixJQUFJLEdBQUcsSUFBSTtRQUNqQixJQUFJLENBQUMsRUFBRSxDQUFDLFVBQVUsRUFBRSxDQUFDO1FBQ3JCLElBQUksQ0FBQyxHQUFHLENBQUMsVUFBVSxFQUFFLENBQUM7UUFDdEIsSUFBSSxJQUFJLENBQUMsZ0JBQWdCLENBQUMsTUFBTSxHQUFHLENBQUMsRUFBRTtZQUNwQyxJQUFJLENBQUMsa0JBQWtCLENBQUMsZUFBZSxDQUFDLEVBQUUsRUFBRSxFQUFFLFFBQVEsQ0FBQyxJQUFJLEVBQUUsRUFBRSxVQUFVLEVBQUUsSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsZ0JBQWdCLENBQUMsRUFBRSxVQUFVLEVBQUUsSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsaUJBQWlCLENBQUMsRUFBRSxPQUFPLEVBQUUsSUFBSSxDQUFDLE9BQU8sRUFBRSxNQUFNLEVBQUUsSUFBSSxDQUFDLE1BQU0sRUFBRSxFQUFFLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDLFNBQVMsRUFBRSxDQUFDO1NBQ3hQO2FBQU07WUFDTCxJQUFJLENBQUMsa0JBQWtCLENBQUMsaUJBQWlCLENBQUMsSUFBSSxDQUFDLE1BQU0sRUFBRSxJQUFJLENBQUMsT0FBTyxFQUFFLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDLFNBQVMsRUFBRSxDQUFDO1lBQ3hHLElBQUksQ0FBQyxnQkFBZ0IsR0FBRyxFQUFFLENBQUM7WUFDM0IsSUFBSSxDQUFDLGlCQUFpQixHQUFHLEVBQUUsQ0FBQztZQUM1QixJQUFJLENBQUMsc0JBQXNCLEdBQUcsRUFBRSxDQUFDO1NBQ2xDO1FBQ0QsSUFBSSxDQUFDLGFBQWEsR0FBRyxDQUFDLENBQUMsQ0FBQztRQUN4QixJQUFJLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxFQUFFLEtBQUssRUFBRSxJQUFJLENBQUMsZ0JBQWdCLEVBQUUsQ0FBQyxDQUFDO0lBRTFELENBQUM7Ozs7SUFRRCxnQkFBZ0I7UUFDZCxJQUFJLENBQUMsWUFBWSxDQUFDLElBQUksRUFBRSxDQUFDO0lBQzNCLENBQUM7Ozs7SUFFRCxhQUFhO1FBQ1gsSUFBSSxDQUFDLGdCQUFnQixDQUFDLElBQUksQ0FBQztZQUN6QixJQUFJLEVBQUUsUUFBUSxDQUFDLElBQUksRUFBRTtZQUNyQixhQUFhLEVBQUUsSUFBSSxDQUFDLE9BQU87WUFDM0IsWUFBWSxFQUFFLEVBQUU7WUFDaEIsY0FBYyxFQUFFLEVBQUU7WUFDbEIsY0FBYyxFQUFFLElBQUk7WUFDcEIsYUFBYSxFQUFFLEVBQUU7WUFDakIsZUFBZSxFQUFFLEVBQUU7WUFDbkIseUJBQXlCLEVBQUUsQ0FBQztZQUM1QixXQUFXLEVBQUUsRUFBRTtZQUNmLGdCQUFnQixFQUFFLEVBQUU7WUFDcEIsc0JBQXNCLEVBQUUsSUFBSTtZQUM1QixvQkFBb0IsRUFBRSxFQUFFO1NBQ3pCLENBQUMsQ0FBQztRQUVILElBQUksQ0FBQyxFQUFFLENBQUMsT0FBTyxFQUFFLENBQUM7SUFDcEIsQ0FBQzs7OztJQUVELGdCQUFnQjs7Y0FDUixJQUFJLEdBQUcsSUFBSTtRQUNqQixJQUFJLElBQUksQ0FBQyxFQUFFLENBQUMsV0FBVyxFQUFFOztrQkFDakIsRUFBRSxHQUFHLElBQUksQ0FBQyxFQUFFLENBQUMsV0FBVyxDQUFDLEVBQUU7O2tCQUMzQixLQUFLLEdBQUcsU0FBUyxDQUFDLElBQUksQ0FBQyxnQkFBZ0I7Ozs7WUFBRSxVQUFVLENBQU07Z0JBQzdELE9BQU8sQ0FBQyxDQUFDLEVBQUUsS0FBSyxFQUFFLENBQUM7WUFDckIsQ0FBQyxFQUFDO1lBQ0YsSUFBSSxDQUFDLGdCQUFnQixDQUFDLE1BQU0sQ0FBQyxLQUFLLEVBQUUsQ0FBQyxDQUFDLENBQUM7WUFDdkMsSUFBSSxDQUFDLGdCQUFnQixHQUFHLENBQUMsR0FBRyxJQUFJLENBQUMsZ0JBQWdCLENBQUMsQ0FBQztZQUNuRCxJQUFJLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxNQUFNLEtBQUssQ0FBQyxFQUFFO2dCQUN0QyxJQUFJLENBQUMsaUJBQWlCLEdBQUcsRUFBRSxDQUFDO2dCQUM1QixJQUFJLENBQUMsc0JBQXNCLEdBQUcsRUFBRSxDQUFDO2FBQ2xDO2lCQUFNOztzQkFDQyxNQUFNLEdBQUcsRUFBRTtnQkFDakIseUNBQXlDO2dCQUN6QyxLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsSUFBSSxDQUFDLGlCQUFpQixDQUFDLE1BQU0sRUFBRSxDQUFDLEVBQUUsRUFBRTtvQkFDdEQsSUFBSSxJQUFJLENBQUMsaUJBQWlCLENBQUMsQ0FBQyxDQUFDLENBQUMsVUFBVSxLQUFLLEVBQUUsRUFBRTt3QkFDL0MsTUFBTSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsaUJBQWlCLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztxQkFDeEM7aUJBQ0Y7Z0JBQ0QsSUFBSSxDQUFDLGlCQUFpQixDQUFDLElBQUksQ0FBQyxHQUFHLE1BQU0sQ0FBQyxDQUFDO2FBQ3hDO1lBQ0QsSUFBSSxDQUFDLEVBQUUsQ0FBQyxPQUFPLEVBQUUsQ0FBQztZQUNsQixJQUFJLENBQUMsR0FBRyxDQUFDLE9BQU8sRUFBRSxDQUFDO1NBQ3BCO0lBQ0gsQ0FBQzs7Ozs7SUFFTSxnQkFBZ0IsQ0FBQyxJQUFTO1FBQy9CLElBQUksQ0FBQyxFQUFFLENBQUMsVUFBVSxFQUFFLENBQUM7SUFDdkIsQ0FBQzs7Ozs7SUFFRCxlQUFlLENBQUMsSUFBUzs7WUFDbkIsS0FBSyxHQUFHLFFBQVE7UUFDcEIsSUFBSSxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxJQUFJLG1CQUFtQixFQUFFO1lBQy9DLEtBQUssR0FBRyxtQkFBbUIsQ0FBQyxHQUFHLENBQUMsUUFBUSxDQUFDLGVBQWUsRUFBRSxDQUFDLFdBQVcsRUFBRSxDQUFDO1NBQzFFO1FBQ0QsSUFBSSxDQUFDLEtBQUssRUFBRTtZQUNWLEtBQUssR0FBRyxRQUFRLENBQUM7U0FDbEI7UUFDRCxPQUFPLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUM7SUFDMUMsQ0FBQzs7OztJQUVELFFBQVE7UUFDTixJQUFJLENBQUMsT0FBTyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUM7SUFDeEMsQ0FBQzs7OztJQUNELE9BQU87UUFDTCxJQUFJLENBQUMsVUFBVSxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUM7SUFDM0MsQ0FBQzs7Ozs7SUFFRCxZQUFZLENBQUMsTUFBVzs7Y0FDaEIsSUFBSSxHQUFHLElBQUk7UUFDakIsSUFBSSxJQUFJLENBQUMsRUFBRSxDQUFDLFdBQVcsRUFBRTs7a0JBQ2pCLEtBQUssR0FBRyxTQUFTLENBQUMsSUFBSSxDQUFDLGdCQUFnQjs7OztZQUFFLFVBQVUsQ0FBTTtnQkFDN0QsT0FBTyxDQUFDLENBQUMsRUFBRSxLQUFLLElBQUksQ0FBQyxFQUFFLENBQUMsV0FBVyxDQUFDLEVBQUUsQ0FBQztZQUN6QyxDQUFDLEVBQUM7WUFFRixJQUFJLENBQUMsZ0JBQWdCLENBQUMsS0FBSyxDQUFDLENBQUMsWUFBWSxHQUFHLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUM7WUFDekQsSUFBSSxDQUFDLGdCQUFnQixDQUFDLEtBQUssQ0FBQyxDQUFDLFlBQVksR0FBRyxFQUFFLFFBQVEsRUFBRSxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxFQUFFLENBQUM7WUFDekUsSUFBSSxDQUFDLGdCQUFnQixDQUFDLEtBQUssQ0FBQyxDQUFDLFVBQVUsR0FBRyxNQUFNLENBQUM7O2dCQUM3QyxXQUFXLEdBQUcsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLGNBQWMsQ0FBQyxZQUFZO1lBQ3ZELElBQUksV0FBVyxFQUFFO2dCQUNmLFdBQVcsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLFdBQVcsQ0FBQyxDQUFDO2dCQUN0QyxLQUFLLE1BQU0sVUFBVSxJQUFJLFdBQVcsRUFBRTtvQkFDcEMsSUFBSSxVQUFVLENBQUMsSUFBSSxLQUFLLFNBQVMsRUFBRTt3QkFDakMsSUFBSSxDQUFDLGdCQUFnQixDQUFDLEtBQUssQ0FBQyxDQUFDLGtCQUFrQixHQUFHLFVBQVUsQ0FBQyxLQUFLLENBQUM7cUJBQ3BFO2lCQUNGO2FBQ0Y7WUFDRCxJQUFJLENBQUMsZ0JBQWdCLEdBQUcsQ0FBQyxHQUFHLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO1NBQ3BEO0lBQ0gsQ0FBQzs7Ozs7SUFDRCxXQUFXLENBQUMsTUFBVzs7Y0FDZixJQUFJLEdBQUcsSUFBSTtRQUNqQixJQUFJLElBQUksQ0FBQyxFQUFFLENBQUMsV0FBVyxFQUFFOztrQkFDakIsS0FBSyxHQUFHLFNBQVMsQ0FBQyxJQUFJLENBQUMsZ0JBQWdCOzs7O1lBQUUsVUFBVSxDQUFNO2dCQUM3RCxPQUFPLENBQUMsQ0FBQyxFQUFFLEtBQUssSUFBSSxDQUFDLEVBQUUsQ0FBQyxXQUFXLENBQUMsRUFBRSxDQUFDO1lBQ3pDLENBQUMsRUFBQztZQUVGLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxLQUFLLENBQUMsQ0FBQyxZQUFZLEdBQUcsTUFBTSxDQUFDLGFBQWEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUM7WUFDMUUsSUFBSSxDQUFDLGdCQUFnQixDQUFDLEtBQUssQ0FBQyxDQUFDLFlBQVksR0FBRyxFQUFFLFFBQVEsRUFBRSxNQUFNLENBQUMsYUFBYSxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksRUFBRSxDQUFDO1lBQ3ZGLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxLQUFLLENBQUMsQ0FBQyxXQUFXLEdBQUcsTUFBTSxDQUFDLGFBQWEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxXQUFXLENBQUM7WUFDL0UsSUFBSSxDQUFDLGdCQUFnQixDQUFDLEtBQUssQ0FBQyxDQUFDLFVBQVUsR0FBRyxLQUFLLENBQUM7O2dCQUM1QyxXQUFXLEdBQUcsTUFBTSxDQUFDLGFBQWEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxZQUFZO1lBQ3RELElBQUksV0FBVyxFQUFFO2dCQUNmLFdBQVcsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLFdBQVcsQ0FBQyxDQUFDO2dCQUN0QyxLQUFLLE1BQU0sVUFBVSxJQUFJLFdBQVcsRUFBRTtvQkFDcEMsSUFBSSxVQUFVLENBQUMsSUFBSSxLQUFLLFNBQVMsRUFBRTt3QkFDakMsSUFBSSxDQUFDLGdCQUFnQixDQUFDLEtBQUssQ0FBQyxDQUFDLGtCQUFrQixHQUFHLFVBQVUsQ0FBQyxLQUFLLENBQUM7cUJBQ3BFO2lCQUNGO2FBQ0Y7WUFDRCxJQUFJLENBQUMsZ0JBQWdCLEdBQUcsQ0FBQyxHQUFHLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO1NBQ3BEO0lBQ0gsQ0FBQzs7Ozs7SUFFRCxTQUFTLENBQUMsS0FBVTtRQUNsQixJQUFJLENBQUMsYUFBYSxHQUFHLEtBQUssQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDO1FBQ25DLElBQUksQ0FBQyxzQkFBc0IsR0FBRyxJQUFJLENBQUMsaUJBQWlCLENBQUMsTUFBTTs7OztRQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLFVBQVUsS0FBSyxJQUFJLENBQUMsYUFBYSxFQUFDLENBQUM7UUFDdEcsSUFBSSxDQUFDLEVBQUUsQ0FBQyxVQUFVLEVBQUUsQ0FBQztRQUNyQixJQUFJLENBQUMsR0FBRyxDQUFDLFVBQVUsRUFBRSxDQUFDO0lBQ3hCLENBQUM7Ozs7O0lBRUQsZ0JBQWdCLENBQUMsS0FBVTtRQUN6QixJQUFJLENBQUMsR0FBRyxDQUFDLFVBQVUsRUFBRSxDQUFDO0lBQ3hCLENBQUM7Ozs7SUFFRCxZQUFZOztjQUNKLElBQUksR0FBRyxJQUFJO1FBQ2pCLElBQUksSUFBSSxDQUFDLEVBQUUsQ0FBQyxXQUFXLEVBQUU7O2tCQUNqQixFQUFFLEdBQUcsSUFBSSxDQUFDLEVBQUUsQ0FBQyxXQUFXLENBQUMsRUFBRTs7a0JBQzNCLEtBQUssR0FBRyxTQUFTLENBQUMsSUFBSSxDQUFDLGdCQUFnQjs7OztZQUFFLFVBQVUsQ0FBTTtnQkFDN0QsT0FBTyxDQUFDLENBQUMsRUFBRSxLQUFLLEVBQUUsQ0FBQztZQUNyQixDQUFDLEVBQUM7WUFFRixJQUFJLElBQUksQ0FBQyxlQUFlLEVBQUU7Z0JBQ3hCLEtBQUssTUFBTSxJQUFJLElBQUksSUFBSSxDQUFDLGVBQWUsRUFBRTtvQkFDdkMsSUFBSSxDQUFDLGlCQUFpQixDQUFDLFVBQVUsQ0FBQzt3QkFDaEMsR0FBRyxFQUFFLEtBQUssR0FBRyxJQUFJO3dCQUNqQixJQUFJLEVBQUUsSUFBSTt3QkFDVixXQUFXLEVBQUUsRUFBRTtxQkFDaEIsQ0FBQyxDQUFDO2lCQUNKO2FBQ0Y7WUFFRCxjQUFjO1lBQ2QsSUFBSSxJQUFJLENBQUMsV0FBVyxFQUFFO2dCQUNwQixJQUFJLENBQUMsV0FBVyxDQUFDLE9BQU87Ozs7Z0JBQUMsT0FBTyxDQUFDLEVBQUU7b0JBQ2pDLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxVQUFVLENBQUM7d0JBQ2hDLEdBQUcsRUFBRSxLQUFLLEdBQUcsT0FBTyxDQUFDLFNBQVM7d0JBQzlCLElBQUksRUFBRSxPQUFPLENBQUMsSUFBSTt3QkFDbEIsV0FBVyxFQUFFLEVBQUU7cUJBQ2hCLENBQUMsQ0FBQztnQkFDTCxDQUFDLEVBQUMsQ0FBQzthQUNKO1lBRUQsSUFBSSxDQUFDLGlCQUFpQixDQUFDLGlCQUFpQixDQUFDLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxLQUFLLENBQUMsQ0FBQyxjQUFjLENBQUMsQ0FBQztZQUN0RixJQUFJLENBQUMsaUJBQWlCLENBQUMsZUFBZSxFQUFFLENBQUMsSUFBSTs7OztZQUFDLFVBQVUsQ0FBQyxFQUFFO2dCQUN6RCxJQUFJLENBQUMsZ0JBQWdCLENBQUMsS0FBSyxDQUFDLENBQUMsY0FBYyxHQUFHLFVBQVUsQ0FBQztnQkFDekQsaUJBQWlCO2dCQUNqQix1QkFBdUI7Z0JBQ3ZCLDBDQUEwQztnQkFDMUMsSUFBSTtnQkFDSixJQUFJLENBQUMsZ0JBQWdCLEdBQUcsQ0FBQyxHQUFHLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO2dCQUNuRCxJQUFJLElBQUksQ0FBQyxzQkFBc0IsRUFBRTtvQkFDL0IsSUFBSSxDQUFDLHNCQUFzQixDQUFDLFdBQVcsQ0FBQyxRQUFRLENBQUMsVUFBVSxDQUFDLENBQUM7aUJBQzlEO1lBQ0gsQ0FBQyxFQUFDLENBQUM7U0FDSjtJQUNILENBQUM7Ozs7SUFFRCxjQUFjOztjQUNOLFVBQVUsR0FBRyxJQUFJLENBQUMsYUFBYTtRQUNyQyxJQUFJLFVBQVUsS0FBSyxDQUFDLENBQUMsRUFBRTtZQUNyQixJQUFJLENBQUMsaUJBQWlCLENBQUMsSUFBSSxDQUFDO2dCQUMxQixJQUFJLEVBQUUsUUFBUSxDQUFDLElBQUksRUFBRTtnQkFDckIsWUFBWSxFQUFFLFVBQVU7Z0JBQ3hCLE1BQU0sRUFBRSxFQUFFO2dCQUNWLFVBQVUsRUFBRSxFQUFFO2dCQUNkLFdBQVcsRUFBRSxFQUFFO2dCQUNmLGVBQWUsRUFBRSxLQUFLO2FBQ3ZCLENBQUMsQ0FBQztZQUNILElBQUksQ0FBQyxzQkFBc0IsR0FBRyxJQUFJLENBQUMsaUJBQWlCLENBQUMsTUFBTTs7OztZQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLFVBQVUsS0FBSyxJQUFJLENBQUMsYUFBYSxFQUFDLENBQUM7U0FDdkc7UUFDRCxJQUFJLENBQUMsR0FBRyxDQUFDLE9BQU8sRUFBRSxDQUFDO0lBQ3JCLENBQUM7Ozs7SUFDRCxpQkFBaUI7O2NBQ1QsSUFBSSxHQUFHLElBQUk7UUFDakIsSUFBSSxJQUFJLENBQUMsR0FBRyxDQUFDLFdBQVcsRUFBRTs7a0JBQ2xCLEtBQUssR0FBRyxTQUFTLENBQUMsSUFBSSxDQUFDLGlCQUFpQjs7OztZQUFFLFVBQVUsQ0FBTTtnQkFDOUQsT0FBTyxDQUFDLENBQUMsRUFBRSxLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsV0FBVyxDQUFDLEVBQUUsQ0FBQztZQUMxQyxDQUFDLEVBQUM7WUFDRixJQUFJLENBQUMsaUJBQWlCLENBQUMsTUFBTSxDQUFDLEtBQUssRUFBRSxDQUFDLENBQUMsQ0FBQztZQUN4QyxJQUFJLENBQUMsc0JBQXNCLEdBQUcsSUFBSSxDQUFDLGlCQUFpQixDQUFDLE1BQU07Ozs7WUFBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxVQUFVLEtBQUssSUFBSSxDQUFDLGFBQWEsRUFBQyxDQUFDO1lBQ3RHLElBQUksQ0FBQyxzQkFBc0IsR0FBRyxDQUFDLEdBQUcsSUFBSSxDQUFDLHNCQUFzQixDQUFDLENBQUM7U0FDaEU7SUFDSCxDQUFDOzs7WUFuZEYsU0FBUyxTQUFDO2dCQUNULFFBQVEsRUFBRSxjQUFjO2dCQUN4Qix1dUpBQTRDO2dCQUU1QyxhQUFhLEVBQUUsaUJBQWlCLENBQUMsSUFBSTs7YUFDdEM7Ozs7WUF0QjRGLFNBQVM7WUFBcUIsd0JBQXdCO1lBSTFJLGtCQUFrQjtZQUowSCxRQUFRLHVCQWlGeEosUUFBUTs7O3lCQXZEVixNQUFNOzBCQUVOLE1BQU07MkJBQ04sS0FBSzswQkFVTCxTQUFTLFNBQUMsWUFBWTtpQkE0QnRCLFNBQVMsU0FBQyxJQUFJO2tCQUNkLFNBQVMsU0FBQyxLQUFLOzJCQUNmLFNBQVMsU0FBQyxjQUFjO3NCQUd4QixTQUFTLFNBQUMsU0FBUzt5QkFDbkIsU0FBUyxTQUFDLFlBQVk7K0JBQ3RCLFNBQVMsU0FBQyxrQkFBa0I7K0JBQzVCLFNBQVMsU0FBQyxrQkFBa0I7Ozs7SUFqRDdCLDBDQUErQzs7SUFFL0MsMkNBQWdEOztJQUNoRCw0Q0FBZ0M7O0lBQ2hDLHVDQUFhOztJQUNiLHNDQUE4RDs7SUFDOUQseUNBQWU7O0lBQ2YsZ0RBQXNCOztJQUN0Qiw2Q0FBbUI7O0lBQ25CLDJDQUFpQjs7SUFDakIsdUNBQWE7O0lBQ2IsK0NBQXVCOztJQUV2QiwyQ0FBdUQ7O0lBQ3ZELDJDQUtFOztJQUVGLGdEQUEyQjs7SUFDM0IsaURBQTRCOztJQUM1QixvQ0FBZTs7Ozs7SUFDZiw2Q0FBMkI7O0lBQzNCLDJDQUFzQjs7SUFDdEIsMENBQXFCOztJQUNyQiw0Q0FHRTs7SUFDRiw4Q0FBeUI7O0lBQ3pCLCtDQUFpQzs7SUFDakMsaURBQXFDOztJQUVyQyx5Q0FBZTs7SUFDZix3Q0FBYzs7SUFFZCxzREFBOEI7O0lBRTlCLHNEQUFpQzs7SUFDakMsa0NBQXVDOztJQUN2QyxtQ0FBeUM7O0lBQ3pDLDRDQUF5RDs7SUFHekQsdUNBQW1EOztJQUNuRCwwQ0FBaUU7O0lBQ2pFLGdEQUFrRTs7SUFDbEUsZ0RBQWtFOztJQTZNbEUsaURBSUM7Ozs7O0lBOU1DLHdDQUEyQjs7Ozs7SUFDM0Isd0NBQTBDOzs7OztJQUMxQyxrREFBOEM7Ozs7O0lBQzlDLHdDQUFzQyIsInNvdXJjZXNDb250ZW50IjpbIi8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTptYXgtbGluZS1sZW5ndGhcclxuaW1wb3J0IHsgQ29tcG9uZW50LCBPbkluaXQsIE9uRGVzdHJveSwgSW5wdXQsIE9wdGlvbmFsLCBPbkNoYW5nZXMsIFNpbXBsZUNoYW5nZXMsIFZpZXdDaGlsZCwgUmVuZGVyZXIyLCBWaWV3RW5jYXBzdWxhdGlvbiwgQ29tcG9uZW50RmFjdG9yeVJlc29sdmVyLCBJbmplY3RvciwgT3V0cHV0LCBFdmVudEVtaXR0ZXIsIFRlbXBsYXRlUmVmLCBJbmplY3QgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgRGlhbG9nQ29tcG9uZW50IH0gZnJvbSAnQGZhcnJpcy91aS1kaWFsb2cnO1xyXG5pbXBvcnQgeyBSdGZBcHBIZWxwQ29tcG9uZW50IH0gZnJvbSAnQGdzcC1zeXMvcnRmLXVpJztcclxuaW1wb3J0IHsgUnRmQXBwSGVscENvbXBvbmVudCBhcyBSdGZBcHBsaWNhdGlvbkhlbHBDb21wb25lbnQgfSBmcm9tICdAZ3NwLXN5cy9ydGYtYXBwaGVscCc7XHJcbmltcG9ydCB7IEpvaW50U2VhcmNoU2VydmljZSB9IGZyb20gJy4uLy4uL3NlcnZpY2Uvam9pbnQtc2VhcmNoL2pvaW50LXNlYXJjaC5zZXJ2aWNlJztcclxuaW1wb3J0IHsgRXZlbnRCdXMgfSBmcm9tICdAcWRwL2NvbW1vbic7XHJcbmltcG9ydCB7IERhdGFncmlkQ29tcG9uZW50IH0gZnJvbSAnQGZhcnJpcy91aS1kYXRhZ3JpZCc7XHJcbmltcG9ydCB7IE9ic2VydmFibGUsIG9mIH0gZnJvbSAncnhqcyc7XHJcbmltcG9ydCB7IGZpbmRJbmRleCB9IGZyb20gJ2xvZGFzaC1lcyc7XHJcbmltcG9ydCB7IEVkaXRvclR5cGVzIH0gZnJvbSAnQGZhcnJpcy91aS1kYXRhZ3JpZC1lZGl0b3JzJztcclxuaW1wb3J0IHsgTG9jYWxpemVTZXJ2aWNlIH0gZnJvbSAnQHFkcC9sb2NhbGl6ZSc7XHJcbmltcG9ydCB7IEV4cHJlc3Npb25TZXJ2aWNlIH0gZnJvbSAnQGdzcC1zdmMvZXhwcmVzc2lvbic7XHJcbmltcG9ydCB7IGVsZW1lbnQgfSBmcm9tICdwcm90cmFjdG9yJztcclxuXHJcbmRlY2xhcmUgdmFyIGdzcDogYW55O1xyXG5kZWNsYXJlIHZhciBnc3BmcmFtZXdvcmtTZXJ2aWNlOiBhbnk7XHJcblxyXG5AQ29tcG9uZW50KHtcclxuICBzZWxlY3RvcjogJ2pvaW50LXNlYXJjaCcsXHJcbiAgdGVtcGxhdGVVcmw6ICcuL2pvaW50LXNlYXJjaC5jb21wb25lbnQuaHRtbCcsXHJcbiAgc3R5bGVVcmxzOiBbJy4vam9pbnQtc2VhcmNoLmNvbXBvbmVudC5jc3MnXSxcclxuICBlbmNhcHN1bGF0aW9uOiBWaWV3RW5jYXBzdWxhdGlvbi5Ob25lXHJcbn0pXHJcblxyXG5leHBvcnQgY2xhc3MgSm9pbnRTZWFyY2hDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQsIE9uRGVzdHJveSwgT25DaGFuZ2VzIHtcclxuXHJcbiAgQE91dHB1dCgpIGNsb3NlTW9kYWwgPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcclxuICAvLyDmqKHmgIHmoYbnoa7lrprlkI7lhbPpl63vvIzlubbkvKDpgJLlj4LmlbBcclxuICBAT3V0cHV0KCkgc3VibWl0TW9kYWwgPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcclxuICBASW5wdXQoKSBlZGl0b3JQYXJhbXM6IGFueSA9IHt9O1xyXG4gIHF1ZXJ5SWQ6IGFueTsgLy8g5p+l6K+iSURcclxuICBmb3JtSWQ6IGFueSA9ICdmb3JtJyArICdmZjNlYTQ3NC1jYzY1LTIzYjAtY2RiMS03M2M5MTQ2Y2VhM2InOyAvLyDlvZPliY3ooajljZVJRFxyXG4gIHNlc3Npb25JZDogYW55OyAvLyDlvZPliY1zZXNzaW9uaWRcclxuICBxdWVyeVJlbGF0aXZlVXJsOiBhbnk7XHJcbiAgcW9NYW5hZ2VyQ29kZTogYW55OyAvLyDlvZPliY1xb01hbmFnZXJDb2RlXHJcbiAgZHluYW1pY0NvbHM6IGFueTsgLy8g5b2T5YmN5p+l6K+i6KGo5Y2V55qE5Yqo5oCB5YiX5ZCN56ewXHJcbiAgZG9tSnNvbjogYW55O1xyXG4gIHZpZXdNb2RlbEZpZWxkczogYW55W107XHJcblxyXG4gIEBWaWV3Q2hpbGQoJ2VudW1Gb290ZXInKSBtb2RhbEZvb3RlcjogVGVtcGxhdGVSZWY8YW55PjtcclxuICBtb2RhbENvbmZpZyA9IHtcclxuICAgIHRpdGxlOiAn6IGU5p+l5pig5bCEJyxcclxuICAgIHdpZHRoOiA5MDAsXHJcbiAgICBoZWlnaHQ6IDgwMCxcclxuICAgIHNob3dCdXR0b25zOiB0cnVlXHJcbiAgfTtcclxuXHJcbiAgZnVuY3Rpb25TdWJEYXRhczogYW55ID0gW107IC8vIOaVsOaNrlxyXG4gIGZ1bmN0aW9uUGFyYURhdGFzOiBhbnkgPSBbXTtcclxuICBzaXplOiBhbnkgPSB7fTtcclxuICBwcml2YXRlIHNlbGVjdGVkSW5kZXg6IGFueTtcclxuICBwYXJhQ29sdW1uczogYW55ID0gW107XHJcbiAgU3ViQ29sdW1uczogYW55ID0gW107XHJcbiAgZGlzcGxheXN0eWxlOiBhbnkgPSBbXHJcbiAgICB7ICduYW1lJzogJ+WPs+mUruiBlOafpScsIHZhbHVlOiAxIH0sXHJcbiAgICB7ICduYW1lJzogJ+i2hemTvuiBlOafpScsIHZhbHVlOiAyIH1cclxuICBdO1xyXG4gIFF1ZXJ5SW5mb0RhdGFzOiBhbnkgPSBbXTtcclxuICBsb2NhbGl6ZVNlcnZpY2U6IExvY2FsaXplU2VydmljZTtcclxuICBleHByZXNzaW9uU2VydmljZTogRXhwcmVzc2lvblNlcnZpY2U7XHJcblxyXG4gIGxhbmd1YWdlcyA9IFtdO1xyXG4gIGxhbmd1YWdlOiBhbnk7XHJcblxyXG4gIF9jdXJyZW50Q29uZGl0aW9uSW5wdXQgPSBudWxsO1xyXG5cclxuICBmdW5jdGlvblBhcmFEYXRhc09mU3ViOiBhbnkgPSBbXTtcclxuICBAVmlld0NoaWxkKCdkZycpIGRnOiBEYXRhZ3JpZENvbXBvbmVudDtcclxuICBAVmlld0NoaWxkKCdkZzEnKSBkZzE6IERhdGFncmlkQ29tcG9uZW50O1xyXG4gIEBWaWV3Q2hpbGQoJ2ZhcnJpc0RpYWxvZycpIGZhcnJpc0RpYWxvZzogRGlhbG9nQ29tcG9uZW50O1xyXG4gIC8vICAgLy8gQFZpZXdDaGlsZCgnZ3JpZEZ1bmN0aW9uU3ViJykgZ3JpZEZ1bmN0aW9uU3ViOiBHcmlkQ29tcG9uZW50O1xyXG4gIC8vICAgLy8gQFZpZXdDaGlsZCgnZ3JpZEZ1bmN0aW9uUGFyYScpIGdyaWRGdW5jdGlvblBhcmE6IEdyaWRDb21wb25lbnQ7XHJcbiAgQFZpZXdDaGlsZCgnYXBwSGVscCcpIGFwcEhlbHA6IFJ0ZkFwcEhlbHBDb21wb25lbnQ7XHJcbiAgQFZpZXdDaGlsZCgncnRmYXBwSGVscCcpIHJ0ZmFwcEhlbHA6IFJ0ZkFwcGxpY2F0aW9uSGVscENvbXBvbmVudDtcclxuICBAVmlld0NoaWxkKCdmdW5jdGlvbmNvZGVUZW1wJykgZnVuY3Rpb25jb2RlVGVtcDogVGVtcGxhdGVSZWY8YW55PjtcclxuICBAVmlld0NoaWxkKCdmdW5jdGlvbk5hbWVUZW1wJykgZnVuY3Rpb25OYW1lVGVtcDogVGVtcGxhdGVSZWY8YW55PjtcclxuXHJcbiAgY29uc3RydWN0b3IoXHJcbiAgICBwcml2YXRlIHJlbmRlcmVyOiBSZW5kZXJlcjIsXHJcbiAgICBwcml2YXRlIHJlc29sdmVyOiBDb21wb25lbnRGYWN0b3J5UmVzb2x2ZXIsXHJcbiAgICBwcml2YXRlIGpvaW50U2VhcmNoU2VydmljZTogSm9pbnRTZWFyY2hTZXJ2aWNlLFxyXG4gICAgQE9wdGlvbmFsKCkgcHJpdmF0ZSBpbmplY3RvcjogSW5qZWN0b3JcclxuICApIHtcclxuICAgIGlmICh0aGlzLmluamVjdG9yKSB7XHJcbiAgICAgIHRoaXMubG9jYWxpemVTZXJ2aWNlID0gdGhpcy5pbmplY3Rvci5nZXQoTG9jYWxpemVTZXJ2aWNlKTtcclxuICAgICAgdGhpcy5sYW5ndWFnZSA9IHRoaXMubG9jYWxpemVTZXJ2aWNlLmxhbmd1YWdlO1xyXG4gICAgICB0aGlzLmV4cHJlc3Npb25TZXJ2aWNlID0gdGhpcy5pbmplY3Rvci5nZXQoRXhwcmVzc2lvblNlcnZpY2UpO1xyXG4gICAgICB0aGlzLm1vZGFsQ29uZmlnLnRpdGxlID0gdGhpcy5sb2NhbGl6ZVNlcnZpY2UuZ2V0VmFsdWUoJ2lkZUNtcC5kcmlsbERvd24uZHJpbGxEb3duTmFtZScpO1xyXG4gICAgICB0aGlzLmRpc3BsYXlzdHlsZSA9IHRoaXMubG9jYWxpemVTZXJ2aWNlLmdldFZhbHVlKCdpZGVDbXAuZHJpbGxEb3duLmRpc3BsYXlTdHlsZScpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgbmdPbkRlc3Ryb3koKSB7XHJcbiAgfVxyXG5cclxuICBuZ09uSW5pdCgpIHtcclxuICAgIHRoaXMuZHJvcERvd25Jbml0Rm9ySURFKCk7XHJcbiAgICB0aGlzLmdyaWRJbml0KCk7XHJcbiAgfVxyXG5cclxuICBuZ09uQ2hhbmdlcyhjaGFuZ2VzOiBTaW1wbGVDaGFuZ2VzKSB7XHJcbiAgICBmb3IgKGNvbnN0IGNoYW5nZU5hbWUgaW4gY2hhbmdlcykge1xyXG4gICAgICBjb25zdCBuZXdWYWx1ZSA9IGNoYW5nZXNbY2hhbmdlTmFtZV0uY3VycmVudFZhbHVlO1xyXG4gICAgICBpZiAobmV3VmFsdWUgIT09IG51bGwgJiYgbmV3VmFsdWUgIT09IHZvaWQgMCkge1xyXG4gICAgICAgIHN3aXRjaCAoY2hhbmdlTmFtZSkge1xyXG4gICAgICAgICAgY2FzZSAnZWRpdG9yUGFyYW1zJzpcclxuICAgICAgICAgICAgdGhpcy5kcm9wRG93bkluaXRGb3JJREUoKTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGRyb3BEb3duSW5pdEZvcklERSgpIHtcclxuICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xyXG4gICAgc2VsZi5mb3JtSWQgPSAnZm9ybScgKyAnZmYzZWE0NzQtY2M2NS0yM2IwLWNkYjEtNzNjOTE0NmNlYTNiJztcclxuICAgIGlmIChzZWxmLmVkaXRvclBhcmFtcyAmJiBzZWxmLmVkaXRvclBhcmFtcy5xdWVyeUlkKSB7XHJcbiAgICAgIHNlbGYucXVlcnlJZCA9IHNlbGYuZWRpdG9yUGFyYW1zLnF1ZXJ5SWQ7XHJcbiAgICAgIHNlbGYuc2Vzc2lvbklkID0gc2VsZi5lZGl0b3JQYXJhbXMuc2Vzc2lvbklkO1xyXG4gICAgICBzZWxmLnF1ZXJ5UmVsYXRpdmVVcmwgPSBzZWxmLmVkaXRvclBhcmFtcy5xdWVyeVJlbGF0aXZlVXJsO1xyXG4gICAgICBzZWxmLnFvTWFuYWdlckNvZGUgPSBzZWxmLmVkaXRvclBhcmFtcy5xb01hbmFnZXJDb2RlO1xyXG4gICAgICBzZWxmLmRvbUpzb24gPSBzZWxmLmVkaXRvclBhcmFtcy5kb21Kc29uO1xyXG4gICAgICBzZWxmLnZpZXdNb2RlbEZpZWxkcyA9IFtdO1xyXG4gICAgICBzZWxmLmdldFZpZXdNb2RlbEZpZWxkcygpO1xyXG5cclxuICAgICAgc2VsZi5qb2ludFNlYXJjaFNlcnZpY2UuZ2V0TGFuZ3VhZ2VMaXN0KCkuc3Vic2NyaWJlKChkYXRhOiBhbnkpID0+IHtcclxuICAgICAgICBpZiAoZGF0YSAmJiBkYXRhLmxlbmd0aCkge1xyXG4gICAgICAgICAgZGF0YS5mb3JFYWNoKChlOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgc2VsZi5sYW5ndWFnZXMucHVzaCh7IGNvZGU6IGUuY29kZS50b0xvd2VyQ2FzZSgpLCBuYW1lOiBlLmRlc2NyaXB0aW9uIH0pO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHNlbGYuam9pbnRTZWFyY2hTZXJ2aWNlLmdldGpvaW50c2VhcmNoKHNlbGYuZm9ybUlkLCBzZWxmLnF1ZXJ5SWQsIHNlbGYucXVlcnlSZWxhdGl2ZVVybCkuc3Vic2NyaWJlKFxyXG4gICAgICAgICAgZGF0YSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChkYXRhICE9IG51bGwpIHtcclxuICAgICAgICAgICAgICBzZWxmLmZ1bmN0aW9uU3ViRGF0YXMgPSBKU09OLnBhcnNlKGRhdGEuam9pblNlYXJjaCk7XHJcbiAgICAgICAgICAgICAgc2VsZi5mdW5jdGlvblBhcmFEYXRhcyA9IEpTT04ucGFyc2UoZGF0YS5qb2ludHBhcmFtKTtcclxuICAgICAgICAgICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6cHJlZmVyLWZvci1vZlxyXG4gICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2VsZi5mdW5jdGlvblN1YkRhdGFzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoc2VsZi5mdW5jdGlvblN1YkRhdGFzW2ldLmpvaW50c2VyYWNoZGlzcGxheXN0eWxlID09PSAyKSB7XHJcbiAgICAgICAgICAgICAgICAgIHNlbGYuZGcuc2hvd0NvbHVtbignbGlua2ZpZWxkJyk7XHJcbiAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGNvbnN0IHBhcmFtcyA9IHt9O1xyXG4gICAgICAgIHBhcmFtc1sncW9NYW5hZ2VyQ29kZSddID0gc2VsZi5xb01hbmFnZXJDb2RlO1xyXG4gICAgICAgIHBhcmFtc1sncGFnZUluZGV4J10gPSAwO1xyXG4gICAgICAgIHBhcmFtc1snc2NoZW1hSWQnXSA9ICcnO1xyXG4gICAgICAgIHBhcmFtc1snZW50aXR5RGF0YSddID0gJyc7XHJcbiAgICAgICAgcGFyYW1zWydleHRlbmRDb25kJ10gPSAnJztcclxuICAgICAgICBzZWxmLmpvaW50U2VhcmNoU2VydmljZS5nZXRDb2wocGFyYW1zLCBzZWxmLnF1ZXJ5UmVsYXRpdmVVcmwpLnN1YnNjcmliZSh2YWx1ZSA9PiB7XHJcbiAgICAgICAgICBpZiAodmFsdWUgJiYgdmFsdWUuZHluYW1pY0NvbHMpIHtcclxuICAgICAgICAgICAgc2VsZi5keW5hbWljQ29scyA9IHZhbHVlLmR5bmFtaWNDb2xzO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGdyaWRJbml0KCkge1xyXG4gICAgY29uc3Qgc2VsZiA9IHRoaXM7XHJcbiAgICBjb25zdCBlbnVtT3B0cyA9IHsgdmFsdWVGaWVsZDogJ3ZhbHVlJywgdGV4dEZpZWxkOiAnbmFtZScsIGRhdGE6IHRoaXMuZGlzcGxheXN0eWxlIH07XHJcbiAgICB0aGlzLlN1YkNvbHVtbnMgPSBbXHJcbiAgICAgIHsgZmllbGQ6ICdmdW5jdGlvbmNvZGUnLCB3aWR0aDogMTYwLCB0aXRsZTogc2VsZi5sb2NhbGl6ZVNlcnZpY2UuZ2V0VmFsdWUoJ2lkZUNtcC5kcmlsbERvd24uY29sdW1uSGVhZGVyJylbMF0sIHRlbXBsYXRlOiB0aGlzLmZ1bmN0aW9uY29kZVRlbXAgfSxcclxuICAgICAgeyBmaWVsZDogJ2Z1bmN0aW9ubmFtZScsIHdpZHRoOiAxMDAsIHRpdGxlOiBzZWxmLmxvY2FsaXplU2VydmljZS5nZXRWYWx1ZSgnaWRlQ21wLmRyaWxsRG93bi5jb2x1bW5IZWFkZXInKVsxXSwgdGVtcGxhdGU6IHRoaXMuZnVuY3Rpb25OYW1lVGVtcCB9LFxyXG4gICAgICAvLyB7IGZpZWxkOiAnam9pbnRzZWFyY2hpZCcsIHdpZHRoOiAxMDAsIHRpdGxlOiBzZWxmLmxvY2FsaXplU2VydmljZS5nZXRWYWx1ZSgnaWRlQ21wLmRyaWxsRG93bi5jb2x1bW5IZWFkZXInKVsyXSwgZWRpdG9yOiB7IHR5cGU6IEVkaXRvclR5cGVzLlRFWFRCT1gsIG9wdGlvbnM6IHt9IH0gfSxcclxuICAgICAge1xyXG4gICAgICAgIGZpZWxkOiAnam9pbnRzZXJhY2hkaXNwbGF5c3R5bGUnLCB3aWR0aDogMTAwLCB0aXRsZTogc2VsZi5sb2NhbGl6ZVNlcnZpY2UuZ2V0VmFsdWUoJ2lkZUNtcC5kcmlsbERvd24uY29sdW1uSGVhZGVyJylbM10sXHJcbiAgICAgICAgZm9ybWF0dGVyOiB7IHR5cGU6ICdlbnVtJywgb3B0aW9uczogZW51bU9wdHMgfSxcclxuICAgICAgICBlZGl0b3I6IHsgdHlwZTogRWRpdG9yVHlwZXMuQ09NQk9MSVNULCBvcHRpb25zOiB7XHJcbiAgICAgICAgICAgIGRhdGE6IHRoaXMuZGlzcGxheXN0eWxlLFxyXG4gICAgICAgICAgICBpZEZpZWxkOiAndmFsdWUnLFxyXG4gICAgICAgICAgICB0ZXh0RmllbGQ6ICduYW1lJyxcclxuICAgICAgICAgICAgc2VsZWN0Q2hhbmdlOiB0aGlzLnNlbGVjdENoYW5nZS5iaW5kKHRoaXMpXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9LFxyXG4gICAgICB7IGZpZWxkOiAnbGlua2ZpZWxkJywgd2lkdGg6IDEwMCwgdGl0bGU6IHNlbGYubG9jYWxpemVTZXJ2aWNlLmdldFZhbHVlKCdpZGVDbXAuZHJpbGxEb3duLmNvbHVtbkhlYWRlcicpWzZdLCB2aXNpYmxlOiBmYWxzZSwgZWRpdG9yOiB7IHR5cGU6IEVkaXRvclR5cGVzLlRFWFRCT1gsIG9wdGlvbnM6IHt9IH0gfSxcclxuICAgICAge1xyXG4gICAgICAgIGZpZWxkOiAndmlzaWJsZWZvcm11bGEnLCB3aWR0aDogMTAwLCB0aXRsZTogc2VsZi5sb2NhbGl6ZVNlcnZpY2UuZ2V0VmFsdWUoJ2lkZUNtcC5kcmlsbERvd24uY29sdW1uSGVhZGVyJylbNF0sXHJcbiAgICAgICAgZWRpdG9yOiB7XHJcbiAgICAgICAgICB0eXBlOiBFZGl0b3JUeXBlcy5JTlBVVEdST1VQLCBvcHRpb25zOiB7XHJcbiAgICAgICAgICAgIGdyb3VwVGV4dDogJzxpIGNsYXNzPVwiZi1pY29uIGYtaWNvbi1sb29rdXBcIj48L2k+JyxcclxuICAgICAgICAgICAgY2xpY2tIYW5kbGU6IChlKSA9PiB7XHJcbiAgICAgICAgICAgICAgdGhpcy5fY3VycmVudENvbmRpdGlvbklucHV0ID0gZTtcclxuICAgICAgICAgICAgICB0aGlzLmlucHV0Q29uZEV4cCgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgIH1cclxuICAgICAgfSxcclxuICAgIF07XHJcbiAgICB0aGlzLnBhcmFDb2x1bW5zID0gW1xyXG4gICAgICB7IGZpZWxkOiAncGFyYScsIHdpZHRoOiAxMDAsIHRpdGxlOiBzZWxmLmxvY2FsaXplU2VydmljZS5nZXRWYWx1ZSgnaWRlQ21wLmRyaWxsRG93bi5wYXJhbUNvbHVtbkhlYWRlcicpWzBdLCBlZGl0b3I6IHsgdHlwZTogRWRpdG9yVHlwZXMuVEVYVEJPWCwgb3B0aW9uczoge30gfSB9LFxyXG4gICAgICB7IGZpZWxkOiAncGFyYW5hbWUnLCB3aWR0aDogMTAwLCB0aXRsZTogc2VsZi5sb2NhbGl6ZVNlcnZpY2UuZ2V0VmFsdWUoJ2lkZUNtcC5kcmlsbERvd24ucGFyYW1Db2x1bW5IZWFkZXInKVsxXSwgZWRpdG9yOiB7IHR5cGU6IEVkaXRvclR5cGVzLlRFWFRCT1gsIG9wdGlvbnM6IHt9IH0gfSxcclxuICAgICAgeyBmaWVsZDogJ3BhcmF2YWx1ZScsIHdpZHRoOiAxMDAsIHRpdGxlOiBzZWxmLmxvY2FsaXplU2VydmljZS5nZXRWYWx1ZSgnaWRlQ21wLmRyaWxsRG93bi5wYXJhbUNvbHVtbkhlYWRlcicpWzJdLCBlZGl0b3I6IHsgdHlwZTogRWRpdG9yVHlwZXMuVEVYVEJPWCwgb3B0aW9uczoge30gfSB9LFxyXG4gICAgICB7XHJcbiAgICAgICAgZmllbGQ6ICdwYXJhdmFsdWV0eXBlJywgd2lkdGg6IDEwMCwgdGl0bGU6IHNlbGYubG9jYWxpemVTZXJ2aWNlLmdldFZhbHVlKCdpZGVDbXAuZHJpbGxEb3duLnBhcmFtQ29sdW1uSGVhZGVyJylbM10sIGVkaXRvcjogeyB0eXBlOiBFZGl0b3JUeXBlcy5DSEVDS0JPWCwgb3B0aW9uczoge30gfSxcclxuICAgICAgICBmb3JtYXR0ZXI6IHsgdHlwZTogJ2Jvb2xlYW4nLCBvcHRpb25zOiB7IHRydWVUZXh0OiBzZWxmLmxvY2FsaXplU2VydmljZS5nZXRWYWx1ZSgnaWRlQ21wLmRyaWxsRG93bi5lbnVtRXhwcmVzcycpWzBdLCBmYWxzZVRleHQ6IHNlbGYubG9jYWxpemVTZXJ2aWNlLmdldFZhbHVlKCdpZGVDbXAuZHJpbGxEb3duLmVudW1FeHByZXNzJylbMV0gfSB9XHJcbiAgICAgIH0sXHJcbiAgICBdO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBzZWxlY3RDaGFuZ2UoJGV2ZW50OiBhbnkpIHtcclxuICAgIC8vIGNvbnNvbGUubG9nKCRldmVudCk7XHJcbiAgICBjb25zdCBzZWxmID0gdGhpcztcclxuICAgIGlmICgoJGV2ZW50LnZhbHVlLmRhdGEudmFsdWUgLSAwKSA9PT0gMikge1xyXG4gICAgICB0aGlzLmRnLnNob3dDb2x1bW4oJ2xpbmtmaWVsZCcpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5kZy5oaWRlQ29sdW1uKCdsaW5rZmllbGQnKTtcclxuICAgIH1cclxuICAgIGlmICh0aGlzLmRnLnNlbGVjdGVkUm93KSB7XHJcbiAgICAgIGNvbnN0IGluZGV4ID0gZmluZEluZGV4KHRoaXMuZnVuY3Rpb25TdWJEYXRhcywgZnVuY3Rpb24gKG46IGFueSkge1xyXG4gICAgICAgIHJldHVybiBuLmlkID09PSBzZWxmLmRnLnNlbGVjdGVkUm93LmlkO1xyXG4gICAgICB9KTtcclxuICAgICAgc2VsZi5mdW5jdGlvblN1YkRhdGFzW2luZGV4XS5qb2ludHNlcmFjaGRpc3BsYXlzdHlsZSA9ICRldmVudC52YWx1ZS5kYXRhLnZhbHVlO1xyXG4gICAgICBzZWxmLmZ1bmN0aW9uU3ViRGF0YXMgPSBbLi4uc2VsZi5mdW5jdGlvblN1YkRhdGFzXTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgZ2V0Vmlld01vZGVsRmllbGRzKCkge1xyXG4gICAgaWYgKHRoaXMuZG9tSnNvbikge1xyXG4gICAgICBjb25zdCBjb21wb25lbnQgPSB0aGlzLmRvbUpzb24ubW9kdWxlLmNvbXBvbmVudHMuZmluZCh4ID0+IHguY29tcG9uZW50VHlwZSA9PT0gJ0ZyYW1lJyk7XHJcbiAgICAgIHRoaXMucmVjdXJzaXZlR2V0Vmlld01vZGVsRmllbGRzKGNvbXBvbmVudCwgbnVsbCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHJlY3Vyc2l2ZUdldFZpZXdNb2RlbEZpZWxkcyhjb21wb25lbnQ6IGFueSwgY29udGVudHM6IGFueSkge1xyXG4gICAgaWYgKGNvbXBvbmVudCkge1xyXG4gICAgICBpZiAoY29tcG9uZW50LnR5cGUgPT09ICdRZHBGcmFtZXdvcmsnKSB7XHJcbiAgICAgICAgaWYgKGNvbXBvbmVudCAmJiBjb21wb25lbnQucGFyYW1zICYmIGNvbXBvbmVudC5wYXJhbXMubGVuZ3RoKSB7XHJcbiAgICAgICAgICBmb3IgKGNvbnN0IGZpZWxkIG9mIGNvbXBvbmVudC5wYXJhbXMpIHtcclxuICAgICAgICAgICAgdGhpcy52aWV3TW9kZWxGaWVsZHMucHVzaChmaWVsZC5QYXJhbUNvZGUpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfSBlbHNlIGlmIChjb21wb25lbnQuY29udGVudHMgJiYgY29tcG9uZW50LmNvbnRlbnRzLmxlbmd0aCkge1xyXG4gICAgICAgIHRoaXMucmVjdXJzaXZlR2V0Vmlld01vZGVsRmllbGRzKG51bGwsIGNvbXBvbmVudC5jb250ZW50cyk7XHJcbiAgICAgIH1cclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY29udGVudHMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICBpZiAoY29udGVudHNbaV0udHlwZSA9PT0gJ1FkcEZyYW1ld29yaycpIHtcclxuICAgICAgICAgIGlmIChjb250ZW50c1tpXSAmJiBjb250ZW50c1tpXS5wYXJhbXMgJiYgY29udGVudHNbaV0ucGFyYW1zLmxlbmd0aCkge1xyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IGZpZWxkIG9mIGNvbnRlbnRzW2ldLnBhcmFtcykge1xyXG4gICAgICAgICAgICAgIHRoaXMudmlld01vZGVsRmllbGRzLnB1c2goZmllbGQuUGFyYW1Db2RlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSBpZiAoY29udGVudHNbaV0uY29udGVudHMgJiYgY29udGVudHNbaV0uY29udGVudHMubGVuZ3RoKSB7XHJcbiAgICAgICAgICB0aGlzLnJlY3Vyc2l2ZUdldFZpZXdNb2RlbEZpZWxkcyhudWxsLCBjb250ZW50c1tpXS5jb250ZW50cyk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBvblJlc2l6ZWQoZXZlbnQ6IGFueSk6IHZvaWQge1xyXG4gICAgdGhpcy5zaXplLmhlaWdodCA9IGV2ZW50Lm5ld0hlaWdodDtcclxuICAgIHRoaXMuc2l6ZS53aWR0aCA9IGV2ZW50Lm5ld1dpZHRoO1xyXG4gIH1cclxuXHJcbiAgY2xpY2tDYW5jZWwoKSB7XHJcbiAgICB0aGlzLmNsb3NlTW9kYWwuZW1pdCgpO1xyXG4gIH1cclxuXHJcbiAgY2xpY2tDb25maXJtKCkge1xyXG4gICAgY29uc3Qgc2VsZiA9IHRoaXM7XHJcbiAgICBzZWxmLmRnLmVuZFJvd0VkaXQoKTtcclxuICAgIHNlbGYuZGcxLmVuZFJvd0VkaXQoKTtcclxuICAgIGlmIChzZWxmLmZ1bmN0aW9uU3ViRGF0YXMubGVuZ3RoID4gMCkge1xyXG4gICAgICBzZWxmLmpvaW50U2VhcmNoU2VydmljZS5zYXZlam9pbnRzZWFyY2goeyBJZDogRXZlbnRCdXMuZ3VpZCgpLCBqb2luc2VhcmNoOiBKU09OLnN0cmluZ2lmeShzZWxmLmZ1bmN0aW9uU3ViRGF0YXMpLCBqb2ludHBhcmFtOiBKU09OLnN0cmluZ2lmeShzZWxmLmZ1bmN0aW9uUGFyYURhdGFzKSwgcXVlcnlpZDogc2VsZi5xdWVyeUlkLCBGb3JtSWQ6IHNlbGYuZm9ybUlkIH0sIHRoaXMucXVlcnlSZWxhdGl2ZVVybCkuc3Vic2NyaWJlKCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBzZWxmLmpvaW50U2VhcmNoU2VydmljZS5kZWxldGVqb2ludHNlYXJjaChzZWxmLmZvcm1JZCwgc2VsZi5xdWVyeUlkLCB0aGlzLnF1ZXJ5UmVsYXRpdmVVcmwpLnN1YnNjcmliZSgpO1xyXG4gICAgICBzZWxmLmZ1bmN0aW9uU3ViRGF0YXMgPSBbXTtcclxuICAgICAgc2VsZi5mdW5jdGlvblBhcmFEYXRhcyA9IFtdO1xyXG4gICAgICBzZWxmLmZ1bmN0aW9uUGFyYURhdGFzT2ZTdWIgPSBbXTtcclxuICAgIH1cclxuICAgIHRoaXMuc2VsZWN0ZWRJbmRleCA9IC0xO1xyXG4gICAgdGhpcy5zdWJtaXRNb2RhbC5lbWl0KHsgdmFsdWU6IHRoaXMuZnVuY3Rpb25TdWJEYXRhcyB9KTtcclxuXHJcbiAgfVxyXG5cclxuICBoYW5kbGViZWZvcmVDbG9zZSA9ICgpOiBPYnNlcnZhYmxlPGFueT4gPT4ge1xyXG4gICAgdGhpcy5kZy5lbmRSb3dFZGl0KCk7XHJcbiAgICB0aGlzLmRnMS5lbmRSb3dFZGl0KCk7XHJcbiAgICByZXR1cm4gb2YodHJ1ZSk7XHJcbiAgfVxyXG5cclxuICBoYW5kbGVEaWFsb2dTaG93KCkge1xyXG4gICAgdGhpcy5mYXJyaXNEaWFsb2cuc2hvdygpO1xyXG4gIH1cclxuXHJcbiAgYWRkU3ViSGFuZGxlcigpIHtcclxuICAgIHRoaXMuZnVuY3Rpb25TdWJEYXRhcy5wdXNoKHtcclxuICAgICAgJ2lkJzogRXZlbnRCdXMuZ3VpZCgpLFxyXG4gICAgICAncXVlcnlQYXJhSUQnOiB0aGlzLnF1ZXJ5SWQsXHJcbiAgICAgICdzZWFyY2h0eXBlJzogJycsXHJcbiAgICAgICdmdW5jdGlvbmNvZGUnOiAnJyxcclxuICAgICAgJ2Z1bmN0aW9ubmFtZSc6IG51bGwsXHJcbiAgICAgICdhcHBFbnRyYW5jZSc6ICcnLFxyXG4gICAgICAnam9pbnRzZWFyY2hpZCc6ICcnLFxyXG4gICAgICAnam9pbnRzZXJhY2hkaXNwbGF5c3R5bGUnOiAxLFxyXG4gICAgICAnbGlua2ZpZWxkJzogJycsXHJcbiAgICAgICd2aXNpYmxlZm9ybXVsYSc6ICcnLFxyXG4gICAgICAnZG91YmxlY2xpa2pvaW5zZWFyY2gnOiB0cnVlLFxyXG4gICAgICAnZGVzdGluYXRpb25xdWVyeUlkJzogJydcclxuICAgIH0pO1xyXG5cclxuICAgIHRoaXMuZGcucmVmcmVzaCgpO1xyXG4gIH1cclxuXHJcbiAgcmVtb3ZlU3ViSGFuZGxlcigpIHtcclxuICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xyXG4gICAgaWYgKHNlbGYuZGcuc2VsZWN0ZWRSb3cpIHtcclxuICAgICAgY29uc3QgaWQgPSBzZWxmLmRnLnNlbGVjdGVkUm93LmlkO1xyXG4gICAgICBjb25zdCBpbmRleCA9IGZpbmRJbmRleChzZWxmLmZ1bmN0aW9uU3ViRGF0YXMsIGZ1bmN0aW9uIChuOiBhbnkpIHtcclxuICAgICAgICByZXR1cm4gbi5pZCA9PT0gaWQ7XHJcbiAgICAgIH0pO1xyXG4gICAgICBzZWxmLmZ1bmN0aW9uU3ViRGF0YXMuc3BsaWNlKGluZGV4LCAxKTtcclxuICAgICAgc2VsZi5mdW5jdGlvblN1YkRhdGFzID0gWy4uLnNlbGYuZnVuY3Rpb25TdWJEYXRhc107XHJcbiAgICAgIGlmIChzZWxmLmZ1bmN0aW9uU3ViRGF0YXMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgc2VsZi5mdW5jdGlvblBhcmFEYXRhcyA9IFtdO1xyXG4gICAgICAgIHNlbGYuZnVuY3Rpb25QYXJhRGF0YXNPZlN1YiA9IFtdO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGNvbnN0IHBhcmFtcyA9IFtdO1xyXG4gICAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpwcmVmZXItZm9yLW9mXHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmZ1bmN0aW9uUGFyYURhdGFzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICBpZiAoc2VsZi5mdW5jdGlvblBhcmFEYXRhc1tpXS5mdW5jdGlvbmlkICE9PSBpZCkge1xyXG4gICAgICAgICAgICBwYXJhbXMucHVzaChzZWxmLmZ1bmN0aW9uUGFyYURhdGFzW2ldKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgc2VsZi5mdW5jdGlvblBhcmFEYXRhcy5wdXNoKC4uLnBhcmFtcyk7XHJcbiAgICAgIH1cclxuICAgICAgdGhpcy5kZy5yZWZyZXNoKCk7XHJcbiAgICAgIHRoaXMuZGcxLnJlZnJlc2goKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHB1YmxpYyBjYW5jZWxTdWJIYW5kbGVyKHR5cGU6IGFueSk6IHZvaWQge1xyXG4gICAgdGhpcy5kZy5lbmRSb3dFZGl0KCk7XHJcbiAgfVxyXG5cclxuICBnZXRGdW5jdGlvbk5hbWUoZGF0YTogYW55KSB7XHJcbiAgICBsZXQgbG9jYWwgPSAnemgtY2hzJztcclxuICAgIGlmICgoIWdzcCAmJiAhZ3NwLmNhY2hlKSAmJiBnc3BmcmFtZXdvcmtTZXJ2aWNlKSB7XHJcbiAgICAgIGxvY2FsID0gZ3NwZnJhbWV3b3JrU2VydmljZS5ydGYubGFuZ3VhZ2UuZ2V0TGFuZ3VhZ2VDb2RlKCkudG9Mb3dlckNhc2UoKTtcclxuICAgIH1cclxuICAgIGlmICghbG9jYWwpIHtcclxuICAgICAgbG9jYWwgPSAnemgtY2hzJztcclxuICAgIH1cclxuICAgIHJldHVybiBkYXRhW2xvY2FsXSA/IGRhdGFbbG9jYWxdIDogZGF0YTtcclxuICB9XHJcblxyXG4gIG9wZW5GdW5jKCkge1xyXG4gICAgdGhpcy5hcHBIZWxwLnNob3dIZWxwKHRoaXMuc2Vzc2lvbklkKTtcclxuICB9XHJcbiAgb3BlbkFwcCgpIHtcclxuICAgIHRoaXMucnRmYXBwSGVscC5zaG93SGVscCh0aGlzLnNlc3Npb25JZCk7XHJcbiAgfVxyXG5cclxuICBzZWxlY3RlZEZ1bmMoJGV2ZW50OiBhbnkpIHtcclxuICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xyXG4gICAgaWYgKHNlbGYuZGcuc2VsZWN0ZWRSb3cpIHtcclxuICAgICAgY29uc3QgaW5kZXggPSBmaW5kSW5kZXgoc2VsZi5mdW5jdGlvblN1YkRhdGFzLCBmdW5jdGlvbiAobjogYW55KSB7XHJcbiAgICAgICAgcmV0dXJuIG4uaWQgPT09IHNlbGYuZGcuc2VsZWN0ZWRSb3cuaWQ7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgc2VsZi5mdW5jdGlvblN1YkRhdGFzW2luZGV4XS5mdW5jdGlvbmNvZGUgPSAkZXZlbnRbMF0uSWQ7XHJcbiAgICAgIHNlbGYuZnVuY3Rpb25TdWJEYXRhc1tpbmRleF0uZnVuY3Rpb25uYW1lID0geyAnemgtY2hzJzogJGV2ZW50WzBdLk5hbWUgfTtcclxuICAgICAgc2VsZi5mdW5jdGlvblN1YkRhdGFzW2luZGV4XS5zZWFyY2h0eXBlID0gJ2Z1bmMnO1xyXG4gICAgICBsZXQgc3RhdGljUGFyYW0gPSAkZXZlbnRbMF0uSW52b2tpbmdDb25maWcuc3RhdGljUGFyYW1zO1xyXG4gICAgICBpZiAoc3RhdGljUGFyYW0pIHtcclxuICAgICAgICBzdGF0aWNQYXJhbSA9IEpTT04ucGFyc2Uoc3RhdGljUGFyYW0pO1xyXG4gICAgICAgIGZvciAoY29uc3Qgc3RhdGljUGFyYSBvZiBzdGF0aWNQYXJhbSkge1xyXG4gICAgICAgICAgaWYgKHN0YXRpY1BhcmEubmFtZSA9PT0gJ3F1ZXJ5SWQnKSB7XHJcbiAgICAgICAgICAgIHNlbGYuZnVuY3Rpb25TdWJEYXRhc1tpbmRleF0uZGVzdGluYXRpb25xdWVyeUlkID0gc3RhdGljUGFyYS52YWx1ZTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgc2VsZi5mdW5jdGlvblN1YkRhdGFzID0gWy4uLnNlbGYuZnVuY3Rpb25TdWJEYXRhc107XHJcbiAgICB9XHJcbiAgfVxyXG4gIHNlbGVjdGVkQXBwKCRldmVudDogYW55KSB7XHJcbiAgICBjb25zdCBzZWxmID0gdGhpcztcclxuICAgIGlmIChzZWxmLmRnLnNlbGVjdGVkUm93KSB7XHJcbiAgICAgIGNvbnN0IGluZGV4ID0gZmluZEluZGV4KHRoaXMuZnVuY3Rpb25TdWJEYXRhcywgZnVuY3Rpb24gKG46IGFueSkge1xyXG4gICAgICAgIHJldHVybiBuLmlkID09PSBzZWxmLmRnLnNlbGVjdGVkUm93LmlkO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIHNlbGYuZnVuY3Rpb25TdWJEYXRhc1tpbmRleF0uZnVuY3Rpb25jb2RlID0gJGV2ZW50LnNlbGVjdGVkSW52b2tbMF0uYXBwSWQ7XHJcbiAgICAgIHNlbGYuZnVuY3Rpb25TdWJEYXRhc1tpbmRleF0uZnVuY3Rpb25uYW1lID0geyAnemgtY2hzJzogJGV2ZW50LnNlbGVjdGVkSW52b2tbMF0ubmFtZSB9O1xyXG4gICAgICBzZWxmLmZ1bmN0aW9uU3ViRGF0YXNbaW5kZXhdLmFwcEVudHJhbmNlID0gJGV2ZW50LnNlbGVjdGVkSW52b2tbMF0uYXBwRW50cmFuY2U7XHJcbiAgICAgIHNlbGYuZnVuY3Rpb25TdWJEYXRhc1tpbmRleF0uc2VhcmNodHlwZSA9ICdhcHAnO1xyXG4gICAgICBsZXQgc3RhdGljUGFyYW0gPSAkZXZlbnQuc2VsZWN0ZWRJbnZva1swXS5zdGF0aWNQYXJhbXM7XHJcbiAgICAgIGlmIChzdGF0aWNQYXJhbSkge1xyXG4gICAgICAgIHN0YXRpY1BhcmFtID0gSlNPTi5wYXJzZShzdGF0aWNQYXJhbSk7XHJcbiAgICAgICAgZm9yIChjb25zdCBzdGF0aWNQYXJhIG9mIHN0YXRpY1BhcmFtKSB7XHJcbiAgICAgICAgICBpZiAoc3RhdGljUGFyYS5uYW1lID09PSAncXVlcnlJZCcpIHtcclxuICAgICAgICAgICAgc2VsZi5mdW5jdGlvblN1YkRhdGFzW2luZGV4XS5kZXN0aW5hdGlvbnF1ZXJ5SWQgPSBzdGF0aWNQYXJhLnZhbHVlO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICBzZWxmLmZ1bmN0aW9uU3ViRGF0YXMgPSBbLi4uc2VsZi5mdW5jdGlvblN1YkRhdGFzXTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGZpbmRJbmRleChldmVudDogYW55KSB7XHJcbiAgICB0aGlzLnNlbGVjdGVkSW5kZXggPSBldmVudC5kYXRhLmlkO1xyXG4gICAgdGhpcy5mdW5jdGlvblBhcmFEYXRhc09mU3ViID0gdGhpcy5mdW5jdGlvblBhcmFEYXRhcy5maWx0ZXIoeCA9PiB4LmZ1bmN0aW9uaWQgPT09IHRoaXMuc2VsZWN0ZWRJbmRleCk7XHJcbiAgICB0aGlzLmRnLmVuZFJvd0VkaXQoKTtcclxuICAgIHRoaXMuZGcxLmVuZFJvd0VkaXQoKTtcclxuICB9XHJcblxyXG4gIGNhbmNlbEVkaXRlZFBhcmEoZXZlbnQ6IGFueSkge1xyXG4gICAgdGhpcy5kZzEuZW5kUm93RWRpdCgpO1xyXG4gIH1cclxuXHJcbiAgaW5wdXRDb25kRXhwKCkge1xyXG4gICAgY29uc3Qgc2VsZiA9IHRoaXM7XHJcbiAgICBpZiAoc2VsZi5kZy5zZWxlY3RlZFJvdykge1xyXG4gICAgICBjb25zdCBpZCA9IHNlbGYuZGcuc2VsZWN0ZWRSb3cuaWQ7XHJcbiAgICAgIGNvbnN0IGluZGV4ID0gZmluZEluZGV4KHNlbGYuZnVuY3Rpb25TdWJEYXRhcywgZnVuY3Rpb24gKG46IGFueSkge1xyXG4gICAgICAgIHJldHVybiBuLmlkID09PSBpZDtcclxuICAgICAgfSk7XHJcblxyXG4gICAgICBpZiAodGhpcy52aWV3TW9kZWxGaWVsZHMpIHtcclxuICAgICAgICBmb3IgKGNvbnN0IGNvZGUgb2YgdGhpcy52aWV3TW9kZWxGaWVsZHMpIHtcclxuICAgICAgICAgIHRoaXMuZXhwcmVzc2lvblNlcnZpY2UuYWRkQ29udGV4dCh7XHJcbiAgICAgICAgICAgIGtleTogJ0BQXycgKyBjb2RlLFxyXG4gICAgICAgICAgICBuYW1lOiBjb2RlLFxyXG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogJydcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG5cclxuICAgICAgLy8g57uT5p6c6ZuG5YiX5L+h5oGv5pS+6L+b5LiK5LiL5paHXHJcbiAgICAgIGlmICh0aGlzLmR5bmFtaWNDb2xzKSB7XHJcbiAgICAgICAgdGhpcy5keW5hbWljQ29scy5mb3JFYWNoKGVsZW1lbnQgPT4ge1xyXG4gICAgICAgICAgdGhpcy5leHByZXNzaW9uU2VydmljZS5hZGRDb250ZXh0KHtcclxuICAgICAgICAgICAga2V5OiAnQFJfJyArIGVsZW1lbnQuYmluZEZpZWxkLFxyXG4gICAgICAgICAgICBuYW1lOiBlbGVtZW50Lm5hbWUsXHJcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiAnJ1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHNlbGYuZXhwcmVzc2lvblNlcnZpY2UuYWRkRXhwcmVzc2lvblRleHQoc2VsZi5mdW5jdGlvblN1YkRhdGFzW2luZGV4XS52aXNpYmxlZm9ybXVsYSk7XHJcbiAgICAgIHNlbGYuZXhwcmVzc2lvblNlcnZpY2UuYnVpbGRFeHByZXNzaW9uKCkudGhlbihleHByZXNzU3RyID0+IHtcclxuICAgICAgICBzZWxmLmZ1bmN0aW9uU3ViRGF0YXNbaW5kZXhdLnZpc2libGVmb3JtdWxhID0gZXhwcmVzc1N0cjtcclxuICAgICAgICAvLyBpZiAoc2VsZi5kZykge1xyXG4gICAgICAgIC8vICAgc2VsZi5kZy5yZWZyZXNoKCk7XHJcbiAgICAgICAgLy8gICBzZWxmLmRnLmRhdGEgPSBzZWxmLmZ1bmN0aW9uU3ViRGF0YXM7XHJcbiAgICAgICAgLy8gfVxyXG4gICAgICAgIHNlbGYuZnVuY3Rpb25TdWJEYXRhcyA9IFsuLi5zZWxmLmZ1bmN0aW9uU3ViRGF0YXNdO1xyXG4gICAgICAgIGlmIChzZWxmLl9jdXJyZW50Q29uZGl0aW9uSW5wdXQpIHtcclxuICAgICAgICAgIHNlbGYuX2N1cnJlbnRDb25kaXRpb25JbnB1dC5mb3JtQ29udHJvbC5zZXRWYWx1ZShleHByZXNzU3RyKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgYWRkUGFyYUhhbmRsZXIoKSB7XHJcbiAgICBjb25zdCBmdW5jdGlvbmlkID0gdGhpcy5zZWxlY3RlZEluZGV4O1xyXG4gICAgaWYgKGZ1bmN0aW9uaWQgIT09IC0xKSB7XHJcbiAgICAgIHRoaXMuZnVuY3Rpb25QYXJhRGF0YXMucHVzaCh7XHJcbiAgICAgICAgJ2lkJzogRXZlbnRCdXMuZ3VpZCgpLFxyXG4gICAgICAgICdmdW5jdGlvbmlkJzogZnVuY3Rpb25pZCxcclxuICAgICAgICAncGFyYSc6ICcnLFxyXG4gICAgICAgICdwYXJhbmFtZSc6ICcnLFxyXG4gICAgICAgICdwYXJhdmFsdWUnOiAnJyxcclxuICAgICAgICAncGFyYXZhbHVldHlwZSc6IGZhbHNlXHJcbiAgICAgIH0pO1xyXG4gICAgICB0aGlzLmZ1bmN0aW9uUGFyYURhdGFzT2ZTdWIgPSB0aGlzLmZ1bmN0aW9uUGFyYURhdGFzLmZpbHRlcih4ID0+IHguZnVuY3Rpb25pZCA9PT0gdGhpcy5zZWxlY3RlZEluZGV4KTtcclxuICAgIH1cclxuICAgIHRoaXMuZGcxLnJlZnJlc2goKTtcclxuICB9XHJcbiAgcmVtb3ZlUGFyYUhhbmRsZXIoKSB7XHJcbiAgICBjb25zdCBzZWxmID0gdGhpcztcclxuICAgIGlmIChzZWxmLmRnMS5zZWxlY3RlZFJvdykge1xyXG4gICAgICBjb25zdCBpbmRleCA9IGZpbmRJbmRleChzZWxmLmZ1bmN0aW9uUGFyYURhdGFzLCBmdW5jdGlvbiAobjogYW55KSB7XHJcbiAgICAgICAgcmV0dXJuIG4uaWQgPT09IHNlbGYuZGcxLnNlbGVjdGVkUm93LmlkO1xyXG4gICAgICB9KTtcclxuICAgICAgc2VsZi5mdW5jdGlvblBhcmFEYXRhcy5zcGxpY2UoaW5kZXgsIDEpO1xyXG4gICAgICBzZWxmLmZ1bmN0aW9uUGFyYURhdGFzT2ZTdWIgPSBzZWxmLmZ1bmN0aW9uUGFyYURhdGFzLmZpbHRlcih4ID0+IHguZnVuY3Rpb25pZCA9PT0gdGhpcy5zZWxlY3RlZEluZGV4KTtcclxuICAgICAgc2VsZi5mdW5jdGlvblBhcmFEYXRhc09mU3ViID0gWy4uLnNlbGYuZnVuY3Rpb25QYXJhRGF0YXNPZlN1Yl07XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcbiJdfQ==