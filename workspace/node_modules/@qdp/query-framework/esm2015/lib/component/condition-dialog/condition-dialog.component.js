/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Injector, ViewChild, Input, Output, EventEmitter, QueryList, ContentChildren } from '@angular/core';
import { DialogComponent } from '@farris/ui-dialog';
import { LocalizeService } from '@qdp/localize';
import { Repository } from '@farris/devkit';
import { SchemaService } from '@qdp/ide-cmp';
import { NotifyService } from '@farris/ui-notify';
import { ConditionSchemaService } from '@qdp/condition-schema';
import { ConditionManagerDialogComponent } from '../condition-manager-dialog/condition-manager-dialog.component';
import { SaveasSchemaDialogComponent } from '../saveas-schema-dialog/saveas-schema-dialog.component';
import { of, Subject } from 'rxjs';
import { CacheService } from '@ecp-caf/caf-common';
import { LcpService, QDPCacheUtil, RtfServices, EventBus } from '@qdp/common';
import { FinishLoadService } from '@qdp/condition-schema';
import { ConditionDialogTabComponent } from '../condition-dialog-tab/condition-dialog-tab.component';
import { FormErrorService } from '@farris/command-services';
export class ConditionDialogComponent {
    /**
     * @param {?} injector
     * @param {?} conditionService
     * @param {?} repository
     * @param {?} cacheService
     * @param {?} finishLoasService
     */
    constructor(injector, conditionService, repository, cacheService, finishLoasService) {
        this.injector = injector;
        this.conditionService = conditionService;
        this.repository = repository;
        this.cacheService = cacheService;
        this.finishLoasService = finishLoasService;
        // OnChanges,
        this.schemaId = '';
        this.showFilterExpression = true;
        this.tabIndex = 0;
        this.queryEvent = new EventEmitter();
        this.dialogInitEvent = new EventEmitter();
        this.idChanged = new Subject();
        this.menuShow = false;
        this.defaultSchemaName = '条件方案';
        this.publicList = [];
        this.personalList = [];
        this.controlIndexChanged = 0;
        this.subscriptions = [];
        this.closeType = '';
        this.propertyList = [];
        this.filterExpressionString = '';
        this.beforeOpen = (/**
         * @return {?}
         */
        () => true);
        this.handlebeforeClose = (/**
         * @return {?}
         */
        () => {
            // const self = this;
            // if (this.closeType !== 'query') {
            //   if (self.repository.entityCollection.getAllEntities() && self.repository.entityCollection.getAllEntities()[0]) {
            //     const obj = {
            //       id: self.repository.entityCollection.getAllEntities()[0]['id']
            //     };
            //     self.repository.entityCollection.getAllEntities()[0].load(obj);
            //     (self.repository as BefRepository<Entity>).entityManager.clearAllEntityChanges();
            //     if (this.advanceFilterTab) {
            //       this.advanceFilterTab.filterExpressionString = '';
            //     }
            //   }
            // }
            // this.closeType = '';
            return of(true);
        });
        if (this.injector) {
            this.localizeService = this.injector.get(LocalizeService);
            this.notifyService = this.injector.get(NotifyService);
            this.defaultSchemaName = this.localizeService.getValue('queryFramework.ispreName');
            this.formErrorService = this.injector.get(FormErrorService);
            this.schemaService = this.injector.get(SchemaService);
            this.lcpService = this.injector.get(LcpService);
        }
    }
    /**
     * @return {?}
     */
    getConditionTabs() {
        try {
            if (this.conditionTabs && this.conditionTabs.length) {
                return this.conditionTabs;
            }
            else if (QDPCacheUtil.getCache(RtfServices.getTabId('condition-dialog-tabs') + 'condition-dialog-tabs') && QDPCacheUtil.getCache(RtfServices.getTabId('condition-dialog-tabs') + 'condition-dialog-tabs').length) {
                return QDPCacheUtil.getCache(RtfServices.getTabId('condition-dialog-tabs') + 'condition-dialog-tabs');
            }
        }
        catch (e) {
            return this.conditionTabs;
        }
    }
    /**
     * @return {?}
     */
    get Id() {
        return this.schemaId;
    }
    /**
     * @param {?} value
     * @return {?}
     */
    set Id(value) {
        this.schemaId = value;
        this.idChanged.next(value);
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        this.tabId = RtfServices.getTabId(this.queryId);
        this.queryCount = 1;
        this.conditionDialogInit();
        if (!this.beforeQuery) {
            this.beforeQuery = (/**
             * @param {?} params
             * @return {?}
             */
            (params) => of(true));
        }
        QDPCacheUtil.setCache(this.tabId + 'advanceTemplate-condition-dialog', this);
    }
    /**
     * @return {?}
     */
    ngAfterViewInit() {
        EventBus.dispatch(this.tabId + 'advanceTemplate-condition-dialog-dialogInitEvent', {});
        this.dialogInitEvent.emit(true);
    }
    /**
     * @return {?}
     */
    conditionDialogInit() {
        /** @type {?} */
        const self = this;
        this.subscriptions.push(self.conditionService.getSchemaList(self.queryId, '', '').subscribe());
        this.subscriptions.push(self.conditionService.schemaListChange.subscribe((/**
         * @param {?} result
         * @return {?}
         */
        (result) => {
            /** @type {?} */
            const data = result.schemaInfo;
            if (data && data[self.queryId]) {
                self.publicList = [];
                self.personalList = [];
                for (const key in data[self.queryId]) {
                    if (data[self.queryId][key].schemaType === 0) {
                        self.publicList.push(data[self.queryId][key]);
                    }
                    else {
                        self.personalList.push(data[self.queryId][key]);
                    }
                }
                /** @type {?} */
                let flag = false;
                if (self.schemaId) {
                    /** @type {?} */
                    let index = self.publicList.findIndex((/**
                     * @param {?} item
                     * @return {?}
                     */
                    (item) => item.id === self.schemaId));
                    if (index >= 0) {
                        flag = true;
                        self.currentSchema = self.publicList[index];
                        self.initCondition(self.currentSchema);
                    }
                    index = self.personalList.findIndex((/**
                     * @param {?} item
                     * @return {?}
                     */
                    (item) => item.id === self.schemaId));
                    if (index >= 0) {
                        flag = true;
                        self.currentSchema = self.personalList[index];
                        self.initCondition(self.currentSchema);
                    }
                }
                if (!flag && self.conditionService.isDefaultSchema && self.conditionService.isDefaultSchema[self.queryId] && self.conditionService.isDefaultSchema[self.queryId].id) {
                    self.currentSchema = self.conditionService.isDefaultSchema[self.queryId];
                    self.schemaId = self.conditionService.isDefaultSchema[self.queryId].id;
                    self.defaultSchemaName = self.currentSchema.schemaName;
                }
                this.subscriptions.push(this.finishLoasService.finish.subscribe((/**
                 * @param {?} data
                 * @return {?}
                 */
                (data) => {
                    self.initCondition(self.currentSchema);
                })));
            }
            else {
                self.defaultSchemaName = self.localizeService.getValue('queryFramework.ispreName');
            }
        })));
        this.subscriptions.push(self.idChanged.subscribe((/**
         * @param {?} schemaId
         * @return {?}
         */
        (schemaId) => {
            if (schemaId) {
                self.subscriptions.push(self.conditionService.getSchema(schemaId, self.queryId, true).subscribe((/**
                 * @param {?} data
                 * @return {?}
                 */
                (data) => {
                    if (data) {
                        self.currentSchema = data;
                        self.defaultSchemaName = self.currentSchema.schemaName;
                        self.initCondition(self.currentSchema);
                        if (self.controlIndexChanged === 1) {
                            self.handleInfoChanged(self.controlIndexChanged);
                        }
                    }
                })));
            }
        })));
    }
    /**
     * @private
     * @param {?} schema
     * @return {?}
     */
    initCondition(schema) {
        /** @type {?} */
        const self = this;
        if (schema) { // 预制默认对象
            if (schema.schemaValue && typeof (schema.schemaValue) === 'object') {
                if (schema && schema.schemaValue && this.repository.entityCollection.getAllEntities() && this.repository.entityCollection.getAllEntities().length) {
                    schema.schemaValue.id = this.repository.entityCollection.getAllEntities()[0]['id'];
                }
                self.repository.entityCollection.getAllEntities()[0].load(schema.schemaValue);
                self.filterExpressionString = '';
                if (schema.schemaValue.hasOwnProperty('@filterExpressionString@')) {
                    self.filterExpressionString = schema.schemaValue['@filterExpressionString@'];
                }
            }
            else {
                if (self.repository.entityCollection.getAllEntities() && self.repository.entityCollection.getAllEntities()[0]) {
                    /** @type {?} */
                    const obj = {
                        id: self.repository.entityCollection.getAllEntities()[0]['id']
                    };
                    self.repository.entityCollection.getAllEntities()[0].load(obj);
                }
            }
        }
    }
    /**
     * @param {?} item
     * @return {?}
     */
    getPropertyList(item) {
        this.subscriptions.push(this.lcpService.getCol({
            schemaId: '1',
            entityData: JSON.stringify({ 'id': 'undefined_null' }),
            pageIndex: 1,
            pageSize: 0,
            qoManagerCode: QDPCacheUtil.getCache(this.tabId + 'qoManagerCode'),
            controlType: QDPCacheUtil.getCache(this.tabId + 'controlType'),
            voCode: QDPCacheUtil.getCache(this.tabId + 'voId')
        }, QDPCacheUtil.getCache(this.tabId + 'queryRelativeUrl')).subscribe((/**
         * @param {?} value
         * @return {?}
         */
        value => {
            if (value && value.dynamicCols && value.dynamicCols.length) {
                this.analysisColListData(value.dynamicCols, 'col');
                if (this.advanceFilterTab) {
                    this.advanceFilterTab.propertyList = [...this.propertyList];
                    this.advanceFilterTab.filterExpressionString = this.filterExpressionString;
                }
                item.createFilterComponent();
            }
        })));
    }
    /**
     * @private
     * @param {?} newValue
     * @param {?=} type
     * @return {?}
     */
    analysisColListData(newValue, type) {
        this.propertyList = [];
        newValue.forEach((/**
         * @param {?} col
         * @return {?}
         */
        col => {
            this.recursiveAnalysisColListData(null, col, type);
        }));
    }
    /**
     * @private
     * @param {?} children
     * @param {?} col
     * @param {?=} type
     * @return {?}
     */
    recursiveAnalysisColListData(children, col, type) {
        if (col) {
            /** @type {?} */
            const index = this.propertyList.findIndex((/**
             * @param {?} item
             * @return {?}
             */
            (item) => item.Code === col.bindField));
            if (index < 0) {
                /** @type {?} */
                const node = {};
                node['value'] = col.bindField;
                node['propertyFieldType'] = this.getDataType(col.type);
                node['text'] = col.name;
                this.propertyList.push(node);
            }
            else if (type !== 'col') {
                this.propertyList[index]['text'] = col.name;
            }
            if (col.childList && col.childList.length) {
                this.recursiveAnalysisColListData(col.childList, null);
            }
        }
        else {
            children.forEach((/**
             * @param {?} c
             * @return {?}
             */
            (c) => {
                /** @type {?} */
                const index = this.propertyList.findIndex((/**
                 * @param {?} item
                 * @return {?}
                 */
                (item) => item.Code === c.bindField));
                if (index < 0) {
                    /** @type {?} */
                    const node = {};
                    node['value'] = c.bindField;
                    node['propertyFieldType'] = this.getDataType(c.type);
                    node['text'] = c.name;
                    this.propertyList.push(node);
                }
                else if (type !== 'col') {
                    this.propertyList[index]['text'] = c.name;
                }
                if (c.childList && c.childList.length) {
                    this.recursiveAnalysisColListData(c.childList, null);
                }
            }));
        }
    }
    /**
     * @private
     * @param {?} type
     * @return {?}
     */
    getDataType(type) {
        /** @type {?} */
        let result = 0;
        switch (type) {
            case 'string':
            case 'text':
                result = 0;
                break;
            case 'integer':
                result = 2;
                break;
            case 'decimal':
                result = 4;
                break;
            case 'boolean':
                result = 8;
                break;
            case 'date':
            case 'dateTime':
                result = 9;
                break;
            case 'byte':
                result = 6;
                break;
            case 'char':
                result = 7;
                break;
            case 'array':
                result = 10;
                break;
            default:
                break;
        }
        return result;
    }
    /**
     * @return {?}
     */
    ngOnDestroy() {
        if (this.subscriptions && this.subscriptions.length) {
            for (const subscription of this.subscriptions) {
                subscription.unsubscribe();
            }
        }
    }
    /**
     * @param {?} changes
     * @return {?}
     */
    ngOnChanges(changes) {
    }
    /**
     * @return {?}
     */
    handleDialogShow() {
        this.farrisDialog.show();
    }
    /**
     * @return {?}
     */
    handleDialogClose() {
        this.farrisDialog.close();
    }
    /**
     * @return {?}
     */
    handleSchemaManagerDialog() {
        this.conditionManagerDialog.handleDialogShow();
        this.menuShow = !this.menuShow;
    }
    /**
     * @return {?}
     */
    handleSaveasSchemaDialog() {
        this.saveasSchemaDialogComponent.schemaName = '';
        this.saveasSchemaDialogComponent.isDefault = false;
        this.saveasSchemaDialogComponent.isSchemaType = 0;
        this.menuShow = false;
        this.saveasSchemaDialogComponent.handleDialogShow();
        if (this.advanceFilterTab && this.advanceFilterTab.filterInstance) {
            this.saveasSchemaDialogComponent.filterInstance = this.advanceFilterTab.filterInstance;
        }
    }
    /**
     * @return {?}
     */
    handleSchemaMenu() {
        this.menuShow = !this.menuShow;
    }
    /**
     * @param {?} $event
     * @return {?}
     */
    handleInfoChanged($event) {
        /** @type {?} */
        const self = this;
        this.controlIndexChanged = $event;
        if (this.getConditionTabs() && this.getConditionTabs().length) {
            this.getConditionTabs().forEach((/**
             * @param {?} item
             * @return {?}
             */
            (item) => {
                item.controlIndexChanged = $event;
                item.changeCss();
                if (item.tabIndex === 1 && self.showFilterExpression) {
                    self.advanceFilterTab = item;
                    self.getPropertyList(item);
                }
            }));
        }
    }
    /**
     * @param {?} $event
     * @return {?}
     */
    handleSchemaSelected($event) {
        this.defaultSchemaName = $event.schemaName;
        this.menuShow = !this.menuShow;
        this.currentSchema = $event;
        this.Id = this.currentSchema.id;
    }
    /**
     * @return {?}
     */
    handleQueryClick() {
        /** @type {?} */
        const params = this.handlerGetEntity();
        this.beforeQuery().subscribe((/**
         * @param {?} result
         * @return {?}
         */
        (result) => {
            if (result == true) {
                EventBus.dispatch('openAdvanceTemplateDialog', {});
                this.cacheService.set(this.tabId, params);
                EventBus.dispatch(this.tabId + 'advanceTemplate-condition-dialog-queryEvent', this.queryCount++);
                this.queryEvent.emit(this.queryCount++);
                this.closeType = 'query';
                this.handleDialogClose();
            }
        }));
    }
    /**
     * @return {?}
     */
    handleSaveClick() {
        /** @type {?} */
        const self = this;
        /** @type {?} */
        const params = this.handlerGetEntity();
        if (this.currentSchema) {
            this.currentSchema.schemaValue = params;
            /** @type {?} */
            const newSchema = JSON.parse(JSON.stringify(this.currentSchema));
            if (this.advanceFilterTab && this.advanceFilterTab.filterInstance) {
                if (!newSchema.schemaValue) {
                    newSchema.schemaValue = {};
                }
                newSchema.schemaValue['@filterExpressionString@'] = this.advanceFilterTab.filterInstance.getFilterExpression();
            }
            newSchema.schemaValue = newSchema.schemaValue ? JSON.stringify(newSchema.schemaValue) : null;
            this.conditionService.saveSchema(newSchema).subscribe((/**
             * @return {?}
             */
            () => {
                self.notifyService['success']((/** @type {?} */ ({
                    title: self.localizeService.getValue('queryFramework.message.info.title'), msg: self.localizeService.getValue('queryFramework.message.save.success'), timeout: 3000
                })));
            }), (/**
             * @param {?} error
             * @return {?}
             */
            (error) => {
                self.formErrorService.exception(this.localizeService.getValue('ideCmp.schemaManager.message.validate.qdpModifyPublicSchema'), error);
            }));
        }
    }
    /**
     * @return {?}
     */
    handlerGetEntity() {
        /** @type {?} */
        const entitys = this.repository.entityCollection.getAllEntities();
        /** @type {?} */
        let params;
        if (entitys && entitys.length) {
            params = entitys[0].toJSON();
            if (this.advanceFilterTab && this.advanceFilterTab.filterInstance) {
                if (!params) {
                    params = { id: 'undefined_null' };
                }
                params['@filterExpressionString@'] = this.advanceFilterTab.filterInstance.getFilterExpression();
            }
            else if (this.filterExpressionString) {
                if (!params) {
                    params = { id: 'undefined_null' };
                }
                params['@filterExpressionString@'] = this.filterExpressionString;
            }
        }
        return params;
    }
}
ConditionDialogComponent.decorators = [
    { type: Component, args: [{
                selector: 'condition-dialog',
                template: "<farris-dialog #farrisDialog [title]=\"localizeService.getValue('queryFramework.dialogTitle')\" [showButtons]=\"false\" [beforeClose]=\"handlebeforeClose\"\r\n  [width]=\"960\" [showMaxButton]=\"false\" [showMinButton]=\"false\" [resizable]=\"false\" [height]=\"570\" [beforeOpen]=\"beforeOpen\">\r\n  <div class=\"f-utils-absolute-all f-utils-flex-column bg-white\">\r\n    <div class=\"f-utils-flex-row-wrap farris-overflow-hidden\">\r\n      <div class=\"ml-3 mt-2 schema-manager-title\" (click)=\"handleSchemaMenu()\">{{defaultSchemaName}}</div>\r\n      <div class=\"schema-manager-tr\">\r\n      </div>\r\n    </div>\r\n    <div class=\"box ml-3 mt-2 schema-manager-dropdown\" [style.display]=\"menuShow?'block':'none'\">\r\n      <div class=\"f-utils-absolute-all f-utils-flex-column\">\r\n        <div class=\"f-utils-fill-flex-column f-utils-fill-auto\">\r\n          <div class=\"schemaType\">{{localizeService.getValue('queryFramework.schemaType.public')}}</div>\r\n          <div *ngFor=\"let item of publicList\" [class]=\"currentSchema && currentSchema.id && currentSchema.id === item.id ? 'schemaItem schemaItemHover' : 'schemaItem'\">\r\n            <div class=\"f-utils-flex-row-wrap\" (click)=\"handleSchemaSelected(item)\">\r\n              <div class=\"schemaItemFont1 col-8\">{{item.schemaName}}</div>\r\n              <div *ngIf=\"item.isDefault === 1\" class=\"schemaItemFont2 col-4\">\r\n                {{localizeService.getValue('queryFramework.defaultName')}}</div>\r\n            </div>\r\n          </div>\r\n          <div class=\"schemaType\">{{localizeService.getValue('queryFramework.schemaType.personal')}}</div>\r\n          <div *ngFor=\"let item1 of personalList\" [class]=\"currentSchema && currentSchema.id && currentSchema.id === item1.id ? 'schemaItem schemaItemHover' : 'schemaItem'\">\r\n            <div class=\"f-utils-flex-row-wrap\" (click)=\"handleSchemaSelected(item1)\">\r\n              <div class=\"schemaItemFont1 col-8\">{{item1.schemaName}}</div>\r\n              <div *ngIf=\"item1.isDefault === 1\" class=\"schemaItemFont2 col-4\">\r\n                {{localizeService.getValue('queryFramework.defaultName')}}</div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div class=\"p-2 schema-manager-toolbar\">\r\n          <div class=\"btn-toolbar btn-group-lg\" id=\"page-header-toolbar\">\r\n            <button class=\"btn btn-link mr-1\" id=\"button-edit\"\r\n              (click)=\"handleSchemaManagerDialog()\">{{localizeService.getValue('queryFramework.btnManager')}}</button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=\"f-utils-flex-row pl-3 pr-3 pt-2 pb-2\">\r\n      <button [class]=\"controlIndexChanged === 0 ? 'btn btn-primary' : 'btn btn-secondary'\" id=\"button-edit1\"\r\n        (click)=\"handleInfoChanged(0)\">\r\n        {{localizeService.getValue('queryFramework.tabName1')}}</button>\r\n      <button [class]=\"controlIndexChanged === 1 ? 'btn btn-primary' : 'btn btn-secondary'\" id=\"button-edit2\"\r\n        (click)=\"handleInfoChanged(1)\">\r\n        {{localizeService.getValue('queryFramework.tabName2')}}</button>\r\n      <!-- <button [class]=\"controlIndexChanged == false ? 'btn btn-primary' : 'btn btn-secondary'\" id=\"button-edit2\"\r\n          (click)=\"handleInfoChanged(2)\">\r\n          {{localizeService.getValue('ideCmp.schemaManager.columnOption.selection2')}}</button> -->\r\n    </div>\r\n    <div class=\"f-utils-fill-flex-column\">\r\n      <ng-content></ng-content>\r\n    </div>\r\n    <div class=\"modal-footer\">\r\n      <div class=\"btn-toolbar btn-group-lg\" id=\"page-header-toolbar\">\r\n        <button class=\"btn btn-primary mr-1\" id=\"button-edit\" (click)=\"handleQueryClick()\">\r\n          {{localizeService.getValue('queryFramework.btnQuery')}}</button>\r\n        <button class=\"btn btn-secondary mr-1\" id=\"button-edit\" (click)=\"handleSaveasSchemaDialog()\">\r\n          {{localizeService.getValue('queryFramework.btnSaveAsSchema')}}</button>\r\n        <button *ngIf=\"(!currentSchema) == false\" class=\"btn btn-secondary mr-1\" id=\"button-edit\" (click)=\"handleSaveClick()\">\r\n          {{localizeService.getValue('queryFramework.btnSaveSchema')}}</button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</farris-dialog>\r\n<condition-manager-dialog [queryId]=\"queryId\" [publicList]=\"publicList\" [personalList]=\"personalList\" [currentSchema]=\"currentSchema\"></condition-manager-dialog>\r\n<saveas-schema-dialog [queryId]=\"queryId\" [currentSchema]=\"currentSchema\"></saveas-schema-dialog>\r\n",
                styles: [".schema-manager-title{cursor:pointer;display:block;height:22px;font-family:PingFangSC-Regular;font-size:16px;color:#388fff;text-align:right}.schema-manager-tr{margin-top:1.1rem!important;margin-left:.25rem!important;width:0;height:0;border-left:3px solid transparent;border-right:3px solid transparent;border-top:6px solid rgba(0,0,0,.25)}.box{cursor:pointer;display:inline-block;position:relative;width:200px;height:246px;-webkit-filter:drop-shadow(0 2px 4px rgba(0, 0, 0, .2));filter:drop-shadow(0 2px 4px rgba(0, 0, 0, .2));border-radius:3px;background-color:#fff;border:1px solid #bbb}.box:after,.box:before{content:\"\";position:absolute;border:10px solid transparent;bottom:100%;left:10px}.box:before{border-bottom-color:#bbb}.box:after{border-bottom-color:#fff;margin-bottom:-1px}.schemaType{font-family:PingFangSC-Regular;font-size:14px;color:rgba(0,0,0,.45);line-height:20px;padding-left:.75rem!important;padding-top:.75rem!important;padding-bottom:.25rem!important}.schemaItem{height:30px}.schemaItem:hover,.schemaItemHover{background:#ddf4ff}.schemaItemFont1{font-family:PingFangSC-Regular;font-size:14px;color:rgba(0,0,0,.85);line-height:20px;margin-top:.25rem!important;margin-bottom:.25rem!important;float:left;text-align:center;word-break:keep-all;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;padding-left:0;padding-right:0}.schemaItemFont2{font-family:PingFangSC-Regular;font-size:12px;color:rgba(0,0,0,.45);line-height:20px;margin-top:.25rem!important;margin-bottom:.25rem!important;float:right;text-align:right;padding-left:0}.schema-manager-toolbar{background:#f9f9f9;display:flex;align-items:center;justify-content:flex-end;border-top:1px solid #e2e8f0}.schema-manager-dropdown{float:left;z-index:1000;position:absolute;top:30px}"]
            }] }
];
/** @nocollapse */
ConditionDialogComponent.ctorParameters = () => [
    { type: Injector },
    { type: ConditionSchemaService },
    { type: Repository },
    { type: CacheService },
    { type: FinishLoadService }
];
ConditionDialogComponent.propDecorators = {
    showFilterExpression: [{ type: Input }],
    queryId: [{ type: Input }],
    tabIndex: [{ type: Input }],
    beforeQuery: [{ type: Input }],
    queryEvent: [{ type: Output }],
    farrisDialog: [{ type: ViewChild, args: ['farrisDialog',] }],
    conditionTabs: [{ type: ContentChildren, args: [ConditionDialogTabComponent,] }],
    conditionManagerDialog: [{ type: ViewChild, args: [ConditionManagerDialogComponent,] }],
    saveasSchemaDialogComponent: [{ type: ViewChild, args: [SaveasSchemaDialogComponent,] }]
};
if (false) {
    /** @type {?} */
    ConditionDialogComponent.prototype.schemaId;
    /** @type {?} */
    ConditionDialogComponent.prototype.showFilterExpression;
    /** @type {?} */
    ConditionDialogComponent.prototype.queryId;
    /** @type {?} */
    ConditionDialogComponent.prototype.tabIndex;
    /** @type {?} */
    ConditionDialogComponent.prototype.beforeQuery;
    /** @type {?} */
    ConditionDialogComponent.prototype.queryEvent;
    /** @type {?} */
    ConditionDialogComponent.prototype.dialogInitEvent;
    /** @type {?} */
    ConditionDialogComponent.prototype.idChanged;
    /** @type {?} */
    ConditionDialogComponent.prototype.farrisDialog;
    /** @type {?} */
    ConditionDialogComponent.prototype.conditionTabs;
    /** @type {?} */
    ConditionDialogComponent.prototype.conditionManagerDialog;
    /** @type {?} */
    ConditionDialogComponent.prototype.saveasSchemaDialogComponent;
    /** @type {?} */
    ConditionDialogComponent.prototype.localizeService;
    /** @type {?} */
    ConditionDialogComponent.prototype.menuShow;
    /** @type {?} */
    ConditionDialogComponent.prototype.defaultSchemaName;
    /** @type {?} */
    ConditionDialogComponent.prototype.currentSchema;
    /** @type {?} */
    ConditionDialogComponent.prototype.publicList;
    /** @type {?} */
    ConditionDialogComponent.prototype.personalList;
    /** @type {?} */
    ConditionDialogComponent.prototype.controlIndexChanged;
    /** @type {?} */
    ConditionDialogComponent.prototype.queryCount;
    /** @type {?} */
    ConditionDialogComponent.prototype.notifyService;
    /**
     * @type {?}
     * @private
     */
    ConditionDialogComponent.prototype.subscriptions;
    /**
     * @type {?}
     * @private
     */
    ConditionDialogComponent.prototype.closeType;
    /** @type {?} */
    ConditionDialogComponent.prototype.formErrorService;
    /** @type {?} */
    ConditionDialogComponent.prototype.propertyList;
    /** @type {?} */
    ConditionDialogComponent.prototype.filterExpressionString;
    /** @type {?} */
    ConditionDialogComponent.prototype.advanceFilterTab;
    /** @type {?} */
    ConditionDialogComponent.prototype.schemaService;
    /** @type {?} */
    ConditionDialogComponent.prototype.lcpService;
    /** @type {?} */
    ConditionDialogComponent.prototype.tabId;
    /** @type {?} */
    ConditionDialogComponent.prototype.beforeOpen;
    /** @type {?} */
    ConditionDialogComponent.prototype.handlebeforeClose;
    /**
     * @type {?}
     * @private
     */
    ConditionDialogComponent.prototype.injector;
    /**
     * @type {?}
     * @private
     */
    ConditionDialogComponent.prototype.conditionService;
    /**
     * @type {?}
     * @private
     */
    ConditionDialogComponent.prototype.repository;
    /**
     * @type {?}
     * @private
     */
    ConditionDialogComponent.prototype.cacheService;
    /**
     * @type {?}
     * @private
     */
    ConditionDialogComponent.prototype.finishLoasService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29uZGl0aW9uLWRpYWxvZy5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AcWRwL3F1ZXJ5LWZyYW1ld29yay8iLCJzb3VyY2VzIjpbImxpYi9jb21wb25lbnQvY29uZGl0aW9uLWRpYWxvZy9jb25kaXRpb24tZGlhbG9nLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUFFLFNBQVMsRUFBRSxRQUFRLEVBQVUsU0FBUyxFQUE0QixLQUFLLEVBQUUsTUFBTSxFQUFFLFlBQVksRUFBYSxTQUFTLEVBQUUsZUFBZSxFQUFpQixNQUFNLGVBQWUsQ0FBQztBQUNwTCxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0sbUJBQW1CLENBQUM7QUFDcEQsT0FBTyxFQUFFLGVBQWUsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUNoRCxPQUFPLEVBQVUsVUFBVSxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFFcEQsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLGNBQWMsQ0FBQztBQUM3QyxPQUFPLEVBQUUsYUFBYSxFQUFpQixNQUFNLG1CQUFtQixDQUFDO0FBQ2pFLE9BQU8sRUFBRSxzQkFBc0IsRUFBRSxNQUFNLHVCQUF1QixDQUFDO0FBQy9ELE9BQU8sRUFBRSwrQkFBK0IsRUFBRSxNQUFNLGdFQUFnRSxDQUFDO0FBQ2pILE9BQU8sRUFBRSwyQkFBMkIsRUFBRSxNQUFNLHdEQUF3RCxDQUFDO0FBQ3JHLE9BQU8sRUFBYyxFQUFFLEVBQUUsT0FBTyxFQUFnQixNQUFNLE1BQU0sQ0FBQztBQUM3RCxPQUFPLEVBQUUsWUFBWSxFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFDbkQsT0FBTyxFQUFFLFVBQVUsRUFBRSxZQUFZLEVBQUUsV0FBVyxFQUFFLFFBQVEsRUFBRSxNQUFNLGFBQWEsQ0FBQztBQUM5RSxPQUFPLEVBQUUsaUJBQWlCLEVBQUUsTUFBTSx1QkFBdUIsQ0FBQztBQUMxRCxPQUFPLEVBQUUsMkJBQTJCLEVBQUUsTUFBTSx3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QztJQUNoQixDQUFDOzs7WUF6WEYsU0FBUyxTQUFDO2dCQUNULFFBQVEsRUFBRSxrQkFBa0I7Z0JBQzVCLHdnSkFBZ0Q7O2FBRWpEOzs7O1lBdEJtQixRQUFRO1lBT25CLHNCQUFzQjtZQUpkLFVBQVU7WUFRbEIsWUFBWTtZQUVaLGlCQUFpQjs7O21DQVl2QixLQUFLO3NCQUNMLEtBQUs7dUJBQ0wsS0FBSzswQkFDTCxLQUFLO3lCQUNMLE1BQU07MkJBR04sU0FBUyxTQUFDLGNBQWM7NEJBQ3hCLGVBQWUsU0FBQywyQkFBMkI7cUNBYTNDLFNBQVMsU0FBQywrQkFBK0I7MENBQ3pDLFNBQVMsU0FBQywyQkFBMkI7Ozs7SUF2QnRDLDRDQUFjOztJQUNkLHdEQUFxQzs7SUFDckMsMkNBQWlCOztJQUNqQiw0Q0FBc0I7O0lBQ3RCLCtDQUF5RDs7SUFDekQsOENBQStDOztJQUMvQyxtREFBMEM7O0lBQzFDLDZDQUErQjs7SUFDL0IsZ0RBQXlEOztJQUN6RCxpREFBb0c7O0lBYXBHLDBEQUFvRzs7SUFDcEcsK0RBQWlHOztJQUNqRyxtREFBcUI7O0lBQ3JCLDRDQUFpQjs7SUFDakIscURBQTJCOztJQUMzQixpREFBbUI7O0lBQ25CLDhDQUFnQjs7SUFDaEIsZ0RBQWtCOztJQUNsQix1REFBd0I7O0lBQ3hCLDhDQUFnQjs7SUFDaEIsaURBQTZCOzs7OztJQUM3QixpREFBMkM7Ozs7O0lBQzNDLDZDQUF1Qjs7SUFDdkIsb0RBQXNCOztJQVV0QixnREFBa0I7O0lBQ2xCLDBEQUE0Qjs7SUFDNUIsb0RBQXNCOztJQUN0QixpREFBNkI7O0lBQzdCLDhDQUF1Qjs7SUFDdkIseUNBQVc7O0lBbVVYLDhDQUF3Qjs7SUFFeEIscURBZ0JDOzs7OztJQWxWQyw0Q0FBMEI7Ozs7O0lBQzFCLG9EQUFnRDs7Ozs7SUFDaEQsOENBQW1DOzs7OztJQUNuQyxnREFBa0M7Ozs7O0lBQ2xDLHFEQUE0QyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCwgSW5qZWN0b3IsIE9uSW5pdCwgVmlld0NoaWxkLCBPbkNoYW5nZXMsIFNpbXBsZUNoYW5nZXMsIElucHV0LCBPdXRwdXQsIEV2ZW50RW1pdHRlciwgT25EZXN0cm95LCBRdWVyeUxpc3QsIENvbnRlbnRDaGlsZHJlbiwgQWZ0ZXJWaWV3SW5pdCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBEaWFsb2dDb21wb25lbnQgfSBmcm9tICdAZmFycmlzL3VpLWRpYWxvZyc7XHJcbmltcG9ydCB7IExvY2FsaXplU2VydmljZSB9IGZyb20gJ0BxZHAvbG9jYWxpemUnO1xyXG5pbXBvcnQgeyBFbnRpdHksIFJlcG9zaXRvcnkgfSBmcm9tICdAZmFycmlzL2RldmtpdCc7XHJcbmltcG9ydCB7IE1lc3NhZ2VyU2VydmljZSB9IGZyb20gJ0BmYXJyaXMvdWktbWVzc2FnZXInO1xyXG5pbXBvcnQgeyBTY2hlbWFTZXJ2aWNlIH0gZnJvbSAnQHFkcC9pZGUtY21wJztcclxuaW1wb3J0IHsgTm90aWZ5U2VydmljZSwgTm90aWZ5T3B0aW9ucyB9IGZyb20gJ0BmYXJyaXMvdWktbm90aWZ5JztcclxuaW1wb3J0IHsgQ29uZGl0aW9uU2NoZW1hU2VydmljZSB9IGZyb20gJ0BxZHAvY29uZGl0aW9uLXNjaGVtYSc7XHJcbmltcG9ydCB7IENvbmRpdGlvbk1hbmFnZXJEaWFsb2dDb21wb25lbnQgfSBmcm9tICcuLi9jb25kaXRpb24tbWFuYWdlci1kaWFsb2cvY29uZGl0aW9uLW1hbmFnZXItZGlhbG9nLmNvbXBvbmVudCc7XHJcbmltcG9ydCB7IFNhdmVhc1NjaGVtYURpYWxvZ0NvbXBvbmVudCB9IGZyb20gJy4uL3NhdmVhcy1zY2hlbWEtZGlhbG9nL3NhdmVhcy1zY2hlbWEtZGlhbG9nLmNvbXBvbmVudCc7XHJcbmltcG9ydCB7IE9ic2VydmFibGUsIG9mLCBTdWJqZWN0LCBTdWJzY3JpcHRpb24gfSBmcm9tICdyeGpzJztcclxuaW1wb3J0IHsgQ2FjaGVTZXJ2aWNlIH0gZnJvbSAnQGVjcC1jYWYvY2FmLWNvbW1vbic7XHJcbmltcG9ydCB7IExjcFNlcnZpY2UsIFFEUENhY2hlVXRpbCwgUnRmU2VydmljZXMsIEV2ZW50QnVzIH0gZnJvbSAnQHFkcC9jb21tb24nO1xyXG5pbXBvcnQgeyBGaW5pc2hMb2FkU2VydmljZSB9IGZyb20gJ0BxZHAvY29uZGl0aW9uLXNjaGVtYSc7XHJcbmltcG9ydCB7IENvbmRpdGlvbkRpYWxvZ1RhYkNvbXBvbmVudCB9IGZyb20gJy4uL2NvbmRpdGlvbi1kaWFsb2ctdGFiL2NvbmRpdGlvbi1kaWFsb2ctdGFiLmNvbXBvbmVudCc7XHJcbmltcG9ydCB7IEJlZlJlcG9zaXRvcnkgfSBmcm9tICdAZmFycmlzL2JlZic7XHJcbmltcG9ydCB7IEZvcm1FcnJvclNlcnZpY2UgfSBmcm9tICdAZmFycmlzL2NvbW1hbmQtc2VydmljZXMnO1xyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgc2VsZWN0b3I6ICdjb25kaXRpb24tZGlhbG9nJyxcclxuICB0ZW1wbGF0ZVVybDogJy4vY29uZGl0aW9uLWRpYWxvZy5jb21wb25lbnQuaHRtbCcsXHJcbiAgc3R5bGVVcmxzOiBbJy4vY29uZGl0aW9uLWRpYWxvZy5jb21wb25lbnQuY3NzJ11cclxufSlcclxuZXhwb3J0IGNsYXNzIENvbmRpdGlvbkRpYWxvZ0NvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCwgT25EZXN0cm95LCBPbkNoYW5nZXMsIEFmdGVyVmlld0luaXQgeyAvLyBPbkNoYW5nZXMsXHJcbiAgc2NoZW1hSWQgPSAnJztcclxuICBASW5wdXQoKSBzaG93RmlsdGVyRXhwcmVzc2lvbiA9IHRydWU7XHJcbiAgQElucHV0KCkgcXVlcnlJZDtcclxuICBASW5wdXQoKSB0YWJJbmRleCA9IDA7XHJcbiAgQElucHV0KCkgYmVmb3JlUXVlcnk6IChlbXB0eU9iaj86IHt9KSA9PiBPYnNlcnZhYmxlPGFueT47XHJcbiAgQE91dHB1dCgpIHF1ZXJ5RXZlbnQgPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcclxuICBkaWFsb2dJbml0RXZlbnQgPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcclxuICBpZENoYW5nZWQgPSBuZXcgU3ViamVjdDxhbnk+KCk7XHJcbiAgQFZpZXdDaGlsZCgnZmFycmlzRGlhbG9nJykgZmFycmlzRGlhbG9nOiBEaWFsb2dDb21wb25lbnQ7XHJcbiAgQENvbnRlbnRDaGlsZHJlbihDb25kaXRpb25EaWFsb2dUYWJDb21wb25lbnQpIGNvbmRpdGlvblRhYnM6IFF1ZXJ5TGlzdDxDb25kaXRpb25EaWFsb2dUYWJDb21wb25lbnQ+O1xyXG4gIGdldENvbmRpdGlvblRhYnMoKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICBpZiAodGhpcy5jb25kaXRpb25UYWJzICYmIHRoaXMuY29uZGl0aW9uVGFicy5sZW5ndGgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5jb25kaXRpb25UYWJzO1xyXG4gICAgICB9IGVsc2UgaWYgKFFEUENhY2hlVXRpbC5nZXRDYWNoZShSdGZTZXJ2aWNlcy5nZXRUYWJJZCgnY29uZGl0aW9uLWRpYWxvZy10YWJzJykgKyAnY29uZGl0aW9uLWRpYWxvZy10YWJzJykgJiYgUURQQ2FjaGVVdGlsLmdldENhY2hlKFJ0ZlNlcnZpY2VzLmdldFRhYklkKCdjb25kaXRpb24tZGlhbG9nLXRhYnMnKSArICdjb25kaXRpb24tZGlhbG9nLXRhYnMnKS5sZW5ndGgpIHtcclxuICAgICAgICByZXR1cm4gUURQQ2FjaGVVdGlsLmdldENhY2hlKFJ0ZlNlcnZpY2VzLmdldFRhYklkKCdjb25kaXRpb24tZGlhbG9nLXRhYnMnKSArICdjb25kaXRpb24tZGlhbG9nLXRhYnMnKTtcclxuICAgICAgfVxyXG4gICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICByZXR1cm4gdGhpcy5jb25kaXRpb25UYWJzO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgQFZpZXdDaGlsZChDb25kaXRpb25NYW5hZ2VyRGlhbG9nQ29tcG9uZW50KSBjb25kaXRpb25NYW5hZ2VyRGlhbG9nOiBDb25kaXRpb25NYW5hZ2VyRGlhbG9nQ29tcG9uZW50O1xyXG4gIEBWaWV3Q2hpbGQoU2F2ZWFzU2NoZW1hRGlhbG9nQ29tcG9uZW50KSBzYXZlYXNTY2hlbWFEaWFsb2dDb21wb25lbnQ6IFNhdmVhc1NjaGVtYURpYWxvZ0NvbXBvbmVudDtcclxuICBsb2NhbGl6ZVNlcnZpY2U6IGFueTtcclxuICBtZW51U2hvdyA9IGZhbHNlO1xyXG4gIGRlZmF1bHRTY2hlbWFOYW1lID0gJ+adoeS7tuaWueahiCc7XHJcbiAgY3VycmVudFNjaGVtYTogYW55O1xyXG4gIHB1YmxpY0xpc3QgPSBbXTtcclxuICBwZXJzb25hbExpc3QgPSBbXTtcclxuICBjb250cm9sSW5kZXhDaGFuZ2VkID0gMDtcclxuICBxdWVyeUNvdW50OiBhbnk7XHJcbiAgbm90aWZ5U2VydmljZTogTm90aWZ5U2VydmljZTtcclxuICBwcml2YXRlIHN1YnNjcmlwdGlvbnM6IFN1YnNjcmlwdGlvbltdID0gW107XHJcbiAgcHJpdmF0ZSBjbG9zZVR5cGUgPSAnJztcclxuICBmb3JtRXJyb3JTZXJ2aWNlOiBhbnk7XHJcblxyXG4gIHB1YmxpYyBnZXQgSWQoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5zY2hlbWFJZDtcclxuICB9XHJcbiAgcHVibGljIHNldCBJZCh2YWx1ZTogYW55KSB7XHJcbiAgICB0aGlzLnNjaGVtYUlkID0gdmFsdWU7XHJcbiAgICB0aGlzLmlkQ2hhbmdlZC5uZXh0KHZhbHVlKTtcclxuICB9XHJcblxyXG4gIHByb3BlcnR5TGlzdCA9IFtdO1xyXG4gIGZpbHRlckV4cHJlc3Npb25TdHJpbmcgPSAnJztcclxuICBhZHZhbmNlRmlsdGVyVGFiOiBhbnk7XHJcbiAgc2NoZW1hU2VydmljZTogU2NoZW1hU2VydmljZTtcclxuICBsY3BTZXJ2aWNlOiBMY3BTZXJ2aWNlO1xyXG4gIHRhYklkOiBhbnk7XHJcblxyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgcHJpdmF0ZSBpbmplY3RvcjogSW5qZWN0b3IsXHJcbiAgICBwcml2YXRlIGNvbmRpdGlvblNlcnZpY2U6IENvbmRpdGlvblNjaGVtYVNlcnZpY2UsXHJcbiAgICBwcml2YXRlIHJlcG9zaXRvcnk6IFJlcG9zaXRvcnk8YW55PixcclxuICAgIHByaXZhdGUgY2FjaGVTZXJ2aWNlOiBDYWNoZVNlcnZpY2UsXHJcbiAgICBwcml2YXRlIGZpbmlzaExvYXNTZXJ2aWNlOiBGaW5pc2hMb2FkU2VydmljZSkge1xyXG4gICAgaWYgKHRoaXMuaW5qZWN0b3IpIHtcclxuICAgICAgdGhpcy5sb2NhbGl6ZVNlcnZpY2UgPSB0aGlzLmluamVjdG9yLmdldChMb2NhbGl6ZVNlcnZpY2UpO1xyXG4gICAgICB0aGlzLm5vdGlmeVNlcnZpY2UgPSB0aGlzLmluamVjdG9yLmdldChOb3RpZnlTZXJ2aWNlKTtcclxuICAgICAgdGhpcy5kZWZhdWx0U2NoZW1hTmFtZSA9IHRoaXMubG9jYWxpemVTZXJ2aWNlLmdldFZhbHVlKCdxdWVyeUZyYW1ld29yay5pc3ByZU5hbWUnKTtcclxuICAgICAgdGhpcy5mb3JtRXJyb3JTZXJ2aWNlID0gdGhpcy5pbmplY3Rvci5nZXQoRm9ybUVycm9yU2VydmljZSk7XHJcbiAgICAgIHRoaXMuc2NoZW1hU2VydmljZSA9IHRoaXMuaW5qZWN0b3IuZ2V0KFNjaGVtYVNlcnZpY2UpO1xyXG4gICAgICB0aGlzLmxjcFNlcnZpY2UgPSB0aGlzLmluamVjdG9yLmdldChMY3BTZXJ2aWNlKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIG5nT25Jbml0KCkge1xyXG4gICAgdGhpcy50YWJJZCA9IFJ0ZlNlcnZpY2VzLmdldFRhYklkKHRoaXMucXVlcnlJZCk7XHJcbiAgICB0aGlzLnF1ZXJ5Q291bnQgPSAxO1xyXG4gICAgdGhpcy5jb25kaXRpb25EaWFsb2dJbml0KCk7XHJcbiAgICBpZiAoIXRoaXMuYmVmb3JlUXVlcnkpIHtcclxuICAgICAgdGhpcy5iZWZvcmVRdWVyeSA9IChwYXJhbXM6IGFueSkgPT4gb2YodHJ1ZSk7XHJcbiAgICB9XHJcbiAgICBRRFBDYWNoZVV0aWwuc2V0Q2FjaGUodGhpcy50YWJJZCArICdhZHZhbmNlVGVtcGxhdGUtY29uZGl0aW9uLWRpYWxvZycsIHRoaXMpO1xyXG4gIH1cclxuXHJcbiAgbmdBZnRlclZpZXdJbml0KCkge1xyXG4gICAgRXZlbnRCdXMuZGlzcGF0Y2godGhpcy50YWJJZCArICdhZHZhbmNlVGVtcGxhdGUtY29uZGl0aW9uLWRpYWxvZy1kaWFsb2dJbml0RXZlbnQnLCB7fSk7XHJcbiAgICB0aGlzLmRpYWxvZ0luaXRFdmVudC5lbWl0KHRydWUpO1xyXG4gIH1cclxuXHJcbiAgY29uZGl0aW9uRGlhbG9nSW5pdCgpIHtcclxuICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xyXG4gICAgdGhpcy5zdWJzY3JpcHRpb25zLnB1c2goc2VsZi5jb25kaXRpb25TZXJ2aWNlLmdldFNjaGVtYUxpc3Qoc2VsZi5xdWVyeUlkLCAnJywgJycpLnN1YnNjcmliZSgpKTtcclxuICAgIHRoaXMuc3Vic2NyaXB0aW9ucy5wdXNoKHNlbGYuY29uZGl0aW9uU2VydmljZS5zY2hlbWFMaXN0Q2hhbmdlLnN1YnNjcmliZSgocmVzdWx0OiBhbnkpID0+IHtcclxuICAgICAgY29uc3QgZGF0YSA9IHJlc3VsdC5zY2hlbWFJbmZvO1xyXG4gICAgICBpZiAoZGF0YSAmJiBkYXRhW3NlbGYucXVlcnlJZF0pIHtcclxuICAgICAgICBzZWxmLnB1YmxpY0xpc3QgPSBbXTtcclxuICAgICAgICBzZWxmLnBlcnNvbmFsTGlzdCA9IFtdO1xyXG4gICAgICAgIGZvciAoY29uc3Qga2V5IGluIGRhdGFbc2VsZi5xdWVyeUlkXSkge1xyXG4gICAgICAgICAgaWYgKGRhdGFbc2VsZi5xdWVyeUlkXVtrZXldLnNjaGVtYVR5cGUgPT09IDApIHtcclxuICAgICAgICAgICAgc2VsZi5wdWJsaWNMaXN0LnB1c2goZGF0YVtzZWxmLnF1ZXJ5SWRdW2tleV0pO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgc2VsZi5wZXJzb25hbExpc3QucHVzaChkYXRhW3NlbGYucXVlcnlJZF1ba2V5XSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxldCBmbGFnID0gZmFsc2U7XHJcbiAgICAgICAgaWYgKHNlbGYuc2NoZW1hSWQpIHtcclxuICAgICAgICAgIGxldCBpbmRleCA9IHNlbGYucHVibGljTGlzdC5maW5kSW5kZXgoKGl0ZW06IGFueSkgPT4gaXRlbS5pZCA9PT0gc2VsZi5zY2hlbWFJZCk7XHJcbiAgICAgICAgICBpZiAoaW5kZXggPj0gMCkge1xyXG4gICAgICAgICAgICBmbGFnID0gdHJ1ZTtcclxuICAgICAgICAgICAgc2VsZi5jdXJyZW50U2NoZW1hID0gc2VsZi5wdWJsaWNMaXN0W2luZGV4XTtcclxuICAgICAgICAgICAgc2VsZi5pbml0Q29uZGl0aW9uKHNlbGYuY3VycmVudFNjaGVtYSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBpbmRleCA9IHNlbGYucGVyc29uYWxMaXN0LmZpbmRJbmRleCgoaXRlbTogYW55KSA9PiBpdGVtLmlkID09PSBzZWxmLnNjaGVtYUlkKTtcclxuICAgICAgICAgIGlmIChpbmRleCA+PSAwKSB7XHJcbiAgICAgICAgICAgIGZsYWcgPSB0cnVlO1xyXG4gICAgICAgICAgICBzZWxmLmN1cnJlbnRTY2hlbWEgPSBzZWxmLnBlcnNvbmFsTGlzdFtpbmRleF07XHJcbiAgICAgICAgICAgIHNlbGYuaW5pdENvbmRpdGlvbihzZWxmLmN1cnJlbnRTY2hlbWEpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIWZsYWcgJiYgc2VsZi5jb25kaXRpb25TZXJ2aWNlLmlzRGVmYXVsdFNjaGVtYSAmJiBzZWxmLmNvbmRpdGlvblNlcnZpY2UuaXNEZWZhdWx0U2NoZW1hW3NlbGYucXVlcnlJZF0gJiYgc2VsZi5jb25kaXRpb25TZXJ2aWNlLmlzRGVmYXVsdFNjaGVtYVtzZWxmLnF1ZXJ5SWRdLmlkKSB7XHJcbiAgICAgICAgICBzZWxmLmN1cnJlbnRTY2hlbWEgPSBzZWxmLmNvbmRpdGlvblNlcnZpY2UuaXNEZWZhdWx0U2NoZW1hW3NlbGYucXVlcnlJZF07XHJcbiAgICAgICAgICBzZWxmLnNjaGVtYUlkID0gc2VsZi5jb25kaXRpb25TZXJ2aWNlLmlzRGVmYXVsdFNjaGVtYVtzZWxmLnF1ZXJ5SWRdLmlkO1xyXG4gICAgICAgICAgc2VsZi5kZWZhdWx0U2NoZW1hTmFtZSA9IHNlbGYuY3VycmVudFNjaGVtYS5zY2hlbWFOYW1lO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnN1YnNjcmlwdGlvbnMucHVzaCh0aGlzLmZpbmlzaExvYXNTZXJ2aWNlLmZpbmlzaC5zdWJzY3JpYmUoKGRhdGEpID0+IHtcclxuICAgICAgICAgIHNlbGYuaW5pdENvbmRpdGlvbihzZWxmLmN1cnJlbnRTY2hlbWEpO1xyXG4gICAgICAgIH0pKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBzZWxmLmRlZmF1bHRTY2hlbWFOYW1lID0gc2VsZi5sb2NhbGl6ZVNlcnZpY2UuZ2V0VmFsdWUoJ3F1ZXJ5RnJhbWV3b3JrLmlzcHJlTmFtZScpO1xyXG4gICAgICB9XHJcbiAgICB9KSk7XHJcbiAgICB0aGlzLnN1YnNjcmlwdGlvbnMucHVzaChzZWxmLmlkQ2hhbmdlZC5zdWJzY3JpYmUoKHNjaGVtYUlkOiBhbnkpID0+IHtcclxuICAgICAgaWYgKHNjaGVtYUlkKSB7XHJcbiAgICAgICAgc2VsZi5zdWJzY3JpcHRpb25zLnB1c2goc2VsZi5jb25kaXRpb25TZXJ2aWNlLmdldFNjaGVtYShzY2hlbWFJZCwgc2VsZi5xdWVyeUlkLCB0cnVlKS5zdWJzY3JpYmUoKGRhdGE6IGFueSkgPT4ge1xyXG4gICAgICAgICAgaWYgKGRhdGEpIHtcclxuICAgICAgICAgICAgc2VsZi5jdXJyZW50U2NoZW1hID0gZGF0YTtcclxuICAgICAgICAgICAgc2VsZi5kZWZhdWx0U2NoZW1hTmFtZSA9IHNlbGYuY3VycmVudFNjaGVtYS5zY2hlbWFOYW1lO1xyXG4gICAgICAgICAgICBzZWxmLmluaXRDb25kaXRpb24oc2VsZi5jdXJyZW50U2NoZW1hKTtcclxuICAgICAgICAgICAgaWYgKHNlbGYuY29udHJvbEluZGV4Q2hhbmdlZCA9PT0gMSkge1xyXG4gICAgICAgICAgICAgIHNlbGYuaGFuZGxlSW5mb0NoYW5nZWQoc2VsZi5jb250cm9sSW5kZXhDaGFuZ2VkKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pKTtcclxuICAgICAgfVxyXG4gICAgfSkpO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBpbml0Q29uZGl0aW9uKHNjaGVtYTogYW55KSB7XHJcbiAgICBjb25zdCBzZWxmID0gdGhpcztcclxuICAgIGlmIChzY2hlbWEpIHsgLy8g6aKE5Yi26buY6K6k5a+56LGhXHJcbiAgICAgIGlmIChzY2hlbWEuc2NoZW1hVmFsdWUgJiYgdHlwZW9mIChzY2hlbWEuc2NoZW1hVmFsdWUpID09PSAnb2JqZWN0Jykge1xyXG4gICAgICAgIGlmIChzY2hlbWEgJiYgc2NoZW1hLnNjaGVtYVZhbHVlICYmIHRoaXMucmVwb3NpdG9yeS5lbnRpdHlDb2xsZWN0aW9uLmdldEFsbEVudGl0aWVzKCkgJiYgdGhpcy5yZXBvc2l0b3J5LmVudGl0eUNvbGxlY3Rpb24uZ2V0QWxsRW50aXRpZXMoKS5sZW5ndGgpIHtcclxuICAgICAgICAgIHNjaGVtYS5zY2hlbWFWYWx1ZS5pZCA9IHRoaXMucmVwb3NpdG9yeS5lbnRpdHlDb2xsZWN0aW9uLmdldEFsbEVudGl0aWVzKClbMF1bJ2lkJ107XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHNlbGYucmVwb3NpdG9yeS5lbnRpdHlDb2xsZWN0aW9uLmdldEFsbEVudGl0aWVzKClbMF0ubG9hZChzY2hlbWEuc2NoZW1hVmFsdWUpO1xyXG4gICAgICAgIHNlbGYuZmlsdGVyRXhwcmVzc2lvblN0cmluZyA9ICcnO1xyXG4gICAgICAgIGlmIChzY2hlbWEuc2NoZW1hVmFsdWUuaGFzT3duUHJvcGVydHkoJ0BmaWx0ZXJFeHByZXNzaW9uU3RyaW5nQCcpKSB7XHJcbiAgICAgICAgICBzZWxmLmZpbHRlckV4cHJlc3Npb25TdHJpbmcgPSBzY2hlbWEuc2NoZW1hVmFsdWVbJ0BmaWx0ZXJFeHByZXNzaW9uU3RyaW5nQCddO1xyXG4gICAgICAgIH1cclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBpZiAoc2VsZi5yZXBvc2l0b3J5LmVudGl0eUNvbGxlY3Rpb24uZ2V0QWxsRW50aXRpZXMoKSAmJiBzZWxmLnJlcG9zaXRvcnkuZW50aXR5Q29sbGVjdGlvbi5nZXRBbGxFbnRpdGllcygpWzBdKSB7XHJcbiAgICAgICAgICBjb25zdCBvYmogPSB7XHJcbiAgICAgICAgICAgIGlkOiBzZWxmLnJlcG9zaXRvcnkuZW50aXR5Q29sbGVjdGlvbi5nZXRBbGxFbnRpdGllcygpWzBdWydpZCddXHJcbiAgICAgICAgICB9O1xyXG4gICAgICAgICAgc2VsZi5yZXBvc2l0b3J5LmVudGl0eUNvbGxlY3Rpb24uZ2V0QWxsRW50aXRpZXMoKVswXS5sb2FkKG9iaik7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBnZXRQcm9wZXJ0eUxpc3QoaXRlbTogYW55KSB7XHJcbiAgICB0aGlzLnN1YnNjcmlwdGlvbnMucHVzaCh0aGlzLmxjcFNlcnZpY2UuZ2V0Q29sKHtcclxuICAgICAgc2NoZW1hSWQ6ICcxJyxcclxuICAgICAgZW50aXR5RGF0YTogSlNPTi5zdHJpbmdpZnkoeyAnaWQnOiAndW5kZWZpbmVkX251bGwnIH0pLFxyXG4gICAgICBwYWdlSW5kZXg6IDEsXHJcbiAgICAgIHBhZ2VTaXplOiAwLFxyXG4gICAgICBxb01hbmFnZXJDb2RlOiBRRFBDYWNoZVV0aWwuZ2V0Q2FjaGUodGhpcy50YWJJZCArICdxb01hbmFnZXJDb2RlJyksXHJcbiAgICAgIGNvbnRyb2xUeXBlOiBRRFBDYWNoZVV0aWwuZ2V0Q2FjaGUodGhpcy50YWJJZCArICdjb250cm9sVHlwZScpLFxyXG4gICAgICB2b0NvZGU6IFFEUENhY2hlVXRpbC5nZXRDYWNoZSh0aGlzLnRhYklkICsgJ3ZvSWQnKVxyXG4gICAgfSwgUURQQ2FjaGVVdGlsLmdldENhY2hlKHRoaXMudGFiSWQgKyAncXVlcnlSZWxhdGl2ZVVybCcpKS5zdWJzY3JpYmUodmFsdWUgPT4ge1xyXG4gICAgICBpZiAodmFsdWUgJiYgdmFsdWUuZHluYW1pY0NvbHMgJiYgdmFsdWUuZHluYW1pY0NvbHMubGVuZ3RoKSB7XHJcbiAgICAgICAgdGhpcy5hbmFseXNpc0NvbExpc3REYXRhKHZhbHVlLmR5bmFtaWNDb2xzLCAnY29sJyk7XHJcbiAgICAgICAgaWYgKHRoaXMuYWR2YW5jZUZpbHRlclRhYikge1xyXG4gICAgICAgICAgdGhpcy5hZHZhbmNlRmlsdGVyVGFiLnByb3BlcnR5TGlzdCA9IFsuLi50aGlzLnByb3BlcnR5TGlzdF07XHJcbiAgICAgICAgICB0aGlzLmFkdmFuY2VGaWx0ZXJUYWIuZmlsdGVyRXhwcmVzc2lvblN0cmluZyA9IHRoaXMuZmlsdGVyRXhwcmVzc2lvblN0cmluZztcclxuICAgICAgICB9XHJcbiAgICAgICAgaXRlbS5jcmVhdGVGaWx0ZXJDb21wb25lbnQoKTtcclxuICAgICAgfVxyXG4gICAgfSkpO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBhbmFseXNpc0NvbExpc3REYXRhKG5ld1ZhbHVlOiBhbnksIHR5cGU/OiBhbnkpIHtcclxuICAgIHRoaXMucHJvcGVydHlMaXN0ID0gW107XHJcbiAgICBuZXdWYWx1ZS5mb3JFYWNoKGNvbCA9PiB7XHJcbiAgICAgIHRoaXMucmVjdXJzaXZlQW5hbHlzaXNDb2xMaXN0RGF0YShudWxsLCBjb2wsIHR5cGUpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHJlY3Vyc2l2ZUFuYWx5c2lzQ29sTGlzdERhdGEoY2hpbGRyZW46IGFueSwgY29sOiBhbnksIHR5cGU/OiBhbnkpIHtcclxuICAgIGlmIChjb2wpIHtcclxuICAgICAgY29uc3QgaW5kZXggPSB0aGlzLnByb3BlcnR5TGlzdC5maW5kSW5kZXgoKGl0ZW06IGFueSkgPT4gaXRlbS5Db2RlID09PSBjb2wuYmluZEZpZWxkKTtcclxuICAgICAgaWYgKGluZGV4IDwgMCkge1xyXG4gICAgICAgIGNvbnN0IG5vZGUgPSB7fTtcclxuICAgICAgICBub2RlWyd2YWx1ZSddID0gY29sLmJpbmRGaWVsZDtcclxuICAgICAgICBub2RlWydwcm9wZXJ0eUZpZWxkVHlwZSddID0gdGhpcy5nZXREYXRhVHlwZShjb2wudHlwZSk7XHJcbiAgICAgICAgbm9kZVsndGV4dCddID0gY29sLm5hbWU7XHJcbiAgICAgICAgdGhpcy5wcm9wZXJ0eUxpc3QucHVzaChub2RlKTtcclxuICAgICAgfSBlbHNlIGlmICh0eXBlICE9PSAnY29sJykge1xyXG4gICAgICAgIHRoaXMucHJvcGVydHlMaXN0W2luZGV4XVsndGV4dCddID0gY29sLm5hbWU7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKGNvbC5jaGlsZExpc3QgJiYgY29sLmNoaWxkTGlzdC5sZW5ndGgpIHtcclxuICAgICAgICB0aGlzLnJlY3Vyc2l2ZUFuYWx5c2lzQ29sTGlzdERhdGEoY29sLmNoaWxkTGlzdCwgbnVsbCk7XHJcbiAgICAgIH1cclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGNoaWxkcmVuLmZvckVhY2goKGM6IGFueSkgPT4ge1xyXG4gICAgICAgIGNvbnN0IGluZGV4ID0gdGhpcy5wcm9wZXJ0eUxpc3QuZmluZEluZGV4KChpdGVtOiBhbnkpID0+IGl0ZW0uQ29kZSA9PT0gYy5iaW5kRmllbGQpO1xyXG4gICAgICAgIGlmIChpbmRleCA8IDApIHtcclxuICAgICAgICAgIGNvbnN0IG5vZGUgPSB7fTtcclxuICAgICAgICAgIG5vZGVbJ3ZhbHVlJ10gPSBjLmJpbmRGaWVsZDtcclxuICAgICAgICAgIG5vZGVbJ3Byb3BlcnR5RmllbGRUeXBlJ10gPSB0aGlzLmdldERhdGFUeXBlKGMudHlwZSk7XHJcbiAgICAgICAgICBub2RlWyd0ZXh0J10gPSBjLm5hbWU7XHJcbiAgICAgICAgICB0aGlzLnByb3BlcnR5TGlzdC5wdXNoKG5vZGUpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAodHlwZSAhPT0gJ2NvbCcpIHtcclxuICAgICAgICAgIHRoaXMucHJvcGVydHlMaXN0W2luZGV4XVsndGV4dCddID0gYy5uYW1lO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoYy5jaGlsZExpc3QgJiYgYy5jaGlsZExpc3QubGVuZ3RoKSB7XHJcbiAgICAgICAgICB0aGlzLnJlY3Vyc2l2ZUFuYWx5c2lzQ29sTGlzdERhdGEoYy5jaGlsZExpc3QsIG51bGwpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGdldERhdGFUeXBlKHR5cGU6IGFueSkge1xyXG4gICAgbGV0IHJlc3VsdCA9IDA7XHJcbiAgICBzd2l0Y2ggKHR5cGUpIHtcclxuICAgICAgY2FzZSAnc3RyaW5nJzpcclxuICAgICAgY2FzZSAndGV4dCc6XHJcbiAgICAgICAgcmVzdWx0ID0gMDtcclxuICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSAnaW50ZWdlcic6XHJcbiAgICAgICAgcmVzdWx0ID0gMjtcclxuICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSAnZGVjaW1hbCc6XHJcbiAgICAgICAgcmVzdWx0ID0gNDtcclxuICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSAnYm9vbGVhbic6XHJcbiAgICAgICAgcmVzdWx0ID0gODtcclxuICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSAnZGF0ZSc6XHJcbiAgICAgIGNhc2UgJ2RhdGVUaW1lJzpcclxuICAgICAgICByZXN1bHQgPSA5O1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlICdieXRlJzpcclxuICAgICAgICByZXN1bHQgPSA2O1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlICdjaGFyJzpcclxuICAgICAgICByZXN1bHQgPSA3O1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlICdhcnJheSc6XHJcbiAgICAgICAgcmVzdWx0ID0gMTA7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG4gIH1cclxuXHJcbiAgbmdPbkRlc3Ryb3koKTogdm9pZCB7XHJcbiAgICBpZiAodGhpcy5zdWJzY3JpcHRpb25zICYmIHRoaXMuc3Vic2NyaXB0aW9ucy5sZW5ndGgpIHtcclxuICAgICAgZm9yIChjb25zdCBzdWJzY3JpcHRpb24gb2YgdGhpcy5zdWJzY3JpcHRpb25zKSB7XHJcbiAgICAgICAgc3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIG5nT25DaGFuZ2VzKGNoYW5nZXM6IFNpbXBsZUNoYW5nZXMpIHtcclxuICB9XHJcblxyXG4gIGhhbmRsZURpYWxvZ1Nob3coKSB7XHJcbiAgICB0aGlzLmZhcnJpc0RpYWxvZy5zaG93KCk7XHJcbiAgfVxyXG5cclxuICBoYW5kbGVEaWFsb2dDbG9zZSgpIHtcclxuICAgIHRoaXMuZmFycmlzRGlhbG9nLmNsb3NlKCk7XHJcbiAgfVxyXG5cclxuICBoYW5kbGVTY2hlbWFNYW5hZ2VyRGlhbG9nKCkge1xyXG4gICAgdGhpcy5jb25kaXRpb25NYW5hZ2VyRGlhbG9nLmhhbmRsZURpYWxvZ1Nob3coKTtcclxuICAgIHRoaXMubWVudVNob3cgPSAhdGhpcy5tZW51U2hvdztcclxuICB9XHJcblxyXG4gIGhhbmRsZVNhdmVhc1NjaGVtYURpYWxvZygpIHtcclxuICAgIHRoaXMuc2F2ZWFzU2NoZW1hRGlhbG9nQ29tcG9uZW50LnNjaGVtYU5hbWUgPSAnJztcclxuICAgIHRoaXMuc2F2ZWFzU2NoZW1hRGlhbG9nQ29tcG9uZW50LmlzRGVmYXVsdCA9IGZhbHNlO1xyXG4gICAgdGhpcy5zYXZlYXNTY2hlbWFEaWFsb2dDb21wb25lbnQuaXNTY2hlbWFUeXBlID0gMDtcclxuICAgIHRoaXMubWVudVNob3cgPSBmYWxzZTtcclxuICAgIHRoaXMuc2F2ZWFzU2NoZW1hRGlhbG9nQ29tcG9uZW50LmhhbmRsZURpYWxvZ1Nob3coKTtcclxuICAgIGlmICh0aGlzLmFkdmFuY2VGaWx0ZXJUYWIgJiYgdGhpcy5hZHZhbmNlRmlsdGVyVGFiLmZpbHRlckluc3RhbmNlKSB7XHJcbiAgICAgIHRoaXMuc2F2ZWFzU2NoZW1hRGlhbG9nQ29tcG9uZW50LmZpbHRlckluc3RhbmNlID0gdGhpcy5hZHZhbmNlRmlsdGVyVGFiLmZpbHRlckluc3RhbmNlO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgaGFuZGxlU2NoZW1hTWVudSgpIHtcclxuICAgIHRoaXMubWVudVNob3cgPSAhdGhpcy5tZW51U2hvdztcclxuICB9XHJcblxyXG4gIGhhbmRsZUluZm9DaGFuZ2VkKCRldmVudDogYW55KSB7XHJcbiAgICBjb25zdCBzZWxmID0gdGhpcztcclxuICAgIHRoaXMuY29udHJvbEluZGV4Q2hhbmdlZCA9ICRldmVudDtcclxuICAgIGlmICh0aGlzLmdldENvbmRpdGlvblRhYnMoKSAmJiB0aGlzLmdldENvbmRpdGlvblRhYnMoKS5sZW5ndGgpIHtcclxuICAgICAgdGhpcy5nZXRDb25kaXRpb25UYWJzKCkuZm9yRWFjaCgoaXRlbTogYW55KSA9PiB7XHJcbiAgICAgICAgaXRlbS5jb250cm9sSW5kZXhDaGFuZ2VkID0gJGV2ZW50O1xyXG4gICAgICAgIGl0ZW0uY2hhbmdlQ3NzKCk7XHJcbiAgICAgICAgaWYgKGl0ZW0udGFiSW5kZXggPT09IDEgJiYgc2VsZi5zaG93RmlsdGVyRXhwcmVzc2lvbikge1xyXG4gICAgICAgICAgc2VsZi5hZHZhbmNlRmlsdGVyVGFiID0gaXRlbTtcclxuICAgICAgICAgIHNlbGYuZ2V0UHJvcGVydHlMaXN0KGl0ZW0pO1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBoYW5kbGVTY2hlbWFTZWxlY3RlZCgkZXZlbnQ6IGFueSkge1xyXG4gICAgdGhpcy5kZWZhdWx0U2NoZW1hTmFtZSA9ICRldmVudC5zY2hlbWFOYW1lO1xyXG4gICAgdGhpcy5tZW51U2hvdyA9ICF0aGlzLm1lbnVTaG93O1xyXG4gICAgdGhpcy5jdXJyZW50U2NoZW1hID0gJGV2ZW50O1xyXG4gICAgdGhpcy5JZCA9IHRoaXMuY3VycmVudFNjaGVtYS5pZDtcclxuICB9XHJcblxyXG4gIGhhbmRsZVF1ZXJ5Q2xpY2soKSB7XHJcbiAgICBjb25zdCBwYXJhbXMgPSB0aGlzLmhhbmRsZXJHZXRFbnRpdHkoKTtcclxuICAgIHRoaXMuYmVmb3JlUXVlcnkoKS5zdWJzY3JpYmUoKHJlc3VsdCkgPT4ge1xyXG4gICAgICBpZiAocmVzdWx0ID09IHRydWUpIHtcclxuICAgICAgICBFdmVudEJ1cy5kaXNwYXRjaCgnb3BlbkFkdmFuY2VUZW1wbGF0ZURpYWxvZycsIHt9KTtcclxuICAgICAgICB0aGlzLmNhY2hlU2VydmljZS5zZXQodGhpcy50YWJJZCwgcGFyYW1zKTtcclxuICAgICAgICBFdmVudEJ1cy5kaXNwYXRjaCh0aGlzLnRhYklkICsgJ2FkdmFuY2VUZW1wbGF0ZS1jb25kaXRpb24tZGlhbG9nLXF1ZXJ5RXZlbnQnLCB0aGlzLnF1ZXJ5Q291bnQrKyk7XHJcbiAgICAgICAgdGhpcy5xdWVyeUV2ZW50LmVtaXQodGhpcy5xdWVyeUNvdW50KyspO1xyXG4gICAgICAgIHRoaXMuY2xvc2VUeXBlID0gJ3F1ZXJ5JztcclxuICAgICAgICB0aGlzLmhhbmRsZURpYWxvZ0Nsb3NlKCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgaGFuZGxlU2F2ZUNsaWNrKCkge1xyXG4gICAgY29uc3Qgc2VsZiA9IHRoaXM7XHJcbiAgICBjb25zdCBwYXJhbXMgPSB0aGlzLmhhbmRsZXJHZXRFbnRpdHkoKTtcclxuICAgIGlmICh0aGlzLmN1cnJlbnRTY2hlbWEpIHtcclxuICAgICAgdGhpcy5jdXJyZW50U2NoZW1hLnNjaGVtYVZhbHVlID0gcGFyYW1zO1xyXG4gICAgICBjb25zdCBuZXdTY2hlbWEgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHRoaXMuY3VycmVudFNjaGVtYSkpO1xyXG4gICAgICBpZiAodGhpcy5hZHZhbmNlRmlsdGVyVGFiICYmIHRoaXMuYWR2YW5jZUZpbHRlclRhYi5maWx0ZXJJbnN0YW5jZSkge1xyXG4gICAgICAgIGlmICghbmV3U2NoZW1hLnNjaGVtYVZhbHVlKSB7IG5ld1NjaGVtYS5zY2hlbWFWYWx1ZSA9IHt9OyB9XHJcbiAgICAgICAgbmV3U2NoZW1hLnNjaGVtYVZhbHVlWydAZmlsdGVyRXhwcmVzc2lvblN0cmluZ0AnXSA9IHRoaXMuYWR2YW5jZUZpbHRlclRhYi5maWx0ZXJJbnN0YW5jZS5nZXRGaWx0ZXJFeHByZXNzaW9uKCk7XHJcbiAgICAgIH1cclxuICAgICAgbmV3U2NoZW1hLnNjaGVtYVZhbHVlID0gbmV3U2NoZW1hLnNjaGVtYVZhbHVlID8gSlNPTi5zdHJpbmdpZnkobmV3U2NoZW1hLnNjaGVtYVZhbHVlKSA6IG51bGw7XHJcbiAgICAgIHRoaXMuY29uZGl0aW9uU2VydmljZS5zYXZlU2NoZW1hKG5ld1NjaGVtYSkuc3Vic2NyaWJlKCgpID0+IHtcclxuICAgICAgICBzZWxmLm5vdGlmeVNlcnZpY2VbJ3N1Y2Nlc3MnXSh7XHJcbiAgICAgICAgICB0aXRsZTogc2VsZi5sb2NhbGl6ZVNlcnZpY2UuZ2V0VmFsdWUoJ3F1ZXJ5RnJhbWV3b3JrLm1lc3NhZ2UuaW5mby50aXRsZScpLCBtc2c6IHNlbGYubG9jYWxpemVTZXJ2aWNlLmdldFZhbHVlKCdxdWVyeUZyYW1ld29yay5tZXNzYWdlLnNhdmUuc3VjY2VzcycpLCB0aW1lb3V0OiAzMDAwXHJcbiAgICAgICAgfSBhcyBOb3RpZnlPcHRpb25zKTtcclxuICAgICAgfSwgKGVycm9yOiBhbnkpID0+IHtcclxuICAgICAgICBzZWxmLmZvcm1FcnJvclNlcnZpY2UuZXhjZXB0aW9uKHRoaXMubG9jYWxpemVTZXJ2aWNlLmdldFZhbHVlKCdpZGVDbXAuc2NoZW1hTWFuYWdlci5tZXNzYWdlLnZhbGlkYXRlLnFkcE1vZGlmeVB1YmxpY1NjaGVtYScpLCBlcnJvcik7XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgaGFuZGxlckdldEVudGl0eSgpIHtcclxuICAgIGNvbnN0IGVudGl0eXMgPSB0aGlzLnJlcG9zaXRvcnkuZW50aXR5Q29sbGVjdGlvbi5nZXRBbGxFbnRpdGllcygpO1xyXG4gICAgbGV0IHBhcmFtcztcclxuICAgIGlmIChlbnRpdHlzICYmIGVudGl0eXMubGVuZ3RoKSB7XHJcbiAgICAgIHBhcmFtcyA9IGVudGl0eXNbMF0udG9KU09OKCk7XHJcbiAgICAgIGlmICh0aGlzLmFkdmFuY2VGaWx0ZXJUYWIgJiYgdGhpcy5hZHZhbmNlRmlsdGVyVGFiLmZpbHRlckluc3RhbmNlKSB7XHJcbiAgICAgICAgaWYgKCFwYXJhbXMpIHsgcGFyYW1zID0geyBpZDogJ3VuZGVmaW5lZF9udWxsJyB9OyB9XHJcbiAgICAgICAgcGFyYW1zWydAZmlsdGVyRXhwcmVzc2lvblN0cmluZ0AnXSA9IHRoaXMuYWR2YW5jZUZpbHRlclRhYi5maWx0ZXJJbnN0YW5jZS5nZXRGaWx0ZXJFeHByZXNzaW9uKCk7XHJcbiAgICAgIH0gZWxzZSBpZiAodGhpcy5maWx0ZXJFeHByZXNzaW9uU3RyaW5nKSB7XHJcbiAgICAgICAgaWYgKCFwYXJhbXMpIHsgcGFyYW1zID0geyBpZDogJ3VuZGVmaW5lZF9udWxsJyB9OyB9XHJcbiAgICAgICAgcGFyYW1zWydAZmlsdGVyRXhwcmVzc2lvblN0cmluZ0AnXSA9IHRoaXMuZmlsdGVyRXhwcmVzc2lvblN0cmluZztcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHBhcmFtcztcclxuICB9XHJcblxyXG4gIGJlZm9yZU9wZW4gPSAoKSA9PiB0cnVlO1xyXG5cclxuICBoYW5kbGViZWZvcmVDbG9zZSA9ICgpID0+IHtcclxuICAgIC8vIGNvbnN0IHNlbGYgPSB0aGlzO1xyXG4gICAgLy8gaWYgKHRoaXMuY2xvc2VUeXBlICE9PSAncXVlcnknKSB7XHJcbiAgICAvLyAgIGlmIChzZWxmLnJlcG9zaXRvcnkuZW50aXR5Q29sbGVjdGlvbi5nZXRBbGxFbnRpdGllcygpICYmIHNlbGYucmVwb3NpdG9yeS5lbnRpdHlDb2xsZWN0aW9uLmdldEFsbEVudGl0aWVzKClbMF0pIHtcclxuICAgIC8vICAgICBjb25zdCBvYmogPSB7XHJcbiAgICAvLyAgICAgICBpZDogc2VsZi5yZXBvc2l0b3J5LmVudGl0eUNvbGxlY3Rpb24uZ2V0QWxsRW50aXRpZXMoKVswXVsnaWQnXVxyXG4gICAgLy8gICAgIH07XHJcbiAgICAvLyAgICAgc2VsZi5yZXBvc2l0b3J5LmVudGl0eUNvbGxlY3Rpb24uZ2V0QWxsRW50aXRpZXMoKVswXS5sb2FkKG9iaik7XHJcbiAgICAvLyAgICAgKHNlbGYucmVwb3NpdG9yeSBhcyBCZWZSZXBvc2l0b3J5PEVudGl0eT4pLmVudGl0eU1hbmFnZXIuY2xlYXJBbGxFbnRpdHlDaGFuZ2VzKCk7XHJcbiAgICAvLyAgICAgaWYgKHRoaXMuYWR2YW5jZUZpbHRlclRhYikge1xyXG4gICAgLy8gICAgICAgdGhpcy5hZHZhbmNlRmlsdGVyVGFiLmZpbHRlckV4cHJlc3Npb25TdHJpbmcgPSAnJztcclxuICAgIC8vICAgICB9XHJcbiAgICAvLyAgIH1cclxuICAgIC8vIH1cclxuICAgIC8vIHRoaXMuY2xvc2VUeXBlID0gJyc7XHJcbiAgICByZXR1cm4gb2YodHJ1ZSk7XHJcbiAgfVxyXG59XHJcbiJdfQ==