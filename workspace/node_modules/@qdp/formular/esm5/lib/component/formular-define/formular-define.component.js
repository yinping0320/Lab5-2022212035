/**
 * @fileoverview added by tsickle
 * Generated from: lib/component/formular-define/formular-define.component.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { Component, ViewChild, TemplateRef } from '@angular/core';
import { of, Subject } from 'rxjs';
import { MessagerService } from '@farris/ui-messager';
import { CacheService } from '@ecp-caf/caf-common';
import { RestfulService } from '../../service/restful.service';
import { DatagridComponent } from '@farris/ui-datagrid';
import { LoadingService } from '@farris/ui-loading';
import { EntityDataService } from '../../service/entitydata.service';
import { LocalizeService } from '@qdp/localize';
var FormularDefineComponent = /** @class */ (function () {
    function FormularDefineComponent(restfulService, msgService, cacheService, loadService, entityDataService, localizeService) {
        var _this = this;
        this.restfulService = restfulService;
        this.msgService = msgService;
        this.cacheService = cacheService;
        this.loadService = loadService;
        this.entityDataService = entityDataService;
        this.localizeService = localizeService;
        this.data = [];
        this.funcData = [];
        // 当前站点host
        this.size = {};
        this.inputTemplate = '';
        this.dynamicInput = [];
        this.columns = [];
        this.formularText = ''; // 公式信息
        // 公式信息
        this.binding = 'selectFormular';
        this.name = ''; // 公式名称
        // 公式名称
        this.isGroup = false; // 是否分组
        // 是否分组
        this.resultDatas = [];
        this.resultColumns = [];
        this.formularWizard = '0';
        this.formularType = 0; // 0普通公式 1组合公式
        // 0普通公式 1组合公式
        this.loading = this.loadService.show({ container: 'body' });
        /**
         * 国际化
         */
        this.labelSaveFormular = '保存公式';
        this.resultSortColumns = [
            {
                id: '0',
                label: '无'
            },
            {
                id: '1',
                label: '升序'
            },
            {
                id: '2',
                label: '降序'
            }
        ];
        this.resultColVisibleColumns = [
            {
                id: '0',
                label: '否'
            },
            {
                id: '1',
                label: '是'
            }
        ];
        /**
         * 帮助配置字段
         */
        this.helpData = [];
        this.helpColumns = [];
        this.handlebeforeClose = (/**
         * @return {?}
         */
        function () {
            return of(true);
        });
        this.clickLastStep = (/**
         * @return {?}
         */
        function () {
            _this.cacheService.set('formularParam', _this.data);
            return true;
        });
        this.beforeFinish = (/**
         * @return {?}
         */
        function () {
            /** @type {?} */
            var flag$ = new Subject();
            if (_this.formularType === 1) { // 组合公式保存
                if (!_this.name) {
                    _this.msgService.info(_this.localizeService.getValue('formular.define.messageAlert.nameVerify'));
                }
                if (!_this.formularText) {
                    _this.msgService.info(_this.localizeService.getValue('formular.define.messageAlert.combineVerify'));
                }
                else if (_this.formularText && !_this.formularCheck(_this.formularText)) {
                    _this.msgService.info(_this.localizeService.getValue('formular.define.messageAlert.formularIntegrityVerify'));
                }
                /** @type {?} */
                var formularInfo = {
                    id: _this.currentFormularId,
                    isgroup: _this.isGroup ? 1 : 0,
                    name: _this.name,
                    queryfunc: '',
                    str1: '',
                    str2: '',
                    str3: '',
                    str4: '',
                    cursu: _this.data.currentSU,
                    str5: _this.data.formularRegion ? _this.data.formularRegion : 'publish',
                    str6: _this.formularText,
                    num1: 1,
                };
                /** @type {?} */
                var options = {
                    headers: {
                        'SessionId': _this.data.sessionId,
                        'Content-Type': 'application/json'
                    }
                };
                if (formularInfo) {
                    /** @type {?} */
                    var retrieveUri = _this.data.serverHost + '/api/gsp/bcc/v1.0/querygetdatadetail_frm/service/saveqdpformular';
                    _this.restfulService.put(retrieveUri, { formularInfo: JSON.stringify(formularInfo) }, {}, options).subscribe((/**
                     * @param {?} data
                     * @return {?}
                     */
                    function (data) {
                        /** @type {?} */
                        var formularData = data.returnValue;
                        if (formularData) {
                            _this.currentFormularId = formularData;
                            _this.entityDataService.setFormularState(true, { id: _this.currentFormularId, name: _this.name });
                            //this.cacheService.set('formularResult', { id: this.currentFormularId, name: '公式' });
                            flag$.next(true);
                        }
                        else {
                            _this.entityDataService.setFormularState(false, {});
                            _this.msgService.error(_this.localizeService.getValue('formular.define.messageAlert.saveFormularFailure'));
                        }
                    }));
                }
            }
            else if (!_this.currentFormularId) {
                _this.entityDataService.setFormularState(false, {});
                _this.msgService.info(_this.localizeService.getValue('formular.define.messageAlert.formularSaveVerify'));
                return false;
            }
            else {
                _this.entityDataService.setFormularState(true, { id: _this.currentFormularId, name: _this.name });
                //this.cacheService.set('formularResult', { id: this.currentFormularId, name: this.name ? this.name : '公式' });
                return true;
            }
            return flag$;
        });
        this.labelSaveFormular = this.localizeService.getValue('formular.define.labelSaveFormular');
        this.labelGeneraterFormular = this.localizeService.getValue('formular.define.labelGeneraterFormular');
        this.labelQueryFunc = this.localizeService.getValue('formular.define.labelQueryFunc');
        this.labelBasicInfo = this.localizeService.getValue('formular.define.labelBasicInfo');
        this.labelFormularName = this.localizeService.getValue('formular.define.labelFormularName');
        this.labelIsGroup = this.localizeService.getValue('formular.define.labelIsGroup');
        this.labelParamInfo = this.localizeService.getValue('formular.define.labelParamInfo');
        this.labelResultColInfo = this.localizeService.getValue('formular.define.labelResultColInfo');
        this.resultSortColumns = this.localizeService.getValue('formular.define.resultSortColumns');
        this.resultColVisibleColumns = this.localizeService.getValue('formular.define.resultColVisibleColumns');
    }
    /**
     * @return {?}
     */
    FormularDefineComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.data = this.cacheService.get('formularParam');
        this.formularWizard = this.data.formularWizard;
        this.formularType = this.data.formularWizard === '2' ? 1 : 0;
        this.currentFormularId = this.data.currentFormularId;
        this.columns = [
            // { field: 'id', width: 100, title: 'ID' },
            { field: 'resultcolvisible', width: 60, title: this.localizeService.getValue('formular.define.columntitles.resultcolvisible'), template: this.resultColVisibleColumnTemp },
            { field: 'resultcode', width: 60, title: this.localizeService.getValue('formular.define.columntitles.resultcode') },
            { field: 'resultdescription', width: 60, title: this.getResultDescription() },
            { field: 'resultsort', width: 60, title: this.localizeService.getValue('formular.define.columntitles.resultsort'), template: this.resultSortColumnTemp }
        ];
        if (this.data.sessionId) {
            this.getFuncInfo();
        }
        else {
            this.createHeaderSessionId().subscribe((/**
             * @param {?} sessionId
             * @return {?}
             */
            function (sessionId) {
                console.log(sessionId);
                if (sessionId) {
                    _this.getFuncInfo();
                }
            }));
        }
    };
    /**
     * @return {?}
     */
    FormularDefineComponent.prototype.guid = /**
     * @return {?}
     */
    function () {
        return ((/** @type {?} */ ([1e7])) + -1e3 + -4e3 + -8e3 + -1e11).replace(/[018]/g, (/**
         * @param {?} c
         * @return {?}
         */
        function (c) {
            return (c ^ crypto.getRandomValues(new Uint8Array(1))[0] & 15 >> c / 4).toString(16);
        }));
    };
    /**
     * @return {?}
     */
    FormularDefineComponent.prototype.getResultDescription = /**
     * @return {?}
     */
    function () {
        return this.getLanguage() === 'zh-chs' ? '列描述' : 'description';
    };
    /**
     * @return {?}
     */
    FormularDefineComponent.prototype.getLanguage = /**
     * @return {?}
     */
    function () {
        switch (this.localizeService.localeId) {
            case 'zh-chs':
            case 'zh-cn':
            case 'zh':
                return 'zh-chs';
            case 'en-us':
            case 'en':
                return 'en-us';
        }
        return 'zh-chs';
    };
    /**
     * @return {?}
     */
    FormularDefineComponent.prototype.ngAfterViewInit = /**
     * @return {?}
     */
    function () {
        this.loading.close();
    };
    /**
     * @private
     * @return {?}
     */
    FormularDefineComponent.prototype.createHeaderSessionId = /**
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var sessionId = new Subject();
        /** @type {?} */
        var options = {
            headers: {
                'Content-Type': 'application/json'
            },
            responseType: 'text'
        };
        /** @type {?} */
        var createSessionUrl = this.data.serverHost + '/api/gsp/bcc/v1.0/queryfuncdetail_frm/service/createsession';
        this.restfulService.post(createSessionUrl, {}, {}, options).subscribe((/**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            _this.data.sessionId = data;
            sessionId.next(data);
        }));
        return sessionId;
    };
    /**
     * @private
     * @return {?}
     */
    FormularDefineComponent.prototype.getFuncInfo = /**
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var uri = this.data.serverHost;
        /** @type {?} */
        var options = {
            headers: {
                'SessionId': this.data.sessionId,
                'Content-Type': 'application/json'
            }
        };
        /** @type {?} */
        var entityFilter = {
            FilterConditions: [{ 'FilterField': 'SrcSU', 'Value': this.data.currentSU, 'Lbracket': null, 'Rbracket': null, 'Relation': 0, 'Expresstype': 0, 'Compare': 6 }],
            SortConditions: [],
            IsUsePagination: false,
            Pagination: {
                PageIndex: 0,
                PageSize: 0,
                PageCount: 0,
                TotalCount: 0
            }
        };
        uri += '/api/gsp/bcc/v1.0/queryfuncdetail_frm/extension/query?entityFilter=' + JSON.stringify(entityFilter);
        this.restfulService.put(uri, {}, {}, options).subscribe((/**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            /** @type {?} */
            var funcDatas = data.returnValue.result;
            if (funcDatas && funcDatas.length > 0) {
                funcDatas.forEach((/**
                 * @param {?} x
                 * @return {?}
                 */
                function (x) {
                    _this.funcData.push({ name: x.name, value: x.id });
                }));
            }
            _this.currentFuncDatas = funcDatas;
            // 如果选择的是选择公式，根据公示信息初始默认的数据
            if (_this.currentFormularId && _this.data.formularData && _this.data.formularData.num1 === 1) {
                _this.name = _this.data.formularData.name;
                _this.formularText = _this.data.formularData.str6;
                _this.formularType = 1;
            }
            else {
                _this.getFormularInfo();
            }
        }));
    };
    /**
     * @private
     * @return {?}
     */
    FormularDefineComponent.prototype.getFormularInfo = /**
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        // 清空历史数据
        this.dynamicInput = [];
        this.resultColumns = [];
        this.resultDatas = [];
        this.formularText = '';
        this.name = '';
        this.isGroup = 0;
        if (this.currentFormularId) {
            /** @type {?} */
            var options = {
                headers: {
                    'SessionId': this.data.sessionId,
                    'Content-Type': 'application/json'
                }
            };
            /** @type {?} */
            var retrieveUri = this.data.serverHost + '/api/gsp/bcc/v1.0/querygetdatadetail_frm/extension/retrieve/' + this.currentFormularId;
            this.restfulService.put(retrieveUri, {}, {}, options).subscribe((/**
             * @param {?} data
             * @return {?}
             */
            function (data) {
                /** @type {?} */
                var formularData = data.returnValue;
                if (formularData) {
                    // 初始基础数据
                    _this.name = formularData.name;
                    _this.data.currentFormularName = formularData.name;
                    _this.isGroup = formularData.isGroup;
                    /** @type {?} */
                    var queryFuncId_1 = formularData.queryFunc;
                    _this.type = formularData.str1;
                    _this.metadataobjectid = formularData.str2;
                    _this.funcSelectValue = _this.funcData.find((/**
                     * @param {?} x
                     * @return {?}
                     */
                    function (x) { return x.value === queryFuncId_1; }));
                    _this.entityDataService.setFormularState(true, { id: _this.currentFormularId, name: _this.name });
                    if (queryFuncId_1) {
                        _this.getDropDownInfo(queryFuncId_1, _this.type, _this.metadataobjectid, true, formularData.queryGetDataParamInfos);
                    }
                    // const currentQueryGetDataParams = formularData.queryGetDataParamInfos;
                    /** @type {?} */
                    var queryFuncResults = formularData.queryGetDataResultInfos;
                    // if (currentQueryGetDataParams && currentQueryGetDataParams.length > 0) {
                    //   currentQueryGetDataParams.forEach(queryGetDataParam => {
                    //     const fieldConfig = JSON.parse(queryGetDataParam.fieldConfig);
                    //     if (fieldConfig.controltype === 'dropdown') {
                    //       fieldConfig.enumValues = JSON.parse(fieldConfig.enumValues);
                    //     }
                    //     this.dynamicInput.push({ paramcode: queryGetDataParam.paramCode, paramname: queryGetDataParam.paramName, paramvalue: queryGetDataParam.paramValue, fieldConfig: JSON.parse(queryGetDataParam.fieldConfig) });
                    //   });
                    // }
                    if (queryFuncResults && queryFuncResults.length > 0) {
                        /** @type {?} */
                        var resultColumns_1 = [];
                        /** @type {?} */
                        var data_1 = [];
                        queryFuncResults.forEach((/**
                         * @param {?} queryFuncResult
                         * @return {?}
                         */
                        function (queryFuncResult) {
                            resultColumns_1.push({ id: queryFuncResult.resultCode, label: queryFuncResult.resultName });
                            data_1.push({
                                id: queryFuncResult.id,
                                resultcode: queryFuncResult.resultCode,
                                resultsort: queryFuncResult.resultSort,
                                resultname: queryFuncResult.resultName,
                                resultcolvisible: queryFuncResult.resultColVisible === true ? '1' : '0',
                                resultdescription: ''
                            });
                        }));
                        _this.resultColumns = tslib_1.__spread(resultColumns_1);
                        _this.resultDatas = tslib_1.__spread(data_1);
                    }
                }
            }));
        }
    };
    /**
     * @return {?}
     */
    FormularDefineComponent.prototype.generateFormular = /**
     * @return {?}
     */
    function () {
        var _this = this;
        if (!this.name) {
            this.msgService.info(this.localizeService.getValue('formular.define.messageAlert.nameVerify'));
            return;
        }
        if (!this.funcSelectValue) {
            this.msgService.info(this.localizeService.getValue('formular.define.messageAlert.funcVerify'));
            return;
        }
        /** @type {?} */
        var formularInfo = {
            id: this.currentFormularId,
            cursu: this.data.currentSU,
            isgroup: this.isGroup ? 1 : 0,
            name: this.name,
            queryfunc: this.funcSelectValue.value,
            str1: this.type,
            str2: this.metadataobjectid,
            str3: this.qomanagercode ? this.qomanagercode : '',
            str4: this.funcSelectValue.name,
            str5: '',
            str6: '',
            formularParamInfos: this.dynamicInput,
            formularResultInfos: this.resultDatas
        };
        /** @type {?} */
        var options = {
            headers: {
                'SessionId': this.data.sessionId,
                'Content-Type': 'application/json'
            }
        };
        if (formularInfo) {
            /** @type {?} */
            var retrieveUri = this.data.serverHost + '/api/gsp/bcc/v1.0/querygetdatadetail_frm/service/saveqdpformular';
            this.restfulService.put(retrieveUri, { formularInfo: JSON.stringify(formularInfo) }, {}, options).subscribe((/**
             * @param {?} data
             * @return {?}
             */
            function (data) {
                /** @type {?} */
                var formularData = data.returnValue;
                if (formularData) {
                    _this.currentFormularId = formularData;
                    _this.entityDataService.setFormularState(true, { id: _this.currentFormularId, name: _this.name });
                    // this.entityDataService.isFinish = true;
                    _this.msgService.info(_this.localizeService.getValue('formular.define.messageAlert.saveFormular'));
                }
            }));
        }
    };
    /**
     * @return {?}
     */
    FormularDefineComponent.prototype.generateFormularInfo = /**
     * @return {?}
     */
    function () {
        if (!this.currentFunctionId) {
            this.msgService.info(this.localizeService.getValue('formular.define.messageAlert.pleaseSelectQueryFunc'));
            return;
        }
        if (this.resultDatas && this.resultDatas.filter((/**
         * @param {?} x
         * @return {?}
         */
        function (x) { return x.resultcolvisible === '1'; })).length !== 1) {
            this.msgService.info(this.localizeService.getValue('formular.define.messageAlert.resultVerify'));
            return;
        }
        /** @type {?} */
        var paramInfo = [];
        this.dynamicInput.forEach((/**
         * @param {?} x
         * @return {?}
         */
        function (x) {
            paramInfo.push({ key: x.paramcode, value: x.paramvalue ? x.paramvalue : '' });
        }));
        /** @type {?} */
        var formularcompile = {
            funcId: this.currentFunctionId,
            paramInfos: paramInfo,
            resultColName: this.resultDatas[0].resultcode,
            qomanagercode: this.qomanagercode,
            isgroup: this.isGroup ? 1 : 0
        };
        this.formularText = this.formularText + 'QDPFormular.execute(' + JSON.stringify(formularcompile) + ') ';
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    FormularDefineComponent.prototype.operator = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        this.formularText = this.formularText + $event;
    };
    /**
     * @param {?} event
     * @return {?}
     */
    FormularDefineComponent.prototype.onResized = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        this.size.height = event.newHeight;
        this.size.width = event.newWidth;
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    FormularDefineComponent.prototype.selectionChange = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        var _this = this;
        // 清空历史数据
        this.dynamicInput = [];
        this.resultColumns = [];
        this.resultDatas = [];
        this.name = this.formularType === 1 ? this.name : '';
        this.isGroup = 0;
        if ($event && $event.value) {
            this.currentFunctionId = $event.value;
            /** @type {?} */
            var funcData = this.currentFuncDatas.find((/**
             * @param {?} x
             * @return {?}
             */
            function (x) { return x.id === _this.currentFunctionId; }));
            this.name = this.name === '' ? funcData.name : this.name;
            // 保存公式类型及元数据id
            this.type = funcData.srcType;
            this.metadataobjectid = funcData.metadataObject;
            if (this.currentFunctionId) {
                this.getDropDownInfo(this.currentFunctionId, this.type, this.metadataobjectid, true, '');
            }
        }
    };
    // 初始下拉信息
    // 初始下拉信息
    /**
     * @param {?} funcid
     * @param {?} type
     * @param {?} metadataobjectid
     * @param {?} generateData
     * @param {?} queryFormularParam
     * @return {?}
     */
    FormularDefineComponent.prototype.getDropDownInfo = 
    // 初始下拉信息
    /**
     * @param {?} funcid
     * @param {?} type
     * @param {?} metadataobjectid
     * @param {?} generateData
     * @param {?} queryFormularParam
     * @return {?}
     */
    function (funcid, type, metadataobjectid, generateData, queryFormularParam) {
        /** @type {?} */
        var self = this;
        // 访问数据服务
        /** @type {?} */
        var options = {
            headers: {
                'SessionId': self.data.sessionId,
                'Content-Type': 'application/json'
            }
        };
        /** @type {?} */
        var url = self.data.serverHost + '/api/gsp/bcc/v1.0/queryfuncdetail_frm/extension/retrieve/' + funcid;
        self.restfulService.put(url, {}, {}, options).toPromise().then((/**
         * @param {?} value
         * @return {?}
         */
        function (value) {
            var e_1, _a;
            if (value) {
                value = value.returnValue;
                // 查询参数
                if (generateData) {
                    /** @type {?} */
                    var queryFuncParams = value.queryFuncParams;
                    if (queryFuncParams.length > 0) {
                        // if (currentQueryGetDataParams && currentQueryGetDataParams.length > 0) {
                        //   currentQueryGetDataParams.forEach(queryGetDataParam => {
                        //     const fieldConfig = JSON.parse(queryGetDataParam.fieldConfig);
                        //     if (fieldConfig.controltype === 'dropdown') {
                        //       fieldConfig.enumValues = JSON.parse(fieldConfig.enumValues);
                        //     }
                        //     this.dynamicInput.push({ paramcode: queryGetDataParam.paramCode, paramname: queryGetDataParam.paramName, paramvalue: queryGetDataParam.paramValue, fieldConfig: JSON.parse(queryGetDataParam.fieldConfig) });
                        //   });
                        // }
                        queryFuncParams = queryFuncParams.sort(self.sortData);
                        queryFuncParams.forEach((/**
                         * @param {?} funcParam
                         * @return {?}
                         */
                        function (funcParam) {
                            if (funcParam) {
                                /** @type {?} */
                                var fieldConfig = JSON.parse(funcParam.fieldConfig);
                                if (fieldConfig.controltype === 'dropdown') {
                                    fieldConfig.enumValues = fieldConfig.enumValues;
                                }
                                /** @type {?} */
                                var findParamInfo = void 0;
                                if (queryFormularParam && queryFormularParam.length > 0) {
                                    findParamInfo = queryFormularParam.find((/**
                                     * @param {?} x
                                     * @return {?}
                                     */
                                    function (x) { return x.paramCode === funcParam.code; }));
                                }
                                /** @type {?} */
                                var paramvalue = (findParamInfo && findParamInfo.paramValue) ? findParamInfo.paramValue : '';
                                fieldConfig.paramvaluename = '';
                                if (fieldConfig.controltype === 'help' && findParamInfo) {
                                    /** @type {?} */
                                    var paramvaluearray = paramvalue.split('|');
                                    paramvalue = paramvaluearray[0];
                                    fieldConfig.paramvaluename = paramvaluearray[1];
                                }
                                self.dynamicInput.push({ id: findParamInfo ? findParamInfo.id : '', paramcode: funcParam.code, paramname: funcParam.name, paramvalue: paramvalue, fieldConfig: fieldConfig });
                            }
                        }));
                    }
                }
                if (generateData) { // 新建或者组合公式调用此逻辑
                    self.resultColumns = [];
                    if (type === 'BE') {
                        /** @type {?} */
                        var queryFuncResults = value.queryFuncResults;
                        if (queryFuncResults.length > 0) {
                            /** @type {?} */
                            var funcResultDatas_2 = [];
                            queryFuncResults.forEach((/**
                             * @param {?} funcResult
                             * @return {?}
                             */
                            function (funcResult) {
                                if (funcResult) {
                                    // self.resultColumns.push({ id: funcResult.srcCol, label: funcResult.colName });
                                    funcResultDatas_2.push({ id: self.guid(), resultcode: funcResult.srcCol, resultsort: '0', resultname: funcResult.colName,
                                        resultcolvisible: '1', resultdescription: funcResult.description });
                                }
                            }));
                            if (funcResultDatas_2.length > 0) {
                                if (self.resultDatas && self.resultDatas.length > 0) {
                                    /** @type {?} */
                                    var newResultDatas = [];
                                    var _loop_1 = function (funcResultData) {
                                        /** @type {?} */
                                        var resultData = self.resultDatas.find((/**
                                         * @param {?} x
                                         * @return {?}
                                         */
                                        function (x) { return x.resultcode === funcResultData.resultcode; }));
                                        if (resultData) {
                                            newResultDatas.push(tslib_1.__assign({}, resultData, { resultdescription: funcResultData.resultdescription }));
                                        }
                                        else {
                                            newResultDatas.push(funcResultData);
                                        }
                                    };
                                    try {
                                        for (var funcResultDatas_1 = tslib_1.__values(funcResultDatas_2), funcResultDatas_1_1 = funcResultDatas_1.next(); !funcResultDatas_1_1.done; funcResultDatas_1_1 = funcResultDatas_1.next()) {
                                            var funcResultData = funcResultDatas_1_1.value;
                                            _loop_1(funcResultData);
                                        }
                                    }
                                    catch (e_1_1) { e_1 = { error: e_1_1 }; }
                                    finally {
                                        try {
                                            if (funcResultDatas_1_1 && !funcResultDatas_1_1.done && (_a = funcResultDatas_1.return)) _a.call(funcResultDatas_1);
                                        }
                                        finally { if (e_1) throw e_1.error; }
                                    }
                                    /** @type {?} */
                                    var resultColumns1_1 = [];
                                    newResultDatas.forEach((/**
                                     * @param {?} m
                                     * @return {?}
                                     */
                                    function (m) {
                                        resultColumns1_1.push({ id: m.resultcode, label: m.resultname });
                                    }));
                                    self.resultColumns = tslib_1.__spread(resultColumns1_1);
                                    self.resultDatas = tslib_1.__spread(newResultDatas);
                                }
                                else {
                                    /** @type {?} */
                                    var resultColumns1_2 = [];
                                    funcResultDatas_2.forEach((/**
                                     * @param {?} m
                                     * @return {?}
                                     */
                                    function (m) {
                                        resultColumns1_2.push({ id: m.resultcode, label: m.resultname });
                                    }));
                                    self.resultColumns = tslib_1.__spread(resultColumns1_2);
                                    self.resultDatas = tslib_1.__spread(funcResultDatas_2);
                                }
                                // self.resultDatas = [...funcResultDatas];
                            }
                        }
                    }
                    else {
                        /** @type {?} */
                        var options_1 = {
                            headers: {
                                'SessionId': self.data.sessionId,
                                'Content-Type': 'application/json'
                            }
                        };
                        // 根据id获取元数据信息
                        self.restfulService.get(self.data.serverHost + '/api/runtime/sys/v1.0/rt-metadatas/' + metadataobjectid, {}, options_1).subscribe((/**
                         * @param {?} metadataContent
                         * @return {?}
                         */
                        function (metadataContent) {
                            if (metadataContent) {
                                /** @type {?} */
                                var currentMetadataContent = JSON.parse(metadataContent['content']);
                                /** @type {?} */
                                var mainObject = currentMetadataContent.QueryNode;
                                if (!mainObject) {
                                    mainObject = currentMetadataContent.DataSources['0'].QueryNode;
                                }
                                /** @type {?} */
                                var datas_1 = [];
                                mainObject.ContainElements.forEach((/**
                                 * @param {?} containElement
                                 * @return {?}
                                 */
                                function (containElement) {
                                    self.resultColumns.push({ id: containElement.Code, label: containElement.Name });
                                    datas_1.push({ id: self.guid(), resultcode: containElement.Code, resultsort: '0', resultname: containElement.Name, resultcolvisible: '1', resultdescription: '' });
                                }));
                                if (datas_1.length > 0) {
                                    self.resultDatas = tslib_1.__spread(datas_1);
                                }
                                self.qomanagercode = 'com.' + (currentMetadataContent.NamespacePrefix + '.' + currentMetadataContent.Code).toLowerCase(); // qo编号
                            }
                        }));
                    }
                }
            }
        }));
    };
    /**
     * @param {?} a
     * @param {?} b
     * @return {?}
     */
    FormularDefineComponent.prototype.sortData = /**
     * @param {?} a
     * @param {?} b
     * @return {?}
     */
    function (a, b) {
        return a.orderNumber - b.orderNumber;
    };
    /**
     * @param {?} string
     * @return {?}
     */
    FormularDefineComponent.prototype.formularCheck = /**
     * @param {?} string
     * @return {?}
     */
    function (string) {
        // 剔除空白符
        string = string.replace(/\s/g, '');
        // 错误情况，空字符串
        if ('' === string) {
            return false;
        }
        // 错误情况，运算符连续
        if (/[\+\-\*\/]{2,}/.test(string)) {
            return false;
        }
        // 空括号
        if (/\(\)/.test(string)) {
            return false;
        }
        // 错误情况，括号不配对
        /** @type {?} */
        var stack = [];
        for (var i = 0, item; i < string.length; i++) {
            item = string.charAt(i);
            if ('(' === item) {
                stack.push('(');
            }
            else if (')' === item) {
                if (stack.length > 0) {
                    stack.pop();
                }
                else {
                    return false;
                }
            }
        }
        if (0 !== stack.length) {
            return false;
        }
        // 错误情况，(后面是运算符 
        if (/\([\+\-\*\/]/.test(string)) {
            return false;
        }
        // 错误情况，)前面是运算符
        if (/[\+\-\*\/]\)/.test(string)) {
            return false;
        }
        // // 错误情况，(前面不是运算符
        // if (/[^\+\-\*\/]\(/.test(string)) {
        //   return false;
        // }
        // // 错误情况，)后面不是运算符
        // if (/\)[^\+\-\*\/]/.test(string)) {
        //   return false;
        // }
        return true;
    };
    FormularDefineComponent.decorators = [
        { type: Component, args: [{
                    selector: 'formular-define',
                    template: "<div class=\"farris-main-area flex-column\">\r\n  <div class=\"farris-header\">\r\n    <div class=\"farris-form form-inline farris-form-inline\">\r\n      <div class=\"f-utils-flex-row-wrap\">\r\n        <div class=\"col-2\" *ngIf=\"formularType===0\">\r\n          <farris-button (click)=\"generateFormular()\">\r\n            <span>{{labelSaveFormular}}</span>\r\n          </farris-button>\r\n        </div>\r\n        <div class=\"col-10\" *ngIf=\"formularType===1\">\r\n          <farris-button (click)=\"generateFormularInfo()\">\r\n            <span>{{labelGeneraterFormular}}</span>\r\n          </farris-button>\r\n          <farris-button class=\"mx-2\" [size]=\"'small'\" (click)=\"operator('+')\">\r\n            <span>+</span>\r\n          </farris-button>\r\n          <farris-button class=\"mx-2\" [size]=\"'small'\" (click)=\"operator('-')\">\r\n            <span>-</span>\r\n          </farris-button>\r\n          <farris-button class=\"mx-2\" [size]=\"'small'\" (click)=\"operator('*')\">\r\n            <span>*</span>\r\n          </farris-button>\r\n          <farris-button class=\"mx-2\" [size]=\"'small'\" (click)=\"operator('/')\">\r\n            <span>-</span>\r\n          </farris-button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=\"navbar p-0\" *ngIf=\"formularType===1\">\r\n      <textarea class=\"form-control\" rows=\"10\" maxlength=\"2000\" id=\"formularText\" [(ngModel)]=\"formularText\"></textarea>\r\n    </div>\r\n  </div>\r\n  <div class=\"d-flex flex-row flex-fill farris-overflow-hidden\">\r\n    <div class=\"col-3 p-0 m-1 farris-overflow-hidden\" (resized)=\"onResized($event)\">\r\n      <div class=\"col-12 col-md-12 col-lg-12\">\r\n        <div class=\"farris-group-wrap form-inline farris-form-inline\">\r\n          <div class=\"form-group farris-form-group\">\r\n            <label class=\"col-form-label\" for=\"colFunction\" style=\"width: 6rem; min-width: 6rem;\">\r\n              <span class=\"farris-label-text\">{{labelQueryFunc}}:</span>\r\n            </label>\r\n            <div class=\"farris-input-wrap\">\r\n              <kendo-combobox id=\"colAlign\" [(ngModel)]=\"funcSelectValue\" [data]=\"funcData\" [textField]=\"'name'\"\r\n                [valueField]=\"'value'\" class=\"form-control\" (selectionChange)=\"selectionChange($event)\">\r\n              </kendo-combobox>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=\"flex-fill f-utils-overflow-xhya \">\r\n      <farris-panel [foldable]=\"true\" [defaultExpand]=\"true\">\r\n        <farris-panel-item [title]=\"labelBasicInfo\">\r\n          <ng-template #contentTempl>\r\n            <div class=\"farris-form form-inline farris-form-inline\">\r\n              <div class=\"f-utils-flex-row-wrap\">\r\n                <div class=\"col-6\">\r\n                  <div class=\"farris-group-wrap\">\r\n                    <div class=\"form-group farris-form-group\">\r\n                      <label class=\"col-form-label\">\r\n                        <span class=\"farris-label-info text-danger\">*</span>\r\n                        <span class=\"farris-label-text\">{{labelFormularName}}</span>\r\n                      </label>\r\n                      <div class=\"farris-input-wrap\">\r\n                        <input class=\"form-control\" type=\"text\" id=\"name\" [(ngModel)]=\"name\" maxlength=\"36\">\r\n                        <div class=\"farris-feedback valid-feedback\"></div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n                <div class=\"col-6\">\r\n                  <div class=\"farris-group-wrap\">\r\n                    <div class=\"form-group farris-form-group\">\r\n                      <label class=\"col-form-label\" for=\"class-input-checkbox01\">\r\n                        <span class=\"farris-label-text\">{{labelIsGroup}}</span>\r\n                      </label>\r\n                      <div class=\"farris-input-wrap\">\r\n                        <div class=\"custom-control custom-checkbox\">\r\n                          <input class=\"custom-control-input\" id=\"isGroup\" [(ngModel)]=\"isGroup\" type=\"checkbox\">\r\n                          <label class=\"custom-control-label\" for=\"isGroup\"></label>\r\n                        </div>\r\n                        <div class=\"farris-feedback valid-feedback\"></div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </ng-template>\r\n        </farris-panel-item>\r\n        <farris-panel-item [title]=\"labelParamInfo\">\r\n          <ng-template #contentTempl>\r\n            <div class=\"farris-form form-inline farris-form-inline\">\r\n              <div class=\"f-utils-flex-row-wrap\">\r\n                <div class=\"col-6\" *ngFor=\"let i of dynamicInput\">\r\n                  <div class=\"farris-group-wrap\">\r\n                    <div class=\"form-group farris-form-group\">\r\n                      <label class=\"col-form-label\">\r\n                        <span class=\"farris-label-text\">{{i.paramname}}:</span>\r\n                      </label>\r\n                      <div class=\"farris-input-wrap\">\r\n                        <div *ngIf=\"i.fieldConfig.controltype === 'text'\">\r\n                          <input class=\"form-control\" type=\"text\" id=\"name\" [(ngModel)]=\"i.paramvalue\" maxlength=\"36\">\r\n                          <div class=\"farris-feedback valid-feedback\"></div>\r\n                        </div>\r\n                        <div *ngIf=\"i.fieldConfig.controltype === 'help'\">\r\n                          <farris-lookup-grid input-end-edit data-mapping [useTip]=\" false\" [nosearch]=\"false\" [ngModel]=\"i.fieldConfig.paramvaluename\"\r\n                            [editable]=\"false\" [displayType]=\"'List'\" [items]=\"helpData\"\r\n                            [idField]=\"i.fieldConfig.idField\"  [singleSelect]=\"true\"\r\n                            [pageSize]=\"20\" [pageIndex]=\"1\" [pagination]=\"true\" [textField]=\"i.fieldConfig.textField\"\r\n                            [valueField]=\"i.fieldConfig.valueField\" [title]=\"'\u901A\u7528\u5E2E\u52A9'\" [showCloseButton]=\"true\"\r\n                            [resizable]=\"true\" [context]='i.fieldConfig' [enableToSelect]=\"true\"\r\n                            [columns]=\"i.fieldConfig.showColumns\" [libHelpBeforeEvent]=\"i\"\r\n                            [localHost]=\"data.serverHost\" [dynamicInput] = \"dynamicInput\"></farris-lookup-grid>\r\n                          <div class=\"farris-feedback\"></div>\r\n                        </div>\r\n                        <div *ngIf=\"i.fieldConfig.controltype === 'dropdown'\">\r\n                          <farris-combo-list [(ngModel)]=\"i.paramvalue\" [idField]=\"'value'\" [textField]=\"'name'\"\r\n                            [editable]=\"false\" [data]=\"i.fieldConfig.enumValues\"\r\n                            [multiSelect]=\"i.fieldConfig.multiSelect\"></farris-combo-list>\r\n                          <div class=\"farris-feedback\"></div>\r\n                        </div>\r\n                        <div *ngIf=\"i.fieldConfig.controltype === 'single-date'\">\r\n                          <farris-datepicker [(ngModel)]=\"i.paramvalue\" [returnFormat]=\"'yyyy-MM-dd'\"\r\n                            [dateFormat]=\"i.fieldConfig.format\">\r\n                          </farris-datepicker>\r\n                          <div class=\"farris-feedback\"></div>\r\n                        </div>\r\n                        <div *ngIf=\"i.fieldConfig.controltype === 'single-number'\">\r\n                          <farris-number-spinner [(ngModel)]=\"i.paramvalue\"></farris-number-spinner>\r\n                          <div class=\"farris-feedback\"></div>\r\n                        </div>\r\n                        <div *ngIf=\"i.fieldConfig.controltype === 'single-year'\">\r\n                          <farris-datepicker [(ngModel)]=\"i.paramvalue\"  [returnFormat]=\"'yyyy'\"\r\n                            [dateFormat]=\"'yyyy'\" [showType]=\"3\"></farris-datepicker>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </ng-template>\r\n        </farris-panel-item>\r\n        <farris-panel-item [title]=\"labelResultColInfo\">\r\n          <ng-template #contentTempl>\r\n            <!-- <div class=\"row\" style=\"margin: 0; padding: 15px; background-color: #fff\">\r\n            <button class=\"btn btn-primary\" (click)=\"newAdd()\">\u65B0\u589E</button>\r\n            <button class=\"btn btn-default ml-1 mr-1\" (click)=\"removeRow()\">\u5220\u9664</button>\r\n          </div> -->\r\n            <farris-datagrid [data]=\"resultDatas\" [columns]=\"columns\" #dg=\"datagrid\" [fit]=\"true\" [showCheckbox]=\"false\"\r\n              [fitColumns]=\"true\" [showLineNumber]=\"false\" [striped]=\"true\" [virtualized]=\"false\" [height]=\"250\"\r\n              [pagination]=\"false\">\r\n            </farris-datagrid>\r\n          </ng-template>\r\n        </farris-panel-item>\r\n      </farris-panel>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #resultColumnTemp let-ctx>\r\n  <div class=\"f-datagrid-cell-formgroup farris-group-auto\">\r\n    <farris-combo-list [(ngModel)]=\"ctx.rowData['resultcode']\" [idField]=\"'id'\" [textField]=\"'label'\" [readonly]=\"true\"\r\n      [disabled]=\"true\" [data]=\"resultColumns\"></farris-combo-list>\r\n  </div>\r\n</ng-template>\r\n<ng-template #resultSortColumnTemp let-ctx>\r\n  <div class=\"f-datagrid-cell-formgroup farris-group-auto\">\r\n    <farris-combo-list [(ngModel)]=\"ctx.rowData['resultsort']\" [idField]=\"'id'\" [textField]=\"'label'\"\r\n      [data]=\"resultSortColumns\"></farris-combo-list>\r\n  </div>\r\n</ng-template>\r\n<ng-template #resultColVisibleColumnTemp let-ctx>\r\n  <div class=\"f-datagrid-cell-formgroup farris-group-auto\">\r\n    <farris-combo-list [(ngModel)]=\"ctx.rowData['resultcolvisible']\" [idField]=\"'id'\" [textField]=\"'label'\"\r\n      [data]=\"resultColVisibleColumns\"></farris-combo-list>\r\n  </div>\r\n</ng-template>",
                    styles: [""]
                }] }
    ];
    /** @nocollapse */
    FormularDefineComponent.ctorParameters = function () { return [
        { type: RestfulService },
        { type: MessagerService },
        { type: CacheService },
        { type: LoadingService },
        { type: EntityDataService },
        { type: LocalizeService }
    ]; };
    FormularDefineComponent.propDecorators = {
        resultColumnTemp: [{ type: ViewChild, args: ['resultColumnTemp',] }],
        resultSortColumnTemp: [{ type: ViewChild, args: ['resultSortColumnTemp',] }],
        resultColVisibleColumnTemp: [{ type: ViewChild, args: ['resultColVisibleColumnTemp',] }],
        dg: [{ type: ViewChild, args: ['dg',] }]
    };
    return FormularDefineComponent;
}());
export { FormularDefineComponent };
if (false) {
    /** @type {?} */
    FormularDefineComponent.prototype.resultColumnTemp;
    /** @type {?} */
    FormularDefineComponent.prototype.resultSortColumnTemp;
    /** @type {?} */
    FormularDefineComponent.prototype.resultColVisibleColumnTemp;
    /** @type {?} */
    FormularDefineComponent.prototype.data;
    /** @type {?} */
    FormularDefineComponent.prototype.funcData;
    /** @type {?} */
    FormularDefineComponent.prototype.currentFormularId;
    /** @type {?} */
    FormularDefineComponent.prototype.currentFunctionId;
    /** @type {?} */
    FormularDefineComponent.prototype.serverHost;
    /** @type {?} */
    FormularDefineComponent.prototype.size;
    /** @type {?} */
    FormularDefineComponent.prototype.currentFuncDatas;
    /** @type {?} */
    FormularDefineComponent.prototype.funcSelectValue;
    /** @type {?} */
    FormularDefineComponent.prototype.inputTemplate;
    /** @type {?} */
    FormularDefineComponent.prototype.sessionId;
    /** @type {?} */
    FormularDefineComponent.prototype.dynamicInput;
    /** @type {?} */
    FormularDefineComponent.prototype.columns;
    /** @type {?} */
    FormularDefineComponent.prototype.formularText;
    /** @type {?} */
    FormularDefineComponent.prototype.binding;
    /** @type {?} */
    FormularDefineComponent.prototype.name;
    /** @type {?} */
    FormularDefineComponent.prototype.isGroup;
    /** @type {?} */
    FormularDefineComponent.prototype.resultDatas;
    /** @type {?} */
    FormularDefineComponent.prototype.dg;
    /** @type {?} */
    FormularDefineComponent.prototype.resultColumns;
    /** @type {?} */
    FormularDefineComponent.prototype.type;
    /** @type {?} */
    FormularDefineComponent.prototype.metadataobjectid;
    /** @type {?} */
    FormularDefineComponent.prototype.qomanagercode;
    /** @type {?} */
    FormularDefineComponent.prototype.formularWizard;
    /** @type {?} */
    FormularDefineComponent.prototype.formularType;
    /** @type {?} */
    FormularDefineComponent.prototype.loading;
    /**
     * 国际化
     * @type {?}
     */
    FormularDefineComponent.prototype.labelSaveFormular;
    /** @type {?} */
    FormularDefineComponent.prototype.labelGeneraterFormular;
    /** @type {?} */
    FormularDefineComponent.prototype.labelQueryFunc;
    /** @type {?} */
    FormularDefineComponent.prototype.labelBasicInfo;
    /** @type {?} */
    FormularDefineComponent.prototype.labelFormularName;
    /** @type {?} */
    FormularDefineComponent.prototype.labelIsGroup;
    /** @type {?} */
    FormularDefineComponent.prototype.labelParamInfo;
    /** @type {?} */
    FormularDefineComponent.prototype.labelResultColInfo;
    /** @type {?} */
    FormularDefineComponent.prototype.resultSortColumns;
    /** @type {?} */
    FormularDefineComponent.prototype.resultColVisibleColumns;
    /**
     * 帮助配置字段
     * @type {?}
     */
    FormularDefineComponent.prototype.helpData;
    /** @type {?} */
    FormularDefineComponent.prototype.helpColumns;
    /** @type {?} */
    FormularDefineComponent.prototype.handlebeforeClose;
    /** @type {?} */
    FormularDefineComponent.prototype.clickLastStep;
    /** @type {?} */
    FormularDefineComponent.prototype.beforeFinish;
    /**
     * @type {?}
     * @private
     */
    FormularDefineComponent.prototype.restfulService;
    /**
     * @type {?}
     * @private
     */
    FormularDefineComponent.prototype.msgService;
    /**
     * @type {?}
     * @private
     */
    FormularDefineComponent.prototype.cacheService;
    /**
     * @type {?}
     * @private
     */
    FormularDefineComponent.prototype.loadService;
    /**
     * @type {?}
     * @private
     */
    FormularDefineComponent.prototype.entityDataService;
    /**
     * @type {?}
     * @private
     */
    FormularDefineComponent.prototype.localizeService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZm9ybXVsYXItZGVmaW5lLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BxZHAvZm9ybXVsYXIvIiwic291cmNlcyI6WyJsaWIvY29tcG9uZW50L2Zvcm11bGFyLWRlZmluZS9mb3JtdWxhci1kZWZpbmUuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQXVDLFNBQVMsRUFBNEIsV0FBVyxFQUE0QixNQUFNLGVBQWUsQ0FBQztBQUMzSixPQUFPLEVBQWMsRUFBRSxFQUFnQixPQUFPLEVBQUUsTUFBTSxNQUFNLENBQUM7QUFDN0QsT0FBTyxFQUFFLGVBQWUsRUFBRSxNQUFNLHFCQUFxQixDQUFDO0FBQ3RELE9BQU8sRUFBa0IsWUFBWSxFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFDbkUsT0FBTyxFQUFFLGNBQWMsRUFBRSxNQUFNLCtCQUErQixDQUFDO0FBQy9ELE9BQU8sRUFBRSxpQkFBaUIsRUFBRSxNQUFNLHFCQUFxQixDQUFDO0FBQ3hELE9BQU8sRUFBRSxjQUFjLEVBQUUsTUFBTSxvQkFBb0IsQ0FBQztBQUVwRCxPQUFPLEVBQUUsaUJBQWlCLEVBQUUsTUFBTSxrQ0FBa0MsQ0FBQztBQUNyRSxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBRWhEO0lBaUZFLGlDQUFvQixjQUE4QixFQUN0QyxVQUEyQixFQUMzQixZQUEwQixFQUMxQixXQUEyQixFQUMzQixpQkFBb0MsRUFDcEMsZUFBZ0M7UUFMNUMsaUJBaUJDO1FBakJtQixtQkFBYyxHQUFkLGNBQWMsQ0FBZ0I7UUFDdEMsZUFBVSxHQUFWLFVBQVUsQ0FBaUI7UUFDM0IsaUJBQVksR0FBWixZQUFZLENBQWM7UUFDMUIsZ0JBQVcsR0FBWCxXQUFXLENBQWdCO1FBQzNCLHNCQUFpQixHQUFqQixpQkFBaUIsQ0FBbUI7UUFDcEMsb0JBQWUsR0FBZixlQUFlLENBQWlCO1FBN0U1QyxTQUFJLEdBQVEsRUFBRSxD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QztTQWxuQlksdUJBQXVCOzs7SUFDbEMsbURBQWtFOztJQUNsRSx1REFBMEU7O0lBQzFFLDZEQUFzRjs7SUFDdEYsdUNBQWU7O0lBQ2YsMkNBQW1COztJQUNuQixvREFBdUI7O0lBQ3ZCLG9EQUF1Qjs7SUFDdkIsNkNBQWdCOztJQUNoQix1Q0FBZTs7SUFDZixtREFBc0I7O0lBQ3RCLGtEQUFxQjs7SUFDckIsZ0RBQXdCOztJQUN4Qiw0Q0FBZTs7SUFDZiwrQ0FBdUI7O0lBQ3ZCLDBDQUNFOztJQUNGLCtDQUF1Qjs7SUFDdkIsMENBQWdDOztJQUNoQyx1Q0FBZTs7SUFDZiwwQ0FBcUI7O0lBQ3JCLDhDQUFzQjs7SUFDdEIscUNBQXVDOztJQUN2QyxnREFDRTs7SUFDRix1Q0FBVTs7SUFDVixtREFBc0I7O0lBQ3RCLGdEQUFtQjs7SUFDbkIsaURBQTBCOztJQUMxQiwrQ0FBaUI7O0lBQ2pCLDBDQUF1RDs7Ozs7SUFLdkQsb0RBQTJCOztJQUMzQix5REFBK0I7O0lBQy9CLGlEQUF5Qjs7SUFDekIsaURBQXVCOztJQUN2QixvREFBMEI7O0lBQzFCLCtDQUFxQjs7SUFDckIsaURBQXVCOztJQUN2QixxREFBNEI7O0lBRTVCLG9EQWFFOztJQUVGLDBEQVNFOzs7OztJQUtGLDJDQUFtQjs7SUFDbkIsOENBQXNCOztJQXdFdEIsb0RBRUM7O0lBbVdELGdEQUdDOztJQUVELCtDQXdEQzs7Ozs7SUF4ZVcsaURBQXNDOzs7OztJQUM5Qyw2Q0FBbUM7Ozs7O0lBQ25DLCtDQUFrQzs7Ozs7SUFDbEMsOENBQW1DOzs7OztJQUNuQyxvREFBNEM7Ozs7O0lBQzVDLGtEQUF3QyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCwgT25Jbml0LCBJbnB1dCwgT3V0cHV0LCBFdmVudEVtaXR0ZXIsIFZpZXdDaGlsZCwgT25DaGFuZ2VzLCBTaW1wbGVDaGFuZ2VzLCBUZW1wbGF0ZVJlZiwgT25EZXN0cm95LCBBZnRlclZpZXdJbml0IH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IE9ic2VydmFibGUsIG9mLCBTdWJzY3JpcHRpb24sIFN1YmplY3QgfSBmcm9tICdyeGpzJztcclxuaW1wb3J0IHsgTWVzc2FnZXJTZXJ2aWNlIH0gZnJvbSAnQGZhcnJpcy91aS1tZXNzYWdlcic7XHJcbmltcG9ydCB7IFNlc3Npb25TZXJ2aWNlLCBDYWNoZVNlcnZpY2UgfSBmcm9tICdAZWNwLWNhZi9jYWYtY29tbW9uJztcclxuaW1wb3J0IHsgUmVzdGZ1bFNlcnZpY2UgfSBmcm9tICcuLi8uLi9zZXJ2aWNlL3Jlc3RmdWwuc2VydmljZSc7XHJcbmltcG9ydCB7IERhdGFncmlkQ29tcG9uZW50IH0gZnJvbSAnQGZhcnJpcy91aS1kYXRhZ3JpZCc7XHJcbmltcG9ydCB7IExvYWRpbmdTZXJ2aWNlIH0gZnJvbSAnQGZhcnJpcy91aS1sb2FkaW5nJztcclxuaW1wb3J0IHsgRm9ybXVsYXJTZXJ2aWNlIH0gZnJvbSAnLi4vLi4vc2VydmljZS9mb3JtdWxhci5zZXJ2aWNlJztcclxuaW1wb3J0IHsgRW50aXR5RGF0YVNlcnZpY2UgfSBmcm9tICcuLi8uLi9zZXJ2aWNlL2VudGl0eWRhdGEuc2VydmljZSc7XHJcbmltcG9ydCB7IExvY2FsaXplU2VydmljZSB9IGZyb20gJ0BxZHAvbG9jYWxpemUnO1xyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgc2VsZWN0b3I6ICdmb3JtdWxhci1kZWZpbmUnLFxyXG4gIHRlbXBsYXRlVXJsOiAnLi9mb3JtdWxhci1kZWZpbmUuY29tcG9uZW50Lmh0bWwnLFxyXG4gIHN0eWxlVXJsczogWycuL2Zvcm11bGFyLWRlZmluZS5jb21wb25lbnQuc2NzcyddXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBGb3JtdWxhckRlZmluZUNvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCwgQWZ0ZXJWaWV3SW5pdCB7XHJcbiAgQFZpZXdDaGlsZCgncmVzdWx0Q29sdW1uVGVtcCcpIHJlc3VsdENvbHVtblRlbXA6IFRlbXBsYXRlUmVmPGFueT47XHJcbiAgQFZpZXdDaGlsZCgncmVzdWx0U29ydENvbHVtblRlbXAnKSByZXN1bHRTb3J0Q29sdW1uVGVtcDogVGVtcGxhdGVSZWY8YW55PjtcclxuICBAVmlld0NoaWxkKCdyZXN1bHRDb2xWaXNpYmxlQ29sdW1uVGVtcCcpIHJlc3VsdENvbFZpc2libGVDb2x1bW5UZW1wOiBUZW1wbGF0ZVJlZjxhbnk+O1xyXG4gIGRhdGE6IGFueSA9IFtdO1xyXG4gIGZ1bmNEYXRhOiBhbnkgPSBbXTtcclxuICBjdXJyZW50Rm9ybXVsYXJJZDogYW55OyAvLyDlvZPliY3lhazlvI9pZFxyXG4gIGN1cnJlbnRGdW5jdGlvbklkOiBhbnk7IC8vIOW9k+WJjeS4muWKoeWHveaVsGlkXHJcbiAgc2VydmVySG9zdDogYW55OyAvLyDlvZPliY3nq5nngrlob3N0XHJcbiAgc2l6ZTogYW55ID0ge307XHJcbiAgY3VycmVudEZ1bmNEYXRhczogYW55O1xyXG4gIGZ1bmNTZWxlY3RWYWx1ZTogYW55O1xyXG4gIGlucHV0VGVtcGxhdGU6IGFueSA9ICcnO1xyXG4gIHNlc3Npb25JZDogYW55O1xyXG4gIGR5bmFtaWNJbnB1dDogYW55ID0gW107XHJcbiAgY29sdW1uczogYW55ID0gW1xyXG4gIF07XHJcbiAgZm9ybXVsYXJUZXh0OiBhbnkgPSAnJzsgLy8g5YWs5byP5L+h5oGvXHJcbiAgYmluZGluZzogYW55ID0gJ3NlbGVjdEZvcm11bGFyJztcclxuICBuYW1lOiBhbnkgPSAnJzsgLy8g5YWs5byP5ZCN56ewXHJcbiAgaXNHcm91cDogYW55ID0gZmFsc2U7IC8vIOaYr+WQpuWIhue7hFxyXG4gIHJlc3VsdERhdGFzOiBhbnkgPSBbXTtcclxuICBAVmlld0NoaWxkKCdkZycpIGRnOiBEYXRhZ3JpZENvbXBvbmVudDtcclxuICByZXN1bHRDb2x1bW5zOiBhbnkgPSBbXHJcbiAgXTtcclxuICB0eXBlOiBhbnk7XHJcbiAgbWV0YWRhdGFvYmplY3RpZDogYW55O1xyXG4gIHFvbWFuYWdlcmNvZGU6IGFueTtcclxuICBmb3JtdWxhcldpemFyZDogYW55ID0gJzAnO1xyXG4gIGZvcm11bGFyVHlwZSA9IDA7IC8vIDDmma7pgJrlhazlvI8gMee7hOWQiOWFrOW8j1xyXG4gIGxvYWRpbmcgPSB0aGlzLmxvYWRTZXJ2aWNlLnNob3coeyBjb250YWluZXI6ICdib2R5JyB9KTtcclxuXHJcbiAgLyoqXHJcbiAgICog5Zu96ZmF5YyWXHJcbiAgICovXHJcbiAgbGFiZWxTYXZlRm9ybXVsYXIgPSAn5L+d5a2Y5YWs5byPJztcclxuICBsYWJlbEdlbmVyYXRlckZvcm11bGFyOiAn5b2i5oiQ5YWs5byPJztcclxuICBsYWJlbFF1ZXJ5RnVuYzogJ+S4muWKoeafpeivouWHveaVsCc7XHJcbiAgbGFiZWxCYXNpY0luZm86ICfln7rmnKzkv6Hmga8nO1xyXG4gIGxhYmVsRm9ybXVsYXJOYW1lOiAn5YWs5byP5ZCN56ewJztcclxuICBsYWJlbElzR3JvdXA6ICfmmK/lkKbliIbnu4QnO1xyXG4gIGxhYmVsUGFyYW1JbmZvOiAn5Y+C5pWw5L+h5oGvJztcclxuICBsYWJlbFJlc3VsdENvbEluZm86ICfnu5PmnpzliJfkv6Hmga8nO1xyXG5cclxuICByZXN1bHRTb3J0Q29sdW1uczogYW55ID0gW1xyXG4gICAge1xyXG4gICAgICBpZDogJzAnLFxyXG4gICAgICBsYWJlbDogJ+aXoCdcclxuICAgIH0sXHJcbiAgICB7XHJcbiAgICAgIGlkOiAnMScsXHJcbiAgICAgIGxhYmVsOiAn5Y2H5bqPJ1xyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgaWQ6ICcyJyxcclxuICAgICAgbGFiZWw6ICfpmY3luo8nXHJcbiAgICB9XHJcbiAgXTtcclxuXHJcbiAgcmVzdWx0Q29sVmlzaWJsZUNvbHVtbnM6IGFueSA9IFtcclxuICAgIHtcclxuICAgICAgaWQ6ICcwJyxcclxuICAgICAgbGFiZWw6ICflkKYnXHJcbiAgICB9LFxyXG4gICAge1xyXG4gICAgICBpZDogJzEnLFxyXG4gICAgICBsYWJlbDogJ+aYrydcclxuICAgIH1cclxuICBdO1xyXG5cclxuICAvKipcclxuICAgKiDluK7liqnphY3nva7lrZfmrrVcclxuICAgKi9cclxuICBoZWxwRGF0YTogYW55ID0gW107XHJcbiAgaGVscENvbHVtbnM6IGFueSA9IFtdO1xyXG5cclxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIHJlc3RmdWxTZXJ2aWNlOiBSZXN0ZnVsU2VydmljZVxyXG4gICAgLCBwcml2YXRlIG1zZ1NlcnZpY2U6IE1lc3NhZ2VyU2VydmljZVxyXG4gICAgLCBwcml2YXRlIGNhY2hlU2VydmljZTogQ2FjaGVTZXJ2aWNlXHJcbiAgICAsIHByaXZhdGUgbG9hZFNlcnZpY2U6IExvYWRpbmdTZXJ2aWNlXHJcbiAgICAsIHByaXZhdGUgZW50aXR5RGF0YVNlcnZpY2U6IEVudGl0eURhdGFTZXJ2aWNlXHJcbiAgICAsIHByaXZhdGUgbG9jYWxpemVTZXJ2aWNlOiBMb2NhbGl6ZVNlcnZpY2UpIHtcclxuICAgIHRoaXMubGFiZWxTYXZlRm9ybXVsYXIgPSB0aGlzLmxvY2FsaXplU2VydmljZS5nZXRWYWx1ZSgnZm9ybXVsYXIuZGVmaW5lLmxhYmVsU2F2ZUZvcm11bGFyJyk7XHJcbiAgICB0aGlzLmxhYmVsR2VuZXJhdGVyRm9ybXVsYXIgPSB0aGlzLmxvY2FsaXplU2VydmljZS5nZXRWYWx1ZSgnZm9ybXVsYXIuZGVmaW5lLmxhYmVsR2VuZXJhdGVyRm9ybXVsYXInKTtcclxuICAgIHRoaXMubGFiZWxRdWVyeUZ1bmMgPSB0aGlzLmxvY2FsaXplU2VydmljZS5nZXRWYWx1ZSgnZm9ybXVsYXIuZGVmaW5lLmxhYmVsUXVlcnlGdW5jJyk7XHJcbiAgICB0aGlzLmxhYmVsQmFzaWNJbmZvID0gdGhpcy5sb2NhbGl6ZVNlcnZpY2UuZ2V0VmFsdWUoJ2Zvcm11bGFyLmRlZmluZS5sYWJlbEJhc2ljSW5mbycpO1xyXG4gICAgdGhpcy5sYWJlbEZvcm11bGFyTmFtZSA9IHRoaXMubG9jYWxpemVTZXJ2aWNlLmdldFZhbHVlKCdmb3JtdWxhci5kZWZpbmUubGFiZWxGb3JtdWxhck5hbWUnKTtcclxuICAgIHRoaXMubGFiZWxJc0dyb3VwID0gdGhpcy5sb2NhbGl6ZVNlcnZpY2UuZ2V0VmFsdWUoJ2Zvcm11bGFyLmRlZmluZS5sYWJlbElzR3JvdXAnKTtcclxuICAgIHRoaXMubGFiZWxQYXJhbUluZm8gPSB0aGlzLmxvY2FsaXplU2VydmljZS5nZXRWYWx1ZSgnZm9ybXVsYXIuZGVmaW5lLmxhYmVsUGFyYW1JbmZvJyk7XHJcbiAgICB0aGlzLmxhYmVsUmVzdWx0Q29sSW5mbyA9IHRoaXMubG9jYWxpemVTZXJ2aWNlLmdldFZhbHVlKCdmb3JtdWxhci5kZWZpbmUubGFiZWxSZXN1bHRDb2xJbmZvJyk7XHJcbiAgICB0aGlzLnJlc3VsdFNvcnRDb2x1bW5zID0gdGhpcy5sb2NhbGl6ZVNlcnZpY2UuZ2V0VmFsdWUoJ2Zvcm11bGFyLmRlZmluZS5yZXN1bHRTb3J0Q29sdW1ucycpO1xyXG4gICAgdGhpcy5yZXN1bHRDb2xWaXNpYmxlQ29sdW1ucyA9IHRoaXMubG9jYWxpemVTZXJ2aWNlLmdldFZhbHVlKCdmb3JtdWxhci5kZWZpbmUucmVzdWx0Q29sVmlzaWJsZUNvbHVtbnMnKTtcclxuXHJcbiAgfVxyXG5cclxuICBuZ09uSW5pdCgpIHtcclxuICAgIHRoaXMuZGF0YSA9IHRoaXMuY2FjaGVTZXJ2aWNlLmdldCgnZm9ybXVsYXJQYXJhbScpO1xyXG4gICAgdGhpcy5mb3JtdWxhcldpemFyZCA9IHRoaXMuZGF0YS5mb3JtdWxhcldpemFyZDtcclxuICAgIHRoaXMuZm9ybXVsYXJUeXBlID0gdGhpcy5kYXRhLmZvcm11bGFyV2l6YXJkID09PSAnMicgPyAxIDogMDtcclxuICAgIHRoaXMuY3VycmVudEZvcm11bGFySWQgPSB0aGlzLmRhdGEuY3VycmVudEZvcm11bGFySWQ7XHJcbiAgICB0aGlzLmNvbHVtbnMgPSBbXHJcbiAgICAgIC8vIHsgZmllbGQ6ICdpZCcsIHdpZHRoOiAxMDAsIHRpdGxlOiAnSUQnIH0sXHJcbiAgICAgIHsgZmllbGQ6ICdyZXN1bHRjb2x2aXNpYmxlJywgd2lkdGg6IDYwLCB0aXRsZTogdGhpcy5sb2NhbGl6ZVNlcnZpY2UuZ2V0VmFsdWUoJ2Zvcm11bGFyLmRlZmluZS5jb2x1bW50aXRsZXMucmVzdWx0Y29sdmlzaWJsZScpLCB0ZW1wbGF0ZTogdGhpcy5yZXN1bHRDb2xWaXNpYmxlQ29sdW1uVGVtcCB9LFxyXG4gICAgICB7IGZpZWxkOiAncmVzdWx0Y29kZScsIHdpZHRoOiA2MCwgdGl0bGU6IHRoaXMubG9jYWxpemVTZXJ2aWNlLmdldFZhbHVlKCdmb3JtdWxhci5kZWZpbmUuY29sdW1udGl0bGVzLnJlc3VsdGNvZGUnKX0sXHJcbiAgICAgIHsgZmllbGQ6ICdyZXN1bHRkZXNjcmlwdGlvbicsIHdpZHRoOiA2MCwgdGl0bGU6IHRoaXMuZ2V0UmVzdWx0RGVzY3JpcHRpb24oKX0sXHJcbiAgICAgIHsgZmllbGQ6ICdyZXN1bHRzb3J0Jywgd2lkdGg6IDYwLCB0aXRsZTogdGhpcy5sb2NhbGl6ZVNlcnZpY2UuZ2V0VmFsdWUoJ2Zvcm11bGFyLmRlZmluZS5jb2x1bW50aXRsZXMucmVzdWx0c29ydCcpLCB0ZW1wbGF0ZTogdGhpcy5yZXN1bHRTb3J0Q29sdW1uVGVtcCB9XHJcbiAgICBdO1xyXG4gICAgaWYgKHRoaXMuZGF0YS5zZXNzaW9uSWQpIHtcclxuICAgICAgdGhpcy5nZXRGdW5jSW5mbygpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5jcmVhdGVIZWFkZXJTZXNzaW9uSWQoKS5zdWJzY3JpYmUoc2Vzc2lvbklkID0+IHtcclxuICAgICAgICBjb25zb2xlLmxvZyhzZXNzaW9uSWQpO1xyXG4gICAgICAgIGlmIChzZXNzaW9uSWQpIHtcclxuICAgICAgICAgIHRoaXMuZ2V0RnVuY0luZm8oKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBndWlkKCkge1xyXG4gICAgcmV0dXJuIChbMWU3XSBhcyBhbnkgKyAtMWUzICsgLTRlMyArIC04ZTMgKyAtMWUxMSkucmVwbGFjZSgvWzAxOF0vZywgYyA9PlxyXG4gICAgICAoYyBeIGNyeXB0by5nZXRSYW5kb21WYWx1ZXMobmV3IFVpbnQ4QXJyYXkoMSkpWzBdICYgMTUgPj4gYyAvIDQpLnRvU3RyaW5nKDE2KSk7XHJcbiAgfVxyXG5cclxuICBnZXRSZXN1bHREZXNjcmlwdGlvbigpIHtcclxuICAgIHJldHVybiB0aGlzLmdldExhbmd1YWdlKCkgPT09ICd6aC1jaHMnID8gJ+WIl+aPj+i/sCc6ICdkZXNjcmlwdGlvbic7XHJcbiAgfVxyXG5cclxuICBnZXRMYW5ndWFnZSgpIHtcclxuICAgIHN3aXRjaCh0aGlzLmxvY2FsaXplU2VydmljZS5sb2NhbGVJZCkge1xyXG4gICAgICBjYXNlICd6aC1jaHMnOlxyXG4gICAgICBjYXNlICd6aC1jbic6XHJcbiAgICAgIGNhc2UgJ3poJzpcclxuICAgICAgICByZXR1cm4gJ3poLWNocyc7XHJcbiAgICAgIGNhc2UgJ2VuLXVzJzpcclxuICAgICAgY2FzZSAnZW4nOlxyXG4gICAgICAgIHJldHVybiAnZW4tdXMnO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICByZXR1cm4gJ3poLWNocyc7XHJcbiAgfVxyXG5cclxuICBuZ0FmdGVyVmlld0luaXQoKSB7XHJcbiAgICB0aGlzLmxvYWRpbmcuY2xvc2UoKTtcclxuICB9XHJcblxyXG4gIGhhbmRsZWJlZm9yZUNsb3NlID0gKCk6IE9ic2VydmFibGU8YW55PiA9PiB7XHJcbiAgICByZXR1cm4gb2YodHJ1ZSk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGNyZWF0ZUhlYWRlclNlc3Npb25JZCgpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgY29uc3Qgc2Vzc2lvbklkID0gbmV3IFN1YmplY3QoKTtcclxuICAgIGNvbnN0IG9wdGlvbnM6IGFueSA9IHtcclxuICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcclxuICAgICAgfSxcclxuICAgICAgcmVzcG9uc2VUeXBlOiAndGV4dCdcclxuICAgIH07XHJcbiAgICBjb25zdCBjcmVhdGVTZXNzaW9uVXJsID0gdGhpcy5kYXRhLnNlcnZlckhvc3QgKyAnL2FwaS9nc3AvYmNjL3YxLjAvcXVlcnlmdW5jZGV0YWlsX2ZybS9zZXJ2aWNlL2NyZWF0ZXNlc3Npb24nO1xyXG4gICAgdGhpcy5yZXN0ZnVsU2VydmljZS5wb3N0KGNyZWF0ZVNlc3Npb25VcmwsIHt9LCB7fSwgb3B0aW9ucykuc3Vic2NyaWJlKGRhdGEgPT4ge1xyXG4gICAgICB0aGlzLmRhdGEuc2Vzc2lvbklkID0gZGF0YTtcclxuICAgICAgc2Vzc2lvbklkLm5leHQoZGF0YSk7XHJcbiAgICB9KTtcclxuICAgIHJldHVybiBzZXNzaW9uSWQ7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGdldEZ1bmNJbmZvKCkge1xyXG4gICAgbGV0IHVyaSA9IHRoaXMuZGF0YS5zZXJ2ZXJIb3N0O1xyXG4gICAgY29uc3Qgb3B0aW9ucyA9IHtcclxuICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgICdTZXNzaW9uSWQnOiB0aGlzLmRhdGEuc2Vzc2lvbklkLFxyXG4gICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcclxuICAgICAgfVxyXG4gICAgfTtcclxuICAgIGNvbnN0IGVudGl0eUZpbHRlciA9IHtcclxuICAgICAgRmlsdGVyQ29uZGl0aW9uczogW3sgJ0ZpbHRlckZpZWxkJzogJ1NyY1NVJywgJ1ZhbHVlJzogdGhpcy5kYXRhLmN1cnJlbnRTVSwgJ0xicmFja2V0JzogbnVsbCwgJ1JicmFja2V0JzogbnVsbCwgJ1JlbGF0aW9uJzogMCwgJ0V4cHJlc3N0eXBlJzogMCwgJ0NvbXBhcmUnOiA2IH1dLFxyXG4gICAgICBTb3J0Q29uZGl0aW9uczogW10sXHJcbiAgICAgIElzVXNlUGFnaW5hdGlvbjogZmFsc2UsXHJcbiAgICAgIFBhZ2luYXRpb246IHtcclxuICAgICAgICBQYWdlSW5kZXg6IDAsXHJcbiAgICAgICAgUGFnZVNpemU6IDAsXHJcbiAgICAgICAgUGFnZUNvdW50OiAwLFxyXG4gICAgICAgIFRvdGFsQ291bnQ6IDBcclxuICAgICAgfVxyXG4gICAgfTtcclxuICAgIHVyaSArPSAnL2FwaS9nc3AvYmNjL3YxLjAvcXVlcnlmdW5jZGV0YWlsX2ZybS9leHRlbnNpb24vcXVlcnk/ZW50aXR5RmlsdGVyPScgKyBKU09OLnN0cmluZ2lmeShlbnRpdHlGaWx0ZXIpO1xyXG4gICAgdGhpcy5yZXN0ZnVsU2VydmljZS5wdXQodXJpLCB7fSwge30sIG9wdGlvbnMpLnN1YnNjcmliZShkYXRhID0+IHtcclxuICAgICAgY29uc3QgZnVuY0RhdGFzID0gZGF0YS5yZXR1cm5WYWx1ZS5yZXN1bHQ7XHJcbiAgICAgIGlmIChmdW5jRGF0YXMgJiYgZnVuY0RhdGFzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICBmdW5jRGF0YXMuZm9yRWFjaCh4ID0+IHtcclxuICAgICAgICAgIHRoaXMuZnVuY0RhdGEucHVzaCh7IG5hbWU6IHgubmFtZSwgdmFsdWU6IHguaWQgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgICAgdGhpcy5jdXJyZW50RnVuY0RhdGFzID0gZnVuY0RhdGFzO1xyXG4gICAgICAvLyDlpoLmnpzpgInmi6nnmoTmmK/pgInmi6nlhazlvI/vvIzmoLnmja7lhaznpLrkv6Hmga/liJ3lp4vpu5jorqTnmoTmlbDmja5cclxuICAgICAgaWYgKHRoaXMuY3VycmVudEZvcm11bGFySWQgJiYgdGhpcy5kYXRhLmZvcm11bGFyRGF0YSAmJiB0aGlzLmRhdGEuZm9ybXVsYXJEYXRhLm51bTEgPT09IDEpIHtcclxuICAgICAgICB0aGlzLm5hbWUgPSB0aGlzLmRhdGEuZm9ybXVsYXJEYXRhLm5hbWU7XHJcbiAgICAgICAgdGhpcy5mb3JtdWxhclRleHQgPSB0aGlzLmRhdGEuZm9ybXVsYXJEYXRhLnN0cjY7XHJcbiAgICAgICAgdGhpcy5mb3JtdWxhclR5cGUgPSAxO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHRoaXMuZ2V0Rm9ybXVsYXJJbmZvKCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBnZXRGb3JtdWxhckluZm8oKSB7XHJcbiAgICAvLyDmuIXnqbrljoblj7LmlbDmja5cclxuICAgIHRoaXMuZHluYW1pY0lucHV0ID0gW107XHJcbiAgICB0aGlzLnJlc3VsdENvbHVtbnMgPSBbXTtcclxuICAgIHRoaXMucmVzdWx0RGF0YXMgPSBbXTtcclxuICAgIHRoaXMuZm9ybXVsYXJUZXh0ID0gJyc7XHJcbiAgICB0aGlzLm5hbWUgPSAnJztcclxuICAgIHRoaXMuaXNHcm91cCA9IDA7XHJcblxyXG4gICAgaWYgKHRoaXMuY3VycmVudEZvcm11bGFySWQpIHtcclxuICAgICAgY29uc3Qgb3B0aW9ucyA9IHtcclxuICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICAnU2Vzc2lvbklkJzogdGhpcy5kYXRhLnNlc3Npb25JZCxcclxuICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcclxuICAgICAgICB9XHJcbiAgICAgIH07XHJcbiAgICAgIGNvbnN0IHJldHJpZXZlVXJpID0gdGhpcy5kYXRhLnNlcnZlckhvc3QgKyAnL2FwaS9nc3AvYmNjL3YxLjAvcXVlcnlnZXRkYXRhZGV0YWlsX2ZybS9leHRlbnNpb24vcmV0cmlldmUvJyArIHRoaXMuY3VycmVudEZvcm11bGFySWQ7XHJcbiAgICAgIHRoaXMucmVzdGZ1bFNlcnZpY2UucHV0KHJldHJpZXZlVXJpLCB7fSwge30sIG9wdGlvbnMpLnN1YnNjcmliZShkYXRhID0+IHtcclxuICAgICAgICBjb25zdCBmb3JtdWxhckRhdGEgPSBkYXRhLnJldHVyblZhbHVlO1xyXG4gICAgICAgIGlmIChmb3JtdWxhckRhdGEpIHtcclxuICAgICAgICAgIC8vIOWIneWni+WfuuehgOaVsOaNrlxyXG4gICAgICAgICAgdGhpcy5uYW1lID0gZm9ybXVsYXJEYXRhLm5hbWU7XHJcbiAgICAgICAgICB0aGlzLmRhdGEuY3VycmVudEZvcm11bGFyTmFtZSA9IGZvcm11bGFyRGF0YS5uYW1lO1xyXG4gICAgICAgICAgdGhpcy5pc0dyb3VwID0gZm9ybXVsYXJEYXRhLmlzR3JvdXA7XHJcbiAgICAgICAgICBjb25zdCBxdWVyeUZ1bmNJZCA9IGZvcm11bGFyRGF0YS5xdWVyeUZ1bmM7XHJcbiAgICAgICAgICB0aGlzLnR5cGUgPSBmb3JtdWxhckRhdGEuc3RyMTtcclxuICAgICAgICAgIHRoaXMubWV0YWRhdGFvYmplY3RpZCA9IGZvcm11bGFyRGF0YS5zdHIyO1xyXG4gICAgICAgICAgdGhpcy5mdW5jU2VsZWN0VmFsdWUgPSB0aGlzLmZ1bmNEYXRhLmZpbmQoeCA9PiB4LnZhbHVlID09PSBxdWVyeUZ1bmNJZCk7XHJcbiAgICAgICAgICB0aGlzLmVudGl0eURhdGFTZXJ2aWNlLnNldEZvcm11bGFyU3RhdGUodHJ1ZSwgeyBpZDogdGhpcy5jdXJyZW50Rm9ybXVsYXJJZCwgbmFtZTogdGhpcy5uYW1lIH0pO1xyXG4gICAgICAgICAgaWYgKHF1ZXJ5RnVuY0lkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZ2V0RHJvcERvd25JbmZvKHF1ZXJ5RnVuY0lkLCB0aGlzLnR5cGUsIHRoaXMubWV0YWRhdGFvYmplY3RpZCwgdHJ1ZSwgZm9ybXVsYXJEYXRhLnF1ZXJ5R2V0RGF0YVBhcmFtSW5mb3MpO1xyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICAgIC8vIGNvbnN0IGN1cnJlbnRRdWVyeUdldERhdGFQYXJhbXMgPSBmb3JtdWxhckRhdGEucXVlcnlHZXREYXRhUGFyYW1JbmZvcztcclxuICAgICAgICAgIGNvbnN0IHF1ZXJ5RnVuY1Jlc3VsdHMgPSBmb3JtdWxhckRhdGEucXVlcnlHZXREYXRhUmVzdWx0SW5mb3M7XHJcbiAgICAgICAgICAvLyBpZiAoY3VycmVudFF1ZXJ5R2V0RGF0YVBhcmFtcyAmJiBjdXJyZW50UXVlcnlHZXREYXRhUGFyYW1zLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgIC8vICAgY3VycmVudFF1ZXJ5R2V0RGF0YVBhcmFtcy5mb3JFYWNoKHF1ZXJ5R2V0RGF0YVBhcmFtID0+IHtcclxuICAgICAgICAgIC8vICAgICBjb25zdCBmaWVsZENvbmZpZyA9IEpTT04ucGFyc2UocXVlcnlHZXREYXRhUGFyYW0uZmllbGRDb25maWcpO1xyXG4gICAgICAgICAgLy8gICAgIGlmIChmaWVsZENvbmZpZy5jb250cm9sdHlwZSA9PT0gJ2Ryb3Bkb3duJykge1xyXG4gICAgICAgICAgLy8gICAgICAgZmllbGRDb25maWcuZW51bVZhbHVlcyA9IEpTT04ucGFyc2UoZmllbGRDb25maWcuZW51bVZhbHVlcyk7XHJcbiAgICAgICAgICAvLyAgICAgfVxyXG4gICAgICAgICAgLy8gICAgIHRoaXMuZHluYW1pY0lucHV0LnB1c2goeyBwYXJhbWNvZGU6IHF1ZXJ5R2V0RGF0YVBhcmFtLnBhcmFtQ29kZSwgcGFyYW1uYW1lOiBxdWVyeUdldERhdGFQYXJhbS5wYXJhbU5hbWUsIHBhcmFtdmFsdWU6IHF1ZXJ5R2V0RGF0YVBhcmFtLnBhcmFtVmFsdWUsIGZpZWxkQ29uZmlnOiBKU09OLnBhcnNlKHF1ZXJ5R2V0RGF0YVBhcmFtLmZpZWxkQ29uZmlnKSB9KTtcclxuICAgICAgICAgIC8vICAgfSk7XHJcbiAgICAgICAgICAvLyB9XHJcbiAgICAgICAgICBpZiAocXVlcnlGdW5jUmVzdWx0cyAmJiBxdWVyeUZ1bmNSZXN1bHRzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgY29uc3QgcmVzdWx0Q29sdW1ucyA9IFtdO1xyXG4gICAgICAgICAgICBjb25zdCBkYXRhID0gW107XHJcbiAgICAgICAgICAgIHF1ZXJ5RnVuY1Jlc3VsdHMuZm9yRWFjaChxdWVyeUZ1bmNSZXN1bHQgPT4ge1xyXG4gICAgICAgICAgICAgIHJlc3VsdENvbHVtbnMucHVzaCh7IGlkOiBxdWVyeUZ1bmNSZXN1bHQucmVzdWx0Q29kZSwgbGFiZWw6IHF1ZXJ5RnVuY1Jlc3VsdC5yZXN1bHROYW1lIH0pO1xyXG4gICAgICAgICAgICAgIGRhdGEucHVzaCh7IFxyXG4gICAgICAgICAgICAgICAgaWQ6IHF1ZXJ5RnVuY1Jlc3VsdC5pZCxcclxuICAgICAgICAgICAgICAgIHJlc3VsdGNvZGU6IHF1ZXJ5RnVuY1Jlc3VsdC5yZXN1bHRDb2RlLFxyXG4gICAgICAgICAgICAgICAgcmVzdWx0c29ydDogcXVlcnlGdW5jUmVzdWx0LnJlc3VsdFNvcnQsXHJcbiAgICAgICAgICAgICAgICByZXN1bHRuYW1lOiBxdWVyeUZ1bmNSZXN1bHQucmVzdWx0TmFtZSxcclxuICAgICAgICAgICAgICAgIHJlc3VsdGNvbHZpc2libGU6IHF1ZXJ5RnVuY1Jlc3VsdC5yZXN1bHRDb2xWaXNpYmxlID09PSB0cnVlID8gJzEnIDogJzAnLFxyXG4gICAgICAgICAgICAgICAgcmVzdWx0ZGVzY3JpcHRpb246ICcnXHJcbiAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB0aGlzLnJlc3VsdENvbHVtbnMgPSBbLi4ucmVzdWx0Q29sdW1uc107XHJcbiAgICAgICAgICAgIHRoaXMucmVzdWx0RGF0YXMgPSBbLi4uZGF0YV07XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGdlbmVyYXRlRm9ybXVsYXIoKSB7XHJcbiAgICBpZiAoIXRoaXMubmFtZSkge1xyXG4gICAgICB0aGlzLm1zZ1NlcnZpY2UuaW5mbyh0aGlzLmxvY2FsaXplU2VydmljZS5nZXRWYWx1ZSgnZm9ybXVsYXIuZGVmaW5lLm1lc3NhZ2VBbGVydC5uYW1lVmVyaWZ5JykpO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBpZiAoIXRoaXMuZnVuY1NlbGVjdFZhbHVlKSB7XHJcbiAgICAgIHRoaXMubXNnU2VydmljZS5pbmZvKHRoaXMubG9jYWxpemVTZXJ2aWNlLmdldFZhbHVlKCdmb3JtdWxhci5kZWZpbmUubWVzc2FnZUFsZXJ0LmZ1bmNWZXJpZnknKSk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGNvbnN0IGZvcm11bGFySW5mbzogYW55ID0ge1xyXG4gICAgICBpZDogdGhpcy5jdXJyZW50Rm9ybXVsYXJJZCxcclxuICAgICAgY3Vyc3U6IHRoaXMuZGF0YS5jdXJyZW50U1UsXHJcbiAgICAgIGlzZ3JvdXA6IHRoaXMuaXNHcm91cCA/IDEgOiAwLFxyXG4gICAgICBuYW1lOiB0aGlzLm5hbWUsXHJcbiAgICAgIHF1ZXJ5ZnVuYzogdGhpcy5mdW5jU2VsZWN0VmFsdWUudmFsdWUsXHJcbiAgICAgIHN0cjE6IHRoaXMudHlwZSxcclxuICAgICAgc3RyMjogdGhpcy5tZXRhZGF0YW9iamVjdGlkLFxyXG4gICAgICBzdHIzOiB0aGlzLnFvbWFuYWdlcmNvZGUgPyB0aGlzLnFvbWFuYWdlcmNvZGUgOiAnJyxcclxuICAgICAgc3RyNDogdGhpcy5mdW5jU2VsZWN0VmFsdWUubmFtZSxcclxuICAgICAgc3RyNTogJycsXHJcbiAgICAgIHN0cjY6ICcnLFxyXG4gICAgICBmb3JtdWxhclBhcmFtSW5mb3M6IHRoaXMuZHluYW1pY0lucHV0LFxyXG4gICAgICBmb3JtdWxhclJlc3VsdEluZm9zOiB0aGlzLnJlc3VsdERhdGFzXHJcbiAgICB9O1xyXG4gICAgY29uc3Qgb3B0aW9ucyA9IHtcclxuICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgICdTZXNzaW9uSWQnOiB0aGlzLmRhdGEuc2Vzc2lvbklkLFxyXG4gICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcclxuICAgICAgfVxyXG4gICAgfTtcclxuICAgIGlmIChmb3JtdWxhckluZm8pIHtcclxuICAgICAgY29uc3QgcmV0cmlldmVVcmkgPSB0aGlzLmRhdGEuc2VydmVySG9zdCArICcvYXBpL2dzcC9iY2MvdjEuMC9xdWVyeWdldGRhdGFkZXRhaWxfZnJtL3NlcnZpY2Uvc2F2ZXFkcGZvcm11bGFyJztcclxuICAgICAgdGhpcy5yZXN0ZnVsU2VydmljZS5wdXQocmV0cmlldmVVcmksIHsgZm9ybXVsYXJJbmZvOiBKU09OLnN0cmluZ2lmeShmb3JtdWxhckluZm8pIH0sIHt9LCBvcHRpb25zKS5zdWJzY3JpYmUoZGF0YSA9PiB7XHJcbiAgICAgICAgY29uc3QgZm9ybXVsYXJEYXRhID0gZGF0YS5yZXR1cm5WYWx1ZTtcclxuICAgICAgICBpZiAoZm9ybXVsYXJEYXRhKSB7XHJcbiAgICAgICAgICB0aGlzLmN1cnJlbnRGb3JtdWxhcklkID0gZm9ybXVsYXJEYXRhO1xyXG4gICAgICAgICAgdGhpcy5lbnRpdHlEYXRhU2VydmljZS5zZXRGb3JtdWxhclN0YXRlKHRydWUsIHsgaWQ6IHRoaXMuY3VycmVudEZvcm11bGFySWQsIG5hbWU6IHRoaXMubmFtZSB9KTtcclxuICAgICAgICAgIC8vIHRoaXMuZW50aXR5RGF0YVNlcnZpY2UuaXNGaW5pc2ggPSB0cnVlO1xyXG4gICAgICAgICAgdGhpcy5tc2dTZXJ2aWNlLmluZm8odGhpcy5sb2NhbGl6ZVNlcnZpY2UuZ2V0VmFsdWUoJ2Zvcm11bGFyLmRlZmluZS5tZXNzYWdlQWxlcnQuc2F2ZUZvcm11bGFyJykpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBnZW5lcmF0ZUZvcm11bGFySW5mbygpIHtcclxuICAgIGlmICghdGhpcy5jdXJyZW50RnVuY3Rpb25JZCkge1xyXG4gICAgICB0aGlzLm1zZ1NlcnZpY2UuaW5mbyh0aGlzLmxvY2FsaXplU2VydmljZS5nZXRWYWx1ZSgnZm9ybXVsYXIuZGVmaW5lLm1lc3NhZ2VBbGVydC5wbGVhc2VTZWxlY3RRdWVyeUZ1bmMnKSk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGlmICh0aGlzLnJlc3VsdERhdGFzICYmIHRoaXMucmVzdWx0RGF0YXMuZmlsdGVyKHggPT4geC5yZXN1bHRjb2x2aXNpYmxlID09PSAnMScpLmxlbmd0aCAhPT0gMSkge1xyXG4gICAgICB0aGlzLm1zZ1NlcnZpY2UuaW5mbyh0aGlzLmxvY2FsaXplU2VydmljZS5nZXRWYWx1ZSgnZm9ybXVsYXIuZGVmaW5lLm1lc3NhZ2VBbGVydC5yZXN1bHRWZXJpZnknKSk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGNvbnN0IHBhcmFtSW5mbyA9IFtdO1xyXG4gICAgdGhpcy5keW5hbWljSW5wdXQuZm9yRWFjaCh4ID0+IHtcclxuICAgICAgcGFyYW1JbmZvLnB1c2goeyBrZXk6IHgucGFyYW1jb2RlLCB2YWx1ZTogeC5wYXJhbXZhbHVlID8geC5wYXJhbXZhbHVlIDogJycgfSk7XHJcbiAgICB9KTtcclxuICAgIGNvbnN0IGZvcm11bGFyY29tcGlsZSA9IHtcclxuICAgICAgZnVuY0lkOiB0aGlzLmN1cnJlbnRGdW5jdGlvbklkLFxyXG4gICAgICBwYXJhbUluZm9zOiBwYXJhbUluZm8sXHJcbiAgICAgIHJlc3VsdENvbE5hbWU6IHRoaXMucmVzdWx0RGF0YXNbMF0ucmVzdWx0Y29kZSxcclxuICAgICAgcW9tYW5hZ2VyY29kZTogdGhpcy5xb21hbmFnZXJjb2RlLFxyXG4gICAgICBpc2dyb3VwOiB0aGlzLmlzR3JvdXAgPyAxIDogMFxyXG4gICAgfTtcclxuICAgIHRoaXMuZm9ybXVsYXJUZXh0ID0gdGhpcy5mb3JtdWxhclRleHQgKyAnUURQRm9ybXVsYXIuZXhlY3V0ZSgnICsgSlNPTi5zdHJpbmdpZnkoZm9ybXVsYXJjb21waWxlKSArICcpICc7XHJcbiAgfVxyXG5cclxuICBvcGVyYXRvcigkZXZlbnQpIHtcclxuICAgIHRoaXMuZm9ybXVsYXJUZXh0ID0gdGhpcy5mb3JtdWxhclRleHQgKyAkZXZlbnQ7XHJcbiAgfVxyXG5cclxuICBvblJlc2l6ZWQoZXZlbnQpIHtcclxuICAgIHRoaXMuc2l6ZS5oZWlnaHQgPSBldmVudC5uZXdIZWlnaHQ7XHJcbiAgICB0aGlzLnNpemUud2lkdGggPSBldmVudC5uZXdXaWR0aDtcclxuICB9XHJcblxyXG4gIHNlbGVjdGlvbkNoYW5nZSgkZXZlbnQpIHtcclxuICAgIC8vIOa4heepuuWOhuWPsuaVsOaNrlxyXG4gICAgdGhpcy5keW5hbWljSW5wdXQgPSBbXTtcclxuICAgIHRoaXMucmVzdWx0Q29sdW1ucyA9IFtdO1xyXG4gICAgdGhpcy5yZXN1bHREYXRhcyA9IFtdO1xyXG4gICAgdGhpcy5uYW1lID0gdGhpcy5mb3JtdWxhclR5cGUgPT09IDEgPyB0aGlzLm5hbWUgOiAnJztcclxuICAgIHRoaXMuaXNHcm91cCA9IDA7XHJcbiAgICBpZiAoJGV2ZW50ICYmICRldmVudC52YWx1ZSkge1xyXG4gICAgICB0aGlzLmN1cnJlbnRGdW5jdGlvbklkID0gJGV2ZW50LnZhbHVlO1xyXG4gICAgICBjb25zdCBmdW5jRGF0YSA9IHRoaXMuY3VycmVudEZ1bmNEYXRhcy5maW5kKHggPT4geC5pZCA9PT0gdGhpcy5jdXJyZW50RnVuY3Rpb25JZCk7XHJcbiAgICAgIHRoaXMubmFtZSA9IHRoaXMubmFtZSA9PT0gJycgPyBmdW5jRGF0YS5uYW1lIDogdGhpcy5uYW1lO1xyXG4gICAgICAvLyDkv53lrZjlhazlvI/nsbvlnovlj4rlhYPmlbDmja5pZFxyXG4gICAgICB0aGlzLnR5cGUgPSBmdW5jRGF0YS5zcmNUeXBlO1xyXG4gICAgICB0aGlzLm1ldGFkYXRhb2JqZWN0aWQgPSBmdW5jRGF0YS5tZXRhZGF0YU9iamVjdDtcclxuICAgICAgaWYgKHRoaXMuY3VycmVudEZ1bmN0aW9uSWQpIHtcclxuICAgICAgICB0aGlzLmdldERyb3BEb3duSW5mbyh0aGlzLmN1cnJlbnRGdW5jdGlvbklkLCB0aGlzLnR5cGUsIHRoaXMubWV0YWRhdGFvYmplY3RpZCwgdHJ1ZSwgJycpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyDliJ3lp4vkuIvmi4nkv6Hmga9cclxuICBnZXREcm9wRG93bkluZm8oZnVuY2lkOiBhbnksIHR5cGU6IGFueSwgbWV0YWRhdGFvYmplY3RpZDogYW55LCBnZW5lcmF0ZURhdGE6IGFueSwgcXVlcnlGb3JtdWxhclBhcmFtOiBhbnkpIHtcclxuICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xyXG4gICAgLy8g6K6/6Zeu5pWw5o2u5pyN5YqhXHJcbiAgICBjb25zdCBvcHRpb25zID0ge1xyXG4gICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgJ1Nlc3Npb25JZCc6IHNlbGYuZGF0YS5zZXNzaW9uSWQsXHJcbiAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xyXG4gICAgICB9XHJcbiAgICB9O1xyXG4gICAgY29uc3QgdXJsID0gc2VsZi5kYXRhLnNlcnZlckhvc3QgKyAnL2FwaS9nc3AvYmNjL3YxLjAvcXVlcnlmdW5jZGV0YWlsX2ZybS9leHRlbnNpb24vcmV0cmlldmUvJyArIGZ1bmNpZDtcclxuICAgIHNlbGYucmVzdGZ1bFNlcnZpY2UucHV0KHVybCwge30sIHt9LCBvcHRpb25zKS50b1Byb21pc2UoKS50aGVuKGZ1bmN0aW9uICh2YWx1ZSkge1xyXG4gICAgICBpZiAodmFsdWUpIHtcclxuICAgICAgICB2YWx1ZSA9IHZhbHVlLnJldHVyblZhbHVlO1xyXG4gICAgICAgIC8vIOafpeivouWPguaVsFxyXG4gICAgICAgIGlmIChnZW5lcmF0ZURhdGEpIHtcclxuICAgICAgICAgIGxldCBxdWVyeUZ1bmNQYXJhbXMgPSB2YWx1ZS5xdWVyeUZ1bmNQYXJhbXM7XHJcbiAgICAgICAgICBpZiAocXVlcnlGdW5jUGFyYW1zLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgLy8gaWYgKGN1cnJlbnRRdWVyeUdldERhdGFQYXJhbXMgJiYgY3VycmVudFF1ZXJ5R2V0RGF0YVBhcmFtcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIC8vICAgY3VycmVudFF1ZXJ5R2V0RGF0YVBhcmFtcy5mb3JFYWNoKHF1ZXJ5R2V0RGF0YVBhcmFtID0+IHtcclxuICAgICAgICAgICAgLy8gICAgIGNvbnN0IGZpZWxkQ29uZmlnID0gSlNPTi5wYXJzZShxdWVyeUdldERhdGFQYXJhbS5maWVsZENvbmZpZyk7XHJcbiAgICAgICAgICAgIC8vICAgICBpZiAoZmllbGRDb25maWcuY29udHJvbHR5cGUgPT09ICdkcm9wZG93bicpIHtcclxuICAgICAgICAgICAgLy8gICAgICAgZmllbGRDb25maWcuZW51bVZhbHVlcyA9IEpTT04ucGFyc2UoZmllbGRDb25maWcuZW51bVZhbHVlcyk7XHJcbiAgICAgICAgICAgIC8vICAgICB9XHJcbiAgICAgICAgICAgIC8vICAgICB0aGlzLmR5bmFtaWNJbnB1dC5wdXNoKHsgcGFyYW1jb2RlOiBxdWVyeUdldERhdGFQYXJhbS5wYXJhbUNvZGUsIHBhcmFtbmFtZTogcXVlcnlHZXREYXRhUGFyYW0ucGFyYW1OYW1lLCBwYXJhbXZhbHVlOiBxdWVyeUdldERhdGFQYXJhbS5wYXJhbVZhbHVlLCBmaWVsZENvbmZpZzogSlNPTi5wYXJzZShxdWVyeUdldERhdGFQYXJhbS5maWVsZENvbmZpZykgfSk7XHJcbiAgICAgICAgICAgIC8vICAgfSk7XHJcbiAgICAgICAgICAgIC8vIH1cclxuICAgICAgICAgICAgcXVlcnlGdW5jUGFyYW1zID0gcXVlcnlGdW5jUGFyYW1zLnNvcnQoc2VsZi5zb3J0RGF0YSk7XHJcbiAgICAgICAgICAgIHF1ZXJ5RnVuY1BhcmFtcy5mb3JFYWNoKGZ1bmNQYXJhbSA9PiB7XHJcbiAgICAgICAgICAgICAgaWYgKGZ1bmNQYXJhbSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZmllbGRDb25maWcgPSBKU09OLnBhcnNlKGZ1bmNQYXJhbS5maWVsZENvbmZpZyk7XHJcbiAgICAgICAgICAgICAgICBpZiAoZmllbGRDb25maWcuY29udHJvbHR5cGUgPT09ICdkcm9wZG93bicpIHtcclxuICAgICAgICAgICAgICAgICAgZmllbGRDb25maWcuZW51bVZhbHVlcyA9IGZpZWxkQ29uZmlnLmVudW1WYWx1ZXM7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBsZXQgZmluZFBhcmFtSW5mbztcclxuICAgICAgICAgICAgICAgIGlmIChxdWVyeUZvcm11bGFyUGFyYW0gJiYgcXVlcnlGb3JtdWxhclBhcmFtLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgZmluZFBhcmFtSW5mbyA9IHF1ZXJ5Rm9ybXVsYXJQYXJhbS5maW5kKHggPT4geC5wYXJhbUNvZGUgPT09IGZ1bmNQYXJhbS5jb2RlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGxldCBwYXJhbXZhbHVlID0gKGZpbmRQYXJhbUluZm8gJiYgZmluZFBhcmFtSW5mby5wYXJhbVZhbHVlKSA/IGZpbmRQYXJhbUluZm8ucGFyYW1WYWx1ZSA6ICcnO1xyXG4gICAgICAgICAgICAgICAgZmllbGRDb25maWcucGFyYW12YWx1ZW5hbWUgPSAnJztcclxuICAgICAgICAgICAgICAgIGlmIChmaWVsZENvbmZpZy5jb250cm9sdHlwZSA9PT0gJ2hlbHAnICYmIGZpbmRQYXJhbUluZm8pIHtcclxuICAgICAgICAgICAgICAgICAgY29uc3QgcGFyYW12YWx1ZWFycmF5ID0gcGFyYW12YWx1ZS5zcGxpdCgnfCcpO1xyXG4gICAgICAgICAgICAgICAgICBwYXJhbXZhbHVlID0gcGFyYW12YWx1ZWFycmF5WzBdO1xyXG4gICAgICAgICAgICAgICAgICBmaWVsZENvbmZpZy5wYXJhbXZhbHVlbmFtZSA9IHBhcmFtdmFsdWVhcnJheVsxXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHNlbGYuZHluYW1pY0lucHV0LnB1c2goeyBpZDogZmluZFBhcmFtSW5mbyA/IGZpbmRQYXJhbUluZm8uaWQgOiAnJywgcGFyYW1jb2RlOiBmdW5jUGFyYW0uY29kZSwgcGFyYW1uYW1lOiBmdW5jUGFyYW0ubmFtZSwgcGFyYW12YWx1ZTogcGFyYW12YWx1ZSwgZmllbGRDb25maWc6IGZpZWxkQ29uZmlnIH0pO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoZ2VuZXJhdGVEYXRhKSB7IC8vIOaWsOW7uuaIluiAhee7hOWQiOWFrOW8j+iwg+eUqOatpOmAu+i+kVxyXG4gICAgICAgICAgc2VsZi5yZXN1bHRDb2x1bW5zID0gW107XHJcbiAgICAgICAgICBpZiAodHlwZSA9PT0gJ0JFJykge1xyXG4gICAgICAgICAgICBjb25zdCBxdWVyeUZ1bmNSZXN1bHRzID0gdmFsdWUucXVlcnlGdW5jUmVzdWx0cztcclxuICAgICAgICAgICAgaWYgKHF1ZXJ5RnVuY1Jlc3VsdHMubGVuZ3RoID4gMCkge1xyXG5cclxuICAgICAgICAgICAgICBjb25zdCBmdW5jUmVzdWx0RGF0YXMgPSBbXTtcclxuICAgICAgICAgICAgICBxdWVyeUZ1bmNSZXN1bHRzLmZvckVhY2goZnVuY1Jlc3VsdCA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZnVuY1Jlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgICAvLyBzZWxmLnJlc3VsdENvbHVtbnMucHVzaCh7IGlkOiBmdW5jUmVzdWx0LnNyY0NvbCwgbGFiZWw6IGZ1bmNSZXN1bHQuY29sTmFtZSB9KTtcclxuICAgICAgICAgICAgICAgICAgZnVuY1Jlc3VsdERhdGFzLnB1c2goeyBpZDogc2VsZi5ndWlkKCksIHJlc3VsdGNvZGU6IGZ1bmNSZXN1bHQuc3JjQ29sLCByZXN1bHRzb3J0OiAnMCcsIHJlc3VsdG5hbWU6IGZ1bmNSZXN1bHQuY29sTmFtZSxcclxuICAgICAgICAgICAgICAgICAgIHJlc3VsdGNvbHZpc2libGU6ICcxJywgcmVzdWx0ZGVzY3JpcHRpb246IGZ1bmNSZXN1bHQuZGVzY3JpcHRpb24gfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgIGlmIChmdW5jUmVzdWx0RGF0YXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHNlbGYucmVzdWx0RGF0YXMgJiYgc2VsZi5yZXN1bHREYXRhcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgIGxldCBuZXdSZXN1bHREYXRhcyA9IFtdO1xyXG4gICAgICAgICAgICAgICAgICBmb3IgKGxldCBmdW5jUmVzdWx0RGF0YSBvZiBmdW5jUmVzdWx0RGF0YXMpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCByZXN1bHREYXRhID0gc2VsZi5yZXN1bHREYXRhcy5maW5kKHggPT4geC5yZXN1bHRjb2RlID09PSBmdW5jUmVzdWx0RGF0YS5yZXN1bHRjb2RlKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0RGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgbmV3UmVzdWx0RGF0YXMucHVzaCh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC4uLnJlc3VsdERhdGEsIHJlc3VsdGRlc2NyaXB0aW9uOiBmdW5jUmVzdWx0RGF0YS5yZXN1bHRkZXNjcmlwdGlvblxyXG4gICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgbmV3UmVzdWx0RGF0YXMucHVzaChmdW5jUmVzdWx0RGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICBsZXQgcmVzdWx0Q29sdW1uczEgPSBbXTtcclxuICAgICAgICAgICAgICAgICAgbmV3UmVzdWx0RGF0YXMuZm9yRWFjaChtID0+IHtcclxuICAgICAgICAgICAgICAgICAgICByZXN1bHRDb2x1bW5zMS5wdXNoKHsgaWQ6IG0ucmVzdWx0Y29kZSwgbGFiZWw6IG0ucmVzdWx0bmFtZSB9KTtcclxuICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgIHNlbGYucmVzdWx0Q29sdW1ucyA9IFsuLi5yZXN1bHRDb2x1bW5zMV07XHJcblxyXG4gICAgICAgICAgICAgICAgICBzZWxmLnJlc3VsdERhdGFzID0gWy4uLm5ld1Jlc3VsdERhdGFzXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICBsZXQgcmVzdWx0Q29sdW1uczEgPSBbXTtcclxuICAgICAgICAgICAgICAgICAgZnVuY1Jlc3VsdERhdGFzLmZvckVhY2gobSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0Q29sdW1uczEucHVzaCh7IGlkOiBtLnJlc3VsdGNvZGUsIGxhYmVsOiBtLnJlc3VsdG5hbWUgfSk7XHJcbiAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICBzZWxmLnJlc3VsdENvbHVtbnMgPSBbLi4ucmVzdWx0Q29sdW1uczFdO1xyXG5cclxuICAgICAgICAgICAgICAgICAgc2VsZi5yZXN1bHREYXRhcyA9IFsuLi5mdW5jUmVzdWx0RGF0YXNdO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIC8vIHNlbGYucmVzdWx0RGF0YXMgPSBbLi4uZnVuY1Jlc3VsdERhdGFzXTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnN0IG9wdGlvbnMgPSB7XHJcbiAgICAgICAgICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgICAgICAgICAgJ1Nlc3Npb25JZCc6IHNlbGYuZGF0YS5zZXNzaW9uSWQsXHJcbiAgICAgICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAvLyDmoLnmja5pZOiOt+WPluWFg+aVsOaNruS/oeaBr1xyXG4gICAgICAgICAgICBzZWxmLnJlc3RmdWxTZXJ2aWNlLmdldChzZWxmLmRhdGEuc2VydmVySG9zdCArICcvYXBpL3J1bnRpbWUvc3lzL3YxLjAvcnQtbWV0YWRhdGFzLycgKyBtZXRhZGF0YW9iamVjdGlkLCB7fSwgb3B0aW9ucykuc3Vic2NyaWJlKG1ldGFkYXRhQ29udGVudCA9PiB7XHJcbiAgICAgICAgICAgICAgaWYgKG1ldGFkYXRhQ29udGVudCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgY3VycmVudE1ldGFkYXRhQ29udGVudCA9IEpTT04ucGFyc2UobWV0YWRhdGFDb250ZW50Wydjb250ZW50J10pO1xyXG4gICAgICAgICAgICAgICAgbGV0IG1haW5PYmplY3QgPSBjdXJyZW50TWV0YWRhdGFDb250ZW50LlF1ZXJ5Tm9kZTtcclxuICAgICAgICAgICAgICAgIGlmICghbWFpbk9iamVjdCkgeyBtYWluT2JqZWN0ID0gY3VycmVudE1ldGFkYXRhQ29udGVudC5EYXRhU291cmNlc1snMCddLlF1ZXJ5Tm9kZTsgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgZGF0YXMgPSBbXTtcclxuICAgICAgICAgICAgICAgIG1haW5PYmplY3QuQ29udGFpbkVsZW1lbnRzLmZvckVhY2goY29udGFpbkVsZW1lbnQgPT4ge1xyXG4gICAgICAgICAgICAgICAgICBzZWxmLnJlc3VsdENvbHVtbnMucHVzaCh7IGlkOiBjb250YWluRWxlbWVudC5Db2RlLCBsYWJlbDogY29udGFpbkVsZW1lbnQuTmFtZSB9KTtcclxuICAgICAgICAgICAgICAgICAgZGF0YXMucHVzaCh7IGlkOiBzZWxmLmd1aWQoKSwgcmVzdWx0Y29kZTogY29udGFpbkVsZW1lbnQuQ29kZSwgcmVzdWx0c29ydDogJzAnLCByZXN1bHRuYW1lOiBjb250YWluRWxlbWVudC5OYW1lLCByZXN1bHRjb2x2aXNpYmxlOiAnMScsIHJlc3VsdGRlc2NyaXB0aW9uOiAnJyB9KTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgaWYgKGRhdGFzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgc2VsZi5yZXN1bHREYXRhcyA9IFsuLi5kYXRhc107XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBzZWxmLnFvbWFuYWdlcmNvZGUgPSAnY29tLicgKyAoY3VycmVudE1ldGFkYXRhQ29udGVudC5OYW1lc3BhY2VQcmVmaXggKyAnLicgKyBjdXJyZW50TWV0YWRhdGFDb250ZW50LkNvZGUpLnRvTG93ZXJDYXNlKCk7IC8vIHFv57yW5Y+3XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgc29ydERhdGEoYSwgYikge1xyXG4gICAgcmV0dXJuICBhLm9yZGVyTnVtYmVyIC0gYi5vcmRlck51bWJlcjtcclxuICB9XHJcblxyXG4gIGNsaWNrTGFzdFN0ZXAgPSAoKSA9PiB7XHJcbiAgICB0aGlzLmNhY2hlU2VydmljZS5zZXQoJ2Zvcm11bGFyUGFyYW0nLCB0aGlzLmRhdGEpO1xyXG4gICAgcmV0dXJuIHRydWU7XHJcbiAgfVxyXG5cclxuICBiZWZvcmVGaW5pc2ggPSAoKSA9PiB7XHJcbiAgICBjb25zdCBmbGFnJCA9IG5ldyBTdWJqZWN0KCk7XHJcbiAgICBpZiAodGhpcy5mb3JtdWxhclR5cGUgPT09IDEpIHsgLy8g57uE5ZCI5YWs5byP5L+d5a2YXHJcbiAgICAgIGlmICghdGhpcy5uYW1lKSB7XHJcbiAgICAgICAgdGhpcy5tc2dTZXJ2aWNlLmluZm8odGhpcy5sb2NhbGl6ZVNlcnZpY2UuZ2V0VmFsdWUoJ2Zvcm11bGFyLmRlZmluZS5tZXNzYWdlQWxlcnQubmFtZVZlcmlmeScpKTtcclxuICAgICAgfVxyXG4gICAgICBpZiAoIXRoaXMuZm9ybXVsYXJUZXh0KSB7XHJcbiAgICAgICAgdGhpcy5tc2dTZXJ2aWNlLmluZm8odGhpcy5sb2NhbGl6ZVNlcnZpY2UuZ2V0VmFsdWUoJ2Zvcm11bGFyLmRlZmluZS5tZXNzYWdlQWxlcnQuY29tYmluZVZlcmlmeScpKTtcclxuICAgICAgfSBlbHNlIGlmICh0aGlzLmZvcm11bGFyVGV4dCAmJiAhdGhpcy5mb3JtdWxhckNoZWNrKHRoaXMuZm9ybXVsYXJUZXh0KSkge1xyXG4gICAgICAgIHRoaXMubXNnU2VydmljZS5pbmZvKHRoaXMubG9jYWxpemVTZXJ2aWNlLmdldFZhbHVlKCdmb3JtdWxhci5kZWZpbmUubWVzc2FnZUFsZXJ0LmZvcm11bGFySW50ZWdyaXR5VmVyaWZ5JykpO1xyXG4gICAgICB9XHJcbiAgICAgIGNvbnN0IGZvcm11bGFySW5mbzogYW55ID0ge1xyXG4gICAgICAgIGlkOiB0aGlzLmN1cnJlbnRGb3JtdWxhcklkLFxyXG4gICAgICAgIGlzZ3JvdXA6IHRoaXMuaXNHcm91cCA/IDEgOiAwLFxyXG4gICAgICAgIG5hbWU6IHRoaXMubmFtZSxcclxuICAgICAgICBxdWVyeWZ1bmM6ICcnLFxyXG4gICAgICAgIHN0cjE6ICcnLFxyXG4gICAgICAgIHN0cjI6ICcnLFxyXG4gICAgICAgIHN0cjM6ICcnLFxyXG4gICAgICAgIHN0cjQ6ICcnLFxyXG4gICAgICAgIGN1cnN1OiB0aGlzLmRhdGEuY3VycmVudFNVLFxyXG4gICAgICAgIHN0cjU6IHRoaXMuZGF0YS5mb3JtdWxhclJlZ2lvbiA/IHRoaXMuZGF0YS5mb3JtdWxhclJlZ2lvbiA6ICdwdWJsaXNoJyxcclxuICAgICAgICBzdHI2OiB0aGlzLmZvcm11bGFyVGV4dCxcclxuICAgICAgICBudW0xOiAxLCAvLyDku6Pooajnu4TlkIjlhazlvI9cclxuICAgICAgfTtcclxuICAgICAgY29uc3Qgb3B0aW9ucyA9IHtcclxuICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICAnU2Vzc2lvbklkJzogdGhpcy5kYXRhLnNlc3Npb25JZCxcclxuICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcclxuICAgICAgICB9XHJcbiAgICAgIH07XHJcbiAgICAgIGlmIChmb3JtdWxhckluZm8pIHtcclxuICAgICAgICBjb25zdCByZXRyaWV2ZVVyaSA9IHRoaXMuZGF0YS5zZXJ2ZXJIb3N0ICsgJy9hcGkvZ3NwL2JjYy92MS4wL3F1ZXJ5Z2V0ZGF0YWRldGFpbF9mcm0vc2VydmljZS9zYXZlcWRwZm9ybXVsYXInO1xyXG4gICAgICAgIHRoaXMucmVzdGZ1bFNlcnZpY2UucHV0KHJldHJpZXZlVXJpLCB7IGZvcm11bGFySW5mbzogSlNPTi5zdHJpbmdpZnkoZm9ybXVsYXJJbmZvKSB9LCB7fSwgb3B0aW9ucykuc3Vic2NyaWJlKGRhdGEgPT4ge1xyXG4gICAgICAgICAgY29uc3QgZm9ybXVsYXJEYXRhID0gZGF0YS5yZXR1cm5WYWx1ZTtcclxuICAgICAgICAgIGlmIChmb3JtdWxhckRhdGEpIHtcclxuICAgICAgICAgICAgdGhpcy5jdXJyZW50Rm9ybXVsYXJJZCA9IGZvcm11bGFyRGF0YTtcclxuICAgICAgICAgICAgdGhpcy5lbnRpdHlEYXRhU2VydmljZS5zZXRGb3JtdWxhclN0YXRlKHRydWUsIHsgaWQ6IHRoaXMuY3VycmVudEZvcm11bGFySWQsIG5hbWU6IHRoaXMubmFtZSB9KTtcclxuICAgICAgICAgICAgLy90aGlzLmNhY2hlU2VydmljZS5zZXQoJ2Zvcm11bGFyUmVzdWx0JywgeyBpZDogdGhpcy5jdXJyZW50Rm9ybXVsYXJJZCwgbmFtZTogJ+WFrOW8jycgfSk7XHJcbiAgICAgICAgICAgIGZsYWckLm5leHQodHJ1ZSk7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmVudGl0eURhdGFTZXJ2aWNlLnNldEZvcm11bGFyU3RhdGUoZmFsc2UsIHt9KTtcclxuICAgICAgICAgICAgdGhpcy5tc2dTZXJ2aWNlLmVycm9yKHRoaXMubG9jYWxpemVTZXJ2aWNlLmdldFZhbHVlKCdmb3JtdWxhci5kZWZpbmUubWVzc2FnZUFsZXJ0LnNhdmVGb3JtdWxhckZhaWx1cmUnKSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgIH0gZWxzZSBpZiAoIXRoaXMuY3VycmVudEZvcm11bGFySWQpIHtcclxuICAgICAgdGhpcy5lbnRpdHlEYXRhU2VydmljZS5zZXRGb3JtdWxhclN0YXRlKGZhbHNlLCB7fSk7XHJcbiAgICAgIHRoaXMubXNnU2VydmljZS5pbmZvKHRoaXMubG9jYWxpemVTZXJ2aWNlLmdldFZhbHVlKCdmb3JtdWxhci5kZWZpbmUubWVzc2FnZUFsZXJ0LmZvcm11bGFyU2F2ZVZlcmlmeScpKTtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5lbnRpdHlEYXRhU2VydmljZS5zZXRGb3JtdWxhclN0YXRlKHRydWUsIHsgaWQ6IHRoaXMuY3VycmVudEZvcm11bGFySWQsIG5hbWU6IHRoaXMubmFtZSB9KTtcclxuICAgICAgLy90aGlzLmNhY2hlU2VydmljZS5zZXQoJ2Zvcm11bGFyUmVzdWx0JywgeyBpZDogdGhpcy5jdXJyZW50Rm9ybXVsYXJJZCwgbmFtZTogdGhpcy5uYW1lID8gdGhpcy5uYW1lIDogJ+WFrOW8jycgfSk7XHJcbiAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGZsYWckO1xyXG4gIH1cclxuXHJcbiAgZm9ybXVsYXJDaGVjayhzdHJpbmcpIHtcclxuICAgIC8vIOWJlOmZpOepuueZveesplxyXG4gICAgc3RyaW5nID0gc3RyaW5nLnJlcGxhY2UoL1xccy9nLCAnJyk7XHJcblxyXG4gICAgLy8g6ZSZ6K+v5oOF5Ya177yM56m65a2X56ym5LiyXHJcbiAgICBpZiAoJycgPT09IHN0cmluZykge1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgLy8g6ZSZ6K+v5oOF5Ya177yM6L+Q566X56ym6L+e57utXHJcbiAgICBpZiAoL1tcXCtcXC1cXCpcXC9dezIsfS8udGVzdChzdHJpbmcpKSB7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICAvLyDnqbrmi6zlj7dcclxuICAgIGlmICgvXFwoXFwpLy50ZXN0KHN0cmluZykpIHtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIOmUmeivr+aDheWGte+8jOaLrOWPt+S4jemFjeWvuVxyXG4gICAgdmFyIHN0YWNrID0gW107XHJcbiAgICBmb3IgKHZhciBpID0gMCwgaXRlbTsgaSA8IHN0cmluZy5sZW5ndGg7IGkrKykge1xyXG4gICAgICBpdGVtID0gc3RyaW5nLmNoYXJBdChpKTtcclxuICAgICAgaWYgKCcoJyA9PT0gaXRlbSkge1xyXG4gICAgICAgIHN0YWNrLnB1c2goJygnKTtcclxuICAgICAgfSBlbHNlIGlmICgnKScgPT09IGl0ZW0pIHtcclxuICAgICAgICBpZiAoc3RhY2subGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgc3RhY2sucG9wKCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIGlmICgwICE9PSBzdGFjay5sZW5ndGgpIHtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIOmUmeivr+aDheWGte+8jCjlkI7pnaLmmK/ov5DnrpfnrKYgXHJcbiAgICBpZiAoL1xcKFtcXCtcXC1cXCpcXC9dLy50ZXN0KHN0cmluZykpIHtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIOmUmeivr+aDheWGte+8jCnliY3pnaLmmK/ov5DnrpfnrKZcclxuICAgIGlmICgvW1xcK1xcLVxcKlxcL11cXCkvLnRlc3Qoc3RyaW5nKSkge1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gLy8g6ZSZ6K+v5oOF5Ya177yMKOWJjemdouS4jeaYr+i/kOeul+esplxyXG4gICAgLy8gaWYgKC9bXlxcK1xcLVxcKlxcL11cXCgvLnRlc3Qoc3RyaW5nKSkge1xyXG4gICAgLy8gICByZXR1cm4gZmFsc2U7XHJcbiAgICAvLyB9XHJcblxyXG4gICAgLy8gLy8g6ZSZ6K+v5oOF5Ya177yMKeWQjumdouS4jeaYr+i/kOeul+esplxyXG4gICAgLy8gaWYgKC9cXClbXlxcK1xcLVxcKlxcL10vLnRlc3Qoc3RyaW5nKSkge1xyXG4gICAgLy8gICByZXR1cm4gZmFsc2U7XHJcbiAgICAvLyB9XHJcblxyXG4gICAgcmV0dXJuIHRydWU7XHJcbiAgfVxyXG5cclxufSJdfQ==