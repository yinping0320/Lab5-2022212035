/**
 * @fileoverview added by tsickle
 * Generated from: lib/component/formular-define/formular-define.component.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, ViewChild, TemplateRef } from '@angular/core';
import { of, Subject } from 'rxjs';
import { MessagerService } from '@farris/ui-messager';
import { CacheService } from '@ecp-caf/caf-common';
import { RestfulService } from '../../service/restful.service';
import { DatagridComponent } from '@farris/ui-datagrid';
import { LoadingService } from '@farris/ui-loading';
import { EntityDataService } from '../../service/entitydata.service';
import { LocalizeService } from '@qdp/localize';
export class FormularDefineComponent {
    /**
     * @param {?} restfulService
     * @param {?} msgService
     * @param {?} cacheService
     * @param {?} loadService
     * @param {?} entityDataService
     * @param {?} localizeService
     */
    constructor(restfulService, msgService, cacheService, loadService, entityDataService, localizeService) {
        this.restfulService = restfulService;
        this.msgService = msgService;
        this.cacheService = cacheService;
        this.loadService = loadService;
        this.entityDataService = entityDataService;
        this.localizeService = localizeService;
        this.data = [];
        this.funcData = [];
        // 当前站点host
        this.size = {};
        this.inputTemplate = '';
        this.dynamicInput = [];
        this.columns = [];
        this.formularText = ''; // 公式信息
        // 公式信息
        this.binding = 'selectFormular';
        this.name = ''; // 公式名称
        // 公式名称
        this.isGroup = false; // 是否分组
        // 是否分组
        this.resultDatas = [];
        this.resultColumns = [];
        this.formularWizard = '0';
        this.formularType = 0; // 0普通公式 1组合公式
        // 0普通公式 1组合公式
        this.loading = this.loadService.show({ container: 'body' });
        /**
         * 国际化
         */
        this.labelSaveFormular = '保存公式';
        this.resultSortColumns = [
            {
                id: '0',
                label: '无'
            },
            {
                id: '1',
                label: '升序'
            },
            {
                id: '2',
                label: '降序'
            }
        ];
        this.resultColVisibleColumns = [
            {
                id: '0',
                label: '否'
            },
            {
                id: '1',
                label: '是'
            }
        ];
        /**
         * 帮助配置字段
         */
        this.helpData = [];
        this.helpColumns = [];
        this.handlebeforeClose = (/**
         * @return {?}
         */
        () => {
            return of(true);
        });
        this.clickLastStep = (/**
         * @return {?}
         */
        () => {
            this.cacheService.set('formularParam', this.data);
            return true;
        });
        this.beforeFinish = (/**
         * @return {?}
         */
        () => {
            /** @type {?} */
            const flag$ = new Subject();
            if (this.formularType === 1) { // 组合公式保存
                if (!this.name) {
                    this.msgService.info(this.localizeService.getValue('formular.define.messageAlert.nameVerify'));
                }
                if (!this.formularText) {
                    this.msgService.info(this.localizeService.getValue('formular.define.messageAlert.combineVerify'));
                }
                else if (this.formularText && !this.formularCheck(this.formularText)) {
                    this.msgService.info(this.localizeService.getValue('formular.define.messageAlert.formularIntegrityVerify'));
                }
                /** @type {?} */
                const formularInfo = {
                    id: this.currentFormularId,
                    isgroup: this.isGroup ? 1 : 0,
                    name: this.name,
                    queryfunc: '',
                    str1: '',
                    str2: '',
                    str3: '',
                    str4: '',
                    cursu: this.data.currentSU,
                    str5: this.data.formularRegion ? this.data.formularRegion : 'publish',
                    str6: this.formularText,
                    num1: 1,
                };
                /** @type {?} */
                const options = {
                    headers: {
                        'SessionId': this.data.sessionId,
                        'Content-Type': 'application/json'
                    }
                };
                if (formularInfo) {
                    /** @type {?} */
                    const retrieveUri = this.data.serverHost + '/api/gsp/bcc/v1.0/querygetdatadetail_frm/service/saveqdpformular';
                    this.restfulService.put(retrieveUri, { formularInfo: JSON.stringify(formularInfo) }, {}, options).subscribe((/**
                     * @param {?} data
                     * @return {?}
                     */
                    data => {
                        /** @type {?} */
                        const formularData = data.returnValue;
                        if (formularData) {
                            this.currentFormularId = formularData;
                            this.entityDataService.setFormularState(true, { id: this.currentFormularId, name: this.name });
                            //this.cacheService.set('formularResult', { id: this.currentFormularId, name: '公式' });
                            flag$.next(true);
                        }
                        else {
                            this.entityDataService.setFormularState(false, {});
                            this.msgService.error(this.localizeService.getValue('formular.define.messageAlert.saveFormularFailure'));
                        }
                    }));
                }
            }
            else if (!this.currentFormularId) {
                this.entityDataService.setFormularState(false, {});
                this.msgService.info(this.localizeService.getValue('formular.define.messageAlert.formularSaveVerify'));
                return false;
            }
            else {
                this.entityDataService.setFormularState(true, { id: this.currentFormularId, name: this.name });
                //this.cacheService.set('formularResult', { id: this.currentFormularId, name: this.name ? this.name : '公式' });
                return true;
            }
            return flag$;
        });
        this.labelSaveFormular = this.localizeService.getValue('formular.define.labelSaveFormular');
        this.labelGeneraterFormular = this.localizeService.getValue('formular.define.labelGeneraterFormular');
        this.labelQueryFunc = this.localizeService.getValue('formular.define.labelQueryFunc');
        this.labelBasicInfo = this.localizeService.getValue('formular.define.labelBasicInfo');
        this.labelFormularName = this.localizeService.getValue('formular.define.labelFormularName');
        this.labelIsGroup = this.localizeService.getValue('formular.define.labelIsGroup');
        this.labelParamInfo = this.localizeService.getValue('formular.define.labelParamInfo');
        this.labelResultColInfo = this.localizeService.getValue('formular.define.labelResultColInfo');
        this.resultSortColumns = this.localizeService.getValue('formular.define.resultSortColumns');
        this.resultColVisibleColumns = this.localizeService.getValue('formular.define.resultColVisibleColumns');
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        this.data = this.cacheService.get('formularParam');
        this.formularWizard = this.data.formularWizard;
        this.formularType = this.data.formularWizard === '2' ? 1 : 0;
        this.currentFormularId = this.data.currentFormularId;
        this.columns = [
            // { field: 'id', width: 100, title: 'ID' },
            { field: 'resultcolvisible', width: 60, title: this.localizeService.getValue('formular.define.columntitles.resultcolvisible'), template: this.resultColVisibleColumnTemp },
            { field: 'resultcode', width: 60, title: this.localizeService.getValue('formular.define.columntitles.resultcode') },
            { field: 'resultdescription', width: 60, title: this.getResultDescription() },
            { field: 'resultsort', width: 60, title: this.localizeService.getValue('formular.define.columntitles.resultsort'), template: this.resultSortColumnTemp }
        ];
        if (this.data.sessionId) {
            this.getFuncInfo();
        }
        else {
            this.createHeaderSessionId().subscribe((/**
             * @param {?} sessionId
             * @return {?}
             */
            sessionId => {
                console.log(sessionId);
                if (sessionId) {
                    this.getFuncInfo();
                }
            }));
        }
    }
    /**
     * @return {?}
     */
    guid() {
        return ((/** @type {?} */ ([1e7])) + -1e3 + -4e3 + -8e3 + -1e11).replace(/[018]/g, (/**
         * @param {?} c
         * @return {?}
         */
        c => (c ^ crypto.getRandomValues(new Uint8Array(1))[0] & 15 >> c / 4).toString(16)));
    }
    /**
     * @return {?}
     */
    getResultDescription() {
        return this.getLanguage() === 'zh-chs' ? '列描述' : 'description';
    }
    /**
     * @return {?}
     */
    getLanguage() {
        switch (this.localizeService.localeId) {
            case 'zh-chs':
            case 'zh-cn':
            case 'zh':
                return 'zh-chs';
            case 'en-us':
            case 'en':
                return 'en-us';
        }
        return 'zh-chs';
    }
    /**
     * @return {?}
     */
    ngAfterViewInit() {
        this.loading.close();
    }
    /**
     * @private
     * @return {?}
     */
    createHeaderSessionId() {
        /** @type {?} */
        const sessionId = new Subject();
        /** @type {?} */
        const options = {
            headers: {
                'Content-Type': 'application/json'
            },
            responseType: 'text'
        };
        /** @type {?} */
        const createSessionUrl = this.data.serverHost + '/api/gsp/bcc/v1.0/queryfuncdetail_frm/service/createsession';
        this.restfulService.post(createSessionUrl, {}, {}, options).subscribe((/**
         * @param {?} data
         * @return {?}
         */
        data => {
            this.data.sessionId = data;
            sessionId.next(data);
        }));
        return sessionId;
    }
    /**
     * @private
     * @return {?}
     */
    getFuncInfo() {
        /** @type {?} */
        let uri = this.data.serverHost;
        /** @type {?} */
        const options = {
            headers: {
                'SessionId': this.data.sessionId,
                'Content-Type': 'application/json'
            }
        };
        /** @type {?} */
        const entityFilter = {
            FilterConditions: [{ 'FilterField': 'SrcSU', 'Value': this.data.currentSU, 'Lbracket': null, 'Rbracket': null, 'Relation': 0, 'Expresstype': 0, 'Compare': 6 }],
            SortConditions: [],
            IsUsePagination: false,
            Pagination: {
                PageIndex: 0,
                PageSize: 0,
                PageCount: 0,
                TotalCount: 0
            }
        };
        uri += '/api/gsp/bcc/v1.0/queryfuncdetail_frm/extension/query?entityFilter=' + JSON.stringify(entityFilter);
        this.restfulService.put(uri, {}, {}, options).subscribe((/**
         * @param {?} data
         * @return {?}
         */
        data => {
            /** @type {?} */
            const funcDatas = data.returnValue.result;
            if (funcDatas && funcDatas.length > 0) {
                funcDatas.forEach((/**
                 * @param {?} x
                 * @return {?}
                 */
                x => {
                    this.funcData.push({ name: x.name, value: x.id });
                }));
            }
            this.currentFuncDatas = funcDatas;
            // 如果选择的是选择公式，根据公示信息初始默认的数据
            if (this.currentFormularId && this.data.formularData && this.data.formularData.num1 === 1) {
                this.name = this.data.formularData.name;
                this.formularText = this.data.formularData.str6;
                this.formularType = 1;
            }
            else {
                this.getFormularInfo();
            }
        }));
    }
    /**
     * @private
     * @return {?}
     */
    getFormularInfo() {
        // 清空历史数据
        this.dynamicInput = [];
        this.resultColumns = [];
        this.resultDatas = [];
        this.formularText = '';
        this.name = '';
        this.isGroup = 0;
        if (this.currentFormularId) {
            /** @type {?} */
            const options = {
                headers: {
                    'SessionId': this.data.sessionId,
                    'Content-Type': 'application/json'
                }
            };
            /** @type {?} */
            const retrieveUri = this.data.serverHost + '/api/gsp/bcc/v1.0/querygetdatadetail_frm/extension/retrieve/' + this.currentFormularId;
            this.restfulService.put(retrieveUri, {}, {}, options).subscribe((/**
             * @param {?} data
             * @return {?}
             */
            data => {
                /** @type {?} */
                const formularData = data.returnValue;
                if (formularData) {
                    // 初始基础数据
                    this.name = formularData.name;
                    this.data.currentFormularName = formularData.name;
                    this.isGroup = formularData.isGroup;
                    /** @type {?} */
                    const queryFuncId = formularData.queryFunc;
                    this.type = formularData.str1;
                    this.metadataobjectid = formularData.str2;
                    this.funcSelectValue = this.funcData.find((/**
                     * @param {?} x
                     * @return {?}
                     */
                    x => x.value === queryFuncId));
                    this.entityDataService.setFormularState(true, { id: this.currentFormularId, name: this.name });
                    if (queryFuncId) {
                        this.getDropDownInfo(queryFuncId, this.type, this.metadataobjectid, true, formularData.queryGetDataParamInfos);
                    }
                    // const currentQueryGetDataParams = formularData.queryGetDataParamInfos;
                    /** @type {?} */
                    const queryFuncResults = formularData.queryGetDataResultInfos;
                    // if (currentQueryGetDataParams && currentQueryGetDataParams.length > 0) {
                    //   currentQueryGetDataParams.forEach(queryGetDataParam => {
                    //     const fieldConfig = JSON.parse(queryGetDataParam.fieldConfig);
                    //     if (fieldConfig.controltype === 'dropdown') {
                    //       fieldConfig.enumValues = JSON.parse(fieldConfig.enumValues);
                    //     }
                    //     this.dynamicInput.push({ paramcode: queryGetDataParam.paramCode, paramname: queryGetDataParam.paramName, paramvalue: queryGetDataParam.paramValue, fieldConfig: JSON.parse(queryGetDataParam.fieldConfig) });
                    //   });
                    // }
                    if (queryFuncResults && queryFuncResults.length > 0) {
                        /** @type {?} */
                        const resultColumns = [];
                        /** @type {?} */
                        const data = [];
                        queryFuncResults.forEach((/**
                         * @param {?} queryFuncResult
                         * @return {?}
                         */
                        queryFuncResult => {
                            resultColumns.push({ id: queryFuncResult.resultCode, label: queryFuncResult.resultName });
                            data.push({
                                id: queryFuncResult.id,
                                resultcode: queryFuncResult.resultCode,
                                resultsort: queryFuncResult.resultSort,
                                resultname: queryFuncResult.resultName,
                                resultcolvisible: queryFuncResult.resultColVisible === true ? '1' : '0',
                                resultdescription: ''
                            });
                        }));
                        this.resultColumns = [...resultColumns];
                        this.resultDatas = [...data];
                    }
                }
            }));
        }
    }
    /**
     * @return {?}
     */
    generateFormular() {
        if (!this.name) {
            this.msgService.info(this.localizeService.getValue('formular.define.messageAlert.nameVerify'));
            return;
        }
        if (!this.funcSelectValue) {
            this.msgService.info(this.localizeService.getValue('formular.define.messageAlert.funcVerify'));
            return;
        }
        /** @type {?} */
        const formularInfo = {
            id: this.currentFormularId,
            cursu: this.data.currentSU,
            isgroup: this.isGroup ? 1 : 0,
            name: this.name,
            queryfunc: this.funcSelectValue.value,
            str1: this.type,
            str2: this.metadataobjectid,
            str3: this.qomanagercode ? this.qomanagercode : '',
            str4: this.funcSelectValue.name,
            str5: '',
            str6: '',
            formularParamInfos: this.dynamicInput,
            formularResultInfos: this.resultDatas
        };
        /** @type {?} */
        const options = {
            headers: {
                'SessionId': this.data.sessionId,
                'Content-Type': 'application/json'
            }
        };
        if (formularInfo) {
            /** @type {?} */
            const retrieveUri = this.data.serverHost + '/api/gsp/bcc/v1.0/querygetdatadetail_frm/service/saveqdpformular';
            this.restfulService.put(retrieveUri, { formularInfo: JSON.stringify(formularInfo) }, {}, options).subscribe((/**
             * @param {?} data
             * @return {?}
             */
            data => {
                /** @type {?} */
                const formularData = data.returnValue;
                if (formularData) {
                    this.currentFormularId = formularData;
                    this.entityDataService.setFormularState(true, { id: this.currentFormularId, name: this.name });
                    // this.entityDataService.isFinish = true;
                    this.msgService.info(this.localizeService.getValue('formular.define.messageAlert.saveFormular'));
                }
            }));
        }
    }
    /**
     * @return {?}
     */
    generateFormularInfo() {
        if (!this.currentFunctionId) {
            this.msgService.info(this.localizeService.getValue('formular.define.messageAlert.pleaseSelectQueryFunc'));
            return;
        }
        if (this.resultDatas && this.resultDatas.filter((/**
         * @param {?} x
         * @return {?}
         */
        x => x.resultcolvisible === '1')).length !== 1) {
            this.msgService.info(this.localizeService.getValue('formular.define.messageAlert.resultVerify'));
            return;
        }
        /** @type {?} */
        const paramInfo = [];
        this.dynamicInput.forEach((/**
         * @param {?} x
         * @return {?}
         */
        x => {
            paramInfo.push({ key: x.paramcode, value: x.paramvalue ? x.paramvalue : '' });
        }));
        /** @type {?} */
        const formularcompile = {
            funcId: this.currentFunctionId,
            paramInfos: paramInfo,
            resultColName: this.resultDatas[0].resultcode,
            qomanagercode: this.qomanagercode,
            isgroup: this.isGroup ? 1 : 0
        };
        this.formularText = this.formularText + 'QDPFormular.execute(' + JSON.stringify(formularcompile) + ') ';
    }
    /**
     * @param {?} $event
     * @return {?}
     */
    operator($event) {
        this.formularText = this.formularText + $event;
    }
    /**
     * @param {?} event
     * @return {?}
     */
    onResized(event) {
        this.size.height = event.newHeight;
        this.size.width = event.newWidth;
    }
    /**
     * @param {?} $event
     * @return {?}
     */
    selectionChange($event) {
        // 清空历史数据
        this.dynamicInput = [];
        this.resultColumns = [];
        this.resultDatas = [];
        this.name = this.formularType === 1 ? this.name : '';
        this.isGroup = 0;
        if ($event && $event.value) {
            this.currentFunctionId = $event.value;
            /** @type {?} */
            const funcData = this.currentFuncDatas.find((/**
             * @param {?} x
             * @return {?}
             */
            x => x.id === this.currentFunctionId));
            this.name = this.name === '' ? funcData.name : this.name;
            // 保存公式类型及元数据id
            this.type = funcData.srcType;
            this.metadataobjectid = funcData.metadataObject;
            if (this.currentFunctionId) {
                this.getDropDownInfo(this.currentFunctionId, this.type, this.metadataobjectid, true, '');
            }
        }
    }
    // 初始下拉信息
    /**
     * @param {?} funcid
     * @param {?} type
     * @param {?} metadataobjectid
     * @param {?} generateData
     * @param {?} queryFormularParam
     * @return {?}
     */
    getDropDownInfo(funcid, type, metadataobjectid, generateData, queryFormularParam) {
        /** @type {?} */
        const self = this;
        // 访问数据服务
        /** @type {?} */
        const options = {
            headers: {
                'SessionId': self.data.sessionId,
                'Content-Type': 'application/json'
            }
        };
        /** @type {?} */
        const url = self.data.serverHost + '/api/gsp/bcc/v1.0/queryfuncdetail_frm/extension/retrieve/' + funcid;
        self.restfulService.put(url, {}, {}, options).toPromise().then((/**
         * @param {?} value
         * @return {?}
         */
        function (value) {
            if (value) {
                value = value.returnValue;
                // 查询参数
                if (generateData) {
                    /** @type {?} */
                    let queryFuncParams = value.queryFuncParams;
                    if (queryFuncParams.length > 0) {
                        // if (currentQueryGetDataParams && currentQueryGetDataParams.length > 0) {
                        //   currentQueryGetDataParams.forEach(queryGetDataParam => {
                        //     const fieldConfig = JSON.parse(queryGetDataParam.fieldConfig);
                        //     if (fieldConfig.controltype === 'dropdown') {
                        //       fieldConfig.enumValues = JSON.parse(fieldConfig.enumValues);
                        //     }
                        //     this.dynamicInput.push({ paramcode: queryGetDataParam.paramCode, paramname: queryGetDataParam.paramName, paramvalue: queryGetDataParam.paramValue, fieldConfig: JSON.parse(queryGetDataParam.fieldConfig) });
                        //   });
                        // }
                        queryFuncParams = queryFuncParams.sort(self.sortData);
                        queryFuncParams.forEach((/**
                         * @param {?} funcParam
                         * @return {?}
                         */
                        funcParam => {
                            if (funcParam) {
                                /** @type {?} */
                                const fieldConfig = JSON.parse(funcParam.fieldConfig);
                                if (fieldConfig.controltype === 'dropdown') {
                                    fieldConfig.enumValues = fieldConfig.enumValues;
                                }
                                /** @type {?} */
                                let findParamInfo;
                                if (queryFormularParam && queryFormularParam.length > 0) {
                                    findParamInfo = queryFormularParam.find((/**
                                     * @param {?} x
                                     * @return {?}
                                     */
                                    x => x.paramCode === funcParam.code));
                                }
                                /** @type {?} */
                                let paramvalue = (findParamInfo && findParamInfo.paramValue) ? findParamInfo.paramValue : '';
                                fieldConfig.paramvaluename = '';
                                if (fieldConfig.controltype === 'help' && findParamInfo) {
                                    /** @type {?} */
                                    const paramvaluearray = paramvalue.split('|');
                                    paramvalue = paramvaluearray[0];
                                    fieldConfig.paramvaluename = paramvaluearray[1];
                                }
                                self.dynamicInput.push({ id: findParamInfo ? findParamInfo.id : '', paramcode: funcParam.code, paramname: funcParam.name, paramvalue: paramvalue, fieldConfig: fieldConfig });
                            }
                        }));
                    }
                }
                if (generateData) { // 新建或者组合公式调用此逻辑
                    self.resultColumns = [];
                    if (type === 'BE') {
                        /** @type {?} */
                        const queryFuncResults = value.queryFuncResults;
                        if (queryFuncResults.length > 0) {
                            /** @type {?} */
                            const funcResultDatas = [];
                            queryFuncResults.forEach((/**
                             * @param {?} funcResult
                             * @return {?}
                             */
                            funcResult => {
                                if (funcResult) {
                                    // self.resultColumns.push({ id: funcResult.srcCol, label: funcResult.colName });
                                    funcResultDatas.push({ id: self.guid(), resultcode: funcResult.srcCol, resultsort: '0', resultname: funcResult.colName,
                                        resultcolvisible: '1', resultdescription: funcResult.description });
                                }
                            }));
                            if (funcResultDatas.length > 0) {
                                if (self.resultDatas && self.resultDatas.length > 0) {
                                    /** @type {?} */
                                    let newResultDatas = [];
                                    for (let funcResultData of funcResultDatas) {
                                        /** @type {?} */
                                        const resultData = self.resultDatas.find((/**
                                         * @param {?} x
                                         * @return {?}
                                         */
                                        x => x.resultcode === funcResultData.resultcode));
                                        if (resultData) {
                                            newResultDatas.push(Object.assign({}, resultData, { resultdescription: funcResultData.resultdescription }));
                                        }
                                        else {
                                            newResultDatas.push(funcResultData);
                                        }
                                    }
                                    /** @type {?} */
                                    let resultColumns1 = [];
                                    newResultDatas.forEach((/**
                                     * @param {?} m
                                     * @return {?}
                                     */
                                    m => {
                                        resultColumns1.push({ id: m.resultcode, label: m.resultname });
                                    }));
                                    self.resultColumns = [...resultColumns1];
                                    self.resultDatas = [...newResultDatas];
                                }
                                else {
                                    /** @type {?} */
                                    let resultColumns1 = [];
                                    funcResultDatas.forEach((/**
                                     * @param {?} m
                                     * @return {?}
                                     */
                                    m => {
                                        resultColumns1.push({ id: m.resultcode, label: m.resultname });
                                    }));
                                    self.resultColumns = [...resultColumns1];
                                    self.resultDatas = [...funcResultDatas];
                                }
                                // self.resultDatas = [...funcResultDatas];
                            }
                        }
                    }
                    else {
                        /** @type {?} */
                        const options = {
                            headers: {
                                'SessionId': self.data.sessionId,
                                'Content-Type': 'application/json'
                            }
                        };
                        // 根据id获取元数据信息
                        self.restfulService.get(self.data.serverHost + '/api/runtime/sys/v1.0/rt-metadatas/' + metadataobjectid, {}, options).subscribe((/**
                         * @param {?} metadataContent
                         * @return {?}
                         */
                        metadataContent => {
                            if (metadataContent) {
                                /** @type {?} */
                                const currentMetadataContent = JSON.parse(metadataContent['content']);
                                /** @type {?} */
                                let mainObject = currentMetadataContent.QueryNode;
                                if (!mainObject) {
                                    mainObject = currentMetadataContent.DataSources['0'].QueryNode;
                                }
                                /** @type {?} */
                                const datas = [];
                                mainObject.ContainElements.forEach((/**
                                 * @param {?} containElement
                                 * @return {?}
                                 */
                                containElement => {
                                    self.resultColumns.push({ id: containElement.Code, label: containElement.Name });
                                    datas.push({ id: self.guid(), resultcode: containElement.Code, resultsort: '0', resultname: containElement.Name, resultcolvisible: '1', resultdescription: '' });
                                }));
                                if (datas.length > 0) {
                                    self.resultDatas = [...datas];
                                }
                                self.qomanagercode = 'com.' + (currentMetadataContent.NamespacePrefix + '.' + currentMetadataContent.Code).toLowerCase(); // qo编号
                            }
                        }));
                    }
                }
            }
        }));
    }
    /**
     * @param {?} a
     * @param {?} b
     * @return {?}
     */
    sortData(a, b) {
        return a.orderNumber - b.orderNumber;
    }
    /**
     * @param {?} string
     * @return {?}
     */
    formularCheck(string) {
        // 剔除空白符
        string = string.replace(/\s/g, '');
        // 错误情况，空字符串
        if ('' === string) {
            return false;
        }
        // 错误情况，运算符连续
        if (/[\+\-\*\/]{2,}/.test(string)) {
            return false;
        }
        // 空括号
        if (/\(\)/.test(string)) {
            return false;
        }
        // 错误情况，括号不配对
        /** @type {?} */
        var stack = [];
        for (var i = 0, item; i < string.length; i++) {
            item = string.charAt(i);
            if ('(' === item) {
                stack.push('(');
            }
            else if (')' === item) {
                if (stack.length > 0) {
                    stack.pop();
                }
                else {
                    return false;
                }
            }
        }
        if (0 !== stack.length) {
            return false;
        }
        // 错误情况，(后面是运算符 
        if (/\([\+\-\*\/]/.test(string)) {
            return false;
        }
        // 错误情况，)前面是运算符
        if (/[\+\-\*\/]\)/.test(string)) {
            return false;
        }
        // // 错误情况，(前面不是运算符
        // if (/[^\+\-\*\/]\(/.test(string)) {
        //   return false;
        // }
        // // 错误情况，)后面不是运算符
        // if (/\)[^\+\-\*\/]/.test(string)) {
        //   return false;
        // }
        return true;
    }
}
FormularDefineComponent.decorators = [
    { type: Component, args: [{
                selector: 'formular-define',
                template: "<div class=\"farris-main-area flex-column\">\r\n  <div class=\"farris-header\">\r\n    <div class=\"farris-form form-inline farris-form-inline\">\r\n      <div class=\"f-utils-flex-row-wrap\">\r\n        <div class=\"col-2\" *ngIf=\"formularType===0\">\r\n          <farris-button (click)=\"generateFormular()\">\r\n            <span>{{labelSaveFormular}}</span>\r\n          </farris-button>\r\n        </div>\r\n        <div class=\"col-10\" *ngIf=\"formularType===1\">\r\n          <farris-button (click)=\"generateFormularInfo()\">\r\n            <span>{{labelGeneraterFormular}}</span>\r\n          </farris-button>\r\n          <farris-button class=\"mx-2\" [size]=\"'small'\" (click)=\"operator('+')\">\r\n            <span>+</span>\r\n          </farris-button>\r\n          <farris-button class=\"mx-2\" [size]=\"'small'\" (click)=\"operator('-')\">\r\n            <span>-</span>\r\n          </farris-button>\r\n          <farris-button class=\"mx-2\" [size]=\"'small'\" (click)=\"operator('*')\">\r\n            <span>*</span>\r\n          </farris-button>\r\n          <farris-button class=\"mx-2\" [size]=\"'small'\" (click)=\"operator('/')\">\r\n            <span>-</span>\r\n          </farris-button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=\"navbar p-0\" *ngIf=\"formularType===1\">\r\n      <textarea class=\"form-control\" rows=\"10\" maxlength=\"2000\" id=\"formularText\" [(ngModel)]=\"formularText\"></textarea>\r\n    </div>\r\n  </div>\r\n  <div class=\"d-flex flex-row flex-fill farris-overflow-hidden\">\r\n    <div class=\"col-3 p-0 m-1 farris-overflow-hidden\" (resized)=\"onResized($event)\">\r\n      <div class=\"col-12 col-md-12 col-lg-12\">\r\n        <div class=\"farris-group-wrap form-inline farris-form-inline\">\r\n          <div class=\"form-group farris-form-group\">\r\n            <label class=\"col-form-label\" for=\"colFunction\" style=\"width: 6rem; min-width: 6rem;\">\r\n              <span class=\"farris-label-text\">{{labelQueryFunc}}:</span>\r\n            </label>\r\n            <div class=\"farris-input-wrap\">\r\n              <kendo-combobox id=\"colAlign\" [(ngModel)]=\"funcSelectValue\" [data]=\"funcData\" [textField]=\"'name'\"\r\n                [valueField]=\"'value'\" class=\"form-control\" (selectionChange)=\"selectionChange($event)\">\r\n              </kendo-combobox>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=\"flex-fill f-utils-overflow-xhya \">\r\n      <farris-panel [foldable]=\"true\" [defaultExpand]=\"true\">\r\n        <farris-panel-item [title]=\"labelBasicInfo\">\r\n          <ng-template #contentTempl>\r\n            <div class=\"farris-form form-inline farris-form-inline\">\r\n              <div class=\"f-utils-flex-row-wrap\">\r\n                <div class=\"col-6\">\r\n                  <div class=\"farris-group-wrap\">\r\n                    <div class=\"form-group farris-form-group\">\r\n                      <label class=\"col-form-label\">\r\n                        <span class=\"farris-label-info text-danger\">*</span>\r\n                        <span class=\"farris-label-text\">{{labelFormularName}}</span>\r\n                      </label>\r\n                      <div class=\"farris-input-wrap\">\r\n                        <input class=\"form-control\" type=\"text\" id=\"name\" [(ngModel)]=\"name\" maxlength=\"36\">\r\n                        <div class=\"farris-feedback valid-feedback\"></div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n                <div class=\"col-6\">\r\n                  <div class=\"farris-group-wrap\">\r\n                    <div class=\"form-group farris-form-group\">\r\n                      <label class=\"col-form-label\" for=\"class-input-checkbox01\">\r\n                        <span class=\"farris-label-text\">{{labelIsGroup}}</span>\r\n                      </label>\r\n                      <div class=\"farris-input-wrap\">\r\n                        <div class=\"custom-control custom-checkbox\">\r\n                          <input class=\"custom-control-input\" id=\"isGroup\" [(ngModel)]=\"isGroup\" type=\"checkbox\">\r\n                          <label class=\"custom-control-label\" for=\"isGroup\"></label>\r\n                        </div>\r\n                        <div class=\"farris-feedback valid-feedback\"></div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </ng-template>\r\n        </farris-panel-item>\r\n        <farris-panel-item [title]=\"labelParamInfo\">\r\n          <ng-template #contentTempl>\r\n            <div class=\"farris-form form-inline farris-form-inline\">\r\n              <div class=\"f-utils-flex-row-wrap\">\r\n                <div class=\"col-6\" *ngFor=\"let i of dynamicInput\">\r\n                  <div class=\"farris-group-wrap\">\r\n                    <div class=\"form-group farris-form-group\">\r\n                      <label class=\"col-form-label\">\r\n                        <span class=\"farris-label-text\">{{i.paramname}}:</span>\r\n                      </label>\r\n                      <div class=\"farris-input-wrap\">\r\n                        <div *ngIf=\"i.fieldConfig.controltype === 'text'\">\r\n                          <input class=\"form-control\" type=\"text\" id=\"name\" [(ngModel)]=\"i.paramvalue\" maxlength=\"36\">\r\n                          <div class=\"farris-feedback valid-feedback\"></div>\r\n                        </div>\r\n                        <div *ngIf=\"i.fieldConfig.controltype === 'help'\">\r\n                          <farris-lookup-grid input-end-edit data-mapping [useTip]=\" false\" [nosearch]=\"false\" [ngModel]=\"i.fieldConfig.paramvaluename\"\r\n                            [editable]=\"false\" [displayType]=\"'List'\" [items]=\"helpData\"\r\n                            [idField]=\"i.fieldConfig.idField\"  [singleSelect]=\"true\"\r\n                            [pageSize]=\"20\" [pageIndex]=\"1\" [pagination]=\"true\" [textField]=\"i.fieldConfig.textField\"\r\n                            [valueField]=\"i.fieldConfig.valueField\" [title]=\"'\u901A\u7528\u5E2E\u52A9'\" [showCloseButton]=\"true\"\r\n                            [resizable]=\"true\" [context]='i.fieldConfig' [enableToSelect]=\"true\"\r\n                            [columns]=\"i.fieldConfig.showColumns\" [libHelpBeforeEvent]=\"i\"\r\n                            [localHost]=\"data.serverHost\" [dynamicInput] = \"dynamicInput\"></farris-lookup-grid>\r\n                          <div class=\"farris-feedback\"></div>\r\n                        </div>\r\n                        <div *ngIf=\"i.fieldConfig.controltype === 'dropdown'\">\r\n                          <farris-combo-list [(ngModel)]=\"i.paramvalue\" [idField]=\"'value'\" [textField]=\"'name'\"\r\n                            [editable]=\"false\" [data]=\"i.fieldConfig.enumValues\"\r\n                            [multiSelect]=\"i.fieldConfig.multiSelect\"></farris-combo-list>\r\n                          <div class=\"farris-feedback\"></div>\r\n                        </div>\r\n                        <div *ngIf=\"i.fieldConfig.controltype === 'single-date'\">\r\n                          <farris-datepicker [(ngModel)]=\"i.paramvalue\" [returnFormat]=\"'yyyy-MM-dd'\"\r\n                            [dateFormat]=\"i.fieldConfig.format\">\r\n                          </farris-datepicker>\r\n                          <div class=\"farris-feedback\"></div>\r\n                        </div>\r\n                        <div *ngIf=\"i.fieldConfig.controltype === 'single-number'\">\r\n                          <farris-number-spinner [(ngModel)]=\"i.paramvalue\"></farris-number-spinner>\r\n                          <div class=\"farris-feedback\"></div>\r\n                        </div>\r\n                        <div *ngIf=\"i.fieldConfig.controltype === 'single-year'\">\r\n                          <farris-datepicker [(ngModel)]=\"i.paramvalue\"  [returnFormat]=\"'yyyy'\"\r\n                            [dateFormat]=\"'yyyy'\" [showType]=\"3\"></farris-datepicker>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </ng-template>\r\n        </farris-panel-item>\r\n        <farris-panel-item [title]=\"labelResultColInfo\">\r\n          <ng-template #contentTempl>\r\n            <!-- <div class=\"row\" style=\"margin: 0; padding: 15px; background-color: #fff\">\r\n            <button class=\"btn btn-primary\" (click)=\"newAdd()\">\u65B0\u589E</button>\r\n            <button class=\"btn btn-default ml-1 mr-1\" (click)=\"removeRow()\">\u5220\u9664</button>\r\n          </div> -->\r\n            <farris-datagrid [data]=\"resultDatas\" [columns]=\"columns\" #dg=\"datagrid\" [fit]=\"true\" [showCheckbox]=\"false\"\r\n              [fitColumns]=\"true\" [showLineNumber]=\"false\" [striped]=\"true\" [virtualized]=\"false\" [height]=\"250\"\r\n              [pagination]=\"false\">\r\n            </farris-datagrid>\r\n          </ng-template>\r\n        </farris-panel-item>\r\n      </farris-panel>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #resultColumnTemp let-ctx>\r\n  <div class=\"f-datagrid-cell-formgroup farris-group-auto\">\r\n    <farris-combo-list [(ngModel)]=\"ctx.rowData['resultcode']\" [idField]=\"'id'\" [textField]=\"'label'\" [readonly]=\"true\"\r\n      [disabled]=\"true\" [data]=\"resultColumns\"></farris-combo-list>\r\n  </div>\r\n</ng-template>\r\n<ng-template #resultSortColumnTemp let-ctx>\r\n  <div class=\"f-datagrid-cell-formgroup farris-group-auto\">\r\n    <farris-combo-list [(ngModel)]=\"ctx.rowData['resultsort']\" [idField]=\"'id'\" [textField]=\"'label'\"\r\n      [data]=\"resultSortColumns\"></farris-combo-list>\r\n  </div>\r\n</ng-template>\r\n<ng-template #resultColVisibleColumnTemp let-ctx>\r\n  <div class=\"f-datagrid-cell-formgroup farris-group-auto\">\r\n    <farris-combo-list [(ngModel)]=\"ctx.rowData['resultcolvisible']\" [idField]=\"'id'\" [textField]=\"'label'\"\r\n      [data]=\"resultColVisibleColumns\"></farris-combo-list>\r\n  </div>\r\n</ng-template>",
                styles: [""]
            }] }
];
/** @nocollapse */
FormularDefineComponent.ctorParameters = () => [
    { type: RestfulService },
    { type: MessagerService },
    { type: CacheService },
    { type: LoadingService },
    { type: EntityDataService },
    { type: LocalizeService }
];
FormularDefineComponent.propDecorators = {
    resultColumnTemp: [{ type: ViewChild, args: ['resultColumnTemp',] }],
    resultSortColumnTemp: [{ type: ViewChild, args: ['resultSortColumnTemp',] }],
    resultColVisibleColumnTemp: [{ type: ViewChild, args: ['resultColVisibleColumnTemp',] }],
    dg: [{ type: ViewChild, args: ['dg',] }]
};
if (false) {
    /** @type {?} */
    FormularDefineComponent.prototype.resultColumnTemp;
    /** @type {?} */
    FormularDefineComponent.prototype.resultSortColumnTemp;
    /** @type {?} */
    FormularDefineComponent.prototype.resultColVisibleColumnTemp;
    /** @type {?} */
    FormularDefineComponent.prototype.data;
    /** @type {?} */
    FormularDefineComponent.prototype.funcData;
    /** @type {?} */
    FormularDefineComponent.prototype.currentFormularId;
    /** @type {?} */
    FormularDefineComponent.prototype.currentFunctionId;
    /** @type {?} */
    FormularDefineComponent.prototype.serverHost;
    /** @type {?} */
    FormularDefineComponent.prototype.size;
    /** @type {?} */
    FormularDefineComponent.prototype.currentFuncDatas;
    /** @type {?} */
    FormularDefineComponent.prototype.funcSelectValue;
    /** @type {?} */
    FormularDefineComponent.prototype.inputTemplate;
    /** @type {?} */
    FormularDefineComponent.prototype.sessionId;
    /** @type {?} */
    FormularDefineComponent.prototype.dynamicInput;
    /** @type {?} */
    FormularDefineComponent.prototype.columns;
    /** @type {?} */
    FormularDefineComponent.prototype.formularText;
    /** @type {?} */
    FormularDefineComponent.prototype.binding;
    /** @type {?} */
    FormularDefineComponent.prototype.name;
    /** @type {?} */
    FormularDefineComponent.prototype.isGroup;
    /** @type {?} */
    FormularDefineComponent.prototype.resultDatas;
    /** @type {?} */
    FormularDefineComponent.prototype.dg;
    /** @type {?} */
    FormularDefineComponent.prototype.resultColumns;
    /** @type {?} */
    FormularDefineComponent.prototype.type;
    /** @type {?} */
    FormularDefineComponent.prototype.metadataobjectid;
    /** @type {?} */
    FormularDefineComponent.prototype.qomanagercode;
    /** @type {?} */
    FormularDefineComponent.prototype.formularWizard;
    /** @type {?} */
    FormularDefineComponent.prototype.formularType;
    /** @type {?} */
    FormularDefineComponent.prototype.loading;
    /**
     * 国际化
     * @type {?}
     */
    FormularDefineComponent.prototype.labelSaveFormular;
    /** @type {?} */
    FormularDefineComponent.prototype.labelGeneraterFormular;
    /** @type {?} */
    FormularDefineComponent.prototype.labelQueryFunc;
    /** @type {?} */
    FormularDefineComponent.prototype.labelBasicInfo;
    /** @type {?} */
    FormularDefineComponent.prototype.labelFormularName;
    /** @type {?} */
    FormularDefineComponent.prototype.labelIsGroup;
    /** @type {?} */
    FormularDefineComponent.prototype.labelParamInfo;
    /** @type {?} */
    FormularDefineComponent.prototype.labelResultColInfo;
    /** @type {?} */
    FormularDefineComponent.prototype.resultSortColumns;
    /** @type {?} */
    FormularDefineComponent.prototype.resultColVisibleColumns;
    /**
     * 帮助配置字段
     * @type {?}
     */
    FormularDefineComponent.prototype.helpData;
    /** @type {?} */
    FormularDefineComponent.prototype.helpColumns;
    /** @type {?} */
    FormularDefineComponent.prototype.handlebeforeClose;
    /** @type {?} */
    FormularDefineComponent.prototype.clickLastStep;
    /** @type {?} */
    FormularDefineComponent.prototype.beforeFinish;
    /**
     * @type {?}
     * @private
     */
    FormularDefineComponent.prototype.restfulService;
    /**
     * @type {?}
     * @private
     */
    FormularDefineComponent.prototype.msgService;
    /**
     * @type {?}
     * @private
     */
    FormularDefineComponent.prototype.cacheService;
    /**
     * @type {?}
     * @private
     */
    FormularDefineComponent.prototype.loadService;
    /**
     * @type {?}
     * @private
     */
    FormularDefineComponent.prototype.entityDataService;
    /**
     * @type {?}
     * @private
     */
    FormularDefineComponent.prototype.localizeService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZm9ybXVsYXItZGVmaW5lLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BxZHAvZm9ybXVsYXIvIiwic291cmNlcyI6WyJsaWIvY29tcG9uZW50L2Zvcm11bGFyLWRlZmluZS9mb3JtdWxhci1kZWZpbmUuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsT0FBTyxFQUFFLFNBQVMsRUFBdUMsU0FBUyxFQUE0QixXQUFXLEVBQTRCLE1BQU0sZUFBZSxDQUFDO0FBQzNKLE9BQU8sRUFBYyxFQUFFLEVBQWdCLE9BQU8sRUFBRSxNQUFNLE1BQU0sQ0FBQztBQUM3RCxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFDdEQsT0FBTyxFQUFrQixZQUFZLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUNuRSxPQUFPLEVBQUUsY0FBYyxFQUFFLE1BQU0sK0JBQStCLENBQUM7QUFDL0QsT0FBTyxFQUFFLGlCQUFpQixFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFDeEQsT0FBTyxFQUFFLGNBQWMsRUFBRSxNQUFNLG9CQUFvQixDQUFDO0FBRXBELE9BQU8sRUFBRSxpQkFBaUIsRUFBRSxNQUFNLGtDQUFrQyxDQUFDO0FBQ3JFLE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFPaEQsTUFBTSxPQUFPLHVCQUF1Qjs7Ozs7Ozs7O0lBNEVsQyxZQUFvQixjQUE4QixFQUN0QyxVQUEyQixFQUMzQixZQUEwQixFQUMxQixXQUEyQixFQUMzQixpQkFBb0MsRUFDcEMsZUFBZ0M7UUFMeEIsbUJBQWMsR0FBZCxjQUFjLENBQWdCO1FBQ3RDLGVBQVUsR0FBVixVQUFVLENBQWlCO1FBQzNCLGlCQUFZLEdBQVosWUFBWSxDQUFjO1FBQzFCLGdCQUFXLEdBQVgsV0FBVyxDQUFnQjtRQUMzQixzQkFBaUIsR0FBakIsaUJBQWlCLENBQW1CO1FBQ3BDLG9CQUFlLEdBQWYsZUFBZSxDQUFpQjtRQTdFNUMsU0FBSSxH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QWU7O0lBQ2YsMENBQXFCOztJQUNyQiw4Q0FBc0I7O0lBQ3RCLHFDQUF1Qzs7SUFDdkMsZ0RBQ0U7O0lBQ0YsdUNBQVU7O0lBQ1YsbURBQXNCOztJQUN0QixnREFBbUI7O0lBQ25CLGlEQUEwQjs7SUFDMUIsK0NBQWlCOztJQUNqQiwwQ0FBdUQ7Ozs7O0lBS3ZELG9EQUEyQjs7SUFDM0IseURBQStCOztJQUMvQixpREFBeUI7O0lBQ3pCLGlEQUF1Qjs7SUFDdkIsb0RBQTBCOztJQUMxQiwrQ0FBcUI7O0lBQ3JCLGlEQUF1Qjs7SUFDdkIscURBQTRCOztJQUU1QixvREFhRTs7SUFFRiwwREFTRTs7Ozs7SUFLRiwyQ0FBbUI7O0lBQ25CLDhDQUFzQjs7SUF3RXRCLG9EQUVDOztJQW1XRCxnREFHQzs7SUFFRCwrQ0F3REM7Ozs7O0lBeGVXLGlEQUFzQzs7Ozs7SUFDOUMsNkNBQW1DOzs7OztJQUNuQywrQ0FBa0M7Ozs7O0lBQ2xDLDhDQUFtQzs7Ozs7SUFDbkMsb0RBQTRDOzs7OztJQUM1QyxrREFBd0MiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIE9uSW5pdCwgSW5wdXQsIE91dHB1dCwgRXZlbnRFbWl0dGVyLCBWaWV3Q2hpbGQsIE9uQ2hhbmdlcywgU2ltcGxlQ2hhbmdlcywgVGVtcGxhdGVSZWYsIE9uRGVzdHJveSwgQWZ0ZXJWaWV3SW5pdCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBPYnNlcnZhYmxlLCBvZiwgU3Vic2NyaXB0aW9uLCBTdWJqZWN0IH0gZnJvbSAncnhqcyc7XHJcbmltcG9ydCB7IE1lc3NhZ2VyU2VydmljZSB9IGZyb20gJ0BmYXJyaXMvdWktbWVzc2FnZXInO1xyXG5pbXBvcnQgeyBTZXNzaW9uU2VydmljZSwgQ2FjaGVTZXJ2aWNlIH0gZnJvbSAnQGVjcC1jYWYvY2FmLWNvbW1vbic7XHJcbmltcG9ydCB7IFJlc3RmdWxTZXJ2aWNlIH0gZnJvbSAnLi4vLi4vc2VydmljZS9yZXN0ZnVsLnNlcnZpY2UnO1xyXG5pbXBvcnQgeyBEYXRhZ3JpZENvbXBvbmVudCB9IGZyb20gJ0BmYXJyaXMvdWktZGF0YWdyaWQnO1xyXG5pbXBvcnQgeyBMb2FkaW5nU2VydmljZSB9IGZyb20gJ0BmYXJyaXMvdWktbG9hZGluZyc7XHJcbmltcG9ydCB7IEZvcm11bGFyU2VydmljZSB9IGZyb20gJy4uLy4uL3NlcnZpY2UvZm9ybXVsYXIuc2VydmljZSc7XHJcbmltcG9ydCB7IEVudGl0eURhdGFTZXJ2aWNlIH0gZnJvbSAnLi4vLi4vc2VydmljZS9lbnRpdHlkYXRhLnNlcnZpY2UnO1xyXG5pbXBvcnQgeyBMb2NhbGl6ZVNlcnZpY2UgfSBmcm9tICdAcWRwL2xvY2FsaXplJztcclxuXHJcbkBDb21wb25lbnQoe1xyXG4gIHNlbGVjdG9yOiAnZm9ybXVsYXItZGVmaW5lJyxcclxuICB0ZW1wbGF0ZVVybDogJy4vZm9ybXVsYXItZGVmaW5lLmNvbXBvbmVudC5odG1sJyxcclxuICBzdHlsZVVybHM6IFsnLi9mb3JtdWxhci1kZWZpbmUuY29tcG9uZW50LnNjc3MnXVxyXG59KVxyXG5leHBvcnQgY2xhc3MgRm9ybXVsYXJEZWZpbmVDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQsIEFmdGVyVmlld0luaXQge1xyXG4gIEBWaWV3Q2hpbGQoJ3Jlc3VsdENvbHVtblRlbXAnKSByZXN1bHRDb2x1bW5UZW1wOiBUZW1wbGF0ZVJlZjxhbnk+O1xyXG4gIEBWaWV3Q2hpbGQoJ3Jlc3VsdFNvcnRDb2x1bW5UZW1wJykgcmVzdWx0U29ydENvbHVtblRlbXA6IFRlbXBsYXRlUmVmPGFueT47XHJcbiAgQFZpZXdDaGlsZCgncmVzdWx0Q29sVmlzaWJsZUNvbHVtblRlbXAnKSByZXN1bHRDb2xWaXNpYmxlQ29sdW1uVGVtcDogVGVtcGxhdGVSZWY8YW55PjtcclxuICBkYXRhOiBhbnkgPSBbXTtcclxuICBmdW5jRGF0YTogYW55ID0gW107XHJcbiAgY3VycmVudEZvcm11bGFySWQ6IGFueTsgLy8g5b2T5YmN5YWs5byPaWRcclxuICBjdXJyZW50RnVuY3Rpb25JZDogYW55OyAvLyDlvZPliY3kuJrliqHlh73mlbBpZFxyXG4gIHNlcnZlckhvc3Q6IGFueTsgLy8g5b2T5YmN56uZ54K5aG9zdFxyXG4gIHNpemU6IGFueSA9IHt9O1xyXG4gIGN1cnJlbnRGdW5jRGF0YXM6IGFueTtcclxuICBmdW5jU2VsZWN0VmFsdWU6IGFueTtcclxuICBpbnB1dFRlbXBsYXRlOiBhbnkgPSAnJztcclxuICBzZXNzaW9uSWQ6IGFueTtcclxuICBkeW5hbWljSW5wdXQ6IGFueSA9IFtdO1xyXG4gIGNvbHVtbnM6IGFueSA9IFtcclxuICBdO1xyXG4gIGZvcm11bGFyVGV4dDogYW55ID0gJyc7IC8vIOWFrOW8j+S/oeaBr1xyXG4gIGJpbmRpbmc6IGFueSA9ICdzZWxlY3RGb3JtdWxhcic7XHJcbiAgbmFtZTogYW55ID0gJyc7IC8vIOWFrOW8j+WQjeensFxyXG4gIGlzR3JvdXA6IGFueSA9IGZhbHNlOyAvLyDmmK/lkKbliIbnu4RcclxuICByZXN1bHREYXRhczogYW55ID0gW107XHJcbiAgQFZpZXdDaGlsZCgnZGcnKSBkZzogRGF0YWdyaWRDb21wb25lbnQ7XHJcbiAgcmVzdWx0Q29sdW1uczogYW55ID0gW1xyXG4gIF07XHJcbiAgdHlwZTogYW55O1xyXG4gIG1ldGFkYXRhb2JqZWN0aWQ6IGFueTtcclxuICBxb21hbmFnZXJjb2RlOiBhbnk7XHJcbiAgZm9ybXVsYXJXaXphcmQ6IGFueSA9ICcwJztcclxuICBmb3JtdWxhclR5cGUgPSAwOyAvLyAw5pmu6YCa5YWs5byPIDHnu4TlkIjlhazlvI9cclxuICBsb2FkaW5nID0gdGhpcy5sb2FkU2VydmljZS5zaG93KHsgY29udGFpbmVyOiAnYm9keScgfSk7XHJcblxyXG4gIC8qKlxyXG4gICAqIOWbvemZheWMllxyXG4gICAqL1xyXG4gIGxhYmVsU2F2ZUZvcm11bGFyID0gJ+S/neWtmOWFrOW8jyc7XHJcbiAgbGFiZWxHZW5lcmF0ZXJGb3JtdWxhcjogJ+W9ouaIkOWFrOW8jyc7XHJcbiAgbGFiZWxRdWVyeUZ1bmM6ICfkuJrliqHmn6Xor6Llh73mlbAnO1xyXG4gIGxhYmVsQmFzaWNJbmZvOiAn5Z+65pys5L+h5oGvJztcclxuICBsYWJlbEZvcm11bGFyTmFtZTogJ+WFrOW8j+WQjeensCc7XHJcbiAgbGFiZWxJc0dyb3VwOiAn5piv5ZCm5YiG57uEJztcclxuICBsYWJlbFBhcmFtSW5mbzogJ+WPguaVsOS/oeaBryc7XHJcbiAgbGFiZWxSZXN1bHRDb2xJbmZvOiAn57uT5p6c5YiX5L+h5oGvJztcclxuXHJcbiAgcmVzdWx0U29ydENvbHVtbnM6IGFueSA9IFtcclxuICAgIHtcclxuICAgICAgaWQ6ICcwJyxcclxuICAgICAgbGFiZWw6ICfml6AnXHJcbiAgICB9LFxyXG4gICAge1xyXG4gICAgICBpZDogJzEnLFxyXG4gICAgICBsYWJlbDogJ+WNh+W6jydcclxuICAgIH0sXHJcbiAgICB7XHJcbiAgICAgIGlkOiAnMicsXHJcbiAgICAgIGxhYmVsOiAn6ZmN5bqPJ1xyXG4gICAgfVxyXG4gIF07XHJcblxyXG4gIHJlc3VsdENvbFZpc2libGVDb2x1bW5zOiBhbnkgPSBbXHJcbiAgICB7XHJcbiAgICAgIGlkOiAnMCcsXHJcbiAgICAgIGxhYmVsOiAn5ZCmJ1xyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgaWQ6ICcxJyxcclxuICAgICAgbGFiZWw6ICfmmK8nXHJcbiAgICB9XHJcbiAgXTtcclxuXHJcbiAgLyoqXHJcbiAgICog5biu5Yqp6YWN572u5a2X5q61XHJcbiAgICovXHJcbiAgaGVscERhdGE6IGFueSA9IFtdO1xyXG4gIGhlbHBDb2x1bW5zOiBhbnkgPSBbXTtcclxuXHJcbiAgY29uc3RydWN0b3IocHJpdmF0ZSByZXN0ZnVsU2VydmljZTogUmVzdGZ1bFNlcnZpY2VcclxuICAgICwgcHJpdmF0ZSBtc2dTZXJ2aWNlOiBNZXNzYWdlclNlcnZpY2VcclxuICAgICwgcHJpdmF0ZSBjYWNoZVNlcnZpY2U6IENhY2hlU2VydmljZVxyXG4gICAgLCBwcml2YXRlIGxvYWRTZXJ2aWNlOiBMb2FkaW5nU2VydmljZVxyXG4gICAgLCBwcml2YXRlIGVudGl0eURhdGFTZXJ2aWNlOiBFbnRpdHlEYXRhU2VydmljZVxyXG4gICAgLCBwcml2YXRlIGxvY2FsaXplU2VydmljZTogTG9jYWxpemVTZXJ2aWNlKSB7XHJcbiAgICB0aGlzLmxhYmVsU2F2ZUZvcm11bGFyID0gdGhpcy5sb2NhbGl6ZVNlcnZpY2UuZ2V0VmFsdWUoJ2Zvcm11bGFyLmRlZmluZS5sYWJlbFNhdmVGb3JtdWxhcicpO1xyXG4gICAgdGhpcy5sYWJlbEdlbmVyYXRlckZvcm11bGFyID0gdGhpcy5sb2NhbGl6ZVNlcnZpY2UuZ2V0VmFsdWUoJ2Zvcm11bGFyLmRlZmluZS5sYWJlbEdlbmVyYXRlckZvcm11bGFyJyk7XHJcbiAgICB0aGlzLmxhYmVsUXVlcnlGdW5jID0gdGhpcy5sb2NhbGl6ZVNlcnZpY2UuZ2V0VmFsdWUoJ2Zvcm11bGFyLmRlZmluZS5sYWJlbFF1ZXJ5RnVuYycpO1xyXG4gICAgdGhpcy5sYWJlbEJhc2ljSW5mbyA9IHRoaXMubG9jYWxpemVTZXJ2aWNlLmdldFZhbHVlKCdmb3JtdWxhci5kZWZpbmUubGFiZWxCYXNpY0luZm8nKTtcclxuICAgIHRoaXMubGFiZWxGb3JtdWxhck5hbWUgPSB0aGlzLmxvY2FsaXplU2VydmljZS5nZXRWYWx1ZSgnZm9ybXVsYXIuZGVmaW5lLmxhYmVsRm9ybXVsYXJOYW1lJyk7XHJcbiAgICB0aGlzLmxhYmVsSXNHcm91cCA9IHRoaXMubG9jYWxpemVTZXJ2aWNlLmdldFZhbHVlKCdmb3JtdWxhci5kZWZpbmUubGFiZWxJc0dyb3VwJyk7XHJcbiAgICB0aGlzLmxhYmVsUGFyYW1JbmZvID0gdGhpcy5sb2NhbGl6ZVNlcnZpY2UuZ2V0VmFsdWUoJ2Zvcm11bGFyLmRlZmluZS5sYWJlbFBhcmFtSW5mbycpO1xyXG4gICAgdGhpcy5sYWJlbFJlc3VsdENvbEluZm8gPSB0aGlzLmxvY2FsaXplU2VydmljZS5nZXRWYWx1ZSgnZm9ybXVsYXIuZGVmaW5lLmxhYmVsUmVzdWx0Q29sSW5mbycpO1xyXG4gICAgdGhpcy5yZXN1bHRTb3J0Q29sdW1ucyA9IHRoaXMubG9jYWxpemVTZXJ2aWNlLmdldFZhbHVlKCdmb3JtdWxhci5kZWZpbmUucmVzdWx0U29ydENvbHVtbnMnKTtcclxuICAgIHRoaXMucmVzdWx0Q29sVmlzaWJsZUNvbHVtbnMgPSB0aGlzLmxvY2FsaXplU2VydmljZS5nZXRWYWx1ZSgnZm9ybXVsYXIuZGVmaW5lLnJlc3VsdENvbFZpc2libGVDb2x1bW5zJyk7XHJcblxyXG4gIH1cclxuXHJcbiAgbmdPbkluaXQoKSB7XHJcbiAgICB0aGlzLmRhdGEgPSB0aGlzLmNhY2hlU2VydmljZS5nZXQoJ2Zvcm11bGFyUGFyYW0nKTtcclxuICAgIHRoaXMuZm9ybXVsYXJXaXphcmQgPSB0aGlzLmRhdGEuZm9ybXVsYXJXaXphcmQ7XHJcbiAgICB0aGlzLmZvcm11bGFyVHlwZSA9IHRoaXMuZGF0YS5mb3JtdWxhcldpemFyZCA9PT0gJzInID8gMSA6IDA7XHJcbiAgICB0aGlzLmN1cnJlbnRGb3JtdWxhcklkID0gdGhpcy5kYXRhLmN1cnJlbnRGb3JtdWxhcklkO1xyXG4gICAgdGhpcy5jb2x1bW5zID0gW1xyXG4gICAgICAvLyB7IGZpZWxkOiAnaWQnLCB3aWR0aDogMTAwLCB0aXRsZTogJ0lEJyB9LFxyXG4gICAgICB7IGZpZWxkOiAncmVzdWx0Y29sdmlzaWJsZScsIHdpZHRoOiA2MCwgdGl0bGU6IHRoaXMubG9jYWxpemVTZXJ2aWNlLmdldFZhbHVlKCdmb3JtdWxhci5kZWZpbmUuY29sdW1udGl0bGVzLnJlc3VsdGNvbHZpc2libGUnKSwgdGVtcGxhdGU6IHRoaXMucmVzdWx0Q29sVmlzaWJsZUNvbHVtblRlbXAgfSxcclxuICAgICAgeyBmaWVsZDogJ3Jlc3VsdGNvZGUnLCB3aWR0aDogNjAsIHRpdGxlOiB0aGlzLmxvY2FsaXplU2VydmljZS5nZXRWYWx1ZSgnZm9ybXVsYXIuZGVmaW5lLmNvbHVtbnRpdGxlcy5yZXN1bHRjb2RlJyl9LFxyXG4gICAgICB7IGZpZWxkOiAncmVzdWx0ZGVzY3JpcHRpb24nLCB3aWR0aDogNjAsIHRpdGxlOiB0aGlzLmdldFJlc3VsdERlc2NyaXB0aW9uKCl9LFxyXG4gICAgICB7IGZpZWxkOiAncmVzdWx0c29ydCcsIHdpZHRoOiA2MCwgdGl0bGU6IHRoaXMubG9jYWxpemVTZXJ2aWNlLmdldFZhbHVlKCdmb3JtdWxhci5kZWZpbmUuY29sdW1udGl0bGVzLnJlc3VsdHNvcnQnKSwgdGVtcGxhdGU6IHRoaXMucmVzdWx0U29ydENvbHVtblRlbXAgfVxyXG4gICAgXTtcclxuICAgIGlmICh0aGlzLmRhdGEuc2Vzc2lvbklkKSB7XHJcbiAgICAgIHRoaXMuZ2V0RnVuY0luZm8oKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuY3JlYXRlSGVhZGVyU2Vzc2lvbklkKCkuc3Vic2NyaWJlKHNlc3Npb25JZCA9PiB7XHJcbiAgICAgICAgY29uc29sZS5sb2coc2Vzc2lvbklkKTtcclxuICAgICAgICBpZiAoc2Vzc2lvbklkKSB7XHJcbiAgICAgICAgICB0aGlzLmdldEZ1bmNJbmZvKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgZ3VpZCgpIHtcclxuICAgIHJldHVybiAoWzFlN10gYXMgYW55ICsgLTFlMyArIC00ZTMgKyAtOGUzICsgLTFlMTEpLnJlcGxhY2UoL1swMThdL2csIGMgPT5cclxuICAgICAgKGMgXiBjcnlwdG8uZ2V0UmFuZG9tVmFsdWVzKG5ldyBVaW50OEFycmF5KDEpKVswXSAmIDE1ID4+IGMgLyA0KS50b1N0cmluZygxNikpO1xyXG4gIH1cclxuXHJcbiAgZ2V0UmVzdWx0RGVzY3JpcHRpb24oKSB7XHJcbiAgICByZXR1cm4gdGhpcy5nZXRMYW5ndWFnZSgpID09PSAnemgtY2hzJyA/ICfliJfmj4/ov7AnOiAnZGVzY3JpcHRpb24nO1xyXG4gIH1cclxuXHJcbiAgZ2V0TGFuZ3VhZ2UoKSB7XHJcbiAgICBzd2l0Y2godGhpcy5sb2NhbGl6ZVNlcnZpY2UubG9jYWxlSWQpIHtcclxuICAgICAgY2FzZSAnemgtY2hzJzpcclxuICAgICAgY2FzZSAnemgtY24nOlxyXG4gICAgICBjYXNlICd6aCc6XHJcbiAgICAgICAgcmV0dXJuICd6aC1jaHMnO1xyXG4gICAgICBjYXNlICdlbi11cyc6XHJcbiAgICAgIGNhc2UgJ2VuJzpcclxuICAgICAgICByZXR1cm4gJ2VuLXVzJztcclxuICAgIH1cclxuICAgIFxyXG4gICAgcmV0dXJuICd6aC1jaHMnO1xyXG4gIH1cclxuXHJcbiAgbmdBZnRlclZpZXdJbml0KCkge1xyXG4gICAgdGhpcy5sb2FkaW5nLmNsb3NlKCk7XHJcbiAgfVxyXG5cclxuICBoYW5kbGViZWZvcmVDbG9zZSA9ICgpOiBPYnNlcnZhYmxlPGFueT4gPT4ge1xyXG4gICAgcmV0dXJuIG9mKHRydWUpO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBjcmVhdGVIZWFkZXJTZXNzaW9uSWQoKTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgIGNvbnN0IHNlc3Npb25JZCA9IG5ldyBTdWJqZWN0KCk7XHJcbiAgICBjb25zdCBvcHRpb25zOiBhbnkgPSB7XHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXHJcbiAgICAgIH0sXHJcbiAgICAgIHJlc3BvbnNlVHlwZTogJ3RleHQnXHJcbiAgICB9O1xyXG4gICAgY29uc3QgY3JlYXRlU2Vzc2lvblVybCA9IHRoaXMuZGF0YS5zZXJ2ZXJIb3N0ICsgJy9hcGkvZ3NwL2JjYy92MS4wL3F1ZXJ5ZnVuY2RldGFpbF9mcm0vc2VydmljZS9jcmVhdGVzZXNzaW9uJztcclxuICAgIHRoaXMucmVzdGZ1bFNlcnZpY2UucG9zdChjcmVhdGVTZXNzaW9uVXJsLCB7fSwge30sIG9wdGlvbnMpLnN1YnNjcmliZShkYXRhID0+IHtcclxuICAgICAgdGhpcy5kYXRhLnNlc3Npb25JZCA9IGRhdGE7XHJcbiAgICAgIHNlc3Npb25JZC5uZXh0KGRhdGEpO1xyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gc2Vzc2lvbklkO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBnZXRGdW5jSW5mbygpIHtcclxuICAgIGxldCB1cmkgPSB0aGlzLmRhdGEuc2VydmVySG9zdDtcclxuICAgIGNvbnN0IG9wdGlvbnMgPSB7XHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICAnU2Vzc2lvbklkJzogdGhpcy5kYXRhLnNlc3Npb25JZCxcclxuICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXHJcbiAgICAgIH1cclxuICAgIH07XHJcbiAgICBjb25zdCBlbnRpdHlGaWx0ZXIgPSB7XHJcbiAgICAgIEZpbHRlckNvbmRpdGlvbnM6IFt7ICdGaWx0ZXJGaWVsZCc6ICdTcmNTVScsICdWYWx1ZSc6IHRoaXMuZGF0YS5jdXJyZW50U1UsICdMYnJhY2tldCc6IG51bGwsICdSYnJhY2tldCc6IG51bGwsICdSZWxhdGlvbic6IDAsICdFeHByZXNzdHlwZSc6IDAsICdDb21wYXJlJzogNiB9XSxcclxuICAgICAgU29ydENvbmRpdGlvbnM6IFtdLFxyXG4gICAgICBJc1VzZVBhZ2luYXRpb246IGZhbHNlLFxyXG4gICAgICBQYWdpbmF0aW9uOiB7XHJcbiAgICAgICAgUGFnZUluZGV4OiAwLFxyXG4gICAgICAgIFBhZ2VTaXplOiAwLFxyXG4gICAgICAgIFBhZ2VDb3VudDogMCxcclxuICAgICAgICBUb3RhbENvdW50OiAwXHJcbiAgICAgIH1cclxuICAgIH07XHJcbiAgICB1cmkgKz0gJy9hcGkvZ3NwL2JjYy92MS4wL3F1ZXJ5ZnVuY2RldGFpbF9mcm0vZXh0ZW5zaW9uL3F1ZXJ5P2VudGl0eUZpbHRlcj0nICsgSlNPTi5zdHJpbmdpZnkoZW50aXR5RmlsdGVyKTtcclxuICAgIHRoaXMucmVzdGZ1bFNlcnZpY2UucHV0KHVyaSwge30sIHt9LCBvcHRpb25zKS5zdWJzY3JpYmUoZGF0YSA9PiB7XHJcbiAgICAgIGNvbnN0IGZ1bmNEYXRhcyA9IGRhdGEucmV0dXJuVmFsdWUucmVzdWx0O1xyXG4gICAgICBpZiAoZnVuY0RhdGFzICYmIGZ1bmNEYXRhcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgZnVuY0RhdGFzLmZvckVhY2goeCA9PiB7XHJcbiAgICAgICAgICB0aGlzLmZ1bmNEYXRhLnB1c2goeyBuYW1lOiB4Lm5hbWUsIHZhbHVlOiB4LmlkIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICAgIHRoaXMuY3VycmVudEZ1bmNEYXRhcyA9IGZ1bmNEYXRhcztcclxuICAgICAgLy8g5aaC5p6c6YCJ5oup55qE5piv6YCJ5oup5YWs5byP77yM5qC55o2u5YWs56S65L+h5oGv5Yid5aeL6buY6K6k55qE5pWw5o2uXHJcbiAgICAgIGlmICh0aGlzLmN1cnJlbnRGb3JtdWxhcklkICYmIHRoaXMuZGF0YS5mb3JtdWxhckRhdGEgJiYgdGhpcy5kYXRhLmZvcm11bGFyRGF0YS5udW0xID09PSAxKSB7XHJcbiAgICAgICAgdGhpcy5uYW1lID0gdGhpcy5kYXRhLmZvcm11bGFyRGF0YS5uYW1lO1xyXG4gICAgICAgIHRoaXMuZm9ybXVsYXJUZXh0ID0gdGhpcy5kYXRhLmZvcm11bGFyRGF0YS5zdHI2O1xyXG4gICAgICAgIHRoaXMuZm9ybXVsYXJUeXBlID0gMTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICB0aGlzLmdldEZvcm11bGFySW5mbygpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgZ2V0Rm9ybXVsYXJJbmZvKCkge1xyXG4gICAgLy8g5riF56m65Y6G5Y+y5pWw5o2uXHJcbiAgICB0aGlzLmR5bmFtaWNJbnB1dCA9IFtdO1xyXG4gICAgdGhpcy5yZXN1bHRDb2x1bW5zID0gW107XHJcbiAgICB0aGlzLnJlc3VsdERhdGFzID0gW107XHJcbiAgICB0aGlzLmZvcm11bGFyVGV4dCA9ICcnO1xyXG4gICAgdGhpcy5uYW1lID0gJyc7XHJcbiAgICB0aGlzLmlzR3JvdXAgPSAwO1xyXG5cclxuICAgIGlmICh0aGlzLmN1cnJlbnRGb3JtdWxhcklkKSB7XHJcbiAgICAgIGNvbnN0IG9wdGlvbnMgPSB7XHJcbiAgICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgICAgJ1Nlc3Npb25JZCc6IHRoaXMuZGF0YS5zZXNzaW9uSWQsXHJcbiAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXHJcbiAgICAgICAgfVxyXG4gICAgICB9O1xyXG4gICAgICBjb25zdCByZXRyaWV2ZVVyaSA9IHRoaXMuZGF0YS5zZXJ2ZXJIb3N0ICsgJy9hcGkvZ3NwL2JjYy92MS4wL3F1ZXJ5Z2V0ZGF0YWRldGFpbF9mcm0vZXh0ZW5zaW9uL3JldHJpZXZlLycgKyB0aGlzLmN1cnJlbnRGb3JtdWxhcklkO1xyXG4gICAgICB0aGlzLnJlc3RmdWxTZXJ2aWNlLnB1dChyZXRyaWV2ZVVyaSwge30sIHt9LCBvcHRpb25zKS5zdWJzY3JpYmUoZGF0YSA9PiB7XHJcbiAgICAgICAgY29uc3QgZm9ybXVsYXJEYXRhID0gZGF0YS5yZXR1cm5WYWx1ZTtcclxuICAgICAgICBpZiAoZm9ybXVsYXJEYXRhKSB7XHJcbiAgICAgICAgICAvLyDliJ3lp4vln7rnoYDmlbDmja5cclxuICAgICAgICAgIHRoaXMubmFtZSA9IGZvcm11bGFyRGF0YS5uYW1lO1xyXG4gICAgICAgICAgdGhpcy5kYXRhLmN1cnJlbnRGb3JtdWxhck5hbWUgPSBmb3JtdWxhckRhdGEubmFtZTtcclxuICAgICAgICAgIHRoaXMuaXNHcm91cCA9IGZvcm11bGFyRGF0YS5pc0dyb3VwO1xyXG4gICAgICAgICAgY29uc3QgcXVlcnlGdW5jSWQgPSBmb3JtdWxhckRhdGEucXVlcnlGdW5jO1xyXG4gICAgICAgICAgdGhpcy50eXBlID0gZm9ybXVsYXJEYXRhLnN0cjE7XHJcbiAgICAgICAgICB0aGlzLm1ldGFkYXRhb2JqZWN0aWQgPSBmb3JtdWxhckRhdGEuc3RyMjtcclxuICAgICAgICAgIHRoaXMuZnVuY1NlbGVjdFZhbHVlID0gdGhpcy5mdW5jRGF0YS5maW5kKHggPT4geC52YWx1ZSA9PT0gcXVlcnlGdW5jSWQpO1xyXG4gICAgICAgICAgdGhpcy5lbnRpdHlEYXRhU2VydmljZS5zZXRGb3JtdWxhclN0YXRlKHRydWUsIHsgaWQ6IHRoaXMuY3VycmVudEZvcm11bGFySWQsIG5hbWU6IHRoaXMubmFtZSB9KTtcclxuICAgICAgICAgIGlmIChxdWVyeUZ1bmNJZCkge1xyXG4gICAgICAgICAgICB0aGlzLmdldERyb3BEb3duSW5mbyhxdWVyeUZ1bmNJZCwgdGhpcy50eXBlLCB0aGlzLm1ldGFkYXRhb2JqZWN0aWQsIHRydWUsIGZvcm11bGFyRGF0YS5xdWVyeUdldERhdGFQYXJhbUluZm9zKTtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAvLyBjb25zdCBjdXJyZW50UXVlcnlHZXREYXRhUGFyYW1zID0gZm9ybXVsYXJEYXRhLnF1ZXJ5R2V0RGF0YVBhcmFtSW5mb3M7XHJcbiAgICAgICAgICBjb25zdCBxdWVyeUZ1bmNSZXN1bHRzID0gZm9ybXVsYXJEYXRhLnF1ZXJ5R2V0RGF0YVJlc3VsdEluZm9zO1xyXG4gICAgICAgICAgLy8gaWYgKGN1cnJlbnRRdWVyeUdldERhdGFQYXJhbXMgJiYgY3VycmVudFF1ZXJ5R2V0RGF0YVBhcmFtcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAvLyAgIGN1cnJlbnRRdWVyeUdldERhdGFQYXJhbXMuZm9yRWFjaChxdWVyeUdldERhdGFQYXJhbSA9PiB7XHJcbiAgICAgICAgICAvLyAgICAgY29uc3QgZmllbGRDb25maWcgPSBKU09OLnBhcnNlKHF1ZXJ5R2V0RGF0YVBhcmFtLmZpZWxkQ29uZmlnKTtcclxuICAgICAgICAgIC8vICAgICBpZiAoZmllbGRDb25maWcuY29udHJvbHR5cGUgPT09ICdkcm9wZG93bicpIHtcclxuICAgICAgICAgIC8vICAgICAgIGZpZWxkQ29uZmlnLmVudW1WYWx1ZXMgPSBKU09OLnBhcnNlKGZpZWxkQ29uZmlnLmVudW1WYWx1ZXMpO1xyXG4gICAgICAgICAgLy8gICAgIH1cclxuICAgICAgICAgIC8vICAgICB0aGlzLmR5bmFtaWNJbnB1dC5wdXNoKHsgcGFyYW1jb2RlOiBxdWVyeUdldERhdGFQYXJhbS5wYXJhbUNvZGUsIHBhcmFtbmFtZTogcXVlcnlHZXREYXRhUGFyYW0ucGFyYW1OYW1lLCBwYXJhbXZhbHVlOiBxdWVyeUdldERhdGFQYXJhbS5wYXJhbVZhbHVlLCBmaWVsZENvbmZpZzogSlNPTi5wYXJzZShxdWVyeUdldERhdGFQYXJhbS5maWVsZENvbmZpZykgfSk7XHJcbiAgICAgICAgICAvLyAgIH0pO1xyXG4gICAgICAgICAgLy8gfVxyXG4gICAgICAgICAgaWYgKHF1ZXJ5RnVuY1Jlc3VsdHMgJiYgcXVlcnlGdW5jUmVzdWx0cy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdENvbHVtbnMgPSBbXTtcclxuICAgICAgICAgICAgY29uc3QgZGF0YSA9IFtdO1xyXG4gICAgICAgICAgICBxdWVyeUZ1bmNSZXN1bHRzLmZvckVhY2gocXVlcnlGdW5jUmVzdWx0ID0+IHtcclxuICAgICAgICAgICAgICByZXN1bHRDb2x1bW5zLnB1c2goeyBpZDogcXVlcnlGdW5jUmVzdWx0LnJlc3VsdENvZGUsIGxhYmVsOiBxdWVyeUZ1bmNSZXN1bHQucmVzdWx0TmFtZSB9KTtcclxuICAgICAgICAgICAgICBkYXRhLnB1c2goeyBcclxuICAgICAgICAgICAgICAgIGlkOiBxdWVyeUZ1bmNSZXN1bHQuaWQsXHJcbiAgICAgICAgICAgICAgICByZXN1bHRjb2RlOiBxdWVyeUZ1bmNSZXN1bHQucmVzdWx0Q29kZSxcclxuICAgICAgICAgICAgICAgIHJlc3VsdHNvcnQ6IHF1ZXJ5RnVuY1Jlc3VsdC5yZXN1bHRTb3J0LFxyXG4gICAgICAgICAgICAgICAgcmVzdWx0bmFtZTogcXVlcnlGdW5jUmVzdWx0LnJlc3VsdE5hbWUsXHJcbiAgICAgICAgICAgICAgICByZXN1bHRjb2x2aXNpYmxlOiBxdWVyeUZ1bmNSZXN1bHQucmVzdWx0Q29sVmlzaWJsZSA9PT0gdHJ1ZSA/ICcxJyA6ICcwJyxcclxuICAgICAgICAgICAgICAgIHJlc3VsdGRlc2NyaXB0aW9uOiAnJ1xyXG4gICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgdGhpcy5yZXN1bHRDb2x1bW5zID0gWy4uLnJlc3VsdENvbHVtbnNdO1xyXG4gICAgICAgICAgICB0aGlzLnJlc3VsdERhdGFzID0gWy4uLmRhdGFdO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBnZW5lcmF0ZUZvcm11bGFyKCkge1xyXG4gICAgaWYgKCF0aGlzLm5hbWUpIHtcclxuICAgICAgdGhpcy5tc2dTZXJ2aWNlLmluZm8odGhpcy5sb2NhbGl6ZVNlcnZpY2UuZ2V0VmFsdWUoJ2Zvcm11bGFyLmRlZmluZS5tZXNzYWdlQWxlcnQubmFtZVZlcmlmeScpKTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgaWYgKCF0aGlzLmZ1bmNTZWxlY3RWYWx1ZSkge1xyXG4gICAgICB0aGlzLm1zZ1NlcnZpY2UuaW5mbyh0aGlzLmxvY2FsaXplU2VydmljZS5nZXRWYWx1ZSgnZm9ybXVsYXIuZGVmaW5lLm1lc3NhZ2VBbGVydC5mdW5jVmVyaWZ5JykpO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBjb25zdCBmb3JtdWxhckluZm86IGFueSA9IHtcclxuICAgICAgaWQ6IHRoaXMuY3VycmVudEZvcm11bGFySWQsXHJcbiAgICAgIGN1cnN1OiB0aGlzLmRhdGEuY3VycmVudFNVLFxyXG4gICAgICBpc2dyb3VwOiB0aGlzLmlzR3JvdXAgPyAxIDogMCxcclxuICAgICAgbmFtZTogdGhpcy5uYW1lLFxyXG4gICAgICBxdWVyeWZ1bmM6IHRoaXMuZnVuY1NlbGVjdFZhbHVlLnZhbHVlLFxyXG4gICAgICBzdHIxOiB0aGlzLnR5cGUsXHJcbiAgICAgIHN0cjI6IHRoaXMubWV0YWRhdGFvYmplY3RpZCxcclxuICAgICAgc3RyMzogdGhpcy5xb21hbmFnZXJjb2RlID8gdGhpcy5xb21hbmFnZXJjb2RlIDogJycsXHJcbiAgICAgIHN0cjQ6IHRoaXMuZnVuY1NlbGVjdFZhbHVlLm5hbWUsXHJcbiAgICAgIHN0cjU6ICcnLFxyXG4gICAgICBzdHI2OiAnJyxcclxuICAgICAgZm9ybXVsYXJQYXJhbUluZm9zOiB0aGlzLmR5bmFtaWNJbnB1dCxcclxuICAgICAgZm9ybXVsYXJSZXN1bHRJbmZvczogdGhpcy5yZXN1bHREYXRhc1xyXG4gICAgfTtcclxuICAgIGNvbnN0IG9wdGlvbnMgPSB7XHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICAnU2Vzc2lvbklkJzogdGhpcy5kYXRhLnNlc3Npb25JZCxcclxuICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXHJcbiAgICAgIH1cclxuICAgIH07XHJcbiAgICBpZiAoZm9ybXVsYXJJbmZvKSB7XHJcbiAgICAgIGNvbnN0IHJldHJpZXZlVXJpID0gdGhpcy5kYXRhLnNlcnZlckhvc3QgKyAnL2FwaS9nc3AvYmNjL3YxLjAvcXVlcnlnZXRkYXRhZGV0YWlsX2ZybS9zZXJ2aWNlL3NhdmVxZHBmb3JtdWxhcic7XHJcbiAgICAgIHRoaXMucmVzdGZ1bFNlcnZpY2UucHV0KHJldHJpZXZlVXJpLCB7IGZvcm11bGFySW5mbzogSlNPTi5zdHJpbmdpZnkoZm9ybXVsYXJJbmZvKSB9LCB7fSwgb3B0aW9ucykuc3Vic2NyaWJlKGRhdGEgPT4ge1xyXG4gICAgICAgIGNvbnN0IGZvcm11bGFyRGF0YSA9IGRhdGEucmV0dXJuVmFsdWU7XHJcbiAgICAgICAgaWYgKGZvcm11bGFyRGF0YSkge1xyXG4gICAgICAgICAgdGhpcy5jdXJyZW50Rm9ybXVsYXJJZCA9IGZvcm11bGFyRGF0YTtcclxuICAgICAgICAgIHRoaXMuZW50aXR5RGF0YVNlcnZpY2Uuc2V0Rm9ybXVsYXJTdGF0ZSh0cnVlLCB7IGlkOiB0aGlzLmN1cnJlbnRGb3JtdWxhcklkLCBuYW1lOiB0aGlzLm5hbWUgfSk7XHJcbiAgICAgICAgICAvLyB0aGlzLmVudGl0eURhdGFTZXJ2aWNlLmlzRmluaXNoID0gdHJ1ZTtcclxuICAgICAgICAgIHRoaXMubXNnU2VydmljZS5pbmZvKHRoaXMubG9jYWxpemVTZXJ2aWNlLmdldFZhbHVlKCdmb3JtdWxhci5kZWZpbmUubWVzc2FnZUFsZXJ0LnNhdmVGb3JtdWxhcicpKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgZ2VuZXJhdGVGb3JtdWxhckluZm8oKSB7XHJcbiAgICBpZiAoIXRoaXMuY3VycmVudEZ1bmN0aW9uSWQpIHtcclxuICAgICAgdGhpcy5tc2dTZXJ2aWNlLmluZm8odGhpcy5sb2NhbGl6ZVNlcnZpY2UuZ2V0VmFsdWUoJ2Zvcm11bGFyLmRlZmluZS5tZXNzYWdlQWxlcnQucGxlYXNlU2VsZWN0UXVlcnlGdW5jJykpO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBpZiAodGhpcy5yZXN1bHREYXRhcyAmJiB0aGlzLnJlc3VsdERhdGFzLmZpbHRlcih4ID0+IHgucmVzdWx0Y29sdmlzaWJsZSA9PT0gJzEnKS5sZW5ndGggIT09IDEpIHtcclxuICAgICAgdGhpcy5tc2dTZXJ2aWNlLmluZm8odGhpcy5sb2NhbGl6ZVNlcnZpY2UuZ2V0VmFsdWUoJ2Zvcm11bGFyLmRlZmluZS5tZXNzYWdlQWxlcnQucmVzdWx0VmVyaWZ5JykpO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBjb25zdCBwYXJhbUluZm8gPSBbXTtcclxuICAgIHRoaXMuZHluYW1pY0lucHV0LmZvckVhY2goeCA9PiB7XHJcbiAgICAgIHBhcmFtSW5mby5wdXNoKHsga2V5OiB4LnBhcmFtY29kZSwgdmFsdWU6IHgucGFyYW12YWx1ZSA/IHgucGFyYW12YWx1ZSA6ICcnIH0pO1xyXG4gICAgfSk7XHJcbiAgICBjb25zdCBmb3JtdWxhcmNvbXBpbGUgPSB7XHJcbiAgICAgIGZ1bmNJZDogdGhpcy5jdXJyZW50RnVuY3Rpb25JZCxcclxuICAgICAgcGFyYW1JbmZvczogcGFyYW1JbmZvLFxyXG4gICAgICByZXN1bHRDb2xOYW1lOiB0aGlzLnJlc3VsdERhdGFzWzBdLnJlc3VsdGNvZGUsXHJcbiAgICAgIHFvbWFuYWdlcmNvZGU6IHRoaXMucW9tYW5hZ2VyY29kZSxcclxuICAgICAgaXNncm91cDogdGhpcy5pc0dyb3VwID8gMSA6IDBcclxuICAgIH07XHJcbiAgICB0aGlzLmZvcm11bGFyVGV4dCA9IHRoaXMuZm9ybXVsYXJUZXh0ICsgJ1FEUEZvcm11bGFyLmV4ZWN1dGUoJyArIEpTT04uc3RyaW5naWZ5KGZvcm11bGFyY29tcGlsZSkgKyAnKSAnO1xyXG4gIH1cclxuXHJcbiAgb3BlcmF0b3IoJGV2ZW50KSB7XHJcbiAgICB0aGlzLmZvcm11bGFyVGV4dCA9IHRoaXMuZm9ybXVsYXJUZXh0ICsgJGV2ZW50O1xyXG4gIH1cclxuXHJcbiAgb25SZXNpemVkKGV2ZW50KSB7XHJcbiAgICB0aGlzLnNpemUuaGVpZ2h0ID0gZXZlbnQubmV3SGVpZ2h0O1xyXG4gICAgdGhpcy5zaXplLndpZHRoID0gZXZlbnQubmV3V2lkdGg7XHJcbiAgfVxyXG5cclxuICBzZWxlY3Rpb25DaGFuZ2UoJGV2ZW50KSB7XHJcbiAgICAvLyDmuIXnqbrljoblj7LmlbDmja5cclxuICAgIHRoaXMuZHluYW1pY0lucHV0ID0gW107XHJcbiAgICB0aGlzLnJlc3VsdENvbHVtbnMgPSBbXTtcclxuICAgIHRoaXMucmVzdWx0RGF0YXMgPSBbXTtcclxuICAgIHRoaXMubmFtZSA9IHRoaXMuZm9ybXVsYXJUeXBlID09PSAxID8gdGhpcy5uYW1lIDogJyc7XHJcbiAgICB0aGlzLmlzR3JvdXAgPSAwO1xyXG4gICAgaWYgKCRldmVudCAmJiAkZXZlbnQudmFsdWUpIHtcclxuICAgICAgdGhpcy5jdXJyZW50RnVuY3Rpb25JZCA9ICRldmVudC52YWx1ZTtcclxuICAgICAgY29uc3QgZnVuY0RhdGEgPSB0aGlzLmN1cnJlbnRGdW5jRGF0YXMuZmluZCh4ID0+IHguaWQgPT09IHRoaXMuY3VycmVudEZ1bmN0aW9uSWQpO1xyXG4gICAgICB0aGlzLm5hbWUgPSB0aGlzLm5hbWUgPT09ICcnID8gZnVuY0RhdGEubmFtZSA6IHRoaXMubmFtZTtcclxuICAgICAgLy8g5L+d5a2Y5YWs5byP57G75Z6L5Y+K5YWD5pWw5o2uaWRcclxuICAgICAgdGhpcy50eXBlID0gZnVuY0RhdGEuc3JjVHlwZTtcclxuICAgICAgdGhpcy5tZXRhZGF0YW9iamVjdGlkID0gZnVuY0RhdGEubWV0YWRhdGFPYmplY3Q7XHJcbiAgICAgIGlmICh0aGlzLmN1cnJlbnRGdW5jdGlvbklkKSB7XHJcbiAgICAgICAgdGhpcy5nZXREcm9wRG93bkluZm8odGhpcy5jdXJyZW50RnVuY3Rpb25JZCwgdGhpcy50eXBlLCB0aGlzLm1ldGFkYXRhb2JqZWN0aWQsIHRydWUsICcnKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8g5Yid5aeL5LiL5ouJ5L+h5oGvXHJcbiAgZ2V0RHJvcERvd25JbmZvKGZ1bmNpZDogYW55LCB0eXBlOiBhbnksIG1ldGFkYXRhb2JqZWN0aWQ6IGFueSwgZ2VuZXJhdGVEYXRhOiBhbnksIHF1ZXJ5Rm9ybXVsYXJQYXJhbTogYW55KSB7XHJcbiAgICBjb25zdCBzZWxmID0gdGhpcztcclxuICAgIC8vIOiuv+mXruaVsOaNruacjeWKoVxyXG4gICAgY29uc3Qgb3B0aW9ucyA9IHtcclxuICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgICdTZXNzaW9uSWQnOiBzZWxmLmRhdGEuc2Vzc2lvbklkLFxyXG4gICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcclxuICAgICAgfVxyXG4gICAgfTtcclxuICAgIGNvbnN0IHVybCA9IHNlbGYuZGF0YS5zZXJ2ZXJIb3N0ICsgJy9hcGkvZ3NwL2JjYy92MS4wL3F1ZXJ5ZnVuY2RldGFpbF9mcm0vZXh0ZW5zaW9uL3JldHJpZXZlLycgKyBmdW5jaWQ7XHJcbiAgICBzZWxmLnJlc3RmdWxTZXJ2aWNlLnB1dCh1cmwsIHt9LCB7fSwgb3B0aW9ucykudG9Qcm9taXNlKCkudGhlbihmdW5jdGlvbiAodmFsdWUpIHtcclxuICAgICAgaWYgKHZhbHVlKSB7XHJcbiAgICAgICAgdmFsdWUgPSB2YWx1ZS5yZXR1cm5WYWx1ZTtcclxuICAgICAgICAvLyDmn6Xor6Llj4LmlbBcclxuICAgICAgICBpZiAoZ2VuZXJhdGVEYXRhKSB7XHJcbiAgICAgICAgICBsZXQgcXVlcnlGdW5jUGFyYW1zID0gdmFsdWUucXVlcnlGdW5jUGFyYW1zO1xyXG4gICAgICAgICAgaWYgKHF1ZXJ5RnVuY1BhcmFtcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIC8vIGlmIChjdXJyZW50UXVlcnlHZXREYXRhUGFyYW1zICYmIGN1cnJlbnRRdWVyeUdldERhdGFQYXJhbXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAvLyAgIGN1cnJlbnRRdWVyeUdldERhdGFQYXJhbXMuZm9yRWFjaChxdWVyeUdldERhdGFQYXJhbSA9PiB7XHJcbiAgICAgICAgICAgIC8vICAgICBjb25zdCBmaWVsZENvbmZpZyA9IEpTT04ucGFyc2UocXVlcnlHZXREYXRhUGFyYW0uZmllbGRDb25maWcpO1xyXG4gICAgICAgICAgICAvLyAgICAgaWYgKGZpZWxkQ29uZmlnLmNvbnRyb2x0eXBlID09PSAnZHJvcGRvd24nKSB7XHJcbiAgICAgICAgICAgIC8vICAgICAgIGZpZWxkQ29uZmlnLmVudW1WYWx1ZXMgPSBKU09OLnBhcnNlKGZpZWxkQ29uZmlnLmVudW1WYWx1ZXMpO1xyXG4gICAgICAgICAgICAvLyAgICAgfVxyXG4gICAgICAgICAgICAvLyAgICAgdGhpcy5keW5hbWljSW5wdXQucHVzaCh7IHBhcmFtY29kZTogcXVlcnlHZXREYXRhUGFyYW0ucGFyYW1Db2RlLCBwYXJhbW5hbWU6IHF1ZXJ5R2V0RGF0YVBhcmFtLnBhcmFtTmFtZSwgcGFyYW12YWx1ZTogcXVlcnlHZXREYXRhUGFyYW0ucGFyYW1WYWx1ZSwgZmllbGRDb25maWc6IEpTT04ucGFyc2UocXVlcnlHZXREYXRhUGFyYW0uZmllbGRDb25maWcpIH0pO1xyXG4gICAgICAgICAgICAvLyAgIH0pO1xyXG4gICAgICAgICAgICAvLyB9XHJcbiAgICAgICAgICAgIHF1ZXJ5RnVuY1BhcmFtcyA9IHF1ZXJ5RnVuY1BhcmFtcy5zb3J0KHNlbGYuc29ydERhdGEpO1xyXG4gICAgICAgICAgICBxdWVyeUZ1bmNQYXJhbXMuZm9yRWFjaChmdW5jUGFyYW0gPT4ge1xyXG4gICAgICAgICAgICAgIGlmIChmdW5jUGFyYW0pIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGZpZWxkQ29uZmlnID0gSlNPTi5wYXJzZShmdW5jUGFyYW0uZmllbGRDb25maWcpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGZpZWxkQ29uZmlnLmNvbnRyb2x0eXBlID09PSAnZHJvcGRvd24nKSB7XHJcbiAgICAgICAgICAgICAgICAgIGZpZWxkQ29uZmlnLmVudW1WYWx1ZXMgPSBmaWVsZENvbmZpZy5lbnVtVmFsdWVzO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgbGV0IGZpbmRQYXJhbUluZm87XHJcbiAgICAgICAgICAgICAgICBpZiAocXVlcnlGb3JtdWxhclBhcmFtICYmIHF1ZXJ5Rm9ybXVsYXJQYXJhbS5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgIGZpbmRQYXJhbUluZm8gPSBxdWVyeUZvcm11bGFyUGFyYW0uZmluZCh4ID0+IHgucGFyYW1Db2RlID09PSBmdW5jUGFyYW0uY29kZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBsZXQgcGFyYW12YWx1ZSA9IChmaW5kUGFyYW1JbmZvICYmIGZpbmRQYXJhbUluZm8ucGFyYW1WYWx1ZSkgPyBmaW5kUGFyYW1JbmZvLnBhcmFtVmFsdWUgOiAnJztcclxuICAgICAgICAgICAgICAgIGZpZWxkQ29uZmlnLnBhcmFtdmFsdWVuYW1lID0gJyc7XHJcbiAgICAgICAgICAgICAgICBpZiAoZmllbGRDb25maWcuY29udHJvbHR5cGUgPT09ICdoZWxwJyAmJiBmaW5kUGFyYW1JbmZvKSB7XHJcbiAgICAgICAgICAgICAgICAgIGNvbnN0IHBhcmFtdmFsdWVhcnJheSA9IHBhcmFtdmFsdWUuc3BsaXQoJ3wnKTtcclxuICAgICAgICAgICAgICAgICAgcGFyYW12YWx1ZSA9IHBhcmFtdmFsdWVhcnJheVswXTtcclxuICAgICAgICAgICAgICAgICAgZmllbGRDb25maWcucGFyYW12YWx1ZW5hbWUgPSBwYXJhbXZhbHVlYXJyYXlbMV07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBzZWxmLmR5bmFtaWNJbnB1dC5wdXNoKHsgaWQ6IGZpbmRQYXJhbUluZm8gPyBmaW5kUGFyYW1JbmZvLmlkIDogJycsIHBhcmFtY29kZTogZnVuY1BhcmFtLmNvZGUsIHBhcmFtbmFtZTogZnVuY1BhcmFtLm5hbWUsIHBhcmFtdmFsdWU6IHBhcmFtdmFsdWUsIGZpZWxkQ29uZmlnOiBmaWVsZENvbmZpZyB9KTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGdlbmVyYXRlRGF0YSkgeyAvLyDmlrDlu7rmiJbogIXnu4TlkIjlhazlvI/osIPnlKjmraTpgLvovpFcclxuICAgICAgICAgIHNlbGYucmVzdWx0Q29sdW1ucyA9IFtdO1xyXG4gICAgICAgICAgaWYgKHR5cGUgPT09ICdCRScpIHtcclxuICAgICAgICAgICAgY29uc3QgcXVlcnlGdW5jUmVzdWx0cyA9IHZhbHVlLnF1ZXJ5RnVuY1Jlc3VsdHM7XHJcbiAgICAgICAgICAgIGlmIChxdWVyeUZ1bmNSZXN1bHRzLmxlbmd0aCA+IDApIHtcclxuXHJcbiAgICAgICAgICAgICAgY29uc3QgZnVuY1Jlc3VsdERhdGFzID0gW107XHJcbiAgICAgICAgICAgICAgcXVlcnlGdW5jUmVzdWx0cy5mb3JFYWNoKGZ1bmNSZXN1bHQgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKGZ1bmNSZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgICAgLy8gc2VsZi5yZXN1bHRDb2x1bW5zLnB1c2goeyBpZDogZnVuY1Jlc3VsdC5zcmNDb2wsIGxhYmVsOiBmdW5jUmVzdWx0LmNvbE5hbWUgfSk7XHJcbiAgICAgICAgICAgICAgICAgIGZ1bmNSZXN1bHREYXRhcy5wdXNoKHsgaWQ6IHNlbGYuZ3VpZCgpLCByZXN1bHRjb2RlOiBmdW5jUmVzdWx0LnNyY0NvbCwgcmVzdWx0c29ydDogJzAnLCByZXN1bHRuYW1lOiBmdW5jUmVzdWx0LmNvbE5hbWUsXHJcbiAgICAgICAgICAgICAgICAgICByZXN1bHRjb2x2aXNpYmxlOiAnMScsIHJlc3VsdGRlc2NyaXB0aW9uOiBmdW5jUmVzdWx0LmRlc2NyaXB0aW9uIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICBpZiAoZnVuY1Jlc3VsdERhdGFzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgIGlmIChzZWxmLnJlc3VsdERhdGFzICYmIHNlbGYucmVzdWx0RGF0YXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICBsZXQgbmV3UmVzdWx0RGF0YXMgPSBbXTtcclxuICAgICAgICAgICAgICAgICAgZm9yIChsZXQgZnVuY1Jlc3VsdERhdGEgb2YgZnVuY1Jlc3VsdERhdGFzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0RGF0YSA9IHNlbGYucmVzdWx0RGF0YXMuZmluZCh4ID0+IHgucmVzdWx0Y29kZSA9PT0gZnVuY1Jlc3VsdERhdGEucmVzdWx0Y29kZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdERhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgIG5ld1Jlc3VsdERhdGFzLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAuLi5yZXN1bHREYXRhLCByZXN1bHRkZXNjcmlwdGlvbjogZnVuY1Jlc3VsdERhdGEucmVzdWx0ZGVzY3JpcHRpb25cclxuICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgIG5ld1Jlc3VsdERhdGFzLnB1c2goZnVuY1Jlc3VsdERhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgbGV0IHJlc3VsdENvbHVtbnMxID0gW107XHJcbiAgICAgICAgICAgICAgICAgIG5ld1Jlc3VsdERhdGFzLmZvckVhY2gobSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0Q29sdW1uczEucHVzaCh7IGlkOiBtLnJlc3VsdGNvZGUsIGxhYmVsOiBtLnJlc3VsdG5hbWUgfSk7XHJcbiAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICBzZWxmLnJlc3VsdENvbHVtbnMgPSBbLi4ucmVzdWx0Q29sdW1uczFdO1xyXG5cclxuICAgICAgICAgICAgICAgICAgc2VsZi5yZXN1bHREYXRhcyA9IFsuLi5uZXdSZXN1bHREYXRhc107XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgbGV0IHJlc3VsdENvbHVtbnMxID0gW107XHJcbiAgICAgICAgICAgICAgICAgIGZ1bmNSZXN1bHREYXRhcy5mb3JFYWNoKG0gPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdENvbHVtbnMxLnB1c2goeyBpZDogbS5yZXN1bHRjb2RlLCBsYWJlbDogbS5yZXN1bHRuYW1lIH0pO1xyXG4gICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgc2VsZi5yZXN1bHRDb2x1bW5zID0gWy4uLnJlc3VsdENvbHVtbnMxXTtcclxuXHJcbiAgICAgICAgICAgICAgICAgIHNlbGYucmVzdWx0RGF0YXMgPSBbLi4uZnVuY1Jlc3VsdERhdGFzXTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAvLyBzZWxmLnJlc3VsdERhdGFzID0gWy4uLmZ1bmNSZXN1bHREYXRhc107XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zdCBvcHRpb25zID0ge1xyXG4gICAgICAgICAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICAgICAgICAgICdTZXNzaW9uSWQnOiBzZWxmLmRhdGEuc2Vzc2lvbklkLFxyXG4gICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgLy8g5qC55o2uaWTojrflj5blhYPmlbDmja7kv6Hmga9cclxuICAgICAgICAgICAgc2VsZi5yZXN0ZnVsU2VydmljZS5nZXQoc2VsZi5kYXRhLnNlcnZlckhvc3QgKyAnL2FwaS9ydW50aW1lL3N5cy92MS4wL3J0LW1ldGFkYXRhcy8nICsgbWV0YWRhdGFvYmplY3RpZCwge30sIG9wdGlvbnMpLnN1YnNjcmliZShtZXRhZGF0YUNvbnRlbnQgPT4ge1xyXG4gICAgICAgICAgICAgIGlmIChtZXRhZGF0YUNvbnRlbnQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRNZXRhZGF0YUNvbnRlbnQgPSBKU09OLnBhcnNlKG1ldGFkYXRhQ29udGVudFsnY29udGVudCddKTtcclxuICAgICAgICAgICAgICAgIGxldCBtYWluT2JqZWN0ID0gY3VycmVudE1ldGFkYXRhQ29udGVudC5RdWVyeU5vZGU7XHJcbiAgICAgICAgICAgICAgICBpZiAoIW1haW5PYmplY3QpIHsgbWFpbk9iamVjdCA9IGN1cnJlbnRNZXRhZGF0YUNvbnRlbnQuRGF0YVNvdXJjZXNbJzAnXS5RdWVyeU5vZGU7IH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IGRhdGFzID0gW107XHJcbiAgICAgICAgICAgICAgICBtYWluT2JqZWN0LkNvbnRhaW5FbGVtZW50cy5mb3JFYWNoKGNvbnRhaW5FbGVtZW50ID0+IHtcclxuICAgICAgICAgICAgICAgICAgc2VsZi5yZXN1bHRDb2x1bW5zLnB1c2goeyBpZDogY29udGFpbkVsZW1lbnQuQ29kZSwgbGFiZWw6IGNvbnRhaW5FbGVtZW50Lk5hbWUgfSk7XHJcbiAgICAgICAgICAgICAgICAgIGRhdGFzLnB1c2goeyBpZDogc2VsZi5ndWlkKCksIHJlc3VsdGNvZGU6IGNvbnRhaW5FbGVtZW50LkNvZGUsIHJlc3VsdHNvcnQ6ICcwJywgcmVzdWx0bmFtZTogY29udGFpbkVsZW1lbnQuTmFtZSwgcmVzdWx0Y29sdmlzaWJsZTogJzEnLCByZXN1bHRkZXNjcmlwdGlvbjogJycgfSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGlmIChkYXRhcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgIHNlbGYucmVzdWx0RGF0YXMgPSBbLi4uZGF0YXNdO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgc2VsZi5xb21hbmFnZXJjb2RlID0gJ2NvbS4nICsgKGN1cnJlbnRNZXRhZGF0YUNvbnRlbnQuTmFtZXNwYWNlUHJlZml4ICsgJy4nICsgY3VycmVudE1ldGFkYXRhQ29udGVudC5Db2RlKS50b0xvd2VyQ2FzZSgpOyAvLyBxb+e8luWPt1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHNvcnREYXRhKGEsIGIpIHtcclxuICAgIHJldHVybiAgYS5vcmRlck51bWJlciAtIGIub3JkZXJOdW1iZXI7XHJcbiAgfVxyXG5cclxuICBjbGlja0xhc3RTdGVwID0gKCkgPT4ge1xyXG4gICAgdGhpcy5jYWNoZVNlcnZpY2Uuc2V0KCdmb3JtdWxhclBhcmFtJywgdGhpcy5kYXRhKTtcclxuICAgIHJldHVybiB0cnVlO1xyXG4gIH1cclxuXHJcbiAgYmVmb3JlRmluaXNoID0gKCkgPT4ge1xyXG4gICAgY29uc3QgZmxhZyQgPSBuZXcgU3ViamVjdCgpO1xyXG4gICAgaWYgKHRoaXMuZm9ybXVsYXJUeXBlID09PSAxKSB7IC8vIOe7hOWQiOWFrOW8j+S/neWtmFxyXG4gICAgICBpZiAoIXRoaXMubmFtZSkge1xyXG4gICAgICAgIHRoaXMubXNnU2VydmljZS5pbmZvKHRoaXMubG9jYWxpemVTZXJ2aWNlLmdldFZhbHVlKCdmb3JtdWxhci5kZWZpbmUubWVzc2FnZUFsZXJ0Lm5hbWVWZXJpZnknKSk7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKCF0aGlzLmZvcm11bGFyVGV4dCkge1xyXG4gICAgICAgIHRoaXMubXNnU2VydmljZS5pbmZvKHRoaXMubG9jYWxpemVTZXJ2aWNlLmdldFZhbHVlKCdmb3JtdWxhci5kZWZpbmUubWVzc2FnZUFsZXJ0LmNvbWJpbmVWZXJpZnknKSk7XHJcbiAgICAgIH0gZWxzZSBpZiAodGhpcy5mb3JtdWxhclRleHQgJiYgIXRoaXMuZm9ybXVsYXJDaGVjayh0aGlzLmZvcm11bGFyVGV4dCkpIHtcclxuICAgICAgICB0aGlzLm1zZ1NlcnZpY2UuaW5mbyh0aGlzLmxvY2FsaXplU2VydmljZS5nZXRWYWx1ZSgnZm9ybXVsYXIuZGVmaW5lLm1lc3NhZ2VBbGVydC5mb3JtdWxhckludGVncml0eVZlcmlmeScpKTtcclxuICAgICAgfVxyXG4gICAgICBjb25zdCBmb3JtdWxhckluZm86IGFueSA9IHtcclxuICAgICAgICBpZDogdGhpcy5jdXJyZW50Rm9ybXVsYXJJZCxcclxuICAgICAgICBpc2dyb3VwOiB0aGlzLmlzR3JvdXAgPyAxIDogMCxcclxuICAgICAgICBuYW1lOiB0aGlzLm5hbWUsXHJcbiAgICAgICAgcXVlcnlmdW5jOiAnJyxcclxuICAgICAgICBzdHIxOiAnJyxcclxuICAgICAgICBzdHIyOiAnJyxcclxuICAgICAgICBzdHIzOiAnJyxcclxuICAgICAgICBzdHI0OiAnJyxcclxuICAgICAgICBjdXJzdTogdGhpcy5kYXRhLmN1cnJlbnRTVSxcclxuICAgICAgICBzdHI1OiB0aGlzLmRhdGEuZm9ybXVsYXJSZWdpb24gPyB0aGlzLmRhdGEuZm9ybXVsYXJSZWdpb24gOiAncHVibGlzaCcsXHJcbiAgICAgICAgc3RyNjogdGhpcy5mb3JtdWxhclRleHQsXHJcbiAgICAgICAgbnVtMTogMSwgLy8g5Luj6KGo57uE5ZCI5YWs5byPXHJcbiAgICAgIH07XHJcbiAgICAgIGNvbnN0IG9wdGlvbnMgPSB7XHJcbiAgICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgICAgJ1Nlc3Npb25JZCc6IHRoaXMuZGF0YS5zZXNzaW9uSWQsXHJcbiAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXHJcbiAgICAgICAgfVxyXG4gICAgICB9O1xyXG4gICAgICBpZiAoZm9ybXVsYXJJbmZvKSB7XHJcbiAgICAgICAgY29uc3QgcmV0cmlldmVVcmkgPSB0aGlzLmRhdGEuc2VydmVySG9zdCArICcvYXBpL2dzcC9iY2MvdjEuMC9xdWVyeWdldGRhdGFkZXRhaWxfZnJtL3NlcnZpY2Uvc2F2ZXFkcGZvcm11bGFyJztcclxuICAgICAgICB0aGlzLnJlc3RmdWxTZXJ2aWNlLnB1dChyZXRyaWV2ZVVyaSwgeyBmb3JtdWxhckluZm86IEpTT04uc3RyaW5naWZ5KGZvcm11bGFySW5mbykgfSwge30sIG9wdGlvbnMpLnN1YnNjcmliZShkYXRhID0+IHtcclxuICAgICAgICAgIGNvbnN0IGZvcm11bGFyRGF0YSA9IGRhdGEucmV0dXJuVmFsdWU7XHJcbiAgICAgICAgICBpZiAoZm9ybXVsYXJEYXRhKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY3VycmVudEZvcm11bGFySWQgPSBmb3JtdWxhckRhdGE7XHJcbiAgICAgICAgICAgIHRoaXMuZW50aXR5RGF0YVNlcnZpY2Uuc2V0Rm9ybXVsYXJTdGF0ZSh0cnVlLCB7IGlkOiB0aGlzLmN1cnJlbnRGb3JtdWxhcklkLCBuYW1lOiB0aGlzLm5hbWUgfSk7XHJcbiAgICAgICAgICAgIC8vdGhpcy5jYWNoZVNlcnZpY2Uuc2V0KCdmb3JtdWxhclJlc3VsdCcsIHsgaWQ6IHRoaXMuY3VycmVudEZvcm11bGFySWQsIG5hbWU6ICflhazlvI8nIH0pO1xyXG4gICAgICAgICAgICBmbGFnJC5uZXh0KHRydWUpO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5lbnRpdHlEYXRhU2VydmljZS5zZXRGb3JtdWxhclN0YXRlKGZhbHNlLCB7fSk7XHJcbiAgICAgICAgICAgIHRoaXMubXNnU2VydmljZS5lcnJvcih0aGlzLmxvY2FsaXplU2VydmljZS5nZXRWYWx1ZSgnZm9ybXVsYXIuZGVmaW5lLm1lc3NhZ2VBbGVydC5zYXZlRm9ybXVsYXJGYWlsdXJlJykpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICB9IGVsc2UgaWYgKCF0aGlzLmN1cnJlbnRGb3JtdWxhcklkKSB7XHJcbiAgICAgIHRoaXMuZW50aXR5RGF0YVNlcnZpY2Uuc2V0Rm9ybXVsYXJTdGF0ZShmYWxzZSwge30pO1xyXG4gICAgICB0aGlzLm1zZ1NlcnZpY2UuaW5mbyh0aGlzLmxvY2FsaXplU2VydmljZS5nZXRWYWx1ZSgnZm9ybXVsYXIuZGVmaW5lLm1lc3NhZ2VBbGVydC5mb3JtdWxhclNhdmVWZXJpZnknKSk7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuZW50aXR5RGF0YVNlcnZpY2Uuc2V0Rm9ybXVsYXJTdGF0ZSh0cnVlLCB7IGlkOiB0aGlzLmN1cnJlbnRGb3JtdWxhcklkLCBuYW1lOiB0aGlzLm5hbWUgfSk7XHJcbiAgICAgIC8vdGhpcy5jYWNoZVNlcnZpY2Uuc2V0KCdmb3JtdWxhclJlc3VsdCcsIHsgaWQ6IHRoaXMuY3VycmVudEZvcm11bGFySWQsIG5hbWU6IHRoaXMubmFtZSA/IHRoaXMubmFtZSA6ICflhazlvI8nIH0pO1xyXG4gICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH1cclxuICAgIHJldHVybiBmbGFnJDtcclxuICB9XHJcblxyXG4gIGZvcm11bGFyQ2hlY2soc3RyaW5nKSB7XHJcbiAgICAvLyDliZTpmaTnqbrnmb3nrKZcclxuICAgIHN0cmluZyA9IHN0cmluZy5yZXBsYWNlKC9cXHMvZywgJycpO1xyXG5cclxuICAgIC8vIOmUmeivr+aDheWGte+8jOepuuWtl+espuS4slxyXG4gICAgaWYgKCcnID09PSBzdHJpbmcpIHtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIOmUmeivr+aDheWGte+8jOi/kOeul+espui/nue7rVxyXG4gICAgaWYgKC9bXFwrXFwtXFwqXFwvXXsyLH0vLnRlc3Qoc3RyaW5nKSkge1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgLy8g56m65ous5Y+3XHJcbiAgICBpZiAoL1xcKFxcKS8udGVzdChzdHJpbmcpKSB7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICAvLyDplJnor6/mg4XlhrXvvIzmi6zlj7fkuI3phY3lr7lcclxuICAgIHZhciBzdGFjayA9IFtdO1xyXG4gICAgZm9yICh2YXIgaSA9IDAsIGl0ZW07IGkgPCBzdHJpbmcubGVuZ3RoOyBpKyspIHtcclxuICAgICAgaXRlbSA9IHN0cmluZy5jaGFyQXQoaSk7XHJcbiAgICAgIGlmICgnKCcgPT09IGl0ZW0pIHtcclxuICAgICAgICBzdGFjay5wdXNoKCcoJyk7XHJcbiAgICAgIH0gZWxzZSBpZiAoJyknID09PSBpdGVtKSB7XHJcbiAgICAgICAgaWYgKHN0YWNrLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgIHN0YWNrLnBvcCgpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBpZiAoMCAhPT0gc3RhY2subGVuZ3RoKSB7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICAvLyDplJnor6/mg4XlhrXvvIwo5ZCO6Z2i5piv6L+Q566X56ymIFxyXG4gICAgaWYgKC9cXChbXFwrXFwtXFwqXFwvXS8udGVzdChzdHJpbmcpKSB7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICAvLyDplJnor6/mg4XlhrXvvIwp5YmN6Z2i5piv6L+Q566X56ymXHJcbiAgICBpZiAoL1tcXCtcXC1cXCpcXC9dXFwpLy50ZXN0KHN0cmluZykpIHtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIC8vIOmUmeivr+aDheWGte+8jCjliY3pnaLkuI3mmK/ov5DnrpfnrKZcclxuICAgIC8vIGlmICgvW15cXCtcXC1cXCpcXC9dXFwoLy50ZXN0KHN0cmluZykpIHtcclxuICAgIC8vICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgLy8gfVxyXG5cclxuICAgIC8vIC8vIOmUmeivr+aDheWGte+8jCnlkI7pnaLkuI3mmK/ov5DnrpfnrKZcclxuICAgIC8vIGlmICgvXFwpW15cXCtcXC1cXCpcXC9dLy50ZXN0KHN0cmluZykpIHtcclxuICAgIC8vICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgLy8gfVxyXG5cclxuICAgIHJldHVybiB0cnVlO1xyXG4gIH1cclxuXHJcbn0iXX0=